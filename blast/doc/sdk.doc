{\rtf1\ansi\ansicpg1252\uc1 \deff0\deflang1033\deflangfe1033{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f1\fswiss\fcharset0\fprq2{\*\panose 020b0604020202020204}Arial;}{\f2\fmodern\fcharset0\fprq1{\*\panose 02070309020205020404}Courier New;}{\f3\froman\fcharset2\fprq2{\*\panose 05050102010706020507}Symbol;}{\f4\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times;}{\f5\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}Helvetica;}{\f6\fmodern\fcharset0\fprq1{\*\panose 00000000000000000000}Courier;}{\f7\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}Geneva;}{\f8\froman\fcharset0\fprq2{\*\panose 00000000000000000000}Tms Rmn;}{\f9\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}Helv;}{\f10\froman\fcharset0\fprq2{\*\panose 00000000000000000000}MS Serif;}{\f11\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}MS Sans Serif;}{\f12\froman\fcharset0\fprq2{\*\panose 00000000000000000000}New York;}{\f13\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}System;}{\f14\fnil\fcharset2\fprq2{\*\panose 05000000000000000000}Wingdings;}{\f15\fswiss\fcharset0\fprq3{\*\panose 020b0604030504040204}Tahoma;}{\f16\froman\fcharset0\fprq2{\*\panose 00000000000000000000}Palatino;}{\f17\froman\fcharset0\fprq0{\*\panose 00000000000000000000}PAl;}{\f18\fswiss\fcharset0\fprq2{\*\panose 00000000000000000000}Helvetica-Narrow;}{\f19\froman\fcharset238\fprq2 Times New Roman CE;}{\f20\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f22\froman\fcharset161\fprq2 Times New Roman Greek;}{\f23\froman\fcharset162\fprq2 Times New Roman Tur;}{\f24\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f25\fswiss\fcharset238\fprq2 Arial CE;}{\f26\fswiss\fcharset204\fprq2 Arial Cyr;}{\f28\fswiss\fcharset161\fprq2 Arial Greek;}{\f29\fswiss\fcharset162\fprq2 Arial Tur;}{\f30\fswiss\fcharset186\fprq2 Arial Baltic;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\sb240\widctlpar\adjustright \f16\fs20\cgrid \snext0 Normal;}{\s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \adjustright \b\f16\fs28\cgrid \sbasedon0 \snext0 heading 1;}{\s2\sb240\keep\keepn\widctlpar\adjustright \b\f16\fs28\cgrid \sbasedon0 \snext0 heading 2;}{\s3\li360\sb240\keep\keepn\widctlpar\adjustright \b\f16\cgrid \sbasedon0 \snext15 heading 3;}{\s4\li360\sb240\widctlpar\adjustright \f4\ul\cgrid \sbasedon0 \snext15 heading 4;}{\s5\li720\sb240\widctlpar\adjustright \b\f4\fs20\cgrid \sbasedon0 \snext15 heading 5;}{\s6\li720\sb240\widctlpar\adjustright \f4\fs20\ul\cgrid \sbasedon0 \snext15 heading 6;}{\s7\li720\sb240\widctlpar\adjustright \i\f4\fs20\cgrid \sbasedon0 \snext15 heading 7;}{\s8\li720\sb240\widctlpar\adjustright \i\f4\fs20\cgrid \sbasedon0 \snext15 heading 8;}{\s9\li720\sb240\widctlpar\adjustright \i\f4\fs20\cgrid \sbasedon0 \snext15 heading 9;}{\*\cs10 \additive Default Paragraph Font;}{\s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext0 Normal Indent;}{\s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid \sbasedon0 \snext0 toc 3;}{\s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid \sbasedon0 \snext0 toc 2;}{\s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid \sbasedon0 \snext0 toc 1;}{\s19\li360\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext0 index 2;}{\s20\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext0 index 1;}{\*\cs21 \additive \sbasedon10 line number;}{\s22\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext20 index heading;}{\s23\qc\sb240\widctlpar\tqc\tx4320\tqr\tx8640\adjustright \shading2000 \b\f16\fs28\cgrid \sbasedon0 \snext23 footer;}{\s24\sb240\widctlpar\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid \sbasedon0 \snext24 header;}{\*\cs25 \additive \fs16\up6 \sbasedon10 footnote reference;}{\s26\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext26 footnote text;}{\s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid \sbasedon0 \snext27 Code Example;}{\s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid \sbasedon0 \snext28 Asn Example;}{\s29\keepn\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext29 TableType;}{\s30\widctlpar\tx187\tx360\tx547\tx720\tx907\tx1080\tx1267\tx1440\adjustright \f6\fs10\cgrid \sbasedon0 \snext30 AsnCompare;}{\s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid \sbasedon0 \snext31 TableTitle;}{\s32\li1080\ri720\keep\keepn\widctlpar\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\adjustright \f2\fs16\cgrid \sbasedon0 \snext32 Source code;}{\s33\fi-1800\li2520\sb29\sa29\keep\widctlpar\tx2520\adjustright \f4\fs22\cgrid \sbasedon34 \snext33 List of fields;}{\s34\li1080\sb29\sa29\widctlpar\adjustright \f4\fs22\cgrid \sbasedon0 \snext34 List;}{\s35\li1080\sb72\sa72\widctlpar\adjustright \f4\fs22\cgrid \sbasedon0 \snext35 Comments;}{\s36\fi-1440\li1440\ri360\sb43\sa43\keep\widctlpar\adjustright \f4\fs22\cgrid \sbasedon0 \snext36 DataType;}{\s37\fi-2520\li3600\sb86\sa58\widctlpar\adjustright \f4\fs22\cgrid \sbasedon34 \snext37 Standard List;}{\s38\qc\sb72\sa1440\keepn\pagebb\widctlpar\adjustright \b\scaps\f16\fs56\cgrid \sbasedon1 \snext38 Chapter Title;}{\s39\fi-2160\li3240\keep\keepn\widctlpar\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\adjustright \f2\fs20\cgrid \sbasedon32 \snext39 Definition;}{\s40\fi-2304\li2304\sb29\sa29\widctlpar\tx2304\adjustright \f16\fs22\cgrid \sbasedon34 \snext40 List of functions;}{\s41\fi-1080\li1080\ri360\sa58\keep\widctlpar\tx1080\adjustright \f16\fs22\cgrid \sbasedon0 \snext41 Arguments;}{\s42\li1080\ri720\keep\keepn\widctlpar\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\adjustright \b\f2\fs18\cgrid \sbasedon32 \snext42 Typedef;}{\s43\li1080\ri720\sb14\sa14\keep\keepn\widctlpar\tx360\tx720\tx1080\tx1440\tx1800\tx2160\tx2520\tx2880\tx3240\tx3600\tx3960\tx4320\tx4680\tx5040\tx5400\tx5760\adjustright \b\f18\fs20\cgrid \sbasedon32 \snext43 Asn1Spec;}{\s44\fi-1944\li1944\sb29\sa29\keep\widctlpar\tx1944\adjustright \f16\fs22\cgrid \sbasedon40 \snext44 Asn1fields;}{\s45\fi-1800\li5400\sb29\sa29\widctlpar\adjustright \f4\fs22\cgrid \sbasedon37 \snext45 Sub-List;}{\s46\li1800\widctlpar\tx2160\tx2520\tx2880\tqr\tx5040\adjustright \f2\fs20\cgrid \sbasedon32 \snext46 Filename;}{\s47\sb180\sa58\keepn\widctlpar\tx2160\tx2520\tx2880\tqr\tx5040\adjustright \f2\cgrid \sbasedon46 \snext47 Filename heading;}{\s48\fi-2880\li4320\sb29\widctlpar\tx4320\adjustright \f6\fs22\cgrid \sbasedon34 \snext48 List of Constants;}{\s49\sa43\keepn\widctlpar\adjustright \b\f2\fs22\cgrid \sbasedon0 \snext49 ProgramName;}{\s50\qj\sb240\widctlpar\adjustright \f16\fs22\cgrid \sbasedon0 \snext50 Text;}{\s51\li360\sb240\keep\widctlpar\adjustright \f6\fs20\cgrid \sbasedon0 \snext51 Program;}{\s52\qj\sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext50 Section;}{\s53\qj\sb240\widctlpar\adjustright \f16\fs22\cgrid \sbasedon0 \snext51 Comment;}{\s54\qc\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext54 Figure;}{\s55\qc\sb240\keepn\widctlpar\adjustright \b\f16\fs28\cgrid \sbasedon0 \snext50 Heading;}{\s56\widctlpar\adjustright \f6\fs20\cgrid \sbasedon51 \snext56 Index;}{\s57\sb240\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext57 ormal;}{\s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid \sbasedon59 \snext58 FileContents;}{\s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext59 FuncDescr;}{\s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid \sbasedon0 \snext60 FuncProto;}{\s61\keep\widctlpar\adjustright \i\f16\fs18\cgrid \sbasedon62 \snext61 TableHead;}{\s62\sb40\sa40\keep\widctlpar\adjustright \f16\fs20\cgrid \sbasedon0 \snext62 TableText;}{\s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrt\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid \sbasedon64 \snext63 Normal ListHead;}{\s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\tx3600\adjustright \f16\fs20\cgrid \sbasedon15 \snext64 Normal List;}{\s65\li2160\ri720\sb240\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid \sbasedon0 \snext0 toc 4;}}{\*\revtbl {Unknown;}}{\info{\author Jim Ostell}{\operator francis}{\creatim\yr1993\mo1\dy26\hr15\min28}{\revtim\yr1998\mo3\dy23\hr17\min26}{\printim\yr1994\mo10\dy27\hr10\min28}{\version51}{\edmins511}{\nofpages15}{\nofwords108533}{\nofchars618643}{\*\company NCBI/NLM/NIH}{\nofcharsws759737}{\vern89}}\margl1440\margr1440\gutter720 \facingp\widowctrl\ftnbj\aenddoc\noextrasprl\prcolbl\cvmme\sprsspbf\brkfrm\swpbdr\lytprtmet\hyphcaps0\fracwidth\viewkind4\viewscale100\pgbrdrhead\pgbrdrfoot \fet0{\*\template C:\\WORD\\SDK.DOT}\sectd \sbkodd\pgnrestart\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 
\par }}{\footerl \pard\plain \s23\qc\sb240\widctlpar\tqc\tx4320\tqr\tx8640\adjustright \shading2000 \b\f16\fs28\cgrid {NCBI Software Development ToolKit - Version 1.8
\par }}{\footerr \pard\plain \s23\qc\sb240\widctlpar\tqc\tx4320\tqr\tx8640\adjustright \shading2000 \b\f16\fs28\cgrid {NCBI Software Development ToolKit - Version 1.9
\par }}{\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\trowd \trgaph108\trleft-108\trkeep \clvertalt\cltxlrtb \cellx7200\clvertalt\cltxlrtb \cellx8820\pard\plain \widctlpar\intbl\brdrb\brdrs\brdrw30\brsp20 \adjustright \f16\fs20\cgrid {\b\i\fs28 National Center for Biotechnology Information}{\fs22 
\par }\pard \li288\widctlpar\intbl\adjustright {National Library of Medicine
\par }\pard \li288\widctlpar\intbl\adjustright {National Institutes of Health, Building 38A
\par 8600 Rockville Pike
\par Bethesda, MD  20984
\par 301-496-2475         FAX 301-480-9241}{\fs22 \cell }\pard \widctlpar\intbl\adjustright {\f0 {\pict\wmetafile8\picw2577\pich2648\picwgoal1461\pichgoal1501 \bin4608  	    	             ã˝   N L    ˙            -     ¸           -    	       ˇˇˇ            ˙     ˇˇˇ    -    ¸  ˇˇˇ      -             	ˇˇˇ    ˇˇˇ            ˙     ˇˇˇ    -         $ ‘˝ã˝Wã˝W‘˝‘˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        % ‘˝ã˝Wã˝W‘˝‘˝       -         $ ç˝Uç˝U®˝®˝ç˝   'ˇˇ   ˙     ˇˇˇ    -    ¸  ˇˇˇ      -            	ˇˇˇ    ˇˇˇ            ˚Ëˇ	     ê       Times ó9   -    .        ! N ¢˝   ! C ¢˝(   ! B ¢˝7   ! I ¢˝G       'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        % ®˝U®˝   ˙     ÛÛÛ    -    ¸  ÛÛÛ      -            	ÛÛÛ    ˇˇˇ            -         $
 ≤˝≤˝≥˝æ˝…˝ ˝ ˝…˝≥˝≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %
 ≤˝≤˝≥˝æ˝…˝ ˝ ˝…˝≥˝≤˝   ˙     ÛÛÛ    -    ¸  ÛÛÛ      -            	ÛÛÛ    ˇˇˇ            -         $	 .≤˝*≤˝)≤˝#…˝" ˝& ˝'…˝-≥˝.≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %	 .≤˝*≤˝)≤˝#…˝" ˝& ˝'…˝-≥˝.≤˝   ˙     ÛÛÛ    -    ¸  ÛÛÛ      -            	ÛÛÛ    ˇˇˇ            -         $	 '≤˝#≤˝"≤˝…˝ ˝ ˝ …˝&≥˝'≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %	 '≤˝#≤˝"≤˝…˝ ˝ ˝ …˝&≥˝'≤˝   ˙     ÛÛÛ    -    ¸  ÛÛÛ      -            	ÛÛÛ    ˇˇˇ            -         $ >≤˝:≤˝3…˝2 ˝7 ˝7…˝>≥˝>≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        % >≤˝:≤˝3…˝2 ˝7 ˝7…˝>≥˝>≤˝   ˙     ÛÛÛ    -    ¸  ÛÛÛ      -            	ÛÛÛ    ˇˇˇ            -         $	 7≤˝3≤˝/æ˝,…˝+ ˝0 ˝0…˝6≥˝7≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %	 7≤˝3≤˝/æ˝,…˝+ ˝0 ˝0…˝6≥˝7≤˝   ˙     ˇˇˇ    -    ¸  ˇˇˇ      -            	ˇˇˇ    ˇˇˇ            -         $ 1∏˝U∏˝Uƒ˝1ƒ˝1∏˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˚Òˇ     ê       "Helvetica Á8   -    .        ! 0 √˝1   ! 1 √˝6       'ˇˇ       ˚Òˇ     ê       "Helvetica Á8   -    .        ! 1 √˝:   ! 0 √˝>   ! 1 √˝C   ! 0 √˝H   ! 1 √˝L       'ˇˇ       ˚Òˇ     ê       "Helvetica Á8   -    .        ! 1 √˝Q       'ˇˇ   ˙     Ç    -    ¸  Ç      -            	Ç    ˇˇˇ            -         $	 ≤˝≤˝æ˝…˝ ˝ ˝…˝≥˝≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %	 ≤˝≤˝æ˝…˝ ˝ ˝…˝≥˝≤˝   ˙     Ç    -    ¸  Ç      -            	Ç    ˇˇˇ            -         $
 ≤˝≤˝≤˝%…˝& ˝! ˝!…˝æ˝≥˝≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        %
 ≤˝≤˝≤˝%…˝& ˝! ˝!…˝æ˝≥˝≤˝   ˙     Ç    -    ¸  Ç      -            	Ç    ˇˇˇ            -         $ #≤˝(≤˝/…˝/ ˝+ ˝*…˝$≥˝#≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        % #≤˝(≤˝/…˝/ ˝+ ˝*…˝$≥˝#≤˝   ˙     Ç    -    ¸  Ç      -            	Ç    ˇˇˇ            -         $ *≤˝/≤˝6…˝7 ˝2 ˝1…˝+≥˝*≤˝   'ˇˇ   ˙           -    ¸          -            	      ˇˇˇ            ˙           -        % *≤˝/≤˝6…˝7 ˝2 ˝1…˝+≥˝*≤˝   ˙             -    ¸  ÄÄÄ      -              re manipulation. 
It is recomm}}{\f0 \cell }\pard \widctlpar\intbl\adjustright {\f0 \row }\pard \sb240\widctlpar\adjustright {
\par }\pard \qc\sb240\widctlpar\adjustright {\b\fs48 
\par }\pard \qc\sb240\widctlpar\adjustright {\b\fs48 NCBI Software Development ToolKit
\par }{\b\fs28 Version 1.9 - August 1, 1994
\par 
\par 
\par Draft Copy
\par This documentation is always incomplete and under revision.
\par \sect }\sectd \sbkodd\pgnrestart\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 
\par }}\pard\plain \qc\sb240\widctlpar\adjustright \f16\fs20\cgrid {\b\fs28 NCBI Software Development ToolKit
\par }\pard \qc\sb240\widctlpar\adjustright {\b\fs28 Short Table of Contents
\par 
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Full Table of Contents\tab 1
\par }\pard \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Overview\tab 9
\par Data Model\tab 19
\par CoreLib: Portable Core Library\tab 31
\par AsnLib: ASN.1 Processing\tab 49
\par General Use Objects\tab 81
\par Bibliographic References\tab 91
\par MEDLINE Data\tab 109
\par Biological Sequences\tab 115
\par Collections of Sequences\tab 159
\par Sequence Locations and Identifiers\tab 167
\par Sequence Features\tab 185
\par Sequence Alignments\tab 215
\par Sequence Graphs\tab 225
\par Sequence Utilities\tab 229
\par Entrez Data Access\tab 243
\par Vibrant User Interface Tools\tab 257
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\pgnrestart\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\field{\*\fldinst {page }}{\fldrslt {\lang1024 10}}}{\tab NCBI SDK
\par }}{\headerr \pard\plain \qr\sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI SDK\tab }{\field{\*\fldinst {page }}{\fldrslt {\lang1024 9}}}{
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430216}{\*\bkmkstart _Toc294430693}{\*\bkmkstart _Toc300649089}Full Table of Contents{\*\bkmkend _Toc294430216}{\*\bkmkend _Toc294430693}{\*\bkmkend _Toc300649089}
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field\fldedit{\*\fldinst {TOC \\o}}{\fldrslt {Full Table of Contents\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649089  }{\field{\*\fldinst { PAGEREF _Toc300649089 }}{\fldrslt {1}}}}}{
\par }\pard \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Overview\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649090  }{\field{\*\fldinst { PAGEREF _Toc300649090 }}{\fldrslt {9}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649091  }{\field{\*\fldinst { PAGEREF _Toc300649091 }}{\fldrslt {9}}}}}{
\par Components Of The Software Development ToolKit\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649092  }{\field{\*\fldinst { PAGEREF _Toc300649092 }}{\fldrslt {10}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649093  }{\field{\*\fldinst { PAGEREF _Toc300649093 }}{\fldrslt {10}}}}}{
\par Data Model For Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649094  }{\field{\*\fldinst { PAGEREF _Toc300649094 }}{\fldrslt {11}}}}}{
\par CoreLib: Writing Portable Software\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649095  }{\field{\*\fldinst { PAGEREF _Toc300649095 }}{\fldrslt {11}}}}}{
\par AsnLib: Reading and Writing ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649096  }{\field{\*\fldinst { PAGEREF _Toc300649096 }}{\fldrslt {11}}}}}{
\par Object Loaders: Combining AsnLib and the Data Model\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649097  }{\field{\*\fldinst { PAGEREF _Toc300649097 }}{\fldrslt {11}}}}}{
\par Utilities\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649098  }{\field{\*\fldinst { PAGEREF _Toc300649098 }}{\fldrslt {12}}}}}{
\par Data Access\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649099  }{\field{\*\fldinst { PAGEREF _Toc300649099 }}{\fldrslt {12}}}}}{
\par Vibrant: A Portable Windowing System\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649100  }{\field{\*\fldinst { PAGEREF _Toc300649100 }}{\fldrslt {12}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {A Few Samples\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649101  }{\field{\*\fldinst { PAGEREF _Toc300649101 }}{\fldrslt {13}}}}}{
\par Using This Document\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649102  }{\field{\*\fldinst { PAGEREF _Toc300649102 }}{\fldrslt {15}}}}}{
\par Contacting NCBI\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649103  }{\field{\*\fldinst { PAGEREF _Toc300649103 }}{\fldrslt {16}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Data Model\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649104  }{\field{\*\fldinst { PAGEREF _Toc300649104 }}{\fldrslt {19}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649105  }{\field{\*\fldinst { PAGEREF _Toc300649105 }}{\fldrslt {19}}}}}{
\par Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649106  }{\field{\*\fldinst { PAGEREF _Toc300649106 }}{\fldrslt {20}}}}}{
\par Classes of Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649107  }{\field{\*\fldinst { PAGEREF _Toc300649107 }}{\fldrslt {21}}}}}{
\par Locations on Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649108  }{\field{\*\fldinst { PAGEREF _Toc300649108 }}{\fldrslt {24}}}}}{
\par Associating Annotation With Locations On Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649109  }{\field{\*\fldinst { PAGEREF _Toc300649109 }}{\fldrslt {24}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Feature Tables\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649110  }{\field{\*\fldinst { PAGEREF _Toc300649110 }}{\fldrslt {25}}}}}{
\par Sequence Alignments\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649111  }{\field{\*\fldinst { PAGEREF _Toc300649111 }}{\fldrslt {26}}}}}{
\par Sequence Graph\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649112  }{\field{\*\fldinst { PAGEREF _Toc300649112 }}{\fldrslt {27}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Collections of Related Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649113  }{\field{\*\fldinst { PAGEREF _Toc300649113 }}{\fldrslt {27}}}}}{
\par Consequences of the Data Model\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649114  }{\field{\*\fldinst { PAGEREF _Toc300649114 }}{\fldrslt {29}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {CoreLib: Portable Core Library\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649115  }{\field{\*\fldinst { PAGEREF _Toc300649115 }}{\fldrslt {31}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649116  }{\field{\*\fldinst { PAGEREF _Toc300649116 }}{\fldrslt {31}}}}}{
\par Application Frameworks\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649117  }{\field{\*\fldinst { PAGEREF _Toc300649117 }}{\fldrslt {31}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Main Entry Point\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649118  }{\field{\*\fldinst { PAGEREF _Toc300649118 }}{\fldrslt {32}}}}}{
\par Getting Program Arguments\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649119  }{\field{\*\fldinst { PAGEREF _Toc300649119 }}{\fldrslt {32}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {User Interface Elements\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649120  }{\field{\*\fldinst { PAGEREF _Toc300649120 }}{\fldrslt {34}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Alerts\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649121  }{\field{\*\fldinst { PAGEREF _Toc300649121 }}{\fldrslt {34}}}}}{
\par Beeps\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649122  }{\field{\*\fldinst { PAGEREF _Toc300649122 }}{\fldrslt {36}}}}}{
\par Monitors\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649123  }{\field{\*\fldinst { PAGEREF _Toc300649123 }}{\fldrslt {36}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Configuration Files\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649124  }{\field{\*\fldinst { PAGEREF _Toc300649124 }}{\fldrslt {39}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {File Names\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649125  }{\field{\*\fldinst { PAGEREF _Toc300649125 }}{\fldrslt {39}}}}}{
\par File Format\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649126  }{\field{\*\fldinst { PAGEREF _Toc300649126 }}{\fldrslt {39}}}}}{
\par Configuration File Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649127  }{\field{\*\fldinst { PAGEREF _Toc300649127 }}{\fldrslt {40}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Error Processing\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649128  }{\field{\*\fldinst { PAGEREF _Toc300649128 }}{\fldrslt {40}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Posting An Error\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649129  }{\field{\*\fldinst { PAGEREF _Toc300649129 }}{\fldrslt {42}}}}}{
\par User Error Strings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649130  }{\field{\*\fldinst { PAGEREF _Toc300649130 }}{\fldrslt {43}}}}}{
\par Customization\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649131  }{\field{\*\fldinst { PAGEREF _Toc300649131 }}{\fldrslt {43}}}}}{
\par Configuration File Settings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649132  }{\field{\*\fldinst { PAGEREF _Toc300649132 }}{\fldrslt {46}}}}}{
\par Preparing Error Message Files\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649133  }{\field{\*\fldinst { PAGEREF _Toc300649133 }}{\fldrslt {48}}}}}{
\par }\pard \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Fetching and Displaying Errors\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649134  }{\field{\*\fldinst { PAGEREF _Toc300649134 }}{\fldrslt {49}}}}}{
\par }\pard \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Installing Custom Error Handlers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649135  }{\field{\*\fldinst { PAGEREF _Toc300649135 }}{\fldrslt {49}}}}}{
\par Miscellaneous Utility Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649136  }{\field{\*\fldinst { PAGEREF _Toc300649136 }}{\fldrslt {50}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Files and Directories\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649137  }{\field{\*\fldinst { PAGEREF _Toc300649137 }}{\fldrslt {50}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {ANSI-Style Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649138  }{\field{\*\fldinst { PAGEREF _Toc300649138 }}{\fldrslt {50}}}}}{
\par Directory Management\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649139  }{\field{\*\fldinst { PAGEREF _Toc300649139 }}{\fldrslt {51}}}}}{
\par CD-ROM\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649140  }{\field{\*\fldinst { PAGEREF _Toc300649140 }}{\fldrslt {52}}}}}{
\par Customization\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649141  }{\field{\*\fldinst { PAGEREF _Toc300649141 }}{\fldrslt {53}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Memory Management\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649142  }{\field{\*\fldinst { PAGEREF _Toc300649142 }}{\fldrslt {53}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {ANSI-Style Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649143  }{\field{\*\fldinst { PAGEREF _Toc300649143 }}{\fldrslt {53}}}}}{
\par Fixed Memory\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649144  }{\field{\*\fldinst { PAGEREF _Toc300649144 }}{\fldrslt {55}}}}}{
\par Relocatable Memory\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649145  }{\field{\*\fldinst { PAGEREF _Toc300649145 }}{\fldrslt {55}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Byte Stores\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649146  }{\field{\*\fldinst { PAGEREF _Toc300649146 }}{\fldrslt {56}}}}}{
\par String Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649147  }{\field{\*\fldinst { PAGEREF _Toc300649147 }}{\fldrslt {59}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {ANSI-Style Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649148  }{\field{\*\fldinst { PAGEREF _Toc300649148 }}{\fldrslt {59}}}}}{
\par Additional String Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649149  }{\field{\*\fldinst { PAGEREF _Toc300649149 }}{\fldrslt {59}}}}}{
\par Number Strings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649150  }{\field{\*\fldinst { PAGEREF _Toc300649150 }}{\fldrslt {60}}}}}{
\par Time Strings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649151  }{\field{\*\fldinst { PAGEREF _Toc300649151 }}{\fldrslt {61}}}}}{
\par SGML Strings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649152  }{\field{\*\fldinst { PAGEREF _Toc300649152 }}{\fldrslt {61}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {ValNode Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649153  }{\field{\*\fldinst { PAGEREF _Toc300649153 }}{\fldrslt {61}}}}}{
\par Math Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649154  }{\field{\*\fldinst { PAGEREF _Toc300649154 }}{\fldrslt {64}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Macros\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649155  }{\field{\*\fldinst { PAGEREF _Toc300649155 }}{\fldrslt {64}}}}}{
\par Arithmatic Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649156  }{\field{\*\fldinst { PAGEREF _Toc300649156 }}{\fldrslt {65}}}}}{
\par Transendental Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649157  }{\field{\*\fldinst { PAGEREF _Toc300649157 }}{\fldrslt {65}}}}}{
\par Gamma Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649158  }{\field{\*\fldinst { PAGEREF _Toc300649158 }}{\fldrslt {65}}}}}{
\par Advanced Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649159  }{\field{\*\fldinst { PAGEREF _Toc300649159 }}{\fldrslt {66}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Miscellaneous Utilities\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649160  }{\field{\*\fldinst { PAGEREF _Toc300649160 }}{\fldrslt {66}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Macros\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649161  }{\field{\*\fldinst { PAGEREF _Toc300649161 }}{\fldrslt {66}}}}}{
\par Random Numbers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649162  }{\field{\*\fldinst { PAGEREF _Toc300649162 }}{\fldrslt {67}}}}}{
\par Sorting\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649163  }{\field{\*\fldinst { PAGEREF _Toc300649163 }}{\fldrslt {67}}}}}{
\par Time\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649164  }{\field{\*\fldinst { PAGEREF _Toc300649164 }}{\fldrslt {67}}}}}{
\par Process ID\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649165  }{\field{\*\fldinst { PAGEREF _Toc300649165 }}{\fldrslt {67}}}}}{
\par Application Properties\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649166  }{\field{\*\fldinst { PAGEREF _Toc300649166 }}{\fldrslt {67}}}}}{
\par Debugging Macros\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649167  }{\field{\*\fldinst { PAGEREF _Toc300649167 }}{\fldrslt {68}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Portability Issues\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649168  }{\field{\*\fldinst { PAGEREF _Toc300649168 }}{\fldrslt {69}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Portable Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649169  }{\field{\*\fldinst { PAGEREF _Toc300649169 }}{\fldrslt {71}}}}}{
\par }\pard\plain \s65\li2160\ri720\sb240\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Integral Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649170  }{\field{\*\fldinst { PAGEREF _Toc300649170 }}{\fldrslt {71}}}}}{
\par Floating-point Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649171  }{\field{\*\fldinst { PAGEREF _Toc300649171 }}{\fldrslt {71}}}}}{
\par Pointer Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649172  }{\field{\*\fldinst { PAGEREF _Toc300649172 }}{\fldrslt {71}}}}}{
\par Avoiding Name Collisions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649173  }{\field{\*\fldinst { PAGEREF _Toc300649173 }}{\fldrslt {72}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Byte Order\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649174  }{\field{\*\fldinst { PAGEREF _Toc300649174 }}{\fldrslt {72}}}}}{
\par Function Prototypes\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649175  }{\field{\*\fldinst { PAGEREF _Toc300649175 }}{\fldrslt {72}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {AsnLib: ASN.1 Processing\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649176  }{\field{\*\fldinst { PAGEREF _Toc300649176 }}{\fldrslt {75}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction to ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649177  }{\field{\*\fldinst { PAGEREF _Toc300649177 }}{\fldrslt {75}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Why ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649178  }{\field{\*\fldinst { PAGEREF _Toc300649178 }}{\fldrslt {75}}}}}{
\par }\pard \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Structure of ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649179  }{\field{\*\fldinst { PAGEREF _Toc300649179 }}{\fldrslt {76}}}}}{
\par Further information about ASN.1\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649180  }{\field{\*\fldinst { PAGEREF _Toc300649180 }}{\fldrslt {79}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {AsnLib: Overview\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649181  }{\field{\*\fldinst { PAGEREF _Toc300649181 }}{\fldrslt {80}}}}}{
\par Principles of Operation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649182  }{\field{\*\fldinst { PAGEREF _Toc300649182 }}{\fldrslt {81}}}}}{
\par Specification for AsnLib\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649183  }{\field{\*\fldinst { PAGEREF _Toc300649183 }}{\fldrslt {82}}}}}{
\par AsnTool\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649184  }{\field{\*\fldinst { PAGEREF _Toc300649184 }}{\fldrslt {84}}}}}{
\par AsnTool Tutorial\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649185  }{\field{\*\fldinst { PAGEREF _Toc300649185 }}{\fldrslt {84}}}}}{
\par Using AsnLib\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649186  }{\field{\*\fldinst { PAGEREF _Toc300649186 }}{\fldrslt {86}}}}}{
\par AsnLib: A Tutorial\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649187  }{\field{\*\fldinst { PAGEREF _Toc300649187 }}{\fldrslt {87}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {getmesh.c\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649188  }{\field{\*\fldinst { PAGEREF _Toc300649188 }}{\fldrslt {87}}}}}{
\par indexpub.c\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649189  }{\field{\*\fldinst { PAGEREF _Toc300649189 }}{\fldrslt {89}}}}}{
\par getpub.c\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649190  }{\field{\*\fldinst { PAGEREF _Toc300649190 }}{\fldrslt {91}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Data-links\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649191  }{\field{\*\fldinst { PAGEREF _Toc300649191 }}{\fldrslt {93}}}}}{
\par AsnLib Generated Header Files\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649192  }{\field{\*\fldinst { PAGEREF _Toc300649192 }}{\fldrslt {94}}}}}{
\par Returns From AsnLib Parsing\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649193  }{\field{\*\fldinst { PAGEREF _Toc300649193 }}{\fldrslt {95}}}}}{
\par Finding AsnTypePtrs at Run-time\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649194  }{\field{\*\fldinst { PAGEREF _Toc300649194 }}{\fldrslt {96}}}}}{
\par Custom Read and Write Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649195  }{\field{\*\fldinst { PAGEREF _Toc300649195 }}{\fldrslt {96}}}}}{
\par Customizing an AsnIo Stream\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649196  }{\field{\*\fldinst { PAGEREF _Toc300649196 }}{\fldrslt {97}}}}}{
\par ASN.1 Object Loaders\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649197  }{\field{\*\fldinst { PAGEREF _Toc300649197 }}{\fldrslt {97}}}}}{
\par AsnLib and Object Loaders As a Generalized Iterator\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649198  }{\field{\*\fldinst { PAGEREF _Toc300649198 }}{\fldrslt {98}}}}}{
\par AsnLib and Object Loaders Provide a Generalized Copy and Compare\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649199  }{\field{\*\fldinst { PAGEREF _Toc300649199 }}{\fldrslt {100}}}}}{
\par AsnLib Interface: asn.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649200  }{\field{\*\fldinst { PAGEREF _Toc300649200 }}{\fldrslt {100}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {General Use Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649201  }{\field{\*\fldinst { PAGEREF _Toc300649201 }}{\fldrslt {109}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649202  }{\field{\*\fldinst { PAGEREF _Toc300649202 }}{\fldrslt {109}}}}}{
\par Large Text Blocks: StringStore\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649203  }{\field{\*\fldinst { PAGEREF _Toc300649203 }}{\fldrslt {109}}}}}{
\par The Date\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649204  }{\field{\*\fldinst { PAGEREF _Toc300649204 }}{\fldrslt {109}}}}}{
\par Identifying Things: Object-id\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649205  }{\field{\*\fldinst { PAGEREF _Toc300649205 }}{\fldrslt {110}}}}}{
\par Identifying Things: Dbtag\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649206  }{\field{\*\fldinst { PAGEREF _Toc300649206 }}{\fldrslt {110}}}}}{
\par Identifying People: Person-id\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649207  }{\field{\*\fldinst { PAGEREF _Toc300649207 }}{\fldrslt {110}}}}}{
\par Expressing Uncertainty with Fuzzy Integers: Int-fuzz\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649208  }{\field{\*\fldinst { PAGEREF _Toc300649208 }}{\fldrslt {111}}}}}{
\par Creating Your Own Objects: User-object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649209  }{\field{\*\fldinst { PAGEREF _Toc300649209 }}{\fldrslt {111}}}}}{
\par ASN.1 Specification: general.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649210  }{\field{\*\fldinst { PAGEREF _Toc300649210 }}{\fldrslt {112}}}}}{
\par C Structures and Functions: objgen.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649211  }{\field{\*\fldinst { PAGEREF _Toc300649211 }}{\fldrslt {114}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Bibliographic References\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649212  }{\field{\*\fldinst { PAGEREF _Toc300649212 }}{\fldrslt {119}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649213  }{\field{\*\fldinst { PAGEREF _Toc300649213 }}{\fldrslt {119}}}}}{
\par Citation Components: Affiliation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649214  }{\field{\*\fldinst { PAGEREF _Toc300649214 }}{\fldrslt {119}}}}}{
\par Citation Components: Authors\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649215  }{\field{\*\fldinst { PAGEREF _Toc300649215 }}{\fldrslt {119}}}}}{
\par Citation Components: Imprint\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649216  }{\field{\*\fldinst { PAGEREF _Toc300649216 }}{\fldrslt {120}}}}}{
\par Citation Components: Title\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649217  }{\field{\*\fldinst { PAGEREF _Toc300649217 }}{\fldrslt {120}}}}}{
\par Citing an Article\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649218  }{\field{\*\fldinst { PAGEREF _Toc300649218 }}{\fldrslt {121}}}}}{
\par Citing a Journal\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649219  }{\field{\*\fldinst { PAGEREF _Toc300649219 }}{\fldrslt {121}}}}}{
\par Citing a Book\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649220  }{\field{\*\fldinst { PAGEREF _Toc300649220 }}{\fldrslt {121}}}}}{
\par Citing a Proceedings\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649221  }{\field{\*\fldinst { PAGEREF _Toc300649221 }}{\fldrslt {121}}}}}{
\par Citing a Letter, Manuscript, or Thesis\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649222  }{\field{\*\fldinst { PAGEREF _Toc300649222 }}{\fldrslt {122}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Citing Directly Submitted Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649223  }{\field{\*\fldinst { PAGEREF _Toc300649223 }}{\fldrslt {122}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Citing a Patent\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649224  }{\field{\*\fldinst { PAGEREF _Toc300649224 }}{\fldrslt {122}}}}}{
\par Identifying a Patent\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649225  }{\field{\*\fldinst { PAGEREF _Toc300649225 }}{\fldrslt {122}}}}}{
\par Citing an Article or Book which is In Press\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649226  }{\field{\*\fldinst { PAGEREF _Toc300649226 }}{\fldrslt {123}}}}}{
\par Special Cases: Unpublished, Unparsed, or Unusual\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649227  }{\field{\*\fldinst { PAGEREF _Toc300649227 }}{\fldrslt {123}}}}}{
\par Accommodating Any Publication Type\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649228  }{\field{\*\fldinst { PAGEREF _Toc300649228 }}{\fldrslt {123}}}}}{
\par Grouping Different Forms of Citation for a Single Work\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649229  }{\field{\*\fldinst { PAGEREF _Toc300649229 }}{\fldrslt {124}}}}}{
\par Sets of Citations\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649230  }{\field{\*\fldinst { PAGEREF _Toc300649230 }}{\fldrslt {124}}}}}{
\par Comparing Citations\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649231  }{\field{\*\fldinst { PAGEREF _Toc300649231 }}{\fldrslt {124}}}}}{
\par ASN.1 Specification: biblio.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649232  }{\field{\*\fldinst { PAGEREF _Toc300649232 }}{\fldrslt {124}}}}}{
\par C Structures and Functions: objbibli.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649233  }{\field{\*\fldinst { PAGEREF _Toc300649233 }}{\fldrslt {127}}}}}{
\par ASN.1 Specification: pub.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649234  }{\field{\*\fldinst { PAGEREF _Toc300649234 }}{\fldrslt {132}}}}}{
\par C Structures and Functions: objpub.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649235  }{\field{\*\fldinst { PAGEREF _Toc300649235 }}{\fldrslt {133}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {MEDLINE Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649236  }{\field{\*\fldinst { PAGEREF _Toc300649236 }}{\fldrslt {137}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649237  }{\field{\*\fldinst { PAGEREF _Toc300649237 }}{\fldrslt {137}}}}}{
\par Structure of a MEDLINE Entry\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649238  }{\field{\*\fldinst { PAGEREF _Toc300649238 }}{\fldrslt {137}}}}}{
\par MeSH Index Terms\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649239  }{\field{\*\fldinst { PAGEREF _Toc300649239 }}{\fldrslt {137}}}}}{
\par Substance Records\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649240  }{\field{\*\fldinst { PAGEREF _Toc300649240 }}{\fldrslt {138}}}}}{
\par Database Cross Reference Records\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649241  }{\field{\*\fldinst { PAGEREF _Toc300649241 }}{\fldrslt {138}}}}}{
\par Funding Identifiers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649242  }{\field{\*\fldinst { PAGEREF _Toc300649242 }}{\fldrslt {138}}}}}{
\par Gene Symbols\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649243  }{\field{\*\fldinst { PAGEREF _Toc300649243 }}{\fldrslt {138}}}}}{
\par ASN.1 Specification: medline.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649244  }{\field{\*\fldinst { PAGEREF _Toc300649244 }}{\fldrslt {138}}}}}{
\par C Structures and Functions: objmedli.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649245  }{\field{\*\fldinst { PAGEREF _Toc300649245 }}{\fldrslt {139}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Biological Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649246  }{\field{\*\fldinst { PAGEREF _Toc300649246 }}{\fldrslt {143}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649247  }{\field{\*\fldinst { PAGEREF _Toc300649247 }}{\fldrslt {143}}}}}{
\par Bioseq: the Biological Sequence\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649248  }{\field{\*\fldinst { PAGEREF _Toc300649248 }}{\fldrslt {143}}}}}{
\par Seq-id: Identifying the Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649249  }{\field{\*\fldinst { PAGEREF _Toc300649249 }}{\fldrslt {143}}}}}{
\par Seq-annot: Annotating the Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649250  }{\field{\*\fldinst { PAGEREF _Toc300649250 }}{\fldrslt {144}}}}}{
\par Seq-descr: Describing the Bioseq and Placing It In Context\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649251  }{\field{\*\fldinst { PAGEREF _Toc300649251 }}{\fldrslt {144}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {mol-type: The Molecule Type\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649252  }{\field{\*\fldinst { PAGEREF _Toc300649252 }}{\fldrslt {145}}}}}{
\par modif: Modifying Our Assumptions About a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649253  }{\field{\*\fldinst { PAGEREF _Toc300649253 }}{\fldrslt {145}}}}}{
\par method: Protein Sequencing Method\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649254  }{\field{\*\fldinst { PAGEREF _Toc300649254 }}{\fldrslt {146}}}}}{
\par name: A Descriptive Name\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649255  }{\field{\*\fldinst { PAGEREF _Toc300649255 }}{\fldrslt {147}}}}}{
\par title: A Descriptive Title\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649256  }{\field{\*\fldinst { PAGEREF _Toc300649256 }}{\fldrslt {147}}}}}{
\par org: What Organism Did this Come From?\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649257  }{\field{\*\fldinst { PAGEREF _Toc300649257 }}{\fldrslt {148}}}}}{
\par comment: Commentary Text\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649258  }{\field{\*\fldinst { PAGEREF _Toc300649258 }}{\fldrslt {148}}}}}{
\par num: Applying a Numbering System to a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649259  }{\field{\*\fldinst { PAGEREF _Toc300649259 }}{\fldrslt {148}}}}}{
\par maploc: Map Location\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649260  }{\field{\*\fldinst { PAGEREF _Toc300649260 }}{\fldrslt {148}}}}}{
\par pir: PIR Specific Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649261  }{\field{\*\fldinst { PAGEREF _Toc300649261 }}{\fldrslt {149}}}}}{
\par sp: SWISSPROT Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649262  }{\field{\*\fldinst { PAGEREF _Toc300649262 }}{\fldrslt {149}}}}}{
\par embl: EMBL Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649263  }{\field{\*\fldinst { PAGEREF _Toc300649263 }}{\fldrslt {149}}}}}{
\par prf: PRF Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649264  }{\field{\*\fldinst { PAGEREF _Toc300649264 }}{\fldrslt {149}}}}}{
\par pdb: PDB Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649265  }{\field{\*\fldinst { PAGEREF _Toc300649265 }}{\fldrslt {149}}}}}{
\par genbank: GenBank Flatfile Specific Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649266  }{\field{\*\fldinst { PAGEREF _Toc300649266 }}{\fldrslt {149}}}}}{
\par pub: Description of a Publication\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649267  }{\field{\*\fldinst { PAGEREF _Toc300649267 }}{\fldrslt {149}}}}}{
\par }\pard \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {region: Name of a Genomic Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649268  }{\field{\*\fldinst { PAGEREF _Toc300649268 }}{\fldrslt {149}}}}}{
\par }\pard \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {user: A User-defined Structured Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649269  }{\field{\*\fldinst { PAGEREF _Toc300649269 }}{\fldrslt {149}}}}}{
\par neighbors: Bioseqs Related by Sequence Similarity\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649270  }{\field{\*\fldinst { PAGEREF _Toc300649270 }}{\fldrslt {149}}}}}{
\par create-date:\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649271  }{\field{\*\fldinst { PAGEREF _Toc300649271 }}{\fldrslt {150}}}}}{
\par update-date:\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649272  }{\field{\*\fldinst { PAGEREF _Toc300649272 }}{\fldrslt {150}}}}}{
\par het: Heterogen\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649273  }{\field{\*\fldinst { PAGEREF _Toc300649273 }}{\fldrslt {150}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Seq-inst: Instantiating the Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649274  }{\field{\*\fldinst { PAGEREF _Toc300649274 }}{\fldrslt {150}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Seq-inst: Virtual Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649275  }{\field{\*\fldinst { PAGEREF _Toc300649275 }}{\fldrslt {150}}}}}{
\par Seq-inst: Raw Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649276  }{\field{\*\fldinst { PAGEREF _Toc300649276 }}{\fldrslt {150}}}}}{
\par Seq-inst: Segmented Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649277  }{\field{\*\fldinst { PAGEREF _Toc300649277 }}{\fldrslt {150}}}}}{
\par Seq-inst: Reference Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649278  }{\field{\*\fldinst { PAGEREF _Toc300649278 }}{\fldrslt {151}}}}}{
\par Seq-inst: Constructed Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649279  }{\field{\*\fldinst { PAGEREF _Toc300649279 }}{\fldrslt {152}}}}}{
\par Seq-inst: Typical or Consensus Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649280  }{\field{\*\fldinst { PAGEREF _Toc300649280 }}{\fldrslt {153}}}}}{
\par Seq-inst: Map Bioseqs\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649281  }{\field{\*\fldinst { PAGEREF _Toc300649281 }}{\fldrslt {153}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Seq-hist: History of a Seq-inst\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649282  }{\field{\*\fldinst { PAGEREF _Toc300649282 }}{\fldrslt {154}}}}}{
\par Seq-data: Encoding the Sequence Data Itself\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649283  }{\field{\*\fldinst { PAGEREF _Toc300649283 }}{\fldrslt {155}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {IUPACaa: The IUPAC-IUB Encoding of Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649284  }{\field{\*\fldinst { PAGEREF _Toc300649284 }}{\fldrslt {155}}}}}{
\par NCBIeaa: Extended IUPAC Encoding of Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649285  }{\field{\*\fldinst { PAGEREF _Toc300649285 }}{\fldrslt {156}}}}}{
\par NCBIstdaa: A Simple Sequential Code for Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649286  }{\field{\*\fldinst { PAGEREF _Toc300649286 }}{\fldrslt {157}}}}}{
\par NCBI8aa: An Encoding for Modified Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649287  }{\field{\*\fldinst { PAGEREF _Toc300649287 }}{\fldrslt {158}}}}}{
\par IUPAC3aa: A 3 Letter Display Code for Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649288  }{\field{\*\fldinst { PAGEREF _Toc300649288 }}{\fldrslt {158}}}}}{
\par NCBIpaa: A Profile Style Encoding for Amino Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649289  }{\field{\*\fldinst { PAGEREF _Toc300649289 }}{\fldrslt {159}}}}}{
\par IUPACna: The IUPAC-IUB Encoding for Nucleic Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649290  }{\field{\*\fldinst { PAGEREF _Toc300649290 }}{\fldrslt {160}}}}}{
\par NCBI4na: A Four Bit Encoding of Nucleic Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649291  }{\field{\*\fldinst { PAGEREF _Toc300649291 }}{\fldrslt {160}}}}}{
\par NCBI2na: A Two Bit Encoding for Nucleic Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649292  }{\field{\*\fldinst { PAGEREF _Toc300649292 }}{\fldrslt {161}}}}}{
\par NCBI8na: An Eight Bit Sequential Encoding for Modified Nucleic Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649293  }{\field{\*\fldinst { PAGEREF _Toc300649293 }}{\fldrslt {161}}}}}{
\par NCBIpna: A Frequency Profile Encoding for Nucleic Acids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649294  }{\field{\*\fldinst { PAGEREF _Toc300649294 }}{\fldrslt {161}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Tables of Sequence Codes\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649295  }{\field{\*\fldinst { PAGEREF _Toc300649295 }}{\fldrslt {162}}}}}{
\par Mapping Between Different Sequence Alphabets\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649296  }{\field{\*\fldinst { PAGEREF _Toc300649296 }}{\fldrslt {162}}}}}{
\par Data and Tools for Sequence Alphabets\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649297  }{\field{\*\fldinst { PAGEREF _Toc300649297 }}{\fldrslt {163}}}}}{
\par Pubdesc: Publication Describing a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649298  }{\field{\*\fldinst { PAGEREF _Toc300649298 }}{\fldrslt {163}}}}}{
\par Numbering: Applying a Numbering System to a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649299  }{\field{\*\fldinst { PAGEREF _Toc300649299 }}{\fldrslt {163}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Num-cont: A Continuous Integer Numbering System\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649300  }{\field{\*\fldinst { PAGEREF _Toc300649300 }}{\fldrslt {164}}}}}{
\par Num-real: A Real Number Numbering Scheme\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649301  }{\field{\*\fldinst { PAGEREF _Toc300649301 }}{\fldrslt {164}}}}}{
\par Num-enum: An Enumerated Numbering Scheme\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649302  }{\field{\*\fldinst { PAGEREF _Toc300649302 }}{\fldrslt {164}}}}}{
\par Num-ref: Numbering by Reference to Another Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649303  }{\field{\*\fldinst { PAGEREF _Toc300649303 }}{\fldrslt {164}}}}}{
\par Numbering: C Structures and Utility Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649304  }{\field{\*\fldinst { PAGEREF _Toc300649304 }}{\fldrslt {165}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {ASN.1 Specification: seq.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649305  }{\field{\*\fldinst { PAGEREF _Toc300649305 }}{\fldrslt {165}}}}}{
\par ASN.1 Specification: seqblock.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649306  }{\field{\*\fldinst { PAGEREF _Toc300649306 }}{\fldrslt {169}}}}}{
\par ASN.1 Specification: seqcode.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649307  }{\field{\*\fldinst { PAGEREF _Toc300649307 }}{\fldrslt {172}}}}}{
\par C Structures and Functions: objseq.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649308  }{\field{\*\fldinst { PAGEREF _Toc300649308 }}{\fldrslt {173}}}}}{
\par C Structures and Functions: objpubd.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649309  }{\field{\*\fldinst { PAGEREF _Toc300649309 }}{\fldrslt {178}}}}}{
\par C Structures and Functions: objblock.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649310  }{\field{\*\fldinst { PAGEREF _Toc300649310 }}{\fldrslt {181}}}}}{
\par C Structures and Functions: objcode.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649311  }{\field{\*\fldinst { PAGEREF _Toc300649311 }}{\fldrslt {184}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Collections of Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649312  }{\field{\*\fldinst { PAGEREF _Toc300649312 }}{\fldrslt {187}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649313  }{\field{\*\fldinst { PAGEREF _Toc300649313 }}{\fldrslt {187}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Seq-entry: The Sequence Entry\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649314  }{\field{\*\fldinst { PAGEREF _Toc300649314 }}{\fldrslt {187}}}}}{
\par Bioseq-set: A Set Of Seq-entrys\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649315  }{\field{\*\fldinst { PAGEREF _Toc300649315 }}{\fldrslt {187}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {id: local identifier for this set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649316  }{\field{\*\fldinst { PAGEREF _Toc300649316 }}{\fldrslt {187}}}}}{
\par coll: global identifier for this set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649317  }{\field{\*\fldinst { PAGEREF _Toc300649317 }}{\fldrslt {187}}}}}{
\par level: nesting level of set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649318  }{\field{\*\fldinst { PAGEREF _Toc300649318 }}{\fldrslt {187}}}}}{
\par class: classification of sets\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649319  }{\field{\*\fldinst { PAGEREF _Toc300649319 }}{\fldrslt {188}}}}}{
\par release: an explanatory string\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649320  }{\field{\*\fldinst { PAGEREF _Toc300649320 }}{\fldrslt {188}}}}}{
\par date:\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649321  }{\field{\*\fldinst { PAGEREF _Toc300649321 }}{\fldrslt {188}}}}}{
\par descr: Seq-descr for this set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649322  }{\field{\*\fldinst { PAGEREF _Toc300649322 }}{\fldrslt {188}}}}}{
\par seq-set: the sequences and sets within the Bioseq-set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649323  }{\field{\*\fldinst { PAGEREF _Toc300649323 }}{\fldrslt {189}}}}}{
\par annot: Seq-annots for the set\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649324  }{\field{\*\fldinst { PAGEREF _Toc300649324 }}{\fldrslt {190}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Bioseq-sets are Convenient Packages\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649325  }{\field{\*\fldinst { PAGEREF _Toc300649325 }}{\fldrslt {190}}}}}{
\par ASN.1 Specification: seqset.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649326  }{\field{\*\fldinst { PAGEREF _Toc300649326 }}{\fldrslt {190}}}}}{
\par C Structures and Functions: objsset.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649327  }{\field{\*\fldinst { PAGEREF _Toc300649327 }}{\fldrslt {191}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Sequence Locations and Identifiers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649328  }{\field{\*\fldinst { PAGEREF _Toc300649328 }}{\fldrslt {195}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649329  }{\field{\*\fldinst { PAGEREF _Toc300649329 }}{\fldrslt {195}}}}}{
\par Seq-id: Identifying Sequences\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649330  }{\field{\*\fldinst { PAGEREF _Toc300649330 }}{\fldrslt {195}}}}}{
\par Seq-id: Semantics of Use\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649331  }{\field{\*\fldinst { PAGEREF _Toc300649331 }}{\fldrslt {196}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {local: Privately Maintained Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649332  }{\field{\*\fldinst { PAGEREF _Toc300649332 }}{\fldrslt {196}}}}}{
\par other: A Local Textseq-id\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649333  }{\field{\*\fldinst { PAGEREF _Toc300649333 }}{\fldrslt {196}}}}}{
\par general: Ids from Local Databases\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649334  }{\field{\*\fldinst { PAGEREF _Toc300649334 }}{\fldrslt {196}}}}}{
\par gibbsq, gibbmt: GenInfo Backbone Ids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649335  }{\field{\*\fldinst { PAGEREF _Toc300649335 }}{\fldrslt {197}}}}}{
\par genbank, embl, ddbj: The International Nucleic Acid Sequence Databases\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649336  }{\field{\*\fldinst { PAGEREF _Toc300649336 }}{\fldrslt {197}}}}}{
\par pir: PIR International\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649337  }{\field{\*\fldinst { PAGEREF _Toc300649337 }}{\fldrslt {198}}}}}{
\par swissprot: SWISS-PROT\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649338  }{\field{\*\fldinst { PAGEREF _Toc300649338 }}{\fldrslt {198}}}}}{
\par prf: Protein Research Foundation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649339  }{\field{\*\fldinst { PAGEREF _Toc300649339 }}{\fldrslt {198}}}}}{
\par patent: Citing a Patent\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649340  }{\field{\*\fldinst { PAGEREF _Toc300649340 }}{\fldrslt {199}}}}}{
\par pdb: Citing a Biopolymer Chain from a Structure Database\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649341  }{\field{\*\fldinst { PAGEREF _Toc300649341 }}{\fldrslt {199}}}}}{
\par giim: GenInfo Import Id\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649342  }{\field{\*\fldinst { PAGEREF _Toc300649342 }}{\fldrslt {199}}}}}{
\par gi: A Stable, Uniform Id Applied to Sequences From All Sources\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649343  }{\field{\*\fldinst { PAGEREF _Toc300649343 }}{\fldrslt {199}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Seq-id: The C Implementation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649344  }{\field{\*\fldinst { PAGEREF _Toc300649344 }}{\fldrslt {199}}}}}{
\par NCBI ID Database: Imposing Stable Seq-ids\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649345  }{\field{\*\fldinst { PAGEREF _Toc300649345 }}{\fldrslt {200}}}}}{
\par Seq-loc: Locations on a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649346  }{\field{\*\fldinst { PAGEREF _Toc300649346 }}{\fldrslt {201}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {null: A Gap\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649347  }{\field{\*\fldinst { PAGEREF _Toc300649347 }}{\fldrslt {201}}}}}{
\par empty: A Gap in an Alignment\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649348  }{\field{\*\fldinst { PAGEREF _Toc300649348 }}{\fldrslt {201}}}}}{
\par whole: A Reference to a Whole Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649349  }{\field{\*\fldinst { PAGEREF _Toc300649349 }}{\fldrslt {202}}}}}{
\par int: An Interval on a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649350  }{\field{\*\fldinst { PAGEREF _Toc300649350 }}{\fldrslt {202}}}}}{
\par packed-int: A Series of Intervals\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649351  }{\field{\*\fldinst { PAGEREF _Toc300649351 }}{\fldrslt {202}}}}}{
\par pnt: A Single Point on a Sequence\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649352  }{\field{\*\fldinst { PAGEREF _Toc300649352 }}{\fldrslt {202}}}}}{
\par packed-pnt: A Collection of Points\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649353  }{\field{\*\fldinst { PAGEREF _Toc300649353 }}{\fldrslt {202}}}}}{
\par mix: An Arbitrarily Complex Location\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649354  }{\field{\*\fldinst { PAGEREF _Toc300649354 }}{\fldrslt {203}}}}}{
\par equiv: Equivalent Locations\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649355  }{\field{\*\fldinst { PAGEREF _Toc300649355 }}{\fldrslt {203}}}}}{
\par bond: A Chemical Bond Between Two Residues\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649356  }{\field{\*\fldinst { PAGEREF _Toc300649356 }}{\fldrslt {203}}}}}{
\par feat: A Location Indirectly Referenced Through A Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649357  }{\field{\*\fldinst { PAGEREF _Toc300649357 }}{\fldrslt {203}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Seq-loc: The C Implementation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649358  }{\field{\*\fldinst { PAGEREF _Toc300649358 }}{\fldrslt {203}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {ASN.1 Specification: seqloc.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649359  }{\field{\*\fldinst { PAGEREF _Toc300649359 }}{\fldrslt {204}}}}}{
\par C Structures and Functions: objloc.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649360  }{\field{\*\fldinst { PAGEREF _Toc300649360 }}{\fldrslt {206}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Sequence Features\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649361  }{\field{\*\fldinst { PAGEREF _Toc300649361 }}{\fldrslt {213}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649362  }{\field{\*\fldinst { PAGEREF _Toc300649362 }}{\fldrslt {213}}}}}{
\par Seq-feat: Structure of a Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649363  }{\field{\*\fldinst { PAGEREF _Toc300649363 }}{\fldrslt {213}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {id: Features Can Have Identifiers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649364  }{\field{\*\fldinst { PAGEREF _Toc300649364 }}{\fldrslt {213}}}}}{
\par data: Structured Data Makes Feature Types Unique\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649365  }{\field{\*\fldinst { PAGEREF _Toc300649365 }}{\fldrslt {213}}}}}{
\par partial: This Feature is Incomplete\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649366  }{\field{\*\fldinst { PAGEREF _Toc300649366 }}{\fldrslt {214}}}}}{
\par except: There is Something Biologically Exceptional\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649367  }{\field{\*\fldinst { PAGEREF _Toc300649367 }}{\fldrslt {214}}}}}{
\par comment: A Comment About This Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649368  }{\field{\*\fldinst { PAGEREF _Toc300649368 }}{\fldrslt {214}}}}}{
\par product: Does This Feature Produce Another Bioseq?\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649369  }{\field{\*\fldinst { PAGEREF _Toc300649369 }}{\fldrslt {215}}}}}{
\par location: Source Location of This Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649370  }{\field{\*\fldinst { PAGEREF _Toc300649370 }}{\fldrslt {215}}}}}{
\par qual: GenBank Style Qualifiers\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649371  }{\field{\*\fldinst { PAGEREF _Toc300649371 }}{\fldrslt {215}}}}}{
\par title: A User Defined Name\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649372  }{\field{\*\fldinst { PAGEREF _Toc300649372 }}{\fldrslt {215}}}}}{
\par ext: A User Defined Structured Extension\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649373  }{\field{\*\fldinst { PAGEREF _Toc300649373 }}{\fldrslt {215}}}}}{
\par cit: Citations For This Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649374  }{\field{\*\fldinst { PAGEREF _Toc300649374 }}{\fldrslt {216}}}}}{
\par exp-ev: Experimental Evidence\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649375  }{\field{\*\fldinst { PAGEREF _Toc300649375 }}{\fldrslt {216}}}}}{
\par xref: Linking To Other Features\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649376  }{\field{\*\fldinst { PAGEREF _Toc300649376 }}{\fldrslt {216}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {SeqFeatData: Type Specific Feature Data\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649377  }{\field{\*\fldinst { PAGEREF _Toc300649377 }}{\fldrslt {216}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {gene: Location Of A Gene\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649378  }{\field{\*\fldinst { PAGEREF _Toc300649378 }}{\fldrslt {216}}}}}{
\par org: Source Organism Of The Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649379  }{\field{\*\fldinst { PAGEREF _Toc300649379 }}{\fldrslt {217}}}}}{
\par cdregion: Coding Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649380  }{\field{\*\fldinst { PAGEREF _Toc300649380 }}{\fldrslt {217}}}}}{
\par prot: Describing A Protein\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649381  }{\field{\*\fldinst { PAGEREF _Toc300649381 }}{\fldrslt {217}}}}}{
\par rna: Describing An RNA\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649382  }{\field{\*\fldinst { PAGEREF _Toc300649382 }}{\fldrslt {217}}}}}{
\par pub: Publication About A Bioseq Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649383  }{\field{\*\fldinst { PAGEREF _Toc300649383 }}{\fldrslt {218}}}}}{
\par seq: Tracking Original Sequence Sources\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649384  }{\field{\*\fldinst { PAGEREF _Toc300649384 }}{\fldrslt {218}}}}}{
\par imp: Importing Features From Other Data Models\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649385  }{\field{\*\fldinst { PAGEREF _Toc300649385 }}{\fldrslt {218}}}}}{
\par region: A Named Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649386  }{\field{\*\fldinst { PAGEREF _Toc300649386 }}{\fldrslt {218}}}}}{
\par comment: A Comment On A Region Of Sequence\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649387  }{\field{\*\fldinst { PAGEREF _Toc300649387 }}{\fldrslt {219}}}}}{
\par bond: A Bond Between Residues\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649388  }{\field{\*\fldinst { PAGEREF _Toc300649388 }}{\fldrslt {219}}}}}{
\par site: A Defined Site\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649389  }{\field{\*\fldinst { PAGEREF _Toc300649389 }}{\fldrslt {219}}}}}{
\par rsite: A Restriction Enzyme Cut Site\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649390  }{\field{\*\fldinst { PAGEREF _Toc300649390 }}{\fldrslt {219}}}}}{
\par user: A User Defined Feature\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649391  }{\field{\*\fldinst { PAGEREF _Toc300649391 }}{\fldrslt {220}}}}}{
\par txinit: Transcription Initiation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649392  }{\field{\*\fldinst { PAGEREF _Toc300649392 }}{\fldrslt {220}}}}}{
\par num: Applying Custom Numbering To A Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649393  }{\field{\*\fldinst { PAGEREF _Toc300649393 }}{\fldrslt {220}}}}}{
\par psec-str: Protein Secondary Structure\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649394  }{\field{\*\fldinst { PAGEREF _Toc300649394 }}{\fldrslt {220}}}}}{
\par non-std-residue: Unusual Residues\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649395  }{\field{\*\fldinst { PAGEREF _Toc300649395 }}{\fldrslt {220}}}}}{
\par het: Heterogen\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649396  }{\field{\*\fldinst { PAGEREF _Toc300649396 }}{\fldrslt {220}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Seq-feat Implementation in C\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649397  }{\field{\*\fldinst { PAGEREF _Toc300649397 }}{\fldrslt {221}}}}}{
\par CdRegion: Coding Region\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649398  }{\field{\*\fldinst { PAGEREF _Toc300649398 }}{\fldrslt {222}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {orf: Open Reading Frame\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649399  }{\field{\*\fldinst { PAGEREF _Toc300649399 }}{\fldrslt {222}}}}}{
\par Translation Information\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649400  }{\field{\*\fldinst { PAGEREF _Toc300649400 }}{\fldrslt {222}}}}}{
\par Problems With Translations\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649401  }{\field{\*\fldinst { PAGEREF _Toc300649401 }}{\fldrslt {222}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Genetic Codes\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649402  }{\field{\*\fldinst { PAGEREF _Toc300649402 }}{\fldrslt {223}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {C Implementation Of Genetic Codes\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649403  }{\field{\*\fldinst { PAGEREF _Toc300649403 }}{\fldrslt {223}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Rsite-ref: Reference To A Restriction Enzyme\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649404  }{\field{\*\fldinst { PAGEREF _Toc300649404 }}{\fldrslt {224}}}}}{
\par RNA-ref: Reference To An RNA\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649405  }{\field{\*\fldinst { PAGEREF _Toc300649405 }}{\fldrslt {224}}}}}{
\par Gene-ref: Reference To A Gene\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649406  }{\field{\*\fldinst { PAGEREF _Toc300649406 }}{\fldrslt {225}}}}}{
\par Prot-ref: Reference To A Protein\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649407  }{\field{\*\fldinst { PAGEREF _Toc300649407 }}{\fldrslt {225}}}}}{
\par Txinit: Transcription Initiation\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649408  }{\field{\*\fldinst { PAGEREF _Toc300649408 }}{\fldrslt {226}}}}}{
\par Current Genetic Code Table: gc.prt\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649409  }{\field{\*\fldinst { PAGEREF _Toc300649409 }}{\fldrslt {226}}}}}{
\par ASN.1 Specification: seqfeat.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649410  }{\field{\*\fldinst { PAGEREF _Toc300649410 }}{\fldrslt {228}}}}}{
\par C Structures and Functions: objfeat.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649411  }{\field{\*\fldinst { PAGEREF _Toc300649411 }}{\fldrslt {234}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Sequence Alignments\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649412  }{\field{\*\fldinst { PAGEREF _Toc300649412 }}{\fldrslt {243}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649413  }{\field{\*\fldinst { PAGEREF _Toc300649413 }}{\fldrslt {243}}}}}{
\par Seq-align\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649414  }{\field{\*\fldinst { PAGEREF _Toc300649414 }}{\fldrslt {243}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {type: global\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649415  }{\field{\*\fldinst { PAGEREF _Toc300649415 }}{\fldrslt {244}}}}}{
\par type: partial\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649416  }{\field{\*\fldinst { PAGEREF _Toc300649416 }}{\fldrslt {244}}}}}{
\par type: diags\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649417  }{\field{\*\fldinst { PAGEREF _Toc300649417 }}{\fldrslt {244}}}}}{
\par dim: Dimensionality Of The Alignment\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649418  }{\field{\*\fldinst { PAGEREF _Toc300649418 }}{\fldrslt {244}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Score: Score Of An Alignment Or Segment\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649419  }{\field{\*\fldinst { PAGEREF _Toc300649419 }}{\fldrslt {245}}}}}{
\par Dense-diag: Segments For "diags" Seq-align\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649420  }{\field{\*\fldinst { PAGEREF _Toc300649420 }}{\fldrslt {245}}}}}{
\par Dense-seg: Segments for "global" or "partial" Seq-align\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649421  }{\field{\*\fldinst { PAGEREF _Toc300649421 }}{\fldrslt {245}}}}}{
\par Std-seg: Aligning Any Bioseq Type With Any Other\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649422  }{\field{\*\fldinst { PAGEREF _Toc300649422 }}{\fldrslt {246}}}}}{
\par ASN.1 Specification: seqalign.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649423  }{\field{\*\fldinst { PAGEREF _Toc300649423 }}{\fldrslt {248}}}}}{
\par C Structures and Functions: objalign.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649424  }{\field{\*\fldinst { PAGEREF _Toc300649424 }}{\fldrslt {249}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Sequence Graphs\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649425  }{\field{\*\fldinst { PAGEREF _Toc300649425 }}{\fldrslt {253}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649426  }{\field{\*\fldinst { PAGEREF _Toc300649426 }}{\fldrslt {253}}}}}{
\par Seq-graph: Graph on a Bioseq\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649427  }{\field{\*\fldinst { PAGEREF _Toc300649427 }}{\fldrslt {253}}}}}{
\par ASN.1 Specification: seqres.asn\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649428  }{\field{\*\fldinst { PAGEREF _Toc300649428 }}{\fldrslt {253}}}}}{
\par C Structures and Functions: objres.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649429  }{\field{\*\fldinst { PAGEREF _Toc300649429 }}{\fldrslt {254}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Sequence Utilities\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649430  }{\field{\*\fldinst { PAGEREF _Toc300649430 }}{\fldrslt {257}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649431  }{\field{\*\fldinst { PAGEREF _Toc300649431 }}{\fldrslt {257}}}}}{
\par Demo: seqtest.c\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649432  }{\field{\*\fldinst { PAGEREF _Toc300649432 }}{\fldrslt {257}}}}}{
\par Finding Features and Descriptors in an Entry\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649433  }{\field{\*\fldinst { PAGEREF _Toc300649433 }}{\fldrslt {262}}}}}{
\par Exploring an Object Using ASN.1 Defined Names\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649434  }{\field{\*\fldinst { PAGEREF _Toc300649434 }}{\fldrslt {263}}}}}{
\par C Structures and Functions: sequtil.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649435  }{\field{\*\fldinst { PAGEREF _Toc300649435 }}{\fldrslt {264}}}}}{
\par C Structures and Functions: seqport.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649436  }{\field{\*\fldinst { PAGEREF _Toc300649436 }}{\fldrslt {269}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Entrez Data Access\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649437  }{\field{\*\fldinst { PAGEREF _Toc300649437 }}{\fldrslt {271}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649438  }{\field{\*\fldinst { PAGEREF _Toc300649438 }}{\fldrslt {271}}}}}{
\par Connecting To and Disconnecting From Data Sources\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649439  }{\field{\*\fldinst { PAGEREF _Toc300649439 }}{\fldrslt {271}}}}}{
\par Scanning the List of Available Terms\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649440  }{\field{\*\fldinst { PAGEREF _Toc300649440 }}{\fldrslt {272}}}}}{
\par Obtaining the UID Given an Accession Number\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649441  }{\field{\*\fldinst { PAGEREF _Toc300649441 }}{\fldrslt {272}}}}}{
\par Obtaining the UIDs That Satisfy a Boolean Query\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649442  }{\field{\*\fldinst { PAGEREF _Toc300649442 }}{\fldrslt {273}}}}}{
\par Loading a Sequence Record\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649443  }{\field{\*\fldinst { PAGEREF _Toc300649443 }}{\fldrslt {274}}}}}{
\par Loading a MEDLINE Record\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649444  }{\field{\*\fldinst { PAGEREF _Toc300649444 }}{\fldrslt {275}}}}}{
\par Streaming Through All of the Data Records\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649445  }{\field{\*\fldinst { PAGEREF _Toc300649445 }}{\fldrslt {275}}}}}{
\par Converting to FASTA Format\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649446  }{\field{\*\fldinst { PAGEREF _Toc300649446 }}{\fldrslt {276}}}}}{
\par Converting GenBank Format\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649447  }{\field{\*\fldinst { PAGEREF _Toc300649447 }}{\fldrslt {276}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Converting to MEDLARS Format\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649448  }{\field{\*\fldinst { PAGEREF _Toc300649448 }}{\fldrslt {277}}}}}{
\par }\pard \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright {Loading a Document Summary\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649449  }{\field{\*\fldinst { PAGEREF _Toc300649449 }}{\fldrslt {277}}}}}{
\par Loading a Set of Document Summaries\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649450  }{\field{\*\fldinst { PAGEREF _Toc300649450 }}{\fldrslt {277}}}}}{
\par Retreiving Neighbors and Links\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649451  }{\field{\*\fldinst { PAGEREF _Toc300649451 }}{\fldrslt {277}}}}}{
\par C Structures and Functions: accentr.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649452  }{\field{\*\fldinst { PAGEREF _Toc300649452 }}{\fldrslt {278}}}}}{
\par C Structures and Functions: casn.h\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649453  }{\field{\*\fldinst { PAGEREF _Toc300649453 }}{\fldrslt {282}}}}}{
\par }\pard\plain \s18\ri720\sb120\keepn\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \b\f16\fs20\cgrid {Vibrant User Interface Tools\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649454  }{\field{\*\fldinst { PAGEREF _Toc300649454 }}{\fldrslt {285}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Introduction\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649455  }{\field{\*\fldinst { PAGEREF _Toc300649455 }}{\fldrslt {285}}}}}{
\par Programming Example\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649456  }{\field{\*\fldinst { PAGEREF _Toc300649456 }}{\fldrslt {287}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Object Specification\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649457  }{\field{\*\fldinst { PAGEREF _Toc300649457 }}{\fldrslt {288}}}}}{
\par Callback Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649458  }{\field{\*\fldinst { PAGEREF _Toc300649458 }}{\fldrslt {291}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Reference\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649459  }{\field{\*\fldinst { PAGEREF _Toc300649459 }}{\fldrslt {294}}}}}{
\par }\pard\plain \s16\li1440\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs18\cgrid {Object Data Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649460  }{\field{\*\fldinst { PAGEREF _Toc300649460 }}{\fldrslt {295}}}}}{
\par Callback Types\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649461  }{\field{\*\fldinst { PAGEREF _Toc300649461 }}{\fldrslt {296}}}}}{
\par General Global Variables\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649462  }{\field{\*\fldinst { PAGEREF _Toc300649462 }}{\fldrslt {296}}}}}{
\par Window Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649463  }{\field{\*\fldinst { PAGEREF _Toc300649463 }}{\fldrslt {297}}}}}{
\par Context Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649464  }{\field{\*\fldinst { PAGEREF _Toc300649464 }}{\fldrslt {297}}}}}{
\par Grouping Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649465  }{\field{\*\fldinst { PAGEREF _Toc300649465 }}{\fldrslt {297}}}}}{
\par Button Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649466  }{\field{\*\fldinst { PAGEREF _Toc300649466 }}{\fldrslt {298}}}}}{
\par List Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649467  }{\field{\*\fldinst { PAGEREF _Toc300649467 }}{\fldrslt {298}}}}}{
\par Menu Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649468  }{\field{\*\fldinst { PAGEREF _Toc300649468 }}{\fldrslt {298}}}}}{
\par Popup Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649469  }{\field{\*\fldinst { PAGEREF _Toc300649469 }}{\fldrslt {299}}}}}{
\par Prompt Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649470  }{\field{\*\fldinst { PAGEREF _Toc300649470 }}{\fldrslt {299}}}}}{
\par Text Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649471  }{\field{\*\fldinst { PAGEREF _Toc300649471 }}{\fldrslt {299}}}}}{
\par Scroll Bar Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649472  }{\field{\*\fldinst { PAGEREF _Toc300649472 }}{\fldrslt {300}}}}}{
\par Slate and Panel Objects\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649473  }{\field{\*\fldinst { PAGEREF _Toc300649473 }}{\fldrslt {301}}}}}{
\par Repeat Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649474  }{\field{\*\fldinst { PAGEREF _Toc300649474 }}{\fldrslt {302}}}}}{
\par Switch Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649475  }{\field{\*\fldinst { PAGEREF _Toc300649475 }}{\fldrslt {302}}}}}{
\par Icon Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649476  }{\field{\*\fldinst { PAGEREF _Toc300649476 }}{\fldrslt {302}}}}}{
\par Graphical Viewer Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649477  }{\field{\*\fldinst { PAGEREF _Toc300649477 }}{\fldrslt {303}}}}}{
\par Doc Object\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649478  }{\field{\*\fldinst { PAGEREF _Toc300649478 }}{\fldrslt {305}}}}}{
\par Class Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649479  }{\field{\*\fldinst { PAGEREF _Toc300649479 }}{\fldrslt {305}}}}}{
\par Miscellaneous Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649480  }{\field{\*\fldinst { PAGEREF _Toc300649480 }}{\fldrslt {306}}}}}{
\par Graphical Drawing Functions\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649481  }{\field{\*\fldinst { PAGEREF _Toc300649481 }}{\fldrslt {307}}}}}{
\par }\pard\plain \s17\li720\ri720\widctlpar\tldot\tx8280\tqr\tx8640\adjustright \f16\fs20\cgrid {Index\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649482  }{\field{\*\fldinst { PAGEREF _Toc300649482 }}{\fldrslt {311}}}}}{
\par Acknowledgments\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649483  }{\field{\*\fldinst { PAGEREF _Toc300649483 }}{\fldrslt {316}}}}}{
\par Trademarks\tab }{\field\flddirty{\*\fldinst { GOTOBUTTON _Toc300649484  }{\field{\*\fldinst { PAGEREF _Toc300649484 }}{\fldrslt {317}}}}}{
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl \pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include overview.doc}}{\fldrslt {{\*\bkmkstart _Toc294430694}{\*\bkmkstart _Toc300649090}Overview{\*\bkmkend _Toc294430694}{\*\bkmkend _Toc300649090}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430695}{\*\bkmkstart _Toc300649091}Introduction{\*\bkmkend _Toc294430695}{\*\bkmkend _Toc300649091}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Molecular biology is generating a host of data which are dramatically altering and deeping our understanding of the processes which underlie all living things. This new knowledge is already affecting medicine, agriculture, biotechnology, and basic science in fundamental and sweeping ways. However, the data on which our growing understanding is based is being accumulated and analyzed in thousands of laboratories all over the world, from large genome centers to small university laboratories, from large pharmacutical companies to small biotech startups. It is being managed and analyzed on machines from small personal computers to supercomputers, on systems from a few disk files to large commercial database systems. These essential new data require specialized tools for analysis and management, so software tools are being developed in all these different environments at once.  Since molecular biology is an infant science, the data itself is not yet fully understood, so its fundamental properties and relationships are constantly being revised as well. Finally, the raw volume of molecular biology data is growing at an astonishing rate.
\par In recognition of the essential and growing role of bioinformatics in the United States, the National Center for Biotechnology Information (NCBI) was created by act of Congress in November 1988. This law mandates that NCBI shall:
\par }\pard \widctlpar\adjustright {
\par }\pard \fi-432\li432\widctlpar\adjustright {1) Create automated systems for knowledge about molecular biology, biochemistry, and genetics.
\par 2) Perform research into advanced methods of analyzing and interpreting molecular biology data.
\par 3) Enable biotechnology researchers and medical care personnel to use the systems and methods developed.
\par 4) Coordinate efforts to gather biotechnology information worldwide.
\par }\pard \sb240\widctlpar\adjustright {To approach these goals, NCBI has been organized into three interoperating branches. The Basic Research Branch (BRB) is a group of scientists who perform research into algorithms and methods for analyzing molecular biology data and publish results in peer reviewed journals, and keeps the other branches abreast of the latest developments from a scientific perspective. The Information Resources Branch (IRB) maintains the infrastructure at NCBI, administers the distribution of data and services provided by NCBI to the community, supports a visiting scientist program to enable researchers to spend time working at NCBI, and interacts with other agencies and bodies. The Information Engineering Branch (IEB) designs and builds databases and software tools for molecular biology information which attempt to incorporate the new approaches and meet the needs of the BRB, while producing data and software tools which are released to the community on a production basis by the IRB.
\par This document describes the data model and software tools developed by the IEB to achieve their mission. The IEB approaches its task with an understanding of the situation outlined in the first paragraph, that molecular biology data comes from and is used in an extremely hetergenous, distributed, and changing environment, from both computing and biological points of view. The data processed and integrated by IEB will come from many different sources which may use different models of the data, which can be expected to change over time. The data will be stored and managed on many different computer systems using many different database management systems. The data itself is expected to be valuable for longer than the life cycle of any particular computer system or program. This means that the data must be described in a controlled and formal way, so that all participants can clearly understand what data components are available in common at any time, but without dependence on any particular software tool or language, database managment system, or hardware architecture.
\par Software developed by IEB must be capable of running on all major hardware platforms used in the scientific community and must be designed to be ported to new systems as the computer industry progresses. It must be capable of providing systems for data retrieval by end-user scientists while also providing software hooks for other programs written by bioinformatics specialists in commercial, academic, or government settings, and by academic researchers.
\par To achieve the goal of a formal, controlled, yet flexible data specification, IEB has adopted the use of Abstract Syntax Notation 1 (ASN.1), and International Standards Organization standard (ISO 8824, 8825) for describing and encoding data in a machine readable way which is independent of hardware or software architecture and language. IEB has created a formal specification in ASN.1 for biotechnology and bibliographic information. This specification is based on a data model which unifies sequence related data from bands on a gel to genetic maps to sequenced nucleic acid and protein molecules. It provides connections from such data to other specialized datasets such as stock center lists, taxonomies, or structures. The specification is done as a series of connected modules. This means selected modules can be reused by other biotechnology databases and new ones added to meet specialized needs. The ASN.1 specification and encoding provide an essential common ground, changing the many to many mapping between the various information sources and applications to a many to one mapping, both for data models and for software interfaces.
\par To achieve the goals of software portability and of providing different levels of access from database producer to programmer to end-user, IEB has developed a layered software toolkit. The toolkit is used internally at NCBI to process and analyze data from a variety of sources to build and maintain the unified databases and also serves as the components for the end-user applications NCBI distributes. This means it is subjected to the continuous demands for quality and perfomance imposed by a large, production operation in the course of our daily work. The source code for the toolkit is made available without restriction for use by anyone wishing to take advantage of the work done by NCBI. The software runs on a wide variety of common platforms and is layered to allow programmers use both very low level or very high level tools to access and manipulate data.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430696}{\*\bkmkstart _Toc300649092}Components Of The Software Development ToolKit{\*\bkmkend _Toc294430696}{\*\bkmkend _Toc300649092}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430697}{\*\bkmkstart _Toc300649093}ASN.1{\*\bkmkend _Toc294430697}{\*\bkmkend _Toc300649093}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A brief introduction is provided to the ASN.1 language itself in the beginning of the AsnLib chapter. Those familiar with Backus-Naur form should have no trouble reading it immediately, while a short explanation may be required for others. It is a simple, logical way to specify data and is used for many purposes in the computer industry to describe and exchange data. A number of books, articles, and software tools from the computer industry at large are readily available for those who wish a more in-depth knowledge of ASN.1. This is an important aspect of choosing the ASN.1 language to describe biological data. ASN.1 is a formal data description language, developed, tested, and used within the computer industry, not an ad hoc file format developed by biologists. Would you program in an ad hoc programming language developed by biologists? Then why describe data that way?
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430698}{\*\bkmkstart _Toc300649094}Data Model For Biological Sequences{\*\bkmkend _Toc294430698}{\*\bkmkend _Toc300649094}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The selection of a data description language does not define what it is used for any more than the selection of English defines what a book is about. The IEB has defined a model for biotechnology information (which happens to be specified in ASN.1) which is centered around the concept of a biological sequence as a simple, linear coordinate system. Genetic and physical maps, sequenced pieces of nucleic acids and proteins, and complex assemblies of such components can all be considered specializations of the basic sequence concept of an identified coordinate system. Relationships between sequences (e.g. sequence alignments, sequence assemblies, relationships of genetic to physical maps) can all be considered mappings from one sequencecoordinate system to another. Information about sequences can be considered mappings of specialized data objects (e.g. publications, genes, coding regions) to any sequence coordinate system. Such specialzed data objects may themselves contain keys to other databases containing more specialized information not necessarily captured by the common data model, but unique to a particular organism, discipline, or database.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430699}{\*\bkmkstart _Toc300649095}CoreLib: Writing Portable Software{\*\bkmkend _Toc294430699}{\*\bkmkend _Toc300649095}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The CoreLib is a small set of "C' language functions, macros, and guidelines that permit the writing of programs which compile and execute without change on over fourteen different hardware/operating system/compiler combinations. If one wishes to distribute one's code to as many molecular biolgists as possible with as little work as possible, learning to write CoreLib style code is a tremendous advantage. If one wishes to write on one platform, but interface with NCBI software, one should still understand the CoreLib approach (read the introduction in the CoreLib chapter), but it does not require that one write CoreLib code oneself.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430700}{\*\bkmkstart _Toc300649096}AsnLib: Reading and Writing ASN.1{\*\bkmkend _Toc294430700}{\*\bkmkend _Toc300649096}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {AsnLib is a function library written with CoreLib, which provides functions for reading and validating ASN.1 specifications and generating parse trees to encoded and decode data conforming to the specification. The parse trees can be generating dynamically at run-time from any input specification, or parse trees for particular specifications can be produced as "C" language header files to be incorporated into applications. Given a parse tree generated either way, AsnLib provides low level functions for encoding and decoding data in either the text or binary forms of ASN.1, one element at a time. Converters to other languages (ASN.1 to Prolog or ASN.1 to LISP have been done), filters (get all journal titles from an ASN.1 encoded stream of bibliographic citations), or indexing programs (index a file of ASN.1 encoded bibliographic citations on author name) can be written with tools at this level.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430701}{\*\bkmkstart _Toc300649097}Object Loaders: Combining AsnLib and the Data Model{\*\bkmkend _Toc294430701}{\*\bkmkend _Toc300649097}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Every ASN.1 specification module in the NCBI data model has a corressponding "object loader" module. This is a "C" language ".c" and ".h" file which typedef a "C" structure for every entity defined in ASN.1 (called an "object" here). For each object there is a function to create it, read it from an ASN.1 stream, write it to an ASN.1 stream, and free it. These take the form of [AsnName]New(), [AsnName]AsnRead(), [AsnName]AsnWrite(), and [AsnName]Free(). If an "object" is considered data associated with methods, these routines define the structure of the data (as mapped from ASN.1) and define routines to load such objects in and out of memory from ASN.1.
\par In some cases additional functions such as compare, duplicate, find, or print are defined here as well. The Data Access layer returns pointers to these structures and the Utilities layer provides more routines to compare, explore, manipulate, and display these structures. Using the object loader layer incorporates a great deal of NCBI code into your application, but most programmers find this the easiest level to access NCBI data for complex objects such as whole sequence entries.
\par In the following document detailed discussion of an ASN.1 module and its corressponding object loader are combined together in a single chapter. The chapters are organized by grouping closely related objects together. The discussion in each chapter focusses on particular issues surrounding the implementation of that data type but may not mention every function. The complete ASN.1 specification and object loader ".h" files follow at the end of each such chapter for the comprehensive and definitive specification.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430702}{\*\bkmkstart _Toc300649098}Utilities{\*\bkmkend _Toc294430702}{\*\bkmkend _Toc300649098}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A growing number of utility functions have been written that manipulate or analyze the structures defined in the object loaders. For example, one function compares two (arbitrarily complex) locations on sequences and determines if they overlap or if one is contained in the other. Another opens a "port" on any (arbitrarily complex) sequence or part(s) of a sequence(s) and treat it as a single single sequence, in any selected sequence alphabet, with operations provided such as "seek to location", "get next residue", "read x residues into a buffer", and so on. A whole family of functions allow the exploration of any arbitrarily complex structure in memory with a call to a user supplied function when encountering any structure based on it's ASN.1 name (e.g. find all coding region features, or find all publications, or find all author names in publications). Finally there are functions that will output a sequence entry in GenBank format, FASTA format, or a report format.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430703}{\*\bkmkstart _Toc300649099}Data Access{\*\bkmkend _Toc294430703}{\*\bkmkend _Toc300649099}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A family of functions supplies high level access to sequence and bibliographic data on the Entrez:Sequences CDROM provided by NCBI. These functions allow the evaluation of Boolean operations on a list of terms, resulting the sequence ids (or MEDLINE ids) that satisfy the query. Other functions take sequence or MEDLINE id and retrieve the record from the CDROM, or retrieve it's "neighbors", entries which are similar to it.
\par These same functions have been implemented as Internet network access functions to the NCBI data servers, and will become publically available in 1993. Software which accesses data on the Entrez: Sequences CDROM using the access functions can be changed to access the network servers by just linking to a different library.
\par The access functions mean that a programmer can incorporate any or all of the functionality shown by the Entrez application into a program of their own design. This means customized analysis and retrieval systems can be written which nonetheless take advantage of the public data retrieval systems.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430704}{\*\bkmkstart _Toc300649100}Vibrant: A Portable Windowing System{\*\bkmkend _Toc294430704}{\*\bkmkend _Toc300649100}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Vibrant is a portable windowing system written with CoreLib which allows windowing applications to be written which are source code identifical on Macintosh, MicroSoft Windows, UNIX X11 Motif and VMS X11 Motif. Vibrant not meant to provide every possible tool supported by the host system or other commercial products, but rather to vastly simplify writing basic scientific applications which are compatible with the modern windowing environments widely used by scientists now in a portable way.
\par NCBI fondly hopes that eventually a standard windowing API or appropriate tools will emerge from the computer industry. We will only support Vibrant until that time. While we make it available to the public to use as desired, Vibrant is primarily aimed at serving internal NCBI needs.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430705}{\*\bkmkstart _Toc300649101}A Few Samples{\*\bkmkend _Toc294430705}{\*\bkmkend _Toc300649101}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This document contains a large mass of detailed information and new ideas. Just as learning a new language, it is a substantial committment to learn and understand it all. But knowing it all may not be necessary to get started. This is a quick sample of what is available to give you a flavor of what this is.
\par This is the ASN.1 definitions used for an article citation (from a book, journal, or proceedings.. only journal is shown). The "::=" means "is defined as" and SEQUENCE means "the following items come in order", not a biological sequence. You can probably just read the rest.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Cit-art ::= SEQUENCE \{                  -- article in journal or book
\par     title Title OPTIONAL ,              -- title of paper (ANSI requires)
\par     authors Auth-list OPTIONAL ,        -- authors (ANSI requires)
\par     from CHOICE \{                       -- journal or book
\par         journal Cit-jour ,
\par         book Cit-book ,
\par         proc Cit-proc \} \}
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Cit-jour ::= SEQUENCE \{             -- Journal citation
\par     title Title ,                   -- title of journal
\par     imp Imprint \}
\par 
\par Auth-list ::= SEQUENCE \{
\par         names CHOICE \{
\par             std SEQUENCE OF Author ,        -- full citations
\par             ml SEQUENCE OF VisibleString ,  -- MEDLINE, semi-structured
\par             str SEQUENCE OF VisibleString \} , -- free for all
\par         affil Affil OPTIONAL \}        -- author affiliation
\par 
\par Title ::= SET OF CHOICE \{
\par     name VisibleString ,    -- Title, Anal,Coll,Mono    AJB
\par     tsub VisibleString ,    -- Title, Subordinate       A B
\par     trans VisibleString ,   -- Title, Translated        AJB
\par     jta VisibleString ,     -- Title, Abbreviated        J
\par     iso-jta VisibleString , -- specifically ISO jta      J
\par     ml-jta VisibleString ,  -- specifically MEDLINE jta  J
\par     coden VisibleString ,   -- a coden                   J
\par     issn VisibleString ,    -- ISSN                      J
\par     abr VisibleString ,     -- Title, Abbreviated         B
\par     isbn VisibleString \}    -- ISBN                       B
\par 
\par Imprint ::= SEQUENCE \{                  -- Imprint group
\par     date Date ,                         -- date of publication
\par     volume VisibleString OPTIONAL ,
\par     issue VisibleString OPTIONAL ,
\par     pages VisibleString OPTIONAL ,
\par     section VisibleString OPTIONAL ,
\par     pub Affil OPTIONAL,                     -- publisher, required for book
\par     cprt Date OPTIONAL,                     -- copyright date, "    "   "
\par     part-sup VisibleString OPTIONAL ,       -- used in MEDLINE
\par     language VisibleString DEFAULT "ENG" ,  -- put here for simplicity
\par \tab prepub ENUMERATED \{                     -- for prepublication citaions
\par \tab \tab submitted (1) ,                     -- submitted, not accepted
\par \tab \tab in-press (2) ,\tab \tab \tab -- accepted, not published
\par \tab \tab other (255)  \} OPTIONAL \}
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {That is a very complete and detailed specification but here is a sample of a journal citation in text form ASN.1. You can easily see how it conforms to the specification and how one would locate the journal title for example.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Cit-art ::= \{
\par   title \{
\par     name "Developmental regulation of a constitutively expressed mouse mRNA
\par  encoding a 72-kDa heat shock-like protein." \} ,
\par   authors \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    names
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {      ml \{
\par         "Giebel LB" ,
\par         "Dworniczak BP" ,
\par         "Bautz EK" \} ,
\par     affil
\par       str "Zentrum fur Molekulare Biologie, Universitat Heidelberg (ZMBH),
\par  Federal Republic of Germany." \} ,
\par   from
\par     journal \{
\par       title \{
\par         ml-jta "Dev Biol" \} ,
\par       imp \{
\par         date
\par           std \{
\par             year 1988 ,
\par             month 1 \} ,
\par         volume "125" ,
\par         issue "1" ,
\par         pages "200-7" \} \} \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Here is the object loader "C" structure and its attendent functions for a Cit-art. There is even a matching function for this object. Details of using the "fromptr" to access the CitJour, CitBook, or CitProc for the article are given in the Bibliographic References chapter. This is just to give the flavor.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*****************************************************************************
\par *
\par *   Cit-art
\par *
\par *****************************************************************************/
\par typedef struct citart \{
\par \tab ValNodePtr title;       /* choice[1]=name,[2]=tsub,[3]=trans */
\par \tab AuthListPtr authors;
\par \tab Uint1 from;             /* [1]=journal,[2]=book,[3]=proc */
\par \tab Pointer fromptr;
\par \} CitArt, PNTR CitArtPtr;
\par 
\par extern CitArtPtr CitArtNew PROTO((void));
\par extern CitArtPtr CitArtFree PROTO((CitArtPtr cap));
\par extern CitArtPtr CitArtAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitArtAsnWrite PROTO((CitArtPtr cap, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 CitArtMatch PROTO((CitArtPtr a, CitArtPtr b));
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Here is a data access function which retrieves a MEDLINE record (a MedlineEntry) from the Entrez: Sequences CDROM, given a MEDLINE unique identifier (uid). A MedlineEntry contains an article citation (i.e. it reuses the Cit-art object from the bibliographic module then adds the additional index terms and information needed to make a MEDLINE record).
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {MedlineEntryPtr GetMedline (Int4 uid)
\par \{
\par \tab MedlineEntryPtr mep = NULL;
\par 
\par \tab if (! EntrezInit())\tab \tab \tab /* intitialize Entrez CDROM */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab return NULL;\tab \tab \tab \tab /* failed to initialize */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab mep = EntrezMedlineEntryGet(uid);\tab /* get the Medline entry */
\par \tab EntrezFini();\tab \tab \tab \tab /* close CDROM */
\par \tab return mep;
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Here is a code fragment that will exhaustively explore the MedlineEntry structure in memory and call the user supplied callback function when it finds Imprint in the Cit-jour of the Cit-art (i.e. the article was published in a journal which was printed at a particular time). The string "Cit-art.from.jour.imp" defines a path to the journal imprint following the ASN.1 specification given above.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {ExploreExample( MedlineEntryPtr mep)
\par \{
\par \tab AsnIoPtr aip;
\par 
\par \tab aip = AsnIoNullOpen();\tab \tab \tab \tab /* attach a callback below */
\par \tab AsnExpOptNew(aip, "Cit-art.from.jour.imp", NULL, GetImprint);
\par \tab MedlineEntryAsnWrite(mep, aip, NULL);\tab /* traverse structure */
\par \tab AsnIoClose(aip);
\par \tab return;
\par \}
\par 
\par /*** this is called whenever a journal imprint in an article is found **/
\par void GetImprint(AsnExpOptStructPtr aeosp)
\par \{
\par \tab ImprintPtr ip;
\par 
\par \tab /*
\par \tab ** Make sure we are at the beginning of an Imprint
\par \tab */
\par 
\par \tab if (aeosp->dvp->intvalue != START_STRUCT) return;
\par 
\par \tab ip = (ImprintPtr)aeosp->the_struct;  /* we have the Imprint */
\par \tab \tab /*.... do whatever you want with it */
\par \tab return;
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, here we print out the MedlineEntry in EndNote format and free the memory it used.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {MedlineToFile (MedlineEntryPtr mep)
\par \{
\par \tab FILE *fp;
\par 
\par \tab fp = FileOpen("test.out", "w");
\par \tab MedlineEntryToDocFile (mep, fp);
\par \tab FileClose(fp);
\par \tab MedlineEntryFree(mep);
\par \tab return;
\par \}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430706}{\*\bkmkstart _Toc300649102}Using This Document{\*\bkmkend _Toc294430706}{\*\bkmkend _Toc300649102}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This document has a detailed table of contents which can direct you to the topic of interest. For an initial acquaintence with the system, read the Data Model chapter and the introductions to the other chapters. Then, depending on your style and interests, either:
\par }\pard \sb240\widctlpar\adjustright {1) Download the software toolkit, build it, and make the demo programs. Print the ".c" files for the demos and look them over. Print the ".asn" files from the \\asn directory and look them over. Print the ".h" files from the \\object directory. Print "sequtil.h" and "seqport.h" from \\api. Print "accentr.h" from \\cdromlib. Go back and read the rest of the documentation.
\par }\pard \sb240\widctlpar\adjustright {2) Read the documentation by scanning the sections after the introductions in each chapter. Then return in detail to what interests you.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430707}{\*\bkmkstart _Toc300649103}Contacting NCBI{\*\bkmkend _Toc294430707}{\*\bkmkend _Toc300649103}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {You can
download the software tools (all versions) by anonymous ftp to ftp.ncbi.nih.gov
\par cd toolbox\\ncbi_tools
\par }\pard \widctlpar\adjustright {bin
\par }\pard \widctlpar\adjustright {get ncbi.tar.Z\tab \tab (compressed UNIX tar file)
\par or
\par get ncbiZ.exe\tab \tab (self extracting DOS archive)
\par or
\par get ncbi.sea.hqx\tab \tab (self extracting Mac archive)
\par }\pard \sb240\widctlpar\adjustright {You can get on an email list to be notified of new releases of software by sending your name, address, institution, and email address to bits-request@ncbi.nlm.nih.gov
\par You can email to toolbox@ncbi.nlm.nih.gov
\par You can FAX 301-480-9241, attn. toolbox
\par You can mail to:
\par toolbox
\par }\pard \widctlpar\adjustright {NCBI
\par }\pard \widctlpar\adjustright {Bldg 38A, NIH
\par 8600 Rockville Pike
\par Bethesda, MD 20850
\par }\pard \sb240\widctlpar\adjustright {All comments are welcome. If you are part of a larger project or group who wish to make use of the NCBI tools or to establish data exchange with NCBI, please let us know and we will do whatever we can to ensure your success.
\par 
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 30}}}{\b0 \tab Data Model}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Data Model\tab }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 29}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include datamodl.doc}}{\fldrslt {{\*\bkmkstart _Toc294430708}{\*\bkmkstart _Toc300649104}Data Model{\*\bkmkend _Toc294430708}{\*\bkmkend _Toc300649104}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430709}{\*\bkmkstart _Toc300649105}Introduction{\*\bkmkend _Toc294430709}{\*\bkmkend _Toc300649105}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The NCBI sequence databases and software tools are designed around a particular model of biological sequence data.  It is designed to provide a few unifying concepts which cross a wide range of domains, providing a path between the domains. Specialized objects are defined which are appropriate within a domain.  In the following sections we will present the unifying ideas, then examine each area of the model in more detail.
\par Since we expect that computer technologies will continue to develop at a rapid rate, NCBI has made considerable investment of time and energy to ensure that our data and software tools are not too tightly bound to any particular computer platform or database technology.  However, we also wish to embrace the intellectual rigor imposed by describing our data within a formal system and in a machine readable and checkable way.  For this reason we have chosen to describe our data in Abstract Syntax Notation 1 (ASN.1; ISO 8824, 8825).  Enough explanation will be given here to allow the reader to examine the data definitions.  A much fuller description of ASN.1 and the NCBI software tools which use it appears in later chapters.
\par   The data specification chapters are arranged by ASN.1 module with detailed discussions of data objects defined in each and the software functions available to operate on those objects.  Each ASN.1 defined object has a matching "C" language structure.  Each "C" structure has at a minimum, a function to create it, write it to an ASN.1 stream, read it from an ASN.1 stream, and destroy it.  Many objects have additional functions.  Some of these are described in the chapter on the module and some with more extensive interfaces are described in additional chapters.  Each module chapter begins with a description of the elements, followed by the full ASN.1 definition of the module, then the "C" code header defining the structures.
\par This chapter provides an overview of all modules.  Selected ASN.1 definitions are inserted into the body of the text as necessary.  They are also described in the chapter on the appropriate module.
\par There are two major areas for which data objects have been defined.  One is bibliographic data.  It is clear that this class of information is central to all scientific fields within and outside of molecular biology so we expect these definitions to be widely useful.  We have followed the American National Standard for Bibliographic References (ANSI Z39.29-1977) and consulted with the US Patent Office and professional librarians to ensure complete and accurate representation of citation information.  Unlike biological data, this data is relatively well understood, so we hope that the bibliographic specification can be quite complete and stable.  Despite it's importance, the bibliographic specification will not be discussed further here, since it does not present ideas which may be novel to the reader.
\par The other major area of the specification is biological sequence data and it's associated information.  Here the data model attempts to achieve a number of goals.  Biomedical information is a vast interconnected web of data which crosses many domains of discourse with very different ways of viewing the world.  Biological science is very much like the parable of the blind men and elephant. To some of the blind men the elephant feels like a column, to some like a snake, to others like a wall.  The excitement of modern biological research is that we all agree that, at least at some level, we are all exploring aspects of the same thing.  But it is early enough in the development of the science that we cannot agree on what that thing is.
\par The power of molecular biology is that DNA and protein sequence data cut across most fields of biology from evolution to development, from enzymology to agriculture, from statistical mechanics to medicine.  Sequence data can be viewed as a simple, relatively well defined armature on which data from various disciplines can be hung.  By associated diverse data with the sequence, connections can be made between fields of research with no other common ground, and often with little or no idea of what the other field is doing.
\par This data model establishes a biological sequence as a simple integer coordinate system with which diverse data can be associated.  It is reasonable to hope that such a simple core can be very stable and compatible with a very wide range of data.  Additional information closely linked to the coordinate system, such as the sequence of amino acids or bases, or genes on a genetic map are layered onto it.  With stable identifiers for specific coordinate systems, a greater diversity of information about the coordinate system can be specifically attached to it in a very flexible yet rigorous way.  The essential differences between different biological forms are preserved, yet they can viewed as aspects of the same thing around the core, and thus move us toward our goal of understanding the totality.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430710}{\*\bkmkstart _Toc300649106}Biological Sequences{\*\bkmkend _Toc294430710}{\*\bkmkend _Toc300649106}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Bioseq is a single continuous biological sequence.  It can be nucleic acid or protein.  It can be fully instantiated (i.e. we have data for every residue) or only partially instantiated (e.g. we know a fragment is 10 kilobases long, but we only have sequence data over 1 kilobase).  A Bioseq is defined in ASN.1 as follows:
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Bioseq\tab ::= SEQUENCE \{
\par \tab id\tab SET OF Seq-id ,
\par \tab descr \tab Seq-descr\tab \tab OPTIONAL ,
\par \tab inst \tab Seq-inst ,
\par \tab annot\tab SET OF Seq-annot\tab OPTIONAL \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In ASN.1 a named datatype begins with a capital letter (e.g. Bioseq). The symbol "::=" means "is defined as". A primitive type is all capitals (e.g. SEQUENCE).  A field within a named datatype begins with a lower case letter (e.g. descr).  A structured datatype is bounded by curly brackets (\{\}). We can now read the definition above:  a Bioseq is defined as a SEQUENCE (i.e. a structure where the elements must come in order; the mathematical notion of SEQUENCE, not the biological one).  The first element of Bioseq is called "id" and is a SET OF (i.e. an unordered collection of repeating elements of the same type) a named datatype called "Seq-id". Seq-id would have it's own definition elsewhere.  The second element is called "descr" and is a named type called "Seq-descr", which is OPTIONAL.  In this text, when we wish to refer to the id element of the named type Bioseq, we will use the notation "Bioseq.id".
\par A Bioseq has two OPTIONAL elements, which both have descriptive information ABOUT the sequence.  Seq-descr is a collection of types of information about the context of the sequence.  It may set biological context (e.g. define the organism sequenced), or bibliographic context (e.g. the paper it was published in), among other things.  Seq-annot is information that is explicitly tied to locations on the sequence.  This could be feature tables, alignments, or graphs, at the present time.  A Bioseq can have more than one feature table, perhaps coming from different sources, or a feature table and a graph, etc.
\par A Bioseq is only REQUIRED to have two elements, id and inst.  Bioseq.id is one or more identifiers for this Bioseq.  An identifier is a key which allows us to retrieve this object from a database or identify it uniquely.  It is not a name, which is a human compatible description, but not necessarily a unique identifier.  The name "Jane Doe" does not uniquely identify a person in the United States, while the identifier, social security number, does.  Each Seq-id is a CHOICE of one of a number of identifier types from different databases, which may have different structures.  All Bioseqs MUST have at least one identifier.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430711}{\*\bkmkstart _Toc300649107}Classes of Biological Sequences{\*\bkmkend _Toc294430711}{\*\bkmkend _Toc300649107}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The other required element of a Bioseq is a Seq-inst.  This element instantiates the sequence itself.  It represents things like is it DNA, RNA, or protein?  Circular or linear? Double-stranded or single-stranded?  How long is it?
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Seq-inst ::= SEQUENCE \{
\par \tab repr\tab ENUMERATED \{
\par \tab \tab \tab not-set (0) ,
\par \tab \tab \tab virtual (1) ,
\par \tab \tab \tab raw (2) , 
\par \tab \tab \tab seg (3) ,
\par \tab \tab \tab const (4) ,
\par \tab \tab \tab ref (5) , 
\par \tab \tab \tab consen (6) ,
\par \tab \tab \tab map (7) ,
\par  \tab \tab \tab other (255) \} ,
\par \tab mol \tab ENUMERATED \{
\par \tab \tab \tab not-set (0) ,
\par \tab \tab \tab dna (1) ,
\par \tab \tab \tab rna (2) ,
\par \tab \tab \tab aa (3) ,
\par \tab \tab \tab na (4) ,
\par \tab \tab \tab other (255) \} ,
\par \tab length\tab INTEGER\tab OPTIONAL , 
\par \tab fuzz\tab Int-fuzz\tab \tab OPTIONAL ,
\par \tab topology ENUMERATED \{
\par \tab \tab \tab not-set (0) ,
\par \tab \tab \tab linear (1) ,
\par \tab \tab \tab circular (2) ,
\par \tab \tab \tab tandem (3) ,
\par \tab \tab \tab other (255) \} DEFAULT linear ,
\par \tab strand\tab ENUMERATED \{
\par \tab \tab \tab not-set (0) ,
\par \tab \tab \tab ss (1) ,
\par \tab \tab \tab ds (2) ,
\par \tab \tab \tab mixed (3) ,
\par \tab \tab \tab other (255) \} OPTIONAL ,
\par \tab seq-data Seq-data\tab OPTIONAL ,
\par \tab ext\tab Seq-ext\tab OPTIONAL ,
\par \tab hist\tab Seq-hist\tab  OPTIONAL \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seq-inst is the parent class of a sequence representation class hierarchy.  There are two major branches to the hierarchy.  The molecule type branch is indicted by Seq-inst.mol.  This could be a nucleic acid, or further sub classified as RNA or DNA.  The nucleic acid may be circular, linear, or one repeat of a tandem repeat structure.  It can be double, single, or of a mixed strandedness.  It could also be a protein, in which case topology and strandedness are not relevant.
\par There is also a representation branch, which is independent of the molecule type branch.  This class hierarchy involves the particular data structure used to represent the knowledge we have about the molecule, no matter which part of the molecule type branch it may be in.  The repr element indicates the type of representation used.  The aim of such a set of representation classes is to support the information to express different views of sequence based objects, from chromosomes to restriction fragments, from genetic maps to proteins, within a single overall model.  The ability to do this confers profound advantages for software tools, data storage and retrieval, and traversal of related sequence and map data from different scientific domains.
\par }\pard \qc\sb240\widctlpar\adjustright {\pard\plain \qc\sb240\widctlpar\adjustright \f16\fs20\cgrid {\object\objemb\rsltmerge\objw10190\objh11207\objscalex81\objscaley81{\*\objclass MSDraw}{\*\objdata 0105000002000000070000004d5344726177000000000000000000c014000008003246344d0100090000033e0a000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000e30800000100030000000000ffffff0000000000ffffff000100000100000001000000000001000000000000010c0053797374656d0003008a00ff00290003015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d724564030008000000600058004b10da11050000000b0258006000050000000c028211eb0f030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e00040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0100000b000000320ac0006000070000005669727475616c0009000000320a3003600003000000526177000e00000026060f0012004d724564030008000000000390001005100207000000fc020000ffffff00ffff040000002d010100040000000201020008000000fa0206000800080000000000040000002d010200090000001c0660006000140214058c00fc02040000000201010009000000320a2001300303000000444e410008000000320a800130030200000044530b000000320ae00130030700000031303030206270000e00000026060f0012004d7245640300080000001005900010082001040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000200110089000100509000000320a400e6000030000004d6170000e00000026060f0012004d7245640300080000000003100e1005900f040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c0660006000940f14050c0efc02040000000201010009000000320aa00e300303000000444e410008000000320a000f30030200000044530b000000320a600f30030700000031303030206270000e00000026060f0012004d7245640300080000001005100e1008a00e040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000a00e1008100e10050e00000026060f0012004d7245640300080000000003000310058004040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c066000600084041405fc02fc02040000000201010009000000320a9003300303000000444e410008000000320af00330030200000044530b000000320a500430030700000031303030206270000e00000026060f0012004d72456403000800000010050003100890030400000002010200090000001c063000300094031408fc020c0504000000020101000d000000320a600340050b0000004147474354414154474343000c000000320a70056000090000005365676d656e746564000e00000026060f0012004d724564030008000000000340051005c0060400000002010200090000001c0660006000c40614053c05fc02040000000201010009000000320ad005300303000000444e410008000000320a300630030200000044530b000000320a900630030700000031303030206270000e00000026060f0012004d724564030008000000100540051008d005040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000d0051008400510050e00000026060f0012004d7245640300080000000003c006c0030209040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c06900090000609c403bc06fc020b00000026060f000c004d72456401000200000000000800000025030200c0035007c003d0080b00000026060f000c004d72456401000200000000000800000025030200c003d2086006d0080b00000026060f000c004d724564010002000000000008000000250302006006d0083006a0080b00000026060f000c004d72456401000200000000000800000025030200300602096006d0080e00000026060f001200ffffffff000008000000b8031807880488070b00000026060f000c004d72456401000200000000000800000025030200c0035207800450070b00000026060f000c004d7245640100020000000000080000002503020080045007500420070b00000026060f000c004d7245640100020000000000080000002503020080045007500480070a00000026060f000a00ffffffff0100000000000b00000026060f000c004d72456401000200000000000800000025030200c0031208700512080b00000026060f000c004d72456401000200000000000800000025030200700510084005e0070b00000026060f000c004d724564010002000000000008000000250302007005100840054008040000000201010009000000320a5007300303000000657874000e00000026060f001200ffffffff000008000000780418070806b8070e00000026060f0012004d724564030008000000800420071005b0070400000002010200090000001c0630003000b40714051c077c040e00000026060f0012004d7245640300080000001005200700065007090000001c0630003000540704061c070c050a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff00000800000058069808e80738090e00000026060f0012004d7245640300080000006006a008f0063009090000001c06300030003409f4069c085c060e00000026060f0012004d724564030008000000f006a008e007d008090000001c0630003000d408e4079c08ec060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006805d807f80678080e00000026060f0012004d7245640300080000007005e00700067008090000001c063000300074080406dc076c050e00000026060f0012004d7245640300080000000006e007f006100808000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c06300030001008f006e00700060a00000026060f000a00ffffffff0100000000000e00000026060f0012004d7245640300080000000003400b1008500d04000000020102000400000002010100090000001c0684008400500d1008400b00030d000000320af00960000b000000436f6e7374727563746564000e00000026060f0012004d7245640300080000000003c0091005400b040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c0660006000440b1405bc09fc02040000000201010009000000320a500a300303000000444e410008000000320ab00a30030200000044530b000000320a100b30030700000031303030206270000e00000026060f0012004d7245640300080000001005c0091008500a0400000002010200090000001c0630003000540a1408bc090c0504000000020101000d000000320a200a40050b0000004147474354414154474343000e00000026060f001200ffffffff0000080000004804680bd805080c0e00000026060f0012004d7245640300080000005004700be004000c0400000002010200090000001c0630003000040ce4046c0b4c040e00000026060f0012004d724564030008000000e004700bd005a00b090000001c0630003000a40bd4056c0bdc040a00000026060f000a00ffffffff010000000000040000000201010009000000320aa00b300304000000686973740e00000026060f001200ffffffff0000080000000805f80b9806980c0e00000026060f0012004d7245640300080000001005000ca005900c0400000002010200090000001c0630003000940ca405fc0b0c050e00000026060f0012004d724564030008000000a005000c9006300c090000001c0630003000340c9406fc0b9c050a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000004804b80cd805580d0e00000026060f0012004d7245640300080000005004c00ce004500d090000001c0630003000540de404bc0c4c040e00000026060f0012004d724564030008000000e004c00cd005f00c090000001c0630003000f40cd405bc0cdc040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000002806580cb807f80c0e00000026060f0012004d7245640300080000003006600cc006f00c090000001c0630003000f40cc4065c0c2c060e00000026060f0012004d724564030008000000c006600cb007900c090000001c0630003000940cb4075c0cbc060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000002806680bb807080c0e00000026060f0012004d7245640300080000003006700bc006000c090000001c0630003000040cc4066c0b2c060e00000026060f0012004d724564030008000000c006700bb007a00b090000001c0630003000a40bb4076c0bbc060a00000026060f000a00ffffffff0100000000000e00000026060f0012004d7245640300080000000003900fc003d211090000001c0690009000d611c4038c0ffc02040000000201010009000000320a2010300303000000657874000e00000026060f001200ffffffff000008000000b803e80f880458100b00000026060f000c004d72456401000200000000000800000025030200c0032210800420100b00000026060f000c004d72456401000200000000000800000025030200800420105004f00f0b00000026060f000c004d7245640100020000000000080000002503020080042010500450100a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000b80378108804e8100b00000026060f000c004d72456401000200000000000800000025030200c003b2108004b0100b00000026060f000c004d724564010002000000000008000000250302008004b010500480100b00000026060f000c004d724564010002000000000008000000250302008004b0105004e0100a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000b8030811880478110b00000026060f000c004d72456401000200000000000800000025030200c0034211800440110b00000026060f000c004d7245640100020000000000080000002503020080044011500410110b00000026060f000c004d7245640100020000000000080000002503020080044011500470110a00000026060f000a00ffffffff01000000000009000000320a5010b004030000006163650009000000320ae010b004030000006c61630009000000320a7011b00403000000617474000e00000026060f0012004d724564030008000000e00a6000c00c70020400000002010200070000001b047402c40c5c00dc0a0b00000026060f000c004d72456401000200000000000800000025030200100bf000a00bf0000b00000026060f000c004d72456401000200000000000800000025030200100b2001a00b20010b00000026060f000c004d72456401000200000000000800000025030200000cf000900cf0000b00000026060f000c004d72456401000200000000000800000025030200100bb001a00bb0010b00000026060f000c004d72456401000200000000000800000025030200000cb001900cb0010b00000026060f000c004d72456401000200000000000800000025030200000c1002900c1002040000000201010015000000320af006500a1c00000041474743475454542e2e2e283430206270292e2e2e5454414747544112000000320ac003500a160000004147474354414154474343544154544154414343544108000000fa0206002000200000000000040000002d01030004000000f00102000b00000026060f000c004d72456401000200000000000800000025030200500a500a900f500a08000000fa0206000800080000000000040000002d01020004000000f00103000b00000026060f000c004d72456401000200000000000800000025030200500a400bf00c400b0b00000026060f000c004d72456401000200000000000800000025030200a00ba00ba00ea00b0b00000026060f000c004d72456401000200000000000800000025030200800d300cc00f300c0b00000026060f000c004d72456401000200000000000800000025030200500ac00c600cc00c0b00000026060f000c004d72456401000200000000000800000025030200000c200db00d200d08000000fa0206002000200000000000040000002d01030004000000f00102000b00000026060f000c004d72456401000200000000000800000025030200200af00fc00ff00f08000000fa0206000800080000000000040000002d01020004000000f00103000b00000026060f000c004d72456401000200000000000800000025030200800a900f800af00f0b00000026060f000c004d72456401000200000000000800000025030200b00d900fb00df00f0b00000026060f000c004d72456401000200000000000800000025030200a00e900fa00ef00f09000000320a600f500a030000006163650009000000320a600f800d030000006c61630009000000320a600f700e030000006174740009000000320a8010c00903000000302e30000a000000320a8010600f050000003130302e300010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01030004000000f001000008000000fa02050000000000ffffff00040000002d01000004000000f001020007000000fc020100000000000000040000002d01020004000000f0010100040000002701ffff040000002701ffff0300000000006050d0506000003048685848480000203048484830000010304848483000003030484848030000006163650009000000320a600f800d03000000ff0003d401050000050000000d0000004d45544146494c45504943540033460000ccb2ffff8414000008003346344d00000100090000033e0a000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000e30800000100030000000000ffffff0000000000ffffff000100000100000001000000000001000000000000010c0053797374656d0003008a00ff00290003015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d724564030008000000600058004b10da11050000000b0258006000050000000c028211eb0f030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e00040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0100000b000000320ac0006000070000005669727475616c0009000000320a3003600003000000526177000e00000026060f0012004d724564030008000000000390001005100207000000fc020000ffffff00ffff040000002d010100040000000201020008000000fa0206000800080000000000040000002d010200090000001c0660006000140214058c00fc02040000000201010009000000320a2001300303000000444e410008000000320a800130030200000044530b000000320ae00130030700000031303030206270000e00000026060f0012004d7245640300080000001005900010082001040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000200110089000100509000000320a400e6000030000004d6170000e00000026060f0012004d7245640300080000000003100e1005900f040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c0660006000940f14050c0efc02040000000201010009000000320aa00e300303000000444e410008000000320a000f30030200000044530b000000320a600f30030700000031303030206270000e00000026060f0012004d7245640300080000001005100e1008a00e040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000a00e1008100e10050e00000026060f0012004d7245640300080000000003000310058004040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c066000600084041405fc02fc02040000000201010009000000320a9003300303000000444e410008000000320af00330030200000044530b000000320a500430030700000031303030206270000e00000026060f0012004d72456403000800000010050003100890030400000002010200090000001c063000300094031408fc020c0504000000020101000d000000320a600340050b0000004147474354414154474343000c000000320a70056000090000005365676d656e746564000e00000026060f0012004d724564030008000000000340051005c0060400000002010200090000001c0660006000c40614053c05fc02040000000201010009000000320ad005300303000000444e410008000000320a300630030200000044530b000000320a900630030700000031303030206270000e00000026060f0012004d724564030008000000100540051008d005040000000201020008000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c0630003000d0051008400510050e00000026060f0012004d7245640300080000000003c006c0030209040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c06900090000609c403bc06fc020b00000026060f000c004d72456401000200000000000800000025030200c0035007c003d0080b00000026060f000c004d72456401000200000000000800000025030200c003d2086006d0080b00000026060f000c004d724564010002000000000008000000250302006006d0083006a0080b00000026060f000c004d72456401000200000000000800000025030200300602096006d0080e00000026060f001200ffffffff000008000000b8031807880488070b00000026060f000c004d72456401000200000000000800000025030200c0035207800450070b00000026060f000c004d7245640100020000000000080000002503020080045007500420070b00000026060f000c004d7245640100020000000000080000002503020080045007500480070a00000026060f000a00ffffffff0100000000000b00000026060f000c004d72456401000200000000000800000025030200c0031208700512080b00000026060f000c004d72456401000200000000000800000025030200700510084005e0070b00000026060f000c004d724564010002000000000008000000250302007005100840054008040000000201010009000000320a5007300303000000657874000e00000026060f001200ffffffff000008000000780418070806b8070e00000026060f0012004d724564030008000000800420071005b0070400000002010200090000001c0630003000b40714051c077c040e00000026060f0012004d7245640300080000001005200700065007090000001c0630003000540704061c070c050a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff00000800000058069808e80738090e00000026060f0012004d7245640300080000006006a008f0063009090000001c06300030003409f4069c085c060e00000026060f0012004d724564030008000000f006a008e007d008090000001c0630003000d408e4079c08ec060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006805d807f80678080e00000026060f0012004d7245640300080000007005e00700067008090000001c063000300074080406dc076c050e00000026060f0012004d7245640300080000000006e007f006100808000000fa0202000000000000000000040000002d01030004000000f00102000400000002010100090000001c06300030001008f006e00700060a00000026060f000a00ffffffff0100000000000e00000026060f0012004d7245640300080000000003400b1008500d04000000020102000400000002010100090000001c0684008400500d1008400b00030d000000320af00960000b000000436f6e7374727563746564000e00000026060f0012004d7245640300080000000003c0091005400b040000000201020008000000fa0206000800080000000000040000002d01020004000000f0010300090000001c0660006000440b1405bc09fc02040000000201010009000000320a500a300303000000444e410008000000320ab00a30030200000044530b000000320a100b30030700000031303030206270000e00000026060f0012004d7245640300080000001005c0091008500a0400000002010200090000001c0630003000540a1408bc090c0504000000020101000d000000320a200a40050b0000004147474354414154474343000e00000026060f001200ffffffff0000080000004804680bd805080c0e00000026060f0012004d7245640300080000005004700be004000c0400000002010200090000001c0630003000040ce4046c0b4c040e00000026060f0012004d724564030008000000e004700bd005a00b090000001c0630003000a40bd4056c0bdc040a00000026060f000a00ffffffff010000000000040000000201010009000000320aa00b300304000000686973740e00000026060f001200ffffffff0000080000000805f80b9806980c0e00000026060f0012004d7245640300080000001005000ca005900c0400000002010200090000001c0630003000940ca405fc0b0c050e00000026060f0012004d724564030008000000a005000c9006300c090000001c0630003000340c9406fc0b9c050a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000004804b80cd805580d0e00000026060f0012004d7245640300080000005004c00ce004500d090000001c0630003000540de404bc0c4c040e00000026060f0012004d724564030008000000e004c00cd005f00c090000001c0630003000f40cd405bc0cdc040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000002806580cb807f80c0e00000026060f0012004d7245640300080000003006600cc006f00c090000001c0630003000f40cc4065c0c2c060e00000026060f0012004d724564030008000000c006600cb007900c090000001c0630003000940cb4075c0cbc060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000002806680bb807080c0e00000026060f0012004d7245640300080000003006700bc006000c090000001c0630003000040cc4066c0b2c060e00000026060f0012004d724564030008000000c006700bb007a00b090000001c0630003000a40bb4076c0bbc060a00000026060f000a00ffffffff0100000000000e00000026060f0012004d7245640300080000000003900fc003d211090000001c0690009000d611c4038c0ffc02040000000201010009000000320a2010300303000000657874000e00000026060f001200ffffffff000008000000b803e80f880458100b00000026060f000c004d72456401000200000000000800000025030200c0032210800420100b00000026060f000c004d72456401000200000000000800000025030200800420105004f00f0b00000026060f000c004d7245640100020000000000080000002503020080042010500450100a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000b80378108804e8100b00000026060f000c004d72456401000200000000000800000025030200c003b2108004b0100b00000026060f000c004d724564010002000000000008000000250302008004b010500480100b00000026060f000c004d724564010002000000000008000000250302008004b0105004e0100a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000b8030811880478110b00000026060f000c004d72456401000200000000000800000025030200c0034211800440110b00000026060f000c004d7245640100020000000000080000002503020080044011500410110b00000026060f000c004d7245640100020000000000080000002503020080044011500470110a00000026060f000a00ffffffff01000000000009000000320a5010b004030000006163650009000000320ae010b004030000006c61630009000000320a7011b00403000000617474000e00000026060f0012004d724564030008000000e00a6000c00c70020400000002010200070000001b047402c40c5c00dc0a0b00000026060f000c004d72456401000200000000000800000025030200100bf000a00bf0000b00000026060f000c004d72456401000200000000000800000025030200100b2001a00b20010b00000026060f000c004d72456401000200000000000800000025030200000cf000900cf0000b00000026060f000c004d72456401000200000000000800000025030200100bb001a00bb0010b00000026060f000c004d72456401000200000000000800000025030200000cb001900cb0010b00000026060f000c004d72456401000200000000000800000025030200000c1002900c1002040000000201010015000000320af006500a1c00000041474743475454542e2e2e283430206270292e2e2e5454414747544112000000320ac003500a160000004147474354414154474343544154544154414343544108000000fa0206002000200000000000040000002d01030004000000f00102000b00000026060f000c004d72456401000200000000000800000025030200500a500a900f500a08000000fa0206000800080000000000040000002d01020004000000f00103000b00000026060f000c004d72456401000200000000000800000025030200500a400bf00c400b0b00000026060f000c004d72456401000200000000000800000025030200a00ba00ba00ea00b0b00000026060f000c004d72456401000200000000000800000025030200800d300cc00f300c0b00000026060f000c004d72456401000200000000000800000025030200500ac00c600cc00c0b00000026060f000c004d72456401000200000000000800000025030200000c200db00d200d08000000fa0206002000200000000000040000002d01030004000000f00102000b00000026060f000c004d72456401000200000000000800000025030200200af00fc00ff00f08000000fa0206000800080000000000040000002d01020004000000f00103000b00000026060f000c004d72456401000200000000000800000025030200800a900f800af00f0b00000026060f000c004d72456401000200000000000800000025030200b00d900fb00df00f0b00000026060f000c004d72456401000200000000000800000025030200a00e900fa00ef00f09000000320a600f500a030000006163650009000000320a600f800d030000006c61630009000000320a600f700e030000006174740009000000320a8010c00903000000302e30000a000000320a8010600f050000003130302e300010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01030004000000f001000008000000fa02050000000000ffffff00040000002d01000004000000f001020007000000fc020100000000000000040000002d01020004000000f0010100040000002701ffff040000002701ffff030000000000}{\result {\f0 {\pict\wmetafile8\picw17970\pich19764\picwgoal10189\pichgoal11206 \picscalex81\picscaley81 \bin5280  	  >
   Z        &  ˇˇˇˇ    MrEd Microsoft Draw  Z   & © MrEd ü   ù  ˇˇˇˇˇˇˇˇ  „        ˇˇˇ     ˇˇˇ                  System  ä ˇ ) _  Ø       ˇˇˇ ¿¿¿ ÄÄÄ ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä ˇ ˇ Ä Ä     &  MrEd    ` X K⁄   X `    ÇÎ           ˇˇˇ    	                           .        ˚∞ˇ      ê       Times New Roman      -     2
¿ `    Virtual 	   2
0`    Raw    &  MrEd     ê    ¸  ˇˇˇ ˇˇ   -        ˙          - 	   ` ` å ¸    	   2
 0   DNA    2
Ä0   DS   2
‡0   1000 bp    &  MrEd    ê         ˙            -         	   0 0  ê 	   2
@`    Map    &  MrEd     ê       ˙          -     	   ` ` î¸    	   2
†0   DNA    2
 0   DS   2
`0   1000 bp    &  MrEd    †       ˙            -         	   0 0 †   &  MrEd      Ä       ˙          -     	   ` ` Ñ¸¸    	   2
ê0   DNA    2
0   DS   2
P0   1000 bp    &  MrEd     ê    	   0 0 î¸       2
`@   AGGCTAATGCC    2
p` 	   Segmented    &  MrEd     @¿    	   ` ` ƒ<¸    	   2
–0   DNA    2
00   DS   2
ê0   1000 bp    &  MrEd    @–       ˙            -         	   0 0 –@   &  MrEd     ¿¿	       ˙          -     	   ê ê 	ƒº¸   &  MrEd         % ¿P¿–   &  MrEd         % ¿“`–   &  MrEd         % `–0†   &  MrEd         % 0	`–   &  ˇˇˇˇ     ∏àà   &  MrEd         % ¿RÄP   &  MrEd         % ÄPP    &  MrEd         % ÄPPÄ
   & 
 ˇˇˇˇ        &  MrEd         % ¿p   &  MrEd         % p@‡   &  MrEd         % p@@    	   2
P0   ext    &  ˇˇˇˇ     x∏   &  MrEd    Ä ∞    	   0 0 ¥|   &  MrEd      P	   0 0 T
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     XòË8	   &  MrEd    `†0		   0 0 4	Ùú\   &  MrEd    †‡–	   0 0 ‘‰úÏ
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     hÿ¯x   &  MrEd    p‡ p	   0 0 t‹l   &  MrEd     ‡   ˙            -         	   0 0 ‡ 
   & 
 ˇˇˇˇ        &  MrEd     @P        	   Ñ Ñ P@    2
	`    Constructed    &  MrEd     ¿	@       ˙          -     	   ` ` Dº	¸    	   2
P
0   DNA    2
∞
0   DS   2
0   1000 bp    &  MrEd    ¿	P
    	   0 0 T
º	       2
 
@   AGGCTAATGCC    &  ˇˇˇˇ     Hhÿ   &  MrEd    Pp‡     	   0 0 ‰lL   &  MrEd    ‡p–†	   0 0 §‘l‹
   & 
 ˇˇˇˇ         	   2
†0   hist   &  ˇˇˇˇ     ¯òò   &  MrEd     †ê    	   0 0 î§¸   &  MrEd    † ê0	   0 0 4î¸ú
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     H∏ÿX   &  MrEd    P¿‡P	   0 0 T‰ºL   &  MrEd    ‡¿–	   0 0 Ù‘º‹
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     (X∏¯   &  MrEd    0`¿	   0 0 Ùƒ\,   &  MrEd    ¿`∞ê	   0 0 î¥\º
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     (h∏   &  MrEd    0p¿ 	   0 0 ƒl,   &  MrEd    ¿p∞†	   0 0 §¥lº
   & 
 ˇˇˇˇ        &  MrEd     ê¿“	   ê ê ÷ƒå¸    	   2
 0   ext    &  ˇˇˇˇ     ∏ËàX   &  MrEd         % ¿"Ä    &  MrEd         % Ä P   &  MrEd         % Ä PP
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     ∏xàË   &  MrEd         % ¿≤Ä∞   &  MrEd         % Ä∞PÄ   &  MrEd         % Ä∞P‡
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     ∏àx   &  MrEd         % ¿BÄ@   &  MrEd         % Ä@P   &  MrEd         % Ä@Pp
   & 
 ˇˇˇˇ     	   2
P∞   ace 	   2
‡∞   lac 	   2
p∞   att    &  MrEd    ‡
` ¿p       tƒ\ ‹
   &  MrEd         %  †    &  MrEd         %  †    &  MrEd         %   ê    &  MrEd         % ∞†∞   &  MrEd         %  ∞ê∞   &  MrEd         %  ê       2
P
   AGGCGTTT...(40 bp)...TTAGGTA   2
¿P
   AGGCTAATGCCTATTATACCTA   ˙            -        &  MrEd         % P
P
êP
   ˙          -        &  MrEd         % P
@@   &  MrEd         % ††††   &  MrEd         % Ä0¿0   &  MrEd         % P
¿`¿   &  MrEd         %   ∞    ˙            -        &  MrEd         %  
¿   ˙          -        &  MrEd         % Ä
êÄ
   &  MrEd         % ∞ê∞   &  MrEd         % †ê†	   2
`P
   ace 	   2
`Ä   lac 	   2
`p   att 	   2
Ä¿	   0.0 
   2
Ä`   100.0    ˚ 	     º    "System    -         ˙     ˇˇˇ    -         ¸          -        'ˇˇ   'ˇˇ     `P–P`  0HhXHH   0HHH0  0HHH0  00HHH}}}}}{
\par }\pard \sb240\widctlpar\adjustright {A }{\b virtual}{ representation is used to describe a sequence about which we may know things like it is DNA, it is double stranded, we may even know it's length, but we do not have the actual sequence itself yet.  Most fields of the Seq-inst are filled in, but Seq-inst.seq-data is empty.  An example would be a band on a restriction map.
\par A }{\b raw}{ representation is used for what we traditionally consider a sequence.  We know it is DNA, it is double stranded, we know it's length exactly, and we have the sequence data itself.  In this case, Seq-inst.seq-data contains the sequence data.
\par A }{\b segmented}{ representation is very analogous to a virtual representation.  We posit that a continuous double stranded DNA sequence of a certain length exists, and pieces of it exist in other Bioseqs, but there is no data in Seq-inst.seq-data.  Such a case would be when we have cloned and mapped a DNA fragment containing a large protein coding region, but have only actually sequenced the regions immediately around the exons.  The sequence of each exon is an individual raw Bioseq in it's own right.  The regions between exons are virtual Bioseqs.  The segmented Bioseq uses Seq-inst.ext to hold a SEQUENCE OF Seq-loc.  That is, the extension is an ordered series of locations on OTHER Bioseqs, in this case the raw and virtual Bioseqs representing the exons and introns.  The segmented Bioseq contains data only by reference to other Bioseqs.  In order to retrieve the base at the first position in the segmented Bioseq, one would go to the first Seq-loc in the extension, and return the appropriate base from the Bioseq it points to.
\par A }{\b constructed}{ Bioseq is used to describe an assembly or merge of other Bioseqs.  It is analogous to the raw representation.  In fact, most raw Bioseqs were actually constructed from an assembly of gel readings.  However, the constructed representation class is really meant for tracking higher level merging, such as when an expert in a particular organism or gene region may construct a "typical" sequence from that region by merging available sequence data, often published by different groups, using domain knowledge to resolve discrepancies between reports or to select a typical allele.  Seq-inst contains an optional Seq-hist object.  Seq-hist contains a field called "assembly" which is a SET OF Seq-align, or sequence alignments.  The alignments are used to record the history of how the various component Bioseqs used for the merge are related to the final product.  A constructed sequence DOES contain sequence data in Seq-inst.seq-data, unlike a segmented sequence, because the component sequences may overlap, or expert knowledge may have been used to determine the "correct" residue at any position that is not captured in the original components.  So Seq-hist.assembly is used to simply record the relationship of the merge to the old Bioseqs, but does NOT describe how to generate it from them.
\par A }{\b map}{ is akin to a virtual Bioseq.  For example, for a genetic map of E.coli, we might posit that the E.coli chromosome is about 5 million base pairs long, DNA, double stranded, circular, but we do not have the sequence data for it.  However, we do know the positions of some genes on this putative sequence.  In this case, the Seq-inst.ext is a SEQUENCE OF Seq-feat, that is, a feature table.  For a genetic map, the feature table contains Gene-ref features.  An ordered restriction map would have a feature table containing Rsite-ref features.  The feature table is part of Seq-inst because, for a map, it is an essential part of instantiating the map Bioseq, not merely annotation on a known sequence.  In a sense, for a map, the annotation IS part of the sequence.  As an aside, note that we have given gene positions on the E.coli genetic map in base pairs, while the standard E.coli map is numbered from 0.0 to 100.0 map units.  Numbering systems can be applied to a Bioseq as a descriptor or a feature.  For E.coli, we would simply apply the 0.0 - 100.0 floating point numbering system to the map Bioseq.  Gene positions can then be shown to the scientists in familiar map units, while the underlying software still treats positions as large integers, just the same as with any other Bioseq.
\par }\pard \sb240\widctlpar\adjustright {Coordinates on ANY class of Bioseq are ALWAYS integer offsets.  So the first residue in any Bioseq is at position 0.  The last residue of any Bioseq is in position (length - 1).
\par }\pard \sb240\widctlpar\adjustright {The consequence of this design is that one uses EXACTLY the same data object to describe the location of a gene on an unsequenced restriction fragment, a fully sequenced piece of DNA, a partially sequenced piece of DNA, a putative overview of a large genetic region, or a genetic or physical map.  Software to display, manipulate, or compare gene locations can work without change on the full range of possible representations.  Sequence and physical map data can be easily integrated into a single, dynamically assembled view by creating a segmented sequence which points alternatively to raw or constructed Bioseqs and parts of a map Bioseq.  The relationship between a genetic and physical map is simply an alignment between two Bioseqs of representation class map, no different than the alignment between two sequences of class raw generated by a database search program like BLAST or FASTA.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430712}{\*\bkmkstart _Toc300649108}Locations on Biological Sequences{\*\bkmkend _Toc294430712}{\*\bkmkend _Toc300649108}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-loc is an object which defines a location on a Bioseq.  The smooth class hierarchy for Seq-inst makes it possible to use the same Seq-loc to describe an interval on a genetic map as that used to describe an interval on a sequenced molecule.
\par Seq-loc is itself a class hierarchy.  A valid Seq-loc can be an interval, a point, a whole sequence, a series of intervals, and so on.
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Seq-loc ::= CHOICE \{
\par \tab null\tab \tab NULL ,
\par \tab empty\tab \tab Seq-id ,
\par \tab whole\tab \tab Seq-id ,
\par \tab int\tab \tab Seq-interval ,
\par \tab packed-int\tab Packed-seqint ,
\par \tab pnt\tab \tab Seq-point ,
\par \tab packed-pnt\tab Packed-seqpnt ,
\par \tab mix\tab \tab Seq-loc-mix ,
\par \tab equiv\tab \tab Seq-loc-equiv ,
\par \tab bond\tab \tab Seq-bond ,
\par \tab feat\tab \tab Feat-id \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seq-loc.null indicates a region of unknown length for which no data exists.  Such a location may be used in a segmented sequence for the region between two sequenced fragments about which nothing, not even length, is known.
\par All other Seq-loc types, except Seq-loc.feat, contain a Seq-id.  This means they are independent of context.  This means that data objects describing information ABOUT Bioseqs can be created and exchanged independently from the Bioseq itself.  This encourages the development and exchange of structured knowledge about sequence data from many directions and is an essential goal of the data model.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430713}{\*\bkmkstart _Toc300649109}Associating Annotation With Locations On Biological Sequences{\*\bkmkend _Toc294430713}{\*\bkmkend _Toc300649109}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seq-annot, or sequence annotation, is a collection of information ABOUT a sequence, tied to specific regions of Bioseqs through the use of Seq-loc's.  A Bioseq can have many Seq-annot's associated with it.  This allows knowledge from a variety of sources to be collected in a single place but still be attributed to the original sources.  Currently there are three kinds of Seq-annot, feature tables, alignments, and graphs.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430714}{\*\bkmkstart _Toc300649110}Feature Tables{\*\bkmkend _Toc294430714}{\*\bkmkend _Toc300649110}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A feature table is a collection of Seq-feat, or sequence features.  A Seq-feat is designed to tie a Seq-loc together with a datablock, a block of specific data.  Datablocks are defined objects themselves, many of which are objects used in their own right in some other context, such as publications (Pub) or references to organisms (Org-ref) or genes (Gene-ref).  Some datablocks, such as coding regions (CdRegion) make sense only in the context of a Seq-loc.  However, since by design there is no intention that one datablock need to have anything in common with any other datablock, each can be tailored exactly to do a particular job.  If a change or addition is required to one datablock, no others are affected.  In those cases where a pre-existing object from another context is used as a datablock, any software that can use that object can now operate on the feature as well.  For example, a piece of code to display a publication can operate on a publication from a bibliographic database or one use as a sequence feature with no change.
\par Since the Seq-feat data structure itself and the Seq-loc used to attach it to the sequence are common to all features, it is also possible to support a class of operations over all features without regard to the different types of datablocks attached to them.  So a function to determine all features in a particular region of a Bioseq need not care what type of features they are.
\par }\pard \qc\sb240\widctlpar\adjustright {\pard\plain \qc\sb240\widctlpar\adjustright \f16\fs20\cgrid {\object\objemb\rsltmerge\objw6679\objh4501{\*\objclass MSDraw}{\*\objdata 0105000002000000070000004d5344726177000000000000000000200900000800022e021f0100090000036e04000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d0001003c003c00fc03b2020000000000000100030000000000ffffff0000000000ffffff00ffff000100000001000000000001000000000000010c0054696d6573204e657720526f6d616e00015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d7245640300080000004001e000af0be807050000000b02e0004001050000000c0208076f0a030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d724564030008000000500100069003f00607000000fc020000ffffff00ffff040000002d01000008000000fa0206000800080000000000040000002d010100090000001c0690009000f4069403fc054c01040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0102000b000000320a9006e001070000005365712d6c6f63000e00000026060f0012004d72456403000800000060090006a00bf0060400000002010200090000001c0690009000f406a40bfc055c0904000000020101000b000000320a9006f009070000005365712d6c6f63000e00000026060f0012004d72456403000800000040051005b007e0070400000002010200090000001c0692009200e407b4070c053c0504000000020101000b000000320a9006d005080000005365712d666561740e00000026060f001200ffffffff000008000000800350065005d00608000000fa0206001000100000000000040000002d01030004000000f00101000b00000026060f000c004d7245640100020000000000080000002503020090039006400590060b00000026060f000c004d7245640100020000000000080000002503020040059006100560060b00000026060f000c004d72456401000200000000000800000025030200400590061005c0060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000a00750067009d0060b00000026060f000c004d72456401000200000000000800000025030200b0079006600990060b00000026060f000c004d7245640100020000000000080000002503020060099006300960060b00000026060f000c004d72456401000200000000000800000025030200600990063009c0060a00000026060f000a00ffffffff0100000000000b000000320ad005f0090700000070726f64756374000b00000026060f000c004d72456401000200000000000800000025030200600610056006c0030b00000026060f000c004d724564010002000000000008000000250302006006c0039006f0030b00000026060f000c004d724564010002000000000008000000250302006006c0033006f00309000000320a9003000604000000646174610e00000026060f0012004d7245640300080000005001f0002f039f020400000002010200070000001b04a7023703e800480104000000020101000b000000320ae0018001080000004364526567696f6e0e00000026060f001200ffffffff000008000000e003e000af05af020e00000026060f0012004d724564030008000000f003f0009f059f020400000002010200070000001804a702a705e800e80304000000020101000b000000320ae00120040800000047656e652d7265660a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000005006e000b008b0020b00000026060f000c004d724564010002000000000008000000250302008007f0006006a0020b00000026060f000c004d724564010002000000000008000000250302008007f000a008a0020e00000026060f001200ffffffff00000800000050069801b008b0020b00000026060f000c004d724564010002000000000008000000250302006006a002a008a00209000000320ae001200703000000507562000a00000026060f000a00ffffffff0100000000000a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff00000800000080091001af0b80020e00000026060f0012004d724564030008000000900920019f0b70020400000002010200090000001c06900090007802a70b1801880904000000020101000b000000320ae001f00907000000524e412d726566000a00000026060f000a00ffffffff01000000000008000000fa0201000000000000000000040000002d01010004000000f00103000b00000026060f000c004d7245640100020000000000080000002503020040023003800a30030b00000026060f000c004d7245640100020000000000080000002503020040020003400230030b00000026060f000c004d72456401000200000000000800000025030200b0040003b00430030b00000026060f000c004d7245640100020000000000080000002503020050070003500730030b00000026060f000c004d72456401000200000000000800000025030200800a0003800a30030b000000320ad005e001080000006c6f636174696f6e15000000fb02a0ff0000000000009001000000000000001254696d6573204e657720526f6d616e00be3d040000002d01030004000000f001020008000000320ae0016003020000006f7208000000320ae001a008020000006f7208000000320ae0010006020000006f7210000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01020004000000f001030008000000fa02050000000000ffffff00040000002d01030004000000f001010007000000fc020100000000000000040000002d01010004000000f0010000040000002701ffff040000002701ffff030000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff06060606060606060000ffffffffffffffffffffffffffffff01050000050000000d0000004d45544146494c455049435400012e0000fee0ffffe40800000800012e021f00000100090000036e04000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d0001003c003c00fc03b2020000000000000100030000000000ffffff0000000000ffffff00ffff000100000001000000000001000000000000010c0054696d6573204e657720526f6d616e00015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d7245640300080000004001e000af0be807050000000b02e0004001050000000c0208076f0a030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d724564030008000000500100069003f00607000000fc020000ffffff00ffff040000002d01000008000000fa0206000800080000000000040000002d010100090000001c0690009000f4069403fc054c01040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0102000b000000320a9006e001070000005365712d6c6f63000e00000026060f0012004d72456403000800000060090006a00bf0060400000002010200090000001c0690009000f406a40bfc055c0904000000020101000b000000320a9006f009070000005365712d6c6f63000e00000026060f0012004d72456403000800000040051005b007e0070400000002010200090000001c0692009200e407b4070c053c0504000000020101000b000000320a9006d005080000005365712d666561740e00000026060f001200ffffffff000008000000800350065005d00608000000fa0206001000100000000000040000002d01030004000000f00101000b00000026060f000c004d7245640100020000000000080000002503020090039006400590060b00000026060f000c004d7245640100020000000000080000002503020040059006100560060b00000026060f000c004d72456401000200000000000800000025030200400590061005c0060a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000a00750067009d0060b00000026060f000c004d72456401000200000000000800000025030200b0079006600990060b00000026060f000c004d7245640100020000000000080000002503020060099006300960060b00000026060f000c004d72456401000200000000000800000025030200600990063009c0060a00000026060f000a00ffffffff0100000000000b000000320ad005f0090700000070726f64756374000b00000026060f000c004d72456401000200000000000800000025030200600610056006c0030b00000026060f000c004d724564010002000000000008000000250302006006c0039006f0030b00000026060f000c004d724564010002000000000008000000250302006006c0033006f00309000000320a9003000604000000646174610e00000026060f0012004d7245640300080000005001f0002f039f020400000002010200070000001b04a7023703e800480104000000020101000b000000320ae0018001080000004364526567696f6e0e00000026060f001200ffffffff000008000000e003e000af05af020e00000026060f0012004d724564030008000000f003f0009f059f020400000002010200070000001804a702a705e800e80304000000020101000b000000320ae00120040800000047656e652d7265660a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000005006e000b008b0020b00000026060f000c004d724564010002000000000008000000250302008007f0006006a0020b00000026060f000c004d724564010002000000000008000000250302008007f000a008a0020e00000026060f001200ffffffff00000800000050069801b008b0020b00000026060f000c004d724564010002000000000008000000250302006006a002a008a00209000000320ae001200703000000507562000a00000026060f000a00ffffffff0100000000000a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff00000800000080091001af0b80020e00000026060f0012004d724564030008000000900920019f0b70020400000002010200090000001c06900090007802a70b1801880904000000020101000b000000320ae001f00907000000524e412d726566000a00000026060f000a00ffffffff01000000000008000000fa0201000000000000000000040000002d01010004000000f00103000b00000026060f000c004d7245640100020000000000080000002503020040023003800a30030b00000026060f000c004d7245640100020000000000080000002503020040020003400230030b00000026060f000c004d72456401000200000000000800000025030200b0040003b00430030b00000026060f000c004d7245640100020000000000080000002503020050070003500730030b00000026060f000c004d72456401000200000000000800000025030200800a0003800a30030b000000320ad005e001080000006c6f636174696f6e15000000fb02a0ff0000000000009001000000000000001254696d6573204e657720526f6d616e00be3d040000002d01030004000000f001020008000000320ae0016003020000006f7208000000320ae001a008020000006f7208000000320ae0010006020000006f7210000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01020004000000f001030008000000fa02050000000000ffffff00040000002d01030004000000f001010007000000fc020100000000000000040000002d01010004000000f0010000040000002701ffff040000002701ffff030000000000}{\result {\f0 {\pict\wmetafile8\picw11778\pich7938\picwgoal6678\pichgoal4501 \bin2304  	  n   Z        &  ˇˇˇˇ    MrEd Microsoft Draw  Z   & © MrEd ü   ù  < < ¸≤            ˇˇˇ     ˇˇˇ ˇˇ                Times New Roman _  Ø       ˇˇˇ ¿¿¿ ÄÄÄ ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä ˇ ˇ Ä Ä     &  MrEd    @‡ ØË   ‡ @   o
           ˇˇˇ    	                           &  MrEd    P ê   ¸  ˇˇˇ ˇˇ   -     ˙          - 	   ê ê Ùî¸L   .        ˚∞ˇ      ê       Times New Roman      -    2
ê‡   Seq-loc    &  MrEd    `	 †    	   ê ê Ù§¸\	       2
ê	   Seq-loc    &  MrEd    @∞‡    	   í í ‰¥<       2
ê–   Seq-feat   &  ˇˇˇˇ     ÄPP–   ˙          -        &  MrEd         % êê@ê   &  MrEd         % @ê`   &  MrEd         % @ê¿
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     †Pp	–   &  MrEd         % ∞ê`	ê   &  MrEd         % `	ê0	`   &  MrEd         % `	ê0	¿
   & 
 ˇˇˇˇ        2
–	   product    &  MrEd         % ``¿   &  MrEd         % `¿ê   &  MrEd         % `¿0	   2
ê    data   &  MrEd    P /ü       ß7Ë H       2
‡Ä   CdRegion   &  ˇˇˇˇ     ‡‡ ØØ   &  MrEd     üü       ßßË Ë       2
‡    Gene-ref
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     P‡ ∞∞   &  MrEd         % Ä `†   &  MrEd         % Ä ††   &  ˇˇˇˇ     Pò∞∞   &  MrEd         % `†††	   2
‡    Pub 
   & 
 ˇˇˇˇ     
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     Ä	ØÄ   &  MrEd    ê	 üp    	   ê ê xßà	       2
‡	   RNA-ref 
   & 
 ˇˇˇˇ        ˙            -        &  MrEd         % @0Ä
0   &  MrEd         % @ @0   &  MrEd         % ∞ ∞0   &  MrEd         % P P0   &  MrEd         % Ä
 Ä
0   2
–‡   location   ˚†ˇ      ê       Times New Roman æ=   -        2
‡`   or   2
‡†   or   2
‡    or   ˚ 	     º    "System    -        ˙     ˇˇˇ    -        ¸          -         'ˇˇ   'ˇˇ     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ}}}}}{
\par }\pard \sb240\widctlpar\adjustright {A Seq-feat is bipolar in that it contains up to two Seq-loc's.  Seq-feat.location indicates the "source" and is the location similar to the single location in common feature table implementations.  Seq-feat.product is the "sink".  A CdRegion feature would have it's Seq-feat.location on the DNA and it's Seq-feat.product on the protein sequence produced.  Used this way it defines the process of translating a DNA sequence to a protein sequence.  This establishes in an explicit way the important relationship between nucleic acid and protein sequence databases.
\par The presence of two Seq-loc's also allows a more complete representation of data conflicts or exceptional biological circumstances.  If an author presents a DNA sequence and it's protein product in a figure in a paper, it is possible to enter the DNA and protein sequences independently, then confirm through the CdRegion feature that the DNA in fact translates to that protein sequence.  In an unfortunate number of published papers, the DNA presented does not translate to the protein presented.  This may be a signal that the database has made an error of some sort, which can be caught early and corrected.  Or the original paper may be in error.  In this case, the "conflict" flag can be set in CdRegion, but the protein sequence is not lost, and retroactive work can be done to determine the source of the problem.  It may also be the case that a genomic sequence cannot be translated to a protein for a known biological reason, such as RNA editing or suppressor tRNAs.  In this case the "exception" flag can be set in Seq-feat to indicate that the data are correct, but will not behave in the expected way.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430715}{\*\bkmkstart _Toc300649111}Sequence Alignments{\*\bkmkend _Toc294430715}{\*\bkmkend _Toc300649111}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A sequence alignment is essentially a correlation between Seq-locs, often associated with some score.  An alignment is most commonly between two sequences, but it may be among many at once.  In an alignment between two raw Bioseqs, a certain amount of optimization can be done in the data structure based on the knowledge that there is a one to one mapping between the residues of the sequences.  So instead of recording the start and stop in Bioseq A and the start and stop in Bioseq B, it is enough to record the start in A and the start in B and the length of the aligned region.  However if one is aligning a genetic map Bioseq with a physical map Bioseq, then one will wish to allow the aligned regions to distort relative one another to account for the differences from the different mapping techniques.  To accommodate this most general case, there is a Seq-align type which is purely correlation's between Seq-locs of any type, with no constraint that they cover exactly the same number of residues.
\par A Seq-align is considered to be a SEQUENCE OF segments.  Each segment is an unbroken interval on a defined Bioseq, or a gap in that Bioseq.  For example, let us look at the following three dimensional alignment with 6 segments:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par \tab Seq-ids
\par \tab id=100\tab \tab AAGGCCTTTTAGAGATGATGATGATGATGA
\par \tab id=200\tab \tab AAGGCCTaTTAG.......GATGATGATGA
\par \tab id=300\tab \tab ....CCTTTTAGAGATGATGAT....ATGA
\par \tab \tab \tab \tab | 1 |   2   |   3  | 4| 5 | 6 |  Segments
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\object\objemb\rsltmerge\objw8780\objh6519\objscalex98\objscaley99{\*\objclass MSDraw}{\*\objdata 0105000002000000070000004d53447261770000000000000000000018000008007b3ce82c010009000003e30b000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000000000000100030000000000ffffff0000000000ffffff000000000100000001000000000001000000000000010c0053797374656d0003008a00ff00290003015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d72456403000800000060008800170eb70a050000000b0288006000050000000c022f0ab70d030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d7245640300080000002d0bdf010f0eaf0a07000000fc020000ffffff00ffff040000002d01000008000000fa0206000000000000000000040000002d010100090000001c06a100a100af0a0f0edf012d0b0e00000026060f0012004d724564030008000000f903df01db06af0a090000001c06a100a100af0adb06df01f9030e00000026060f0012004d7245640300080000009307df01760aaf0a090000001c06a100a100af0a760adf0193070e00000026060f0012004d724564030008000000180190009d033f0208000000fa0206000800080000000000040000002d01020004000000f0010100090000001c06900090004302a1038c001401040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0101000c000000320a7f01d001090000005365712d616c69676e0008000000fa0206001000100000000000040000002d01030004000000f00102000b00000026060f000c004d724564010002000000000008000000250302005b026f0289023f020b00000026060f000c004d724564010002000000000008000000250302005b026f022c023f020e00000026060f0012004d724564030008000000d0016f02e5028f0304000000020102000700000018049703ed026702c801040000000201010008000000320a2f032c020100000031000e00000026060f001200ffffffff000008000000d502bf028f066f030b00000026060f000c004d72456401000200000000000800000025030200e502ff025604ff020b00000026060f000c004d724564010002000000000008000000250302005604ff022704cf020b00000026060f000c004d724564010002000000000008000000250302005604ff0227042f030e00000026060f0012004d7245640300080000005604cf027f065f030400000002010200090000001c069000900067038706c7024e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06bf02280a6f030b00000026060f000c004d724564010002000000000008000000250302007f06ff02ef07ff020b00000026060f000c004d72456401000200000000000800000025030200ef07ff02c107cf020b00000026060f000c004d72456401000200000000000800000025030200ef07ff02c1072f030e00000026060f0012004d724564030008000000ef07cf02180a5f03090000001c06900090006703200ac702e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080abf02c20d6f030b00000026060f000c004d72456401000200000000000800000025030200180aff02890bff020b00000026060f000c004d72456401000200000000000800000025030200890bff025b0bcf020b00000026060f000c004d72456401000200000000000800000025030200890bff025b0b2f030e00000026060f0012004d724564030008000000890bcf02b20d5f03090000001c06900090006703ba0dc702810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02bf0389028f030b00000026060f000c004d724564010002000000000008000000250302005b02bf032c028f030e00000026060f0012004d724564030008000000d001bf03e502df04070000001804e704ed02b703c8010e00000026060f001200ffffffff000008000000d5020f048f06bf040b00000026060f000c004d72456401000200000000000800000025030200e5024f0456044f040b00000026060f000c004d7245640100020000000000080000002503020056044f0427041f040b00000026060f000c004d7245640100020000000000080000002503020056044f0427047f040e00000026060f0012004d72456403000800000056041f047f06af04090000001c0690009000b704870617044e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f060f04280abf040b00000026060f000c004d724564010002000000000008000000250302007f064f04ef074f040b00000026060f000c004d72456401000200000000000800000025030200ef074f04c1071f040b00000026060f000c004d72456401000200000000000800000025030200ef074f04c1077f040e00000026060f0012004d724564030008000000ef071f04180aaf04090000001c0690009000b704200a1704e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a0f04c20dbf040b00000026060f000c004d72456401000200000000000800000025030200180a4f04890b4f040b00000026060f000c004d72456401000200000000000800000025030200890b4f045b0b1f040b00000026060f000c004d72456401000200000000000800000025030200890b4f045b0b7f040e00000026060f0012004d724564030008000000890b1f04b20daf04090000001c0690009000b704ba0d1704810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b020f058902df040b00000026060f000c004d724564010002000000000008000000250302005b020f052c02df040e00000026060f0012004d724564030008000000d0010f05e5022f060700000018043706ed020705c8010e00000026060f001200ffffffff000008000000d5025f058f060f060b00000026060f000c004d72456401000200000000000800000025030200e5029f0556049f050b00000026060f000c004d7245640100020000000000080000002503020056049f0527046f050b00000026060f000c004d7245640100020000000000080000002503020056049f052704cf050e00000026060f0012004d72456403000800000056046f057f06ff05090000001c06900090000706870667054e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f065f05280a0f060b00000026060f000c004d724564010002000000000008000000250302007f069f05ef079f050b00000026060f000c004d72456401000200000000000800000025030200ef079f05c1076f050b00000026060f000c004d72456401000200000000000800000025030200ef079f05c107cf050e00000026060f0012004d724564030008000000ef076f05180aff05090000001c06900090000706200a6705e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a5f05c20d0f060b00000026060f000c004d72456401000200000000000800000025030200180a9f05890b9f050b00000026060f000c004d72456401000200000000000800000025030200890b9f055b0b6f050b00000026060f000c004d72456401000200000000000800000025030200890b9f055b0bcf050e00000026060f0012004d724564030008000000890b6f05b20dff05090000001c06900090000706ba0d6705810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b025f0689022f060b00000026060f000c004d724564010002000000000008000000250302005b025f062c022f060e00000026060f0012004d724564030008000000d0015f06e5027f070700000018048707ed025706c8010e00000026060f001200ffffffff000008000000d502af068f065f070b00000026060f000c004d72456401000200000000000800000025030200e502ef065604ef060b00000026060f000c004d724564010002000000000008000000250302005604ef062704bf060b00000026060f000c004d724564010002000000000008000000250302005604ef0627041f070e00000026060f0012004d7245640300080000005604bf067f064f07090000001c069000900057078706b7064e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06af06280a5f070b00000026060f000c004d724564010002000000000008000000250302007f06ef06ef07ef060b00000026060f000c004d72456401000200000000000800000025030200ef07ef06c107bf060b00000026060f000c004d72456401000200000000000800000025030200ef07ef06c1071f070e00000026060f0012004d724564030008000000ef07bf06180a4f07090000001c06900090005707200ab706e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080aaf06c20d5f070b00000026060f000c004d72456401000200000000000800000025030200180aef06890bef060b00000026060f000c004d72456401000200000000000800000025030200890bef065b0bbf060b00000026060f000c004d72456401000200000000000800000025030200890bef065b0b1f070e00000026060f0012004d724564030008000000890bbf06b20d4f07090000001c06900090005707ba0db706810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02af0789027f070b00000026060f000c004d724564010002000000000008000000250302005b02af072c027f070e00000026060f0012004d724564030008000000d001af07e502cf08070000001804d708ed02a707c8010e00000026060f001200ffffffff000008000000d502ff078f06af080b00000026060f000c004d72456401000200000000000800000025030200e5023f0856043f080b00000026060f000c004d7245640100020000000000080000002503020056043f0827040f080b00000026060f000c004d7245640100020000000000080000002503020056043f0827046f080e00000026060f0012004d72456403000800000056040f087f069f08090000001c0690009000a708870607084e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06ff07280aaf080b00000026060f000c004d724564010002000000000008000000250302007f063f08ef073f080b00000026060f000c004d72456401000200000000000800000025030200ef073f08c1070f080b00000026060f000c004d72456401000200000000000800000025030200ef073f08c1076f080e00000026060f0012004d724564030008000000ef070f08180a9f08090000001c0690009000a708200a0708e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080aff07c20daf080b00000026060f000c004d72456401000200000000000800000025030200180a3f08890b3f080b00000026060f000c004d72456401000200000000000800000025030200890b3f085b0b0f080b00000026060f000c004d72456401000200000000000800000025030200890b3f085b0b6f080e00000026060f0012004d724564030008000000890b0f08b20d9f08090000001c0690009000a708ba0d0708810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02ff088902cf080b00000026060f000c004d724564010002000000000008000000250302005b02ff082c02cf080e00000026060f0012004d724564030008000000d001ff08e5021f0a070000001804270aed02f708c8010e00000026060f001200ffffffff000008000000d5024f098f06ff090b00000026060f000c004d72456401000200000000000800000025030200e5028f0956048f090b00000026060f000c004d7245640100020000000000080000002503020056048f0927045f090b00000026060f000c004d7245640100020000000000080000002503020056048f092704bf090e00000026060f0012004d72456403000800000056045f097f06ef09090000001c0690009000f709870657094e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f064f09280aff090b00000026060f000c004d724564010002000000000008000000250302007f068f09ef078f090b00000026060f000c004d72456401000200000000000800000025030200ef078f09c1075f090b00000026060f000c004d72456401000200000000000800000025030200ef078f09c107bf090e00000026060f0012004d724564030008000000ef075f09180aef09090000001c0690009000f709200a5709e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a4f09c20dff090b00000026060f000c004d72456401000200000000000800000025030200180a8f09890b8f090b00000026060f000c004d72456401000200000000000800000025030200890b8f095b0b5f090b00000026060f000c004d72456401000200000000000800000025030200890b8f095b0bbf090e00000026060f0012004d724564030008000000890b5f09b20def09090000001c0690009000f709ba0d5709810b0a00000026060f000a00ffffffff01000000000004000000020101000b000000320a2f038404080000003130303a20302d340b000000320a2f034c08080000003230303a20302d340c000000320a2f03e50b0a0000003330303a20656d70747908000000320a7f042c020100000032000c000000320a7f048404090000003130303a20352d31320008000000320acf052c020100000033000c000000320a7f044c08090000003230303a20352d3132000b000000320a7f04e50b080000003330303a20302d370c000000320acf0584040a0000003130303a2031332d31390c000000320acf054c080a0000003230303a20656d7074790c000000320acf05e50b090000003330303a20382d31340008000000320a1f072c0201000000340008000000320a6f082c0201000000350008000000320abf092c020100000036000c000000320a1f0784040a0000003130303a2032302d32320c000000320a1f074c080a0000003230303a2031332d31350c000000320a6f0884040a0000003130303a2032332d32360c000000320a1f07e50b0a0000003330303a2031352d31370c000000320a6f084c080a0000003230303a2031362d31390c000000320a6f08e50b0a0000003330303a20656d7074790c000000320abf0984040a0000003130303a2032372d33300c000000320abf094c080a0000003230303a2032302d32330c000000320abf09e50b0a0000003330303a2031382d32310b000000320a2f036000070000005365676d656e74000b000000320a7f046000070000005365676d656e74000b000000320acf056000070000005365676d656e74000b000000320a1f076000070000005365676d656e74000b000000320a6f086000070000005365676d656e74000b000000320abf096000070000005365676d656e74000c000000320aaf01b2040a00000042696f736571203130300c000000320aaf014c080a00000042696f736571203230300c000000320aaf01b70b0a00000042696f7365712033303010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01020004000000f001010008000000fa02050000000000ffffff00040000002d01010004000000f001030007000000fc020100000000000000040000002d01030004000000f0010000040000002701ffff040000002701ffff030000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000ffffffffffffffffff0001050000050000000d0000004d45544146494c4550494354007b3c000019d3ffffce17000008007b3ce72c0000010009000003e30b000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000000000000100030000000000ffffff0000000000ffffff000000000100000001000000000001000000000000010c0053797374656d0003008a00ff00290003015f0b020011000301af0d0200120003100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d72456403000800000060008800170eb70a050000000b0288006000050000000c022f0ab70d030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d7245640300080000002d0bdf010f0eaf0a07000000fc020000ffffff00ffff040000002d01000008000000fa0206000000000000000000040000002d010100090000001c06a100a100af0a0f0edf012d0b0e00000026060f0012004d724564030008000000f903df01db06af0a090000001c06a100a100af0adb06df01f9030e00000026060f0012004d7245640300080000009307df01760aaf0a090000001c06a100a100af0a760adf0193070e00000026060f0012004d724564030008000000180190009d033f0208000000fa0206000800080000000000040000002d01020004000000f0010100090000001c06900090004302a1038c001401040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e000000040000002d0101000c000000320a7f01d001090000005365712d616c69676e0008000000fa0206001000100000000000040000002d01030004000000f00102000b00000026060f000c004d724564010002000000000008000000250302005b026f0289023f020b00000026060f000c004d724564010002000000000008000000250302005b026f022c023f020e00000026060f0012004d724564030008000000d0016f02e5028f0304000000020102000700000018049703ed026702c801040000000201010008000000320a2f032c020100000031000e00000026060f001200ffffffff000008000000d502bf028f066f030b00000026060f000c004d72456401000200000000000800000025030200e502ff025604ff020b00000026060f000c004d724564010002000000000008000000250302005604ff022704cf020b00000026060f000c004d724564010002000000000008000000250302005604ff0227042f030e00000026060f0012004d7245640300080000005604cf027f065f030400000002010200090000001c069000900067038706c7024e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06bf02280a6f030b00000026060f000c004d724564010002000000000008000000250302007f06ff02ef07ff020b00000026060f000c004d72456401000200000000000800000025030200ef07ff02c107cf020b00000026060f000c004d72456401000200000000000800000025030200ef07ff02c1072f030e00000026060f0012004d724564030008000000ef07cf02180a5f03090000001c06900090006703200ac702e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080abf02c20d6f030b00000026060f000c004d72456401000200000000000800000025030200180aff02890bff020b00000026060f000c004d72456401000200000000000800000025030200890bff025b0bcf020b00000026060f000c004d72456401000200000000000800000025030200890bff025b0b2f030e00000026060f0012004d724564030008000000890bcf02b20d5f03090000001c06900090006703ba0dc702810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02bf0389028f030b00000026060f000c004d724564010002000000000008000000250302005b02bf032c028f030e00000026060f0012004d724564030008000000d001bf03e502df04070000001804e704ed02b703c8010e00000026060f001200ffffffff000008000000d5020f048f06bf040b00000026060f000c004d72456401000200000000000800000025030200e5024f0456044f040b00000026060f000c004d7245640100020000000000080000002503020056044f0427041f040b00000026060f000c004d7245640100020000000000080000002503020056044f0427047f040e00000026060f0012004d72456403000800000056041f047f06af04090000001c0690009000b704870617044e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f060f04280abf040b00000026060f000c004d724564010002000000000008000000250302007f064f04ef074f040b00000026060f000c004d72456401000200000000000800000025030200ef074f04c1071f040b00000026060f000c004d72456401000200000000000800000025030200ef074f04c1077f040e00000026060f0012004d724564030008000000ef071f04180aaf04090000001c0690009000b704200a1704e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a0f04c20dbf040b00000026060f000c004d72456401000200000000000800000025030200180a4f04890b4f040b00000026060f000c004d72456401000200000000000800000025030200890b4f045b0b1f040b00000026060f000c004d72456401000200000000000800000025030200890b4f045b0b7f040e00000026060f0012004d724564030008000000890b1f04b20daf04090000001c0690009000b704ba0d1704810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b020f058902df040b00000026060f000c004d724564010002000000000008000000250302005b020f052c02df040e00000026060f0012004d724564030008000000d0010f05e5022f060700000018043706ed020705c8010e00000026060f001200ffffffff000008000000d5025f058f060f060b00000026060f000c004d72456401000200000000000800000025030200e5029f0556049f050b00000026060f000c004d7245640100020000000000080000002503020056049f0527046f050b00000026060f000c004d7245640100020000000000080000002503020056049f052704cf050e00000026060f0012004d72456403000800000056046f057f06ff05090000001c06900090000706870667054e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f065f05280a0f060b00000026060f000c004d724564010002000000000008000000250302007f069f05ef079f050b00000026060f000c004d72456401000200000000000800000025030200ef079f05c1076f050b00000026060f000c004d72456401000200000000000800000025030200ef079f05c107cf050e00000026060f0012004d724564030008000000ef076f05180aff05090000001c06900090000706200a6705e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a5f05c20d0f060b00000026060f000c004d72456401000200000000000800000025030200180a9f05890b9f050b00000026060f000c004d72456401000200000000000800000025030200890b9f055b0b6f050b00000026060f000c004d72456401000200000000000800000025030200890b9f055b0bcf050e00000026060f0012004d724564030008000000890b6f05b20dff05090000001c06900090000706ba0d6705810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b025f0689022f060b00000026060f000c004d724564010002000000000008000000250302005b025f062c022f060e00000026060f0012004d724564030008000000d0015f06e5027f070700000018048707ed025706c8010e00000026060f001200ffffffff000008000000d502af068f065f070b00000026060f000c004d72456401000200000000000800000025030200e502ef065604ef060b00000026060f000c004d724564010002000000000008000000250302005604ef062704bf060b00000026060f000c004d724564010002000000000008000000250302005604ef0627041f070e00000026060f0012004d7245640300080000005604bf067f064f07090000001c069000900057078706b7064e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06af06280a5f070b00000026060f000c004d724564010002000000000008000000250302007f06ef06ef07ef060b00000026060f000c004d72456401000200000000000800000025030200ef07ef06c107bf060b00000026060f000c004d72456401000200000000000800000025030200ef07ef06c1071f070e00000026060f0012004d724564030008000000ef07bf06180a4f07090000001c06900090005707200ab706e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080aaf06c20d5f070b00000026060f000c004d72456401000200000000000800000025030200180aef06890bef060b00000026060f000c004d72456401000200000000000800000025030200890bef065b0bbf060b00000026060f000c004d72456401000200000000000800000025030200890bef065b0b1f070e00000026060f0012004d724564030008000000890bbf06b20d4f07090000001c06900090005707ba0db706810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02af0789027f070b00000026060f000c004d724564010002000000000008000000250302005b02af072c027f070e00000026060f0012004d724564030008000000d001af07e502cf08070000001804d708ed02a707c8010e00000026060f001200ffffffff000008000000d502ff078f06af080b00000026060f000c004d72456401000200000000000800000025030200e5023f0856043f080b00000026060f000c004d7245640100020000000000080000002503020056043f0827040f080b00000026060f000c004d7245640100020000000000080000002503020056043f0827046f080e00000026060f0012004d72456403000800000056040f087f069f08090000001c0690009000a708870607084e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f06ff07280aaf080b00000026060f000c004d724564010002000000000008000000250302007f063f08ef073f080b00000026060f000c004d72456401000200000000000800000025030200ef073f08c1070f080b00000026060f000c004d72456401000200000000000800000025030200ef073f08c1076f080e00000026060f0012004d724564030008000000ef070f08180a9f08090000001c0690009000a708200a0708e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080aff07c20daf080b00000026060f000c004d72456401000200000000000800000025030200180a3f08890b3f080b00000026060f000c004d72456401000200000000000800000025030200890b3f085b0b0f080b00000026060f000c004d72456401000200000000000800000025030200890b3f085b0b6f080e00000026060f0012004d724564030008000000890b0f08b20d9f08090000001c0690009000a708ba0d0708810b0a00000026060f000a00ffffffff0100000000000b00000026060f000c004d724564010002000000000008000000250302005b02ff088902cf080b00000026060f000c004d724564010002000000000008000000250302005b02ff082c02cf080e00000026060f0012004d724564030008000000d001ff08e5021f0a070000001804270aed02f708c8010e00000026060f001200ffffffff000008000000d5024f098f06ff090b00000026060f000c004d72456401000200000000000800000025030200e5028f0956048f090b00000026060f000c004d7245640100020000000000080000002503020056048f0927045f090b00000026060f000c004d7245640100020000000000080000002503020056048f092704bf090e00000026060f0012004d72456403000800000056045f097f06ef09090000001c0690009000f709870657094e040a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff0000080000006f064f09280aff090b00000026060f000c004d724564010002000000000008000000250302007f068f09ef078f090b00000026060f000c004d72456401000200000000000800000025030200ef078f09c1075f090b00000026060f000c004d72456401000200000000000800000025030200ef078f09c107bf090e00000026060f0012004d724564030008000000ef075f09180aef09090000001c0690009000f709200a5709e7070a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000080a4f09c20dff090b00000026060f000c004d72456401000200000000000800000025030200180a8f09890b8f090b00000026060f000c004d72456401000200000000000800000025030200890b8f095b0b5f090b00000026060f000c004d72456401000200000000000800000025030200890b8f095b0bbf090e00000026060f0012004d724564030008000000890b5f09b20def09090000001c0690009000f709ba0d5709810b0a00000026060f000a00ffffffff01000000000004000000020101000b000000320a2f038404080000003130303a20302d340b000000320a2f034c08080000003230303a20302d340c000000320a2f03e50b0a0000003330303a20656d70747908000000320a7f042c020100000032000c000000320a7f048404090000003130303a20352d31320008000000320acf052c020100000033000c000000320a7f044c08090000003230303a20352d3132000b000000320a7f04e50b080000003330303a20302d370c000000320acf0584040a0000003130303a2031332d31390c000000320acf054c080a0000003230303a20656d7074790c000000320acf05e50b090000003330303a20382d31340008000000320a1f072c0201000000340008000000320a6f082c0201000000350008000000320abf092c020100000036000c000000320a1f0784040a0000003130303a2032302d32320c000000320a1f074c080a0000003230303a2031332d31350c000000320a6f0884040a0000003130303a2032332d32360c000000320a1f07e50b0a0000003330303a2031352d31370c000000320a6f084c080a0000003230303a2031362d31390c000000320a6f08e50b0a0000003330303a20656d7074790c000000320abf0984040a0000003130303a2032372d33300c000000320abf094c080a0000003230303a2032302d32330c000000320abf09e50b0a0000003330303a2031382d32310b000000320a2f036000070000005365676d656e74000b000000320a7f046000070000005365676d656e74000b000000320acf056000070000005365676d656e74000b000000320a1f076000070000005365676d656e74000b000000320a6f086000070000005365676d656e74000b000000320abf096000070000005365676d656e74000c000000320aaf01b2040a00000042696f736571203130300c000000320aaf014c080a00000042696f736571203230300c000000320aaf01b70b0a00000042696f7365712033303010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01020004000000f001010008000000fa02050000000000ffffff00040000002d01010004000000f001030007000000fc020100000000000000040000002d01030004000000f0010000040000002701ffff040000002701ffff030000000000}{\result {\f0 {\pict\wmetafile8\picw15483\pich11496\picwgoal8779\pichgoal6518 \picscalex98\picscaley99 \bin6112  	  „   Z        &  ˇˇˇˇ    MrEd Microsoft Draw  Z   & © MrEd ü   ù  ˇˇˇˇˇˇˇˇ            ˇˇˇ     ˇˇˇ                   System  ä ˇ ) _  Ø       ˇˇˇ ¿¿¿ ÄÄÄ ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä ˇ ˇ Ä Ä     &  MrEd    ` à ∑
   à `    /
∑           ˇˇˇ    	                           &  MrEd    -ﬂØ
   ¸  ˇˇˇ ˇˇ   -     ˙            - 	   ° ° Ø
ﬂ-   &  MrEd    ˘ﬂ€Ø
	   ° ° Ø
€ﬂ˘   &  MrEd    ìﬂv
Ø
	   ° ° Ø
v
ﬂì   &  MrEd    ê ù?   ˙          -     	   ê ê C°å    .        ˚∞ˇ      ê       Times New Roman      -    2
–	   Seq-align    ˙          -        &  MrEd         % [oâ?   &  MrEd         % [o,?   &  MrEd    –oÂè       óÌg»       2
/,   1    &  ˇˇˇˇ     ’øèo   &  MrEd         % ÂˇVˇ   &  MrEd         % Vˇ'œ   &  MrEd         % Vˇ'/   &  MrEd    Vœ_    	   ê ê gá«N
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     oø(
o   &  MrEd         % ˇÔˇ   &  MrEd         % Ôˇ¡œ   &  MrEd         % Ôˇ¡/   &  MrEd    Ôœ
_	   ê ê g 
«Á
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
ø¬o   &  MrEd         % 
ˇâˇ   &  MrEd         % âˇ[œ   &  MrEd         % âˇ[/   &  MrEd    âœ≤_	   ê ê g∫«Å
   & 
 ˇˇˇˇ        &  MrEd         % [øâè   &  MrEd         % [ø,è   &  MrEd    –øÂﬂ   ÁÌ∑»   &  ˇˇˇˇ     ’èø   &  MrEd         % ÂOVO   &  MrEd         % VO'   &  MrEd         % VO'   &  MrEd    VØ	   ê ê ∑áN
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     o(
ø   &  MrEd         % OÔO   &  MrEd         % ÔO¡   &  MrEd         % ÔO¡   &  MrEd    Ô
Ø	   ê ê ∑ 
Á
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
¬ø   &  MrEd         % 
OâO   &  MrEd         % âO[   &  MrEd         % âO[   &  MrEd    â≤Ø	   ê ê ∑∫Å
   & 
 ˇˇˇˇ        &  MrEd         % [âﬂ   &  MrEd         % [,ﬂ   &  MrEd    –Â/   7Ì»   &  ˇˇˇˇ     ’_è   &  MrEd         % ÂüVü   &  MrEd         % Vü'o   &  MrEd         % Vü'œ   &  MrEd    Voˇ	   ê ê ágN
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     o_(
   &  MrEd         % üÔü   &  MrEd         % Ôü¡o   &  MrEd         % Ôü¡œ   &  MrEd    Ôo
ˇ	   ê ê  
gÁ
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
_¬   &  MrEd         % 
üâü   &  MrEd         % âü[o   &  MrEd         % âü[œ   &  MrEd    âo≤ˇ	   ê ê ∫gÅ
   & 
 ˇˇˇˇ        &  MrEd         % [_â/   &  MrEd         % [_,/   &  MrEd    –_Â   áÌW»   &  ˇˇˇˇ     ’Øè_   &  MrEd         % ÂÔVÔ   &  MrEd         % VÔ'ø   &  MrEd         % VÔ'   &  MrEd    VøO	   ê ê Wá∑N
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     oØ(
_   &  MrEd         % ÔÔÔ   &  MrEd         % ÔÔ¡ø   &  MrEd         % ÔÔ¡   &  MrEd    Ôø
O	   ê ê W 
∑Á
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
Ø¬_   &  MrEd         % 
ÔâÔ   &  MrEd         % âÔ[ø   &  MrEd         % âÔ[   &  MrEd    âø≤O	   ê ê W∫∑Å
   & 
 ˇˇˇˇ        &  MrEd         % [Øâ   &  MrEd         % [Ø,   &  MrEd    –ØÂœ   ◊Ìß»   &  ˇˇˇˇ     ’ˇèØ   &  MrEd         % Â?V?   &  MrEd         % V?'   &  MrEd         % V?'o   &  MrEd    Vü	   ê ê ßáN
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     oˇ(
Ø   &  MrEd         % ?Ô?   &  MrEd         % Ô?¡   &  MrEd         % Ô?¡o   &  MrEd    Ô
ü	   ê ê ß 
Á
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
ˇ¬Ø   &  MrEd         % 
?â?   &  MrEd         % â?[   &  MrEd         % â?[o   &  MrEd    â≤ü	   ê ê ß∫Å
   & 
 ˇˇˇˇ        &  MrEd         % [ˇâœ   &  MrEd         % [ˇ,œ   &  MrEd    –ˇÂ
   '
Ì˜»   &  ˇˇˇˇ     ’O	èˇ	   &  MrEd         % Âè	Vè	   &  MrEd         % Vè	'_	   &  MrEd         % Vè	'ø	   &  MrEd    V_	Ô		   ê ê ˜	áW	N
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     oO	(
ˇ	   &  MrEd         % è	Ôè	   &  MrEd         % Ôè	¡_	   &  MrEd         % Ôè	¡ø	   &  MrEd    Ô_	
Ô		   ê ê ˜	 
W	Á
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     
O	¬ˇ	   &  MrEd         % 
è	âè	   &  MrEd         % âè	[_	   &  MrEd         % âè	[ø	   &  MrEd    â_	≤Ô		   ê ê ˜	∫W	Å
   & 
 ˇˇˇˇ            2
/Ñ   100: 0-4   2
/L   200: 0-4   2
/Â
   300: empty   2
,   2    2
Ñ	   100: 5-12    2
œ,   3    2
L	   200: 5-12    2
Â   300: 0-7   2
œÑ
   100: 13-19   2
œL
   200: empty   2
œÂ	   300: 8-14    2
,   4    2
o,   5    2
ø	,   6    2
Ñ
   100: 20-22   2
L
   200: 13-15   2
oÑ
   100: 23-26   2
Â
   300: 15-17   2
oL
   200: 16-19   2
oÂ
   300: empty   2
ø	Ñ
   100: 27-30   2
ø	L
   200: 20-23   2
ø	Â
   300: 18-21   2
/`    Segment    2
`    Segment    2
œ`    Segment    2
`    Segment    2
o`    Segment    2
ø	`    Segment    2
Ø≤
   Bioseq 100   2
ØL
   Bioseq 200   2
Ø∑
   Bioseq 300   ˚ 	     º    "System    -        ˙     ˇˇˇ    -        ¸          -         'ˇˇ   'ˇˇ     ˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇˇ}}}}}{
\par The example above is a global alignment, that is each segment sequentially maps a region of each Bioseq to a region of the others.  An alignment can also be of type "diags", which is just a collection of segments with no implication about the logic of joining one segment to the next.  This is equivalent to the diagonal lines that are shown on a dot-matrix plot.
\par The example above illustrates the most general form of a Seq-align, Std-seg, where each segment is purely a correlated set of Seq-loc.  Two other forms of Seq-align allow denser packing of data for when only raw Bioseqs are aligned.  These are Dense-seg, for global alignments, and Dense-diag for "diag" collections.  The basic underlying model for these denser types is very similar to that shown above, but the data structure itself is somewhat different.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430716}{\*\bkmkstart _Toc300649112}Sequence Graph{\*\bkmkend _Toc294430716}{\*\bkmkend _Toc300649112}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The third annotation type is a graph on a sequence, Seq-graph.  It is basically a Seq-loc, over which to apply the graph, and a series of numbers representing values of the graph along the sequence.  A software tool which calculates base composition or hydrophobic tendency might generate a Seq-graph.  Additional fields in Seq-graph allow specification of axis labels, setting of ranges covered, compression of the data relative to the sequence, and so on.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430717}{\*\bkmkstart _Toc300649113}Collections of Related Biological Sequences{\*\bkmkend _Toc294430717}{\*\bkmkend _Toc300649113}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It is often useful, even "natural", to package a group of sequences together.  Some examples are a segmented Bioseq and the Bioseqs that make up its parts, a DNA sequence and it's translated proteins, the separate chains of a multi-chain molecule, and so on.  A Bioseq-set is such a collection of Bioseqs.
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Bioseq-set ::= SEQUENCE \{
\par \tab id\tab Object-id\tab OPTIONAL ,
\par \tab coll\tab Dbtag\tab \tab OPTIONAL ,
\par \tab level\tab INTEGER\tab OPTIONAL ,
\par \tab class\tab ENUMERATED \{
\par \tab \tab \tab not-set (0) ,
\par \tab \tab \tab nuc-prot (1) ,
\par \tab \tab \tab segset (2) ,
\par \tab \tab \tab conset (3) ,
\par \tab \tab \tab parts (4) ,
\par \tab \tab \tab gibb (5) ,
\par \tab \tab \tab gi (6) ,
\par \tab \tab \tab genbank (7) ,
\par \tab \tab \tab  pir (8) ,\tab 
\par \tab \tab \tab pub-set (9) ,
\par \tab \tab \tab equiv (10) ,
\par \tab \tab \tab swissprot (11) ,
\par \tab \tab \tab pdb-entry (12) ,
\par  \tab \tab \tab other (255) \} DEFAULT not-set ,
\par \tab release\tab VisibleString\tab OPTIONAL ,
\par \tab date\tab Date\tab \tab OPTIONAL ,
\par \tab descr\tab Seq-descr\tab OPTIONAL ,
\par \tab seq-set\tab SEQUENCE OF Seq-entry ,
\par \tab annot\tab SET OF Seq-annot OPTIONAL \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The basic structure of a Bioseq-set is very similar to that of a Bioseq.  Instead of Bioseq.id, there is a series of identifier and descriptive fields for the set.  A Bioseq-set is only a convenient way of packaging sequences so controlled, stable identifiers are less important for them than they are for Bioseqs.  After the first few fields the structure is exactly parallel to a Bioseq.
\par There are descriptors which describe aspects of the collection and the Bioseqs within the collection.  The general rule for descriptors in a Bioseq-set is that they apply to "all of everything below".  That is, a Bioseq-set of human sequences need have only one Org-ref descriptor for "human" at the top level of the set, and it is applied to all Bioseqs within the set.
\par Then follows the equivalent of Seq-inst, that is the instantiation of the data.  In this case, the data is the chain of contained Bioseqs or Bioseq-sets.  A Seq-entry is either a Bioseq or Bioseq-set.  Seq-entry's are very often used as arguments to display and analysis functions, since one can move around either a single Bioseq or a collection of related Bioseqs in context just as easily.  This also makes a Bioseq-set recursive.  That is, it may consist of collections of collections.
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Seq-entry ::= CHOICE \{
\par \tab seq\tab Bioseq ,
\par \tab set\tab Bioseq-set \} 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, a Bioseq-set may contain Seq-annot's.  Generally one would put the Seq-annot's which apply to more than one Bioseq in the Bioseq-set at this level.  Examples would be CdRegion features that point to DNA and protein Bioseqs, or Seq-align which align more than one Bioseq with each other.  However, since Seq-annot's always explicitly cite a Seq-id, it does not matter, in terms of meaning, at what level they are put.  This is in contrast to descriptors, where context does matter.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430718}{\*\bkmkstart _Toc300649114}Consequences of the Data Model{\*\bkmkend _Toc294430718}{\*\bkmkend _Toc300649114}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This data model has profound consequences for building sequence databases and for researchers and software tools interacting with them.  Assuming that Seq-ids point to stable coordinate systems, it is easily possible to consider the whole set of data conforming to the model as a distributed, active heterogeneous database.  For example, let us suppose that two raw Bioseqs with Seq-ids "A" and "B" are published in the scientific literature and appear in the large public sequence databases.  They are both genomic nucleic acid sequences from human, each coding for a single protein.
\par One researcher is a specialist in transcription initiation.  He finds additional experimental information involving detailed work on initiation for the flanking region of Bioseq "A".  He can then submit a feature table with a TxInit feature in it to the database with his summarized data.  He need not contact the original author of "A", nor edit the original sequence entry for "A" to do this.  The database staff, who are not experts in transcription initiation, need not attempt to annotate every transcription initiation paper in sufficient detail and accuracy to be of interest to a specialist in the area.  The researcher submitting the feature need not use any particular software system or computer to participate, he need only submit a ASN.1 message which conforms to the specification for a feature.
\par Another researcher is a medical geneticist who is interested in the medical consequences of mutations in the gene on Bioseq "B".  This individual can add annotation to "B" which is totally different in content to that added by the transcription specialist (in fact, it is unlikely that either follows the literature read by the other) and submit the data to the database in precisely the same way.
\par A third group may be doing bulk sequencing in the region of the human chromosome where "A" and "B" lie.  They produce a third sequence, "C", which they discover by sequence similarity and mapping data, overlaps "A" at one end and "B" at the other.  This group can submit not just the sequence of "C" but it's relationship to "A" and "B" to the database and as part of their publication.
\par The database now has the information from five different research groups, experts in different fields, using different computer and software systems, and unaware, in many cases, of each other's work, to unambiguously pull together all this related information into an integrated high level view through the use of the shared data model and the controlled Seq-ids on common cited coordinate systems.  This integration across disciplines and generation of high level views of the data is continuously and automatically available to all users and can be updated immediately on the arrival of new data without human intervention or interpretation by the database staff.  This moves scientific databases from the role of curators of scientific data to the role of facilitators of discourse among researchers.  It makes identification of potentially fruitful connections across disciplines an automatic result of data entry, rather than of painstaking analysis by a central group.  It takes advantage of the growing rush of molecular biology data, making its volume and diversity advantages rather than liabilities.
\par }{\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\object\objemb\rsltmerge\objw9642\objh8002\objscalex89\objscaley89{\*\objclass MSDraw}{\*\objdata 0105000002000000070000004d5344726177000000000000000000a00f000008006c421f37010009000003b707000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000e70000000100030000000000ffffff0000000000ffffff000200000100000001000000000001002e00000000010c0053797374656d007720746f205573652048656c7000000095012657696e646f77100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d724564030008000000b0ff2000c00ea00c050000000b022000b0ff050000000c02800c100f030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d7245640300080000006000a005ef06500707000000fc020000ffffff00ffff040000002d01000008000000fa0206001000100000000000040000002d010100070000001b045807f706980558000e00000026060f001200ffffffff0000080000001001f005a00670060e00000026060f0012004d724564030008000000d002000660036006090000001c063000300068066803f805c8020e00000026060f0012004d72456403000800000020040006b0046006090000001c06300030006806b804f80518040e00000026060f0012004d72456403000800000010050006d0056006090000001c06300030006806d805f80508050b00000026060f000c004d7245640100020000000000080000002503020060033006c00300060b00000026060f000c004d72456401000200000000000800000025030200c0030006200430060b00000026060f000c004d72456401000200000000000800000025030200b0043006e00400060b00000026060f000c004d72456401000200000000000800000025030200e0040006100530060b00000026060f000c004d72456401000200000000000800000025030200d0023006200130060b00000026060f000c004d72456401000200000000000800000025030200d0053006900630060a00000026060f000a00ffffffff010000000000040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e003b01040000002d01020008000000320a6006900001000000410008000000320af006200101000000300009000000320af006000604000000313030300e00000026060f0012004d7245640300080000009006200af00cd00b0400000002010200070000001b04d80bf80c180a88060e00000026060f001200ffffffff0000080000001007700a700cf00a0e00000026060f0012004d7245640300080000004008800a0009e00a090000001c0630003000e80a0809780a38080e00000026060f0012004d724564030008000000c009800a200ae00a090000001c0630003000e80a280a780ab8090b00000026060f000c004d724564010002000000000008000000250302000009b00a6009800a0b00000026060f000c004d724564010002000000000008000000250302006009800ac009b00a0b00000026060f000c004d724564010002000000000008000000250302004008b00a2007b00a0b00000026060f000c004d72456401000200000000000800000025030200200ab00a600cb00a0a00000026060f000a00ffffffff010000000000040000000201010008000000320ae00ac00601000000420008000000320aa00b200701000000300009000000320a700b000c03000000383030000e00000026060f0012004d724564030008000000900c3000e00d800104000000020102000700000018048801e80d2800880c04000000020101000a000000320af000c00c060000005478496e69740b00000026060f000c004d72456401000200000000000800000025030200200d8001200d10020e00000026060f0012004d7245640300080000006000200ad002900c0400000002010200070000001b04980cd802180a58000b00000026060f000c004d72456401000200000000000800000025030200c000700b8001500a0b00000026060f000c004d724564010002000000000008000000250302008001500a4002700b0b00000026060f000c004d72456401000200000000000800000025030200c000700b4002700b0b00000026060f000c004d724564010002000000000008000000250302008001700b8001d00b040000000201010009000000320a400b20010400000047656e650c000000320a300cf0000a000000423a203130302d3430300e00000026060f0012004d724564030008000000400280079009f0090400000002010200070000001b04f8099809780738020b00000026060f000c004d72456401000200000000000800000025030200c0031008d008100804000000020101000d000000320ae00770020c000000636f6e73742042696f7365710b00000026060f000c004d72456401000200000000000800000025030200c0033009700530090b00000026060f000c004d7245640100020000000000080000002503020070053009400500090b00000026060f000c004d7245640100020000000000080000002503020070053009400560090b00000026060f000c004d72456401000200000000000800000025030200e004a008f006a0080b00000026060f000c004d72456401000200000000000800000025030200f006a008c00670080b00000026060f000c004d72456401000200000000000800000025030200f006a008c006d0080b00000026060f000c004d7245640100020000000000080000002503020060063009d00830090b00000026060f000c004d7245640100020000000000080000002503020060063009900600090b00000026060f000c004d72456401000200000000000800000025030200600630099006600908000000320ad008800401000000430008000000320a6009600301000000420008000000320a6009000901000000410008000000fa02060050005000c0c0c000040000002d01030004000000f00101000b00000026060f000c004d7245640100020000000000080000002503020000001005700e10050e00000026060f0012004d7245640300080000008001e00140024002040000000201020008000000fa0206001000100000000000040000002d01010004000000f0010300090000001c063000300048024802d80178010e00000026060f0012004d7245640300080000000003e00160034002090000001c063000300048026803d801f8020b00000026060f000c004d7245640100020000000000080000002503020040021002a002e0010b00000026060f000c004d72456401000200000000000800000025030200a002e001000310020b00000026060f000c004d7245640100020000000000080000002503020080011002600010020b00000026060f000c004d7245640100020000000000080000002503020060031002900910020e00000026060f0012004d724564030008000000000ce001900c4002090000001c06300030004802980cd801f80b0e00000026060f0012004d724564030008000000b00ae001400b4002090000001c06300030004802480bd801a80a0e00000026060f0012004d7245640300080000009009e001500a4002090000001c06300030004802580ad80188090e00000026060f001200ffffffff000008000000300bd001100c20020b00000026060f000c004d72456401000200000000000800000025030200400b1002a00be0010b00000026060f000c004d72456401000200000000000800000025030200a00be001000c10020a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000400ad001c00a20020b00000026060f000c004d72456401000200000000000800000025030200500a1002800ae0010b00000026060f000c004d72456401000200000000000800000025030200800ae001b00a10020a00000026060f000a00ffffffff0100000000000b00000026060f000c004d72456401000200000000000800000025030200400e1002900c10020e00000026060f0012004d724564030008000000e00aa005b00d7008070000001b047808b80d9805d80a04000000020101000c000000320a1008700b0a000000413a203131302d3131350e00000026060f0012004d724564030008000000a00bd005f00c200704000000020102000700000018042807f80cc805980b04000000020101000a000000320a9006d00b060000005478496e69740b00000026060f000c004d72456401000200000000000800000025030200300c2007300cb0070b00000026060f000c004d7245640100020000000000080000002503020020018001e00160000b00000026060f000c004d72456401000200000000000800000025030200e0016000a00280010b00000026060f000c004d7245640100020000000000080000002503020020018001a00280010b00000026060f000c004d72456401000200000000000800000025030200e0018001e001e00109000000320a500180010400000047656e650b00000026060f000c004d7245640100020000000000080000002503020060006003400560030b00000026060f000c004d7245640100020000000000080000002503020040056003100530030b00000026060f000c004d7245640100020000000000080000002503020040056003100590030b00000026060f000c004d724564010002000000000008000000250302005004d0020009d0020b00000026060f000c004d724564010002000000000008000000250302000009d002d008a0020b00000026060f000c004d724564010002000000000008000000250302000009d002d00800030b00000026060f000c004d72456401000200000000000800000025030200400e6003100860030b00000026060f000c004d7245640100020000000000080000002503020010086003400830030b00000026060f000c004d72456401000200000000000800000025030200100860034008900308000000320a3003900001000000420008000000320aa002800401000000430008000000320a3003800d01000000410008000000320a4008600301000000440008000000320ae001900001000000440010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01030004000000f001020008000000fa02050000000000ffffff00040000002d01020004000000f001010007000000fc020100000000000000040000002d01010004000000f0010000040000002701ffff040000002701ffff030000000000c45ef026c7070100ff7608ff76068b46f08b0200400e6003100860030b00000026060f000c004d72ffffff0001050000050000000d0000004d45544146494c4550494354006c420000e1c8ffff760f000008006c421f370000010009000003b707000004005a00000000001500000026060f001f00ffffffff0400150000004d7245640f004d6963726f736f6674204472617700005a00000026060f00a9004d72456402009f0000009d000100ffffffffffffffff0000e70000000100030000000000ffffff0000000000ffffff000200000100000001000000000001002e00000000010c0053797374656d007720746f205573652048656c7000000095012657696e646f77100000000000ffffff00c0c0c00080808000ff00000080000000ffff00008080000000ff00000080000000ffff00008080000000ff0000008000ff00ff0080008000000e00000026060f0012004d724564030008000000b0ff2000c00ea00c050000000b022000b0ff050000000c02800c100f030000001e000400000003010800050000000102ffffff000500000009020000000004000000070103000400000004010d0004000000060101000400000002010200030000001e000e00000026060f0012004d7245640300080000006000a005ef06500707000000fc020000ffffff00ffff040000002d01000008000000fa0206001000100000000000040000002d010100070000001b045807f706980558000e00000026060f001200ffffffff0000080000001001f005a00670060e00000026060f0012004d724564030008000000d002000660036006090000001c063000300068066803f805c8020e00000026060f0012004d72456403000800000020040006b0046006090000001c06300030006806b804f80518040e00000026060f0012004d72456403000800000010050006d0056006090000001c06300030006806d805f80508050b00000026060f000c004d7245640100020000000000080000002503020060033006c00300060b00000026060f000c004d72456401000200000000000800000025030200c0030006200430060b00000026060f000c004d72456401000200000000000800000025030200b0043006e00400060b00000026060f000c004d72456401000200000000000800000025030200e0040006100530060b00000026060f000c004d72456401000200000000000800000025030200d0023006200130060b00000026060f000c004d72456401000200000000000800000025030200d0053006900630060a00000026060f000a00ffffffff010000000000040000002e011800040000000201010015000000fb02b0ff0000000000009001000000000000001254696d6573204e657720526f6d616e003b01040000002d01020008000000320a6006900001000000410008000000320af006200101000000300009000000320af006000604000000313030300e00000026060f0012004d7245640300080000009006200af00cd00b0400000002010200070000001b04d80bf80c180a88060e00000026060f001200ffffffff0000080000001007700a700cf00a0e00000026060f0012004d7245640300080000004008800a0009e00a090000001c0630003000e80a0809780a38080e00000026060f0012004d724564030008000000c009800a200ae00a090000001c0630003000e80a280a780ab8090b00000026060f000c004d724564010002000000000008000000250302000009b00a6009800a0b00000026060f000c004d724564010002000000000008000000250302006009800ac009b00a0b00000026060f000c004d724564010002000000000008000000250302004008b00a2007b00a0b00000026060f000c004d72456401000200000000000800000025030200200ab00a600cb00a0a00000026060f000a00ffffffff010000000000040000000201010008000000320ae00ac00601000000420008000000320aa00b200701000000300009000000320a700b000c03000000383030000e00000026060f0012004d724564030008000000900c3000e00d800104000000020102000700000018048801e80d2800880c04000000020101000a000000320af000c00c060000005478496e69740b00000026060f000c004d72456401000200000000000800000025030200200d8001200d10020e00000026060f0012004d7245640300080000006000200ad002900c0400000002010200070000001b04980cd802180a58000b00000026060f000c004d72456401000200000000000800000025030200c000700b8001500a0b00000026060f000c004d724564010002000000000008000000250302008001500a4002700b0b00000026060f000c004d72456401000200000000000800000025030200c000700b4002700b0b00000026060f000c004d724564010002000000000008000000250302008001700b8001d00b040000000201010009000000320a400b20010400000047656e650c000000320a300cf0000a000000423a203130302d3430300e00000026060f0012004d724564030008000000400280079009f0090400000002010200070000001b04f8099809780738020b00000026060f000c004d72456401000200000000000800000025030200c0031008d008100804000000020101000d000000320ae00770020c000000636f6e73742042696f7365710b00000026060f000c004d72456401000200000000000800000025030200c0033009700530090b00000026060f000c004d7245640100020000000000080000002503020070053009400500090b00000026060f000c004d7245640100020000000000080000002503020070053009400560090b00000026060f000c004d72456401000200000000000800000025030200e004a008f006a0080b00000026060f000c004d72456401000200000000000800000025030200f006a008c00670080b00000026060f000c004d72456401000200000000000800000025030200f006a008c006d0080b00000026060f000c004d7245640100020000000000080000002503020060063009d00830090b00000026060f000c004d7245640100020000000000080000002503020060063009900600090b00000026060f000c004d72456401000200000000000800000025030200600630099006600908000000320ad008800401000000430008000000320a6009600301000000420008000000320a6009000901000000410008000000fa02060050005000c0c0c000040000002d01030004000000f00101000b00000026060f000c004d7245640100020000000000080000002503020000001005700e10050e00000026060f0012004d7245640300080000008001e00140024002040000000201020008000000fa0206001000100000000000040000002d01010004000000f0010300090000001c063000300048024802d80178010e00000026060f0012004d7245640300080000000003e00160034002090000001c063000300048026803d801f8020b00000026060f000c004d7245640100020000000000080000002503020040021002a002e0010b00000026060f000c004d72456401000200000000000800000025030200a002e001000310020b00000026060f000c004d7245640100020000000000080000002503020080011002600010020b00000026060f000c004d7245640100020000000000080000002503020060031002900910020e00000026060f0012004d724564030008000000000ce001900c4002090000001c06300030004802980cd801f80b0e00000026060f0012004d724564030008000000b00ae001400b4002090000001c06300030004802480bd801a80a0e00000026060f0012004d7245640300080000009009e001500a4002090000001c06300030004802580ad80188090e00000026060f001200ffffffff000008000000300bd001100c20020b00000026060f000c004d72456401000200000000000800000025030200400b1002a00be0010b00000026060f000c004d72456401000200000000000800000025030200a00be001000c10020a00000026060f000a00ffffffff0100000000000e00000026060f001200ffffffff000008000000400ad001c00a20020b00000026060f000c004d72456401000200000000000800000025030200500a1002800ae0010b00000026060f000c004d72456401000200000000000800000025030200800ae001b00a10020a00000026060f000a00ffffffff0100000000000b00000026060f000c004d72456401000200000000000800000025030200400e1002900c10020e00000026060f0012004d724564030008000000e00aa005b00d7008070000001b047808b80d9805d80a04000000020101000c000000320a1008700b0a000000413a203131302d3131350e00000026060f0012004d724564030008000000a00bd005f00c200704000000020102000700000018042807f80cc805980b04000000020101000a000000320a9006d00b060000005478496e69740b00000026060f000c004d72456401000200000000000800000025030200300c2007300cb0070b00000026060f000c004d7245640100020000000000080000002503020020018001e00160000b00000026060f000c004d72456401000200000000000800000025030200e0016000a00280010b00000026060f000c004d7245640100020000000000080000002503020020018001a00280010b00000026060f000c004d72456401000200000000000800000025030200e0018001e001e00109000000320a500180010400000047656e650b00000026060f000c004d7245640100020000000000080000002503020060006003400560030b00000026060f000c004d7245640100020000000000080000002503020040056003100530030b00000026060f000c004d7245640100020000000000080000002503020040056003100590030b00000026060f000c004d724564010002000000000008000000250302005004d0020009d0020b00000026060f000c004d724564010002000000000008000000250302000009d002d008a0020b00000026060f000c004d724564010002000000000008000000250302000009d002d00800030b00000026060f000c004d72456401000200000000000800000025030200400e6003100860030b00000026060f000c004d7245640100020000000000080000002503020010086003400830030b00000026060f000c004d72456401000200000000000800000025030200100860034008900308000000320a3003900001000000420008000000320aa002800401000000430008000000320a3003800d01000000410008000000320a4008600301000000440008000000320ae001900001000000440010000000fb021400090000000000bc02000000000102022253797374656d0005040000002d01030004000000f001020008000000fa02050000000000ffffff00040000002d01020004000000f001010007000000fc020100000000000000040000002d01010004000000f0010000040000002701ffff040000002701ffff030000000000}{\result {\f0 {\pict\wmetafile8\picw17004\pich14111\picwgoal9641\pichgoal8001 \picscalex89\picscaley89 \bin3968  	  ∑   Z        &  ˇˇˇˇ    MrEd Microsoft Draw  Z   & © MrEd ü   ù  ˇˇˇˇˇˇˇˇ  Á         ˇˇˇ     ˇˇˇ            .     System w to Use Help   ï&Window     ˇˇˇ ¿¿¿ ÄÄÄ ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä   ˇˇ  ÄÄ   ˇ   Ä ˇ ˇ Ä Ä     &  MrEd    ∞ˇ  ¿†     ∞ˇ   Ä           ˇˇˇ    	                           &  MrEd    ` †ÔP   ¸  ˇˇˇ ˇˇ   -     ˙          -    X˜òX    &  ˇˇˇˇ     †p   &  MrEd    – ``	   0 0 hh¯»   &  MrEd      ∞`	   0 0 h∏¯   &  MrEd     –`	   0 0 hÿ¯   &  MrEd         % `0¿    &  MrEd         % ¿  0   &  MrEd         % ∞0‡    &  MrEd         % ‡ 0   &  MrEd         % –0 0   &  MrEd         % –0ê0
   & 
 ˇˇˇˇ        .        ˚∞ˇ      ê       Times New Roman ;   -    2
`ê    A    2
    0 	   2
    1000   &  MrEd    ê 
–       ÿ¯
à   &  ˇˇˇˇ     p
p
   &  MrEd    @Ä
 	‡
	   0 0 Ë
	x
8   &  MrEd    ¿	Ä
 
‡
	   0 0 Ë
(
x
∏	   &  MrEd         %  	∞
`	Ä
   &  MrEd         % `	Ä
¿	∞
   &  MrEd         % @∞
 ∞
   &  MrEd         %  
∞
`∞

   & 
 ˇˇˇˇ            2
‡
¿   B    2
†    0 	   2
p    800    &  MrEd    ê0 ‡Ä       àË( à    
   2
 ¿   TxInit   &  MrEd         %  Ä    &  MrEd    `  
–ê       òÿ
X    &  MrEd         % ¿ pÄP
   &  MrEd         % ÄP
@p   &  MrEd         % ¿ p@p   &  MrEd         % ÄpÄ–    	   2
@    Gene   2
0 
   B: 100-400   &  MrEd    @Äê		       ¯	ò	x8   &  MrEd         % ¿–       2
‡p   const Bioseq   &  MrEd         % ¿0	p0	   &  MrEd         % p0	@ 	   &  MrEd         % p0	@`	   &  MrEd         % ‡††   &  MrEd         % †¿p   &  MrEd         % †¿–   &  MrEd         % `0	–0	   &  MrEd         % `0	ê 	   &  MrEd         % `0	ê`	   2
–Ä   C    2
`	`   B    2
`	 	   A    ˙ P P ¿¿¿    -        &  MrEd         %   p   &  MrEd    Ä‡@@       ˙          -     	   0 0 HHÿx   &  MrEd     ‡`@	   0 0 Hhÿ¯   &  MrEd         % @†‡   &  MrEd         % †‡    &  MrEd         % Ä`    &  MrEd         % `ê	   &  MrEd     ‡ê@	   0 0 Hòÿ¯   &  MrEd    ∞
‡@@	   0 0 HHÿ®
   &  MrEd    ê	‡P
@	   0 0 HX
ÿà	   &  ˇˇˇˇ     0–    &  MrEd         % @†‡   &  MrEd         % †‡ 
   & 
 ˇˇˇˇ        &  ˇˇˇˇ     @
–¿
    &  MrEd         % P
Ä
‡   &  MrEd         % Ä
‡∞

   & 
 ˇˇˇˇ        &  MrEd         % @ê   &  MrEd    ‡
†∞p   x∏òÿ
       2
p
   A: 110-115   &  MrEd    †–        (¯»ò    
   2
ê–   TxInit   &  MrEd         % 0 0∞   &  MrEd         %  Ä‡`    &  MrEd         % ‡` †Ä   &  MrEd         %  Ä†Ä   &  MrEd         % ‡Ä‡‡	   2
PÄ   Gene   &  MrEd         % ` `@`   &  MrEd         % @`0   &  MrEd         % @`ê   &  MrEd         % P– 	–   &  MrEd         %  	––†   &  MrEd         %  	––    &  MrEd         % @``   &  MrEd         % `@0   &  MrEd         % `@ê   2
0ê    B    2
†Ä   C    2
0Ä   A    2
@`   D    2
‡ê    D    ˚ 	     º    "System    -        ˙     ˇˇˇ    -        ¸          -         'ˇˇ   'ˇˇ     ƒ^&« ˇvˇvãFã}}}}}{
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 74}}}{\b0 \tab CoreLib}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 CoreLib\tab }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 73}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include corelib.doc}}{\fldrslt {{\*\bkmkstart _Toc300649115}CoreLib: Portable Core Library{\*\bkmkend _Toc300649115}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649116}Introduction{\*\bkmkend _Toc300649116}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI has defined a series of header files, basic utility routines, and programming guidelines for the C programming language intended to encourage good programming practice in general and to facilitate the creation of code which will compile and run without change on a variety of hardware platforms under a variety of operating systems and user interfaces, both command line and windowing.  We have developed and tested the system on Intel 80386 and 80486 machines under MS-DOS and Microsoft Windows 3.1, on various Macintosh II machines under Mac-OS, on many different machines under UNIX, on an IBM 3090 running AIX and on VMS VAX. A complete list of systems is given in the README file for the NCBI software toolkit release.
\par }\pard \s15\li720\sb240\widctlpar\adjustright {A large number of applications have been written using this set of core tools, and they compile and run without change on all the above system.  While there is clearly no perfect or all inclusive system, we find this one works remarkably well.  This system is not meant to be a universal panacea.  It is meant only to allow the creation of portable code for most of the types of things scientists might want to do on a computer.  It is not expected to support extremely interactive or graphically oriented programs, nor is it meant to support extremely computation resource limited applications.  It is to make an average application portable and robust.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649117}Application Frameworks{\*\bkmkend _Toc300649117}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {In C, there is a common programming model that we are all accustomed to, in which command-line arguments are made available to the program's }{\b main}{ function and the }{\b stdin}{ and }{\b stdout}{ streams are used for input and output data.  However, with some of the modern graphical user interfaces, this may not be convenient or desired.  Futhermore, graphical intefaces generally require substantial initialization before any application code runs and may require specific steps be taken before application exits.  The exact steps required vary widely from one platform to the next.
\par To simplify the process of writing programs that run in all of these situations, let us introduce the notion of an }{\i application framework}{, which takes care of whatever initialization and termination steps may be required and provides a uniform mechanism for obtaining program arguments.  The NCBI Toolkit provides two application frameworks.  The first is part of CoreLib and is extremely simple, but useful for "quick-and-dirty" tool development.  The second is provided by Vibrant and supports the full look-and-feel of the target graphical interface (described elsewhere in this manual).
\par It is important to note that the use of these frameworks is purely optional.  Any NCBI Toolbox function, with the single exception of the }{\b GetArgs}{, may be called from any application, whether it a simple UNIX filter program or a full-blown Macintosh application.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649118}Main Entry Point{\*\bkmkend _Toc300649118}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {To use this simple framework, you should write a function called }{\b Main}{, which you can think of this as the entry point to your program.  In fact, the true entry point (main or WinMain or whatever) is a function within CoreLib, which will perform whatever initilization is required for the platform and then call Main.  From }{\b Main}{ you will call functions to perform the task for which the program is designed and then }{\b Main}{ should return zero on success or non-zero on failure, as in the following example.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {#include <ncbi.h>
\par 
\par Int2 Main()
\par \{
\par \tab if (!DoSearch("swissprot","query.aa",12,0.1,"blast.out"))
\par \tab \tab return 1;  /* failure */
\par 
\par \tab return 0;   /* success */
\par \}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {You should include the C header file }{\b ncbi.h}{\pard\plain \s15\li720\sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {ncbi.h header file}}}{ to get the function definition (prototype) for }{\b Main}{, as well as all other functions, types, and constants described in this chapter.  It it turn includes various other headers, such as one that contains contains platform-specific definitions (}{\b ncbilcl.h}{) and others that define the interfaces to the various modules (for example, the memory management functions are defined in }{\b ncbimem.h}{).  Since the order of inclusion may be important in certain instances, it is safest to simply include }{\b ncbi.h}{.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649119}Getting Program Arguments{\*\bkmkend _Toc300649119}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Notice that }{\b Main}{ takes no parameters.  How, then, will your program get access to arguments that may be supplied by the user?  Early in the program, you should make a single call to a function called }{\b GetArgs}{ to obtain the program's run-time arguments.  Actually, }{\b GetArgs}{ does more than just get arguments; it may also prompt the user for input, validate the arguments against allowed ranges, and convert them to the appropriate integer or floating point types.  The }{\b Arg}{ structure}{\pard\plain \s15\li720\sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Arg structure}}}{ contains all of the information required to do this and contains storage for the values returned by the function.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean GetArgs}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetArgs function}}}{ (CharPtr progname, Int2 argcount, Arg *arglist)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Gets arguments for the program named }{\b\i progname}{.  The the argument specifications are stored in }{\b\i arglist}{, an array of Arg structures containing }{\b\i argcount}{ elements.  The }{\b Arg}{ structure has the following definition:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {typedef struct \{
\par \tab char *prompt;\tab \tab /* Visible prompt for user */
\par \tab char *defaultvalue;\tab /* Default value */
\par \tab char *from;\tab \tab \tab /* Low value in allowed range */
\par \tab char *to;\tab \tab \tab /* High value in allowed range */
\par \tab Boolean\tab optional;\tab /* Is this argument optional? */
\par \tab char\tab tag;\tab \tab \tab /* Command-line switch */
\par \tab Int1\tab type;\tab \tab \tab /* Data type */
\par \tab FloatHi\tab floatvalue;\tab /* Returned floating point value */
\par \tab Int4\tab intvalue;\tab \tab /* Returned integer value */
\par \tab CharPtr\tab strvalue;\tab /* Returned string value */
\par \} Arg, *ArgPtr;
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {The arguments on the command line are expected to consist of the dash (-) character, a single letter }{\b tag}{, and finally the argument value.  There may be a space between the tag and the value.  For example, "}{\f6 -F fname}{" and "}{\f6 -Ffname}{" are equivalent.  The field called }{\b type}{ determines how the argument is interpreted as well as where it is stored in the }{\b Arg}{ structure.
\par }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6120\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9000\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Datatype Symbol\cell Data Type Description\cell Storage Field in }{\b Arg}{ \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\cltxlrtb \cellx6120\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9000\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_BOOLEAN\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {TRUE/FALSE value\cell intvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_INT\cell Integer value\cell intvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_FLOAT\cell Floating point value\cell floatvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_STRING\cell String value\cell strvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_FILE_IN\cell Name of input file\cell strvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_FILE_OUT\cell Name of output file\cell strvalue\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_DATA_IN\cell Datalink in\cell strvalue  [[ VERIFY ]]\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6120\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9000\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ARG_DATA_OUT\cell Datalink out\cell strvalue  [[ VERIFY ]]\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Arguments are considered to be required unless the }{\b optional}{ field is TRUE.  The user will be prompted for all non-optional arguments not given on the command line using the string supplied in }{\b prompt}{.  Optional arguments not supplied by the user are assigned to }{\b defaultvalue}{ (may be NULL).  All numerical arguments are converted from strings to either integer or flotaing point and validated against the valid range defined by the }{\b from}{ and }{\b to}{ fields (may be NULL for no validation).  If all non-default arguments have been supplied and validated, TRUE is returned.  If not, or if the only argument given is "-", the program usage is shown and the function returns FALSE.
\par }\pard \s15\li720\sb240\keepn\widctlpar\adjustright {The example above may be extend as follows.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {#include <ncbi.h>
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {
\par Arg arg[] = \{
\par   \{"Database","nr",NULL,NULL,FALSE,'D',ARG_STRING,0.0,0, NULL\},
\par   \{"Query file","query.aa",NULL,NULL,FALSE,'Q',ARG_FILE_IN,0.0,0, NULL\},
\par   \{"Threshold","13","5","25",TRUE,'T',ARG_BOOLEAN,0.0,0,NULL\},
\par   \{"Expect","0.1","0.01","10",TRUE,'E',ARG_FLOAT,0.0,0,NULL \},
\par   \{"Output file","blast.out",NULL,NULL,FALSE,'O',ARG_FILE_OUT,0.0,0, NULL\}\};
\par 
\par Int2 Main()
\par \{
\par \tab if (!GetArgs("demo",DIM(arg),arg))
\par \tab \tab return 1;  /* failure */
\par 
\par \tab if (!DoSearch(arg[0].strvalue,arg[1].strvalue,
\par \tab \tab \tab arg[2].intvalue,arg[3].floatvalue,arg[4].strvalue))
\par \tab \tab return 1;  /* failure */
\par 
\par \tab return 0;   /* success */
\par \}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {The Vibrant version of }{\b GetArgs}{ produces a dialog box containing the prompt strings edit fields into which the user may enter the values.  If all required arguments are supplied, TRUE is returned.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649120}User Interface Elements{\*\bkmkend _Toc300649120}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {We find it useful to include a minimal set of functions in the core library to provide feedback to the user for such purposes as displaying messages (alerts), providing audible feedback (beeps), and indicating the progress of lengthy operations (monitors).  However, we recognize that a significant amout of customization is needed to suit the tastes and requirements of individual applications programmers using this Toolkit.  Indeed, every single user interface element described below may be replaced by one of your own design.  This is done by registering }{\i hook functions}{ with the library that will be called to generate the desired effects.  Without this, your program will get the default functionality provided by CoreLib, which is extremely simple and uses primarily console I/O.  Programs featuring a graphical inteface will almost certainly want to install hook functions to provide something more elegant.  For example, the Vibrant application framework installs hooks for all user interface elements prior to calling your }{\b Main}{ function.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649121}Alerts{\*\bkmkend _Toc300649121}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Alerts are used to show a message to the user, which in some cases may be in the form of a question with a small number of possible answers.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MsgAnswer MsgAlert}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MsgAlert function}}}{ (MsgKey key, ErrSev sev, const char *capt, \line const char *fmt, ...)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Generates a message string using the format string }{\b fmt}{ and a variable number of arguments.  The }{\b\i key}{ parameter is used to specify the list of possible user responses and may be any of the following constants.
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {KEY_NONE\tab No response requried (console) or OK button (graphical)
\par KEY_OK\tab OK button
\par KEY_OKC\tab OK and Cancel buttons
\par KEY_YN\tab Yes and No buttons
\par KEY_YNC\tab Yes, No and Cancel buttons
\par KEY_RC\tab Retry and Cancel buttons
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {KEY_ARI\tab Abort, Retry and Ignore buttons
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Two additional parameters, a caption string }{\b capt}{ and a severity code }{\b sev}{, may be supplied if desired.  Although they they are ignored in the default }{\b MsgAlert}{ processing provided by CoreLib, these two arguments are passed through to the message hook function (if any) for use in graphical alerts.  The caption string is intended for use in the caption bar of the alert window (if it has one) and is normally the name of the application.  The severity code is for use in selecting an icon to appear in the content area of the window beside the message text.  Any of the severity constants listed for the }{\b ErrPostEx}{ function (described later in this chapter) may be used.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MsgAnswer MsgAlertStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MsgAlertStr function}}}{ (MsgKey key, ErrSev sev, \line const char *caption, const char *str)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Same as }{\b MsgAlert}{ except that the message }{\b\i str}{ is a single string instead of a format string and argument list.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MsgAnswer Message}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Message function}}}{ (Int2 option, const char *fmt, ...)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Displays a message to the user that is generated from the format specification string }{\b\i fmt}{ and a variable list of arguments.  The }{\b\i option}{ argument modifies the behavior of the function and may be any one of the following.
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {MSG_ERROR\tab Beep, show the message, and wait for an acknowlegement from the user before continuing.
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {MSG_FATAL\tab Beep, show the message, then halt the program by calling the AbnormalExit function.
\par MSG_OK\tab Show the message and wait for an acknowledgement from the user before continuing (press the OK button or wait for a keypress).
\par MSG_OKC\tab Show the message and prompt for OK/Cancel.
\par MSG_YN\tab Show the message and prompt for Yes/No.
\par MSG_YNC\tab Show the message and prompt for Yes/No/Cancel.
\par MSG_RC\tab Show the message and prompt for Retry/Cancel.
\par MSG_ARI\tab Show the message and prompt for Abort/Retry/Ignore.
\par MSG_POST\tab Show the message and continue (in graphical interfaces, the alert must generally be dismissed by explicit action of the user).
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {MSG_POSTERR\tab Beep, show the message and continue.
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Message calls }{\b MsgAlert}{ to actually display the message.  If an application property has been installed (see }{\b SetAppProperty}{) with the key "AppName", it is used as the caption when calling }{\b MsgAlert}{.  Otherwise, there is no caption.  The function result is an enumerated type and may be any of the following values.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {typedef enum MsgAnswser
\par \{
\par \tab ANS_NONE,
\par \tab ANS_OK,
\par \tab ANS_CANCEL,
\par \tab ANS_ABORT,
\par \tab ANS_RETRY,
\par \tab ANS_IGNORE,
\par \tab ANS_YES,
\par \tab ANS_NO
\par \}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {ASN_NONE is returned for the options that do not require any user response (MSG_POST and MSG_POSTERR).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {\page MsgHook SetMessageHook}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MsgAlert function}}}{ (MsgHook hook)
\par }\pard\plain \s15\li720\sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{\pard\plain \s15\li720\sb240\keepn\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Hook function\:for messages}}}{ as the function to be called for showing messages.  A pointer to the previous hook function (if any) is returned, so that it is possible to later restore it.  The message hook function should have the following form.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {MsgAnswer LIBCALLBACK MyMessageHook (MsgKey key, ErrSev sev, 
\par \tab \tab \tab const char *caption, const char *message)
\par \{
\par \tab MsgAnswer answer;
\par 
\par \tab /* Create a dialog box using caption as the title.  Within
\par \tab *  content region, show message and an icon selected using 
\par \tab *  sev.  Place buttons on the dialog based on the value of 
\par \tab *  key.  Wait for the user to press a button, then destroy
\par \tab *  the dialog window and return the appropriate answer code. */
\par \tab 
\par \tab return answer;
\par \}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649122}Beeps{\*\bkmkend _Toc300649122}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void Beep}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Beep function}}}{ ()
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sounds an audible beep.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {BeepHook SetBeepHook}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {SetBeepHook function}}}{ (BeepHook hook)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{\pard\plain \s15\li720\sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Hook function\:for beeps}}}{ as the function to be called for sounding beeps.  The function takes no arguments and has no return value.  The return value is a pointer to the previous BeepHook.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {void LIBCALLBACK MyBeepHook ()
\par \{
\par \tab PlaySoundFile("beep.snd");\line \}
\par 
\par Int2 Main ()
\par \{
\par \tab SetBeepHook(MyBeepFunction);
\par }{\i\f16\fs18 
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\i\f16\fs18 \tab ...etc...
\par 
\par }{\tab return 0;
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649123}Monitors{\*\bkmkend _Toc300649123}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {\i Monitors}{ are user interface elements used to indicate the status or progress of potentially lengthy operations.  There are two general types of monitors.  The first is the }{\i string monitor}{, which displays a series of strings, one after the other.  The second is the }{\i integer range monitor}{, which indicates progress of an operation as an integer value within some defined range.  String monitors and integer monitors must be created before they can be used using either }{\b MonitorStrNew}{ or }{\b MonitorIntNew}{, respectively and destroyed when they are no longer needed using }{\b MonitorFree}{.  
\par In addition to these, there is the notion of a }{\i default progress monitor}{ which may be used by calling }{\b ProgMon}{, even though these may have been initialized in a completely different code module or not initialized at all.  Normally, the default monotor is created in the top-level application code and registered with the system by calling }{\b SetProgMon}{.
\par The monitor functionality provided by CoreLib is appropriate for use in situations where console I/O is used.  For applications having a graphical interface or for console-style programs in which customized monitor behavior is desired, you can write your own monotor hook function to implement the user interface and install it by calling }{\b SetMonitorHook}{.  Programs using Vibrant need not do this as the application framework takes care of installing hook functions for all user interface elements.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MonitorPtr MonitorStrNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MonitorStrNew function}}}{ (const char *title, Int2 len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new string monitor with the caption }{\b\i title}{ and returns a pointer to it.  The maximum length of any string value is supplied as the }{\b\i len}{ argument.  NULL is returned on failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean MonitorStrValue}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MonitorStrValue function}}}{ (MonitorPtr mon, const char *sval)
\par }\pard\plain \s15\li720\sb240\widctlpar\tqr\tx14220\adjustright \f16\fs20\cgrid {Sets the value of the string monitor }{\b\i mon}{ to the string }{\b\i sval}{.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MonitorPtr MonitorIntNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MonitorIntNew function}}}{ (const char *title, Int4 n1, Int4 n2)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new integer monitor with the caption }{\b\i title}{ whose extent is from }{\b\i n1}{ to }{\b\i n2}{ and returns a pointer to it.  NULL is returned on failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean MonitorIntValue}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MonitorIntValue function}}}{ (MonitorPtr mon, Int4 ival)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sets the value of the inteber monitor }{\b\i mon}{ to }{\b\i ival}{.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {MonitorPtr MonitorFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MonitorFree function}}}{ (MonitorPtr mon)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Frees the monitor }{\b\i mon}{, which may be either of the integer or string monitor class.  The return value is always NULL.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {\page MonitorHook SetMonitorHook}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {SetMonitorHook function}}}{ (MonitorHook hook)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{ as the function to be called to carry out monitor activities.  The value of the previous hook function is returned.  The hook function should have the following form.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {int LIBCALLBACK MyMonitorHook (Monitor *mon, MonCode code)
\par \{
\par \tab switch (code)
\par \tab \{
\par \tab \tab case MonCode_Create :
\par \tab \tab \tab /* allocate memory & create interface elements here */
\par \tab \tab \tab if (failure)
\par \tab \tab \tab \tab return FALSE;
\par \tab \tab \tab break;
\par \tab \tab case MonCode_Destroy :
\par \tab \tab \tab /* free memory & destroy interface elements here */
\par \tab \tab \tab break;
\par \tab \tab case MonCode_IntValue :
\par \tab \tab \tab /* */
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab \tab \tab break;
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab \tab case MonCode_StrValue :
\par \tab \tab \tab /* */
\par \tab \tab \tab break;
\par \tab \tab default :
\par \tab \tab \tab return FALSE;
\par \tab \}
\par \tab return TRUE;\line \}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean SetProgMon}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {SetProgMon function}}}{ (ProgMonFunc hook, VoidPtr data)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{ as the function to be called for default progress monitor handling.  A pointer to an arbitrary data block }{\b\i data}{ and a string are passed to the hook function when it is called.  In the example below, a normal string monitor is used for default processing.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {Boolean LIBCALLBACK MyProgMonHook (VoidPtr data, CharStr str);
\par Monitor *defProgMon;
\par 
\par Int Main ()
\par \{
\par \tab defProgMon = MonitorStrNew(\ldblquote Progress Messages\rdblquote ,80);
\par \tab SetProgMon(MyProgMonHook,(void*)defProgMon);
\par 
\par }{\f17\fs18 \tab }{\b\i\f17\fs18 ... do stuff ...}{
\par 
\par \tab MonitorFree(defProgMon);
\par \tab return 0;\line \}
\par 
\par Boolean LIBCALLBACK MyProgMonHook (void *data, const char *str)
\par \{
\par \tab return MonitorStrValue((Monitor*)data,str);
\par \}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean ProgMon}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ProgMon function}}}{ (CharPtr str)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Pass the string }{\b\i str}{ to the default progress monitor.  If no default monitor has been installed with }{\b SetProgMon}{, calling this function has no effect.  The return value is whatever was returned by the default monitor hook function.
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649124}Configuration Files{\*\bkmkend _Toc300649124}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {A scheme for storing and modifying persistent system and application configuration options is provided.  It is modeled on services provided in the Microsoft Windows environment and has been extended to work all of the platforms that we support.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649125}File Names{\*\bkmkend _Toc300649125}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Since each platform may have its own convention for naming configuration files, we have opted to use a common }{\i basename}{ from which the actual filename can be derived as appropriate for the system.  This is described in the table below, where }{\b\i xxx}{ represents the basename.
\par }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2880\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4320\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx8640\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Platform\cell File Name\cell Locations searched\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx2880\clvertalt\cltxlrtb \cellx4320\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx8640\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {UNIX\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {\f6 .}{\i\fs22 xxx}{\f6 rc}{\cell 1. Path from NCBI environment variable \line 2. User's home directory\line 3. Current working directory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {VMS\cell }{\f6 .}{\i\fs22 xxx}{\f6 rc}{\cell 1. Path from NCBI environment variable \line 2. User's home directory\line 3. Current working directory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Macintosh\cell }{\i\fs22 xxx}{\f6 .cnf}{\cell 1. System Folder:Preferences\line 2. System Folder\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MS-DOS\cell }{\i\fs22 xxx}{\f6 .cfg}{\cell 1. Path from NCBI environment variable\line 2. Current directory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2880\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4320\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx8640\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MS-Windows\cell }{\i\fs22 xxx}{\f6 .ini}{\cell 1. Windows directory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649126}File Format{\*\bkmkend _Toc300649126}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Configuration files are plain ASCII text files that may be edited by the user.  They are divided into }{\i sections}{, each of which is headed by the section name enclosed in square brackets.  Below each section heading is a series of }{\i key}{=}{\i value}{ strings, somewhat analogous to the environment variables that are used on many platforms.  Any line that begins with a semi-colon is considered a comment.  The following lines serve as an example of what may appear in a settings file:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {[General]
\par AsnLoad = c:\\ncbi\\asnload
\par AsnData = c:\\ncbi\\asndata
\par 
\par [CD-ROM]
\par path = E:\\
\par 
\par [NetService]
\par ; Note: set USERNAME = ? to be prompted for your username
\par username=?
\par host=dispatcher@ncbi.nlm.nih.gov
\par timeout=30
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649127}Configuration File Functions{\*\bkmkend _Toc300649127}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean SetAppParam}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {SetAppParam function}}}{ (const char *filebase, const char *sect, const char *key, const char *val)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sets the value of }{\b\i key}{ to }{\b\i val}{ in section }{\b\i sect}{ of the configuration file specified by }{\b\i filebase}{.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean TransientSetAppParam}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {TransientSetAppParam function}}}{ (const char *filebase, \line const char *sect, const char *key, const char *val)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sets a configuration value like }{\b SetAppParam}{, except that the setting exists only in memory and is not written to the configuration file.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int GetAppParam}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetAppParam function}}}{ (const char *filebase, const char *sect, \line const char *key, const char *dflt, char *buf, int buflen)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Searches section }{\b\i sect}{ of the configuration file specified by }{\b\i filebase}{ for }{\b\i key}{ and returns its value in the buffer }{\b\i buf}{.  If }{\b\i key}{ is not found, the default value }{\b\i dflt}{ is copied to }{\b\i buf}{.  The return value is the number of characters copied to }{\b\i buf}{, which may be up to }{\b\i buflen}{-1.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean FindPath}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FindPath function function}}}{ (const char *filebase, const char *sect, \line const char *key, char *buf, int buflen)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Gets a configuration setting by passing the supplied arguments to }{\b GetAppParam}{ (with NULL as the default) and then ensures that the returned string is of the proper form for a filesystem path on the particular platform.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649128}Error Processing{\*\bkmkend _Toc300649128}
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {The core library includes functions for posting, reporting, logging, and handling whatever error conditions may be encountered during program execution.  An important concept is that indicating that an error occurred, or }{\i posting}{ an error}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Posting an error}}}{, can be functionally decoupled from the handling of that error.  The function }{\b ErrPostEx}{ is provided for posting an error along with an indication of its severity.  If no special provisions have been made, default processing of the error will occur, which may include (depending on the severity) displaying the error to the user and halting the program.  However, there are a number of ways to customize this behavior.  The simplest is to adjust the severity level that will be displayed to the users or that will result in a fatal program exit using }{\b ErrSetMessageLevel}{ and }{\b ErrSetFatalLevel}{, respectively.  For maximal control, you can use }{\b ErrSetHandler}{ to install your own function that will be called whenever an error is posted.
\par The software toolkit provides the ability to keep a log of all posted errors}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Logging errors}}}{, which we have found quite useful as an aid to debugging or for producing reports on large data processing runs.  Error logging is performed at the time an error is posted, regardless of how or when the error is ever handled.  Logging is disabled by default; to enable it, use }{\b ErrSetOptFlags}{ with EO_LOGTO_USRFILE as the argument.  The name of the file can be modified with the }{\b ErrSetLogfile}{ function.
\par When interpreting an error message, it is sometimes useful to know something about the context in which the error was posted.  For example, knowing that an error is from the ASN.1 function library as opposed to the network services library might be of assistance in diagnosing problems with a client program that retrieves ASN.1 data from a network service.  In the past we have used defined integer context codes for this purpose.  However, for a variety of reasons, we now prefer to use a string to indicate the context, or }{\i module}{, in which the error occurred.  At a finer granularity, you might want to know the filename and line number in the C source file in which the error was posted, but that is mainly of interest to programmers and not shown by default.  In order to allow some context information to be captured with minimal effort, we make use of two macros, THIS_MODULE}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {THIS_MODULE macro}}}{ and THIS_FILE}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {THIS_FILE macro}}}{, which you can (but are not required to) define once at the top of each source file.  Both represent strings and may be defined as NULL if they are to be ignored.  If you do not define them at all, you will inherit the default definitions from }{\b ncbierr.h}{:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {#ifndef THIS_MODULE
\par #define THIS_MODULE  NULL
\par #endif
\par #ifndef THIS_FILE
\par #define THIS_FILE  __FILE__
\par #endif
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {\b ErrPostEx}{ is actually implemented as a macro, which passes these two strings, along with the line number, to the toolbox functions (this obviates the need for several additional arguments).  Since not all linkers will merge duplicate strings, it is usually best to instantiate string variables for the module and filename and define the macros as aliases.  Without doing this it is possible to end up with one copy of each string for each expansion of the }{\b ErrPostEx}{ macro.  
\par }\pard \s59\li1440\sb60\sa60\keepn\widctlpar\adjustright {A typical example would be:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {static char *this_module = "MyModule";
\par #define THIS_MODULE  this_module
\par static char *this_file = __FILE__;
\par #define THIS_FILE this_file
\par 
\par #include <ncbi.h>
\par 
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {If you wish to include the }{\b ncbi.h}{ header file first, then you can undefine the symbols prior to redefining them.  
\par A recent enhancement to the error processing code is support for }{\i error message files}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \i\v\f16\fs20\cgrid {\xe {\i Error message files\:about}}}{.  These files may contain information allowing you to (1) convert integer error codes to a mnemonic string on output, (2) provide a verbose explanatory message to be appended to the standard error message, and (3) specify the severity level to be used for any error.  The files are plain ASCII text and fairly easy to edit, so they may be used to customize error reporting according to the preferences of individual users.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649129}Posting An Error{\*\bkmkend _Toc300649129}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrPost}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrPost function}}}{ (int context, int errcode, const char *fmt, ...)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Posts a fatal error that is defined by }{\b\i errcode}{ and described to the user by means of a string that is generated from the format string }{\b\i fmt}{ a variable number of arguments.  The }{\b\i context}{ argument is effectively the equivalent of the module, but it is only displayed if THIS_MODULE has not been defined to anything (i.e., if it is defined to NULL, as it is in }{\b ncbierr.h}{).
\par NOTE: This is an old function that has been retained for compatibility purposes.  New code should use ErrPostEx instead.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrPostEx}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrPostEx function}}}{ (ErrSev sev, int errcode, int subcode, \line const char *fmt, ...)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Posts an error of severity}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Error severities}}}{ }{\b\i sev}{.  The error is defined by }{\b\i errcode}{ and }{\b\i subcode}{ and described to the user by means of a string that is generated from the format string }{\b\i fmt}{ a variable number of arguments.  The return value is the same as that returned by }{\b ErrPostStr}{ (see below).  The possible severity codes are:
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {SEV_INFO\tab Purely an informational message, not a true error.
\par SEV_WARNING\tab Warning of a possible error condition.
\par SEV_ERROR\tab An error has occurred but execution can continue.
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {SEV_FATAL\tab An fatal (non-continuable) error has occurred.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrPostStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrPostStr function}}}{ (ErrSev sev, int errcode, int subcode, \line const char *str)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Posts an error as described for the }{\b ErrPostEx}{ function except that }{\b\i str}{ contains the descriptive error text as a single string instead of a format string plus variable argument list (hence, it can be called from programs that are written in languages other than C or C++).  
\par Both }{\b ErrPost}{ and }{\b ErrPostEx}{ call }{\b ErrPostStr}{ after formatting the string and this is where the real work takes place.  First, an internal ErrDesc structure is populated with all of the information describing the error that occurred.  If logging is enabled and }{\b\i sev}{ is greater than or equal to the current LogLevel, this information is then logged according to whatever style flags have been set using the ErrSetOptFlags function.  The user-supplied error handler function is given the first opportunity to handle the error.  If it returns zero or if there is no such function, default processing takes place.  If }{\b\i sev}{ is greater than or equal to the current MessageLevel, Message is called to display the error to the user.  If }{\b\i sev}{ is greater than or equal to the current FatalLevel, the program is halted by calling }{\b AbnormalExit}{.
\par The return value is one of the "answer codes" (e.g. ANS_OK) that may be returned by the }{\b MsgAlert}{ function.  If the programmer has installed an error handler function, it should return one of these codes if it handles the error or zero otherwise.  If }{\b MsgAlert}{ was called as a result of default error processing, its result value is returned to the caller.  If neither of these is true, zero is returned.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649130}User Error Strings{\*\bkmkend _Toc300649130}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {One thing we have found to be quite useful is the ability to include in the error messages additonal strings defined by the user (meaning the programmer in this case) in order to provide additonal information about the context in which the error occured.  For example, image that you have a program that streams through every record in a sequence database performing some sort of analysis or calculation.  Before processing each record you could use ErrUserInstall suppplying (say) its accession number as the string.  Then, if any error occurs during the run, you would know which record was being processed at the time because its accession number would be part of the error message.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ErrStrId ErrUserInstall}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrUserInstall function}}}{ (const char *msg, ErrStrId id)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {If }{\b\i id}{ is zero, the string }{\b\i msg}{ is added to the list of user-defined error strings and a unique id value for that string is returned.  Otherwise, the text of an existing entry in the list identified by }{\b\i id}{\b  }{is replaced with }{\b\i msg}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean ErrUserDelete}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrUserDelete function}}}{ (ErrStrId id)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Deletes the user-defined error string identified by }{\b\i id}{ (returned by }{\b ErrUserInstall}{).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrUserClear}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrUserClear function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Clears the entire list of user-defined error strings.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649131}Customization{\*\bkmkend _Toc300649131}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrSetFatalLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetFatalLevel function}}}{ (ErrSev level)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Sets the minimum severity that will result in a fatal exit to }{\b level}{.   The return value is the previous setting.  The default value is SEV_FATAL, but changing it to SEV_MAX will prevent the application aborting.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrGetFatalLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrGetFatalLevel function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Returns the current FatalLevel value.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrSetMessageLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetMessageLevel function}}}{ (ErrSev level)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Sets the minimum severity that will be displayed to the user (via the Message function) to }{\b\i level}{.The return value is the previous setting.  The default value is SEV_WARNING, but setting it to SEV_MAX will disable all error reporting.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrGetMessageLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrGetMessageLevel function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Returns the current MessageLevel setting.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrSetLogLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetLogLevel function}}}{ (ErrSev level)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Sets the minimum severity that will be logged to }{\b\i level}{.  The return value is the previous setting.  The default value is SEV_INFO.  Note that one of the log output channels (logfile, stderr, or trace) must be enabled before any logging will occur.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrGetLogLevel}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrGetLogLevel function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Returns the current LogLevel setting.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrSetLogfile}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetLogfile function}}}{ (const char *filename, unsigned long flags)
\par }\pard\plain \s59\li1440\sb60\sa60\keepn\widctlpar\adjustright \f16\fs20\cgrid {Sets the name of the error log file to }{\b\i filename}{ (from the default name "error.log").  Note that the ER_LOG_USRFILE flag must be set (see below) to actually enable logging to the named file.  The }{\b\i flags}{ may be any of the following, which may be combined with the bitwise-OR operator.
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrt\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {ELOG_BANNER\tab Writes a banner line with the current time and date.
\par ELOG_APPEND\tab Appends to an existing file (if there is one).
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {ELOG_NOCREATE\tab Do not attempt to create the file at this time (wait until the first error is posted).  Ignored if ELOG_BANNER given.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {unsigned long ErrSetOptFlags}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetOptFlags function}}}{ (unsigned long flags)
\par }\pard\plain \s59\li1440\sb60\sa60\keepn\widctlpar\adjustright \f16\fs20\cgrid {Sets one or more bit-flags, which should be combined with the bitwise-OR operator into the }{\b\i flags}{ argument.  The flags may be any of the following [default state in brackets]:
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {EO_LOG_SEVERITY\tab Log an indication of the severity (e.g. "WARNING") to the file [yes]
\par EO_MSG_SEVERITY\tab Show an indication of the severity (e.g. "WARNING") to the user [yes]
\par EO_SHOW_SEVERITY\tab EO_LOG_SEVERITY | EO_MSG_SEVERITY
\par EO_LOG_CODES\tab Log the module name, error code, and subcode [yes]
\par EO_MSG_CODES\tab Show the module name, error code, and subcode to the user [yes]
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {EO_SHOW_CODES\tab EO_LOG_CODES | EO_MSG_CODES
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {EO_LOG_FILELINE\tab Log the source file and line number at which ErrPostEx was called [yes]
\par EO_MSG_FILELINE\tab Show the source file and line number to the user [no]
\par EO_SHOW_FILELINE\tab EO_LOG_FILELINE | EO_MSG_FILELINE
\par EO_LOG_USERSTR\tab Log programmer-defined error strings [yes]
\par EO_MSG_USERSTR\tab Show programmer-defined error strings to the user [yes]
\par EO_SHOW_USERSTR\tab EO_LOG_USERSTR | EO_MSG_USERSTR
\par EO_LOG_ERRTEXT\tab Show the error message to the user [yes]
\par EO_MSG_ERRTEXT\tab Log the error message [yes]
\par EO_SHOW_ERRTEXT\tab EO_LOG_ERRTEXT | EO_MSG_ERRTEXT
\par EO_LOG_MSGTEXT\tab Retrieve and log the verbose explanatory text from a message file [no]
\par EO_MSG_MSGTEXT\tab Retrieve the verbose explanatory text from a message file and and present it to the user [no]
\par EO_SHOW_MSGTEXT\tab EO_LOG_MSGTEXT | EO_MSG_MSGTEXT
\par EO_XLATE_CODES\tab Translate the integer error code and subcode into the mnemonic strings defined in an error message file.  (If the file cannot be found, the integer values are displayed as if this flag were not set.)
\par EO_BEEP\tab Produce an audible beep when displaying an error to the user [no]
\par EO_WAIT_KEYPRESS\tab Wait for the user to press a key or button before continuing [no]
\par EO_PROMPT_ABORT\tab Prompt the user as to whether to abort [no]
\par EO_LOGTO_USRFILE\tab Log to the error log file [no]
\par EO_LOGTO_STDOUT\tab Log to stdout [no]
\par EO_LOGTO_STDERR\tab Log to stderr [no]
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {EO_LOGTO_TRACE\tab Log to the "trace device" (see TRACE, below) [no]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {unsigned long ErrClearOptFlags}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrClearOptFlags function}}}{ (unsigned long flags)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Clears one or more bit-flags (see above), which may be combined with the bitwise-OR operator into the }{\b\i flags}{ argument.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {unsigned long ErrTestOptFlags}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrTestOptFlags function}}}{ (unsigned long flags)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Tests one or more bit-flags (see above), which may be combined with the bitwise-OR operator into the }{\b\i flags}{ argument.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrSaveOptions}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSaveOptions function}}}{ (ErrOpts *erropt)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Copies all error option settings to the local buffer pointed to by }{\b\i erropt}{.  This will include severity levels for logging, displaying, and aborting as well as all option flags.  This should be done prior to changing any settings if you intend to later restore the state.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrRestoreOptions}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrRestoreOptions function}}}{ (const ErrOpts *erropt)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Restores the error options state using the information that was previously captured using ErrSaveOptions in the buffer pointed to by }{\b\i erropt}{.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649132}Configuration File Settings{\*\bkmkend _Toc300649132}
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {The main configuration file for the NCBI toolkit (variously called .ncbirc, ncbi.ini, or ncbi.cfg, etc., depending on the platform) may contain settings within the "ErrorProcessing" section to provide additional runtime customization.  Here are some example settings:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {[ErrorProcessing]
\par 
\par ;  need to tell the system where the message files are kept
\par MsgPath=/sun/ncbi/errmsg
\par 
\par SEV_INFO    = "==> note    "
\par SEV_WARNING = "==> WARNING "
\par SEV_ERROR   = "==> ERROR   "
\par SEV_FATAL   = "==> FATAL   "
\par 
\par ;  override a few of the option flags
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {EO_SHOW_MSGTEXT = 1   ;always show me everything...
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {EO_BEEP = 0           ;...but those beeps drive me nuts
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {The MsgPath key is used to tell the system where to look for error message files.  If this setting is not present, only the current directory will be examined.  Failure to locate the error message file will not prevent any application from running.  Instead, it will simply not be possible to convert integer error codes to strings or to display verbose error messages.
\par The strings that are used to indicate the severity of the error ("WARNING", for example) may be modified if desired.  To do so, use the same symbols used to indicate severity in your code (e.g., SEV_WARNING) as the key with the desired string as the value.  In the example above, the strings are quoted, but this is only required if leading or trailing spaces are to be included in the string.
\par In a similar fashion, each of the option flags may be set or cleared by using the symbol for that flag as the key and either 1 (one) or 0 (zero) as the value (alternatively, you can use YES/NO or TRUE/FALSE).  Note that these settings override anything that the programmer may have chosen to implement.  For example, if the configuration file contained the line EO_BEEP=0, there would be no beeps sounded on an error even if the code explicitly contained the command }{\b ErrSetOptFlags}{(EO_BEEP).
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {\page {\*\bkmkstart _Toc300649133}Preparing Error Message Files{\*\bkmkend _Toc300649133}
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {You can use your favorite text editor to prepare error message files}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Error message files\:preparing}}}{ as they are plain ASCII text.  However, the name of the file is significant; it must be derived from the module name by converting to all lower case characters and appending the ".msg" extension.  For example, the message file for the "CoreLib" module should be called "corelib.msg" (shown below).  The first line of the file should consist of the keyword "MODULE" followed by the name of the module (e.g. "CoreLib" in the example below).  
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {MODULE CoreLib
\par 
\par $$ NoMemory, 1, SEV_FATAL
\par 
\par $$ File, 2, SEV_INFO
\par 
\par $^   Open, 1
\par This often indicates that the file simply does not exist. 
\par Alternatively, it may exist but you do not have permission to 
\par access the file in the requested mode.
\par 
\par $^   Read, 2
\par Not sure what would cause this...
\par 
\par $^   Write, 3, SEV_FATAL
\par This may indicate that the filesystem is full.
\par 
\par $$ Math, 3
\par $^   Param, 1
\par $^   Domain, 2
\par $^   Range, 3
\par $^   Iter, 4
\par 
\par $$ SGML, 4
\par $^   Init, 1
\par $^   Braces, 2
\par $^   Entity, 3
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Lines beginning with "$$" are used to define a main-level error code.  The first two (comma delimited) tokens on the line are the mnemonic string and integer representations of the error.  In the example above, the string "NoMemory" is equated to error code 1.  These two tokens are required, but a third optional token may be supplied to specify a severity level to be used when posting that error.  Note that this overrides the severity used by the programmer and therefore allows for runtime customization of the program.  In the example above, all "NoMemory" errors would be fatal.
\par In a similar manner, lines beginning with "$^" may be used to define subcodes within the scope of the maincode that appears above it.  In the example above, "Open" is a subcode within "File".  A subcode can inherit a severity from its parent if it does not have one of its own.  For example, SEV_INFO would used for all "File" errors with the exception of "Write", which would be SEV_FATAL.
\par Below any maincode or subcode line you may (optionally) enter a block of text to be used as the verbose error message.  This is appended to the actual error message posted by the program and is intended to provide addional explanation.  A common pitfall is to repeat the error message in the explanation.  For example, you would probably not want to begin the explanation for File.Write with "A file write error has occurred" because this would almost certainly be in the original error message.  
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649134}Fetching and Displaying Errors{\*\bkmkend _Toc300649134}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrPeek}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrPeek function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Returns a non-zero value if an error pending (i.e., has been posted but not yet processed).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrCopy}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrCopy function}}}{ (ErrDesc *errdesc)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {In an error is pending, information about the error is copied to the local buffer pointed to by }{\b\i errdesc}{ and a non-zero value is returned.  The error is not cleared by this function and may still be displayed by calling }{\b ErrShow}{. Zero is returned if no error is pending.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrClear}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrClear function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Clears a pending error, if there is one.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrFetch}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrFetch function}}}{ (ErrDesc *errdesc)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Copies the description of the pending error, if there is one, to }{\b\i errdesc}{ and then clears the error condition (functionally equivalent to }{\b ErrCopy}{ followed by }{\b ErrClear}{).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int ErrShow}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrShow function}}}{ ()
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {If an error is pending and its severity is greater than or equal to the MessageLevel setting, it is displayed to the user via a call to the }{\b MsgAlert}{ function.  If the EO_PROMPT_ABORT option flag has been set, the message includes the question "Abort, Retry, or Ignore ?".  In this case, if the users responds "Abort", the program aborts (otherwise, execution continues and either ANS_RETRY or ANS_IGNORE is returned so the caller may decide whether or not to distinguish between these alternatives).  If the EO_PROMPT_ABORT bit is cleared (as it is by default), the program will abort if the severity of the error is greater than or equal to the FatalLevel.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649135}Installing Custom Error Handlers{\*\bkmkend _Toc300649135}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ErrHookProc ErrSetHandler}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrSetHandler function}}}{ (ErrHookProc hook)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {Hook function\:for error handling}}}{ as the function to be called when an error posted.  If error logging is enabled, the error will already have been logged before the hook function is called.  The hook function takes a pointer to an ErrDesc structure and should return a non-zero value if it handled the error (preferably ANS_OK) and zero if it did not.  In the latter case, the system will perform the default error handling, which may involve displaying the error and/or halting the program.  
\par }\pard \s59\li1440\sb60\sa60\keepn\widctlpar\adjustright {\page Here's an Example:
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {#include <ncbi.h>
\par 
\par int LIBCALLBACK MyErrorHandler (const ErrDesc *err)
\par \{
\par \tab if (strcmp(err->cntxstr,"CoreLib") ==0 &&
\par \tab \tab \tab err->errcode == E_NoMemory)
\par \tab \{
\par \tab \tab Beep(); Beep(); Beep(); /* something they'll notice! */
\par \tab \tab ReleaseLifeboat(); /* free up memory reserves */
\par \tab \tab return ErrShow();
\par \tab \}
\par \tab return 0;  /* zero means we didn't handle the error */
\par \}
\par 
\par int main (int argc, char **argv)
\par \{
\par \tab ErrSetHandler(MyErrorHandler);
\par 
\par \tab }{\i\f0\fs20 ... do stuff ...}{\i 
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab return 0;
\par \}
\par 
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649136}Miscellaneous Utility Functions{\*\bkmkend _Toc300649136}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrLogPrintf}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrLogPrintf function}}}{ (const char *fmt, ...)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Formats a string using a printf-style format string }{\b\i fmt}{ and a variable-length list of arguments and then writes it to any error logging streams that may have been enabled.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void ErrLogPrintStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ErrLogPrintStr function}}}{ (const char *str)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Similar to ErrLogPrintf, except that }{\b\i str}{ is a single string to be written to the error logging streams (for users of programming languages other than C or C++).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void AbnormalExit}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {AbnormalExit function}}}{ (int)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Terminates the program immediately.  This function should only be called if an application is not capable of exiting any other way.  Cleanup code (e.g. closing files and sockets) will not generally get called before program halts.  On some systems, calling this function may also invoke a debugger if one has been installed.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649137}Files and Directories{\*\bkmkend _Toc300649137}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649138}ANSI-Style Functions{\*\bkmkend _Toc300649138}
\par }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {NCBI Toolbox\cell }\pard \s61\keep\widctlpar\intbl\adjustright {ANSI C \cell }\pard \s61\keep\widctlpar\intbl\adjustright {Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\cltxlrtb \cellx5040\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FileOpen\cell fopen\cell Opens a file for reading or writing\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FileClose\cell fclose\cell Closes an open file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FileRead\cell fread\cell Reads bytes from an open file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FileWrite\cell fwrite\cell Writes bytes to an open file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FileGets\cell fgets\cell Reads a string from an open file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FilePuts\cell fputs\cell Writes a string to an open file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649139}Directory Management{\*\bkmkend _Toc300649139}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean CreateDir}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {CreateDir function}}}{ (char *pathname)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a directory called }{\b\i pathname}{.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void FileCreate}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileCreate function function}}}{ (char *fileName, char *type, char *creator)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* TmpNam}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {TmpNam function}}}{ (char *tmp)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Generates a unique temporary file name.  If a pointer to a string buffer is supplied as the }{\b\i tmp}{ argument, the name is placed there, otherwise it is formatted in a static buffer within the library.  Either way, the return value points to the generated temporary file name.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean FileRemove}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileRemove function}}}{ (char *fileName)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Removes the file }{\b\i fileName}{, if it exists.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean FileRename}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileRename function}}}{ (char *oldFileName, char *newFileName)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Changes the name of a file from }{\b\i oldFileName}{ to }{\b\i newFileName}{.  The file cannot generally be moved from one directory to another, so no path should be included.  The return value indicates success or failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* FileBuildPath}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileBuildPath function}}}{ (char *root, char *subpath, char *filename)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* FileNameFind}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileNameFind function}}}{ (char *pathname)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns a pointer to the filename portion of }{\b\i pathname}{.  For example, on a Macintosh system, FileNameFind("harddisk:System Folder:Excel Settings") would return a pointer to "Excel Settings".
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Int4 FileLength}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {FileLength function}}}{ (char *fileName)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the length (in bytes) of the file called }{\b\i fileName}{.  If the length cannot be determined, zero is returned.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649140}CD-ROM{\*\bkmkend _Toc300649140}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean EjectCd}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {EjectCd function}}}{ (char *sVolume, char *deviceName, char *rawDeviceName, char *mountPoint, char *mountCmd)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Ejects a CD-ROM from the device.  This function has no effect on DOS and Microsoft Windows systems.
\par }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5400\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9108\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Parameter\cell Operating System\cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\cltxlrtb \cellx5400\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9108\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {sVolume\cell MacOS\cell Volume name, e.g. \ldblquote SEQDATA\rdblquote \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {deviceName\cell UNIX\cell Name of CD-ROM device, e.g. \ldblquote /dev/sr0\rdblquote \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {rawDeviceName\cell UNIX\cell Name of raw device, e.g. \ldblquote dev/rsr0\rdblquote \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {mountPoint\cell UNIX, VMS\cell Filesystem location where CD-ROM data should be mounted, e.g. \ldblquote /cdrom\rdblquote \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3330\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5400\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9108\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {mountCmp\cell UNIX\cell A script or program that performs the ejecting and mounting actions.  For many UNIX systems, mounting requires super-user privileges\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean MountCd}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MountCd function}}}{ (char *sVolume, char *deviceName, \line char *mountPoint, char *mountCmd)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Mounts a CD-ROM.  The parameters are the same as those described for EjectCd, except that the raw device is not needed.  This function has no effect on DOS and Microsoft Windows systems.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {\page {\*\bkmkstart _Toc300649141}Customization{\*\bkmkend _Toc300649141}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void SetFileOpenHook (FileOpenHook hook)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i hook}{ as the function to be called by FileOpen to actually open the file. The arguments of the hook function are the same as those for FileOpen.  In the following example, the hook function looks to see if a full path is given and, if so, first attempts to open a file of the same name in the current directory.  If that fails, a normal file open is performed using the fopen function.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {FILE* LIBCALLBACK  MyFileOpenHook (const char *fname, const char *fmode);
\par 
\par Int 2 Main ()
\par \{
\par \tab SetFileOpenHook (myFileOpenHook);
\par 
\par \tab }{\i\f0\fs20 ... do stuff ...}{\i 
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab return 0;\line \}
\par 
\par FILE* LIBCALLBACK  MyFileOpenHook (const char *fname, const char *fmode)
\par \{
\par \tab /* Note:  FileOpen checks for NULL arguments, so we don\rquote t
\par \tab \tab have to do it here */
\par 
\par \tab char *p = strchr(fname,DIRDELIMCHR);
\par \tab if (p != NULL)
\par \tab \{
\par \tab \tab FILE *fd = fopen(p+1,fmode);
\par \tab \tab if (fd != NULL)
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab \tab \tab return fd;
\par }\pard \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 {\tab \}
\par \tab return fopen(fname,fmode);\line \}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649142}Memory Management{\*\bkmkend _Toc300649142}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Services for the dynamic allocation and deallocation of memory differ widely among platforms.  All of them provide standard ANSI functions, such as }{\b malloc}{, which allocates non-relocatable memory blocks that are referenced by pointers.  In addition, the Macintosh and Microsoft Windows environments provide the ability to allocate relocatable memory blocks, which is designed to reduce heap fragmentation.  Relocatable blocks are referenced by }{\i handles}{ instead of pointers.  They must be }{\i locked}{ before use and a valid pointer is obtained as part of the lock operation. When they are later }{\i unlocked,}{ the pointer becomes invalid.  For most routine uses, we recommend using fixed memory.  Clearly, fixed memory is easier to use (since locking is unnecessary), and ongoing advances in chip architectures and system software on the microcomputer platforms are eliminating the performance advantage that relocatable memory currently offers.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649143}ANSI-Style Functions{\*\bkmkend _Toc300649143}
\par }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {NCBI Toolkit\cell ANSI C\cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\cltxlrtb \cellx5040\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Malloc\cell malloc\cell Allocates memory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Calloc\cell calloc\cell Allocates memory\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Realloc\cell realloc\cell Changes the size of a previously allocated block.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Free\cell free\cell Frees a memory block.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MemCopy\cell memcpy\cell Copies a range of bytes .\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MemMove\cell memmove\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Copies a range of bytes (source and destination may overlap).\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MemFill\cell memset\cell Sets a range of bytes to a particular value.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {\page {\*\bkmkstart _Toc300649144}Fixed Memory{\*\bkmkend _Toc300649144}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemGet}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemGet function}}}{ (size_t size, unsigned int flags)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Allocates a fixed memory block containing }{\b\i size}{ bytes using options encoded in }{\b\i flags}{ and returns a pointer to it. The flags may be any of the following:
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {MGET_CLEAR\tab Clears the allocated memory to zeros.
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {MGET_ERRPOST\tab Posts an error (severity ERR_FATAL) on memory allocation failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemNew function}}}{ (size_t bytes)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {General-purpose fixed memory allocator that calls MemGet with the MGET_CLEAR and MGET_ERRPOST flags.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemMore}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemMore function}}}{ (void *ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Changes the size of a fixed memory block }{\b\i ptr}{ to }{\b\i size}{ bytes.  On failure, NULL is returned. 
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemExtend}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemExtend function}}}{ (void *ptr, size_t size, size_t oldsize)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Changes the size of a fixed memory block }{\b\i ptr}{, the current size of which must be supplied as }{\b\i oldsize}{, to a new size of }{\b\i size}{.  If }{\b\i size}{ is greater than }{\b\i oldsize}{, the additional memory is cleared to zeros.  On failure, NULL is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemDup}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemDup function}}}{ (const void *ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Duplicates a fixed memory block }{\b\i ptr}{, the size of which must be supplied as the }{\b\i size}{ argument.  On failure, NULL is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* MemFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {MemFree function}}}{ (void *ptr)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Frees the mixed memory block }{\b\i ptr}{ (if it is non-NULL).  The return value is always NULL.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649145}Relocatable Memory{\*\bkmkend _Toc300649145}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {We provide functions for the manipulation of relocatable memory, but on systems where this is not available, fixed memory is used instead (and the type Handle is equivalent to Pointer).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Handle HandGet}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandGet function}}}{ (size_t size, Boolean clear)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Allocates a moveable memory block containing }{\b\i size}{ bytes.  On failure, NULL is returned (no error is posted).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Handle HandNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandNew function}}}{ (size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Allocates a moveable memory block containing }{\b\i size}{ bytes and clears it to zeros.  On failure, an error is posted (SEV_FATAL) and NULL is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Handle HandMore}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandMore function}}}{ (Handle hnd, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Changes the size of moveable block }{\b\i hnd}{ to }{\b\i size}{ bytes.  On success, the return value is the re-sized block, which may or may not be the same as }{\b\i hnd}{.  On failure, NULL is returned.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Handle HandFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandFree function}}}{ (Handle hnd)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Frees moveable memory block }{\b\i hnd}{ (if non-NULL).  The return value is always NULL.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* HandLock}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandLock function}}}{ (Handle hnd)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Locks moveable memory block }{\b\i hnd}{ and returns a pointer to it.  The pointer remains valid until HandUnlock is called.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* HandUnlock}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HandUnlock function}}}{ (Handle hnd)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Unlocks moveable memory block }{\b\i hnd}{ that was previously locked with HandLock.
\par NOTE: Ensure that you do not have nested HandLock/HandUnlock calls.  Although some systems will handle this situation properly, others do not.  Notably, on the Macintosh, HandUnlock will always unlocked by HandUnlock regardless of how many times it was locked.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649146}Byte Stores{\*\bkmkend _Toc300649146}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {We have implemented an additional type of dynamic storage called a }{\i ByteStore}{.  It is designed to look and behave much like an unformatted file, but its data exist in memory (however, due to various virtual memory schemes, the data may be in files after all!).  A ByteStore is especially useful for storing large amounts of data that would normally exceed the limits imposed by systems using 16-bit memory addressing.
\par A ByteStore is created by }{\b BSNew}{ and the pointer it returns is a requried argument for the remaining ByteStore functions.  At the end of its lifespan, it is deallocated by the }{\b BSFree}{ function.
\par A ByteStore has a }{\i logical length}{, which is returned by }{\b BSLen}{ and corresponds to the number of bytes of data it contains.  The }{\i physical length}{ of a ByteStore is actual amount of memory allocated and is often larger than the logical length.  All functions that add data to a ByteStore automatically take care of increasing the physical length to accomodate the logical length.
\par As with file I/O, a ByteStore uses the notion of a }{\i current position}{ that is used for reading and writing data.  The functions }{\b BSSeek}{ and }{\b BSTell}{ provide a means of setting and querying the current position.  The functions BSRead, BSWrite, BSGetByte, and BSPutByte are analogous to functions used in file I/O.  However, unlike file I/O, an block of data may be inserted or deleted internally using }{\b BSInsert}{ and }{\b BSDelete}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ByteStorePtr BSNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSNew function}}}{ (long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a ByteStore with an initial physical length of }{\b\i len}{ and returns a pointer to it.  If }{\b\i len}{ is zero, a default physical size is used.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ByteStorePtr BSDup}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSDup function}}}{ (ByteStorePtr bs)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ByteStore that is a copy of }{\b bs}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* BSMerge}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSMerge function}}}{ (ByteStorePtr bs, void *buff)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Copies }{\i all}{ of the data in ByteStore }{\b bs}{ to a single memory buffer }{\b\i buff}{.  If }{\b\i buff}{ is NULL, the function will allocate a buffer of the correct size.  Otherwise, it is the responsibility of the caller to ensure that the buffer is at least as large as the value returned by }{\b BSLen}{.  The return value is the pointer to the buffer containing the merged data.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ByteStorePtr BSFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSFree function}}}{ (ByteStorePtr bs)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Deallocates ByteStore }{\b\i bs}{ (if bs is NULL, nothing happens).  The return value is always NULL.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSLen}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSLen function}}}{ (ByteStorePtr bs)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the logical length of ByteStore }{\b\i bs}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Int2 BSSeek}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSSeek function}}}{ (ByteStorePtr bs, long offset, int origin)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Moves the current position of ByteStore }{\b\i bs}{ to }{\b\i offset}{ bytes from the point indicated by }{\b\i origin}{, which may be any of the following:
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab New position
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {SEEK_SET\tab offset bytes from the beginning of the ByteStore
\par SEEK_END\tab offset bytes from the end of the ByteStore
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {SEEK_CUR\tab offset bytes from the current position
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSTell}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSTell function}}}{ (ByteStorePtr bs)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the current position of ByteStore }{\b bs}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSWrite}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSWrite function}}}{ (ByteStorePtr bs, void *buff, long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Writes }{\b\i len}{ bytes of data from the memory buffer }{\b\i buff}{ to the current position of ByteStore }{\b\i bs}{.  Following this operation, the current position will be increased by the number of bytes written.  The return value is the same as }{\b\i len}{ if the write was successful or zero if not.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSRead}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSRead function}}}{ (ByteStorePtr bs, void *buff, long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Attempts to read }{\b\i len}{ bytes of data from the current position of ByteStore }{\b\i bs}{ to the buffer }{\b\i buff}{.  The return value is the number of bytes actually read, which may be less than }{\b\i len}{ if the logical end of data is reached.  Following this operation, the current position will be increased by the number of bytes read.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSInsert}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSInsert function}}}{ (ByteStorePtr bs, void *buff, long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Inserts }{\b\i len}{ bytes from memory buffer }{\b\i buff}{ before the current position in ByteStore }{\b\i bs}{.  The current position is then increased by len so that it points to the position just after the inserted range.  The return value is the same as }{\b\i len}{ if the insertion was successful or zero if not.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSInsertFromBS}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSInsertFromBS function}}}{ (ByteStorePtr bs, ByteStore *bs2, long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Inserts }{\b\i len}{ bytes into ByteStore }{\b\i bs}{ by reading them from a second ByteStore }{\b\i bs2}{.  The return value is the actual number of bytes transferred, and the current positions of both ByteStores will be increased by this amount.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long BSDelete}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSDelete function}}}{ (ByteStorePtr bs, long len)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Deletes }{\b\i len}{ bytes from ByteStore }{\b\i bs}{ beginning at the current position (which is not changed by the operation).  The return value specifies the actual number of bytes deleted, which may be less than }{\b\i len}{ if the logical end of data was reached.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Int2 BSPutByte}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSPutByte function}}}{ (ByteStorePtr bs, int b)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Inserts the byte }{\b\i b}{ at the current position of ByteStore bs and advances the position by one.  If }{\b\i b}{ is equal to the constant EOF, the ByteStore is truncated at the current position.  The return value is }{\b\i b}{ on success or EOF on failure.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Int2 BSGetByte}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {BSGetByte function}}}{ (ByteStorePtr bs)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the byte at the current position of ByteStore bs and advances the position by one.  If the logical end of data has been reached, the constant EOF is returned.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649147}String Functions{\*\bkmkend _Toc300649147}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649148}ANSI-Style Functions{\*\bkmkend _Toc300649148}
\par }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {NCBI Toolkit\cell ANSI C \cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\i \row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\cltxlrtb \cellx5040\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringLen\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {strlen\cell Gets string length\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringCpy\cell strcpy\cell Copies a string\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringNCpy\cell strncpy\cell Copies a string (n chars)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringCat\cell strcat\cell Catenates strings\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringNCat\cell strncat\cell Catenates strings (n chars)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringCmp\cell strcmp\cell Compares strings\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringNCmp\cell strncmp\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Compares strings (n chars)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringChr\cell strchr\cell Searches for a character in a string (from beginning)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringRChr\cell strrchr\cell Searches for a chatacter in a string (from end)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringPBrk\cell strpbrk\cell Searches for first characters in a string that is a member of a specified set\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringStr\cell strstr\cell Searches for a substring in a string\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringSpn\cell strspn\cell Counts leading characters that are members of a specified set\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringCSpn\cell strcspn\cell Counts leading characters that are not members of a specified set\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringSet\cell strset\cell Sets all characters of a string to a specified character\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringNSet\cell strnset\cell Sets up to n characters of a string to a specified character\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringTok\cell strtok\cell Breaks a string into tokens\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Refer to ANSI C documentation for details.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649149}Additional String Functions{\*\bkmkend _Toc300649149}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int StringICmp}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {StringICmp function}}}{ (const char *a, const char *b)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Compares strings }{\b\i a}{ and }{\b\i b}{ like }{\b StringCmp}{, but ignoring case (assumes ASCII character set).  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int StringNICmp}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {StringNICmp function}}}{ (const char *a, const char *b, size_t n)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Compares up to the first }{\b\i n}{ characters of strings }{\b\i a}{ and }{\b\i b}{ like }{\b StringNCmp}{, but ignoring case (assumes ASCII character set).
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* StringMove}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {StringMove function}}}{ (char *dst, const char *src)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Copies the string }{\b\i src}{ to }{\b\i dst}{\i  }{and returns a pointer to the null byte that terminates the catenated string.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* StringSave}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {StringSave function}}}{ (const char *str)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Copies }{\b\i str}{ to a dynamically allocated memory block an returns a pointer to that block.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {size_t StringCnt}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {StringCnt function}}}{ (const char *str, const char *list)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Searches the string }{\b\i str}{ for any of the characters of the string }{\b\i list}{ and returns the number of occurances found.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649150}Number Strings{\*\bkmkend _Toc300649150}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Several functions are provided for converting integers to ASCII strings.  The following option flags determine how the string is formatted (may be combined with the bitwise-OR operator).
\par }\pard\plain \s63\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx3600\adjustright \i\f16\fs18\cgrid {Symbol\tab Description
\par }\pard\plain \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright \f16\fs20\cgrid {MISC_COMMAS\tab Insert commas only when |value| >= 10,000
\par MISC_ALLCOMMAS\tab Insert commas for any |value| >= 1,000
\par MISC_ANYCOMMAS\tab Both MISC_COMMAS and MISC_ALLCOMMAS
\par }\pard \s64\fi-2160\li3600\sb20\sa40\keep\keepn\widctlpar\brdrl\brdrs\brdrw15\brsp20 \brdrb\brdrs\brdrw15\brsp20 \brdrr\brdrs\brdrw15\brsp20 \tx3600\adjustright {MISC_PLUSSIGNS\tab Prepend a plus sign (+) to positive values\tab 
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* Ltostr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Ltostr function}}}{ (long x, int opts)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Converts the integer value }{\b\i x}{ to ASCII using options }{\b\i opts}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int Lwidth}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Lwidth function}}}{ (long x, int opts)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the length of the string that would result from the conversion of integer value }{\b\i x}{ to ASCII using options }{\b\i opts}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* Ultostr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Ultostr function}}}{ (unsigned long x, int opts)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Converts the unsigned integer value }{\b\i x}{ to ASCII using options }{\b\i opts}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int Ulwidth}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Ulwidth function}}}{ (unsigned long x, int opts)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the length of the string that would result from the conversion of unsigned integer value }{\b\i x}{ to ASCII using options }{\b\i opts}{.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649151}Time Strings{\*\bkmkend _Toc300649151}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean DayTimeStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {DayTimeStr function}}}{ (char *buf, Boolean date, Boolean time)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Gets the current calendar time and generates a string representation in }{\b\i buf}{. containing the date and/or time as specified by the }{\b\i date}{ and }{\b\i time}{ arguments.  The buffer should be of sufficient size to hold 24 characters.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649152}SGML Strings{\*\bkmkend _Toc300649152}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {char* Sgml2Ascii}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Sgml2Ascii function}}}{ (const char *sgml, char *ascii, size_t buflen)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Converts the SGML string in }{\b\i sgml}{ into a printable ASCII string and copies it to }{\b\i ascii}{.  The }{\b\i buflen}{ parameter gives the length of the }{\b\i ascii}{ buffer.  The return value is the same as }{\b\i ascii}{ [[check this]].
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {size_t Sgml2AsciiLen}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Sgml2AsciiLen function}}}{ (const char *sgml)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the length of the printable ASCII string that would result from convesion from SGML text.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649153}ValNode Functions{\*\bkmkend _Toc300649153}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {A ValNode is a simple data structure that allows a mixture of data types to be grouped into a linked list. It contains a "choice" slot, which is used to discriminate the datatype held in the union called "data". ValNodes are used extensively in ASN.1 objects to represent CHOICE, SEQUENCE OF, and SET OF types. They are also used in other NCBI functions where a very flexible linked list is required.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {typedef union dataval 
\par \{
\par \tab VoidPtr ptrvalue;
\par \tab Int4 intvalue;
\par \tab FloatHi realvalue;
\par \tab Boolean boolvalue;
\par \} DataVal, *DataValPtr;
\par 
\par typedef struct valnode 
\par \{
\par \tab Uint1 choice;\tab \tab \tab /* to pick a choice */
\par \tab DataVal data;\tab \tab \tab /* attached data */
\par \tab struct valnode *next;\tab \tab /* next in linked list */
\par \} ValNode}{\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \v\f2\fs16\cgrid {\xe {ValNode structure}}}{, *ValNodePtr;
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeNew function}}}{ (ValNodePtr node)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode and returns a pointer to it.  If desired, the newly-created node may be attached to the end a linked list, of which }{\b\i node}{ is the tail element.  Otherwise }{\b\i node}{ should be NULL.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAdd}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeAdd function}}}{ (ValNodePtr *head)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode and returns a pointer to it.  The }{\b\i head}{ argument points to a variable that contains the head element of a linked list of ValNodes to which the new node should be appended.  If }{\b\i head}{ contains NULL, it will be initialized with the pointer to the newly-created ValNode.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAddBoolean}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeAddBoolean function}}}{ (ValNodePtr *head, Int2 choice, Boolean bool)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.boolvalue member to }{\b\i bool}{.  The return value is the new ValNode.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAddInt (ValNodePtr *head, Int2 choice, Int4 value)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.intvalue to }{\b\i value}{.  The return value is the new ValNode.}{\f6 
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAddFloat (ValNodePtr *head, Int2 choice, FloatHi value)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.intvalue to }{\b\i value}{.  The return value is the new ValNode.}{\f6 
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAddStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeAddStr function}}}{ (ValNodePtr *head, Int2 choice, CharPtr str)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.ptrvalue member to the string }{\b\i str}{.  The string is }{\i not}{ copied to allocated storage.  The return value is the new ValNode.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeCopyStr}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeCopyStr function}}}{ (ValNodePtr *head, Int2 choice, CharPtr str)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.ptrvalue member to a copy of the string }{\b\i str}{.  The return value is the new ValNode.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeAddPointer (ValNodePtr *head, Int2 choice, Pointer ptr)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Creates a new ValNode by calling }{\b ValNodeAdd}{ and sets its choice member to }{\b\i choice}{ and its data.ptrvalue to }{\b\i ptr}{.  The return value is the new ValNode.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeLink}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeLink function}}}{ (ValNodePtr *head, ValNodePtr node)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Adds }{\b\i node}{ to the end of a linked list whose head element is in the variable pointed to by }{\b\i head}{.  If head contains NULL, it is ititialized with to the value of }{\b\i node}{.  The return value is always the head element of the linked list.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeFree function}}}{ (ValNodePtr node)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Frees an entire list of ValNode structures of which }{\b\i node}{ is the head element.  Whatever data may be referenced in the data member is }{\i not}{ freed. The return value is always NULL.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeFreeData}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeFreeData function}}}{ (ValNodePtr vn)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Frees a list of ValNode structures like the }{\b ValNodeFree}{ function, except that associated data is also freed.  This function should only be used if it is known that the data.ptrvalue member of every node in the list is either NULL or a valid pointer to a single fixed memory block.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeExtract}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ValNodeExtract function}}}{ (ValNodePtr *head, Int2 choice)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Scans the linked list whose head element is in the variable pointed to by }{\b\i head}{ for the first node whose choice element is equal to }{\b\i choice}{.  If found, the node is unlinked from the list and returned as the function result.  If it is not found, NULL is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeExtractList (ValNodePtr *headptr, Int2 choice)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Scans the linked list whose head element is in the variable pointed to by }{\b\i head}{ for all nodes whose choice element is equal to }{\b\i choice}{.  The return value is the head element of a linked list of all such nodes.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr ValNodeFindNext (ValNodePtr head, ValNodePtr curr, Int2 choice)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Scans a linked list of ValNodes for a node whose choice member is equal to }{\b\i choice}{ and returns a pointer to it.  The search begins with }{\b\i curr}{, if non-NULL, or }{\b\i head}{ otherwise.  If }{\b\i choice}{ is negative, the next node is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr NodeListNew}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListNew function}}}{ (void)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr NodeListFree}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListFree function}}}{ (ValNodePtr head)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Int2 NodeListLen}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListLen function}}}{ (ValNodePtr node)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the number of elements in the linked list of which }{\b\i node}{ is the head element.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ValNodePtr NodeListFind}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListFind function}}}{ (ValNodePtr head, Int2 item, Boolean extend)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListRead}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListRead function}}}{ (ValNodePtr head, Int2 item, VoidPtr ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListWrite}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListWrite function}}}{ (ValNodePtr head, Int2 item, VoidPtr ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListAppend}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListAppend function}}}{ (ValNodePtr head, VoidPtr ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListInsert}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListInsert function}}}{ (ValNodePtr head, Int2 item, VoidPtr ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListReplace}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListReplace function}}}{ (ValNodePtr head, Int2 item, VoidPtr ptr, size_t size)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean NodeListDelete}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NodeListDelete function}}}{ (ValNodePtr head, Int2 item)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {[[ ...insert text here... ]]
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649154}Math Functions{\*\bkmkend _Toc300649154}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649155}Macros{\*\bkmkend _Toc300649155}
\par }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Macro\cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {LN2}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {LN2 macro}}}{\cell Natural logarithm of 2\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {LN10}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {LN10 macro}}}{\cell Natural logarithm of 10\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {EXP2}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {EXP2 macro}}}{(x)\cell Base-2 exponential of x\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {LOG2}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {LOG2 macro}}}{(x)\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Base-2 logarithm of x\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {EXP10}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {EXP10 macro}}}{(x)\cell Base-10 exponential of x\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {LOG10}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {LOG10 macro}}}{(x)\cell Base-10 logarithm of x\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649156}Arithmatic Functions{\*\bkmkend _Toc300649156}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long Gcd}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Gcd function}}}{ (long a, long b)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the greatest common divisor of }{\b\i a}{ and }{\b\i b}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long Nint}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Nint function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the nearest integer to }{\b\i x}{.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649157}Transendental Functions{\*\bkmkend _Toc300649157}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double Log1p}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Log1p function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns log(}{\b\i x}{+1) for all }{\b\i x}{ > -1
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double Expm1}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Expm1 function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns exp(}{\b\i x}{)-1 for all }{\b\i x}{
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double Powi}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Powi function}}}{ (double x, int n)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the integral power of }{\b\i x}{
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double Factorial}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Factorial function}}}{ (int x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns }{\b\i x}{! (x factorial)
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649158}Gamma Functions{\*\bkmkend _Toc300649158}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double Gamma}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {Gamma function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {gamma(}{\b\i x}{)
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double LnGamma}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {LnGamma function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {log(gamma(}{\b\i x}{))
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double LnGammaInt}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {LnGammaInt function}}}{ (int n)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {log(gamma(}{\b\i n}{)), integral n
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double DiGamma}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {DiGamma function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {digamma(}{\b\i x}{) 1st order derivative of log(gamma(x))
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double TriGamma}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {TriGamma function}}}{ (double x)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {trigamma(}{\b\i x}{) 2nd order derivative of log(gamma(x))
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double PolyGamma}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {PolyGamma function}}}{ (double x, int order)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Nth order derivative of log(gamma)
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void GammaCoeffSet}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GammaCoeffSet function}}}{ (double *coef, unsigned dimension)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Change gamma coefficients
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649159}Advanced Functions{\*\bkmkend _Toc300649159}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double LogDerivative}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {LogDerivative function}}}{ (int order, double *u)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Nth }{\b\i order}{ derivative of ln(}{\b\i u}{)
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double NRBis}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {NRBis function}}}{ (double y, double(*f) (double), double (*df) (double), double p, double x, double q, double tol)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Combined Newton-Raphson and Bisection root solver
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {double RombergIntegrate}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {RombergIntegrate function}}}{ (double(*f)(double, VoidPtr), void *fargs, double p, double q, double eps, int epsit, int itmin)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Romberg numerical integrator
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649160}Miscellaneous Utilities{\*\bkmkend _Toc300649160}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649161}Macros{\*\bkmkend _Toc300649161}
\par }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Macro\cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ABS}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {ABS macro}}}{(a)\cell Returns the absolute value of }{\b a}{ (any numerical type).\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {SIGN}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {SIGN macro}}}{(a)\cell Returns -1 if }{\b a}{ is negative, +1 if it is positive, or 0 if it is zero.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MIN}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {MIN macro}}}{(a,b)\cell Returns the maximum of }{\b a}{ and }{\b b}{ (any numerical type).\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {MAX}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {MAX macro}}}{(a,b)\cell Returns the minimum of }{\b a}{ and }{\b b}{ (any numerical type).\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ROUNDUP}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {ROUNDUP macro}}}{(a,b)\cell Rounds }{\b a}{ up to the nearest multiple of }{\b b}{.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3240\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {DIM}{\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {DIM macro}}}{(a)\cell Returns the dimension (number of elements) in the array }{\b a}{.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649162}Random Numbers{\*\bkmkend _Toc300649162}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void RandomSeed}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {RandomSeed function}}}{ (long seed)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sets the seed value of the random number generator to }{\b\i seed}{.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long RandomNum}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {RandomNum function}}}{ ()
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the next value in the series of pseudo-random numbers.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649163}Sorting{\*\bkmkend _Toc300649163}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void HeapSort}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {HeapSort function}}}{ (void *base, size_t nel, size_t size, \line int (LIBCALLBACK *cmp)(VoidPtr,VoidPtr))
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Sorts an array of elements, which may be of any basic or structured type.  The starting address of the array is }{\b\i base}{, with }{\b\i nel}{ and }{\b\i size}{ being the number and size of elements in the array.  A pointer to an element comparison function }{\b\i cmp}{ must also be supplied.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649164}Time{\*\bkmkend _Toc300649164}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {time_t  GetSecs}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetSecs function}}}{ ()
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the current value of a timer that ticks once per second.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {Boolean  GetDayTime}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetDayTime function}}}{ (struct tm *dtp)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the current time in broken-down format.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649165}Process ID{\*\bkmkend _Toc300649165}
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {long  GetAppProcessID}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetAppProcessID function}}}{ ()
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns a unique number identifying the process.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649166}Application Properties{\*\bkmkend _Toc300649166}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {We will refer to named block of arbitrary data associated with a single application instance as an }{\i application property}{.  Application properties have two main uses.  First, they allow for isolation of application instance data in certain shared library contexts where the data space would normally be shared by all applications using the library.  Second, they allow for a simple level of communication between code modules without requiring that they \ldblquote know\rdblquote  anything about each other.  For example, during initialization of your program, you might create a property called \ldblquote ProgramName\rdblquote  with a string giving the name of your program.  Other code modules might then use this property when generating various messages and reports.  Application properties are identified by a string with case being significant. They are created or modified with }{\b SetAppProperty}{, retrieved with }{\b GetAppProperty}{, and destroyed with }{\b RemoveAppProperty}{.  If you want to scan through the propery list, use }{\b EnumAppProperties}{ with a pointer to a callback function to be called once for each property.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* SetAppProperty}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {SetAppProperty function}}}{ (const char *key, void *data)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Installs }{\b\i data}{, identified by }{\b\i key}{, as a property of the current application.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* GetAppProperty}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {GetAppProperty function}}}{ (const char *key)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Returns the property data associated with }{\b\i key}{.  If the property does not exist, NULL is returned.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void* RemoveAppProperty}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {RemoveAppProperty function}}}{ (const char *key)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Removes the property of the current applicatin that is identified by }{\b\i key}{, if there is one.  If the data pointer for this property is returned as the function result and it is the responsibility of the programmer to release whatever dynamic memory may be involved.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {int EnumAppProperties}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {EnumAppProperties function}}}{ (AppPropEnumProc proc)
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {Calls the user-supplied funcion }{\b\i proc}{ once for each property of the current application.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649167}Debugging Macros{\*\bkmkend _Toc300649167}
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {The following macros are designed to assist in debugging during program development (or more precisely to prevent the need for debugging!) and are only enabled if the macro _DEBUG is defined during compilation.  However, when the time comes to build a "release version" to distribute to end-users, they can be easily disabled by recompiling without _DEBUG defined.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {void TRACE}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {TRACE macro}}}{ (const char *fmt, ...)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Formats a string using }{\b\i fmt}{ as a printf-style format string along with a variable number of arguments and then writes it to the "trace device".  What the trace device actually represents differs with the platform and compiler switches.  Under Microsoft Windows, traced messages go to the debugger console (AUX) if it is running.  Although similar facilities may exist on other platforms, none are supported at present (but we will entertain any suggestions you may have). For this reason the default \ldblquote trace device\rdblquote  on UNIX systems is \ldblquote stderr\rdblquote  and on all other platforms is to a file called \ldblquote trace.out\rdblquote . This behavior may be circumvented by doing the following prior to including <ncbi.h>:
\par 
\par #define one of these symbols:
\par \tab TRACE_TO_STDOUT
\par \tab TRACE_TO_STDERR
\par \tab TRACE_TO_AUX (Windows only)
\par \tab TRACE_TO_FILE  (goes to \ldblquote trace.out\rdblquote )
\par Followed by:
\par \tab TRACE_DEVICE_DEFINED  (inhibits redefinition)
\par 
\par }\pard \s59\li1440\sb60\sa60\widctlpar\adjustright {Note that all the above only makes TRACEing possible, but does not enable the feature. To do so, compile selected files with the symbol _DEBUG defined. This is _not_ done in the default makefiles. When _DEBUG is not defined, TRACE() has no effect.
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {ASSERT}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {ASSERT macro}}}{(}{\i expression}{)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {If _DEBUG is defined, asserts that }{\b\i expression}{ is TRUE.  If it evaluates to FALSE, a message is displayed giving the expression and the file name and line number where the assertion failed.  After this, the program halts through a call to AbnormalExit.  If _DEBUG is not defined, }{\b\i expression}{ is never evaluated.  
\par }\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\f6\fs20\cgrid {VERIFY}{\pard\plain \s60\fi-360\li1440\sb360\keepn\widctlpar\adjustright \b\v\f6\fs20\cgrid {\xe {VERIFY macro}}}{(}{\i expression}{)
\par }\pard\plain \s59\li1440\sb60\sa60\widctlpar\adjustright \f16\fs20\cgrid {Similar to ASSERT, except that }{\b\i expression}{ is always evaluated.  This should be used if the expression contains an assignment or function call that should be executed regardless of whether or not _DEBUG is defined.
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc300649168}Portability Issues{\*\bkmkend _Toc300649168}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {There are always a variety of factors conspiring to hinder the portability of C code despite the best intentions of the programmer.  These barriers are due to differences in hardware, operating systems, compilers, and filesystems.  
\par We have attempted to sequester all system-specific definitions into a single header file called }{\b ncbilcl.h}{\pard\plain \s15\li720\sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {ncbilcl.h header file}}}{\b  }{(which is included by }{\b ncbi.h}{\pard\plain \s15\li720\sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {ncbi.h header file}}}{)  It contains defined symbols describing the platform as well as type definitions and often a variety of macros.  The NCBI Toolkit includes a version of this file for each of the supported platforms.
\par }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx7020\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Filename\cell Hardware\cell Operating System\cell Compiler\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\cltxlrtb \cellx5040\clvertalt\cltxlrtb \cellx7020\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.370\cell IBM 370\cell AIX\cell System V cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.acc\cell Sun SPARC\cell SunOS\cell Sun acc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.alf  \cell DEC Alpha-XP\cell OSF/1\cell DEC C compiler\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.aov  \cell DEC Alpha-XP\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {OpenVMS\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {BSD cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.aux\cell Macintosh 68K\cell AU/X\cell AU/X\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.bor\cell Intel PC\cell MS-DOS\cell Borland C/C++\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.bwn  \cell Intel PC\cell Windows DOS\cell Borland C/C++\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.ccr  \cell Sun SPARC\cell SunOS\cell CodeCenter\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.cpp\cell Sun SPARC\cell SunOS\cell Sun C++\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.cra\cell Cray YMP\cell Unicos\cell Cray C compiler\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.cvx  \cell CONVEX\cell UNIX System V\cell BSD cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.gcc  \cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Sun SPARC\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {SunOS\cell Gnu gcc or g++\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.hp\cell HP PA-RISC\cell HP-UX\cell System V cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.mpw\cell Macintosh 68K\cell MacOS\cell Apple MPW C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.msc  \cell Intel PC\cell MS-DOS\cell Microsoft C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.msw  \cell Intel PC\cell Windows DOS\cell Microsoft C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.nxt\cell Next\cell NextStep\cell Next C compiler\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.r6k\cell IBM RS 6000\cell AIX\cell System V cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.sgi  \cell SGI MIPS\cell UNIX System V\cell System V cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.sol  \cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Sun SPARC\cell Sun Solaris\cell SunPro\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.sun\cell Sun SPARC\cell SunOS\cell BSD cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.thc\cell Macintosh 68K\cell MacOS\cell Symantec C/C++\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.ult\cell DEC MIPS\cell ULTRIX\cell System V cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1332\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5040\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx7020\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbilcl.vms\cell VAX\cell OpenVMS\cell BSD cc\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {\page {\*\bkmkstart _Toc300649169}Portable Types{\*\bkmkend _Toc300649169}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {In C, the sizes of basic types vary with each compiler implementation.  Certain minimum sizes are guaranteed by the ANSI standard, however.  The choice of which type to use in any particular situation may be based on the required precision and the natural word size of the hardware.  Always use the }{\b sizeof}{ operator rather than assuming any particular size.
\par We have defined the following types.
\par }\pard\plain \s4\li360\sb240\widctlpar\outlinelevel3\adjustright \f4\ul\cgrid {{\*\bkmkstart _Toc300649170}Integral Types{\*\bkmkend _Toc300649170}
\par }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2790\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5633\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6521\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx8120\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9719\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Type\cell Description\cell }\pard \s61\keep\widctlpar\intbl\adjustright {Size\cell }\pard \s61\keep\widctlpar\intbl\adjustright {Min. Value\cell Max. Value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx2790\clvertalt\cltxlrtb \cellx5633\clvertalt\cltxlrtb \cellx6521\clvertalt\cltxlrtb \cellx8120\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9719\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Boolean\cell A TRUE or FALSE value\cell }{\field\flddirty{\*\fldinst {symbol 179 \\f "Symbol"}}{\fldrslt }}{ 1\cell FALSE\cell TRUE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Byte\cell Smallest unit of storage that a C program can address (unsigned)\cell 1\cell 0\cell UINT_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Char\cell ASCII character occupying one byte of storage (may be either signed or unsigned) \cell 1\cell CHAR_MIN\cell CHAR_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uchar\cell Unsigned ASCII character\cell 1\cell UCHAR_MIN\cell UCHAR_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int1\cell Signed integer, 1 byte\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {1\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {INT1_MIN\cell INT1_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint1\cell Unsigned integer, 1 byte\cell 1\cell 0\cell UINT1_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int2\cell Signed integer, 2 bytes\cell }{\field\flddirty{\*\fldinst {symbol 179 \\f "Symbol"}}{\fldrslt }}{ 2\cell INT2_MIN\cell INT2_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint2\cell Unsigned intege, 2 bytes\cell }{\field\flddirty{\*\fldinst {symbol 179 \\f "Symbol"}}{\fldrslt }}{ 2\cell 0\cell UINT2_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int4\cell Signed integer, 4 bytes\cell }{\field\flddirty{\*\fldinst {symbol 179 \\f "Symbol"}}{\fldrslt }}{ 4\cell INT4_MIN\cell INT4_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2790\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx5633\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6521\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx8120\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9719\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint4\cell Unsigned integer, 4 bytes\cell }{\field\flddirty{\*\fldinst {symbol 179 \\f "Symbol"}}{\fldrslt }}{ 4\cell 0\cell UINT4_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s4\li360\sb240\widctlpar\outlinelevel3\adjustright \f4\ul\cgrid {{\*\bkmkstart _Toc300649171}Floating-point Types{\*\bkmkend _Toc300649171}
\par }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2700\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6480\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx8100\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Type\cell Description\cell Min. Value\cell Max. Value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx2700\clvertalt\cltxlrtb \cellx6480\clvertalt\cltxlrtb \cellx8100\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FloatLo\cell Low-precision floating point value (same as float)\cell FLT_MIN\cell FLT_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2700\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx6480\clvertalt\clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx8100\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FloatHi\cell High-precision floating point variable (same as double)\cell FLT_MAX\cell DBL_MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s4\li360\sb240\widctlpar\outlinelevel3\adjustright \f4\ul\cgrid {{\*\bkmkstart _Toc300649172}Pointer Types{\*\bkmkend _Toc300649172}
\par }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Type,\cell }\pard \s61\keep\widctlpar\intbl\adjustright {Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {VoidPtr\cell Generic pointer (same as Pointer)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {BoolPtr\cell Pointer to Boolean\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {BytePtr\cell Pointer to Byte\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {CharPtr\cell Pointer to Char\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {UcharPtr\cell Pointer to Uchar\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int1Ptr\cell Pointer to Int1\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint1Ptr\cell Pointer to Uint1\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int2Ptr\cell Pointer to Int2\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint2Ptr\cell Pointer to Uint2\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Int4Ptr\cell Pointer to Int4\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Uint4Ptr\cell Pointer to Uint4\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FloatHiPtr\cell }\pard \s62\sb40\sa40\keep\widctlpar\intbl\adjustright {Pointer to FloatHi\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FloatLoPtr\cell Pointer to FloatLo\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {FnPtr\cell Generic function pointer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Pointer\cell Generic pointer (same as VoidPtr)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1422\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3060\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {Handle\cell Generic handle. Points to a block of memory that is moveable on Macintosh & Windows. On other platforms it is the same as a Pointer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s4\li360\sb240\widctlpar\outlinelevel3\adjustright \f4\ul\cgrid {{\*\bkmkstart _Toc300649173}Avoiding Name Collisions{\*\bkmkend _Toc300649173}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {The types are first typedeffed with names like Nlm_Int2.  Then they are defined with easier to use names like #define Int2 Nlm_Int2.  A similar procedure is used in declaring the utility functions.  This is because one wishes to treat them in your program as real data types.  However, if a conflict with a typedeffed name in some other program or header occurs, one cannot "untypdef" things, and it's a problem to use the other headers.  #defines can be undefined which solves the conflict problem.  We typedef with "Nlm_..." in the expectation that there will be no conflict with the name. We then #define that to something easier to remember, but more likely to conflict, and get the best of both worlds. The defined types are listed below
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649174}Byte Order{\*\bkmkend _Toc300649174} 
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {The order of bytes within any integral value of size greater than 1 is defined by the hardware.  
\par Although other orderings are possible, none of the platforms we support has such a configuration.  One of the following symbols should be defined in every }{\b ncbilcl.}{\i xxx}{. 
\par }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3856\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s61\keep\widctlpar\intbl\adjustright \i\f16\fs18\cgrid {Symbol\cell Description\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \cltxlrtb \cellx3856\clvertalt\clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {IS_BIG_ENDIAN\cell The target platform is "big endian", having the most significant byte in the lowest address.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft1440\trkeep \clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3856\clvertalt\clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx9720\pard\plain \s62\sb40\sa40\keep\widctlpar\intbl\adjustright \f16\fs20\cgrid {IS_LITTLE_ENDIAN\cell The target platform is "little endian", having the most significant byte in the highest address.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc300649175}Function Prototypes{\*\bkmkend _Toc300649175}
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {A mechanism has also been worked out for declaring functions and prototypes such that compilers which can check function prototypes will check them, and those which don't do not see them (prototypes are syntax errors on older compilers !).  The trick is to declare the prototype with the PROTO(()) macro (note the double parentheses).  A similar macro, VPROTO(()), is provided for functions with variable argument lists.
\par }\pard\plain \s58\li1584\ri144\keep\widctlpar\box\brdrs\brdrw15\brsp120 \tx2016\tx2592\tx3168\tx3744\tx4320\tx4896\tx5472\tx6048\tx6624\tx7200\tx7776\adjustright \shading2000\cfpat16\cbpat8 \f2\fs16\cgrid {Int2 StringCmp PROTO((CharPtr str1, CharPtr str2));
\par Int2 Message VPROTO((Int2 key, char *fmt, ...));
\par }\pard\plain \s15\li720\sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par 
\par 
\par 
\par 
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 106}}}{\b0 \tab AsnLib}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 AsnLib\tab }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 107}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {include asnlib.doc}}{\fldrslt {{\*\bkmkstart _Toc294430299}{\*\bkmkstart _Toc294430776}{\*\bkmkstart _Toc300649176}AsnLib: ASN.1 Processing{\*\bkmkend _Toc294430299}{\*\bkmkend _Toc294430776}{\*\bkmkend _Toc300649176}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430300}{\*\bkmkstart _Toc294430777}{\*\bkmkstart _Toc300649177}Introduction to ASN.1{\*\bkmkend _Toc294430300}{\*\bkmkend _Toc294430777}{\*\bkmkend _Toc300649177}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430301}{\*\bkmkstart _Toc294430778}{\*\bkmkstart _Toc300649178}Why ASN.1{\*\bkmkend _Toc294430301}{\*\bkmkend _Toc294430778}{\*\bkmkend _Toc300649178}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Abstract Syntax Notation 1 (ASN.1) is used to describe the structure of data to be transferred between the Application Layer and the Presentation Layer of the Open Systems Interconnection (OSI).  It is meant to provide a mechanism whereby the Presentation Layer can use a single standard encoding to reliably exchange any arbitrary data structure with other computer systems, while the Application layer can map the standard encoding into any type of representation or language that is appropriate for the end user.  ASN.1 does not describe the content, meaning, or structure of the data, only the way in which it is specified and encoded.
\par These properties make it an excellent choice for a standard way of encoding scientific data.  Since ASN.1 does not specify content, specifications can be created as new concepts need to be represented.  Yet since it is an International Standards Organization (ISO) standard, the new specification can take advantage of various tools built to work with ASN.1 in general.  It removes from scientists the role of specifying ad hoc file formats, and focuses them instead on specifying the content and structure of data necessary to convey scientific meaning.
\par There are two aspects to ASN.1, the specification of the data and the encoded data itself.  The specification describes the abstract structure of the data and the allowed values various fields may take.  Frequently today scientific data is presented with no formal specification.  There may be some documentation describing the data file, but very often it is incomplete or not entirely accurate, since it is usually written about the file, rather than as an integral step toward building the file.  The ASN.1 specification is formal language, which means it can be automatically and thoroughly checked for errors and inconsistencies in form by machine before any data are collected at all.  Further, it can be used by a computer to validate that any data presented correctly reflect that specification.  This is essential in eliminating the random errors and oversights in generating data files that plague scientific data now.  A utility program, asntool, was built with the AsnTool libraries to do this sort of checking and validation while developing ASN.1 specifications.
\par The requirement for a separate specification also means that interested parties can examine and evaluate the structure of the data independent of any particular database or data file.  One can understand the limits and strengths of a specification separately from the quality or amount of the data itself. Data structures that prove to be useful can be re-used in a variety of ways; by large public databases, by small private databases, in various software tools, and in assorted data files.
\par Finally, a separate specification means software to construct, decode, and validate any ASN.1 specified object can be built semi- or fully automatically from the specification.  Data encoded according to that specification can then be processed with relatively little manual programming for those aspects of the application dealing directly with ASN.1.  This is what the AsnTool routines are for.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430302}{\*\bkmkstart _Toc294430779}{\*\bkmkstart _Toc300649179}Structure of ASN.1{\*\bkmkend _Toc294430302}{\*\bkmkend _Toc294430779}{\*\bkmkend _Toc300649179}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {ASN.1 has Type References, identifiers, and values.  A Type Reference is the name of an object defined in an ASN.1 specification.  An identifier is a field within an object.  A value is generally not included in the specification, but rather is the value of a Type Reference or an identifier in data encoded in ASN.1.  Values can be encoded in either a text or a binary form.  The examples here will obviously be in the text form.
\par Type References ALWAYS start with an upper case letter.  Identifiers ALWAYS start with a lower case letter.  Values depend on what type of value it is (integer, string, etc.) and examples are given below.  "-" (hyphen) is the ONLY separator character allowed in References and identifiers.
\par ASN.1 allows elements of SET, SEQUENCE, and CHOICE to not have identifiers if they can be distinguished from each other by their type (e.g. one is an integer and one is a string).  However, this can make the text value notation ambiguous and it may also lead to errors in the hands of the novice.  So we REQUIRE that every element of a SET, SEQUENCE, and CHOICE have an identifier.
\par ASN.1 also allows the specification of numerical tags (used for the binary encoding) in [] in addition to or in lieu of identifiers.  Again, this can be a problem for the novice.  Since we require identifiers, our software generates the numerical tags itself and we can ignore this.  It still supports explicitly defined APPLICATION, and PRIVATE tags, but that is beyond the scope of this document.  Comments begin with   --   and end with   --    or end of line.
\par }\pard \sb240\keepn\widctlpar\adjustright {A simple ASN.1 specification module example is shown below:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Demo-module DEFINITIONS ::=\tab \tab -- Module-name DEFINITIONS ::= BEGIN
\par BEGIN
\par 
\par EXPORTS My-type;\tab \tab \tab \tab -- My-type can be used by other modules
\par 
\par IMPORTS Foreign-type FROM Other-module; -- can import types
\par 
\par \tab \tab \tab \tab \tab \tab \tab \tab -- we define an object called My-type
\par My-type ::= SEQUENCE \{\tab \tab \tab -- My-type is a Type Reference
\par \tab first \tab \tab INTEGER ,\tab \tab \tab -- first is an identifier
\par \tab second \tab INTEGER DEFAULT 2 ,\tab \tab -- second defaults to 2
\par \tab third \tab \tab VisibleString OPTIONAL\tab -- third is an optional string
\par \tab \}\tab \tab \tab \tab \tab \tab \tab -- end of object definition
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Another ::= Foreign-type\tab \tab \tab -- can reference other defined types
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {END\tab \tab \tab \tab \tab \tab \tab \tab -- end of module, END required
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {Value notation (or data encoded in the text form of ASN.1) looks like this:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {My-type ::= \{
\par \tab first 42
\par \tab \}
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {This means this My-type will have first = 42, second = 2, and third not present.  To present more than one My-type you must have defined:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par My-type-set ::= SET OF My-type\tab \tab -- in Demo-module
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {  Then you could have:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {My-type-set ::= \{\tab \tab \tab \tab -- start SET OF
\par \tab \{\tab \tab \tab \tab \tab \tab \tab -- a My-type
\par \tab \tab first 42
\par \tab  \} ,
\par \tab \{\tab \tab \tab \tab \tab \tab \tab -- another My-type
\par \tab \tab first 27 ,
\par \tab \tab second 22 ,
\par \tab \tab third "Everything set here"
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \} 
\par \}\tab \tab \tab \tab \tab \tab \tab \tab -- end of SET OF
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {ASN.1 Primitive Types Supported by AsnLib
\par }\trowd \trqc\trgaph72\trleft-84\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1461\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4237\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx6813\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8758\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\fs18 Type,\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b\fs18 Description\cell Specification\cell Value Notation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\trowd \trqc\trgaph72\trleft-84\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1461\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4237\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx6813\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8758\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 BOOLEAN\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 Any TRUE or FALSE value
\par May have a DEFAULT\cell Truth ::= BOOLEAN\cell Truth ::= FALSE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\trowd \trqc\trgaph72\trleft-84\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1461\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4237\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx6813\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8758\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 INTEGER\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 Any integer value.
\par May be given named values but range not limited to names.
\par May have a DEFAULT.\cell Number ::= INTEGER
\par or
\par Number ::= INTEGER \{
\par      red (1) ,
\par      blue (2) \}\cell Number ::= 42
\par or
\par Number ::= red\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 OCTET STRING\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 Any string of bytes.
\par Returned as or read from ByteStorePtr.
\par May not have DEFAULT.\cell Hstring ::= OCTET STRING\cell Hstring ::= '0A01F'H\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 NULL\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 null is only allowed value\cell Nothing ::= NULL\cell Nothing ::= null\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 REAL\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 Floating point number in base 2 or 10.
\par REAL value notation is 3 integers for \{ matissa, base, exponent \}
\par May have a DEFAULT.\cell Pi ::= REAL\cell Pi ::= \{ 314159, 10, -5 \}\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 ENUMERATED\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A named set of integer values.
\par Only named values allowed.
\par May have a DEFAULT\cell Sex ::= ENUMERATED \{
\par      male (1) ,
\par      female (2) \}\cell Sex ::= male\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 SEQUENCE\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A series of other named types, in order.
\par Not related to a biological sequence.
\par All elements must be present unless OPTIONAL or DEFAULT\cell Yuppie ::= SEQUENCE \{
\par      income   INTEGER ,
\par      name     VisibleString \}\cell Yuppie ::= \{
\par      income 100000 ,
\par      name "John Doe" \}\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 SEQUENCE OF\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A repeating series of a single type in order.\cell Stooges ::= 
\par SEQUENCE OF VisibleString\cell Stooges ::= \{
\par      "Larry" ,
\par      "Curly",
\par      "Moe" \}\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 SET\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A series of named other types.
\par Order does not matter.
\par All elements must be present unless OPTIONAL or DEFAULT\cell Yuppie ::= SET \{
\par      income   INTEGER ,
\par      name     VisibleString \}\cell Yuppie ::= \{
\par      income 100000 ,
\par }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18      name "John Doe" \}\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 SET OF\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A repeating series of a single type. Order does not matter.\cell Stooges ::= 
\par SET OF VisibleString\cell Stooges ::= \{
\par      "Larry" ,
\par      "Curly",
\par      "Moe" \}\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 CHOICE\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A way to select one from a set of alternate types.
\par }{\b NOTE}{:  in the value notation you are indicating one choice, so \{\} are not necessary (or allowed) but the identifier for the selected CHOICE must be given before the value.}{\fs18 \cell Person ::= CHOICE \{
\par      social-security INTEGER ,
\par      name VisibleString ,
\par      badge-id INTEGER \}\cell Person ::= name "Joe"\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 VisibleString\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 A string of printable ASCII characters
\par }{\b NOTE}{: The double quite character (") may be included in a VisibleString by doubling it.\line "He said ""Hi Mom!"" to her"\line }{\b NOTE}{: AsnLib can accept wrapped long VisibleStrings.  That is, a string may contain internal newlines which are stripped on input from the value notation.\line  Text ::= "He said ""Hi Mom!"" to her"\line would be read as:\line "He said ""Hi Mom!"" to her"}{\fs18 \cell Text ::= VisibleString\cell Text ::= "Hi Mom!"\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\trowd \trqc\trgaph72\trleft-84\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1461\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4237\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx6813\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8758\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\fs18 StringStore\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\fs18 ONLY in AsnLib. Defines a VisibleString which is read into a ByteStore instead of a CharPtr. Used for long strings like DNA sequences.\cell Dna ::= StringStore\cell Dna ::= "AGGAGG"\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f2\fs16 \row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430303}{\*\bkmkstart _Toc294430780}{\*\bkmkstart _Toc300649180}Further information about ASN.1{\*\bkmkend _Toc294430303}{\*\bkmkend _Toc294430780}{\*\bkmkend _Toc300649180}
\par }\pard\plain \s29\keepn\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard \s29\keepn\widctlpar\adjustright {The Open Book\line A Practical Perspective on OSI\line by Marshall T. Rose\line Prentice Hall, Englewood Cliffs, New Jersey  07632\line (c) 1990
\par 
\par ISO Development Environment  (public software)\line University of Pennsylvania\line Dept. of Computer Science and Information Science\line Moore School\line Attn: David J. Farber (ISODE Distribution)\line 200 South 33rd Street\line Philadelphia, PA  19104-6314\line 1-215-898-8560
\par 
\par OSIkit Tools from NIST  (1989) (public software)\line US Dept. of Commerce\line National Institute of Standards and Technology\line Gaithersburg, MD
\par 
\par Information Processing - Open Systems Interconnection - Specification of Abstract Syntax Notation One (ASN.1).  International Organization for Standardization and International Electrotechnical Committee, 1987. International Standard 8824.
\par 
\par Information Processing - Open Systems Interconnection - Specification of Basic Encoding Rules for Abstract Syntax Notation One (ASN.1).  International Organization for Standardization and International Electrotechnical Committee, 1987.  International Standard 8825.
\par 
\par Information Processing - Open Systems Interconnection - Abstract Syntax Notation One (ASN.1) - Draft Addendum 1:  Extensions to ASN.1.  International Organization for Standardization and International Electrotechnical Committee, 1987.  Draft Addendum 8824/DAD 1.
\par 
\par Information Processing - Open Systems Interconnection - Abstract Syntax Notation One (ASN.1) - Draft Addendum 1:  Extensions to ASN.1 Basic Encoding Rules.  International Organization for Standardization and International Electrotechnical Committee, 1987.  Draft Addendum 8825/DAD 1.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430304}{\*\bkmkstart _Toc294430781}{\*\bkmkstart _Toc300649181}AsnLib: Overview{\*\bkmkend _Toc294430304}{\*\bkmkend _Toc294430781}{\*\bkmkend _Toc300649181}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {AsnLib is a library of functions developed by NCBI for manipulating and exchanging ASN.1 specifications and encoded data for scientific purposes.
\par A number of commercial and public domain tools are available for working with ASN.1 and for automatically building data handlers of various sorts. They are focused on the use for which ASN.1 was originally intended, the exchange of data between layers of the OSI.  As such they tend to automate the process more than AsnLib does, because the domain of use is much more limited.  The fact that they determine the internal data structures to use and write all the code to handle them themselves is not a big problem in this case.
\par When ASN.1 is used for scientific data description though, other uses will be made of the encoded data than may have originally been envisaged by the designers of these products.  For example, a scientist will often want an application which scans through a large complicated data structure, and just extracts certain fields for use, or even just counts occurrences of certain values.  A tool which automatically generates large elaborate data structures and lots of code to parse the stream, generate the structures, and store them in memory is inappropriate for such an application.  Further, a scientific application may well wish to manipulate that data in a different language than the tool is written in, such as FORTRAN, PROLOG, or LISP.  These applications may well wish to store the whole data structure from the stream, but they will not wish to use the data structures provided by the tool.
\par ASN.1 can be used to encode data in two ways, an ASCII human readable form called "value notation" or "print form", and a binary encoding.  ASN.1 has separate standards documents for the syntax (specification rules) and the binary encoding rules (BER, or "Basic Encoding Rules").  This was done on purpose to allow various encoding rules for the same abstract syntax.  The BER is, at this writing, the only official ISO encoding for ASN.1, but several other encodings which are faster or take less space, are under consideration by ISO.  Currently the only binary encoding AsnLib supports is BER.
\par The value notation, or ASCII form of the data is not really an official ISO standard.  It was meant to provide a human readable form of ASN.1 data for development or explication, but not as a standard for data exchange. Nonetheless, value notation rules are given in the ISO documents for all the data types they describe.  With only a few additional rules, value notation is quite robust for data exchange.  These rules are listed in Appendix 1. While we do not recommend the ASCII form of ASN.1 encoded data for large amounts of data, it is very useful for developing and testing data representations or for generating ASN.1 values easily from other data files or local databases without specialized tools.  Since the value notation and binary encoded forms of data are completely and reliably interconvertable using AsnLib, there is no problem doing this.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {\f0 {\*\bkmkstart _Toc294430305}{\*\bkmkstart _Toc294430782}{\*\bkmkstart _Toc300649182}Principles of Operation{\*\bkmkend _Toc294430305}{\*\bkmkend _Toc294430782}{\*\bkmkend _Toc300649182}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {AsnLib operates on atomic elements of ASN.1 specified data.  It is built using the NCBI core software tools and this document assumes you have some acquaintance with them.  AsnLib reads or writes strings, integers, etc. with single function calls.  Composite objects such as a SEQUENCE or a SET are read or written with a series of calls to read or write its component parts.  The process is designed to be relatively intuitive even in this case.  One calls a function to start encoding a SEQUENCE, then calls the routines to encode its parts, then calls a function to end encoding the SEQUENCE. NCBI has built functions to read and write such higher level objects in single function calls (described in the chapters on data), which use the low level AsnLib functions described here.
\par }\pard \sb240\widctlpar\adjustright {One can read and write any type using only three functions.  They take as arguments the identifier of an ASN.1 encoded stream (binary or ASCII), a pointer to a node in a parse tree (generated from the ASN.1 specification), and a pointer to a union which can hold a value of any type.  All aspects of how to encode a value properly, error checking to be sure that all appropriate nodes in the tree are visited in the proper order and that values are valid for a particular type are all taken care of within AsnLib and are not the concern of application programmer.  The application programmers must read and understand the ASN.1 specification to make proper use of it, but all the other details of using ASN.1 correctly are not their concern.
\par The parse tree contains information about the type of every node, its name, it's binary tag, allowed values, default values, and the next valid element. The header file also contains a series of #defines which associate names derived from the ASN.1 specification with pointers to nodes in the parse tree. Thus one's code would refer to JOURNAL_title, not a pointer to a specific node.  Using these defines means that if an ASN.1 specification is changed, but the names and types of nodes an application cares about have not changed, the application can be updated by just compiling with the new header file.
\par There are also functions which allow more interpreter-like code to be written.  One function will load an ASN.1 specification from a file, validate it, and build the appropriate parse tree on the fly, rather than at compile time by including a header file.  One can still identify nodes in the tree by name with a function that searches the tree for nodes with names matching a string.  As with all interpreter/compiler trade offs, such an application is slower, but more flexible.
\par AsnLib assumes that specifications will be written as a collection of smaller modules.  Data types may be declared as IMPORTS or EXPORTS by any module.  Multiple modules which reference each other may be loaded at once into AsnLib or through the interpreter function described above.  It will then link the modules before outputing the header file, thus effectively building a single parse tree containing all the modules.
\par In another approach, one might build a series of functions which handle the datatypes in a particular module.  Then when one writes code which uses a module which IMPORTS another module type, it is left unlinked in that parse tree and one just calls the appropriate function to read it.  AsnLib contains two functions for temporarily linking, then unlinking local parse subtrees to a parent object parse tree for this purpose.  We have begun to build a library of such modular object functions, so one need not link the whole world of possible datatypes into a single routine or module, or write the basic routines to create, destroy, and exchange such sub-objects.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {\f0 {\*\bkmkstart _Toc294430306}{\*\bkmkstart _Toc294430783}{\*\bkmkstart _Toc300649183}Specification for AsnLib{\*\bkmkend _Toc294430306}{\*\bkmkend _Toc294430783}{\*\bkmkend _Toc300649183}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {AsnLib supports the following types from ISO 8824}{\pard\plain \sb240\widctlpar\adjustright \v\f16\fs20\cgrid {\xe {ISO 8824}}}{ and the ASN.1 enhancements.  The internal representation used by AsnLib (from the NCBI core tools) for routines dealing with these types is also shown.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Supported ASN.1 primitive types
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1890\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4793\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b type                                 \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b internal representation\~\~\~\~\~\~\~\~         \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1890\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4793\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {BOOLEAN\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Boolean           \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1890\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4793\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {INTEGER\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Int4\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {OCTET STRING\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {NULL\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {REAL\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {FloatHi\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ENUMERATED\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Int4\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {SEQUENCE\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {SEQUENCE OF\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {SET \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {SET OF\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {CHOICE \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no value\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {VisibleString\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1890\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4793\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {StringStore\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {Other ASN.1 string types are supported as VisibleString.  No checks are made to ensure restrictions of character usage by the various string types. }{\f0 Types not supported by AsnLib at this point (although they will be accepted in a module specification as valid ASN.1) are:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Unsupported ASN.1 primitive types
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx3510\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {BIT STRING\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx3510\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {OBJECT IDENTIFIER\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ObjectDescriptor\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {EXTERNAL\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ANY\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {GeneralizedTime\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx3510\pard\plain \s29\widctlpar\intbl\adjustright \f16\fs20\cgrid {UTCTime\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\keepn\widctlpar\adjustright {The following keywords are currently supported by AsnLib:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Supported ASN.1 keywords
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2250\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {DEFINITIONS\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2250\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {BEGIN\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {END\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {EXPORTS\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {IMPORTS\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FROM\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {APPLICATION\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {PRIVATE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {UNIVERSAL\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {DEFAULT\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {OPTIONAL\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FALSE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2250\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TRUE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {The following ASN.1 keywords are not supported by AsnLib (although they are passed in a module specification as valid ASN.1):
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Unsupported ASN.1 keywords
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {IMPLICIT\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ABSENT\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {BY\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {COMPONENT\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {DEFINED\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {INCLUDES\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {MIN\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {MINUS-INFINITY\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {MAX\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {PRESENT\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {PLUS-INFINITY\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {SIZE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TAGS\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx2430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {WITH\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {AsnLib uses indefinite encoding for output of all binary encoded non\_ primitive types.  It can decode either definite or indefinite binary encoded data for all types.  This conforms to the BER.
\par DEFAULT values may be given in an ASN.1 specification.  AsnLib accepts and records them in the parse tree.  However, it does not supply the value if it is missing from the input stream on the assumption that the application would want to distinguish a value actually supplied from a value defaulted locally. DEFAULT is only supported for simple types like INTEGER or VisibleString, but not for structure types like SEQUENCE because it is too difficult to code.
\par Values may not be assigned in a specification module to types defined in a different module.  Each module is self contained and does not "know" anything about types defined in other modules except their names if they were IMPORTS. So suppose one module defines:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par Dna-strand ::= ENUMERATED \{ plus(1), minus(2) \}
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A different module may not use the DEFAULT in the following case:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid { Dna-sequence ::= SEQUENCE \{
\par \tab length INTEGER ,
\par \tab strand Dna-strand DEFAULT plus \}
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {because it does not know Dna-strand is ENUMERATED or what its allowed values are.  Such a construct is acceptable if the definition of Dna-strand and Dna\_ sequence are in the same module and the Dna-strand definition comes first.
\par Elements of a SEQUENCE are checked that they are all received or sent in the correct order and that no non-OPTIONAL or non-DEFAULT elements are missing.  However, because AsnLib does not store whole structures, it can only check that the types of elements in a SET are correct, but cannot check if more than one element of a type is used or if a required element is missing.  For this reason it is safer to use SEQUENCE rather than SET as a rule when using AsnLib.  While there is a semantic difference, there is no representational limitation in doing this.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430307}{\*\bkmkstart _Toc294430784}{\*\bkmkstart _Toc300649184}AsnTool{\*\bkmkend _Toc294430307}{\*\bkmkend _Toc294430784}{\*\bkmkend _Toc300649184}
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {An application program called "asntool", is built by the NCBI Software Toolkit using the AsnLib function libraries, which in turn are based on the NCBI portable core software tools. This application is a utility program which can:
\par }\pard\plain \s15\li720\sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {1. \tab Read, write, and error check an ASN.1 specification.
\par }\pard \s15\li720\keepn\widctlpar\adjustright {2. \tab Read, write, and check ASCII values conforming to the specification in 1.
\par }\pard \s15\li720\keepn\widctlpar\adjustright {3. \tab Read, write, and check binary values conforming to the specification in 1.
\par }\pard \s15\li720\keepn\widctlpar\adjustright {4. \tab Combinations of 2 and 3 to translate or convert between binary and ASCII
\par }\pard \s15\li720\widctlpar\adjustright {5.\tab Output a C language header file which contains a parse tree for specification 1 which can be used in an application program.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430308}{\*\bkmkstart _Toc294430785}{\*\bkmkstart _Toc300649185}AsnTool Tutorial{\*\bkmkend _Toc294430308}{\*\bkmkend _Toc294430785}{\*\bkmkend _Toc300649185}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It may be quickest to demonstrate the use of AsnLib through example.  In the distribution directory of the NCBI Software Toolkit, \\ncbi, there are two subdirectories. \\demo contains demonstration source code to be used in the section below and 2 samples of MEDLINE entries as ASN.1 value notation (ASCII).  medline.ent is a single Medline-entry and medline.prt is a Pub-set containing many MEDLINE entries. \\asn contains the ASN.1 specifications for the modules used to describe the MEDLINE entries.  They are:
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1440\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3015\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8095\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b File            \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Module                \cell Description                            \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1440\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3015\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8095\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {general.asn\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {NCBI-General}{\pard\plain \s29\keepn\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {NCBI-General}}}{\cell general purpose data types\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1440\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3015\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8095\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {pub.asn\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {NCBI-Pub}{\pard\plain \s29\keepn\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {NCBI-Pub}}}{\cell branch point for various publication types.\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {biblio.asn\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {NCBI-Biblio}{\pard\plain \s29\keepn\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {NCBI-Biblio}}}{\cell standard bibliographic citations for journals, books, manuscripts, patents based on ANSI standard\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {medline.asn\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {NCBI-Medline}{\pard\plain \s29\keepn\widctlpar\intbl\adjustright \v\f16\fs20\cgrid {\xe {NCBI-Medline}}}{\cell MEDLINE entry (based on NCBI-Biblio)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1440\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3015\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8095\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {asnpub.all\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {all\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {all above modules in one file\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {asntool should have been built as part of installing the system.  It is in \\ncbi\\bin.  Set your path, or move asntool to a place it can be executed.
\par From within the \\demo directory, run asntool with no arguments.  It presents its argument usage to you.  Note that you must always give a module file name. asntool takes only one module file, so if you wish to use more than one you must concatenate them into a single file, such as asnpub.all.
\par Try the following exercises -- type:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This will read the publication modules and validate that they are correctly built.  asntool will notify you of various syntax errors and typos, usually giving the line number where the error occurred.  It makes sure that everything EXPORTS from a module is defined in that module and that everything IMPORTS is used by that module.  Everything not IMPORTS must be defined within the module.  In the case of multiple modules, it will try to link EXPORTS from one module with IMPORTS from others.  It is not an error to be unable to link an IMPORTS, but it does imply you expect it to be handled by an outside function.  There are no errors in asnpub.all, so asntool is silent.  The path may have a different form on various machines.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all -v medline.ent
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This does everything above, then reads the file medline.ent which it expects to be of a type defined in asnpub.all.  It checks for errors, reporting any it finds.  There are none, so asntool is silent.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all -v medline.ent -p stdout
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {On command line systems, everything above will happen, except that medline.ent will be encoded from asntool's internal structures to ASN.1 value notation on stdout, your terminal.  On Macintosh or Microsoft Windows, the output will go to a disk file named "stdout".
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all -v medline.prt -e medline.val
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This reads the set of MEDLINE records from medline.prt and encodes them in binary ASN.1 in the file medline.val
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all -d medline.val -t Pub-set -p stdout
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This reads (decodes) the set of MEDLINE records from the binary ASN.1 file we just made and outputs them as value notation on stdout.  Note that we MUST specify the type (Pub-set) of the binary file or message.  That is because the binary form does not have that information.  The value notation form does, so asntool can figure it out, but the binary, which is the real ISO standard, does not.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par asntool -m ..\\asn\\asnpub.all -o allpub.h
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This outputs a header file for an application which will use the asntool routines to encode and decode objects defined in asnpub.all.}{\f0 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430309}{\*\bkmkstart _Toc294430786}{\*\bkmkstart _Toc300649186}Using AsnLib{\*\bkmkend _Toc294430309}{\*\bkmkend _Toc294430786}{\*\bkmkend _Toc300649186}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If you take a look at the allpub.h you generated above, you will see that it includes <asn.h> which defines the interface to the AsnLib library and which includes <ncbi.h> which defines the interface to the NCBI core software tools.
\par Then come the arrays of structures defining the parse tree.  You should never program directly for these structures as they may change without notice. You should always use the functions described below.
\par Last come the #defines for pointers to specific nodes in the parse tree. They are built from the names of objects specified in the ASN.1 modules.  The name of the type itself is upper case, and component parts are in lower case. An example of the mapping between the ASN.1 specification medline.asn and the #defines in allpub.h is shown in Appendix 2.  
\par One less intuitive aspect of this system applies only to SET OF or SEQUENCE OF which are repeating series of the same type.  Since any one element of such a repeating series does not have a name, one must be invented.  This is done by appending a _E (for Element of) to the parent name (e.g.. if Name-list ::= SEQUENCE OF VisibleString, then one name (VisibleString) of that SEQUENCE OF would have a #defined node name of NAME_LIST_E).  Names defined this way are limited to a maximum of 31 characters.  If they grow longer than that, the leftmost characters are truncated.  The suggestion is: keep names as short as you can and still be meaningful.  Also, since "-" is the only valid separator character in ASN.1 but "_" is the only valid separator character in C, the Name-list (mentioned above) node in the parse tree would be defined as NAME_LIST.
\par ASN.1 encoded values are represented basically as identifier/value pairs. AsnLib has two parsing functions that correspond to the members of the pair:
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {\f2 atp = AsnReadId(aip, amp, atp);
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\f2   }{  Reads an identifier from an input stream (aip) and returns a pointer to the appropriate node in the parse tree for it (atp as the return value).  atp will be one of the nodes #defined in the header generated by AsnLib.
\par }\pard\plain \s29\keepn\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {\f2 success = AsnReadVal(aip, atp, avp);
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\f2 \tab }{Reads the value of atp from the stream (aip) into an AsnValue (a union of Pointer, Int4, Boolean, FloatHi).  If AsnReadVal() is called with avp = NULL, it skips over that value.  This is useful for scanning through a file extracting only a few fields.
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {To parse then, one basically just alternates AsnReadId() and AsnReadVal(). The most common error to make in writing a parser that uses these functions is to get out of synchronization alternating between these two routines.
\par There is only one function to write an identifier/value pair at once:
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {\f2 success = AsnWrite(aip, atp, avp);
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\f2 \tab }{Writes the identifier pointed to by atp, and the value in avp, to the stream aip.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430310}{\*\bkmkstart _Toc294430787}{\*\bkmkstart _Toc300649187}AsnLib: A Tutorial{\*\bkmkend _Toc294430310}{\*\bkmkend _Toc294430787}{\*\bkmkend _Toc300649187}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\f0 In \\ncbi\\demo are three small demo applications that process medline entries and require the allpub.h header and the binary form of medline.prt we built in the sections above.  The make files for Microsoft C (makedemo.msc) and for all UNIX systems (makedemo.unx) are in \\make.  Copy the makedemo file appropriate for your system into \\ncbi\\build and make it.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430311}{\*\bkmkstart _Toc294430788}{\*\bkmkstart _Toc300649188}getmesh.c{\*\bkmkend _Toc294430311}{\*\bkmkend _Toc294430788}{\*\bkmkend _Toc300649188}}{\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\v\f16\cgrid {\xe {getmesh.c}}}{\f0 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Function:  Reads a Medline-entry, extracts the MeSH terms, and prints them.
\par }\pard \sb240\widctlpar\adjustright {Type "getmesh -" to see its arguments.
\par Type "getmesh -i medline.ent -o terms.out".  getmesh reads medline.ent, which contains a single Medline-entry in value notation (ASCII).  This file is presented at the end of this chapter, somewhat abbreviated, with the #defined names for the nodes in the allpub.h parse tree that will be encountered in the course of reading this file. getmesh parses it, extracts the MeSH terms and prints them in "terms.out".
\par Look at the source code in getmesh.c.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*****************************************************************************
\par *
\par *   getmesh.c
\par *   \tab gets mesh terms from a Medline-entry
\par *
\par *****************************************************************************/
\par #include <allpub.h>
\par 
\par #define NUMARGS 3
\par Args myargs[NUMARGS] = \{
\par \tab \{ "Input data", NULL, "Medline-entry", NULL, FALSE, 'i', ARG_DATA_IN, 0.0,0,NULL\},
\par \tab \{ "Input data is binary", "F", NULL, NULL, TRUE , 'b', ARG_BOOLEAN, 0.0,0,NULL\},
\par \tab \{ "Output list", NULL, NULL, NULL, FALSE, 'o', ARG_FILE_OUT, 0.0,0,NULL\}\};
\par 
\par Int2 Main()
\par \{
\par \tab AsnIoPtr aip;
\par \tab AsnTypePtr atp;
\par \tab DataVal value;
\par \tab static CharPtr intypes[2] = \{ "r", "rb" \};
\par \tab Int2 intype;
\par \tab FILE *fp;
\par 
\par     if (! AsnLoad())
\par         Message(MSG_FATAL, "Unable to load allpub parse tree.");
\par 
\par     if (! GetArgs("GetMesh 1.0", NUMARGS, myargs))
\par \tab \tab return 1;
\par 
\par \tab if (myargs[1].intvalue)        /* binary input is TRUE */
\par \tab \tab intype = 1;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab else
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab intype = 0;
\par 
\par \tab if ((aip = AsnIoOpen(myargs[0].strvalue, intypes[intype])) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[0].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab if ((fp = FileOpen(myargs[2].strvalue, "w")) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[2].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab atp = MEDLINE_ENTRY;
\par 
\par \tab fprintf(fp, "MeSH terms =\\n\\n");
\par \tab while ((atp = AsnReadId(aip, amp, atp)) != NULL)
\par \tab \{
\par \tab \tab if (atp == MEDLINE_MESH_term)
\par \tab \tab \{
\par \tab \tab \tab AsnReadVal(aip, atp, &value);
\par \tab \tab \tab FilePuts(value.ptrvalue, fp);
\par \tab \tab \tab FilePuts("\\n", fp);
\par \tab \tab \tab AsnKillValue(atp, &value);
\par \tab \tab \}
\par \tab \tab else
\par \tab \tab \tab AsnReadVal(aip, atp, NULL);
\par \tab \}
\par 
\par \tab aip = AsnIoClose(aip);
\par 
\par \tab FileClose(fp);
\par 
\par \tab return 0;
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Pretty short for doing all this, isn't it?  Walking through the code:
\par }\pard\plain \s15\li720\sb120\widctlpar\adjustright \f16\fs20\cgrid {0.\tab AsnLoad() is called to load the ASN.1 parse tree for "allpub" into memory.
\par 1.\tab GetArgs() is called to display or get the command line arguments.
\par 2.\tab The appropriate string is selected for opening a value notation ("r") or a binary ("rb") input stream.
\par 3. \tab The input stream is opened with AsnIoOpen().
\par 4.\tab The file for printed output is opened.
\par 5. \tab atp is initialized to MEDLINE_ENTRY, the defined node we expect the input stream to start with.  If the input stream were ALWAYS value notation, atp could be set to NULL, and Medline-entry ::= would be read from the input file and atp set correctly.  Since getmesh takes binary and value notation, atp must be properly initialized.
\par }\pard \s15\li720\sb120\widctlpar\adjustright {6. \tab The main while loop just reads identifiers with AsnReadId() until it returns NULL, which is EOF.  The argument, amp, is the AsnModulePtr declared in allpub.h.  It is used to locate the appropriate AsnTypePtr (atp) if it was set to NULL on the first call.  After that, atp provides the link to the parse tree.
\par }\pard \s15\li720\sb120\widctlpar\adjustright {7.\tab In the while loop, a check is made to see if atp == MEDLINE_MESH_term, or the VisibleString containing a single MeSH term.  If so, we read the value with AsnReadVal(), print it, then call AsnKillValue() which will deallocate any storage used when any data type is read.  Since a VisibleString requires storage this is necessary.  There is no harm in calling AsnKillValue() even on types that do not allocate storage (e.g.. INTEGER).
\par 8.\tab  If it's not a MeSH term, we call AsnReadVal() with a NULL argument for the AsnValuePtr, which just skips over the value to the next identifier.
\par 9. \tab We close the streams.
\par 10. \tab }{\i c'est tout}{.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430312}{\*\bkmkstart _Toc294430789}{\*\bkmkstart _Toc300649189}indexpub.c{\*\bkmkend _Toc294430312}{\*\bkmkend _Toc294430789}{\*\bkmkend _Toc300649189}}{\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\v\f16\cgrid {\xe {indexpub.c}}}{\f0 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Function: Builds an index to medline.ent base on Medline Unique Identifier.
\par }\pard \sb240\widctlpar\adjustright {Type "indexpub -" to see the arguments.
\par Type "indexpub -imedline.val".  indexpub will read the binary value file, medline.val, note the seek offset of the start of each Medline-entry it contains, identifies the Medline uid for it, and builds an index file, "medline.idx".
\par Take a look at the source code, indexpub.c.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*****************************************************************************
\par *
\par *   indexpub.c
\par *      indexes a Pub-set by Medline UID
\par *
\par *****************************************************************************/
\par #include <allpub.h>
\par 
\par #define NUMARGS 3
\par Args myargs[NUMARGS] = \{
\par \tab \{ "Input data", "medline.val", "Pub-set", NULL, FALSE, 'i', ARG_DATA_IN, 0.0,0,NULL\},
\par \tab \{ "Input data is binary", "T", NULL, NULL, TRUE , 'b', ARG_BOOLEAN, 0.0,0,NULL\},
\par \tab \{ "Output index table", "medline.idx", NULL, NULL, FALSE, 't', ARG_FILE_OUT, 0.0,0,NULL\}\};
\par 
\par 
\par Int2 Main()
\par \{
\par \tab AsnIoPtr aip;
\par \tab AsnTypePtr atp;
\par \tab DataVal value;
\par \tab Int4 seekptr, tempseek, uid;
\par \tab static CharPtr intypes[2] = \{ "r", "rb" \};
\par \tab Int2 intype;
\par \tab FILE *fp;
\par 
\par     if (! AsnLoad())
\par         Message(MSG_FATAL, "Unable to load allpub parse tree.");
\par 
\par \tab if (! GetArgs("IndexPub 1.0", NUMARGS, myargs))
\par \tab \tab return 1;
\par 
\par \tab if (myargs[1].intvalue)        /* binary input is TRUE */
\par \tab \tab intype = 1;
\par \tab else
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab intype = 0;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par \tab if ((aip = AsnIoOpen(myargs[0].strvalue, intypes[intype])) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[0].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab if ((fp = FileOpen(myargs[2].strvalue, "w")) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[2].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab atp = PUB_SET;
\par \tab tempseek = 0L;
\par 
\par \tab while ((atp = AsnReadId(aip, amp, atp)) != NULL)
\par \tab \{
\par \tab \tab if (atp == PUB_SET_medline_E)
\par \tab \tab \tab seekptr = tempseek;
\par \tab \tab if (atp == MEDLINE_ENTRY_uid)
\par \tab \tab \{
\par \tab \tab \tab AsnReadVal(aip, atp, &value);
\par \tab \tab \tab uid = value.intvalue;
\par \tab \tab \tab fprintf(fp, "%ld %ld\\n", uid, seekptr);
\par \tab \tab \}
\par \tab \tab else
\par \tab \tab \tab AsnReadVal(aip, atp, NULL);
\par \tab \tab tempseek = AsnIoTell(aip);
\par \tab \}
\par 
\par \tab aip = AsnIoClose(aip);
\par \tab FileClose(fp);
\par \tab return 0;
\par 
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It is the same basic structure as getmesh.c.  However, the use of the while loop is a little different.  Since we are building an index, we want to record the offset in the file of the identifier which starts each medline entry in the Pub-set (PUB_SET_medline_E \_- a PUB_SET of type medline is a SET OF Medline-entry).  So tempseek is set (to 0 to begin with, then with AsnIoTell()) BEFORE each read of an identifier with AsnReadId().  When the return value is PUB_SET_medline_E we know that tempseek contains the seek offset just before the first identifier for the Medline-entry.  Then we read through the entry looking for the MEDLINE_ENTRY_uid since we want to index on the MEDLINE Unique Identifier. When we find it, we store the seek offset and the uid in the index file.  All other values are skipped.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430313}{\*\bkmkstart _Toc294430790}{\*\bkmkstart _Toc300649190}getpub.c{\*\bkmkend _Toc294430313}{\*\bkmkend _Toc294430790}{\*\bkmkend _Toc300649190}}{\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\v\f16\cgrid {\xe {getpub.c}}}{\f0 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Function: Uses the index created by indexpub.c to retrieve a Medline-entry from medline.val by Medline uid.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*****************************************************************************
\par *
\par *   getpub.c
\par *      does an indexed lookup for medline entries by medline uid
\par *
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#include "allpub.h"
\par 
\par #define NUMARGS 5
\par Args myargs[NUMARGS] = \{
\par \tab \{ "Input binary data", "medline.val", "Pub-set", NULL, FALSE, 'i', ARG_DATA_IN, 0.0,0,NULL\},
\par \tab \{ "Medline UID to find", "88055872", NULL,NULL,FALSE,'u', ARG_INT, 0.0, 0, NULL \},
\par \tab \{ "Input index table", "medline.idx", NULL,NULL,FALSE,'t', ARG_FILE_IN, 0.0,0,NULL \},
\par \tab \{ "Output data", "stdout", "Medline-entry",NULL,FALSE,'o',ARG_DATA_OUT, 0.0,0,NULL\},
\par \tab \{ "Output data is binary", "F", NULL, NULL, FALSE , 'b', ARG_BOOLEAN, 0.0,0,NULL\}\};
\par 
\par 
\par Int2 Main()
\par \{
\par \tab AsnIoPtr aip, aipout;
\par \tab AsnTypePtr atp;
\par \tab DataVal value;
\par \tab Int4 seekptr, uid, uid_to_find;
\par \tab static CharPtr outtypes[2] = \{ "w", "wb" \};
\par \tab Int2 outtype;
\par \tab FILE *fp;
\par \tab Boolean done, first;
\par \tab int retval;
\par 
\par     if (! AsnLoad())
\par         Message(MSG_FATAL, "Unable to load allpub parse tree.");
\par 
\par \tab if (! GetArgs("GetPub 1.0", NUMARGS, myargs))
\par \tab \tab return 1;
\par 
\par \tab if (myargs[4].intvalue)        /* binary output is TRUE */
\par \tab \tab outtype = 1;
\par \tab else
\par \tab \tab outtype = 0;
\par 
\par \tab if ((aip = AsnIoOpen(myargs[0].strvalue, "rb")) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[0].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab if ((aipout = AsnIoOpen(myargs[3].strvalue, outtypes[outtype])) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[3].strvalue);
\par \tab \tab return 1;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \}
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par \tab if ((fp = FileOpen(myargs[2].strvalue, "r")) == NULL)
\par \tab \{
\par \tab \tab Message(MSG_ERROR, "Couldn't open %s", myargs[2].strvalue);
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab uid_to_find = myargs[1].intvalue;
\par \tab done = FALSE;
\par \tab first = TRUE;
\par \tab while (! done)
\par \tab \{
\par \tab \tab retval = fscanf(fp, "%ld %ld", &uid, &seekptr);
\par \tab \tab if (retval == EOF)
\par \tab \tab \{
\par \tab \tab \tab Message(MSG_ERROR, "UID %ld not found", uid_to_find);
\par \tab \tab \tab return 1;
\par \tab \tab \}
\par \tab \tab if (uid == uid_to_find)
\par \tab \tab \tab done = TRUE;
\par \tab \}
\par \tab FileClose(fp);
\par 
\par \tab atp = MEDLINE_ENTRY;
\par \tab AsnIoSeek(aip, seekptr);
\par \tab done = FALSE;
\par \tab while (! done)
\par \tab \{
\par \tab \tab atp = AsnReadId(aip, amp, atp);
\par \tab \tab AsnReadVal(aip, atp, &value);
\par \tab \tab AsnWrite(aipout, atp, &value);
\par \tab \tab AsnKillValue(atp, &value);
\par 
\par \tab \tab if (! first)
\par \tab \tab \{
\par \tab \tab \tab if (atp == MEDLINE_ENTRY)
\par \tab \tab \tab \tab done = TRUE;
\par \tab \tab \}
\par \tab \tab else
\par \tab \tab \tab first = FALSE;
\par \tab \}
\par 
\par \tab AsnIoClose(aip);
\par \tab AsnIoClose(aipout);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab return 0;
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is a very simple program.  It looks up the seek offset into the file by uid, and seeks to that point with AsnIoSeek().  It then just cycles through the process of reading an identifier then reading a value from medline.val using AsnReadId() and AsnReadVal().  It then writes them both to the output file with AsnWrite().  Any storage used is freed with AsnKillValue(). Depending on the way the output AsnIo stream is opened, ASCII or binary, the program can deliver a binary Medline-entry or an ASCII conversion of it.
\par One important point to note is that the way the while loop knows when it has finished reading a MEDLINE_ENTRY.  Since it is a SEQUENCE which is basically a structure with component parts, AsnReadId() returns atp == MEDLINE_ENTRY twice.  Once when it reads the start of the structure, and once when it reads the end.  If you imagine the MEDLINE_ENTRY being bounded by braces \{\} as in the value notation the process is this:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {MEDLINE_ENTRY ::= \{ AsnReadId() gets MEDLINE_ENTRY, AsnReadVal() gets \{
\par     one ,                    \tab \{ read the internal components )
\par     two 
\par    \}                AsnReadId() gets MEDLINE_ENTRY, AsnReadVal() gets \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {To produce the same effect on output, there are two extra output functions for AsnLib, in addition to AsnWrite().
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {AsnOpenStruct(aip, atp, ptr)
\par \tab Writes the first instance of atp on the output stream aip at the beginning of a structure (SEQUENCE, SET, SEQUENCE OF, SET OF).
\par }\pard\plain \s29\keepn\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {AsnCloseStruct(aip, atp, ptr)
\par \tab Writes the second, closing instance.
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The "ptr" argument is a pointer to the internal C structure representing the ASN.1 structure. It is used by functions that piggyback on the AsnWrite functions to explore the internal objects (discussed below).
\par }\pard \sb240\keepn\widctlpar\adjustright {For this reason a similar function is provided to write a CHOICE.
\par }\pard\plain \s28\li1440\ri1440\keep\keepn\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {AsnWriteChoice(aip, atp, choice, value)
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\tab Writes a choice of types. The choice argument is an integer to indicate which type will be written at the next AsnWrite(), and value is a DataVal in which can be passed the internal C structure used to represent the choice.
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid { In the case of getpub.c, it is not necessary to call these functions because getpub is simply reading the data from an ASN.1 stream then writing it again in order, which includes the two instances of MEDLINE_ENTRY.
\par Another point about this program is that we recognized the Medline entries in the Pub-set in indexpub.c by looking for PUB_SET_medline_E, but we are reading and writing the same entry in getpub.c using MEDLINE_ENTRY.  That is because a Pub-set of CHOICE medline is defined as a SET OF Medline-entry.  So when reading the whole Pub-set, each Medline-entry is a PUB_SET_medline_E. But when reading one entry it is a MEDLINE_ENTRY.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430314}{\*\bkmkstart _Toc294430791}{\*\bkmkstart _Toc300649191}Data-links{\*\bkmkend _Toc294430314}{\*\bkmkend _Toc294430791}{\*\bkmkend _Toc300649191}}{\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\v\f16\fs28\cgrid {\xe {Data-links}}}{
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Data-links are described in the NCBI Core Tools document.  They are meant to be "ports" in and out of software applications which perform exchange of structured data (in ASN.1).  The inputs and outputs for getpub.c and getmesh.c are actually Data-links.  If you simply type the command:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par getpub -u 88055872 -b -o stdout | getmesh -i stdin -b -o terms.out
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {you have executed a pair of programs which communicate over a Data-link with structured, binary encoded ASN.1.  getpub extracts a Medline-entry with uid = 88055872 from a binary encoded Pub-set by indexed look-up, transfers it out stdout as a Medline-entry in binary, to getmesh which parses the "message" and locates MeSH terms, and prints them to test.out.
\par This example is just a pipe between two programs, with the enhancement that the stream is binary coded ASN.1, which permits a very much richer "vocabulary" for the exchange than is usual for traditional pipes.  Further, since binary coded ASN.1 is a machine independent coding, the exchange could just as easily been between two completely different machines over a network. Finally, this pipe is a single channel of exchange.  The principles hold if one expands the system to many channels, by a variety of means.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430315}{\*\bkmkstart _Toc294430792}{\*\bkmkstart _Toc300649192}AsnLib Generated Header Files{\*\bkmkend _Toc294430315}{\*\bkmkend _Toc294430792}{\*\bkmkend _Toc300649192}
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {Correspondence between ASN.1 and header #defines
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Medline-entry ::= SEQUENCE \{\tab \tab \tab MEDLINE_ENTRY
\par \tab uid INTEGER ,\tab \tab \tab \tab \tab \tab MEDLINE_ENTRY_uid
\par \tab em Date ,\tab \tab \tab \tab \tab \tab \tab MEDLINE_ENTRY_em
\par \tab cit Cit-art ,\tab \tab \tab \tab \tab \tab MEDLINE_ENTRY_cit
\par \tab abstract VisibleString OPTIONAL ,\tab \tab \tab MEDLINE_ENTRY_abstract
\par \tab mesh SET OF Medline-mesh OPTIONAL ,\tab \tab \tab MEDLINE_ENTRY_mesh
\par \tab substance SET OF Medline-rn OPTIONAL ,\tab \tab MEDLINE_ENTRY_substance
\par \tab xref SET OF Medline-si OPTIONAL ,\tab \tab \tab MEDLINE_ENTRY_xref
\par \tab idnum SET OF VisibleString OPTIONAL \}\tab \tab MEDLINE_ENTRY_idnum
\par 
\par Medline-mesh ::= SEQUENCE \{\tab \tab \tab MEDLINE_MESH
\par \tab mp BOOLEAN DEFAULT FALSE ,\tab \tab \tab \tab MEDLINE_MESH_mp
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab term VisibleString ,\tab \tab \tab \tab \tab MEDLINE_MESH_term
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab qual SET OF Medline-qual OPTIONAL \}\tab \tab \tab MEDLINE_MESH_qual
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430316}{\*\bkmkstart _Toc294430793}{\*\bkmkstart _Toc300649193}Returns From AsnLib Parsing{\*\bkmkend _Toc294430316}{\*\bkmkend _Toc294430793}{\*\bkmkend _Toc300649193}
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {Medline-entry with header #defines as returned when parsing with AsnLib
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Medline-entry ::= \{                    /MEDLINE_ENTRY
\par   uid 88055872 ,                      |   MEDLINE_ENTRY_uid
\par   em                                  |   MEDLINE_ENTRY_em
\par     std \{                             |    /DATE_std
\par       year 1988 ,                     |   |   DATE_STD_year
\par       month 3                         |   |   DATE_STD_month
\par     \} ,                               |    \\DATE_std
\par   cit \{                               |  /MEDLINE_ENTRY_cit
\par     title \{                           | |  /CIT_ART_title
\par       name "Developmental .. protein."| | |   TITLE_name
\par     \} ,\tab                              | |  \\CIT_ART_title
\par     authors \{                         | |  /CIT_ART_authors
\par       names                           | | |  AUTH_LIST_names
\par         ml \{                          | | |   /AUTH_LIST_names_ml
\par           "Giebel LB" ,               | | |  |   AUTH_LIST_names_ml_E
\par           "Dworniczak BP" ,           | | |  |   AUTH_LIST_names_ml_E
\par           "Bautz EK"                  | | |  |   AUTH_LIST_names_ml_E
\par         \} ,                           | | |   \\AUTH_LIST_names_ml
\par       affil                           | | |    AUTH_LIST_affil
\par         str "Zentrum ... Germany"     | | |      AFFIL_str
\par     \} ,                               | |  \\CIT_ART_authors
\par     from                              | |   CIT_ART_from
\par       journal \{                       | |    /CIT_ART_from_journal
\par         title \{                       | |   |  /CIT_JOUR_title
\par           ml-jta "Dev Biol"           | |   | |   TITLE_ml_jta
\par         \} ,                           | |   |  \\CIT_JOUR_title
\par         imp \{                         | |   |  /CIT_JOUR_imp
\par           date                        | |   | |   IMPRINT_date
\par             std \{                     | |   | |    /DATE_std
\par               year 1988 ,             | |   | |   |   DATE_STD_year
\par               month 1                 | |   | |   |   DATE_STD_month
\par             \} ,                       | |   | |    \\DATE_std
\par           volume "125" ,              | |   | |   IMPRINT_volume
\par           issue "1" ,                 | |   | |   IMPRINT_issue
\par           pages "200-7"               | |   | |   IMPRINT_pages
\par         \}                             | |   |  \\CIT_JOUR_imp
\par       \}                               | |    \\CIT_ART_from_journal
\par   \},                                  |  \\MEDLINE_ENTRY_cit
\par   abstract "Multiple ... protein." ,  |   MEDLINE_ENTRY_abstract
\par   mesh \{                              |  /MEDLINE_ENTRY_mesh
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    \{                                 | |  /MEDLINE_ENTRY_mesh_E
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {      term "Amino Acid Sequence"      | | |   MEDLINE_MESH_term
\par     \} ,                               | |  \\MEDLINE_ENTRY_mesh_E
\par     \{\tab                                 | |  /MEDLINE_ENTRY_mesh_E
\par       term "Clathrin" ,               | | |   MEDLINE_MESH_term
\par       qual \{                          | | |  /MEDLINE_MESH_qual
\par         \{                             | | | |  /MEDLINE_QUAL
\par           subh "metabolism"           | | | | |   MEDLINE_QUAL_subh
\par         \}                             | | | |  \\MEDLINE_QUAL
\par       \}                               | | |  \\MEDLINE_MESH_qual
\par     \} ,                               | |  \\MEDLINE_ENTRY_mesh_E
\par     \{                                 | |  /MEDLINE_ENTRY_mesh_E
\par       term "Heat-Shock Proteins" ,    | | |   MEDLINE_MESH_term
\par       qual \{                          | | |  /MEDLINE_MESH_qual
\par         \{                             | | | |  /MEDLINE_QUAL
\par           mp TRUE ,                   | | | | |   MEDLINE_QUAL_mp
\par           subh "genetics"             | | | | |   MEDLINE_QUAL_subh
\par         \}                             | | | |  \\MEDLINE_QUAL
\par       \}                               | | |  \\MEDLINE_MESH_qual
\par     \}                                 | |  \\MEDLINE_ENTRY_mesh_E
\par   \} ,                                 |  \\MEDLINE_ENTRY_mesh
\par   substance \{                         |  /MEDLINE_ENTRY_substance
\par     \{                                 | |  /MEDLINE_substance_E
\par       type cas ,                      | | |   MEDLINE_RN_type
\par       cit "9007-49-2" ,               | | |   MEDLINE_RN_cit
\par       name "DNA"                      | | |   MEDLINE_RN_name
\par     \}                                 | |  \\MEDLINE_substance_E
\par   \} ,                                 |  \\MEDLINE_ENTRY_substance
\par   xref \{                              |  /MEDLINE_ENTRY_xref
\par     \{                                 | |  /MEDLINE_ENTRY_xref_E
\par       type genbank ,                  | | |   MEDLINE_SI_type
\par       cit "M19141"                    | | |   MEDLINE_SI_cit
\par     \}                                 | |  \\MEDLINE_ENTRY_xref_E
\par   \}                                   |  \\MEDLINE_ENTRY_xref
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\}                                      \\MEDLINE_ENTRY
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430317}{\*\bkmkstart _Toc294430794}{\*\bkmkstart _Toc300649194}Finding AsnTypePtrs at Run-time{\*\bkmkend _Toc294430317}{\*\bkmkend _Toc294430794}{\*\bkmkend _Toc300649194}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The #defines described above are statically defined in a header file. But sometimes one must find the parse tree nodes (asntypes) from a module which does not include the parse tree itself. If all parse trees have been loaded using the AsnLoad() functions in the modules that include the parse trees, then they are globally accessible by name through a number of functions. AsnFind() takes a string with the name of an ASN.1 specified entity or a partial path (sub-entities separated by dots) to the entity and returns a pointer to its type node. For example,
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {AsnTypePtr atp;
\par 
\par \tab atp = AsnFind("Seq\_entry.location");
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {will return the same pointer #defined as SEQ_ENTRY_location in the parse tree header file.
\par Other functions will return information about types at run-time. Using the atp obtained above for Seq-entry.location, which is a "Seq-loc", which is itself defined as the primitive type CHOICE:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {CharPtr str;
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab str = AsnFindPrimName(atp);    /* returns "CHOICE" */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab str = AsnFindBaseName(atp);    /* returns "Seq-loc"  */
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {For an ENUMERATED type one can get the values at run-time. For the ASN.1 specification:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Sex ::= ENUMERATED \{
\par \tab male (1) ,
\par \tab female (2) \};
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {the following code can be used:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {AsnTypePtr atp;
\par CharPtr str;
\par 
\par \tab atp = AsnFind("Sex");
\par \tab str = AsnEnumTypeStr(atp, 2);     /* returns "female" */
\par \tab str = AsnEnumStr("Sex", 2);       /* also returns "female" */
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430318}{\*\bkmkstart _Toc294430795}{\*\bkmkstart _Toc300649195}Custom Read and Write Functions{\*\bkmkend _Toc294430318}{\*\bkmkend _Toc294430795}{\*\bkmkend _Toc300649195}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The AsnLib read and write functions can be replaced to provide custom I/O using the AsnIoNew() function. This is how the NCBI network client/servers are implemented, by replacing the read and write functions with socket based routines. We have also used it to write blocks of ASN.1 in memory buffers for transfer in and out of databases. This is not normally something done by a novice, but several functions which read and write to memory are given in the toolkit as models of how to do this sort of thing.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {   /*** read and write to memory buffer ***/
\par extern AsnIoMemPtr AsnIoMemOpen PROTO((CharPtr mode, BytePtr buf, Uint2 size));
\par extern AsnIoMemPtr AsnIoMemClose PROTO((AsnIoMemPtr aimp));
\par extern Boolean AsnIoMemReset PROTO((AsnIoMemPtr aimp, Uint2 bytes_to_read));
\par extern Int2 AsnIoMemRead PROTO((Pointer, CharPtr, Uint2));
\par extern Int2 AsnIoMemWrite PROTO((Pointer, CharPtr, Uint2));
\par 
\par    /*** read and write to a ByteStore in memory ***/
\par extern AsnIoBSPtr AsnIoBSOpen PROTO((CharPtr mode, ByteStorePtr bsp));
\par extern AsnIoBSPtr AsnIoBSClose PROTO((AsnIoBSPtr aibp));
\par extern Int2 AsnIoBSRead PROTO((Pointer, CharPtr, Uint2));
\par extern Int2 AsnIoBSWrite PROTO((Pointer, CharPtr, Uint2));
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430319}{\*\bkmkstart _Toc294430796}{\*\bkmkstart _Toc300649196}Customizing an AsnIo Stream{\*\bkmkend _Toc294430319}{\*\bkmkend _Toc294430796}{\*\bkmkend _Toc300649196}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Sometimes one wishes to change the details of a series of functions at run-time. This can be accomplished by attaching AsnOption structures to the stream. These form a linked list of structures which carry user defined data and are identified by user defined class and type values. A series of functions allow the options to be added, removed, or located on a stream pointer. These are used to customize the behavior of the object loaders (see below) under different run-time conditions, but have many other uses as well. AsnOptions are not the same as AsnExpOptStructs, or exploration structures used by the generalized iterator described below.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430320}{\*\bkmkstart _Toc294430797}{\*\bkmkstart _Toc300649197}ASN.1 Object Loaders{\*\bkmkend _Toc294430320}{\*\bkmkend _Toc294430797}{\*\bkmkend _Toc300649197}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {About the only time it is efficient to read the lower level ASN.1 raw values is when there are just a few types of simple values that one is interested in processing.  For example, if one wanted to record the relative  occurrence  of journal titles in some particular ASN.1 file, one could find those without worrying about the objects.  However, most of the time it is much more convenient to load all or a portion of the ASN.1 information into C code structured objects.  
\par }\pard \sb240\widctlpar\tx11790\adjustright {In general, when the ASN.1 stream is positioned at the beginning of a structure, one can call the <OBJECT>AsnRead function (replacing "<OBJECT>" with some object name) which returns a pointer of the <OBJECT>'s type to an allocated structure.  This structure can then be processed within the C code.  To use these objects, it is convenient to know both the ASN.1 definitions and the C structures, as well as any special function names which operate on them.  For this reason, these different kinds of format descriptions (ASN.1 definitions, C structure definitions, and function prototypes) all appear together, alphabetized by C code object type (if it exists, else using the ASN.1 definition) following this section.  For most objects, there are <OBJECT>New() functions which allocate memory and set any default values, <OBJECT>Free() functions, which release the memory, <OBJECT>AsnRead() and <OBJECT>AsnWrite functions for communication with the ASN.1 I/O stream.  These are true objects in that the upper level objects inherit the slots and "knowledge" about the lower level objects, so that when, for example, an <OBJECT>Free() routine is called which is composed of (recursively) other sub-objects, their <SUB-OBJECT>Free() functions are used as needed. The same type of behavior is exhibited on the <OBJECT>AsnRead() and <OBJECT>AsnWrite() functions since they called the appropriate <SUB-OBJECT>AsnRead() and <SUB_OBJECT>AsnWrite() functions as needed.
\par }\pard \sb240\widctlpar\adjustright {The <OBJECT>New() functions take no parameters, and return an <OBJECT>Ptr.  The <OBJECT>Free() functions take an <OBJECT>Ptr parameter, pointing to the object that is to be returned to the heap, and return a NULL pointer of the same type.  The <OBJECT>AsnRead() functions take a pointer to an AsnIo stream (not a FILE *) that was opened with AsnIoOpen() and an AsnTypePtr which points within the parse tree to the type of the Id whose value follows.   An example of what is meant by this follows:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par if ( -- expect seqentry only ---)\{
\par \tab atp = SEQ_ENTRY;
\par \tab while ((atp = AsnReadId(AsnFp, my_amp, atp)) != NULL) \{
\par \tab \tab the_set = SeqEntryAsnRead(AsnFp, atp);
\par \tab \tab /*--process the SeqEntry --*/
\par \tab \tab SeqEntryFree(the_set);
\par \tab \}
\par \} else \{
\par \tab /*---Expect a BioseqSet----*/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab atp = BIOSEQ_SET;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab while ((atp = AsnReadId(AsnFp, my_amp, atp)) != NULL) \{
\par \tab \tab if (atp == BIOSEQ_SET_seq_set_E) \{
\par \tab \tab \tab /*------------
\par \tab \tab \tab * The "..._E" is the type of the element of the
\par \tab \tab \tab * seq-set.  Generally, when there  are repeating elements
\par \tab \tab \tab * of the same type, the "_E" type holds a place in the parse tree.
\par \tab \tab \tab *--------------*/
\par \tab \tab \tab the_set = SeqEntryAsnRead(AsnFp, atp);
\par 
\par \tab \tab \tab /*--process the SeqEntry --*/
\par \tab \tab \tab SeqEntryFree(the_set);
\par \tab \tab \} else \{
\par \tab \tab \tab AsnReadVal(AsnFp,atp, &value);
\par \tab \tab \}
\par \tab \}
\par \}
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An <OBJECT>Ptr (or NULL on some error conditions) is returned.  The <OBJECT>AsnWrite() functions take the same parameters as the <OBJECT>AsnRead() functions, with the addition of an <OBJECT>Ptr to the object to be added to the ASN.1 stream.  The return is a Boolean (TRUE on success, FALSE on failure).
\par In many cases, these standard functions are all that are needed. In some special cases additional functions for comparing, duplicating, or displaying objects are provided as well. The object loaders are discussed in the following chapters which describe the NCBI data objects themselves. Finally there are chapters on utility functions which perform more complex operations on these objects.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430321}{\*\bkmkstart _Toc294430798}{\*\bkmkstart _Toc300649198}AsnLib and Object Loaders As a Generalized Iterator{\*\bkmkend _Toc294430321}{\*\bkmkend _Toc294430798}{\*\bkmkend _Toc300649198}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The ability to scan a stream of data and identify and extract data items in a very general way just using their names as defined in their ASN.1 specification is a very powful aspect of AsnLib functionality. Since the object loader xxxAsnWrite() functions must exhaustively traverse the internal C structures to write them out, and must "know" both the ASN.1 specified type of every structure and field, one can use these functions to create a generalized iterator for the object loader structures in memory.
\par One can create a "null" output AsnIoPtr (although this will work on a real AsnWrite as well) by using:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {AsnIoPtr aip;
\par 
\par \tab aip = AsnIoNullOpen();
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {One can then associate a data type from the ASN.1 specification or a partial path in the ASN.1 specification where each element is sparated by dots. "Seq-loc" is the Seq-loc object no matter what it's context. "Seq-feat.location" is a Seq-loc ONLY in the "location" slot of a Seq-feat. The Seq-feat itself can be in any context, since that is the top of the partial path. Whenever the object loader AsnWrite routine encounters a data item that satisfys the partial path, it can be made to call a user supplied callback funtion with arguments of a user defined data object and the data object that would be written. An AsnIoPtr can have as many of these options as desired. More than one callback can be associated with the same data type. More than one datatype can be associated with the same callback. Explore options are associate with a stream like this program which counts the features in a SeqEntry.:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\tab typedef struct mydata \{
\par \tab \tab Int2 counter;
\par \tab \} Mydata, PNTR MydataPtr;
\par 
\par /*** counts features in a SeqEntry ***/
\par Int2 countfeats(SeqEntryPtr sep)
\par \tab MydataPtr localptr;
\par \tab AsnIoPtr aip;
\par \tab Int2 num;
\par 
\par \tab localptr = (MydataPtr)MemNew(sizeof(Mydata));
\par \tab localptr->counter = 0;
\par \tab aip = AsnIoNullOpen();
\par \tab AsnExpOptNew(aip, "Seq-feat", (Pointer)localptr, mycallback);
\par \tab SeqEntryAsnWrite(sep, aip, NULL);   /* object loader write */
\par \tab num = localptr->counter;
\par \tab MemFree(localptr);
\par \tab AsnIoClose(aip);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab return num;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\}
\par 
\par void mycallback (AsnExpOptStructPtr aeosp)
\par \{
\par \tab SeqFeatPtr sfp;
\par \tab MydataPtr mdp;
\par 
\par \tab /*** this will be called at both the beginning and end of writing */
\par     /**  a structure. Be sure we only act once (at the beginning) */
\par 
\par \tab if (aeosp->dvp->intvalue != START_STRUCT) return;
\par 
\par     /** get the SeqFeatPtr ***/
\par     /** this step is unnecessary in this application.. it's just here */
\par \tab  /** to show where to get it */
\par 
\par \tab sfp = (SeqFeatPtr) aeosp->the_struct;
\par 
\par \tab /** get the user supplied data **/
\par 
\par \tab mdp = (MydataPtr) aeosp->data;
\par 
\par \tab /*** do the job of counting ****/
\par 
\par \tab mdp->counter++;
\par 
\par \tab /*** that's it *****/
\par 
\par \tab return;
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The AsnExpOptStruct, aeosp, is not the same as an AsnOption, described earlier. The aeosp\_>dvp is the DataValPtr which would normally be written out on the AsnWrite(). For primitive types it contains the integer, boolean, real number, CharPtr or ByteStorePtr for the data. For structures like SEQUENCE, SET, etc, it contains the value START_STRUCT or END_STRUCT, and the pointer to the C structure will be in aeosp->the_struct, as above. When the same callback is used for different data types, the data type can be found in aeosp->atp for all types. When writing a CHOICE, a key for the CHOICE is found in aeosp->the_choice, and a value appropriate to the CHOICE is found in aeosp->dvp.  What is delivered for a CHOICE type can be problematic, since for a CHOICE itself, nothing but a type is normally written, so it is a judgment call what to supply in dvp. For these types, one should look at the object loader .c file to be certain what will be passed.
\par Note that for this iterator to work for structures and choices, AsnOpenStruct(), AsnCloseStruct(), and AsnWriteChoice() must be used in the object loaders.
\par When the stream is closed, the ExpOpt structures are also freed. If a stream is to be reused then an AsnExpOptFree() function is provided to strip ExpOpts off the stream pointer.
\par The generalized iterator shown here can be used to treat the object loader structures as a random access database with named keys in memory. It is extremely powerful and flexible. It's main drawback is that it must travers the whole structure to find the fields of interest. Since this is normally very fast anyway, this is not a major problem at the moment, although for very large objects it may be.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430322}{\*\bkmkstart _Toc294430799}{\*\bkmkstart _Toc300649199}AsnLib and Object Loaders Provide a Generalized Copy and Compare{\*\bkmkend _Toc294430322}{\*\bkmkend _Toc294430799}{\*\bkmkend _Toc300649199}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Any data of arbitrary complexity can be easily copied or compared using the object loaders. Basically the object loader read and write functions, and a pointer to the object to be copied are passed to a function. The functions are then used first to write the struct as ASN.1, to a file or in memory, then are used to read it back into a new structure, then return a pointer to the new structure. The compare is done the same way, except one copy is written, then the other is written and, as part of the second write, compared to the first write (only one copy ever actually exists as an ASN.1 stream). This is a byte by byte compare, so the objects must be completely identical to return TRUE.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {extern Pointer AsnIoCopy PROTO((Pointer from, AsnReadFunc readfunc,
\par \tab \tab \tab \tab \tab \tab \tab \tab \tab \tab AsnWriteFunc writefunc);
\par 
\par extern Pointer AsnIoMemCopy PROTO((Pointer from, AsnReadFunc readfunc,
\par \tab \tab \tab \tab \tab \tab \tab  \tab \tab \tab AsnWriteFunc writefunc));
\par 
\par extern Boolean AsnIoMemComp PROTO((Pointer a, Pointer b,
\par \tab \tab \tab \tab \tab \tab \tab \tab \tab \tab  AsnWriteFunc writefunc));
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430323}{\*\bkmkstart _Toc294430800}{\*\bkmkstart _Toc300649200}AsnLib Interface: asn.h{\*\bkmkend _Toc294430323}{\*\bkmkend _Toc294430800}{\*\bkmkend _Toc300649200}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/* asn.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name: asn.h
\par *
\par * Author:  James Ostell
\par *
\par * Version Creation Date: 1/1/91
\par *
\par * $Revision: 2.2 $
\par *
\par * File Description:
\par *   This header the interface to all the routines in the ASN.1 libraries
\par *     that an application should ever use.  It also includes the necessary
\par *     typedefs -- however the application programmer is not meant to use
\par *     the internal structures directly outside of the specified functions,
\par *     as the internal structures may be changed without notice.
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date     Name        Description of modification
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* -------  ----------  -----------------------------------------------------
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _ASNTOOL_
\par #define _ASNTOOL_
\par                       /*** depends on NCBI core routines ***/
\par #ifndef _NCBI_
\par #include <ncbi.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par    /**** ValNode is used for internal representation of values from
\par \tab ****  CHOICE, SET OF, SEQ OF and combinations for many cases.
\par \tab ****  it is provided in ncbimisc for build object routines ****/
\par 
\par /***  The following defines can be used for backward compatibility
\par #define AsnValue DataVal
\par #define AsnNode ValNode
\par ***/
\par /***  In addition, AsnValueNode was changed to AsnValxNode so it would
\par       not conflict with the AsnValue define above
\par ****/
\par 
\par #ifndef START_STRUCT
\par #define START_STRUCT \tab 411\tab \tab /* \{ found */
\par #define END_STRUCT \tab \tab 412\tab \tab /* \} found */
\par #endif
\par 
\par typedef struct asnvaluenode \{
\par \tab Int2 valueisa;
\par \tab CharPtr name;\tab \tab /* use for strings and named int */
\par \tab Int4 intvalue;\tab \tab     /* use for int and boolean */
\par \tab FloatHi realvalue;
\par \tab struct asnvaluenode PNTR next;
\par \}\tab AsnValxNode, PNTR AsnValxNodePtr;
\par 
\par    /******** AsnType is a node in the AsnTool parse tree *******/
\par 
\par typedef struct asntype \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab Int2 isa;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab CharPtr name;
\par \tab Uint1 tagclass;
\par \tab Int2 tagnumber;
\par \tab Boolean implicit;
\par \tab Boolean optional;
\par \tab Boolean hasdefault;
\par \tab Boolean exported;
\par \tab Boolean imported;
\par \tab Boolean resolved;
\par \tab AsnValxNodePtr defaultvalue;\tab \tab  /* used for default value, range, subtypes */
\par \tab struct asntype PNTR type;
\par \tab Pointer branch;\tab \tab \tab \tab  /* used for named ints, enum, set, sequence */
\par \tab Int2 tmp;     /* for temporary ->type link to local tree */
\par \tab struct asntype PNTR next;
\par \}\tab AsnType, PNTR AsnTypePtr;
\par 
\par typedef struct asnmodule \{
\par \tab CharPtr modulename;
\par \tab CharPtr filename;           /* if module to be loaded from disk */
\par \tab AsnTypePtr types;
\par \tab AsnTypePtr values;
\par \tab struct asnmodule PNTR next;    /* for chain of modules */
\par \tab Int2 lasttype;          /* for isa defined types */
\par \tab Int2 lastvalue; \tab \tab /* for isa defined values */
\par \}\tab AsnModule, PNTR AsnModulePtr;
\par 
\par #define ASNIO_BUFSIZE\tab 1024    /* default size of AsnIo.buf */
\par                                 /* AsnIo.type  bit[0] = text? bit[1]=binary?*/
\par                                 /* bit[2]=input? bit[3]=output?           */
\par #define ASNIO_TEXT  1
\par #define ASNIO_BIN   2
\par #define ASNIO_IN    4
\par #define ASNIO_OUT   8
\par #define ASNIO_FILE  16
\par #define ASNIO_CARRIER   32     /* is a pure iterator */
\par 
\par #define ASNIO_TEXT_IN\tab 21     /* AsnIo.type */
\par #define ASNIO_TEXT_OUT\tab 25
\par #define ASNIO_BIN_IN\tab 22
\par #define ASNIO_BIN_OUT\tab 26
\par 
\par typedef struct pstack \{
\par     AsnTypePtr type;           /* type at this level of stack */
\par     Int4 len;                  /* length of item for binary decode */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    Boolean resolved;          /* resolution of type for binary decode */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab Boolean tag_indef;                /* indefinate tag length on input? */
\par \} Pstack, PNTR PstackPtr;
\par 
\par typedef void (* AsnOptFreeFunc) PROTO ((Pointer));
\par 
\par typedef struct asnopt \{
\par \tab Int2 ao_class;               /* class of option. all negative numbers res.*/
\par \tab Int2 type;                /* type within ao_class */
\par \tab DataVal data;            /* data used for setting option */
\par \tab AsnOptFreeFunc freefunc;  /* function to free data.ptrvalue */
\par \tab struct asnopt PNTR next;
\par \} AsnOption, PNTR AsnOptionPtr;
\par 
\par typedef struct asnexpoptstruct \{
\par \tab struct asnio PNTR aip;
\par \tab AsnTypePtr atp;
\par \tab DataValPtr dvp;
\par \tab Int2 the_choice;
\par \tab Pointer the_struct;
\par \tab Pointer data;
\par \} AsnExpOptStruct, PNTR AsnExpOptStructPtr;
\par 
\par typedef void (* AsnExpOptFunc) PROTO ((AsnExpOptStructPtr));
\par #define NO_CHOICE_SET INT2_MIN     /* for AsnExpOptStruct.the_choice  */
\par 
\par typedef struct expopt \{
\par \tab Int2 numtypes;
\par \tab AsnTypePtr PNTR types;             /* the type to check */
\par \tab Pointer user_data;           /* user supplied data */
\par \tab AsnExpOptFunc user_callback; /* user supplied callback function */
\par \tab struct expopt PNTR next;
\par \} AsnExpOpt, PNTR AsnExpOptPtr;
\par 
\par typedef void ( *ErrorRetType) PROTO((Int2, CharPtr));
\par typedef Int2 ( *IoFuncType) PROTO((Pointer, CharPtr, Uint2));
\par 
\par typedef struct asnio \{
\par \tab CharPtr linebuf;
\par \tab Int1 type;            /* type- text-in, text-out, bin-in, bin-out */
\par \tab Int2 linepos;         /* current offset in linebuf */
\par \tab FILE * fp;             /* file to write or read to */
\par \tab BytePtr buf;          /* buffer for I/O */
\par     Int2 bufsize;         /* sizeof this buffer */
\par \tab Int2 bytes,           /* bytes of data available in buf */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab offset;           /* current offset of processing in buf */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab Uint1 tagclass;       /* last BER tag-id-len read */
\par \tab Int2 tagnumber;
\par \tab Boolean constructed;
\par \tab Int4 length;          /* length of BER encoded data */
\par \tab Boolean tagsaved;     /* TRUE if tag info already here - stops read */
\par \tab Int4 used;            /* if tagsaved, bytes used recorded here */
\par \tab Int1 tabsize,         /* spaces per tab */
\par \tab \tab indent_level,     /* current indent level for print output */
\par \tab \tab linelength,      /* max line length on output */
\par \tab \tab max_indent,       /* current maximum indent levels for first */
\par \tab \tab state;            /* parsing state */
\par     BoolPtr first;        /* for first element on indented line for printing */
\par \tab Int4 linenumber;      /* for reporting errors */
\par \tab CharPtr word;           /* current word in linebuf */
\par \tab Int2 wordlen,         /* length of word in linebuf */
\par \tab      token;           /* current parsing token for word */
\par     PstackPtr typestack;  /* the parsing stack for input and output */
\par \tab Int1 type_indent,     /* used like indent_level and max_indent, but for */
\par \tab \tab max_type;         /* typestack */
\par \tab ErrorRetType error_ret;     /* user error return */
\par     Pointer iostruct;    /* non-FILE io structure */
\par     IoFuncType readfunc,      /* read/write functions for sockets */
\par           writefunc;     /*  open and close MUST be done outside AsnIo */
\par \tab Boolean read_id;     /* for checking AsnReadId AsnReadVal alternation */
\par \tab CharPtr fname;       /* name of file in use */
\par \tab AsnOptionPtr aop;    /* head of options chain */
\par \tab AsnExpOptPtr aeop;   /* exploration options chain */
\par \tab AsnExpOptStructPtr aeosp;
\par \tab Boolean io_failure;  /* set on failed write */
\par \} AsnIo, PNTR AsnIoPtr;
\par 
\par typedef struct asniomem \{    /* for AsnIo to and from a memory block */
\par \tab AsnIoPtr aip;\tab \tab \tab  /* the AsnIoPtr for this */
\par \tab BytePtr buf;\tab \tab \tab  /* a buffer for the data */
\par \tab Uint2 size,\tab \tab /* size of this buffer (w) or bytes_to_read (r) */
\par \tab \tab \tab count;\tab \tab /* count of bytes read from or written to buffer */
\par \} AsnIoMem, PNTR AsnIoMemPtr;
\par 
\par typedef struct asniobs \{    /* for AsnIo to and from a memory ByteStore */
\par \tab AsnIoPtr aip;\tab \tab \tab  /* the AsnIoPtr for this */
\par \tab ByteStorePtr bsp;        /* byte store for this */
\par \} AsnIoBS, PNTR AsnIoBSPtr;
\par 
\par /***** typedefs used often in object loaders **********/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {typedef Pointer (* AsnReadFunc) PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par typedef Boolean (* AsnWriteFunc) PROTO((Pointer object, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   prototypes
\par *\tab \tab 
\par *****************************************************************************/
\par /*** asngen.c ****/
\par 
\par extern AsnTypePtr AsnReadId PROTO((AsnIoPtr aip, AsnModulePtr amp, AsnTypePtr atp));
\par extern Int2 AsnReadVal PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr vp));
\par extern Boolean AsnWrite PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr dvp));
\par extern Boolean AsnSkipValue PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par 
\par extern Boolean AsnOpenStruct PROTO((AsnIoPtr aip, AsnTypePtr atp,
\par \tab \tab \tab Pointer the_struct));
\par extern Boolean AsnCloseStruct PROTO((AsnIoPtr aip, AsnTypePtr atp,
\par \tab \tab \tab Pointer the_struct));
\par extern Boolean AsnWriteChoice PROTO((AsnIoPtr aip, AsnTypePtr atp, Int2 choice,
\par \tab \tab \tab DataValPtr the_value));
\par extern void AsnCheckExpOpt PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr dvp));
\par extern AsnExpOptPtr AsnExpOptNew PROTO((AsnIoPtr aip, CharPtr path,
\par \tab \tab \tab Pointer user_data, AsnExpOptFunc user_func));
\par extern AsnExpOptPtr AsnExpOptFree PROTO((AsnIoPtr aip, AsnExpOptPtr aeop));
\par 
\par extern Int2 AsnGetLevel PROTO((AsnIoPtr aip));
\par extern void AsnNullValueMsg PROTO((AsnIoPtr aip, AsnTypePtr node));
\par 
\par /*** asntypes.c ***/
\par 
\par extern void AsnKillValue PROTO((AsnTypePtr atp, DataValPtr dvp));
\par extern AsnTypePtr PNTR AsnTypePathFind PROTO((AsnModulePtr amp, CharPtr str, Int2Ptr numtypes));
\par extern AsnTypePtr AsnTypeFind PROTO((AsnModulePtr amp, CharPtr str));
\par #define AsnFind(x) AsnTypeFind(NULL,x)    /* find type (all) */
\par extern CharPtr AsnFindPrimName PROTO((AsnTypePtr atp));
\par extern CharPtr AsnFindBaseName PROTO((AsnTypePtr atp));
\par extern AsnTypePtr AsnLinkType PROTO((AsnTypePtr type, AsnTypePtr localtype));
\par extern void AsnUnlinkType PROTO((AsnTypePtr type));
\par extern CharPtr AsnTypeDumpStack PROTO((CharPtr str, AsnIoPtr aip));
\par extern Boolean AsnTreeLoad PROTO((char * file, AsnValxNodePtr * avnptr, AsnTypePtr * atptr, AsnModulePtr * ampptr));
\par #define AsnLoad() AsnTreeLoad(asnfilename, &avn, &at, &amp)   /* simple loader */
\par extern void AsnModuleLink PROTO((AsnModulePtr amp));
\par extern CharPtr AsnEnumStr PROTO((CharPtr str, Int2 val));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern CharPtr AsnEnumTypeStr PROTO((AsnTypePtr atp, Int2 val));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern AsnModulePtr AsnAllModPtr PROTO((void));
\par 
\par /*** asnio.c ****/
\par 
\par extern AsnIoPtr AsnIoOpen PROTO((CharPtr file_name, CharPtr mode));
\par extern AsnIoPtr AsnIoClose PROTO((AsnIoPtr aip));
\par extern void AsnIoReset PROTO((AsnIoPtr aip));
\par extern void AsnIoSetErrorMsg PROTO((AsnIoPtr aip, ErrorRetType error_ret));
\par extern Int4 AsnIoSeek PROTO((AsnIoPtr aip, Int4 pos));
\par extern Int4 AsnIoTell PROTO((AsnIoPtr aip));
\par extern void AsnIoFlush PROTO((AsnIoPtr aip));
\par extern AsnIoPtr AsnIoNew PROTO((Int1 type, FILE * fp, Pointer iostruct, IoFuncType readfunc, IoFuncType writefunc));
\par extern Boolean AsnIoSetBufsize PROTO((AsnIoPtr aip, Int2 size));
\par extern AsnOptionPtr AsnIoOptionNew PROTO((AsnIoPtr aip, Int2 ao_class, Int2 type, DataVal av, AsnOptFreeFunc freefunc));
\par extern void AsnIoOptionFree PROTO((AsnIoPtr aip, Int2 ao_class, Int2 type));
\par extern Boolean AsnClassTypeMatch PROTO((Int2 ao_class, Int2 type, Int2 this_class, Int2 this_type));
\par extern AsnOptionPtr AsnIoOptionGet PROTO((AsnIoPtr aip, Int2 ao_class, Int2 type,
\par \tab \tab \tab \tab \tab \tab \tab AsnOptionPtr last));
\par extern AsnOptionPtr AsnOptionNew PROTO((AsnOptionPtr PNTR aopp, Int2 ao_class, Int2 type, DataVal av, AsnOptFreeFunc freefunc));
\par extern void AsnOptionFree PROTO((AsnOptionPtr PNTR aopp, Int2 ao_class, Int2 type));
\par extern AsnOptionPtr AsnOptionGet PROTO((AsnOptionPtr head, Int2 ao_class, Int2 type,
\par \tab \tab \tab \tab \tab \tab \tab AsnOptionPtr last));
\par 
\par    /*** read and write to memory buffer ***/
\par extern AsnIoMemPtr AsnIoMemOpen PROTO((CharPtr mode, BytePtr buf, Uint2 size));
\par extern AsnIoMemPtr AsnIoMemClose PROTO((AsnIoMemPtr aimp));
\par extern Boolean AsnIoMemReset PROTO((AsnIoMemPtr aimp, Uint2 bytes_to_read));
\par extern Int2 AsnIoMemRead PROTO((Pointer, CharPtr, Uint2));
\par extern Int2 AsnIoMemWrite PROTO((Pointer, CharPtr, Uint2));
\par 
\par    /*** read and write to a ByteStore in memory ***/
\par extern AsnIoBSPtr AsnIoBSOpen PROTO((CharPtr mode, ByteStorePtr bsp));
\par extern AsnIoBSPtr AsnIoBSClose PROTO((AsnIoBSPtr aibp));
\par extern Int2 AsnIoBSRead PROTO((Pointer, CharPtr, Uint2));
\par extern Int2 AsnIoBSWrite PROTO((Pointer, CharPtr, Uint2));
\par 
\par   /** Copy and Compare functions ***/
\par extern Pointer AsnIoCopy PROTO((Pointer from, AsnReadFunc readfunc, AsnWriteFunc writefunc));
\par extern Pointer AsnIoMemCopy PROTO((Pointer from, AsnReadFunc readfunc, AsnWriteFunc writefunc));
\par extern Boolean AsnIoMemComp PROTO((Pointer a, Pointer b, AsnWriteFunc writefunc));
\par 
\par #define AsnIoNullOpen() AsnIoNew((ASNIO_OUT | ASNIO_TEXT | ASNIO_CARRIER), NULL, NULL, NULL, NULL)
\par 
\par /*** asndebin.c ***/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern AsnTypePtr AsnBinReadId PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Int2 AsnBinReadVal PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr vp));
\par 
\par /*** asnenbin.c ***/
\par 
\par extern Boolean AsnBinWrite PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr dvp));
\par          /** expert use only ***/
\par extern void AsnEnBinBytes PROTO((Pointer ptr, Uint4 len, AsnIoPtr aip));
\par 
\par /*** asnlex.c ***/
\par 
\par extern AsnTypePtr AsnTxtReadId PROTO((AsnIoPtr aip, AsnModulePtr amp, AsnTypePtr atp));
\par extern Int2 AsnTxtReadVal PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr vp));
\par 
\par /*** asnprint.c ***/
\par 
\par extern Boolean AsnTxtWrite PROTO((AsnIoPtr aip, AsnTypePtr atp, DataValPtr dvp));
\par 
\par /*** asnlext.c ***/
\par 
\par extern AsnModulePtr AsnLoadModules PROTO((AsnIoPtr aip));
\par 
\par /******** temporary defines for older code *************/
\par 
\par #define AsnStartStruct(x,y) AsnOpenStruct(x, y, NULL)
\par #define AsnEndStruct(x,y) AsnCloseStruct(x, y, NULL)
\par 
\par /***** AsnOption ao_class values - do not reuse ***************/
\par /***** all positive numbers > 0 are available to non-NCBI applications ***/
\par 
\par #define OP_ANY          0
\par #define OP_TOGENBNK    -1
\par #define OP_BB2ASN      -2
\par #define OP_NCBIOBJSSET -3
\par #define OP_NCBIOBJSEQ  -4
\par #define OP_GET_MUID    -5
\par 
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 118}}}{\b0 \tab General Objects}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 General Objects   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 117}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {include general.doc}}{\fldrslt {{\*\bkmkstart _Toc294430324}{\*\bkmkstart _Toc294430801}{\*\bkmkstart _Toc300649201}General Use Objects{\*\bkmkend _Toc294430324}{\*\bkmkend _Toc294430801}{\*\bkmkend _Toc300649201}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430325}{\*\bkmkstart _Toc294430802}{\*\bkmkstart _Toc300649202}Introduction{\*\bkmkend _Toc294430325}{\*\bkmkend _Toc294430802}{\*\bkmkend _Toc300649202}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This section presents the data objects defined in general.asn and objgen.[ch].  They are a miscellaneous collection of generally useful types.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430326}{\*\bkmkstart _Toc294430803}{\*\bkmkstart _Toc300649203}Large Text Blocks: StringStore{\*\bkmkend _Toc294430326}{\*\bkmkend _Toc294430803}{\*\bkmkend _Toc300649203}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A StringStore is defined as a VisibleString for ASN.1 encoding.  This type is used to hold very long strings.  It is simply a hint to the AsnLib functions to store the incoming data in a ByteStore (see CoreLib chapter) rather than an array to avoid overrunning allocation limits of some computers.  OCTET STRINGs (a sequence of opaque bytes) are always kept in ByteStore structures since the length of the object must be stored as well (no terminating '\\0' is possible).  ByteStores have the advantage of segmenting the long strings, which for nucleic acid data can get very long.  The ByteStore will allow us to add data buffering to disk for these large objects as it becomes necessary even on large computers.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430327}{\*\bkmkstart _Toc294430804}{\*\bkmkstart _Toc300649204}The Date{\*\bkmkend _Toc294430327}{\*\bkmkend _Toc294430804}{\*\bkmkend _Toc300649204}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {ASN.1 has primitive types for recording dates but which require the time in seconds as well.  For scientific and bibliographic data, it is common that only the date, or even just a part of the date (e.g. month and year) are available.  Rather than use artificial zero values for the more precise ASN.1 form, we have created a specialized Date type.  Date is a CHOICE of a simple, unparsed string or a structured Date-std.  The string form is a fall-back for when the input data is so poorly structured that it is impossible to reliably parse the date fields from it.  It should only be used as a last resort to accommodate old data, as it is impossible to compute or index on.
\par When possible, the "std" form of the Date should be used.  In this case year is an integer (e.g. 1992), month is an integer from 1-12 (where January is 1), and day is an integer from 1-31.  A string called "season" can be used, particularly for bibliographic citations (e.g. the "spring" issue).  When a range of months is given for an issue (e.g. "June\_July") it cannot be represented directly.  However, one would like to be able to index on integer months but still not lose the range.  This is accomplished by putting 6 in the "month" slot and "\_July" in the "season" slot.  The DatePrint() function will put them back together for display, but the issue can still be indexed by month.  Year is the only required field in a Date-std.
\par The "C" structure used for Date can accommodate both the representation of the CHOICE itself (which kind of Date is this?) and the data from either CHOICE.  It has a four byte array and a CharPtr.  The byte[0] indicates what kind of Date it is.  If a "str" type, then the CharPtr points to the string and the other three bytes in the array have no meaning.  If a "std" type, then the byte[1] is the year (minus 1900 to save space - the object loaders will add the 1900 back when encoding into ASN.1), byte[2] is the month (or 0 if not given), and byte[3] is the day (or 0 if not given).  If the CharPtr is NULL, then the season is not given.
\par The object loaders contain a number of handy functions for working with Dates in addition to the usual New(), Free(), AsnRead() and AsnWrite() functions. DateWrite() will fill a Date.std with the function arguments. DateRead() will fill pointer arguments with the values from a Date. DateCurr() will create and return a Date.std filled with the current date by accessing the computer system.  DateDup() will create a copy of a Date. DatePrint() will format a Date into a display format into a buffer supplied by the caller.  This buffer should normally be at least 30 bytes long.  The format is e.g. "Jun 30, 1992".
\par DateMatch(a, b, all) will return 0 if Date a is the same as Date b, 1 if b is after a, -1 if b is before a. It will return a 2 or -2 (for sorting) if they are different Date types (str and std) that could not be compared. If all is equal to TRUE, then all fields that are set in one Date must be set and must match in the other Date. If all is equal to FALSE, then only the fields set in both are matched. Note that this function can only measure if one date is before another chronologically if both are Date-std types. The string Date types can only be compared lexically (like strcmp()).
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430328}{\*\bkmkstart _Toc294430805}{\*\bkmkstart _Toc300649205}Identifying Things: Object-id{\*\bkmkend _Toc294430328}{\*\bkmkend _Toc294430805}{\*\bkmkend _Toc300649205}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An Object-id is a simple structure used to identify a data object.  It is just a CHOICE of an INTEGER or a VisibleString.  It must always be used within some defining context (e.g. see Dbtag below) in order to have some global meaning.  It allows flexibility in a host system's preference for identifying things by integers or strings.
\par The ObjectId "C" structure has a 4 byte integer slot and a CharPtr slot.  If the CharPtr is NULL, then the integer value is the identifier and the type is "int".  If the CharPtr is not NULL, then the Object-id is type "str" and the CharPtr is considered to point at the identifier.
\par There is an ObjectIdDup() function to make a copy of an ObjectId and an ObjectIdMatch() function which returns TRUE if two ObjectIds are identical, FALSE if they are not.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430329}{\*\bkmkstart _Toc294430806}{\*\bkmkstart _Toc300649206}Identifying Things: Dbtag{\*\bkmkend _Toc294430329}{\*\bkmkend _Toc294430806}{\*\bkmkend _Toc300649206}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Dbtag is an Object-id within the context of a database.  The database is just defined by a VisibleString.  The strings identifying the database are not centrally controlled, so it is possible that a conflict could occur.  If there is a proliferation of Dbtags, then a registry might be considered at NCBI.  Dbtags provide a simple, general way for small database providers to supply their own internal identifiers in a way which will, usually, be globally unique as well, yet requires no official sanction.  So, for example, identifiers for features on sequences are not widely available at the present time.  However, the Eukaryotic Promotor Database (EPD) can be provided as a set of features on sequences.  The internal key to each EPD entry can be propagated as the Feature-id by using a Dbtag where "EPD" is the "db" field and an integer is used in the Object-id, which is the same integer identifying the entry in the normal EPD release.
\par As for ObjectIds, there are DbtagMatch() and DbtagDup() functions in the object loaders.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430330}{\*\bkmkstart _Toc294430807}{\*\bkmkstart _Toc300649207}Identifying People: Person-id{\*\bkmkend _Toc294430330}{\*\bkmkend _Toc294430807}{\*\bkmkend _Toc300649207}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Person-id provides an extremely flexible way to identify people.  There are four CHOICES from very explicit to completely unstructured.  When one is building a database, one should select the most structured form possible.  However, when one is processing data from other sources, one can only pick the most structured form possible, given the input data.
\par The first Person-id CHOICE is a Dbtag.  It would allow people to be identified by some formal registry.  For example, in the USA, it might be possible to identify people by Social Security Number.  Theoretically, one could then maintain a link to a person in database, even if they changed their name.  Dbtag would allow other registries, such as professional societies, to be used as well. Frankly, this may be wishful thinking and possibly even socially inadvisable, though from a database standpoint, it would be very useful to have some stable identifier for people.
\par A Name-std Choice is the next most explicit form.  It allows a structured, fielded name, making indexing by last name, but disambiguation (of say, "Jones") by first name possible.  This is the best choice when the data is available and its use should be encouraged by those building new databases wherever reasonable.
\par The last two choices are string types.  MEDLINE stores names in strings in a structured way (e.g. Jones JM).  This means one can usually, but not always, parse out last names and can generally build indexes on the assumption that the last name is first.  Thus, it is worth distinguishing this case from the pure string form, the last CHOICE.  In a pure string, there is no guarantees of any kind made about the structure of the name.  It could be last name first, first name first, comma after last name, periods between initials, etc.  The string form should be the CHOICE of last resort.
\par In the "C" structure, the first element indicates the type of the Person-id.  The generic Pointer then must be cast to the correct type given that knowledge.  So, for a Person-id.dbtag the Pointer is a DbtagPtr.  For Person-id.name it is a NameStdPtr.  For Person-id.ml or Person-id.str it is a CharPtr.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430331}{\*\bkmkstart _Toc294430808}{\*\bkmkstart _Toc300649208}Expressing Uncertainty with Fuzzy Integers: Int-fuzz{\*\bkmkend _Toc294430331}{\*\bkmkend _Toc294430808}{\*\bkmkend _Toc300649208}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Lengths of biological sequences and locations on them are expressed with integers.  However, sometimes it is desirable to be able to indicate some uncertainty about that length or location.  Unfortunately, most software cannot make good use of such uncertainties, though in most cases this is fine.  In order to provide both a simple, single integer view, as well as a more complex fuzzy view when appropriate, we have adopted the following strategy.  In the NCBI specifications, all lengths and locations are always given by simple integers.  If information about fuzziness is appropriate, then an Int-fuzz is ADDED to the data.  In this case, the simple integer can be considered a "best guess" of the length or location.  Thus simple software can ignore fuzziness, while it is not lost to more sophisticated uses.
\par Fuzziness can take a variety of forms.  It can be plus or minus some fixed value.  It can be somewhere in a range of values.  It can be plus or minus a percentage of the best guess value.  It may also be certain boundary conditions (greater than the value, less than the value) or refer to the bond BETWEEN residues of the biological sequence (bond to the right of this residue, bond to the left of that residue).
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430332}{\*\bkmkstart _Toc294430809}{\*\bkmkstart _Toc300649209}Creating Your Own Objects: User-object{\*\bkmkend _Toc294430332}{\*\bkmkend _Toc294430809}{\*\bkmkend _Toc300649209}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {One of the strengths of ASN.1 is that it requires a formal specification of data down to very detailed levels.  This enforces clear definitions of data which greatly facilitates exchange of information in useful ways between different databases, software tools, and scientific enterprises.  The problem with this approach is that it makes it very difficult for end users to add their own objects to the specification or enhance objects already in the specification.  Certainly custom modules can be added to accommodate specific groups needs, but the data from such custom modules cannot be exchanged or passed through tools which adhere only to the common specification.
\par We have defined an object called a User-object, which can represent any class of simple, structured, or tabular data in a completely structured way, but which can be defined in any way that meets a user's needs. The User-object itself has a "class" tag which is a string used like the "db" string in Dbtag, to set the context in which this User-object is meaningful.  The "class" strings are not centrally controlled, so again it is possible to have a conflict, but unlikely unless activity in this area becomes very great.  Within a "class" one can define an object "type" by either a string or an integer.  Thus any particular endeavor can define a wide variety of different types for their own use.  The combination of "class" and "type" identifies the object to databases and software that may understand and make use this particular User-object's structure and properties.  Yet, the generic definition means software that does not understand the purpose or use of any User-object can still parse it, pass it though, or even print it out for a user to peruse.
\par The attributes of the User-object are contained in one or more User-fields.  Each User-field has a field label, which is either a string or an integer.  It may contain any kind of data, strings, real numbers, integers, arrays of anything, or even sub-fields or complete sub-objects.  When arrays and repeating fields are supplied, the optional "num" attribute of the User-field is used to tell software how many elements to prepare to receive.  Virtually any structured data type from the simplest to the most complex can be built up from these elements.
\par The User-object is provided in a number of places in the public ASN.1 specifications to allow users to added their own structured features to Feature-tables or their own custom extensions to existing features.  This allows new ideas to be tried out publicly, and allows software tools to be written to accommodate them, without requiring consensus among scientists or constant revisions to specifications.  Those new ideas which time and experience indicate have become important concepts in molecular biology can be "graduated" to real ASN.1 specifications in the public scheme.  A large body of structured data would presumably already exist in User-objects of this type, and these could all be back fitted into the new specified type, allowing data to "catch up" to the present specification.  Those User-objects which do not turn out to be generally useful or important remain as harmless historical artifacts.  User-objects could also be used for custom software to attach data only required for use by a particular tool to an existing standard object without harming it for use by standard tools.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430333}{\*\bkmkstart _Toc294430810}{\*\bkmkstart _Toc300649210}ASN.1 Specification: general.asn{\*\bkmkend _Toc294430333}{\*\bkmkend _Toc294430810}{\*\bkmkend _Toc300649210}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par --
\par --  NCBI General Data elements
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-General DEFINITIONS ::=
\par BEGIN
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {EXPORTS Date, Person-id, Object-id, Dbtag, Int-fuzz, User-object;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par -- StringStore is really a VisibleString.  It is used to define very
\par --   long strings which may need to be stored by the receiving program
\par --   in special structures, such as a ByteStore, but it's just a hint.
\par --   AsnTool stores StringStores in ByteStore structures.
\par -- OCTET STRINGs are also stored in ByteStores by AsnTool
\par -- 
\par -- typedef struct bsunit \{       /* for building multiline strings */
\par    -- Nlm_Handle str;            /* the string piece */
\par    -- Nlm_Int2 len_avail,
\par        -- len;
\par    -- struct bsunit PNTR next; \}       /* the next one */
\par -- Nlm_BSUnit, PNTR Nlm_BSUnitPtr;
\par -- 
\par -- typedef struct bytestore \{
\par    -- Nlm_Int4 seekptr,       /* current position */
\par    -- totlen,             /* total stored data length in bytes */
\par -- chain_offset;     /* offset in ByteStore of first byte in curchain */
\par    -- Nlm_BSUnitPtr chain,       /* chain of elements */
\par       -- curchain;           /* the BSUnit containing seekptr */
\par -- \} Nlm_ByteStore, PNTR Nlm_ByteStorePtr;
\par --
\par -- AsnTool incorporates this as a primitive type, so the definition
\par --   is here just for completness
\par -- 
\par --  StringStore ::= [APPLICATION 1] IMPLICIT OCTET STRING
\par --
\par 
\par -- Date is used to replace the (overly complex) UTCTtime, GeneralizedTime
\par --  of ASN.1
\par --  It stores only a date
\par --
\par 
\par Date ::= CHOICE \{
\par     str VisibleString ,        -- for those unparsed dates
\par     std Date-std \}             -- use this if you can
\par 
\par Date-std ::= SEQUENCE \{        -- NOTE: this is NOT a unix tm struct
\par     year INTEGER ,             -- full year (including 1900)
\par     month INTEGER OPTIONAL ,   -- month (1-12)
\par     day INTEGER OPTIONAL ,     -- day of month (1-31)
\par     season VisibleString OPTIONAL \}  -- for "spring", "may-june", etc
\par 
\par -- Dbtag is generalized for tagging
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {-- eg. \{ "Social Security", str "023-79-8841" \}
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {-- or  \{ "member", id 8882224 \}
\par 
\par Dbtag ::= SEQUENCE \{
\par     db VisibleString ,          -- name of database or system
\par     tag Object-id \}         -- appropriate tag
\par 
\par -- Object-id can tag or name anything
\par --
\par 
\par Object-id ::= CHOICE \{
\par     id INTEGER ,
\par     str VisibleString \}
\par 
\par -- Person-id is to define a std element for people
\par --
\par 
\par Person-id ::= CHOICE \{
\par     dbtag Dbtag ,               -- any defined database tag
\par     name Name-std ,             -- structured name
\par     ml VisibleString ,          -- MEDLINE name (semi-structured)
\par                                 --    eg. "Jones RM"
\par     str VisibleString \}         -- unstructured name
\par 
\par Name-std ::= SEQUENCE \{ -- Structured names
\par     last VisibleString ,
\par     first VisibleString OPTIONAL ,
\par     middle VisibleString OPTIONAL ,
\par     full VisibleString OPTIONAL ,    -- full name eg. "J. John Poop, Esq"
\par     initials VisibleString OPTIONAL,  -- first + middle initials
\par     suffix VisibleString OPTIONAL ,   -- Jr, Sr, III
\par     title VisibleString OPTIONAL \}    -- Dr., Sister, etc
\par 
\par --**** Int-fuzz **********************************************
\par --*
\par --*   uncertainties in integer values
\par 
\par Int-fuzz ::= CHOICE \{
\par     p-m INTEGER ,                    -- plus or minus fixed amount
\par     range SEQUENCE \{                 -- max to min
\par         max INTEGER ,
\par         min INTEGER \} ,
\par     pct INTEGER ,                    -- % plus or minus (x10) 0-1000
\par     lim ENUMERATED \{                 -- some limit value
\par         unk (0) ,                    -- unknown
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        gt (1) ,                     -- greater than
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        lt (2) ,                     -- less than
\par         tr (3) ,                     -- space to right of position
\par         tl (4) ,                     -- space to left of position
\par         other (255) \} \}              -- something else
\par 
\par 
\par --**** User-object **********************************************
\par --*
\par --*   a general object for a user defined structured data item
\par --*    used by Seq-feat and Seq-descr
\par 
\par User-object ::= SEQUENCE \{
\par     class VisibleString OPTIONAL ,   -- endeavor which designed this object
\par     type Object-id ,                 -- type of object within class
\par     data SEQUENCE OF User-field \}    -- the object itself
\par 
\par User-field ::= SEQUENCE \{
\par     label Object-id ,                -- field label
\par     num INTEGER OPTIONAL ,           -- required for strs, ints, reals, oss
\par     data CHOICE \{                    -- field contents
\par         str VisibleString ,
\par         int INTEGER ,
\par         real REAL ,
\par         bool BOOLEAN ,
\par         os OCTET STRING ,
\par         object User-object ,         -- for using other definitions
\par         strs SEQUENCE OF VisibleString ,
\par         ints SEQUENCE OF INTEGER ,
\par         reals SEQUENCE OF REAL ,
\par         oss SEQUENCE OF OCTET STRING ,
\par         fields SEQUENCE OF User-field ,
\par         objects SEQUENCE OF User-object \} \}
\par 
\par 
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430334}{\*\bkmkstart _Toc294430811}{\*\bkmkstart _Toc300649211}C Structures and Functions: objgen.h{\*\bkmkend _Toc294430334}{\*\bkmkend _Toc294430811}{\*\bkmkend _Toc300649211}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objgen.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  terms of the United States Copyright Act.  It was written as part of    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objgen.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 1/1/91
\par *
\par * $Revision: 2.1 $
\par *
\par * File Description:  Object manager interface for module NCBI-General
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_General_
\par #define _NCBI_General_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern "C" \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean GeneralAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-General objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   Date, Date-std share the same structure
\par *      any data[2] or data[3] values = 0 means not set or not present
\par *   data [0] - CHOICE of date ,0=str, 1=std
\par *        [1] - year (- 1900)
\par *        [2] - month (1-12)  optional
\par *   \tab  [3] - day (1-31)\tab  optional
\par *
\par *****************************************************************************/
\par 
\par 
\par typedef struct date \{
\par \tab Uint1 data[4];      /* see box above */
\par \tab CharPtr str;\tab \tab /* str or season or NULL */
\par \} NCBI_Date, PNTR NCBI_DatePtr;
\par #define DatePtr NCBI_DatePtr
\par 
\par NCBI_DatePtr DateNew PROTO((void));
\par NCBI_DatePtr DateFree PROTO((NCBI_DatePtr dp));
\par Boolean DateWrite PROTO((NCBI_DatePtr dp, Int2 year, Int2 month, Int2 day, CharPtr season));
\par Boolean DateRead PROTO((NCBI_DatePtr dp, Int2Ptr year, Int2Ptr month, Int2Ptr day, CharPtr season));
\par Boolean DatePrint PROTO((NCBI_DatePtr dp, CharPtr buf));
\par NCBI_DatePtr DateCurr PROTO((void));
\par NCBI_DatePtr DateDup PROTO((NCBI_DatePtr dp));
\par Boolean DateAsnWrite PROTO((NCBI_DatePtr dp, AsnIoPtr aip, AsnTypePtr atp));
\par NCBI_DatePtr DateAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par Int2 DateMatch PROTO((DatePtr a, DatePtr b, Boolean all));
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {/*****************************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par *   Object-id stuff
\par *
\par *****************************************************************************/
\par typedef struct objid \{
\par \tab Int4 id;
\par \tab CharPtr str;
\par \} ObjectId, PNTR ObjectIdPtr;
\par 
\par extern ObjectIdPtr ObjectIdNew PROTO((void));
\par extern ObjectIdPtr ObjectIdFree PROTO(( ObjectIdPtr oid));
\par extern ObjectIdPtr ObjectIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean ObjectIdAsnWrite PROTO((ObjectIdPtr oid, AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean ObjectIdMatch PROTO((ObjectIdPtr a, ObjectIdPtr b));
\par extern ObjectIdPtr ObjectIdDup PROTO((ObjectIdPtr oldid));
\par 
\par /*****************************************************************************
\par *
\par *   DBtag stuff
\par *
\par *****************************************************************************/
\par typedef struct dbtag \{
\par \tab CharPtr db;
\par \tab ObjectIdPtr tag;
\par \} Dbtag, PNTR DbtagPtr;
\par 
\par extern DbtagPtr DbtagNew PROTO((void));
\par extern DbtagPtr DbtagFree PROTO(( DbtagPtr dbt));
\par extern DbtagPtr DbtagAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean DbtagAsnWrite PROTO((DbtagPtr dbt, AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean DbtagMatch PROTO((DbtagPtr a, DbtagPtr b));
\par extern DbtagPtr DbtagDup PROTO((DbtagPtr oldtag));
\par 
\par /*****************************************************************************
\par *
\par *   Name-std
\par *   names[0] = last
\par *        [1] = first
\par *        [2] = middle
\par *        [3] = full
\par *        [4] = initials
\par *        [5] = suffix
\par *        [6] = title
\par *
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {typedef struct namestd \{
\par \tab CharPtr names[7];
\par \} NameStd, PNTR NameStdPtr;
\par 
\par extern NameStdPtr NameStdNew PROTO((void));
\par extern NameStdPtr NameStdFree PROTO(( NameStdPtr nsp));
\par extern NameStdPtr NameStdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean NameStdAsnWrite PROTO((NameStdPtr nsp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Person-id
\par *     choice = 0 = not set
\par *              1 = dbtag
\par *              2 = name
\par *              3 = ml
\par *              4 = str
\par *
\par *****************************************************************************/
\par typedef struct personid \{
\par \tab Uint1 choice;         /* which CHOICE, see above */
\par \tab Pointer data;         /* points to appropriate data structure */
\par \} PersonId, PNTR PersonIdPtr;
\par 
\par extern PersonIdPtr PersonIdNew PROTO((void));
\par extern PersonIdPtr PersonIdFree PROTO(( PersonIdPtr pid));
\par extern PersonIdPtr PersonIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean PersonIdAsnWrite PROTO((PersonIdPtr pid, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Int-fuzz
\par *
\par *****************************************************************************/
\par typedef struct intfuzz \{
\par \tab Uint1 choice;       /* 1=p-m, 2=range, 3=pct, 4=lim */
\par \tab Int4 a, b;          /* a=p-m,max,pct,orlim, b=min */
\par \} IntFuzz, PNTR IntFuzzPtr;
\par 
\par extern IntFuzzPtr IntFuzzNew PROTO((void));
\par extern IntFuzzPtr IntFuzzFree PROTO(( IntFuzzPtr ifp));
\par extern IntFuzzPtr IntFuzzAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean IntFuzzAsnWrite PROTO((IntFuzzPtr ifp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {/*****************************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par *   User-field
\par *      data is an DataVal where:
\par *    choice    asn1              data. =
\par         1 = str VisibleString ,  ptrvalue = CharPtr
\par         2 = int INTEGER ,        intvalue
\par         3 = real REAL ,          realvalue
\par         4 = bool BOOLEAN ,       boolvalue
\par         5 = os OCTET STRING ,    ptrvalue = ByteStorePtr
\par         6 = object User-object ,   ptrvalue = UserObjectPtr
\par         7 = strs SEQUENCE OF VisibleString ,  ptrvalue = CharPtr PNTR
\par         8 = ints SEQUENCE OF INTEGER ,        ptrvalue = Int4Ptr
\par         9 = reals SEQUENCE OF REAL ,          ptrvalue = FloatHiPtr
\par         10 = oss SEQUENCE OF OCTET STRING ,   ptrvalue = ByteStorePtr PNTR
\par         11 = fields SEQUENCE OF User-field ,  ptrvalue = UserFieldPtr
\par         12 = objects SEQUENCE OF User-object \} \}  ptrvalue = UserObjectPtr
\par 
\par *   User-object
\par *
\par *****************************************************************************/
\par typedef struct userfield \{
\par     ObjectIdPtr label;
\par     Int4 num;
\par     Uint1 choice;
\par     DataVal data;
\par     struct userfield PNTR next;
\par \} UserField, PNTR UserFieldPtr;
\par 
\par extern UserFieldPtr UserFieldNew PROTO((void));
\par extern UserFieldPtr UserFieldFree PROTO(( UserFieldPtr ufp));
\par extern UserFieldPtr UserFieldAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean UserFieldAsnWrite PROTO((UserFieldPtr ufp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par typedef struct userobj \{
\par     CharPtr _class;
\par     ObjectIdPtr type;
\par     UserFieldPtr data;
\par     struct userobj PNTR next;   /* for SEQUENCE OF User-object */
\par \} UserObject, PNTR UserObjectPtr;
\par 
\par extern UserObjectPtr UserObjectNew PROTO((void));
\par extern UserObjectPtr UserObjectFree PROTO(( UserObjectPtr uop));
\par extern UserObjectPtr UserObjectAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean UserObjectAsnWrite PROTO((UserObjectPtr uop, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 134}}}{\b0 \tab Bibliographic Elements}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Bibliographic Elements   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 135}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {include biblio.doc}}{\fldrslt {{\*\bkmkstart _Toc294430335}{\*\bkmkstart _Toc294430812}{\*\bkmkstart _Toc300649212}Bibliographic References{\*\bkmkend _Toc294430335}{\*\bkmkend _Toc294430812}{\*\bkmkend _Toc300649212}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430336}{\*\bkmkstart _Toc294430813}{\*\bkmkstart _Toc300649213}Introduction{\*\bkmkend _Toc294430336}{\*\bkmkend _Toc294430813}{\*\bkmkend _Toc300649213}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The published literature is an essential component of any scientific endeavor, not just in molecular biology.  The bibliographic component of the specification and the tools which go with it may find wide use then, permitting reuse of software and databases in many contexts.  In addition, the fact that bibliographic citations appear in data from many sources, makes this data extremely valuable in linking data items from different databases to each other (i.e. indirectly through a shared literature citation) to build integrated views of complex data.  For this reason, it is also important that database builders ensure that their literature component contain sufficient information to permit this mapping.  By conforming to the specification below one can be assured that this will be the case.
\par Much of the following bibliographic specification was derived from the components recommended in the American National Standard for Bibliographic References (ANSI Z39.29-1977), and in interviews with professional librarians at the National Library of Medicine.  The recommendations were then relaxed somewhat (by making certain fields OPTIONAL) to accommodate the less complete citation information available in current biomedical databases.  Thus, although a field may be OPTIONAL, a database builder should still attempt to fill it, if it can reasonably be done.
\par In this chapter we also present a specification for the base class Pub, publications of any sort and collections of publications. The MEDLINE specification has enough unique components that it is discussed separately in another chapter.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430337}{\*\bkmkstart _Toc294430814}{\*\bkmkstart _Toc300649214}Citation Components: Affiliation{\*\bkmkend _Toc294430337}{\*\bkmkend _Toc294430814}{\*\bkmkend _Toc300649214}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Affiliation is effectively the institutional affiliation of an author.  Since it has the same fields needed to cite a publisher (of a book) it is reused in that context as well, although in that case it is not precisely an "affiliation".  Affil is a CHOICE of two forms, a structured form which is preferred, or an unstructured string when that is all that is available.
\par The structured form has a number of fields taken from the ANSI guidelines.  "affil" is institutional affiliation, such as "Harvard University".  "div" is division within institution, such as "Department of Molecular Biology". "city" is obvious. "sub" is a subdivision of a country.  In the United States, this would be the state.  "country" is obvious. "street" has been added to the specification (it is not included in ANSI) so that it is possible to produce a valid mailing address.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430338}{\*\bkmkstart _Toc294430815}{\*\bkmkstart _Toc300649215}Citation Components: Authors{\*\bkmkend _Toc294430338}{\*\bkmkend _Toc294430815}{\*\bkmkend _Toc300649215}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Auth-list is the list of authors for the citation. It is a SEQUENCE, not a SET, since the order of author names matters.  The names can be unstructured strings (the least desirable), semi-structured strings following the MEDLINE rules (e.g. "Jones JM"), or fully structured Authors (most desirable). An Affil can be associated with the whole list (typical of a scientific article). A more detailed discussion on the use of different types of names can be found in the "Identifying People" section of the "General Use Objects" chapter.
\par If fully structured Authors are used, each Author can have an individual Affil.  The Author uses Person-id (defined in general.asn) which can be an unstructured string or MEDLINE string, as above, or a fielded name with the components broken out separately.  The Author form also allows specification of the role of individual authors in producing the citation.  The primary author(s) does not mean the "first" author, but rather that this author had a role in the original writing or experimental work.  A secondary author is a reviewer or editor of the article.  It is rare in a scientific work that a secondary author is ever mentioned by name.  Authors may play different roles in the work., compiling, editing, translating.  Again, in a scientific work, the authors mentioned did none of these things, but were involved in the actual writing of the paper, although it would not be unusual anymore for one author to be the patent assignee.  For scientific work, then, the main advantages of using the Author form is the use of fielded names and of individual Affils.  For a book, being able to indicate the editors vs. the authors is useful also.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430339}{\*\bkmkstart _Toc294430816}{\*\bkmkstart _Toc300649216}Citation Components: Imprint{\*\bkmkend _Toc294430339}{\*\bkmkend _Toc294430816}{\*\bkmkend _Toc300649216}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Imprint provides information about the physical form in which the citation appeared, such as what volume and issue of a journal it was in. For the "date" a structured Date is preferred. While "volume", "issue", and "pages" are commonly integers, there are many cases where they are not pure integers (e.g. pages xvi-xvii or issue 10A).  Pages is given as a single string to simplify input from different sources.  The convention is first page (hyphen) last page, or just page if it is on a single page.  "section" may be relevant to a book or proceedings.  "pub" is an Affil used to give the publisher of a book.  The Affil.affil field is used to give the name of the publisher. "cprt" is the copyright date for a book. "part-sup" is for part or supplement and is not part of ANSI, but is used by MEDLINE. "language" is for the original language of the publication, which is also used by MEDLINE, but is not part of the ANSI standard. "prepub" is not part of the ANSI standard, but was added by NCBI to accommodate citations for as yet unpublished papers that can accompany data directly submitted by authors to the database.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430340}{\*\bkmkstart _Toc294430817}{\*\bkmkstart _Toc300649217}Citation Components: Title{\*\bkmkend _Toc294430340}{\*\bkmkend _Toc294430817}{\*\bkmkend _Toc300649217}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A published work may have a number of Titles, each playing a particular role in specifying the work.  There is the title of a paper, the title of a book it appears in, or the title of the journal, in which case it may come from a controlled list of serials.  There may also be an original title and a translated title.  For these reasons, Title is a defined entity rather than just a string, to allow the roles to be specified explicitly. Certain types of Title are legal for an Article, but not for a Journal or a Book.  Rather than make three overlapping definitions, one for Article Titles, one for Journal Titles, and one for Book Titles, we have made one Title type and just indicated in the comments of the specification whether a particular form of Title is legal for an Article, Journal, or Book. Title is a SET OF because a work may have more than one title (e.g. an original and a translated title, or an ISO journal title abbreviation and an ISSN).
\par Title can be of a number of types. "name" is the full title of an article, or the full name of a book or journal. "tsub" is a subordinate title (e.g. "Hemoglobin Binds Oxygen" might be a primary title, while "Heme Groups in Biology: Part II" might be a subordinate title). "trans" is the translated title.  So for an English language database like MEDLINE which contains an article originally published in French, the French title is "name" and the English version of it is "trans".
\par "jta" is a journal title abbreviation.  It is only valid for a journal name, obviously.  "jta" does not specify what kind of abbreviation it is, so it is the least useful of the journal designations available and should only be used as a last resort. "iso-jta" is an International Standards Organization (ISO) journal title abbreviation.  This is the preferred form.  A list of valid iso-jta's is available from NCBI or the National Library of Medicine. "ml-jta" is a MEDLINE journal title abbreviation.  MEDLINE pre-dates the ISO effort, so it does not use iso-jta's. "coden" is a six letter code for journals which is used by a number of groups, particularly in Europe.  "issn" is a code used by publishers to identify journals.  To facilitate the use of controlled vocabularies for journal titles, NCBI maintains a file of mappings between "name", "iso-jta", "ml-jta", "coden", and "issn" where it is possible, and this file is available upon request.
\par "abr" is strictly the abbreviated title of a book. "isbn" is similar to "issn" in that it is a publishers abbreviation for a book.  "isbn" is very useful, but one must be careful since it is used by publishers to list books, and to a publisher a hard cover book is different from a paperback (and get different "isbn"s) even if they are the same title.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430341}{\*\bkmkstart _Toc294430818}{\*\bkmkstart _Toc300649218}Citing an Article{\*\bkmkend _Toc294430341}{\*\bkmkend _Toc294430818}{\*\bkmkend _Toc300649218}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An article always occurs within some other published medium.  It can be an article in a journal or a chapter or section in a book or proceedings.  Thus there are two components to an article citation; a citation for the work it was published in and a citation for the article within that work. Cit-art.title is the Title of the article and Cit-art.authors are the authors of the article. The "from" field is used to indicate the medium the article was published in, and reuses the standard definitions for citing a journal, book, or proceedings.
\par In the C structure, CitArt.from gives the type of medium published in, and CitArt.fromptr must be cast appropriately to CitJourPtr or CitBookPtr (proceedings uses the same structure as book).
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430342}{\*\bkmkstart _Toc294430819}{\*\bkmkstart _Toc300649219}Citing a Journal{\*\bkmkend _Toc294430342}{\*\bkmkend _Toc294430819}{\*\bkmkend _Toc300649219}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Cit-jour is used to cite an issue of a journal, not an article within a journal (see Cit-art, above). Cit-jour.title is the title of the journal, and Cit-jour.imp gives the date, volume, issue of the journal.  Cit-jour.imp also gives the pages of an article within the issue when used as part of a Cit-art.  This is not the purest possible split between article and journal, book, or proceedings, but does have the practical advantage of putting all such physical medium information together in a single common data structure.  A controlled list of journal titles is maintained by NCBI, and database builders are encouraged to use this list to facilitate exchange and linking of data between databases.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430343}{\*\bkmkstart _Toc294430820}{\*\bkmkstart _Toc300649220}Citing a Book{\*\bkmkend _Toc294430343}{\*\bkmkend _Toc294430820}{\*\bkmkend _Toc300649220}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Cit-book is used to cite a whole book, not an article within a book (see Cit-art, above). Cit-book.title is the title of this particular book. Cit-book.coll is used if the book if part of a collection, or muti-volume set (e.g. "The Complete Works of Charles Darwin"). Cit-book.authors is for the authors or editors of the book itself (not necessarily of any particular chapter). Cit-book.imp contains the publication information about the book.  As with a Cit-art, if the Cit-book is being used to cite a chapter in a book, the pages in given in Cit-book.imp.
\par In the C structure, CitBook is used for Cit-book, Cit-proc, and Cit-let, since they have most fields in common. If CitBook.othertype is 0, it is just a Cit-book.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430344}{\*\bkmkstart _Toc294430821}{\*\bkmkstart _Toc300649221}Citing a Proceedings{\*\bkmkend _Toc294430344}{\*\bkmkend _Toc294430821}{\*\bkmkend _Toc300649221}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A proceedings is a book published as a result or byproduct of a meeting.  As such it contains all the same fields as a Cit-book and an additional block of information describing the meeting.  These extra fields are the meeting number (as a string to accommodate things like "10A"), the date the meeting occurred, and an OPTIONAL Affil to record the place of the meeting.  The name of the organization or meeting is normally the book title.  Don't be confused by things like the Proceedings of the National Academy of Sciences, USA, which is really a journal.
\par In the C structure, a CitBook is used, with CitBook.othertype set to 1.  CitBook.otherdata contains a ValNodePtr.  The proceedings can have up to 3 ValNodes where the ValNode.choice indicates the component of the Meeting information, and ValNode.data.ptrvalue contains a pointer to the appropriate data as below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {*     choice       ASN.1 field      Pointer type
\par *       1          number           CharPtr
\par *       2          date             DatePtr
\par *       3          place            AffilPtr
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {There are separate CitProcAsnRead() and CitProcAsnWrite() functions.  A proceedings reuses the parent class CitBookNew() and CitBookFree() functions.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430345}{\*\bkmkstart _Toc294430822}{\*\bkmkstart _Toc300649222}Citing a Letter, Manuscript, or Thesis{\*\bkmkend _Toc294430345}{\*\bkmkend _Toc294430822}{\*\bkmkend _Toc300649222}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A letter, manuscript, or a thesis share most components and so are grouped together under Cit\_let. They all require most of the attributes of a book, and thus Cit\_let incorporates the Cit\_book structure.  Unlike a normal book, they will not have a copyright date.  A letter or manuscript will not have a publisher, although a thesis may.  In addition, a manuscript may have a manuscript identifier (e.g. "Technical Report X1134").\-
\par }\pard \sb240\widctlpar\adjustright {The CitBook C structure is reused for Cit\_let.  The CitBook.othertype is 2.  CitBook.let_type is used to indicate if it is a letter, manuscript, or thesis. If it is a manuscript, then CitBook.otherdata is a CharPtr which may be NULL, or point to a string with the manuscript-id.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430346}{\*\bkmkstart _Toc294430823}{\*\bkmkstart _Toc300649223}Citing Directly Submitted Data{\*\bkmkend _Toc294430346}{\*\bkmkend _Toc294430823}{\*\bkmkend _Toc300649223}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This form is used to cite the submission of data directly to a database, independent of any publication(s) which may be associated with the data as well. Authors (of the submission) and Date (in an Imprint) are required.  The Affiliation of the Authors should be filled in the Author-list. Optionally one may also record the medium in which the submission was made.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430347}{\*\bkmkstart _Toc294430824}{\*\bkmkstart _Toc300649224}Citing a Patent{\*\bkmkend _Toc294430347}{\*\bkmkend _Toc294430824}{\*\bkmkend _Toc300649224}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A full patent citation, Cit-pat conveys not only enough information to identify a patent (see below) but to characterize it somewhat as well.  A patent has a title and authors, the country in which the patent was issued, a document type and number, and the date the patent was issued.  Patents are grouped into classes based on the patent subject, and this may be useful to know. In addition, when a patent is first filed it is issued an application number (different from the document number assigned to the issued patent).  For tracking purposes, or issues of precedence, it is also helpful to know the application number and filing date.
\par The C structure, CitPat, is a straightforward mapping of the Cit-pat fields.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430348}{\*\bkmkstart _Toc294430825}{\*\bkmkstart _Toc300649225}Identifying a Patent{\*\bkmkend _Toc294430348}{\*\bkmkend _Toc294430825}{\*\bkmkend _Toc300649225}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {When citing a patent, it may be sufficient to merely unambiguously identify it, on the assumption that more extensive information will be available from some other source, given the identifier.  Id-pat thus contains fields only for the country in which the patent was applied for, or issued in, then a CHOICE of the patent document number (if issued) or the application number (if pending).
\par The C structure, IdPat, is a straightforward mapping the Id-pat fields.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430349}{\*\bkmkstart _Toc294430826}{\*\bkmkstart _Toc300649226}Citing an Article or Book which is In Press{\*\bkmkend _Toc294430349}{\*\bkmkend _Toc294430826}{\*\bkmkend _Toc300649226}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A number of the fields in Cit-art and Cit-book are OPTIONAL, not only to allow incorporation of older, incomplete databases, but also to allow partial information for works submitted, or in press.  One simply fills in as many of the fields in Cit-art or Cit-book as possible.  One must also set the "pre-pub" flag in Imprint to the appropriate status.  That's it.  Once the work is published, the remaining information is filled in and the "pre-pub" flag is removed.  NOTE: this does NOT apply to work which is "unpublished" or "personal communication", or even "in preparation" because one knows nothing about where or when (or if) it will ever be published.  One must use a Cit-gen for this (below).
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430350}{\*\bkmkstart _Toc294430827}{\*\bkmkstart _Toc300649227}Special Cases: Unpublished, Unparsed, or Unusual{\*\bkmkend _Toc294430350}{\*\bkmkend _Toc294430827}{\*\bkmkend _Toc300649227}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A generic citation, Cit-gen, is used to hold anything not fitting into the more usual bibliographic entities described above.  Cit-gen.cit is a string which can hold a unparsable citation (if you can parse it into a structured type, you should). Sometimes it possible to parse some things but not everything.  In this case, a number of fields, such as authors, journal, etc., which are similar to those in the structured types, can be populated as much as possible, and the remainder of the unparsed string can go in "cit".
\par Less standard citation types, such as a MEDLINE unique identifier, or the serial numbers used in the GenBank flatfile can be accommodated by Cit-gen. An unpublished citation normally has authors and date filled into the structured fields.  Often a title is available as well (e.g. for a talk or for a manuscript in preparation). The string "unpublished" can then appear in the "cit" field.
\par Software developed to display or print a Cit-gen must be opportunistic about using whatever information is available.  Obviously it is not possible to assume that all Cit-gens can be displayed in a uniform manner, but in practice at NCBI we have found they can generally be made fairly regular.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430351}{\*\bkmkstart _Toc294430828}{\*\bkmkstart _Toc300649228}Accommodating Any Publication Type{\*\bkmkend _Toc294430351}{\*\bkmkend _Toc294430828}{\*\bkmkend _Toc300649228}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Pub is the bibliographic object base class. It can accommodate a citation of any kind defined in the bibliographic specification, the MEDLINE specification, and more. It is very useful when one wishes to be able to associate a bibliographic reference in a very general way with a software tool or data item, yet still preserve the attributes specific for each class of citation.  Pub is widely used for this purpose in the NCBI specifications.
\par The C structures implement a Pub as a ValNode, where the choice gives the publication type and, in most cases, data.ptrvalue is a pointer to the appropriate data structure (and must be cast to the appropriate type for further use). The exception is for MEDLINE uid, which uses the data.intvalue field. The values are listed in objpub.h.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430352}{\*\bkmkstart _Toc294430829}{\*\bkmkstart _Toc300649229}Grouping Different Forms of Citation for a Single Work{\*\bkmkend _Toc294430352}{\*\bkmkend _Toc294430829}{\*\bkmkend _Toc300649229}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In some cases a database builder may wish to present more than one form of citation for the same bibliographic work. For example, in a sequence entry from the NCBI Backbone database, it is useful to provide the MEDLINE uid (for use as a link by other software tools), the Cit-art (for display to the user), and a Cit-gen containing the internal NCBI Backbone identifier for this publication as the string "pub_id = 188824" (for use in checking the database by in-house staff) for the same article. The Pub-equiv provides this capacity. It is a SET OF Pub. Each element in the SET is an equivalent citation for the same bibliographic work.  Software can examine the SET and select the form most appropriate to the job at hand.
\par A Pub-equiv is implemented as a linked list of ValNodes, where each ValNode is a Pub as described above. NOTE: a Pub of type Pub-equiv is a ValNode whose choice indicates pub-equiv and whose data.ptrvalue is the head of the linked list of ValNodes.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430353}{\*\bkmkstart _Toc294430830}{\*\bkmkstart _Toc300649230}Sets of Citations{\*\bkmkend _Toc294430353}{\*\bkmkend _Toc294430830}{\*\bkmkend _Toc300649230}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {One often needs to collect a set of citations together.  Unlike the Pub-equiv (above), a Pub-set is a set of citations for DIFFERENT bibliographic works. It is a CHOICE of types for a mixture of publication classes, or for a collection of the same publication class.
\par A Pub-set is implemented as a ValNode, where the choice gives the type of the Pub-set and data.ptrvalue points to a linked list of ValNodes. The ValNodes are necessary to create the linked list. For convenience then, the choice of each ValNode is set appropriately for the type of bibliographic object it holds. This is only technically necessary for Pub-set of type "pub", but since it costs nothing all classes of Pub-set are done the same way.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430354}{\*\bkmkstart _Toc294430831}{\*\bkmkstart _Toc300649231}Comparing Citations{\*\bkmkend _Toc294430354}{\*\bkmkend _Toc294430831}{\*\bkmkend _Toc300649231}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Common question is whether two citations refer to same the publication. Note that this does not necessarily mean they are identical. For example a Medline-entry may refer to the same article as a Cit-art or a simple MEDLINE uid type of Pub. A series of xxxMatch() functions make this determination. Like strcmp() they return 0 if the two arguments refer to the same publication, 1 if the second argument comes after the first, or -1 if the first argument comes after the second. When possible, the ordering is based on some rational attribute of that Pub type, such as MEDLINE uid order. However, particularly when comparing different types of Pubs, the ordering is arbitrary, but unique. Thus the xxxMatch() functions can be used to sort various kinds of Pubs in the same list, or to locate Pubs in such an ordered list by binary search.
\par The most general function is PubMatch(a,b), which compares two Pubs of any type. PubEquivMatch(a,b) compares two PubEquivs only, CitArtMatch(a,b) compares two CitArts only, and so on.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430355}{\*\bkmkstart _Toc294430832}{\*\bkmkstart _Toc300649232}ASN.1 Specification: biblio.asn{\*\bkmkend _Toc294430355}{\*\bkmkend _Toc294430832}{\*\bkmkend _Toc300649232}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --****************************************************************
\par --
\par --  NCBI Bibliographic data elements
\par --  by James Ostell, 1990
\par --
\par --  Taken from the American National Standard for
\par --      Bibliographic References
\par --      ANSI Z39.29-1977
\par --
\par --****************************************************************
\par 
\par NCBI-Biblio DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Cit-art, Cit-jour, Cit-book, Cit-pat, Cit-let, Id-pat, Cit-gen,
\par \tab \tab Cit-proc, Cit-sub;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {IMPORTS Person-id, Date FROM NCBI-General;
\par 
\par     -- Citation Types
\par 
\par Cit-art ::= SEQUENCE \{                  -- article in journal or book
\par     title Title OPTIONAL ,              -- title of paper (ANSI requires)
\par     authors Auth-list OPTIONAL ,        -- authors (ANSI requires)
\par     from CHOICE \{                       -- journal or book
\par         journal Cit-jour ,
\par         book Cit-book ,
\par         proc Cit-proc \} \}
\par 
\par Cit-jour ::= SEQUENCE \{             -- Journal citation
\par     title Title ,                   -- title of journal
\par     imp Imprint \}
\par 
\par Cit-book ::= SEQUENCE \{              -- Book citation
\par     title Title ,                    -- Title of book
\par     coll Title OPTIONAL ,            -- part of a collection
\par     authors Auth-list,               -- authors
\par     imp Imprint \}
\par 
\par Cit-proc ::= SEQUENCE \{             -- Meeting proceedings
\par     book Cit-book ,                 -- citation to meeting
\par     meet Meeting \}                  -- time and location of meeting
\par     
\par Cit-pat ::= SEQUENCE \{                  -- patent citation
\par     title VisibleString ,
\par     authors Auth-list,                  -- authors
\par     country VisibleString ,             -- Patent Document Country
\par     doc-type VisibleString ,            -- Patent Document Type
\par     number VisibleString ,              -- Patent Document Number
\par     date-issue Date ,                   -- Patent-Issue Date
\par     class VisibleString OPTIONAL ,      -- Patent Doc Class Code 
\par     app-number VisibleString OPTIONAL , -- Patent Doc Appl Number
\par     app-date Date OPTIONAL \}            -- Patent Appl File Date
\par 
\par Id-pat ::= SEQUENCE \{                   -- just to identify a patent
\par     country VisibleString ,             -- Patent Document Country
\par     id CHOICE \{
\par         number VisibleString ,          -- Patent Document Number
\par         app-number VisibleString \} \}    -- Patent Doc Appl Number
\par 
\par Cit-let ::= SEQUENCE \{                  -- letter, thesis, or manuscript
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    cit Cit-book ,                      -- same fields as a book
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    man-id VisibleString OPTIONAL ,     -- Manuscript identifier
\par     type ENUMERATED \{
\par         manuscript (1) ,
\par         letter (2) ,
\par         thesis (3) \} OPTIONAL \}
\par                                 -- NOTE: this is just to cite a
\par                                 -- direct data submission, see NCBI-Submit
\par                                 -- for the form of a sequence submission
\par Cit-sub ::= SEQUENCE \{               -- citation for a direct submission
\par     authors Auth-list ,              -- not necessarily authors of the paper
\par     imp Imprint ,
\par     medium ENUMERATED \{              -- medium of submission
\par         paper   (1) ,
\par         tape    (2) ,
\par         floppy  (3) ,
\par         email   (4) ,
\par         other   (255) \} OPTIONAL \}
\par     
\par Cit-gen ::= SEQUENCE \{      -- NOT from ANSI, this is a catchall
\par     cit VisibleString OPTIONAL ,     -- anything, not parsable
\par     authors Auth-list OPTIONAL ,
\par     muid INTEGER OPTIONAL ,      -- medline uid
\par     journal Title OPTIONAL ,
\par     volume VisibleString OPTIONAL ,
\par     issue VisibleString OPTIONAL ,
\par     pages VisibleString OPTIONAL ,
\par     date Date OPTIONAL ,
\par     serial-number INTEGER OPTIONAL ,   -- for GenBank style references
\par \tab title VisibleString OPTIONAL \}     -- eg. cit="unpublished",title="title"
\par     
\par     
\par     -- Authorship Group
\par Auth-list ::= SEQUENCE \{
\par         names CHOICE \{
\par             std SEQUENCE OF Author ,        -- full citations
\par             ml SEQUENCE OF VisibleString ,  -- MEDLINE, semi-structured
\par             str SEQUENCE OF VisibleString \} , -- free for all
\par         affil Affil OPTIONAL \}        -- author affiliation
\par 
\par Author ::= SEQUENCE \{
\par     name Person-id ,                        -- Author, Primary or Secondary
\par     level ENUMERATED \{
\par         primary (1),
\par         secondary (2) \} OPTIONAL ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    role ENUMERATED \{                   -- Author Role Indicator
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        compiler (1),
\par         editor (2),
\par         patent-assignee (3),
\par         translator (4) \} OPTIONAL ,
\par     affil Affil OPTIONAL ,
\par \tab is-corr BOOLEAN OPTIONAL \}          -- TRUE if corressponding author
\par 
\par Affil ::= CHOICE \{
\par     str VisibleString ,                 -- unparsed string
\par     std SEQUENCE \{                      -- std representation
\par     affil VisibleString OPTIONAL ,      -- Author Affiliation, Name
\par     div VisibleString OPTIONAL ,        -- Author Affiliation, Division
\par     city VisibleString OPTIONAL ,       -- Author Affiliation, City
\par     sub VisibleString OPTIONAL ,        -- Author Affiliation, County Sub
\par     country VisibleString OPTIONAL ,    -- Author Affiliation, Country
\par \tab street VisibleString OPTIONAL \}\}    -- street address, not ANSI
\par 
\par     -- Title Group
\par     -- Valid for = A = Analytic (Cit-art)
\par     --             J = Journals (Cit-jour)
\par     --             B = Book (Cit-book)
\par                                                  -- Valid for:
\par Title ::= SET OF CHOICE \{
\par     name VisibleString ,    -- Title, Anal,Coll,Mono    AJB
\par     tsub VisibleString ,    -- Title, Subordinate       A B
\par     trans VisibleString ,   -- Title, Translated        AJB
\par     jta VisibleString ,     -- Title, Abbreviated        J
\par     iso-jta VisibleString , -- specifically ISO jta      J
\par     ml-jta VisibleString ,  -- specifically MEDLINE jta  J
\par     coden VisibleString ,   -- a coden                   J
\par     issn VisibleString ,    -- ISSN                      J
\par     abr VisibleString ,     -- Title, Abbreviated         B
\par     isbn VisibleString \}    -- ISBN                       B
\par 
\par Imprint ::= SEQUENCE \{                  -- Imprint group
\par     date Date ,                         -- date of publication
\par     volume VisibleString OPTIONAL ,
\par     issue VisibleString OPTIONAL ,
\par     pages VisibleString OPTIONAL ,
\par     section VisibleString OPTIONAL ,
\par     pub Affil OPTIONAL,                     -- publisher, required for book
\par     cprt Date OPTIONAL,                     -- copyright date, "    "   "
\par     part-sup VisibleString OPTIONAL ,       -- used in MEDLINE
\par     language VisibleString DEFAULT "ENG" ,  -- put here for simplicity
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab prepub ENUMERATED \{                     -- for prepublication citaions
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab submitted (1) ,                     -- submitted, not accepted
\par \tab \tab in-press (2) ,\tab \tab \tab -- accepted, not published
\par \tab \tab other (255)  \} OPTIONAL \}
\par 
\par Meeting ::= SEQUENCE \{
\par     number VisibleString ,
\par     date Date ,
\par     place Affil OPTIONAL \}
\par 
\par             
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430356}{\*\bkmkstart _Toc294430833}{\*\bkmkstart _Toc300649233}C Structures and Functions: objbibli.h{\*\bkmkend _Toc294430356}{\*\bkmkend _Toc294430833}{\*\bkmkend _Toc300649233}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objbibli.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objbibli.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 1/1/91
\par *
\par * $Revision: 2.1 $
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* File Description:  Object manager interface for module NCBI-Biblio
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Biblio_
\par #define _NCBI_Biblio_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean BiblioAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   Affil
\par *
\par *****************************************************************************/
\par typedef struct affil \{
\par \tab Uint1 choice;           /* [1]=str,[2]=std */
\par \tab CharPtr affil,          /* also used for str */
\par \tab \tab div,
\par \tab \tab city,
\par \tab \tab sub,
\par \tab \tab country,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab street;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} Affil, PNTR AffilPtr;
\par 
\par extern AffilPtr AffilNew PROTO((void));
\par extern AffilPtr AffilFree PROTO((AffilPtr afp));
\par extern AffilPtr AffilAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean AffilAsnWrite PROTO((AffilPtr afp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   AuthList
\par *
\par *****************************************************************************/
\par typedef struct authors \{
\par \tab Uint1 choice;        /* [1]=std, [2]=ml, [3]=str (only on Cit-art,gen) */
\par \tab ValNodePtr names;    /* the SEQUENCE OF */
\par \tab AffilPtr affil;
\par \} AuthList, PNTR AuthListPtr;
\par 
\par extern AuthListPtr AuthListNew PROTO((void));
\par extern AuthListPtr AuthListFree PROTO((AuthListPtr asp));
\par extern AuthListPtr AuthListAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean AuthListAsnWrite PROTO((AuthListPtr afp, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 AuthListMatch PROTO((AuthListPtr a, AuthListPtr b, Boolean all));
\par 
\par /*****************************************************************************
\par *
\par *   Author
\par *
\par *****************************************************************************/
\par typedef struct author \{
\par \tab PersonIdPtr name;
\par \tab Uint1 lr[2];       /* level[0], role[1] as in spec. 0=not used */
\par \tab Uint1 is_corr;     /* corresponding author? 255=not set, 0=false, 1=true */
\par \tab AffilPtr affil;
\par \} Author, PNTR AuthorPtr;
\par 
\par extern AuthorPtr AuthorNew PROTO((void));
\par extern AuthorPtr AuthorFree PROTO((AuthorPtr ap));
\par extern AuthorPtr AuthorAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean AuthorAsnWrite PROTO((AuthorPtr ap, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-art
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par typedef struct citart \{
\par \tab ValNodePtr title;       /* choice[1]=name,[2]=tsub,[3]=trans */
\par \tab AuthListPtr authors;
\par \tab Uint1 from;             /* [1]=journal,[2]=book,[3]=proc */
\par \tab Pointer fromptr;
\par \} CitArt, PNTR CitArtPtr;
\par 
\par extern CitArtPtr CitArtNew PROTO((void));
\par extern CitArtPtr CitArtFree PROTO((CitArtPtr cap));
\par extern CitArtPtr CitArtAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitArtAsnWrite PROTO((CitArtPtr cap, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 CitArtMatch PROTO((CitArtPtr a, CitArtPtr b));
\par 
\par /*****************************************************************************
\par *
\par *   Imprint
\par *
\par *****************************************************************************/
\par typedef struct imprint \{
\par \tab DatePtr date;
\par     CharPtr volume,
\par         issue,
\par         pages,
\par         section,
\par         part_sup,
\par         language;
\par     DatePtr cprt;     /* copy right date (for books) */
\par     AffilPtr pub;   /* publisher (for books)  */
\par \tab Uint1 prepub;   /* 0=not set 1=submitted 2=in-press 255=other */
\par \} Imprint, PNTR ImprintPtr;
\par 
\par extern ImprintPtr ImprintNew PROTO((void));
\par extern ImprintPtr ImprintFree PROTO((ImprintPtr cap));
\par extern ImprintPtr ImprintAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean ImprintAsnWrite PROTO((ImprintPtr cap, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 ImprintMatch PROTO((ImprintPtr a, ImprintPtr b, Boolean all));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-jour
\par *
\par *****************************************************************************/
\par typedef struct citjour \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab ValNodePtr title;     /* choice in order of spec, 1=name,2=trans,etc */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab ImprintPtr imp;
\par \} CitJour, PNTR CitJourPtr;
\par 
\par extern CitJourPtr CitJourNew PROTO((void));
\par extern CitJourPtr CitJourFree PROTO((CitJourPtr cjp));
\par extern CitJourPtr CitJourAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitJourAsnWrite PROTO((CitJourPtr cjp, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 CitJourMatch PROTO((CitJourPtr a, CitJourPtr b));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-book
\par *
\par *****************************************************************************/
\par typedef struct citbook \{
\par \tab ValNodePtr title,      /* choice in order of spec, 1=name, 2=tsub, etc */
\par \tab \tab \tab    coll;       /* ditto */
\par \tab AuthListPtr authors;
\par \tab ImprintPtr imp;
\par \tab Uint1 othertype,      /* 0=Cit-book, 1=Cit-proc, 2=Cit-let */
\par \tab \tab let_type;         /* if Cit-let, 1=manuscript,2=letter,3=thesis */
\par \tab Pointer otherdata;    /* NULL,  ValNodes, CharPtr man-id */
\par \} CitBook, PNTR CitBookPtr;
\par 
\par extern CitBookPtr CitBookNew PROTO((void));
\par extern CitBookPtr CitBookFree PROTO((CitBookPtr cbp));
\par extern CitBookPtr CitBookAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitBookAsnWrite PROTO((CitBookPtr cbp, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 CitBookMatch PROTO((CitBookPtr a, CitBookPtr b));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-sub
\par *   \tab Direct submission of data
\par *
\par *****************************************************************************/
\par typedef struct citsub \{
\par \tab AuthListPtr authors;
\par \tab ImprintPtr imp;
\par \tab Uint1 medium;
\par \} CitSub, PNTR CitSubPtr;
\par 
\par extern CitSubPtr CitSubNew PROTO((void));
\par extern CitSubPtr CitSubFree PROTO((CitSubPtr cbp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern CitSubPtr CitSubAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern Boolean CitSubAsnWrite PROTO((CitSubPtr cbp, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 CitSubMatch PROTO((CitSubPtr a, CitSubPtr b));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   Cit-proc
\par *     uses otherdata in Cit-book
\par *     chain of ValNodes
\par *     choice       ident      Pointer type
\par *       1          number      CharPtr
\par *       2          date        DatePtr
\par *       3          place       AffilPtr
\par *
\par *****************************************************************************/
\par extern CitBookPtr CitProcAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitProcAsnWrite PROTO((CitBookPtr cpp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-let
\par *     uses otherdata in Cit-book as CharPtr for man-id
\par *
\par *****************************************************************************/
\par extern CitBookPtr CitLetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitLetAsnWrite PROTO((CitBookPtr cpp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par 
\par 
\par /*****************************************************************************
\par *
\par *   Cit-pat
\par *
\par *****************************************************************************/
\par typedef struct citpat \{
\par \tab CharPtr title;
\par \tab AuthListPtr authors;
\par \tab CharPtr country,
\par \tab \tab doc_type,
\par \tab \tab number;
\par \tab DatePtr date_issue;
\par \tab CharPtr _class,
\par \tab \tab app_number;
\par \tab DatePtr app_date;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} CitPat, PNTR CitPatPtr;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par extern CitPatPtr CitPatNew PROTO((void));
\par extern CitPatPtr CitPatFree PROTO((CitPatPtr cpp));
\par extern CitPatPtr CitPatAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean CitPatAsnWrite PROTO((CitPatPtr cpp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Id-pat
\par *
\par *****************************************************************************/
\par typedef struct idpat \{
\par \tab CharPtr country,
\par \tab \tab number,\tab \tab \tab \tab  /** actually CHOICE of number or app_number */
\par \tab \tab app_number;
\par \} IdPat, PNTR IdPatPtr;
\par 
\par extern IdPatPtr IdPatNew PROTO((void));
\par extern IdPatPtr IdPatFree PROTO((IdPatPtr ipp));
\par extern IdPatPtr IdPatAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean IdPatAsnWrite PROTO((IdPatPtr ipp, AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean IdPatMatch PROTO((IdPatPtr a, IdPatPtr b));
\par 
\par /*****************************************************************************
\par *
\par *   Cit-gen
\par *
\par *****************************************************************************/
\par typedef struct cit_gen \{
\par \tab CharPtr cit;
\par \tab AuthListPtr authors;
\par     Int4 muid;                  /* medline uid, -1 if not set */
\par     ValNodePtr journal;         /* journal/book Title */
\par     CharPtr volume,
\par         issue,
\par         pages;
\par \tab DatePtr date;
\par     Int2 serial_number;      /* for GenBank style references (-1 = not used)*/
\par \tab CharPtr title;           /* a specific title (in addition to cit or journal) */
\par \} CitGen, PNTR CitGenPtr;
\par 
\par extern CitGenPtr CitGenNew PROTO((void));
\par extern CitGenPtr CitGenFree PROTO((CitGenPtr cgp));
\par extern CitGenPtr CitGenAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern Boolean CitGenAsnWrite PROTO((CitGenPtr cgp, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Int2 CitGenMatch PROTO((CitGenPtr a, CitGenPtr b, Boolean all));
\par 
\par /*****************************************************************************
\par *
\par *   Title
\par *
\par *****************************************************************************/
\par 
\par extern ValNodePtr TitleFree PROTO((ValNodePtr anp));
\par extern ValNodePtr TitleAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean TitleAsnWrite PROTO((ValNodePtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par Int2 TitleMatch PROTO((ValNodePtr a, ValNodePtr b, Uint1 type));
\par 
\par #define Cit_title_name ( (Uint1) 1)
\par #define Cit_title_tsub ( (Uint1) 2)
\par #define Cit_title_trans ( (Uint1) 3)
\par #define Cit_title_jta ( (Uint1) 4)
\par #define Cit_title_iso_jta ( (Uint1) 5)
\par #define Cit_title_ml_jta ( (Uint1) 6)
\par #define Cit_title_coden ( (Uint1) 7)
\par #define Cit_title_issn ( (Uint1) 8)
\par #define Cit_title_abr ( (Uint1) 9)
\par #define Cit_title_isbn ( (Uint1) 10)
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430357}{\*\bkmkstart _Toc294430834}{\*\bkmkstart _Toc300649234}ASN.1 Specification: pub.asn{\*\bkmkend _Toc294430357}{\*\bkmkend _Toc294430834}{\*\bkmkend _Toc300649234}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --********************************************************************
\par --
\par --  Publication common set
\par --  James Ostell, 1990
\par --
\par --  This is the base class definitions for Publications of all sorts
\par --
\par --********************************************************************
\par 
\par NCBI-Pub DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Pub, Pub-set, Pub-equiv;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {IMPORTS Medline-entry FROM NCBI-Medline
\par         Cit-art, Cit-jour, Cit-book, Cit-proc, Cit-pat, Id-pat, Cit-gen,
\par         Cit-let, Cit-sub FROM NCBI-Biblio;
\par 
\par Pub ::= CHOICE \{
\par     gen Cit-gen ,        -- general or generic unparsed
\par     sub Cit-sub ,        -- submission
\par     medline Medline-entry ,
\par     muid INTEGER ,       -- medline uid
\par     article Cit-art ,
\par     journal Cit-jour ,
\par     book Cit-book ,
\par     proc Cit-proc ,      -- proceedings of a meeting
\par     patent Cit-pat ,
\par     pat-id Id-pat ,      -- identify a patent
\par     man Cit-let ,        -- manuscript, thesis, or letter
\par     equiv Pub-equiv \}    -- to cite a variety of ways
\par 
\par Pub-equiv ::= SET OF Pub   -- equivalent identifiers for same citation
\par 
\par Pub-set ::= CHOICE \{
\par     pub SET OF Pub ,
\par     medline SET OF Medline-entry ,
\par     article SET OF Cit-art ,
\par     journal SET OF Cit-jour ,
\par     book SET OF Cit-book ,
\par     proc SET OF Cit-proc ,      -- proceedings of a meeting
\par     patent SET OF Cit-pat \}
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430358}{\*\bkmkstart _Toc294430835}{\*\bkmkstart _Toc300649235}C Structures and Functions: objpub.h{\*\bkmkend _Toc294430358}{\*\bkmkend _Toc294430835}{\*\bkmkend _Toc300649235}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objpub.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  Although all reasonable efforts have been taken to ensure the accuracy  
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objpub.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.1 $
\par *
\par * File Description:  Object manager interface for module NCBI-Pub
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Pub_
\par #define _NCBI_Pub_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_Biblio_
\par #include <objbibli.h>
\par #endif
\par #ifndef _NCBI_Medline_
\par #include <objmedli.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern "C" \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean PubAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-Pub objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   Pub is a choice using an ValNode, most types in data.ptrvalue
\par *   choice:
\par *   0 = not set
\par     1 = gen Cit-gen ,        -- general or generic unparsed
\par     2 = sub Cit-sub ,        -- submission
\par     3 = medline Medline-entry ,
\par     4 = muid INTEGER ,       -- medline uid (stored in data.intvalue)
\par     5 = article Cit-art ,
\par     6 = journal Cit-jour ,
\par     7 = book Cit-book ,
\par     8 = proc Cit-proc ,      -- proceedings of a meeting
\par     9 = patent Cit-pat ,
\par     10 = pat-id Id-pat ,      -- identify a patent
\par     11 = man Cit-let         -- manuscript or letter
\par     12 = equiv Pub-equiv      -- set of equivalent citation forms for 1 pub
\par *
\par *****************************************************************************/
\par Boolean PubAsnWrite PROTO((ValNodePtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr PubAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr PubFree PROTO((ValNodePtr anp));
\par 
\par #define PUB_Gen 1
\par #define PUB_Sub 2
\par #define PUB_Medline 3
\par #define PUB_Muid 4
\par #define PUB_Article 5
\par #define PUB_Journal 6
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define PUB_Book 7
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define PUB_Proc 8
\par #define PUB_Patent 9
\par #define PUB_Pat_id 10
\par #define PUB_Man 11
\par #define PUB_Equiv 12
\par /****
\par *  Pub and PubEquiv Matching functions (same citation, not same form)
\par *   PubMatch() returns
\par *   \tab 0 = point to same citation
\par *       1,-1 = same pub type, but different
\par *       2,-2 = different put types, don't match
\par *   PubEquivMatch() returns
\par *   \tab 0 = point to same citation
\par *   \tab 1,-1 = point to different citations
\par *****/
\par Int2 PubMatch PROTO((ValNodePtr a, ValNodePtr b));
\par Int2 PubEquivMatch PROTO((ValNodePtr a, ValNodePtr b));
\par 
\par /*****************************************************************************
\par *
\par *   PubSet is a choice using an ValNode, PubSet->data.ptrvalue is chain of
\par *       Pubs (ValNodes) holding data for set for all types.
\par *   PubSet->choice:
\par *   0 = not set
\par     1 = pub Pub    -- set of real Pubs
\par                    -- the rest are implemented as Pubs anyway
\par     3 = medline Medline-entry ,
\par     5 = article Cit-art ,
\par     6 = journal Cit-jour ,
\par     7 = book Cit-book ,
\par     8 = proc Cit-proc ,      -- proceedings of a meeting
\par     9 = patent Cit-pat ,
\par *
\par *****************************************************************************/
\par Boolean PubSetAsnWrite PROTO((ValNodePtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr PubSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr PubSetFree PROTO((ValNodePtr anp));
\par 
\par /*****************************************************************************
\par *
\par *   PubEquiv is just a chain of Pubs (ValNodes)
\par *
\par *****************************************************************************/
\par Boolean PubEquivAsnWrite PROTO((ValNodePtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ValNodePtr PubEquivAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ValNodePtr PubEquivFree PROTO((ValNodePtr anp));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 140}}}{\b0 \tab MEDLINE}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 MEDLINE   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 141}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {include medline.doc}}{\fldrslt {{\*\bkmkstart _Toc294430359}{\*\bkmkstart _Toc294430836}{\*\bkmkstart _Toc300649236}MEDLINE Data{\*\bkmkend _Toc294430359}{\*\bkmkend _Toc294430836}{\*\bkmkend _Toc300649236}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430360}{\*\bkmkstart _Toc294430837}{\*\bkmkstart _Toc300649237}Introduction{\*\bkmkend _Toc294430360}{\*\bkmkend _Toc294430837}{\*\bkmkend _Toc300649237}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {MEDLINE is the largest and oldest biomedical database in the world. It is built at the National Library of Medicine (NLM), a part of NIH. At this writing it contains over seven million citations from the scientific literature from over 3500 different journals. MEDLINE is a bibliographic database. It contains citation information (e.g. title, authors, journal, etc.). Many entries contain the abstract from the article. All articles are carefully indexed by professionals according to formal guidelines in a variety of ways. All entries can be uniquely identified by an integer key, the MEDLINE unique identifier (MEDLINE uid).
\par MEDLINE is a valuable resource in its own right. In addition, the MEDLINE uid can serve as a valuable link between entries in factual databases. When NCBI processes a new molecular biology factual database into the standardized format, we also normalize the bibliographic citations and attempt to map them to MEDLINE. For the biomedical databases we have tried thus far, we have succeeding in mapping most or all of the citations this way. From then on, linkage to other data objects can be made simply and easily through the share MEDLINE uid. The MEDLINE uid also allows movement from the data item to the world of scientific literature in general and back.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430361}{\*\bkmkstart _Toc294430838}{\*\bkmkstart _Toc300649238}Structure of a MEDLINE Entry{\*\bkmkend _Toc294430361}{\*\bkmkend _Toc294430838}{\*\bkmkend _Toc300649238}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Each Medline-entry represents a single article from the scientific literature. The MEDLINE uid is an INTEGER which uniquely identifies the entry. If corrections are made to the contents of the entry, the uid is not changed. The MEDLINE uid is the simplest and most reliable way to identify the entry.
\par The entry-month is the month and year in which the entry became part of the public view of MEDLINE. It is not the same as the date the article was published. It is mostly useful for tracking what is new since a previous query of MEDLINE.
\par The article citation itself is contained in a standard Cit-art, imported from the bibliographic module, so will not be discussed further here. The entry often contains the abstract from the article.  The rest of the entry consists of various index terms, which will be discussed below.
\par The C implementation of a MedlineEntry is straightforward.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430362}{\*\bkmkstart _Toc294430839}{\*\bkmkstart _Toc300649239}MeSH Index Terms{\*\bkmkend _Toc294430362}{\*\bkmkend _Toc294430839}{\*\bkmkend _Toc300649239}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Medical Subject Heading (MeSH) terms are a tree of controlled vocabulary maintained by the Library Operations division of NLM. The tree is arranged with parent terms above more specialized terms within the same concept. An entry in MEDLINE is indexed by the most specific MeSH term(s) available. Since the MeSH vocabulary is a tree, one may then query on specific terms directly, or on general terms by including all the child terms in the query as well.
\par A MeSH term may be qualified by one or more sub-headings. For example, the MeSH term "insulin" may carry quite a different meaning if qualified by "clinical trials" versus being qualified by "genetics".
\par A MeSH term or a sub-heading may be flagged as indicating the "main point" of the article. Again the most specific form is used. If the main point of the article was about insulin and they also discuss genetics, then the insulin MeSH term will be flagged but the genetics sub-heading will not be. However, if the main point of the article was the genetics of insulin, then the sub-heading genetics under the MeSH term insulin will be flagged but the MeSH term itself will not be.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430363}{\*\bkmkstart _Toc294430840}{\*\bkmkstart _Toc300649240}Substance Records{\*\bkmkend _Toc294430363}{\*\bkmkend _Toc294430840}{\*\bkmkend _Toc300649240}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If an article has substantial discussion of recognizable chemical compounds, they are indexed in the substance records. The record may contain only the name of the compound, or it may contain the name and a Chemical Abstracts Service (CAS) registry number or a Enzyme Commission (EC) number as appropriate.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430364}{\*\bkmkstart _Toc294430841}{\*\bkmkstart _Toc300649241}Database Cross Reference Records{\*\bkmkend _Toc294430364}{\*\bkmkend _Toc294430841}{\*\bkmkend _Toc300649241}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If an article cites an identifier recognized to be from a known list of biomedical databases, the cross reference is given in this field and the key for which database it was from. A typical example would be a GenBank accession number citing in an article.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430365}{\*\bkmkstart _Toc294430842}{\*\bkmkstart _Toc300649242}Funding Identifiers{\*\bkmkend _Toc294430365}{\*\bkmkend _Toc294430842}{\*\bkmkend _Toc300649242}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If an id number from a grant or contract is cited in the article (usually acknowledging support) it will appear in this field.
\par In the C structure, ValNodes are used to make a linked list of the CharPtrs to the strings.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430366}{\*\bkmkstart _Toc294430843}{\*\bkmkstart _Toc300649243}Gene Symbols{\*\bkmkend _Toc294430366}{\*\bkmkend _Toc294430843}{\*\bkmkend _Toc300649243}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {As an experiment, Library Operations at the NLM is putting in mnemonic symbols from articles, if they appear by form and usage to be gene symbols. Obviously such symbols vary and are not always properly used, so this field must be approached with caution. Nonetheless it can provide a route to a rich source of potentially relevant citations.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430367}{\*\bkmkstart _Toc294430844}{\*\bkmkstart _Toc300649244}ASN.1 Specification: medline.asn{\*\bkmkend _Toc294430367}{\*\bkmkend _Toc294430844}{\*\bkmkend _Toc300649244}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par --
\par --  MEDLINE data definitions
\par --  James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Medline DEFINITIONS ::=
\par BEGIN
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {EXPORTS Medline-entry;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par IMPORTS Cit-art FROM NCBI-Biblio
\par         Date FROM NCBI-General;
\par 
\par                                 -- a MEDLINE entry
\par Medline-entry ::= SEQUENCE \{
\par     uid INTEGER ,               -- MEDLINE UID
\par     em Date ,                   -- Entry Month
\par     cit Cit-art ,               -- article citation
\par     abstract VisibleString OPTIONAL ,
\par     mesh SET OF Medline-mesh OPTIONAL ,
\par     substance SET OF Medline-rn OPTIONAL ,
\par     xref SET OF Medline-si OPTIONAL ,
\par     idnum SET OF VisibleString OPTIONAL ,  -- ID Number (grants, contracts)
\par     gene SET OF VisibleString OPTIONAL \}
\par 
\par Medline-mesh ::= SEQUENCE \{
\par     mp BOOLEAN DEFAULT FALSE ,       -- TRUE if main point (*)
\par     term VisibleString ,                   -- the MeSH term
\par     qual SET OF Medline-qual OPTIONAL \}    -- qualifiers
\par 
\par Medline-qual ::= SEQUENCE \{
\par     mp BOOLEAN DEFAULT FALSE ,       -- TRUE if main point
\par     subh VisibleString \}             -- the subheading
\par 
\par Medline-rn ::= SEQUENCE \{       -- medline substance records
\par     type ENUMERATED \{           -- type of record
\par         nameonly (0) ,
\par         cas (1) ,               -- CAS number
\par         ec (2) \} ,              -- EC number
\par     cit VisibleString OPTIONAL ,  -- CAS or EC number if present
\par     name VisibleString \}          -- name (always present)
\par 
\par Medline-si ::= SEQUENCE \{       -- medline cross reference records
\par     type ENUMERATED \{           -- type of xref
\par         ddbj (1) ,              -- DNA Data Bank of Japan
\par         carbbank (2) ,          -- Carbohydrate Structure Database
\par         embl (3) ,              -- EMBL Data Library
\par         hdb (4) ,               -- Hybridoma Data Bank
\par         genbank (5) ,           -- GenBank
\par         hgml (6) ,              -- Human Gene Map Library
\par         mim (7) ,               -- Mendelian Inheritance in Man
\par         msd (8) ,               -- Microbial Strains Database
\par         pdb (9) ,               -- Protein Data Bank (Brookhaven)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        pir (10) ,              -- Protein Identification Resource
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        prfseqdb (11) ,         -- Protein Research Foundation (Japan)
\par         psd (12) ,              -- Protein Sequence Database (Japan)
\par         swissprot (13) \} ,      -- SwissProt
\par     cit VisibleString OPTIONAL \}    -- the citation/accession number
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430368}{\*\bkmkstart _Toc294430845}{\*\bkmkstart _Toc300649245}C Structures and Functions: objmedli.h{\*\bkmkend _Toc294430368}{\*\bkmkend _Toc294430845}{\*\bkmkend _Toc300649245}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objmedli.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objmedli.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 1/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Medline
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* Date\tab    Name        Description of modification
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Medline_
\par #define _NCBI_Medline_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par #ifndef _NCBI_Biblio_
\par #include <objbibli.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean MedlineAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *    Medline-mesh
\par *
\par *****************************************************************************/
\par typedef struct mesh \{
\par     Boolean mp;                   /* main point */
\par     CharPtr term;
\par     ValNodePtr qual;
\par     struct mesh PNTR next;
\par  \} MedlineMesh, PNTR MedlineMeshPtr;
\par 
\par extern MedlineMeshPtr MedlineMeshNew PROTO((void));
\par extern MedlineMeshPtr MedlineMeshFree PROTO((MedlineMeshPtr mmp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern MedlineMeshPtr MedlineMeshAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern Boolean MedlineMeshAsnWrite PROTO((MedlineMeshPtr mmp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *    Medline-rn
\par *
\par *****************************************************************************/
\par typedef struct rn \{
\par     Uint1 type;                
\par     CharPtr cit,
\par             name;
\par     struct rn PNTR next;
\par  \} MedlineRn, PNTR MedlineRnPtr;
\par 
\par extern MedlineRnPtr MedlineRnNew PROTO((void));
\par extern MedlineRnPtr MedlineRnFree PROTO((MedlineRnPtr mrp));
\par extern MedlineRnPtr MedlineRnAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean MedlineRnAsnWrite PROTO((MedlineRnPtr mrp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *    Medline-si
\par *      ValNode used for structure
\par *
\par *****************************************************************************/
\par 
\par extern ValNodePtr MedlineSiAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean MedlineSiAsnWrite PROTO((ValNodePtr msp, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   Medline-entry
\par *
\par *****************************************************************************/
\par typedef struct medline \{
\par     Int4 uid;
\par     DatePtr em;
\par     CitArtPtr cit;
\par     CharPtr abstract;
\par     MedlineMeshPtr mesh;
\par     MedlineRnPtr substance;
\par     ValNodePtr xref;
\par     ValNodePtr idnum;
\par     ValNodePtr gene;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} MedlineEntry, PNTR MedlineEntryPtr;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par extern MedlineEntryPtr MedlineEntryNew PROTO((void));
\par extern MedlineEntryPtr MedlineEntryFree PROTO((MedlineEntryPtr mep));
\par extern MedlineEntryPtr MedlineEntryAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par extern Boolean MedlineEntryAsnWrite PROTO((MedlineEntryPtr mep, AsnIoPtr aip, AsnTypePtr atp));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 186}}}{\b0 \tab Biological Sequences}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Biological Sequences   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 185}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {include bioseq.doc}}{\fldrslt {{\*\bkmkstart _Toc294430369}{\*\bkmkstart _Toc294430846}{\*\bkmkstart _Toc300649246}Biological Sequences{\*\bkmkend _Toc294430369}{\*\bkmkend _Toc294430846}{\*\bkmkend _Toc300649246}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430370}{\*\bkmkstart _Toc294430847}{\*\bkmkstart _Toc300649247}Introduction{\*\bkmkend _Toc294430370}{\*\bkmkend _Toc294430847}{\*\bkmkend _Toc300649247}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A biological sequence is a single, continuous molecule of nucleic acid or protein. It can be thought of as a multiple inheritance class hierarchy. One hierarchy is that of the underlying molecule type: DNA, RNA, or protein. The other hierarchy is the way the underlying biological sequence is represented by the data structure. It could be a physical or genetic map, an actual sequence of amino acids or nucleic acids, or some more complicated data structure building a composite view from other entries. An overview of this data model has been presented previously, in the Data Model chapter. The overview will not be repeated here so if you have not read that chapter, do so now. This chapter will concern itself with the details of the specification and representation of biological sequence data.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430371}{\*\bkmkstart _Toc294430848}{\*\bkmkstart _Toc300649248}Bioseq: the Biological Sequence{\*\bkmkend _Toc294430371}{\*\bkmkend _Toc294430848}{\*\bkmkend _Toc300649248}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Bioseq represents a single, continuous molecule of nucleic acid or protein. It can be anything from a band on a gel to a complete chromosome. It can be a genetic or physical map. All Bioseqs have more common properties than differences. All Bioseqs must have at least one identifier, a Seq-id (i.e. Bioseqs must be citable). Seq-ids are discussed in detail in the chapter Sequence Ids and Locations. All Bioseqs represent an integer coordinate system (even maps). All positions on Bioseqs are given by offsets from the first residue, and thus fall in the range from zero to (length - 1). All Bioseqs may have specific descriptive data elements (descriptors) and/or annotations such as feature tables, alignments, or graphs associated with them.
\par The differences in Bioseqs arise primarily from the way they are instantiated (represented). Different data elements are required to represent a map than are required to represent a sequence of residues.
\par The C structure for a Bioseq has pointers for a linked list of Seq-ids, a linked list of Seq-descr, and a linked list of Seq-annot, mapping quite directly from the ASN.1. However, since a Seq-inst is always required for a Bioseq, those fields have been incorporated into the Bioseq itself. There are SeqInstAsnRead() and SeqInstAsnWrite() as separate functions, but they take a pointer to a Bioseq.
\par A number of #defines are provided in objseq.h for the representation classes, molecule types, and types of sequence encoding used in the Bioseq C structure. Also the macros ISA_na() and ISA_aa() are provided to split Bioseqs into the two major molecule classes. A Bioseq.length equal to -1 means the length is unknown and will not appear in the ASN.1. When actual sequence data is present, Bioseq.seq_data holds the pointer to it. Bioseq.seq_data_type contains a value indicating the type of sequence encoding used (and thus the pointer type to cast Bioseq.seq_data to). Sequence encoding is discussed in more detail below.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430372}{\*\bkmkstart _Toc294430849}{\*\bkmkstart _Toc300649249}Seq-id: Identifying the Bioseq{\*\bkmkend _Toc294430372}{\*\bkmkend _Toc294430849}{\*\bkmkend _Toc300649249}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Every Bioseq MUST have at least one Seq-id, or sequence identifier. This means a Bioseq is always citable. You can refer to it by a label of some sort. This is a crucial property for different software tools or different scientists to be able to talk about the same thing. There is a wide range of Seq-ids and they are used in different ways. They are discussed in more detail in the Sequence Ids and Locations chapter.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430373}{\*\bkmkstart _Toc294430850}{\*\bkmkstart _Toc300649250}Seq-annot: Annotating the Bioseq{\*\bkmkend _Toc294430373}{\*\bkmkend _Toc294430850}{\*\bkmkend _Toc300649250}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-annot is a self-contained package of sequence annotations, or information that refers to specific locations on specific Bioseqs. Every Seq-annot can have an Object-id for local use by software, a Dbtag for globally identifying the source of the Seq-annot, and/or a name and description for display and use by a human. These describe the whole package of annotations and make it attributable to a source, independent of the source of the Bioseq.
\par A Seq-annot may contain a feature table, a set of sequence alignments, or a set of graphs of attributes along the sequence. These are described in detail in the Sequence Annotation chapter.
\par A Bioseq may have many Seq-annots. This means it is possible for one Bioseq to have feature tables from several different sources, or a feature table and set of alignments. A collection of sequences (see Sets Of Bioseqs) can have Seq-annots as well. Finally, a Seq-annot can stand alone, not directly attached to anything. This is because each element in the Seq-annot has specific references to locations on Bioseqs so the information is very explicitly associated with Bioseqs, not implicitly associated by attachment. This property makes possible the exchange of information about Bioseqs as naturally as the exchange of the Bioseqs themselves, be it among software tools or between scientists or as contributions to public databases.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430374}{\*\bkmkstart _Toc294430851}{\*\bkmkstart _Toc300649251}Seq-descr: Describing the Bioseq and Placing It In Context{\*\bkmkend _Toc294430374}{\*\bkmkend _Toc294430851}{\*\bkmkend _Toc300649251}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-descr is meant to describe a Bioseq (or set of Bioseqs.. see Sets Of Bioseqs) and place it in a biological and/or bibliographic context. Seq-descrs apply to the whole Bioseq. Some Seq-descr classes appear also as features, when used to describe a specific part of a Bioseq. But anything appearing at the Seq-descr level applies to the whole thing.
\par The C implementation uses a linked list of ValNodes, where the ValNode.choice indicates what kind of Seq-descr this is, and ValNode.data contains either an integer or pointer depending on the type of descriptor. The file objseq.h lists the choices and data types and is summarize in the following table. Under Value is the value of ValNode.choice. Type gives an indication of the data stored in ValNode.data. If "i", then an integer is stored in valnode->data.intvalue. Otherwise a pointer is stored in valnode->data.ptrvalue and the datatype of the pointer is given. The file objseq.h also has a series of #defines for Value below constructed by prefixing "Seq_descr_" to the Name below and replacing any hyphens (-) in the ASN.1 name with underline (_) to make it legal C (e.g. #define Seq_descr_mol_type 1).
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Seq-descr
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1971\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3579\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8317\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Name\cell Type\cell Explanation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1971\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3579\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8317\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {mol-type}{\b \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {i\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {role of molecule in life\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1971\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3579\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8317\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {modif\cell ValNodePtr\cell modifying keywords of mol-type\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {method\cell i\cell protein sequencing method used\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {name\cell CharPtr\cell a commonly used name (e.g. "SV40")\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {title\cell CharPtr\cell a descriptive title or definition\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {org\cell OrgRefPtr\cell (single) organism from which mol comes\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {comment\cell CharPtr\cell descriptive comment (may have many)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {num\cell NumberingPtr\cell a numbering system for whole Bioseq\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {maploc\cell DbtagPtr\cell a map location from a mapping database\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pir\cell PirBlockPtr\cell PIR specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {genbank\cell GBBlockPtr\cell GenBank flatfile specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pub\cell PubdescPtr\cell Publication citation and descriptive info from pub\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {region\cell CharPtr\cell name of genome region (e.g. B-globin cluster)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {user\cell UserObjectPtr\cell user defined data object for any purpose\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {sp\cell SPBlockPtr\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SWISSPROT specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {16\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {neighbors\cell LinkSetPtr\cell ids of pre-calculated similar sequences\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {17\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {embl\cell EMBLBlockPtr\cell EMBL specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {18\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {create-date\cell DatePtr\cell date entry was created by source database\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {19\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {update-date\cell DatePtr\cell date entry last updated by source database\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {20\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {prf\cell PrfBlockPtr\cell PRF specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {21\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pdb\cell PdbBlockPtr\cell PDB specific data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1971\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3579\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8317\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {22\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {het\cell CharPtr\cell heterogen: non-Bioseq atom/molecule\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430375}{\*\bkmkstart _Toc294430852}{\*\bkmkstart _Toc300649252}mol-type: The Molecule Type{\*\bkmkend _Toc294430375}{\*\bkmkend _Toc294430852}{\*\bkmkend _Toc300649252}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-descr.mol-type is of type GIBB-mol. It is derived from the molecule information used in the GenInfo BackBone database. It indicates the biological role of the Bioseq in life. It can be genomic (including organelle genomes). It can be a transcription product such as pre-mRNA, mRNA, rRNA, tRNA, snRNA (small nuclear RNA), or scRNA (small cytoplasmic RNA). All amino acid sequences are peptides. No distinction is made at this level about the level of processing of the peptide (but see Prot-ref in the Sequence Annotations chapter). The type other-genetic is provided for "other genetic material" such a B chromosomes or F factors that are not normal genomic material but are also not transcription products. The type genomic-mRNA is provided to describe sequences presented in figures in papers in which the author has combined genomic flanking sequence with cDNA sequence. Since such a figure often does not accurately reflect either the sequence of the mRNA or the sequence of genome, this practice should be discouraged.
\par Since GIBB-mol is an ENUMERATED type, the ValNode for the Seq-descr simply places the enumerated value in ValNode.data.intvalue.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430376}{\*\bkmkstart _Toc294430853}{\*\bkmkstart _Toc300649253}modif: Modifying Our Assumptions About a Bioseq{\*\bkmkend _Toc294430376}{\*\bkmkend _Toc294430853}{\*\bkmkend _Toc300649253}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A GIBB-mod began as a GenInfo BackBone component and was found to be of general utility. A GIBB-mod is meant to modify the assumptions one might make about a Bioseq. If a GIBB-mod is not present, it does not mean it does not apply, only that it is part of a reasonable assumption already. For example, a Bioseq with GIBB-mol = genomic would be assumed to be DNA, to be chromosomal, and to be partial (complete genome sequences are still rare). If GIBB-mod = mitochondrial and GIBB-mod = complete are both present in Seq-descr, then we know this is a complete mitochondrial genome. Even though GIBB-mod = DNA  is not present we can still assume it is DNA.
\par The modifier concept permits a lot of flexibility. So a peptide with GIBB-mod = mitochondrial is a mitochondrial protein. There is no implication that it is from a mitochondrial gene, only that it functions in the mitochondrion. The assumption is that peptide sequences are complete, so GIBB-mod = complete is not necessary for most proteins, but GIBB-mod = partial is important information for some. A list of brief explanations of GIBB-mod values follows:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {GIBB-mod
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2334\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7208\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Name\cell Explanation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2334\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7208\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {dna}{\b \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {molecule is DNA in life\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {rna\cell molecule is RNA in life\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {extrachrom\cell molecule is extrachromosomal\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {plasmid\cell molecule is or is from a plasmid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {mitochondrial\cell molecule is from mitochondrion\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {chloroplast\cell molecule is from chloroplast\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {kinetoplast\cell molecule is from kinetoplast\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {cyanelle\cell molecule is from cyanelle\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {synthetic\cell molecule was synthesized artificially\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {recombinant\cell molecule was formed by recombination\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {partial\cell not a complete sequence for molecule\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {complete\cell sequence covers complete molecule\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {mutagen\cell molecule subjected to mutagenesis\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {natmut\cell molecule is a naturally occuring mutant\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {transposon\cell molecule is a transposon\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {insertion-seq\cell molecule is an insertion sequence\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {16\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no-left\cell partial molecule is missing left end
\par 5' end for nucleic acid, NH3 end for peptide\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {17\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {no-right\cell partial molecule is missing right end
\par 3' end for nucleic acid, COOH end for peptide\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {18\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {macronuclear\cell molecule is from macronucleus\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {19\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {proviral\cell molecule is an integrated provirus\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2334\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7208\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {20\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {est\cell molecule is an expressed sequence tag\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {Seq-descr.modif is defined as a SET OF GIBB-mod, so it must be implemented as a chain, not as a single value. The ValNode representing a Seq-descr.modif then has ValNode.choice = Seq_descr_modif and a ValNode.data.ptrvalue is the head of a chain of ValNodes. Each member of that chain has a ValNode.data.intvalue set to represent a single GIBB-mod according to the table above.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430377}{\*\bkmkstart _Toc294430854}{\*\bkmkstart _Toc300649254}method: Protein Sequencing Method{\*\bkmkend _Toc294430377}{\*\bkmkend _Toc294430854}{\*\bkmkend _Toc300649254}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The method Seq-descr gives the method used to obtain a protein sequence. The values for a GIBB-method are also stored in the C structure as integer values mapping directly from the ASN.1 ENUMERATED type. They are:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {GIBB-method
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2432\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7610\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Name\cell Explanation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2432\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7610\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {concept-trans}{\b \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {conceptual translation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {seq-pept\cell peptide itself was sequenced\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {both\cell conceptual translation with partial peptide sequencing\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {seq-pept-overlap\cell peptides sequenced, fragments ordered by overlap\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {seq-pept-homol\cell peptides sequenced, fragments ordered by homology\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2432\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7610\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {concept-trans-a\cell conceptual translation, provided by author of sequence\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430378}{\*\bkmkstart _Toc294430855}{\*\bkmkstart _Toc300649255}name: A Descriptive Name{\*\bkmkend _Toc294430378}{\*\bkmkend _Toc294430855}{\*\bkmkend _Toc300649255}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A sequence name is very different from a sequence identifier. A Seq-id uniquely identifies a specific Bioseq. A Seq-id may be no more than an integer and will not necessarily convey any biological or descriptive information in itself. A name is not guaranteed to uniquely identify a single Bioseq, but if used with caution, can be a very useful tool to identify the best current entry for a biological entity. For example, we may wish to associate the name "SV40" with a single Bioseq for the complete genome of SV40. Let us suppose this Bioseq has the Seq-id 10. Then it is discovered that there were errors in the original Bioseq designated 10, and it is replaced by a new Bioseq from a curator with Seq-id 15. The name "SV40" can be moved to Seq-id 15 now. If a biologist wishes to see the "best" or "most typical" sequence of the SV40 genome, she would retrieve on the name "SV40". At an earlier point in time she would get Bioseq 10. At a later point she would get Bioseq 15. Note that her query is always answered in the context of best current data. On the other hand, if she had done a sequence analysis on Bioseq 10 and wanted to compare results, she would cite Seq-id 10, not the name "SV40", since her results apply to the specific Bioseq, 10, not necessarily to the "best" or "most typical" entry for the virus at the moment.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430379}{\*\bkmkstart _Toc294430856}{\*\bkmkstart _Toc300649256}title: A Descriptive Title{\*\bkmkend _Toc294430379}{\*\bkmkend _Toc294430856}{\*\bkmkend _Toc300649256}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A title is a brief, generally one line, description of an entry. It is extremely useful when presenting lists of Bioseqs returned from a query or search. This is the same as the familiar GenBank flatfile DEFINITION line.
\par  Because of the utility of such terse summaries, NCBI has been experimenting with algorithmically generated titles which try to pack as much information as possible into a single line in a regular and readable format. You will see titles of this form appearing on entries produced by the NCBI journal scanning component of GenBank.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {DEFINITION  atp6=F0-ATPase subunit 6 \{RNA edited\} [Brassica napus=rapeseed,
\par             mRNA Mitochondrial, 905 nt]
\par 
\par DEFINITION  mprA=metalloprotease, mprR=regulatory protein [Streptomyces
\par             coelicolor, Muller DSM3030, Genomic, 3 genes, 2040 nt]
\par 
\par DEFINITION  pelBC gene cluster: pelB=pectate lyase isozyme B, pelC=pectate
\par             lyase isozyme C [Erwinia chrysanthemi, 3937, Genomic, 2481 nt]
\par 
\par DEFINITION  glycoprotein J...glycoprotein I [simian herpes B virus SHBV,
\par             prototypic B virus, Genomic, 3 genes, 2652 nt]
\par 
\par DEFINITION  glycoprotein B, gB [human herpesvirus-6 HHV6, GS, Peptide, 830
\par                aa]
\par 
\par DEFINITION  \{pseudogene\} RESA-2=ring-infected erythrocyte surface antigen 2
\par             [Plasmodium falciparum, FCR3, Genomic, 3195 nt]
\par 
\par DEFINITION  microtubule-binding protein tau \{exons 4A, 6, 8 and 13/14\} [human,
\par             Genomic, 954 nt, segment 1 of 4]
\par 
\par DEFINITION  CAD protein carbamylphosphate synthetase domain \{5' end\} [Syrian
\par             hamsters, cell line 165-28, mRNA Partial, 553 nt]
\par 
\par DEFINITION  HLA-DPB1 (SSK1)=MHC class II antigen [human, Genomic, 288 nt]
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Gene and protein names come first. If both gene name and protein name are know they are linked with "=". If more than two genes are on a Bioseq then the first and last gene are given, separated by "...". A region name, if available, will precede the gene names. Extra comments will appear in \{\}. Organism, strain names, and molecule type and modifier appear in [] at the end. Note that the whole definition is constructed from structured information in the ASN.1 data structure by software. It is not composed by hand, but is instead a brief, machine generated summary of the entry based on data within the entry. We therefore discourage attempts to machine parse this line. It may change, but the underlying structured data will not. Software should always be designed to process the structured data.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430380}{\*\bkmkstart _Toc294430857}{\*\bkmkstart _Toc300649257}org: What Organism Did this Come From?{\*\bkmkend _Toc294430380}{\*\bkmkend _Toc294430857}{\*\bkmkend _Toc300649257}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If the whole Bioseq comes from a single organism (the usual case). See the Feature Table chapter for a detailed description of the Org-ref (organism reference) data structure.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430381}{\*\bkmkstart _Toc294430858}{\*\bkmkstart _Toc300649258}comment: Commentary Text{\*\bkmkend _Toc294430381}{\*\bkmkend _Toc294430858}{\*\bkmkend _Toc300649258}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A comment that applies to the whole Bioseq may go here. A comment may contain many sentences or paragraphs. A Bioseq may have many comments.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430382}{\*\bkmkstart _Toc294430859}{\*\bkmkstart _Toc300649259}num: Applying a Numbering System to a Bioseq{\*\bkmkend _Toc294430382}{\*\bkmkend _Toc294430859}{\*\bkmkend _Toc300649259}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {One may apply a custom numbering system over the full length of the Bioseq with this Seq\_descr. See the section on Numbering later in this chapter for a detailed description of the possible forms this can take. To report the numbering system used in a particular publication, the Pubdesc Seq-descr has its own Numbering slot.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430383}{\*\bkmkstart _Toc294430860}{\*\bkmkstart _Toc300649260}maploc: Map Location{\*\bkmkend _Toc294430383}{\*\bkmkend _Toc294430860}{\*\bkmkend _Toc300649260}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The map location given here is a Dbtag, to be able to cite a map location given by a map database to this Bioseq (e.g. "GDB", "4q21"). It is not necessarily the map location published by the author of the Bioseq. A map location published by the author would be part of a Pubdesc Seq-descr.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430384}{\*\bkmkstart _Toc294430861}{\*\bkmkstart _Toc300649261}pir: PIR Specific Data{\*\bkmkend _Toc294430384}{\*\bkmkend _Toc294430861}{\*\bkmkend _Toc300649261}
\par {\*\bkmkstart _Toc294430385}{\*\bkmkstart _Toc294430862}{\*\bkmkstart _Toc300649262}sp: SWISSPROT Data{\*\bkmkend _Toc294430385}{\*\bkmkend _Toc294430862}{\*\bkmkend _Toc300649262}
\par {\*\bkmkstart _Toc294430386}{\*\bkmkstart _Toc294430863}{\*\bkmkstart _Toc300649263}embl: EMBL Data{\*\bkmkend _Toc294430386}{\*\bkmkend _Toc294430863}{\*\bkmkend _Toc300649263}
\par {\*\bkmkstart _Toc294430387}{\*\bkmkstart _Toc294430864}{\*\bkmkstart _Toc300649264}prf: PRF Data{\*\bkmkend _Toc294430387}{\*\bkmkend _Toc294430864}{\*\bkmkend _Toc300649264}
\par {\*\bkmkstart _Toc294430388}{\*\bkmkstart _Toc294430865}{\*\bkmkstart _Toc300649265}pdb: PDB Data{\*\bkmkend _Toc294430388}{\*\bkmkend _Toc294430865}{\*\bkmkend _Toc300649265}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI produces ASN.1 encoded entries from data provided by many different sources. Almost all of the data items from these widely differing sources are mapped into the common ASN.1 specifications described in this document. However, in all cases a small number of elements are unique to a particular data source, or cannot be unambiguously mapped into the common ASN.1 specification. Rather than lose such elements, they are carried in small data structures unique to each data source. These are specified in seqblock.asn and objblock.h.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430389}{\*\bkmkstart _Toc294430866}{\*\bkmkstart _Toc300649266}genbank: GenBank Flatfile Specific Data{\*\bkmkend _Toc294430389}{\*\bkmkend _Toc294430866}{\*\bkmkend _Toc300649266}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A number of data items unique to the GenBank flatfile format do not map readily to the common ASN.1 specification. These fields are partially populated by NCBI for Bioseqs derived from other sources than GenBank to permit the production of valid GenBank flatfile entries from those Bioseqs. Other fields are populated to preserve information coming from older GenBank entries.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430390}{\*\bkmkstart _Toc294430867}{\*\bkmkstart _Toc300649267}pub: Description of a Publication{\*\bkmkend _Toc294430390}{\*\bkmkend _Toc294430867}{\*\bkmkend _Toc300649267}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This Seq-descr is used both to cite a particular bibliographic source and to carry additional information about the Bioseq as it appeared in that publication, such as the numbering system to use, the figure it appeared in, a map location given by the author in that paper, and so. See the section on the Pubdesc later in this chapter for a more detailed description of this data type.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430391}{\*\bkmkstart _Toc294430868}{\*\bkmkstart _Toc300649268}region: Name of a Genomic Region{\*\bkmkend _Toc294430391}{\*\bkmkend _Toc294430868}{\*\bkmkend _Toc300649268}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A region of genome often has a name which is a commonly understood description for the Bioseq, such as "B-globin cluster".
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430392}{\*\bkmkstart _Toc294430869}{\*\bkmkstart _Toc300649269}user: A User-defined Structured Object{\*\bkmkend _Toc294430392}{\*\bkmkend _Toc294430869}{\*\bkmkend _Toc300649269}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is a place holder for software or databases to add their own structured datatypes to Bioseqs without corrupting the common specification or disabling the automatic ASN.1 syntax checking. A User-object can also be used as a feature. See the chapter on General User Objects for a detailed explanation of User-objects.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430393}{\*\bkmkstart _Toc294430870}{\*\bkmkstart _Toc300649270}neighbors: Bioseqs Related by Sequence Similarity{\*\bkmkend _Toc294430393}{\*\bkmkend _Toc294430870}{\*\bkmkend _Toc300649270}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI computes a list of "neighbors", or closely related Bioseqs based on sequence similarity for use in the Entrez service. This descriptor is so that such context setting information could be included in a Bioseq itself, if desired.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430394}{\*\bkmkstart _Toc294430871}{\*\bkmkstart _Toc300649271}create-date:{\*\bkmkend _Toc294430394}{\*\bkmkend _Toc294430871}{\*\bkmkend _Toc300649271}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is the date a Bioseq was created for the first time. It is normally supplied by the source database. It may not be present when not normally distributed by the source database.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430395}{\*\bkmkstart _Toc294430872}{\*\bkmkstart _Toc300649272}update-date:{\*\bkmkend _Toc294430395}{\*\bkmkend _Toc294430872}{\*\bkmkend _Toc300649272}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is the date of the last update to a Bioseq by the source database. For several source databases this is the only date provided with an entry. The nature of the last update done is generally not available in computer readable (or any) form.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430396}{\*\bkmkstart _Toc294430873}{\*\bkmkstart _Toc300649273}het: Heterogen{\*\bkmkend _Toc294430396}{\*\bkmkend _Toc294430873}{\*\bkmkend _Toc300649273}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A "heterogen" is a non-biopolymer atom or molecule associated with Bioseqs from PDB. When a heterogen appears at the Seq-descr level, it means it was resolved in the crystal structure but is not associated with specific residues of the Bioseq. Heterogens which are associated with specific residues of the Bioseq are attached as features.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430397}{\*\bkmkstart _Toc294430874}{\*\bkmkstart _Toc300649274}Seq-inst: Instantiating the Bioseq{\*\bkmkend _Toc294430397}{\*\bkmkend _Toc294430874}{\*\bkmkend _Toc300649274}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seq-inst.mol gives the physical type of the Bioseq in the living organism. If it is not certain if the Bioseq is DNA (dna) or RNA (rna), then (na) can be used to indicate just "nucleic acid". A protein is always (aa) or "amino acid". The values "not-set" or "other" are provided for internal use by editing and authoring tools, but should not be found on a finished Bioseq being sent to an analytical tool or database.
\par The representation class to which the Bioseq belongs is encoded in Seq-inst.repr. The values "not-set" or "other" are provided for internal use by editing and authoring tools, but should not be found on a finished Bioseq being sent to an analytical tool or database. The Data Model chapter discusses the representation class hierarchy in general. Specific details follow below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430398}{\*\bkmkstart _Toc294430875}{\*\bkmkstart _Toc300649275}Seq-inst: Virtual Bioseq{\*\bkmkend _Toc294430398}{\*\bkmkend _Toc294430875}{\*\bkmkend _Toc300649275}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A "virtual" Bioseq is one in which we know the type of molecule, and possibly it's length, topology, and/or strandedness, but for which we do not have sequence data. It is not unusual to have some uncertainty about the length of a virtual Bioseq, so Seq-inst.fuzz may be used. The fields Seq-inst.seq-data and Seq-inst.ext are not appropriate for a virtual Bioseq.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430399}{\*\bkmkstart _Toc294430876}{\*\bkmkstart _Toc300649276}Seq-inst: Raw Bioseq{\*\bkmkend _Toc294430399}{\*\bkmkend _Toc294430876}{\*\bkmkend _Toc300649276}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A "raw" Bioseq does have sequence data, so Seq-inst.length must be set and there should be no Seq-inst.fuzz associated with it. Seq-inst.seq-data must be filled in with the sequence itself and a Seq-data encoding must be selected which is appropriate to Seq-inst.mol. The topology and strandedness may or may not be available. Seq-inst.ext is not appropriate.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430400}{\*\bkmkstart _Toc294430877}{\*\bkmkstart _Toc300649277}Seq-inst: Segmented Bioseq{\*\bkmkend _Toc294430400}{\*\bkmkend _Toc294430877}{\*\bkmkend _Toc300649277}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A segmented ("seg") Bioseq has all the properties of a virtual Bioseq, except that Seq-hist.ext of type Seq-ext.seg must be used to indicate the pieces of other Bioseqs to assemble to make the segmented Bioseq. A Seq-ext.seg is defined as a SEQUENCE OF Seq-loc, or a series of locations on other Bioseqs, taken in order.
\par For example, a segmented Bioseq (called "X") has a SEQUENCE OF Seq-loc which are an interval from position 11 to 20 on Bioseq "A" followed by an interval from position 6 to 15 on Bioseq "B". So "X" is a Bioseq with no internal gaps which is 20 residues long (no Seq-inst.fuzz). The first residue of "X" is the residue found at position 11 in "A". To obtain this residue, software must retrieve Bioseq "A" and examine the residue at "A" position 11. The segmented Bioseq contains no sequence data itself, only pointers to where to get the sequence data and what pieces to assemble in what order.
\par The type of segmented Bioseq described above might be used to represent the putative mRNA by simply pointing to the exons on two pieces of genomic sequence. Suppose however, that we had only sequenced around the exons on the genomic sequence, but wanted to represent the putative complete genomic sequence.  Let us assume that Bioseq "A" is the genomic sequence of the first exon and some small amount of flanking DNA, and that Bioseq "B" is the genomic sequence around the second exon. Further, we may know from mapping that the exons are separated by about two kilobases of DNA. We can represent the genomic region by creating a segmented sequence in which the first location is all of Bioseq "A". The second location will be all of a virtual Bioseq (call it "C") whose length is two thousand and which has a Seq-inst.fuzz representing whatever uncertainty we may have about the exact length of the intervening genomic sequence. The third location will be all of Bioseq "B". If "A" is 100 base pairs long and "B" is 200 base pairs, then the segmented entry is 2300 base pairs long ("A"+"C"+"B") and has the same Seq-inst.fuzz as "C" to express the uncertainty of the overall length.
\par A variation of the case above is when one has no idea at all what the length of the intervening genomic region is. A segmented Bioseq can also represent this case. The Seq-inst.ext location chain would be first all of "A", then a Seq-loc of type "null", then all of "B". The "null" indicates that there is no available information here. The length of the segmented Bioseq is just the sum of the length of "A" and the length of "B", and Seq-inst.fuzz is set to indicate the real length is greater-than the length given. The "null" location does not add to the overall length of the segmented Bioseq and is ignored in determining the integer value of a location on the segmented Bioseq itself. If "A" is 100 base pairs long and "B" is 50 base pairs long, then position 0 on the segmented Bioseq is equivalent to the first residue of "A" and position 100 on the segmented Bioseq is equivalent to the first residue of "B", despite the intervening "null" location indicating the gap of unknown length. Utility functions such as the SeqPort (described in the Sequence Utilities chapter) can be configured to signal when crossing such boundaries, or to ignore them.
\par The Bioseqs referenced by a segmented Bioseq should always be from the same Seq-inst.mol class as the segmented Bioseq, but may well come from a mixture of Seq-inst.repr classes (as for example the mixture of virtual and raw Bioseq references used to describe sequenced and unsequenced genomic regions above). Other reasonable mixtures might be raw and map (see below) Bioseqs to describe a region which is fully mapped and partially sequenced, or even a mixture of virtual, raw, and map Bioseqs for a partially mapped and partially sequenced region. The "character" of any region of a segmented Bioseq is always taken from the underlying Bioseq to which it points in that region. However, a segmented Bioseq can have its own annotations. Things like feature tables are not automatically propagated to the segmented Bioseq.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430401}{\*\bkmkstart _Toc294430878}{\*\bkmkstart _Toc300649278}Seq-inst: Reference Bioseq{\*\bkmkend _Toc294430401}{\*\bkmkend _Toc294430878}{\*\bkmkend _Toc300649278}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A reference Bioseq is effectively a segmented Bioseq with only one pointer location. It behaves exactly like a segmented Bioseq in taking it's data and "character" from the Bioseq to which it points. Its purpose is not to construct a new Bioseq from others like a segmented Bioseq, but to refer to an existing Bioseq. It could be used to provide a convenient handle to a frequently used region of a larger Bioseq. Or it could be used to develop a customized, personally annotated view of a Bioseq in a public database without losing the "live" link to the public sequence.
\par In the first example, software would want to be able to use the Seq-loc to gather up annotations and descriptors for the region and display them to user with corrections to align them appropriately to the sub region. In this form, a scientist my refer to the "lac region" by name, and analyze or annotate it as if it were a separate Bioseq, but each retrieve starts with a fresh copy of the underlying Bioseq and annotations, so corrections or additions made to the underlying Bioseq in the public database will be immediately visible to the scientist, without either having to always look at the whole Bioseq or losing any additional annotations the scientist may have made on the region themselves.
\par In the second example, software would not propagate annotations or descriptors from the underlying Bioseq by default (because presumably the scientist prefers his own view to the public one) but the connection to the underlying Bioseq is not lost. Thus the public annotations are available on demand and any new annotations added by the scientist share the public coordinate system and can be compared with those done by others.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430402}{\*\bkmkstart _Toc294430879}{\*\bkmkstart _Toc300649279}Seq-inst: Constructed Bioseq{\*\bkmkend _Toc294430402}{\*\bkmkend _Toc294430879}{\*\bkmkend _Toc300649279}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A constructed (const) Bioseq inherits all the attributes of a raw Bioseq. It is used to represent a Bioseq which has been constructed by assembling other Bioseqs. In this case the component Bioseqs normally overlap each other and there may be considerable redundancy of component Bioseqs. A constructed Bioseq is often also called a "contig" or a "merge".
\par Most raw Bioseqs in the public databases were constructed by merging overlapping gel or sequencer readings of a few hundred base pairs each. While the const Bioseq data structure can easily accommodate this information, the const Bioseq data type was not really intended for this purpose. It was intended to represent higher level merges of public sequence data and private data, such as when a number of sequence entries from different authors are found to overlap or be contained in each other. In this case a view of the larger sequence region can be constructed by merging the components. The relationship of the merge to the component Bioseqs is preserved in the constructed Bioseq, but it is clear that the constructed Bioseq is a "better" or "more complete" view of the overall region, and could replace the component Bioseqs in some views of the sequence database. In this way an author can submit a data structure to the database which in this author's opinion supersedes his own or other scientist's database entries, without the database actually dropping the other author's entries (who may not necessarily agree with the author submitting the constructed Bioseq).
\par The constructed Bioseq is like a raw, rather than a segmented, Bioseq because Seq-inst.seq-data must be present. The sequence itself is part of the constructed Bioseq.  This is because the component Bioseqs may overlap in a number of ways, and expert knowledge or voting rules may have been applied to determine the "correct" or "best" residue from the overlapping regions. The Seq-inst.seq-data contains the sequence which is the final result of such a process.
\par Seq-inst.ext is not used for the constructed Bioseq. The relationship of the merged sequence to its component Bioseqs is stored in Seq-inst.hist, the history of the Bioseq (described in more detail below). Seq-hist.assembly contains alignments of the constructed Bioseq with its component Bioseqs. Any Bioseq can have a Seq-hist.assembly. A raw Bioseq may use this to show its relationship to its gel readings. The constructed Bioseq is special in that its Seq-hist.assembly shows how a high level view was constructed from other pieces. The sequence in a constructed Bioseq is only posited to exist. However, since it is constructed from data by possibly many different laboratories, it may never have been sequenced in its entirety from a single biological source.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430403}{\*\bkmkstart _Toc294430880}{\*\bkmkstart _Toc300649280}Seq-inst: Typical or Consensus Bioseq{\*\bkmkend _Toc294430403}{\*\bkmkend _Toc294430880}{\*\bkmkend _Toc300649280}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A consensus (consen) Bioseq is used to represent a pattern typical of a sequence region or family of sequences. There is no assertion that even one sequence exists that is exactly like this one, or even that the Bioseq is a best guess at what a real sequence region looks like. Instead it summarizes attributes of an aligned collection of real sequences. It could be a "typical" ferredoxin made by aligning ferredoxin sequences from many organisms and producing a protein sequence which is by some measure "central" to the group. By using the NCBIpaa encoding for the protein, which permits a probability to be assigned to each position that any of the standard amino acids occurs there, one can create a "weight matrix" or "profile" to define the sequence.
\par While a consensus Bioseq can represent a frequency profile (including the probability that any amino acid can occur at a position, a type of gap penalty), it cannot represent a regular expression per se. That is because all Bioseqs represent fixed integer coordinate systems. This property is essential for attaching feature tables or expressing alignments. There is no clear way to attach a fixed coordinate system to a regular expression, while one can approximate allowing weighted gaps in specific regions with a frequency profile. Since the consensus Bioseq is like any other, information can be attached to it through a feature table and alignments of the consensus pattern to other Bioseqs can be represented like any other alignment (although it may be computed a special way). Through the alignment, annotated features on the pattern can be related to matched regions of the aligned sequence in a straightforward way.
\par Seq-hist.assembly can be used in a consensus Bioseq to record the sequence regions used to construct the pattern and their relationships with it. While Seq-hist.assembly for a constructed Bioseq indicates the relationship with Bioseqs which are meant to be superseded by the constructed Bioseq, the consensus Bioseq does not in any way replace the Bioseqs in its Seq-hist.assembly. Rather it is a summary of common features among them, not a "better" or "more complete" version of them.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430404}{\*\bkmkstart _Toc294430881}{\*\bkmkstart _Toc300649281}Seq-inst: Map Bioseqs{\*\bkmkend _Toc294430404}{\*\bkmkend _Toc294430881}{\*\bkmkend _Toc300649281}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A map Bioseq inherits all the properties of a virtual Bioseq. For a consensus genetic map of E.coli, we can posit that the chromosome is DNA, circular, double-stranded, and about 5 million base pairs long. Given this coordinate system, we estimate the positions of genes on it based on genetic evidence. That is, we build a feature table with Gene-ref features on it (explained in more detail in the Feature Table chapter). Thus, a map Bioseq is a virtual Bioseq with a Seq-inst.ext which is a feature table. In this case the feature table is an essential part of instantiating the Bioseq, not simply an annotation on the Bioseq. This is not to say a map Bioseq cannot have a feature table in the usual sense as well. It can. It can also be used in alignments, displays, or by any software that can process or store Bioseqs. This is the great strength of this approach. A genetic or physical map is just another Bioseq and can be stored or analyzed right along with other more typical Bioseqs.
\par It is understood that within a particular physical or genetic mapping research project more data will have to be present than the map Bioseq can represent. But the same is true for a big sequencing project. The Bioseq is an object for reporting the result of such projects to others in a way that preserves most or all the information of use to workers outside the particular research group. It also preserves enough information to be useful to software tools within the project, such as display tools or analysis tools which were written by others.
\par }\pard \sb240\widctlpar\adjustright {A number of attributes of Bioseqs can make such a generic representation more "natural" to a particular research community.  For the E.coli map example, above, no E.coli geneticist thinks of the positions of genes in base pairs (yet). So a Num-ref annotation (see Seq-descr, below) can be attached to the Bioseq, which provides information to convert the internal integer coordinate system of the map Bioseq to "minutes", the floating point numbers from 0.0 to 100.0 that E.coli gene positions are traditionally given in. Seq-loc objects which the Gene-ref features use to indicate their position can represent uncertainty, and thus give some idea of the accuracy of the mapping in a simple way. This representation cannot store order information directly (e.g. B and C are after A and before D, but we don't know the absolute distance and we don't know the relative order of B and C), which would need to be stored in a genetic mapping research database. However, a reasonable enough presentation can be made of this situation using locations and uncertainties to be very useful for a wide variety of purposes. As more sequence and physical map information become available, such uncertainties in gene position, at least for the "typical" chromosome, will gradually be resolved and will then map very will to such a generic model.
\par }\pard \sb240\widctlpar\adjustright {A physical map Bioseq has similar strengths and weaknesses as the genetic map Bioseq. It can represent an ordered map (such as an ordered restriction map) very well and easily. For some contig building approaches, ordering information is essential to the process of building the physical map and would have to be stored and processed separately by the map building research group. However, the map Bioseq serves very well as a vehicle for periodic reports of the group's best view of the physical map for consumption by the scientific public. The map Bioseq data structure maps quite well to the figures such groups publish to summarize their work. The map Bioseq is an electronic summary that can be integrated with other data and software tools.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430405}{\*\bkmkstart _Toc294430882}{\*\bkmkstart _Toc300649282}Seq-hist: History of a Seq-inst{\*\bkmkend _Toc294430405}{\*\bkmkend _Toc294430882}{\*\bkmkend _Toc300649282}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seq-hist is literally the history of the Seq-inst part of a Bioseq. It does not track changes in annotation at all. However, since the coordinate system provided by the Seq-inst is the critical element for tying annotations and alignments done at various times by various people into a single consistent database, this is the most important element to track.
\par While Seq-hist can use any valid Seq-id, in practice NCBI will use the best available Seq-id in the Seq-hist. For this purpose, the Seq-id most tightly linked to the exact sequence itself is best. See the Seq-id discussion.
\par Seq-hist.assembly has been mentioned above. It is a SET OF Seq-align which show the relationship of this Bioseq to any older components that might be merged into it. The Bioseqs included in the assembly are those from which this Bioseq was made or is meant to supersede. The Bioseqs in the assembly need not all be from the author, but could come from anywhere. Assembly just sets the Bioseq in context.
\par Seq-hist.replaces makes an editorial statement using a Seq-hist-rec. As of a certain date, this Bioseq should replace the following Bioseqs. Databases at NCBI interpret this in a very specific way. Seq-ids in Seq-hist.replaces, which are owned by the owner of the Bioseq, are taken from the public view of the database. The author has told us to replace them with this one. If the author does not own some of them, it is taken as advice that the older entries may be obsolete, but they are not removed from the public view.
\par Seq-hist.replaced-by is a forward pointer. It means this Bioseq was replaced by the following Seq-id(s) on a certain date. In the case described above, that an author tells NCBI that a new Bioseq replaces some of his old ones, not only is the backward pointer (Seq-hist.replaces) provided by the author in the database, but NCBI will update the Seq-hist.replaced-by forward pointer when the old Bioseq is removed from public view. Since such old entries are still available for specific retrieval by the public, if a scientist does have annotation pointing to the old entry, the new entry can be explicitly located. Conversely, the older versions of a Bioseq can easily be located as well. Note that Seq-hist.replaced-by points only one generation forward and Seq-hist.replaces points only one generation back. This makes Bioseqs with a Seq-hist a doubly linked list over its revision history. This is very different from GenBank/EMBL/DDBJ secondary accession numbers, which only indicate "some relationship" between entries. When that relationship happens to be the replacement relationship, they still carry all accession numbers in the secondary accessions, not just the last ones, so reconstructing the entry history is impossible, even in a very general way.
\par Another fate which may await a Bioseq is that it is completely withdrawn. This is relatively rare but does happen. Seq-hist.deleted can either be set to just TRUE, or the date of the deletion event can be entered (preferred). In the SeqHist C structure, slots for both the deleted boolean and deleted date are present. If the deleted date is present, the ASN.1 will have the Date CHOICE for Seq-hist.deleted, else if the deleted boolean is TRUE the ASN.1 will have the BOOLEAN form.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430406}{\*\bkmkstart _Toc294430883}{\*\bkmkstart _Toc300649283}Seq-data: Encoding the Sequence Data Itself{\*\bkmkend _Toc294430406}{\*\bkmkend _Toc294430883}{\*\bkmkend _Toc300649283}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In the case of a raw or constructed Bioseq, the sequence data itself is stored in Seq-inst.seq-data, which is the data type Seq-data. Seq-data is a CHOICE of different ways of encoding the data, allowing selection of the optimal type for the case in hand. Both nucleic acid and amino acid encoding are given as CHOICEs of Seq-data rather than further subclassing first. But it is still not reasonable to encode a Bioseq of Seq-inst.mol of "aa" using a nucleic acid Seq-data type.
\par In the C structures all types of Seq-data are stored in ByteStores in Bioseq.seq_data. The encoding is given by the value of Bioseq.seq_data_type. The file objseq.h contains a series of #defines for the values of Bioseq.seq_data_type. These #defines map exactly to the ASN.1 Seq-code-type described below.
\par The ASN.1 module seqcode.asn and C header objcode.h define tables for recording the allowed values for the various sequence encoding and the ways to display or map between codes. This permits useful information about the allowed encoding to be stored as ASN.1 data and read into a program at runtime. NCBI uses the text file seqcode.prt and the binary version of that, seqcode.val, with its software tools. Some of the data from this file is presented in tables in the following discussion of the different sequence encoding. The "value" is the internal numerical value of a residue in the C code. The "symbol" is a one letter or multi-letter symbol to be used in display to a human. The "name" is a descriptive name for the residue. Other data in seqcode.prt will be discussed in the section on seqcode.asn itself.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430407}{\*\bkmkstart _Toc294430884}{\*\bkmkstart _Toc300649284}IUPACaa: The IUPAC-IUB Encoding of Amino Acids{\*\bkmkend _Toc294430407}{\*\bkmkend _Toc294430884}{\*\bkmkend _Toc300649284}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A set of one letter abbreviations for amino acids were suggested by the IUPAC-IUB Commission on Biochemical Nomenclature, published in J. Biol. Chem. (1968) 243: 3557-3559. It is very widely used in both printed and electronic forms of protein sequence, and many computer programs have been written to analyze data in this form internally (that is the actual ASCII value of the one letter code is used internally). To support such approaches, the IUPACaa encoding represents each amino acid internally as the ASCII value of its external one letter symbol. Note that this symbol is UPPER CASE. One may choose to display the value as lower case to a user for readability, but the data itself must be the UPPER CASE value.
\par In the NCBI C code implementation, the values are stored one value per byte.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {IUPACaa
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx720\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1654\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4422\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx720\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1654\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4422\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {65\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Alanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx720\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1654\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4422\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {66\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {B\cell Asp or Asn\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {67\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {68\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {D\cell Aspartic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {69\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {E\cell Glutamic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {70\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {F\cell Phenylalanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {71\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Glycine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {72\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {H\cell Histidine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {73\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {I\cell Isoleucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {75\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {K\cell Lysine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {76\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {L\cell Leucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {77\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {M\cell Methionine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {78\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {N\cell Asparagine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {80\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {P\cell Proline\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {81\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Q\cell Glutamine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {82\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {R\cell Arginine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {83\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {S\cell Serine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {84\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Threoine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {86\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {V\cell Valine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {87\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {W\cell Tryptophan\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {88\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {X\cell Undetermined or atypical\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {89\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Y\cell Tyrosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx720\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1654\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4422\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {90\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Z\cell Glu or Gln\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430408}{\*\bkmkstart _Toc294430885}{\*\bkmkstart _Toc300649285}NCBIeaa: Extended IUPAC Encoding of Amino Acids{\*\bkmkend _Toc294430408}{\*\bkmkend _Toc294430885}{\*\bkmkend _Toc300649285}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The official IUPAC amino acid code has some limitations. One is the lack of symbols for termination, gap, or selenocysteine. Such extensions to the IUPAC codes are also commonly used by sequence analysis software. NCBI has created such a code which is simply the IUPACaa code above extended with the additional symbols.
\par In the NCBI C code implementation, the values are stored one value per byte.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {NCBIeaa
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx709\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1699\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4467\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx709\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1699\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4467\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {42\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {*\cell Termination\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx709\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1699\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4467\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {45\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {-\cell Gap\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {65\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Alanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {66\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {B\cell Asp or Asn\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {67\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {68\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {D\cell Aspartic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {69\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {E\cell Glutamic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {70\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {F\cell Phenylalanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {71\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Glycine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {72\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {H\cell Histidine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {73\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {I\cell Isoleucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {75\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {K\cell Lysine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {76\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {L\cell Leucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {77\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {M\cell Methionine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {78\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {N\cell Asparagine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {80\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {P\cell Proline\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {81\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Q\cell Glutamine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {82\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {R\cell Arginine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {83\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {S\cell Serine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {84\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Threoine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {85\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {U\cell Selenocysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {86\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {V\cell Valine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {87\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {W\cell Tryptophan\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {88\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {X\cell Undetermined or atypical\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {89\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Y\cell Tyrosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx709\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1699\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4467\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {90\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Z\cell Glu or Gln\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430409}{\*\bkmkstart _Toc294430886}{\*\bkmkstart _Toc300649286}NCBIstdaa: A Simple Sequential Code for Amino Acids{\*\bkmkend _Toc294430409}{\*\bkmkend _Toc294430886}{\*\bkmkend _Toc300649286}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It is often very useful to separate the external symbol for a residue from its internal representation as a data value. For amino acids NCBI has devised a simple continuous set of values that encompasses the set of "standard" amino acids also represented by the NCBIeaa code above. A continuous set of values means that compact arrays can be used in computer software to look up attributes for residues simply and easily by using the value as an index into the array. The only significance of any particular mapping of a value to an amino acid is that zero is used for gap and the official IUPAC amino acids come first in the list. In general, we recommend the use of this encoding for standard amino acid sequences.
\par In the NCBI C code implementation, the values are stored one value per byte.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {NCBIstdaa
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx698\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4473\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx698\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4473\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {-\cell Gap           \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx698\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4473\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Alanine       \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {B\cell Asp or Asn    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cysteine      \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {D\cell Aspartic Acid \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {E\cell Glutamic Acid \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {F\cell Phenylalanine \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Glycine       \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {H\cell Histidine     \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {I\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Isoleucine    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {K\cell Lysine        \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {L\cell Leucine       \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {M\cell Methionine    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {N\cell Asparagine    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {P\cell Proline       \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Q\cell Glutamine     \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {16\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {R\cell Arginine      \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {17\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {S\cell Serine        \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {18\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Threoine      \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {19\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {V\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Valine        \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {20\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {W\cell Tryptophan    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {21\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {X\cell Undetermined or atypical\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {22\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Y\cell Tyrosine      \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {23\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Z\cell Glu or Gln    \cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {24\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {U\cell Selenocysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx698\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4473\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {25\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {*\cell Termination\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430410}{\*\bkmkstart _Toc294430887}{\*\bkmkstart _Toc300649287}NCBI8aa: An Encoding for Modified Amino Acids{\*\bkmkend _Toc294430410}{\*\bkmkend _Toc294430887}{\*\bkmkend _Toc300649287}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Post-translational modifications can introduce a number of non-standard or modified amino acids into biological molecules. The NCBI8aa code will be used to represent up to 250 possible amino acids by using the remaining coding space in the NCBIstdaa code. That is, for the first 26 values, NCBI8aa will be identical to NCBIstdaa. The remaining 224 values will be used for the most commonly encountered modified amino acids. Only the first 250 values will be used to signify amino acids, leaving values in the range of 250-255 to be used for software control codes. Obviously there are a very large number of possible modified amino acids, especially if one takes protein engineering into account. However, the intent here is to only represent commonly found biological forms. This encoding is not yet available since decisions about what amino acids to include have not all been made yet.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430411}{\*\bkmkstart _Toc294430888}{\*\bkmkstart _Toc300649288}IUPAC3aa: A 3 Letter Display Code for Amino Acids{\*\bkmkend _Toc294430411}{\*\bkmkend _Toc294430888}{\*\bkmkend _Toc300649288}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The IUPAC3aa code uses exactly the same values as NCBIstdaa. The only difference is the symbol is the three letter instead of the one letter code. This code is purely for display. As such it does not appear as a valid CHOICE in Seq-data for encoding actual sequence data. However, it does appear in the seqcode.asn specification and is stored in seqcode.val. The symbols follow the IUPAC-IUB recommendations for three letter codes where possible.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {IUPAC3aa
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx684\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4490\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx684\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4490\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {---\cell Gap\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx684\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4490\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Ala\cell Alanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Asx\cell Asp or Asn\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Cys\cell Cysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Asp\cell Aspartic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Glu\cell Glutamic Acid\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Phe\cell Phenylalanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Gly\cell Glycine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {His\cell Histidine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Ile\cell Isoleucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Lys\cell Lysine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Leu\cell Leucine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Met\cell Methionine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Asn\cell Asparagine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Pro\cell Proline\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Gln\cell Glutamine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {16\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Arg\cell Arginine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {17\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Ser\cell Serine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {18\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Thr\cell Threoine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {19\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Val\cell Valine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {20\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Trp\cell Tryptophan\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {21\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Xxx\cell Undetermined or atypical\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {22\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Tyr\cell Tyrosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {23\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Glx\cell Glu or Gln\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {24\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Sec\cell Selenocysteine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx684\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1677\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4490\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {25\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Ter\cell Termination\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430412}{\*\bkmkstart _Toc294430889}{\*\bkmkstart _Toc300649289}NCBIpaa: A Profile Style Encoding for Amino Acids{\*\bkmkend _Toc294430412}{\*\bkmkend _Toc294430889}{\*\bkmkend _Toc300649289}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The NCBIpaa encoding is designed to accommodate a frequency profile describing a protein motif or family in a form which is consistent with the sequences in a Bioseq. Each position in the sequence is defined by 30 values. Each of the 30 values represents the probability that a particular amino acid (or gap, termination, etc.) will occur at that position. One can consider each set of 30 values an array. The amino acid for each cell of the 30 value array corresponds to the NCBIstdaa index scheme. This means that currently only the first 26 array elements will ever have a meaningful value. The remaining 4 cells are available for possible future additions to NCBIstdaa. Each cell represents the probability that the amino acid defined by the NCBIstdaa index to that cell will appear at that position in the motif or protein. The probability is encoded as an 8-bit value from 0-255 corresponding to a probability from 0.0 to 1.0 by interpolation.
\par This type of encoding would presumably never appear except in a Bioseq of type "consensus". In the C code implementation these amino acids are encoded at 30 bytes per amino acid in a simple linear order. That is, the first 30 bytes are the first amino acid, the second 30 the next amino acid, and so on.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430413}{\*\bkmkstart _Toc294430890}{\*\bkmkstart _Toc300649290}IUPACna: The IUPAC-IUB Encoding for Nucleic Acids{\*\bkmkend _Toc294430413}{\*\bkmkend _Toc294430890}{\*\bkmkend _Toc300649290}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Like the IUPACaa codes the IUPACna codes are single letters for nucleic acids and the value is the same as the ASCII value of the recommended IUPAC letter. The IUPAC recommendations for nucleic acid codes also include letters to represent all possible ambiguities at a single position in the sequence except a gap. To make the values non-redundant, U is considered the same as T. Whether a sequence actually contains U or T is easily determined from Seq-inst.mol. Since some software tools are designed to work directly on the ASCII representation of the IUPAC letters, this representation is provided. Note that the ASCII values correspond to the UPPER CASE letters. Using values corresponding to lower case letters in Seq-data is an error. For display to a user, any readable case or font is appropriate.
\par The C implementation encodes one value for a nucleic acid residue per byte.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {IUPACna
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1737\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4598\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1737\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4598\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {65\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Adenine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1737\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4598\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {66\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {B\cell G or T or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {67\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cytosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {68\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {D\cell G or A or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {71\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Guanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {72\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {H\cell A or C or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {75\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {K\cell G or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {77\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {M\cell A or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {78\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {N\cell A or G or C or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {82\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {R\cell G or A\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {83\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {S\cell G or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {84\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Thymine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {86\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {V\cell G or C or A\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {87\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {W\cell A or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1737\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4598\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {89\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Y\cell T or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430414}{\*\bkmkstart _Toc294430891}{\*\bkmkstart _Toc300649291}NCBI4na: A Four Bit Encoding of Nucleic Acids{\*\bkmkend _Toc294430414}{\*\bkmkend _Toc294430891}{\*\bkmkend _Toc300649291}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It is possible to represent the same set of nucleic acid and ambiguities with a four bit code, where one bit corresponds to each possible base and where more than one bit is set to represent ambiguity.  The particular encoding used for NCBI4na is the same as that used on the GenBank Floppy Disk Format. A four bit encoding has several advantages over the direct mapping of the ASCII IUPAC codes. One can represent "no base" as 0000. One can match various ambiguous or unambiguous bases by a simple AND. For example, in NCBI4na 0001=A, 0010=C, 0100=G, 1000=T/U. Adenine (0001) then matches Purine (0101) by the AND method. Finally, it is possible to store the sequence in half the space by storing two bases per byte. This is done both in the ASN.1 encoding and in the NCBI C software implementation. Utility functions (see SeqPort()) allow the developer to ignore the complexities of storage while taking advantage of the greater packing. Since nucleic acid sequences can be very long, this is a real savings.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {NCBI4na
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1715\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4586\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1715\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4586\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {-\cell Gap\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1715\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4586\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Adenine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cytosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {M\cell A or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Guanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {R\cell G or A\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {S\cell G or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {V\cell G or C or A\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Thymine/Uracil\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {W\cell A or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {Y\cell T or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {H\cell A or C or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {K\cell G or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {D\cell G or A or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {B\cell G or T or C\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx756\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1715\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4586\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {N\cell A or G or C or T\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430415}{\*\bkmkstart _Toc294430892}{\*\bkmkstart _Toc300649292}NCBI2na: A Two Bit Encoding for Nucleic Acids{\*\bkmkend _Toc294430415}{\*\bkmkend _Toc294430892}{\*\bkmkend _Toc300649292}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If no ambiguous bases are present in a nucleic acid sequence it can be completely encoded using only two bits per base. This allows encoding into ASN.1 or storage in the NCBI C implementation with a four fold savings in space. As with the four bit packing, the NCBI C utility SeqPort() allows the programmer to ignore the complexities introduced by the packing. The two bit encoding selected is the same as that proposed for the GenBank CDROM.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {NCBI2na
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx743\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1705\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4585\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Symbol\cell Name\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx743\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1705\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4585\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {A\cell Adenine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx743\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1705\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4585\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {C\cell Cytosine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {G\cell Guanine\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx743\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1705\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx4585\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {T\cell Thymine/Uracil\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430416}{\*\bkmkstart _Toc294430893}{\*\bkmkstart _Toc300649293}NCBI8na: An Eight Bit Sequential Encoding for Modified Nucleic Acids{\*\bkmkend _Toc294430416}{\*\bkmkend _Toc294430893}{\*\bkmkend _Toc300649293}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The first 16 values of NCBI8na are identical with those of NCBI4na. The remaining possible 234 values will be used for common, biologically occurring modified bases such as those found in tRNAs. This full encoding is still being determined at the time of this writing. Only the first 250 values will be used, leaving values in the range of 250-255 to be used as control codes in software.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430417}{\*\bkmkstart _Toc294430894}{\*\bkmkstart _Toc300649294}NCBIpna: A Frequency Profile Encoding for Nucleic Acids{\*\bkmkend _Toc294430417}{\*\bkmkend _Toc294430894}{\*\bkmkend _Toc300649294}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Frequency profiles have been used to describe motifs and signals in nucleic acids. This can be encoded by using five bytes per sequence position. The first four bytes are used to express the probability that particular bases occur at that position, in the order A, C, G, T as in the NCBI2na encoding. The fifth position encodes the probability that a base occurs there at all. Each byte has a value from 0-255 corresponding to a probability from 0.0-1.0.
\par The sequence is encoded as a simple linear sequence of bytes where the first five bytes code for the first position, the next five for the second position, and so on. Typically the NCBIpna notation would only be found on a Bioseq of type consensus. However, one can imagine other uses for such an encoding, for example to represent knowledge about low resolution sequence data in an easily computable form.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430418}{\*\bkmkstart _Toc294430895}{\*\bkmkstart _Toc300649295}Tables of Sequence Codes{\*\bkmkend _Toc294430418}{\*\bkmkend _Toc294430895}{\*\bkmkend _Toc300649295}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Various sequence alphabets can be stored in tables of type Seq-code-table, defined in seqcode.asn. An enumerated type, Seq-code-type is used as a key to each table. Each code can be thought of as a square table essentially like those presented above in describing each alphabet. Each "residue" of the code has a numerical one-byte value used to represent that residue both in ASN.1 data and in internal C structures. The information necessary to display the value is given by the "symbol". A symbol can be in a one-letter series (e.g. A,G,C,T) or more than one letter (e.g. Met, Leu, etc.). The symbol gives a human readable representation the corresponds to each numerical residue value. A name, or explanatory string, is also associated with each.
\par So, the NCBI2na code above would be coded into a Seq-code-table very simply as:
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {        \{                                -- NCBI2na
\par             code ncbi2na ,
\par             num 4 ,                               -- continuous 0-3
\par             one-letter TRUE ,            -- all one letter codes
\par             table \{
\par                 \{ symbol "A", name "Adenine" \},
\par                 \{ symbol "C", name "Cytosine" \},
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {                \{ symbol "G", name "Guanine" \},
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {                \{ symbol "T", name "Thymine/Uracil"\}
\par             \} ,                          -- end of table            
\par             comps \{                      -- complements
\par                 3,
\par                 2,
\par                 1,
\par                 0
\par             \}
\par         \} ,
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The table has 4 rows (with values 0-3) with one letter symbols. If we wished to represent a code with values which do not start at 0 (such as the IUPAC codes) then we would set the OPTIONAL "start-at" element to the value for the first row in the table.
\par In the case of nucleic acid codes, the Seq-code-table also has rows for indexes to complement the values represented in the table. In the example above, the complement of 0 ("A") is 3 ("T").
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430419}{\*\bkmkstart _Toc294430896}{\*\bkmkstart _Toc300649296}Mapping Between Different Sequence Alphabets{\*\bkmkend _Toc294430419}{\*\bkmkend _Toc294430896}{\*\bkmkend _Toc300649296}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-map-table provides a mapping from the values of one alphabet to the values of another, very like the way complements are mapped above. A Seq-map-table has two Seq-code-types, one giving the alphabet to map from and the other the alphabet to map to. The Seq-map-table has the same number of rows and the same "start-at" value as the Seq-code-table for the alphabet it maps FROM. This makes the mapping a simple array lookup using the value of a residue of the FROM alphabet and subtracting "start-at". Remember that alphabets are not created equal and mapping from a bigger alphabet to a smaller may result in loss of information.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430420}{\*\bkmkstart _Toc294430897}{\*\bkmkstart _Toc300649297}Data and Tools for Sequence Alphabets{\*\bkmkend _Toc294430420}{\*\bkmkend _Toc294430897}{\*\bkmkend _Toc300649297}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI provides a collection of Seq-code-tables and Seq-map-tables together in a Seq-code-set as part of the software toolbox. The file is called seqcode.prt (text form) or seqcode.val (binary ASN.1 used by the software). The function SeqCodeSetLoad() will check your NCBI configuration file looking for the path to "DATA", then read seqcode.val into memory using SeqCodeSetAsnRead(). A local static pointer to the loaded SeqCodes is kept in the SeqCode module, and thus need not be kept by the caller. Additional functions use the static pointer to provide access to the codes. SeqCodeTableFind() will return the appropriate SeqCodeTablePtr given a valid sequence code, and SeqMapTableFind() will return the appropriate SeqMapTablePtr given a code to map from and a code to map to. The SeqPort functions use these functions to provide a view of a sequence in any requested alphabet by mapping residues on demand.  See the chapter on Writing Sequence Software.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430421}{\*\bkmkstart _Toc294430898}{\*\bkmkstart _Toc300649298}Pubdesc: Publication Describing a Bioseq{\*\bkmkend _Toc294430421}{\*\bkmkend _Toc294430898}{\*\bkmkend _Toc300649298}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Pubdesc is a data structure used to record how a particular publication described a Bioseq. It contains the citation itself as a Pub-equiv (see the Bibliographic References chapter) so that equivalent forms of the citation (e.g. a MEDLINE uid and a Cit-Art) can all be accommodated in a single data structure. Then a number of additional fields allow a more complete description of what was presented in the publication. These extra fields are generally only filled in for entries produced by the NCBI journal scanning component of GenBank, also known as the Backbone database. This information is not generally available in data from any other database yet.
\par Pubdesc.name is the name given the sequence in the publication, usually in the figure. Pubdesc.fig gives the figure the Bioseq appeared in so a scientist can locate it in the paper. Pubdesc.num preserves the numbering system used by the author (see Numbering below). Pubdesc.numexc, if TRUE, indicates that a "numbering exception" was found (i.e. the author's numbering did not agree with the number of residues in the sequence). This usually indicates an error in the preparation of the figure. If Pubdesc.poly-a is TRUE, then a poly-A tract was indicated for the Bioseq in the figure, but was not explicitly preserved in the sequence itself (e.g. ...AGAATTTCT (Poly-A) ). Pubdesc.maploc is the map location for this sequence as given by the author in this paper. Pubdesc.seq-raw allows the presentation of the sequence exactly as typed from the figure. This is never used now. Pubdesc.align-group, if present, indicates the Bioseq was presented in a group aligned with other Bioseqs. The align-group value is an arbitrary integer. Other Bioseqs from the same publication which are part of the same alignment will have the same align-group number.
\par Pubdesc.comment is simply a free text comment associated with this publication. SWISSPROT entries may also have this field filled.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430422}{\*\bkmkstart _Toc294430899}{\*\bkmkstart _Toc300649299}Numbering: Applying a Numbering System to a Bioseq{\*\bkmkend _Toc294430422}{\*\bkmkend _Toc294430899}{\*\bkmkend _Toc300649299}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Internally, locations on Bioseqs are ALWAYS integer offsets in the range 0 to (length - 1). However, it is often helpful to display some other numbering system. The Numbering data structure supports a variety of numbering styles and conventions. In the ASN.1 specification, it is simply a CHOICE of the four possible types. When a Numbering object is supplied as a Seq-descr, then it applies to the complete length of the Bioseq. A Numbering object can also be a feature, in which case it only applies to the interval defined by the feature's location.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430423}{\*\bkmkstart _Toc294430900}{\*\bkmkstart _Toc300649300}Num-cont: A Continuous Integer Numbering System{\*\bkmkend _Toc294430423}{\*\bkmkend _Toc294430900}{\*\bkmkend _Toc300649300}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The most widely used numbering system for sequences is some form of a continuous integer numbering. Num-cont.refnum is the number to assign to the first residue in the Bioseq. If Num-cont.has-zero is TRUE, the numbering system uses zero. When biologists start numbering with a negative number, it is quite common for them to skip zero, going directly from -1 to +1, so the DEFAULT for has-zero is FALSE. This only reflects common usage, not any recommendation in terms of convention. Any useful software tool should support both conventions, since they are both used in the literature. Finally, the most common numbering systems are ascending, however descending numbering systems are encountered from time to time, so Num-cont.ascending would then be set to FALSE.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430424}{\*\bkmkstart _Toc294430901}{\*\bkmkstart _Toc300649301}Num-real: A Real Number Numbering Scheme{\*\bkmkend _Toc294430424}{\*\bkmkend _Toc294430901}{\*\bkmkend _Toc300649301}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Genetic maps may use real numbers as "map units" since they treat the chromosome as a continuous coordinate system, instead of a discrete, integer coordinate system of base pairs. Thus a Bioseq of type "map" which may use an underlying integer coordinate system from 0 to 5 million may be best presented to user in the familiar 0.0 to 100.0 map units. Num-real supports a simply linear equation specifying the relationship:
\par map units = ( Num-real.a + base_pair_position) + Num-real.b
\par in this example. Since such numbering systems generally have their own units (e.g. "map units", "centisomes", "centimorgans", etc), Num-real.units provides a string for labeling the display.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430425}{\*\bkmkstart _Toc294430902}{\*\bkmkstart _Toc300649302}Num-enum: An Enumerated Numbering Scheme{\*\bkmkend _Toc294430425}{\*\bkmkend _Toc294430902}{\*\bkmkend _Toc300649302}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Occasionally biologists do not use a continuous numbering system at all. Crystallographers and immunologists, for example, who do extensive studies on one or a few sequences, may name the individual residues in the sequence as they fit them into a theoretical framework. So one might see residues numbered ... "10" "11" "12" "12A" "12B" "12C" "13" "14" ... To accommodate this sort of scheme the "name" of each residue must be explicitly given by a string, since there is no anticipating any convention that may be used. The Num-enum.num gives the number of residue names (which should agree with the number of residues in the Bioseq, in the case of use as a Seq-descr), followed by the names as strings.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430426}{\*\bkmkstart _Toc294430903}{\*\bkmkstart _Toc300649303}Num-ref: Numbering by Reference to Another Bioseq{\*\bkmkend _Toc294430426}{\*\bkmkend _Toc294430903}{\*\bkmkend _Toc300649303}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Two types of references are allowed. The "sources" references is meant to apply the numbering system of constituent Bioseqs to a segmented Bioseq. This is useful for seeing the mapping from the parts to the whole.
\par The "aligns" reference requires that the Num-ref-aligns alignment be filled in with an alignment of the target Bioseq with one or more pieces of other Bioseqs. The numbering will come from the aligned pieces.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430427}{\*\bkmkstart _Toc294430904}{\*\bkmkstart _Toc300649304}Numbering: C Structures and Utility Functions{\*\bkmkend _Toc294430427}{\*\bkmkend _Toc294430904}{\*\bkmkend _Toc300649304}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Numbering object is implemented in C simply as a ValNode, where ValNode.choice is given by a series of #defines in objpubd.h and ValNode.ptrvalue is a pointer to the appropriate data structure for the Numbering type.
\par In sequtil.h (see the Sequence Utilities chapter) a number of functions are defined which convert from internal to display numbering systems and vice versa. These functions make the use of fairly complex numbering systems fairly straightforward.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430428}{\*\bkmkstart _Toc294430905}{\*\bkmkstart _Toc300649305}ASN.1 Specification: seq.asn{\*\bkmkend _Toc294430428}{\*\bkmkend _Toc294430905}{\*\bkmkend _Toc300649305}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.1 $
\par --**********************************************************************
\par --
\par --  NCBI Sequence elements
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {NCBI-Sequence DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Bioseq, Seq-annot, Pubdesc, Seq-descr, Numbering, Heterogen;
\par 
\par IMPORTS Date, Int-fuzz, Dbtag, Object-id, User-object FROM NCBI-General
\par         Seq-align FROM NCBI-Seqalign
\par         Seq-feat FROM NCBI-Seqfeat
\par         Seq-graph FROM NCBI-Seqres
\par         Pub-equiv FROM NCBI-Pub
\par         Org-ref FROM NCBI-Organism
\par         Seq-id, Seq-loc FROM NCBI-Seqloc
\par         Link-set FROM NCBI-Access
\par \tab \tab GB-block FROM GenBank-General
\par \tab \tab PIR-block FROM PIR-General
\par         EMBL-block FROM EMBL-General
\par \tab \tab SP-block FROM SP-General
\par \tab \tab PRF-block FROM PRF-General
\par \tab \tab PDB-block FROM PDB-General;
\par 
\par --*** Sequence ********************************
\par --*
\par 
\par Bioseq ::= SEQUENCE \{
\par     id SET OF Seq-id ,            -- equivalent identifiers
\par     descr Seq-descr OPTIONAL , -- descriptors
\par     inst Seq-inst ,            -- the sequence data
\par     annot SET OF Seq-annot OPTIONAL \}
\par 
\par --*** Descriptors *****************************
\par --*
\par 
\par Seq-descr ::= SET OF CHOICE \{
\par     mol-type GIBB-mol ,          -- type of molecule
\par     modif SET OF GIBB-mod ,      -- modifiers
\par     method GIBB-method ,         -- sequencing method
\par     name VisibleString ,         -- a name for this sequence
\par     title VisibleString ,        -- a title for this sequence
\par     org Org-ref ,                -- if all from one organism
\par     comment VisibleString ,      -- a more extensive comment
\par     num Numbering ,              -- a numbering system
\par     maploc Dbtag ,               -- map location of this sequence
\par     pir PIR-block ,              -- PIR specific info
\par     genbank GB-block ,           -- GenBank specific info
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    pub Pubdesc ,                -- a reference to the publication
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    region VisibleString ,       -- overall region (globin locus)
\par     user User-object ,           -- user defined object
\par \tab sp SP-block ,                -- SWISSPROT specific info
\par     neighbors Link-set ,         -- neighboring information
\par     embl EMBL-block ,            -- EMBL specific information
\par \tab create-date Date ,           -- date entry first created/released
\par \tab update-date Date ,           -- date of last update
\par \tab prf PRF-block ,\tab \tab \tab \tab  -- PRF specific information
\par \tab pdb PDB-block ,              -- PDB specific information
\par \tab het Heterogen \}              -- cofactor, etc associated but not bound
\par 
\par GIBB-mol ::= ENUMERATED \{       -- type of molecule represented
\par     unknown (0) ,
\par     genomic (1) ,
\par     pre-mRNA (2) ,
\par     mRNA (3) ,
\par     rRNA (4) ,
\par     tRNA (5) ,
\par     snRNA (6) ,
\par     scRNA (7) ,
\par     peptide (8) ,
\par \tab other-genetic (9) ,      -- other genetic material
\par \tab genomic-mRNA (10) ,      -- reported a mix of genomic and cdna sequence
\par     other (255) \}
\par     
\par GIBB-mod ::= ENUMERATED \{        -- GenInfo Backbone modifiers
\par     dna (0) ,
\par     rna (1) ,
\par     extrachrom (2) ,
\par     plasmid (3) ,
\par     mitochondrial (4) ,
\par     chloroplast (5) ,
\par     kinetoplast (6) ,
\par     cyanelle (7) ,
\par     synthetic (8) ,
\par     recombinant (9) ,
\par     partial (10) ,
\par     complete (11) ,
\par     mutagen (12) ,    -- subject of mutagenesis ?
\par     natmut (13) ,     -- natural mutant ?
\par     transposon (14) ,
\par     insertion-seq (15) ,
\par \tab no-left (16) ,    -- missing left end (5' for na, NH2 for aa)
\par \tab no-right (17) ,   -- missing right end (3' or COOH)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab macronuclear (18) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab proviral (19) ,
\par \tab est (20) ,        -- expressed sequence tag
\par     other (255) \}
\par 
\par GIBB-method ::= ENUMERATED \{        -- sequencing methods
\par     concept-trans (1) ,    -- conceptual translation
\par     seq-pept (2) ,         -- peptide was sequenced
\par     both (3) ,             -- concept transl. w/ partial pept. seq.
\par \tab seq-pept-overlap (4) , -- sequenced peptide, ordered by overlap
\par \tab seq-pept-homol (5) ,   -- sequenced peptide, ordered by homology
\par \tab concept-trans-a (6) ,  -- conceptual transl. supplied by author
\par     other (255) \}
\par     
\par Numbering ::= CHOICE \{           -- any display numbering system
\par     cont Num-cont ,              -- continuous numbering
\par     enum Num-enum ,              -- enumerated names for residues
\par     ref Num-ref ,                -- by reference to another sequence
\par     real Num-real \}              -- supports mapping to a float system
\par     
\par Num-cont ::= SEQUENCE \{          -- continuous display numbering system
\par     refnum INTEGER DEFAULT 1,         -- number assigned to first residue
\par     has-zero BOOLEAN DEFAULT FALSE ,  -- 0 used?
\par     ascending BOOLEAN DEFAULT TRUE \}  -- ascending numbers?
\par 
\par Num-enum ::= SEQUENCE \{          -- any tags to residues
\par     num INTEGER ,                        -- number of tags to follow
\par     names SEQUENCE OF VisibleString \}    -- the tags
\par 
\par Num-ref ::= SEQUENCE \{           -- by reference to other sequences
\par     type ENUMERATED \{            -- type of reference
\par         not-set (0) ,
\par         sources (1) ,            -- by segmented or const seq sources
\par         aligns (2) \} ,           -- by alignments given below
\par     aligns Seq-align OPTIONAL \}
\par 
\par Num-real ::= SEQUENCE \{          -- mapping to floating point system
\par     a REAL ,                     -- from an integer system used by Bioseq
\par     b REAL ,                     -- position = (a * int_position) + b
\par     units VisibleString OPTIONAL \}
\par 
\par Pubdesc ::= SEQUENCE \{              -- how sequence presented in pub
\par     pub Pub-equiv ,                 -- the citation(s)
\par     name VisibleString OPTIONAL ,   -- name used in paper
\par     fig VisibleString OPTIONAL ,    -- figure in paper
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    num Numbering OPTIONAL ,        -- numbering from paper
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    numexc BOOLEAN OPTIONAL ,       -- numbering problem with paper
\par     poly-a BOOLEAN OPTIONAL ,       -- poly A tail indicated in figure?
\par     maploc VisibleString OPTIONAL , -- map location reported in paper
\par     seq-raw StringStore OPTIONAL ,  -- original sequence from paper
\par     align-group INTEGER OPTIONAL ,  -- this seq aligned with others in paper
\par \tab comment VisibleString OPTIONAL \}-- any comment on this pub in context
\par 
\par Heterogen ::= VisibleString       -- cofactor, prosthetic group, inibitor, etc
\par 
\par --*** Instances of sequences *******************************
\par --*
\par 
\par Seq-inst ::= SEQUENCE \{            -- the sequence data itself
\par     repr ENUMERATED \{              -- representation class
\par         not-set (0) ,              -- empty
\par         virtual (1) ,              -- no seq data
\par         raw (2) ,                  -- continuous sequence
\par         seg (3) ,                  -- segmented sequence
\par         const (4) ,                -- constructed sequence
\par         ref (5) ,                  -- reference to another sequence
\par         consen (6) ,               -- consensus sequence or pattern
\par         map (7) ,                  -- ordered map (genetic, restriction)
\par         other (255) \} ,
\par     mol ENUMERATED \{               -- molecule class in living organism
\par         not-set (0) ,              --   > cdna = rna
\par         dna (1) ,
\par         rna (2) ,
\par         aa (3) ,
\par         na (4) ,                   -- just a nucleic acid
\par         other (255) \} ,
\par     length INTEGER OPTIONAL ,      -- length of sequence in residues
\par     fuzz Int-fuzz OPTIONAL ,       -- length uncertainty
\par     topology ENUMERATED \{          -- topology of molecule
\par         not-set (0) ,
\par         linear (1) ,
\par         circular (2) ,
\par         tandem (3) ,               -- some part of tandem repeat
\par         other (255) \} DEFAULT linear ,
\par     strand ENUMERATED \{            -- strandedness in living organism
\par         not-set (0) ,
\par         ss (1) ,                   -- single strand
\par         ds (2) ,                   -- double strand
\par         mixed (3) ,
\par         other (255) \} OPTIONAL ,   -- default ds for DNA, ss for RNA, pept
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    seq-data Seq-data OPTIONAL ,   -- the sequence
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    ext Seq-ext OPTIONAL ,         -- extensions for special types
\par \tab hist Seq-hist OPTIONAL \}       -- sequence history
\par 
\par --*** Sequence Extensions **********************************
\par --*  for representing more complex types
\par --*  const type uses Seq-hist.assembly
\par 
\par Seq-ext ::= CHOICE \{
\par     seg Seg-ext ,        -- segmented sequences
\par     ref Ref-ext ,        -- hot link to another sequence (a view)
\par     map Map-ext \}        -- ordered map of markers
\par 
\par Seg-ext ::= SEQUENCE OF Seq-loc
\par 
\par Ref-ext ::= Seq-loc
\par 
\par Map-ext ::= SEQUENCE OF Seq-feat
\par 
\par --*** Sequence History Record ***********************************
\par --** assembly = records how seq was assembled from others
\par --** replaces = records sequences made obsolete by this one
\par --** replaced-by = this seq is made obsolete by another(s)
\par 
\par Seq-hist ::= SEQUENCE \{
\par \tab assembly SET OF Seq-align OPTIONAL ,-- how was this assembled?
\par \tab replaces Seq-hist-rec OPTIONAL ,    -- seq makes these seqs obsolete
\par \tab replaced-by Seq-hist-rec OPTIONAL , -- these seqs make this one obsolete
\par \tab deleted CHOICE \{
\par \tab \tab bool BOOLEAN ,
\par \tab \tab date Date \} OPTIONAL \}
\par 
\par Seq-hist-rec ::= SEQUENCE \{
\par \tab date Date OPTIONAL ,
\par \tab ids SET OF Seq-id \}
\par \tab 
\par --*** Various internal sequence representations ************
\par --*      all are controlled, fixed length forms
\par 
\par Seq-data ::= CHOICE \{              -- sequence representations
\par     iupacna IUPACna ,              -- IUPAC 1 letter nuc acid code
\par     iupacaa IUPACaa ,              -- IUPAC 1 letter amino acid code
\par     ncbi2na NCBI2na ,              -- 2 bit nucleic acid code
\par     ncbi4na NCBI4na ,              -- 4 bit nucleic acid code
\par     ncbi8na NCBI8na ,              -- 8 bit extended nucleic acid code
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    ncbipna NCBIpna ,              -- nucleic acid probabilities
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    ncbi8aa NCBI8aa ,              -- 8 bit extended amino acid codes
\par     ncbieaa NCBIeaa ,              -- extended ASCII 1 letter aa codes
\par     ncbipaa NCBIpaa ,              -- amino acid probabilities
\par     ncbistdaa NCBIstdaa \}          -- consecutive codes for std aas
\par 
\par 
\par IUPACna ::= StringStore       -- IUPAC 1 letter codes, no spaces
\par IUPACaa ::= StringStore       -- IUPAC 1 letter codes, no spaces
\par NCBI2na ::= OCTET STRING      -- 00=A, 01=C, 10=G, 11=T
\par NCBI4na ::= OCTET STRING      -- 1 bit each for agct
\par                               -- 0001=A, 0010=C, 0100=G, 1000=T/U
\par                               -- 0101=Purine, 1010=Pyrimidine, etc
\par NCBI8na ::= OCTET STRING      -- for modified nucleic acids
\par NCBIpna ::= OCTET STRING      -- 5 octets/base, prob for a,c,g,t,n
\par                               -- probabilities are coded 0-255 = 0.0-1.0
\par NCBI8aa ::= OCTET STRING      -- for modified amino acids
\par NCBIeaa ::= StringStore       -- ASCII extended 1 letter aa codes
\par                               -- IUPAC codes + U=selenocysteine
\par NCBIpaa ::= OCTET STRING      -- 25 octets/aa, prob for IUPAC aas in order:
\par                               -- A-Y,B,Z,X,(ter),anything
\par                               -- probabilities are coded 0-255 = 0.0-1.0
\par NCBIstdaa ::= OCTET STRING    -- codes 0-25, 1 per byte
\par 
\par --*** Sequence Annotation *************************************
\par --*
\par 
\par Seq-annot ::= SEQUENCE \{
\par     id Object-id OPTIONAL ,
\par     db Dbtag OPTIONAL ,
\par     name VisibleString OPTIONAL ,
\par     desc VisibleString OPTIONAL ,
\par     data CHOICE \{
\par         ftable SET OF Seq-feat ,
\par         align SET OF Seq-align ,
\par         graph SET OF Seq-graph \} \}
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430429}{\*\bkmkstart _Toc294430906}{\*\bkmkstart _Toc300649306}ASN.1 Specification: seqblock.asn{\*\bkmkend _Toc294430429}{\*\bkmkend _Toc294430906}{\*\bkmkend _Toc300649306}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --*********************************************************************
\par --
\par --  EMBL specific data
\par --  This block of specifications was developed by Reiner Fuchs of EMBL
\par --
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--*********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par EMBL-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS EMBL-dbname, EMBL-xref, EMBL-block;
\par 
\par IMPORTS Date, Object-id FROM NCBI-General;
\par 
\par EMBL-dbname ::= CHOICE \{
\par \tab code ENUMERATED \{
\par \tab \tab embl(0),
\par \tab \tab genbank(1),
\par \tab \tab ddbj(2),
\par \tab \tab geninfo(3),
\par \tab \tab medline(4),
\par \tab \tab swissprot(5),
\par \tab \tab pir(6),
\par \tab \tab pdb(7),
\par \tab \tab epd(8),
\par \tab \tab ecd(9),
\par \tab \tab tfd(10),
\par \tab \tab flybase(11),
\par \tab \tab prosite(12),
\par \tab \tab enzyme(13),
\par \tab \tab mim(14),
\par \tab \tab ecoseq(15),
\par \tab \tab hiv(16) \},
\par \tab name\tab VisibleString \}
\par 
\par EMBL-xref ::= SEQUENCE \{
\par \tab dbname EMBL-dbname,
\par \tab id SEQUENCE OF Object-id \}
\par 
\par EMBL-block ::= SEQUENCE \{
\par \tab class ENUMERATED \{
\par \tab \tab not-set(0),
\par \tab \tab standard(1),
\par \tab \tab unannotated(2),
\par \tab \tab other(255) \} DEFAULT standard,
\par \tab div ENUMERATED \{
\par \tab \tab fun(0),
\par \tab \tab inv(1),
\par \tab \tab mam(2),
\par \tab \tab org(3),
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab phg(4),
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab pln(5),
\par \tab \tab pri(6),
\par \tab \tab pro(7),
\par \tab \tab rod(8),
\par \tab \tab syn(9),
\par \tab \tab una(10),
\par \tab \tab vrl(11),
\par \tab \tab vrt(12) \} OPTIONAL,
\par \tab creation-date Date,
\par \tab update-date Date,
\par \tab extra-acc SEQUENCE OF VisibleString OPTIONAL,
\par \tab keywords SEQUENCE OF VisibleString OPTIONAL,
\par \tab xref SEQUENCE OF EMBL-xref OPTIONAL \}
\par 
\par END
\par 
\par --*********************************************************************
\par --
\par --  SWISSPROT specific data
\par --  This block of specifications was developed by Mark Cavanaugh of
\par --\tab \tab NCBI working with Amos Bairoch of SWISSPROT
\par --
\par --*********************************************************************
\par 
\par SP-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS SP-block;
\par 
\par IMPORTS Date, Dbtag FROM NCBI-General
\par \tab \tab Seq-id FROM NCBI-SeqLoc;
\par 
\par SP-block ::= SEQUENCE \{         -- SWISSPROT specific descriptions
\par \tab class ENUMERATED \{
\par \tab \tab not-set (0) ,
\par \tab \tab standard (1) ,      -- conforms to all SWISSPROT checks
\par \tab \tab prelim (2) ,        -- only seq and biblio checked
\par \tab \tab other (255) \} ,
\par \tab extra-acc SET OF VisibleString OPTIONAL ,  -- old SWISSPROT ids
\par \tab imeth BOOLEAN DEFAULT FALSE ,  -- seq known to start with Met
\par \tab plasnm SET OF VisibleString OPTIONAL,  -- plasmid names carrying gene
\par \tab seqref SET OF Seq-id OPTIONAL,         -- xref to other sequences
\par \tab dbref SET OF Dbtag OPTIONAL ,          -- xref to non-sequence dbases
\par \tab keywords SET OF VisibleString OPTIONAL , -- keywords
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab created Date OPTIONAL ,\tab \tab \tab -- creation date
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab sequpd Date OPTIONAL ,\tab \tab \tab -- sequence update
\par \tab annotupd Date OPTIONAL \}\tab \tab -- annotation update
\par 
\par END
\par 
\par --*********************************************************************
\par --
\par --  PIR specific data
\par --  This block of specifications was developed by Jim Ostell of
\par --\tab \tab NCBI
\par --
\par --*********************************************************************
\par 
\par PIR-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS PIR-block;
\par 
\par IMPORTS Seq-id FROM NCBI-SeqLoc;
\par 
\par PIR-block ::= SEQUENCE \{          -- PIR specific descriptions
\par     had-punct BOOLEAN OPTIONAL ,      -- had punctuation in sequence ?
\par     host VisibleString OPTIONAL ,
\par     source VisibleString OPTIONAL ,     -- source line
\par     summary VisibleString OPTIONAL ,
\par     genetic VisibleString OPTIONAL ,
\par     includes VisibleString OPTIONAL ,
\par     placement VisibleString OPTIONAL ,
\par     superfamily VisibleString OPTIONAL ,
\par     keywords SEQUENCE OF VisibleString OPTIONAL ,
\par     cross-reference VisibleString OPTIONAL ,
\par     date VisibleString OPTIONAL ,
\par \tab seq-raw VisibleString OPTIONAL ,  -- seq with punctuation
\par \tab seqref SET OF Seq-id OPTIONAL \}         -- xref to other sequences
\par 
\par END
\par 
\par --*********************************************************************
\par --
\par --  GenBank specific data
\par --  This block of specifications was developed by Jim Ostell of
\par --\tab \tab NCBI
\par --
\par --*********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {GenBank-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS GB-block;
\par 
\par IMPORTS Date FROM NCBI-General;
\par 
\par GB-block ::= SEQUENCE \{          -- GenBank specific descriptions
\par     extra-accessions SEQUENCE OF VisibleString OPTIONAL ,
\par     source VisibleString OPTIONAL ,     -- source line
\par     keywords SEQUENCE OF VisibleString OPTIONAL ,
\par     origin VisibleString OPTIONAL,
\par     date VisibleString OPTIONAL ,       -- old form Entry Date
\par     entry-date Date OPTIONAL ,          -- replaces date
\par     div VisibleString OPTIONAL ,        -- GenBank division
\par     taxonomy VisibleString OPTIONAL \}   -- continuation line of organism
\par 
\par END
\par 
\par --**********************************************************************
\par -- PRF specific definition
\par --    PRF is a protein sequence database crated and maintained by
\par --    Protein Research Foundation, Minoo-city, Osaka, Japan.
\par --
\par --    Written by A.Ogiwara, Inst.Chem.Res. (Dr.Kanehisa's Lab),
\par --            Kyoto Univ., Japan
\par --
\par --**********************************************************************
\par 
\par PRF-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS PRF-block;
\par 
\par PRF-block ::= SEQUENCE \{
\par       extra-src       PRF-ExtraSrc OPTIONAL,
\par       keywords        SEQUENCE OF VisibleString OPTIONAL
\par \}
\par 
\par PRF-ExtraSrc ::= SEQUENCE \{
\par       host    VisibleString OPTIONAL,
\par       part    VisibleString OPTIONAL,
\par       state   VisibleString OPTIONAL,
\par       strain  VisibleString OPTIONAL,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {      taxon   VisibleString OPTIONAL
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\}
\par 
\par END
\par 
\par --*********************************************************************
\par --
\par --  PDB specific data
\par --  This block of specifications was developed by Jim Ostell and
\par --\tab \tab Steve Bryant of NCBI
\par --
\par --*********************************************************************
\par 
\par PDB-General DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS PDB-block;
\par 
\par IMPORTS Date FROM NCBI-General;
\par 
\par PDB-block ::= SEQUENCE \{          -- PDB specific descriptions
\par \tab deposition Date ,         -- deposition date  month,year
\par \tab class VisibleString ,
\par \tab compound SEQUENCE OF VisibleString ,
\par \tab source SEQUENCE OF VisibleString ,
\par \tab exp-method VisibleString OPTIONAL ,  -- present if NOT X-ray diffraction
\par \tab replace PDB-replace OPTIONAL \} -- replacement history
\par 
\par PDB-replace ::= SEQUENCE \{
\par \tab date Date ,
\par \tab ids SEQUENCE OF VisibleString \}   -- entry ids replace by this one
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430430}{\*\bkmkstart _Toc294430907}{\*\bkmkstart _Toc300649307}ASN.1 Specification: seqcode.asn{\*\bkmkend _Toc294430430}{\*\bkmkend _Toc294430907}{\*\bkmkend _Toc300649307}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --  *********************************************************************
\par --
\par --  These are code and conversion tables for NCBI sequence codes
\par --  ASN.1 for the sequences themselves are define in seq.asn
\par --
\par --  Seq-map-table and Seq-code-table REQUIRE that codes start with 0
\par --    and increase continuously.  So IUPAC codes, which are upper case
\par --    letters will always have 65 0 cells before the codes begin.  This
\par --    allows all codes to do indexed lookups for things
\par --
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--  Valid names for code tables are:
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--    IUPACna
\par --    IUPACaa
\par --    IUPACeaa
\par --    IUPACaa3     3 letter amino acid codes : parallels IUPACeaa
\par --                   display only, not a data exchange type
\par --    NCBI2na
\par --    NCBI4na
\par --    NCBI8na
\par --    NCBI8aa
\par --    NCBIstdaa
\par --     probability types map to IUPAC types for display as characters
\par 
\par NCBI-SeqCode DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Seq-code-table, Seq-map-table, Seq-code-set;
\par 
\par Seq-code-type ::= ENUMERATED \{              -- sequence representations
\par     iupacna (1) ,              -- IUPAC 1 letter nuc acid code
\par     iupacaa (2) ,              -- IUPAC 1 letter amino acid code
\par     ncbi2na (3) ,              -- 2 bit nucleic acid code
\par     ncbi4na (4) ,              -- 4 bit nucleic acid code
\par     ncbi8na (5) ,              -- 8 bit extended nucleic acid code
\par     ncbipna (6) ,              -- nucleic acid probabilities
\par     ncbi8aa (7) ,              -- 8 bit extended amino acid codes
\par     ncbieaa (8) ,              -- extended ASCII 1 letter aa codes
\par     ncbipaa (9) ,              -- amino acid probabilities
\par     iupacaa3 (10) ,            -- 3 letter code only for display
\par     ncbistdaa (11) \}           -- consecutive codes for std aas, 0-25
\par 
\par Seq-map-table ::= SEQUENCE \{ -- for tables of sequence mappings 
\par     from Seq-code-type ,      -- code to map from
\par     to Seq-code-type ,        -- code to map to
\par     num INTEGER ,             -- number of rows in table
\par     start-at INTEGER DEFAULT 0 ,   -- index offset of first element
\par     table SEQUENCE OF INTEGER \}  -- table of values, in from-to order
\par 
\par Seq-code-table ::= SEQUENCE \{ -- for names of coded values
\par     code Seq-code-type ,      -- name of code
\par     num INTEGER ,             -- number of rows in table
\par     one-letter BOOLEAN ,   -- symbol is ALWAYS 1 letter?
\par     start-at INTEGER DEFAULT 0 ,   -- index offset of first element
\par     table SEQUENCE OF
\par         SEQUENCE \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {            symbol VisibleString ,      -- the printed symbol or letter
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {            name VisibleString \} ,      -- an explanatory name or string
\par     comps SEQUENCE OF INTEGER OPTIONAL \} -- pointers to complement nuc acid
\par 
\par Seq-code-set ::= SEQUENCE \{    -- for distribution
\par     codes SET OF Seq-code-table OPTIONAL ,
\par     maps SET OF Seq-map-table OPTIONAL \}
\par 
\par END
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430431}{\*\bkmkstart _Toc294430908}{\*\bkmkstart _Toc300649308}C Structures and Functions: objseq.h{\*\bkmkend _Toc294430431}{\*\bkmkend _Toc294430908}{\*\bkmkend _Toc300649308}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objseq.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objseq.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Seq
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seq_
\par #define _NCBI_Seq_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par #ifndef _NCBI_Seqloc_
\par #include <objloc.h>
\par #endif
\par #ifndef _NCBI_Pub_
\par #include <objpub.h>
\par #endif
\par #ifndef _NCBI_Seqalign_
\par #include <objalign.h>
\par #endif
\par #ifndef _NCBI_Pubdesc_
\par #include <objpubd.h>     /* separated out to avoid typedef order problems */
\par #endif
\par #ifndef _NCBI_Seqfeat_
\par #include <objfeat.h>       /* include organism for now */
\par #endif
\par #ifndef _NCBI_Seqres_
\par #include <objres.h>
\par #endif
\par #ifndef _NCBI_Access_
\par #include <objacces.h>
\par #endif
\par #ifndef _NCBI_SeqBlock_
\par #include <objblock.h>
\par #endif
\par #ifndef _NCBI_SeqCode_
\par #include <objcode.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#endif
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-Seq objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   SeqAnnot - Sequence annotations
\par *
\par *****************************************************************************/
\par typedef struct seqannot \{
\par     ObjectIdPtr id;
\par     DbtagPtr db;
\par     CharPtr name,
\par         desc;
\par     Uint1 type;             /* 1=ftable, 2=align, 3=graph */
\par     Pointer data;
\par     struct seqannot PNTR next;
\par \} SeqAnnot, PNTR SeqAnnotPtr;
\par 
\par SeqAnnotPtr SeqAnnotNew PROTO((void));
\par Boolean SeqAnnotAsnWrite PROTO((SeqAnnotPtr sap, AsnIoPtr aip, AsnTypePtr atp));
\par SeqAnnotPtr SeqAnnotAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqAnnotPtr SeqAnnotFree PROTO((SeqAnnotPtr sap));
\par 
\par /*****************************************************************************
\par *
\par *   Sets of SeqAnnots
\par *
\par *****************************************************************************/
\par Boolean SeqAnnotSetAsnWrite PROTO((SeqAnnotPtr sap, AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {SeqAnnotPtr SeqAnnotSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par 
\par /*****************************************************************************
\par *
\par *   SeqHist
\par *
\par *****************************************************************************/
\par typedef struct seqhist \{
\par \tab SeqAlignPtr assembly;
\par \tab DatePtr replace_date;
\par \tab SeqIdPtr replace_ids;
\par \tab DatePtr replaced_by_date;
\par \tab SeqIdPtr replaced_by_ids;
\par \tab Boolean deleted;
\par \tab DatePtr deleted_date;
\par \} SeqHist, PNTR SeqHistPtr;
\par 
\par SeqHistPtr SeqHistNew PROTO((void));
\par Boolean SeqHistAsnWrite PROTO((SeqHistPtr shp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqHistPtr SeqHistAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqHistPtr SeqHistFree PROTO((SeqHistPtr shp));
\par 
\par /*****************************************************************************
\par *
\par *   Bioseq.
\par *     Inst is incorporated within Bioseq for efficiency
\par *     seq_data_type
\par *       0 = not set
\par *       1 = IUPACna
\par *       2 = IUPACaa
\par *       3 = NCBI2na
\par *       4 = NCBI4na
\par *       5 = NCBI8na
\par *       6 = NCBIpna
\par *       7 = NCBI8aa
\par *       8 = NCBIeaa
\par *       9 = NCBIpaa
\par *      11 = NCBIstdaa
\par *   seq_ext_type
\par *       0 = none
\par *       1 = seg-ext
\par *       2 = ref-ext
\par *       3 = map-ext
\par *
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define Seq_code_iupacna 1
\par #define Seq_code_iupacaa 2
\par #define Seq_code_ncbi2na 3
\par #define Seq_code_ncbi4na 4
\par #define Seq_code_ncbi8na 5
\par #define Seq_code_ncbipna 6
\par #define Seq_code_ncbi8aa 7
\par #define Seq_code_ncbieaa 8
\par #define Seq_code_ncbipaa 9
\par #define Seq_code_iupacaa3 10
\par #define Seq_code_ncbistdaa 11
\par 
\par #define Seq_repr_virtual 1
\par #define Seq_repr_raw    2
\par #define Seq_repr_seg    3
\par #define Seq_repr_const  4
\par #define Seq_repr_ref    5
\par #define Seq_repr_consen 6
\par #define Seq_repr_map    7
\par #define Seq_repr_other  255
\par 
\par #define Seq_mol_dna     1
\par #define Seq_mol_rna     2
\par #define Seq_mol_aa      3
\par #define Seq_mol_na      4
\par #define Seq_mol_other   255
\par #define ISA_na(x)  ((x==1)||(x==2)||(x==4))
\par #define ISA_aa(x)  (x == 3)
\par 
\par typedef struct bioseq \{
\par     SeqIdPtr id;          /* Seq-ids */
\par     ValNodePtr descr;              /* Seq-descr */
\par     Uint1 repr,
\par         mol;
\par     Int4 length;            /* -1 if not set */
\par     IntFuzzPtr fuzz;
\par     Uint1 topology,
\par         strand,
\par         seq_data_type,      /* as in Seq_code_type above */
\par         seq_ext_type;
\par     ByteStorePtr seq_data;
\par     Pointer seq_ext;
\par     SeqAnnotPtr annot;
\par \tab SeqHistPtr hist;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} Bioseq, PNTR BioseqPtr;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par BioseqPtr BioseqNew PROTO((void));
\par Boolean BioseqAsnWrite PROTO((BioseqPtr bsp, AsnIoPtr aip, AsnTypePtr atp));
\par BioseqPtr BioseqAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par BioseqPtr BioseqFree PROTO((BioseqPtr bsp));
\par 
\par Boolean BioseqInstAsnWrite PROTO((BioseqPtr bsp, AsnIoPtr aip, AsnTypePtr orig));
\par Boolean BioseqInstAsnRead PROTO((BioseqPtr bsp, AsnIoPtr aip, AsnTypePtr orig));
\par 
\par BioseqPtr PNTR BioseqInMem PROTO((Int2Ptr numptr));
\par 
\par /*****************************************************************************
\par *
\par *   Initialize bioseq and seqcode tables and default numbering
\par *
\par *****************************************************************************/
\par Boolean BioseqLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   BioseqAsnRead Options
\par *
\par *****************************************************************************/
\par 
\par typedef struct op_objseq \{
\par \tab SeqIdPtr sip;          /* seq id to find */
\par \tab Boolean found_it;      /* set to TRUE when BioseqAsnRead matches sip */
\par \tab Boolean load_by_id;    /* if TRUE, load only if sip matches */
\par \} Op_objseq, PNTR Op_objseqPtr;
\par 
\par /* types for AsnIoOption OP_NCBIOBJSEQ */
\par #define BIOSEQ_CHECK_ID 1    /* match Op_objseq.sip */
\par 
\par /*****************************************************************************
\par *
\par *   SeqDescr uses an ValNode with choice = 
\par     1 = * mol-type GIBB-mol ,          -- type of molecule
\par     2 = ** modif SET OF GIBB-mod ,      -- modifiers
\par     3 = * method GIBB-method ,         -- sequencing method
\par     4 = name VisibleString ,         -- a name for this sequence
\par     5 = title VisibleString ,        -- a title for this sequence
\par     6 = org Org-ref ,                -- if all from one organism
\par     7 = comment VisibleString ,      -- a more extensive comment
\par     8 = num Numbering ,              -- a numbering system
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    9 = maploc Dbtag ,               -- map location of this sequence
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    10 = pir PIR-block ,              -- PIR specific info
\par     11 = genbank GB-block ,           -- GenBank specific info
\par     12 = pub Pubdesc                 -- a reference to the publication
\par     13 = region VisibleString        -- name for this region of sequence
\par     14 = user UserObject             -- user structured data object
\par     15 = sp SP-block                 -- SWISSPROT specific info
\par     16 = neighbors Entrez-link       -- links to sequence neighbors
\par \tab 17 = embl EMBL-block             -- EMBL specific info
\par \tab 18 = create-date Date            -- date entry created
\par \tab 19 = update-date Date            -- date of last update
\par \tab 20 = prf PRF-block \tab \tab \tab \tab  -- PRF specific information
\par \tab 21 = pdb PDB-block              -- PDB specific information
\par \tab 22 = het Heterogen              -- cofactor, etc associated but not bound
\par 
\par     types with * use data.intvalue.  Other use data.ptrvalue
\par     ** uses a chain of ValNodes which use data.intvalue for enumerated type
\par *
\par *****************************************************************************/
\par #define Seq_descr_mol_type 1
\par #define Seq_descr_modif 2
\par #define Seq_descr_method 3
\par #define Seq_descr_name 4
\par #define Seq_descr_title 5
\par #define Seq_descr_org 6
\par #define Seq_descr_comment 7
\par #define Seq_descr_num 8
\par #define Seq_descr_maploc 9
\par #define Seq_descr_pir 10
\par #define Seq_descr_genbank 11
\par #define Seq_descr_pub 12
\par #define Seq_descr_region 13
\par #define Seq_descr_user 14
\par #define Seq_descr_sp 15
\par #define Seq_descr_neighbors 16
\par #define Seq_descr_embl 17
\par #define Seq_descr_create_date 18
\par #define Seq_descr_update_date 19
\par #define Seq_descr_prf 20
\par #define Seq_descr_pdb 21
\par #define Seq_descr_het 22
\par 
\par Boolean SeqDescrAsnWrite PROTO((ValNodePtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr SeqDescrAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par ValNodePtr SeqDescrFree PROTO((ValNodePtr anp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {/*****************************************************************************
\par *
\par *   Pubdesc and Numbering types defined in objpubd.h
\par *
\par *****************************************************************************/
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430432}{\*\bkmkstart _Toc294430909}{\*\bkmkstart _Toc300649309}C Structures and Functions: objpubd.h{\*\bkmkend _Toc294430432}{\*\bkmkend _Toc294430909}{\*\bkmkend _Toc300649309}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objpubd.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objpubd.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* File Description:  Object manager interface for type Pubdesc from
\par *                    NCBI-Sequence.  This is separate to avoid typedef
\par *                    order problems with NCBI-Sequence and NCBI-Seqfeat
\par *                    which both reference Pubdesc
\par *   \tab \tab \tab \tab    Numbering and Heterogen have now also been added
\par *   \tab \tab \tab \tab for the same reason.  Heterogen is just a string,
\par *   \tab \tab \tab \tab so no special typedefs are required.
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Pubdesc_
\par #define _NCBI_Pubdesc_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   Pubdesc
\par *
\par *****************************************************************************/
\par typedef struct pd \{
\par     ValNodePtr pub;          /* points to Pub-equiv */
\par     CharPtr name,
\par         fig;
\par     ValNodePtr num;          /* points to Numbering */
\par     Boolean numexc,
\par         poly_a;
\par     Uint1 align_group;       /* 0 = not part of a group */
\par     CharPtr maploc,
\par         seq_raw,
\par \tab \tab comment;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} Pubdesc, PNTR PubdescPtr;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par PubdescPtr PubdescNew PROTO((void));
\par Boolean PubdescAsnWrite PROTO((PubdescPtr pdp, AsnIoPtr aip, AsnTypePtr atp));
\par PubdescPtr PubdescAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PubdescPtr PubdescFree PROTO((PubdescPtr pdp));
\par 
\par typedef ValNodePtr NumberingPtr;
\par 
\par /*****************************************************************************
\par *
\par *   Numbering uses an ValNode with choice = 
\par     1 = cont Num-cont ,              -- continuous numbering
\par     2 = enum Num-enum ,              -- enumerated names for residues
\par     3 = ref Num-ref, type 1 sources  -- by reference to another sequence
\par     4 = ref Num-ref, type 2 aligns  (SeqAlign in data.ptrvalue)
\par     5 = real Num-real     -- for maps etc
\par *
\par *****************************************************************************/
\par 
\par #define Numbering_cont 1
\par #define Numbering_enum 2
\par #define Numbering_ref_source 3
\par #define Numbering_ref_align 4
\par #define Numbering_real 5
\par 
\par Boolean NumberingAsnWrite PROTO((NumberingPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par NumberingPtr NumberingAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par NumberingPtr NumberingFree PROTO((NumberingPtr anp));
\par 
\par /*****************************************************************************
\par *
\par *   NumCont - continuous numbering system
\par *
\par *****************************************************************************/
\par typedef struct numcont \{
\par     Int4 refnum;
\par     Boolean has_zero,
\par         ascending;
\par \} NumCont, PNTR NumContPtr;
\par 
\par NumContPtr NumContNew PROTO((void));
\par Boolean NumContAsnWrite PROTO((NumContPtr ncp, AsnIoPtr aip, AsnTypePtr atp));
\par NumContPtr NumContAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par NumContPtr NumContFree PROTO((NumContPtr ncp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {/*****************************************************************************
\par *
\par *   NumEnum - enumerated numbering system
\par *
\par *****************************************************************************/
\par typedef struct numenum \{
\par     Int4 num;               /* number of names */
\par     CharPtr buf;            /* a buffer for the names */
\par     CharPtr PNTR names;     /* array of pointers to names */
\par \} NumEnum, PNTR NumEnumPtr;
\par 
\par NumEnumPtr NumEnumNew PROTO((void));
\par Boolean NumEnumAsnWrite PROTO((NumEnumPtr nep, AsnIoPtr aip, AsnTypePtr atp));
\par NumEnumPtr NumEnumAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par NumEnumPtr NumEnumFree PROTO((NumEnumPtr nep));
\par 
\par /*****************************************************************************
\par *
\par *   NumReal - float type numbering system
\par *
\par *****************************************************************************/
\par typedef struct numreal \{
\par     FloatHi a, b;        /* number in "units" = ax + b */
\par     CharPtr units;
\par \} NumReal, PNTR NumRealPtr;
\par 
\par NumRealPtr NumRealNew PROTO((void));
\par Boolean NumRealAsnWrite PROTO((NumRealPtr ncp, AsnIoPtr aip, AsnTypePtr atp));
\par NumRealPtr NumRealAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par NumRealPtr NumRealFree PROTO((NumRealPtr ncp));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430433}{\*\bkmkstart _Toc294430910}{\*\bkmkstart _Toc300649310}C Structures and Functions: objblock.h{\*\bkmkend _Toc294430433}{\*\bkmkend _Toc294430910}{\*\bkmkend _Toc300649310}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objblock.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  terms of the United States Copyright Act.  It was written as part of    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objblock.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager for module GenBank-General,
\par *   \tab \tab \tab \tab \tab EMBL-General, PIR-General, SWISSPROT-General
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_SeqBlock_
\par #define _NCBI_SeqBlock_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#include <objgen.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#endif
\par #ifndef _NCBI_Seqloc_
\par #include <objloc.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqBlockAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   PirBlock - PIR specific data elements
\par *
\par *****************************************************************************/
\par typedef struct pirblock \{
\par     Boolean had_punct;
\par     CharPtr host,
\par         source,
\par         summary,
\par         genetic,
\par         includes,
\par         placement,
\par         superfamily,
\par         cross_reference,
\par         date,
\par         seq_raw;
\par     ValNodePtr keywords;
\par     SeqIdPtr seqref;
\par \} PirBlock, PNTR PirBlockPtr;
\par 
\par PirBlockPtr PirBlockNew PROTO((void));
\par Boolean PirBlockAsnWrite PROTO((PirBlockPtr pbp, AsnIoPtr aip, AsnTypePtr atp));
\par PirBlockPtr PirBlockAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PirBlockPtr PirBlockFree PROTO((PirBlockPtr pbp));
\par 
\par /*****************************************************************************
\par *
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*   GBBlock - GenBank specific data elements
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par *****************************************************************************/
\par typedef struct gbblock \{
\par     ValNodePtr extra_accessions,
\par         keywords;
\par     CharPtr source,
\par         origin,
\par         date,
\par         div,
\par         taxonomy;
\par     DatePtr entry_date;
\par \} GBBlock, PNTR GBBlockPtr;
\par 
\par GBBlockPtr GBBlockNew PROTO((void));
\par Boolean GBBlockAsnWrite PROTO((GBBlockPtr gbp, AsnIoPtr aip, AsnTypePtr atp));
\par GBBlockPtr GBBlockAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par GBBlockPtr GBBlockFree PROTO((GBBlockPtr gbp));
\par 
\par /*****************************************************************************
\par *
\par *   SPBlock - SWISSPROT specific data elements
\par *
\par *****************************************************************************/
\par typedef struct spblock \{
\par     Uint1 _class;
\par     ValNodePtr extra_acc;
\par     Boolean imeth;
\par     ValNodePtr plasnm;
\par     SeqIdPtr seqref;
\par     ValNodePtr dbref;
\par     ValNodePtr keywords;
\par \tab NCBI_DatePtr created,
\par \tab \tab sequpd,
\par \tab \tab annotupd;
\par \} SPBlock, PNTR SPBlockPtr;
\par 
\par SPBlockPtr SPBlockNew PROTO((void));
\par Boolean SPBlockAsnWrite PROTO((SPBlockPtr sbp, AsnIoPtr aip, AsnTypePtr atp));
\par SPBlockPtr SPBlockAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SPBlockPtr SPBlockFree PROTO((SPBlockPtr sbp));
\par 
\par /*****************************************************************************
\par *
\par *   EMBLBlock - EMBL specific data elements
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par typedef struct emblxref \{
\par \tab Uint1 _class;\tab \tab 
\par \tab CharPtr name;\tab \tab \tab /* NULL if class used */
\par \tab ValNodePtr id;          /* ValNode->data.ptrvalue is an ObjectIdPtr */
\par \tab struct emblxref PNTR next;
\par \} EMBLXref, PNTR EMBLXrefPtr;
\par 
\par typedef struct emblblock \{
\par     Uint1 _class,
\par \tab \tab div;               /* 255 = not set */
\par \tab NCBI_DatePtr creation_date ,
\par \tab \tab update_date;
\par     ValNodePtr extra_acc;
\par     ValNodePtr keywords;
\par \tab EMBLXrefPtr xref;
\par \} EMBLBlock, PNTR EMBLBlockPtr;
\par 
\par EMBLBlockPtr EMBLBlockNew PROTO((void));
\par Boolean EMBLBlockAsnWrite PROTO((EMBLBlockPtr ebp, AsnIoPtr aip, AsnTypePtr atp));
\par EMBLBlockPtr EMBLBlockAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par EMBLBlockPtr EMBLBlockFree PROTO((EMBLBlockPtr ebp));
\par 
\par /*****************************************************************************
\par *
\par *\tab PRF-Block\tab - PRF specific data emements
\par *\tab \tab \tab \tab by A.Ogiwara
\par *****************************************************************************/
\par typedef struct prfextsrc \{
\par \tab CharPtr\tab \tab host;
\par \tab CharPtr\tab \tab part;
\par \tab CharPtr\tab \tab state;
\par \tab CharPtr\tab \tab strain;
\par \tab CharPtr\tab \tab taxon;
\par \} PrfExtSrc, PNTR PrfExtSrcPtr;
\par 
\par typedef struct prfblock \{
\par \tab PrfExtSrcPtr\tab extra_src;
\par \tab ValNodePtr\tab keywords;
\par \} PrfBlock, PNTR PrfBlockPtr;
\par 
\par PrfBlockPtr\tab PrfBlockNew\tab PROTO((void));
\par Boolean\tab \tab PrfBlockAsnWrite\tab PROTO((PrfBlockPtr pbp, AsnIoPtr aip,
\par \tab \tab \tab \tab \tab \tab AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {PrfBlockPtr\tab PrfBlockAsnRead\tab PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {PrfBlockPtr\tab PrfBlockFree\tab PROTO((PrfBlockPtr pbp));
\par 
\par 
\par /*****************************************************************************
\par *
\par *\tab PDB-Block\tab - PDB specific data emements
\par *
\par *****************************************************************************/
\par 
\par typedef struct pdbreplace \{
\par \tab DatePtr date;
\par \tab ValNodePtr ids;
\par \}
\par PdbRep, PNTR PdbRepPtr;
\par 
\par typedef struct pdbblock \{
\par \tab DatePtr deposition ;
\par \tab CharPtr class ;
\par \tab ValNodePtr compound ;
\par \tab ValNodePtr source ;
\par \tab CharPtr exp_method ;
\par \tab PdbRepPtr replace;
\par \}
\par PdbBlock, PNTR PdbBlockPtr;
\par 
\par PdbBlockPtr\tab PdbBlockNew\tab PROTO((void));
\par Boolean\tab \tab PdbBlockAsnWrite\tab PROTO((PdbBlockPtr pdbp, AsnIoPtr aip,
\par \tab \tab \tab \tab \tab \tab AsnTypePtr atp));
\par PdbBlockPtr\tab PdbBlockAsnRead\tab PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PdbBlockPtr\tab PdbBlockFree\tab PROTO((PdbBlockPtr pdbp));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430434}{\*\bkmkstart _Toc294430911}{\*\bkmkstart _Toc300649311}C Structures and Functions: objcode.h{\*\bkmkend _Toc294430434}{\*\bkmkend _Toc294430911}{\*\bkmkend _Toc300649311}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objcode.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  This software/database is a "United States Government Work" under the   
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objcode.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 8/10/92
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-SeqCode
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_SeqCode_
\par #define _NCBI_SeqCode_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifdef __cplusplus
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqCodeAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   SeqMapTable - Table from mapping sequence codes to each other
\par *      Codes ALWAYS start from 0 and increase continuously
\par *      IUPAC has 65 empty rows
\par *
\par *****************************************************************************/
\par typedef struct seqmaptable \{
\par     Uint1 from,                 /* as ENUMERATED in Seq-code-type */
\par         to;
\par     Uint1 num;
\par     Uint1 start_at;
\par     Uint1Ptr table;
\par     struct seqmaptable PNTR next;
\par \} SeqMapTable, PNTR SeqMapTablePtr;
\par 
\par SeqMapTablePtr SeqMapTableNew PROTO((void));
\par Boolean SeqMapTableAsnWrite PROTO((SeqMapTablePtr smp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqMapTablePtr SeqMapTableAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqMapTablePtr SeqMapTableFree PROTO((SeqMapTablePtr smp));
\par 
\par SeqMapTablePtr SeqMapTableFind PROTO((Uint1 to, Uint1 from));
\par 
\par /*****************************************************************************
\par *
\par *   SeqCodeTable - Table of sequence codes
\par *       in code order, starting with 0 and increasing continuously
\par *
\par *****************************************************************************/
\par typedef struct seqcodetable \{
\par     Uint1 code;                        /* as ENUMERATED in Seq-code-type */
\par     Uint1 num;                          /* number of codes */
\par     Boolean one_letter;                  /* one letter codes? */
\par     Uint1 start_at;                     /* index offset of first code */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    CharPtr letters;                   /* one letter codes */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    CharPtr PNTR symbols;              /* multi-length codes */
\par     CharPtr PNTR names;                /* explanatory names */
\par     Uint1Ptr comps;                    /* maps to complements */
\par     struct seqcodetable PNTR next;
\par \} SeqCodeTable, PNTR SeqCodeTablePtr;
\par 
\par SeqCodeTablePtr SeqCodeTableNew PROTO((void));
\par Boolean SeqCodeTableAsnWrite PROTO((SeqCodeTablePtr scp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqCodeTablePtr SeqCodeTableAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqCodeTablePtr SeqCodeTableFree PROTO((SeqCodeTablePtr scp));
\par 
\par SeqCodeTablePtr SeqCodeTableFind PROTO((Uint1 code));
\par 
\par /*****************************************************************************
\par *
\par *   SeqCodeSet - Set of sequence codes and maps
\par *
\par *****************************************************************************/
\par typedef struct seqcodeset \{
\par     SeqCodeTablePtr codes;
\par     SeqMapTablePtr maps;
\par \} SeqCodeSet, PNTR SeqCodeSetPtr;
\par 
\par SeqCodeSetPtr SeqCodeSetNew PROTO((void));
\par Boolean SeqCodeSetAsnWrite PROTO((SeqCodeSetPtr ssp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqCodeSetPtr SeqCodeSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqCodeSetPtr SeqCodeSetFree PROTO((SeqCodeSetPtr ssp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqCodeSetLoad()
\par *       loads the standard sequence codes from "seqcode.val" in "data"
\par *
\par *****************************************************************************/
\par SeqCodeSetPtr SeqCodeSetLoad PROTO((void));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 192}}}{\b0 \tab Biological Sequence Sets}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Biological Sequence Sets   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 193}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field\flddirty{\*\fldinst {\b0\fs20 include seqset.doc}}{\fldrslt {{\*\bkmkstart _Toc294430435}{\*\bkmkstart _Toc294430912}{\*\bkmkstart _Toc300649312}Collections of Sequences{\*\bkmkend _Toc294430435}{\*\bkmkend _Toc294430912}{\*\bkmkend _Toc300649312}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430436}{\*\bkmkstart _Toc294430913}{\*\bkmkstart _Toc300649313}Introduction{\*\bkmkend _Toc294430436}{\*\bkmkend _Toc294430913}{\*\bkmkend _Toc300649313}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A biological sequence is often most appropriately stored in the context of other, related sequences. Such a collection might have a biological basis (e.g. a nucleic acid and its translated proteins, or the chains of an enzyme complex) or some other basis (e.g. a release of GenBank, or the sequences published in an article). The Bioseq-set provides a framework for collections of sequences.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430437}{\*\bkmkstart _Toc294430914}{\*\bkmkstart _Toc300649314}Seq-entry: The Sequence Entry{\*\bkmkend _Toc294430437}{\*\bkmkend _Toc294430914}{\*\bkmkend _Toc300649314}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Sometimes a sequence is not part of a collection (e.g. a single annotated protein). Thus a sequence entry could be either a single Bioseq or a collection of them. A Seq-entry is an entity which represents this choice. A great deal of NCBI software is designed to accept a Seq-entry as the primary unit of data. This is the most powerful and flexible object to use as a target software developement in general.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430438}{\*\bkmkstart _Toc294430915}{\*\bkmkstart _Toc300649315}Bioseq-set: A Set Of Seq-entrys{\*\bkmkend _Toc294430438}{\*\bkmkend _Toc294430915}{\*\bkmkend _Toc300649315}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Bioseq-set contains a convenient collection of Seq-entrys. It can have descriptors and annotations just like a single Bioseq (see Biological Sequences). It can have identifiers for the set, although these are less thoroughly controlled than Seq-ids at this time. Since the "heart" of a Bioseq-set is a collection of Seq-entrys, which themselves are either a Bioseq or a Bioseq-set, a Bioseq-set can recursively contain other sets. This recursive property makes for a very rich data structure, and a necessary one for biological sequence data, but presents new challenges for software to manipulate and display it. We will discuss some guidelines for building and using Bioseq-sets below, based on the NCBI experience to date.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430439}{\*\bkmkstart _Toc294430916}{\*\bkmkstart _Toc300649316}id: local identifier for this set{\*\bkmkend _Toc294430439}{\*\bkmkend _Toc294430916}{\*\bkmkend _Toc300649316}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The id field just contains an integer or string to identify this set for internal use by a software system or database. This is useful for building collections of sequences for temporary use, but still be able to cite them.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430440}{\*\bkmkstart _Toc294430917}{\*\bkmkstart _Toc300649317}coll: global identifier for this set{\*\bkmkend _Toc294430440}{\*\bkmkend _Toc294430917}{\*\bkmkend _Toc300649317}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The coll field is a Dbtag, which will accept a string to identify a source database and a string or integer as an identifier within that database. This semi-controlled form provides a global identifier for the set of sequences in a simple way.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430441}{\*\bkmkstart _Toc294430918}{\*\bkmkstart _Toc300649318}level: nesting level of set{\*\bkmkend _Toc294430441}{\*\bkmkend _Toc294430918}{\*\bkmkend _Toc300649318}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Since Bioseq-sets are recursive, the level integer was conceived as way of expliciting indicating the nesting level. In practice we have found this to be little or no use and recommend it be ignored and eventually removed.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430442}{\*\bkmkstart _Toc294430919}{\*\bkmkstart _Toc300649319}class: classification of sets{\*\bkmkend _Toc294430442}{\*\bkmkend _Toc294430919}{\*\bkmkend _Toc300649319}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The class field is an attempt to classify sets of sequences that may be widely used. There are a number which are just releases of well known databases and others which represent biological groupings.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Bioseq-set classes
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx2274\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8635\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b ASN.1 name\cell Explanation\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2274\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8635\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {not-set\cell not determined\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx2274\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8635\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {nuc-prot\cell a nucleic acid and the proteins from its coding regions\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {segset\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {a segmented Bioseq and the Bioseqs it is made from\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {conset\cell a constructed Bioseq and the Bioseqs it was assembled from\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {parts\cell a set cotained within a segset or conset holding the Bioseqs which are the components of the segmented or constructed Bioseq\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {gibb\cell GenInfo Backbone entries (NCBI Journal Scanning Database)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {gi\cell GenInfo entries (NCBI ID Database)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {genbank\cell GenBank entries\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pir\cell PIR entries\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pub-set\cell all the Seq-entrys from a single publication\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {equiv\cell a set of equivalent representations of the same sequence (e.g. a genetic map Bioseq and a physical map Bioseq for the same chromosome)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {swissprot\cell SWISSPROT entries\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {pdb-entry\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {all the Bioseqs associated with a single PDB structure\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx2274\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8635\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {255\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {other\cell new type. Usually Bioseq-set.release will have an explanatory string\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430443}{\*\bkmkstart _Toc294430920}{\*\bkmkstart _Toc300649320}release: an explanatory string{\*\bkmkend _Toc294430443}{\*\bkmkend _Toc294430920}{\*\bkmkend _Toc300649320}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is just a free text field which can contain a human readable description of the set. Often used to show which release of GenBank, for example.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430444}{\*\bkmkstart _Toc294430921}{\*\bkmkstart _Toc300649321}date:{\*\bkmkend _Toc294430444}{\*\bkmkend _Toc294430921}{\*\bkmkend _Toc300649321}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is a date associated with the creation of this set.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430445}{\*\bkmkstart _Toc294430922}{\*\bkmkstart _Toc300649322}descr: Seq-descr for this set{\*\bkmkend _Toc294430445}{\*\bkmkend _Toc294430922}{\*\bkmkend _Toc300649322}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Just like a Bioseq, a Bioseq-set can have Seq-descr (see Biological Sequences) which set it in a biological or bibliographic context, or confer a title or a name. The rule for descriptors at the set level is that they apply to "all of everything below". So if an Org-ref is given at the set level, it means that every Bioseq in the set comes from that organism. If this is not true, then Org-ref would not appear on the set, but different Org-refs would occur on lower level members.
\par For any Bioseq in arbitrarily deeply nested Bioseq-sets, one should be able to collect all Bioseq-set.descr from all higher level Bioseq-sets that contain the Bioseq, and move them to the Bioseq. If this process introduces any confusion or contradiction, then the set level descriptor has been incorrectly used.
\par The only exception to this is the title and name types, which often refer to the set level on which they are placed (a nuc-prot may have the title "Adh gene and ADH protein", while the Bioseqs have the titles "Adh gene" and "ADH protein". The gain in code sharing by using exactly the same Seq-descr for Bioseq or Bioseq-set seemed to outweigh the price of this one exception to the rule.
\par To simplify access to elements like this that depend on a set context, a series of BioseqContext() functions are provided in utilities which allow easy access to all relevant descriptors starting with a specific Bioseq and moving up the levels in the set.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430446}{\*\bkmkstart _Toc294430923}{\*\bkmkstart _Toc300649323}seq-set: the sequences and sets within the Bioseq-set{\*\bkmkend _Toc294430446}{\*\bkmkend _Toc294430923}{\*\bkmkend _Toc300649323}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The seq-set field contains a SEQUENCE OF Seq-entry which represent the contents of the Bioseq-set. As mentioned above, these may be nested internally to any level. Although there is no guarantee that members of a set will come in any particular order, NCBI finds the following conventions useful and natural.
\par For sets of entries from specific databases, each Seq-entry is the "natural" size of an entry from that databases. Thus GenBank will contain a set of Seq-entry which will be a mixture of Bioseq (just a nucleic acid, no coding regions), seg-set (segmented nucleic acid, no coding regions), or nuc-prot (nucleic acid (as Bioseq or seg-set) and proteins from the translated coding regions). PDB will contain a mixture of Bioseq (single chain structures) or pdb-entry (multi-chain structures).
\par }\pard \sb240\keepn\widctlpar\adjustright {A segset, representing a segmented sequence combines the segmented Bioseq with the set of the Bioseqs that make it up.
\par }\pard\plain \s28\li1440\ri1440\keep\keepn\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {segset (Bioseq-set) contains
\par \tab segmented sequence (Bioseq)
\par \tab parts (Bioseq-set) contains
\par \tab \tab first piece (Bioseq)
\par \tab \tab second piece (Bioseq
\par \tab \tab etc
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A consset has the same layout as a segset, except the top level Bioseq is constructured rather than segmented.
\par }\pard \sb240\keepn\widctlpar\adjustright {A nuc-prot set gives the nucleic acid and its protein products at the same levels.
\par }\pard\plain \s28\li1440\ri1440\keep\keepn\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {nuc-prot (Bioseq-set) contains
\par \tab nucleic acid (Bioseq)
\par \tab protein1 (Bioseq)
\par \tab protein2 (Bioseq)
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\tab etc.
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {A nuc-prot set where the nucleic acid is segmented simply replaces the nucleic acid Bioseq with a seg-set.
\par }\pard\plain \s28\li1440\ri1440\keepn\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {nuc-prot (Bioseq-set) contains
\par \tab nucleic acid segset (Bioseq-set) contains
\par \tab \tab segmented sequence (Bioseq)
\par \tab \tab parts (Bioseq-set) contains
\par \tab \tab \tab first piece (Bioseq)
\par \tab \tab \tab second piece (Bioseq
\par \tab \tab \tab etc
\par \tab protein1 (Bioseq)
\par \tab protein2 (Bioseq)
\par }\pard \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright {\tab etc.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430447}{\*\bkmkstart _Toc294430924}{\*\bkmkstart _Toc300649324}annot: Seq-annots for the set{\*\bkmkend _Toc294430447}{\*\bkmkend _Toc294430924}{\*\bkmkend _Toc300649324}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Bioseq-set can have Seq-annots just like a Bioseq can. Because all forms of Seq-annot use explicit ids for the Bioseqs they reference, there is no dependence on context. Any Seq-annot can appear at any level of nesting in the set (or even stand alone) without any loss of information.
\par However, as a convention, NCBI puts the Seq-annot at the nesting level of the set that contains all the Bioseqs referenced by it, if possible. So if a feature applies just to one Bioseq, it goes in the Bioseq.annot itself. If it applies to all the members of a segmented set, it goes in Bioseq-set.annot of the segset. If, like a coding region, it points to both nucleic acid and protein sequences, it goes in the Bioseq-set.annot of the nuc-prot set.
\par The utilities include BioseqContextGetSeqFeat() which provides a convenient way of getting all the features that apply to a particular Bioseq in a set, not matter where in the nesting they occur.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430448}{\*\bkmkstart _Toc294430925}{\*\bkmkstart _Toc300649325}Bioseq-sets are Convenient Packages{\*\bkmkend _Toc294430448}{\*\bkmkend _Toc294430925}{\*\bkmkend _Toc300649325}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Remember that Bioseq-sets are just convenient ways to package Bioseqs and associated annotations. But Bioseqs may appear in various contexts and software should always be prepared to deal with them that way. A segmented Bioseq may not appear as part of a segset and a Bioseq with coding regions may not appear as part of a nuc-prot set. In both cases the elements making up the segmented Bioseq and the Bioseqs involved in the coding regions all use Seq-locs, which explicit reference Seq-ids. So they are not dependent on context. NCBI packages Bioseqs in sets for convenience, so all the closely related elements can be retrieved together. But this is only a convenience, not a requirement of the specification. The same caveat applies to the ordering conventions within a set, described above.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430449}{\*\bkmkstart _Toc294430926}{\*\bkmkstart _Toc300649326}ASN.1 Specification: seqset.asn{\*\bkmkend _Toc294430449}{\*\bkmkend _Toc294430926}{\*\bkmkend _Toc300649326}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.1 $
\par --**********************************************************************
\par --
\par --  NCBI Sequence Collections
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Seqset DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Bioseq-set, Seq-entry;
\par 
\par IMPORTS Bioseq, Seq-annot, Seq-descr FROM NCBI-Sequence
\par         Object-id, Dbtag, Date FROM NCBI-General;
\par 
\par --*** Sequence Collections ********************************
\par --*
\par 
\par Bioseq-set ::= SEQUENCE \{      -- just a collection
\par     id Object-id OPTIONAL ,
\par     coll Dbtag OPTIONAL ,          -- to identify a collection
\par     level INTEGER OPTIONAL ,       -- nesting level
\par     class ENUMERATED \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        not-set (0) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        nuc-prot (1) ,              -- nuc acid and coded proteins
\par         segset (2) ,                -- segmented sequence + parts
\par         conset (3) ,                -- constructed sequence + parts
\par         parts (4) ,                 -- parts for 2 or 3
\par         gibb (5) ,                  -- geninfo backbone
\par         gi (6) ,                    -- geninfo
\par         genbank (7) ,               -- converted genbank
\par         pir (8) ,                   -- converted pir
\par         pub-set (9) ,               -- all the seqs from a single publication
\par         equiv (10) ,                -- a set of equivalent maps or seqs
\par \tab \tab swissprot (11) ,            -- converted SWISSPROT
\par \tab \tab pdb-entry (12) ,            -- a complete PDB entry
\par         other (255) \} DEFAULT not-set ,
\par     release VisibleString OPTIONAL ,
\par     date Date OPTIONAL ,
\par     descr Seq-descr OPTIONAL ,
\par     seq-set SEQUENCE OF Seq-entry ,
\par     annot SET OF Seq-annot OPTIONAL \}
\par 
\par Seq-entry ::= CHOICE \{
\par         seq Bioseq ,
\par         set Bioseq-set \} 
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430450}{\*\bkmkstart _Toc294430927}{\*\bkmkstart _Toc300649327}C Structures and Functions: objsset.h{\*\bkmkend _Toc294430450}{\*\bkmkend _Toc294430927}{\*\bkmkend _Toc300649327}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objsset.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  purpose.                                                                
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objsset.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Seqset
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seqset_
\par #define _NCBI_Seqset_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par #ifndef _NCBI_Seq_
\par #include <objseq.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par typedef ValNodePtr SeqEntryPtr;
\par 
\par /*****************************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqSetAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-Seqset objects
\par *
\par *****************************************************************************/
\par /*****************************************************************************
\par *
\par *   BioseqSet - a collection of sequences
\par *
\par *****************************************************************************/
\par typedef struct seqset \{
\par     ObjectIdPtr id;
\par     DbtagPtr coll;
\par     Int2 level;            /* set to INT2_MIN (ncbilcl.h) for not used */
\par     Uint1 _class;
\par     CharPtr release;
\par     DatePtr date;
\par     ValNodePtr descr;
\par     SeqEntryPtr seq_set;
\par     SeqAnnotPtr annot;
\par \} BioseqSet, PNTR BioseqSetPtr;
\par 
\par BioseqSetPtr BioseqSetNew PROTO((void));
\par Boolean BioseqSetAsnWrite PROTO((BioseqSetPtr bsp, AsnIoPtr aip, AsnTypePtr atp));
\par BioseqSetPtr BioseqSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par BioseqSetPtr BioseqSetFree PROTO((BioseqSetPtr bsp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqEntry - implemented as an ValNode
\par *     choice:
\par *       1 = Bioseq
\par *       2 = Bioseq-set
\par *
\par *****************************************************************************/
\par 
\par SeqEntryPtr SeqEntryNew PROTO((void));
\par Boolean SeqEntryAsnWrite PROTO((SeqEntryPtr sep, AsnIoPtr aip, AsnTypePtr atp));
\par SeqEntryPtr SeqEntryAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {SeqEntryPtr SeqEntryFree PROTO((SeqEntryPtr sep));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {SeqEntryPtr PNTR SeqEntryInMem PROTO((Int2Ptr numptr));
\par 
\par /*****************************************************************************
\par *
\par *   Options for SeqEntryAsnRead()
\par *
\par *****************************************************************************/
\par SeqEntryPtr SeqEntryAsnGet PROTO((AsnIoPtr aip, AsnTypePtr atp, SeqIdPtr sip, Int2 retcode));
\par 
\par #define SEQENTRY_OPTION_MAX_COMPLEX 1   /* option type to use with OP_NCBIOBJSSET */
\par 
\par     /* values for retcode, implemented with AsnIoOptions */
\par #define SEQENTRY_READ_BIOSEQ 1    /* read only Bioseq identified by sip */
\par #define SEQENTRY_READ_SEG_SET 2   /* read any seg-set it may be part of */
\par #define SEQENTRY_READ_NUC_PROT 3   /* read any nuc-prot set it may be in */
\par #define SEQENTRY_READ_PUB_SET 4    /* read pub-set it may be part of */
\par 
\par typedef struct objsset_option \{
\par \tab SeqIdPtr sip;              /* seq-id to find */
\par \tab Int2 retcode;              /* type of set/seq to return */
\par \tab Boolean in_right_set;
\par \tab Uint1 working_on_set;      /* 2, if in first set of retcode type */
\par \tab                            /* 1, if found Bioseq, but not right set */
\par \tab                            /* 0, if Bioseq not yet found */
\par \} Op_objsset, PNTR Op_objssetPtr;
\par 
\par 
\par #define IS_Bioseq(a) (a->choice == 1)
\par #define IS_Bioseq_set(a)  (a->choice == 2)
\par 
\par /*****************************************************************************
\par *
\par *   loader for ObjSeqSet and Sequence Codes
\par *
\par *****************************************************************************/
\par extern Boolean SeqEntryLoad PROTO((void));
\par 
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 212}}}{\b0 \tab Locations and IDs}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Locations and IDs   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 211}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include seqloc.doc}}{\fldrslt {{\*\bkmkstart _Toc294430928}{\*\bkmkstart _Toc300649328}Sequence Locations and Identifiers{\*\bkmkend _Toc294430928}{\*\bkmkend _Toc300649328}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430929}{\*\bkmkstart _Toc300649329}Introduction{\*\bkmkend _Toc294430929}{\*\bkmkend _Toc300649329}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {As described in the Biological Sequences chapter, a Bioseq always has at least one identifier. This means that any valid biological sequence can be referenced by using this identifier. However, all identifiers are not created equal. They may differ in their basic structure (e.g. a GenBank accession number is required to have an uppercase letter followed by exactly five digits while the NCBI GenInfo Id uses a simple integer identifier). They also differ in how they are used (e.g. the sequence identified by the GenBank accession number may change from release to release while the sequence identified by the NCBI GenInfo Id will always be exactly the same sequence).
\par Locations of regions on Bioseqs are always given as integer offsets, also described in the Biological Sequences chapter. So the first residue is always 0 and the last residue is always (length - 1). Further, since all the classes of Bioseqs from bands on a gel to genetic or physical maps to sequenced DNA use the same integer offset convention, locations always have the same form and meaning even when moving between very different types of Bioseq representations. This allows alignment, comparison, and display functions, among others, to have the same uniform interface and semantics, no matter what the underlying Bioseq class. Specialized numbering systems are supported but only as descriptive annotation (see Numbering in Biological Sequences and Feature types "seq" and "num" in Sequence Features). The internal conventions for positions on sequences is always the same.
\par There are no implicit Bioseq locations. All locations include a sequence identifier. This means Features, Alignments, and Graphs are always independent of context and can always be exchanged, submitted to databases, or stored as independent objects. The main consequence of this is that information ABOUT regions of Bioseqs can be developed and contributed to the public scientific discussion without any special rights of editing the Bioseq itself needing to be granted to anyone but the original author of the Bioseq. Bioseqs in the public databases, then, no longer need an anointed curator (beyond the original author) to be included in ongoing scientific discussion and data exchange by electronic media.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430930}{\*\bkmkstart _Toc300649330}Seq-id: Identifying Sequences{\*\bkmkend _Toc294430930}{\*\bkmkend _Toc300649330}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In a pure sense, a Seq-id is meant to unambiguously identify a Bioseq. Unfortunately, different databases have different semantic rules regarding the stability and ambiguity of their best available identifiers. For this reason a Bioseq can have more than one Seq-id, so that the Seq-id with the best semantics for a particular use can be selected from all that are available for that Bioseq, or so that a new Seq-id with different semantics can be conferred on an existing Bioseq. Further, Seq-id is defined as a CHOICE of datatypes which may differ considerably in their structure and semantics from each other. Again, this is because differing sequence databases use different conventions for identifying sequences and it is important not to lose this critical information from the original data source.
\par One Seq-id type, "gi", has been implemented specifically to make a simple, absolutely stable Seq-id available for sequence data derived from any source. It is discussed in detail below.
\par A Textseq-id structure is used in many Seq-ids described below. It has four possible fields; a name, an accession number, a release, and a version. Formally, all fields are OPTIONAL, although to be useful, a Textseq-id should have at least a name or an accession or both. This style of Seq-id is used by GenBank, EMBL, DDBJ, PIR, SWISS-PROT, and PRF, but the semantics of its use differ considerably depending on the database. However none of these databases guarantees the stability of name or accession (i.e. that it points at a specific sequence), so to be unambiguous the id must also have either the release of the database in which the sequence with this id appeared. See the discussion under Seq-id: Semantics for details.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430931}{\*\bkmkstart _Toc300649331}Seq-id: Semantics of Use{\*\bkmkend _Toc294430931}{\*\bkmkend _Toc300649331}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Different databases use their ids different ways and these patterns may change over time. An attempt is made is this section to describe current usage and offer some guidelines for interpreting Seq-ids.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430932}{\*\bkmkstart _Toc300649332}local: Privately Maintained Data{\*\bkmkend _Toc294430932}{\*\bkmkend _Toc300649332}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The local Seq-id is an Object-id (see discussion in General Use Objects), which is a CHOICE of a string or an integer. This is to reconcile the requirement that all Bioseqs have a Seq-id and the needs of local software tools to manipulate data produced or maintained privately. This might be pre-publication data, data still being developed, or proprietary data. The Object-id will accommodate either a string or a number as is appropriate for the local environment. It is the responsibility of local software to keep the local Seq-ids unique. A local Seq-id is not globally unique, so when Bioseqs with such identifiers are published or exchanged, context (i.e. the submittor or owner of the id) must be maintained or a new id class must be applied to the Bioseq (e.g. the assignment of a GenBank accession upon direct data submission to GenBank).
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430933}{\*\bkmkstart _Toc300649333}other: A Local Textseq-id{\*\bkmkend _Toc294430933}{\*\bkmkend _Toc300649333}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The type "other" is a Textseq-id only, it does not carry context (what database is this from?). So it is meant only be used under similar conditions as "local", above, but allows the name/accession system to be used locally instead of being limited to a single string or name as "local" is.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430934}{\*\bkmkstart _Toc300649334}general: Ids from Local Databases{\*\bkmkend _Toc294430934}{\*\bkmkend _Toc300649334}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Seq-id type "general" uses a Dbtag (see discussion in General Use Objects), which is an Object-id as in Seq-id.local, above, with an additional string to identify a source database. This means that an integer or string id from a smaller database can create Seq-ids which both cite the database source and make the local Seq-ids globally unique (usually). For example, the EcoSeq database is a collection of E.coli sequences derived from many sources, curated and maintained by Kenn Rudd. Each sequence in EcoSeq has a unique descriptive name which is used as it's primary identifier. A "general" Seq-id could be make for the EcoSeq entry "EcoAce" by making the following "general" Seq-id:
\par }\pard\plain \s28\li1440\ri1440\keep\widctlpar\box\brdrsh\brdrs\brdrw30\brsp20 \adjustright \b\f16\fs20\cgrid {Seq-id ::= general \{
\par \tab \tab db "EcoSeq" ,
\par \tab \tab tag str "EcoAce" \}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430935}{\*\bkmkstart _Toc300649335}gibbsq, gibbmt: GenInfo Backbone Ids{\*\bkmkend _Toc294430935}{\*\bkmkend _Toc300649335}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The journal scanning component of GenBank was originally know as the "GenInfo Backbone" database. This database is built by NCBI in collaboration with Library Operations at the National Library of Medicine (NLM) by building on the journal abstracting work done for building MEDLINE. This collaboration means more than 3500 different journals (more than 350,000 articles a year) are scanned for sequence containing publications, both nucleic acid and protein. New sequence data which cannot be proven to have been already directly submitted to the sequence databases is entered into the GenInfo Backbone. The data is released as part of the normal NCBI sequence database releases.
\par The Backbone database is a relational database which distinguishes between a simple sequence (equivalent to a virtual or a raw Bioseq) and a complex Bioseq (equivalent to a segmented Bioseq). As a result, every raw or virtual Bioseq produced from the Backbone will have a gibbsq (GenInfo Backbone Seq Id). If that Bioseq is a component of a segmented Bioseq, then the segmented Bioseq will have a gibbmt (GenInfo Backbone Molecule Type Id) but no gibbsq. If the raw or virtual Bioseq is not part of a segmented Bioseq, then it will have both a gibbsq and a gibbmt (the sequence and the molecule are the some).
\par This may seem confusing, and is, in fact, simply the result of the design of this database. For a user of Bioseqs derived from the GenInfo Backbone, it is enough to know three things. Every Bioseq from the Backbone will have a gibbsq, a gibbmt, or both. The gibbsq and gibbmt are simple integers from two independent series. Either a gibbsq or a gibbmt is sufficient to retrieve an entry, but the gibbsq is preferred if available to reference a specific sequence.
\par While sequences identified by a gibbsq or gibbmt are in practice very stable, they are not guaranteed to be stable. If a correction must be made to a sequence in the Backbone, it's id will not be changed. See "gi" below for a guaranteed stable id. Backbone sequences for nucleic acids are assigned a GenBank accession number in addition to it's backbone ids by NCBI.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430936}{\*\bkmkstart _Toc300649336}genbank, embl, ddbj: The International Nucleic Acid Sequence Databases{\*\bkmkend _Toc294430936}{\*\bkmkend _Toc300649336}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {NCBI (GenBank) in the U.S.,  the European Molecular Biology Laboratory datalibrary (EMBL) in Europe, and the DNA Database of Japan (DDBJ) in Japan are members of an international collaboration of nucleic acid sequence databases. Each collects data, often directly submitted by authors, and makes releases of it's data in it's own format independently of each other. However, there are agreements in place for all the parties to exchange information with each other in an attempt to avoid duplication of effort and provide a world wide comprehensive database to their users. So a release by one of these databases is actually a composite of data derived from all three sources.
\par All three databases assign a mnemonic name (called a LOCUS name by GenBank and DDBJ, and an entry name by EMBL) which is meant to carry meaning encoded into it. The first few letters indicate the organism, and next few a gene product, and so on. There is no concerted attempt to keep an entry name the same from release to release, nor is there any attempt for the same entry to have the same entry name in the three different databases (since they construct entry names using different conventions). While many people are used to referring to entrys by name (and thus name is included in a Textseq-id) it is a notoriously unreliable way of identifying a Bioseq and should normally be avoided.
\par All three databases also assign an Accession Number to each entry. Accession numbers do not convey meaning, other than in a bookkeeping sense. Unlike names, accession numbers are meant to be same for the same entry, no matter which database one looks in. Thus, accession number is the best id for a Bioseq from this collaboration. Unfortunately rules for the use of accession numbers have not required that an accession number uniquely identify a sequence. A database may change an accession when it merely changes the annotation on an entry. Conversely, a database may not change an accession even though it has changed the sequence itself. There is no consistency about when such events may occur. There is also no exact method of recording the history of an entry in this collaboration, so such accession number shifts make it possible to lose track of entries by outside users of the databases. With all these caveats, accession numbers are still the best identifiers available within this collaboration.
\par A database release may be considered a snapshot of the database at a frozen moment of time. So a name or accession AND the database release IS a unique identifier for a Bioseq. For this reason it is provided in the Textseq-id structure. Be warned however, that depending on what data service is being queried, retrieval may not make use of the release information. Finally, EMBL assigns a version number to each entry. For entries derived from EMBL, the combination of accession number and version number is supposed to uniquely identify a sequence.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430937}{\*\bkmkstart _Toc300649337}pir: PIR International{\*\bkmkend _Toc294430937}{\*\bkmkend _Toc300649337}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The PIR database is also produced through an international collaboration with contributors in the US at the Protein Identification Resource of the National Biomedical Research Foundation (NBRF), in Europe  at the Martinsried Institute for Protein Sequences (MIPS), and in Japan at the International Protein Information Database in Japan (JIPID). They also use an entry name and accession number. The PIR accession numbers, however, are not related to the GenBank/EMBL/DDBJ accession numbers in any way and have a very different meaning. In PIR, the entry name identifies the sequence, which is meant to be the "best version" of that protein. The accession numbers are in transition from a meaning more similar to the GenBank/EMBL/DDBJ accessions, to one in which an accession is associated with protein sequences exactly as they appeared in specific publications. Thus, at present, PIR ids may have both an accession and a name, they will move to more typically having either a name or an accession, depending on what is being cited, the "best" sequence or an original published sequence.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430938}{\*\bkmkstart _Toc300649338}swissprot: SWISS-PROT{\*\bkmkend _Toc294430938}{\*\bkmkend _Toc300649338}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The SWISS-PROT database was created by Amos Bairoch at the University of Geneva in Switzerland (thus the name) and he continues to direct and develop it in it's current collaborative relationship with EMBL. SWISS-PROT is derived from many sources including PIR, the GenInfo Backbone, and the translated coding regions from the GenBank/EMBL/DDBJ nucleic acid databases, among others. SWISS-PROT follows the same name and accession number conventions as GenBank/EMBL/DDBJ. The name is meant to be easily remembered and codes biological information, but is not a stable identifier from release to release. The accession is meant to be a stable identifier from release to release, but conveys only bookkeeping information. Unlike PIR accession numbers, the SWISS-PROT accession numbers are coordinated with those of GenBank/EMBL/DDBJ and do not conflict.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430939}{\*\bkmkstart _Toc300649339}prf: Protein Research Foundation{\*\bkmkend _Toc294430939}{\*\bkmkend _Toc300649339}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Protein Research Foundation in Japan has a large database of protein sequence and peptide fragments derived from the literature. Again, there is a name and an accession number. Since this database is meant only to record the sequence as it appeared in a particular publication, the relationship between the id and the sequence is quite stable in practice.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430940}{\*\bkmkstart _Toc300649340}patent: Citing a Patent{\*\bkmkend _Toc294430940}{\*\bkmkend _Toc300649340}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The minimal information to unambiguously identify a sequence in a patent is first to unambiguously identify the patent (by the Patent-seq-id.cit, see Bibliographic References for a discussion of Id-pat) and then providing an integer serial number to identify the sequence within the patent. The sequence data for sequence related patents are now being submitted to the international patent offices in computer readable form, and the serial number for the sequence is assigned by the processing office. However, older sequence related patents were not assigned serial numbers by the processing patent offices. For those sequences the serial number is assigned arbitrarily (but still uniquely). Note that a sequence with a Patent-seq-id just appeared as part of a patent document. It is NOT necessarily what was patented by the patent document.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430941}{\*\bkmkstart _Toc300649341}pdb: Citing a Biopolymer Chain from a Structure Database{\*\bkmkend _Toc294430941}{\*\bkmkend _Toc300649341}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Protein Data Bank (PDB, also known as the Brookhaven Database), is a collection of data about structures of biological entities such hemoglobin or cytochrome c. The basic entry in PDB is a structural model of a molecule, not a sequence as in most sequence databases. A molecule may have multiple chains. So a PDB-seq-id has a string for the PDB entry name (called PDB-mol-id here) and a single character for a chain identifier within the molecule. The use of the single character just maps the PDB practice. The character may be a digit, a letter, or even a space (ASCII 32). As with the databases using the Textseq-id, the sequence of the chain in PDB associated with this information is not stable, so to be unambiguous the id must also include the release date.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430942}{\*\bkmkstart _Toc300649342}giim: GenInfo Import Id{\*\bkmkend _Toc294430942}{\*\bkmkend _Toc300649342}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Giimport-id is a temporary id used to identify sequences imported into the GenInfo system at NCBI from a variety of sources. Currently this id type is used in the NCBI ASN.1 and Entrez:Sequences releases to provide a uniform id type across sequence from all sources. The giim is not stable from release to release. The use of giim is a temporary measure until long term, stable identifiers such as "gi" below can be assigned (first or second quarter of 1993).
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430943}{\*\bkmkstart _Toc300649343}gi: A Stable, Uniform Id Applied to Sequences From All Sources{\*\bkmkend _Toc294430943}{\*\bkmkend _Toc300649343}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-id of type "gi" is a simple integer assigned to a sequence by the NCBI "ID" database. It can be applied to a Bioseq of any representation class, nucleic acid or protein. It uniquely identifies a sequence from a particular source. If the sequence changes at all, then a new "gi" is assigned. The "gi" does not change if only annotations are changed. Thus the "gi" provides a simple, uniform way of identifying a stable coordinate system on a Bioseq provided by data sources which may not themselves have stable ids. This is the identifier of choice for all references to Bioseqs through features or alignments. See discussion below.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430944}{\*\bkmkstart _Toc300649344}Seq-id: The C Implementation{\*\bkmkend _Toc294430944}{\*\bkmkend _Toc300649344}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-id is implemented in C as a ValNode with a typedef SeqIdPtr ValNodePtr. The type of the Seq-id is given in ValNode->choice and a series of #defines are used to indicate the type of the Seq-id. The ValNode->data.intvalue is used for the integer types and ValNode->data.ptrvalue for the other types as in the following table.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Seq-id
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2719\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx4327\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7052\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b #define\cell ASN.1 name\cell Type in ValNode->data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2719\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4327\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7052\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {0\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_NOT_SET}{\b \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {not-set\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {not needed\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2719\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4327\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7052\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_LOCAL\cell local\cell ObjectIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GIBBSQ\cell gibbsq\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GIBBMT\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {gibbmt\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GIIM\cell giim\cell GiimPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GENBANK\cell genbank\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_EMBL\cell embl\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_PIR\cell pir\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_SWISSPROT\cell swissprot\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_PATENT\cell patent\cell PatentSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_OTHER\cell other\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GENERAL\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {general\cell DbtagPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {12\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_GI\cell gi\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {13\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_DDBJ\cell ddbj\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {14\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_PRF\cell prf\cell TextSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx2719\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx4327\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7052\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {15\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQID_PDB\cell pdb\cell PDBSeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard \sb240\widctlpar\adjustright {Since a SeqIdPtr is a ValNodePtr, a special SeqIdNew() is not provided, although the usual SeqIdAsnRead(), SeqIdAsnWrite(), and SeqIdFree() functions are provided. Since SET OF and SEQUENCE OF Seq-id are common, SeqIdSetAsnRead(), SeqIdSetAsnWrite(), and SeqIdSetFree() functions are provided. They assume that the SeqIdPtr passed is the head of a chain of SeqIds connect through the ValNodePtr->next and with the last ValNodePtr->next equal to NULL. SeqIdDup() provides a fast function for duplicating SeqIds.
\par }\pard \sb240\widctlpar\adjustright {A large number of additional functions for manipulating SeqIds are described in the Sequence Utilities chapter.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430945}{\*\bkmkstart _Toc300649345}NCBI ID Database: Imposing Stable Seq-ids{\*\bkmkend _Toc294430945}{\*\bkmkend _Toc300649345}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {As described in the Data Model chapter, Bioseqs provide a simple integer coordinate system through which a host of different data and analytical results can be easily associated with each other, even with scientists working independently of each other and on heterogeneous systems. For this model to work, however, requires stable identifiers for these integer coordinate systems. If one scientist notes a coding region from positions 10-50 of sequence "A", then the database adds a single base pair at position 5 of "A" without changing the identifier of "A", then at the next release of the database the scientist's coding region is now frame-shifted one position and invalid. Unfortunately this is currently the case due to the casual use of sequence identifiers by most existing databases.
\par Since NCBI integrates data from many different databases which follow their own directions, we must impose stable ids on an unstable starting material. While a daunting task, it is not, in the main, impossible. We have built a database called "ID", whose sole task is to assign and track stable sequence ids. ID assigns "gi" numbers, simple arbitrary integers which stably identify a particular sequence coordinate system.
\par The first time ID "sees" a Bioseq, say EMBL accession A00000, it checks to see if it has a Bioseq from EMBL with this accession already. If not, it assigns a new GI, say 5, to the entry and adds it to the Bioseq.id chain (the original EMBL id is not lost). It also replaces all references in the entry (say in the feature table) to EMBL A00000 to GI 5. This makes the annotations now apply to a stable coordinate system.
\par Now EMBL sends an update of the entry which is just a correction to the feature table. The same process occurs, except this time there is a previous entry with the same EMBL accession number. ID retrieves the old entry and compares the sequence of the old entry with the new entry. Since they are identical it reassigns GI 5 to the same entry, converts the new annotations, and stores it as the most current view of that EMBL entry.
\par Now ID gets another update to A00000, but this time the sequence is different. ID assigns a new GI, say 6, to this entry. It also updates the sequence history (Seq-inst.hist, see the Biological Sequences chapter) of both old and new entries to make a doubly linked list. The GI 5 entry has a pointer that it has been replaced by GI 6, and the GI 6 entry has a pointer showing it replaced GI 5. When NCBI makes a new data release the entry designated GI 6 will be released to represent EMBL entry A00000. However, the ASN.1 form of the data contains an explicit history. A scientist who annotated a coding region on GI 5 can discover that it has been replaced by GI 6. The GI 5 entry can still be retrieved from ID, aligned with GI 6, and the scientist can determine if her annotation is still valid on the new entry. If she annotated using the accession number instead of the GI, of course, she could be out of luck.
\par }\pard \sb240\widctlpar\adjustright {Since ID is attempting to order a chaotic world, mistakes will inevitably be made. However, it is clear that in the vast majority of cases it is possible to impose stable ids. As scientists and software begin to use the GI ids and reap the benefits of stable ids, the world may gradually become less chaotic. The Seq-inst.hist data structure can even be used by data suppliers to actively maintain an explicit history without ID having to infer it, which would be the ideal case.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430946}{\*\bkmkstart _Toc300649346}Seq-loc: Locations on a Bioseq{\*\bkmkend _Toc294430946}{\*\bkmkend _Toc300649346}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-loc is a location on a Bioseq of any representation class, nucleic acid or protein. All Bioseqs provide a simple integer coordinate system from 0 to (length -1) and all Seq-locs refer to that coordinate system. All Seq-locs also explicitly the Bioseq (coordinate system) to which they apply with a Seq-id. Most objects which are attached to or reference sequences do so through a Seq-loc. Features are blocks of data attached by a Seq-loc. An alignment is just a collection of correlated Seq-locs. A segmented sequence is built from other sequences by reference to Seq-locs.
\par Seq-locs come in many varieties.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430947}{\*\bkmkstart _Toc300649347}null: A Gap{\*\bkmkend _Toc294430947}{\*\bkmkend _Toc300649347}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A null Seq-loc can be used in a Seq-loc with many components to indicate a gap of unknown size. For example it is used in segmented sequences to indicate such gaps between the sequenced pieces.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430948}{\*\bkmkstart _Toc300649348}empty: A Gap in an Alignment{\*\bkmkend _Toc294430948}{\*\bkmkend _Toc300649348}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A alignment (see Sequence Alignments) may require that every Seq-loc refer to a Bioseq, even for a gap. They empty type fulfills this need.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430949}{\*\bkmkstart _Toc300649349}whole: A Reference to a Whole Bioseq{\*\bkmkend _Toc294430949}{\*\bkmkend _Toc300649349}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is just a shorthand for the Bioseq from 0 to (length -1). This form is falling out of favor at NCBI because it means one must retrieve the referenced Bioseq to determine the length of the location. An interval covering the whole Bioseq is equivalent to this and more useful. One the other hand, if an unstable Seq-id is used here, it always applies to the full length of the Bioseq, even if the length changes. This was the original rationale for this type. and it may still be valid while unstable sequences persist.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430950}{\*\bkmkstart _Toc300649350}int: An Interval on a Bioseq{\*\bkmkend _Toc294430950}{\*\bkmkend _Toc300649350}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An interval is a single continuous region of defined length on a Bioseq. A single integer value (Seq\_interval.from), another single integer value (Seq-interval.to), and a Seq-id (Seq-interval.id) are required. The "from" and "to" values must be in the range 0 to (length -1) of the Bioseq cited in "id". If there is uncertainty about either the "from" or "to" values, it is expressed in additional fields "fuzz-from" and/or "fuzz-to", and the "from" and "to" values can be considered a "best guess" location. This design means that simple software can ignore fuzzy values, but they are not lost to more sophisticated tools.
\par The "from" value is ALWAYS less than or equal to the "to" value, no matter what strand the interval is on. It may be convenient for software to present intervals on the minus strand with the "to" value before the "from" value, but internally this is NEVER the case. This requirement means that software which determines overlaps of locations need never treat plus or minus strand locations differently and it greatly simplifies processing.
\par The value of Seq-interval.strand is the only value different in intervals on the plus or minus strand. Seq-interval.strand is OPTIONAL since it is irrelevant for proteins, but operationally it will DEFAULT to plus strand on nucleic acid locations where it is not supplied.
\par The plus or minus strand is an attribute on each simple Seq-loc (interval or point) instead of as an operation on an arbitrarily complex location (as in the GenBank/EMBL/DDBJ flatfile Feature Table) since it means even very complex locations can be processed to a base pair location in simple linear order, instead of requiring that the whole expression be processed and resolved first.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430951}{\*\bkmkstart _Toc300649351}packed-int: A Series of Intervals{\*\bkmkend _Toc294430951}{\*\bkmkend _Toc300649351}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Packed-seqint is simply a SEQUENCE OF Seq-interval. That means the location is resolved by evaluating a series of Seq-interval in order. Note that the Seq-intervals in the series need not all be on the same Bioseq or on the same strand.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430952}{\*\bkmkstart _Toc300649352}pnt: A Single Point on a Sequence{\*\bkmkend _Toc294430952}{\*\bkmkend _Toc300649352}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-point is essentially one-half of a Seq-interval and the discussion (above) about fuzziness and strand applies equally to Seq-point.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430953}{\*\bkmkstart _Toc300649353}packed-pnt: A Collection of Points{\*\bkmkend _Toc294430953}{\*\bkmkend _Toc300649353}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Packed-seqpnt is an optimization for attaching a large number of points to a single Bioseq. Information about the Seq-id, strand, or fuzziness need not be duplicated for every point. Of course, this also means it must apply equally to all points as well. This would typically be the case for listing all the cut sites of a certain restriction enzyme, for example.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430954}{\*\bkmkstart _Toc300649354}mix: An Arbitrarily Complex Location{\*\bkmkend _Toc294430954}{\*\bkmkend _Toc300649354}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-loc-mix is simply a SEQUENCE OF Seq-loc. The location is resolved by resolving each Seq-loc in order. The component Seq-locs may be of any complexity themselves, making this definition completely recursive. This means a relatively small amount of software code can process locations of extreme complexity with relative ease.
\par A Seq-loc-mix might be used to represent a segmented sequence with gaps of unknown length. In this case it would consist of some elements of type "int" for intervals on Bioseqs and some of type "null" representing gaps of unknown length. Another use would be to combine a Seq-interval representing an untranslated leader, with a Packed-seqint from a multi-exon coding region feature, and another Seq-interval representing an untranslated 3' end, to define the extent of an mRNA on a genomic sequence.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430955}{\*\bkmkstart _Toc300649355}equiv: Equivalent Locations{\*\bkmkend _Toc294430955}{\*\bkmkend _Toc300649355}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This form is simply a SET OF Seq-loc which are equivalent to each other. Such a construct could be used to represent alternative splicing, for example (and is when translating the GenBank/EMBL/DDBJ location "one-of"). However note that such a location can never resolve to a single result. Further, if there are multiple "equiv" forms in a complex Seq-loc, it is unclear if all possible combinations are valid. In general this construct should be avoided unless there is no alternative.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430956}{\*\bkmkstart _Toc300649356}bond: A Chemical Bond Between Two Residues{\*\bkmkend _Toc294430956}{\*\bkmkend _Toc300649356}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The data elements in a Seq-bond is just two Seq-points. The meaning is that these two points have a chemical bond between them (which is different than describing just the location of two points). At NCBI we have restricted its use to covalent bonds. Note that the points may be on the same (intra-chain bond) or different (inter-chain bond) Bioseqs completely explicitly.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430957}{\*\bkmkstart _Toc300649357}feat: A Location Indirectly Referenced Through A Feature{\*\bkmkend _Toc294430957}{\*\bkmkend _Toc300649357}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This one is really for the future, when not only Bioseqs, but features have stable ids. The meaning is "the location of this feature". This way one could give a valid location by citing, for example a Gene feature, which would resolve to the location of that gene on a Bioseq. When identifiable features become common (see Sequence Features) this will become a very useful location.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430958}{\*\bkmkstart _Toc300649358}Seq-loc: The C Implementation{\*\bkmkend _Toc294430958}{\*\bkmkend _Toc300649358}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Since a Seq-loc is a CHOICE of many types a SeqLocPtr is typedefed as a ValNodePtr. The ValNodePtr->choice indicates the type of SeqLoc and a series of #defines provide the values in a convenient way. The ValNodePtr->data.ptrvalue contains a pointer to the appropriate data structure as in the table below:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {Seq-loc
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3097\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx4705\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b Value\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b #define\cell ASN.1 name\cell Type in ValNode->data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3097\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4705\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {1\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_NULL}{\b \cell }\pard \s29\keepn\widctlpar\intbl\adjustright {null\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {not needed\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3097\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx4705\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {2\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_EMPTY\cell empty\cell SeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {3\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_WHOLE\cell whole\cell SeqIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {4\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_INT\cell int\cell SeqIntPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_PACKED_INT\cell packed-int\cell SeqLocPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {6\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_PNT\cell pnt\cell SeqPntPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {7\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_PACKED_PNT\cell packed-pnt\cell PackSeqPntPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {8\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_MIX\cell mix\cell SeqLocPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {9\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_EQUIV\cell equiv\cell SeqLocPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {10\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_BOND\cell bond\cell SeqBondPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx666\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx3097\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx4705\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx7430\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {11\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {SEQLOC_FEAT\cell feat\cell ChoicePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard \sb240\widctlpar\adjustright {Note that SEQLOC_MIX and SEQLOC_EQUIV types have a SeqLocPtr in their data.ptrvalue. This is expected since they are a SEQUENCE OF or SET OF Seq-loc and data.ptrvalue contains a pointer to the head of the linked list of ValNodes connect through their ->next pointers. SEQLOC_PACKED_INT is implemented this way as well,  for simplicity, although each Seq-loc in that chain will, by definition, be of type SEQLOC_INT.
\par }\pard \sb240\widctlpar\adjustright {Like Seq-id, above, there is no SeqLocNew() function since it is just a ValNode, but there are the usual SeqLocAsnRead(), SeqLocAsnWrite(), and SeqLocFree() functions. In addition there are SeqLocSetAsnWrite(), SeqLocSetAsnRead(), and SeqLocSetFree() functions.
\par }\pard \sb240\widctlpar\adjustright {PackSeqPnt has some extra functions as well. PackSeqPntNum() returns the number of points in the the PackSeqPnt. PackSeqPntGet() will return a point given an index (0 to (number of points -1)) of the point. PackSeqPntPut() will add a point to the PackSeqPnt. This functions are to hide the complexity of managing the set of points.
\par }\pard \sb240\widctlpar\adjustright {A series of #defines for nucleic acid strands are provided to map to the ASN.1 ENUMERATED type. They are:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {#define Seq_strand_unknown 0
\par #define Seq_strand_plus 1
\par #define Seq_strand_minus 2
\par #define Seq_strand_both 3
\par #define Seq_strand_both_rev 4
\par #define Seq_strand_other 255
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In addition, there are a large number of utility functions for working with SeqLocs described in the chapter on Sequence Utilities. This allow traversal of complex locations, comparison of locations for overlap, conversion of coordinates in locations, and ability to open a window on a Bioseq through a location.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430959}{\*\bkmkstart _Toc300649359}ASN.1 Specification: seqloc.asn{\*\bkmkend _Toc294430959}{\*\bkmkend _Toc300649359}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par --
\par --  NCBI Sequence location and identifier elements
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Seqloc DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Seq-id, Seq-loc, Seq-interval, Packed-seqint, Seq-point, Packed-seqpnt,
\par         Na-strand, Giimport-id;
\par 
\par IMPORTS Object-id, Int-fuzz, Dbtag, Date FROM NCBI-General
\par         Id-pat FROM NCBI-Biblio
\par         Feat-id FROM NCBI-Seqfeat;
\par 
\par --*** Sequence identifiers ********************************
\par --*
\par 
\par Seq-id ::= CHOICE \{
\par     local Object-id ,      -- local use
\par     gibbsq INTEGER ,         -- Geninfo backbone seqid
\par     gibbmt INTEGER ,         -- Geninfo backbone moltype
\par     giim Giimport-id ,       -- Geninfo import id
\par     genbank Textseq-id ,
\par     embl Textseq-id ,
\par     pir Textseq-id ,
\par     swissprot Textseq-id ,
\par     patent Patent-seq-id ,
\par     other Textseq-id ,       -- catch all
\par     general Dbtag ,          -- for other databases
\par     gi INTEGER ,             -- GenInfo Integrated Database
\par \tab ddbj Textseq-id ,        -- DDBJ
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab prf Textseq-id ,         -- PRF SEQDB
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab pdb PDB-seq-id \}         -- PDB sequence
\par 
\par Patent-seq-id ::= SEQUENCE \{
\par     seqid INTEGER ,         -- number of sequence in patent
\par     cit Id-pat \}           -- patent citation
\par 
\par Textseq-id ::= SEQUENCE \{
\par     name VisibleString OPTIONAL ,
\par     accession VisibleString OPTIONAL ,
\par     release VisibleString OPTIONAL ,
\par     version INTEGER OPTIONAL \}
\par 
\par Giimport-id ::= SEQUENCE \{
\par     id INTEGER ,               -- the id to use here
\par     db VisibleString OPTIONAL ,  -- dbase used in
\par     release VisibleString OPTIONAL \}   -- the release
\par 
\par PDB-seq-id ::= SEQUENCE \{
\par \tab mol PDB-mol-id ,          -- the molecule name
\par \tab chain INTEGER DEFAULT 32 ,-- a single ASCII character, chain id
\par     rel Date OPTIONAL \}   -- release date, month and year
\par 
\par PDB-mol-id ::= VisibleString  -- name of mol, 4 chars
\par \tab 
\par --*** Sequence locations **********************************
\par --*
\par 
\par Seq-loc ::= CHOICE \{
\par     null NULL ,           -- not placed
\par     empty Seq-id ,        -- to NULL one Seq-id in a collection
\par     whole Seq-id ,        -- whole sequence
\par     int Seq-interval ,    -- from to
\par     packed-int Packed-seqint ,
\par     pnt Seq-point ,
\par     packed-pnt Packed-seqpnt ,
\par     mix Seq-loc-mix ,
\par     equiv Seq-loc-equiv ,  -- equivalent sets of locations
\par     bond Seq-bond ,
\par     feat Feat-id \}         -- indirect, through a Seq-feat
\par     
\par 
\par Seq-interval ::= SEQUENCE \{
\par     from INTEGER ,
\par     to INTEGER ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    strand Na-strand OPTIONAL ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    id Seq-id ,    -- WARNING: this used to be optional
\par     fuzz-from Int-fuzz OPTIONAL ,
\par     fuzz-to Int-fuzz OPTIONAL \}
\par 
\par Packed-seqint ::= SEQUENCE OF Seq-interval
\par 
\par Seq-point ::= SEQUENCE \{
\par     point INTEGER ,
\par     strand Na-strand OPTIONAL ,
\par     id Seq-id ,     -- WARNING: this used to be optional
\par     fuzz Int-fuzz OPTIONAL \}
\par 
\par Packed-seqpnt ::= SEQUENCE \{
\par     strand Na-strand OPTIONAL ,
\par     id Seq-id ,
\par     fuzz Int-fuzz OPTIONAL ,
\par     points SEQUENCE OF INTEGER \}
\par 
\par Na-strand ::= ENUMERATED \{          -- strand of nucleid acid
\par     unknown (0) ,
\par     plus (1) ,
\par     minus (2) ,               
\par     both (3) ,                -- in forward orientation
\par     both-rev (4) ,            -- in reverse orientation
\par     other (255) \}
\par 
\par Seq-bond ::= SEQUENCE \{         -- bond between residues
\par \tab a Seq-point ,           -- connection to a least one residue
\par \tab b Seq-point OPTIONAL \}  -- other end may not be available
\par 
\par Seq-loc-mix ::= SEQUENCE OF Seq-loc   -- this will hold anything
\par 
\par Seq-loc-equiv ::= SET OF Seq-loc      -- for a set of equivalent locations
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430960}{\*\bkmkstart _Toc300649360}C Structures and Functions: objloc.h{\*\bkmkend _Toc294430960}{\*\bkmkend _Toc300649360}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objloc.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  the author's official duties as a United States Government employee and 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the loclic for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objloc.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Seqloc
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seqloc_
\par #define _NCBI_Seqloc_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifndef _NCBI_Biblio_
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#include <objbibli.h>
\par #endif
\par 
\par typedef ValNodePtr SeqIdPtr;
\par typedef ValNodePtr SeqLocPtr;
\par 
\par #ifndef _NCBI_Seqfeat_
\par #include <objfeat.h>      /* after Seqloc to avoid cycles */
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   Seqloc loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqLocAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-Seqloc objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   SeqId is a choice using an ValNode, most types in data.ptrvalue
\par *      except integers, in data.intvalue
\par *   choice:
\par *   0 = not set
\par     1 = local Object-id ,      -- local use
\par     2 = gibbsq INTEGER ,         -- Geninfo backbone seqid
\par     3 = gibbmt INTEGER ,         -- Geninfo backbone moltype
\par     4 = giim Giimport-id ,       -- Geninfo import id
\par     5 = genbank Textseq-id ,
\par     6 = embl Textseq-id ,
\par     7 = pir Textseq-id ,
\par     8 = swissprot Textseq-id ,
\par     9 = patent Patent-seq-id ,
\par     10 = other Textseq-id ,       -- catch all
\par     11 = general Dbtag          -- for other databases
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    12 = gi  INTEGER          -- GenInfo Integrated Database
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    13 = ddbj Textseq-id
\par \tab 14 = prf Textseq-id ,         -- PRF SEQDB
\par \tab 15 = pdb PDB-seq-id          -- PDB sequence
\par *
\par *****************************************************************************/
\par #define SEQID_NOT_SET ( (Uint1)0)
\par #define SEQID_LOCAL ( (Uint1)1)
\par #define SEQID_GIBBSQ ( (Uint1)2)
\par #define SEQID_GIBBMT ( (Uint1)3)
\par #define SEQID_GIIM ( (Uint1)4)
\par 
\par /*---
\par  * WARNING: CODE in objloc.c, especially SeqIdPrint() requires that
\par  * GENBANK through SwissProt be contiguous numbers
\par  * in the following order.
\par  *-----*/
\par #define SEQID_GENBANK ( (Uint1)5)
\par #define SEQID_EMBL ( (Uint1)6)
\par #define SEQID_PIR ( (Uint1)7)
\par #define SEQID_SWISSPROT ( (Uint1)8)
\par 
\par 
\par #define SEQID_PATENT ( (Uint1)9)
\par #define SEQID_OTHER ( (Uint1)10)
\par #define SEQID_GENERAL ( (Uint1)11)
\par #define SEQID_GI ( (Uint1)12)
\par #define SEQID_DDBJ ((Uint1)13)
\par #define SEQID_PRF ((Uint1)14)
\par #define SEQID_PDB ((Uint1)15)
\par 
\par Boolean SeqIdAsnWrite PROTO((SeqIdPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqIdPtr SeqIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqIdPtr SeqIdFree PROTO((SeqIdPtr anp));
\par SeqIdPtr SeqIdDup PROTO((SeqIdPtr oldid));
\par 
\par /*****************************************************************************
\par *
\par *   These routines process sets or sequences of SeqId's
\par *
\par *****************************************************************************/
\par Boolean SeqIdSetAsnWrite PROTO((SeqIdPtr anp, AsnIoPtr aip, AsnTypePtr settype, AsnTypePtr elementtype));
\par SeqIdPtr SeqIdSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr settype, AsnTypePtr elementtype));
\par SeqIdPtr SeqIdSetFree PROTO((SeqIdPtr anp));
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {/*****************************************************************************
\par *
\par *   PatentSeqId
\par *
\par *****************************************************************************/
\par typedef struct patentseqid \{
\par     Int2 seqid;
\par     IdPatPtr cit;
\par \} PatentSeqId, PNTR PatentSeqIdPtr;
\par 
\par PatentSeqIdPtr PatentSeqIdNew PROTO((void));
\par Boolean PatentSeqIdAsnWrite PROTO((PatentSeqIdPtr psip, AsnIoPtr aip, AsnTypePtr atp));
\par PatentSeqIdPtr PatentSeqIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PatentSeqIdPtr PatentSeqIdFree PROTO((PatentSeqIdPtr psip));
\par 
\par /*****************************************************************************
\par *
\par *   TextSeqId
\par *
\par *****************************************************************************/
\par typedef struct textseqid \{
\par     CharPtr name,
\par         accession,
\par         release;
\par \tab Int2 version;             /* INT2_MIN (ncbilcl.h) = not set */
\par \} TextSeqId, PNTR TextSeqIdPtr;
\par 
\par TextSeqIdPtr TextSeqIdNew PROTO((void));
\par Boolean TextSeqIdAsnWrite PROTO((TextSeqIdPtr tsip, AsnIoPtr aip, AsnTypePtr atp));
\par TextSeqIdPtr TextSeqIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par TextSeqIdPtr TextSeqIdFree PROTO((TextSeqIdPtr tsip));
\par 
\par /*****************************************************************************
\par *
\par *   Giim
\par *
\par *****************************************************************************/
\par typedef struct giim \{
\par     Int4 id;
\par     CharPtr db,
\par         release;
\par \} Giim, PNTR GiimPtr;
\par 
\par GiimPtr GiimNew PROTO((void));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean GiimAsnWrite PROTO((GiimPtr gip, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {GiimPtr GiimAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par GiimPtr GiimFree PROTO((GiimPtr gip));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   PDBSeqId
\par *
\par *****************************************************************************/
\par typedef struct pdbseqid \{
\par     CharPtr mol;
\par \tab Uint1 chain;        /* 0 = no chain set.  default = 32 */
\par \tab DatePtr rel;
\par \} PDBSeqId, PNTR PDBSeqIdPtr;
\par 
\par PDBSeqIdPtr PDBSeqIdNew PROTO((void));
\par Boolean PDBSeqIdAsnWrite PROTO((PDBSeqIdPtr tsip, AsnIoPtr aip, AsnTypePtr atp));
\par PDBSeqIdPtr PDBSeqIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PDBSeqIdPtr PDBSeqIdFree PROTO((PDBSeqIdPtr tsip));
\par 
\par /*****************************************************************************
\par *
\par *   SeqLoc
\par *   SeqLoc is a choice using an ValNode, most types in data.ptrvalue
\par *      except integers, in data.intvalue
\par *   choice:
\par     1 = null NULL ,           -- not placed
\par     2 = empty Seq-id ,        -- to NULL one Seq-id in a collection
\par     3 = whole Seq-id ,        -- whole sequence
\par     4 = int Seq-interval ,    -- from to
\par     5 = packed-int Packed-seqint ,
\par     6 = pnt Seq-point ,
\par     7 = packed-pnt Packed-seqpnt ,
\par     8 = mix SEQUENCE OF Seq-loc ,
\par     9 = equiv SET OF Seq-loc ,  -- equivalent sets of locations
\par     10 = bond Seq-bond
\par     11 = feat Feat-id    -- indirect through a feature
\par *
\par *****************************************************************************/
\par #define SEQLOC_NULL ( (Uint1)1)
\par #define SEQLOC_EMPTY ( (Uint1)2)
\par #define SEQLOC_WHOLE ( (Uint1)3)
\par #define SEQLOC_INT ( (Uint1)4)
\par #define SEQLOC_PACKED_INT ( (Uint1)5)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define SEQLOC_PNT ( (Uint1)6)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define SEQLOC_PACKED_PNT ( (Uint1)7)
\par #define SEQLOC_MIX ( (Uint1)8)
\par #define SEQLOC_EQUIV ( (Uint1)9)
\par #define SEQLOC_BOND ( (Uint1)10)
\par #define SEQLOC_FEAT ( (Uint1)11)
\par 
\par Boolean SeqLocAsnWrite PROTO((SeqLocPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqLocPtr SeqLocAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqLocPtr SeqLocFree PROTO((SeqLocPtr anp));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   these routines work on set/seq of SeqLoc
\par *
\par *****************************************************************************/
\par Boolean SeqLocSetAsnWrite PROTO((SeqLocPtr anp, AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par SeqLocPtr SeqLocSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr orig, AsnTypePtr element));
\par SeqLocPtr SeqLocSetFree PROTO((SeqLocPtr anp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqInt
\par *
\par *****************************************************************************/
\par typedef struct seqint \{
\par     Int4 from,
\par         to;
\par     Uint1 strand;
\par     SeqIdPtr id;    /* seq-id */
\par     IntFuzzPtr if_from,
\par                if_to;
\par \} SeqInt, PNTR SeqIntPtr;
\par 
\par SeqIntPtr SeqIntNew PROTO((void));
\par Boolean SeqIntAsnWrite PROTO((SeqIntPtr sip, AsnIoPtr aip, AsnTypePtr atp));
\par SeqIntPtr SeqIntAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqIntPtr SeqIntFree PROTO((SeqIntPtr sip));
\par 
\par /*****************************************************************************
\par *
\par *   Packed-int
\par *
\par *****************************************************************************/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean PackSeqIntAsnWrite PROTO((SeqLocPtr sip, AsnIoPtr aip, AsnTypePtr atp));
\par SeqLocPtr PackSeqIntAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqLocMix
\par *
\par *****************************************************************************/
\par 
\par Boolean SeqLocMixAsnWrite PROTO((SeqLocPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqLocPtr SeqLocMixAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqLocEquiv
\par *
\par *****************************************************************************/
\par 
\par Boolean SeqLocEquivAsnWrite PROTO((SeqLocPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqLocPtr SeqLocEquivAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqPnt
\par *
\par *****************************************************************************/
\par typedef struct seqpoint \{
\par     Int4 point;
\par     Uint1 strand;
\par     SeqIdPtr id;    /* seq-id */
\par     IntFuzzPtr fuzz;
\par \} SeqPnt, PNTR SeqPntPtr;
\par 
\par SeqPntPtr SeqPntNew PROTO((void));
\par Boolean SeqPntAsnWrite PROTO((SeqPntPtr spp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqPntPtr SeqPntAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqPntPtr SeqPntFree PROTO((SeqPntPtr spp));
\par 
\par /*****************************************************************************
\par *
\par *   PackSeqPnt
\par *
\par *****************************************************************************/
\par #define PACK_PNT_NUM 100     /* number of points per block */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {typedef struct packseqpnt \{
\par     SeqIdPtr id;    /* seq-id */
\par     IntFuzzPtr fuzz;
\par     Uint1 strand,
\par           used;       /* number of pnts used */
\par     Int4 pnts[PACK_PNT_NUM];
\par     struct packseqpnt PNTR next;   /* builds up chain of points */
\par \} PackSeqPnt, PNTR PackSeqPntPtr;
\par 
\par PackSeqPntPtr PackSeqPntNew PROTO((void));
\par Boolean PackSeqPntAsnWrite PROTO((PackSeqPntPtr pspp, AsnIoPtr aip, AsnTypePtr atp));
\par PackSeqPntPtr PackSeqPntAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par PackSeqPntPtr PackSeqPntFree PROTO((PackSeqPntPtr pspp));
\par Int4 PackSeqPntGet PROTO((PackSeqPntPtr pspp, Int4 index));
\par Boolean PackSeqPntPut PROTO((PackSeqPntPtr pspp, Int4 point));
\par Int4 PackSeqPntNum PROTO((PackSeqPntPtr pspp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqBond
\par *
\par *****************************************************************************/
\par typedef struct seqbond \{
\par     SeqPntPtr a,
\par                 b;
\par \} SeqBond, PNTR SeqBondPtr;
\par 
\par SeqBondPtr SeqBondNew PROTO((void));
\par Boolean SeqBondAsnWrite PROTO((SeqBondPtr sbp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqBondPtr SeqBondAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqBondPtr SeqBondFree PROTO((SeqBondPtr sbp));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   strand types
\par *
\par *****************************************************************************/
\par #define Seq_strand_unknown 0
\par #define Seq_strand_plus 1
\par #define Seq_strand_minus 2
\par #define Seq_strand_both 3
\par #define Seq_strand_both_rev 4
\par #define Seq_strand_other 255
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 240}}}{\b0 \tab Sequence Features}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Sequence Features   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 241}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include seqfeat.doc}}{\fldrslt {{\*\bkmkstart _Toc294430961}{\*\bkmkstart _Toc300649361}Sequence Features{\*\bkmkend _Toc294430961}{\*\bkmkend _Toc300649361}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430962}{\*\bkmkstart _Toc300649362}Introduction{\*\bkmkend _Toc294430962}{\*\bkmkend _Toc300649362}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A sequence feature (Seq-feat) is a block of structured data (SeqFeatData) explicitly attached to a region of a Bioseq through one or two Seq-locs (see Sequence Locations and Identifiers). The Seq-feat itself can carry information common to all features, as well as serving as the junction between the SeqFeatData and Seq-loc(s). Since a Seq-feat references a Bioseq through an explicit Seq-loc, a Seq-feat is an entity which can stand alone, or be moved between contexts without loss of information. Thus, information ABOUT Bioseqs can be created, exchanged, and compared independently from the Bioseq itself. This is an important attribute of the NCBI data model.
\par A feature table is a set of Seq-feat gathered together within a Seq-annot (see Biological Sequences). The Seq-annot allows the features to be attributed to a source and be associated with a title or comment. Seq-feats are normally exchanged "packaged" into a feature table.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430963}{\*\bkmkstart _Toc300649363}Seq-feat: Structure of a Feature{\*\bkmkend _Toc294430963}{\*\bkmkend _Toc300649363}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-feat is a data structure common to all features. The fields it contains can be evaluated by software the same way for all features, ignoring the "data" element which is what makes each feature class unique.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430964}{\*\bkmkstart _Toc300649364}id: Features Can Have Identifiers{\*\bkmkend _Toc294430964}{\*\bkmkend _Toc300649364}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {At this time unique identifiers for features are even less available or controlled than sequence identifiers. However, as molecular biology informatics becomes more sophisticated, it will become not only useful, but essential to be able to cite features as precisely as NCBI is beginning to be able to cite sequences. The Seq-feat.id slot is where these identifiers will go. The Feat-id object for features, meant to be equivalent of the Seq-id object for Bioseqs, is not very fully developed yet. It can accommodate feature ids from the NCBI Backbone database, local ids, and the generic Dbtag type. Look for better characterized global ids to appear here in future as the requirement for structured data exchange becomes increasingly accepted.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430965}{\*\bkmkstart _Toc300649365}data: Structured Data Makes Feature Types Unique{\*\bkmkend _Toc294430965}{\*\bkmkend _Toc300649365}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Each type of feature can have a data structure which is specifically designed to accommodate all the requirements of that type with no concern about the requirements of other feature types. Thus a coding region data structure can have fielded elements for reading frame and genetic code, while a tRNA data structure would have information about the amino acid transferred.
\par This design completely modularizes the components required specifically by each feature type. If a new field is required by a particular feature type, it does not affect any of the others. A new feature type, even a very complex one, can be added without affecting any of the others.
\par Software can be written in a very modular fashion, reflecting the data design. Functions common to all features (such as determining all features in a sequence region) simply ignore the "data" field and are robust against changes or additions to this component. Functions which process particular types have a well defined data interface unique to each type.
\par Perhaps a less obvious consequence is code and data reuse. Data objects used in other contexts can be used as features simply by making them a CHOICE in SeqFeatData. For example, the publication feature reuses the Pubdesc type used for Bioseq descriptors. This type includes all the standard bibliographic types (see Bibliographic References) used by MEDLINE or other bibliographic databases. Software which displays, queries, or retrieves publications will work without change on the "data" component of a publication feature because it is EXACTLY THE SAME object. This has profound positive consequences for both data and code development and maintenance.
\par This modularization also makes it natural to discuss each allowed feature type separately as is done in the SeqFeatData section below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430966}{\*\bkmkstart _Toc300649366}partial: This Feature is Incomplete{\*\bkmkend _Toc294430966}{\*\bkmkend _Toc300649366}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If Seq-feat.partial is TRUE, the feature is incomplete in some (unspecified) way. The details of incompleteness may be specified in more detail in the Seq-feat.location field. This flag allows quick exclusion of incomplete features when doing a database wide survey. It also allows the feature to be flagged when the details of incompleteness may not be know.
\par Seq-feat.partial should ALWAYS be TRUE if the feature is incomplete, even if Seq-feat.location indicates the incompleteness as well.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430967}{\*\bkmkstart _Toc300649367}except: There is Something Biologically Exceptional{\*\bkmkend _Toc294430967}{\*\bkmkend _Toc300649367}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Seq-feat.except flag is similar to the Seq-feat.partial flag in that it allows a simple warning that there is something unusual about this feature, without attempting to structure a detailed explanation. Again, this allows software scanning features in the database to ignore atypical cases easily. If Seq-feat.except is TRUE, Seq-feat.comment should contain a string explaining the exceptional situation.
\par Seq-feat.except does not necessarily indicate there is something wrong with the feature, but more that the biological exceeds the current representational capacity of the feature definition and that this may lead to an incorrect interpretation. For example, a coding region feature on genomic DNA where post-transcriptional editing of the RNA occurs would be a biological exception. If one translates the region using the frame and genetic code given in the feature one does not get the protein it points to, but the data supplied in the feature is, in fact, correct. It just does not take into account the RNA editing process.
\par Ideally, one should try to avoid or minimize exceptions by the way annotation is done. An approach to minimizing the RNA editing problem is described in the "product" section below. If one is forced to use exception consistently, it is a signal that a new or revised feature type is needed.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430968}{\*\bkmkstart _Toc300649368}comment: A Comment About This Feature{\*\bkmkend _Toc294430968}{\*\bkmkend _Toc300649368}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {No length limit is set on the comment, but practically speaking brief is better.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430969}{\*\bkmkstart _Toc300649369}product: Does This Feature Produce Another Bioseq?{\*\bkmkend _Toc294430969}{\*\bkmkend _Toc300649369}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-feat is unusual in that it can point to two different sequence locations. The "product" location enables two Bioseqs to be linked together in a source/product relationship explicitly. This is very valuable for features which describe a transformation from one Bioseq to another, such as coding region (nucleic acid to protein) or the various RNA types (genomic nucleic acid to RNA product).
\par This explicit linkage is extremely valuable for connecting diverse types. Linkage of nucleic acid to protein through coding region makes data traversal from gene to product or back simple and explicit, but clearly of profound biological significance. Less obvious, but nonetheless useful is the connection between a tRNA gene and the modified sequence of the tRNA itself, or of a transcribed coding region and an edited mRNA.
\par Note that such a feature is as valuable in association with its product Bioseq alone as it is with its source Bioseq alone, and could be distributed with either or both.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430970}{\*\bkmkstart _Toc300649370}location: Source Location of This Feature{\*\bkmkend _Toc294430970}{\*\bkmkend _Toc300649370}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Seq-feat.location is the traditional location associated with a feature. While it is possible to use any Seq-loc type in Seq-feat.location, it is recommended to use types which resolve to a single unique sequence. The use of a type like Seq-loc-equiv to represent alternative splicing of exons (similar to the GenBank/EMBL/DDBJ feature table "one-of") is strongly discouraged. Consider the example of such an alternatively spliced coding region. What protein sequence is coded for by such usage? This problem is accentuated by the availability of the "product" slot. Which protein sequence is the product of this coding region? While such a short hand notation may seem attractive at first glance, it is clearly much more useful to represent each splicing alternative, and it's associated protein product, times of expression, etc. separately.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430971}{\*\bkmkstart _Toc300649371}qual: GenBank Style Qualifiers{\*\bkmkend _Toc294430971}{\*\bkmkend _Toc300649371}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The GenBank/EMBL/DDBJ feature table uses "qualifiers", a combination of a string key and a string value. Many of these qualifiers do not map to the ASN.1 specification, so this provides a means of carrying them in the Seq-feat for features derived from those sources.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430972}{\*\bkmkstart _Toc300649372}title: A User Defined Name{\*\bkmkend _Toc294430972}{\*\bkmkend _Toc300649372}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This field is provided for naming features for display. It would be used by end-user software to allow the user to add locally meaningful names to features. This is not an id, as this is provided by the "id" slot.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430973}{\*\bkmkstart _Toc300649373}ext: A User Defined Structured Extension{\*\bkmkend _Toc294430973}{\*\bkmkend _Toc300649373}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The "ext" field allows the extension of a standard feature type with a structured User-object (see General Use Objects) defined by a user. For example, a particular scientist may have additional detailed information about coding regions which do not fit into the standard CdRegion data type. Rather than create a completely new feature type, the CdRegion type can be extended by filling in as much of the standard CdRegion fields as possible, then putting the additional information in the User-object. Software which only expects a standard coding region will operate on the extended feature without a problem, while software that can make use of the additional data in the User-object can operate on exactly the same the feature.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430974}{\*\bkmkstart _Toc300649374}cit: Citations For This Feature{\*\bkmkend _Toc294430974}{\*\bkmkend _Toc300649374}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This slot is a set of Pubs which are citations about the feature itself, not about the Bioseq as a whole. It can be of any type, although the most common is type "pub", a set of any kind of Pubs. The individual Pubs within the set may be Pub-equivs (see Bibliographic References) to hold equivalent forms for the same publication, so some thought should be given to the process of accessing all the possible levels of information in this seemingly simple field.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430975}{\*\bkmkstart _Toc300649375}exp-ev: Experimental Evidence{\*\bkmkend _Toc294430975}{\*\bkmkend _Toc300649375}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If it is known for certain that there is or is not experimental evidence supporting a particular feature, Seq-feat.exp-ev can be "experimental" or "not-experimental" respectively. If the type of evidence supporting the feature is not known, exp-ev should not be given at all.
\par This field is only a simple flag. It gives no indication of what kind of evidence may be available. A structured field of this type will differ from feature type to feature type, and thus is inappropriate to the generic Seq-feat. Information regarding the quality of the feature can be found in the CdRegion feature and even more detail on methods in the Tx-init feature. Other feature types may gain experimental evidence fields appropriate to their types as it becomes clear what a reasonable classification of that evidence might be.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430976}{\*\bkmkstart _Toc300649376}xref: Linking To Other Features{\*\bkmkend _Toc294430976}{\*\bkmkend _Toc300649376}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SeqFeatXrefs are copies of the Seq-feat.data field and (optionally) the Seq-feat.id field from other related features. This is a copy operation and is meant to keep some degree of connectivity or completeness with a Seq-feat that is moved out of context. For example, in a collection of data including a nucleic acid sequence and its translated protein product, there would be a Gene feature on the nucleic acid, a Prot-ref feature on the protein, and a CdRegion feature linking all three together. However, if the CdRegion feature is taken by itself, the name of the translated protein and the name of the gene are not immediately available. The Seq-feat.xref provides a simple way to copy the relevant information. Note that there is a danger to any such copy operation in that the original source of the copied data may be modified without updating the copy. Software should be careful about this, and the best course is to take the original data if it is available to the software, using any copies in xref only as a last resort. If the "id" is included in the xref, this makes it easier for software to keep the copy up to date. But it depends on widespread use of feature ids.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430977}{\*\bkmkstart _Toc300649377}SeqFeatData: Type Specific Feature Data{\*\bkmkend _Toc294430977}{\*\bkmkend _Toc300649377}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The "data" slot of a Seq-feat is filled with SeqFeatData, which is just a CHOICE of a variety of specific data structures. They are listed under their CHOICE type below, but for most types a detailed discussion will be found under the type name itself later in this chapter, or in another chapter. That is because most types are data objects in their own right, and may find uses in many other contexts than features.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430978}{\*\bkmkstart _Toc300649378}gene: Location Of A Gene{\*\bkmkend _Toc294430978}{\*\bkmkend _Toc300649378}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A gene is a feature of its own, rather than a modifier of other features as in the GenBank/EMBL/DDBJ feature tables. A gene is a heritable region of nucleic acid sequence which confers a measurable phenotype. That phenotype may be achieved by many components of the gene including but not limited to coding regions, promoters, enhancers, terminators, and so on. The gene feature is meant to approximately cover the region of nucleic acid considered by workers in the field to be the gene. This admittedly fuzzy concept has an appealing simplicity and fits in well with higher level views of genes such as genetic maps.
\par The gene feature is implemented with a Gene-ref object, or a "reference to" a gene. The Gene-ref object is discussed below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430979}{\*\bkmkstart _Toc300649379}org: Source Organism Of The Bioseq{\*\bkmkend _Toc294430979}{\*\bkmkend _Toc300649379}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Normally when a whole Bioseq or set of Bioseqs is from the same organism, the Org-ref (reference to Organism) will be found at the descriptor level of the Bioseq or Bioseq-set (see Biological Sequences). However, in some cases the whole Bioseq may not be from the same organism. This may occur naturally (e.g. a provirus integrated into a host chromosome) or artificially (e.g. recombinant DNA techniques).
\par The org feature is implemented with an Org-ref object, or a "reference to" an organism. The Org\_ref is discussed below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430980}{\*\bkmkstart _Toc300649380}cdregion: Coding Region{\*\bkmkend _Toc294430980}{\*\bkmkend _Toc300649380}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A cdregion is a region of nucleic acid which codes for a protein. It can be thought of as "instructions to translate" a nucleic acid, not simply as a series of exons or a reflection of an mRNA or primary transcript. Other features represent those things. Unfortunately, most existing sequences in the database are only annotated for coding region, so transcription and splicing information must be inferred (often inaccurately) from it. We encourage the annotation of transcription features in addition to the coding region. Note that since the cdregion is "instructions to translate", one can represent translational stuttering by having overlapping intervals in the Seq-feat.location. Again, beware of assuming a cdregion definitely reflects transcription.
\par A cdregion feature is implemented with a Cdregion object, discussed below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430981}{\*\bkmkstart _Toc300649381}prot: Describing A Protein{\*\bkmkend _Toc294430981}{\*\bkmkend _Toc300649381}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A protein feature describes and/or names a protein or region of a protein. It uses a Prot-ref object, or "reference to" a protein, described in detail below.
\par A single amino acid Bioseq can have many protein features on it. It may have one over its full length describing a pro-peptide, then a shorter one describing the mature peptide. An extreme case might be a viral polyprotein which would have one protein feature for the whole polyprotein, then additional protein features for each of the component mature proteins. One should always take into account the "location" slot of a protein feature.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430982}{\*\bkmkstart _Toc300649382}rna: Describing An RNA{\*\bkmkend _Toc294430982}{\*\bkmkend _Toc300649382}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An RNA feature can describe both coding intermediates and structural RNAs using an RNA-ref, or "reference to" an RNA. The RNA-ref is described in more detail below. The Seq-feat.location for an RNA can be attached to either the genomic sequence coding for the RNA, or to the sequence of the RNA itself, when available. The determination of whether the Bioseq the RNA feature is attached to is genomic or an RNA type is made by examining the Bioseq.descr.mol-type, not by making assumptions based on the feature. When both the genomic Bioseq and the RNA Bioseq are both available, one could attach the RNA Seq-feat.location to the genomic sequence and the Seq-feat.product to the RNA to connect them and capture explicitly the process by which the RNA is created.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430983}{\*\bkmkstart _Toc300649383}pub: Publication About A Bioseq Region{\*\bkmkend _Toc294430983}{\*\bkmkend _Toc300649383}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {When a publication describes a whole Bioseq, it would normally be at the "descr" slot of the Bioseq. However, if it applies to a sub region of the Bioseq, it is convenient to make it a feature. The pub feature uses a Pubdesc (see Biological Sequences for a detailed description) to describe a publication and how it relates to the Bioseq. To indicate a citation about a specific feature (as opposed to about the sequence region in general), use the Seq-feat.cit slot of that feature.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430984}{\*\bkmkstart _Toc300649384}seq: Tracking Original Sequence Sources{\*\bkmkend _Toc294430984}{\*\bkmkend _Toc300649384}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The "seq" feature is a simple way to associate a region of sequence with a region of another. For example, if one wished to annotate a region of a recombinant sequence as being from "pBR322 10-50" one would simply use a Seq-loc (see Sequence Locations and Identifiers) for the interval 10-50 on Seq-id pBR322. Software tools could use such information to provide the pBR322 numbering system over that interval.
\par This feature is really meant to accommodate older or approximate data about the source of a sequence region and is no more than annotation. More specific and computationally useful ways of doing this are (1) create the recombinant sequence as a segmented sequence directly (see Biological Sequences), (2) use the Seq-hist field of a Bioseq to record its history, (3) create alignments (see Sequence Alignments) which are also valid Seq-annots, to indicate more complex relationships of one Bioseq to others.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430985}{\*\bkmkstart _Toc300649385}imp: Importing Features From Other Data Models{\*\bkmkend _Toc294430985}{\*\bkmkend _Toc300649385}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The SeqFeatData types explicitly define only certain well understood or widely used feature types. There may be other features contained in databases converted to this specification which are not represented by this ASN.1 specification. At least for GenBank, EMBL, DDBJ, PIR, and SWISS-PROT, these can be mapped to an Imp-feat structure so the features are not lost, although they are still unique to the source database. All these features have the basic form of a string key, a location (carried as the original string), and a descriptor (another string). In the GenBank/EMBL/DDBJ case, any additional qualifiers can be carried on the Seq-feat.qual slot.
\par GenBank/EMBL/DDBJ use a "location" called "replace" which is actually an editing operation on the sequence which incorporates literal strings. Since the locations defined in this specification are locations on sequences, and not editing operations, features with replace operators are all converted to Imp-feat so that the original location string can be preserved. This same strategy is taken in the face of incorrectly constructed locations encountered in parsing outside databases into ASN.1.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430986}{\*\bkmkstart _Toc300649386}region: A Named Region{\*\bkmkend _Toc294430986}{\*\bkmkend _Toc300649386}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The region feature provides a simple way to name a region of a Bioseq (e.g. "globin locus", "LTR", "subrepeat region", etc).
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430987}{\*\bkmkstart _Toc300649387}comment: A Comment On A Region Of Sequence{\*\bkmkend _Toc294430987}{\*\bkmkend _Toc300649387}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The comment feature allows a comment to be made about any specified region of sequence. Since comment is already a field in Seq-feat, there is no need for an additional type specific data item in this case, so it is just NULL.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430988}{\*\bkmkstart _Toc300649388}bond: A Bond Between Residues{\*\bkmkend _Toc294430988}{\*\bkmkend _Toc300649388}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This feature annotates a bond between two residues. A Seq-loc of type "bond" is expected in Seq-feat.location. Certain types of bonds are given in the ENUMERATED type. If the bond type is "other" the Seq-feat.comment slot should be used to explain the type of the bond. Allowed bond types are:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {        disulfide (1) ,
\par         thiolester (2) ,
\par         xlink (3) ,
\par         thioether (4) ,
\par         other (255) \} ,
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430989}{\*\bkmkstart _Toc300649389}site: A Defined Site{\*\bkmkend _Toc294430989}{\*\bkmkend _Toc300649389}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The site feature annotates a know site from the following specified list. If the site is "other" then Seq-feat.comment should be used to explain the site.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\tab \tab active (1) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab binding (2) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab cleavage (3) ,
\par \tab \tab inhibit (4) ,
\par \tab \tab modified (5),
\par \tab \tab glycosylation (6) ,
\par \tab \tab myristoylation (7) ,
\par \tab \tab mutagenized (8) ,
\par \tab \tab metal-binding (9) ,
\par \tab \tab phosphorylation (10) ,
\par \tab \tab acetylation (11) ,
\par \tab \tab amidation (12) ,
\par \tab \tab methylation (13) ,
\par \tab \tab hydroxylation (14) ,
\par \tab \tab sulfatation (15) ,
\par \tab \tab oxidative-deamination (16) ,
\par \tab \tab pyrrolidone-carboxylic-acid (17) ,
\par \tab \tab gamma-carboxyglutamic-acid (18) ,
\par \tab \tab blocked (19) ,
\par \tab \tab lipid-binding (20) ,
\par \tab \tab np-binding (21) ,
\par \tab \tab dna-binding (22) ,
\par \tab \tab other (255) \} ,
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430990}{\*\bkmkstart _Toc300649390}rsite: A Restriction Enzyme Cut Site{\*\bkmkend _Toc294430990}{\*\bkmkend _Toc300649390}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A restriction map is basically a feature table with rsite features. Software which generates such a feature table could then use any sequence annotation viewer to display its results. Restriction maps generated by physical methods (before sequence is available), can use this feature to create a map type Bioseq representing the ordered restriction map. For efficiency one would probably create one Seq-feat for each restriction enzyme used and used the Packed-pnt Seq-loc in the location slot. See Rsite-ref, below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430991}{\*\bkmkstart _Toc300649391}user: A User Defined Feature{\*\bkmkend _Toc294430991}{\*\bkmkend _Toc300649391}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An end-user can create a feature completely of their own design by using a User-object (see General Use Objects) for SeqFeatData. This provides a means for controlled addition and testing of new feature types, which may or may not become widely accepted or to "graduate" to a defined SeqFeatData type. It is also a means for software to add structured information to Bioseqs for it's own use and which may never be intended to become a widely used standard. All the generic feature operations, including display, deletion, determining which features are carried on a sub region of sequence, etc, can be applied to an user feature with no knowledge of the particular User-object structure or meaning. Yet software which recognizes that User-object can take advantage of it.
\par If an existing feature type is available but lacks certain additional fields necessary for a special task or view of information, then it should be extended with the Seq-feat.ext slot, rather than building a complete user feature de novo.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430992}{\*\bkmkstart _Toc300649392}txinit: Transcription Initiation{\*\bkmkend _Toc294430992}{\*\bkmkend _Toc300649392}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This feature is used to designate the region of transcription initiation, about which considerable knowledge is available. See Txinit, below.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430993}{\*\bkmkstart _Toc300649393}num: Applying Custom Numbering To A Region{\*\bkmkend _Toc294430993}{\*\bkmkend _Toc300649393}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Numbering object can be used as a Bioseq descriptor to associate various numbering systems with an entire Bioseq. When used as a feature, the numbering system applies only to the region in Seq-feat.location. This make multiple, discontinuous numbering systems available on the same Bioseq. See Biological Sequences for a description of Numbering, and also Seq-feat.seq, above, for an alternative way of applying a sequence name and it's numbering system to a sequence region.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430994}{\*\bkmkstart _Toc300649394}psec-str: Protein Secondary Structure{\*\bkmkend _Toc294430994}{\*\bkmkend _Toc300649394}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Secondary structure can be annotated on a protein sequence using this type. It can be predicted by algorithm (in which case Seq-feat.exp-ev should be "not-experimental") or by analysis of the known protein structure (Seq-feat.exp-ev = "experimental"). Only three types of secondary structure are currently supported. A "helix" is any helix, a "sheet" is beta sheet, and "turn" is a beta or gamma turn. Given the controversial nature of secondary structure classification (not be mention prediction), we opted to keep it simple until it was clear that more detail was really necessary or understood.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430995}{\*\bkmkstart _Toc300649395}non-std-residue: Unusual Residues{\*\bkmkend _Toc294430995}{\*\bkmkend _Toc300649395}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {When an unusual residue does not have a direct sequence code, the "best" standard substitute can be used in the sequence and the residue can be labeled with its real name. No attempt is made to enforce a standard nomenclature for this string.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430996}{\*\bkmkstart _Toc300649396}het: Heterogen{\*\bkmkend _Toc294430996}{\*\bkmkend _Toc300649396}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In the PDB structural database, non-biopolymer atoms associated with a Bioseq are referred to as "heterogens". When a heterogen appears as a feature, it is assumed to be bonded to the sequence positions in Seq-feat.location. If there is no specific bonding information, the heterogen will appear as a descriptor of the Bioseq. The Seq-loc for the Seq-feat.location will probably be a point or points, not a bond. A Seq-loc of type bond is between sequence residues.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430997}{\*\bkmkstart _Toc300649397}Seq-feat Implementation in C{\*\bkmkend _Toc294430997}{\*\bkmkend _Toc300649397}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The C implementation of a Seq-feat is mostly straightforward. However, some explanation of the "id" and "data" slots will be helpful. Both are implemented as a Choice, which is like a ValNode but without a next pointer. Both Choice structures are included as part of a SeqFeat structure. In the tables below the values of Choice.choice and the type in Choice.data.ptrvalue or Choice.data.intvalue are shown.
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {SeqFeat.id
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b ASN.1 name\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Value in Choice.choice\cell Type in Choice.data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3170\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {(not present)\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {0\cell not needed\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {gibb\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {1\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {giim\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {2\cell GiimPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {local\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {3\cell ObjectIdPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {general\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {4\cell DbtagPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {SeqFeat.data
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b ASN.1 name\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Value in Choice.choice\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Type in Choice.data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3170\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {(not present)\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {0\cell not needed\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {gene\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {1\cell GeneRefPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {org\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {2\cell OrgRefPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {cdregion\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {3\cell CdRegionPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {prot\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {4\cell ProtRefPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {rna\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {5\cell RnaRefPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {pub\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {6\cell PubdescPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {seq\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {7\cell SeqLocPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {imp\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {8\cell ImpFeatPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {region\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {9\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {comment\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {10\cell (not used)\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {bond\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {11\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {site\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {12\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {rsite\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {13\cell RsiteRefPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {user\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {14\cell UserObjectPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {txinit\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {15\cell TxinitPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {num\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {16\cell NumberingPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {psec-str\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {17\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {non-std-residue\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {18\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3170\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx5895\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {het\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {19\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard \sb240\widctlpar\adjustright {In addition to the usual SeqFeatNew(), SeqFeatAsnRead(), SeqFeatAsnWrite(), and SeqFeatFree() functions, there is a SeqFeatToXref() function which creates an xref and copies the "id" and "data" slots to it. There are also SeqFeatSetAsnRead() and SeqFeatSetAsnWrite() functions for sets of features. Finally, there is are special SeqFeatDataAsnRead(), SeqFeatDataAsnWrite(), and SeqFeatDataFree() functions which operate on the "data" component of a SeqFeat structure since there is no separate C structure for SeqFeatData.
\par }\pard \sb240\widctlpar\adjustright {Of course, within the software tools for producing GenBank, report, or other formats from ASN.1 are functions to format and display features as well. There are some functions to manipulate the SeqFeatData objects, such as the translation of a CdRegion, and a host of functions to use and compare the Seq-locs of "product" and "location" or easily access and use the sequence regions they point to. These functions are discussed in the Sequence Utilities chapter. Additional functions, described in Exploring The Data, allow one to easily locate features of interest by type, in arbitrarily complex objects.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294430998}{\*\bkmkstart _Toc300649398}CdRegion: Coding Region{\*\bkmkend _Toc294430998}{\*\bkmkend _Toc300649398}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A CdRegion, in association with a Seq-feat, is considered "instructions to translate" to protein. The Seq-locs used by the Seq-feat do not necessarily reflect the exon structure of the primary transcript (although they often do). A Seq-feat of type CdRegion can point both to the source nucleic acid and to the protein sequence it produces. Most of the information about the source nucleic acid (such as the gene) or the destination protein (such as it's name) are associated directly with those Bioseqs. The CdRegion only serves as a link between them, and as a method for explicitly encoding the information needed to derive one from the other.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294430999}{\*\bkmkstart _Toc300649399}orf: Open Reading Frame{\*\bkmkend _Toc294430999}{\*\bkmkend _Toc300649399}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {CdRegion.orf is TRUE if the coding region is only known to be an open reading frame. This is a signal that nothing is known about the protein product, or even if it is produced. In this case the translated protein sequence will be attached, but there will be no other information associated with it. This flag allows such very speculative coding regions to be easily ignored when scanning the database for genuine protein coding regions.
\par The orf flag is not set when any reasonable argument can be made that the CdRegion is really expressed, such as detection of mRNA or strong sequence similarity to known proteins.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431000}{\*\bkmkstart _Toc300649400}Translation Information{\*\bkmkend _Toc294431000}{\*\bkmkend _Toc300649400}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {CdRegion has several explicit fields to define how to translate the coding region. Reading frame is explicitly given or defaults to frame one.
\par The genetic code is assumed to be the universal code unless given explicitly. The code itself is given, rather than requiring software to determine the code at run-time by analyzing the phylogenetic position of the Bioseq. Genetic code is described below.
\par Occasionally the genetic code is not followed at specific positions in the sequence. Examples are the use of alternate initiation codons only in the first position, the effects of suppresser tRNAs, or the addition of selenocysteine. The Code-break object specifies the three bases of the codon in the Bioseq which is treated differently and the amino acid which is generated at that position. During translation the genetic code is followed except at positions indicated by Code-breaks, where the instructions in the Code-break are followed instead.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431001}{\*\bkmkstart _Toc300649401}Problems With Translations{\*\bkmkend _Toc294431001}{\*\bkmkend _Toc300649401}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {In a surprising number of cases an author publishes both a nucleic acid sequence and the protein sequence produced by its coding region, but the translation of the coding region does not yield the published protein sequence. On the basis of the publication it is not possible to know for certain which sequence is correct. In the NCBI Backbone database both sequences are preserved as published by the author, but the conflict flag is set to TRUE in the CdRegion. If available, the number of gaps and mismatches in the alignment of the translated sequence to the published protein sequence are also given so a judgment can be made about the severity of the problem.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431002}{\*\bkmkstart _Toc300649402}Genetic Codes{\*\bkmkend _Toc294431002}{\*\bkmkend _Toc300649402}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Genetic-code is a SET which may include one or more of a name, an integer id, or 64 cell arrays of amino acid codes in different alphabets. Thus, in a CdRegion, one can either refer to a genetic code by name or id, provide the genetic code itself, or both. Tables of genetic codes are provided in the NCBI software release with most possibilities filled in.
\par The Genetic-code.name is a descriptive name for the genetic code, mainly for display to humans. The integer id refers to the ids in the gc.val (binary ASN.1) or gc.prt (text ASN.1) file of genetic codes maintained by NCBI, distributed with the software tools and Entrez releases, and published in the GenBank/EMBL/DDBJ feature table document. Genetic-code.id is the best way to explicitly refer to a genetic code.
\par The genetic codes themselves are arrays of 64 amino acid codes. The index to the position in the array of the amino acid is derived from the codon by the following method:
\par }\pard \qc\sb240\widctlpar\adjustright {index = (base1 * 16) + (base2 * 4) + base3
\par }\pard \qc\widctlpar\adjustright {where T=0, C=1, A=2, G=3
\par }\pard \sb240\widctlpar\adjustright {Note that this encoding of the bases is not the same as any of the standard nucleic acid encoding described in Biological Sequence. This set of values was chosen specifically for genetic codes because it results in the convenient groupings of amino acid by codon preferred for display of genetic code tables.
\par }\pard \sb240\widctlpar\adjustright {The genetic code arrays have names which indicate the amino acid alphabet used (e.g. ncbieaa). The same encoding technique is used to specify start codons. Alphabet names are prefixed with "s" (e.g. sncbieaa) to indicate start codon arrays. Each cell of a start codon array contains either the gap code ("-" for ncbieaa) or an amino acid code if it is valid to use the codon as a start codon. Currently all starts are set to code for methionine, since it has never been convincingly demonstrated that a protein can start with any other amino acid. However, if other amino acids are shown to be used as starts, this structure can easily accommodate that information.
\par The contents of gc.prt, the current supported genetic codes, is given at the end of this chapter.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431003}{\*\bkmkstart _Toc300649403}C Implementation Of Genetic Codes{\*\bkmkend _Toc294431003}{\*\bkmkend _Toc300649403}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {GeneticCode is implemented as a ValNodePtr with choice = 254. The ValNodePtr\_>data.ptrvalue is the head of a linked list of ValNodes, each of which contains on of the possible forms of a particular GeneticCode as follows:
\par }\pard\plain \s31\qc\sb240\keepn\widctlpar\adjustright \b\f16\cgrid {GeneticCode Elements
\par }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3308\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx6033\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {\b ASN.1 name\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {\b Value in ValNode.choice\cell Type in ValNode.data\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\b\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3308\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx6033\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {name\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {1\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \cltxlrtb \cellx3308\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx6033\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {id\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {2\cell integer\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbieaa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {3\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbi8aa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {4\cell ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {ncbistdaa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {5\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {sncbieaa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {6\cell CharPtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {sncbi8aa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {7\cell ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\trowd \trqc\trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx1562\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \cltxlrtb \cellx3308\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx6033\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {sncbistdaa\cell }\pard \s29\keepn\widctlpar\intbl\adjustright {8\cell ByteStorePtr\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\f0 \row }\pard \sb240\widctlpar\adjustright {GeneticCodeNew() returns a pointer to the ValNode with choice = 254, the element which points to the head of the chain. This is the datum which is returned from GeneticCodeAsnRead() and is passed to GeneticCodeAsnWrite() and GeneticCodeFree(). There are also GeneticCodeTableAsnRead() and ..Write() functions. The table functions expect a list of ValNode with ->choice = 254 linked by their ->next pointers, each with a linked list of ValNodes representing the elements of a genetic code starting from its ValNodePtr->data.ptrvalue.
\par }\pard \sb240\widctlpar\adjustright {A special function, GeneticCodeTableLoad() reads gc.val into memory. For this function to work the gc.val file must be in the directory with other DATA items such as sequence alphabet file, seqcode.val.
\par GeneticCodeFind(id, name) returns a GeneticCodePtr to the appropriate code assuming GeneticCodeTableLoad() has previously succeeded. If "name" is NULL, id is matched. If the code cannot be found, NULL is returned.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431004}{\*\bkmkstart _Toc300649404}Rsite-ref: Reference To A Restriction Enzyme{\*\bkmkend _Toc294431004}{\*\bkmkend _Toc300649404}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This simple data structure just references a restriction enzyme. It is a choice of a simple string (which may or may not be from a controlled vocabulary) or a Dbtag, in order to cite an enzyme from a specific database such as RSITE. The Dbtag is preferred, if available.
\par Note that this reference is not an Rsite-entry which might contain a host of information about the restriction enzyme, but is only a reference to the enzyme.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431005}{\*\bkmkstart _Toc300649405}RNA-ref: Reference To An RNA{\*\bkmkend _Toc294431005}{\*\bkmkend _Toc300649405}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An RNA-ref allows naming and a minimal description of various RNAs. The "type" is a controlled vocabulary for dividing RNAs into broad, well accepted classes. The "pseudo" field is used for RNA pseudogenes.
\par The "ext" field allows the addition of structure information appropriate to a specific RNA class as appropriate. The "name" extension allows naming the "other" type or adding a modifier, such as "28S" to rRNA. For tRNA there is a structured extension which as fields for the amino acid transferred, drawn from the standard amino acid alphabets, and a value for one or more codons that this tRNA recognizes. The values of the codons are calculated as a number from 0 to 63 using the same formula as for calculating the index to Genetic Codes, above.
\par As nomenclature and attributes for classes of RNAs becomes better understood and accepted, the RNA-ref.ext will gain additional extensions.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431006}{\*\bkmkstart _Toc300649406}Gene-ref: Reference To A Gene{\*\bkmkend _Toc294431006}{\*\bkmkend _Toc300649406}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Gene-ref is not intended to carry all the information one might want to know about a gene, but to provide a small set of information and reference some larger body of information, such as an entry in a genetic database.
\par The "locus" field is for the gene symbol, preferably an official one (e.g. "Adh"). The "allele" field is for an allele symbol (e.g. "S"). The "desc" field is for a descriptive name for the gene (e.g. "Alcohol dehydrogenase, SLOW allele"). One should fill in as many of these fields as possible.
\par The "maploc" field accepts a string with a map location using whatever conventions are appropriate to the organism. This field is hardly definitive and if up to date mapping information is desired a true mapping database should always be consulted.
\par If "pseudo" is TRUE, this is a pseudogene.
\par The "db" field allows the Gene-ref to be attached to controlled identifiers from established gene databases. This allows a direct key to a database where gene information will be kept up to date without requiring that the rest of the information in the Gene-ref necessarily be up to date as well. This type of foreign key is essential to keeping loosely connected data up to date and NCBI is encouraging gene databases to make such controlled keys publicly available.
\par The "syn" field holds synonyms for the gene. It does not attempt to discriminate symbols, alleles, or descriptions.
\par In addition to the usual C functions, there is a specific GeneRefDup() function to duplicate this object quickly.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431007}{\*\bkmkstart _Toc300649407}Prot-ref: Reference To A Protein{\*\bkmkend _Toc294431007}{\*\bkmkend _Toc300649407}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Prot-ref is meant to reference a protein very analogous to the way a Gene-ref references a gene. The "name" field is a SET OF strings to allow synonyms. The first name is presumed to be the preferred name by software tools. Since there is no controlled vocabulary for protein names this is the best that can be done at this time. "ADH" and "alcohol dehydrogenase" are both protein names.
\par }\pard \sb240\widctlpar\adjustright {The "desc" field is for a description of the protein. This field is often not necessary if the name field is filled in, but may be informative in some cases and essential in cases where the protein has not yet been named (e.g. ORF21 putative protein).
\par }\pard \sb240\widctlpar\adjustright {The "ec" field contains a SET of EC numbers. These strings are expected to be only numbers separated by periods (no leading "EC"). Sometimes the last few positions will be occupied by dashes or not filled in at all if the protein has not been fully characterized. Examples of EC numbers are ( 1.14.13.8 or 1.14.14.- or 1.14.14.3 or 1.14.--.-- or 1.14 ).
\par The "activity" field allows the various known activities of the protein to be specified. This can be very helpful, especially when the name is not informative.
\par The "db" field is to accommodate keys from protein databases. While protein nomenclature is not well controlled, there are subfields such as immunology which have controlled names. There are also databases which characterize proteins in other ways than sequence, such as 2-d spot databases which could provide such a key.
\par In addition to the usual C functions, there is also a ProtRefDup() for quickly duplicating this object.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431008}{\*\bkmkstart _Toc300649408}Txinit: Transcription Initiation{\*\bkmkend _Toc294431008}{\*\bkmkend _Toc300649408}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is an example of a SeqFeatData block designed and built by a domain expert, an approach the NCBI strongly encourages and supports. The Txinit structure was developed by Philip Bucher and David Ghosh. It carries most of the information about transcription initiation represented in the Eukaryotic Promoter Database (EPD). The Txinit structure carries a host of detailed experimental information, far beyond the simple "promoter" features in GenBank/EMBL/DDBJ. EPD is released as a database in its own right and as Txinit Seq-feats. NCBI will be incorporating the EPD in its feature table form to provide expert annotation of the sequence databases in the manner described in the Data Model chapter.
\par The Txinit object is well described by its comments in the ASN.1 definition. The best source of more in depth discussion of these fields is in the EPD documentation, and so it will not be reproduced here.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431009}{\*\bkmkstart _Toc300649409}Current Genetic Code Table: gc.prt{\*\bkmkend _Toc294431009}{\*\bkmkend _Toc300649409}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx90\tx180\tx1440\adjustright \f2\fs18\cgrid {--**************************************************************************
\par --  This is the NCBI genetic code table
\par --  Base 1-3 of each codon have been added as comments to facilitate
\par --    readability at the suggestion of Peter Rice, EMBL
\par --*************************************************************************
\par 
\par Genetic-code-table ::= \{
\par \tab \{
\par \tab \tab name "Standard" ,
\par \tab \tab name "SGC0" ,
\par \tab \tab id 1 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Vertebrate Mitochondrial" ,
\par \tab \tab name "SGC1" ,
\par \tab \tab id 2 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIMMTTTTNNKKSS**VVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "--------------------------------MMMM---------------M------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Yeast Mitochondrial" ,
\par \tab \tab name "SGC2" ,
\par \tab \tab id 3 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWTTTTPPPPHHQQRRRRIIMMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx90\tx180\tx1440\adjustright {\tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx90\tx180\tx1440\adjustright {\tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Mold Mitochondrial and Mycoplasma" ,
\par \tab \tab name "SGC3" ,
\par \tab \tab id 4 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Invertebrate Mitochondrial" ,
\par \tab \tab name "SGC4" ,
\par \tab \tab id 5 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIMMTTTTNNKKSSSSVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "---M----------------------------M-MM----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Ciliate Macronuclear and Daycladacean" ,
\par \tab \tab name "SGC5" ,
\par \tab \tab id 6 ,
\par \tab \tab ncbieaa  "FFLLSSSSYYQQCC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Protozoan Mitochondrial (and Kinetoplast)" ,
\par \tab \tab name "SGC6" ,
\par \tab \tab id 7 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "--MM---------------M------------MMMM---------------M------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,\tab \tab \tab \tab \tab \tab \tab \tab \tab \tab \tab   
\par \tab \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx90\tx180\tx1440\adjustright {\tab \tab name "Plant Mitochondrial/Chloroplast (posttranscriptional variant)" ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx90\tx180\tx1440\adjustright {\tab \tab name "SGC7" ,
\par \tab \tab id 8 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRWIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "--M-----------------------------MMMM---------------M------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Echinoderm Mitochondrial" ,
\par \tab \tab name "SGC8" ,
\par \tab \tab id 9 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNNKSSSSVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Euplotid Macronuclear" ,
\par \tab \tab name "SGC9" ,
\par \tab \tab id 10 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY*QCCCWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "-----------------------------------M----------------------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} ,
\par \tab \{
\par \tab \tab name "Eubacterial" ,
\par \tab \tab id 11 ,
\par \tab \tab ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",
\par \tab \tab sncbieaa "---M---------------M------------M--M---------------M------------"
\par \tab \tab -- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG
\par \tab \tab -- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG
\par \tab \tab -- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG
\par \tab \} 
\par \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431010}{\*\bkmkstart _Toc300649410}ASN.1 Specification: seqfeat.asn{\*\bkmkend _Toc294431010}{\*\bkmkend _Toc300649410}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--  NCBI Sequence Feature elements
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Seqfeat DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Seq-feat, Feat-id;
\par 
\par IMPORTS Gene-ref FROM NCBI-Gene
\par         Prot-ref FROM NCBI-Protein
\par         Org-ref FROM NCBI-Organism
\par         RNA-ref FROM NCBI-RNA
\par         Seq-loc, Giimport-id FROM NCBI-Seqloc
\par         Pubdesc, Numbering, Heterogen FROM NCBI-Sequence
\par         Rsite-ref FROM NCBI-Rsite
\par         Txinit FROM NCBI-TxInit
\par         Pub-set FROM NCBI-Pub
\par         Object-id, Dbtag, User-object FROM NCBI-General;
\par 
\par --*** Feature identifiers ********************************
\par --*
\par 
\par Feat-id ::= CHOICE \{
\par     gibb INTEGER ,            -- geninfo backbone
\par     giim Giimport-id ,        -- geninfo import
\par     local Object-id ,         -- for local software use
\par     general Dbtag \}           -- for use by various databases
\par 
\par --*** Seq-feat *******************************************
\par --*  sequence feature generalization
\par 
\par Seq-feat ::= SEQUENCE \{
\par     id Feat-id OPTIONAL ,
\par     data SeqFeatData ,           -- the specific data
\par     partial BOOLEAN OPTIONAL ,    -- incomplete in some way?
\par     except BOOLEAN OPTIONAL ,     -- something funny about this?
\par     comment VisibleString OPTIONAL ,
\par     product Seq-loc OPTIONAL ,    -- product of process
\par     location Seq-loc ,            -- feature made from
\par     qual SEQUENCE OF Gb-qual OPTIONAL ,  -- qualifiers
\par     title VisibleString OPTIONAL ,   -- for user defined label
\par     ext User-object OPTIONAL ,    -- user defined structure extension
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    cit Pub-set OPTIONAL ,        -- citations for this feature
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    exp-ev ENUMERATED \{           -- evidence for existence of feature
\par         experimental (1) ,        -- any reasonable experimental check
\par         not-experimental (2) \} OPTIONAL , -- similarity, pattern, etc
\par \tab xref SET OF SeqFeatXref OPTIONAL \}   -- cite other relevant features
\par 
\par SeqFeatData ::= CHOICE \{
\par     gene Gene-ref ,
\par     org Org-ref ,
\par     cdregion Cdregion ,
\par     prot Prot-ref ,
\par     rna RNA-ref ,
\par     pub Pubdesc ,              -- publication applies to this seq 
\par     seq Seq-loc ,              -- to annotate origin from another seq
\par     imp Imp-feat ,
\par     region VisibleString,      -- named region (globin locus)
\par     comment NULL ,             -- just a comment
\par     bond ENUMERATED \{
\par         disulfide (1) ,
\par         thiolester (2) ,
\par         xlink (3) ,
\par         thioether (4) ,
\par         other (255) \} ,
\par \tab site ENUMERATED \{
\par \tab \tab active (1) ,
\par \tab \tab binding (2) ,
\par \tab \tab cleavage (3) ,
\par \tab \tab inhibit (4) ,
\par \tab \tab modified (5),
\par \tab \tab glycosylation (6) ,
\par \tab \tab myristoylation (7) ,
\par \tab \tab mutagenized (8) ,
\par \tab \tab metal-binding (9) ,
\par \tab \tab phosphorylation (10) ,
\par \tab \tab acetylation (11) ,
\par \tab \tab amidation (12) ,
\par \tab \tab methylation (13) ,
\par \tab \tab hydroxylation (14) ,
\par \tab \tab sulfatation (15) ,
\par \tab \tab oxidative-deamination (16) ,
\par \tab \tab pyrrolidone-carboxylic-acid (17) ,
\par \tab \tab gamma-carboxyglutamic-acid (18) ,
\par \tab \tab blocked (19) ,
\par \tab \tab lipid-binding (20) ,
\par \tab \tab np-binding (21) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab dna-binding (22) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab other (255) \} ,
\par     rsite Rsite-ref ,       -- restriction site  (for maps really)
\par     user User-object ,      -- user defined structure
\par     txinit Txinit ,         -- transcription initiation
\par \tab num Numbering ,         -- a numbering system
\par \tab psec-str ENUMERATED \{   -- protein secondary structure
\par \tab \tab helix (1) ,         -- any helix
\par \tab \tab sheet (2) ,         -- beta sheet
\par \tab \tab turn  (3) \} ,       -- beta or gamma turn
\par \tab non-std-residue VisibleString ,  -- non-standard residue here in seq
\par \tab het Heterogen \}         -- cofactor, prosthetic grp, etc, bound to seq
\par 
\par SeqFeatXref ::= SEQUENCE \{
\par     id Feat-id OPTIONAL ,\tab \tab  -- the feature copied
\par     data SeqFeatData \}           -- the specific data
\par \tab 
\par --*** CdRegion ***********************************************
\par --*
\par --*  Instructions to translate from a nucleic acid to a peptide
\par --*    conflict means it's supposed to translate but doesn't
\par --*
\par 
\par 
\par Cdregion ::= SEQUENCE \{
\par     orf BOOLEAN OPTIONAL ,             -- just an ORF ?
\par     frame ENUMERATED \{
\par         not-set (0) ,                  -- not set, default to one
\par         one (1) ,
\par         two (2) ,
\par         three (3) \} DEFAULT one ,      -- reading frame
\par     conflict BOOLEAN OPTIONAL ,        -- conflict
\par     gaps INTEGER OPTIONAL ,            -- number of gaps on conflict/except
\par     mismatch INTEGER OPTIONAL ,        -- number of mismatches on above
\par     code Genetic-code OPTIONAL ,       -- genetic code used
\par     code-break SEQUENCE OF Code-break OPTIONAL ,   -- individual exceptions
\par     stops INTEGER OPTIONAL \}           -- number of stop codons on above
\par 
\par                     -- each code is 64 cells long, in the order where
\par                     -- T=0,C=1,A=2,G=3, TTT=0, TTC=1, TCA=4, etc
\par                     -- NOTE: this order does NOT corresspond to a Seq-data
\par                     -- encoding.  It is "natural" to codon usage instead.
\par                     -- the value in each cell is the AA coded for
\par                     -- start= AA coded only if first in peptide
\par                     --   in start array, if codon is not a legitimate start
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {                    --   codon, that cell will have the "gap" symbol for
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {                    --   that alphabet.  Otherwise it will have the AA
\par                     --   encoded when that codon is used at the start.
\par 
\par Genetic-code ::= SET OF CHOICE \{
\par     name VisibleString ,               -- name of a code
\par     id INTEGER ,                       -- id in dbase
\par     ncbieaa VisibleString ,            -- indexed to IUPAC extended
\par     ncbi8aa OCTET STRING ,             -- indexed to NCBI8aa
\par \tab ncbistdaa OCTET STRING ,           -- indexed to NCBIstdaa
\par     sncbieaa VisibleString ,            -- start, indexed to IUPAC extended
\par     sncbi8aa OCTET STRING ,             -- start, indexed to NCBI8aa
\par \tab sncbistdaa OCTET STRING \}           -- start, indexed to NCBIstdaa
\par 
\par Code-break ::= SEQUENCE \{              -- specific codon exceptions
\par     loc Seq-loc ,                      -- location of exception
\par     aa CHOICE \{                        -- the amino acid
\par         ncbieaa INTEGER ,              -- ASCII value of NCBIeaa code
\par         ncbi8aa INTEGER ,              -- NCBI8aa code
\par \tab \tab ncbistdaa INTEGER \} \}           -- NCBIstdaa code
\par 
\par Genetic-code-table ::= SET OF Genetic-code     -- table of genetic codes
\par 
\par --*** Import ***********************************************
\par --*
\par --*  Features imported from other databases
\par --*
\par 
\par Imp-feat ::= SEQUENCE \{
\par     key VisibleString ,
\par     loc VisibleString OPTIONAL ,         -- original location string
\par     descr VisibleString OPTIONAL \}       -- text description
\par 
\par Gb-qual ::= SEQUENCE \{
\par     qual VisibleString ,
\par     val VisibleString \}
\par 
\par END 
\par 
\par --**********************************************************************
\par --
\par --  NCBI Restriction Sites
\par --  by James Ostell, 1990
\par --  version 0.8
\par --
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--**********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par NCBI-Rsite DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Rsite-ref;
\par 
\par IMPORTS Dbtag FROM NCBI-General;
\par 
\par Rsite-ref ::= CHOICE \{
\par     str VisibleString ,     -- may be unparsable
\par     db  Dbtag \}             -- pointer to a restriction site database
\par 
\par END
\par 
\par --**********************************************************************
\par --
\par --  NCBI RNAs
\par --  by James Ostell, 1990
\par --  version 0.8
\par --
\par --**********************************************************************
\par 
\par NCBI-RNA DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS RNA-ref, Trna-ext;
\par 
\par --*** rnas ***********************************************
\par --*
\par --*  various rnas
\par --*
\par                          -- minimal RNA sequence
\par RNA-ref ::= SEQUENCE \{
\par     type ENUMERATED \{            -- type of RNA feature
\par         unknown (0) ,
\par         premsg (1) ,
\par         mRNA (2) ,
\par         tRNA (3) ,
\par         rRNA (4) ,
\par         snRNA (5) ,
\par         scRNA (6) ,
\par         other (255) \} ,
\par     pseudo BOOLEAN OPTIONAL ,  
\par     ext CHOICE \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        name VisibleString ,        -- for naming "other" type
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        tRNA Trna-ext \} OPTIONAL \}  -- for tRNAs
\par 
\par Trna-ext ::= SEQUENCE \{                -- tRNA feature extensions
\par     aa CHOICE \{                         -- aa this carries
\par         iupacaa INTEGER ,
\par         ncbieaa INTEGER ,
\par         ncbi8aa INTEGER ,
\par \tab \tab ncbistdaa INTEGER \} OPTIONAL ,
\par     codon SET OF INTEGER OPTIONAL \}     -- codon(s) as in Genetic-code
\par                                         -- NOT anti-codons
\par END
\par 
\par --**********************************************************************
\par --
\par --  NCBI Genes
\par --  by James Ostell, 1990
\par --  version 0.8
\par --
\par --**********************************************************************
\par 
\par NCBI-Gene DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Gene-ref;
\par 
\par IMPORTS Dbtag FROM NCBI-General;
\par 
\par --*** Gene ***********************************************
\par --*
\par --*  reference to a gene
\par --*
\par 
\par Gene-ref ::= SEQUENCE \{
\par     locus VisibleString OPTIONAL ,     -- Official gene symbol
\par     allele VisibleString OPTIONAL ,    -- Official allele designation
\par     desc VisibleString OPTIONAL ,      -- descriptive name
\par     maploc VisibleString OPTIONAL ,    -- descriptive map location
\par     pseudo BOOLEAN DEFAULT FALSE ,          -- pseudogene
\par     db SET OF Dbtag OPTIONAL ,      -- ids in other dbases
\par \tab syn SET OF VisibleString OPTIONAL \}      -- synonyms for locus
\par 
\par END
\par 
\par --**********************************************************************
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--  NCBI Organism
\par --  by James Ostell, 1990
\par --  version 0.8
\par --
\par --**********************************************************************
\par 
\par NCBI-Organism DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Org-ref;
\par 
\par IMPORTS Dbtag FROM NCBI-General;
\par 
\par --*** Org-ref ***********************************************
\par --*
\par --*  Reference to an organism
\par --*
\par 
\par Org-ref ::= SEQUENCE \{
\par     taxname VisibleString OPTIONAL ,   -- scientific name
\par     common VisibleString OPTIONAL ,    -- common name
\par     mod SET OF VisibleString OPTIONAL , -- modifier for tissue/strain/line
\par     db SET OF Dbtag OPTIONAL ,         -- ids in other dbases
\par     syn SET OF VisibleString OPTIONAL \}  -- synonyms for taxname or common
\par 
\par END 
\par 
\par --**********************************************************************
\par --
\par --  NCBI Protein
\par --  by James Ostell, 1990
\par --  version 0.8
\par --
\par --**********************************************************************
\par 
\par NCBI-Protein DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Prot-ref;
\par 
\par IMPORTS Dbtag FROM NCBI-General;
\par 
\par --*** Prot-ref ***********************************************
\par --*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--*  Reference to a protein name
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {--*
\par 
\par Prot-ref ::= SEQUENCE \{
\par     name SET OF VisibleString OPTIONAL ,      -- protein name
\par     desc VisibleString OPTIONAL ,      -- description (instead of name)
\par     ec SET OF VisibleString OPTIONAL , -- E.C. number(s)
\par     activity SET OF VisibleString OPTIONAL ,  -- activities
\par     db SET OF Dbtag OPTIONAL \}         -- ids in other dbases
\par 
\par 
\par 
\par END 
\par --********************************************************************
\par --
\par --  Transcription Initiation Site Feature Data Block
\par --  James Ostell, 1991
\par --  Philip Bucher, David Ghosh
\par --  version 1.1
\par --
\par --  
\par --
\par --********************************************************************
\par 
\par NCBI-TxInit DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Txinit;
\par 
\par IMPORTS Gene-ref, Prot-ref, Org-ref FROM NCBI-SeqFeat;
\par 
\par Txinit ::= SEQUENCE \{
\par     name VisibleString ,    -- descriptive name of initiation site
\par     syn SEQUENCE OF VisibleString OPTIONAL ,   -- synonyms
\par     gene SEQUENCE OF Gene-ref OPTIONAL ,  -- gene(s) transcribed
\par     protein SEQUENCE OF Prot-ref OPTIONAL ,   -- protein(s) produced
\par     rna SEQUENCE OF VisibleString OPTIONAL ,  -- rna(s) produced
\par     expression VisibleString OPTIONAL ,  -- tissue/time of expression
\par     txsystem ENUMERATED \{       -- transcription apparatus used at this site
\par         unknown (0) ,
\par         pol1 (1) ,      -- eukaryotic Pol I
\par         pol2 (2) ,      -- eukaryotic Pol II
\par         pol3 (3) ,      -- eukaryotic Pol III
\par         bacterial (4) ,
\par         viral (5) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        rna (6) ,       -- RNA replicase
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        organelle (7) ,
\par         other (255) \} ,
\par     txdescr VisibleString OPTIONAL ,   -- modifiers on txsystem
\par     txorg Org-ref OPTIONAL ,  -- organism supplying transcription apparatus
\par     mapping-precise BOOLEAN DEFAULT FALSE ,  -- mapping precise or approx
\par     location-accurate BOOLEAN DEFAULT FALSE , -- does Seq-loc reflect mapping
\par     inittype ENUMERATED \{
\par         unknown (0) ,
\par         single (1) ,
\par         multiple (2) ,
\par         region (3) \} OPTIONAL ,
\par     evidence SET OF Tx-evidence OPTIONAL \}
\par 
\par Tx-evidence ::= SEQUENCE \{
\par     exp-code ENUMERATED \{
\par         unknown (0) ,    
\par         rna-seq (1) ,   -- direct RNA sequencing
\par         rna-size (2) ,  -- RNA length measurement
\par         np-map (3) ,    -- nuclease protection mapping with homologous sequence ladder
\par         np-size (4) ,   -- nuclease protected fragment length measurement
\par         pe-seq (5) ,    -- dideoxy RNA sequencing 
\par         cDNA-seq (6) ,  -- full-length cDNA sequencing
\par         pe-map (7) ,    -- primer extension mapping with homologous sequence ladder    
\par         pe-size (8) ,   -- primer extension product length measurement
\par         pseudo-seq (9) , -- full-length processed pseudogene sequencing
\par \tab \tab rev-pe-map (10) ,   -- see NOTE (1) below
\par         other (255) \} ,
\par     expression-system ENUMERATED \{
\par         unknown (0) ,
\par         physiological (1) ,
\par         in-vitro (2) ,
\par         oocyte (3) ,
\par         transfection (4) ,
\par         transgenic (5) ,
\par         other (255) \} DEFAULT physiological ,
\par     low-prec-data BOOLEAN DEFAULT FALSE ,
\par     from-homolog BOOLEAN DEFAULT FALSE \}     -- experiment actually done on
\par                                              --  close homolog
\par 
\par \tab -- NOTE (1) length measurement of a reverse direction primer-extension
\par \tab --\tab \tab \tab product (blocked  by  RNA  5'end)  by  comparison with
\par \tab --\tab \tab \tab homologous sequence ladder (J. Mol. Biol. 199, 587)
\par 
\par     
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431011}{\*\bkmkstart _Toc300649411}C Structures and Functions: objfeat.h{\*\bkmkend _Toc294431011}{\*\bkmkend _Toc300649411}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objfeat.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objfeat.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-SeqFeat
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifndef _NCBI_Seqfeat_
\par #define _NCBI_Seqfeat_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par #ifndef _NCBI_Seqloc_
\par #include <objloc.h>
\par #endif
\par #ifndef _NCBI_Pub_
\par #include <objpub.h>
\par #endif
\par #ifndef _NCBI_Pubdesc_
\par #include <objpubd.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqFeatAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   GBQual
\par *
\par *****************************************************************************/
\par typedef struct gbqual \{
\par     CharPtr qual,
\par         val;
\par     struct gbqual PNTR next;
\par \} GBQual, PNTR GBQualPtr;
\par 
\par GBQualPtr GBQualNew PROTO((void));
\par Boolean GBQualAsnWrite PROTO((GBQualPtr gbp, AsnIoPtr aip, AsnTypePtr atp));
\par GBQualPtr GBQualAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {GBQualPtr GBQualFree PROTO((GBQualPtr gbp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par /*****************************************************************************
\par *
\par *   SeqFeatXref
\par *   \tab cross references between features
\par *
\par *****************************************************************************/
\par typedef struct seqfeatxref \{
\par     Choice id;      
\par     Choice data;
\par     struct seqfeatxref PNTR next;
\par \} SeqFeatXref, PNTR SeqFeatXrefPtr;
\par 
\par SeqFeatXrefPtr SeqFeatXrefNew PROTO((void));
\par Boolean SeqFeatXrefAsnWrite PROTO((SeqFeatXrefPtr sfxp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqFeatXrefPtr SeqFeatXrefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqFeatXrefPtr SeqFeatXrefFree PROTO((SeqFeatXrefPtr sfxp));
\par \tab \tab \tab \tab \tab   /* free frees whole chain of SeqFeatXref */
\par /*****************************************************************************
\par *
\par *   SeqFeat
\par *     Feat-id is built into idtype/id
\par *       1=gibb (in id.intvalue)
\par *       2=gimm (id.ptrvalue)
\par *       3=local (id.ptrvalue to Object-id)
\par *       4=general (id.ptrvalue to Dbtag)
\par *     SeqFeatData is built into datatype/data
\par *       datatype gives type of SeqFeatData:
\par *   0 = not set
\par     1 = gene, data.value.ptrvalue = Gene-ref ,
\par     2 = org , data.value.ptrvalue = Org-ref ,
\par     3 = cdregion, data.value.ptrvalue = Cdregion ,
\par     4 = prot , data.value.ptrvalue = Prot-ref ,
\par     5 = rna, data.value.ptrvalue = RNA-ref ,
\par     6 = pub, data.value.ptrvalue = Pubdesc ,  -- publication applies to this seq 
\par     7 = seq, data.value.ptrvalue = Seq-loc ,  -- for tracking source of a seq.
\par     8 = imp, data.value.ptrvalue = Imp-feat ,
\par     9 = region, data.value.ptrvalue= VisibleString,      -- for a name
\par     10 = comment, data.value.ptrvalue= NULL ,             -- just a comment
\par     11 = bond, data.value.intvalue = ENUMERATED \{
\par         disulfide (1) ,
\par         thiolester (2) ,
\par         xlink (3) ,
\par         other (255) \} ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    12 = site, data.value.intvalue = ENUMERATED \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        active (1) ,
\par         binding (2) ,
\par         cleavage (3) ,
\par         inhibit (4) ,
\par         modified (5),
\par         other (255) \} ,
\par     13 = rsite, data.value.ptrvalue = Rsite-ref
\par     14 = user, data.value.ptrvalue = UserObjectPtr
\par     15 = txinit, data.value.ptrvalue = TxinitPtr
\par \tab 16 = num, data.value.ptrvalue = NumberingPtr   -- a numbering system
\par \tab 17 = psec-str data.value.intvalue = ENUMERATED \{   -- protein secondary structure
\par \tab \tab helix (1) ,         -- any helix
\par \tab \tab sheet (2) ,         -- beta sheet
\par \tab \tab turn  (3) \} ,       -- beta or gamma turn
\par \tab 18 = non-std-residue data.value.ptrvalue = VisibleString ,  -- non-standard residue here in seq
\par \tab 19 = het data.value.ptrvalue=CharPtr Heterogen   -- cofactor, prosthetic grp, etc, bound to seq
\par *   
\par *
\par *****************************************************************************/
\par typedef struct seqfeat \{
\par     Choice id;      
\par     Choice data;
\par     Boolean partial ,
\par         except;
\par     CharPtr comment;
\par     ValNodePtr product ,
\par         location;
\par     GBQualPtr qual;
\par     CharPtr title;
\par     UserObjectPtr ext;
\par     ValNodePtr cit;       /* citations (Pub-set)  */
\par \tab Uint1 exp_ev;
\par \tab SeqFeatXrefPtr xref;
\par     struct seqfeat PNTR next;
\par \} SeqFeat, PNTR SeqFeatPtr;
\par 
\par SeqFeatPtr SeqFeatNew PROTO((void));
\par Boolean SeqFeatAsnWrite PROTO((SeqFeatPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqFeatPtr SeqFeatAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqFeatPtr SeqFeatFree PROTO((SeqFeatPtr anp));
\par 
\par      /* get a SeqFeatXref from a feature.  Currently only Prot-ref and */
\par      /* Gene-ref are supported */
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {SeqFeatXrefPtr SeqFeatToXref PROTO((SeqFeatPtr sfp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par /*****************************************************************************
\par *
\par *   SeqFeatId - used as parts of other things, so is not allocated itself
\par *
\par *****************************************************************************/
\par void SeqFeatIdFree PROTO((ChoicePtr cp));  /* does NOT free cp itself */
\par Boolean SeqFeatIdAsnWrite PROTO((ChoicePtr cp, AsnIoPtr aip, AsnTypePtr orig));
\par Boolean SeqFeatIdAsnRead PROTO((AsnIoPtr aip, AsnTypePtr orig, ChoicePtr cp));
\par        /** NOTE: SeqFeatIdAsnRead() does NOT allocate cp ***/
\par Boolean SeqFeatIdDup PROTO((ChoicePtr dest, ChoicePtr src));
\par 
\par /*****************************************************************************
\par *
\par *   SeqFeatData - used as parts of other things, so is not allocated itself
\par *
\par *****************************************************************************/
\par void SeqFeatDataFree PROTO((ChoicePtr cp));  /* does NOT free cp itself */
\par Boolean SeqFeatDataAsnWrite PROTO((ChoicePtr cp, AsnIoPtr aip, AsnTypePtr orig));
\par Boolean SeqFeatDataAsnRead PROTO((AsnIoPtr aip, AsnTypePtr orig, ChoicePtr cp));
\par        /** NOTE: SeqFeatDataAsnRead() does NOT allocate cp ***/
\par 
\par /*****************************************************************************
\par *
\par *   SeqFeatSet - sets of seqfeats
\par *
\par *****************************************************************************/
\par Boolean SeqFeatSetAsnWrite PROTO((SeqFeatPtr anp, AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par SeqFeatPtr SeqFeatSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par 
\par /*****************************************************************************
\par *
\par *   CodeBreak
\par *
\par *****************************************************************************/
\par typedef struct cb \{
\par     SeqLocPtr loc;          /* the Seq-loc */
\par     Choice aa;              /* 1=ncbieaa, 2=ncbi8aa, 3=ncbistdaa */
\par     struct cb PNTR next;
\par \} CodeBreak, PNTR CodeBreakPtr;
\par 
\par CodeBreakPtr CodeBreakNew PROTO((void));
\par Boolean CodeBreakAsnWrite PROTO((CodeBreakPtr cbp, AsnIoPtr aip, AsnTypePtr atp));
\par CodeBreakPtr CodeBreakAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {CodeBreakPtr CodeBreakFree PROTO((CodeBreakPtr cbp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par /*****************************************************************************
\par *
\par *   CdRegion
\par *
\par *****************************************************************************/
\par typedef struct cdregion \{
\par     Boolean orf;
\par     Uint1 frame;
\par     Boolean conflict;
\par     Uint1 gaps,                         /* 255 = any number > 254 */
\par         mismatch,
\par         stops;
\par     ValNodePtr genetic_code;                 /* NULL = not set */
\par     CodeBreakPtr code_break;
\par \} CdRegion, PNTR CdRegionPtr;
\par 
\par CdRegionPtr CdRegionNew PROTO((void));
\par Boolean CdRegionAsnWrite PROTO((CdRegionPtr cdp, AsnIoPtr aip, AsnTypePtr atp));
\par CdRegionPtr CdRegionAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par CdRegionPtr CdRegionFree PROTO((CdRegionPtr cdp));
\par 
\par /*****************************************************************************
\par *
\par *   GeneticCode
\par *
\par *      ncbieaa, ncbi8aa, ncbistdaa
\par *      are arrays 64 cells long, where each cell gives the aa produced
\par *      by triplets coded by T=0, C=1, A=2, G=3
\par *      TTT = cell[0]
\par *      TTC = cell[1]
\par *      TTA = cell[2]
\par *      TTG = cell[3]
\par *      TCT = cell[4]
\par *      ((base1 * 16) + (base2 * 4) + (base3)) = cell in table
\par *
\par *      sncbieaa, sncbi8aa, sncbistdaa
\par *   \tab are arrays same as above, except the AA's they code for are only for
\par *   \tab the first AA of a peptide.  This accomdates alternate start codes.
\par *       If a codon is not a valid start, the cell contains the "gap" symbol
\par *       instead of an AA.
\par *
\par *      in both cases, IUPAC cannot be used because it has no symbol for
\par *       stop.
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*   \tab 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par *   GeneticCode is a ValNodePtr so variable numbers of elements are
\par *   \tab easily accomodated.  A ValNodePtr with choice = 254 is the head
\par *       of the list.  It's elements are a chain of ValNodes beginning with
\par *       the data.ptrvalue of the GeneticCode (head).  GeneticCodeNew()
\par *       returns the head.
\par *   
\par *   Types in ValNodePtr->choice are:
\par *   \tab 0 = not set
\par *   \tab 1 = name (CharPtr in ptrvalue)
\par *   \tab 2 = id\tab (in intvalue)
\par *   \tab 3 = ncbieaa (CharPtr in ptrvalue)
\par *   \tab 4 = ncbi8aa (ByteStorePtr in ptrvalue)
\par *   \tab 5 = ncbistdaa (ByteStorePtr in ptrvalue)
\par *   \tab 6 = sncbieaa (CharPtr in ptrvalue)
\par *   \tab 7 = sncbi8aa (ByteStorePtr in ptrvalue)
\par *   \tab 8 = sncbistdaa (ByteStorePtr in ptrvalue)
\par *   \tab 255 = read unrecognized type, but passed ASN.1
\par *   
\par *****************************************************************************/
\par typedef ValNodePtr GeneticCodePtr;
\par 
\par GeneticCodePtr GeneticCodeNew PROTO((void));
\par Boolean GeneticCodeAsnWrite PROTO((GeneticCodePtr gcp, AsnIoPtr aip, AsnTypePtr atp));
\par GeneticCodePtr GeneticCodeAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par GeneticCodePtr GeneticCodeFree PROTO((GeneticCodePtr gcp));
\par 
\par Boolean GeneticCodeTableAsnWrite PROTO((GeneticCodePtr gcp, AsnIoPtr aip, AsnTypePtr atp));
\par GeneticCodePtr GeneticCodeTableAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par 
\par GeneticCodePtr GeneticCodeFind PROTO((Int4 id, CharPtr name));
\par GeneticCodePtr GeneticCodeTableLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   ImpFeat
\par *
\par *****************************************************************************/
\par typedef struct impfeat \{
\par     CharPtr key,
\par         loc,
\par         descr;
\par \} ImpFeat, PNTR ImpFeatPtr;
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ImpFeatPtr ImpFeatNew PROTO((void));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean ImpFeatAsnWrite PROTO((ImpFeatPtr ifp, AsnIoPtr aip, AsnTypePtr atp));
\par ImpFeatPtr ImpFeatAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par ImpFeatPtr ImpFeatFree PROTO((ImpFeatPtr ifp));
\par 
\par /*****************************************************************************
\par *
\par *   RnaRef
\par *    Choice used for extensions
\par *      0 = no extension
\par *      1 = name, ext.value.ptrvalue = CharPtr
\par *      2 = trna, ext.value.ptrvalue = tRNA
\par *
\par *****************************************************************************/
\par typedef struct rnaref \{
\par     Uint1 type;
\par     Boolean pseudo;
\par     Choice ext;
\par \} RnaRef, PNTR RnaRefPtr;
\par 
\par RnaRefPtr RnaRefNew PROTO((void));
\par Boolean RnaRefAsnWrite PROTO((RnaRefPtr rrp, AsnIoPtr aip, AsnTypePtr atp));
\par RnaRefPtr RnaRefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par RnaRefPtr RnaRefFree PROTO((RnaRefPtr rrp));
\par 
\par /*****************************************************************************
\par *
\par *   tRNA
\par *
\par *****************************************************************************/
\par typedef struct trna \{
\par     Uint1 aatype,  /* 0=not set, 1=iupacaa, 2=ncbieaa, 3=ncbi8aa 4=ncbistdaa */
\par         aa;        /* the aa transferred in above code */
\par     Uint1 codon[6];    /* codons recognized, coded as for Genetic-code */
\par \} tRNA, PNTR tRNAPtr;   /*  0-63 = codon,  255=no data in cell */
\par 
\par /*****************************************************************************
\par *
\par *   GeneRef
\par *
\par *****************************************************************************/
\par typedef struct generef \{
\par     CharPtr locus,
\par         allele,
\par         desc,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        maploc;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    Boolean pseudo;
\par     ValNodePtr db;          /* ids in other databases */
\par     ValNodePtr syn;         /* synonyms for locus */
\par \} GeneRef, PNTR GeneRefPtr;
\par 
\par GeneRefPtr GeneRefNew PROTO((void));
\par Boolean GeneRefAsnWrite PROTO((GeneRefPtr grp, AsnIoPtr aip, AsnTypePtr atp));
\par GeneRefPtr GeneRefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par GeneRefPtr GeneRefFree PROTO((GeneRefPtr grp));
\par GeneRefPtr GeneRefDup PROTO((GeneRefPtr grp));
\par 
\par /*****************************************************************************
\par *
\par *   OrgRef
\par *
\par *****************************************************************************/
\par typedef struct orgref \{
\par     CharPtr taxname,
\par         common;
\par     ValNodePtr mod;
\par     ValNodePtr db;          /* ids in other databases */
\par     ValNodePtr syn;         /* synonyms for taxname and/or common */
\par \} OrgRef, PNTR OrgRefPtr;
\par 
\par OrgRefPtr OrgRefNew PROTO((void));
\par Boolean OrgRefAsnWrite PROTO((OrgRefPtr orp, AsnIoPtr aip, AsnTypePtr atp));
\par OrgRefPtr OrgRefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par OrgRefPtr OrgRefFree PROTO((OrgRefPtr orp));
\par 
\par /*****************************************************************************
\par *
\par *   ProtRef
\par *
\par *****************************************************************************/
\par typedef struct protref \{
\par     ValNodePtr name;
\par     CharPtr desc;
\par     ValNodePtr ec,
\par         activity;
\par     ValNodePtr db;          /* ids in other databases */
\par \} ProtRef, PNTR ProtRefPtr;
\par 
\par ProtRefPtr ProtRefNew PROTO((void));
\par Boolean ProtRefAsnWrite PROTO((ProtRefPtr orp, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ProtRefPtr ProtRefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ProtRefPtr ProtRefFree PROTO((ProtRefPtr orp));
\par ProtRefPtr ProtRefDup PROTO((ProtRefPtr orp));
\par 
\par /*****************************************************************************
\par *
\par *   RsiteRef
\par *       uses an ValNode
\par *       choice = 1 = str
\par *                2 = db
\par *
\par *****************************************************************************/
\par typedef ValNodePtr RsiteRefPtr;
\par 
\par Boolean RsiteRefAsnWrite PROTO((RsiteRefPtr orp, AsnIoPtr aip, AsnTypePtr atp));
\par RsiteRefPtr RsiteRefAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par RsiteRefPtr RsiteRefFree PROTO((RsiteRefPtr orp));
\par 
\par /*****************************************************************************
\par *
\par *   Txinit
\par *       Transcription initiation site
\par *
\par *****************************************************************************/
\par typedef struct txevidence \{
\par     Uint1 exp_code ,
\par         exp_sys ;
\par     Boolean low_prec_data ,
\par         from_homolog;
\par     struct txevidence PNTR next;
\par \} TxEvidence, PNTR TxEvidencePtr;
\par 
\par typedef struct txinit \{
\par     CharPtr name;
\par     ValNodePtr syn ,
\par         gene ,
\par         protein ,
\par         rna ;
\par     CharPtr expression;
\par     Uint1 txsystem;
\par     CharPtr txdescr;
\par     OrgRefPtr txorg;
\par     Boolean mapping_precise,
\par         location_accurate;
\par     Uint1 inittype;              /* 255 if not set */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    TxEvidencePtr evidence;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} Txinit, PNTR TxinitPtr;
\par 
\par TxinitPtr TxinitNew PROTO((void));
\par Boolean TxinitAsnWrite PROTO((TxinitPtr txp, AsnIoPtr aip, AsnTypePtr atp));
\par TxinitPtr TxinitAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par TxinitPtr TxinitFree PROTO((TxinitPtr txp));
\par 
\par 
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 252}}}{\b0 \tab Sequence Alignments}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Sequence Alignments   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 251}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {include seqalign.doc}}{\fldrslt {{\*\bkmkstart _Toc294431012}{\*\bkmkstart _Toc300649412}Sequence Alignments{\*\bkmkend _Toc294431012}{\*\bkmkend _Toc300649412}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431013}{\*\bkmkstart _Toc300649413}Introduction{\*\bkmkend _Toc294431013}{\*\bkmkend _Toc300649413}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A sequence alignment is a mapping of the coordinates of one Bioseq onto the coordinates of one or more other Bioseqs. Such a mapping may be associated with a score and/or a method for doing the alignment. An alignment can be generated algorithmically by software or manually by a scientist. The Seq-align object is designed to capture the final result of the process, not the process itself.
\par A Seq-align is one of the forms of Seq-annot and is as acceptable a sequence annotation as a feature table. Seq-aligns would normally be "packaged" in a Seq-annot for exchange with other tools or databases so the alignments can be identified and given a title.
\par The most common sequence alignment is from one sequence to another with a one to one relationship between the aligned residues of one sequence with the residues of the other (with allowance for gaps). Two types of Seq-align types, Dense-seg and Dense-diag are specifically for this type of alignment. The Std-seg, on the other hand, is very generic and does not assume that the length of one aligned region is necessarily the same as the other. This permits expansion and contraction of one Bioseq relative to another, which is necessary in the case of a physical map Bioseq aligned to a genetic map Bioseq, or a sequence Bioseq aligned with any map Bioseq.
\par All the forms of Seq-align are composed of segments. Each segment is an aligned region which contains only sequence or only a gap for any sequence in the alignment. Below is a three dimensional alignment with six segments:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\f6\fs20 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab Seq-ids
\par \tab id=100\tab \tab AAGGCCTTTTAGAGATGATGATGATGATGA
\par \tab id=200\tab \tab AAGGCCTaTTAG.......GATGATGATGA
\par \tab id=300\tab \tab ....CCTTTTAGAGATGATGAT....ATGA
\par \tab \tab \tab \tab \tab | 1 |   2  |   3   |4| 5  | 6|  Segments
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Taking only two of the sequences in a two way alignment, only three segments are needed to define the alignment:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\f6\fs20 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab Seq-ids
\par \tab id=100\tab \tab AAGGCCTTTTAGAGATGATGATGATGATGA
\par \tab id=200\tab \tab AAGGCCTaTTAG.......GATGATGATGA
\par \tab \tab \tab \tab \tab |     1    |   2   |     3   |  Segments
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431014}{\*\bkmkstart _Toc300649414}Seq-align{\*\bkmkend _Toc294431014}{\*\bkmkend _Toc300649414}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-align is a collection of segments representing one complete alignment. The whole Seq\_align may have a Score representing some measure of quality or attributing the method used to build the Seq-align. In addition, each segment may have a score for that segment alone.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431015}{\*\bkmkstart _Toc300649415}type: global{\*\bkmkend _Toc294431015}{\*\bkmkend _Toc300649415}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A global alignment is the alignment of Bioseqs over their complete length. It expresses the relationship between the intact Bioseqs. As such it is typically used in studies of homology between closely related proteins or genomes where there is reason to believe they share a common origin over their complete lengths.
\par The segments making up a global alignment are assumed to be connected in order from first to last to make up the alignment, and that the full lengths of all sequences will be accounted for in the alignment.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431016}{\*\bkmkstart _Toc300649416}type: partial{\*\bkmkend _Toc294431016}{\*\bkmkend _Toc300649416}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A partial alignment only defines a relationship between sequences for the lengths actually included in the alignment. No claim is made that the relationship pertains to the full lengths of any of the sequences.
\par }\pard \sb240\widctlpar\adjustright {Like a global alignment, the segments making up a partial alignment are assumed to be connected in order from first to last to make up the alignment. Unlike a global alignment, it is not assumed the alignment will necessarily account for the full lengths of any or all sequences.
\par }\pard \sb240\widctlpar\adjustright {A partial or global alignment may use either the "denseg" choice of segment (for aligned Bioseqs with one to one residue mappings, such as protein or nucleic acid sequences) or the "std" choice for any Bioseqs including maps. In both cases there is an ordered relationship between one segment and the next to make the complete alignment.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431017}{\*\bkmkstart _Toc300649417}type: diags{\*\bkmkend _Toc294431017}{\*\bkmkend _Toc300649417}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-align of type "diags" means that each segment is independent of the next and no claims are made about the reasonableness of connecting one segment to another. This is the kind of relationship shown by a "dot matrix" display. A series of diagonal lines in a square matrix indicate unbroken regions of similarity between the sequences. However, diagonals may overlap multiple times, or regions of the matrix may have no diagonals at all. The "diags" type of alignment captures that kind of relationship, although it is not limited to two dimensions as a dot matrix is.
\par The "diags" type of Seq-align may use either the "dendiag" choice of segment (for aligned Bioseqs with one to one residue mappings, such as protein or nucleic acid sequences) or the "std" choice for any Bioseqs including maps. In both cases the SEQUENCE OF does not imply any ordered relationship between one segment and the next. Each segment is independent of any other.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431018}{\*\bkmkstart _Toc300649418}dim: Dimensionality Of The Alignment{\*\bkmkend _Toc294431018}{\*\bkmkend _Toc300649418}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Most scientists are familiar with pairwise, or two dimensional, sequence alignments. However, it is often useful to align sequences in more dimensions. The "dim" attribute of Seq-align indicates the number of sequences which are SIMULTANEOUSLY aligned. A three dimensional alignment is a true three way alignment (ABC), not three pairwise alignments (AB, AC, BC). Three pairwise alignments are three Seq-align objects, each with dimension equal to two.
\par Another common situation is when many sequences are aligned to one, as is the case of a merge of a number of components into a larger sequence, or the relationship of many mutant alleles to the wild type sequence. This is also a collection of two dimensional alignments, where one of the Bioseqs is common to all alignments. If the wild type Bioseq is A, and the mutants are B, C, D, then the Seq-annot would contain three two dimensional alignments, AB, AC, AD.
\par The "dim" attribute at the level of the Seq-align is OPTIONAL, while the "dim" attribute is required on EACH segment. This is because it is convenient for a global or partial alignment to know the dimensionality for the whole alignment. It is also a integrity check that every segment in such a Seq-align has the same dimension. For "diags" however, the segments are independent of each other, and may even have different dimensions. This would be true for algorithms that locate the best n-way diagonals, where n can be 2 to the number of sequences. For a simple dot-matrix, all segments would be dimension two.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431019}{\*\bkmkstart _Toc300649419}Score: Score Of An Alignment Or Segment{\*\bkmkend _Toc294431019}{\*\bkmkend _Toc300649419}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Score contains an id (of type Object-id) which is meant to identify the method used to generate the score. It could be a string (e.g. "BLAST raw score", "BLAST p value") or an integer for use by a software system planning to process an number of defined values. The value of the Score is either an integer or real number. Both Seq-align and segment types allow more than one Score so that a variety of measures for the same alignment can be accommodated.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431020}{\*\bkmkstart _Toc300649420}Dense-diag: Segments For "diags" Seq-align{\*\bkmkend _Toc294431020}{\*\bkmkend _Toc300649420}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-align of type "diags" represents a series of unconnected diagonals as a SEQUENCE OF Dense-diag. Since each Dense-diag is unrelated to the next the SEQUENCE OF just suggests a presentation order. It does not imply anything about the reasonableness of joining one Dense-diag to the next. In fact, for a multi-sequence comparison, each Dense-diag may have a different dimension and/or include Bioseqs not included by another Dense-diag.
\par A single Dense-diag defines its dimension with "dim". There should be "dim" number of Seq-id in "ids", indicating the Bioseqs involved in the segment, in order. There should be "dim" number of integers in "starts" (offsets into the Bioseqs, starting with 0, as in any Seq-loc) indicating the first (lowest numbered) residue of each Bioseq involved in the segment is, in the same order as "ids". The "len" indicates the length of all Bioseqs in the segment. Thus the last residue involved in the segment for every Bioseq will be its "start" plus ("len " - 1).
\par In the case of nucleic acids, if any or all of the segments are on the complement strand of the original bioseq, then there should be "dim" number of Na-strand in "strands" in the same order as "ids", indicating which segments are on the plus or minus strands. The fact that a segment is on the minus strand or not does NOT affect the values chosen for "starts". It is still the lowest numbered offset of a residue involved in the segment.
\par Clearly all Bioseq regions involved in a Dense-diag must have the same length, so this form does not allow stretching of one Bioseq compared to another, as may occur when comparing a genetic map Bioseq to a physical map or sequence Bioseq. In this case one would use Std-seg.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431021}{\*\bkmkstart _Toc300649421}Dense-seg: Segments for "global" or "partial" Seq-align{\*\bkmkend _Toc294431021}{\*\bkmkend _Toc300649421}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Dense-seg is a single entity which describes a complete global or partial alignment containing many segments. Like Dense-diag above, it is only appropriate when there is no stretching of the Bioseq coordinates relative to each other (as may happen when aligning a physical to a genetic map Bioseq). In that case, one would use a SEQUENCE OF Std-seg, described below.
\par A Dense-seg must give the dimension of the alignment in "dim" and the number of segments in the alignment in "numseg". The "ids" slot must contain "dim" number of "Seq-ids" for the Bioseqs used in the alignment.
\par The "starts" slot contains the lowest numbered residue contained in each segment, in "ids" order. The "starts" slot should have "numseg" times "dim" integers, or the start of each Bioseq in the first segment in "ids" order, followed by the start of each Bioseq in the second segment in "ids" order and so on. A "start" of minus one indicates that the Bioseq is not present in the segment (i.e. a gap in a Bioseq).
\par The "lens" slot contains the length of each segment in segment order, so "lens" will contain "numseg" integers.
\par If any or all of the sequences are on the minus strand of the original Bioseq, then there should be "numseg" times "dim" Na-strand values in "strands" in the same order as "starts". Whether a sequence segment is on the plus or minus strand has NO effect on the value selected for "starts". It is ALWAYS the lowest numbered residue included in the segment.
\par The "scores" is a SEQUENCE OF Score, one for each segment. So there should be "numseg" Scores, if "scores" is filled. A single Score for the whole alignment would appear in the "score" slot of the Seq-align.
\par The three dimensional alignment show above is repeated below, followed by its ASN.1 encoding into a Seq-align using Dense-seg. The Seq-ids are given in the ASN.1 as type "local".
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\f6\fs20 \tab Seq-ids
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab id=100\tab \tab AAGGCCTTTTAGAGATGATGATGATGATGA
\par \tab id=200\tab \tab AAGGCCTaTTAG.......GATGATGATGA
\par \tab id=300\tab \tab ....CCTTTTAGAGATGATGAT....ATGA
\par \tab \tab \tab \tab \tab | 1 |   2  |   3   |4| 5  | 6|  Segments
\par 
\par Seq-align ::= \{
\par \tab type global ,
\par \tab dim 3 ,
\par \tab segs denseg \{
\par \tab \tab dim 3 ,
\par \tab \tab numseg 6 ,
\par \tab \tab ids \{
\par \tab \tab \tab local id 100 ,
\par \tab \tab \tab local id 200 ,
\par \tab \tab \tab local id 300 \} ,
\par \tab \tab starts \{}{ 0,0,-1, 4,4,0, 12,-1,8, 19,12,15, 22,15,-1, 26,19,18 \} ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab lens \{ 4, 8, 7, 3, 4, 4 \} \} \}}{\f6\fs20 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431022}{\*\bkmkstart _Toc300649422}Std-seg: Aligning Any Bioseq Type With Any Other{\*\bkmkend _Toc294431022}{\*\bkmkend _Toc300649422}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A SEQUENCE OF Std-seg can be used to describe any Seq-align type on any types of Bioseqs. A Std-seg is very purely a collection of correlated Seq-locs. There is no requirement that the length of each Bioseq in a segment be the same as the other members of the segment or that the same Seq-loc type be used for each member of the segment. This allows stretching of one Bioseq relative to the other(s) and potentially very complex descriptions of relationships between sequences.
\par }\pard \sb240\widctlpar\adjustright {Each Std-seg must give its dimension, so it can be used for "diags". Optionally it can give the Seq-ids for the Bioseqs used in the segment (again a convenience for Seq-align of type "diags"). The "loc" slot gives the locations on the Bioseqs used in this segment. As usual, there is also a place for various Score(s) associated with the segment. The example given above is presented again, this time as a Seq-align using Std-segs. Note the use of Seq-loc type "empty" to indicate a gap. Alternatively one could simply change the "dim" for each segment to exclude the Bioseqs not present in the segment, although this would require more interpretation by software.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\f6\fs20 \tab Seq-ids
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab id=100\tab \tab AAGGCCTTTTAGAGATGATGATGATGATGA
\par \tab id=200\tab \tab AAGGCCTaTTAG.......GATGATGATGA
\par \tab id=300\tab \tab ....CCTTTTAGAGATGATGAT....ATGA
\par \tab \tab \tab \tab \tab | 1 |   2  |   3   |4| 5  | 6|  Segments
\par 
\par Seq-align ::= \{
\par \tab type global ,
\par \tab dim 3 ,
\par \tab segs std \{
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 0 ,
\par \tab \tab \tab \tab \tab to 3 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 200 ,
\par \tab \tab \tab \tab \tab from 0 ,
\par \tab \tab \tab \tab \tab to 3 \} ,
\par \tab \tab \tab \tab empty local id 300 \} ,
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 4 ,
\par \tab \tab \tab \tab \tab to 11 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 200 ,
\par \tab \tab \tab \tab \tab from 4 ,
\par \tab \tab \tab \tab \tab to 11 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 300 ,
\par \tab \tab \tab \tab \tab from 0 ,
\par \tab \tab \tab \tab \tab to 7 \} \} ,
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 12 ,
\par \tab \tab \tab \tab \tab to 18 \} ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab \tab \tab \tab empty local id 200 ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 300 ,
\par \tab \tab \tab \tab \tab from 8 ,
\par \tab \tab \tab \tab \tab to 14 \} \} ,
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 19 ,
\par \tab \tab \tab \tab \tab to 21 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 200 ,
\par \tab \tab \tab \tab \tab from 12 ,
\par \tab \tab \tab \tab \tab to 14 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 300 ,
\par \tab \tab \tab \tab \tab from 15 ,
\par \tab \tab \tab \tab \tab to 17 \} \} ,
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 22 ,
\par \tab \tab \tab \tab \tab to 25 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 200 ,
\par \tab \tab \tab \tab \tab from 15 ,
\par \tab \tab \tab \tab \tab to 18 \} ,
\par \tab \tab \tab \tab empty local id 300 \} ,
\par \tab \tab \{
\par \tab \tab \tab dim 3 ,
\par \tab \tab \tab loc \{
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 100 ,
\par \tab \tab \tab \tab \tab from 26 ,
\par \tab \tab \tab \tab \tab to 29 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 200 ,
\par \tab \tab \tab \tab \tab from 19 ,
\par \tab \tab \tab \tab \tab to 22 \} ,
\par \tab \tab \tab \tab int \{
\par \tab \tab \tab \tab \tab id local id 300 ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab \tab \tab \tab \tab from 18 ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\f6\fs20 \tab \tab \tab \tab \tab to 21 \} \} \} \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Clearly the Std-seg method should only be used when its flexibility is required. Nonetheless, there is no ready substitute for Std-seg when flexibility is demanded.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431023}{\*\bkmkstart _Toc300649423}ASN.1 Specification: seqalign.asn{\*\bkmkend _Toc294431023}{\*\bkmkend _Toc300649423}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par --
\par --  NCBI Sequence Alignment elements
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Seqalign DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Seq-align;
\par 
\par IMPORTS Seq-id, Seq-loc , Na-strand FROM NCBI-Seqloc
\par         Object-id FROM NCBI-General;
\par 
\par --*** Sequence Alignment ********************************
\par --*
\par 
\par Seq-align ::= SEQUENCE \{
\par     type ENUMERATED \{
\par         not-set (0) ,
\par         global (1) ,
\par         diags (2) ,
\par         partial (3) ,           -- mapping pieces together
\par         other (255) \} ,
\par     dim INTEGER OPTIONAL ,     -- dimensionality
\par     score SET OF Score OPTIONAL ,   -- for whole alignment
\par     segs CHOICE \{                   -- alignment data
\par         dendiag SEQUENCE OF Dense-diag ,
\par         denseg Dense-seg ,
\par         std SEQUENCE OF Std-seg \} \}
\par         
\par         
\par Dense-diag ::= SEQUENCE \{         -- for (multiway) diagonals
\par     dim INTEGER DEFAULT 2 ,    -- dimensionality
\par     ids SEQUENCE OF Seq-id ,   -- sequences in order
\par     starts SEQUENCE OF INTEGER ,  -- start OFFSETS in ids order
\par     len INTEGER ,                 -- len of aligned segments
\par     strands SEQUENCE OF Na-strand OPTIONAL ,
\par     scores SET OF Score OPTIONAL \}
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    -- Dense-seg: the densist packing for sequence alignments only.
\par     --            a start of -1 indicates a gap for that sequence of
\par     --            length lens.
\par     --
\par     -- id=100  AAGGCCTTTTAGAGATGATGATGATGATGA
\par     -- id=200  AAGGCCTTTTAG.......GATGATGATGA
\par     -- id=300  ....CCTTTTAGAGATGATGAT....ATGA
\par     --
\par     -- dim = 3, numseg = 6, ids = \{ 100, 200, 300 \}
\par     -- starts = \{ 0,0,-1, 4,4,0, 12,-1,8, 19,12,15, 22,15,-1, 26,19,18 \}
\par     -- lens = \{ 4, 8, 7, 3, 4, 4 \}
\par     --
\par 
\par Dense-seg ::= SEQUENCE \{          -- for (multiway) global or partial alignments
\par     dim INTEGER DEFAULT 2 ,       -- dimensionality
\par     numseg INTEGER ,              -- number of segments here
\par     ids SEQUENCE OF Seq-id ,      -- sequences in order
\par     starts SEQUENCE OF INTEGER ,  -- start OFFSETS in ids order within segs
\par     lens SEQUENCE OF INTEGER ,    -- lengths in ids order within segs
\par     strands SEQUENCE OF Na-strand OPTIONAL ,
\par     scores SEQUENCE OF Score OPTIONAL \}  -- score for each seg
\par 
\par Std-seg ::= SEQUENCE \{
\par     dim INTEGER DEFAULT 2 ,       -- dimensionality
\par     ids SEQUENCE OF Seq-id OPTIONAL ,
\par     loc SEQUENCE OF Seq-loc ,
\par     scores SET OF Score OPTIONAL \}
\par 
\par Score ::= SEQUENCE \{
\par     id Object-id OPTIONAL ,
\par     value CHOICE \{
\par         real REAL ,
\par         int INTEGER  \} \}
\par 
\par END 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431024}{\*\bkmkstart _Toc300649424}C Structures and Functions: objalign.h{\*\bkmkend _Toc294431024}{\*\bkmkend _Toc300649424}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objalign.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  the author's official duties as a United States Government employee and 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objalign.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Seqalign
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seqalign_
\par #define _NCBI_Seqalign_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_General_
\par #include <objgen.h>
\par #endif
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifndef _NCBI_Seqloc_
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#include <objloc.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par *
\par *****************************************************************************/
\par extern Boolean SeqAlignAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-Seqalign objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   Score
\par *     NOTE: read, write, and free always process GROUPS of scores
\par *
\par *****************************************************************************/
\par typedef struct score \{
\par     ObjectIdPtr id;
\par     Uint1 choice;          /* 0=not set, 1=int, 2=real */
\par     DataVal value;
\par     struct score PNTR next;    /* for sets of scores */
\par \} Score, PNTR ScorePtr;
\par 
\par ScorePtr ScoreNew PROTO((void));
\par Boolean ScoreSetAsnWrite PROTO((ScorePtr sp, AsnIoPtr aip, AsnTypePtr settype, AsnTypePtr elementtype));
\par ScorePtr ScoreSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr settype, AsnTypePtr elementtype));
\par ScorePtr ScoreSetFree PROTO((ScorePtr anp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqAlign
\par *   type =  type of alignment
\par         not-set (0) ,
\par         global (1) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        diags (2) ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        partial (3) ,           -- mapping pieces together
\par         other (255) \} ,
\par     segtype = type of segs structure
\par         not-set 0
\par         dendiag 1
\par         denseq 2
\par         std 3
\par *   
\par *
\par *****************************************************************************/
\par typedef struct seqalign \{
\par     Uint1 type,
\par         segtype;
\par     Int2 dim;
\par     ScorePtr score;
\par     Pointer segs;
\par     struct seqalign PNTR next;
\par \} SeqAlign, PNTR SeqAlignPtr;
\par 
\par SeqAlignPtr SeqAlignNew PROTO((void));
\par Boolean SeqAlignAsnWrite PROTO((SeqAlignPtr anp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqAlignPtr SeqAlignAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqAlignPtr SeqAlignFree PROTO((SeqAlignPtr anp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqAlignSet
\par *
\par *****************************************************************************/
\par Boolean SeqAlignSetAsnWrite PROTO((SeqAlignPtr anp, AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par SeqAlignPtr SeqAlignSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par 
\par /*****************************************************************************
\par *
\par *   DenseDiag
\par *   
\par *
\par *****************************************************************************/
\par typedef struct dendiag \{
\par     Int2 dim;                   /* this is a convenience, not in asn1 */
\par     SeqIdPtr id;
\par     Int4Ptr starts;
\par     Int4 len;
\par     Uint1Ptr strands;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    ScorePtr scores;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    struct dendiag PNTR next;
\par \} DenseDiag, PNTR DenseDiagPtr;
\par 
\par DenseDiagPtr DenseDiagNew PROTO((void));
\par Boolean DenseDiagAsnWrite PROTO((DenseDiagPtr ddp, AsnIoPtr aip, AsnTypePtr atp));
\par DenseDiagPtr DenseDiagAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par DenseDiagPtr DenseDiagFree PROTO((DenseDiagPtr ddp));
\par 
\par /*****************************************************************************
\par *
\par *   DenseSeg
\par *   
\par *
\par *****************************************************************************/
\par typedef struct denseg \{
\par     Int2 dim,
\par         numseg;
\par     SeqIdPtr ids;
\par     Int4Ptr starts;
\par     Int4Ptr lens;
\par     Uint1Ptr strands;
\par     ScorePtr scores;
\par \} DenseSeg, PNTR DenseSegPtr;
\par 
\par DenseSegPtr DenseSegNew PROTO((void));
\par Boolean DenseSegAsnWrite PROTO((DenseSegPtr dsp, AsnIoPtr aip, AsnTypePtr atp));
\par DenseSegPtr DenseSegAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par DenseSegPtr DenseSegFree PROTO((DenseSegPtr dsp));
\par 
\par /*****************************************************************************
\par *
\par *   StdSeg
\par *   
\par *
\par *****************************************************************************/
\par typedef struct stdseg \{
\par     Int2 dim;
\par     SeqIdPtr ids;    /* SeqId s */
\par     SeqLocPtr loc;    /* SeqLoc s */
\par     ScorePtr scores;
\par     struct stdseg PNTR next;
\par \} StdSeg, PNTR StdSegPtr;
\par 
\par StdSegPtr StdSegNew PROTO((void));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean StdSegAsnWrite PROTO((StdSegPtr ssp, AsnIoPtr aip, AsnTypePtr atp));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {StdSegPtr StdSegAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par StdSegPtr StdSegFree PROTO((StdSegPtr ssp));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 256}}}{\b0 \tab Sequence Graphs}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Sequence Graphs   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 255}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {\b0 include seqres.doc}}{\fldrslt {{\*\bkmkstart _Toc294431025}{\*\bkmkstart _Toc300649425}Sequence Graphs{\*\bkmkend _Toc294431025}{\*\bkmkend _Toc300649425}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431026}{\*\bkmkstart _Toc300649426}Introduction{\*\bkmkend _Toc294431026}{\*\bkmkend _Toc300649426}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Analytical tools can attach results to Bioseqs in named collections as Seq-annots. This allows analytical programs developed from various sources to add information to a standard object (the Bioseq) and then let a single program designed for displaying a Bioseq and its associated information show the analytical results in an integrated fashion. Feature tables have been discussed previously, and can serve as the vehicle for results from restriction mapping programs, motif searching programs, open reading frame locators, and so on. Alignment programs and curator tools can produce Seq-annots containing Seq-aligns. In this chapter we present the third annotation type, a graph, which can be used to show properties like G+C content, surface potential, hydrophobicity, and so on.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431027}{\*\bkmkstart _Toc300649427}Seq-graph: Graph on a Bioseq{\*\bkmkend _Toc294431027}{\*\bkmkend _Toc300649427}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A Seq-graph defines some continuous set of values over a defined interval on a Bioseq. It has slots for a title and a comment. The "loc" field defines the region of the Bioseq to which the graph applies. Titles can be given for the X (graph value) axis and/or the Y (sequence axis) of the graph. The "comp" slot allows a compression to supplied (i.e. how many residues are represented by a single value of the graph?). Compression is assumed to be one otherwise. Scaling values, a and b can be used to scale the values given in the Seq-graph to those displayed on the graph (by the formula "display value" = (a times "graph value") plus b). Finally, the number of values in the graph must be given (and should agree with the length of "loc" divided by "comp").
\par The graphs themselves can be coded as byte, integer, or real values. Each type defines the maximum and minimum values to show on the graph (no given values need necessarily reach the maximum or minimum) and the value along which to draw the X axis of the graph.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431028}{\*\bkmkstart _Toc300649428}ASN.1 Specification: seqres.asn{\*\bkmkend _Toc294431028}{\*\bkmkend _Toc300649428}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {--$Revision: 2.0 $
\par --**********************************************************************
\par --
\par --  NCBI Sequence Analysis Results (other than alignments)
\par --  by James Ostell, 1990
\par --
\par --**********************************************************************
\par 
\par NCBI-Seqres DEFINITIONS ::=
\par BEGIN
\par 
\par EXPORTS Seq-graph;
\par 
\par IMPORTS Seq-loc FROM NCBI-Seqloc;
\par 
\par --*** Sequence Graph ********************************
\par --*
\par --*   for values mapped by residue or range to sequence
\par --*
\par 
\par Seq-graph ::= SEQUENCE \{
\par     title VisibleString OPTIONAL ,
\par     comment VisibleString OPTIONAL ,
\par     loc Seq-loc ,                       -- region this applies to
\par     title-x VisibleString OPTIONAL ,    -- title for x-axis
\par     title-y VisibleString OPTIONAL ,
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    comp INTEGER OPTIONAL ,             -- compression (residues/value)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab a REAL OPTIONAL ,                   -- for scaling values
\par \tab b REAL OPTIONAL ,                   -- display = (a x value) + b
\par     numval INTEGER ,                    -- number of values in graph
\par     graph CHOICE \{
\par         real Real-graph ,
\par         int Int-graph ,
\par         byte Byte-graph \} \}
\par 
\par Real-graph ::= SEQUENCE \{
\par     max REAL ,                          -- top of graph
\par     min REAL ,                          -- bottom of graph
\par     axis REAL ,                         -- value to draw axis on
\par     values SEQUENCE OF REAL \}
\par 
\par Int-graph ::= SEQUENCE \{
\par     max INTEGER ,
\par     min INTEGER ,
\par     axis INTEGER ,
\par     values SEQUENCE OF INTEGER \} 
\par 
\par Byte-graph ::= SEQUENCE \{              -- integer from 0-255
\par     max INTEGER ,
\par     min INTEGER ,
\par     axis INTEGER ,
\par     values OCTET STRING \}
\par 
\par END
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431029}{\*\bkmkstart _Toc300649429}C Structures and Functions: objres.h{\*\bkmkend _Toc294431029}{\*\bkmkend _Toc300649429}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  objres.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  may be obtained by using this software or data. The NLM and the U.S.    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  objres.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.0 $
\par *
\par * File Description:  Object manager interface for module NCBI-Seqres
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seqres_
\par #define _NCBI_Seqres_
\par 
\par #ifndef _ASNTOOL_
\par #include <asn.h>
\par #endif
\par #ifndef _NCBI_Seqloc_
\par #include <objloc.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   loader
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*****************************************************************************/
\par extern Boolean SeqResAsnLoad PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   internal structures for NCBI-SeqRes objects
\par *
\par *****************************************************************************/
\par 
\par /*****************************************************************************
\par *
\par *   SeqGraph
\par *
\par *****************************************************************************/
\par typedef struct seqgraph \{
\par     CharPtr title,
\par         comment;
\par     SeqLocPtr loc;     /* SeqLoc */
\par     CharPtr titlex,
\par         titley;
\par     Uint1 flags[3];   /* [0]-comp used?,[1]-a,b used?, [2] graphtype */
\par     Int4 compl;                       /* 1=real, 2=int, 3=byte */
\par     FloatHi a, b;
\par     Int4 numval;
\par     DataVal max,
\par         min,
\par         axis;
\par     Pointer values;  /* real=array of FloatHi, int=array of Int4, */
\par     struct seqgraph PNTR next;              /* byte = ByteStore */
\par \} SeqGraph, PNTR SeqGraphPtr;
\par 
\par SeqGraphPtr SeqGraphNew PROTO((void));
\par Boolean SeqGraphAsnWrite PROTO((SeqGraphPtr sgp, AsnIoPtr aip, AsnTypePtr atp));
\par SeqGraphPtr SeqGraphAsnRead PROTO((AsnIoPtr aip, AsnTypePtr atp));
\par SeqGraphPtr SeqGraphFree PROTO((SeqGraphPtr sgp));
\par 
\par /*****************************************************************************
\par *
\par *   SeqGraphSet
\par *
\par *****************************************************************************/
\par Boolean SeqGraphSetAsnWrite PROTO((SeqGraphPtr sgp, AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par SeqGraphPtr SeqGraphSetAsnRead PROTO((AsnIoPtr aip, AsnTypePtr set, AsnTypePtr element));
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifdef __cplusplus
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 270}}}{\b0 \tab Sequence Utilities}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Sequence Utilities   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 269}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {\b0\fs20 include sequtil.doc}}{\fldrslt {{\*\bkmkstart _Toc294431030}{\*\bkmkstart _Toc300649430}Sequence Utilities{\*\bkmkend _Toc294431030}{\*\bkmkend _Toc300649430}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431031}{\*\bkmkstart _Toc300649431}Introduction{\*\bkmkend _Toc294431031}{\*\bkmkend _Toc300649431}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This chapter discusses a number of high level sequence manipulation functions available in the api directory of the toolkit release. These include functions for exploring data structures, comparing them, or querying their attributes. Also included are routines to output Seq-entrys in GenBank format, report format or FASTA format, and for outputting MEDLINE records in MEDLARS format.
\par Until the narrative text of this chapter can be written, we have simply included the relevant header files and some examples of function uses with listing of some of the programs in the demo directory of the toolkit release.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431032}{\*\bkmkstart _Toc300649432}Demo: seqtest.c{\*\bkmkend _Toc294431032}{\*\bkmkend _Toc300649432}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Seqtest reads an ASN.1 formatted  Seq-entry file into memory. It then uses BioseqExplore to count the number of "real" sequences. The file "example.prt" contains a segmented nucleic acid with two segments of DNA and with two proteins connected by a CdRegion. BioseqExplore reports 3 sequences for it, one nucleic acid (the segmented one... the two segments are really part of one nucleic acid sequence) and 2 proteins. It then uses utility functions to determine their lengths and number of gaps (unspecified spaces, such as between the two segments of the segmented sequence). It prints:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {A.variabilis nifD gene 5' recombination site.
\par len=497 gaps=1 segs=3
\par   len = 204
\par   len = 0
\par   len = 293
\par 
\par xisA peptide A (alt.)
\par len=44 gaps=0 segs=1
\par 
\par xisA peptide B (alt.)
\par len=5 gaps=0 segs=1
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It then opens a SeqPort on the segmented nucleic acid sequence, specifying the plus strand and the IUPAC nucleic acid alphabet. A SeqPort allow you to treat a Bioseq , even a complicated segmented sequence, as if it were a disk file in the alphabet requested. You can seek to a location (like fseek()), get a residue at the current position and increment the current position (like fgetc()), or read a buffer of residues at a time (like fread()). It returns special characters for end of sequence (SEQPORT_EOF), end of an internal segment (SEQPORT_EOS), invalid residue (INVALID_RESIDUE), and supports a little macro (IS_Residue()) to filter these. This is generated from a SeqPort on the plus strand of the segmented nucleic acid sequence:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {SeqPort: plus strand with SeqPortGetResidue
\par 
\par ATCGATAACGCCACCATCATTTATGATGACGTTACCGCCTACGAATTTGAAGAGTTCGTA
\par AAAGCTAAGAAGCCTGATTTAATCGCTTCTGGTATTAAAGAGAAGTATGTCTTCCAAAAG
\par ATGGCTCTTCCCTTCCGTCAAATGCACTCTTGGGATTACTCCGAACCTAGCGATGGGGTG
\par CAAATGTCAGATCAGATAAGGTTT
\par Segment
\par 
\par Segment
\par ACTTTTGTTCTCATGTGTTCTCTTTGCTGCTGTGCTTGCAGACTTGAGCCGAGAAAACTG
\par CCGTCGGTAGATGAAAGTGGCTCCAAGTCTGCAAAGGCTTGTTGATATTTGTCTTGACCC
\par TGATTTTGCATCGCTGTGGTATTAGCCTATATTTAGCCTAAAAATTAATGTGTTATCAGC
\par AAACAATGTTCATCACTAACACTGCTCAGTGCAAACATTAAGCTGTTGAAAGCTATTAAA
\par CCACAAAAAGGATTACTCCGGCCCTTATCACGGTTACGACGGATTTGCTATCT
\par EOF
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Next, it opens a Seqport on the minus strand of the same segemented sequence. Note that a SeqPort is a "view" on the sequence data. It does not change the underlying sequence in any way. This it is possible to have many different SeqPorts open on the same sequence at the same time without interfering with each other. On the minus strand the SeqPort runs backwards and complements the residues. In this example, buffers of residues are read with SeqPortRead instead of one residue at a time with SeqPortGetResidue. Of course either approach could have been used.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {SeqPort on minus with SeqPortRead
\par 
\par AGATAGCAAATCCGTCGTAACCGTGATAAGGGCCGGAGTAATCCTTTTTGTGGTTTAATA
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {GCTTTCAACAGCTTAATGTTTGCACTGAGCAGTGTTAGTGATGAACATTGTTTGCTGATA
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {ACACATTAATTTTTAGGCTAAATATAGGCTAATACCACAGCGATGCAAAATCAGGGTCAA
\par GACAAATATCAACAAGCCTTTGCAGACTTGGAGCCACTTTCATCTACCGACGGCAGTTTT
\par CTCGGCTCAAGTCTGCAAGCACAGCAGCAAAGAGAACACATGAGAACAAAAGT
\par Segment
\par Segment
\par AAACCTTATCTGATCTGACATTTGCACCCCATCGCTAGGTTCGGAGTAATCCCAAGAGTG
\par CATTTGACGGAAGGGAAGAGCCATCTTTTGGAAGACATACTTCTCTTTAATACCAGAAGC
\par GATTAAATCAGGCTTCTTAGCTTTTACGAACTCTTCAAATTCGTAGGCGGTAACGTCATC
\par ATAAATGATGGTGGCGTTATCGAT
\par EOF
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, seqtest.c calls the SeqEntryToFasta function (found in tofasta.h). This function traverses the SeqEntry finding every raw Bioseq for either nucleic acids or proteins and prints them out in FASTA format using what alphabet is specified. This is useful for generating data for tools which require only a simple view of a sequence entry. First the nucleic acids are printed, then the proteins:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Nucleic Acids in FASTA format:
\par 
\par >gb|M28152|ANANIFDR1 A.variabilis nifD gene 5' recombination site.
\par ATCGATAACGCCACCATCATTTATGATGACGTTACCGCCTACGAATTTGAAGAGTTCGTA
\par AAAGCTAAGAAGCCTGATTTAATCGCTTCTGGTATTAAAGAGAAGTATGTCTTCCAAAAG
\par ATGGCTCTTCCCTTCCGTCAAATGCACTCTTGGGATTACTCCGAACCTAGCGATGGGGTG
\par CAAATGTCAGATCAGATAAGGTTT
\par >gb|M28153|ANANIFDR2 A.variabilis nifD gene 3' recombination site, and xisA gene, 5' end.
\par ACTTTTGTTCTCATGTGTTCTCTTTGCTGCTGTGCTTGCAGACTTGAGCCGAGAAAACTG
\par CCGTCGGTAGATGAAAGTGGCTCCAAGTCTGCAAAGGCTTGTTGATATTTGTCTTGACCC
\par TGATTTTGCATCGCTGTGGTATTAGCCTATATTTAGCCTAAAAATTAATGTGTTATCAGC
\par AAACAATGTTCATCACTAACACTGCTCAGTGCAAACATTAAGCTGTTGAAAGCTATTAAA
\par CCACAAAAAGGATTACTCCGGCCCTTATCACGGTTACGACGGATTTGCTATCT
\par 
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Proteins in FASTA format:
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par >gim|86660 xisA peptide A (alt.)
\par MQNQGQDKYQQAFADLEPLSSTDGSFLGSSLQAQQQREHMRTKV
\par >gim|86661 xisA peptide B (alt.)
\par MRTKV
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SeqEntryToFasta uses the SeqIdPrint function to print out the Seq-ids for these sequences. Since this data model supports Seq-ids from many different sources and in many different formats, it displays them in a variety of ways. First comes a code for the source database followed by a vertical bar ( | ). "gb" is GenBank, "gim" is for a temporary "import id" assigned to sequences lacking a source Seq-id (such as these translated coding regions). Following the source identifier are various numbers of fields depending on the source type. For GenBank, the fields are accession number and locus name.
\par This demo simply serves to show a few of the capabilities of current function library while we are finishing the documentation. There are functions to print a Seq-entry in GenBank format, SeqEntryToGenBank (in togenbnk.h) which is used the demo program asn2gnbk.c. There is also a human readable report generator (SeqEntryToFile) which is used in asn2rpt.c. ProteinFromCdRegion (in seqport.h) will translate a CdRegion feature, taking into account alternate genetic codes, unusual start codons, and code-breaks. The reader is encouraged to look over the code in \\demo.
\par 
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*****************************************************************************
\par *
\par *   seqtest.c
\par *       test program for sequence display, SeqPort and ToFasta
\par *
\par *****************************************************************************/
\par 
\par #include <seqport.h>
\par #include <tofasta.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void BuildList (SeqEntryPtr sep, Pointer data, Int4 index, Int2 indent);
\par 
\par Int2 Main()
\par \{
\par \tab AsnIoPtr       aip;
\par \tab SeqEntryPtr    sep;
\par \tab BioseqPtr PNTR seqlist;
\par \tab Int4           seqnum, i, numseg, lens[10], j;
\par \tab Int2           ctr;
\par \tab SeqPortPtr     spp;
\par \tab Uint1          residue;
\par \tab FILE*          fp;
\par \tab CharPtr        title;
\par \tab Char           buffer[101];
\par 
\par \tab /*
\par \tab ** Load SeqEntry object loader and sequence alphabets
\par \tab */
\par 
\par \tab if (! SeqEntryLoad()) \{
\par \tab \tab Message(MSG_ERROR, "SeqEntryLoad failed");
\par \tab \tab return 1;
\par \tab \}
\par 
\par \tab /*
\par \tab ** Use the file "example.prt" as the ASN I/O stream.  This file
\par \tab ** can be found in the ncbi/demo.  It is in ASN.1 Print Value format.
\par \tab */
\par 
\par \tab if ((aip = AsnIoOpen("example.prt", "r")) == NULL)
\par \tab \tab return 1;
\par 
\par \tab /*
\par \tab ** Write the output to "seqtest.out".
\par \tab */
\par 
\par \tab fp = FileOpen("seqtest.out", "w");
\par \tab fprintf(fp, "Sequence summary:\\n\\n");
\par 
\par \tab /*
\par \tab ** Read in the whole entry into the Sequence Entry Pointer, sep.
\par \tab ** Close the ASN stream, which in turn closes the input file.
\par \tab */
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab sep = SeqEntryAsnRead(aip, NULL);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab aip = AsnIoClose(aip);
\par 
\par \tab /*
\par \tab ** Determine how many Bioseqs are in this SeqEntry. Allocate
\par \tab ** enough memory to hold a list of pointer to all of these
\par \tab ** Bioseqs.  Invoke an Explore function to "visit"each Bioseq.
\par \tab ** We are allowed to pass one pointer for use by the exploring
\par \tab ** function, in this case, "BuildList".
\par \tab */
\par 
\par \tab seqnum = BioseqCount(sep);
\par \tab seqlist = MemNew((size_t)(seqnum * sizeof(BioseqPtr)));
\par \tab BioseqExplore(sep, (Pointer) seqlist, BuildList);
\par 
\par \tab /*
\par \tab ** For each Bioseq in the SeqEntry write out it's title
\par \tab ** len, number of gaps, and number of segments. Write out
\par \tab ** the length of each segment, up to 10.
\par \tab */
\par 
\par \tab for(i = 0; i < seqnum; i++) \{
\par \tab \tab numseg = BioseqCountSegs(seqlist[i]);
\par \tab \tab title = BioseqGetTitle(seqlist[i]);
\par \tab \tab FilePuts((VoidPtr)title, fp);
\par \tab \tab FilePuts("\\n", fp);
\par \tab \tab fprintf(fp, "len=%ld gaps=%ld segs=%ld\\n", BioseqGetLen(seqlist[i]),
\par \tab \tab BioseqGetGaps(seqlist[i]), numseg);
\par \tab \tab if ((numseg > 1) && (numseg <= 10)) \{
\par \tab \tab \tab BioseqGetSegLens (seqlist[i], lens);
\par \tab \tab \tab for (j = 0; j < numseg; j++)
\par \tab \tab \tab \tab fprintf(fp, "  len = %ld\\n", lens[j]);
\par \tab \tab \}
\par \tab \tab FilePuts("\\n", fp);
\par \tab \}
\par 
\par \tab spp = SeqPortNew(seqlist[0], 0, -1, 0, Seq_code_iupacna);
\par \tab if (spp == NULL)
\par \tab \tab Message(MSG_ERROR, "fail on SeqPortNew");
\par 
\par \tab fprintf(fp, "SeqPort: plus strand with SeqPortGetResidue\\n\\n");
\par 
\par \tab i = 0;
\par \tab while ((residue = SeqPortGetResidue(spp)) != SEQPORT_EOF) \{
\par \tab \tab if (residue == SEQPORT_EOS) \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab \tab buffer[i] = '\\0';
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab \tab \tab fprintf(fp, "%s\\nSegment\\n", buffer);
\par \tab \tab \tab i = 0;
\par \tab \tab \} else \{
\par \tab \tab \tab buffer[i] = residue;
\par \tab \tab \tab i++;
\par \tab \tab \tab if (i == 60) \{
\par \tab \tab \tab \tab buffer[i] = '\\0';
\par \tab \tab \tab \tab fprintf(fp, "%s\\n", buffer);
\par \tab \tab \tab \tab i = 0;
\par \tab \tab \tab \}
\par \tab \tab \}
\par \tab \}
\par 
\par \tab if (i) \{
\par \tab \tab buffer[i] = '\\0';
\par \tab \tab fprintf(fp, "%s\\n", buffer);
\par \tab \}
\par 
\par \tab fprintf(fp, "EOF\\n");
\par \tab SeqPortFree(spp);
\par 
\par \tab fprintf(fp, "\\nSeqPort on minus with SeqPortRead\\n\\n");
\par \tab spp = SeqPortNew(seqlist[0], 0, -1, Seq_strand_minus, Seq_code_iupacna);
\par 
\par \tab if (spp == NULL)
\par \tab \tab Message(MSG_ERROR, "fail on SeqPortNew");
\par 
\par \tab do \{
\par \tab \tab ctr = SeqPortRead(spp, (Uint1Ptr)buffer, 60);
\par \tab \tab if (ctr > 0) \{
\par \tab \tab \tab buffer[ctr] = '\\0';
\par \tab \tab \tab fprintf(fp, "%s\\n", buffer);
\par \tab \tab \} else \{
\par \tab \tab \tab ctr *= -1;
\par \tab \tab \tab if (ctr == SEQPORT_EOS)
\par \tab \tab \tab \tab fprintf(fp,"Segment\\n");
\par \tab \tab \tab else if (ctr == SEQPORT_EOF)
\par \tab \tab \tab \tab fprintf(fp,"EOF\\n");
\par \tab \tab \}
\par \tab \} while (ctr != SEQPORT_EOF);
\par 
\par \tab SeqPortFree(spp);
\par 
\par \tab /*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab ** Write out the nucleic acid sequences in this SeqEntry
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab */
\par 
\par \tab fprintf(fp, "\\nNucleic Acids in FASTA format:\\n\\n");
\par \tab SeqEntryToFasta(sep, fp, TRUE);
\par 
\par \tab /*
\par \tab ** Write out the protein sequences in this SeqEntry.
\par \tab */
\par 
\par \tab fprintf(fp, "\\nProteins in FASTA format:\\n\\n");
\par \tab SeqEntryToFasta(sep, fp, FALSE);
\par 
\par \tab /*
\par \tab ** Close the output file and free up allocated space.
\par \tab */
\par 
\par \tab fclose(fp);
\par \tab MemFree(seqlist);
\par \tab SeqEntryFree(sep);
\par 
\par \tab return 0;
\par \}
\par 
\par /*
\par ** This SeqEntry exploration function copy the current pointer position inthe
\par ** the Bioseq entry to a list of Bioseq pointers
\par */
\par 
\par void BuildList(SeqEntryPtr sep, Pointer data, Int4 index, Int2 indent)
\par \{
\par \tab ((BioseqPtr PNTR) data)[index] = (BioseqPtr)sep->data.ptrvalue;
\par \tab return;
\par \}
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431033}{\*\bkmkstart _Toc300649433}Finding Features and Descriptors in an Entry{\*\bkmkend _Toc294431033}{\*\bkmkend _Toc300649433}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\f0 The features attached to one particular SeqEntry can be obtained as follows:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <objall.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  #include <sequtil.h>
\par 
\par   BioseqPtr     bsp;
\par   BioseqSetPtr  bsetp;
\par   ValNodePtr    descr;
\par   SeqAnnotPtr   annot;
\par   SeqFeatPtr    feat;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  descr = NULL;
\par   annot = NULL;
\par   feat = NULL;
\par   bsp = NULL;
\par   bsetp = NULL;
\par   if (IS_Bioseq (sep)) \{
\par     bsp = (BioseqPtr) sep->data.ptrvalue;
\par     if (bsp != NULL) \{
\par       descr = bsp->descr;
\par       annot = bsp->annot;
\par     \}
\par   \} else if (IS_Bioseq_set (sep)) \{
\par     bsetp = (BioseqSetPtr) sep->data.ptrvalue;
\par     if (bsetp != NULL) \{
\par       descr = bsetp->descr;
\par       annot = bsetp->annot;
\par     \}
\par   \}
\par   while (descr != NULL) \{
\par     /* Do something with the descr. */
\par     descr = descr->next;
\par   \}
\par 
\par   while (annot != NULL) \{
\par     if (annot->type == 1) \{
\par       feat = (SeqFeatPtr) annot->data;
\par       while (feat != NULL) \{
\par         /* Do something with the feat. */
\par         feat = feat->next;
\par       \}
\par     \}
\par     annot = annot->next;
\par   \}
\par }\pard\plain \sb240\keepn\widctlpar\adjustright \f16\fs20\cgrid {\f0 The features applicable to a given Bioseq, which may be attached at any point in the hierarchy, can be obtained using the BioseqContext functions as follows:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <objall.h>
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  #include <sequtil.h>
\par 
\par   BioseqPtr         bsp;
\par   BioseqSetPtr      bsetp;
\par   ValNodePtr        descr;
\par   SeqAnnotPtr       annot;
\par   SeqFeatPtr        feat;
\par   BioseqContextPtr  bcp;
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  if (IS_Bioseq (sep))
\par     bcp = BioseqContextNew ((BioseqPtr) sep->data.ptrvalue);
\par     if (bcp != NULL) \{
\par       descr = BioseqContextGetSeqDescr (bcp, 0, NULL, NULL);
\par       while (descr != NULL) \{
\par         /* Do something with the descr. */
\par         descr = BioseqContextGetSeqDescr (bcp, 0, descr, NULL);
\par       \}
\par       BioseqContextFree (bcp);
\par     \}
\par     bcp = BioseqContextNew ((BioseqPtr) sep->data.ptrvalue);
\par     if (bcp != NULL) \{
\par       feat = BioseqContextGetSeqFeat (bcp, 0, NULL, NULL, 0);
\par       while (feat != NULL) \{
\par         /* Do something with the feat. */
\par         feat = BioseqContextGetSeqFeat (bcp, 0, feat, NULL, 0);
\par       \}
\par       BioseqContextFree (bcp);
\par     \}
\par   \}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431034}{\*\bkmkstart _Toc300649434}Exploring an Object Using ASN.1 Defined Names{\*\bkmkend _Toc294431034}{\*\bkmkend _Toc300649434}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\f0 An alternative method of obtaining features utilizes exploration of the object loading in memory by the functions which writes it to an ASN.1 stream. This methods allows you to call a function(s) of your design with a data structure of your own on any ASN.1 defined object by just giving the string defining its ASN.1 path.  The callback function in this example prints the sequences referenced by coding region features (choice 3):
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <seqport.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  #include <asn.h>
\par 
\par   static AsnExpOptPtr  aeop;
\par   static AsnIoPtr      aip;
\par   static Int2          charsPerLine = 50;
\par   static FILE          *fp;
\par 
\par   static void GetSeqFeat (AsnExpOptStructPtr aeosp)
\par 
\par   \{
\par     Char        buffer [101];
\par     Int2        i;
\par     Uint1       residue;
\par     SeqFeatPtr  sfp;
\par     SeqPortPtr  spp;
\par 
\par     if (aeosp->dvp->intvalue != START_STRUCT) \{
\par       return
\par     \}
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    sfp = (SeqFeatPtr) aeosp->the_struct;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    if (sfp->data.choice == 3) \{
\par       spp = SeqPortNewByLoc (sfp->location, Seq_code_iupacna);
\par       i = 0;
\par 
\par       while ((residue = SeqPortGetResidue(spp)) != SEQPORT_EOF) \{
\par         if (residue == SEQPORT_EOS) \{
\par           buffer [i] = '\\0';
\par           fprintf (fp, "%s\\n>Segment\\n", buffer);
\par           i = 0;
\par         \} else \{
\par           buffer [i] = residue;
\par           i++;
\par           if (i >= charsPerLine) \{
\par             buffer [i] = '\\0';
\par             fprintf (fp, "%s\\n", buffer);
\par             i = 0;
\par           \}
\par         \}
\par       \}
\par 
\par       if (i != 0) \{
\par         buffer [i] = '\\0';
\par         fprint (fp, "%s\\n", buffer);
\par       \}
\par 
\par       SeqPortFree(spp);
\par     \}
\par   \}
\par 
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The callback is attached to an AsnIoPtr stream with AsnExpOptNew. In this case we use AsnIoNullOpen to attach the AsnIo stream to a null device (will exhaustively traverse the object in memory, but not actually write out ASN.1).  When the object loader function SeqEntryAsnWrite is called, passing the specified ASN.1 entity (Seq-feat in this example) triggers the callback:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  fp = FileOpen ("test.out", "w");
\par   aip = AsnIoNullOpen ();
\par   aeop = AsnExpOptNew (aip, "Seq-feat", NULL, GetSeqFeat);
\par   if (aeop != NULL) \{
\par     SeqEntryAsnWrite (sep, aip, NULL);
\par   \}
\par   AsnIoClose (aip);
\par   FileClose (fp);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431035}{\*\bkmkstart _Toc300649435}C Structures and Functions: sequtil.h{\*\bkmkend _Toc294431035}{\*\bkmkend _Toc300649435}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  sequtil.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*                                                                          
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  sequtil.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 4/1/91
\par *
\par * $Revision: 2.11 $
\par *
\par * File Description:  Sequence Utilities for objseq and objsset
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par #ifndef _NCBI_SeqUtil_
\par #define _NCBI_SeqUtil_
\par 
\par #ifndef _NCBI_Seqset_
\par #include <objsset.h>\tab \tab    /* the object loader interface */
\par #endif
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#ifdef __cplusplus
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   What am I?
\par *
\par *****************************************************************************/
\par extern Uint1 Bioseq_repr PROTO((BioseqPtr bsp));
\par extern Uint1 BioseqGetCode PROTO((BioseqPtr bsp));
\par 
\par ValNodePtr BioseqGetSeqDescr PROTO((BioseqPtr bsp, Int2 type, ValNodePtr curr));
\par CharPtr BioseqGetTitle PROTO((BioseqPtr bsp));
\par NumberingPtr BioseqGetNumbering PROTO((BioseqPtr bsp));
\par 
\par extern Int4 BioseqGetLen PROTO((BioseqPtr bsp));
\par extern Int4 BioseqGetGaps PROTO((BioseqPtr bsp));
\par extern Int4 BioseqGetSegLens PROTO((BioseqPtr bsp, Int4Ptr lens));
\par #define BioseqCountSegs(x) BioseqGetSegLens(x, NULL)
\par 
\par extern Boolean BioseqRawConvert PROTO((BioseqPtr bsp, Uint1 newcode));
\par extern Boolean BioseqRawPack PROTO((BioseqPtr bsp));
\par extern ByteStorePtr BSConvertSeq PROTO((ByteStorePtr bsp, Uint1 newcode, Uint1 oldcode, Int4 seqlen));
\par 
\par BioseqPtr BioseqFind PROTO((SeqIdPtr sip));
\par Boolean BioseqMatch PROTO((BioseqPtr bsp, SeqIdPtr sip));
\par 
\par CharPtr StringForSeqMethod PROTO((Int2 method));
\par 
\par /*****************************************************************************
\par *
\par *   Context routines for Bioseqs in Seq-entrys
\par *      Context is the chain of Seqentries leading to the bioseq.
\par *      context[count-1] is SeqEntry for bsp itself
\par *      If Bioseq not in a Seqentry, count is 0
\par *
\par *****************************************************************************/
\par #define BIOSEQCONTEXTMAX 20
\par 
\par typedef struct bioseqcontxt \{
\par \tab BioseqPtr bsp;           /* the Bioseq in question */
\par \tab Int2 count;              /* number of elements in context */
\par \tab Boolean hit;             /* used by BioseqContextNew and ..GetSeqFeat */
\par \tab SeqEntryPtr context[BIOSEQCONTEXTMAX];  /* array of SeqEntryPtr (last is count -1) */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab SeqFeatPtr sfp;          /* current sfp */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab SeqAnnotPtr sap;         /* current sap */
\par \tab Int2 sftype,             /* SeqFeat type to look for */
\par \tab \tab in;\tab \tab \tab \tab \tab  /* 0=location, 1=product, 2=either */
\par \} BioseqContext, PNTR BioseqContextPtr;
\par 
\par BioseqContextPtr BioseqContextNew PROTO((BioseqPtr bsp));
\par BioseqContextPtr BioseqContextFree PROTO((BioseqContextPtr bcp));
\par ValNodePtr BioseqContextGetSeqDescr PROTO((BioseqContextPtr bcp, Int2 type, ValNodePtr curr, SeqEntryPtr PNTR the_sep));
\par CharPtr BioseqContextGetTitle PROTO((BioseqContextPtr bcp));
\par SeqFeatPtr BioseqContextGetSeqFeat PROTO((BioseqContextPtr bcp, Int2 type,
\par \tab SeqFeatPtr curr, SeqAnnotPtr PNTR sapp, Int2 in));
\par 
\par /*****************************************************************************
\par *
\par *   SeqCodeTable routines
\par *   SeqMapTable routines
\par *     both may return INVALID_RESIDUE when a residue is out of range
\par *
\par *****************************************************************************/
\par #define INVALID_RESIDUE 255
\par 
\par Uint1 SeqMapTableConvert PROTO((SeqMapTablePtr smtp, Uint1 residue));
\par Uint1 SeqCodeTableComp PROTO((SeqCodeTablePtr sctp, Uint1 residue));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   Numbering routines
\par *
\par *****************************************************************************/
\par                               /* convert any numbering value to seq offset */
\par extern Int4 NumberingOffset PROTO((NumberingPtr np, DataValPtr avp));
\par                               /* convert seq offset to numbering value */
\par extern Int2 NumberingValue PROTO((NumberingPtr np, Int4 offset, DataValPtr avp));
\par extern Int2 NumberingValueBySeqId PROTO((SeqIdPtr sip, Int4 offset, DataValPtr avp));
\par 
\par extern void NumberingDefaultLoad PROTO((void));
\par extern NumberingPtr NumberingDefaultGet PROTO((void));
\par 
\par /*****************************************************************************
\par *
\par *   SeqEntry and BioseqSet stuff
\par *
\par *****************************************************************************/
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Uint1 Bioseq_set_class PROTO((SeqEntryPtr sep));
\par 
\par /*****************************************************************************
\par *
\par *   traversal routines
\par *       SeqEntry - any type
\par *
\par *****************************************************************************/
\par typedef void (* SeqEntryFunc) PROTO((SeqEntryPtr sep, Pointer mydata, Int4 index, Int2 indent));
\par extern Int4 SeqEntryList PROTO((SeqEntryPtr sep, Pointer mydata, SeqEntryFunc mycallback, Int4 index, Int2 indent));
\par 
\par #define SeqEntryCount( a )  SeqEntryList( a ,NULL,NULL,0,0);
\par #define SeqEntryExplore(a,b,c) SeqEntryList(a, b, c, 0L, 0);
\par 
\par /*****************************************************************************
\par *
\par *   traversal routines
\par *       Bioseq types only - "individual" sequences
\par *       do NOT traverse component parts of seqmented or constructed types
\par *
\par *****************************************************************************/
\par extern Int4 BioseqList PROTO((SeqEntryPtr sep, Pointer mydata, SeqEntryFunc mycallback, Int4 index, Int2 indent));
\par 
\par #define BioseqCount( a )  BioseqList( a ,NULL,NULL,0,0);
\par #define BioseqExplore(a,b,c) BioseqList(a, b, c, 0L, 0);
\par 
\par /*****************************************************************************
\par *
\par *   Get parts routines
\par *
\par *****************************************************************************/
\par                        /* gets next Seqdescr after curr in sep of type type */
\par ValNodePtr SeqEntryGetSeqDescr PROTO((SeqEntryPtr sep, Int2 type, ValNodePtr curr));
\par                        /* gets first title from sep */
\par CharPtr SeqEntryGetTitle PROTO((SeqEntryPtr sep));
\par 
\par /*****************************************************************************
\par *
\par *   Manipulations
\par *
\par *****************************************************************************/
\par 
\par extern Boolean SeqEntryConvert PROTO((SeqEntryPtr sep, Uint1 newcode));
\par #define SeqEntryPack(x) SeqEntryConvert(x, (Uint1)0)
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par /*****************************************************************************
\par *
\par *   SeqLoc stuff
\par *
\par *****************************************************************************/
\par #define PRINTID_FASTA_SHORT ( (Uint1)1)
\par #define PRINTID_FASTA_LONG ( (Uint1)2)
\par #define PRINTID_TEXTID_LOCUS ( (Uint1)3)
\par #define PRINTID_TEXTID_ACCESSION ( (Uint1)4)
\par #define PRINTID_REPORT ((Uint1)5)
\par 
\par SeqIdPtr SeqIdSelect PROTO((SeqIdPtr sip, Uint1Ptr order, Int2 num));
\par Int2 SeqIdBestRank PROTO((Uint1Ptr buf, Int2 num));
\par SeqIdPtr SeqIdFindBest PROTO(( SeqIdPtr sip, Uint1 target));
\par CharPtr SeqIdPrint PROTO((SeqIdPtr sip, CharPtr buf, Uint1 format));
\par SeqIdPtr SeqIdParse PROTO((CharPtr buf));
\par 
\par /*****************************************************************************
\par *
\par *   Boolean SeqIdMatch(a,b)
\par *       returns TRUE if seqids match
\par *
\par *****************************************************************************/
\par Boolean SeqIdMatch PROTO((SeqIdPtr a, SeqIdPtr b));
\par /*************************
\par    SeqIdForSameBioseq(a,b)
\par    trys to locate all ids for a or b and determine
\par    if (a and b refer the the same Bioseq)
\par **************************/
\par Boolean SeqIdForSameBioseq PROTO((SeqIdPtr a, SeqIdPtr b));
\par /*************************
\par  *      Boolean SeqIdIn (a,b)
\par  *   returns TRUE if a in list of b
\par  ******************/
\par Boolean SeqIdIn PROTO((SeqIdPtr a, SeqIdPtr b));
\par 
\par 
\par SeqLocPtr SeqLocFindNext PROTO((SeqLocPtr seqlochead, SeqLocPtr currseqloc));
\par Boolean IS_one_loc PROTO((SeqLocPtr anp));  /* for SeqLoc */
\par 
\par Int4 SeqLocStart PROTO((SeqLocPtr seqloc));
\par Int4 SeqLocStop PROTO((SeqLocPtr seqloc));
\par Uint1 SeqLocStrand PROTO((SeqLocPtr seqloc));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Int4 SeqLocLen PROTO((SeqLocPtr seqloc));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Int4 SeqLocGetSegLens PROTO((SeqLocPtr slp, Int4Ptr lens, Int4 ctr, Boolean gaps));
\par #define SeqLocCountSegs(x) SeqLocGetSegLens(x, NULL,0,FALSE)
\par #define SeqLocGetGaps(x) SeqLocGetSegLens(x,NULL,0,TRUE)
\par SeqIdPtr SeqLocId PROTO((SeqLocPtr seqloc));
\par Uint1 StrandCmp PROTO((Uint1 strand));
\par Boolean SeqLocRevCmp PROTO((SeqLocPtr anp));
\par Int4 GetOffsetInLoc PROTO((SeqLocPtr of, SeqLocPtr in, Boolean start));
\par Int4 GetOffsetInBioseq PROTO((SeqLocPtr of, BioseqPtr in, Boolean start));
\par Int2 SeqLocOrder PROTO((SeqLocPtr a, SeqLocPtr b, BioseqPtr in));
\par Int2 SeqLocMol PROTO((SeqLocPtr seqloc));
\par 
\par CharPtr SeqLocPrint PROTO((SeqLocPtr slp));
\par 
\par 
\par /*****************************************************************************
\par *
\par *   SeqLocCompare(a, b)
\par *   \tab returns
\par *   \tab 0 = no overlap
\par *   \tab 1 = a is completely contained in b
\par *   \tab 2 = b is completely contained in a
\par *   \tab 3 = a == b
\par *   \tab 4 = a and b overlap, but neither completely contained in the other
\par *
\par *****************************************************************************/
\par Int2 SeqLocCompare PROTO((SeqLocPtr a, SeqLocPtr b));
\par #define SLC_NO_MATCH 0
\par #define SLC_A_IN_B 1
\par #define SLC_B_IN_A 2
\par #define SLC_A_EQ_B 3
\par #define SLC_A_OVERLAP_B 4
\par 
\par Boolean SeqIntCheck PROTO((SeqIntPtr sip));   /* checks for valid interval */
\par Boolean SeqPntCheck PROTO((Int4 point, SeqIdPtr seq_id));  /* checks valid pnt */
\par CharPtr TaxNameFromCommon PROTO((CharPtr common));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431036}{\*\bkmkstart _Toc300649436}C Structures and Functions: seqport.h{\*\bkmkend _Toc294431036}{\*\bkmkend _Toc300649436}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*  seqport.h
\par * ===========================================================================
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  seqport.h
\par *
\par * Author:  James Ostell
\par *   
\par * Version Creation Date: 7/13/91
\par *
\par * $Revision: 2.2 $
\par *
\par * File Description:  Ports onto Bioseqs
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date\tab    Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _NCBI_Seqport_
\par #define _NCBI_Seqport_
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#include <sequtil.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /*****************************************************************************
\par *
\par *   SeqPort
\par *       will attach only to "individual" sequence
\par *       Get/Read return 253 for end of sequence,
\par *           252 for end of segment
\par *           251 when skipping a virtual sequence with length
\par *       and INVALID_RESIDUE (255) on invalid residues
\par *
\par *****************************************************************************/
\par #define SEQPORT_EOF 253       /* end of sequence data */
\par #define SEQPORT_EOS 252       /* end of segment */
\par #define SEQPORT_VIRT 251      /* skipping virtual sequence with length */
\par #define IS_residue(x) (x <= 250)
\par  
\par 
\par typedef struct seqport \{
\par     BioseqPtr bsp;             /* 1 seqentry per port */
\par     Int4 start, stop,            /* region of bsp covered */
\par         curpos,                  /* current position 0-(totlen-1) */
\par         totlen,                  /* total length of covered region */
\par \tab \tab bytepos;                 /* current byte position in bsp->data */
\par     NumberingPtr currnum;        /* current numbering info */
\par     Uint1 strand,                /* as in seqloc */
\par         lastmsg;                 /* used by SeqPortRead() */
\par     Boolean is_circle ,          /* go around the end of a circle? */
\par             is_seg ,             /* return EOS at the end of segments? */
\par             do_virtual,          /* deliver '-' over virtual seqs */
\par             eos;                 /* set when comp strand tries to back off */
\par     SeqMapTablePtr smtp;         /* for mapping to requested alphabet */
\par     SeqCodeTablePtr sctp;        /* for getting symbols */
\par     Uint1 newcode,               /* requested output code */
\par           oldcode;               /* current input seq code (0 if not raw) */
\par     Uint1 byte,                    /* current byte in buf */
\par         bc,                      /* value to start bitctr */
\par         bitctr,                  /* current shift */
\par         lshift,                  /* amount to left shift on decompact */
\par         rshift,                  /* amount to right shift residue value */
\par         mask;                    /* mask for compact byte */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    struct seqport PNTR curr ,   /* current active seqport if seg or ref */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        PNTR segs,                    /* segments if seg or ref */
\par         PNTR next;                    /* if part of a segment chain */
\par \} SeqPort, PNTR SeqPortPtr;
\par 
\par SeqPortPtr SeqPortNew PROTO((BioseqPtr bsp, Int4 start, Int4 stop, Uint1 strand, Uint1 code));
\par SeqPortPtr SeqPortNewByLoc PROTO((SeqLocPtr seqloc, Uint1 code));
\par SeqPortPtr SeqPortFree PROTO((SeqPortPtr spp));
\par Int4 SeqPortTell PROTO((SeqPortPtr spp));
\par Int2 SeqPortSeek PROTO((SeqPortPtr spp, Int4 offset, Int2 origin));
\par Int4 SeqPortLen PROTO((SeqPortPtr spp));
\par Uint1 SeqPortGetResidue PROTO((SeqPortPtr spp));
\par Int2 SeqPortRead PROTO((SeqPortPtr spp, BytePtr buf, Int2 len));
\par 
\par /*****************************************************************************
\par *
\par *   ProteinFromCdRegion(sfp, include_stop)
\par *   \tab produces a ByteStorePtr containing the protein sequence in
\par *   ncbieaa code for the CdRegion sfp.  If include_stop, will translate
\par *   through stop codons.  If NOT include_stop, will stop at first stop
\par *   codon and return the protein sequence NOT including the terminating
\par *   stop.  Supports reading frame, alternate genetic codes, and code breaks
\par *   in the CdRegion
\par *
\par *****************************************************************************/
\par ByteStorePtr ProteinFromCdRegion PROTO(( SeqFeatPtr sfp, Boolean include_stop));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 282}}}{\b0 \tab Entrez Data Access}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Entrez Data Access   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 283}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {\b0\fs20 include access.doc}}{\fldrslt {{\*\bkmkstart _Toc294431037}{\*\bkmkstart _Toc300649437}Entrez Data Access{\*\bkmkend _Toc294431037}{\*\bkmkend _Toc300649437}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431038}{\*\bkmkstart _Toc300649438}Introduction{\*\bkmkend _Toc294431038}{\*\bkmkend _Toc300649438}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The NCBI Software Development Kit provides functions to load Sequence and MEDLINE records from the Entrez: Sequences and Entrez: Citations CD-ROMs.  Records can be accessed by specifying their unique ID (UID). UIDs for a sequence record can easily be obtained by supplying an accession number from a source database, or a full Boolean query on indexed terms can be evaluated to return a list of UIDs that satisfy the query.  Given a UID, a single function call will load the record into a defined structure in memory, and return a pointer to the head of the memory object.
\par Alternatively, each record can be read in turn by a process called streaming, which does not require knowledge of a specific UID.  A program can either use the Object Loader level, which loads a given record into the defined memory structure, or it can use the AsnLib level, allowing it to read each ASN.1 item as it streams by.  The decision on which method to use depends upon the task being performed.
\par These memory object pointers can be passed to a number of utility functions.  These include standard report generators, which can convert MEDLINE records to MEDLARS format and sequence records to FASTA or GenBank Flat File formats.  A sequence port can be opened that gives a simple, linear view of a segmented sequence, converting alphabets, merging exon segments, and dealing with information on both strands of the DNA.  There are also functions to explore the individual BioSeqs in an object, and to retrieve features from any level in the structure. These functions have been discussed in the Sequence Utilities chapter.
\par A demo program, getseq.c, in the \\demo directory of the NCBI software toolkit takes any sequence identifier (e.g. accession number, locus name), finds the unique id, then retrieves the entry. Parts of this program are explained below. Also, all of the Entrez application itself can be found in the \\browser directory. The access functions are in the \\cdromlib directory and listed in accentr.h.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431039}{\*\bkmkstart _Toc300649439}Connecting To and Disconnecting From Data Sources{\*\bkmkend _Toc294431039}{\*\bkmkend _Toc300649439}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The program must connect to the databases before attempting to access them, and must disconnect from the databases prior to exit.  The Entrez application calls EntrezInit and EntrezFini.  (Access to more complicated Sequence and MEDLINE services are obtained by calling AccSeqInit, AccMlInit, AccSeqFini and AccMlFini.)  Many programs will also need to load the ASN.1 parse tables.   These function calls require that the NCBI configuration file (ncbi.cnf, ncbi.ini, ncbi.cfg or .ncbirc, depending upon the computer platform) is properly set up to specify appropriate data paths:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par   #include <objall.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  #include <objcode.h>
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par   if (EntrezInit ()) \{
\par     if (AllObjLoad () && SeqCodeSetLoad ()) \{
\par       /* Main body of program goes here. */
\par     \}
\par     EntrezFini ();
\par   \}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431040}{\*\bkmkstart _Toc300649440}Scanning the List of Available Terms{\*\bkmkend _Toc294431040}{\*\bkmkend _Toc300649440}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The list of terms can be obtained by a scanning procedure.  This utilizes a callback function.  If the Boolean return of the callback is FALSE, the scanning stops:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par 
\par   static Boolean ReadProc (CharPtr term, Int4 special, Int4 total)
\par 
\par   \{
\par     Char  str [32];
\par 
\par     /* Do something with the term. */
\par     MemFree (term);
\par     return TRUE;
\par   \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The term scanning can be started from a given string using EntrezTermListByTerm.  The page on which the first term appears is returned via the last parameter.  The return value is the number of complete pages read.  Scanning will continue until the end of the term list or until the callback returns FALSE:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  EntrezTermListByTerm (TYPE, FIELD, str, TERMS, ReadProc, &startPage);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The term scanning can be started from a given page using EntrezTermListByPage.  Scanning will continue until the end of the term list, until the specified number of pages have been read, or until the callback returns FALSE:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  EntrezTermListByPage (TYPE, FIELD, startPage, PAGES, ReadProc);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The special and total counts for a given term can be obtained by EntrezFindTerm.  This will also perform a truncation if the term string ends in "...":
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  EntrezFindTerm (TYPE, FIELD, str, &special, &total);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431041}{\*\bkmkstart _Toc300649441}Obtaining the UID Given an Accession Number{\*\bkmkend _Toc294431041}{\*\bkmkend _Toc300649441}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The unique ID for the first record indexed under a given name or accession number from a particular source database can be obtained with FindSeqId.  (To get all record UIDS, see the Boolean Query evaluation section below.)  FindSeqId returns a single UID, even if the accession number points to multiple records:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accseq.h>
\par 
\par   SeqIdPtr      sip;
\par   TextSeqIdPtr  tsip;
\par   DocUid        uid;
\par 
\par   tsip = TextSeqIdNew ();
\par   sip = ValNodeNew (NULL);
\par   sip->data.ptrvalue = tsip;
\par 
\par   switch (TYPE) \{
\par     case GENBANK :
\par     sip->choice = SEQID_GENBANK;
\par     break;
\par     case PIR :
\par     sip->choice = SEQID_PIR;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    break;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    case SWISSPROT :
\par     sip->choice = SEQID_SWISSPROT;
\par     break;
\par   \};
\par 
\par   switch (KIND) \{
\par     case NAME :
\par       tsip->name = StringSave (TERM);
\par       break;
\par     case ACCESSION :
\par       tsip->accession = StringSave (TERM);
\par       break;
\par   \}
\par 
\par   uid = FindSeqId (sip);
\par 
\par   if (uid != 0) \{
\par     /* Do something with the uid. */
\par   \}
\par 
\par   TextSeqIdFree (tsip);
\par   ValNodeFree (sip);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431042}{\*\bkmkstart _Toc300649442}Obtaining the UIDs That Satisfy a Boolean Query{\*\bkmkend _Toc294431042}{\*\bkmkend _Toc300649442}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Boolean query evaluation is done by constructing a formula in memory andpassing it to an evaluation routine.  A LinkSetPtr containing the satisfying UIDS is returned.  All calls must define the data type and field of interest. A series of #defines are available in accentr.h for this purpose. 
\par }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s31\qc\sb240\keepn\widctlpar\intbl\adjustright \b\f16\cgrid {#define\cell Data Type\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TYP_ML\cell MEDLINE\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TYP_AA\cell Amino Acid Sequence\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TYP_NT\cell Nucleotide Sequence\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {TYP_SEQ\cell Either Sequence Type\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {
\par }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw30 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s31\qc\sb240\keepn\widctlpar\intbl\adjustright \b\f16\cgrid {#define\cell Field\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_WORD\cell Text words\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_MESH\cell MeSH terms\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_KYWD\cell Keywords\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_AUTH\cell Author Names\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_JOUR\cell Journal Names\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_ORGN\cell Organism Names\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_ACCN\cell Accession numbers, locus names, patent ids...\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_GENE\cell Gene Symbols\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_PROT\cell Protein Names\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\trowd \trgaph108\trleft-108\trkeep \clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw30 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw15 \cltxlrtb \cellx4212\clvertalt\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw30 \clbrdrr\brdrs\brdrw30 \cltxlrtb \cellx8532\pard\plain \s29\keepn\widctlpar\intbl\adjustright \f16\fs20\cgrid {FLD_ECNO\cell E.C. numbers\cell }\pard\plain \widctlpar\intbl\adjustright \f16\fs20\cgrid {\row }\pard \sb240\widctlpar\adjustright {
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par 
\par   ValNodePtr  elst;
\par   Int2        group;
\par   Int4        i;
\par   Int2        last;
\par   LinkSetPtr  lsp;
\par   DocUid      uid;
\par 
\par   group = 0;
\par   last = 0;
\par 
\par   while (MORE_QUERIES) \{
\par     elst = EntrezTLNew (TYPE);
\par     while (GET_NEXT_TERM ()) \{
\par 
\par       if (GROUP_SINGLE || GROUP_FIRST) \{
\par         group++;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {      \}
\par 
\par       if (last == 0) \{
\par         EntrezTLAddLParen (elst);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {      \} else if (last == group) \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {        EntrezTLAddOR (elst);
\par       \} else \{
\par         EntrezTLAddRParen (elst);
\par         EntrezTLAddAND (elst);
\par         EntrezTLAddLParen (elst);
\par       \}
\par 
\par       EntrezTLAddTerm (elst, TERM, TYPE, FIELD, STATE_SPECIAL);
\par       last = group;
\par     \}
\par 
\par     lsp = EntrezTLEval (elst);
\par     EntrezTLFree (elst);
\par     for (i = 0; i < lsp->num; i++) \{
\par       uid = lsp->uids [i];
\par       /* Do something with the uid. */
\par     \}
\par     LinkSetFree (lsp);
\par   \}
\par 
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431043}{\*\bkmkstart _Toc300649443}Loading a Sequence Record{\*\bkmkend _Toc294431043}{\*\bkmkend _Toc300649443}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Given a UID, SeqEntryGet will find the record on the CD-ROM, open an AsnIo channel at that location, call the object loader, and return a pointer to the SeqEntry.  The retcode parameter determines the maximum level of complexity of the loaded sequence object (BioSeq, SegSet or NucProtSet).
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par   #include <objsset.h>
\par 
\par   Int2         retcode;
\par   SeqEntryPtr  sep;
\par 
\par   switch (complexity) \{
\par     case BIOSEQ :
\par       retcode = SEQENTRY_READ_BIOSEQ;
\par       break;
\par     case SEGSET :
\par       retcode = SEQENTRY_READ_SEG_SET;
\par       break;
\par     case NUCPROT :
\par       retcode = SEQENTRY_READ_NUC_PROT;
\par       break;
\par   \}
\par 
\par   sep = EntrezSeqEntryGet (uid, retcode);
\par   /* Do something with the sep. */
\par   SeqEntryFree (sep);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431044}{\*\bkmkstart _Toc300649444}Loading a MEDLINE Record{\*\bkmkend _Toc294431044}{\*\bkmkend _Toc300649444}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Given a UID, MedlineEntryGet will find the record on the CD-ROM, open an AsnIo channel at that location, call the object loader, and return a pointer to the MedlineEntry:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par   #include <objmedli.h>
\par 
\par   MedlineEntryPtr  mep;
\par 
\par   mep = EntrezMedlineEntryGet (uid);
\par   /* Do something with the mep. */
\par   MedlineEntryFree (mep);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431045}{\*\bkmkstart _Toc300649445}Streaming Through All of the Data Records{\*\bkmkend _Toc294431045}{\*\bkmkend _Toc300649445}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {All sequence or MEDLINE records can be examined by streaming through thedata files.  Each data file in the sequence or medline directories on the CD-ROM needs to be opened and read separately. The data on the Entrez CD-ROM has undergone Huffman compression. The casn routines used here do the Huffman decompression for you. A program in the \\demo directory called asndhuff.c shows various was to decompress the data continously. The data can be read a complete entry at a time into memory, as show below, or as an ASN.1 stream from which lower level data elements can be selected as shown in asndhuff.c.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <casn.h>
\par   #include <objmedli.h>
\par   #include <objsset.h>
\par 
\par   CASN_Handle      casnh;
\par   Char             filename [FILENAME_MAX];
\par   Int2             i;
\par   MedlineEntryPtr  mep;
\par   Char             path [PATH_MAX];
\par   SeqEntryPtr      sep;
\par   Int4             total;
\par 
\par   for (i = 1; i <= 21; i++) \{
\par     if (i < 10) \{
\par       sprintf (filename, "seqasn.00%d", (int) i);
\par     \} else \{
\par       sprintf (filename, "seqasn.0%d", (int) i);
\par     \}
\par     StringCpy (path, "SEQDATA:sequence:");
\par     FileBuildPath (path, NULL, filename);
\par 
\par     if ((casnh= CASN_Open (path)) != NULL) \{
\par       total = CASN_DocCount (casnh);
\par       if (CASN_DocType (casnh) == CASN_TypSeq) \{
\par         while ((sep = CASN_NextSeqEntry (casnh)) != NULL) \{
\par           /* Do something with the sep. */
\par           SeqEntryFree (sep);
\par         \}
\par       \}
\par       CASN_Close (casnh);
\par     \}
\par   \}
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  for (i = 1; i <= 10; i++) \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    if (i < 10) \{
\par       sprintf (filename, "medasn.00%d", (int) i);
\par     \} else \{
\par       sprintf (filename, "medasn.0%d", (int) i);
\par     \}
\par     StringCpy (path, "REFDATA:medline:");
\par     FileBuildPath (path, NULL, filename);
\par 
\par     if ((casnh= CASN_Open (path)) != NULL) \{
\par       total = CASN_DocCount (casnh);
\par       if (CASN_DocType (casnh) == CASN_TypMed) \{
\par         while ((mep = CASN_NextMedlineEntry(casnh)) != NULL) \{
\par           /* Do something with the mep. */
\par           MedlineEntryFree (mep);
\par         \}
\par       \}
\par       CASN_Close (casnh);
\par     \}
\par   \}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431046}{\*\bkmkstart _Toc300649446}Converting to FASTA Format{\*\bkmkend _Toc294431046}{\*\bkmkend _Toc300649446}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A loaded sequence record can be converted to and saved in FASTA format:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <tofasta.h>
\par   #include <sequtil.h>
\par 
\par   FILE  *fp;
\par 
\par   fp = FileOpen (str, "w");
\par   SeqEntryConvert (sep, Seq_code_iupacna);
\par   SeqEntryToFasta (sep, fp, is_na);
\par   FileClose (fp);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431047}{\*\bkmkstart _Toc300649447}Converting GenBank Format{\*\bkmkend _Toc294431047}{\*\bkmkend _Toc300649447}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A loaded sequence record can be converted to and saved in GenBank flat file format:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <togenbnk.h>
\par   #include <asn.h>
\par 
\par   FILE          *fp;
\par   AsnOptionPtr  opt;
\par   DataVal       val;
\par 
\par   fp = FileOpen (str, "w");
\par   optionHead = NULL;
\par   val.intvalue = TRUE;
\par   AsnOptionNew (&opt, OP_TOGENBNK, OP_TOGENBNK_QUIET, val, NULL);
\par   AsnOptionNew (&opt, OP_TOGENBNK, OP_TOGENBNK_NO_NCBI, val, NULL);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  val.ptrvalue = StringSave ("\\?\\?\\?");
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  AsnOptionNew (&opt, OP_TOGENBNK, OP_TOGENBNK_DIV, val,
\par                 (AsnOptFreeFunc) MemFree);
\par   val.ptrvalue = StringSave ("\\?\\?-\\?\\?\\?-\\?\\?\\?\\?");
\par   AsnOptionNew (&opt, OP_TOGENBNK, OP_TOGENBNK_DATE, val,
\par                 (AsnOptFreeFunc) MemFree);
\par   AsnOptionNew (&opt, OP_TOGENBNK, OP_TOGENBNK_RELEASE, val, NULL);
\par 
\par   if (IsGenBank (sep)) \{
\par     SeqEntryToGenbank (fp, sep, opt);
\par   \}
\par   AsnOptionFree (&opt, OP_TOGENBNK, 0);
\par   FileClose (fp);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431048}{\*\bkmkstart _Toc300649448}Converting to MEDLARS Format{\*\bkmkend _Toc294431048}{\*\bkmkend _Toc300649448}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A loaded MEDLINE record can be converted to and saved in MEDLARS format:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <tomedlin.h>
\par 
\par   FILE  *fp;
\par 
\par   fp = FileOpen (str, "w");
\par   MedlineEntryToDataFile (mep, fp);
\par   FileClose (fp);
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431049}{\*\bkmkstart _Toc300649449}Loading a Document Summary{\*\bkmkend _Toc294431049}{\*\bkmkend _Toc300649449}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Given a UID and a type, EntrezDocSum will return a document summary for a record.  TYPE is TYP_ML, TYP_AA, TYP_NT, or TYP_SEQ:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par 
\par   DocSumPtr  dsp;
\par 
\par   dsp = EntrezDocSum (TYPE, uid);
\par   /* Do something with the dsp. */
\par   DocSumFree (dsp);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431050}{\*\bkmkstart _Toc300649450}Loading a Set of Document Summaries{\*\bkmkend _Toc294431050}{\*\bkmkend _Toc300649450}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Given a list of UIDs and a type, EntrezDocSumListGet will call a callback for each document summary.  If the callback returns FALSE, then remaining DocSums may be cached locally for subsequent retrieval by EntrezDocSum:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  #include <accentr.h>
\par 
\par   static Boolean DocSumProc (DocSumPtr dsp, DocUid uid)
\par 
\par   \{
\par     /* Do something with the docsum. */
\par     DocSumFree (dsp);
\par     return TRUE;
\par   \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {For EntrezDocSumListGet, NUM is the number of DocSums desired, UIDs is a DocUid array of of length NUM, and TYPE is TYP_ML, TYP_AA, TYP_NT, or TYP_SEQ:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid { EntrezDocSumListGet (NUM, TYPE, UIDs, DocSumProc);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431051}{\*\bkmkstart _Toc300649451}Retreiving Neighbors and Links{\*\bkmkend _Toc294431051}{\*\bkmkend _Toc300649451}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Neighbors and links are precomputed and stored on the Entrez CD-ROM. See the Entrez documentation for an explanation of what neighbors and links are.
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid { #include <accentr.h>
\par   #include <objacces.h>
\par 
\par   LinkSetPtr  lsp;
\par   DocUid      uid;
\par 
\par   lsp= EntrezUidLinks (FIELD, uid, LINK_TO_FIELD);
\par   for (i = 0; i < lsp->num; i++) \{
\par     uid = lsp->uids [i];
\par     /* Do something with the uid. */
\par   \}
\par   LinkSetFree (lsp);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431052}{\*\bkmkstart _Toc300649452}C Structures and Functions: accentr.h{\*\bkmkend _Toc294431052}{\*\bkmkend _Toc300649452}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/*   accentr.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par *  to the public for use. The National Library of Medicine and the U.S.    
\par *  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name:  accentr.h
\par *
\par * Author:  Ostell
\par *
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {* Version Creation Date:   4/23/92
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*
\par * $Revision: 2.10 $
\par *
\par * File Description: 
\par *       entrez index access library for Entrez
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date     Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par *
\par * ==========================================================================
\par */
\par 
\par #ifndef _ACCENTR_
\par #define _ACCENTR_
\par 
\par #ifndef _NCBI_Seqset_
\par #include <objsset.h>
\par #endif
\par 
\par #ifndef _NCBI_Medline_
\par #include <objmedli.h>
\par #endif
\par 
\par #ifndef _NCBI_Access_
\par #include <objacces.h>
\par #endif
\par 
\par #ifdef __cplusplus
\par extern "C" \{
\par #endif
\par 
\par /* --- Type Definitions --- */
\par 
\par typedef Int4  DocUid;
\par typedef Int4Ptr DocUidPtr;
\par typedef Int2   DocType;
\par typedef Int2   DocField;
\par 
\par 
\par typedef struct fielddata \{
\par     Int4    num_terms;                /* number of terms in this field */
\par     Int2    num_bucket;           /* number of buckets of terms */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\} EntrezFieldData, PNTR EntrezFieldDataPtr;
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {    
\par typedef struct typedata \{
\par     Int4    num;                   /* number of entries */
\par     Int4    num_uids;                  /* number of uids */
\par     DocUid  minuid;                /* minimum uid for this type */
\par     DocUid  maxuid;                /* maxuid for this type */
\par     Int2    num_bucket;            /* number of uid buckets */
\par     EntrezFieldDataPtr fields;
\par \} EntrezTypeData, PNTR EntrezTypeDataPtr;
\par     
\par typedef struct _EntrezInfo \{
\par     CharPtr volume_label;
\par     Int2    version;
\par     Int2    issue;
\par     Int2    format;
\par     CharPtr descr;
\par     Boolean no_compression;
\par     Int2    huff_count;
\par     Int2Ptr huff_left;
\par     Int2Ptr huff_right;
\par     Int2    type_count;
\par     CharPtr PNTR type_names;
\par     Int2    type_bucket_size;
\par     Int2    field_count;
\par     CharPtr PNTR field_names;
\par     Int2    field_bucket_size;
\par     EntrezTypeDataPtr types;
\par \} EntrezInfo, PNTR EntrezInfoPtr;
\par 
\par /*****************************************************************************
\par *
\par *   PreDefined Entrez types and fields
\par *
\par *****************************************************************************/
\par 
\par /* doc type codes */
\par #define NTYPE       3   /* number of types == 3 */
\par #define TYP_ML      0   /*  Medline-entry */
\par #define TYP_AA      1   /*  amino acid data   */
\par #define TYP_NT      2   /*  nucleic acid data */
\par #define TYP_SEQ     4   /*  either aa or na used only for uid lookups */
\par 
\par /* field codes */
\par #define NFLD        10  /* number of fields == 10 */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define FLD_WORD    0   /*  Words           */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define FLD_MESH    1   /*  MeSH terms      */
\par #define FLD_KYWD    2   /*  Keyword         */
\par #define FLD_AUTH    3   /*  Authors         */
\par #define FLD_JOUR    4   /*  Journal title   */
\par #define FLD_ORGN    5   /*  Organism        */
\par #define FLD_ACCN    6   /*  Accession number */
\par #define FLD_GENE    7   /*  Gene Symbol     */
\par #define FLD_PROT    8   /*  Protein name    */
\par #define FLD_ECNO    9   /*  E.C. number     */
\par 
\par typedef struct docsum \{
\par     DocUid uid;
\par     Boolean no_abstract,
\par         translated_title,
\par         no_authors;
\par     CharPtr caption,
\par         title;
\par \} DocSum, PNTR DocSumPtr;
\par 
\par typedef Boolean (*DocSumListCallBack) PROTO((DocSumPtr dsp, DocUid uid));
\par 
\par #define NULLSYM     0     /* for building booleans */
\par #define LPAREN      1
\par #define RPAREN      2
\par #define ANDSYMBL    3
\par #define ORSYMBL     4
\par #define BUTNOTSYMBL 5
\par #define SPECIALTERM 6
\par #define TOTALTERM   7
\par 
\par 
\par /**** Initialize and close session *********************/
\par 
\par /* Note:                                                                      */
\par /*   In October 1993, EntrezInit() will be replaced by the functionality of   */
\par /*   EntrezInitWithExtras(), and EntrezInitWithExtras(), in turn, will be     */
\par /*   temporarily defined as a macro version of EntrezInit().                  */
\par /*   I.e., in October 1993, this code will read as follows:                   */
\par /*     #define EntrezInitWithExtras(a,b,c)   EntrezInit(a,b,c)                */
\par /*     extern Boolean _cdecl EntrezInit PROTO((CharPtr appl_id,               */
\par /*         Boolean no_warnings, BoolPtr is_network));                         */
\par /*                                                                            */
\par /*   In the Spring of 1994, the EntrezInitWithExtras() macro will be deleted. */
\par /*                                  - J. Epstein, 8 June 1993                 */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {#define EntrezInit()             EntrezInitWithExtras(NULL, FALSE, NULL)
\par 
\par Boolean LIBCALL EntrezInitWithExtras PROTO((CharPtr appl_id, Boolean no_warnings, BoolPtr is_network));
\par void LIBCALL EntrezFini PROTO((void));
\par 
\par /**** Get names and numbers of fields and types ********/
\par 
\par EntrezInfoPtr LIBCALL EntrezGetInfo PROTO((void));
\par 
\par EntrezInfoPtr LIBCALL EntrezInfoAsnRead PROTO((AsnIoPtr aip, AsnTypePtr orig));
\par EntrezInfoPtr LIBCALL EntrezInfoFree PROTO((EntrezInfoPtr cip));
\par 
\par /**** Creates a term node from the uid parameter ********/
\par void LIBCALL EntrezCreateNamedUidList PROTO((CharPtr term, DocType type, DocField field, Int4 num, DocUidPtr uids));
\par 
\par /**** Used only by Entrez network server ***************/
\par Boolean LIBCALL EntrezInfoAsnWrite PROTO((EntrezInfoPtr p, AsnIoPtr aip, AsnTypePtr orig));
\par 
\par /**** Get detailed text information about the current status *****/
\par CharPtr LIBCALL EntrezDetailedInfo PROTO((void));
\par 
\par /**** Get Links and Neighbors **************************/
\par 
\par Int4 LIBCALL EntrezGetMaxLinks PROTO((void));
\par Int4 LIBCALL EntrezSetUserMaxLinks PROTO((Int4 usermax));
\par Int4 LIBCALL EntrezGetUserMaxLinks PROTO((void));
\par 
\par LinkSetPtr LIBCALL EntrezUidLinks PROTO((DocType type, DocUid uid, DocType link_to_type));
\par Int2 LIBCALL EntrezLinkUidList PROTO((LinkSetPtr PNTR result, DocType type,
\par \tab DocType link_to_type, Int2 numuid, Int4Ptr uids, Boolean mark_missing));
\par 
\par /**** Get Summaries ************************************/
\par 
\par DocSumPtr LIBCALL EntrezDocSum PROTO((DocType type, DocUid uid));
\par DocSumPtr LIBCALL DocSumFree PROTO((DocSumPtr dsp));
\par Int2 LIBCALL EntrezDocSumListGet PROTO((Int2 numuid, DocType type, DocUidPtr uids, DocSumListCallBack callback));
\par Int2 LIBCALL EntrezMlSumListGet PROTO((DocSumPtr PNTR result, Int2 numuid, Int4Ptr uids));
\par Int2 LIBCALL EntrezSeqSumListGet PROTO((DocSumPtr PNTR result, Int2 numuid, Int4Ptr uids));
\par 
\par /**** Get Term Lists ***********************************/
\par 
\par typedef Boolean (*TermListProc) PROTO((CharPtr term, Int4 special, Int4 total));
\par 
\par Int2 LIBCALL EntrezTermListByPage PROTO((DocType type, DocField field, Int2 page, Int2 numpage, TermListProc proc));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Int2 LIBCALL EntrezTermListByTerm PROTO((DocType type, DocField field, CharPtr term, Int2 numterms, TermListProc proc, Int2Ptr first_page));
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {
\par Boolean LIBCALL EntrezFindTerm PROTO((DocType type, DocField field, CharPtr term, Int4Ptr spcl, Int4Ptr totl));
\par 
\par /**** Look up terms with Boolean operations ************/
\par 
\par ValNodePtr LIBCALL EntrezTLNew PROTO((DocType type));
\par ValNodePtr LIBCALL EntrezTLAddTerm PROTO((ValNodePtr elst, CharPtr term, DocType type, DocField field, Boolean special));
\par ValNodePtr LIBCALL EntrezTLAddLParen PROTO((ValNodePtr elst));
\par ValNodePtr LIBCALL EntrezTLAddRParen PROTO((ValNodePtr elst));
\par ValNodePtr LIBCALL EntrezTLAddAND PROTO((ValNodePtr elst));
\par ValNodePtr LIBCALL EntrezTLAddOR PROTO((ValNodePtr elst));
\par ValNodePtr LIBCALL EntrezTLAddBUTNOT PROTO((ValNodePtr elst));
\par ValNodePtr LIBCALL EntrezTLFree PROTO((ValNodePtr elst));
\par LinkSetPtr LIBCALL EntrezTLEval PROTO((ValNodePtr elst));
\par 
\par /**** Look Up a Uid from a SeqId using the Terms list ****/
\par 
\par Int4 LIBCALL EntrezFindSeqId PROTO((SeqIdPtr sip));
\par 
\par /**** Get Sequence or MEDLINE data **********************/
\par 
\par Int2 LIBCALL EntrezSeqEntryListGet PROTO((SeqEntryPtr PNTR result, Int2 numuid, Int4Ptr uids, Int2 retcode, Boolean mark_missing));
\par SeqEntryPtr LIBCALL EntrezSeqEntryGet PROTO((Int4 uid, Int2 retcode));
\par 
\par Int2 LIBCALL EntrezMedlineEntryListGet PROTO((MedlineEntryPtr PNTR result, Int2 numuid, Int4Ptr uids, Boolean mark_missing));
\par MedlineEntryPtr LIBCALL EntrezMedlineEntryGet PROTO((Int4 uid));
\par 
\par #ifdef __cplusplus
\par \}
\par #endif
\par 
\par #endif
\par 
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431053}{\*\bkmkstart _Toc300649453}C Structures and Functions: casn.h{\*\bkmkend _Toc294431053}{\*\bkmkend _Toc300649453}
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {/* casn.h
\par * ===========================================================================
\par *
\par *                            PUBLIC DOMAIN NOTICE                          
\par *               National Center for Biotechnology Information
\par *                                                                          
\par *  This software/database is a "United States Government Work" under the   
\par *  terms of the United States Copyright Act.  It was written as part of    
\par *  the author's official duties as a United States Government employee and 
\par *  thus cannot be copyrighted.  This software/database is freely available 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  to the public for use. The National Library of Medicine and the U.S.    
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {*  Government have not placed any restriction on its use or reproduction.  
\par *                                                                          
\par *  Although all reasonable efforts have been taken to ensure the accuracy  
\par *  and reliability of the software and data, the NLM and the U.S.          
\par *  Government do not and cannot warrant the performance or results that    
\par *  may be obtained by using this software or data. The NLM and the U.S.    
\par *  Government disclaim all warranties, express or implied, including       
\par *  warranties of performance, merchantability or fitness for any particular
\par *  purpose.                                                                
\par *                                                                          
\par *  Please cite the author in any work or product based on this material.   
\par *
\par * ===========================================================================
\par *
\par * File Name: casn.h
\par *
\par * Author:  Greg Schuler
\par *
\par * Version Creation Date: 9/23/92
\par *
\par * $Revision: 2.5 $
\par *
\par * File Description:
\par \tab functions to decompress a compressed ASN,1 (CASN) file.
\par *
\par * Modifications:  
\par * --------------------------------------------------------------------------
\par * Date     Name        Description of modification
\par * -------  ----------  -----------------------------------------------------
\par * 04-21-93 Schuler     CASN_ReadBuff declared as LIBCALLBACK
\par * 06-28-93 Schuler     New function:  CASN_Seek()
\par *
\par * ==========================================================================
\par */
\par #ifndef __CompressedASN1__
\par #define __CompressedASN1__
\par 
\par #include <objsset.h>
\par 
\par #ifdef _cplusplus
\par extern "C" \{
\par #endif
\par 
\par enum CASN_Error\tab \{
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab CASN_ErrNone,\tab \tab \tab /* no error */
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {\tab CASN_ErrGeneric,\tab \tab /* general error, not one listed below */
\par \tab CASN_ErrMemory,\tab \tab \tab /* memory allocation failed */
\par \tab CASN_ErrBadHandle,\tab \tab /* CASN_Handle is invalid or corrupt */
\par \tab CASN_ErrFileOpen,\tab \tab /* unable to open file for reading */
\par \tab CASN_ErrFileCreate,\tab \tab /* unable to open file for writing */
\par \tab CASN_ErrFileRead,\tab \tab /* unable to read from open file */
\par \tab CASN_ErrFileWrite,\tab \tab /* unable to write to open file */
\par \tab CASN_ErrFileSeek,\tab \tab /* either seek or tell failed */
\par \tab CASN_ErrFileFormat \};\tab /* file format not recognized, or file corrupt */
\par 
\par enum CASN_DocType\tab \{
\par \tab CASN_TypeMed\tab = 1,\tab /* MEDLINE record (ASN.1 type Medline-entry)*/
\par \tab CASN_TypeSeq\tab = 2 \};\tab /* Sequence record (ASN.1 type Seq-entry)*/
\par 
\par struct casn_ioblock;
\par typedef struct casn_ioblock *CASN_Handle;
\par 
\par 
\par /* ----- high-level ----- */
\par CASN_Handle     LIBCALL  CASN_Open PROTO((CharPtr fname));
\par void            LIBCALL  CASN_Close PROTO((CASN_Handle handle)); 
\par AsnIoPtr        LIBCALL  CASN_GetAsnIoPtr PROTO((CASN_Handle handle));
\par Int2            LIBCALL  CASN_DocType PROTO((CASN_Handle handle));
\par Int4            LIBCALL  CASN_DocCount PROTO((CASN_Handle handle));
\par MedlineEntryPtr LIBCALL  CASN_NextMedlineEntry PROTO((CASN_Handle handle));
\par SeqEntryPtr     LIBCALL  CASN_NextSeqEntry PROTO((CASN_Handle handle));
\par int             LIBCALL  CASN_Seek PROTO((CASN_Handle,long offset,int origin));
\par 
\par /* ----- low-level ----- */
\par CASN_Handle LIBCALL  CASN_New PROTO((Int2 doc_type, Int2 huff_count));
\par void        LIBCALL  CASN_Free PROTO((CASN_Handle));
\par 
\par #ifdef _cplusplus
\par \}
\par #endif
\par 
\par #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {\sect }\sectd \sbkodd\linex0\endnhere\sectdefaultcl {\headerl \pard\plain \s24\sb240\widctlpar\tx1080\tx1440\tx2160\tqc\tx4320\tqr\tx8640\adjustright \b\f16\fs20\cgrid {\field{\*\fldinst {\b0 PAGE}}{\fldrslt {\b0 316}}}{\b0 \tab Vibrant}{
\par }}{\headerr \pard\plain \s24\qr\sb240\widctlpar\tx1080\tx1440\tx2880\tqc\tx4320\tx7920\adjustright \b\f16\fs20\cgrid {\b0 Vibrant   }{\field{\*\fldinst {\b0 page }}{\fldrslt {\b0 317}}}{\b0 
\par }}\pard\plain \s1\qc\sa360\pagebb\widctlpar\box\brdrdb\brdrw45\brsp80 \outlinelevel0\adjustright \b\f16\fs28\cgrid {\field{\*\fldinst {\b0\fs20 include vibrant.doc}}{\fldrslt {{\*\bkmkstart _Toc294431054}{\*\bkmkstart _Toc300649454}Vibrant User Interface Tools{\*\bkmkend _Toc294431054}{\*\bkmkend _Toc300649454}
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431055}{\*\bkmkstart _Toc300649455}Introduction{\*\bkmkend _Toc294431055}{\*\bkmkend _Toc300649455}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {VIBRANT is a high-level, multi-platform user interface development library designed and implemented by Jonathan Kans at NCBI. Due to popular demand it is now being distributed as part of the NCBI Software Development Kit, but should not be considered a "supported product" the way tools more closely tied to the NCBI databases are. Vibrant is designed to act as an intermediary between an application program and the underlying windowing system toolkit.  The philosophy behind Vibrant is that everything in the published user interface guidelines for the various windowing systems (i.e., the generic behavior of windows, menus, buttons, etc., to which all programs should conform) is taken care of automatically, without needing attention from the programmer.  The programmer can concentrate on the specific behavior of the application in response to manipulation of control objects without worrying about unexpected and undesired interaction between objects.  Vibrant frees the programmer from maintaining resource files, explicitly specifying the positions of objects, and writing an event loop.
\par A program written with Vibrant calls functions that create windows, menus, and the various graphical control objects that reside in them.  Typically, the first parameter to the function that creates a control is the parent object for that control.  The programmer may also write a "callback" function for a given object.  The name of the callback is typically passed as the last parameter to the object creation procedure.  When the user manipulates the object (and thus changes its "value"), the callback function is automatically executed.  In addition to such standard interface objects as windows, menus, buttons, lists, and text boxes, Vibrant provides a universal drawing object called a "slate."  A slate can contain one or more "panels."  Each panel can have instance-specific callbacks for click, drag, hold, release, and draw functions.  By using Vibrant's portable drawing functions in panels, an application can present arbitrarily complex drawings in a completely portable manner.
\par }\pard \sb240\widctlpar\adjustright {Modern graphical windowing interfaces have been largely responsible for the recent popularity of personal computers and workstations among the general public and in the business community.  In contrast to traditional command-line- or prompt-driven programs, applications that run on a contemporary personal computer allow the user to decide the order of execution of computational tasks.  The commands that are available under a given application are frequently displayed in a visible menu, so that the user does not need to remember esoteric acronyms or abbreviations or special function key codes.  Graphical objects that represent relevant physical or mathematical entities appear in windows on the display screen, and these objects can respond to the movements of a pointing device (a "mouse") in a manner analogous to physical manipulation of material objects in the real world.  The ease-of-use of these interfaces, in which learning a few skills allows the user to control many programs in a consistent manner, is especially important in molecular biology, where a given researcher may need to use many different programs on an occasional basis.
\par }\pard \sb240\widctlpar\adjustright {While windowing interfaces have made the user's job much easier, they have made the programmer's job much more difficult.  Because the user is placed in charge of the work flow, the program must continually check to see what the user is doing, and must respond appropriately.  Traditional programming for these interfaces requires the application developer to keep track of many interface implementation details.  The programmer needs to place each object at a specific position, must draw each object correctly upon request, and must make sure that objects in general do not interfere with each other while allowing certain desired interactions to occur.  This means that the cycle time for program development is long, and that even simple changes can require a lot of effort.  In addition, programs written for one operating environment need to be extensively rewritten to run on another platform.  Finally, the programmer must make the effort to become an expert in the use of the interface toolkits.
\par VIBRANT (Virtual Interface for Biological Research ANd Technology) is a portable user interface development library that has been written to allow new algorithms created by NCBI scientists to be quickly implemented and deployed to laboratory researchers as user-friendly computer programs.  As part of the NCBI Software Development Kit, it is written in the C language, and can be built on a variety of computers with their most popular compilers.  Programs written using the Vibrant interface will run on the graphically-oriented personal computers and workstations that are commonly found in many molecular biology laboratories.  In addition, an interface written with Vibrant can be created quickly and changed easily.  These features are particularly important in computer tools for molecular biology, since new problems suitable for computer solution and better algorithms for older problems appear rapidly as our understanding of the science progresses.
\par Vibrant is distinct from the native windowing systems or portable development toolkits in that it does not support the infinite variety of interface objects that could be created using those packages.  Instead, control objects are created by function call from a small repertoire of standard objects that are in common use.  Because of this compromise, Vibrant can internally handle all of the details necessary to fully implement its graphical control objects.  For example, creating a push button, and completely specifying its appearance and behavior, is done with the following function call and parameters:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par button = PushButton (parent, title, action);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The benefit of using Vibrant for building a program is that you can concentrate on writing code for the application functions, and need not worry about low-level interface messages or events.  A choice group in a sub menu could be replaced by a set of radio buttons or a scrolling list simply by calling different functions to create the objects.  With other packages such a program change would entail completely rewriting the code used to create the objects and detect and respond to user actions.  The limitation in using Vibrant is that you must be satisfied with "standard" behavior for all of your graphical control objects.  Some of the fancier interface techniques available only on one platform would generally not be available under Vibrant.
\par Since Vibrant is a functional interface, the programmer is no longer forced to pay attention to many low-level implementation details of visual interface objects (e.g., what radio button is set), and can simply be concerned with the values of the parameters these objects represent (e.g., what choice was made).  From the user's point of view, objects appear to have a logical, hierarchical relationship to one another (e.g., radio buttons always "belong" to a particular group in a particular window), and Vibrant takes advantage of this functional hierarchy by having the programmer explicitly specify the relationships to be created.  Objects are created with a single procedure call, and the call and its parameters are sufficient to make an object exist and define its generic behavior.  Vibrant also automatically positions and sizes visual objects.  Adding new objects to a program's interface imposes no extra burden in terms of code complexity.  This means that the cycle time for program development is short, and it encourages a programmer to make even major changes to the look and feel of a program in order to make it as ergonomic and useful as possible, since such changes are substantially less difficult to implement using Vibrant.
\par A program written with Vibrant is designed around functional subunits that can be called upon user request.  The programmer attaches such a "callback" function to a particular interface object, usually when the object is first created, and the callback is executed automatically when the user performs some appropriate action.  Programs are thus divided into the procedure calls to create objects and the callback functions to give objects their specific behaviors.  The callback structure of the interface is especially suited to user-driven programs.  The callback functions in a program may also need to change the appearance and responsiveness of various interface objects (or create new ones).  Several high-level procedures are available to manipulate objects, and include such self-explanatory functions as Show, Hide, Enable, Disable, Reset, SetTitle, and GetValue.  Because of the object-oriented internal design of the interface, these procedures can be applied to any object, including text boxes, push buttons, and menu choices.
\par Since Vibrant is a portable interface, the programmer no longer needs to master the complicated underlying toolkits for each interface.  Vibrant acts as a bridge between the high-level concepts of parameters (e.g., strings, numbers, choices, toggles) and the toolbox commands for the appropriate visual object on a particular machine.  Portable memory, string and file manipulation procedures are provided by the NCBI Software Development Kit core library.  Application programs using Vibrant currently run unchanged on the Macintosh, under Microsoft Windows on the PC, and on UNIX and VMS machines under OSF/Motif.
\par In addition to the standard interface objects (windows, menus, buttons, lists, and text boxes), Vibrant also supplies a universal drawing environment called a "slate."  A slate allows an application to present arbitrarily complex drawings in a completely portable manner.  Messages or events that are treated by other objects at the generic level (including drawing requests and mouse clicks) are converted by slates to application callback function calls in a platform-independent manner.  A slate can have one or more panels, and each panel can have instance-specific callbacks for click, drag, hold, release, and draw functions.  (The simplest version of a slate merges a slate and a panel in one object instance.)  Vibrant provides a variety of drawing procedures that can be used inside slates regardless of the machine that is actually being used.  A panel can be used to create a new object that solves a general problem (such as display of tabular text, or display of bitmap icons).  Since the slate allows multiple panels, you can combine these general building blocks (even superimpose them) to create a complex slate from simpler components.  This can be much more efficient than having to modify (and thus understand) a copy of the code for each component in order to make a custom object.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431056}{\*\bkmkstart _Toc300649456}Programming Example{\*\bkmkend _Toc294431056}{\*\bkmkend _Toc300649456}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The simple application in this section illustrates programming techniques for Vibrant.  Commentary on the use of Vibrant is interspersed with the code.  For the purposes of illustration, the callbacks, which are referenced in the setup portion, are declared at the end of the program.  Vibrant is built on top of the NCBI Software Development Kit core library.
\par The main application procedure in a Vibrant program is called Main.  Vibrant itself contains the C main function, which initializes the windowing system before calling the application Main.  The Main procedure should create the object hierarchy to be used for the program's interface, and should assign callback functions to appropriate objects.  Once Vibrant objects are created they persist until explicitly removed or until program termination.  A call to ProcessEvents should be at the end of Main, just before any cleanup and the return statement.  ProcessEvents will handle all events or messages from the underlying windowing system, and will trigger the execution of application callback functions when appropriate.  One callback function should call QuitProgram to allow the user to terminate the program.  The remaining callbacks should respond by performing computational services that the user has requested.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431057}{\*\bkmkstart _Toc300649457}Object Specification{\*\bkmkend _Toc294431057}{\*\bkmkend _Toc300649457}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The only header file that needs to be included is <vibrant.h>.  This will automatically include <ncbi.h>, which in turn includes the <ncbilcl.h> header specific for the current platform:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par #include <vibrant.h>
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Interface object data types are variants of Handle types.  Although these may be indirect pointers on the personal computers, they should only be used as parameters to Vibrant procedures, and should not be used with * or -> notation.  The last letter of each Vibrant object type is capitalized for easy identification.
\par The names of many Vibrant object types are self explanatory.  WindoW objects have no parents.  GrouP objects go inside windows or other groups.  Their main purpose is to automatically position their child objects, but they also allow a set of radio buttons to be referenced by an integer value (as are LisT, ChoicE and PopuP sets).  ButtoN, IcoN, LisT, PopuP, PrompT, RepeaT, SlatE, SwitcH, and TexT objects can go inside of groups or windows.  MenU objects belong to particular windows (or NULL on the Macintosh, in which case they are placed on the "desktop window"), and can contain IteM and ChoicE objects (as well as sub menus).  There are also portable types for FonT, PoinT, RecT, and RegioN:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static ButtoN  accept;\line static GrouP   category;\line static PaneL   drawing;\line static GrouP   features;\line static TexT    species;\line static ButtoN  check [4];\line static PoinT   lastPt;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Functions that are referenced before they are declared in a program must be prototyped by copying the function declaration and adding a semicolon to the end of the line.  Vibrant uses the ANSI style of C, in which the parameter list includes the type of each parameter:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void QuitProc (IteM i);\line static void EnableProc (GraphiC g);\line static void DrawProc (PaneL p);\line static void ClickProc (PaneL p, PoinT pt);\line static void DragProc (PaneL p, PoinT pt);\line static void AcceptProc (ButtoN b);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Main procedure returns an Int2, which is defined in <ncbilcl.h> as a 16-bit signed integer:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {extern Int2 Main (void)\line \line \{\line   GrouP   g;\line   IteM    i;\line   MenU    m;\line   PrompT  p;\line   WindoW  w;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Menus are installed on the desktop (on the Macintosh) or inside a given window (under Windows or Motif) by determining whether the platform symbols WIN_MAC, WIN_MSWIN or WIN_MOTIF are defined.  The first parameter to any object creation procedure (except for a window) is the parent object.  Thus, the File menu is created first (with the NULL parent specifying the desktop window in the case of the Macintosh), and its child items are created later.  The CommandItem procedure has its parent menu as its first parameter.  Note that CommandItem objects take an item action procedure callback (typedef void (*ItmActnProc) (IteM)) as an explicit parameter.  An action procedure is used to notify the program when the value of an object has changed, i.e., when the user has chosen the command item from the menu:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {#ifdef WIN_MAC\line   m = AppleMenu (NULL);\line   DeskAccGroup (m);\line   m = PulldownMenu (NULL, "File");\line   i = CommandItem (m, "Quit/Q", QuitProc);\line #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {For the FixedWindow procedure, the "-50, -33" for left and top means that the window will be centered horizontally on the screen and one third of the way down the screen.  The "-10, -10" for width and height mean that 10 pixels will separate objects on the window.  The string parameter is the window title, and the NULL is the close callback.  Whereas a DocumentWindow can be resized and dragged, a FixedWindow can only be dragged:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par   w = FixedWindow (-50, -33, -10, -10, "Observed Organisms", NULL);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {For non-Macintosh platforms, the menus go in a particular window, not on the desktop:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {#ifndef WIN_MAC\line   m = PulldownMenu (w, "File");\line   i = CommandItem (m, "Quit/Q", QuitProc);\line #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A StaticPrompt is a label that takes parameters for the parent group or window, text of the label, pixel width (0 will calculate the width of the string), pixel height (prompts are centered vertically if the height is greater than the line height), font, and justification ('l', 'c', or 'r' for left, centered, or right):
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par   p = StaticPrompt (w, "Species", 0, dialogTextHeight, systemFont, 'l');
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Advance function forces the next object to appear at the top of the next available column on the window.  (A hidden group (discussed below) could also be used to arrange objects.)  Objects are otherwise placed by default below the previous object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par   Advance (w);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A DialogText takes as parameters its parent group or window, the initial value of the edit text, the minimum number of character spaces to reserve, and a callback to be called whenever the text value of the edit box changes.  (Objects that take "character space" parameters also usually add a border of 8 pixels.  These functions will likely be changed to take pixel parameters, perhaps without automatically including additional border pixels.)  Select makes species the active (highlighted) text object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  species = DialogText (w, "", 15, (TxtActnProc) EnableProc);\line   Select (species);\line   Advance (w);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The DefaultButton triggers the callback when it is pressed, or when the Return key is hit, but Disable prevents this action from occurring for the present by graying out the button title:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  accept = DefaultButton (w, "Accept", AcceptProc);\line   Disable (accept);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The Break function forces the next object to appear at the left on the next available row of the window, below all previously placed objects, and resets the new "top" used by Advance:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {  Break (w);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A hidden group is created in order to nicely position the category and features groups and the drawing panel.  The "0, 3" means that objects in the hidden group should be laid out vertically (Y axis comes after X axis in these layout specifications), and that after every third object the next position should advance to the top of the next available column.  SetGroupMargins sets the horizontal and vertical pixel distances between the group boundary and its internal objects, and SetGroupSpacing sets the pixel distances between objects within a group:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  g = HiddenGroup (w, 0, 3, NULL);\line   SetGroupMargins (g, 3, 3);\line   SetGroupSpacing (g, 3, 2);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The RadioButton choices go into a group.  The radio buttons must be inside of a group for them to behave as a mutually exclusive set of choices, and the current choice is an integer property of the group.  The callback for the first group is the same as that for the dialog text box.  The initial value of the group is 0, meaning that no radio buttons are set.  The "5, 0" means that objects are laid out horizontally (X axis), and up to five objects may be placed on each line.  The RadioButton function does return a handle to the button, but only so that individual buttons in a group can be disabled or hidden.  The GetValue function should be used to determine which group member is set, rather than calling GetStatus for each button:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  category = NormalGroup (g, 5, 0, "Category", (GrpActnProc) EnableProc);\line   RadioButton (category, "Amphibian");\line   RadioButton (category, "Bird");\line   RadioButton (category, "Fish");\line   RadioButton (category, "Fungus");\line   RadioButton (category, "Lichen");\line   RadioButton (category, "Mammal");\line   RadioButton (category, "Mold");\line   RadioButton (category, "Plant");\line   RadioButton (category, "Reptile");
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The check boxes are inside of a group merely so that they will line up nicely by virtue of the group's automatic positioning of its children, and do not behave in a mutually exclusive manner.  The check boxes are initially off.  The SetStatus function can change the settings of check boxes:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  features = NormalGroup (g, 4, 0, "Features", NULL);\line   check [0] = CheckBox (features, "Camouflaged", NULL);\line   check [1] = CheckBox (features, "Motile", NULL);\line   check [2] = CheckBox (features, "Nocturnal", NULL);\line   check [3] = CheckBox (features, "Poisonous", NULL);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A simple panel is created to allow the user to sketch the organism, although this information will not be saved to a file.  Since the panel is in the hidden group, its width will be adjusted to be the same as that of its sibling objects (i.e., the category and features groups, overriding the width specification).  The simple panel contains a slate and a single panel in one object instance.  The SimplePanel callback parameter specifies the draw function for that panel.  Vibrant will call this application function whenever the drawing in the panel needs to be refreshed.  The SetPanelClick function assigns callbacks for responding to click, drag, hold, and release mouse actions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  drawing = SimplePanel (g, 100, 100, DrawProc);\line   SetPanelClick (drawing, ClickProc, DragProc, NULL, NULL);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, Main calls Show to make the window visible (and size it to its child objects if the window width and height parameters were negative), and calls ProcessEvents to give control to the user:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  Show (w);\line   ProcessEvents ();\line   return 0;\line \}
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431058}{\*\bkmkstart _Toc300649458}Callback Functions{\*\bkmkend _Toc294431058}{\*\bkmkend _Toc300649458}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The setup portion of this sample program referenced six callback procedures, QuitProc, EnableProc, AcceptProc, DrawProc, ClickProc, and DragProc, and then called ProcessEvents as its final act.  The remainder of the life span of the program consists of these callbacks automatically being executed in response to particular actions by the user:
\par The QuitProc callback calls the Vibrant QuitProgram function, which terminates Vibrant execution and exits the ProcessEvents loop to return to the program's Main function.  After Main returns, Vibrant will clean up its memory structures before returning to the operating system:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void QuitProc (IteM i)\line \line \{\line   QuitProgram ();\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The EnableProc (used as the action procedure of the species text and the category group) enables the accept button only if the species text is not blank and if a category has been chosen.  Since the procedure can be called with either a GrouP or a TexT parameter, the parameter is declared as a GraphiC, and the EnableProc name was cast to a GrpActnProc or a TxtActnProc when referenced:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void EnableProc (GraphiC g)\line \line \{\line   Char  str [32];\line \line   GetTitle (species, str, sizeof (str));\line   if (StringLen (str) == 0 || GetValue (category) == 0) \{\line     Disable (accept);\line   \} else \{\line     Enable (accept);\line   \}\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The panel draw callback is called whenever the drawing in the panel needs to be refreshed.  The DrawProc example callback frames a border around the drawing panel and draws a text label.  Since the draw callback may be triggered many times, the text label is drawn with DrawString rather than by creating a StaticPrompt object.  Unless a new font is selected, DrawString will use the pre-defined systemFont.  ObjectRect returns the bounding rectangle for any Vibrant object.  The current implementation does not save and refresh the drawing:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void DrawProc (PaneL p)\line \line \{\line   RecT  r;\line \line   ObjectRect (p, &r);\line   if (RectInRgn (&r, updateRgn)) \{\line     r.top += 6;\line     FrameRect (&r);\line     r.top -= 6;\line     r.left += 4;\line     r.right = r.left + StringWidth ("Picture") + 2;\line     r.bottom = r.top + stdLineHeight;\line     DrawString (&r, "Picture", 'l', FALSE);\line   \}\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The ClickProc responds to double clicking on the panel by using EraseRect to erase the current drawing.  The coordinates for the mouse position (pt parameter) is always relative to the parent window, with (0, 0) at the upper left of the window.  ObjectRect will return the rectangle of the panel in the same window-based coordinate system:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void ClickProc (PaneL p, PoinT pt)\line \line \{\line   RecT  r;\line \line   if (dblClick) \{\line     ObjectRect (p, &r);\line     r.top += stdLineHeight;\line     InsetRect (&r, 2, 2);\line     EraseRect (&r);\line   \}\line   lastPt = pt;\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The DragProc tracks the mouse on the panel, allowing the user to sketch an organism.  Checking for PtInRect is necessary on some platforms that do not automatically clip to restrict drawing to be within a given panel (all platforms now perform this clipping):
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void DragProc (PaneL p, PoinT pt)\line \line \{\line   RecT  r;\line \line   ObjectRect (p, &r);\line   r.top += stdLineHeight;\line   InsetRect (&r, 4, 4);\line   if (PtInRect (lastPt, &r) && PtInRect (pt, &r)) \{\line     DrawLine (lastPt, pt);\line   \}\line   lastPt = pt;\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The AcceptProc callback, triggered by pressing the accept button once it has been enabled, opens a file using the core library FileOpen function:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void AcceptProc (ButtoN b)\line \line \{\line   FILE  *f;\line   Int2  i;\line   RecT  r;\line   Char  str [32];\line   Int2  val;\line \line   f = FileOpen ("Organism", "a");\line   if (f != NULL) \{
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {It then prints the species and category to the file.  (The Motif version of Vibrant is not able to get the titles of buttons, list elements, or menu items.)  Note that for a group, the value is 0 if no choice has been made, and is 1 through n if a choice item is currently selected:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {    GetTitle (species, str, sizeof (str));\line     StringNCat (str, "\\t", sizeof (str) - 1);\line     WriteString (f, str);\line     val = GetValue (category);\line     GetItemTitle (category, val, str, sizeof (str));\line     WriteString (f, str););
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, it prints the chosen features to the file, and closes the file:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {    for (i = 0; i < CountItems (features); i++) \{\line       if (GetStatus (check [i])) \{\line         WriteChar (f, '\\t');\line         GetTitle (check [i], str, sizeof (str));\line         WriteString (f, str);\line       \}\line     \}\line     WriteLn (f);\line     FileClose (f);\line   \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {To reset for the next entry, it disables the accept button, clears and resets the species text, category group, and features check boxes, erases the drawing, and sets the input focus to the species text object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {  Disable (accept);\line   SetValue (category, 0);\line   for (i = 0; i < CountItems (features); i++) \{\line     SetStatus (check [i], FALSE);\line   \}\line   Select (drawing);\line   ObjectRect (drawing, &r);\line   r.top += stdLineHeight;\line   InsetRect (&r, 2, 2);\line   EraseRect (&r);\line   SetTitle (species, "");\line   Select (species);\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The actual dialog window, with the species, category and feature objects filled in, appears below:
\par 
\par }\pard \qc\sb240\widctlpar\adjustright {{\pict\wmetafile8\picw10265\pich7381\picwgoal5820\pichgoal4185 \bin54888  	  4k    k              Ñ   	       ˇˇˇ     k  C  Ã   Ñ    Ñ    (   Ñ                              ˇˇˇ ˇÃÃ Ãôô ÓÓÓ www                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP    UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P          UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P            P  P UP  U UU U  UP                                                                                                                                                            P            P  PP P U U U  U                                                                                                                                                             P            P  PP  P U U U  U                                                                                                                                                              P            P  PP  P U U U  UUU                                                                                                                                                            P            UU PP  P U U U  U U                                                                                                                                                            P          UPPPPP P U U UP U U UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P             PPP UP UU U U UPUP                                                                                                                                                             P             PP      P                                                                                                                                                                        P             UU P    P                                                                                                                                                                        P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P          UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                    UU                                                                                                                                         P            UUUUUU                                  P           UUUUUP                          UUUUUU                                     UUUUUP                                          P            P                                       P           P   P                          P                                         P   P                                          P            P       UU  UUPPPP UU  UUP U P UUP UUP UU  UUP      PP  P   U UP  U U U UP    P         UP U  P UUPP PP UUPP      PP  U   UP U U  UU PP UU  UUP UP        P            P      P PPPPPPPPPP U PPPPPP PPP    P  P  P   U U U P U U U     P        U U U U P U PPP PPPPP    P  P  U   U U U PPPPPPPPPP U        P            P      P  PPPPPPPPP U PPPPPP  PP     P P  P P U U U P U U U      P       U U U U   U PPP PPPPP     P P  U   U U U  UPPPPPPPPP U        P            P      P  PPPPPPPPP U PPPPPUUPPP     U  P  PU U U U P U U UUU    P       UU U U U   U PPP PPPPP     U  P  U   U U U U PPPPPPPP UP        P            P      P   UUPPPPPPPP U P UUPPPPPPP     U  P  PUUPU U U P U U U U    P      U U U U   U PPP PP UUPP     U  P  UUP U U U UP PPPPPPPPU         P            P      P   PPPPPPPP U P PPPPPPP     P P  UU UU U U P U U U U    P      UP U U U P U PPU PP PP     P P  U U U U U U PPPPPPPPPP        P            P      P   UU UUUU  UU PPUPP UU  UUP UU  UUP    P  P  UP U UP UU U U UP    P      U  UP U UPPPPUUU  UU P    P  P  U U UP U U  UU UU  UU PP UP        P            P      P P                   U P              P      PP  U   U     P   U        P      P          U                P      PP  U U                                     P            P       UU                    UP              P   P   P  P        P U U        P                 U                P   P   P  UUP     U                               P            UUUUUU                                                UUUUUP                          UUUUUU                                     UUUUUP                                          P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P            P  UP UU  U UU U  UP U                                                                                                                                                       P            P  U  U U P U U U  U  PP                                                                                                                                                      P            P  U   U U P U U U  U    UP                                                                                                                                                      P            P  UUU U U P U U U  UUU U                                                                                                                                                       P            UP U U UU P U U U  U U UP                                                                                                                                                       P          UPP  U U P U P U U UP U U U PUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P             P  UP UP UU U U UPUP U                                                                                                                                                        P             P          P                                                                                                                                                                      P             UU         P                                                                                                                                                                      P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P          UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P              UU                                           UP                         UU                          UP            U                                                            P             U  U                                         P P                       U  U                        P P           U                                                            P                P     P UUPPPPPPP UUPP          P      P   U UP U UU        P  P  P UUPPP P    P      U U UP UUP  U U U UP                                               P                P     PPPPPPPPPPPP          P      P   U U U U U U        P  P  PPPPP U     PUP   U U U  U U P U U U                                                P            P        PPPPPPPPPPPP              P  P P U U U U U U    P      P  PPPPP U     UUU P  U U U   U U P U U U                                                 P            P       UPPPPPPPPPPPPP              P  PU U U U U U U    P      P  PPPPP U     UUU P  U U UUU U U P U U UUU                                               P            P      UUP UUPPPPPPP UUPP              P  PUUPU U U U U U    P      UU P UUPPP U     UUU P  UUP U U U U P U U U U                                               P            P      UPUP PPPPPPP PP              P  UU UU U U U U U    P      PPP PPP U     UUU P  U U U U U U P U U U U                                               P                P  U  UP UU UUUU UUUU  UU P          P      UP U UP U UU        P  PPP UU UU UP    PUP   U U UP UUP UU U U UP                                               P                P  P  P                    P          P      U   U     U   U        P  PPP         U     P      U U         P   U                                                   P             U  U       P                    P          P P   P        U   U     U  U   UU P         U     P P   UUP         P U U                                                   P              UU                                           UP                         UU                          UP                                                                         P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                      UU                                                       P              UU              P                           UP                         UU                          UP                P             UU                                       P             U  U             P                          P P                       U  U                        P P                P            U  U                                      P                P  PPPPPUU PPPUU P UUPPP    P      UUP U U  UU           P  P  U U PP        P      U   UUPPP UUP UUP UP        P  UU U U PP UU PP              P                P  PPPPPPPPPPPPPPPPP    P      U U U U  U U           P  P  U PPPP        P      U  PPPPPPPP U        P  P  U U PPPP PPP              P            P      PPPPPPPPPPPPPPPPP        P  U U U U  U U       P      P  U  UPPP            P  U  PPPPPPPP U    P      P  U U  PPP  PP              P            P      PPPPPPPPPPPPPPPPP        P  U U U U  U U       P      P  U U PP            P  U  PPPPPPPP UP    P      P  U U  PPUUPPP              P            P      UUPPPPPPPPPPPP UUPPP        P  UUP U U  U U       P      UP U UP PP            P  UU PPPPPPPPU     P      P  U U  PPPPPP              P            P      PPPPPPPPPPPPP PPP        P  U U U UP U U       P      P  U U PPP            P  U  PPPPPPPPP    P      P  U U PPPPPPP              P                P  PPUUUU UU UU PUU P UU UU     P      U U U UPUU           P  P  U U UU         P      U  PPUU  UUPPP UP        P  P  U U UU  UU UU               P                P  PP          P    P                P      U U        U           P  P       P          P      U                             P  P       P                        P             U  U    UU           P  PP  P            P P   UUP U      U        U  U   UU U    P          P P   UUP                        U  U   P  U    P                        P              UU                                           UP                         UU                          UP                                UU                                       P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                                                                                                                                                                                               P                            UU         UU                                                                                                                                                      P                            P        P                                                                                                                                                     P                             P         P                                                                                                                                                     P             UU  UUP P UU  UUP UU P  UUP                                                                                                                                                     P            P PPP U P PPPPPP PP                                                                                                                                                     P            P  PP U P  PPPPP PP                                                                                                                                                     P            P  PP U UUPPPPPP PP                                                                                                                                                     P            P   UUP U PPPPPPP PP                                                                                                                                                     P          UPP   P U PPPPPPU PPUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU      P             P   UU UP UU  UUP UU PUPP                                                                                                                                                      P             P P     U                                                                                                                                                                          P              UU      U                                                                                                                                                                          P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                         UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU         P                                                                                                                                                        UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU        P                                                                                                                                                       UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP       P                                       UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP   UUP                             UU       P                                                                                                                                                  P   UPUUUUUUUUUUUUUUUUUUUUUUUUUUUUUPU       P                                                                                       P                                                          P  UPU                             UUP      P                                                                                       P                                                          P  UP                             PUP      P             P                                                                        P                                                          P  U                    U          PUP      P             P                                                                        P                                                          P  U                    U          PUP      P          U UU  UU  UP U UP U        UU P  UU  P UUPP UUP UP   UU  U U  UP U UP                                                          P  U     U U U  UP UP UUP  U     PUP      P          PPPPP PP U U  PP      P PP PP U PPPPP U   U U P U  U U U UP                                                          P  U     U U U PP U  U U P     PUP      P           PPPP  P  U U    UP      P  P PP U PPPPP U   U U P U  U U U UP                                                          P  U     U U U  P  U   U U P     PUP      P           UPPPUUPP  U UUU U       P  P PP U PPPPP UP   U U P U  U U UPP                                                          P  U     U U U  P  UUU U U P     PUP      P          U PPPPP  U U U UP       P  P PP U  UUPPPPU    UU P U  U U U UP                                                          P  U     UUU U  P  U U U U P     PUP      P          UP PPPPP U U U U P      P  U PP U  PPPPP   P U P UP U U U UP                                                          P  U     U U U PP U U U U P     PUP      P          U  UU  UU  UP U UP U       P  PU UU UP UU PPP UP   UP UU UPUP U UP                                                          P  U     U U U  UP UP UUP UU     PUP      P          U P                           P P        U     P              P           P                                                          P  U     U U                P     PUP      P          U             U               UU         U     P              P           P                                                          P  U     UP                P     PUP      P                                                                                       P                                                          P  U                               PUP      P                                                                                       P                                                          P  U                               PUP      P                                                                                       P                                                          P  UP                             PUP      P                                                                                                                                                  P  UPU                             UUP      P                                       UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP   UPUUUUUUUUUUUUUUUUUUUUUUUUUUUUUPU       P                                                                                                                                                       UUP                             UU       P                                                                                                                                                       UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP       P                                                                                                                                                        UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU        P                                                                                                                                                         UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU         P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P                                                                                                                                                                                                 P    UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUP    """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""%P    33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333UU3333333333333333333333333333333333333333333333333333333333333333333333333333333333333%P    3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333535S333333333333333333333333333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333333333333333333333333333333333333333333335S33333333333333333333333333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    33333333333333333333333333333333333333333333333333333333333335US3UUS35U33UU35S35US33UU33UUS333UU35S33UUS3UUS5S5S5S3US3U3U3U35U33333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333U3U3U3U3S5S5S3S5S35S535S3S5S5S335S5S5S35S5S5S5S5S5S5S53U3U3U3U3S5S333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    3333333333333333333333333333333333333333333333333333333333333U3U3U3U33US5S335S35S5S5S335S5S335S5S5S35S5S5S5S5S5S5S35U3U3U3U33US3333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333U3U3U3U35U35UUS5S35S5S5UUS5S5S335S5S5S35S5S5S5S5S5S5S3US3U3U3U35U3333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    3333333333333333333333333333333333333333333333333333333333333U3U3U3U3US35S5S5S35S5S5S5S5S5S335S5S5S35S5S3UUS5S5S5S5U33U3U3U3US33333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333U3U3U3U3U3S5S5S5U35S5S5S5S5S5S335S5S5U35S5S535S5S5S5S5S53U3U3U3U3S333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    3333333333333333333333333333333333333333333333333333333333333U3U3UUS35U33UU35SU5S5S3UU33UUS335S5S5SU3UUS3UU35UU35S3US3UUUUS35U33333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333U3U3U333333333333333333333335S335S5S333333333333333333333333333333333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    33333333333333333333333333333333333333333333333333333333333335US3U333333333333333333333335S333UU33333333333333335S33333333333333333333333333333333333333333333333333333333333333333333333333%P    DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDC333333333333333333333333333333333333333333333333333333333333333333333333DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD%P    33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%P    33333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333%P    %P    UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }}{
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431059}{\*\bkmkstart _Toc300649459}Reference{\*\bkmkend _Toc294431059}{\*\bkmkend _Toc300649459}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This section presents the various Vibrant graphic interface functions in some detail.  Although there are quite a few procedures, a number of them are variants of one another.  For example, all of the window creation functions are similar, differing only in the kinds of window controls generated (drag bars, grow regions, close boxes) and in their behavior (normal, modal dialog, or floating palette windows).  Buttons also differ in their behavior, with push buttons used to trigger commands, check boxes used as Boolean toggles, and radio buttons used to select from a mutually exclusive set of choices.  The visibility and functionality modifying functions (e.g., Show, Hide, Enable, Disable, Select) can be applied to any Vibrant graphic object.
\par Some procedures are menu item equivalents of similar button procedures.  For example, a PushButton and CommandItem are equivalent, as are a CheckBox and a StatusItem.  RadioButtons in a group are equivalent to ChoiceItems in a ChoiceGroup.  The "value" of a given object is manipulated by certain functions.  SetValue and GetValue use an integer value, and are appropriate for radio button groups, single choice lists, menu choice groups, and popup menu groups.  (The value 0 means no choice is selected, and the choices are numbered 1 through n.)  SetStatus and GetStatus use a Boolean value, and are appropriate for check boxes and status items.  SetItemStatus and GetItemStatus are used for the item values of multiple choice lists, which do not have individual Vibrant object handles.  SetTitle and GetTitle are used to manipulate the titles of windows, buttons, prompts, etc., and SetItemTitle and GetItemTitle are used to access list item titles.  (Changing or obtaining the title of an item is not always possible for certain objects on certain platforms.)
\par In situations where a user is expected to make a choice among a small number of items, it is frequently appropriate either to implement the choice as a group of radio buttons, as a menu choice group, or as a popup menu group.  If the number of choices can be quite large, or if the names of the actual choices can change each time the program is run, it may be wiser to implement the choice as a single choice list.
\par Certain design decisions will seem unnecessarily complex to people who are familiar with only one of the underlying windowing interfaces.  A case in point is the description of fonts.  On the Macintosh, selection of a font name, size, and style are independent operations.  Under Windows, a different font descriptor must be created for each combination of name, size, and style.  The portable solution in Vibrant was to create a FonT object that specifies one unique combination of name, size, and style, and to change fonts on each machine by calling SelectFont with the desired font object.  In addition, Windows and Motif do not perform garbage collection among allocated fonts, whereas Vibrant will do so.
\par Other design decisions will seem impossibly simple.  For example, by assigning one device context to each parent window in Windows, by having child windows use the parent's device context, and by keeping track of the "current" window and device context in static variables, the device context becomes the functional equivalent of the Macintosh port.  This allows the creation of the slate, the universal drawing environment, on otherwise very different graphics systems.  Vibrant's drawing functions do not need the current window as an explicit parameter, even though the underlying Windows toolbox calls do need to be told which device context to use.  Under Motif, each slate is a separate DrawingArea, and the current Xlib-level Window is also a hidden context variable.  Vibrant will perform garbage collection on Windows pens and brushes.
\par Be sure to read the appropriate declarations in <vibtypes.h>, <vibprocs.h> or <ncbidraw.h> to get a complete list of types, variables, functions and parameters when you are actually working with a particular section of the Vibrant library.  Also, you should become familiar with the types defined in the <ncbilcl.h> header, such as Int2, CharPtr, VoidPtr, and NULL.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431060}{\*\bkmkstart _Toc300649460}Object Data Types{\*\bkmkend _Toc294431060}{\*\bkmkend _Toc300649460}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {All Vibrant objects are referenced, as far as the compiler is concerned, by pointers to hidden data structures.  (In fact, on both the Macintosh and Microsoft Windows, these are in reality handles, which are pointers to pointers to data ("near" pointers to pointers on Windows).  When accessing the data structures, Vibrant internally "locks" the handles to get a pointer to the data and "unlocks" the handles when done.)  The base type is GraphiC, whose definition appears below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef struct Nlm_graphic \{\line   Nlm_VoidPtr  dummy;\line \} HNDL Nlm_GraphiC;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The standard object types are BaR, ButtoN, ChoicE, GrouP, IcoN, IteM, LisT, MenU, PaneL, PopuP, PrompT, RepeaT, SlatE, SwitcH, TexT and WindoW.
\par There are several important points to note.  First, in order to avoid conflicts with type or function names in the various windowing systems, all NCBI core library and Vibrant symbols are prefixed with "Nlm_".  For application programs, <vibrant.h> includes defines that add the prefix to every common symbol prior to compilation:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par #define GraphiC Nlm_GraphiC
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Second, note that for Vibrant objects, the last letter of each data type is capitalized.  This is the evolutionary remnant of a less general attempt at collision avoidance that was ultimately superseded by the Nlm_ prefix.  However, it does allow Vibrant objects to be identified at a glance.
\par Third, the HNDL symbol indicates that the object is a handle.  This symbol is defined in the <ncbilcl.h> file specific for each platform.  On the Macintosh it is simply "*", the general pointer definition.  Under Windows it is "_near *", indicating that it is a 16 bit pointer, which is size compatible with the 16 bit int currently used for a handle.  (The related symbol, PNTR, defines a 32 bit far pointer, which is returned by the core library MemNew memory allocation function.  Under Win32 and Windows NT, both pointers and handles are 32 bits, but PNTR and HNDL should still be used at this time.)  Although it is not safe practice to access the data to which the handle points by double indirection (or even single indirection), the definition of Vibrant object handles as (near) pointers to different dummy structures allows the compiler to distinguish, for example, a ButtoN from a ChoicE.  This means that the compiler can prevent an attempt to place a ButtoN in a MenU, but will allow a ChoicE group to be placed in a MenU.
\par Fourth, note that WindoW and GrouP are (handle-sized) pointers to the same dummy structure:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef struct Nlm_window \{\line   Nlm_VoidPtr  dummy;\line \} HNDL Nlm_GrouP, HNDL Nlm_WindoW;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This allows ButtoN, GrouP, IcoN, LisT, PopuP, PrompT, RepeaT, SlatE, SwitcH and TexT objects to be placed either at the main level of a window, or in a group within a window (or within another group), without having the compiler complain.  (A group has two major functions.  One is that it is the parent object for a group of radio buttons, and gives the set of buttons mutual exclusivity.  The other is that it automatically positions its child objects.  The application rarely has to worry about object layout.)
\par A WindoW is a top level object, and has no parent.  A MenU is placed inside a window (Vibrant considers the Macintosh desktop to be a window).  IteM and ChoicE objects can only go inside menus.  All other objects can go inside a window or inside a group within a window.
\par There are also other definitions for types that are not Vibrant graphic interface objects, but which may be used as parameters when creating such objects or when drawing using slates and panels.  These include FonT, PoinT, RecT and RegioN, which are needed because the equivalent underlying concepts are incompatible between different windowing systems.  FonT is defined as a handle to another dummy structure, and the other definitions are shown below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef struct Nlm_point \{\line   Nlm_Int2  x;\line   Nlm_Int2  y;\line \} Nlm_PoinT, PNTR Nlm_PointPtr;
\par \line typedef struct Nlm_rect \{\line   Nlm_Int2  left;\line   Nlm_Int2  top;\line   Nlm_Int2  right;\line   Nlm_Int2  bottom;\line \} Nlm_RecT, PNTR Nlm_RectPtr;
\par \line typedef Nlm_Handle Nlm_RegioN;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The remainder of this document will omit the Nlm_ prefix.  Function definitions will also omit the PROTO macro, which is used to allow compatibility with compilers that cannot accept parameter lists in prototypes.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431061}{\*\bkmkstart _Toc300649461}Callback Types{\*\bkmkend _Toc294431061}{\*\bkmkend _Toc300649461}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The callback functions for various objects are strictly typed.  The most used class, the action proc, has the handle to the calling object as the only parameter.  (There are separate callback function type definitions for each kind of object, since some compilers check types of function parameters, so only the "generic" typedefs are shown.)  The click proc is used by panels for the click, drag, hold and release callbacks, and includes the x and y coordinates of the mouse at the time of the call:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef void (*VoidProc) (void);\line typedef void (*KeyProc)  (Char);\line typedef void (*ActnProc) (GraphiC);\line typedef void (*ClckProc) (GraphiC, PoinT);\line typedef void (*ScrlProc) (BaR, GraphiC, Int2, Int2);\line typedef void (*ChngProc) (GraphiC, Int2, Int2);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The button action proc and panel click proc illustrate the actual specific callback types:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef void (*BtnActnProc) (ButtoN);\line typedef void (*PnlClckProc) (PaneL, PoinT);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431062}{\*\bkmkstart _Toc300649462}General Global Variables{\*\bkmkend _Toc294431062}{\*\bkmkend _Toc300649462}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {There are a number of useful global variables that are available in Vibrant.  screenRect holds the rectangular coordinates of the computer screen.  systemFont and programFont are predefined font variables.  stdAscent, stdDescent, stdLeading, stdFontHeight, stdLineHeight, and stdCharWidth are constants determined by applying the equivalent (capitalized) function to systemFont.  dblClick and shftKey may be set during list and panel clicks.  updateRgn and updateRect are set in response to panel draw (expose) events.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431063}{\*\bkmkstart _Toc300649463}Window Objects{\*\bkmkend _Toc294431063}{\*\bkmkend _Toc300649463}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Windows are the top level objects in Vibrant.  Document windows may be dragged and resized by the user.  Fixed and Round windows may be dragged but not resized.  Modal windows force the user to enter immediately needed information.  The first two parameters of all of the window creation functions determine the x and y position of the window on the screen.  If these parameter are negative, then the absolute value is used as the percentage of desktop space to be at the left of the window or above it.  The next two parameters specify the width and height of the window.  If these are negative, then the window form fits around its child objects when it is first shown, and the absolute value is the number of pixels to use as the border around and the spacing between the children.  Remaining possible parameters include the window title, a callback for responding to clicking in the close box, and a callback for responding to resizing of the window.  The full prototype for the FixedWindow function is shown below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {extern WindoW FixedWindow (Int2 left, Int2 top, Int2 width, Int2 height\line                            CharPtr title, WndActnProc close);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The remaining sections will omit the types of parameters except for the parent object.  The full prototype declarations may be found in the <vibprocs.h> header.  Other windows are:
\par }\pard\plain \s27\keepn\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {WindoW DocumentWindow (left, top, width, height, title, close, resize);\line WindoW FixedWindow    (left, top, width, height, title, close);\line WindoW FrozenWindow   (left, top, width, height, title, close);\line WindoW RoundWindow    (left, top, width, height, title, close);\line WindoW AlertWindow    (left, top, width, height, close);\line WindoW ModalWindow    (left, top, width, height, close);\line WindoW FloatingWindow (left, top, width, height, close);\line WindoW ShadowWindow   (left, top, width, height, close);\line WindoW PlainWindow    (left, top, width, height, close);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {On some platforms a window becomes "active" and available for manipulation when it is moved to the front of the other windows.  The SetActivate procedure assigns to a window a callback that is triggered when the window is activated, though this parameter may be added to the window creation functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SetActivate (WindoW w, act);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431064}{\*\bkmkstart _Toc300649464}Context Functions{\*\bkmkend _Toc294431064}{\*\bkmkend _Toc300649464}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Vibrant remembers the current window context of an application.  The following functions can be used to get and set the current context.  On Motif, setting the context for a panel in addition requires calling Select for that panel:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {WindoW CurrentWindow (void);\line void   UseWindow     (WindoW w);\line WindoW ParentWindow  (Handle obj);\line WindoW SavePort      (Handle obj);\line void   RestorePort   (WindoW w);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431065}{\*\bkmkstart _Toc300649465}Grouping Objects{\*\bkmkend _Toc294431065}{\*\bkmkend _Toc300649465}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Groups are used to control the positioning of objects within a window.  Groups can be placed in windows, or can be nested inside other groups.  In addition to positioning most classes of Vibrant interface objects, groups are used to reference a set of radio buttons and implement mutual exclusivity.  The width and height parameters determine the layout of child objects.  If the width parameter is positive and the height parameter is 0, objects are laid out horizontally, and the position Breaks to the next row after each set of n objects.  If the height parameter is positive, objects are laid out vertically, and the position Advances to the next column after n objects.  If width or height are negative, objects are laid out as above, but their borders are not aligned with one another.  If both width and height are 0, successive objects are placed at the same position.  In this case, you would typically hide all but one of the superimposed child objects at any given time, or you could call Advance or Break between objects, which would just give up the automatic alignment of items that the group would otherwise provide:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {GrouP NormalGroup (GrouP prnt, width, height, title, actn);\line GrouP HiddenGroup (GrouP prnt, width, height, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SetGroupMargins and SetGroupSpacing specify the borders between a group and its objects and the spacing between internal objects.  Measurements are in pixels:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void SetGroupMargins (GrouP g, xMargin, yMargin);\line void SetGroupSpacing (GrouP g, xSpacing, ySpacing);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431066}{\*\bkmkstart _Toc300649466}Button Objects{\*\bkmkend _Toc294431066}{\*\bkmkend _Toc300649466}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Buttons are created by PushButton, DefaultButton, CheckBox, or RadioButton.  A default button is a push button with a visible border that also responds to the return key.  The check box implements a Boolean toggle.  Changing the radio button selection turns off the previously-selected radio button and triggers the action callback of the parent group:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {ButtoN PushButton    (GrouP prnt, title, actn);\line ButtoN DefaultButton (GrouP prnt, title, actn);\line ButtoN CheckBox      (GrouP prnt, title, actn);\line ButtoN RadioButton   (GrouP prnt, title);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The CheckBox setting is manipulated with the GetStatus and SetStatus functions.  Radio buttons should not be accessed in this manner, but instead with the GetValue and SetValue functions applied to the parent group, which guarantee mutual exclusivity.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431067}{\*\bkmkstart _Toc300649467}List Objects{\*\bkmkend _Toc294431067}{\*\bkmkend _Toc300649467}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Scrolling lists may be single choice or multiple choice:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {LisT SingleList (GrouP prnt, width, height, actn);\line LisT MultiList  (GrouP prnt, width, height, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {List elements are appended to the end of a list with the ListItem function:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void ListItem (LisT prnt, title);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The single choice list has an integer value accessed by GetValue and SetValue, and is the functional equivalent of a group of radio buttons.  A multiple choice list is similar to a group of check boxes, but since each list item does not have its own handle, the settings are accessed with the GetItemStatus and SetItemStatus functions.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431068}{\*\bkmkstart _Toc300649468}Menu Objects{\*\bkmkend _Toc294431068}{\*\bkmkend _Toc300649468}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Menus can reside in a window menu bar, in the Macintosh desktop menu bar, or as a sub menu in another menu.  The Apple menu can be created on the Macintosh.  A parent window parameter of NULL specifies the desktop menu bar on the Macintosh.  SubMenu creates a menu item that controls a cascading sub menu, and takes a menu as its parent:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {MenU PulldownMenu (WindoW prnt, title);\line MenU AppleMenu    (WindoW prnt);\line MenU SubMenu      (MenU prnt, title);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Menus can contain items or choice groups.  The CommandItem is the equivalent of a push button, and the StatusItem is the equivalent of a check box:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {IteM CommandItem (MenU prnt, title, actn);\line IteM StatusItem  (MenU prnt, title, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Separator bars can be used to make the menu easier to read:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SeparatorItem (MenU prnt);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A choice group acts like a group of radio buttons or a single choice list.  As such, the value of the choice group should be accessed with GetValue and SetValue:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par ChoicE ChoiceGroup (MenU prnt, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Choice group items are appended to the end of a choice group with the ChoiceItem function.  The return value can be used to disable a choice item, but should not be used to access the status of the choice item:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par IteM ChoiceItem (ChoicE prnt, title);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431069}{\*\bkmkstart _Toc300649469}Popup Object{\*\bkmkend _Toc294431069}{\*\bkmkend _Toc300649469}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The PopupList is a choice group that can appear anywhere in a window.  On the Macintosh, the macLike parameter determines if the list drops down or pops up around the current selection, but this parameter may be eliminated in the future.  As with other choice groups, the popup list value should be accessed with GetValue and SetValue:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par PopuP PopupList (GrouP prnt, macLike, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Popup menu items are appended to the end of a popup list with the PopupItem function.  There is no return value, so the individual elements of a popup menu cannot be disabled:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void PopupItem (PopuP prnt, title);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431070}{\*\bkmkstart _Toc300649470}Prompt Object{\*\bkmkend _Toc294431070}{\*\bkmkend _Toc300649470}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The StaticPrompt is generally used as a label for a dialog text or a popup menu.  It can also be used to display a changing value on a window.  If the pixwidth parameter is 0, the width of the title string (plus two pixels) is used.  If the pixheight parameter is 0, the stdLineHeight value is used.  If the font specification is NULL, systemFont is used.  The just parameter is either 'l', 'c', or 'r', specifying the horizontal justification:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par PrompT StaticPrompt (GrouP prnt, title, pixwidth, pixheight, font, just);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The prompt is centered vertically around the pixheight value.  Passing the standard variables dialogTextHeight or popupMenuHeight ensures proper placement of the prompt next to these objects.  SetTitle can be used to change the string displayed by the prompt.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431071}{\*\bkmkstart _Toc300649471}Text Objects{\*\bkmkend _Toc294431071}{\*\bkmkend _Toc300649471}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {DialogText and PasswordText procedures accept a single line of text, while ScrollText is used for entering multiple lines of text.  The width, height, and charWidth parameters currently use stdCharWidth as their metric, but this may be changed to pixel values in the future:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {TexT DialogText   (GrouP prnt, dfault, charWidth, actn);\line TexT PasswordText (GrouP prnt, dfault, charWidth, actn);\line TexT ScrollText   (GrouP prnt, width, height, font, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SetTextSelect assigns callbacks to notify the application of changes in the selection range or focus, though these parameter may be added to the text creation functions in the future:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SetTextSelect (TexT t, slct, dslct);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {TextLength returns the number of characters currently in the text object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par Int2 TextLength (TexT t);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Knowledge of the active text and the selection range are useful for cutting and pasting:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {TexT CurrentText (void);\line void TextSelectionRange (TexT t, begin, end);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The cut, copy, paste and clear functions require the text object to be specified as a parameter:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void CutText   (TexT t);\line void CopyText  (TexT t);\line void PasteText (TexT t);\line void ClearText (TexT t);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431072}{\*\bkmkstart _Toc300649472}Scroll Bar Object{\*\bkmkend _Toc294431072}{\*\bkmkend _Toc300649472}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A scroll bar unconnected with a text or slate object can be placed on a window with the ScrollBar function.  Vibrant does not currently create scroll bars in a document window, though this may be implemented in the future.  If width is positive, the scroll bar is horizontal, and if height is positive, it is vertical.  The width and height parameters currently use stdCharWidth as the metric, though this will likely be changed to use pixels:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par BaR ScrollBar (GrouP prnt, width, height, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Scroll bar values are manipulated with GetValue and SetValue, which access the actual scroll bar thumb position.  In addition, a scroll bar must first be activated by calling the SetRange function, passing it the maximum value as well as the page up and page down values:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SetRange (Handle obj, pgUp, pgDn, max);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The scroll bar callback is triggered when the application program calls SetValue.  All other Vibrant objects call their callback only when the user, not the application, changes the value.  This is because the scroll bar is assumed to be controlling some non-standard object, whose appearance is changed in an application-specific manner.
\par In order to adjust the value of the scroll bar without triggering the callback, the CorrectBarValue function is provided.  The CorrectBarMax function changes the maximum value without needing to specify the page up and page down values, and CorrectBarPage changes the page up and down values:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void CorrectBarValue (BaR b, val);\line void CorrectBarMax   (BaR b, max);\line void CorrectBarPage  (BaR b, pgUp, pgDn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The application also gets the scroll bar callbacks for the AutonomousPanel and GeneralSlate objects.  The scroll callback for a panel will generally be written to call ScrollRect (to move lines that will remain visible, albeit in a different location in the panel), InvalRect (to flag as invalid any areas that need to be redrawn), and Update (to force the invalid areas to be immediately redrawn).
\par The application should take care that the scroll bar value is never greater than the maximum.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431073}{\*\bkmkstart _Toc300649473}Slate and Panel Objects{\*\bkmkend _Toc294431073}{\*\bkmkend _Toc300649473}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The slate is a universal drawing object.  A slate can contain one or more panels.  Each panel has an instance-specific callback for drawing, and can be assigned instance-specific callbacks for responding to mouse click, drag, hold, and release events.  A slate comes in two flavors.  One is a combination of a slate and a panel in a single object instance.  These panels are created with the following commands:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {PaneL SimplePanel     (GrouP prnt, pixwidth, pixheight, draw);\line PaneL AutonomousPanel (GrouP prnt, pixwidth, pixheight, draw,\line                        vscrl, hscrl, extra, reset, classPtr);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The mouse response callbacks are assigned by SetPanelClick:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SetPanelClick (PaneL p, click, drag, hold, release);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {For the autonomous panel, extra instance data can be appended to the object.  For example, the repeat button is implemented as an autonomous panel, and stores the button title and repeat action callback as extra data specific to each instance of a repeat button.  The extra data is retrieved and set by the GetPanelExtra and SetPanelExtra functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void GetPanelExtra (PaneL p, VoidPtr sptr);
\par void SetPanelExtra (PaneL p, VoidPtr sptr);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The other flavor of a slate has (usually multiple) panels as the children of a slate:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {SlatE ScrollSlate  (GrouP prnt, width, height);\line SlatE NormalSlate  (GrouP prnt, width, height);\line SlatE HiddenSlate  (GrouP prnt, width, height);\line SlatE GeneralSlate (GrouP prnt, width, height, scrl, extra, classPtr);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The VirtualSlate function fools the vertical scroll bar into acting as if it has a large range:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void VirtualSlate (SlatE s, before, after, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Panels inside these slates are created with CustomPanel or GeneralPanel:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {PaneL CustomPanel  (SlatE prnt, draw, extra, reset);\line PaneL GeneralPanel (SlatE prnt, draw, extra, reset, classPtr);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Panels must register their rectangles to let the parent slate know their dimensions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void RegisterRect (PaneL p, r);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Panels should also register rows and columns to the parent slate scroll bars.  The slate remembers the line offsets and line heights, calls SetRange to the slate scroll bars, and the default slate scroll callback issues ScrollRect and InvalRect commands as appropriate when the user scrolls:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void RegisterRow    (SlatE s, position, height, count);\line void RegisterColumn (SlatE s, position, width, count);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Slates may obtain the first line shown by calling GetOffset to the slate.  Panels may obtain the current pixel offset by calling GetOffset to the child panel:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void GetOffset (Handle obj, horiz, vert);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Finally, the vertical and horizontal scroll bars may be obtained from the slate.  The slate passes SetRange commands to its vertical scroll bar, but this became insufficient when horizontal scroll bars were added:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {BaR GetSlateVScrollBar (SlatE s);\line BaR GetSlateHScrollBar (SlatE s);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Child panels (CustomPanel or GeneralPanel) can be used to build higher level reusable objects.  (TablE and PalettE objects have been built to allow text and pictures to be easily displayed inside a slate.)  The panels can be superimposed to build complex behaviors out of simpler panels, without disrupting the code of the individual panels.  Panels are drawn first to last, so that the first one added to a slate appears at the rear of the slate.  Panels are checked for click responsiveness from last to first, so that the last one added behaves as if it were in front.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431074}{\*\bkmkstart _Toc300649474}Repeat Object{\*\bkmkend _Toc294431074}{\*\bkmkend _Toc300649474}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {RepeatButton takes a click proc as its callback, which is called for click and hold.  Even though it is implemented as a panel, and its callback has a mouse location parameter, it is otherwise close to a button in behavior.  The title can be changed with SetTitle:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par RepeaT RepeatButton  (GrouP prnt, title, actn);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431075}{\*\bkmkstart _Toc300649475}Switch Object{\*\bkmkend _Toc294431075}{\*\bkmkend _Toc300649475}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The switch object is used as a miniature scroll bar, with up and down arrows but no thumb or page areas.  It can optionally display a (non-editable) text representation of the value (e.g., "5/15"):
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {SwitcH UpDownSwitch (GrouP prnt, text, actn);\line SwitcH LeftRightSwitch (GrouP prnt, text, actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The value is manipulated with SetValue and GetValue.  The arrows will allow the user to set values from 1 through max.  SetSwitchParams will set both the max and the value at once, to avoid flickering by multiple redraws:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void SetSwitchMax (SwitcH s, Int2 max);\line Int2 GetSwitchMax (SwitcH s);\line void SetSwitchParams (SwitcH s, Int2 value, Int2 max);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431076}{\*\bkmkstart _Toc300649476}Icon Object{\*\bkmkend _Toc294431076}{\*\bkmkend _Toc300649476}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The IconButton is used to display arbitrary bitmap and drawing controls.  The draw callback should get the value of the icon button (with GetValue) to determine what to display, and should call ObjectRect to determine the rectangle of the icon object (in which it should draw).  The click, drag, hold and release mouse callbacks may use SetValue to change the appearance:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {IcoN IconButton  (GrouP prnt, pixwidth, pixheight, draw, inval,\line                   click, drag, hold, release);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Whenever SetValue is called, the inval callback is triggered.  If this parameter is NULL, the default invalidation procedure is called.  This obtains the object rectangle, insets it by one pixel, and invalidates the resulting rectangle.  The inval parameter is provided to allow the application to invalidate a different region, or to scroll the drawing, if that is more appropriate.  After the inval procedure is called, an Update is forced, calling the draw procedure if any part of the icon has been marked as invalid.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431077}{\*\bkmkstart _Toc300649477}Graphical Viewer Object{\*\bkmkend _Toc294431077}{\*\bkmkend _Toc300649477}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is a high level object written with an autonomous panel.  There are two header files that contain the typedefs and function prototypes for this package:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {#include <picture.h>\line #include <viewer.h>
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {You should read these header files to see the typedefs for the various callbacks.  The mouse responsiveness callbacks, in particular, take an extra parameter from those used directly with panels.
\par A picture is created as a tree of segment objects.  Picture segments are not Vibrant graphical objects, in that they cannot be placed into windows, groups, menus, etc., though their philosophy is very similar to the Vibrant group.  A segment can be given an integer ID that can refer to the program object which it represents.  It can also be told the maximum scale factor at which it will be visible (0 means always visible).  Given any segment, you can find its parent segment, and traverse up the hierarchy to the parent picture.
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {SegmenT CreatePicture  (void);\line SegmenT DeletePicture  (SegmenT picture);
\par SegmenT CreateSegment  (SegmenT parent, segID, maxScale);\line SegmenT ResetSegment   (SegmenT segment);
\par SegmenT ParentSegment  (SegmenT segment);\line Int2    SegmentID      (SegmenT segment);\line Boolean SegmentVisible (SegmenT segment);\line Int1    SegmentStyle   (SegmenT segment);\line void    SegmentBox     (SegmenT segment, box, mrg);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Picture items of various types (rectangles, lines, annotation objects such as symbols and labels, and attribute items that change color, shading, line width and style) are added to segments.  (Segments can also be added to other segments.)  Items are placed in a picture in "world coordinates", which are integer numbers that make sense to the domain being modeled.  The primitive items can contain an integer ID to be returned by FindSegment.
\par Rectangles and lines have must specify their full dimensions in world coordinates.  These items will change size when the picture is scaled in a viewer:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void AddRectangle (SegmenT parent, left, top, right, bottom,\line                    arrow, fill, primID);\line void AddLine      (SegmenT parent, pnt1X, pnt1Y, pnt2X, pnt2Y, arrow, primID);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Annotation objects are attached to a particular point in world coordinates.  They do not change size when the picture is scaled in a viewer, but their position changes depending upon where the point is mapped.  This means that label text will remain a constant font size even when the picture is scaled:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void AddSymbol (SegmenT parent, pntX, pntY, symbol, fill, align, primID);\line void AddBitmap (SegmenT parent, pntX, pntY, width, height,\line                 data, align,primID);\line void AddCustom (SegmenT parent, pntX, pntY, width, height,\line                 proc, align, primID);\line void AddMarker (SegmenT parent, pntX, pntY, length, orient, primID);\line void AddLabel  (SegmenT parent, pntX, pntY, string,
\par                 size, offset, align, primID);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The attribute item changes the color, line style, shading, pen width and drawing mode for subsequent items within a given segment.  The attributes do not effect subsequent items in any parent segments:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void AddAttribute (SegmenT parent, flags, color,\line                    linestyle, shading, penwidth, mode);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A viewer is created on a window or in a group.  A picture is then attached to the viewer.  The viewer is responsible for scaling (zooming) and panning (scrolling) the picture on the screen.  It converts from world coordinates to screen coordinates.  It also responds to mouse events, and can return the deepest segment that contains the item upon which the mouse was clicked.  The viewer width and height parameters are in pixels:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {VieweR CreateViewer (GrouP prnt, width, height, vscroll, hscroll);\line void   ResetViewer  (VieweR viewer);\line VieweR DeleteViewer (VieweR viewer)
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A picture is connected to a viewer by AttachPicture.  This function also specifies where a particular point in world coordinates should initially go on the screen, the scale factors (what number to divide a world coordinate by to get a pixel coordinate), and a draw procedure (for drawing on top of the viewer picture).  A scale parameter of 0 will cause the viewer to calculate the scale needed to show the entire picture at once.  You can also set the click, drag, release, and scrolling pan procedures, and attach extra instance data to the viewer:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void    AttachPicture  (VieweR viewer, picture, pntX, pntY,\line                         align, scaleX, scaleY, draw);\line void    SetViewerProcs (VieweR viewer, click, drag, release, pan);
\par void    SetViewerData  (VieweR viewer, data, cleanup);\line VoidPtr GetViewerData  (VieweR viewer);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {If you wish to respond to the user's scrolling, you should set the pan parameter to a callback in your program.  You can then call ViewerBox to get the current view parameters, including the world boundaries, the port boundaries, the view rectangle, and the X and Y scaling factors.  The port is the view rectangle (pixel rectangle in the viewer) mapped up onto world coordinates, and is always contained within the world boundaries:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void    ViewerBox      (VieweR viewer, world, port, view, scaleX, scaleY);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Printing the picture associated with a viewer is only partially implemented at this time:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void    PrintViewer    (VieweR viewer);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {During a click, drag, or release callback, FindSegment will return the deepest segment containing an object in which the mouse resides, and can return the integer segment ID and primitive ID assigned when the segment and its primitive item were created.  You can also show, hide, or highlight a segment:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void FindSegment      (VieweR viewer, pt, segID, primID);\line void ShowSegment      (VieweR viewer, segment);\line void HideSegment      (VieweR viewer, segment);\line void HighlightSegment (VieweR viewer, SegmenT segment, Int1 highlight);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {World and viewer coordinates can be interconverted with the following functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void MapWorldToViewer (VieweR viewer, pnt, pt);\line void MapViewerToWorld (VieweR viewer, pt, pnt);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {When you want to zoom, you call AttachPicture, passing the old viewer and picture, but giving new values for scaleX and scaleY.  This will recalculate boundary and scaling information, and display the picture at a new level of magnification.
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431078}{\*\bkmkstart _Toc300649478}Doc Object{\*\bkmkend _Toc294431078}{\*\bkmkend _Toc300649478}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {This is a high level object written with an autonomous panel.  It is meant as a (partial) general solution to the problems of displaying text and graphics.  You should read the header to see the callback typedefs and the column and paragraph data structures:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {\line #include <document.h>
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {When a document is created you give it the width and height in pixels.  This does not include the vertical scroll bar that is automatically created:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {DoC  DocumentPanel (GrouP prnt, pixwidth, pixheight);
\par void PrintDocument (DoC d);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void SaveDocument  (DoC d, f);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Paragraph items are appended to the document with AppendItem or AppendText.  AppendText is a special case that takes a pre-formatted text pointer.  AppendItem is a more general function that takes a data pointer and a print procedure.  The print procedure is called when the given paragraph needs to be displayed, printed, or saved:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void AppendItem (DoC d, proc, data, docOwnsData, lines, parFmt, colFmt, font);
\par void AppendText (DoC, text, parFmt, colFmt, font);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Document callback procedures are set in a similar manner to the graphical viewer object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void    SetDocProcs (DoC d, click, drag, release, pan, draw, gray, invert);
\par void    SetDocData  (DoC d, data, cleanup);
\par VoidPtr GetDocData  (DoC d);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The mouse point can be mapped to a paragraph item, row, and column, and parameters can be returned that apply to the document, item, or column levels:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void MapDocPoint   (DoC d, pt, item, row, col);
\par void GetDocParams  (DoC d, numItems, numLines);
\par void GetItemParams (DoC d, item, startsAt, numRows, numCols, lineHeight);
\par void GetColParams  (DoC d, item, col, pixPos, pixWidth, pixInset, just);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Two simple functions can be used to display a text file in a document object:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void DisplayFile  (DoC d, file, font);
\par void DisplayFancy (DoC d, file, parFmt, colFmt, font, tabStops);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431079}{\*\bkmkstart _Toc300649479}Class Functions{\*\bkmkend _Toc294431079}{\*\bkmkend _Toc300649479}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Class functions can be applied to any Vibrant graphical object.  (This does not include the FonT or SegmenT objects.  Even though each FonT or SegmenT refers to an element of a linked list maintained by Vibrant, the structures of these elements is different than Vibrant graphic control objects.  Class functions also cannot be applied to PoinT, RecT, or RegioN, which are simply descriptions of areas in a window.)  Several functions are used to control visibility and responsiveness of an object.  All objects except windows are set to be visible and enabled at the time of their creation.  A window must be explicitly shown in order for it and its children to become visible:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void Show    (Handle obj);\line void Hide    (Handle obj);\line void Enable  (Handle obj);\line void Disable (Handle obj);\line void Select  (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The program parameters that objects represent can have string, integer, or Boolean values:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void    SetTitle  (Handle obj, title);\line void    GetTitle  (Handle obj, title, maxsize);\line void    SetValue  (Handle obj, value);\line Int2    GetValue  (Handle obj);\line void    SetStatus (Handle obj, status);\line Boolean GetStatus (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SetRange controls a scroll bar (or slate vertical scroll bar) range.  SetValue and GetValue will access the actual scroll bar thumb position:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void SetRange (Handle obj, pgUp, pgDn, max);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {SetOffset and GetOffset of a slate, list, or scrolling text access the scroll bar values.  GetOffset of a slate returns the integer setting of the scroll bar (generally representing the number of the first line in view).  GetOffset of a panel child of a slate returns the pixel offset of the line, which is maintained by the slate:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void SetOffset (Handle obj, horiz, vert);\line void GetOffset (Handle obj, horiz, vert);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Reset and Remove reinitialize and delete objects.  These functions are automatically called for all objects at the end of the program:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void Reset  (Handle obj);\line void Remove (Handle obj);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431080}{\*\bkmkstart _Toc300649480}Miscellaneous Functions{\*\bkmkend _Toc294431080}{\*\bkmkend _Toc300649480}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Positioning of objects can be influenced with Advance and Break.  These are called automatically by the group layout function:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void Advance (Handle obj);\line void Break   (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The position in which the next object will be placed can be explicitly set and obtained controlled with the following commands:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void GetNextPosition (Handle obj, pt);\line void SetNextPosition (Handle obj, pt);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The bounding rectangle of any Vibrant graphical object is obtained with ObjectRect:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void ObjectRect (Handle obj, rct);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The number of items in a list or menu choice group can be obtained with CountItems:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par Int2 CountItems (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Whether an object is enabled or visible can be determined with Enabled or Visible.  An object will be unresponsive or invisible if it or any of its parent objects are disabled or hidden, even if it is flagged as visible and enabled:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Boolean Enabled (Handle obj);\line Boolean Visible (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The cursor can be set with the following commands:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void ArrowCursor (void);\line void CrossCursor (void);\line void IBeamCursor (void);\line void PlusCursor  (void);\line void WatchCursor (void);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {An application timer can be set with the Metronome function:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void Metronome (actn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The parent of an object can be traversed up the hierarchy.  The parent of a window is NULL:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par Handle Parent (Handle obj);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {ProcessEvents calls the main Vibrant event loop, and Update forces immediate redrawing:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void ProcessEvents (void);\line void Update        (void);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {AlignObjects may be used for objects within a window (or within a group that does not do automatic repositioning).  Objects should be cast to (HANDLE) (which is different than Handle), and the list must be terminated with NULL.  Alignment will adjust the margins of the target objects so that they line up vertically, by moving the appropriate margins to the maximum value of all margins.  ALIGN_LEFT will move the left margins, ALIGN_RIGHT will move the right margins, ALIGN_JUSTIFY will move both margins, and ALIGN_CENTER will center all objects:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void AlignObjects (Int2 align, ...);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Vibrant adds the following functions for file path manipulation.  These display file open and file save dialogs:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Boolean GetInputFileName (fileName, maxsize, extType, macType);\line Boolean GetOutputFileName (fileName, maxsize, dfault);
\par }\pard\plain \s3\li360\sb240\keep\keepn\widctlpar\outlinelevel2\adjustright \b\f16\cgrid {{\*\bkmkstart _Toc294431081}{\*\bkmkstart _Toc300649481}Graphical Drawing Functions{\*\bkmkend _Toc294431081}{\*\bkmkend _Toc300649481}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Drawing functions are provided for displaying graphics in a Vibrant panel.  (These may now also be used to draw on top of a viewer object.)  Most of these functions simply front-end for the equivalent procedures in the underlying toolkits.  However, some (e.g., CopyBits and ScrollRect) are quite complicated internally, doing much more than the toolkits provide.
\par Procedures for specifying the drawing mode, the color, the pen and brush patterns, and for framing or painting objects, are all independent, even if some of the underlying toolkits combine functions.  Drawing parameters are reset prior to each call to the panel drawing callback.  Coordinates are in pixels, with (0, 0) being the upper left corner of the parent window (not including the window border or frame).
\par There are four modes for drawing.  CopyMode and MergeMode are implemented on all platforms.  Copy mode will overwrite a destination area with the source data.  Drawing text in copy mode will show the text in foreground color on top of a rectangle in background color, regardless of what color had been there before.  MergeMode can be used to superimpose bitmaps of different colors (using CopyBits) to form a multicolored iconic picture.  Drawing text in merge mode will show the text in foreground color but won't change the background.  InvertMode can be used along with a Dotted pen for drawing "rubber band" lines:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void CopyMode   (void);\line void MergeMode  (void);\line void InvertMode (void);\line void EraseMode  (void);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Standard colors for drawing can be set, or an arbitrary color can be selected with one-byte values for red, green, and blue intensity.  InvertColors swaps foreground and background colors, to allow predictable highlighting to occur under various color models:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void Black        (void);\line void Red          (void);\line void Green        (void);\line void Blue         (void);\line void Cyan         (void);\line void Magenta      (void);\line void Yellow       (void);\line void White        (void);\line void Gray         (void);\line void LtGray       (void);\line void DkGray       (void);\line void SelectColor  (red, green, blue);\line void InvertColors (void);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The drawing pattern or dithering can be specified for brushes (painting functions), as can the width and style of a pen (framing functions).  Solid will restore the pen and brush patterns:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void Solid   (void);\line void Dark    (void);\line void Medium  (void);\line void Light   (void);\line void Empty   (void);\line void Dotted  (void);\line void Dashed  (void);\line void WidePen (width);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Fonts are created with GetFont (passing individual parameters) or with ParseFont (passing a string that is parsed and then sent to GetFont).  This returns a handle to an element of a font list maintained by Vibrant.  SelectFont sets that font for use in drawing text.  Vibrant will clean up the memory used for fonts after the application Main exits:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {FonT GetFont    (name, size, bld, itlc, undrln, fmly);\line FonT ParseFont  (spec);\line void SelectFont (font);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Available fonts differ between different windowing systems.  Typically, #ifdefs are used to specify fonts within the program code.  The string sent to ParseFont has the font name, the font size, and any of the characters 'b', 'i', or 'u', for bold, italic, or underline:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {#ifdef WIN_MAC\line   headingFont = ParseFont ("Monaco,9,b");\line   sequenceFont = ParseFont ("Monaco,9");\line #endif\line #ifdef WIN_MSWIN\line   headingFont = ParseFont ("Arial,11,b");\line   sequenceFont = ParseFont ("Courier,9");\line #endif\line #ifdef WIN_MOTIF\line   headingFont = ParseFont ("Helvetica,14,b");\line   sequenceFont = ParseFont ("Courier,12");\line #endif
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Points and rectangles can be loaded, compared, and manipulated.  OffsetRect will add dx to the left and right coordinates, and add dy to the top and bottom coordinates.  InsetRect will add dx to the left, subtract dx from the right, add dy to the top, and subtract dy from the bottom.  SectRect and UnionRect return the intersection and union, respectively, between two source rectangles.  Drawing functions may want to check RectInRgn against the updateRgn to determine if an object needs to be redrawn:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void    LoadPt     (pt, x, y);\line void    AddPt      (src, dst);\line void    SubPt      (src, dst);\line Boolean EqualPt    (pt1, pt2);\line void    LoadRect   (rct, lf, tp, rt, bt);\line void    OffsetRect (rct, dx, dy);\line void    InsetRect  (rct, dx, dy);\line Boolean SectRect   (src1, src2, dst);\line Boolean UnionRect  (src1, src2, dst);\line Boolean EqualRect  (r1, r2);\line Boolean EmptyRect  (rct);\line Boolean PtInRect   (pt, rct);\line Boolean PtInRgn    (pt, rgn);\line Boolean RectInRect (r1, r2);\line Boolean RectInRgn  (rct, rgn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Text metrics are returned for the currently selected font by the following functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {Int2 CharWidth    (ch);\line Int2 StringWidth  (text);\line Int2 TextWidth    (text, len);\line Int2 Ascent       (void);\line Int2 Descent      (void);\line Int2 Leading      (void);\line Int2 FontHeight   (void);\line Int2 LineHeight   (void);\line Int2 MaxCharWidth (void);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The pen position can be set and lines can be drawn with the following functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void SetPen   (pt);\line void GetPen   (pt);\line void MoveTo   (x, y);\line void LineTo   (x, y);\line void DrawLine (pt1, pt2);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Text strings may be painted (at the current pen location) or drawn (in a specified rectangle).  The minimum width of the rectangle should be StringWidth (text) + 2 pixels.  The justification parameter is 'l', 'c' or 'r' for left, centered, or right:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void PaintChar   (ch);\line void PaintString (text);\line void PaintText   (format, ...);\line void DrawString  (rct, text, jst, gray);\line void DrawText    (rct, text, len, jst, gray);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Rectangles, ovals, round rectangles, arcs, and polygons may generally be framed (drawn in outline) and painted (filled in), and on some platforms can also be erased and inverted.
\par Rectangles are drawn with the following functions:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void EraseRect  (rct);\line void FrameRect  (rct);\line void PaintRect  (rct);\line void InvertRect (rct);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Ovals or ellipses are fitted to the bounding rectangle:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void EraseOval  (rct);\line void FrameOval  (rct);\line void PaintOval  (rct);\line void InvertOval (rct);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Round rectangles are not implemented on all systems:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void EraseRoundRect  (rct, ovlWid, ovlHgt);\line void FrameRoundRect  (rct, ovlWid, ovlHgt);\line void PaintRoundRect  (rct, ovlWid, ovlHgt);\line void InvertRoundRect (rct, ovlWid, ovlHgt);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Arcs take a rectangle and draw counter clockwise from the line between the starting point and the center to the line between the ending point and the center:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void EraseArc  (rct, start, end);\line void FrameArc  (rct, start, end);\line void PaintArc  (rct, start, end);\line void InvertArc (rct, start, end);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Polygons take a pointer to an array of PoinTs, and will always form a closed polygon.  Painting is done using the Even-Odd Rule (as opposed to the Winding Rule, which is not available on all platforms).  This means that if the lines connecting the points cross, some areas will be painted and other adjacent areas will not be painted:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void ErasePoly  (num, pts);\line void FramePoly  (num, pts);\line void PaintPoly  (num, pts);\line void InvertPoly (num, pts);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Regions, lists of rectangular areas treated as a group, are manipulated and drawn with the following functions.  Functions that take a destination region (e.g., SectRgn, UnionRgn) must be passed an existing region, and will not create one if NULL is supplied.  Most programs will not need to be concerned with regions, other than to check RectInRgn against the updateRgn:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {RegioN  CreateRgn   (void);\line RegioN  DestroyRgn  (rgn);\line void    ClearRgn    (rgn);\line void    LoadRectRgn (rgn, lf, tp, rt, bt);\line void    OffsetRgn   (rgn, dx, dy);\line void    SectRgn     (src1, src2, dst);\line void    UnionRgn    (src1, src2, dst);\line void    DiffRgn     (src1, src2, dst);\line void    XorRgn      (src1, src2, dst);\line Boolean EqualRgn    (rgn1, rgn2);\line Boolean EmptyRgn    (rgn);\line void    EraseRgn  (rgn);\line void    FrameRgn  (rgn);\line void    PaintRgn  (rgn);\line void    InvertRgn (rgn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Clipping restricts the area on the window in which drawing commands will be honored.  Invalidation marks areas of the window to be erased and redrawn at the next update:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void ClipRect  (rct);\line void ClipRgn   (rgn);\line void ResetClip (void);\line void ValidRect (rct);\line void InvalRect (rct);\line void ValidRgn  (rgn);\line void InvalRgn  (rgn);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {A rectangular area can be scrolled with the ScrollRect function.  The area of the rectangle that will need to be updated is automatically invalidated, but if an application does not draw objects that would be partially visible, it may need to invalidate the (scrolled) areas that would have contained parts of objects when the objects in those areas become fully visible:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void ScrollRect (rct, dx, dy);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Bitmaps (icons) can be displayed with the CopyBits function (which performs a toolbox BitBlt operation).  The source is a VoidPtr to an array of bits in memory, where 1 means foreground color and 0 means background color.  Under Windows, a copy is made, and the bits are inverted.  Under Motif, a copy is made, and the bytes are rotated so that the last significant and most significant bits are reversed:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {
\par void CopyBits (rct, source);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The following bitmap represents a 16-bit-wide downward arrow.  The 1 bits specify foreground color, the 0 bits background color, and the most significant bit in a byte is drawn at the left.  Bitmaps should be declared as Uint1s (to avoid byte order problems between different machines), and the width should be in multiples of 2 bytes, even though the CopyBits rectangle can clip to less than 8 bits.  Bitmaps should be declared outside of functions, since some compilers hang when trying to initialize large internal arrays:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static Uint1  downArrow [] = \{\line   0x1C, 0x00, 0x1C, 0x00,\line   0x1C, 0x00, 0x1C, 0x00,\line   0x1C, 0x00, 0x1C, 0x00,\line   0x7F, 0x00, 0x3E, 0x00,\line   0x1C, 0x00, 0x08, 0x00\line \};
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The following function will draw the downward arrow in the center of a panel.  The arrow will be drawn in the currently selected foreground color, and using the current mode:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {static void DrawDownArrow (PaneL p)\line \line \{\line   RecT  r;\line \line   ObjectRect (p, &r);\line   r.left = (r.left + r.right) / 2 - 8;\line   r.right = r.left + 16;\line   r.top = (r.top + r.bottom) / 2 - 5;\line   r.bottom = r.top + 10;\line   CopyBits (&r, downArrow);\line \}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Complex iconic pictures can be drawn by repeated calls to CopyBits using the same target rectangle and using MergeMode to superimpose different bitmaps in different colors.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431082}{\*\bkmkstart _Toc300649482}Index{\*\bkmkend _Toc294431082}{\*\bkmkend _Toc300649482}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Vibrant types are listed below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef struct point \{\line   Int2  x;\line   Int2  y;\line \} PoinT, PNTR PointPtr;
\par \line typedef struct rect \{\line   Int2  left;\line   Int2  top;\line   Int2  right;\line   Int2  bottom;\line \} RecT, PNTR RectPtr;
\par \line typedef Handle RegioN;
\par \line typedef struct font \{\} HNDL FonT;
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Types of Vibrant graphic objects that can be created are as follows:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {BaR\line ButtoN\line ChoicE\line DoC\line GrouP\line IcoN\line IteM\line LisT\line MenU\line PaneL\line PopuP\line PrompT\line RepeaT\line SlatE\line SwitcH\line TexT\line VieweR\line WindoW
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {Generic callback types are shown below:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {typedef void (*VoidProc) (void);\line typedef void (*KeyProc)  (Char);\line typedef void (*ActnProc) (GraphiC);\line typedef void (*ClckProc) (GraphiC, PoinT);\line typedef void (*ScrlProc) (BaR, GraphiC, Int2, Int2);\line typedef void (*ChngProc) (GraphiC, Int2, Int2);
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The section lists all of the functions presented above in alphabetical order:
\par }\pard\plain \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright \f2\fs18\cgrid {void    AddAttribute       (SegmenT parent, flags, color,\line                             linestyle, shading, penwidth, mode);
\par void    AddBitmap          (SegmenT parent, pntX, pntY, width,\line                             height, data, align, primID);
\par void    AddCustom          (SegmenT parent, pntX, pntY, width,\line                             height, proc, align, primID);
\par void    AddLabel           (SegmenT parent, pntX, pntY, string,\line                             size, offset, align, primID);
\par void    AddLine            (SegmenT parent, pnt1X, pnt1Y,\line                             pnt2X, pnt2Y, arrow, primID);
\par void    AddMarker          (SegmenT parent, pntX, pntY,\line                             length, orient, primID);
\par void    AddPt              (src, dst);
\par void    AddRectangle       (SegmenT parent, left, top, right,\line                             bottom, arrow, fill, primID);
\par void    AddSymbol          (SegmenT parent, pntX, pntY,\line                             symbol, fill, align, primID);
\par void    Advance            (Handle obj);
\par WindoW  AlertWindow        (left, top, width, height, close);
\par void    AlignObjects       (Int2 align, ...);
\par void    AppendItem         (DoC d, proc, data, docOwnsData, lines,\line                             parFmt, colFmt, font);
\par void    AppendText         (DoC, text, parFmt, colFmt, font);
\par MenU    AppleMenu          (WindoW prnt);
\par void    ArrowCursor        (void);
\par Int2    Ascent             (void);
\par void    AttachPicture      (VieweR viewer, picture, pntX, pntY,
\par                             align, scaleX, scaleY, draw);
\par PaneL   AutonomousPanel    (GrouP prnt, pixwidth, pixheight, draw,\line                             vscrl, hscrl, extra, reset, classPtr);
\par 
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    Black              (void);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    Blue               (void);
\par void    Break              (Handle obj);
\par 
\par Int2    CharWidth          (ch);
\par ButtoN  CheckBox           (GrouP prnt, title, actn);
\par ChoicE  ChoiceGroup        (MenU prnt, actn);
\par IteM    ChoiceItem         (ChoicE prnt, title);
\par void    ClearRgn           (rgn);
\par void    ClearText          (TexT t);
\par void    ClipRect           (rct);
\par void    ClipRgn            (rgn);
\par IteM    CommandItem        (MenU prnt, title, actn);
\par void    CopyBits           (rct, source);
\par void    CopyMode           (void);
\par void    CopyText           (TexT t);
\par void    CorrectBarMax      (BaR b, max);
\par void    CorrectBarPage     (BaR b, pgUp, pgDn);
\par void    CorrectBarValue    (BaR b, val);
\par Int2    CountItems         (Handle obj);
\par SegmenT CreatePicture      (void);
\par RegioN  CreateRgn          (void);
\par SegmenT CreateSegment      (SegmenT parent, segID, maxScale);
\par VieweR  CreateViewer       (GrouP prnt, width, height, vscroll, hscroll);
\par void    CrossCursor        (void);
\par TexT    CurrentText        (void);
\par WindoW  CurrentWindow      (void);
\par PaneL   CustomPanel        (SlatE prnt, draw, extra, reset);
\par void    CutText            (TexT t);
\par void    Cyan               (void);
\par 
\par void    Dark               (void);
\par void    Dashed             (void);
\par ButtoN  DefaultButton      (GrouP prnt, title, actn);
\par SegmenT DeletePicture      (SegmenT picture);
\par VieweR  DeleteViewer       (VieweR viewer)
\par Int2    Descent            (void);
\par RegioN  DestroyRgn         (rgn);
\par TexT    DialogText         (GrouP prnt, dfault, charWidth, actn);
\par void    DiffRgn            (src1, src2, dst);
\par void    Disable            (Handle obj);
\par void    DisplayFancy       (DoC d, file, parFmt, colFmt, font, tabStops);
\par void    DisplayFile        (DoC d, file, font);
\par void    DkGray             (void);
\par DoC     DocumentPanel      (GrouP prnt, pixwidth, pixheight);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {WindoW  DocumentWindow     (left, top, width, height, title, close, resize);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    Dotted             (void);
\par void    DrawLine           (pt1, pt2);
\par void    DrawString         (rct, text, jst, gray);
\par void    DrawText           (rct, text, len, jst, gray);
\par 
\par void    Empty              (void);
\par Boolean EmptyRect          (rct);
\par Boolean EmptyRgn           (rgn);
\par void    Enable             (Handle obj);
\par Boolean Enabled            (Handle obj);
\par Boolean EqualPt            (pt1, pt2);
\par Boolean EqualRect          (r1, r2);
\par Boolean EqualRgn           (rgn1, rgn2);
\par void    EraseArc           (rct, start, end);
\par void    EraseMode          (void);
\par void    EraseOval          (rct);
\par void    ErasePoly          (num, pts);
\par void    EraseRect          (rct);
\par void    EraseRgn           (rgn);
\par void    EraseRoundRect     (rct, ovlWid, ovlHgt);
\par 
\par void    FindSegment        (VieweR viewer, pt, segID, primID);
\par WindoW  FixedWindow        (left, top, width, height, title, close);
\par WindoW  FloatingWindow     (left, top, width, height, close);
\par Int2    FontHeight         (void);
\par void    FrameArc           (rct, start, end);
\par void    FrameOval          (rct);
\par void    FramePoly          (num, pts);
\par void    FrameRect          (rct);
\par void    FrameRgn           (rgn);
\par void    FrameRoundRect     (rct, ovlWid, ovlHgt);
\par WindoW  FrozenWindow       (left, top, width, height, title, close);
\par 
\par PaneL   GeneralPanel       (SlatE prnt, draw, extra, reset, classPtr);
\par SlatE   GeneralSlate       (GrouP prnt, width, height, scrl, extra, classPtr);
\par FonT    GetFont            (name, size, bld, itlc, undrln, fmly);
\par void    GetColParams       (DoC d, item, col, pixPos, pixWidth,\line                             pixInset, just);
\par VoidPtr GetDocData         (DoC d);
\par void    GetDocParams       (DoC d, numItems, numLines);
\par void    GetItemParams      (DoC d, item, startsAt, numRows,\line                             numCols, lineHeight);
\par Boolean GetInputFileName   (fileName, maxsize, extType, macType);
\par void    GetNextPosition    (Handle obj, pt);
\par void    GetOffset          (Handle obj, horiz, vert);
\par Boolean GetOutputFileName  (fileName, maxsize, dfault);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    GetPanelExtra      (PaneL p, VoidPtr sptr);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    GetPen             (pt);
\par BaR     GetSlateHScrollBar (SlatE s);
\par BaR     GetSlateVScrollBar (SlatE s);
\par Boolean GetStatus          (Handle obj);
\par Int2    GetSwitchMax       (SwitcH s);
\par void    GetTitle           (Handle obj, title, maxsize);
\par Int2    GetValue           (Handle obj);
\par VoidPtr GetViewerData      (VieweR viewer);
\par void    Gray               (void);
\par void    Green              (void);
\par 
\par GrouP   HiddenGroup        (GrouP prnt, width, height, actn);
\par SlatE   HiddenSlate        (GrouP prnt, width, height);
\par void    Hide               (Handle obj);
\par void    HideSegment        (VieweR viewer, segment);
\par void    HighlightSegment   (VieweR viewer, SegmenT segment, Int1 highlight);
\par 
\par void    IBeamCursor        (void);
\par IcoN    IconButton         (GrouP prnt, pixwidth, pixheight, draw, inval,\line                             click, drag, hold, release);
\par void    InsetRect          (rct, dx, dy);
\par void    InvalRect          (rct);
\par void    InvalRgn           (rgn);
\par void    InvertArc          (rct, start, end);
\par void    InvertColors       (void);
\par void    InvertMode         (void);
\par void    InvertOval         (rct);
\par void    InvertPoly         (num, pts);
\par void    InvertRect         (rct);
\par void    InvertRgn          (rgn);
\par void    InvertRoundRect    (rct, ovlWid, ovlHgt);
\par 
\par Int2    Leading            (void);
\par SwitcH  LeftRightSwitch    (GrouP prnt, text, acrn);
\par void    Light              (void);
\par Int2    LineHeight         (void);
\par void    LineTo             (x, y);
\par void    ListItem           (LisT prnt, title);
\par void    LoadPt             (pt, x, y);
\par void    LoadRect           (rct, lf, tp, rt, bt);
\par void    LoadRectRgn        (rgn, lf, tp, rt, bt);
\par void    LtGray             (void);
\par 
\par void    Magenta            (void);
\par void    MapDocPoint        (DoC d, pt, item, row, col);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    MapViewerToWorld   (VieweR viewer, pt, pnt);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    MapWorldToViewer   (VieweR viewer, pnt, pt);
\par Int2    MaxCharWidth       (void);
\par void    Medium             (void);
\par void    MergeMode          (void);
\par void    Metronome          (actn);
\par WindoW  ModalWindow        (left, top, width, height, close);
\par void    MoveTo             (x, y);
\par LisT    MultiList          (GrouP prnt, width, height, actn);
\par 
\par GrouP   NormalGroup        (GrouP prnt, width, height, title, actn);
\par SlatE   NormalSlate        (GrouP prnt, width, height);
\par 
\par void    ObjectRect         (Handle obj, rct);
\par void    OffsetRect         (rct, dx, dy);
\par void    OffsetRgn          (rgn, dx, dy);
\par 
\par void    PaintArc           (rct, start, end);
\par void    PaintChar          (ch);
\par void    PaintOval          (rct);
\par void    PaintPoly          (num, pts);
\par void    PaintRect          (rct);
\par void    PaintRgn           (rgn);
\par void    PaintRoundRect     (rct, ovlWid, ovlHgt);
\par void    PaintString        (text);
\par void    PaintText          (format, ...);
\par Handle  Parent             (Handle obj);
\par SegmenT ParentSegment      (SegmenT segment);
\par WindoW  ParentWindow       (Handle obj);
\par FonT    ParseFont          (spec);
\par TexT    PasswordText       (GrouP prnt, dfault, charWidth, actn);
\par void    PasteText          (TexT t);
\par WindoW  PlainWindow        (left, top, width, height, close);
\par void    PlusCursor         (void);
\par void    PopupItem          (PopuP prnt, title);
\par PopuP   PopupList          (GrouP prnt, macLike, actn);
\par void    PrintDocument      (DoC d);
\par void    PrintViewer        (VieweR viewer);
\par void    ProcessEvents      (void);
\par Boolean PtInRect           (pt, rct);
\par Boolean PtInRgn            (pt, rgn);
\par MenU    PulldownMenu       (WindoW prnt, title);
\par ButtoN  PushButton         (GrouP prnt, title, actn);
\par 
\par ButtoN  RadioButton        (GrouP prnt, title);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean RectInRect         (r1, r2);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {Boolean RectInRgn          (rct, rgn);
\par void    Red                (void);
\par void    RegisterColumn     (SlatE s, position, width, count);
\par void    RegisterRect       (PaneL p, r);
\par void    RegisterRow        (SlatE s, position, height, count);
\par void    Remove             (Handle obj);
\par RepeaT  RepeatButton       (GrouP prnt, title, actn);
\par void    Reset              (Handle obj);
\par void    ResetClip          (void);
\par SegmenT ResetSegment       (SegmenT segment);
\par void    ResetViewer        (VieweR viewer);
\par void    RestorePort        (WindoW w);
\par WindoW  RoundWindow        (left, top, width, height, title, close);
\par 
\par void    SaveDocument       (DoC d, f);
\par WindoW  SavePort           (Handle obj);
\par BaR     ScrollBar          (GrouP prnt, width, height, actn);
\par void    ScrollRect         (rct, dx, dy);
\par SlatE   ScrollSlate        (GrouP prnt, width, height);
\par TexT    ScrollText         (GrouP prnt, width, height, font, actn);
\par Boolean SectRect           (src1, src2, dst);
\par void    SectRgn            (src1, src2, dst);
\par void    SegmentBox         (SegmenT segment, box, mrg);
\par Int2    SegmentID          (SegmenT segment);
\par Int1    SegmentStyle       (SegmenT segment);\line Boolean SegmentVisible     (SegmenT segment);\line void    Select             (Handle obj);
\par void    SelectColor        (red, green, blue);
\par void    SelectFont         (font);
\par void    SeparatorItem      (MenU prnt);
\par void    SetActivate        (WindoW w, act);
\par void    SetDocData         (DoC d, data, cleanup);
\par void    SetDocProcs        (DoC d, click, drag, release, pan,\line                             draw, gray, invert);
\par void    SetGroupMargins    (GrouP g, xMargin, yMargin);
\par void    SetGroupSpacing    (GrouP g, xSpacing, ySpacing);
\par void    SetNextPosition    (Handle obj, pt);
\par void    SetOffset          (Handle obj, horiz, vert);
\par void    SetPanelClick      (PaneL p, click, drag, hold, release);
\par void    SetPanelExtra      (PaneL p, VoidPtr sptr);
\par void    SetPen             (pt);
\par void    SetRange           (Handle obj, pgUp, pgDn, max);
\par void    SetStatus          (Handle obj, status);
\par void    SetSwitchMax       (SwitcH s, max);
\par void    SetSwitchParams    (SwitcH s, value, max);
\par void    SetTextSelect      (TexT t, slct, dslct);
\par void    SetTitle           (Handle obj, title);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    SetValue           (Handle obj, value);
\par }\pard \s27\widctlpar\box\brdrs\brdrw15\brsp20 \tx360\tx720\tx1080\tx1440\adjustright {void    SetViewerData      (VieweR viewer, data, cleanup);
\par void    SetViewerProcs     (VieweR viewer, click, drag, release, pan);
\par WindoW  ShadowWindow       (left, top, width, height, close);
\par void    Show               (Handle obj);
\par void    ShowSegment        (VieweR viewer, segment);
\par PaneL   SimplePanel        (GrouP prnt, pixwidth, pixheight, draw);
\par LisT    SingleList         (GrouP prnt, width, height, actn);
\par void    Solid              (void);
\par PrompT  StaticPrompt       (GrouP prnt, title, pixwidth, pixheight,\line                             font, just);
\par IteM    StatusItem         (MenU prnt, title, actn);
\par Int2    StringWidth        (text);
\par MenU    SubMenu            (MenU prnt, title);
\par void    SubPt              (src, dst);
\par 
\par Int2    TextLength         (TexT t);
\par void    TextSelectionRange (TexT t, begin, end);
\par Int2    TextWidth          (text, len);
\par 
\par Boolean UnionRect          (src1, src2, dst);
\par void    UnionRgn           (src1, src2, dst);
\par void    Update             (void);
\par SwitcH  UpDownSwitch       (GrouP prnt, text, acrn);
\par void    UseWindow          (WindoW w);
\par 
\par void    ValidRect          (rct);
\par void    ValidRgn           (rgn);
\par void    ViewerBox          (VieweR viewer, world, port, view, scaleX, scaleY);
\par void    VirtualSlate       (SlatE s, before, after, actn);
\par Boolean Visible            (Handle obj);
\par 
\par void    WatchCursor        (void);
\par void    White              (void);
\par void    WidePen            (width);
\par 
\par void    XorRgn             (src1, src2, dst);
\par void    Yellow             (void);
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431083}{\*\bkmkstart _Toc300649483}Acknowledgments{\*\bkmkend _Toc294431083}{\*\bkmkend _Toc300649483}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {I wish to thank a number of colleagues at the National Center for Biotechnology Information who have contributed critical ideas to this interface.  Jim Ostell proposed the ideas of portability and of dealing with objects at a high level, as close to the level of the desired parameters as is possible.  He also made suggestions that led to the concept of automatically positioning objects on the window and within groups.  Warren Gish, Greg Schuler, Tim Clark, Peter Karp, and several others also made numerous useful suggestions and constructive criticisms.  Early applications in Vibrant, written by or for John Spouge, Jill Shermer, Charlie Beatty, Jonathan Epstein and Kenn Rudd, uncovered design limitations that were quickly remedied.  Jill Shermer assisted in porting Vibrant to Motif.
\par Vibrant will be published separately in the near future.  You should reference J. Kans (manuscript in preparation).  Details on the internal organization of Vibrant will be published as an NCBI technical report in the future.  Vibrant is supplied as-is, and is currently not being supported.  Questions or comments can be directed to toolbox@ncbi.nlm.nih.gov.
\par }\pard\plain \s2\sb240\keep\keepn\widctlpar\outlinelevel1\adjustright \b\f16\fs28\cgrid {{\*\bkmkstart _Toc294431084}{\*\bkmkstart _Toc300649484}Trademarks{\*\bkmkend _Toc294431084}{\*\bkmkend _Toc300649484}
\par }\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {The mention of trade names, commercial products, or organizations does not imply endorsement by the NCBI or the U.S. Government.
\par Apple and Macintosh are registered trademarks of Apple Computer, Inc.
\par Microsoft is a registered trademark and Windows is a trademark of Microsoft Corporation.
\par Motif is a registered trademark of the Open Software Foundation.
\par }\pard \sb240\widctlpar\adjustright }}\pard\plain \sb240\widctlpar\adjustright \f16\fs20\cgrid {
\par }}

  <HTML>
  <HEAD>
  <!-- This HTML file has been created by texi2html 1.52 (hacked by david@detron.se)
     from manual.texi on 14 May 2004 -->

  <TITLE>MySQL Reference Manual for version 4.0.20.</TITLE>
   <style> code {color:purple} tt {color:green} samp {color:navy} pre {color:maroon} </style>
  </HEAD>
  <BODY BGCOLOR=silver TEXT=#000000 LINK=#101090 VLINK=#7030B0>
<H1>MySQL Reference Manual for version 4.0.20.</H1>
<P>
<P><HR><P>


<H1><A NAME="Introduction" HREF="manual_toc.html#Introduction">1  General Information</A></H1>

<P>
<A NAME="IDX1"></A>
<A NAME="IDX2"></A>

</P>

<P>
The <CODE>MySQL</CODE> (R) software delivers a very fast, multi-threaded,
multi-user, and robust <CODE>SQL</CODE> (<CODE>Structured Query Language</CODE>)
database server.
<CODE>MySQL Server</CODE> is intended for mission-critical, heavy-load
production systems as well as for embedding into mass-deployed software.
<CODE>MySQL</CODE> is a trademark of <CODE>MySQL AB</CODE>.

</P>
<P>
The <CODE>MySQL</CODE> software is <CODE>Dual Licensed</CODE>. Users can choose to
use the <CODE>MySQL</CODE> software as an <CODE>Open Source</CODE>/<CODE>Free Software</CODE>
product under the terms of the <CODE>GNU General Public License</CODE>
(<a HREF="http://www.fsf.org/licenses/">http://www.fsf.org/licenses/</a>) or can purchase a standard
commercial license from <CODE>MySQL AB</CODE>.
See section <A HREF="manual.html#Licensing_and_Support">1.4  MySQL Support and Licensing</A>.

</P>
<P>
The <CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>) provides the
latest information about the <CODE>MySQL</CODE> software.

</P>
<P>
The following list describes some sections of particular interest in this manual:

</P>

<UL>
<LI>

For information about the company behind the <CODE>MySQL Database Server</CODE>,
see section <A HREF="manual.html#What_is_MySQL_AB">1.3  Overview of MySQL AB</A>.

<LI>

For a discussion about the capabilities of the <CODE>MySQL Database Server</CODE>,
see section <A HREF="manual.html#Features">1.2.2  The Main Features of MySQL</A>.

<LI>

For installation instructions, see section <A HREF="manual.html#Installing">2  Installing MySQL</A>.

<LI>

For tips on porting the <CODE>MySQL Database Software</CODE> to new architectures
or operating systems, see section <A HREF="manual.html#Porting">D  Porting to Other Systems</A>.

<LI>

For information about upgrading from a Version 4.0 release, see
section <A HREF="manual.html#Upgrading-from-4.0">2.5.2  Upgrading from Version 4.0 to 4.1</A>.

<LI>

For information about upgrading from a Version 3.23 release, see
section <A HREF="manual.html#Upgrading-from-3.23">2.5.3  Upgrading from Version 3.23 to 4.0</A>.

<LI>

For information about upgrading from a Version 3.22 release, see
section <A HREF="manual.html#Upgrading-from-3.22">2.5.4  Upgrading from Version 3.22 to 3.23</A>.

<LI>

For a tutorial introduction to the <CODE>MySQL Database Server</CODE>,
see section <A HREF="manual.html#Tutorial">3  MySQL Tutorial</A>.

<LI>

For examples of <CODE>SQL</CODE> and benchmarking information, see the
benchmarking directory (<TT>`sql-bench'</TT> in the distribution).

<LI>

For a history of new features and bugfixes, see section <A HREF="manual.html#News">C  MySQL Change History</A>.

<LI>

For a list of currently known bugs and misfeatures, see section <A HREF="manual.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A>.

<LI>

For future plans, see section <A HREF="manual.html#TODO">1.6  MySQL and the Future (the TODO)</A>.

<LI>

For a list of all the contributors to this project, see section <A HREF="manual.html#Credits">B  Credits</A>.
</UL>

<P>
<STRONG>Important</STRONG>:

</P>
<P>
Reports of errors (often called ``bugs''), as well as questions and comments,
should be sent to the general MySQL mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

</P>
<P>
The <CODE>mysqlbug</CODE> script should be used to generate bug reports on Unix.
(Windows distributions contain a file named <TT>`mysqlbug.txt'</TT> in the base
directory that can be used as a template for a bug report.)

</P>
<P>
For source distributions, the <CODE>mysqlbug</CODE> script can be found in the
<TT>`scripts'</TT> directory. For binary distributions, <CODE>mysqlbug</CODE>
can be found in the <TT>`bin'</TT> directory (<TT>`/usr/bin'</TT> for the
<CODE>MySQL-server</CODE> RPM package).

</P>
<P>
If you have found a sensitive security bug in <CODE>MySQL Server</CODE>, please let
us know immediately by sending an email message to <a HREF="mailto:security@mysql.com">security@mysql.com</a>.

</P>
<P>
<A NAME="IDX3"></A>
<A NAME="IDX4"></A>
<A NAME="IDX5"></A>
<A NAME="IDX6"></A>

</P>



<H2><A NAME="Manual-info" HREF="manual_toc.html#Manual-info">1.1  About This Manual</A></H2>

<P>
<A NAME="IDX7"></A>
<A NAME="IDX8"></A>

</P>
<P>
This is the <CODE>MySQL</CODE> reference manual; it documents <CODE>MySQL</CODE>
up to Version 4.0.20. Functional changes are always
indicated with reference to the version, so this manual is also suitable
if you are using an older version of the <CODE>MySQL</CODE> software
(such as 3.23 or 4.0-production).
There are also references for version 5.0 (development).

</P>
<P>
Being a reference manual, it does not provide general instruction on
<CODE>SQL</CODE> or relational database concepts. It also will not teach you how to
use your operating system or command line interpreter.

</P>
<P>
As the <CODE>MySQL Database Software</CODE> is under constant development,
the manual is also updated frequently.
The most recent version of this manual is available at
<a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a> in many different formats,
including HTML, PDF, and Windows HLP versions.

</P>
<P>
<A NAME="IDX9"></A>
<A NAME="IDX10"></A>

</P>
<P>
The primary document is the Texinfo file.
The HTML version is produced automatically using a modified version of
<CODE>texi2html</CODE>.
The plain text and Info versions are produced with <CODE>makeinfo</CODE>.
The PostScript version is produced using <CODE>texi2dvi</CODE> and <CODE>dvips</CODE>.
The PDF version is produced with <CODE>pdftex</CODE>.

</P>
<P>
The index can assist you in finding information in the manual. For online use,
you can try the searchable version of the manual available at
<a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a>.

</P>
<P>
If you have any suggestions concerning additions or corrections to this
manual, please send them to the documentation team at <a HREF="mailto:docs@mysql.com">docs@mysql.com</a>.

</P>
<P>
This manual was initially written by David Axmark and Michael (Monty)
Widenius. It is now maintained by the MySQL Documentation Team,
consisting of Arjen Lentz, Paul DuBois, and Stefan Hinz.
For the many other contributors, see section <A HREF="manual.html#Credits">B  Credits</A>.

</P>
<P>
The copyright (2004) to this manual is owned by the Swedish company
<CODE>MySQL AB</CODE>. See section <A HREF="manual.html#Copyright">1.4.2  Copyrights and Licenses Used by MySQL</A>.

</P>



<H3><A NAME="Manual_conventions" HREF="manual_toc.html#Manual_conventions">1.1.1  Conventions Used in This Manual</A></H3>

<P>
This manual uses certain typographical conventions:

</P>
<P>
<A NAME="IDX11"></A>
<A NAME="IDX12"></A>
<A NAME="IDX13"></A>

</P>
<DL COMPACT>

<DT><CODE>constant</CODE>
<DD>
Constant-width font is used for command names and options; SQL statements;
database, table, and column names; C and Perl code; and environment variables.
Example: ``To see how <CODE>mysqladmin</CODE> works, invoke it with the
<CODE>--help</CODE> option.''

<DT><TT>`filename'</TT>
<DD>
Constant-width font with surrounding quotes is used for filenames and
pathnames.  Example: ``The distribution is installed under the
<TT>`/usr/local/'</TT> directory.''

<DT><SAMP>`c'</SAMP>
<DD>
Constant-width font with surrounding quotes is also used to indicate
character sequences.  Example: ``To specify a wildcard, use the <SAMP>`%'</SAMP>
character.''

<DT><EM>italic</EM>
<DD>
Italic font is used for emphasis, <EM>like this</EM>.

<DT><STRONG>boldface</STRONG>
<DD>
Boldface font is used in table headings and to convey
<STRONG>especially strong emphasis</STRONG>.
</DL>

<P>
When commands are shown that are meant to be executed by a particular
program, the program is indicated by a prompt shown before the command.  For
example, <CODE>shell&#62;</CODE> indicates a command that you execute from your login
shell, and <CODE>mysql&#62;</CODE> indicates a statement that you execute from the
<CODE>mysql</CODE> client program:

</P>

<PRE>
shell&#62; type a shell command here
mysql&#62; type a mysql statement here
</PRE>

<P>
The ``shell'' is your command interpreter. On Unix, this is typically a
program such as <CODE>sh</CODE> or <CODE>csh</CODE>. On Windows, the equivalent is
<CODE>command.com</CODE> or <CODE>cmd.exe</CODE>, typically run in a Windows console.

</P>
<P>
Note that to enter a command or statement from an example, you do not type
the prompt shown in the example.

</P>
<P>
Commands to set shell variables are shown using Bourne shell syntax.  If you
are using <CODE>csh</CODE> or <CODE>tcsh</CODE>, you will need to issue commands somewhat
differently.
For example, the sequence to set an environment variable and run a command
looks like this in Bourne shell syntax:

</P>

<PRE>
shell&#62; VARNAME=value some_command
</PRE>

<P>
<A NAME="IDX14"></A>
<A NAME="IDX15"></A>

</P>
<P>
For <CODE>csh</CODE> or <CODE>tcsh</CODE>, you would execute the sequence like this:

</P>

<PRE>
shell&#62; setenv VARNAME value
shell&#62; some_command
</PRE>

<P>
Database, table, and column names must often be substituted into commands.  To
indicate that such substitution is necessary, this manual uses
<CODE>db_name</CODE>, <CODE>tbl_name</CODE>, and <CODE>col_name</CODE>.  For example, you might
see a statement like this:

</P>

<PRE>
mysql&#62; SELECT col_name FROM db_name.tbl_name;
</PRE>

<P>
This means that if you were to enter a similar statement, you would supply
your own database, table, and column names, perhaps like this:

</P>

<PRE>
mysql&#62; SELECT author_name FROM biblio_db.author_list;
</PRE>

<P>
SQL keywords are not case sensitive and may be written in uppercase or
lowercase.  This manual uses uppercase.

</P>
<P>
In syntax descriptions, square brackets (<SAMP>`['</SAMP> and <SAMP>`]'</SAMP>) are used
to indicate optional words or clauses.  For example, in the following
statement, <CODE>IF EXISTS</CODE> is optional:

</P>

<PRE>
DROP TABLE [IF EXISTS] tbl_name
</PRE>

<P>
When a syntax element consists of a number of alternatives, the alternatives
are separated by vertical bars (<SAMP>`|'</SAMP>).  When one member from a set of
choices <STRONG>may</STRONG> be chosen, the alternatives are listed within square
brackets (<SAMP>`['</SAMP> and <SAMP>`]'</SAMP>):

</P>

<PRE>
TRIM([[BOTH | LEADING | TRAILING] [remstr] FROM] str)
</PRE>

<P>
When one member from a set of choices <STRONG>must</STRONG> be chosen, the
alternatives are listed within braces (<SAMP>`{'</SAMP> and <SAMP>`}'</SAMP>):

</P>

<PRE>
{DESCRIBE | DESC} tbl_name {col_name | wild}
</PRE>

<P>
An ellipsis (<CODE>...</CODE>) indicates the omission of a section of a statement,
typically to provide a shorter version of more complex syntax. For example,
<CODE>INSERT ... SELECT</CODE> is shorthand for the form of <CODE>INSERT</CODE> statement
that is followed by a <CODE>SELECT</CODE> statement.

</P>
<P>
An ellipsis can also indicate that the preceding syntax element of a statement
may be repeated. In the following example, multiple <CODE>reset_option</CODE> values
may be given, with each of those after the first preceded by commas:

</P>

<PRE>
RESET reset_option [,reset_option] ...
</PRE>



<H2><A NAME="What-is" HREF="manual_toc.html#What-is">1.2  Overview of the MySQL Database Management System</A></H2>

<P>
<A NAME="IDX16"></A>
<A NAME="IDX17"></A>

</P>
<P>
<CODE>MySQL</CODE>, the most popular <CODE>Open Source</CODE> SQL database management
system, is
developed, distributed, and supported by <CODE>MySQL AB</CODE>.  <CODE>MySQL AB</CODE> is a
commercial company, founded by the MySQL developers, that builds its business
by providing services around the <CODE>MySQL</CODE> database management system.
See section <A HREF="manual.html#What_is_MySQL_AB">1.3  Overview of MySQL AB</A>.

</P>
<P>
The <CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>)
provides the latest information about <CODE>MySQL</CODE> software and
<CODE>MySQL AB</CODE>.

</P>
<DL COMPACT>

<DT><CODE>MySQL</CODE> is a database management system.
<DD>
A database is a structured collection of data.  It may be anything from a
simple shopping list to a picture gallery or the vast amounts of
information in a corporate network.  To add, access, and process data
stored in a computer database, you need a database management system
such as <CODE>MySQL</CODE> Server.  Since computers are very good at handling large
amounts of data, database management systems play a central role in computing,
as standalone utilities or as parts of other applications.

<DT>MySQL is a relational database management system.
<DD>
<A NAME="IDX18"></A>
A relational database stores data in separate tables rather than putting
all the data in one big storeroom.  This adds speed and flexibility.
The <CODE>SQL</CODE> part of ``<CODE>MySQL</CODE>'' stands for ``<CODE>Structured
Query Language</CODE>.'' SQL is the most common standardized language used to
access databases and is defined by the ANSI/ISO SQL Standard.(The SQL 
standard has been evolving since 1986 and several versions exist. In this 
manual, ``SQL-92'' refers to the standard released in 1992,
``SQL:1999'' refers to the standard released in 1999, and
``SQL:2003'' refers to the current version of the standard.
We use the phrase ``the SQL standard'' to 
mean the current version of the SQL Standard at any time.)

<DT>MySQL software is <CODE>Open Source</CODE>.
<DD>
<A NAME="IDX19"></A>
<A NAME="IDX20"></A>
<A NAME="IDX21"></A>
<A NAME="IDX22"></A>
<CODE>Open Source</CODE> means that it is possible for anyone to use and modify the software.
Anybody can download the <CODE>MySQL</CODE> software from the Internet and use it
without paying anything.  If you wish, you may study the source code
and change it to suit your needs.  The <CODE>MySQL</CODE> software uses the
<CODE>GPL</CODE> (<CODE>GNU General Public License</CODE>),
<a HREF="http://www.fsf.org/licenses/">http://www.fsf.org/licenses/</a>, to define what you
may and may not do with the software in different situations.
If you feel uncomfortable with the <CODE>GPL</CODE> or need to embed
<CODE>MySQL</CODE> code into a commercial application, you can buy a
commercially licensed version from us.
See section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>.

<DT>Why use the MySQL Database Server?
<DD>
The <CODE>MySQL Database Server</CODE> is very fast, reliable, and easy to use.
If that is what you are looking for, you should give it a try.
<CODE>MySQL Server</CODE> also has a practical set of features developed in
close cooperation with our users.  You can find a performance comparison
of <CODE>MySQL Server</CODE> with other database managers on our benchmark page.
See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.

<CODE>MySQL Server</CODE> was originally developed to handle large databases
much faster than existing solutions and has been successfully used in
highly demanding production environments for several years.  Although
under constant development, <CODE>MySQL Server</CODE> today offers a rich and
useful set of functions.  Its connectivity, speed, and security make
<CODE>MySQL Server</CODE> highly suited for accessing databases on the Internet.

<DT>The technical features of MySQL Server
<DD>
The <CODE>MySQL Database Software</CODE> is a client/server system that consists
of a multi-threaded <CODE>SQL</CODE> server that supports different backends,
several different client programs and libraries, administrative tools,
and a wide range of application programming interfaces (APIs).

We also provide <CODE>MySQL Server</CODE> as a multi-threaded library that you
can link into your application to get a smaller, faster, easier-to-manage
product.

<DT>There is a large amount of contributed MySQL software available.
<DD>
It is very likely that you will find that your favorite application or
language already supports the <CODE>MySQL Database Server</CODE>.

</DL>

<P>
<A NAME="IDX23"></A>
<A NAME="IDX24"></A>
<A NAME="IDX25"></A>
The official way to pronounce <CODE>MySQL</CODE> is ``My Ess Que Ell'' (not
``my sequel''), but we don't mind if you pronounce it as ``my sequel''
or in some other localized way.

</P>



<H3><A NAME="History" HREF="manual_toc.html#History">1.2.1  History of MySQL</A></H3>

<P>
<A NAME="IDX26"></A>
<A NAME="IDX27"></A>
<A NAME="IDX28"></A>
<A NAME="IDX29"></A>
<A NAME="IDX30"></A>
<A NAME="IDX31"></A>

</P>
<P>
We started out with the intention of using <CODE>mSQL</CODE> to connect to our
tables using our own fast low-level (ISAM) routines. However, after some
testing, we came to the conclusion that <CODE>mSQL</CODE> was not fast enough or
flexible enough for our needs.  This resulted in a new SQL interface to our
database but with almost the same API interface as <CODE>mSQL</CODE>.  This API was
designed to allow third-party code that was written for use with <CODE>mSQL</CODE> to
be ported easily for use with <CODE>MySQL</CODE>.

</P>
<P>
The derivation of the name <CODE>MySQL</CODE> is not clear.  Our base
directory and a large number of our libraries and tools have had the prefix
``my'' for well over 10 years.  However, co-founder Monty Widenius's daughter
is also named My.  Which of the two gave its name to
<CODE>MySQL</CODE> is still a mystery, even for us.

</P>
<P>
The name of the MySQL Dolphin (our logo) is <CODE>Sakila</CODE>. <CODE>Sakila</CODE> was chosen
by the founders of MySQL AB from a huge list of names suggested by users
in our ``Name the Dolphin'' contest. The winning name was submitted by
Ambrose Twebaze, an Open Source software developer from Swaziland, Africa.
According to Ambrose, the name Sakila has its roots in SiSwati, the local
language of Swaziland. Sakila is also the name of a town in Arusha,
Tanzania, near Ambrose's country of origin, Uganda.

</P>



<H3><A NAME="Features" HREF="manual_toc.html#Features">1.2.2  The Main Features of MySQL</A></H3>

<P>
<A NAME="IDX32"></A>
<A NAME="IDX33"></A>

</P>
<P>
The following list describes some of the important characteristics
of the <CODE>MySQL Database Software</CODE>. See section <A HREF="manual.html#MySQL_4.0_Nutshell">1.5.1  MySQL 4.0 in a Nutshell</A>.

</P>
<DL COMPACT>

<DT>Internals and Portability
<DD>

<UL>
<LI>

Written in C and C++.
<LI>

Tested with a broad range of different compilers.
<LI>

Works on many different platforms.  See section <A HREF="manual.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A>.
<LI>

Uses GNU Automake, Autoconf, and Libtool for portability.
<LI>

APIs for C, C++, Eiffel, Java, Perl, PHP, Python, Ruby, and Tcl are available.
See section <A HREF="manual.html#Clients">20  MySQL APIs</A>.
<LI>

Fully multi-threaded using kernel threads.  This means it can easily
use multiple CPUs if they are available.
<LI>

Provides transactional and non-transactional storage engines.
<LI>

Uses very fast B-tree disk tables (<CODE>MyISAM</CODE>) with index compression.
<LI>

Relatively easy to add another storage engine. This is useful if you
want to add an SQL interface to an in-house database.
<LI>

A very fast thread-based memory allocation system.
<LI>

Very fast joins using an optimized one-sweep multi-join.
<LI>

In-memory hash tables, which are used as temporary tables.
<LI>

SQL functions are implemented using a highly optimized class library and
should be as fast as possible.  Usually there is no memory allocation
at all after query initialization.
<LI>

The <CODE>MySQL</CODE> code is tested with Purify
(a commercial memory leakage detector) as well as with Valgrind,
a <CODE>GPL</CODE> tool (<a HREF="http://developer.kde.org/~sewardj/">http://developer.kde.org/~sewardj/</a>).
<LI>

The server is available as a separate program for use in a client/server
networked environment.  It is also available as a library that can be
embedded (linked) into standalone applications. Such applications can be
used in isolation or in environments where no network is available.
</UL>

<DT>Column Types
<DD>

<UL>
<LI>

Many column types: signed/unsigned integers 1, 2, 3, 4, and 8 bytes
long, <CODE>FLOAT</CODE>, <CODE>DOUBLE</CODE>, <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>,
<CODE>TEXT</CODE>, <CODE>BLOB</CODE>, <CODE>DATE</CODE>, <CODE>TIME</CODE>, <CODE>DATETIME</CODE>,
<CODE>TIMESTAMP</CODE>, <CODE>YEAR</CODE>, <CODE>SET</CODE>, <CODE>ENUM</CODE>, and OpenGIS geometry
types.
See section <A HREF="manual.html#Column_types">12  Column Types</A>.
<LI>

Fixed-length and variable-length records.
</UL>

<DT>Commands and Functions
<DD>

<UL>
<LI>

Full operator and function support in the <CODE>SELECT</CODE> and <CODE>WHERE</CODE>
clauses of queries.  For example:


<PRE>
mysql&#62; SELECT CONCAT(first_name, ' ', last_name)
    -&#62; FROM tbl_name
    -&#62; WHERE income/dependents &#62; 10000 AND age &#62; 30;
</PRE>

<LI>

Full support for SQL <CODE>GROUP BY</CODE> and
<CODE>ORDER BY</CODE> clauses.  Support
for group functions (<CODE>COUNT()</CODE>,
<CODE>COUNT(DISTINCT ...)</CODE>,
<CODE>AVG()</CODE>, <CODE>STD()</CODE>,
<CODE>SUM()</CODE>, <CODE>MAX()</CODE>, <CODE>MIN()</CODE>, and <CODE>GROUP_CONCAT()</CODE>).
<LI>

Support for <CODE>LEFT OUTER JOIN</CODE> and <CODE>RIGHT OUTER JOIN</CODE> with both standard
SQL and ODBC syntax.
<LI>

Support for aliases on tables and columns as required by standard SQL.
<LI>

<CODE>DELETE</CODE>, <CODE>INSERT</CODE>, <CODE>REPLACE</CODE>, and <CODE>UPDATE</CODE> return
the number of rows that were changed (affected).  It is possible to return
the number of rows matched instead by setting a flag when connecting to the
server.
<LI>

The <CODE>MySQL</CODE>-specific <CODE>SHOW</CODE> command can be used to retrieve
information about databases, tables, and indexes.  The <CODE>EXPLAIN</CODE> command
can be used to determine how the optimizer resolves a query.
<LI>

Function names do not clash with table or column names.  For example,
<CODE>ABS</CODE> is a valid column name.  The only restriction is that for a
function call, no spaces are allowed between the function name and the
<SAMP>`('</SAMP> that follows it.  See section <A HREF="manual.html#Reserved_words">10.6  Treatment of Reserved Words in MySQL</A>.
<LI>

You can mix tables from different databases in the same query (as of
Version 3.22).
</UL>

<DT>Security
<DD>

<UL>
<LI>

A privilege and password system that is very flexible and secure, and
allows host-based verification.  Passwords are secure because all
password traffic is encrypted when you connect to a server.
</UL>

<DT>Scalability and Limits
<DD>

<UL>
<LI>

Handles large databases.  We use <CODE>MySQL Server</CODE> with databases that 
contain 50 million records. We also know of users who
use <CODE>MySQL Server</CODE> with 60,000 tables and about 5,000,000,000 rows.
<LI>

Up to 64 indexes per table are allowed (32 before MySQL 4.1.2).  Each index may
consist of 1 to 16 columns or parts of columns.  The maximum index width is
1000 bytes (500 before MySQL 4.1.2).
An index may use a prefix of a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column.
</UL>

<DT>Connectivity
<DD>

<UL>
<LI>

Clients may connect to the <CODE>MySQL</CODE> server using TCP/IP sockets
on any platform.  On Windows systems in the NT family (NT, 2000,
or XP), clients may connect using named pipes. On Unix systems,
clients may connect using Unix domain socket files.
<LI>

The Connector/ODBC interface provides <CODE>MySQL</CODE> support for client programs
that use ODBC (Open Database Connectivity) connections.  For example,
you can use MS Access to connect to your <CODE>MySQL</CODE> server.  Clients may
be run on Windows or Unix.  Connector/ODBC source is available.  All ODBC
2.5 functions are supported, as are many others.
See section <A HREF="manual.html#ODBC">20.3  MySQL ODBC Support</A>.
<LI>

The Connector/JDBC interface provides <CODE>MySQL</CODE> support for Java client
programs that use JDBC connections.  Clients may be run on Windows or Unix.
Connector/JDBC source is available.
See section <A HREF="manual.html#Java">20.4  MySQL Java Connectivity (JDBC)</A>.
</UL>

<DT>Localization
<DD>

<UL>
<LI>

The server can provide error messages to clients in many languages.
See section <A HREF="manual.html#Languages">5.7.2  Setting the Error Message Language</A>.
<LI>

Full support for several different character sets, including
ISO-8859-1 (Latin1), german, big5, ujis, and more.  For example,
the Scandinavian characters <SAMP>`@^a'</SAMP>, <SAMP>`@"a'</SAMP> and <SAMP>`@"o'</SAMP> are
allowed in table and column names.
Unicode support is available as of <CODE>MySQL</CODE> 4.1.
<LI>

All data is saved in the chosen character set.  All comparisons for normal
string columns are case-insensitive.
<LI>

Sorting is done according to the chosen character set (the Swedish
way by default).  It is possible to change this when the <CODE>MySQL</CODE>
server is started.  To see an example of very advanced sorting, look
at the Czech sorting code.  <CODE>MySQL Server</CODE> supports many different
character sets that can be specified at compile time and runtime.
</UL>

<DT>Clients and Tools
<DD>

<UL>
<LI>

The MySQL server has built-in support for SQL statements to check,
optimize, and repair tables.  These statements are available from the
command line through the <CODE>mysqlcheck</CODE> client. MySQL also includes
<CODE>myisamchk</CODE>, a very fast command-line utility for performing these
operations on <CODE>MyISAM</CODE> tables.
See section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>.
<LI>

All <CODE>MySQL</CODE> programs can be invoked with the <CODE>--help</CODE> or <CODE>-?</CODE>
options to obtain online assistance.
</UL>

</DL>



<H3><A NAME="Stability" HREF="manual_toc.html#Stability">1.2.3  MySQL Stability</A></H3>

<P>
<A NAME="IDX34"></A>

</P>
<P>
This section addresses the questions ``<EM>How stable is MySQL Server?</EM>''
and ``<EM>Can I depend on MySQL Server in this project?</EM>''
We will try to clarify these issues and answer some important
questions that concern many potential users. The information in this
section is based on data gathered from the mailing list, which is
very active in identifying problems as well as reporting types of use.

</P>
<P>
The original code stems back to the early 1980s. It provides a stable code
base, and the <CODE>ISAM</CODE> table format used by the original storage engine
remains backward-compatible.
At TcX, the predecessor of <CODE>MySQL AB</CODE>, <CODE>MySQL</CODE> code has worked
in projects since mid-1996, without any problems.
When the <CODE>MySQL Database Software</CODE> initially was released to a wider public,
our new users quickly found some pieces of ``untested code.'' Each new release
since then has had fewer portability problems (even though each new release
has also had many new features).

</P>
<P>
Each release of the <CODE>MySQL Server</CODE> has been usable. Problems have occurred
only when users try code from the ``gray zones.''  Naturally, new users
don't know what the gray zones are; this section therefore attempts to
document those areas that are currently known.
The descriptions mostly deal with Version 3.23 and 4.0 of <CODE>MySQL Server</CODE>.
All known and reported bugs are fixed in the latest version, with the
exception of those listed in the bugs section, which
are design-related.  See section <A HREF="manual.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A>.

</P>
<P>
The <CODE>MySQL Server</CODE> design is multi-layered with independent modules.
Some of the newer modules are listed here with an indication of how
well-tested each of them is:

</P>
<P>
<A NAME="IDX35"></A>

</P>
<DL COMPACT>

<DT>Replication -- Gamma
<DD>
Large groups of servers using replication are in production use, with
good results. Work on enhanced replication features is continuing
in <CODE>MySQL</CODE> 5.x.

<DT><CODE>InnoDB</CODE> tables -- Stable (in 3.23 from 3.23.49)
<DD>
The <CODE>InnoDB</CODE> transactional storage engine has been declared
stable in the <CODE>MySQL</CODE> 3.23 tree, starting from version 3.23.49.
<CODE>InnoDB</CODE> is being used in large, heavy-load production systems.

<DT><CODE>BDB</CODE> tables -- Gamma
<DD>
The <CODE>Berkeley DB</CODE> code is very stable, but we are still improving
the <CODE>BDB</CODE> transactional storage engine interface in
<CODE>MySQL Server</CODE>, so it will take some time before this is as well
tested as the other table types.

<DT>Full-text searches -- Beta
<DD>
Full-text searching works but is not yet widely used.
Important enhancements have been implemented in <CODE>MySQL</CODE> 4.0.

<DT><CODE>Connector/ODBC 3.51</CODE> (uses ODBC SDK 3.51) -- Stable
<DD>
In wide production use. Some issues brought up appear to be
application-related and independent of the ODBC driver or underlying
database server.

<DT>Automatic recovery of <CODE>MyISAM</CODE> tables -- Gamma
<DD>
This status applies only to the new code in the <CODE>MyISAM</CODE> storage
engine that checks whether the table was closed properly on open and
executes an automatic check or repair of the table if it wasn't.

</DL>

<P>
Paying customers receive high-quality support directly from MySQL AB.
MySQL AB also provides the MySQL mailing list as a community resource
where anyone may ask questions.

</P>
<P>
Bugs are usually fixed right away with a patch. For serious bugs, there
is almost always a new release.

</P>



<H3><A NAME="Table_size" HREF="manual_toc.html#Table_size">1.2.4  How Big MySQL Tables Can Be</A></H3>

<P>
<A NAME="IDX36"></A>
<A NAME="IDX37"></A>
<A NAME="IDX38"></A>
<A NAME="IDX39"></A>
<A NAME="IDX40"></A>

</P>
<P>
<CODE>MySQL</CODE> Version 3.22 had a 4GB (4 gigabyte) limit on table size. With the
<CODE>MyISAM</CODE> storage engine in <CODE>MySQL</CODE> Version 3.23, the maximum table
size was increased to 8 million terabytes (2 ^ 63 bytes). With this larger
allowed table size, the maximum effective table size for <CODE>MySQL</CODE>
databases now normally is determined by operating system constraints
on file sizes, not by MySQL internal limits.

</P>
<P>
The <CODE>InnoDB</CODE> storage engine maintains <CODE>InnoDB</CODE> tables within a
tablespace that can be created from several files. This allows a
table to exceed the maximum individual file size. The tablespace can include
raw disk partitions, which allows extremely large tables. The maximum
tablespace size is 64TB.

</P>
<P>
The following table lists some examples of operating system file-size
limits:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Operating System</STRONG> </TD><TD> <STRONG>File-size Limit</STRONG>
</TD></TR>
<TR><TD>Linux-Intel 32-bit </TD><TD> 2GB, much more when using LFS
</TD></TR>
<TR><TD>Linux-Alpha </TD><TD> 8TB (?)
</TD></TR>
<TR><TD>Solaris 2.5.1 </TD><TD> 2GB (4GB possible with patch)
</TD></TR>
<TR><TD>Solaris 2.6 </TD><TD> 4GB (can be changed with flag)
</TD></TR>
<TR><TD>Solaris 2.7 Intel </TD><TD> 4GB
</TD></TR>
<TR><TD>Solaris 2.7 UltraSPARC </TD><TD> 512GB
</TD></TR>
<TR><TD>NetWare w/NSS filesystem </TD><TD> 8TB
</TD></TR>
</TABLE>

<P>
On Linux 2.2, you can get <CODE>MyISAM</CODE> tables larger than 2GB in size by
using the Large File Support (LFS) patch for the ext2 filesystem. On Linux
2.4, patches also exist for ReiserFS to get support for big files. Most
current Linux distributions are based on kernel 2.4 and already include all
the required LFS patches. However, the maximum
available file size still depends on several factors, one of them being the
filesystem used to store MySQL tables.

</P>
<P>
For a very detailed overview about LFS in Linux, have a look at Andreas
Jaeger's <CITE>Large File Support in Linux</CITE> page at
http://www.suse.de/~aj/linux_lfs.html.

</P>
<P>
By default, <CODE>MySQL</CODE> creates <CODE>MyISAM</CODE> tables with an internal
structure that allows a maximum size of about 4GB.  You can
check the maximum table size for a table with the <CODE>SHOW TABLE STATUS</CODE>
command or with the <CODE>myisamchk -dv tbl_name</CODE>.
See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

</P>
<P>
If you need a <CODE>MyISAM</CODE> table that will be larger than 4GB in size (and your
operating system supports large files), the <CODE>CREATE TABLE</CODE> statement
allows <CODE>AVG_ROW_LENGTH</CODE> and <CODE>MAX_ROWS</CODE> options.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.
You can also change these options with <CODE>ALTER TABLE</CODE> after the table has
been created, to increase the table's maximum allowable size.
See section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.

</P>
<P>
Other ways to work around file-size limits for <CODE>MyISAM</CODE> tables are as
follows:

</P>

<UL>
<LI>

If your large table is read-only, you can use <CODE>myisampack</CODE> to
compress it.  <CODE>myisampack</CODE> usually compresses a table by at
least 50%, so you can have, in effect, much bigger tables.
<CODE>myisampack</CODE> also can merge multiple tables into a single table.
See section <A HREF="manual.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A>.

<LI>

Another way to get around the operating system file limit for <CODE>MyISAM</CODE>
data files is by using the <CODE>RAID</CODE> options.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<LI>

<CODE>MySQL</CODE> includes a <CODE>MERGE</CODE> library that allows
you to handle a collection of <CODE>MyISAM</CODE> tables that have identical
structure as a single <CODE>MERGE</CODE> table.
See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.

</UL>



<H3><A NAME="Year_2000_compliance" HREF="manual_toc.html#Year_2000_compliance">1.2.5  Year 2000 Compliance</A></H3>

<P>
<A NAME="IDX41"></A>
<A NAME="IDX42"></A>
<A NAME="IDX43"></A>

</P>
<P>
The <CODE>MySQL Server</CODE> itself has no problems with Year 2000 (Y2K)
compliance:

</P>

<UL>
<LI>

<CODE>MySQL Server</CODE> uses Unix time functions that handle dates into the year
<CODE>2037</CODE> for <CODE>TIMESTAMP</CODE> values. For <CODE>DATE</CODE> and <CODE>DATETIME</CODE>
values, dates through the year <CODE>9999</CODE> are accepted.

<LI>

All <CODE>MySQL</CODE> date functions are implemented in one source file,
<TT>`sql/time.cc'</TT>, and are coded very carefully to be year 2000-safe.

<LI>

In <CODE>MySQL</CODE> Version 3.22 and later, the <CODE>YEAR</CODE> column type
can store years <CODE>0</CODE> and <CODE>1901</CODE> to <CODE>2155</CODE> in one byte and
display them using two or four digits.
All two-digit years are considered to be in the range
<CODE>1970</CODE> to <CODE>2069</CODE>, which means that if you store <CODE>01</CODE> in a
<CODE>YEAR</CODE> column, <CODE>MySQL Server</CODE> treats it as <CODE>2001</CODE>.
</UL>

<P>
The following simple demonstration illustrates that <CODE>MySQL Server</CODE>
doesn't have any problems with dates until after the year 2030:

</P>

<PRE>
mysql&#62; DROP TABLE IF EXISTS y2k;
Query OK, 0 rows affected (0.01 sec)

mysql&#62; CREATE TABLE y2k (date DATE,
    -&#62;                   date_time DATETIME,
    -&#62;                   time_stamp TIMESTAMP);
Query OK, 0 rows affected (0.00 sec)

mysql&#62; INSERT INTO y2k VALUES
    -&#62; ('1998-12-31','1998-12-31 23:59:59',19981231235959),
    -&#62; ('1999-01-01','1999-01-01 00:00:00',19990101000000),
    -&#62; ('1999-09-09','1999-09-09 23:59:59',19990909235959),
    -&#62; ('2000-01-01','2000-01-01 00:00:00',20000101000000),
    -&#62; ('2000-02-28','2000-02-28 00:00:00',20000228000000),
    -&#62; ('2000-02-29','2000-02-29 00:00:00',20000229000000),
    -&#62; ('2000-03-01','2000-03-01 00:00:00',20000301000000),
    -&#62; ('2000-12-31','2000-12-31 23:59:59',20001231235959),
    -&#62; ('2001-01-01','2001-01-01 00:00:00',20010101000000),
    -&#62; ('2004-12-31','2004-12-31 23:59:59',20041231235959),
    -&#62; ('2005-01-01','2005-01-01 00:00:00',20050101000000),
    -&#62; ('2030-01-01','2030-01-01 00:00:00',20300101000000),
    -&#62; ('2050-01-01','2050-01-01 00:00:00',20500101000000);
Query OK, 13 rows affected (0.01 sec)
Records: 13  Duplicates: 0  Warnings: 0

mysql&#62; SELECT * FROM y2k;
+------------+---------------------+----------------+
| date       | date_time           | time_stamp     |
+------------+---------------------+----------------+
| 1998-12-31 | 1998-12-31 23:59:59 | 19981231235959 |
| 1999-01-01 | 1999-01-01 00:00:00 | 19990101000000 |
| 1999-09-09 | 1999-09-09 23:59:59 | 19990909235959 |
| 2000-01-01 | 2000-01-01 00:00:00 | 20000101000000 |
| 2000-02-28 | 2000-02-28 00:00:00 | 20000228000000 |
| 2000-02-29 | 2000-02-29 00:00:00 | 20000229000000 |
| 2000-03-01 | 2000-03-01 00:00:00 | 20000301000000 |
| 2000-12-31 | 2000-12-31 23:59:59 | 20001231235959 |
| 2001-01-01 | 2001-01-01 00:00:00 | 20010101000000 |
| 2004-12-31 | 2004-12-31 23:59:59 | 20041231235959 |
| 2005-01-01 | 2005-01-01 00:00:00 | 20050101000000 |
| 2030-01-01 | 2030-01-01 00:00:00 | 20300101000000 |
| 2050-01-01 | 2050-01-01 00:00:00 | 00000000000000 |
+------------+---------------------+----------------+
13 rows in set (0.00 sec)

</PRE>

<P>
The final <CODE>TIMESTAMP</CODE> column value is zero because the final
year (<CODE>2050</CODE>) exceeds the <CODE>TIMESTAMP</CODE> maximum.  The
<CODE>TIMESTAMP</CODE> data type, which is used to store the current time,
supports values that range from <CODE>19700101000000</CODE> to
<CODE>20300101000000</CODE> on 32-bit machines (signed value).  On 64-bit
machines, <CODE>TIMESTAMP</CODE> handles values up to <CODE>2106</CODE> (unsigned
value).

</P>
<P>
The example also shows that the <CODE>DATE</CODE> and <CODE>DATETIME</CODE> data types have
no problems with the dates used. They handle dates through the year
<CODE>9999</CODE>.

</P>
<P>
Although <CODE>MySQL Server</CODE> itself is Y2K-safe, you may run into
problems if you use it with applications that are not Y2K-safe.
For example, many old applications store or manipulate years using
two-digit values (which are ambiguous) rather than four-digit values.
This problem may be compounded by applications that use
values such as <CODE>00</CODE> or <CODE>99</CODE> as ``missing'' value indicators.
Unfortunately, these problems may be difficult to fix because different
applications may be written by different programmers, each of whom may
use a different set of conventions and date-handling functions.

</P>
<P>
Thus, even though <CODE>MySQL Server</CODE> has no Y2K problems, it is
the application's responsibility to provide unambiguous input.
See section <A HREF="manual.html#Y2K_issues">12.3.4  Y2K Issues and Date Types</A> for <CODE>MySQL Server</CODE>'s rules for dealing
with ambiguous date input data that contains two-digit year values.

</P>



<H2><A NAME="What_is_MySQL_AB" HREF="manual_toc.html#What_is_MySQL_AB">1.3  Overview of MySQL AB</A></H2>

<P>
<A NAME="IDX44"></A>

</P>
<P>
<CODE>MySQL AB</CODE> is the company of the <CODE>MySQL</CODE> founders and main
developers. <CODE>MySQL AB</CODE> was originally established in Sweden by
David Axmark, Allan Larsson, and Michael ``Monty'' Widenius.

</P>
<P>
The developers of the <CODE>MySQL</CODE> server are all employed by the company.
We are a virtual organization with people in a dozen countries around
the world. We communicate extensively over the Internet every day with one another 
and with our users, supporters, and partners.

</P>
<P>
We are dedicated to developing the <CODE>MySQL</CODE> database software and
promoting it to new users. <CODE>MySQL AB</CODE> owns the copyright to the
<CODE>MySQL</CODE> source code, the <CODE>MySQL</CODE> logo and trademark, and this
manual. See section <A HREF="manual.html#What-is">1.2  Overview of the MySQL Database Management System</A>.

</P>

<P>
The <CODE>MySQL</CODE> core values show our dedication to <CODE>MySQL</CODE> and
<CODE>Open Source</CODE>.

</P>
<P>
We want the <CODE>MySQL Database Software</CODE> to be:

<UL>
<LI>

The best and the most widely used database in the world
<LI>

Available to, and affordable by all
<LI>

Easy to use
<LI>

Continuously improving while remaining fast and safe
<LI>

Fun to use and improve
<LI>

Free from bugs
</UL>

<P>
<CODE>MySQL AB</CODE> and the people at <CODE>MySQL AB</CODE>:

<UL>
<LI>

Promote <CODE>Open Source</CODE> philosophy and support the
<CODE>Open Source</CODE> community
<LI>

Aim to be good citizens
<LI>

Prefer partners that share our values and mind-set
<LI>

Answer email and provide support
<LI>

Are a virtual company, networking with others
<LI>

Work against software patents
</UL>

<P>
The <CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>)
provides the latest information about <CODE>MySQL</CODE> and <CODE>MySQL AB</CODE>.

</P>
<P>
By the way, the ``AB'' part of the company name is the acronym for the
Swedish ``aktiebolag,'' or ``stock company.'' It translates to ``MySQL,
Inc.'' In fact, MySQL, Inc. and MySQL GmbH are examples of MySQL AB
subsidiaries. They are located in the US and Germany, respectively.

</P>



<H3><A NAME="MySQL_AB_business_model_and_services" HREF="manual_toc.html#MySQL_AB_business_model_and_services">1.3.1  The Business Model and Services of MySQL AB</A></H3>

<P>
One of the most common questions we encounter is:
``<EM>How can you make a living from something you give away for free?</EM>''
This is how:

</P>

<UL>
<LI>

<CODE>MySQL AB</CODE> makes money on support, services, commercial licenses,
and royalties.
<LI>

We use these revenues to fund product development
and to expand the <CODE>MySQL</CODE> business.
</UL>

<P>
The company has been profitable since its inception. In October 2001,
we accepted venture financing from leading Scandinavian investors and
a handful of business angels. This investment is used to solidify our
business model and build a basis for sustainable growth.

</P>



<H4><A NAME="Business_Services_Support" HREF="manual_toc.html#Business_Services_Support">1.3.1.1  Support</A></H4>
<P>
<CODE>MySQL AB</CODE> is run and owned by the founders and main developers of
the <CODE>MySQL</CODE> database. The developers are committed to providing support
to customers and other users in order to stay in touch with their needs
and problems. All our support is provided by qualified developers. Really
tricky questions are answered by Michael <CODE>Monty</CODE> Widenius, principal
author of the <CODE>MySQL Server</CODE>.
See section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.

</P>
<P>
For more information and ordering support at various levels, see
<a HREF="http://www.mysql.com/support/">http://www.mysql.com/support/</a> or contact our sales staff at
<a HREF="mailto:sales@mysql.com">sales@mysql.com</a>.

</P>



<H4><A NAME="Business_Services_Training" HREF="manual_toc.html#Business_Services_Training">1.3.1.2  Training and Certification</A></H4>
<P>
<A NAME="IDX45"></A>
<A NAME="IDX46"></A>
<A NAME="IDX47"></A>
<A NAME="IDX48"></A>
<CODE>MySQL AB</CODE> delivers <CODE>MySQL</CODE> and related training worldwide.
We offer both open courses and in-house courses tailored to the
specific needs of your company. <CODE>MySQL Training</CODE> is also available
through our partners, the <CODE>Authorized MySQL Training Centers</CODE>.

</P>
<P>
Our training material uses the same sample databases used in our
documentation and our sample applications, and is always updated
to reflect the latest <CODE>MySQL</CODE> version. Our trainers are backed by
the development team to guarantee the quality of the training and the
continuous development of the course material. This also ensures
that no questions raised during the courses remain unanswered.

</P>
<P>
Attending our training courses will enable you to achieve your <CODE>MySQL</CODE> 
application goals. You will also:

<UL>
<LI>

Save time.
<LI>

Improve the performance of your applications.
<LI>

Reduce or eliminate the need for additional hardware, decreasing cost.
<LI>

Enhance security.
<LI>

Increase customers' and co-workers' satisfaction.
<LI>

Prepare yourself for <CODE>MySQL Certification</CODE>.
</UL>

<P>
If you are interested in our training as a potential participant or
as a training partner, please visit the training section at
<a HREF="http://www.mysql.com/training/">http://www.mysql.com/training/</a> or contact us at:
<a HREF="mailto:training@mysql.com">training@mysql.com</a>.

</P>
<P>
For details about the <CODE>MySQL Certification Program</CODE>, please see
<a HREF="http://www.mysql.com/certification/">http://www.mysql.com/certification/</a>.

</P>



<H4><A NAME="Business_Services_Consulting" HREF="manual_toc.html#Business_Services_Consulting">1.3.1.3  Consulting</A></H4>
<P>
<A NAME="IDX49"></A>
<A NAME="IDX50"></A>
<CODE>MySQL AB</CODE> and its <CODE>Authorized Partners</CODE> offer consulting
services to users of <CODE>MySQL Server</CODE> and to those who embed
<CODE>MySQL Server</CODE> in their own software, all over the world.

</P>
<P>
Our consultants can help you design and tune your databases, construct
efficient queries, tune your platform for optimal performance, resolve
migration issues, set up replication, build robust transactional
applications, and more.
We also help customers embed <CODE>MySQL Server</CODE> in their products and
applications for large-scale deployment.

</P>
<P>
Our consultants work in close collaboration with our development team,
which ensures the technical quality of our professional services.
Consulting assignments range from two-day power-start sessions to
projects that span weeks and months. Our expertise not only covers
<CODE>MySQL Server</CODE>---it also extends into programming and scripting
languages such as PHP, Perl, and more.

</P>
<P>
If you are interested in our consulting services or want to become a
consulting partner, please visit the consulting section of our Web site
at <a HREF="http://www.mysql.com/consulting/">http://www.mysql.com/consulting/</a> or contact our consulting
staff at <a HREF="mailto:consulting@mysql.com">consulting@mysql.com</a>.

</P>



<H4><A NAME="Business_Services_Commercial_licenses" HREF="manual_toc.html#Business_Services_Commercial_licenses">1.3.1.4  Commercial Licenses</A></H4>
<P>
The <CODE>MySQL</CODE> database is released under the
<CODE>GNU General Public License</CODE> (<CODE>GPL</CODE>).
This means that the <CODE>MySQL</CODE> software can be used free of charge
under the <CODE>GPL</CODE>. If you do not want to be bound by the <CODE>GPL</CODE>
terms (such as the requirement that your application must also be <CODE>GPL</CODE>), 
you may purchase a commercial license for the same product
from <CODE>MySQL AB</CODE>; see <a HREF="https://order.mysql.com/">https://order.mysql.com/</a>.
Since <CODE>MySQL AB</CODE> owns the copyright to the <CODE>MySQL</CODE> source code,
we are able to employ <CODE>Dual Licensing</CODE>, which means that the same
product is available under <CODE>GPL</CODE> and under a commercial
license. This does not in any way affect the <CODE>Open Source</CODE>
commitment of <CODE>MySQL AB</CODE>. For details about when a commercial
license is required, please see section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>.

</P>
<P>
We also sell commercial licenses of third-party <CODE>Open Source GPL</CODE>
software that adds value to <CODE>MySQL Server</CODE>. A good example is the
<CODE>InnoDB</CODE> transactional storage engine that offers <CODE>ACID</CODE>
support, row-level locking, crash recovery, multi-versioning, foreign
key support, and more. See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.

</P>



<H4><A NAME="Business_Services_Partnering" HREF="manual_toc.html#Business_Services_Partnering">1.3.1.5  Partnering</A></H4>
<P>
<A NAME="IDX51"></A>
<CODE>MySQL AB</CODE> has a worldwide partner program that covers training
courses, consulting and support, publications, plus reselling and
distributing <CODE>MySQL</CODE> and related products. <CODE>MySQL AB Partners</CODE>
get visibility on the <a HREF="http://www.mysql.com/">http://www.mysql.com/</a> Web site and the right
to use special versions of the <CODE>MySQL</CODE> trademarks to identify their
products and promote their business.

</P>
<P>
If you are interested in becoming a <CODE>MySQL AB Partner</CODE>, please email
<a HREF="mailto:partner@mysql.com">partner@mysql.com</a>.

</P>
<P>
The word <CODE>MySQL</CODE> and the <CODE>MySQL</CODE> dolphin logo are trademarks of
<CODE>MySQL AB</CODE>. See section <A HREF="manual.html#MySQL_AB_Logos_and_Trademarks">1.4.4  MySQL AB Logos and Trademarks</A>.
These trademarks represent a significant value that the <CODE>MySQL</CODE>
founders have built over the years.

</P>
<P>
The <CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>) is popular among
developers and users. In December 2003, we served 16 million page views.
Our visitors represent a group that makes purchase decisions and
recommendations for both software and hardware. Twelve percent of our
visitors authorize purchase decisions, and only nine percent are not
involved in purchase decisions at all. More than 65% have made one or
more online business purchases within the last half-year, and 70% plan
to make one in the next few months.

</P>



<H3><A NAME="Contact_information" HREF="manual_toc.html#Contact_information">1.3.2  Contact Information</A></H3>

<P>
<A NAME="IDX52"></A>
<A NAME="IDX53"></A>
<A NAME="IDX54"></A>
<A NAME="IDX55"></A>
<A NAME="IDX56"></A>

</P>
<P>
The <CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>)
provides the latest information about <CODE>MySQL</CODE> and <CODE>MySQL AB</CODE>.

</P>
<P>
For press services and inquiries not covered in our news releases
(<a HREF="http://www.mysql.com/news-and-events/">http://www.mysql.com/news-and-events/</a>), please send email to
<a HREF="mailto:press@mysql.com">press@mysql.com</a>.

</P>
<P>
If you have a valid support contract with <CODE>MySQL AB</CODE>, you will
get timely, precise answers to your technical questions about the
<CODE>MySQL</CODE> software. For more information, see section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.
On our Web site, see <a HREF="http://www.mysql.com/support/">http://www.mysql.com/support/</a>, or send
an email message to <a HREF="mailto:sales@mysql.com">sales@mysql.com</a>.

</P>
<P>
For information about <CODE>MySQL</CODE> training, please visit the training
section at <a HREF="http://www.mysql.com/training/">http://www.mysql.com/training/</a>. If you have
restricted access to the Internet, please contact the <CODE>MySQL AB</CODE>
training staff via email at <a HREF="mailto:training@mysql.com">training@mysql.com</a>.
See section <A HREF="manual.html#Business_Services_Training">1.3.1.2  Training and Certification</A>.

</P>
<P>
For information on the <CODE>MySQL Certification Program</CODE>, please see
<a HREF="http://www.mysql.com/certification/">http://www.mysql.com/certification/</a>.
See section <A HREF="manual.html#Business_Services_Training">1.3.1.2  Training and Certification</A>.

</P>
<P>
If you're interested in consulting, please visit the consulting
section of our Web site at <a HREF="http://www.mysql.com/consulting/">http://www.mysql.com/consulting/</a>. If you have
restricted access to the Internet, please contact the <CODE>MySQL AB</CODE>
consulting staff via email at <a HREF="mailto:consulting@mysql.com">consulting@mysql.com</a>.
See section <A HREF="manual.html#Business_Services_Consulting">1.3.1.3  Consulting</A>.

</P>
<P>
Commercial licenses may be purchased online at
<a HREF="https://order.mysql.com/">https://order.mysql.com/</a>. There you will also find information
on how to fax your purchase order to <CODE>MySQL AB</CODE>. More information
about licensing can be found at
<a HREF="http://www.mysql.com/products/licensing/">http://www.mysql.com/products/licensing/</a>.
If you have
questions regarding licensing or you want a quote for a high-volume
license deal, please fill in the contact form on our Web site
(<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>) or send email
to <a HREF="mailto:licensing@mysql.com">licensing@mysql.com</a> (for licensing questions) or to
<a HREF="mailto:sales@mysql.com">sales@mysql.com</a> (for sales inquiries).
See section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>.

</P>
<P>
If you represent a business that is interested in partnering with
<CODE>MySQL AB</CODE>, please send email to <a HREF="mailto:partner@mysql.com">partner@mysql.com</a>.
See section <A HREF="manual.html#Business_Services_Partnering">1.3.1.5  Partnering</A>.

</P>
<P>
For more information on the <CODE>MySQL</CODE> trademark policy, refer to
<a HREF="http://www.mysql.com/company/trademark.html">http://www.mysql.com/company/trademark.html</a> or send email to
<a HREF="mailto:trademark@mysql.com">trademark@mysql.com</a>.
See section <A HREF="manual.html#MySQL_AB_Logos_and_Trademarks">1.4.4  MySQL AB Logos and Trademarks</A>.

</P>
<P>
If you are interested in any of the <CODE>MySQL AB</CODE> jobs listed in our
jobs section (<a HREF="http://www.mysql.com/company/jobs/">http://www.mysql.com/company/jobs/</a>),
please send email to <a HREF="mailto:jobs@mysql.com">jobs@mysql.com</a>.
Please do not send your CV as an attachment, but rather as plain text
at the end of your email message.

</P>
<P>
For general discussion among our many users, please direct your
attention to the appropriate mailing list.
See section <A HREF="manual.html#Questions">1.7.1  MySQL Mailing Lists</A>.

</P>
<P>
Reports of errors (often called ``bugs''), as well as questions and
comments, should be sent to the general MySQL mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
If you have found a sensitive security bug in <CODE>MySQL Server</CODE>, please let
us know immediately by sending an email message to <a HREF="mailto:security@mysql.com">security@mysql.com</a>.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

</P>
<P>
If you have benchmark results that we can publish, please
contact us via email at <a HREF="mailto:benchmarks@mysql.com">benchmarks@mysql.com</a>.

</P>
<P>
If you have suggestions concerning additions or corrections to this
manual, please send them to the manual team via email at <a HREF="mailto:docs@mysql.com">docs@mysql.com</a>.

</P>
<P>
For questions or comments about the workings or content of the
<CODE>MySQL</CODE> Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>),
please send email to <a HREF="mailto:webmaster@mysql.com">webmaster@mysql.com</a>.

</P>
<P>
<CODE>MySQL AB</CODE> has a privacy policy, which can be read at
<a HREF="http://www.mysql.com/company/privacy.html">http://www.mysql.com/company/privacy.html</a>.
For any queries regarding this policy, please send email to
<a HREF="mailto:privacy@mysql.com">privacy@mysql.com</a>.

</P>
<P>
For all other inquires, please send an email to <a HREF="mailto:info@mysql.com">info@mysql.com</a>.

</P>



<H2><A NAME="Licensing_and_Support" HREF="manual_toc.html#Licensing_and_Support">1.4  MySQL Support and Licensing</A></H2>

<P>
<A NAME="IDX57"></A>
<A NAME="IDX58"></A>

</P>
<P>
This section describes <CODE>MySQL</CODE> support and licensing arrangements.

</P>



<H3><A NAME="Support" HREF="manual_toc.html#Support">1.4.1  Support Offered by MySQL AB</A></H3>

<P>
<A NAME="IDX59"></A>
<A NAME="IDX60"></A>
<A NAME="IDX61"></A>
<A NAME="IDX62"></A>
<A NAME="IDX63"></A>
<A NAME="IDX64"></A>
<A NAME="IDX65"></A>

</P>
<P>
Technical support from <CODE>MySQL AB</CODE> means individualized answers
to your unique problems direct from the software engineers who code
the <CODE>MySQL</CODE> database engine.

</P>
<P>
We try to take a broad and inclusive view of technical support. Almost
any problem involving <CODE>MySQL</CODE> software is important to us if it's
important to you.
Typically customers seek help on how to get different commands and
utilities to work, remove performance bottlenecks, restore crashed
systems, understand the impact of operating system or networking issues
on <CODE>MySQL</CODE>,
set up best practices for backup and recovery, utilize APIs, and so on.
Our support covers only the <CODE>MySQL</CODE> server and our own utilities,
not third-party products that access the <CODE>MySQL</CODE> server, although we
try to help with these where we can.

</P>
<P>
Detailed information about our various support options is given at
<a HREF="http://www.mysql.com/support/">http://www.mysql.com/support/</a>, where support contracts can also be
ordered online. If you have restricted access to the Internet, please contact
our sales staff via email at <a HREF="mailto:sales@mysql.com">sales@mysql.com</a>.

</P>
<P>
Technical support is like life insurance. You can live happily
without it for years. However, when your hour arrives, it becomes
critically important, but it's too late to buy it.
If you use <CODE>MySQL Server</CODE> for important applications and encounter
sudden difficulties, it may be too time-consuming to figure out all the
answers yourself. You may need immediate access to the most experienced
<CODE>MySQL</CODE> troubleshooters available, those employed by <CODE>MySQL AB</CODE>.

</P>



<H3><A NAME="Copyright" HREF="manual_toc.html#Copyright">1.4.2  Copyrights and Licenses Used by MySQL</A></H3>

<P>
<A NAME="IDX66"></A>
<A NAME="IDX67"></A>

</P>
<P>
<CODE>MySQL AB</CODE> owns the copyright to the <CODE>MySQL</CODE> source code,
the <CODE>MySQL</CODE> logos and trademarks, and this manual.
See section <A HREF="manual.html#What_is_MySQL_AB">1.3  Overview of MySQL AB</A>.
Several different licenses are relevant to the <CODE>MySQL</CODE>
distribution:

</P>

<OL>
<LI>

All the <CODE>MySQL</CODE>-specific source in the server, the <CODE>mysqlclient</CODE>
library and the client, as well as the <CODE>GNU</CODE> <CODE>readline</CODE> library,
are covered by the <CODE>GNU General Public License</CODE>.
See section <A HREF="manual.html#GPL_license">G  GNU General Public License</A>.
The text of this license can be found as the file <TT>`COPYING'</TT>
in the distribution.

<LI>

The <CODE>GNU</CODE> <CODE>getopt</CODE> library is covered by the
<CODE>GNU Lesser General Public License</CODE>.
See http://www.fsf.org/licenses/.

<LI>

Some parts of the source (the <CODE>regexp</CODE> library) are covered
by a Berkeley-style copyright.

<LI>

Older versions of <CODE>MySQL</CODE> (3.22 and earlier) are subject to a
stricter license
(<a HREF="http://www.mysql.com/products/licensing/mypl.html">http://www.mysql.com/products/licensing/mypl.html</a>).
See the documentation of the specific version for information.

<LI>

The <CODE>MySQL</CODE> reference manual is currently <STRONG>not</STRONG> distributed 
under a <CODE>GPL</CODE>-style license. Use of the manual is subject to the 
following terms:

<UL>
<LI>

Conversion to other formats is allowed, but the actual content
may not be altered or edited in any way.
<LI>

You may create a printed copy for your own personal use.
<LI>

For all other uses, such as selling printed copies or using
(parts of) the manual in another publication, prior written
agreement from <CODE>MySQL AB</CODE> is required.
</UL>

Please send an email message to <a HREF="mailto:docs@mysql.com">docs@mysql.com</a> for more information or
if you are interested in doing a translation.
</OL>

<P>
For information about how the <CODE>MySQL</CODE> licenses work in practice,
please refer to section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>.
Also see section <A HREF="manual.html#MySQL_AB_Logos_and_Trademarks">1.4.4  MySQL AB Logos and Trademarks</A>.

</P>



<H3><A NAME="MySQL_licenses" HREF="manual_toc.html#MySQL_licenses">1.4.3  MySQL Licenses</A></H3>

<P>
<A NAME="IDX68"></A>
<A NAME="IDX69"></A>
<A NAME="IDX70"></A>
<A NAME="IDX71"></A>
<A NAME="IDX72"></A>
<A NAME="IDX73"></A>
<A NAME="IDX74"></A>
<A NAME="IDX75"></A>

</P>
<P>
The <CODE>MySQL</CODE> software is released under the
<CODE>GNU General Public License</CODE> (<CODE>GPL</CODE>),
which is probably the best known <CODE>Open Source</CODE> license.
The formal terms of the <CODE>GPL</CODE> license can be found at
<a HREF="http://www.fsf.org/licenses/">http://www.fsf.org/licenses/</a>.
See also <a HREF="http://www.fsf.org/licenses/gpl-faq.html">http://www.fsf.org/licenses/gpl-faq.html</a> and
<a HREF="http://www.gnu.org/philosophy/enforcing-gpl.html">http://www.gnu.org/philosophy/enforcing-gpl.html</a>.

</P>
<P>
Since the <CODE>MySQL</CODE> software is released under the <CODE>GPL</CODE>,
it may often be used for free, but for certain uses you may want
or need to buy commercial licenses from <CODE>MySQL AB</CODE> at
<a HREF="https://order.mysql.com/">https://order.mysql.com/</a>.
See <a HREF="http://www.mysql.com/products/licensing/">http://www.mysql.com/products/licensing/</a> for
more information.

</P>
<P>
Older versions of <CODE>MySQL</CODE> (3.22 and earlier) are subject to a
stricter license
(<a HREF="http://www.mysql.com/products/licensing/mypl.html">http://www.mysql.com/products/licensing/mypl.html</a>).
See the documentation of the specific version for information.

</P>
<P>
Please note that the use of the <CODE>MySQL</CODE> software under commercial
license, <CODE>GPL</CODE>, or the old <CODE>MySQL</CODE> license does not
automatically give you the right to use <CODE>MySQL AB</CODE> trademarks.
See section <A HREF="manual.html#MySQL_AB_Logos_and_Trademarks">1.4.4  MySQL AB Logos and Trademarks</A>.

</P>



<H4><A NAME="Using_the_MySQL_software_under_a_commercial_license" HREF="manual_toc.html#Using_the_MySQL_software_under_a_commercial_license">1.4.3.1  Using the MySQL Software Under a Commercial License</A></H4>

<P>
The <CODE>GPL</CODE> license is contagious in the sense that when a program
is linked to a <CODE>GPL</CODE> program, all the source code for all the parts
of the resulting product must also be released under the <CODE>GPL</CODE>.
If you do not follow this <CODE>GPL</CODE> requirement, you break the license 
terms and forfeit your right to use the <CODE>GPL</CODE> program altogether. 
You also risk damages.

</P>
<P>
You need a commercial license:

</P>

<UL>
<LI>

When you link a program with any <CODE>GPL</CODE> code from the <CODE>MySQL</CODE>
software and don't want the resulting product to be licensed under <CODE>GPL</CODE>, 
perhaps because you want to build a commercial product or keep the added
non-<CODE>GPL</CODE> code closed source for other reasons. When purchasing
commercial licenses, you are not using the <CODE>MySQL</CODE> software under
<CODE>GPL</CODE> even though it's the same code.

<LI>

When you distribute a non-<CODE>GPL</CODE> application that <STRONG>only</STRONG> works with the
<CODE>MySQL</CODE> software and ship it with the <CODE>MySQL</CODE> software. This type
of solution is considered to be linking even if it's done over a network.

<LI>

When you distribute copies of the <CODE>MySQL</CODE> software without providing
the source code as required under the <CODE>GPL</CODE> license.

<LI>

When you want to support the further development of the <CODE>MySQL</CODE>
database even if you don't formally need a commercial license.
Purchasing support directly from <CODE>MySQL AB</CODE> is another good way
of contributing to the development of the <CODE>MySQL</CODE> software, with
immediate advantages for you.
See section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.
</UL>

<P>
If you require a license, you will need one for each installation of the
<CODE>MySQL</CODE> software. This covers any number of CPUs on a machine, and there
is no artificial limit on the number of clients that connect to the server
in any way.

</P>
<P>
For commercial licenses, please visit our Web site at
<a HREF="http://www.mysql.com/products/licensing/">http://www.mysql.com/products/licensing/</a>.
For support contracts, see <a HREF="http://www.mysql.com/support/">http://www.mysql.com/support/</a>.
If you have special needs or you have restricted access to the Internet,
please contact our sales staff via email at <a HREF="mailto:sales@mysql.com">sales@mysql.com</a>.

</P>



<H4><A NAME="Using_the_MySQL_software_for_free_under_GPL" HREF="manual_toc.html#Using_the_MySQL_software_for_free_under_GPL">1.4.3.2  Using the MySQL Software for Free Under GPL</A></H4>

<P>
<A NAME="IDX76"></A>
<A NAME="IDX77"></A>

</P>
<P>
You can use the <CODE>MySQL</CODE> software for free under the <CODE>GPL</CODE> if
you adhere to the conditions of the <CODE>GPL</CODE>.
For additional details, including answers to common questions about the <CODE>GPL</CODE>,
see the generic FAQ from the Free Software Foundation at
<a HREF="http://www.fsf.org/licenses/gpl-faq.html">http://www.fsf.org/licenses/gpl-faq.html</a>. 
Common uses of the <CODE>GPL</CODE> include:

</P>

<UL>
<LI>

When you distribute both your own application and the <CODE>MySQL</CODE>
source code under the <CODE>GPL</CODE> with your product.

<LI>

When you distribute the <CODE>MySQL</CODE> source code bundled with other
programs that are not linked to or dependent on the <CODE>MySQL</CODE> system
for their functionality even if you sell the distribution commercially.
This is called ``mere aggregation'' in the <CODE>GPL</CODE> license.

<LI>

When you are not distributing <STRONG>any</STRONG> part of the <CODE>MySQL</CODE>
system, you can use it for free.

<LI>

<A NAME="IDX78"></A>
<A NAME="IDX79"></A>
<A NAME="IDX80"></A>
<A NAME="IDX81"></A>
When you are an Internet Service Provider (ISP), offering Web hosting
with <CODE>MySQL</CODE> servers for your customers.
We encourage people to use ISPs that have MySQL support,
because doing so will give them the confidence that their ISP will, in fact, 
have the resources to solve any problems they may experience with 
the <CODE>MySQL</CODE> installation. Even if an ISP does not have
a commercial license for <CODE>MySQL Server</CODE>, their customers 
should at least be given read access to the source of the <CODE>MySQL</CODE>
installation so that the customers can verify that it is correctly patched.

<LI>

<A NAME="IDX82"></A>
<A NAME="IDX83"></A>
When you use the <CODE>MySQL</CODE> database software in conjunction with a
Web server, you do not need a commercial license (so long as it is not
a product you distribute). This is true even if you run a commercial
Web server that uses <CODE>MySQL Server</CODE>, because you are not
distributing any part of the <CODE>MySQL</CODE> system. However, in this
case we would like you to purchase <CODE>MySQL</CODE> support because the
<CODE>MySQL</CODE> software is helping your enterprise.
</UL>

<P>
If your use of <CODE>MySQL</CODE> database software does not require a commercial
license, we encourage you to purchase support from <CODE>MySQL AB</CODE> anyway.
This way you contribute toward <CODE>MySQL</CODE> development and also gain
immediate advantages for yourself. See section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.

</P>
<P>
If you use the <CODE>MySQL</CODE> database software in a commercial context
such that you profit by its use, we ask that you further the development
of the <CODE>MySQL</CODE> software by purchasing some level of support.  We feel
that if the <CODE>MySQL</CODE> database helps your business, it is reasonable to
ask that you help <CODE>MySQL AB</CODE>.
(Otherwise, if you ask us support questions, you are not only using
for free something into which we've put a lot a work, you're asking
us to provide free support, too.)

</P>



<H3><A NAME="MySQL_AB_Logos_and_Trademarks" HREF="manual_toc.html#MySQL_AB_Logos_and_Trademarks">1.4.4  MySQL AB Logos and Trademarks</A></H3>

<P>
<A NAME="IDX84"></A>
<A NAME="IDX85"></A>

</P>
<P>
Many users of the <CODE>MySQL</CODE> database want to display the
<CODE>MySQL AB</CODE> dolphin logo on their Web sites, books, or
boxed products. We welcome and encourage this, although it should be
noted that the word <CODE>MySQL</CODE> and the <CODE>MySQL</CODE> dolphin logo
are trademarks of <CODE>MySQL AB</CODE> and may only be used as stated in
our trademark policy at
<a HREF="http://www.mysql.com/company/trademark.html">http://www.mysql.com/company/trademark.html</a>.

</P>



<H4><A NAME="The_Original_MySQL_logo" HREF="manual_toc.html#The_Original_MySQL_logo">1.4.4.1  The Original MySQL Logo</A></H4>

<P>
The <CODE>MySQL</CODE> dolphin logo was designed by the Finnish advertising
agency Priority in 2001.  The dolphin was chosen as a suitable symbol
for the <CODE>MySQL</CODE> database management system, which is like a smart,
fast, and lean animal, effortlessly navigating oceans of data. We also
happen to like dolphins.

</P>
<P>
The original <CODE>MySQL</CODE> logo may only be used by representatives of
<CODE>MySQL AB</CODE> and by those having a written agreement allowing them
to do so.

</P>



<H4><A NAME="MySQL_Logos_that_may_be_Used_Without_Written_Permission" HREF="manual_toc.html#MySQL_Logos_that_may_be_Used_Without_Written_Permission">1.4.4.2  MySQL Logos That May Be Used Without Written Permission</A></H4>

<P>
We have designed a set of special <EM>Conditional Use</EM> logos that may be
downloaded from our Web site at
<a HREF="http://www.mysql.com/press/logos.html">http://www.mysql.com/press/logos.html</a>
and used on third-party Web sites without written permission from
<CODE>MySQL AB</CODE>.
The use of these logos is not entirely unrestricted but, as the name
implies, subject to our trademark policy that is also available on our
Web site. You should read through the trademark policy if you plan to
use them. The requirements are basically as follows:

</P>

<UL>
<LI>

Use the logo you need as displayed on the <a HREF="http://www.mysql.com/">http://www.mysql.com/</a>
site. You may scale it to fit your needs, but may not change colors or design,
or alter the graphics in any way.

<LI>

Make it evident that you, and not <CODE>MySQL AB</CODE>, are the creator and
owner of the site that displays the <CODE>MySQL</CODE> trademark.

<LI>

Don't use the trademark in a way that is detrimental to <CODE>MySQL AB</CODE>
or to the value of <CODE>MySQL AB</CODE> trademarks. We reserve the right to
revoke the right to use the <CODE>MySQL AB</CODE> trademark.

<LI>

If you use the trademark on a Web site, make it clickable, leading directly
to <a HREF="http://www.mysql.com/">http://www.mysql.com/</a>.

<LI>

If you use the <CODE>MySQL</CODE> database under <CODE>GPL</CODE> in an
application, your application must be <CODE>Open Source</CODE> and must
be able to connect to a <CODE>MySQL</CODE> server.
</UL>

<P>
Contact us via email at <a HREF="mailto:trademark@mysql.com">trademark@mysql.com</a> to inquire about special
arrangements to fit your needs.

</P>


<H4><A NAME="When_need_MySQL_logo_permission" HREF="manual_toc.html#When_need_MySQL_logo_permission">1.4.4.3  When You Need Written Permission to Use MySQL Logos</A></H4>

<P>
You need written permission from <CODE>MySQL AB</CODE> before using <CODE>MySQL</CODE> 
logos in the following cases:

</P>

<UL>
<LI>

When displaying any <CODE>MySQL AB</CODE> logo anywhere except on your Web site.

<LI>

When displaying any <CODE>MySQL AB</CODE> logo except the <EM>Conditional Use</EM>
logos (mentioned previously) on Web sites or elsewhere.
</UL>

<P>
Due to legal and commercial reasons, we monitor the use of MySQL
trademarks on products, books, and other items. We usually require a fee for
displaying <CODE>MySQL AB</CODE> logos on commercial products, since we think
it is reasonable that some of the revenue is returned to fund further
development of the <CODE>MySQL</CODE> database.

</P>



<H4><A NAME="MySQL_AB_Partnership_Logos" HREF="manual_toc.html#MySQL_AB_Partnership_Logos">1.4.4.4  MySQL AB Partnership Logos</A></H4>

<P>
<CODE>MySQL</CODE> partnership logos may be used only by companies and persons
having a written partnership agreement with <CODE>MySQL AB</CODE>. Partnerships
include certification as a <CODE>MySQL</CODE> trainer or consultant.
For more information, please see section <A HREF="manual.html#Business_Services_Partnering">1.3.1.5  Partnering</A>.

</P>



<H4><A NAME="Using_MySQL_word_in_presentations" HREF="manual_toc.html#Using_MySQL_word_in_presentations">1.4.4.5  Using the Word <CODE>MySQL</CODE> in Printed Text or Presentations</A></H4>

<P>
<CODE>MySQL AB</CODE> welcomes references to the <CODE>MySQL</CODE> database, but
it should be noted that the word <CODE>MySQL</CODE> is a trademark of <CODE>MySQL AB</CODE>.
Because of this, you must append the trademark symbol (<CODE>TM</CODE>) to
the first or most prominent use of the word <CODE>MySQL</CODE> in a text and,
where appropriate, state that <CODE>MySQL</CODE> is a trademark of
<CODE>MySQL AB</CODE>. For more information, please refer to our trademark policy at
<a HREF="http://www.mysql.com/company/trademark.html">http://www.mysql.com/company/trademark.html</a>.

</P>



<H4><A NAME="Using_MySQL_word_in_company_and_product_names" HREF="manual_toc.html#Using_MySQL_word_in_company_and_product_names">1.4.4.6  Using the Word <CODE>MySQL</CODE> in Company and Product Names</A></H4>

<P>
Use of the word <CODE>MySQL</CODE> in product or company names or in Internet
domain names is not allowed without written permission from <CODE>MySQL AB</CODE>.

</P>



<H2><A NAME="Roadmap" HREF="manual_toc.html#Roadmap">1.5  MySQL Development Roadmap</A></H2>

<P>
This section provides a snapshot of the MySQL development roadmap, including
major features implemented or planned for MySQL 4.0, 4.1, 5.0, and 5.1.
The following sections provide information for each release series.

</P>
<P>
The production release series is MySQL 4.0, which was declared stable
for production use as of Version 4.0.12, released in March 2003. This
means that future 4.0 development will be limited only to making
bugfixes. For the older MySQL 3.23 series, only critical bugfixes will
be made.

</P>
<P>
Active MySQL development currently is taking place in the MySQL 4.1 and
5.0 release series. This means that new features are being added to MySQL
4.1 and MySQL 5.0. Both 4.1 and 5.0 are available now in alpha status.

</P>
<P>
Before upgrading from one release series to the next, please see the notes
at section <A HREF="manual.html#Upgrade">2.5  Upgrading/Downgrading MySQL</A>.

</P>
<P>
Plans for some of the most requested features are summarized in the following
table.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Feature</STRONG> </TD><TD> <STRONG>MySQL Version</STRONG>
</TD></TR>
<TR><TD>Unions </TD><TD> 4.0
</TD></TR>
<TR><TD>Subqueries </TD><TD> 4.1
</TD></TR>
<TR><TD>R-trees </TD><TD> 4.1 (for <CODE>MyISAM</CODE> tables)
</TD></TR>
<TR><TD>Stored procedures </TD><TD> 5.0
</TD></TR>
<TR><TD>Views </TD><TD> 5.0 or 5.1
</TD></TR>
<TR><TD>Cursors </TD><TD> 5.0
</TD></TR>
<TR><TD>Foreign keys </TD><TD> 5.1 (already implemented in 3.23 for <CODE>InnoDB</CODE>)
</TD></TR>
<TR><TD>Triggers </TD><TD> 5.1
</TD></TR>
<TR><TD>Full outer join </TD><TD> 5.1
</TD></TR>
<TR><TD>Constraints </TD><TD> 5.1
</TD></TR>
</TABLE>



<H3><A NAME="MySQL_4.0_Nutshell" HREF="manual_toc.html#MySQL_4.0_Nutshell">1.5.1  MySQL 4.0 in a Nutshell</A></H3>

<P>
Long awaited by our users, MySQL Server 4.0 is now available in production
status.

</P>
<P>
MySQL 4.0 is available for download at <a HREF="http://dev.mysql.com/">http://dev.mysql.com/</a>
and from our mirrors. MySQL 4.0 has been tested by a large number of users
and is in production use at many large sites.

</P>
<P>
The major new features of MySQL Server 4.0 are geared toward our existing
business and community users, enhancing the MySQL database software
as the solution for mission-critical, heavy-load database systems.
Other new features target the users of embedded databases.

</P>



<H4><A NAME="Nutshell_4.0_features" HREF="manual_toc.html#Nutshell_4.0_features">1.5.1.1  Features Available in MySQL 4.0</A></H4>

<DL COMPACT>

<DT>Speed enhancements
<DD>

<UL>
<LI>

MySQL 4.0 has a query cache that can give a huge speed boost to
applications with repetitive queries. See section <A HREF="manual.html#Query_Cache">5.10  The MySQL Query Cache</A>.

<LI>

Version 4.0 further increases the speed of MySQL Server
in a number of areas, such as bulk <CODE>INSERT</CODE> statements, searching on
packed indexes, full-text searching (using <CODE>FULLTEXT</CODE> indexes), and
<CODE>COUNT(DISTINCT)</CODE>.
</UL>

<DT>Embedded MySQL Server introduced
<DD>

<UL>
<LI>

The new Embedded Server library can easily be used to create standalone and
embedded applications.  The embedded server provides an alternative to using
MySQL in a client/server environment.
See section <A HREF="manual.html#Nutshell_Embedded_MySQL">1.5.1.2  The Embedded MySQL Server</A>.
</UL>

<DT><CODE>InnoDB</CODE> storage engine as standard
<DD>

<UL>
<LI>

The <CODE>InnoDB</CODE> storage engine is now offered as a standard feature of the
<CODE>MySQL</CODE> server. This means full support for ACID transactions, foreign
keys with cascading <CODE>UPDATE</CODE> and <CODE>DELETE</CODE>, and row-level locking
are now standard features.
See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.
</UL>

<DT>New functionality
<DD>

<UL>
<LI>

The enhanced <CODE>FULLTEXT</CODE> search properties of MySQL Server 4.0 enables
<CODE>FULLTEXT</CODE> indexing of large text masses with both binary
and natural-language searching logic. You can customize minimal word
length and define your own stop word lists in any human language,
enabling a new set of applications to be built with MySQL Server.
See section <A HREF="manual.html#Fulltext_Search">13.6  Full-Text Search Functions</A>.
</UL>

<DT>Standards compliance, portability, and migration
<DD>

<UL>
<LI>

Many users will also be happy to learn that MySQL Server now supports the
<CODE>UNION</CODE> statement, a long-awaited standard SQL feature.

<LI>

MySQL now runs natively on the Novell NetWare 6.0 platform.
See section <A HREF="manual.html#NetWare_installation">2.2.4  Installing MySQL on NetWare</A>.

<LI>

Features to simplify migration from other database systems to MySQL
Server include <CODE>TRUNCATE TABLE</CODE> (as in Oracle).
</UL>

<DT>Internationalization
<DD>

<UL>
<LI>

Our German, Austrian, and Swiss users will note that <CODE>MySQL</CODE> now
supports a new character set, <CODE>latin1_de</CODE>, which ensures that the 
<EM>German sorting order</EM> sorts words with umlauts in the same order 
as do German telephone books.
</UL>

<DT>Usability enhancements
<DD>
In the process of implementing features for new users, we have not forgotten
requests from our loyal community of existing users.


<UL>
<LI>

Most <CODE>mysqld</CODE> parameters (startup options) can now be set without taking
down the server. This is a convenient feature for database administrators
(DBAs).
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<LI>

Multiple-table <CODE>DELETE</CODE> and <CODE>UPDATE</CODE> statements have been added.

<LI>

On Windows, symbolic link handling at the database level is enabled by default.
On Unix, the <CODE>MyISAM</CODE> storage engine now supports symbolic
linking at the table level (and not just the database level as before).

<LI>

<CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>FOUND_ROWS()</CODE> are new functions that make it
possible to find out the number of rows a <CODE>SELECT</CODE> query that includes a
<CODE>LIMIT</CODE> clause would have returned without that clause.
</UL>

</DL>

<P>
The news section of this manual includes a more in-depth list of features.
See section <A HREF="manual.html#News-4.0.x">C.3  Changes in release 4.0.x (Production)</A>.

</P>



<H4><A NAME="Nutshell_Embedded_MySQL" HREF="manual_toc.html#Nutshell_Embedded_MySQL">1.5.1.2  The Embedded MySQL Server</A></H4>

<P>
The <CODE>libmysqld</CODE> embedded server library makes MySQL Server suitable for
a vastly expanded realm of applications. By using this library, developers can
embed MySQL Server into various applications and electronics devices, where
the end user has no knowledge of there actually being an underlying
database. Embedded MySQL Server is ideal for use behind
the scenes in Internet appliances, public kiosks, turnkey
hardware/software combination units, high performance Internet
servers, self-contained databases distributed on CD-ROM, and so on.

</P>
<P>
Many users of <CODE>libmysqld</CODE> will benefit from the MySQL
<EM>Dual Licensing</EM>. For those not wishing to be bound by the <CODE>GPL</CODE>,
the software is also made available under a commercial license.
The embedded MySQL library uses the same interface as the normal
client library, so it is convenient and easy to use.
See section <A HREF="manual.html#libmysqld">20.2.15  libmysqld, the Embedded MySQL Server Library</A>.

</P>



<H3><A NAME="MySQL_4.1_Nutshell" HREF="manual_toc.html#MySQL_4.1_Nutshell">1.5.2  MySQL 4.1 in a Nutshell</A></H3>

<P>
MySQL Server 4.0 laid the foundation for new features implemented in MySQL
4.1, such as subqueries and Unicode support,
and for the work on stored procedures being done in version 5.0.
These features come at the top of the wish list of many of our customers.

</P>
<P>
With these additions, critics of the MySQL Database Server have to be
more imaginative than ever in pointing out deficiencies in the MySQL
database management system. Already well-known for its stability,
speed, and ease of use, MySQL Server will be able to fulfill the requirement
checklists of very demanding buyers.

</P>



<H4><A NAME="Nutshell_4.1_features" HREF="manual_toc.html#Nutshell_4.1_features">1.5.2.1  Features Available in MySQL 4.1</A></H4>

<P>
The features listed in this section are implemented in MySQL 4.1. A few other
features are still planned for MySQL 4.1. See section <A HREF="manual.html#TODO_MySQL_4.1">1.6.1  New Features Planned for 4.1</A>.

</P>
<P>
Most new features being coded are or will be available in MySQL 5.0.
See section <A HREF="manual.html#TODO_MySQL_5.0">1.6.2  New Features Planned for 5.0</A>.

</P>
<DL COMPACT>

<DT>Support for subqueries and derived tables
<DD>

<UL>
<LI>

A ``subquery'' is a <CODE>SELECT</CODE> statement nested within another statement.
A ``derived table'' (an unnamed view) is a subquery in the <CODE>FROM</CODE> clause
of another statement.
See section <A HREF="manual.html#Subqueries">14.1.8  Subquery Syntax</A>.
</UL>

<DT>Speed enhancements
<DD>

<UL>
<LI>

Faster binary client/server protocol with support for prepared statements
and parameter binding.
See section <A HREF="manual.html#C_API_Prepared_statements">20.2.4  C API Prepared Statements</A>.
<LI>

<CODE>BTREE</CODE> indexing is now supported for <CODE>HEAP</CODE> tables,
significantly improving response time for non-exact searches.
</UL>

<DT>New functionality
<DD>

<UL>
<LI>

<CODE>CREATE TABLE tbl_name2 LIKE tbl_name1</CODE> allows you to create, with
a single statement, a new table with a structure exactly like that of an
existing table.
<LI>

The <CODE>MyISAM</CODE> storage engine now supports
OpenGIS spatial types for storing geographical data.
See section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.
<LI>

Replication can be done over SSL connections.
</UL>

<DT>Standards compliance, portability, and migration
<DD>

<UL>
<LI>

The new client/server protocol adds the ability to pass multiple
warnings to the client, rather than only a single result. This
makes operations such as bulk data loading much easier to track.
<LI>

<CODE>SHOW WARNINGS</CODE> shows warnings for the last command.
See section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.
</UL>

<DT>Internationalization
<DD>

<UL>
<LI>

To support applications that require the use of local languages,
the MySQL software now offers extensive
Unicode support through the <CODE>utf8</CODE> and <CODE>ucs2</CODE> character sets.
<LI>

Character sets can now be defined per column, table, and database.
This allows for a high degree of flexibility in application design,
particularly for multi-language Web sites.
<LI>

For documentation for this improved character set support,
see section <A HREF="manual.html#Charset">11  Character Set Support</A>.
</UL>

<DT>Usability enhancements
<DD>

<UL>
<LI>

In response to popular demand, we have added a server-based
<CODE>HELP</CODE> command that can be used
to get help information for SQL statements.
The advantage of having this information on the server side is that the
information is always applicable to the particular server version that you
actually are using.
Because this information is available by issuing an SQL statement, any client
can be written to access it.
For example, the <CODE>help</CODE> command of the <CODE>mysql</CODE> command-line client
has been modified to have this capability.
<LI>

In the new client/server protocol, multiple statements can be issued with
a single call.
See section <A HREF="manual.html#C_API_multiple_queries">20.2.8  C API Handling of Multiple Query Execution</A>.
<LI>

The new client/server protocol also supports returning multiple result sets.
This might occur as a result of sending multiple statements, for example.
<LI>

A new <CODE>INSERT ... ON DUPLICATE KEY UPDATE ...</CODE> syntax has been
implemented. This allows you to <CODE>UPDATE</CODE> an existing row if the
<CODE>INSERT</CODE> would have caused a duplicate in a <CODE>PRIMARY</CODE> or
<CODE>UNIQUE</CODE> key (index).
See section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>.
<LI>

A new aggregate function, <CODE>GROUP_CONCAT()</CODE>
adds the extremely useful capability of concatenating column values from
grouped rows into a single result string.
See section <A HREF="manual.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A>.
</UL>

</DL>

<P>
The news section of this manual includes a more in-depth list of features.
See section <A HREF="manual.html#News-4.1.x">C.2  Changes in release 4.1.x (Alpha)</A>.

</P>



<H4><A NAME="Nutshell_Stepwise_Rollout" HREF="manual_toc.html#Nutshell_Stepwise_Rollout">1.5.2.2  Stepwise Rollout</A></H4>

<P>
New features are being added to MySQL 4.1. The alpha version is already
available for download. See section <A HREF="manual.html#Nutshell_Ready_for_Immediate_Use">1.5.2.3  Ready for Immediate Development Use</A>.

</P>
<P>
The set of features that are being added to version 4.1 is mostly
fixed. Additional development is already ongoing for version 5.0.
MySQL 4.1 will go through the steps of
<EM>Alpha</EM> (during which time new features might still be added/changed),
<EM>Beta</EM> (when we have feature freeze and only bug corrections will be done),
and <EM>Gamma</EM> (indicating that a production release is just weeks ahead).
At the end of this process, MySQL 4.1 will become the new production release.

</P>



<H4><A NAME="Nutshell_Ready_for_Immediate_Use" HREF="manual_toc.html#Nutshell_Ready_for_Immediate_Use">1.5.2.3  Ready for Immediate Development Use</A></H4>

<P>
MySQL 4.1 is currently in the alpha stage, and binaries are available
for download at <a HREF="http://dev.mysql.com/downloads/mysql/4.1.html">http://dev.mysql.com/downloads/mysql/4.1.html</a>.
All binary releases pass our extensive test suite without any errors on
the platforms on which we test.
See section <A HREF="manual.html#News-4.1.x">C.2  Changes in release 4.1.x (Alpha)</A>.

</P>
<P>
For those wishing to use the most recent development source for MySQL 4.1,
we make our 4.1 BitKeeper repository publicly available.
See section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.

</P>



<H3><A NAME="MySQL_5.0_Nutshell" HREF="manual_toc.html#MySQL_5.0_Nutshell">1.5.3  MySQL 5.0: The Next Development Release</A></H3>

<P>
New development for MySQL is focused on the 5.0 release, featuring
stored procedures and other new features.
See section <A HREF="manual.html#TODO_MySQL_5.0">1.6.2  New Features Planned for 5.0</A>.

</P>
<P>
For those wishing to take a look at the bleeding edge of MySQL
development, we make our BitKeeper repository for
MySQL version 5.0 publicly available.
See section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.
As of December 2003, binary builds of version 5.0 are also available.

</P>



<H2><A NAME="TODO" HREF="manual_toc.html#TODO">1.6  MySQL and the Future (the TODO)</A></H2>

<P>
<A NAME="IDX86"></A>

</P>

<P>
This section summarizes the features that we plan to implement in
<CODE>MySQL Server</CODE>. The items are ordered by release series. Within a list,
items are shown in approximately the order they will be done.

</P>
<P>
<STRONG>Note:</STRONG> If you are an enterprise-level user with an urgent need
for a particular feature, please contact <a HREF="mailto:sales@mysql.com">sales@mysql.com</a> to
discuss sponsoring options. Targeted financing by sponsor companies
allows us to allocate additional resources for specific purposes.
One example of a feature sponsored in the past is replication.

</P>



<H3><A NAME="TODO_MySQL_4.1" HREF="manual_toc.html#TODO_MySQL_4.1">1.6.1  New Features Planned for 4.1</A></H3>

<P>
The following features are not yet implemented in MySQL 4.1, but are planned
for implementation before MySQL 4.1 moves into its beta phase.
For a list what is already done in MySQL 4.1, see section <A HREF="manual.html#Nutshell_4.1_features">1.5.2.1  Features Available in MySQL 4.1</A>.

</P>

<UL>
<LI>

Stable OpenSSL support (MySQL 4.0 supports rudimentary, not 100% tested,
support for OpenSSL).
<LI>

More testing of prepared statements.
<LI>

More testing of multiple character sets for one table.
</UL>



<H3><A NAME="TODO_MySQL_5.0" HREF="manual_toc.html#TODO_MySQL_5.0">1.6.2  New Features Planned for 5.0</A></H3>

<P>
The following features are planned for inclusion into MySQL 5.0.
Some of the features such as stored procedures are complete and are
included in MySQL 5.0 alpha, which is available now.  Others such
as cursors are only partially available. Expect these and other
features to mature and be fully supported in upcoming releases.

</P>
<P>
Note that because we have many developers that are working on different
projects, there will also be many additional features. There is also a
small chance that some of these features will be added to MySQL 4.1.
For a list what is already done in MySQL 4.1, see section <A HREF="manual.html#Nutshell_4.1_features">1.5.2.1  Features Available in MySQL 4.1</A>.

</P>
<P>
For those wishing to take a look at the bleeding edge of MySQL
development, we make our BitKeeper repository for
MySQL version 5.0 publicly available.
See section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.
As of December 2003, binary builds of version 5.0 are also available.

</P>
<DL COMPACT>

<DT>Stored Procedures
<DD>

<UL>
<LI>

Stored procedures are currently implemented, based on the SQL:2003
standard.
See section <A HREF="manual.html#Stored_Procedures">19  Stored Procedures and Functions</A>.

</UL>

<DT>New functionality
<DD>

<UL>
<LI>

Elementary cursor support.
See section <A HREF="manual.html#Cursors">19.1.8  Cursors</A>.
<LI>

The ability to specify explicitly for <CODE>MyISAM</CODE> tables that an index
should be created as an <CODE>RTREE</CODE> index.  (In MySQL 4.1, <CODE>RTREE</CODE> indexes
are used internally for geometrical data that use GIS data types, but cannot be
created on request.)
<LI>

Dynamic length rows for <CODE>HEAP</CODE> tables.
</UL>

<DT>Standards compliance, portability and migration
<DD>

<UL>
<LI>

Add true <CODE>VARCHAR</CODE> support (column lengths longer than 255, and
no stripping of trailing whitespace).
(There is already support for this in the <CODE>MyISAM</CODE> storage engine,
but it is not yet available at the user level.)
</UL>

<DT>Speed enhancements
<DD>

<UL>
<LI>

<CODE>SHOW COLUMNS FROM tbl_name</CODE> (used by <CODE>mysql</CODE> client to allow
expansions of column names) should not open the table, only the
definition file. This will require less memory and be much faster.
<LI>

Allow <CODE>DELETE</CODE> on <CODE>MyISAM</CODE> tables to use the record cache.
To do this, we need to update the threads record cache when we update
the <TT>`.MYD'</TT> file.
<LI>

Better support for <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables:

<UL>
<LI>

Dynamic length rows.
<LI>

Faster row handling (less copying).
</UL>

</UL>

<DT>Usability enhancements
<DD>

<UL>
<LI>

Resolving the issue of <CODE>RENAME TABLE</CODE> on a table used in an active
<CODE>MERGE</CODE> table possibly corrupting the table.
</UL>

</DL>

<P>
The news section of this manual includes a more in-depth list of features.
See section <A HREF="manual.html#News-5.0.x">C.1  Changes in release 5.0.x (Development)</A>.

</P>



<H3><A NAME="TODO_MySQL_5.1" HREF="manual_toc.html#TODO_MySQL_5.1">1.6.3  New Features Planned for 5.1</A></H3>

<DL COMPACT>

<DT>New functionality
<DD>

<UL>
<LI>

<CODE>FOREIGN KEY</CODE> support for all table types, not just <CODE>InnoDB</CODE>.
<LI>

Column-level constraints.
<LI>

Online backup with very low performance penalty.  The online backup will
make it easy to add a new replication slave without taking down the
master.
</UL>

<DT>Speed enhancements
<DD>

<UL>
<LI>

New text based table definition file format (<TT>`.frm'</TT> files) and a
table cache for table definitions.  This will enable us to do faster
queries of table structures and do more efficient foreign key support.
<LI>

Optimize the <CODE>BIT</CODE> type to take one bit. (<CODE>BIT</CODE> now takes one byte;
it is treated as a synonym for <CODE>TINYINT</CODE>.)
</UL>

<DT>Usability enhancements
<DD>

<UL>
<LI>

Add options to the client/server protocol to get progress notes
for long running commands.
<LI>

Implement <CODE>RENAME DATABASE</CODE>. To make this safe for all storage engines,
it should work as follows:

<UL>
<LI>

Create the new database.
<LI>

For every table, do a rename of the table to another database, as
we do with the <CODE>RENAME</CODE> command.
<LI>

Drop the old database.
</UL>

<LI>

New internal file interface change.  This will make all file handling much
more general and make it easier to add extensions like RAID.
</UL>

</DL>



<H3><A NAME="TODO_future" HREF="manual_toc.html#TODO_future">1.6.4  New Features Planned for the Near Future</A></H3>

<DL COMPACT>

<DT>New functionality
<DD>

<UL>
<LI>

Oracle-like <CODE>CONNECT BY PRIOR ...</CODE> to search tree-like (hierarchical)
structures.
<LI>

Add all missing standard SQL and ODBC 3.0 types.
<LI>

Add <CODE>SUM(DISTINCT)</CODE>.
<LI>

<CODE>INSERT SQL_CONCURRENT</CODE> and <CODE>mysqld --concurrent-insert</CODE> to do
a concurrent insert at the end of a table if the table is read-locked.
<LI>

Allow variables to be updated in <CODE>UPDATE</CODE> statements. For example:
<CODE>UPDATE TABLE foo SET @a=a+b,a=@a, b=@a+c</CODE>.
<LI>

Change when user variables are updated so that you can use them with
<CODE>GROUP BY</CODE>, as in the following example:
<CODE>SELECT id, @a:=COUNT(*), SUM(sum_col)/@a FROM tbl_name GROUP BY id</CODE>.
<LI>

Add an <CODE>IMAGE</CODE> option to <CODE>LOAD DATA INFILE</CODE> to not update
<CODE>TIMESTAMP</CODE> and <CODE>AUTO_INCREMENT</CODE> fields.
<LI>

Add <CODE>LOAD DATA INFILE ... UPDATE</CODE> syntax that works like this:

<UL>
<LI>

For tables with primary keys, if an input record contains a primary key
value, existing rows matching that primary key value are updated from the
remainder of the input columns. However, columns corresponding to columns
that are <STRONG>missing</STRONG> from the input record are not touched.
<LI>

For tables with primary keys, if an input record does not contain the primary
key value or is missing some part of the key, the record is treated as
<CODE>LOAD DATA INFILE ... REPLACE INTO</CODE>.
</UL>

<LI>

Make <CODE>LOAD DATA INFILE</CODE> understand syntax like:

<PRE>
LOAD DATA INFILE 'file_name.txt' INTO TABLE tbl_name
     TEXT_FIELDS (text_field1, text_field2, text_field3)
     SET table_field1=CONCAT(text_field1, text_field2),
         table_field3=23
     IGNORE text_field3
</PRE>

This can be used to skip over extra columns in the text file,
or update columns based on expressions of the read data.
<LI>

New functions for working with <CODE>SET</CODE> type columns:

<UL>
<LI><CODE>ADD_TO_SET(value,set)</CODE>

<LI><CODE>REMOVE_FROM_SET(value,set)</CODE>

</UL>

<LI>

If you abort <CODE>mysql</CODE> in the middle of a query, you should open
another connection and kill the old running query.
Alternatively, an attempt should be made to detect this in the server.
<LI>

Add a storage engine interface for table information so that you can use it as a system
table. This would be a bit slow if you requested information about all tables,
but very flexible.  <CODE>SHOW INFO FROM tbl_name</CODE> for basic table information
should be implemented.
<LI>

Allow <CODE>SELECT a FROM tbl_name1 LEFT JOIN tbl_name2 USING (a)</CODE>; in this
case <CODE>a</CODE> is assumed to come from the <CODE>tbl_name1</CODE> table.
<LI>

<CODE>DELETE</CODE> and <CODE>REPLACE</CODE> options to the <CODE>UPDATE</CODE> statement
(this will delete rows when a duplicate-key error occurs while updating).
<LI>

Change the format of <CODE>DATETIME</CODE> to store fractions of seconds.
<LI>

Make it possible to use the new GNU <CODE>regexp</CODE> library instead of the current
one (the new library should be much faster than the current one).
</UL>

<DT>Standards compliance, portability and migration
<DD>

<UL>
<LI>

Don't add automatic <CODE>DEFAULT</CODE> values to columns.  Produce an error for
any <CODE>INSERT</CODE> statement that is missing a value for a column that has no
<CODE>DEFAULT</CODE>.
<LI>

Add <CODE>ANY()</CODE>, <CODE>EVERY()</CODE>, and <CODE>SOME()</CODE> group functions. In
standard SQL, these work only on boolean columns, but we can extend these to
work on any columns or expressions by treating 0 values as FALSE and non-zero
values as TRUE.
<LI>

Fix the type of <CODE>MAX(column)</CODE> to be the same as the column type:

<PRE>
mysql&#62; CREATE TABLE t1 (a DATE);
mysql&#62; INSERT INTO t1 VALUES (NOW());
mysql&#62; CREATE TABLE t2 SELECT MAX(a) FROM t1;
mysql&#62; SHOW COLUMNS FROM t2;
</PRE>

</UL>

<DT>Speed enhancements
<DD>

<UL>
<LI>

Don't allow more than a defined number of threads to run <CODE>MyISAM</CODE>
recovery at the same time.
<LI>

Change <CODE>INSERT ... SELECT</CODE> to optionally use concurrent inserts.
<LI>

Add an option to periodically flush key pages for tables with delayed
keys if they haven't been used in a while.
<LI>

Allow join on key parts (optimization issue).
<LI>

Add a log file analyzer that can parse out information about which tables
are hit most often, how often multiple-table joins are executed, and so on. This
should help users identify areas of table design that could be optimized
to execute much more efficient queries.
</UL>

<DT>Internationalization
<DD>

<UL>
</UL>

<DT>Usability enhancements
<DD>

<UL>
<LI>

Return the original column types when doing
<CODE>SELECT MIN(column) ... GROUP BY</CODE>.
<LI>

Make it possible to specify <CODE>long_query_time</CODE> with a granularity
in microseconds.
<LI>

Link the <CODE>myisampack</CODE> code into the server so that it can perform
<CODE>PACK</CODE> or <CODE>COMPRESS</CODE> operations.
<LI>

Add a temporary key buffer cache during <CODE>INSERT/DELETE/UPDATE</CODE> so that we
can gracefully recover if the index file gets full.
<LI>

If you perform an <CODE>ALTER TABLE</CODE> on a table that is symlinked to another
disk, create temporary tables on that disk.
<LI>

Implement a <CODE>DATE/DATETIME</CODE> type that handles time zone information
properly, to make dealing with dates in different time zones easier.
<LI>

Fix <CODE>configure</CODE> so that all libraries (like <CODE>MyISAM</CODE>)
can be compiled without threads.
<LI>

Allow SQL variables as <CODE>LIMIT</CODE> arguments; for example,
<CODE>LIMIT @a,@b</CODE>.
<LI>

Automatic output from <CODE>mysql</CODE> to a Web browser.
<LI>

<CODE>LOCK DATABASES</CODE> (with various options).
<LI>

Many more variables for <CODE>SHOW STATUS</CODE>.  Records reads and
updates.  Selects on a single table and selects with joins.  Mean number of
tables in select. Number of <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> queries.
<LI>

<CODE>mysqladmin copy database new-database</CODE>; this requires a <CODE>COPY</CODE>
operation to be added to <CODE>mysqld</CODE>.
<LI>

Processlist output should indicate the number of queries/threads.
<LI>

<CODE>SHOW HOSTS</CODE> for printing information about the hostname cache.
<LI>

Change table names from empty strings to <CODE>NULL</CODE> for calculated columns.
<LI>

Don't use <CODE>Item_copy_string</CODE> on numerical values to avoid
number-&#62;string-&#62;number conversion in case of:
<CODE>SELECT COUNT(*)*(id+0) FROM tbl_name GROUP BY id</CODE>
<LI>

Change so that <CODE>ALTER TABLE</CODE> doesn't abort clients
that execute <CODE>INSERT DELAYED</CODE>.
<LI>

Fix so that when columns are referenced in an <CODE>UPDATE</CODE> clause,
they contain the old values from before the update started.
</UL>

<DT>New operating systems
<DD>

<UL>
<LI>

Port the MySQL clients to LynxOS.
</UL>

</DL>



<H3><A NAME="TODO_sometime" HREF="manual_toc.html#TODO_sometime">1.6.5  New Features Planned for the Mid-Term Future</A></H3>


<UL>
<LI>

Implement function: <CODE>get_changed_tables(timeout,table1,table2,...)</CODE>.
<LI>

Change reading through tables to use memmap when possible. Now only
compressed tables use memmap.
<LI>

Make the automatic timestamp code nicer.  Add timestamps to the update
log with <CODE>SET TIMESTAMP=#;</CODE>.
<LI>

Use read/write mutex in some places to get more speed.
<LI>

Simple views (implemented in stepwise fashion up to full functionality).
See section <A HREF="manual.html#ANSI_diff_Views">1.8.5.6  Views</A>.
<LI>

Automatically close some tables if a table, temporary table, or temporary file
gets error 23 (too many open files).
<LI>

Better constant propagation. When an occurrence of <CODE>col_name=n</CODE>
is found in an expression, for some constant <CODE>n</CODE>, replace other
occurrences of <CODE>col_name</CODE> within the expression with <CODE>n</CODE>.
Currently, this is done only for some simple cases.
<LI>

Change all const expressions with calculated expressions if possible.
<LI>

Optimize key = expression comparisons. At the moment, only key = field or
key = constant comparisons are optimized.
<LI>

Join some of the copy functions for nicer code.
<LI>

Change <TT>`sql_yacc.yy'</TT> to an inline parser to reduce its size and get
better error messages.
<LI>

Change the parser to use only one rule per different number of arguments
in function.
<LI>

Use of full calculation names in the order part (for ACCESS97).
<LI>

<CODE>MINUS</CODE>, <CODE>INTERSECT</CODE>, and <CODE>FULL OUTER JOIN</CODE>.
(Currently <CODE>UNION</CODE> [in 4.0] and <CODE>LEFT|RIGHT OUTER JOIN</CODE> are supported.)
<LI>

Allow <CODE>SQL_OPTION MAX_SELECT_TIME=#</CODE>, for placing a time limit on a query.
<LI>

Allow updates to be logged to a database.
<LI>

Enhance <CODE>LIMIT</CODE> to allow retrieval of data from the end of a result set.
<LI>

Alarm around client connect/read/write functions.
<LI>

Please note the changes to <CODE>mysqld_safe</CODE>: According to FSSTND (which
Debian tries to follow), PID files should go into <TT>`/var/run/&#60;progname&#62;.pid'</TT>
and log files into <TT>`/var/log'</TT>. It would be nice if you could put the
"DATADIR" in the first declaration of "pidfile" and "log" so that the
placement of these files can be changed with a single statement.
<LI>

Allow a client to request logging.
<LI>

Allow the <CODE>LOAD DATA INFILE</CODE> statement
to read files that have been compressed with <CODE>gzip</CODE>.
<LI>

Fix sorting and grouping of <CODE>BLOB</CODE> columns (partly solved now).
<LI>

Change to use semaphores when counting threads.  One should first implement
a semaphore library for MIT-pthreads.
<LI>

Add full support for <CODE>JOIN</CODE> with parentheses.
<LI>

As an alternative to the one-thread-per-connection model, manage a pool
of threads to handle queries.
<LI>

Allow <CODE>GET_LOCK()</CODE> to obtain more than one lock.  When doing this, it is
also necessary to handle the possible deadlocks this change will introduce.
</UL>



<H3><A NAME="TODO_unplanned" HREF="manual_toc.html#TODO_unplanned">1.6.6  New Features We Don't Plan to Implement</A></H3>

<P>
We aim toward full compliance with ANSI/ISO SQL, so there are no features
we plan not to implement.

</P>



<H2><A NAME="MySQL_Information_Sources" HREF="manual_toc.html#MySQL_Information_Sources">1.7  MySQL Information Sources</A></H2>



<H3><A NAME="Questions" HREF="manual_toc.html#Questions">1.7.1  MySQL Mailing Lists</A></H3>

<P>
<A NAME="IDX87"></A>
<A NAME="IDX88"></A>
<A NAME="IDX89"></A>

</P>

<P>
This section introduces you to the MySQL mailing lists and provides
some guidelines as to how the lists should be used. When you subscribe to a mailing
list, you will receive all postings to the list as email messages. You can 
also to send your own questions and answers to the list.

</P>



<H4><A NAME="Mailing-list" HREF="manual_toc.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A></H4>

<P>
<A NAME="IDX90"></A>
<A NAME="IDX91"></A>

</P>
<P>
To subscribe to or unsubscribe from any of the mailing lists described in this
section, visit <a HREF="http://lists.mysql.com/">http://lists.mysql.com/</a>.
Please <STRONG>do not</STRONG> send messages about
subscribing or unsubscribing to any of the mailing lists, because such
messages are distributed automatically to thousands of other users.

</P>
<P>
Your local site may have many subscribers to a MySQL mailing list.
If so, the site may have a local mailing list, so that messages sent from
<CODE>lists.mysql.com</CODE> to your site are propagated to the local list.  In such
cases, please contact your system administrator to be added to or dropped
from the local MySQL list.

</P>
<P>
If you wish to have traffic for a mailing list go to a separate mailbox in
your mail program, set up a filter based on the message headers.  You can
use either the <CODE>List-ID:</CODE> or <CODE>Delivered-To:</CODE> headers to identify
list messages.

</P>
<P>
The MySQL mailing lists are as follows:

</P>
<DL COMPACT>

<DT><CODE><CODE>announce</CODE></CODE>
<DD>
This list is for announcements of new versions of MySQL and related
programs.  This is a low-volume list to which all MySQL users should
subscribe.

<DT><CODE><CODE>mysql</CODE></CODE>
<DD>
This is the main list for general MySQL discussion.  Please note that some
topics are better discussed on the more-specialized lists.  If you post to the
wrong list, you may not get an answer.

<DT><CODE><CODE>mysql-digest</CODE></CODE>
<DD>
This is the <CODE>mysql</CODE> list in digest form.  Subscribing to this list means
you will get all list messages, sent as one large mail message once a day.

<DT><CODE><CODE>bugs</CODE></CODE>
<DD>
This list will be of interest to you if you want to stay informed about
issues reported since the last release of <CODE>MySQL</CODE> or if you want to be
actively involved in the process of bug hunting and fixing.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

<DT><CODE><CODE>bugs-digest</CODE></CODE>
<DD>
This is the <CODE>bugs</CODE> list in digest form.

<DT><CODE><CODE>internals</CODE></CODE>
<DD>
This list is for people who work on the MySQL code.  This is also the
forum for discussions on MySQL development and post patches.

<DT><CODE><CODE>internals-digest</CODE></CODE>
<DD>
This is the <CODE>internals</CODE> list in digest form.

<DT><CODE><CODE>mysqldoc</CODE></CODE>
<DD>
This list is for people who work on the MySQL documentation:
people from MySQL AB, translators, and other community members.

<DT><CODE><CODE>mysqldoc-digest</CODE></CODE>
<DD>
This is the <CODE>mysqldoc</CODE> list in digest form.

<DT><CODE><CODE>benchmarks</CODE></CODE>
<DD>
This list is for anyone interested in performance issues. Discussions
concentrate on database performance (not limited to MySQL), but also
include broader categories such as performance of the kernel,
filesystem, disk system, and so on.

<DT><CODE><CODE>benchmarks-digest</CODE></CODE>
<DD>
This is the <CODE>benchmarks</CODE> list in digest form.

<DT><CODE><CODE>packagers</CODE></CODE>
<DD>
This list is for discussions on packaging and distributing MySQL. This is the 
forum used by distribution maintainers to exchange ideas on packaging MySQL 
and on ensuring that MySQL looks and feels as similar as possible on all 
supported platforms and operating systems.

<DT><CODE><CODE>packagers-digest</CODE></CODE>
<DD>
This is the <CODE>packagers</CODE> list in digest form.

<DT><CODE><CODE>java</CODE></CODE>
<DD>
This list is for discussions about the MySQL server and Java. It is mostly 
used to discuss JDBC drivers, including MySQL Connector/J.

<DT><CODE><CODE>java-digest</CODE></CODE>
<DD>
This is the <CODE>java</CODE> list in digest form.

<DT><CODE><CODE>win32</CODE></CODE>
<DD>
This list is for all topics concerning the MySQL software on Microsoft 
operating systems, such as Windows 9x, Me, NT, 2000, and XP.

<DT><CODE><CODE>win32-digest</CODE></CODE>
<DD>
This is the <CODE>win32</CODE> list in digest form.

<DT><CODE><CODE>myodbc</CODE></CODE>
<DD>
This list is for all topics concerning connecting to the MySQL server with ODBC.

<DT><CODE><CODE>myodbc-digest</CODE></CODE>
<DD>
This is the <CODE>myodbc</CODE> list in digest form.

<DT><CODE><CODE>mysqlcc</CODE></CODE>
<DD>
This list is for all topics concerning the <CODE>MySQL Control Center</CODE> graphical client.

<DT><CODE><CODE>mysqlcc-digest</CODE></CODE>
<DD>
This is the <CODE>mysqlcc</CODE> list in digest form.

<DT><CODE><CODE>plusplus</CODE></CODE>
<DD>
This list is for all topics concerning programming with the C++ API to MySQL.

<DT><CODE><CODE>plusplus-digest</CODE></CODE>
<DD>
This is the <CODE>plusplus</CODE> list in digest form.

<DT><CODE><CODE>msql-mysql-modules</CODE></CODE>
<DD>
This list is for all topics concerning the Perl support for MySQL with
<CODE>msql-mysql-modules</CODE>, which is now named <CODE>DBD::mysql</CODE>.

<DT><CODE><CODE>msql-mysql-modules-digest</CODE></CODE>
<DD>
This is the <CODE>msql-mysql-modules</CODE> list in digest form.
</DL>

<P>
If you're unable to get an answer to your questions from a <CODE>MySQL</CODE> mailing list, one
option is to purchase support from MySQL AB. This will put you
in direct contact with MySQL developers. See section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.

</P>
<P>
The following table shows some MySQL mailing lists in languages other than
English.  These lists are not operated by MySQL AB.

</P>
<DL COMPACT>

<DT><CODE><a HREF="mailto:mysql-france-subscribe@yahoogroups.com">mysql-france-subscribe@yahoogroups.com</a></CODE>
<DD>
A French mailing list.

<DT><CODE><a HREF="mailto:list@tinc.net">list@tinc.net</a></CODE>
<DD>
A Korean mailing list.
Email <CODE>subscribe mysql your@email.address</CODE> to this list.

<DT><CODE><a HREF="mailto:mysql-de-request@lists.4t2.com">mysql-de-request@lists.4t2.com</a></CODE>
<DD>
A German mailing list.
Email <CODE>subscribe mysql-de your@email.address</CODE> to this list.
You can find information about this mailing list at
<a HREF="http://www.4t2.com/mysql/">http://www.4t2.com/mysql/</a>.

<DT><CODE><a HREF="mailto:mysql-br-request@listas.linkway.com.br">mysql-br-request@listas.linkway.com.br</a></CODE>
<DD>
A Portuguese mailing list.
Email <CODE>subscribe mysql-br your@email.address</CODE> to this list.

<DT><CODE><a HREF="mailto:mysql-alta@elistas.net">mysql-alta@elistas.net</a></CODE>
<DD>
A Spanish mailing list.
Email <CODE>subscribe mysql your@email.address</CODE> to this list.

</DL>



<H4><A NAME="Asking_questions" HREF="manual_toc.html#Asking_questions">1.7.1.2  Asking Questions or Reporting Bugs</A></H4>

<P>
<A NAME="IDX92"></A>
<A NAME="IDX93"></A>
<A NAME="IDX94"></A>

</P>
<P>
Before posting a bug report or question, please do the following:

</P>

<UL>
<LI>

Start by searching the MySQL online manual at
<a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a>.
We try to keep the manual up to date by updating it frequently with
solutions to newly found problems. The change history appendix
(<a HREF="http://dev.mysql.com/doc/mysql/en/News.html">http://dev.mysql.com/doc/mysql/en/News.html</a>) can be particularly
useful since it is quite possible that a newer version already
contains a solution to your problem.

<LI>

Search in the bugs database at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a> to see 
whether the bug has already been reported and fixed.

<LI>

Search the MySQL mailing list archives at
<a HREF="http://lists.mysql.com/">http://lists.mysql.com/</a>.
<LI>

You can also use <a HREF="http://www.mysql.com/search/">http://www.mysql.com/search/</a> to search all the
Web pages (including the manual) that are located at the MySQL AB Web site.
</UL>

<P>
If you can't find an answer in the manual or the archives, check with your
local MySQL expert.  If you still can't find an answer to your
question, please follow the guidelines on sending mail to a MySQL mailing list, 
outlined in the next section, before contacting us.
 

</P>



<H4><A NAME="Bug_reports" HREF="manual_toc.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A></H4>

<P>
<A NAME="IDX95"></A>
<A NAME="IDX96"></A>
<A NAME="IDX97"></A>
<A NAME="IDX98"></A>
<A NAME="IDX99"></A>
<A NAME="IDX100"></A>
<A NAME="IDX101"></A>
<A NAME="IDX102"></A>
<A NAME="IDX103"></A>

</P>
<P>
The normal place to report bugs is <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>, which is the
address for our bugs database.
This database is public, and can be browsed and searched by anyone.
If you log in to the system, you will also be able to enter new reports.

</P>
<P>
Writing a good bug report takes patience, but doing it right the first
time saves time both for us and for yourself.  A good bug report, containing
a full test case for the bug, makes it very likely that we will fix the bug in
the next release.  This section will help you write your report correctly
so that you don't waste your time doing things that may not help us much
or at all.

</P>
<P>
We encourage everyone to use the <CODE>mysqlbug</CODE> script to generate a bug
report (or a report about any problem).  <CODE>mysqlbug</CODE> can be
found in the <TT>`scripts'</TT> directory (source distribution) and in the 
<TT>`bin'</TT> directory under your MySQL installation directory (binary distribution). 
If you are unable to use <CODE>mysqlbug</CODE> (for example, if you are running 
on Windows), it is still vital that you include all the necessary information 
noted in this section (most importantly, a description of the operating system 
and the MySQL version).

</P>
<P>
The <CODE>mysqlbug</CODE> script helps you generate a report by determining much
of the following information automatically, but if something important is
missing, please include it with your message.  Please read this section
carefully and make sure that all the information described here is included
in your report.

</P>
<P>
Preferably, you should test the problem using the latest production or
development version of MySQL Server before posting.  Anyone should be
able to repeat the bug by just using <CODE>mysql test &#60; script</CODE> on the
included test case or by running the shell or Perl script that is included in the
bug report.

</P>
<P>
All bugs posted in the bugs database at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>
will be corrected or documented in the
next MySQL release. If only minor code changes are needed to correct a
problem, we will also post a patch that fixes the problem.

</P>
<P>
If you have found a sensitive security bug in MySQL, please send an
email to <a HREF="mailto:security@mysql.com">security@mysql.com</a>.

</P>
<P>
If you have a repeatable bug report, please report it to the bugs
database at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>.  Note that even in this case
it's good to run the <CODE>mysqlbug</CODE> script first to find information
about your system.  Any bug that we are able to repeat has a high chance
of being fixed in the next MySQL release.

</P>
<P>
To report other problems, you can use one of the MySQL mailing lists.

</P>
<P>
Remember that it is possible for us to respond to a message containing too much
information, but not to one containing too little.  People often omit facts
because they think they know the cause of a problem and assume that some
details don't matter.  A good principle is this: If you are in doubt about stating
something, state it.  It is faster and less troublesome to
write a couple more lines in your report than to wait longer for the answer
if we must ask you to provide information that was missing from the initial
report.

</P>
<P>
The most common errors made in bug reports are (a) not including the version number of
the MySQL distribution used, and (b) not fully describing the platform on which the MySQL server
is installed (including the platform type and version number).  This is highly
relevant information, and in 99 cases out of 100, the bug report is useless without it.  
Very often we get questions like,
``Why doesn't this work for me?'' Then we find that the feature
requested wasn't implemented in that MySQL version, or that a bug
described in a report has already been fixed in newer MySQL
versions.  Sometimes the error is platform-dependent; in such cases, it is
next to impossible for us to fix anything without knowing the operating system and
the version number of the platform.

</P>
<P>
If you compiled MySQL from source,
remember also to provide information about your compiler, if it is related to
the problem.  Often people find bugs in compilers and think the problem is
MySQL-related.  Most compilers are under development all the time and
become better version by version.  To determine whether your
problem depends on your compiler, we need to know what compiler you use.
Note that every compiling problem should be regarded as a bug and
reported accordingly.

</P>
<P>
It is most helpful when a good description of the problem is included in the
bug report.  That is, give a good example of everything you did that led to
the problem and describe, in exact detail, the problem itself.  The best reports are
those that include a full example showing how to reproduce the bug or
problem.  See section <A HREF="manual.html#Reproduceable_test_case">D.1.6  Making a Test Case If You Experience Table Corruption</A>.

</P>
<P>
If a program produces an error message, it is very important to include the
message in your report.  If we try to search for something from the archives
using programs, it is better that the error message reported exactly matches
the one that the program produces.  (Even the case should be observed.)
You should never try to remember what the error message was; instead, copy
and paste the entire message into your report.

</P>
<P>
If you have a problem with Connector/ODBC (MyODBC), please try to generate a
MyODBC trace file and send it with your report.  See section <A HREF="manual.html#MyODBC_bug_report">20.3.7  Reporting Problems with MyODBC</A>.

</P>
<P>
Please remember that many of the people who will read your report will
do so using an 80-column display.  When generating reports or examples
using the <CODE>mysql</CODE> command-line tool, you should therefore use
the <CODE>--vertical</CODE> option (or the <CODE>\G</CODE> statement terminator)
for output that would exceed the available width for such a display
(for example, with the <CODE>EXPLAIN SELECT</CODE> statement; see the
example later in this section).

</P>
<P>
<A NAME="IDX104"></A>
Please include the following information in your report:

</P>

<UL>
<LI>

The version number of the MySQL distribution you are using (for
example, MySQL Version 4.0.12). You can find out which version you
are running by executing <CODE>mysqladmin version</CODE>.  <CODE>mysqladmin</CODE> can be
found in the <TT>`bin'</TT> directory under your MySQL installation
directory.

<LI>

The manufacturer and model of the machine on which you experience the 
problem.

<LI>

The operating system name and version.  If you work with Windows, you
can usually get the name and version number by double-clicking your
My Computer icon and pulling down the ``Help/About Windows'' menu.
For most Unix-like operating systems, you can get this information by
executing the command <CODE>uname -a</CODE>.

<LI>

Sometimes the amount of memory (real and virtual) is relevant. If in doubt,
include these values.

<LI>

If you are using a source distribution of the MySQL software, the name and
version number of the compiler used are needed.  If you have a binary
distribution, the distribution name is needed.

<LI>

If the problem occurs during compilation, include the exact error
messages and also a few lines of context around the offending code in the
file where the error occurs.

<LI>

If <CODE>mysqld</CODE> died, you should also report the query that crashed
<CODE>mysqld</CODE>.  You can usually find this out by running <CODE>mysqld</CODE> with
logging enabled.  See section <A HREF="manual.html#Using_log_files">D.1.5  Using Log Files to Find Cause of Errors in <CODE>mysqld</CODE></A>.

<LI>

If a database table is related to the problem, include the output from
<CODE>mysqldump --no-data db_name tbl_name1 tbl_name2 ...</CODE>.  This is very easy
to do and is a powerful way to get information about any table in a database.
The information will help us create a situation matching the one you have.

<LI>

For speed-related bugs or problems with <CODE>SELECT</CODE> statements, you
should always include the output of <CODE>EXPLAIN SELECT ...</CODE>, and at
least the number of rows that the <CODE>SELECT</CODE> statement produces.  You
should also include the output from <CODE>SHOW CREATE TABLE tbl_name</CODE>
for each involved table. The more information you give about your
situation, the more likely it is that someone can help you.

The following is an example of a very good bug report. It should be posted
with the <CODE>mysqlbug</CODE> script.  The example uses the <CODE>mysql</CODE>
command-line tool. Note the use of the <CODE>\G</CODE> statement terminator for
statements whose output width would otherwise exceed that of an 80-column
display device.


<PRE>
mysql&#62; SHOW VARIABLES;
mysql&#62; SHOW COLUMNS FROM ...\G
       &#60;output from SHOW COLUMNS&#62;
mysql&#62; EXPLAIN SELECT ...\G
       &#60;output from EXPLAIN&#62;
mysql&#62; FLUSH STATUS;
mysql&#62; SELECT ...;
       &#60;A short version of the output from SELECT,
       including the time taken to run the query&#62;
mysql&#62; SHOW STATUS;
       &#60;output from SHOW STATUS&#62;
</PRE>

<LI>

If a bug or problem occurs while running <CODE>mysqld</CODE>, try to provide an
input script that will reproduce the anomaly.  This script should include any
necessary source files.  The more closely the script can reproduce your
situation, the better.  If you can make a reproducible test case, you should
post it on <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a> for high-priority treatment.

If you can't provide a script, you should at least include the output
from <CODE>mysqladmin variables extended-status processlist</CODE> in your mail to
provide some information on how your system is performing.

<LI>

If you can't produce a test case with only a few rows, or if the test table
is too big to be mailed to the mailing list (more than 10 rows), you should
dump your tables using <CODE>mysqldump</CODE> and create a <TT>`README'</TT> file
that describes your problem.

Create a compressed archive of your files using
<CODE>tar</CODE> and <CODE>gzip</CODE> or <CODE>zip</CODE>, and use <CODE>ftp</CODE> to transfer the
archive to <a HREF="ftp://support.mysql.com/pub/mysql/secret/">ftp://support.mysql.com/pub/mysql/secret/</a>.  Then enter
the problem into our bugs database at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>.

<LI>

If you think that the MySQL server produces a strange result from a query,
include not only the result, but also your opinion of what the result
should be, and an account describing the basis for your opinion.

<LI>

When giving an example of the problem, it's better to use the variable names,
table names, and so on that exist in your actual situation than to come up with
new names.  The problem could be related to the name of a variable or table.
These cases are rare, perhaps, but it is better to be safe than sorry.
After all, it should be easier for you to provide an example that uses your
actual situation, and it is by all means better for us.  In case you have data
you don't want to show to others, you can use <CODE>ftp</CODE> to transfer it to
<a HREF="ftp://support.mysql.com/pub/mysql/secret/">ftp://support.mysql.com/pub/mysql/secret/</a>.  If the data is really top
secret and you don't want to show it even to us, then go ahead and provide
an example using other names, but please regard this as the last choice.

<LI>

Include all the options given to the relevant programs, if possible.  For
example, indicate the options that you use when you start the <CODE>mysqld</CODE>
server as well as the options that you use to run any MySQL client programs.
The options to programs such as <CODE>mysqld</CODE> and <CODE>mysql</CODE>, and to the
<CODE>configure</CODE> script, are often keys to answers and are very relevant.
It is never a bad idea to include them.  If you use any modules, such
as Perl or PHP, please include the version numbers of those as well.

<LI>

If your question is related to the privilege system, please include the
output of <CODE>mysqlaccess</CODE>, the output of <CODE>mysqladmin reload</CODE>, and all
the error messages you get when trying to connect.  When you test your
privileges, you should first run <CODE>mysqlaccess</CODE>.  After this, execute
<CODE>mysqladmin reload version</CODE> and try to connect with the program that
gives you trouble.  <CODE>mysqlaccess</CODE> can be found in the <TT>`bin'</TT>
directory under your MySQL installation directory.

<LI>

If you have a patch for a bug, do include it.  But don't assume that the patch is
all we need, or that we will use it, if you don't provide some necessary
information such as test cases showing the bug that your patch fixes.  We
might find problems with your patch or we might not understand it at all; if
so, we can't use it.

If we can't verify exactly what the purpose of the patch is, we won't use it.
Test cases will help us here.  Show that the patch will handle all the
situations that may occur.  If we find a borderline case (even a rare one)
where the patch won't work, it may be useless.

<LI>

Guesses about what the bug is, why it occurs, or what it depends on
are usually wrong.  Even the MySQL team can't guess such things
without first using a debugger to determine the real cause of a bug.

<LI>

Indicate in your bug report that you have checked the reference manual
and mail archive so that others know you have tried to solve the
problem yourself.

<LI>

If you get a <CODE>parse error</CODE>, please check your syntax closely.  If
you can't find something wrong with it, it's extremely likely that your
current version of MySQL Server doesn't support the syntax you are
using.  If you are using the current version and the manual at
<a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a> doesn't cover the
syntax you are using, MySQL Server doesn't support your query.  In this
case, your only options are to implement the syntax yourself or email
<a HREF="mailto:licensing@mysql.com">licensing@mysql.com</a> and ask for an offer to implement it.

If the manual covers the syntax you are using, but you have an older version
of MySQL Server, you should check the MySQL change history to see
when the syntax was implemented.  In this case, you have the option of
upgrading to a newer version of MySQL Server.  See section <A HREF="manual.html#News">C  MySQL Change History</A>.

<LI>

If your problem is that your data appears corrupt or you get errors
when you access a particular table, you should first check and then try
to repair your tables with <CODE>CHECK TABLE</CODE> and <CODE>REPAIR TABLE</CODE>
or with <CODE>myisamchk</CODE>.
See section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>.

If you are running Windows, please verify that <CODE>lower_case_table_names</CODE>
is 1 or 2 with <CODE>SHOW VARIABLES LIKE 'lower_case_table_names'</CODE>.

<LI>

If you often get corrupted tables, you should try to find out when and why this
happens.  In this case, the error log in the MySQL data directory
may contain some information about what happened. (This is the file with the
<TT>`.err'</TT> suffix in the name.)  See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.  Please
include any relevant information from this file in your bug report.  Normally
<CODE>mysqld</CODE> should <STRONG>never</STRONG> crash a table if nothing killed it in the
middle of an update.  If you can find the cause of <CODE>mysqld</CODE> dying,
it's much easier for us to provide you with a fix for the problem.
See section <A HREF="manual.html#What_is_crashing">A.1  How to Determine What Is Causing a Problem</A>.

<LI>

If possible, download and install the most recent version of MySQL Server
and check whether it solves your problem.  All versions of
the MySQL software are thoroughly tested and should work without problems.
We believe in making everything as backward-compatible as possible,
and you should be able to switch MySQL versions without difficulty.
See section <A HREF="manual.html#Which_version">2.1.2  Choosing Which MySQL Distribution to Install</A>.
</UL>

<P>
<A NAME="IDX105"></A>
<A NAME="IDX106"></A>
<A NAME="IDX107"></A>
<A NAME="IDX108"></A>
If you are a support customer, please cross-post the bug report to
<a HREF="mailto:mysql-support@mysql.com">mysql-support@mysql.com</a> for higher-priority treatment, as well as to
the appropriate mailing list to see whether someone else has experienced (and
perhaps solved) the problem.

</P>
<P>
For information on reporting bugs in <CODE>MyODBC</CODE>, see section <A HREF="manual.html#ODBC_Problems">20.3.4  How to Report Problems with MyODBC</A>.

</P>
<P>
For solutions to some common problems, see section <A HREF="manual.html#Problems">A  Problems and Common Errors</A>.

</P>
<P>
When answers are sent to you individually and not to the mailing list,
it is considered good etiquette to summarize the answers and send the
summary to the mailing list so that others may have the benefit of
responses you received that helped you solve your problem.

</P>



<H4><A NAME="Answering_questions" HREF="manual_toc.html#Answering_questions">1.7.1.4  Guidelines for Answering Questions on the Mailing List</A></H4>

<P>
<A NAME="IDX109"></A>
<A NAME="IDX110"></A>
<A NAME="IDX111"></A>
<A NAME="IDX112"></A>

</P>
<P>
If you consider your answer to have broad interest, you may want to post it
to the mailing list instead of replying directly to the individual who
asked.  Try to make your answer general enough that people other than the
original poster may benefit from it.  When you post to the list, please make
sure that your answer is not a duplication of a previous answer.

</P>
<P>
Try to summarize the essential part of the question in your reply; don't feel
obliged to quote the entire original message.

</P>
<P>
Please don't post mail messages from your browser with HTML mode turned on.
Many users don't read mail with a browser.

</P>


<H3><A NAME="IRC" HREF="manual_toc.html#IRC">1.7.2  MySQL Community Support on IRC (Internet Relay Chat)</A></H3>

<P>
<A NAME="IDX113"></A>
<A NAME="IDX114"></A>

</P>
<P>
In addition to the various MySQL mailing lists, you can find experienced
community people on <CODE>IRC</CODE> (<CODE>Internet Relay Chat</CODE>).
These are the best networks/channels currently known to us:

</P>

<UL>
<LI><STRONG>freenode</STRONG> (see <a HREF="http://www.freenode.net/">http://www.freenode.net/</a> for servers)


<UL>
<LI><CODE>#mysql</CODE>

Primarily MySQL questions, but other database and general SQL questions are welcome.
Questions about PHP, Perl or C in combination with MySQL are also common.
</UL>

<LI><STRONG>EFnet</STRONG> (see <a HREF="http://www.efnet.org/">http://www.efnet.org/</a> for servers)


<UL>
<LI><CODE>#mysql</CODE>

MySQL questions.
</UL>

</UL>

<P>
If you are looking for IRC client software to connect to an IRC network,
take a look at <CODE>X-Chat</CODE> (<a HREF="http://www.xchat.org/">http://www.xchat.org/</a>).
X-Chat (GPL licensed) is available for Unix as well as for Windows platforms.

</P>



<H2><A NAME="Compatibility" HREF="manual_toc.html#Compatibility">1.8  MySQL Standards Compliance</A></H2>

<P>
<A NAME="IDX115"></A>
<A NAME="IDX116"></A>
<A NAME="IDX117"></A>
<A NAME="IDX118"></A>
<A NAME="IDX119"></A>

</P>
<P>
This section describes how MySQL relates to the ANSI/ISO SQL standards.
MySQL Server has many extensions to the SQL standard, and here you
will find out what they are and how to use them.  You will also find
information about functionality missing from MySQL Server, and how to work
around some differences.

</P>
<P>
Our goal is to not restrict MySQL Server usability for any usage without a
very good reason for doing so.  Even if we don't have the resources to perform
 development for every possible use, we are always willing to help and offer
suggestions to people who are trying to use MySQL Server in new territories.

</P>
<P>
One of our main goals with the product is to continue to work toward
compliance with the SQL standard, but without sacrificing speed or reliability.
We are not afraid to add extensions to SQL or support for non-SQL
features if this greatly increases the usability of MySQL Server for a large
segment of our user base.
(The <CODE>HANDLER</CODE> interface in MySQL Server 4.0 is an example of this
strategy. See section <A HREF="manual.html#HANDLER">14.1.3  <CODE>HANDLER</CODE> Syntax</A>.)

</P>
<P>
We will continue to support transactional and non-transactional
databases to satisfy both mission-critical 24/7 usage and
heavy Web or logging usage.

</P>
<P>
MySQL Server was originally designed to work with medium size databases
(10-100 million rows, or about 100MB per table) on small computer systems. 
Today MySQL Server handles terabyte-size databases, but the code can also be
compiled in a reduced version suitable for hand-held and embedded devices.
The compact design of the MySQL server makes development in both directions
possible without any conflicts in the source tree.

</P>
<P>
We are currently not targeting realtime support, although the MySQL
replication capabilities already offer significant functionality.

</P>
<P>
Database cluster support is planned through integration of our acquired
NDB Cluster technology into a new storage engine, available early 2004.

</P>
<P>
We are also looking at providing XML support in the database server.

</P>



<H3><A NAME="Standards" HREF="manual_toc.html#Standards">1.8.1  What Standards MySQL Follows</A></H3>

<P>
ODBC levels 0-3.51.

</P>
<P>
We are aiming toward supporting the full ANSI/ISO SQL standard,
but without making concessions to speed and quality of the code.

</P>



<H3><A NAME="SQL_mode" HREF="manual_toc.html#SQL_mode">1.8.2  Selecting SQL Modes</A></H3>

<P>
The MySQL server can operate in different SQL modes, and can apply these
modes differentially for different clients. This allows applications to
tailor server operation to their own requirements.

</P>
<P>
Modes define what SQL syntax MySQL should support and what kind of
validation checks it should perform on the data.  This makes it easier
to use MySQL in a lot of different environments and to use MySQL together
with other database servers.

</P>
<P>
You can set the default SQL mode by starting <CODE>mysqld</CODE> with the
<CODE>--sql-mode="modes"</CODE> option. Beginning with MySQL 4.1, you can also
change the mode after startup time by setting the <CODE>sql_mode</CODE> variable
with a <CODE>SET [SESSION|GLOBAL] sql_mode='modes'</CODE> statement.

</P>
<P>
For more information on setting the server mode, see section <A HREF="manual.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

</P>



<H3><A NAME="ANSI_mode" HREF="manual_toc.html#ANSI_mode">1.8.3  Running MySQL in ANSI Mode</A></H3>

<P>
<A NAME="IDX120"></A>
<A NAME="IDX121"></A>

</P>
<P>
You can tell <CODE>mysqld</CODE> to use the ANSI mode with the <CODE>--ansi</CODE>
startup option. See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
Running the server in ANSI mode is the same as starting it with these options:

</P>

<PRE>
--sql-mode=REAL_AS_FLOAT,PIPES_AS_CONCAT,ANSI_QUOTES,IGNORE_SPACE,ONLY_FULL_GROUP_BY
--transaction-isolation=SERIALIZABLE
</PRE>

<P>
In MySQL 4.1, you can achieve the same effect with these two statements:

</P>

<PRE>
SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SET GLOBAL sql_mode =
  'REAL_AS_FLOAT,PIPES_AS_CONCAT,ANSI_QUOTES,IGNORE_SPACE,ONLY_FULL_GROUP_BY';
</PRE>

<P>
See section <A HREF="manual.html#SQL_mode">1.8.2  Selecting SQL Modes</A>.

</P>
<P>
In MySQL 4.1.1, the <CODE>sql_mode</CODE> options shown can be also be set with:

</P>

<PRE>
SET GLOBAL sql_mode='ansi';
</PRE>

<P>
In this case, the value of the <CODE>sql_mode</CODE> variable will be set to all
options that are relevant for ANSI mode. You can check the result by doing:

</P>

<PRE>
mysql&#62; SET GLOBAL sql_mode='ansi';
mysql&#62; SELECT @@GLOBAL.sql_mode;
        -&#62; 'REAL_AS_FLOAT,PIPES_AS_CONCAT,ANSI_QUOTES,IGNORE_SPACE,ONLY_FULL_GROUP_BY,ANSI';
</PRE>



<H3><A NAME="Extensions_to_ANSI" HREF="manual_toc.html#Extensions_to_ANSI">1.8.4  MySQL Extensions to the SQL Standard</A></H3>

<P>
<A NAME="IDX122"></A>
MySQL Server includes some extensions that you probably will not find in
other SQL databases.  Be warned that if you use them, your code will not be
portable to other SQL servers.  In some cases, you can write code that
includes MySQL extensions, but is still portable, by using comments
of the form <CODE>/*! ... */</CODE>.  In this case, MySQL Server will parse and
execute the code within the comment as it would any other MySQL
statement, but other SQL servers will ignore the extensions.  For example:

</P>

<PRE>
SELECT /*! STRAIGHT_JOIN */ col_name FROM table1,table2 WHERE ...
</PRE>

<P>
If you add a version number after the <CODE>'!'</CODE> character, the syntax within
the comment will be
executed only if the MySQL version is equal to or newer than the specified
version number:

</P>

<PRE>
CREATE /*!32302 TEMPORARY */ TABLE t (a INT);
</PRE>

<P>
This means that if you have Version 3.23.02 or newer, MySQL
Server will use the <CODE>TEMPORARY</CODE> keyword.

</P>
<P>
The following descriptions list MySQL extensions, organized by category.

</P>
<DL COMPACT>

<DT>Organization of data on disk
<DD>
MySQL Server maps each database to a directory under the MySQL
data directory, and tables within a database to filenames in the database
directory.
This has a few implications:


<UL>

<LI>

<A NAME="IDX123"></A>
<A NAME="IDX124"></A>
<A NAME="IDX125"></A>
<A NAME="IDX126"></A>
Database names and table names are case sensitive in MySQL Server on
operating systems that have case-sensitive filenames (such as most Unix
systems). See section <A HREF="manual.html#Name_case_sensitivity">10.2.2  Identifier Case Sensitivity</A>.

<LI>

Database, table, index, column, or alias names may begin with a digit
(but may not consist solely of digits).

<LI>

You can use standard system commands to back up, rename, move, delete, and copy
tables that are managed by the <CODE>MyISAM</CODE> or <CODE>ISAM</CODE> storage engines.
For example, to rename a <CODE>MyISAM</CODE> table, rename the <TT>`.MYD'</TT>,
<TT>`.MYI'</TT>, and <TT>`.frm'</TT> files to which the table corresponds.
</UL>

<DT>General language syntax
<DD>

<UL>

<LI>

Strings may be enclosed by either <SAMP>`"'</SAMP> or <SAMP>`''</SAMP>, not just by <SAMP>`''</SAMP>.

<LI>

Use of <SAMP>`\'</SAMP> as an escape character in strings.

<LI>

In SQL statements, you can access tables from different databases
with the <CODE>db_name.tbl_name</CODE> syntax.  Some SQL servers provide
the same functionality but call this <CODE>User space</CODE>.
MySQL Server doesn't support tablespaces such as used in statements like this:
<CODE>CREATE TABLE ralph.my_table...IN my_tablespace</CODE>.

</UL>

<DT>SQL statement syntax
<DD>

<UL>

<LI>

The <CODE>ANALYZE TABLE</CODE>, <CODE>CHECK TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, and
<CODE>REPAIR TABLE</CODE> statements.

<LI>

The <CODE>CREATE DATABASE</CODE> and <CODE>DROP DATABASE</CODE> statements.
See section <A HREF="manual.html#CREATE_DATABASE">14.2.3  <CODE>CREATE DATABASE</CODE> Syntax</A>.

<LI>

The <CODE>DO</CODE> statement.

<LI>

<CODE>EXPLAIN SELECT</CODE> to get a description of how tables are joined.

<LI>

The <CODE>FLUSH</CODE> and <CODE>RESET</CODE> statements.

<LI>

The <CODE>SET</CODE> statement. See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<LI>

The <CODE>SHOW</CODE> statement.
See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

<A NAME="IDX127"></A>
<A NAME="IDX128"></A>
<LI>

Use of <CODE>LOAD DATA INFILE</CODE>. In many cases, this syntax is compatible with
Oracle's <CODE>LOAD DATA INFILE</CODE>. See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

<LI>

Use of <CODE>RENAME TABLE</CODE>. See section <A HREF="manual.html#RENAME_TABLE">14.2.9  <CODE>RENAME TABLE</CODE> Syntax</A>.

<LI>

Use of <CODE>REPLACE</CODE> instead of <CODE>DELETE</CODE> + <CODE>INSERT</CODE>.
See section <A HREF="manual.html#REPLACE">14.1.6  <CODE>REPLACE</CODE> Syntax</A>.

<LI>

Use of <CODE>CHANGE col_name</CODE>, <CODE>DROP col_name</CODE>, or <CODE>DROP
INDEX</CODE>, <CODE>IGNORE</CODE> or <CODE>RENAME</CODE> in an <CODE>ALTER TABLE</CODE>
statement.
Use of multiple <CODE>ADD</CODE>, <CODE>ALTER</CODE>, <CODE>DROP</CODE>, or <CODE>CHANGE</CODE>
clauses in an <CODE>ALTER TABLE</CODE> statement.
See section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.

<LI>

Use of index names, indexes on a prefix of a field, and use of
<CODE>INDEX</CODE> or <CODE>KEY</CODE> in a <CODE>CREATE TABLE</CODE>
statement. See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<LI>

Use of <CODE>TEMPORARY</CODE> or <CODE>IF NOT EXISTS</CODE> with <CODE>CREATE TABLE</CODE>.

<LI>

Use of <CODE>IF EXISTS</CODE> with <CODE>DROP TABLE</CODE>.

<LI>

You can drop multiple tables with a single <CODE>DROP TABLE</CODE> statement.

<LI>

The <CODE>ORDER BY</CODE> and <CODE>LIMIT</CODE> clauses of the <CODE>UPDATE</CODE> and
<CODE>DELETE</CODE> statements.

<LI>

<CODE>INSERT INTO ... SET col_name = ...</CODE> syntax.

<LI>

The <CODE>DELAYED</CODE> clause of the <CODE>INSERT</CODE> and <CODE>REPLACE</CODE>
statements.

<LI>

The <CODE>LOW_PRIORITY</CODE> clause of the <CODE>INSERT</CODE>, <CODE>REPLACE</CODE>,
<CODE>DELETE</CODE>, and <CODE>UPDATE</CODE> statements.

<LI>

Use of <CODE>INTO OUTFILE</CODE> and <CODE>STRAIGHT_JOIN</CODE> in a <CODE>SELECT</CODE>
statement. See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

<LI>

The <CODE>SQL_SMALL_RESULT</CODE> option in a <CODE>SELECT</CODE> statement.

<LI>

You don't need to name all selected columns in the <CODE>GROUP BY</CODE> part.
This gives better performance for some very specific, but quite normal
queries.
See section <A HREF="manual.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A>.

<LI>

You can specify <CODE>ASC</CODE> and <CODE>DESC</CODE> with <CODE>GROUP BY</CODE>.

<LI>

The ability to set variables in a statement with the <CODE>:=</CODE> assignment
operator:

<PRE>
mysql&#62; SELECT @a:=SUM(total),@b=COUNT(*),@a/@b AS avg
    -&#62; FROM test_table;
mysql&#62; SELECT @t1:=(@t2:=1)+@t3:=4,@t1,@t2,@t3;
</PRE>

</UL>

<DT>Column types
<DD>

<UL>
<LI>

The column types <CODE>MEDIUMINT</CODE>, <CODE>SET</CODE>, <CODE>ENUM</CODE>, and the
different <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types.

<LI>

The column attributes <CODE>AUTO_INCREMENT</CODE>, <CODE>BINARY</CODE>, <CODE>NULL</CODE>,
<CODE>UNSIGNED</CODE>, and <CODE>ZEROFILL</CODE>.
</UL>

<DT>Functions and operators
<DD>

<UL>

<LI>

To make it easier for users who come from other SQL environments,
MySQL Server supports aliases for many functions. For example, all
string functions support both standard SQL syntax and ODBC syntax.

<LI>

MySQL Server understands the <CODE>||</CODE> and <CODE>&#38;&</CODE> operators to mean
logical OR and AND, as in the C programming language.  In MySQL Server,
<CODE>||</CODE> and <CODE>OR</CODE> are synonyms, as are <CODE>&#38;&</CODE> and <CODE>AND</CODE>.
Because of this nice syntax, MySQL Server doesn't support
the standard SQL <CODE>||</CODE> operator for string concatenation; use
<CODE>CONCAT()</CODE> instead. Because <CODE>CONCAT()</CODE> takes any number
of arguments, it's easy to convert use of the <CODE>||</CODE> operator to
MySQL Server.

<LI>

Use of <CODE>COUNT(DISTINCT list)</CODE> where <CODE>list</CODE> has more than one element.

<LI>

All string comparisons are case-insensitive by default, with sort
ordering determined by the current character set (ISO-8859-1 Latin1 by
default).  If you don't like this, you should declare your columns with
the <CODE>BINARY</CODE> attribute or use the <CODE>BINARY</CODE> cast, which causes
comparisons to be done using the underlying character code values rather
then a lexical ordering.

<A NAME="IDX129"></A>
<A NAME="IDX130"></A>
<LI>

The <CODE>%</CODE> operator is a synonym for <CODE>MOD()</CODE>.  That is,
<CODE>N % M</CODE> is equivalent to <CODE>MOD(N,M)</CODE>.  <CODE>%</CODE> is supported
for C programmers and for compatibility with PostgreSQL.

<LI>

The <CODE>=</CODE>, <CODE>&#60;&#62;</CODE>, <CODE>&#60;=</CODE> ,<CODE>&#60;</CODE>, <CODE>&#62;=</CODE>,<CODE>&#62;</CODE>,
<CODE>&#60;&#60;</CODE>, <CODE>&#62;&#62;</CODE>, <CODE>&#60;=&#62;</CODE>, <CODE>AND</CODE>, <CODE>OR</CODE>, or <CODE>LIKE</CODE>
operators may be used in column comparisons to the left of the
<CODE>FROM</CODE> in <CODE>SELECT</CODE> statements.  For example:


<PRE>
mysql&#62; SELECT col1=1 AND col2=2 FROM tbl_name;
</PRE>

<LI>

The <CODE>LAST_INSERT_ID()</CODE> function.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.

<LI>

<CODE>LIKE</CODE> is allowed on numeric columns.

<LI>

The <CODE>REGEXP</CODE> and <CODE>NOT REGEXP</CODE> extended regular expression
operators.

<LI>

<CODE>CONCAT()</CODE> or <CODE>CHAR()</CODE> with one argument or more than two
arguments.  (In MySQL Server, these functions can take any number of
arguments.)

<LI>The <CODE>BIT_COUNT()</CODE>, <CODE>CASE</CODE>, <CODE>ELT()</CODE>,

<CODE>FROM_DAYS()</CODE>, <CODE>FORMAT()</CODE>, <CODE>IF()</CODE>, <CODE>PASSWORD()</CODE>,
<CODE>ENCRYPT()</CODE>, <CODE>MD5()</CODE>, <CODE>ENCODE()</CODE>, <CODE>DECODE()</CODE>,
<CODE>PERIOD_ADD()</CODE>, <CODE>PERIOD_DIFF()</CODE>, <CODE>TO_DAYS()</CODE>, or
<CODE>WEEKDAY()</CODE> functions.

<LI>

Use of <CODE>TRIM()</CODE> to trim substrings.  Standard SQL supports removal
of single characters only.

<LI>

The <CODE>GROUP BY</CODE> functions <CODE>STD()</CODE>, <CODE>BIT_OR()</CODE>,
<CODE>BIT_AND()</CODE>, <CODE>BIT_XOR()</CODE>, and <CODE>GROUP_CONCAT()</CODE>.
See section <A HREF="manual.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A>.
</UL>

</DL>

<P>
For a prioritized list indicating when new extensions will be added to
MySQL Server, you should consult the online MySQL TODO list at
<a HREF="http://dev.mysql.com/doc/mysql/en/TODO.html">http://dev.mysql.com/doc/mysql/en/TODO.html</a>.
That is the latest version of the TODO list in this manual. See section <A HREF="manual.html#TODO">1.6  MySQL and the Future (the TODO)</A>.

</P>



<H3><A NAME="Differences_from_ANSI" HREF="manual_toc.html#Differences_from_ANSI">1.8.5  MySQL Differences Compared to Standard SQL</A></H3>

<P>
We try to make MySQL Server follow the ANSI SQL standard and the
ODBC SQL standard, but MySQL Server performs operations differently in some
cases:

</P>

<UL>
<LI>

For <CODE>VARCHAR</CODE> columns, trailing spaces are removed when the value is
stored. See section <A HREF="manual.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A>.

<LI>

In some cases, <CODE>CHAR</CODE> columns are silently converted to <CODE>VARCHAR</CODE>
columns when you define a table or alter its structure.
See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

<LI>

Privileges for a table are not automatically revoked when you delete a
table. You must explicitly issue a <CODE>REVOKE</CODE> statement to revoke
privileges for a table. See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.
</UL>



<H4><A NAME="ANSI_diff_Subqueries" HREF="manual_toc.html#ANSI_diff_Subqueries">1.8.5.1  Subqueries</A></H4>

<P>
MySQL Version 4.1 supports subqueries and derived tables.
A ``subquery'' is a <CODE>SELECT</CODE> statement nested within another statement.
A ``derived table'' (an unnamed view) is a subquery in the <CODE>FROM</CODE> clause
of another statement.
See section <A HREF="manual.html#Subqueries">14.1.8  Subquery Syntax</A>.

</P>
<P>
For MySQL versions older than 4.1, most subqueries can be
rewritten using joins or other methods.
See section <A HREF="manual.html#Rewriting_subqueries">14.1.8.11  Rewriting Subqueries as Joins for Earlier MySQL Versions</A> for examples that show how to do this.

</P>



<H4><A NAME="ANSI_diff_SELECT_INTO_TABLE" HREF="manual_toc.html#ANSI_diff_SELECT_INTO_TABLE">1.8.5.2  <CODE>SELECT INTO TABLE</CODE></A></H4>

<P>
<A NAME="IDX131"></A>

</P>
<P>
MySQL Server doesn't support the Sybase SQL extension:
<CODE>SELECT ... INTO TABLE ...</CODE>.  Instead, MySQL Server supports the
standard SQL syntax <CODE>INSERT INTO ... SELECT ...</CODE>, which is basically
the same thing. See section <A HREF="manual.html#INSERT_SELECT">14.1.4.1  <CODE>INSERT ... SELECT</CODE> Syntax</A>.

</P>

<PRE>
INSERT INTO tbl_temp2 (fld_id)
    SELECT tbl_temp1.fld_order_id
    FROM tbl_temp1 WHERE tbl_temp1.fld_order_id &#62; 100;
</PRE>

<P>
Alternatively, you can use <CODE>SELECT INTO OUTFILE ...</CODE> or
<CODE>CREATE TABLE ... SELECT</CODE>.

</P>
<P>
From version 5.0, MySQL supports <CODE>SELECT ... INTO</CODE> with user
variables. The same syntax may also be used inside stored procedures using
cursors and local variables.
See section <A HREF="manual.html#SELECT_INTO_Statement">19.1.6.3  <CODE>SELECT ... INTO</CODE> Statement</A>.

</P>



<H4><A NAME="ANSI_diff_Transactions" HREF="manual_toc.html#ANSI_diff_Transactions">1.8.5.3  Transactions and Atomic Operations</A></H4>

<P>
<A NAME="IDX132"></A>
<A NAME="IDX133"></A>
<A NAME="IDX134"></A>
<A NAME="IDX135"></A>
<A NAME="IDX136"></A>
<A NAME="IDX137"></A>
<A NAME="IDX138"></A>
<A NAME="IDX139"></A>
<A NAME="IDX140"></A>

</P>
<P>
MySQL Server (version 3.23-max and all versions 4.0 and above) supports
transactions with the <CODE>InnoDB</CODE> and <CODE>BDB</CODE>
transactional storage engines.
<CODE>InnoDB</CODE> provides <EM>full</EM> <CODE>ACID</CODE> compliance.
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
The other non-transactional storage engines in MySQL Server (such as
<CODE>MyISAM</CODE>) follow a different paradigm for data integrity called
``atomic operations.'' In transactional terms, <CODE>MyISAM</CODE>
tables effectively always operate in <CODE>AUTOCOMMIT=1</CODE> mode.
Atomic operations often offer comparable integrity with higher performance.

</P>
<P>
With MySQL Server supporting both paradigms, you can decide whether your
applications are best served by the speed of atomic operations or the use of
transactional features. This choice can be made on a per-table basis.

</P>
<P>
As noted, the trade-off for transactional versus non-transactional table
types lies mostly in performance. Transactional tables have significantly
higher memory and diskspace requirements, and more CPU overhead.
On the other hand, transactional table types such as <CODE>InnoDB</CODE> also
offer many significant features. MySQL Server's modular design allows the
concurrent use of different storage engines to suit different
requirements and deliver optimum performance in all situations.

</P>
<P>
But how do you use the features of MySQL Server to maintain rigorous
integrity even with the non-transactional <CODE>MyISAM</CODE> tables, and how
do these features compare with the transactional table types?

</P>

<OL>
<LI>

If your applications are written in a way that is dependent on being able
to call <CODE>ROLLBACK</CODE> rather than
<CODE>COMMIT</CODE> in critical situations, transactions are more
convenient. Transactions also ensure that unfinished updates or
corrupting activities are not committed to the database; the server is
given the opportunity to do an automatic rollback and your database is
saved.

If you use non-transactional tables,
MySQL Server in almost all cases allows you to resolve potential problems
by including simple checks before updates and by running simple scripts
that check the databases for inconsistencies and automatically repair
or warn if such an inconsistency occurs. Note that just by using the
MySQL log or even adding one extra log, you can normally fix tables
perfectly with no data integrity loss.

<LI>

More often than not, critical transactional updates can be rewritten to be
atomic. Generally speaking, all integrity problems that transactions
solve can be done with <CODE>LOCK TABLES</CODE> or atomic updates, ensuring
that you never will get an automatic abort from the server, which is
a common problem with transactional database systems.

<LI>

Even a transactional system can lose data if the server goes down.
The difference between different systems lies in just how small the
time-lag is where they could lose data. No system is 100% secure, only
``secure enough.'' Even Oracle, reputed to be the safest of
transactional database systems, is reported to sometimes lose data in such
situations.

To be safe with MySQL Server, whether or not using transactional tables, you
only need to have backups and have binary logging turned on. With
this you can recover from any situation that you could with any
other transactional database system.  It is always good to have
backups, regardless of which database system you use.
</OL>

<P>
The transactional paradigm has its benefits and its drawbacks. Many
users and application developers depend on the ease with which they
can code around problems where an abort appears to be, or is necessary.
However, even if you are new to the atomic operations paradigm, or more
familiar with transactions, do consider the speed benefit that
non-transactional tables can offer on the order of three to five times
the speed of the fastest and most optimally tuned transactional tables.

</P>
<P>
In situations where integrity is of highest importance, MySQL Server offers
transaction-level reliability and integrity even for non-transactional tables.
If you lock tables with <CODE>LOCK TABLES</CODE>, all updates will stall
until any integrity checks are made. If you obtain a <CODE>READ LOCAL</CODE> lock
(as opposed to a write lock) for a table that allows concurrent inserts at the
end of the table, reads are allowed, as are inserts by other clients.
The new inserted records will not be seen by the
client that has the read lock until it releases the lock.
With <CODE>INSERT DELAYED</CODE>, you can queue inserts into a local
queue, until the locks are released, without having the client wait
for the insert to complete. See section <A HREF="manual.html#INSERT_DELAYED">14.1.4.2  <CODE>INSERT DELAYED</CODE> Syntax</A>.

</P>
<P>
``Atomic,'' in the sense that we mean it, is nothing magical. It only
means that you can be sure that while each specific update is running,
no other user can interfere with it, and there will never be an
automatic rollback (which can happen with transactional tables if you
are not very careful).  MySQL Server also guarantees that there will not be
any dirty reads.

</P>
<P>
Following are some techniques for working with non-transactional tables:

</P>

<UL>
<LI>

Loops that need transactions normally can be coded with the help of
<CODE>LOCK TABLES</CODE>, and you don't need cursors to update
records on the fly.

<LI>

To avoid using <CODE>ROLLBACK</CODE>, you can use the following strategy:


<OL>
<LI>

Use <CODE>LOCK TABLES ...</CODE> to lock all the tables you want to access.
<LI>

Test the conditions that must be true before performing the update.
<LI>

Update if everything is okay.
<LI>

Use <CODE>UNLOCK TABLES</CODE> to release your locks.
</OL>

This is usually a much faster method than using transactions with
possible rollbacks, although not always. The only situation
this solution doesn't handle is when someone kills the threads in the
middle of an update. In this case, all locks will be released but some
of the updates may not have been executed.

<LI>

You can also use functions to update records in a single operation.
You can get a very efficient application by using the following
techniques:


<UL>
<LI>Modify fields relative to their current value.

<LI>Update only those fields that actually have changed.

</UL>

For example, when we are doing updates to some customer information, we
update only the customer data that has changed and test only that none of
the changed data, or data that depends on the changed data, has changed
compared to the original row. The test for changed data is done with the
<CODE>WHERE</CODE> clause in the <CODE>UPDATE</CODE> statement. If the record wasn't
updated, we give the client a message: ``Some of the data you have changed
has been changed by another user.'' Then we show the old row versus the new
row in a window so that the user can decide which version of the customer
record to use.

This gives us something that is similar to column locking but is actually
even better because we only update some of the columns, using values that
are relative to their current values.  This means that typical <CODE>UPDATE</CODE>
statements look something like these:


<PRE>
UPDATE tablename SET pay_back=pay_back+125;

UPDATE customer
  SET
    customer_date='current_date',
    address='new address',
    phone='new phone',
    money_he_owes_us=money_he_owes_us-125
  WHERE
    customer_id=id AND address='old address' AND phone='old phone';
</PRE>

As you can see, this is very efficient and works even if another client
has changed the values in the <CODE>pay_back</CODE> or <CODE>money_he_owes_us</CODE>
columns.

<LI>

<A NAME="IDX141"></A>
<A NAME="IDX142"></A>
In many cases, users have wanted <CODE>LOCK TABLES</CODE> and/or <CODE>ROLLBACK</CODE>
for the purpose of managing unique identifiers.  This can be handled much
more efficiently without locking or rolling back by using an
<CODE>AUTO_INCREMENT</CODE> column and either the SQL function
<CODE>LAST_INSERT_ID()</CODE> or the C API function <CODE>mysql_insert_id()</CODE>.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.
See section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

<A NAME="IDX143"></A>
<A NAME="IDX144"></A>
You can generally code around the need for row-level locking. Some situations
really do need it, and <CODE>InnoDB</CODE> tables support row-level locking. With
<CODE>MyISAM</CODE> tables, you can use a flag column in the table and do something
like the following:


<PRE>
UPDATE tbl_name SET row_flag=1 WHERE id=ID;
</PRE>

MySQL returns 1 for the number of affected rows if the row was
found and <CODE>row_flag</CODE> wasn't already 1 in the original row.

You can think of it as though MySQL Server changed the preceding query to:


<PRE>
UPDATE tbl_name SET row_flag=1 WHERE id=ID AND row_flag &#60;&#62; 1;
</PRE>

</UL>



<H4><A NAME="ANSI_diff_Triggers" HREF="manual_toc.html#ANSI_diff_Triggers">1.8.5.4  Stored Procedures and Triggers</A></H4>

<P>
<A NAME="IDX145"></A>
<A NAME="IDX146"></A>
<A NAME="IDX147"></A>

</P>
<P>
Stored procedures are implemented in MySQL version 5.0.
See section <A HREF="manual.html#Stored_Procedures">19  Stored Procedures and Functions</A>.

</P>
<P>
Triggers are scheduled for implementation in MySQL version 5.1. A ``trigger'' is
effectively a type of stored procedure, one that is invoked when a particular
event occurs.
For example, you could set up a stored procedure that is triggered
each time a record is deleted from a transactional table, and that stored
procedure automatically deletes the corresponding customer from a customer
table when all their transactions are deleted.

</P>



<H4><A NAME="ANSI_diff_Foreign_Keys" HREF="manual_toc.html#ANSI_diff_Foreign_Keys">1.8.5.5  Foreign Keys</A></H4>

<P>
<A NAME="IDX148"></A>
<A NAME="IDX149"></A>

</P>
<P>
In MySQL Server 3.23.44 and up, the <CODE>InnoDB</CODE> storage engine supports
checking of foreign key constraints, including <CODE>CASCADE</CODE>, <CODE>ON
DELETE</CODE>, and <CODE>ON UPDATE</CODE>. See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.

</P>
<P>
For storage engines other than <CODE>InnoDB</CODE>, MySQL Server parses the
<CODE>FOREIGN KEY</CODE> syntax in <CODE>CREATE TABLE</CODE> statements, but does not
use or store it. In the future, the implementation will be
extended to store this information in the table specification file so that it
may be retrieved by <CODE>mysqldump</CODE> and ODBC.  At a later stage,
foreign key constraints will be implemented for <CODE>MyISAM</CODE> tables as well.

</P>
<P>
Foreign key enforcement offers several benefits to database developers:

</P>

<UL>
<LI>

Assuming proper design of the relationships, foreign key constraints
make it more difficult for a programmer to introduce an inconsistency
into the database.

<LI>

Centralized checking of constraints by the database server makes it
unnecessary to perform these checks on the application side. This
eliminates the possibility that different applications may not all check the
constraints in the same way.

<LI>

Using cascading updates and deletes can simplify the application code.

<LI>

Properly designed foreign key rules aid in documenting relationships
between tables.
</UL>

<P>
Do keep in mind that these benefits come at the cost of additional overhead
for the database server to perform the necessary checks. Additional checking
by the server affects performance, which for some applications may be
sufficiently undesirable as to be avoided if possible.
(Some major commercial applications have coded the foreign-key logic at the
application level for this reason.)

</P>
<P>
MySQL gives database developers the choice of which approach to use. If you
don't need foreign keys and want to avoid the overhead associated with
enforcing referential integrity, you can choose another table type instead,
such as <CODE>MyISAM</CODE>. (For example, the <CODE>MyISAM</CODE> storage engine offers
very fast performance for applications that perform only <CODE>INSERT</CODE> and
<CODE>SELECT</CODE> operations, because the inserts can be performed concurrently
with retrievals.  See section <A HREF="manual.html#Table_locking">7.3.2  Table Locking Issues</A>.)

</P>
<P>
If you choose not to take advantage of referential integrity checks,
keep the following considerations in mind:

</P>

<UL>
<LI>

In the absence of server-side foreign key relationship checking, the
application itself must handle relationship issues.  For example, it must
take care to insert rows into tables in the proper
order, and to avoid creating orphaned child records. It must also be able to
recover from errors that occur in the middle of multiple-record insert
operations.

<LI>

If <CODE>ON DELETE</CODE> is the only referential integrity capability an
application needs, note that as of MySQL Server 4.0, you can use
multiple-table <CODE>DELETE</CODE> statements to delete rows from many
tables with a single statement. See section <A HREF="manual.html#DELETE">14.1.1  <CODE>DELETE</CODE> Syntax</A>.

<LI>

A workaround for the lack of <CODE>ON DELETE</CODE> is to add
the appropriate <CODE>DELETE</CODE> statement to your application when you
delete records from a table that has a foreign key. In practice, this is often
as quick as using foreign keys, and is more portable.

</UL>

<P>
Be aware that the use of foreign keys can in some instances lead
to problems:

</P>

<UL>
<LI>

Foreign key support addresses many referential integrity
issues, but it is still necessary to design key relationships carefully to avoid
circular rules or incorrect combinations of cascading deletes.

<LI>

It is not uncommon for a DBA to create a topology of relationships that
makes it difficult to restore individual tables from a backup.
(MySQL alleviates this difficulty by allowing you to temporarily disable
foreign key checks when reloading a table that depends on other tables.
See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.
As of MySQL 4.1.1,
<CODE>mysqldump</CODE> generates dump files that take advantage of this
capability automatically when reloaded.)
</UL>

<P>
Note that foreign keys in SQL are used to check and enforce referential
integrity, not to join tables.  If you want to get results from multiple
tables from a <CODE>SELECT</CODE> statement, you do this by performing a join
between them:

</P>

<PRE>
SELECT * FROM table1,table2 WHERE table1.id = table2.id;
</PRE>

<P>
See section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>. See section <A HREF="manual.html#example-Foreign_keys">3.6.6  Using Foreign Keys</A>.

</P>
<P>
The <CODE>FOREIGN KEY</CODE> syntax without <CODE>ON DELETE ...</CODE> is often used
by ODBC applications to produce automatic <CODE>WHERE</CODE> clauses.

</P>



<H4><A NAME="ANSI_diff_Views" HREF="manual_toc.html#ANSI_diff_Views">1.8.5.6  Views</A></H4>

<P>
<A NAME="IDX150"></A>

</P>
<P>
Views are currently being implemented, and will appear in the 5.0 or 5.1
version of MySQL Server.
Unnamed views (<EM>derived tables</EM>, a subquery in the <CODE>FROM</CODE>
clause of a <CODE>SELECT</CODE>) are already implemented in version 4.1.

</P>
<P>
Historically, MySQL Server has been most used in applications and on Web
systems where the application writer has full control over database
usage. Usage has shifted over time, and so we find that an
increasing number of users now regard views as an important feature.

</P>
<P>
Views are useful for allowing users to access a set of relations (tables)
as if it were a single table, and limiting their access to just that.
Views can also be used to restrict access to rows (a subset of a
particular table).
One does not require views to restrict access to columns, because MySQL Server
has a sophisticated privilege system.
See section <A HREF="manual.html#Privilege_system">5.4  The MySQL Access Privilege System</A>.

</P>
<P>
Many DBMS don't allow updates to a view. Instead, you have to perform the
updates on the individual tables.
In designing an implementation of views, our goal, as much as is possible
within the confines of SQL, is full compliance with
``<STRONG>Codd's Rule #6</STRONG>'' for relational database systems: All views
that are theoretically updatable, should in practice also be updatable.

</P>



<H4><A NAME="ANSI_diff_comments" HREF="manual_toc.html#ANSI_diff_comments">1.8.5.7  <SAMP>`--'</SAMP> as the Start of a Comment</A></H4>

<P>
<A NAME="IDX151"></A>
<A NAME="IDX152"></A>

</P>
<P>
Some other SQL databases use <SAMP>`--'</SAMP> to start comments.
MySQL Server uses <SAMP>`#'</SAMP> as the start comment character. You can also use
the C comment style <CODE>/* this is a comment */</CODE> with MySQL Server.
See section <A HREF="manual.html#Comments">10.5  Comment Syntax</A>.

</P>
<P>
MySQL Server Version 3.23.3 and above support the <SAMP>`--'</SAMP> comment style,
provided the comment is followed by a space (or by a control character such
as a newline). The requirement for a space is to prevent problems with
automatically generated SQL queries that have used something like the following code, where we automatically insert the value of the payment for
<CODE>!payment!</CODE>:

</P>

<PRE>
UPDATE tbl_name SET credit=credit-!payment!
</PRE>

<P>
Think about what happens if the value of <CODE>payment</CODE> is a negative value
such as <CODE>-1</CODE>:

</P>

<PRE>
UPDATE tbl_name SET credit=credit--1
</PRE>

<P>
<CODE>credit--1</CODE> is a legal expression in SQL, but if <CODE>--</CODE> is interpreted
as the start of a comment, part of the expression is discarded. The result is a
statement that has a completely different meaning than intended:

</P>

<PRE>
UPDATE tbl_name SET credit=credit
</PRE>

<P>
The statement produces no change in value at all!  This illustrates that
allowing comments to start with <SAMP>`--'</SAMP> can have serious consequences.

</P>
<P>
Using our implementation of this method of commenting in MySQL Server
Version 3.23.3 and up, <CODE>credit--1</CODE> is actually safe.

</P>
<P>
Another safe feature is that the <CODE>mysql</CODE> command-line client
removes all lines that start with <SAMP>`--'</SAMP>.

</P>

<P>
The following information is relevant only if you are running a
MySQL version earlier than 3.23.3:

</P>
<P>
If you have an SQL program in a text file that contains <SAMP>`--'</SAMP>
comments, you should use the <CODE>replace</CODE> utility as follows to convert the
comments to use <SAMP>`#'</SAMP> characters:

</P>

<PRE>
shell&#62; replace " --" " #" &#60; text-file-with-funny-comments.sql \
         | mysql db_name
</PRE>

<P>
instead of the usual:

</P>

<PRE>
shell&#62; mysql db_name &#60; text-file-with-funny-comments.sql
</PRE>

<P>
You can also edit the command file ``in place'' to change the <SAMP>`--'</SAMP>
comments to <SAMP>`#'</SAMP> comments:

</P>

<PRE>
shell&#62; replace " --" " #" -- text-file-with-funny-comments.sql
</PRE>

<P>
Change them back with this command:

</P>

<PRE>
shell&#62; replace " #" " --" -- text-file-with-funny-comments.sql
</PRE>



<H3><A NAME="Constraints" HREF="manual_toc.html#Constraints">1.8.6  How MySQL Deals with Constraints</A></H3>

<P>
<A NAME="IDX153"></A>

</P>
<P>
MySQL allows you to work with both transactional tables that allow rollback and
non-transactional tables that do not, so constraint handling is
a bit different in MySQL than in other databases.

</P>
<P>
We have to handle the case when you have updated a lot of rows in a
non-transactional table that cannot roll back when an error occurs.

</P>
<P>
The basic philosophy is to try to give an error for anything that we can
detect at compile time but try to recover from any errors we get at runtime.
We do this in most cases, but not yet for all. See section <A HREF="manual.html#TODO_future">1.6.4  New Features Planned for the Near Future</A>.

</P>
<P>
The options MySQL has when an error occurs are to stop the statement in the
middle or to recover as well as possible from the problem and continue.

</P>
<P>
The following sections describe what happens for the different types of
constraints.

</P>



<H4><A NAME="constraint_primary_key" HREF="manual_toc.html#constraint_primary_key">1.8.6.1  Constraint PRIMARY KEY / UNIQUE</A></H4>

<P>
<A NAME="IDX154"></A>
<A NAME="IDX155"></A>
<A NAME="IDX156"></A>

</P>
<P>
Normally you will get an error when you try to <CODE>INSERT</CODE> or
<CODE>UPDATE</CODE> a row that causes a primary key, unique key, or foreign key
violation.  If you are using a transactional storage engine such as
<CODE>InnoDB</CODE>, MySQL will automatically roll back the transaction.  If you are
using a non-transactional storage engine, MySQL will stop at the incorrect
row and leave any remaining rows unprocessed.

</P>
<P>
To make life easier, MySQL supports an <CODE>IGNORE</CODE> keyword for
most commands that can cause a key violation (such as <CODE>INSERT IGNORE</CODE>
and <CODE>UPDATE IGNORE</CODE>). In this case, MySQL will ignore any key
violation and continue with processing the next row.  You can get
information about what MySQL did with the <CODE>mysql_info()</CODE> API function.
See section <A HREF="manual.html#mysql_info">20.2.3.126  <CODE>mysql_info()</CODE></A>.
In MySQL 4.1 and up, you also can use the <CODE>SHOW WARNINGS</CODE> statement.
See section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.

</P>
<P>
Note that, for the moment, only <CODE>InnoDB</CODE> tables support foreign keys.
See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.
Foreign key support in <CODE>MyISAM</CODE> tables is scheduled for implementation
in MySQL 5.1.

</P>



<H4><A NAME="constraint_NOT_NULL" HREF="manual_toc.html#constraint_NOT_NULL">1.8.6.2  Constraint <CODE>NOT NULL</CODE> and <CODE>DEFAULT</CODE> Values</A></H4>

<P>
<A NAME="IDX157"></A>
<A NAME="IDX158"></A>
<A NAME="IDX159"></A>

</P>
<P>
To be able to support easy handling of non-transactional tables, all
columns in MySQL have default values. 

</P>
<P>
If you insert an ``incorrect'' value in a column, such as a <CODE>NULL</CODE> in a
<CODE>NOT NULL</CODE> column or a too-large numerical value in a numerical
column, MySQL sets the column to the ``best possible value''
instead of producing an error.  For numerical values, this is 0, the
smallest possible value, or the largest possible value. For strings, this is
either the empty string or the longest possible string that can be in
the column.

</P>
<P>
This means that if you try to store <CODE>NULL</CODE> into a column that
doesn't take <CODE>NULL</CODE> values, MySQL Server instead stores 0 or <CODE>''</CODE>
(the empty string). This last behavior can, for single-row
inserts, be changed with the <CODE>-DDONT_USE_DEFAULT_FIELDS</CODE> compile
option.) See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.
This causes <CODE>INSERT</CODE> statements to generate an error unless you
explicitly specify values for all columns that require a non-<CODE>NULL</CODE>
value.

</P>
<P>
The reason for the preceding rules is that we can't check these conditions
until the query has begun executing.  We can't just roll back if we
encounter a problem after updating a few rows, because the table type may
not support rollback.  The option of terminating the statement is not that
good; in this case, the update would be ``half done,'' which is probably the
worst possible scenario.  In this case, it's better to ``do the best you
can'' and then continue as if nothing happened.

</P>
<P>
This means that you should generally not use MySQL to check column content.
Instead, the application should ensure that is passes only legal values to
MySQL.

</P>
<P>
In MySQL 5.0, we plan to improve this by providing warnings when automatic
column conversions occur, plus an option to let you roll back statements
that attempt to perform a disallowed column value assignment, as long as the
statement uses only transactional tables.

</P>



<H4><A NAME="constraint_enum" HREF="manual_toc.html#constraint_enum">1.8.6.3  Constraint <CODE>ENUM</CODE> and <CODE>SET</CODE></A></H4>

<P>
In MySQL 4.x, <CODE>ENUM</CODE> is not a real constraint, but is a more efficient
way to define columns that can contain only a given set of values.
This is because of the same reasons <CODE>NOT NULL</CODE> is not honored.
See section <A HREF="manual.html#constraint_NOT_NULL">1.8.6.2  Constraint <CODE>NOT NULL</CODE> and <CODE>DEFAULT</CODE> Values</A>.

</P>
<P>
If you insert an incorrect value into an <CODE>ENUM</CODE> column, it will be set to
the reserved enumeration value <CODE>0</CODE>, which will be displayed as an empty
string in string context. See section <A HREF="manual.html#ENUM">12.4.3  The <CODE>ENUM</CODE> Type</A>.

</P>
<P>
If you insert an incorrect value into a <CODE>SET</CODE> column, the incorrect value
is ignored. For example, if the column can contain the values
<CODE>'a'</CODE>, <CODE>'b'</CODE>, and <CODE>'c'</CODE>, an attempt to assign <CODE>'a,x,b,y'</CODE>
results in a value of <CODE>'a,b'</CODE>.
See section <A HREF="manual.html#SET">12.4.4  The <CODE>SET</CODE> Type</A>.

</P>


<H3><A NAME="Bugs" HREF="manual_toc.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A></H3>

<P>
<A NAME="IDX160"></A>
<A NAME="IDX161"></A>
<A NAME="IDX162"></A>
<A NAME="IDX163"></A>

</P>



<H4><A NAME="Errors_in_3.23" HREF="manual_toc.html#Errors_in_3.23">1.8.7.1  Errors in 3.23 Fixed in a Later MySQL Version</A></H4>

<P>
The following known errors or bugs are not fixed in MySQL 3.23 because fixing
them would involve changing a lot of code that could introduce other
even worse bugs. The bugs are also classified as ``not fatal'' or
``bearable.''

</P>

<UL>
<LI>

You can get a deadlock if you use <CODE>LOCK TABLE</CODE> to lock multiple tables
and then in the same connection use <CODE>DROP TABLE</CODE> to drop one of
them while another thread is trying to lock it.  (To break the deadlock, you
can use <CODE>KILL</CODE> to terminate any of the threads involved.) This issue is
resolved in MySQL 4.0.12.
<LI>

<CODE>SELECT MAX(key_column) FROM t1,t2,t3...</CODE> where one of the tables are
empty doesn't return <CODE>NULL</CODE> but instead returns the maximum value for the
column.  This issue is resolved in MySQL 4.0.11.
<LI>

<CODE>DELETE FROM heap_table</CODE> without a <CODE>WHERE</CODE> clause doesn't work on
a locked <CODE>HEAP</CODE> table.
</UL>



<H4><A NAME="Errors_in_4.0" HREF="manual_toc.html#Errors_in_4.0">1.8.7.2  Errors in 4.0 Fixed in a Later MySQL Version</A></H4>

<P>
The following known errors or bugs are not fixed in MySQL 4.0 because fixing
them would involve changing a lot of code that could introduce other
even worse bugs. The bugs are also classified as ``not fatal'' or
``bearable.''

</P>

<UL>
<LI>

In a <CODE>UNION</CODE>, the first <CODE>SELECT</CODE> determines the type,
<CODE>max_length</CODE>, and <CODE>NULL</CODE> properties for the resulting
columns.  This issue is resolved in MySQL 4.1.1; the property values are based
on the rows from all <CODE>UNION</CODE> parts.
<LI>

In <CODE>DELETE</CODE> with many tables, you can't refer to tables to be
deleted through an alias. This is fixed in 4.1.
<LI>

You cannot mix <CODE>UNION ALL</CODE> and <CODE>UNION DISTINCT</CODE> in the same query.
If you use <CODE>ALL</CODE> for one <CODE>UNION</CODE>, it is used for all
of them.
</UL>



<H4><A NAME="Open_bugs" HREF="manual_toc.html#Open_bugs">1.8.7.3  Open Bugs and Design Deficiencies in MySQL</A></H4>

<P>
The following problems are known and fixing them is a high priority:

</P>

<UL>
<LI>

Even if you are using <CODE>lower_case_table_names=2</CODE> (which enables
MySQL to remember the used case for databases and table names) MySQL
will not on case insensitive systems remember the used case for database
names for the function <CODE>DATABASE()</CODE> or in various logs.

<LI>

Dropping a <CODE>FOREIGN KEY</CODE> constraint doesn't work in replication because
the constraint may have another name on the slave.

<LI>

<CODE>REPLACE</CODE> (and <CODE>LOAD DATA</CODE> with <CODE>REPLACE</CODE> option) does not
trigger <CODE>ON DELETE CASCADE</CODE>.

<LI>

<CODE>DISTINCT</CODE> with <CODE>ORDER BY</CODE> doesn't work inside <CODE>GROUP_CONCAT()</CODE>
if you don't use all and only those columns that are in the
<CODE>DISTINCT</CODE> list.

<LI>

<CODE>GROUP_CONCAT()</CODE> doesn't work with <CODE>BLOB</CODE>/<CODE>TEXT</CODE> columns
when you use <CODE>DISTINCT</CODE> or <CODE>ORDER BY</CODE> inside
<CODE>GROUP_CONCAT()</CODE>. To work around this limitation, use
<CODE>MID(expr, 1, 255)</CODE> instead.

<LI>

If one user has a long-running transaction and another user drops a
table that is updated in the transaction, there is small chance that the
binary log may contain the <CODE>DROP TABLE</CODE> command before the table is
used in the transaction itself.  We plan to fix this in 5.0 by
having the <CODE>DROP TABLE</CODE> wait until the table is not used in any
transaction.

<LI>

When inserting a big integer value (between 2^63 and 2^64-1) into a
decimal/string column, it is inserted as a negative value because
the number is evaluated in a signed integer context. It is planned
to be fixed in 4.1.

<LI>

<CODE>FLUSH TABLES WITH READ LOCK</CODE> does not block <CODE>CREATE TABLE</CODE> or
<CODE>COMMIT</CODE>, which may cause a problem with the binary log position when
doing a full backup of tables and the binary log.

<LI>

<CODE>ANALYZE TABLE</CODE> on a <CODE>BDB</CODE> table may in some cases make the table
unusable until you restart <CODE>mysqld</CODE>.  If this happens, you will
see errors of the following form in the MySQL error file:


<PRE>
001207 22:07:56  bdb:  log_flush: LSN past current end-of-log
</PRE>

<LI>

MySQL accepts parentheses in the <CODE>FROM</CODE> part of a <CODE>SELECT</CODE>
statement, but silently
ignores them.  The reason for not giving an error is that many clients
that automatically generate queries add parentheses in the <CODE>FROM</CODE>
part even where they are not needed.

<LI>

Concatenating many <CODE>RIGHT JOINS</CODE> or combining <CODE>LEFT</CODE> and
<CODE>RIGHT</CODE> join in the same query may not give a correct answer because
MySQL only generates <CODE>NULL</CODE> rows for the table preceding a <CODE>LEFT</CODE> or
before a <CODE>RIGHT</CODE> join.  This will be fixed in 5.0 at the same time
we add support for parentheses in the <CODE>FROM</CODE> part.

<LI>

Don't execute <CODE>ALTER TABLE</CODE> on a <CODE>BDB</CODE> table on which you are
running multiple-statement transactions until all those transactions complete.
(The transaction will probably be ignored.)

<LI>

<CODE>ANALYZE TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, and <CODE>REPAIR TABLE</CODE> may
cause problems on tables for which you are using <CODE>INSERT DELAYED</CODE>.

<LI>

Doing a <CODE>LOCK TABLE ...</CODE> and <CODE>FLUSH TABLES ...</CODE> doesn't
guarantee that there isn't a half-finished transaction in progress on the
table.

<LI>

<CODE>BDB</CODE> tables are a bit slow to open. If you have many <CODE>BDB</CODE> tables
in a database, it will take a long time to use the <CODE>mysql</CODE> client on
the database if you are not using the <CODE>-A</CODE> option or if you are using
<CODE>rehash</CODE>. This is especially notable when you have a large table cache.

<LI>

Replication uses query-level logging: The master writes the executed
queries to the binary log. This is a very fast, compact, and efficient
logging method that works perfectly in most cases.
Although we have never heard of it actually occurring, it is theoretically
possible for the data on the master and slave to become different if a
query is designed in such a way that the data modification is
non-deterministic; that is, left to the will of the query optimizer. (That
generally is not a good practice anyway, even outside of replication!)
For example: 


<UL>
<LI>

<CODE>CREATE ... SELECT</CODE> or
<CODE>INSERT ... SELECT</CODE>  statements that
insert zero or <CODE>NULL</CODE> values into an <CODE>AUTO_INCREMENT</CODE> column.
<LI>

<CODE>DELETE</CODE> if you are
deleting rows from a table which has foreign keys with <CODE>ON DELETE
CASCADE</CODE> properties.
<LI>

<CODE>REPLACE ... SELECT</CODE>, 
<CODE>INSERT IGNORE ... SELECT</CODE> if you have
duplicate key values in the inserted data.
</UL>

<STRONG>If and only if all these queries have no <CODE>ORDER BY</CODE>
clause guaranteeing a deterministic order</STRONG>.

For example, for <CODE>INSERT ... SELECT</CODE> with no <CODE>ORDER
BY</CODE>, the <CODE>SELECT</CODE> may return rows in a different order
(which will result in a row having different ranks, hence getting a
different number in the <CODE>AUTO_INCREMENT</CODE> column),
depending on the choices made by the optimizers on the master and
slave. A query will be optimized differently on the master and slave only if:


<UL>
<LI>

The files used by the two queries are not exactly the same; for
example, <CODE>OPTIMIZE TABLE</CODE> was run on the master tables and not on
the slave tables. (To fix this, <CODE>OPTIMIZE TABLE</CODE>, <CODE>ANALYZE TABLE</CODE>,
and <CODE>REPAIR TABLE</CODE> are written to the binary log, as of MySQL 4.1.1).
<LI>

The table is stored using a different storage engine on the master than
on the slave. (It is possible to use different storage engines on the master
and slave. For example, you can use <CODE>InnoDB</CODE> on the master,
but <CODE>MyISAM</CODE> on the slave if the slave has less available disk
space.)
<LI>

MySQL buffer sizes (<CODE>key_buffer_size</CODE>, and so on) are different on
the master and slave. 
<LI>

The master and slave run different MySQL versions, and the optimizer
code differs between these versions.
</UL>

This problem may also affect database restoration using
<CODE>mysqlbinlog|mysql</CODE>.

The easiest way to avoid this problem in all cases is add an
<CODE>ORDER BY</CODE> clause to 
such non-deterministic queries to ensure that the rows are always
stored or modified in the same order. 
In future MySQL versions, we will automatically add an <CODE>ORDER BY</CODE>
clause when needed.

</UL>

<P>
The following problems are known and will be fixed in due time:

</P>

<UL>

<LI>

Log files are based on hostnames (if you don't specify a file name with
the startup option). For now you have to use options like
<CODE>--log-bin=old_host_name-bin</CODE> if you change your hostname to
something else. Another option is to just rename the old files to
reflect your hostname change. See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

<LI>

<CODE>mysqlbinlog</CODE> will not delete temporary files left after a
<CODE>LOAD DATA INFILE</CODE> command. See section <A HREF="manual.html#mysqlbinlog">8.5  The <CODE>mysqlbinlog</CODE> Binary Log Utility</A>.

<LI>

<CODE>RENAME</CODE> doesn't work with <CODE>TEMPORARY</CODE> tables or tables used in a
<CODE>MERGE</CODE> table.

<LI>

When using the <CODE>RPAD()</CODE> function in a query that has to be
resolved by using a temporary table, all resulting strings will
have rightmost spaces removed. This is an example of such a query:


<PRE>
SELECT RPAD(t1.column1, 50, ' ') AS f2, RPAD(t2.column2, 50, ' ') AS f1
FROM table1 as t1 LEFT JOIN table2 AS t2 ON t1.record=t2.joinID
ORDER BY t2.record;
</PRE>

The final result of this bug is that you will not be able to get spaces on
the right side of the resulting values. The problem also occurs for any other
string function that adds spaces to the right.

The reason for this is due to the fact that <CODE>HEAP</CODE> tables, which are used
first for temporary tables, are not capable of handling <CODE>VARCHAR</CODE> columns.

This behavior exists in all versions of MySQL. 
It will be fixed in one of the 4.1 series releases.

<LI>

Due to the way table definition files are stored, you cannot use
character 255 (<CODE>CHAR(255)</CODE>) in table names, column names, or enumerations.
This is scheduled to be fixed in version 5.1 when we have new table
definition format files.

<LI>

When using <CODE>SET CHARACTER SET</CODE>, you can't use translated
characters in database, table, and column names.

<LI>

You can't use <CODE>_</CODE> or <CODE>%</CODE> with <CODE>ESCAPE</CODE> in <CODE>LIKE
... ESCAPE</CODE>.

<LI>

If you have a <CODE>DECIMAL</CODE> column with a  number stored in different
formats (+01.00, 1.00, 01.00), <CODE>GROUP BY</CODE> may regard each value
as a different value.

<LI>

<CODE>DELETE FROM merge_table</CODE> used without a <CODE>WHERE</CODE> clause
will clear only the mapping for the table, not delete everything in the
mapped tables.

<LI>

You cannot build the server in another directory when using
MIT-pthreads. Because this requires changes to MIT-pthreads, we are not
likely to fix this. See section <A HREF="manual.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A>.

<LI>

<CODE>BLOB</CODE> values can't ``reliably'' be used in <CODE>GROUP BY</CODE> or
<CODE>ORDER BY</CODE> or <CODE>DISTINCT</CODE>. Only the first <CODE>max_sort_length</CODE>
bytes are used when comparing <CODE>BLOB</CODE> values in these cases.
The default value of <CODE>max_sort_length</CODE> value is 1024. It can be changed
at server startup time.  A workaround for most cases is to use a substring.
For example:
<CODE>SELECT DISTINCT LEFT(blob,2048) FROM tbl_name</CODE>.

<LI>

Numeric
calculations are done with <CODE>BIGINT</CODE> or <CODE>DOUBLE</CODE> (both are
normally 64 bits long). It depends on the function which precision one
gets. The general rule is that bit functions are done with <CODE>BIGINT</CODE>
precision, <CODE>IF</CODE>, and <CODE>ELT()</CODE> with <CODE>BIGINT</CODE> or <CODE>DOUBLE</CODE>
precision and the rest with <CODE>DOUBLE</CODE> precision.  You should try to
avoid using unsigned long long values if they resolve to be bigger than
63 bits (9223372036854775807) for anything other than bit fields.
MySQL Server 4.0 has better <CODE>BIGINT</CODE> handling than 3.23.

<LI>

All string columns, except <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns, automatically
have all trailing spaces removed when retrieved. For <CODE>CHAR</CODE> types, this
is okay. The bug is
that in MySQL Server, <CODE>VARCHAR</CODE> columns are treated the same way.

<LI>

You can only have up to 255 <CODE>ENUM</CODE> and <CODE>SET</CODE> columns in one table.

<LI>

In <CODE>MIN()</CODE>, <CODE>MAX()</CODE>, and other aggregate functions, MySQL
currently compares <CODE>ENUM</CODE> and <CODE>SET</CODE> columns by their string
value rather than by the string's relative position in the set.

<LI>

<CODE>mysqld_safe</CODE> redirects all messages from <CODE>mysqld</CODE> to the
<CODE>mysqld</CODE> log.  One problem with this is that if you execute
<CODE>mysqladmin refresh</CODE> to close and reopen the log,
<CODE>stdout</CODE> and <CODE>stderr</CODE> are still redirected to the old log.
If you use <CODE>--log</CODE> extensively, you should edit <CODE>mysqld_safe</CODE> to
log to <TT>`host_name.err'</TT> instead of <TT>`host_name.log'</TT> so that you can
easily reclaim the space for the old log by deleting the old one and
executing <CODE>mysqladmin refresh</CODE>.

<LI>

In the <CODE>UPDATE</CODE> statement, columns are updated from left to right.  If
you refer to an updated column, you will get the updated value instead of the
original value. For example:


<PRE>
mysql&#62; UPDATE tbl_name SET KEY=KEY+1,KEY=KEY+1;
</PRE>

This will increment <CODE>KEY</CODE> by <CODE>2</CODE>, not <CODE>1</CODE>.

<LI>

You can refer to multiple temporary tables in the same query, but
you cannot refer to any given temporary table more than once.
For example, the following doesn't work:


<PRE>
mysql&#62; SELECT * FROM temporary_table, temporary_table AS t2;
</PRE>

<LI>

The optimizer may handle <CODE>DISTINCT</CODE> differently if you are using
``hidden'' columns in a join or not.  In a join, hidden columns are
counted as part of the result (even if they are not shown), whereas in
normal queries, hidden columns don't participate in the <CODE>DISTINCT</CODE>
comparison.  We will probably change this in the future to never compare
the hidden columns when executing <CODE>DISTINCT</CODE>.

An example of this is:


<PRE>
SELECT DISTINCT mp3id FROM band_downloads
       WHERE userid = 9 ORDER BY id DESC;
</PRE>

and


<PRE>
SELECT DISTINCT band_downloads.mp3id
       FROM band_downloads,band_mp3
       WHERE band_downloads.userid = 9
       AND band_mp3.id = band_downloads.mp3id
       ORDER BY band_downloads.id DESC;
</PRE>

In the second case, you may in MySQL Server 3.23.x get two identical rows in
the result set (because the values in the hidden <CODE>id</CODE> column may differ).

Note that this happens only for queries where you don't have the
<CODE>ORDER BY</CODE> columns in the result.

<LI>

Because MySQL Server allows you to work with table types that don't
support transactions, and thus can't roll back data, some things
behave a little differently in MySQL Server than in other SQL servers.
This is just to ensure that MySQL Server never needs to do a rollback
for an SQL statement.  This may be a little awkward at times because column
values must be checked in the application, but this will actually give
you a nice speed increase because it allows MySQL Server to do some
optimizations that otherwise would be very hard to do.

If you set a column to an incorrect value, MySQL Server will, instead of
doing a rollback, store the <CODE>best possible value</CODE> in the column:


<UL>
<LI>

If you try to store a value outside the range in a numerical column,
MySQL Server instead stores the smallest or largest possible value in
the column.

<LI>

If you try to store a string that doesn't start with a number into a
numerical column, MySQL Server stores 0.

<LI>

If you try to store <CODE>NULL</CODE> into a column that doesn't allow
<CODE>NULL</CODE> values, MySQL Server stores 0 or <CODE>''</CODE> (the empty
string) in it instead. (This behavior can, however, be changed with the
<CODE>-DDONT_USE_DEFAULT_FIELDS</CODE> compile option.)

<LI>

MySQL allows you to store some wrong date values into <CODE>DATE</CODE> and
<CODE>DATETIME</CODE> columns (like <CODE>'2000-02-31'</CODE> or <CODE>'2000-02-00'</CODE>).
The idea is that it's not the job of the SQL server to validate dates. If
MySQL can store a date value and retrieve exactly the same value, MySQL
stores it as given.  If the date is totally wrong (outside the server's
ability to store it), the special date value <CODE>'0000-00-00'</CODE> is stored
in the column instead.

<LI>

If you set an <CODE>ENUM</CODE> column to an unsupported value, it is set to
the error value <CODE>empty string</CODE>, with numeric value 0.

<LI>

If you set a <CODE>SET</CODE> column to an unsupported value, the value is ignored.

</UL>

<LI>

If you execute a <CODE>PROCEDURE</CODE> on a query that returns an empty set,
in some cases the <CODE>PROCEDURE</CODE> will not transform the columns.

<LI>

Creation of a table of type <CODE>MERGE</CODE> doesn't check whether the underlying
tables are of compatible types.

<LI>

If you use <CODE>ALTER TABLE</CODE> to first add a <CODE>UNIQUE</CODE> index to a
table used in a <CODE>MERGE</CODE> table and then use <CODE>ALTER TABLE</CODE> to
add a normal index on the <CODE>MERGE</CODE> table, the key order will be
different for the tables if there was an old key that was not unique in the
table. This is because <CODE>ALTER TABLE</CODE> puts <CODE>UNIQUE</CODE> indexes before
normal indexes to be able to detect duplicate keys as early as possible.
</UL>

<P>
The following are known bugs in earlier versions of MySQL:

</P>

<UL>
<LI>

You can get a hung thread if you do a <CODE>DROP TABLE</CODE> on a table that is
one among many tables that is locked with <CODE>LOCK TABLES</CODE>.

<LI>

In the following case you can get a core dump:


<UL>
<LI>

Delayed insert handler has pending inserts to a table.

<LI>

<CODE>LOCK table</CODE> with <CODE>WRITE</CODE>.

<LI>

<CODE>FLUSH TABLES</CODE>.
</UL>

<LI>

Before MySQL Server Version 3.23.2, an <CODE>UPDATE</CODE> that updated a key with
a <CODE>WHERE</CODE> on the same key may have failed because the key was used to
search for records and the same row may have been found multiple times:


<PRE>
UPDATE tbl_name SET KEY=KEY+1 WHERE KEY &#62; 100;
</PRE>

A workaround is to use:


<PRE>
mysql&#62; UPDATE tbl_name SET KEY=KEY+1 WHERE KEY+0 &#62; 100;
</PRE>

This will work because MySQL Server will not use an index on expressions in
the <CODE>WHERE</CODE> clause.

<LI>

Before MySQL Server Version 3.23, all numeric types were treated as
fixed-point fields. That means that you had to specify how many decimals
a floating-point field should have. All results were returned with the
correct number of decimals.
</UL>

<P>
For platform-specific bugs, see the sections about compiling and porting.
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.
See section <A HREF="manual.html#Porting">D  Porting to Other Systems</A>.

</P>



<H1><A NAME="Installing" HREF="manual_toc.html#Installing">2  Installing MySQL</A></H1>

<P>
<A NAME="IDX164"></A>

</P>

<P>
This chapter describes how to obtain and install MySQL:

</P>

<OL>

<LI>

<STRONG>Determine whether your platform is supported.</STRONG>  Please note that
not all supported systems are equally good for running MySQL on them.
On some it is much more robust and efficient than others.
See section <A HREF="manual.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A> for details.

<LI>

<STRONG>Choose a distribution to install.</STRONG>  Several versions of MySQL are available,
and most are available in several distribution formats.  You can choose
from pre-packaged distributions containing binary (precompiled) programs or
source code.  When in doubt, use a binary distribution.  We also provide
public access to our current source tree for those who want to see our most
recent developments and help us test new code.  To determine which version
and type of distribution you should use, see section <A HREF="manual.html#Which_version">2.1.2  Choosing Which MySQL Distribution to Install</A>.

<LI>

<STRONG>Download the distribution that you want to install.</STRONG>
For a list of sites from which you can obtain MySQL, see
section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.
You can verify the integrity of the distribution using the instructions in
section <A HREF="manual.html#Verifying_Package_Integrity">2.1.4  Verifying Package Integrity Using MD5 Checksums or <CODE>GnuPG</CODE></A>.

<LI>

<STRONG>Install the distribution.</STRONG>  To install MySQL from a binary
distribution, use the instructions in section <A HREF="manual.html#Quick_Standard_Installation">2.2  Standard MySQL Installation Using a Binary Distribution</A>.
To install MySQL from a source distribution or from the current development
source tree, use the instructions in section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.

<STRONG>Note:</STRONG>
If you plan to upgrade an existing version of MySQL to a newer version
rather than installing MySQL for the first time, see section <A HREF="manual.html#Upgrade">2.5  Upgrading/Downgrading MySQL</A> for
information about upgrade procedures and about issues that you should
consider before upgrading.

If you encounter installation difficulties, see section <A HREF="manual.html#Operating_System_Specific_Notes">2.6  Operating System-Specific Notes</A> for information on solving problems for particular
platforms.

<LI>

<STRONG>Perform any necessary post-installation setup.</STRONG> After installing
MySQL, read section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.  This section contains important
information about making sure the MySQL server is working properly. It also
describes how to secure the initial MySQL user accounts, <EM>which have no
passwords</EM> until you assign passwords.  The section applies whether you
install MySQL using a binary or source distribution.

<LI>

If you want to run the MySQL benchmark scripts, Perl support for MySQL
must be available.
See section <A HREF="manual.html#Perl_support">2.7  Perl Installation Notes</A>.

</OL>



<H2><A NAME="General_Installation_Issues" HREF="manual_toc.html#General_Installation_Issues">2.1  General Installation Issues</A></H2>

<P>
Before installing MySQL, you should do the following:

</P>

<OL>
<LI>

Determine whether or not MySQL runs on your platform.

<LI>

Choose a distribution to install.

<LI>

Download the distribution and verify its integrity.

</OL>

<P>
This section contains the information necessary to carry out these steps.
After doing so, you can use the instructions in later sections of the chapter
to install the distribution that you choose.

</P>



<H3><A NAME="Which_OS" HREF="manual_toc.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A></H3>

<P>
<A NAME="IDX165"></A>
<A NAME="IDX166"></A>
<A NAME="IDX167"></A>
<A NAME="IDX168"></A>
<A NAME="IDX169"></A>

</P>
<P>
This section lists the operating systems on which you can expect to be able to
run MySQL.

</P>
<P>
We use GNU Autoconf, so it is possible to port MySQL to all modern systems
that have a C++ compiler and a working implementation of POSIX threads.
(Thread support is needed for the server. To compile only the client code,
the only requirement is a C++ compiler.) We use and develop the software
ourselves primarily on Linux (SuSE and Red Hat), FreeBSD, and Sun Solaris
(Versions 8 and 9).

</P>
<P>
MySQL has been reported to compile successfully on the following
combinations of operating system and thread package.  Note that for many
operating systems, native thread support works only in the latest versions.

</P>

<UL>
<LI>

AIX 4.x, 5.x with native threads.  See section <A HREF="manual.html#IBM-AIX">2.6.5.3  IBM-AIX notes</A>.
<LI>

Amiga.
<LI>

BSDI 2.x with the MIT-pthreads package.  See section <A HREF="manual.html#BSDI">2.6.4.5  BSD/OS Version 2.x Notes</A>.
<LI>

BSDI 3.0, 3.1 and 4.x with native threads.  See section <A HREF="manual.html#BSDI">2.6.4.5  BSD/OS Version 2.x Notes</A>.
<LI>

DEC UNIX 4.x with native threads.  See section <A HREF="manual.html#Alpha-DEC-UNIX">2.6.5.5  Alpha-DEC-UNIX Notes (Tru64)</A>.
<LI>

FreeBSD 2.x with the MIT-pthreads package.  See section <A HREF="manual.html#FreeBSD">2.6.4.1  FreeBSD Notes</A>.
<LI>

FreeBSD 3.x and 4.x with native threads.  See section <A HREF="manual.html#FreeBSD">2.6.4.1  FreeBSD Notes</A>.
<LI>

FreeBSD 4.x with LinuxThreads.  See section <A HREF="manual.html#FreeBSD">2.6.4.1  FreeBSD Notes</A>.
<LI>

HP-UX 10.20 with the DCE threads or the MIT-pthreads package.
See section <A HREF="manual.html#HP-UX_10.20">2.6.5.1  HP-UX Version 10.20 Notes</A>.
<LI>

HP-UX 11.x with the native threads.  See section <A HREF="manual.html#HP-UX_11.x">2.6.5.2  HP-UX Version 11.x Notes</A>.
<LI>

Linux 2.0+ with LinuxThreads 0.7.1+ or <CODE>glibc</CODE> 2.0.7+.  See section <A HREF="manual.html#Linux">2.6.1  Linux Notes</A>.
<LI>

Mac OS X.  See section <A HREF="manual.html#Mac_OS_X">2.6.2  Mac OS X Notes</A>.
<LI>

NetBSD 1.3/1.4 Intel and NetBSD 1.3 Alpha (requires GNU make).  See section <A HREF="manual.html#NetBSD">2.6.4.2  NetBSD Notes</A>.
<LI>

Novell NetWare 6.0.  See section <A HREF="manual.html#NetWare_installation">2.2.4  Installing MySQL on NetWare</A>.
<LI>

OpenBSD &#62; 2.5 with native threads. OpenBSD &#60; 2.5 with the
MIT-pthreads package.  See section <A HREF="manual.html#OpenBSD">2.6.4.3  OpenBSD 2.5 Notes</A>.
<LI>

OS/2 Warp 3, FixPack 29 and OS/2 Warp 4, FixPack 4.  See section <A HREF="manual.html#OS_2">2.6.6  OS/2 Notes</A>.
<LI>

SCO OpenServer with a recent port of the FSU Pthreads package. 
See section <A HREF="manual.html#SCO">2.6.5.8  SCO Notes</A>.
<LI>

SCO UnixWare 7.1.x.  See section <A HREF="manual.html#SCO_UnixWare">2.6.5.9  SCO UnixWare Version 7.1.x Notes</A>.
<LI>

SGI Irix 6.x with native threads.  See section <A HREF="manual.html#SGI-Irix">2.6.5.7  SGI Irix Notes</A>.
<LI>

Solaris 2.5 and above with native threads on SPARC and x86.  See section <A HREF="manual.html#Solaris">2.6.3  Solaris Notes</A>.
<LI>

SunOS 4.x with the MIT-pthreads package.  See section <A HREF="manual.html#Solaris">2.6.3  Solaris Notes</A>.
<LI>

Tru64 Unix
<LI>

Windows 9x, Me, NT, 2000, and XP.  See section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.
</UL>

<P>
Not all platforms are equally well-suited for running
MySQL. How well a certain platform is suited for a high-load
mission-critical MySQL server is determined by the following
factors:

</P>

<UL>
<LI>

General stability of the thread library. A platform may have an excellent
reputation otherwise, but MySQL will be only as stable as the thread library
if that library is unstable in the code that is called by MySQL, even if
everything else is perfect.

<LI>

The capability of the kernel and the thread library to take advantage of
symmetric multi-processor (SMP) systems. In other words, when a process
creates a thread, it should be possible for that thread to run on a different
CPU than the original process.

<LI>

The capability of the kernel and the thread library to run many threads that
acquire and release a mutex over a short critical region frequently without
excessive context switches. In other words, if the implementation of
<CODE>pthread_mutex_lock()</CODE> is too anxious to yield CPU time, this will hurt
MySQL tremendously. If this issue is not taken care of, adding extra CPUs
will actually make MySQL slower.

<LI>

General filesystem stability and performance.

<LI>

If your tables are big, the ability of the filesystem to deal with large
files at all and to deal with them efficiently.

<LI>

Our level of expertise here at MySQL AB with the platform. If we know
a platform well, we enable platform-specific optimizations and fixes at
compile time. We can also provide advice on configuring your system optimally
for MySQL.

<LI>

The amount of testing we have done internally for similar configurations.

<LI>

The number of users that have successfully run MySQL on the
platform in similar configurations. If this number is high, the chances of
encountering platform-specific surprises are much smaller.
</UL>

<P>
Based on the preceding criteria, the best platforms for running
MySQL at this point are x86 with SuSE Linux using a 2.4 kernel, and
ReiserFS (or any similar Linux distribution) and SPARC with Solaris
(2.7-9). FreeBSD comes third, but we really hope it will join the top
club once the thread library is improved. We also hope that at some
point we will be able to include into the top category all other platforms
on which MySQL currently compiles and runs okay, but not quite with the
same level of stability and performance.  This will require some
effort on our part in cooperation with the developers of the operating system
and library components that MySQL depends on. If you are interested in
improving one of those components, are in a position to influence its
development, and need more detailed instructions on what MySQL
needs to run better, send an email message to the MySQL <CODE>internals</CODE>
mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>
<P>
Please note that the purpose of the preceding comparison is not to say that
one operating system is better or worse than another in general. We are
talking only about choosing an OS for the specific purpose of running MySQL.
With this in mind, the result of this comparison would be different if we
considered more factors. In some cases, the reason one OS is better than the
other could simply be that we have been able to put more effort into testing
and optimizing for a particular platform.  We are just stating our
observations to help you decide which platform to use for running MySQL.

</P>



<H3><A NAME="Which_version" HREF="manual_toc.html#Which_version">2.1.2  Choosing Which MySQL Distribution to Install</A></H3>

<P>
When preparing to install MySQL, you should decide which version
to use.  MySQL development occurs in several release series, and
you can pick the one that best fits your needs.  After deciding
which version to install, you can choose a distribution format.
Releases are available in binary or source format.

</P>

<P>
<A NAME="IDX170"></A>
<A NAME="IDX171"></A>
<A NAME="IDX172"></A>
<A NAME="IDX173"></A>
<A NAME="IDX174"></A>

</P>


<H4><A NAME="Choosing_version" HREF="manual_toc.html#Choosing_version">2.1.2.1  Choosing Which Version of MySQL to Install</A></H4>

<P>
The first decision to make is whether you want to use a production (stable)
release or a development release.  In the MySQL development process,
multiple release series co-exist, each at a different stage of maturity:

</P>

<UL>

<LI>

MySQL 5.0 is the newest development release series and is under very active
development for new features. Until recently it was available only in
preview form from the BitKeeper source repository. An early alpha release
has now been issued to allow more widespread testing.

<LI>

MySQL 4.1 is a development release series to which major new features have
been added. It is still at alpha status. Sources and binaries are available
for use and testing on development systems.

<LI>

MySQL 4.0 is the current stable (production-quality) release series.
New releases are issued for bugfixes. No new features are added
that could diminish the code stability.

<LI>

MySQL 3.23 is the old stable (production-quality) release series.
This series is retired, so new releases are issued only to fix
critical bugs.

</UL>

<P>
We don't believe in a complete freeze, as this also leaves out bugfixes and
things that ``must be done.''  ``Somewhat frozen'' means that we may add
small things that ``almost surely will not affect anything that's already
working.'' Naturally, relevant bugfixes from an earlier series propagate to
later series.

</P>
<P>
Normally, if you are beginning to use MySQL for the first time or trying
to port it to some system for which there is no binary distribution, we
recommend going with the production release series. Currently this is MySQL
4.0.  All MySQL releases, even those from development series, are
checked with the MySQL benchmarks and an extensive test suite before being
issued.

</P>
<P>
If you are running an old system and want to upgrade, but
don't want to take chances with a non-seamless upgrade, you should
upgrade to the latest version in the same release series you are using (where
only the last part of the version number is newer than yours).  We have tried
to fix only fatal bugs and make small, relatively safe changes to that version.

</P>
<P>
If you want to use new features not present in the production release
series, you can use a version from a development series. Note that
development releases are not as stable as production releases.

</P>
<P>
If you want to use the very latest sources containing all current patches and
bugfixes, you can use one of our BitKeeper repositories.
These are not ``releases'' as such, but are available as previews of the
code on which future releases will be based.

</P>
<P>
<A NAME="IDX175"></A>
<A NAME="IDX176"></A>

</P>
<P>
The MySQL naming scheme uses release names that consist of three
numbers and a suffix; for example, <CODE>mysql-4.1.0-alpha</CODE>.
The numbers within the release name are interpreted like this:

</P>

<UL>
<LI>

The first number (<CODE>4</CODE>) is the major version and also describes the
file format.  All Version 4 releases have the same file format.

<LI>

The second number (<CODE>1</CODE>) is the release level.
Taken together, the major version and release level constitute the release
series number.

<LI>

The third number (<CODE>0</CODE>) is the version number within the
release series.  This is incremented for each new release.  Usually you
want the latest version for the series you have chosen.

</UL>

<P>
For each minor update, the last number in the version string is incremented.
When there are major new features or minor incompatibilities with previous
versions, the second number in the version string is incremented.  When the
file format changes, the first number is increased.

</P>
<P>
Release names also include a suffix to indicates the stability level of the
release.  Releases within a series progress through a set of suffixes to
indicate how the stability level improves.
The possible suffixes are:

</P>

<UL>
<LI>

<CODE>alpha</CODE> indicates that the release contains some large section of
new code that hasn't been 100% tested.  Known bugs (usually there are none)
should be documented in the News section.  See section <A HREF="manual.html#News">C  MySQL Change History</A>.  There are also new
commands and extensions in most alpha releases.  Active development that
may involve major code changes can occur in an alpha release, but everything
will be tested before issuing a release.  For this reason, there should be
no known bugs in any MySQL release.

<LI>

<CODE>beta</CODE> means that all new code has been tested.  No major new
features that could cause corruption in old code are added.  There should
be no known bugs.  A version changes from alpha to beta when there
haven't been any reported fatal bugs within an alpha version for at least
a month and we have no plans to add any features that could make any old
command unreliable.

<LI>

<CODE>gamma</CODE> is a beta that has been around a while and seems to work fine.
Only minor fixes are added.  This is what many other companies call a release.

<LI>

If there is no suffix, it means that the version has been run for a
while at many different sites with no reports of bugs other than
platform-specific bugs.  Only critical bugfixes are applied to the
release. This is what we call a production (stable) release.
</UL>

<P>
MySQL uses a naming scheme that is slightly different from most other products.
In general, it's relatively safe to use any version that has been out for
a couple of weeks without being replaced with a new version within the release
series.

</P>
<P>
All releases of MySQL are run through our standard tests and
benchmarks to ensure that they are relatively safe to use.  Because the
standard tests are extended over time to check for all previously found bugs,
the test suite keeps getting better.

</P>
<P>
<A NAME="IDX177"></A>
<A NAME="IDX178"></A>

</P>
<P>
All releases have been tested at least with:

</P>
<DL COMPACT>

<DT>An internal test suite
<DD>
The <TT>`mysql-test'</TT> directory contains an extensive set of test cases.
We run these tests for virtually every server binary.
See section <A HREF="manual.html#MySQL_test_suite">22.1.2  MySQL Test Suite</A> for more information about this test suite.

<DT>The MySQL benchmark suite
<DD>
This suite runs a range of common queries.  It is also a test to see whether the
latest batch of optimizations actually made the code faster.
See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.

<DT>The <CODE>crash-me</CODE> test
<DD>
This test tries to determine what features the database supports and what its
capabilities and limitations are.  See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.
</DL>

<P>
Another test is that we use the newest MySQL version in our internal
production environment, on at least one machine.  We have more than 100GB
of data to work with.

</P>



<H4><A NAME="Choosing_distribution_format" HREF="manual_toc.html#Choosing_distribution_format">2.1.2.2  Choosing a Distribution Format</A></H4>

<P>
After choosing which version of MySQL to install, you should decide
whether to use a binary distribution or a source distribution.  In
most cases, you should probably use a binary distribution, if one
exists for your platform. Binary distributions are available in native format
for many platforms, such as RPM files for Linux or DMG package installers for
Mac OS X. Distributions also are available as Zip archives or compressed
<CODE>tar</CODE> files. 

</P>
<P>
Reasons to choose a binary distribution include the following:

</P>

<UL>
<LI>

Binary distributions generally are easier to install than source distributions.

<LI>

To satisfy different user requirements, we provide two
different binary versions: one compiled with the non-transactional storage
engines (a small, fast binary), and one configured with the most
important extended options like transaction-safe tables.  Both versions
are compiled from the same source distribution.  All native MySQL
clients can connect to servers from either MySQL version.

The extended MySQL binary distribution is marked with the
<CODE>-max</CODE> suffix and is configured with the same options as
<CODE>mysqld-max</CODE>. See section <A HREF="manual.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A>.

If you want to use the <CODE>MySQL-Max</CODE> RPM, you must first
install the standard <CODE>MySQL-server</CODE> RPM.

</UL>

<P>
Under some circumstances, you probably will be better off installing MySQL
from a source distribution:

</P>

<UL>
<LI>

You want to install MySQL at some explicit location.  The standard
binary distributions are ``ready to run'' at any place, but you may want
to have even more flexibility to place MySQL components where you want.

<LI>

You want to configure <CODE>mysqld</CODE> with some extra features that are not
included in the standard binary distributions.  Here is a list of the most
common extra options that you may want to use:


<UL>
<LI><CODE>--with-innodb</CODE> (default for MySQL 4.0 and onwards)

<LI><CODE>--with-berkeley-db</CODE> (not available on all platforms)

<LI><CODE>--with-raid</CODE>

<LI><CODE>--with-libwrap</CODE>

<LI><CODE>--with-named-z-libs</CODE> (this is done for some of the binaries)

<LI><CODE>--with-debug[=full]</CODE>

</UL>

<LI>

You want to configure <CODE>mysqld</CODE> without some features that are
included in the standard binary distributions. For example,
distributions normally are compiled with support for all character
sets. If you want a smaller MySQL server, you can recompile it with support
for only the character sets you need.

<LI>

You have a special compiler (such as <CODE>pgcc</CODE>) or want to use compiler
options that are better optimized for your processor.  Binary distributions
are compiled with options that should work on a variety of processors from
the same processor family.

<LI>

You want to use the latest sources from one of the BitKeeper
repositories to have access to all current bugfixes. For example,
if you have found a bug and reported it to the MySQL development
team, the bugfix will be committed to the source repository and you
can access it there.  The bugfix will not appear in a release until
a release actually is issued.

<LI>

You want to read (or modify) the C and C++ code that makes up MySQL. For
this purpose, you should get a source distribution, because the source code
is always the ultimate manual.

<LI>

Source distributions contain more tests and examples than binary
distributions.

</UL>



<H4><A NAME="Many_versions" HREF="manual_toc.html#Many_versions">2.1.2.3  How and When Updates Are Released</A></H4>

<P>
<A NAME="IDX179"></A>
<A NAME="IDX180"></A>

</P>
<P>
MySQL is evolving quite rapidly here at MySQL AB and we want to share
new developments with other MySQL users.  We try to make a release
when we have very useful features that others seem to have a need for.

</P>
<P>
We also try to help out users who request features that are easy to
implement.  We take note of what our licensed users want to have, and
we especially take note of what our extended email-supported customers
want and try to help them out.

</P>
<P>
No one has to download a new release.  The News section will tell you if
the new release has something you really want.  See section <A HREF="manual.html#News">C  MySQL Change History</A>.

</P>
<P>
We use the following policy when updating MySQL:

</P>

<UL>
<LI>

Releases are issued within each series. For each release, the last
number in the version is one more than the previous release within the same
series.

<LI>

Production (stable) releases are meant to appear about 1-2 times a year.
However, if small bugs are found, a release with only bugfixes will be issued.

<LI>

Working releases/bugfixes to old releases are meant to appear about
every 4-8 weeks.

<LI>

Binary distributions for some platforms are made by us for major releases.
Other people may make binary distributions for other systems, but probably
less frequently.

<LI>

We make fixes available as soon as we have identified and corrected
small or non-critical but annoying bugs. The fixes
are available immediately from our public BitKeeper repositories, and will
be included in the next release.

<LI>

If by any chance a fatal bug is found in a release, we will make a new
release as soon as possible.  (We would like other companies to do this,
too!)
</UL>



<H4><A NAME="Release_philosophy" HREF="manual_toc.html#Release_philosophy">2.1.2.4  Release Philosophy--No Known Bugs in Releases</A></H4>

<P>
We put a lot of time and effort into making our releases bug-free.
To our knowledge, we have not released a single MySQL version with any
<EM>known</EM> ``fatal'' repeatable bugs.
(A ``fatal'' bug is something that crashes MySQL under normal usage,
produces incorrect answers for normal queries, or has a security problem.)

</P>
<P>
We have documented all open problems, bugs, and issues that are
dependent on design decisions.
See section <A HREF="manual.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A>.

</P>
<P>
Our aim is to fix everything that is fixable without risk of
making a stable MySQL version less stable. In certain cases, this
means we can fix an issue in the development versions, but not
in the stable (production) version. Naturally, we document such
issues so that users are aware.

</P>
<P>
Here is a description of how our build process works:

<UL>
<LI>

We monitor bugs from our customer support list, the bugs database at
<a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>, and the MySQL external mailing lists.
<LI>

All reported bugs for live versions are entered into the bugs database.
<LI>

When we fix a bug, we always try to make a test case for it and
include it into our test system to ensure that the bug will never
recur without being detected. (About 90% of all fixed bugs have a test case.)
<LI>

We create test cases for all new features we add to MySQL.
<LI>

Before we start to build a new MySQL release, we ensure that all
reported repeatable bugs for the MySQL version (3.23.x, 4.0.x, etc)
are fixed.  If something is impossible to fix (due to some internal
design decision in MySQL), we document this in the manual.
See section <A HREF="manual.html#Bugs">1.8.7  Known Errors and Design Deficiencies in MySQL</A>.
<LI>

We do a build on all platforms for which we support binaries (15+
platforms) and run our test suite and benchmark suite on all of them.
<LI>

We will not publish a binary for a platform for which the test or benchmark
suite fails.  If the problem is due to a general error in the source, we fix
it and do the build plus tests on all systems again from scratch.
<LI>

The build and test process takes 2-3 days.  If we receive a report regarding
a fatal bug during this process (for example, one that causes
a core dump), we fix the problem and restart the build process.
<LI>

After publishing the binaries on <a HREF="http://dev.mysql.com/">http://dev.mysql.com/</a>, we send
out an announcement message to the <CODE>mysql</CODE> and <CODE>announce</CODE> mailing
lists.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
The announcement message contains a list
of all changes to the release and any known problems with the release.
The Known Problems section in the release notes has been needed
in only a handful of releases.
<LI>

To quickly give our users access to the latest MySQL features, we do
a new MySQL release every 4-8 weeks.
Source code snapshots are built daily and are available at
<a HREF="http://downloads.mysql.com/snapshots.php">http://downloads.mysql.com/snapshots.php</a>.
<LI>

If, after the release is done, we get any bug reports that, despite our best
efforts, there was something critically wrong with the build on a specific
platform, we will fix it at once and build a new <CODE>'a'</CODE> release for that
platform. Thanks to our large user base, problems are found quickly.
<LI>

Our track record for making good releases is quite good.  In the last
150 releases, we had to do a new build for fewer than 10 releases. In three
of these cases, the bug was a faulty <CODE>glibc</CODE> library on one of our build
machines that took us a long time to track down.
</UL>



<H4><A NAME="MySQL_binaries" HREF="manual_toc.html#MySQL_binaries">2.1.2.5  MySQL Binaries Compiled by MySQL AB</A></H4>

<P>
<A NAME="IDX181"></A>

</P>
<P>
As a service of MySQL AB, we provide a set of binary distributions
of MySQL that are compiled on systems at our site or on systems where
supporters of MySQL kindly have given us access to their machines. 

</P>
<P>
In addition to the binaries provided in platform-specific package formats,
we offer binary distributions for a number of platforms in the form of of
compressed <CODE>tar</CODE> files (<CODE>.tar.gz</CODE> files).
See section <A HREF="manual.html#Quick_Standard_Installation">2.2  Standard MySQL Installation Using a Binary Distribution</A>.

</P>
<P>
For Windows distributions, see section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.

</P>
<P>
These distributions are generated using the script
<CODE>Build-tools/Do-compile</CODE>, which compiles the source code and creates
the binary <CODE>tar.gz</CODE> archive using
<CODE>scripts/make_binary_distribution</CODE>.

</P>
<P>
These binaries are configured and built with the following compilers and
options. This information can also be obtained by looking at the variables
<CODE>COMP_ENV_INFO</CODE> and <CODE>CONFIGURE_LINE</CODE> inside the script
<CODE>bin/mysqlbug</CODE> of every binary <CODE>tar</CODE> file distribution.

</P>
<P>
The following binaries are built on MySQL AB development systems:

</P>
<DL COMPACT>

<DT>Linux 2.4.xx x86 with <CODE>gcc</CODE> 2.95.3:
<DD>
<CODE>CFLAGS="-O2 -mcpu=pentiumpro" CXX=gcc CXXFLAGS="-O2 -mcpu=pentiumpro -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --disable-shared --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static</CODE>

<DT>Linux 2.4.xx Intel Itanium 2 with <CODE>ecc</CODE> (Intel C++ Itanium Compiler 7.0):
<DD>
<CODE>CC=ecc CFLAGS="-O2 -tpp2 -ip -nolib_inline" CXX=ecc CXXFLAGS="-O2 -tpp2 -ip -nolib_inline" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile</CODE>

<DT>Linux 2.4.xx Intel Itanium with <CODE>ecc</CODE> (Intel C++ Itanium Compiler 7.0):
<DD>
<CODE>CC=ecc CFLAGS=-tpp1 CXX=ecc CXXFLAGS=-tpp1 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile</CODE>

<DT>Linux 2.4.xx alpha with <CODE>ccc</CODE> (Compaq C V6.2-505 / Compaq C++ V6.3-006):
<DD>
<CODE>CC=ccc CFLAGS="-fast -arch generic" CXX=cxx CXXFLAGS="-fast -arch generic -noexceptions -nortti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-mysqld-ldflags=-non_shared --with-client-ldflags=-non_shared --disable-shared</CODE>

<DT>Linux 2.x.xx ppc with <CODE>gcc</CODE> 2.95.4:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared --with-embedded-server --with-innodb</CODE>

<DT>Linux 2.4.xx s390 with <CODE>gcc</CODE> 2.95.3:
<DD>
<CODE>CFLAGS="-O2" CXX=gcc CXXFLAGS="-O2 -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static</CODE>

<DT>Linux 2.4.xx x86_64 (AMD64) with <CODE>gcc</CODE> 3.2.1:
<DD>
<CODE>CXX=gcc ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</CODE>

<DT>Sun Solaris 8 x86 with <CODE>gcc</CODE> 3.2.3:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared --with-innodb</CODE>

<DT>Sun Solaris 8 SPARC with <CODE>gcc</CODE> 3.2:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=no --with-named-curses-libs=-lcurses --disable-shared</CODE>

<DT>Sun Solaris 8 SPARC 64-bit with <CODE>gcc</CODE> 3.2:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -m64 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -m64 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=no --with-named-curses-libs=-lcurses --disable-shared</CODE>

<DT>Sun Solaris 9 SPARC with <CODE>gcc</CODE> 2.95.3:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-curses-libs=-lcurses --disable-shared</CODE>

<DT>Sun Solaris 9 SPARC with <CODE>cc-5.0</CODE> (Sun Forte 5.0):
<DD>
<CODE>CC=cc-5.0 CXX=CC ASFLAGS="-xarch=v9" CFLAGS="-Xa -xstrconst -mt -D_FORTEC_ -xarch=v9" CXXFLAGS="-noex -mt -D_FORTEC_ -xarch=v9" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=no --enable-thread-safe-client --disable-shared</CODE>

<DT>IBM AIX 4.3.2 ppc with <CODE>gcc</CODE> 3.2.3:
<DD>
<CODE>CFLAGS="-O2 -mcpu=powerpc -Wa,-many " CXX=gcc CXXFLAGS="-O2 -mcpu=powerpc -Wa,-many  -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared</CODE>

<DT>IBM AIX 4.3.3 ppc with <CODE>xlC_r</CODE> (IBM Visual Age C/C++ 6.0):
<DD>
<CODE>CC=xlc_r CFLAGS="-ma -O2 -qstrict -qoptimize=2 -qmaxmem=8192" CXX=xlC_r CXXFLAGS ="-ma -O2 -qstrict -qoptimize=2 -qmaxmem=8192" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared --with-innodb</CODE>

<DT>IBM AIX 5.1.0 ppc with <CODE>gcc</CODE> 3.3:
<DD>
<CODE>CFLAGS="-O2 -mcpu=powerpc -Wa,-many" CXX=gcc CXXFLAGS="-O2 -mcpu=powerpc -Wa,-many  -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared</CODE>

<DT>IBM AIX 5.2.0 ppc with <CODE>xlC_r</CODE> (IBM Visual Age C/C++ 6.0):
<DD>
<CODE>CC=xlc_r CFLAGS="-ma -O2 -qstrict -qoptimize=2 -qmaxmem=8192" CXX=xlC_r CXXFLAGS="-ma -O2 -qstrict -qoptimize=2 -qmaxmem=8192" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared --with-embedded-server --with-innodb</CODE>

<DT>HP-UX 10.20 pa-risc1.1 with <CODE>gcc</CODE> 3.1:
<DD>
<CODE>CFLAGS="-DHPUX -I/opt/dce/include -O3 -fPIC" CXX=gcc CXXFLAGS="-DHPUX -I/opt/dce /include -felide-constructors -fno-exceptions -fno-rtti -O3 -fPIC" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --with-pthread --with-named-thread-libs=-ldce --with-lib-ccflags=-fPIC --disable-shared</CODE>

<DT>HP-UX 11.00 pa-risc with <CODE>aCC</CODE> (HP ANSI C++ B3910B A.03.50):
<DD>
<CODE>CC=cc CXX=aCC CFLAGS=+DAportable CXXFLAGS=+DAportable ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared --with-embedded-server --with-innodb</CODE>

<DT>HP-UX 11.11 pa-risc2.0 64bit with <CODE>aCC</CODE> (HP ANSI C++ B3910B A.03.33):
<DD>
<CODE>CC=cc CXX=aCC CFLAGS=+DD64 CXXFLAGS=+DD64 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared</CODE>

<DT>HP-UX 11.11 pa-risc2.0 32bit with <CODE>aCC</CODE> (HP ANSI C++ B3910B A.03.33):
<DD>
<CODE>CC=cc CXX=aCC CFLAGS="+DAportable" CXXFLAGS="+DAportable" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared --with-innodb</CODE>

<DT>HP-UX 11.22 ia64 64bit with <CODE>aCC</CODE> (HP aC++/ANSI C B3910B A.05.50):
<DD>
<CODE>CC=cc CXX=aCC CFLAGS="+DD64 +DSitanium2" CXXFLAGS="+DD64 +DSitanium2" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared --with-embedded-server --with-innodb</CODE> 

<DT>Apple Mac OS X 10.2 powerpc with <CODE>gcc</CODE> 3.1:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</CODE>

<DT>FreeBSD 4.7 i386 with <CODE>gcc</CODE> 2.95.4:
<DD>
<CODE>CFLAGS=-DHAVE_BROKEN_REALPATH ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=not-used --disable-shared</CODE>

<DT>FreeBSD 4.7 i386 using LinuxThreads with <CODE>gcc</CODE> 2.95.4:
<DD>
<CODE>CFLAGS="-DHAVE_BROKEN_REALPATH -D__USE_UNIX98 -D_REENTRANT -D_THREAD_SAFE -I/usr/local/include/pthread/linuxthreads" CXXFLAGS="-DHAVE_BROKEN_REALPATH -D__USE_UNIX98 -D_REENTRANT -D_THREAD_SAFE -I/usr/local/include/pthread/linuxthreads" ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-thread-libs="-DHAVE_GLIBC2_STYLE_GETHOSTBYNAME_R -D_THREAD_SAFE -I /usr/local/include/pthread/linuxthreads -L/usr/local/lib -llthread -llgcc_r" --disable-shared --with-embedded-server --with-innodb</CODE>

<DT>QNX Neutrino 6.2.1 i386 with <CODE>gcc</CODE> 2.95.3qnx-nto 20010315:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</CODE>

</DL>

<P>
The following binaries are built on third-party systems kindly provided to
MySQL AB by other users. These are provided only as a courtesy; MySQL AB
does not have full control over these systems, so we can provide only
limited support for the binaries built on them.

</P>
<DL COMPACT>

<DT>SCO Unix 3.2v5.0.6 i386 with <CODE>gcc</CODE> 2.95.3:
<DD>
<CODE>CFLAGS="-O3 -mpentium" LDFLAGS=-static CXX=gcc CXXFLAGS="-O3 -mpentium -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --enable-thread-safe-client --disable-shared</CODE>

<DT>SCO OpenUnix 8.0.0 i386 with <CODE>CC</CODE> 3.2:
<DD>
<CODE>CC=cc CFLAGS="-O" CXX=CC ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --enable-thread-safe-client --disable-shared</CODE>

<DT>Compaq Tru64 OSF/1 V5.1 732 alpha with <CODE>cc/cxx</CODE> (Compaq C V6.3-029i / DIGITAL C++ V6.1-027):
<DD>
<CODE>CC="cc -pthread" CFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all" CXX="cxx -pthread" CXXFLAGS="-O4 -ansi_alias -fast -inline speed -speculate all -noexceptions -nortti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-prefix=/usr/local/mysql --with-named-thread-libs="-lpthread -lmach -lexc -lc" --disable-shared --with-mysqld-ldflags=-all-static</CODE>

<DT>SGI Irix 6.5 IP32 with <CODE>gcc</CODE> 3.0.1:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</CODE>

<DT>FreeBSD/sparc64 5.0 with <CODE>gcc</CODE> 3.2.1:
<DD>
<CODE>CFLAGS=-DHAVE_BROKEN_REALPATH ./configure --prefix=/usr/local/mysql --localstatedir=/usr/local/mysql/data --libexecdir=/usr/local/mysql/bin --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared --with-innodb</CODE>
</DL>

<P>
The following compile options have been used for binary packages that MySQL
AB provided in the past. These binaries are no longer being updated, but the
compile options are listed here for reference purposes.

</P>
<DL COMPACT>

<DT>Linux 2.2.xx SPARC with <CODE>egcs</CODE> 1.1.2:
<DD>
<CODE>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --disable-shared</CODE>

<DT>Linux 2.2.x with x686 with <CODE>gcc</CODE> 2.95.2:
<DD>
<CODE>CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --enable-assembler --with-mysqld-ldflags=-all-static --disable-shared --with-extra-charsets=complex</CODE>

<DT>SunOS 4.1.4 2 sun4c with <CODE>gcc</CODE> 2.7.2.1:
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors" ./configure --prefix=/usr/local/mysql --disable-shared --with-extra-charsets=complex --enable-assembler</CODE>

<DT>SunOS 5.5.1 (and above) sun4u with <CODE>egcs</CODE> 1.0.3a or 2.90.27 or <CODE>gcc</CODE> 2.95.2 and newer:
<DD>
<CODE>CC=gcc CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-low-memory --with-extra-charsets=complex --enable-assembler</CODE>

<DT>SunOS 5.6 i86pc with <CODE>gcc</CODE> 2.8.1:
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-low-memory --with-extra-charsets=complex</CODE>

<DT>BSDI BSD/OS 3.1 i386 with <CODE>gcc</CODE> 2.7.2.1:
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</CODE>

<DT>BSDI BSD/OS 2.1 i386 with <CODE>gcc</CODE> 2.7.2:
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</CODE>

<DT>AIX 2 4 with <CODE>gcc</CODE> 2.7.2.2:
<DD>
<CODE>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</CODE>
</DL>

<P>
Anyone who has more optimal options for any of the preceding configurations
listed can always mail them to the MySQL <CODE>internals</CODE> mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>
<P>
RPM distributions prior to MySQL 3.22 are user-contributed.
Beginning with MySQL 3.22, RPM distributions are generated by MySQL AB.

</P>
<P>
If you want to compile a debug version of MySQL, you should add
<CODE>--with-debug</CODE> or <CODE>--with-debug=full</CODE> to the preceding
<CODE>configure</CODE> commands and remove any <CODE>-fomit-frame-pointer</CODE> options.

</P>



<H3><A NAME="Getting_MySQL" HREF="manual_toc.html#Getting_MySQL">2.1.3  How to Get MySQL</A></H3>

<P>
<A NAME="IDX182"></A>
<A NAME="IDX183"></A>
<A NAME="IDX184"></A>
<A NAME="IDX185"></A>
<A NAME="IDX186"></A>
<A NAME="IDX187"></A>

</P>
<P>
Check the MySQL home page (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>) for
information about the current version and for downloading instructions.

</P>
<P>
Our main mirror is located at <a HREF="http://mirrors.sunsite.dk/mysql/">http://mirrors.sunsite.dk/mysql/</a>.

</P>
<P>
For a complete up-to-date list of MySQL download mirror sites, see
<a HREF="http://dev.mysql.com/downloads/mirrors.html">http://dev.mysql.com/downloads/mirrors.html</a>.
There you will also find information about becoming a MySQL mirror
site and how to report a bad or out-of-date mirror.

</P>



<H3><A NAME="Verifying_Package_Integrity" HREF="manual_toc.html#Verifying_Package_Integrity">2.1.4  Verifying Package Integrity Using MD5 Checksums or <CODE>GnuPG</CODE></A></H3>

<P>
After you have downloaded the MySQL package that suits your needs and before
you attempt to install it, you should make sure that it is intact and has not
been tampered with. MySQL AB offers three means of integrity checking:

</P>

<UL>

<LI>

MD5 checksums

<LI>

Cryptographic signatures using <CODE>GnuPG</CODE>, the GNU Privacy Guard

<LI>

For RPM packages, the built-in RPM integrity verification mechanism

</UL>

<P>
The following sections describe how to use these methods.

</P>
<P>
If you notice that the MD5 checksum or GPG signatures
do not match, first try to download the respective package one more time,
perhaps from another mirror site. If you repeatedly cannot successfully
verify the integrity of the package, please notify us about such incidents,
including the full package name and the download site you have been using,
at <a HREF="mailto:webmaster@mysql.com">webmaster@mysql.com</a> or <a HREF="mailto:build@mysql.com">build@mysql.com</a>.
Do not report downloading problems using the bug-reporting system.

</P>



<H4><A NAME="Verifying_MD5_Checksum" HREF="manual_toc.html#Verifying_MD5_Checksum">2.1.4.1  Verifying the <CODE>MD5</CODE> Checksum</A></H4>

<P>
After you have downloaded a MySQL package, you should make sure that its MD5
checksum matches the one provided on the MySQL download pages. Each package
has an individual checksum that you can verify with the following command,
where <CODE>package_name</CODE> is the name of the package you downloaded:

</P>

<PRE>
shell&#62; md5sum package_name
</PRE>

<P>
Example:

<PRE>
shell&#62; md5sum mysql-standard-4.0.17-pc-linux-i686.tar.gz
60f5fe969d61c8f82e4f7f62657e1f06
                mysql-standard-4.0.17-pc-linux-i686.tar.gz
</PRE>

<P>
You should verify that the resulting checksum (the string of hexadecimal
digits) matches the one displayed on
the download page immediately below the respective package.

</P>
<P>
Note that not all operating systems support the <CODE>md5sum</CODE> command. On
some, it is simply called <CODE>md5</CODE> and others do not ship it at all. On
Linux, it is part of the <CODE>GNU Text Utilities</CODE> package, which is
available for a wide range of platforms. You can download the source code
from <a HREF="http://www.gnu.org/software/textutils/">http://www.gnu.org/software/textutils/</a> as well. If you have
<CODE>OpenSSL</CODE> installed, you can also use the command <CODE>openssl md5
package_name</CODE> instead. A DOS/Windows implementation of the <CODE>md5</CODE>
command is available from <a HREF="http://www.fourmilab.ch/md5/">http://www.fourmilab.ch/md5/</a>.

</P>



<H4><A NAME="Checking_GPG_Signature" HREF="manual_toc.html#Checking_GPG_Signature">2.1.4.2  Signature Checking Using <CODE>GnuPG</CODE></A></H4>

<P>
Another method of verifying the integrity and authenticity of a package
is to use cryptographic signatures. This is more reliable than using MD5
checksums, but requires more work.

</P>
<P>
Beginning with MySQL 4.0.10 (February 2003), MySQL AB started signing
downloadable packages with <CODE>GnuPG</CODE> (<CODE>GNU Privacy Guard</CODE>).
<CODE>GnuPG</CODE> is an Open Source alternative to the very well-known
<CODE>Pretty Good Privacy</CODE> (<CODE>PGP</CODE>) by Phil Zimmermann.
See <a HREF="http://www.gnupg.org/">http://www.gnupg.org/</a> for more information about <CODE>GnuPG</CODE>
and how to obtain and install it on your system. Most Linux distributions
already ship with <CODE>GnuPG</CODE> installed by default.  For more information
about <CODE>OpenPGP</CODE>, see <a HREF="http://www.openpgp.org/">http://www.openpgp.org/</a>.

</P>

<P>
To verify the signature for a specific package, you first need to obtain a
copy of MySQL AB's public GPG build key. You can download the key from
<a HREF="http://www.keyserver.net/">http://www.keyserver.net/</a>.  The key that you want to obtain is named
<CODE>build@mysql.com</CODE>.  Alternatively, you can cut and paste the key
directly from the following text:

</P>

<PRE>
Key ID:
pub  1024D/5072E1F5 2003-02-03
     MySQL Package signing key (www.mysql.com) &#60;build@mysql.com&#62;
Fingerprint: A4A9 4068 76FC BD3C 4567  70C8 8C71 8D3B 5072 E1F5

Public Key (ASCII-armored):

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.0.6 (GNU/Linux)
Comment: For info see http://www.gnupg.org

mQGiBD4+owwRBAC14GIfUfCyEDSIePvEW3SAFUdJBtoQHH/nJKZyQT7h9bPlUWC3
RODjQReyCITRrdwyrKUGku2FmeVGwn2u2WmDMNABLnpprWPkBdCk96+OmSLN9brZ
fw2vOUgCmYv2hW0hyDHuvYlQA/BThQoADgj8AW6/0Lo7V1W9/8VuHP0gQwCgvzV3
BqOxRznNCRCRxAuAuVztHRcEAJooQK1+iSiunZMYD1WufeXfshc57S/+yeJkegNW
hxwR9pRWVArNYJdDRT+rf2RUe3vpquKNQU/hnEIUHJRQqYHo8gTxvxXNQc7fJYLV
K2HtkrPbP72vwsEKMYhhr0eKCbtLGfls9krjJ6sBgACyP/Vb7hiPwxh6rDZ7ITnE
kYpXBACmWpP8NJTkamEnPCia2ZoOHODANwpUkP43I7jsDmgtobZX9qnrAXw+uNDI
QJEXM6FSbi0LLtZciNlYsafwAPEOMDKpMqAK6IyisNtPvaLd8lH0bPAnWqcyefep
rv0sxxqUEMcM3o7wwgfN83POkDasDbs3pjwPhxvhz6//62zQJ7Q7TXlTUUwgUGFj
a2FnZSBzaWduaW5nIGtleSAod3d3Lm15c3FsLmNvbSkgPGJ1aWxkQG15c3FsLmNv
bT6IXQQTEQIAHQUCPj6jDAUJCWYBgAULBwoDBAMVAwIDFgIBAheAAAoJEIxxjTtQ
cuH1cY4AnilUwTXn8MatQOiG0a/bPxrvK/gCAJ4oinSNZRYTnblChwFaazt7PF3q
zIhMBBMRAgAMBQI+PqPRBYMJZgC7AAoJEElQ4SqycpHyJOEAn1mxHijft00bKXvu
cSo/pECUmppiAJ41M9MRVj5VcdH/KN/KjRtW6tHFPYhMBBMRAgAMBQI+QoIDBYMJ
YiKJAAoJELb1zU3GuiQ/lpEAoIhpp6BozKI8p6eaabzF5MlJH58pAKCu/ROofK8J
Eg2aLos+5zEYrB/LsrkCDQQ+PqMdEAgA7+GJfxbMdY4wslPnjH9rF4N2qfWsEN/l
xaZoJYc3a6M02WCnHl6ahT2/tBK2w1QI4YFteR47gCvtgb6O1JHffOo2HfLmRDRi
Rjd1DTCHqeyX7CHhcghj/dNRlW2Z0l5QFEcmV9U0Vhp3aFfWC4Ujfs3LU+hkAWzE
7zaD5cH9J7yv/6xuZVw411x0h4UqsTcWMu0iM1BzELqX1DY7LwoPEb/O9Rkbf4fm
Le11EzIaCa4PqARXQZc4dhSinMt6K3X4BrRsKTfozBu74F47D8Ilbf5vSYHbuE5p
/1oIDznkg/p8kW+3FxuWrycciqFTcNz215yyX39LXFnlLzKUb/F5GwADBQf+Lwqq
a8CGrRfsOAJxim63CHfty5mUc5rUSnTslGYEIOCR1BeQauyPZbPDsDD9MZ1ZaSaf
anFvwFG6Llx9xkU7tzq+vKLoWkm4u5xf3vn55VjnSd1aQ9eQnUcXiL4cnBGoTbOW
I39EcyzgslzBdC++MPjcQTcA7p6JUVsP6oAB3FQWg54tuUo0Ec8bsM8b3Ev42Lmu
QT5NdKHGwHsXTPtl0klk4bQk4OajHsiy1BMahpT27jWjJlMiJc+IWJ0mghkKHt92
6s/ymfdf5HkdQ1cyvsz5tryVI3Fx78XeSYfQvuuwqp2H139pXGEkg0n6KdUOetdZ
Whe70YGNPw1yjWJT1IhMBBgRAgAMBQI+PqMdBQkJZgGAAAoJEIxxjTtQcuH17p4A
n3r1QpVC9yhnW2cSAjq+kr72GX0eAJ4295kl6NxYEuFApmr1+0uUq/SlsQ==
=YJkx
-----END PGP PUBLIC KEY BLOCK-----
</PRE>

<P>
You can import the build key into your personal public GPG keyring by using
<CODE>gpg --import</CODE>. For example, if you save the key in a file named
<TT>`mysql_pubkey.asc'</TT>, the import command looks like this:

</P>

<PRE>
shell&#62; gpg --import mysql_pubkey.asc
</PRE>

<P>
See the GPG documentation for more info on how to work with public keys.

</P>
<P>
After you have downloaded and imported the public build key,
download your desired MySQL package and the corresponding
signature, which also is available from the download page.
The signature file has the same name as the distribution file with an
<TT>`.asc'</TT> extension. For example:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD>Distribution file </TD><TD> <CODE>mysql-standard-4.0.17-pc-linux-i686.tar.gz</CODE>
</TD></TR>
<TR><TD>Signature file </TD><TD> <CODE>mysql-standard-4.0.17-pc-linux-i686.tar.gz.asc</CODE>
</TD></TR>
</TABLE>

<P>
Make sure that both files are stored in the same directory and then run
the following command to verify the signature for the distribution file:

</P>

<PRE>
shell&#62; gpg --verify package_name.asc
</PRE>

<P>
Example:

</P>

<PRE>
shell&#62; gpg --verify mysql-standard-4.0.17-pc-linux-i686.tar.gz.asc
gpg: Warning: using insecure memory!
gpg: Signature made Mon 03 Feb 2003 08:50:39 PM MET
using DSA key ID 5072E1F5
gpg: Good signature from
     "MySQL Package signing key (www.mysql.com) &#60;build@mysql.com&#62;"
</PRE>

<P>
The ``Good signature'' message indicates that everything is all right.
You can ignore the <CODE>insecure memory</CODE> warning.

</P>


<H4><A NAME="Checking_RPM_Signature" HREF="manual_toc.html#Checking_RPM_Signature">2.1.4.3  Signature Checking Using <CODE>RPM</CODE></A></H4>

<P>
For RPM packages, there is no separate signature. RPM packages have a
built-in GPG signature and MD5 checksum. You can verify a package by running
the following command:

</P>

<PRE>
shell&#62; rpm --checksig package_name.rpm
</PRE>

<P>
Example:

</P>

<PRE>
shell&#62; rpm --checksig MySQL-server-4.0.10-0.i386.rpm
MySQL-server-4.0.10-0.i386.rpm: md5 gpg OK
</PRE>

<P>
<STRONG>Note:</STRONG> If you are using RPM 4.1 and it complains about <CODE>(GPG)
NOT OK (MISSING KEYS: GPG#5072e1f5)</CODE>, even though you have imported the
MySQL public build key into your own GPG keyring, you need to import the
key into the RPM keyring first. RPM 4.1 no longer uses your personal GPG
keyring (or GPG itself). Rather, it maintains its own keyring because it is
a system-wide application and a user's GPG public keyring is a user-specific
file. To import the MySQL public key into the RPM keyring, first obtain the
key as described in the previous section. Then use use <CODE>rpm --import</CODE>
to import the key.  For example, if you have the public key stored in a file
named <TT>`mysql_pubkey.asc'</TT>, import it using this command:

</P>

<PRE>
shell&#62; rpm --import mysql_pubkey.asc
</PRE>



<H3><A NAME="Installation_layouts" HREF="manual_toc.html#Installation_layouts">2.1.5  Installation Layouts</A></H3>

<P>
<A NAME="IDX188"></A>
<A NAME="IDX189"></A>
<A NAME="IDX190"></A>
<A NAME="IDX191"></A>

</P>
<P>
This section describes the default layout of the directories created by
installing binary or source distributions provided by MySQL AB. If you
install a distribution provided by another vendor, some other layout might
be used.

</P>
<P>
On Windows, the default installation directory is <TT>`C:\mysql'</TT>, which has
the following subdirectories:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of Directory</STRONG>
</TD></TR>
<TR><TD><TT>`bin'</TT> </TD><TD> Client programs and the <CODE>mysqld</CODE> server
</TD></TR>
<TR><TD><TT>`data'</TT> </TD><TD> Log files, databases
</TD></TR>
<TR><TD><TT>`Docs'</TT> </TD><TD> Documentation
</TD></TR>
<TR><TD><TT>`examples'</TT> </TD><TD> Example programs and scripts
</TD></TR>
<TR><TD><TT>`include'</TT> </TD><TD> Include (header) files
</TD></TR>
<TR><TD><TT>`lib'</TT> </TD><TD> Libraries
</TD></TR>
<TR><TD><TT>`scripts'</TT> </TD><TD> Utility scripts
</TD></TR>
<TR><TD><TT>`share'</TT> </TD><TD> Error message files
</TD></TR>
</TABLE>

<P>
Installations created from Linux RPM distributions result in files under
the following system directories:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of Directory</STRONG>
</TD></TR>
<TR><TD><TT>`/usr/bin'</TT> </TD><TD> Client programs and scripts
</TD></TR>
<TR><TD><TT>`/usr/sbin'</TT> </TD><TD> The <CODE>mysqld</CODE> server
</TD></TR>
<TR><TD><TT>`/var/lib/mysql'</TT> </TD><TD> Log files, databases
</TD></TR>
<TR><TD><TT>`/usr/share/doc/packages'</TT> </TD><TD> Documentation
</TD></TR>
<TR><TD><TT>`include'</TT> </TD><TD> Include (header) files
</TD></TR>
<TR><TD><TT>`lib'</TT> </TD><TD> Libraries
</TD></TR>
<TR><TD><TT>`/usr/share/mysql'</TT> </TD><TD> Error message and character set files
</TD></TR>
<TR><TD><TT>`sql-bench'</TT> </TD><TD> Benchmarks
</TD></TR>
</TABLE>

<P>
On Unix, a <CODE>tar</CODE> file
binary distribution is installed by unpacking it at the installation
location you choose (typically <TT>`/usr/local/mysql'</TT>) and creates the
following directories in that location:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of Directory</STRONG>
</TD></TR>
<TR><TD><TT>`bin'</TT> </TD><TD> Client programs and the <CODE>mysqld</CODE> server
</TD></TR>
<TR><TD><TT>`data'</TT> </TD><TD> Log files, databases
</TD></TR>
<TR><TD><TT>`docs'</TT> </TD><TD> Documentation, ChangeLog
</TD></TR>
<TR><TD><TT>`include'</TT> </TD><TD> Include (header) files
</TD></TR>
<TR><TD><TT>`lib'</TT> </TD><TD> Libraries
</TD></TR>
<TR><TD><TT>`scripts'</TT> </TD><TD> <CODE>mysql_install_db</CODE>
</TD></TR>
<TR><TD><TT>`share/mysql'</TT> </TD><TD> Error message files
</TD></TR>
<TR><TD><TT>`sql-bench'</TT> </TD><TD> Benchmarks
</TD></TR>
</TABLE>

<P>
A source distribution is installed after you configure and compile it.  By
default, the installation step installs files under <TT>`/usr/local'</TT>, in the
following subdirectories:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Directory</STRONG> </TD><TD> <STRONG>Contents of Directory</STRONG>
</TD></TR>
<TR><TD><TT>`bin'</TT> </TD><TD> Client programs and scripts
</TD></TR>
<TR><TD><TT>`include/mysql'</TT> </TD><TD> Include (header) files
</TD></TR>
<TR><TD><TT>`info'</TT> </TD><TD> Documentation in Info format
</TD></TR>
<TR><TD><TT>`lib/mysql'</TT> </TD><TD> Libraries
</TD></TR>
<TR><TD><TT>`libexec'</TT> </TD><TD> The <CODE>mysqld</CODE> server
</TD></TR>
<TR><TD><TT>`share/mysql'</TT> </TD><TD> Error message files
</TD></TR>
<TR><TD><TT>`sql-bench'</TT> </TD><TD> Benchmarks and <CODE>crash-me</CODE> test
</TD></TR>
<TR><TD><TT>`var'</TT> </TD><TD> Databases and log files
</TD></TR>
</TABLE>

<P>
Within an installation directory, the layout of a source installation differs
from that of a binary installation in the following ways:

</P>

<UL>
<LI>

The <CODE>mysqld</CODE> server is installed in the <TT>`libexec'</TT>
directory rather than in the <TT>`bin'</TT> directory.

<LI>

The data directory is <TT>`var'</TT> rather than <TT>`data'</TT>.

<LI>

<CODE>mysql_install_db</CODE> is installed in the <TT>`bin'</TT> directory
rather than in the <TT>`scripts'</TT> directory.

<LI>

The header file and library directories are <TT>`include/mysql'</TT> and
<TT>`lib/mysql'</TT> rather than <TT>`include'</TT> and <TT>`lib'</TT>.
</UL>

<P>
You can create your own binary installation from a compiled source
distribution by executing the <TT>`scripts/make_binary_distribution'</TT> script
from the top directory of the source distribution.

</P>


<H2><A NAME="Quick_Standard_Installation" HREF="manual_toc.html#Quick_Standard_Installation">2.2  Standard MySQL Installation Using a Binary Distribution</A></H2>

<P>
This section covers the installation of MySQL on platforms where we
offer packages using the native packaging format of the respective
platform. (This is also known as performing a ``binary install.'')
However, binary distributions of MySQL are available for many
other platforms as well. See section <A HREF="manual.html#Installing_binary">2.2.5  Installing MySQL on Other Unix-Like Systems</A> for generic
installation instructions for these packages that apply to all platforms.

</P>
<P>
See section <A HREF="manual.html#General_Installation_Issues">2.1  General Installation Issues</A> for more information on what other binary
distributions are available and how to obtain them.

</P>



<H3><A NAME="Windows_installation" HREF="manual_toc.html#Windows_installation">2.2.1  Installing MySQL on Windows</A></H3>

<P>
The installation process for MySQL on Windows has the following steps:

</P>

<OL>
<LI>

Obtain and install the distribution.

<LI>

Set up an option file if necessary.

<LI>

Select the server you want to use.

<LI>

Start the server.

<LI>

Assign passwords to the initial MySQL accounts.

</OL>

<P>
MySQL for Windows is available in two distribution formats:

</P>

<UL>

<LI>

The binary distribution contains a setup program that installs
everything you need so that you can start the server immediately.

<LI>

The source distribution contains all the code and support files
for building the executables using the VC++ 6.0 compiler.

</UL>

<P>
Generally speaking, you should use the binary distribution. It's simpler, and
you need no additional tools to get MySQL up and running.

</P>
<P>
This section describes how to install MySQL on Windows using a binary
distribution.  To install using a source distribution, see
section <A HREF="manual.html#Windows_source_build">2.3.6  Installing MySQL from Source on Windows</A>.

</P>



<H4><A NAME="Windows_system_requirements" HREF="manual_toc.html#Windows_system_requirements">2.2.1.1  Windows System Requirements</A></H4>

<P>
To run MySQL on Windows, you need the following:

</P>

<UL>

<LI>

A 32-bit Windows operating system such as 9x, Me, NT, 2000, or XP.
The NT family (Windows NT, 2000, and XP) permits you to run the MySQL server
as a service. See section <A HREF="manual.html#NT_start">2.2.1.7  Starting MySQL as a Windows Service</A>.

<LI>

TCP/IP protocol support.

<LI>

A copy of the MySQL binary distribution for Windows, which
can be downloaded from <a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.
See section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

Note: If you download the distribution via FTP, we recommend the use of an
adequate FTP client with a resume feature to avoid corruption of files
during the download process.

<LI>

<CODE>WinZip</CODE> or other Windows tool that can read <TT>`.zip'</TT> files,
to unpack the distribution file.

<LI>

Enough space on the hard drive to unpack, install, and create the
databases in accordance with your requirements.

<LI>

If you plan to connect to the MySQL server via ODBC, you
also need the <CODE>MyODBC</CODE> driver. See section <A HREF="manual.html#ODBC">20.3  MySQL ODBC Support</A>.

<LI>

If you need tables with a size larger than 4GB, install MySQL
on an NTFS or newer filesystem. Don't forget to use <CODE>MAX_ROWS</CODE> and
<CODE>AVG_ROW_LENGTH</CODE> when you create tables.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</UL>



<H4><A NAME="Windows_binary_installation" HREF="manual_toc.html#Windows_binary_installation">2.2.1.2  Installing a Windows Binary Distribution</A></H4>

<P>
To install MySQL on Windows using a binary distribution, follow this
procedure:

</P>

<OL>

<LI>

If you are working on a Windows NT, 2000, or XP machine, make sure that you have
logged in as a user with administrator privileges.

<LI>

If you are doing an upgrade of an earlier MySQL installation,
it is necessary to stop the current server.
On Windows NT, 2000, or XP machines, if you are running the server
as a Windows service, stop it as follows from the command prompt:


<PRE>
C:\&#62; NET STOP MySQL
</PRE>

If you plan to use a different server after the upgrade (for example,
if you want to run <CODE>mysqld-max</CODE> rather than <CODE>mysqld</CODE>),
remove the existing service:


<PRE>
C:\&#62; C:\mysql\bin\mysqld --remove
</PRE>

You can reinstall the service to use the proper server after upgrading.

If you are not running the MySQL server as a service, stop it like this:


<PRE>
C:\&#62; C:\mysql\bin\mysqladmin -u root shutdown
</PRE>

<LI>

Exit the <CODE>WinMySQLAdmin</CODE> program if it is running.

<LI>

Unzip the distribution file to a temporary directory.

<LI>

Run the <CODE>setup.exe</CODE> program to begin the installation process.
If you want to install MySQL into a location other than the default directory
(<TT>`C:\mysql'</TT>), use the <CODE>Browse</CODE> button to specify your
preferred directory. If you do not install MySQL into the default location,
you will need to specify the location whenever you start the server. The
easiest way to do this is to use an option file, as described in
section <A HREF="manual.html#Windows_prepare_environment">2.2.1.3  Preparing the Windows MySQL Environment</A>.

<LI>

Finish the install process.

</OL>

<P>
<STRONG>Important note:</STRONG>
Early alpha Windows distributions for MySQL 4.1 do not contain an
installer program.  A 4.1 distribution is a ZIP file that you just
unzip in the location where you want to install MySQL. For example,
to install <TT>`mysql-4.1.1-alpha-win.zip'</TT> as <TT>`C:\mysql'</TT>, unzip
the distribution file on the <CODE>C:</CODE> drive, then rename the resulting
<TT>`mysql-4.1.1-alpha'</TT> directory to <TT>`mysql'</TT>.

</P>
<P>
If you are upgrading to MySQL 4.1 from an earlier version, you will want to
preserve your existing <TT>`data'</TT> directory that contains the grant tables
in the <CODE>mysql</CODE> database and your own databases.  Before installing 4.1,
stop the server if it is running, and save your <TT>`data'</TT> directory to
another location. Then either rename the existing <TT>`C:\mysql'</TT> directory
or remove it.  Install 4.1 as described in the preceding paragraph, and then
replace its <TT>`data'</TT> directory with your old <TT>`data'</TT> directory.
Start the new server and update the grant tables.  This will avoid the loss of
your current databases.
See section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</P>



<H4><A NAME="Windows_prepare_environment" HREF="manual_toc.html#Windows_prepare_environment">2.2.1.3  Preparing the Windows MySQL Environment</A></H4>

<P>
If you need to specify startup options when you run the server,
you can indicate them on the command line or place them in an option
file. For options that will be used every time the server starts,
you will find it most convenient to use an option file to specify
your MySQL configuration. This is true particularly under the
following circumstances:

</P>

<UL>

<LI>

The installation or data directory locations are different from the default
locations (<TT>`C:\mysql'</TT> and <TT>`C:\mysql\data'</TT>).

<LI>

You need to tune the server settings.
For example, to use the <CODE>InnoDB</CODE> transactional tables in
MySQL version 3.23, you must manually add some extra lines to the option
file, as described in section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.
(As of MySQL 4.0, <CODE>InnoDB</CODE> creates its data files and log files in the data
directory by default. This means you need not configure <CODE>InnoDB</CODE> explicitly.
You may still do so if you wish, and an option file will be useful in this
case, too.)

</UL>

<P>
On Windows, the MySQL installer places the data directory directly under
the directory where you install MySQL.  If you would like to use a data
directory in a different location, you should copy the entire contents
of the <TT>`data'</TT> directory to the new location. For example, by default, the
installer
places MySQL in <TT>`C:\mysql'</TT> and the data directory in
<TT>`C:\mysql\data'</TT>. If you want to use a data directory of <TT>`E:\mydata'</TT>,
you must do two things:

</P>

<UL>
<LI>

Move the data directory from <TT>`C:\mysql\data'</TT> to <TT>`E:\mydata'</TT>.

<LI>

Use a <CODE>--datadir</CODE> option to specify the new data directory location
each time you start the server.

</UL>

<P>
When the MySQL server starts on Windows, it looks for options in
two files:  the <TT>`my.ini'</TT> file in the Windows directory, and
the <TT>`C:\my.cnf'</TT> file.  The Windows directory typically is
named something like <TT>`C:\WINDOWS'</TT> or <TT>`C:\WinNT'</TT>.  You
can determine its exact location from the value of the <CODE>WINDIR</CODE>
environment variable using the following command:

</P>

<PRE>
C:\&#62; echo %WINDIR%
</PRE>

<P>
MySQL looks for options first in the <TT>`my.ini'</TT> file, then in
the <TT>`my.cnf'</TT> file.  However, to avoid confusion, it's best if
you use only one file.  If your PC uses a boot loader where the
<CODE>C:</CODE> drive isn't the boot drive, your only option is to use
the <TT>`my.ini'</TT> file.  Whichever one you use, it must be a plain
text file.

</P>
<P>
An option file can be created and modified with any text editor,
such as the <CODE>Notepad</CODE> program.  For example, if MySQL is
installed at <TT>`D:\mysql'</TT> and the data directory is located at
<TT>`D:\mydata\data'</TT>, you can create the option file and set up
a <CODE>[mysqld]</CODE> section to specify values for the <CODE>basedir</CODE>
and <CODE>datadir</CODE> parameters:

</P>

<PRE>
[mysqld]
# set basedir to your installation path
basedir=D:/mysql
# set datadir to the location of your data directory
datadir=D:/mydata/data
</PRE>

<P>
Note that Windows pathnames are specified in option files using
forward slashes rather than backslashes.  If you do use backslashes,
you must double them.

</P>
<P>
Another way to manage an option file is to use the <CODE>WinMySQLAdmin</CODE>
tool. You can find <CODE>WinMySQLAdmin</CODE> in the <TT>`bin'</TT> directory
of your MySQL installation, as well as a help file containing
instructions for using it. <CODE>WinMySQLAdmin</CODE> has the capability
of editing your option file, but note these points:

</P>

<UL>
<LI>

<CODE>WinMySQLAdmin</CODE> uses only the <TT>`my.ini'</TT> file.

<LI>

If <CODE>WinMySQLAdmin</CODE> finds a <TT>`C:\my.cnf'</TT> file, it will in fact rename
it to <TT>`C:\my_cnf.bak'</TT> to disable it.

</UL>

<P>
Now you are ready to start the server.

</P>



<H4><A NAME="Windows_select_server" HREF="manual_toc.html#Windows_select_server">2.2.1.4  Selecting a Windows Server</A></H4>

<P>
Starting with MySQL 3.23.38, the Windows distribution includes
both the normal and the MySQL-Max server binaries.
Here is a list of the different MySQL servers from which you can choose:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Binary</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>mysqld</CODE> </TD><TD> Compiled with full debugging and automatic memory allocation checking, symbolic links, and <CODE>InnoDB</CODE> and <CODE>BDB</CODE> tables.
</TD></TR>
<TR><TD><CODE>mysqld-opt</CODE> </TD><TD> Optimized binary.  From version 4.0 on, <CODE>InnoDB</CODE> is enabled.  Before 4.0, this server includes no transactional table support.
</TD></TR>
<TR><TD><CODE>mysqld-nt</CODE> </TD><TD> Optimized binary for Windows NT, 2000, and XP with support for named pipes.
</TD></TR>
<TR><TD><CODE>mysqld-max</CODE> </TD><TD> Optimized binary with support for symbolic links, and <CODE>InnoDB</CODE> and <CODE>BDB</CODE> tables.
</TD></TR>
<TR><TD><CODE>mysqld-max-nt</CODE> </TD><TD> Like <CODE>mysqld-max</CODE>, but compiled with support for named pipes.
</TD></TR>
</TABLE>

<P>
All of the preceding binaries are optimized for modern Intel processors,
but should work on any Intel i386-class or higher processor.

</P>
<P>
<A NAME="IDX192"></A>
<A NAME="IDX193"></A>

</P>
<P>
MySQL supports TCP/IP on all Windows platforms. The <CODE>mysqld-nt</CODE>
and <CODE>mysql-max-nt</CODE> servers support named pipes on NT, 2000, and XP.
However, the default is to use TCP/IP regardless of the platform.
(Named pipes are slower than TCP/IP in many Windows configurations.)
Named pipe use is subject to these conditions:

</P>

<UL>
<LI>

Starting from MySQL 3.23.50, named pipes are enabled only
if you start the server with the <CODE>--enable-named-pipe</CODE> option.
It is now necessary to use this option explicitly because some users have
experienced problems shutting down the MySQL server when named pipes
were used.

<LI>

Named pipe connections are allowed only by the
<CODE>mysqld-nt</CODE> or <CODE>mysqld-max-nt</CODE> servers, and only if the server is
run on a version of Windows that supports named pipes (NT, 2000, XP).

<LI>

These servers can be run on Windows 98 or Me, but only if TCP/IP is installed;
named pipe connections cannot be used.

<LI>

On Windows 95, these servers cannot be used.

</UL>

<P>
<STRONG>Note:</STRONG>
Most of the examples in the following sections use <CODE>mysqld</CODE> as the
server name. If you choose to use a different server, such as
<CODE>mysqld-opt</CODE>, make the appropriate substitutions in the commands that
are shown in the examples. One good reason to choose a different server is
that because <CODE>mysqld</CODE> contains full debugging support, it uses more
memory and runs slower than the other Windows servers.

</P>


<H4><A NAME="Windows_server_first_start" HREF="manual_toc.html#Windows_server_first_start">2.2.1.5  Starting the Server for the First Time</A></H4>

<P>
On Windows 95, 98, or Me, MySQL clients always connect to the server using
TCP/IP.  (This will allow any machine on your network to connect to your MySQL
server.)  Because of this, you must make sure that TCP/IP support is installed
on your machine before starting MySQL.  You can find TCP/IP on your
Windows CD-ROM.

</P>
<P>
Note that if you are using an old Windows 95 release (for example,
OSR2), it's likely that you have an old Winsock package;
MySQL requires Winsock 2! You can get the newest Winsock from
<a HREF="http://www.microsoft.com/">http://www.microsoft.com/</a>.  Windows 98 has the new Winsock 2
library, so it is unnecessary to update the library.

</P>
<P>
On NT-based systems such as Windows NT, 2000, or XP, clients have two
options. They can use TCP/IP, or they can use a named pipe if the server
supports named pipe connections.

</P>

<P>
For information about which server binary to run, see
section <A HREF="manual.html#Windows_select_server">2.2.1.4  Selecting a Windows Server</A>.

</P>
<P>
This section gives a general overview of starting the MySQL server.
The following sections provide more specific information for particular
versions of Windows.

</P>
<P>
The examples in these sections assume that MySQL is installed under the default
location of <TT>`C:\mysql'</TT>. Adjust the pathnames shown in the examples if you
have MySQL installed in a different location.

</P>
<P>
Testing is best done from a command prompt in a console window (a ``DOS
window''). This way you can have the server display status messages in the
window where they are easy to see.  If something is wrong with your
configuration, these messages will make it easier for you to identify
and fix any problems.

</P>
<P>
To start the server, enter this command:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --console
</PRE>

<P>
For servers that include <CODE>InnoDB</CODE> support,
you should see the following messages as the server starts:

</P>

<PRE>
InnoDB: The first specified datafile c:\ibdata\ibdata1 did not exist:
InnoDB: a new database to be created!
InnoDB: Setting file c:\ibdata\ibdata1 size to 209715200
InnoDB: Database physically writes the file full: wait...
InnoDB: Log file c:\iblogs\ib_logfile0 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile0 size to 31457280
InnoDB: Log file c:\iblogs\ib_logfile1 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile1 size to 31457280
InnoDB: Log file c:\iblogs\ib_logfile2 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile2 size to 31457280
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: creating foreign key constraint system tables
InnoDB: foreign key constraint system tables created
011024 10:58:25  InnoDB: Started
</PRE>

<P>
When the server finishes its startup sequence, you should see something
like this, which indicates that the server is ready to service client
connections:

</P>

<PRE>
mysqld: ready for connections
Version: '4.0.14-log'  socket: ''  port: 3306
</PRE>

<P>
The server will continue to write to the console any further diagnostic
output it produces.  You can open a new console window in which to run
client programs.

</P>
<P>
If you omit the <CODE>--console</CODE> option, the server writes diagnostic output
to the error log in the data directory (<TT>`C:\mysql\data'</TT> by default).
The error log is the file with the <TT>`.err'</TT> extension.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H4><A NAME="Win95_start" HREF="manual_toc.html#Win95_start">2.2.1.6  Starting MySQL from the Windows Command Line</A></H4>

<P>
The MySQL server can be started manually from the command line.
This can be done on any version of Windows.

</P>
<P>
To start the <CODE>mysqld</CODE> server from the command line, you should
start a console window (a ``DOS window'') and enter this command:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld
</PRE>

<P>
On non-NT versions of Windows, this will start <CODE>mysqld</CODE> in the
background. That is, after the server starts, you should see another
command prompt. If you start the server this way on Windows NT, 2000, or XP,
the server will run in the foreground and no command prompt will appear
until the server exits.  Because of this, you should open another console
window to run client programs while the server is running.

</P>
<P>
You can stop the MySQL server by executing this command:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqladmin -u root shutdown
</PRE>

<P>
This invokes the MySQL administrative utility <CODE>mysqladmin</CODE> to
connect to the server and tell it to shut down. The command connects
as <CODE>root</CODE>, which is the default administrative account in the
MySQL grant system. Note that users in the MySQL grant system
are wholly independent from any login users under Windows.

</P>
<P>
If <CODE>mysqld</CODE> doesn't start, check the error log to see whether the
server wrote any messages there to indicate the cause of the problem.
The error log is located in the <TT>`C:\mysql\data'</TT> directory. It is
the file with a suffix of <TT>`.err'</TT>. You can also try to start the
server as <CODE>mysqld --console</CODE>; in this case, you may get some useful
information on the screen that may help solve the problem.

</P>
<P>
The last option is to start <CODE>mysqld</CODE> with
<CODE>--standalone --debug</CODE>.
In this case, <CODE>mysqld</CODE> will write a log file
<TT>`C:\mysqld.trace'</TT> that should contain the reason why
<CODE>mysqld</CODE> doesn't start. See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

</P>
<P>
Use <CODE>mysqld --help</CODE> to display all the options that
<CODE>mysqld</CODE> understands!

</P>



<H4><A NAME="NT_start" HREF="manual_toc.html#NT_start">2.2.1.7  Starting MySQL as a Windows Service</A></H4>

<P>
On the NT family (Windows NT, 2000, or XP), the recommended way to run MySQL
is to install it as a Windows service. Then Windows starts and stops the MySQL
server automatically when Windows starts and stops. A server installed as a
service can also be controlled from the command line using <CODE>NET</CODE>
commands, or with the graphical <CODE>Services</CODE> utility.

</P>
<P>
The <CODE>Services</CODE> utility (the Windows
<CODE>Service Control Manager</CODE>) can be found in the Windows
<CODE>Control Panel</CODE> (under <CODE>Administrative Tools</CODE>
on Windows 2000). It is advisable to close the <CODE>Services</CODE> utility
while performing server installation or removal operations from this command
line.  This prevents some odd errors.

</P>
<P>
To get MySQL to work with TCP/IP on Windows NT 4, you must install
service pack 3 (or newer)!

</P>
<P>
Before installing MySQL as a Windows service, you should first stop
the current server if it is running by using the following command:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqladmin -u root shutdown
</PRE>

<P>
This invokes the MySQL administrative utility <CODE>mysqladmin</CODE> to
connect to the server and tell it to shut down. The command connects
as <CODE>root</CODE>, which is the default administrative account in the
MySQL grant system. Note that users in the MySQL grant system
are wholly independent from any login users under Windows.

</P>
<P>
Now install the server as a service:

</P>

<PRE>
C:\&#62; mysqld --install
</PRE>

<P>
If you have problems installing <CODE>mysqld</CODE> as a
service using just the server name, try installing it using its full pathname:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --install
</PRE>

<P>
As of MySQL 4.0.2, you can specify a specific service name after the
<CODE>--install</CODE> option.  As of MySQL 4.0.3, you can in addition specify a
<CODE>--defaults-file</CODE> option after the service name to indicate where the
server should obtain options when it starts. The rules that determine the
service name and option files the server uses are as follows:

</P>

<UL>

<LI>

If you specify no service name, the server uses the default service name of
<CODE>MySQL</CODE> and the server reads options from the <CODE>[mysqld]</CODE> group in
the standard option files.

<LI>

If you specify a service name after the
<CODE>--install</CODE> option, the server ignores the <CODE>[mysqld]</CODE> option
group and instead reads options from the group that has the same name as the
service. The server reads options from the standard option files.

<LI>

If you specify a <CODE>--defaults-file</CODE> option after the service name,
the server ignores the standard option files and reads options only from the
<CODE>[mysqld]</CODE> group of the named file.

</UL>

<P>
<STRONG>Note:</STRONG> Prior to MySQL 4.0.17, a server installed as a Windows
service has problems starting if its pathname or the service name contains
spaces. For this reason, avoid installing MySQL in a directory such as
<TT>`C:\Program Files'</TT> or using a service name containing spaces.

</P>
<P>
In the usual case that you install the server with <CODE>--install</CODE>
but no service name, the server is installed with a service
name of <CODE>MySQL</CODE>.

</P>
<P>
As a more complex example, consider the following command (which should be
entered on a single line):

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --install mysql
           --defaults-file=C:\my-opts.cnf
</PRE>

<P>
Here, a service name is given after the <CODE>--install</CODE> option. If no
<CODE>--defaults-file</CODE> option had been given, this command would have the
effect of causing the server to read the <CODE>[mysql]</CODE> group from the
standard option files. (This would be a bad idea, because that option group
is for use by the <CODE>mysql</CODE> client program.) However, because the
<CODE>--defaults-file</CODE> option is present, the server reads options only from
the named file, and only from the <CODE>[mysqld]</CODE> option group.

</P>
<P>
You can also specify options as ``<CODE>Start parameters</CODE>'' in the
Windows <CODE>Services</CODE> utility before you start the MySQL service.

</P>
<P>
Once a MySQL server is installed as a service, Windows will start
the service automatically whenever Windows starts.  The service also
can be started immediately from the <CODE>Services</CODE> utility, or by
using the command <CODE>NET START MySQL</CODE>.  The <CODE>NET</CODE> command
is not case sensitive.

</P>
<P>
When run as a service, <CODE>mysqld</CODE> has no access
to a console window, so no messages can be seen there.  If
<CODE>mysqld</CODE> doesn't start, check the error log to see whether the
server wrote any messages there to indicate the cause of the problem.
The error log is located in the <TT>`C:\mysql\data'</TT> directory. It
is the file with a suffix of <TT>`.err'</TT>.

</P>
<P>
When <CODE>mysqld</CODE> is running as a service, it can be stopped by
using the <CODE>Services</CODE> utility, the command <CODE>NET STOP
MySQL</CODE>, or the command <CODE>mysqladmin shutdown</CODE>. If the service
is running when Windows shuts down, Windows will stop the server
automatically.

</P>
<P>
From MySQL version 3.23.44, you have the choice of installing the
server as a <CODE>Manual</CODE> service if you don't wish the service to
be started automatically during the boot process. To do this, use
the <CODE>--install-manual</CODE> option rather than the <CODE>--install</CODE>
option:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --install-manual
</PRE>

<P>
To remove a server that is installed as a service, first stop it if it is
running. Then use the <CODE>--remove</CODE> option to remove it:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --remove
</PRE>

<P>
For MySQL versions older than 3.23.49, one problem with automatic
MySQL service shutdown is that Windows waited only for a few
seconds for the shutdown to complete, then killed the database
server process if the time limit was exceeded. This had the potential
to cause problems.  (For example, the <CODE>InnoDB</CODE> storage engine
had to perform crash recovery at the next startup.) Starting from
MySQL version 3.23.49, Windows waits longer for the MySQL server
shutdown to complete. If you notice this still is not enough for
your installation, it is safest not to run the MySQL server as a
service. Instead, start it from the command-line prompt, and stop
it with <CODE>mysqladmin shutdown</CODE>.

</P>
<P>
This change to tell Windows to wait longer when stopping the MySQL server
works for Windows 2000 and XP. It does not work for Windows NT, where Windows
waits only 20 seconds for a service to shut down, and after that kills the
service process. You can increase this default by opening the Registry
Editor <TT>`\winnt\system32\regedt32.exe'</TT> and editing the value of
<CODE>WaitToKillServiceTimeout</CODE> at
<CODE>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control</CODE>
in the Registry tree. Specify the new larger value in milliseconds.
For example, the value 120000 tells Windows NT to wait up to 120 seconds.

</P>
<P>
If you don't want to start <CODE>mysqld</CODE> as a service, you can
start it from the command line the same way as for versions of
Windows that are not based on NT.  For instructions, see section <A HREF="manual.html#Win95_start">2.2.1.6  Starting MySQL from the Windows Command Line</A>.

</P>


<H4><A NAME="Windows_running" HREF="manual_toc.html#Windows_running">2.2.1.8  Running MySQL Client Programs on Windows</A></H4>

<P>
<A NAME="IDX194"></A>
<A NAME="IDX195"></A>

</P>
<P>
You can test whether the MySQL server is working by executing any of the
following commands:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqlshow
C:\&#62; C:\mysql\bin\mysqlshow -u root mysql
C:\&#62; C:\mysql\bin\mysqladmin version status proc
C:\&#62; C:\mysql\bin\mysql test
</PRE>

<P>
If <CODE>mysqld</CODE> is slow to respond to TCP/IP connections from client programs
on Windows 9x/Me, there is
probably a problem with your DNS.  In this case, start <CODE>mysqld</CODE> with the
<CODE>--skip-name-resolve</CODE> option and use only <CODE>localhost</CODE> and IP
numbers in the <CODE>Host</CODE> column of the MySQL grant tables.

</P>
<P>
You can force a MySQL client to use a named pipe connection rather than TCP/IP
 by specifying the
<CODE>--pipe</CODE> option or by specifying <CODE>.</CODE> (period) as the host
name.  Use the <CODE>--socket</CODE> option to specify the name of the
pipe.  As of MySQL 4.1, you should use the <CODE>--protocol=PIPE</CODE>
option.

</P>
<P>
There are two versions of the MySQL command-line tool:
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Binary</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>mysql</CODE> </TD><TD> Compiled on native Windows, offering limited text editing capabilities.
</TD></TR>
<TR><TD><CODE>mysqlc</CODE> </TD><TD> Compiled with the Cygnus GNU compiler and libraries, which offers <CODE>readline</CODE> editing.
</TD></TR>
</TABLE>

</P>
<P>
If you want to use <CODE>mysqlc</CODE>, you must have a copy of the
<TT>`cygwinb19.dll'</TT> library installed somewhere that <CODE>mysqlc</CODE>
can find it. Current distributions of MySQL include this library
in the same directory as <CODE>mysqlc</CODE> (the <TT>`bin'</TT> directory
under the base directory of your MySQL installation). If your
distribution does not have the <CODE>cygwinb19.dll</CODE> library in the
<TT>`bin'</TT> directory, look for it in the <CODE>lib</CODE> directory and
copy it to your Windows system directory
(<TT>`\Windows\system'</TT> or a similar place).

</P>



<H4><A NAME="Windows_vs_Unix" HREF="manual_toc.html#Windows_vs_Unix">2.2.1.9  MySQL on Windows Compared to MySQL on Unix</A></H4>

<P>
<A NAME="IDX196"></A>
<A NAME="IDX197"></A>

</P>
<P>
MySQL for Windows has by now proven itself to be very stable. The Windows
version of MySQL has the same features as the corresponding Unix version,
with the following exceptions:

</P>
<DL COMPACT>

<DT><STRONG>Windows 95 and threads</STRONG>
<DD>
Windows 95 leaks about 200 bytes of main memory for each thread creation.
Each connection in MySQL creates a new thread, so you shouldn't
run <CODE>mysqld</CODE> for an extended time on Windows 95 if your server handles
many connections!  Other versions of Windows don't suffer from this bug.

<DT><STRONG>Limited number of ports</STRONG>
<DD>
Windows systems have about 4,000 ports available for client connections, and
after a connection on a port closes, it takes two to four minutes before the
port can be reused.  In situations where clients connect to and disconnect
from the server at a high rate, it is possible for all available ports to be
used up before closed ports become available again. If this happens, the
MySQL server will appear to have become unresponsive even though it is
running.  Note that ports may be used by other applications running on the
machine as well, in which case the number of ports available to MySQL is
lower.

<DT><STRONG>Concurrent reads</STRONG>
<DD>
MySQL depends on the <CODE>pread()</CODE> and <CODE>pwrite()</CODE> calls to be
able to mix <CODE>INSERT</CODE> and <CODE>SELECT</CODE>.  Currently we use mutexes
to emulate <CODE>pread()</CODE>/<CODE>pwrite()</CODE>.  We will, in the long run,
replace the file level interface with a virtual interface so that we can
use the <CODE>readfile()</CODE>/<CODE>writefile()</CODE> interface on NT, 2000, and XP to
get more speed.
The current implementation limits the number of open files MySQL
can use to 1,024, which means that you will not be able to run as many
concurrent threads on NT, 2000, and XP as on Unix.

<DT><STRONG>Blocking read</STRONG>
<DD>
MySQL uses a blocking read for each connection, which
has the following implications:


<UL>
<LI>

A connection will not be disconnected automatically after eight hours, as
happens with the Unix version of MySQL.

<LI>

If a connection hangs, it's impossible to break it without killing
MySQL.

<LI>

<CODE>mysqladmin kill</CODE> will not work on a sleeping connection.

<LI>

<CODE>mysqladmin shutdown</CODE> can't abort as long as there are sleeping
connections.
</UL>

We plan to fix this problem when our Windows developers have figured out a
nice workaround.

<DT><STRONG><CODE>ALTER TABLE</CODE></STRONG>
<DD>
While you are executing an <CODE>ALTER TABLE</CODE> statement, the table is locked
from being used by other threads.  This has to do with the fact that on Windows,
you can't delete a file that is in use by another thread.  In the future,
we may find some way to work around this problem.

<DT><STRONG><CODE>DROP TABLE</CODE></STRONG>
<DD>
<CODE>DROP TABLE</CODE> on a table that is in use by a <CODE>MERGE</CODE> table will
not work on Windows because the <CODE>MERGE</CODE> handler does the table mapping
hidden from the upper layer of MySQL.  Because Windows doesn't allow you
to drop files that are open, you first must flush all <CODE>MERGE</CODE>
tables (with <CODE>FLUSH TABLES</CODE>) or drop the <CODE>MERGE</CODE> table before
dropping the table.  We will fix this at the same time we introduce
views.

<DT><STRONG><CODE>DATA DIRECTORY</CODE> and <CODE>INDEX DIRECTORY</CODE></STRONG>
<DD>
The <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX DIRECTORY</CODE> options for
<CODE>CREATE TABLE</CODE> are ignored on Windows, because Windows doesn't support
symbolic links.  These options also are ignored on systems that have a
non-functional <CODE>realpath()</CODE> call.

<DT><STRONG><CODE>DROP DATABASE</CODE></STRONG>
<DD>
You cannot drop a database that is in use by some thread.

<DT><STRONG>Killing MySQL from the Task Manager</STRONG>
<DD>
You cannot kill MySQL from the Task Manager or with the shutdown
utility in Windows 95.  You must take it down with <CODE>mysqladmin shutdown</CODE>.

<DT><STRONG>Case-insensitive names</STRONG>
<DD>
Filenames are not case sensitive on Windows, so MySQL database and table names
are also not case sensitive on Windows.  The only
restriction is that database and table names must be specified using the same
case throughout a given statement.
See section <A HREF="manual.html#Name_case_sensitivity">10.2.2  Identifier Case Sensitivity</A>.

<DT><STRONG>The <SAMP>`\'</SAMP> pathname separator character</STRONG>
<DD>
Pathname components in Windows 95 are separated by the <SAMP>`\'</SAMP> character,
which is also the escape character in MySQL.  If you are using <CODE>LOAD
DATA INFILE</CODE> or <CODE>SELECT ... INTO OUTFILE</CODE>,
use Unix-style filenames with <SAMP>`/'</SAMP> characters:


<PRE>
mysql&#62; LOAD DATA INFILE 'C:/tmp/skr.txt' INTO TABLE skr;
mysql&#62; SELECT * INTO OUTFILE 'C:/tmp/skr.txt' FROM skr;
</PRE>

Alternatively, you must double the <SAMP>`\'</SAMP> character:


<PRE>
mysql&#62; LOAD DATA INFILE 'C:\\tmp\\skr.txt' INTO TABLE skr;
mysql&#62; SELECT * INTO OUTFILE 'C:\\tmp\\skr.txt' FROM skr;
</PRE>

<DT><STRONG>Problems with pipes.</STRONG>
<DD>
Pipes do not work reliably from the Windows command-line prompt.  If the
pipe includes the character <CODE>^Z</CODE> / <CODE>CHAR(24)</CODE>, Windows will think it
has encountered end-of-file and abort the program.

This is mainly a problem when you try to apply a binary log as follows:


<PRE>
C:\&#62; mysqlbinlog binary-log-name | mysql --user=root
</PRE>

If you get a problem applying the log and suspect that it is because of a <CODE>^Z</CODE>
/ <CODE>CHAR(24)</CODE>, character you can use the following workaround:


<PRE>
C:\&#62; mysqlbinlog binary-log-file --result-file=/tmp/bin.sql
C:\&#62; mysql --user=root --execute "source /tmp/bin.sql"
</PRE>

The latter command also can be used to reliably read in any SQL file
that may contain binary data.

<DT><STRONG><CODE>Can't open named pipe</CODE> error</STRONG>
<DD>
If you use a MySQL 3.22 server on Windows NT with the newest MySQL client
programs, you will get the following error:


<PRE>
error 2017: can't open named pipe to host: . pipe...
</PRE>

<A NAME="IDX198"></A>
This happens because the release version of MySQL uses named pipes on NT
by default.  You can avoid this error by using the <CODE>--host=localhost</CODE>
option to the new MySQL clients or create an option file
<TT>`C:\my.cnf'</TT> that contains the following information:


<PRE>
[client]
host = localhost
</PRE>

Starting from 3.23.50, named pipes are enabled only if <CODE>mysqld-nt</CODE> or
<CODE>mysqld-max-nt</CODE> is started with <CODE>--enable-named-pipe</CODE>.

<DT><STRONG><CODE>Access denied for user</CODE> error</STRONG>
<DD>
If you attempt to run a MySQL client program to connect to a server
running on the same machine, but get the error <CODE>Access denied
for user: 'some-user@unknown' to database 'mysql'</CODE>, this means
that MySQL cannot resolve your hostname properly.

To fix this, you should create a file named <TT>`\windows\hosts'</TT> containing
with the following information:


<PRE>
127.0.0.1       localhost
</PRE>

</DL>

<P>
Here are some open issues for anyone who might want to help us improve MySQL
on Windows:

</P>
<P>
<A NAME="IDX199"></A>

</P>

<UL>

<LI>

Add some nice start and shutdown icons to the MySQL installation.

<LI>

It would be really nice to be able to kill <CODE>mysqld</CODE> from the Task Manager
in Windows 95.  For the moment, you must use <CODE>mysqladmin shutdown</CODE>.

<LI>

Port <CODE>readline</CODE> to Windows for use in the <CODE>mysql</CODE> command-line tool.

<LI>

GUI versions of the standard MySQL clients (<CODE>mysql</CODE>,
<CODE>mysqlshow</CODE>, <CODE>mysqladmin</CODE>, and <CODE>mysqldump</CODE>) would be nice.

<LI>

It would be nice if the socket read and write functions in <TT>`net.c'</TT> were
interruptible. This would make it possible to kill open threads with
<CODE>mysqladmin kill</CODE> on Windows.

<LI>

Add macros to use the faster thread-safe increment/decrement methods
provided by Windows.
</UL>



<H3><A NAME="Linux-RPM" HREF="manual_toc.html#Linux-RPM">2.2.2  Installing MySQL on Linux</A></H3>

<P>
<A NAME="IDX200"></A>
<A NAME="IDX201"></A>
<A NAME="IDX202"></A>

</P>
<P>
The recommended way to install MySQL on Linux is by using the RPM
packages. The MySQL RPMs are currently built on a SuSE Linux 7.3
system, but should work on most versions of Linux that support <CODE>rpm</CODE>
and use <CODE>glibc</CODE>.
To obtain RPM packages, see section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

</P>
<P>
<STRONG>Note:</STRONG> RPM distributions of MySQL often are provided by other
vendors.  Be aware that they may differ in features and capabilities from
those built by MySQL AB, and that the instructions in this manual do not
necessarily apply to installing them. The vendor's instructions should be
consulted instead.

</P>
<P>
If you have problems with an RPM file (for example, if you receive the error
``<CODE>Sorry, the host 'xxxx' could not be looked up</CODE>''), see
section <A HREF="manual.html#Binary_notes-Linux">2.6.1.2  Linux Binary Distribution Notes</A>.

</P>
<P>
In most cases, you only need to install the <CODE>MySQL-server</CODE> and
<CODE>MySQL-client</CODE> packages to get a functional MySQL installation. The
other packages are not required for a standard installation.
If you want to run a MySQL-Max server that has additional capabilities,
you should also install the <CODE>MySQL-Max</CODE> RPM. However, you should do so only
<EM> after</EM> installing the <CODE>MySQL-server</CODE> RPM.
See section <A HREF="manual.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A>.

</P>
<P>
If you get a dependency failure when trying to install the MySQL 4.0
packages (for example, ``<CODE>error: removing these packages would break dependencies:
libmysqlclient.so.10 is needed by ...</CODE>''), you should also install
the package <CODE>MySQL-shared-compat</CODE>, which includes both the
shared libraries for backward compatibility (<CODE>libmysqlclient.so.12</CODE>
for MySQL 4.0 and <CODE>libmysqlclient.so.10</CODE> for MySQL 3.23).

</P>
<P>
Many Linux distributions still ship with MySQL 3.23 and they usually link
applications dynamically to save disk space. If these shared libraries are
in a separate package (for example, <CODE>MySQL-shared</CODE>), it is
sufficient to simply leave this package installed and just upgrade
the MySQL server and client packages (which are statically linked
and do not depend on the shared libraries). For distributions that
include the shared libraries in the same package as the MySQL server
(for example, Red Hat Linux), you could either install our 3.23
<CODE>MySQL-shared</CODE> RPM, or use the <CODE>MySQL-shared-compat</CODE> package instead.

</P>
<P>
The following RPM packages are available:

</P>

<UL>
<LI><CODE>MySQL-server-VERSION.i386.rpm</CODE>

The MySQL server.  You will need this unless you only want to
connect to a MySQL server running on another machine. Note:
Server RPM files were called <CODE>MySQL-VERSION.i386.rpm</CODE> before
MySQL 4.0.10. That is, they did not have <CODE>-server</CODE> in the name.

<LI><CODE>MySQL-Max-VERSION.i386.rpm</CODE>

The MySQL-Max server. This server has additional capabilities that the
one provided in the <CODE>MySQL-server</CODE> RPM does not.  You must install the
<CODE>MySQL-server</CODE> RPM first, because the <CODE>MySQL-Max</CODE> RPM depends on it.

<LI><CODE>MySQL-client-VERSION.i386.rpm</CODE>

The standard MySQL client programs. You probably always want to
install this package.

<LI><CODE>MySQL-bench-VERSION.i386.rpm</CODE>

Tests and benchmarks. Requires Perl and the <CODE>DBD::mysql</CODE> module.

<LI><CODE>MySQL-devel-VERSION.i386.rpm</CODE>

The libraries and include files that are needed if you want to compile other
MySQL clients, such as the Perl modules.

<LI><CODE>MySQL-shared-VERSION.i386.rpm</CODE>

This package contains the shared libraries (<CODE>libmysqlclient.so*</CODE>)
that certain languages and applications need to dynamically load and
use MySQL.

<LI><CODE>MySQL-shared-compat-VERSION.i386.rpm</CODE>

This package includes the shared libraries for both MySQL 3.23 and
MySQL 4.0. Install this package instead of <CODE>MySQL-shared</CODE> if you
have applications installed that are dynamically linked against MySQL
3.23 but you want to upgrade to MySQL 4.0 without breaking the library
dependencies. This package has been available since MySQL 4.0.13.

<LI><CODE>MySQL-embedded-VERSION.i386.rpm</CODE>

The embedded MySQL server library (from MySQL 4.0).

<LI><CODE>MySQL-VERSION.src.rpm</CODE>

This contains the source code for all of the previous packages. It can also
be used to rebuild the RPMs on other architectures (for example, Alpha or SPARC).
</UL>

<P>
To see all files in an RPM package (for example, a <CODE>MySQL-server</CODE>
RPM), run:

</P>

<PRE>
shell&#62; rpm -qpl MySQL-server-VERSION.i386.rpm
</PRE>

<P>
To perform a standard minimal installation, run:

</P>

<PRE>
shell&#62; rpm -i MySQL-server-VERSION.i386.rpm
shell&#62; rpm -i MySQL-client-VERSION.i386.rpm
</PRE>

<P>
To install just the client package, run:

</P>

<PRE>
shell&#62; rpm -i MySQL-client-VERSION.i386.rpm
</PRE>

<P>
RPM provides a feature to verify the integrity and authenticity of packages
before installing them. If you would like to learn more about this feature,
see section <A HREF="manual.html#Verifying_Package_Integrity">2.1.4  Verifying Package Integrity Using MD5 Checksums or <CODE>GnuPG</CODE></A>.

</P>
<P>
The server RPM places data under the <TT>`/var/lib/mysql'</TT> directory. The
RPM also creates a login account for a user named <CODE>mysql</CODE> (if one does not
already exist) to use for running the MySQL server, and
creates the appropriate entries in <TT>`/etc/init.d/'</TT> to start the
server automatically at boot time. (This means that if you have performed a
previous installation and have made changes to its startup script, you may
want to make a copy of the script so that you don't lose it when you install a
newer RPM.) See section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A> for more information on how MySQL can be
started automatically on system startup.

</P>
<P>
If you want to install the MySQL RPM on older Linux distributions that do
not support initialization scripts in <TT>`/etc/init.d'</TT> (directly
or via a symlink), you should create a symbolic link that points
to the location where your initialization scripts actually are
installed. For example, if that location is <TT>`/etc/rc.d/init.d'</TT>,
use these commands before installing the RPM to create <TT>`/etc/init.d'</TT>
as a symbolic link that points there:

</P>

<PRE>
shell&#62; cd /etc
shell&#62; ln -s rc.d/init.d .
</PRE>

<P>
However, all current major Linux distributions should already support the
new directory layout that uses <TT>`/etc/init.d'</TT>, because it is
required for LSB (Linux Standard Base) compliance.

</P>
<P>
If the RPM files that you install include <CODE>MySQL-server</CODE>, the
<CODE>mysqld</CODE> server should be up and running after installation.
You should now be able to start using MySQL.

</P>
<P>
If something goes wrong, you can find more information in the binary
installation section. See section <A HREF="manual.html#Installing_binary">2.2.5  Installing MySQL on Other Unix-Like Systems</A>.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H3><A NAME="Mac_OS_X_installation" HREF="manual_toc.html#Mac_OS_X_installation">2.2.3  Installing MySQL on Mac OS X</A></H3>

<P>
<A NAME="IDX203"></A>
<A NAME="IDX204"></A>

</P>
<P>
Beginning with MySQL 4.0.11, you can install MySQL on Mac OS X 10.2.x
(``Jaguar'') and up using a Mac OS X binary package in PKG format instead of the
binary tarball distribution. Please note that older versions of Mac OS X
(for example, 10.1.x) are not supported by this package.

</P>
<P>
The package is located inside a disk image (<CODE>.dmg</CODE>) file that you
first need to mount by double-clicking its icon in the Finder. It should
then mount the image and display its contents.

</P>
<P>
To obtain MySQL, see section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

</P>
<P>
<STRONG>Note:</STRONG> Before proceeding with the installation, be sure to
shut down all running MySQL server instances by either
using the MySQL Manager Application (on Mac OS X Server) or via
<CODE>mysqladmin shutdown</CODE> on the command line.

</P>
<P>
To actually install the MySQL PKG file, double-click on the package icon. This
launches the Mac OS X Package Installer, which will guide you through
the installation of MySQL.

</P>
<P>
Due to a bug in the Mac OS X package installer, you may sometimes see this
error message in the destination disk selection dialog:

</P>

<PRE>
You cannot install this software on this disk. (null)
</PRE>

<P>
If this error occurs, simply click the <CODE>Go Back</CODE> button once to return
to the previous screen. Then click <CODE>Continue</CODE> to advance to the
destination disk selection again, and you should be able to choose the
destination disk correctly. We have reported this bug to Apple and it is
investigating this problem.

</P>
<P>
The Mac OS X PKG of MySQL will install itself into
<TT>`/usr/local/mysql-VERSION'</TT> and will also install a symbolic link,
<TT>`/usr/local/mysql'</TT>, pointing to the new location. If a directory named
<TT>`/usr/local/mysql'</TT> already exists, it will be renamed to
<TT>`/usr/local/mysql.bak'</TT> first. Additionally, it will install the
grant tables in the <CODE>mysql</CODE> database by executing <CODE>mysql_install_db</CODE>
after the installation.

</P>
<P>
The installation layout is similar to that of a <CODE>tar</CODE> file binary
distribution; all MySQL binaries are located in the directory
<TT>`/usr/local/mysql/bin'</TT>.  The MySQL socket file is created as
<TT>`/tmp/mysql.sock'</TT> by default.
See section <A HREF="manual.html#Installation_layouts">2.1.5  Installation Layouts</A>.

</P>
<P>
MySQL installation requires a Mac OS X user account named <CODE>mysql</CODE>.  A
user account with this name should exist by default on Mac OS X 10.2 and up.

</P>
<P>
If you are running Mac OS X Server, you already have a version of MySQL
installed.  The versions of MySQL that ship with Mac OS X Server versions are
shown in the following table:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Mac OS X Server Version</STRONG> </TD><TD> <STRONG>MySQL Version</STRONG>
</TD></TR>
<TR><TD>10.2-10.2.2 </TD><TD> 3.23.51
</TD></TR>
<TR><TD>10.2.3-10.2.6 </TD><TD> 3.23.53
</TD></TR>
<TR><TD>10.3 </TD><TD> 4.0.14
</TD></TR>
<TR><TD>10.3.2 </TD><TD> 4.0.16
</TD></TR>
</TABLE>

<P>
This manual section covers the installation of the official MySQL Mac OS X
PKG only.  Make sure to read Apple's help information about installing MySQL:
Run the ``Help View'' application, select ``Mac OS X Server'' help, do a
search for ``MySQL,'' and read the item entitled ``Installing MySQL.''

</P>
<P>
For pre-installed versions of MySQL on Mac OS X Server, note especially that
you should start <CODE>mysqld</CODE> with <CODE>safe_mysqld</CODE> instead of
<CODE>mysqld_safe</CODE> if MySQL is older than version 4.0.

</P>
<P>
If you previously used Marc Liyanage's MySQL packages for Mac OS X from
<a HREF="http://www.entropy.ch">http://www.entropy.ch</a>, you can simply follow the update instructions
for packages using the binary installation layout as given on his pages.

</P>
<P>
If you are upgrading from Marc's 3.23.xx versions or from the Mac OS X
Server version of MySQL to the official MySQL PKG, you also need to convert
the existing MySQL privilege tables to the current format, because
some new security privileges have been added.
See section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</P>
<P>
If you would like to automatically start up MySQL during system startup, you
also need to install the MySQL Startup Item. Starting with MySQL 4.0.15, it
is part of the Mac OS X installation disk images as a separate installation
package. Simply double-click the <CODE>MySQLStartupItem.pkg</CODE> icon and follow
the instructions to install it.

</P>
<P>
Note that the Startup Item need be installed only once! There is no need to
install it each time you upgrade the MySQL package later.

</P>
<P>
The Startup Item will be installed into
<TT>`/Library/StartupItems/MySQLCOM'</TT>.  (Before MySQL 4.1.2, the location
was <TT>`/Library/StartupItems/MySQL'</TT>, but that collided with the MySQL
Startup Item installed by Mac OS X Server).  Startup Item installation
adds a variable <CODE>MYSQLCOM=-YES-</CODE> to the system configuration file
<TT>`/etc/hostconfig'</TT>. If you would like to disable the automatic startup
of MySQL, simply change this variable to <CODE>MYSQLCOM=-NO-</CODE>.

</P>
<P>
On Mac OS X Server, the default MySQL installation uses the variable
<CODE>MYSQL</CODE> in the <TT>`/etc/hostconfig'</TT> file.  The MySQL AB Startup Item
installer disables this variable by setting it to <CODE>MYSQL=-NO-</CODE>. This
avoids boot time conflicts with the <CODE>MYSQLCOM</CODE> variable used by the
MySQL AB Startup Item.  However, it does not shut down an already running
MySQL server. You should do that yourself.

</P>
<P>
After the installation, you can start up MySQL by running the following
commands in a terminal window. You must have administrator privileges to
perform this task.

</P>
<P>
If you have installed the Startup Item:

</P>

<PRE>
shell&#62; sudo /Library/StartupItems/MySQLCOM/MySQL start
(Enter your password, if necessary)
(Press Control-D or enter "exit" to exit the shell)
</PRE>

<P>
For versions of MySQL older than 4.1.2, substitute 
<CODE>/Library/StartupItems/MySQLCOM/MySQL</CODE> with
<CODE>/Library/StartupItems/MySQL/MySQL</CODE> above.

</P>
<P>
If you don't use the Startup Item, enter the following command sequence:

</P>

<PRE>
shell&#62; cd /usr/local/mysql
shell&#62; sudo ./bin/mysqld_safe
(Enter your password, if necessary)
(Press Control-Z)
shell&#62; bg
(Press Control-D or enter "exit" to exit the shell)
</PRE>

<P>
You should now be able to connect to the MySQL server, for example, by running
<TT>`/usr/local/mysql/bin/mysql'</TT>.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>
<P>
You might want to add aliases to your shell's resource file to make it easier
to access commonly used programs such as <CODE>mysql</CODE> and <CODE>mysqladmin</CODE>
from the command line. The syntax for <CODE>tcsh</CODE> is:

</P>

<PRE>
alias mysql /usr/local/mysql/bin/mysql
alias mysqladmin /usr/local/mysql/bin/mysqladmin
</PRE>

<P>
For <CODE>bash</CODE>, use:

</P>

<PRE>
alias mysql=/usr/local/mysql/bin/mysql
alias mysqladmin=/usr/local/mysql/bin/mysqladmin
</PRE>

<P>
Even better,
add <CODE>/usr/local/mysql/bin</CODE> to
your <CODE>PATH</CODE> environment variable. For example, add the following
line to your <TT>`$HOME/.tcshrc'</TT> file if your shell is <CODE>tcsh</CODE>:

</P>

<PRE>
setenv PATH ${PATH}:/usr/local/mysql/bin
</PRE>

<P>
If no <TT>`.tcshrc'</TT> file exists in your home directory, create it with a text
editor.

</P>
<P>
If you are upgrading an existing installation,
please note that installing a new MySQL PKG does not remove the directory
of an older installation. Unfortunately, the Mac OS X Installer does not yet
offer the functionality required to properly upgrade previously installed
packages.

</P>
<P>
To use your existing databases with the new installation, you'll need to copy
the contents of the old data directory to the new data directory. Make sure
that neither the old server nor the new one is running when you do this.
After you have copied over the MySQL database files from the
previous installation and have successfully started the new server, you should
consider removing the old installation files to save disk space.
Additionally, you should also remove older versions of the Package Receipt
directories located in <TT>`/Library/Receipts/mysql-VERSION.pkg'</TT>.

</P>


<H3><A NAME="NetWare_installation" HREF="manual_toc.html#NetWare_installation">2.2.4  Installing MySQL on NetWare</A></H3>

<P>
<A NAME="IDX205"></A>
<A NAME="IDX206"></A>

</P>
<P>
Porting MySQL to NetWare was an effort spearheaded by
Novell. Novell customers will be pleased to note that NetWare 6.5
ships with bundled MySQL binaries, complete with an automatic
commercial use license for all servers running that version of NetWare.

</P>
<P>
MySQL for NetWare is compiled using a combination of <CODE>Metrowerks
CodeWarrior for NetWare</CODE> and special cross-compilation versions of the
GNU autotools.

</P>
<P>
The latest binary packages for NetWare can be obtained at
<a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.
See section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

</P>
<P>
In order to host MySQL, the NetWare server must meet these requirements:

</P>

<UL>
<LI>

NetWare version 6.5 or later, (Support pack 1.1 is recommended; you can
find this and other updates at
<a HREF="http://support.novell.com/filefinder/18197/index.html">http://support.novell.com/filefinder/18197/index.html</a> or
NetWare 6.0 with Support Pack 3 installed (you can obtain this at
<a HREF="http://support.novell.com/filefinder/13659/index.html">http://support.novell.com/filefinder/13659/index.html</a>).
<LI>

The system must meet Novell's minimum requirements to run the respective
version of NetWare.
<LI>

MySQL data, as well as the binaries themselves, must be installed on an
NSS volume; traditional volumes are not supported.
</UL>

<P>
To install MySQL for NetWare, use the following procedure:

</P>

<OL>
<LI>

If you are upgrading from a prior installation, stop the MySQL server.
This is done from the server console, using the following command:


<PRE>
SERVER:  mysqladmin -u root shutdown
</PRE>

<LI>

Log on to the target server from a client machine with access to the
location where you will install MySQL.

<LI>

Extract the binary package Zip file onto the server. Be sure to allow
the paths in the Zip file to be used. It is safe to simply extract the
file to <TT>`SYS:\'</TT>.

If you are upgrading from a prior installation, you may need to copy the
data directory (for example, <TT>`SYS:MYSQL\DATA'</TT>) now, as well as
<TT>`my.cnf'</TT>, if you have customized it. You can then delete the old copy
of MySQL.

<LI>

You might want to rename the directory to something more consistent and easy
to use. We recommend using <TT>`SYS:MYSQL'</TT>; examples in this manual
use this name to refer to the installation directory in general.

<LI>

At the server console, add a search path for the directory containing the
MySQL NLMs. For example:


<PRE>
SERVER:  SEARCH ADD SYS:MYSQL\BIN
</PRE>

<LI>

Initialize the data directory and the grant tables, if needed, by executing
<CODE>mysql_install_db</CODE> at the server console.

<LI>

Start the MySQL server using <CODE>mysqld_safe</CODE> at the server console.

<LI>

To finish the installation, you should also add the following commands to
<CODE>autoexec.ncf</CODE>. For example, if your MySQL installation is in
<TT>`SYS:MYSQL'</TT> and you want MySQL to start automatically, you could
add these lines:


<PRE>
#Starts the MySQL 4.0.x database server
SEARCH ADD SYS:MYSQL\BIN
MYSQLD_SAFE
</PRE>

If you are running MySQL on NetWare 6.0, we strongly suggest that you use the
<CODE>--skip-external-locking</CODE> option on the command line:


<PRE>
#Starts the MySQL 4.0.x database server
SEARCH ADD SYS:MYSQL\BIN
MYSQLD_SAFE --skip-external-locking
</PRE>

It will also be necessary to use <CODE>CHECK TABLE</CODE> and <CODE>REPAIR
TABLE</CODE> instead of <CODE>myisamchk</CODE>, because <CODE>myisamchk</CODE> makes use
of external locking.  External locking is known to have problems on
NetWare 6.0; the problem has been eliminated in NetWare 6.5.

<CODE>mysqld_safe</CODE> on NetWare provides a screen presence. When you unload
(shut down) the <CODE>mysqld_safe</CODE> NLM, the screen does not by default go
away.  Instead, it prompts for user input:


<PRE>
*&#60;NLM has terminated; Press any key to close the screen&#62;*
</PRE>

If you want NetWare to close the screen automatically instead, use the
<CODE>--autoclose</CODE> option to <CODE>mysqld_safe</CODE>. For example:


<PRE>
#Starts the MySQL 4.0.x database server
SEARCH ADD SYS:MYSQL\BIN
MYSQLD_SAFE --autoclose
</PRE>

</OL>

<P>
The behavior of <CODE>mysqld_safe</CODE> on NetWare is described further in
section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>
<P>
If there was an existing installation of MySQL on the server, be sure
to check for existing MySQL startup commands in <CODE>autoexec.ncf</CODE>,
and edit or delete them as necessary.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H3><A NAME="Installing_binary" HREF="manual_toc.html#Installing_binary">2.2.5  Installing MySQL on Other Unix-Like Systems</A></H3>

<P>
<A NAME="IDX207"></A>
<A NAME="IDX208"></A>

</P>
<P>
This section covers the installation of MySQL binary distributions that are
provided for various platforms in the form of compressed <CODE>tar</CODE> files
(files with a <CODE>.tar.gz</CODE> extension).  See section <A HREF="manual.html#MySQL_binaries">2.1.2.5  MySQL Binaries Compiled by MySQL AB</A> for a
detailed list.

</P>
<P>
MySQL <CODE>tar</CODE> file binary distributions have names of the form
<TT>`mysql-VERSION-OS.tar.gz'</TT>, where <CODE>VERSION</CODE> is a number (for
example, <CODE>4.0.17</CODE>), and <CODE>OS</CODE> indicates the type of operating
system for which the distribution is intended (for example,
<CODE>pc-linux-gnu-i586</CODE>).

</P>
<P>
In addition to these generic packages, we also offer binaries in
platform-specific package formats for selected platforms.
See section <A HREF="manual.html#Quick_Standard_Installation">2.2  Standard MySQL Installation Using a Binary Distribution</A> for more information on how to install
these.

</P>
<P>
To obtain MySQL, see section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

</P>
<P>
You need the following tools to install a MySQL <CODE>tar</CODE> file binary
distribution:

</P>

<UL>
<LI>

GNU <CODE>gunzip</CODE> to uncompress the distribution.

<LI>

A reasonable <CODE>tar</CODE> to unpack the distribution. GNU <CODE>tar</CODE> is known
to work. Some operating systems come with a pre-installed version of
<CODE>tar</CODE> that is known to have problems.  For example, Mac OS X <CODE>tar</CODE>
and Sun <CODE>tar</CODE> are known to have problems with long filenames.  On Mac
OS X, you can use the pre-installed <CODE>gnutar</CODE> program.  On other systems
with a deficient <CODE>tar</CODE>, you should install GNU <CODE>tar</CODE> first.
</UL>

<P>
If you run into problems, <EM>please always use <CODE>mysqlbug</CODE></EM> when
posting questions to a MySQL mailing list.  Even if the problem
isn't a bug, <CODE>mysqlbug</CODE> gathers system information that will help others
solve your problem.  By not using <CODE>mysqlbug</CODE>, you lessen the likelihood
of getting a solution to your problem.  You will find <CODE>mysqlbug</CODE> in the
<TT>`bin'</TT> directory after you unpack the distribution.  See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

</P>
<P>
<A NAME="IDX209"></A>
The basic commands you must execute to install and use a MySQL
binary distribution are:

</P>

<PRE>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
shell&#62; cd /usr/local
shell&#62; gunzip &#60; /path/to/mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s full-path-to-mysql-VERSION-OS mysql
shell&#62; cd mysql
shell&#62; scripts/mysql_install_db --user=mysql
shell&#62; chown -R root  .
shell&#62; chown -R mysql data
shell&#62; chgrp -R mysql .
shell&#62; bin/mysqld_safe --user=mysql &#38;
</PRE>

<P>
For versions of MySQL older than 4.0, substitute <CODE>bin/safe_mysqld</CODE>
for <CODE>bin/mysqld_safe</CODE> in the final command.

</P>
<P>
<STRONG>Note:</STRONG> This procedure does not set up any passwords for MySQL
accounts.  After following the procedure, proceed to section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>,
for post-installation setup and testing.

</P>
<P>
A more detailed version of the preceding description for installing
a binary distribution follows:

</P>

<OL>

<LI>

Add a login user and group for <CODE>mysqld</CODE> to run as:


<PRE>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
</PRE>

These commands add the <CODE>mysql</CODE> group and the <CODE>mysql</CODE> user.  The
syntax for <CODE>useradd</CODE> and <CODE>groupadd</CODE> may differ slightly on different
versions of Unix.  They may also be called <CODE>adduser</CODE> and <CODE>addgroup</CODE>.

You might want to call the user and group something else instead
of <CODE>mysql</CODE>.  If so, substitute the appropriate name in the
following steps.

<LI>

Pick the directory under which you want to unpack the distribution, and
change location into it. In the following example, we unpack the
distribution under <TT>`/usr/local'</TT> (The instructions, therefore, assume
that you have permission to create files and directories in
<TT>`/usr/local'</TT>.  If that directory is protected, you will need to perform
the installation as <CODE>root</CODE>.)


<PRE>
shell&#62; cd /usr/local
</PRE>

<LI>

Obtain a distribution file from one of the sites listed in
section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.
For a given release, binary distributions for all platforms
are built from the same MySQL source distribution.

<LI>

Unpack the distribution, which will create the installation directory.
Then create a symbolic link to that directory:


<PRE>
shell&#62; gunzip &#60; /path/to/mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s full-path-to-mysql-VERSION-OS mysql
</PRE>

The <CODE>tar</CODE> command creates a directory named <TT>`mysql-VERSION-OS'</TT>.  The
<CODE>ln</CODE> command makes a symbolic link to that directory.  This lets you refer
more easily to the installation directory as <TT>`/usr/local/mysql'</TT>.

With GNU <CODE>tar</CODE>, no separate invocation of <CODE>gunzip</CODE> is necessary.
You can replace the first line with the following
alternative command to uncompress and extract the distribution:


<PRE>
shell&#62; tar zxvf /path/to/mysql-VERSION-OS.tar.gz
</PRE>

<LI>

Change location into the installation directory:


<PRE>
shell&#62; cd mysql
</PRE>

You will find several files and subdirectories in the <CODE>mysql</CODE> directory.
The most important for installation purposes are the <TT>`bin'</TT> and
<TT>`scripts'</TT> subdirectories.

<DL COMPACT>

<DT><TT>`bin'</TT>
<DD>
<A NAME="IDX210"></A>
<A NAME="IDX211"></A>
This directory contains client programs and the server.
You should add the full pathname of this directory to your
<CODE>PATH</CODE> environment variable so that your shell finds the MySQL
programs properly. See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

<DT><TT>`scripts'</TT>
<DD>
This directory contains the <CODE>mysql_install_db</CODE> script used to initialize
the <CODE>mysql</CODE> database containing the grant tables that store the server
access permissions.
</DL>

<LI>

If you haven't installed MySQL before, you must create the MySQL grant tables:


<PRE>
shell&#62; scripts/mysql_install_db --user=mysql
</PRE>

If you run the command as <CODE>root</CODE>, you should use the <CODE>--user</CODE>
option as shown.  The value of the option should be the name of the login
account that you created in the first step to use for running the server.
If you run the command while logged in as that user, you can omit the
<CODE>--user</CODE> option.

Note that for MySQL versions older than 3.22.10,
<CODE>mysql_install_db</CODE> left the server running after creating the grant
tables.  This is no longer true; you will need to restart the server after
performing the remaining steps in this procedure.

<LI>

Change ownership of program binaries to <CODE>root</CODE> and ownership of the data
directory to the user that you will run <CODE>mysqld</CODE> as.  Assuming that you
are located in the installation directory (<TT>`/usr/local/mysql'</TT>), the
commands look like this:


<PRE>
shell&#62; chown -R root  .
shell&#62; chown -R mysql data
shell&#62; chgrp -R mysql .
</PRE>

The first command changes the owner attribute of the files to the
<CODE>root</CODE> user. The second changes the owner attribute of the
data directory to the <CODE>mysql</CODE> user. The third changes the
group attribute to the <CODE>mysql</CODE> group.

<LI>

If you would like MySQL to start automatically when you boot your
machine, you can copy <CODE>support-files/mysql.server</CODE> to the location where
your system has its startup files.  More information can be found in the
<CODE>support-files/mysql.server</CODE> script itself and in
section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.

<LI>

<A NAME="IDX212"></A>
<A NAME="IDX213"></A>
<A NAME="IDX214"></A>
You can set up new accounts using the <CODE>bin/mysql_setpermission</CODE> script if
you install the <CODE>DBI</CODE> and <CODE>DBD::mysql</CODE> Perl modules.
For instructions, see section <A HREF="manual.html#Perl_support">2.7  Perl Installation Notes</A>.

<LI>

If you would like to use <CODE>mysqlaccess</CODE> and have the MySQL
distribution in some non-standard place, you must change the location where
<CODE>mysqlaccess</CODE> expects to find the <CODE>mysql</CODE> client.  Edit the
<TT>`bin/mysqlaccess'</TT> script at approximately line 18.  Search for a line
that looks like this:


<PRE>
$MYSQL     = '/usr/local/bin/mysql';    # path to mysql executable
</PRE>

Change the path to reflect the location where <CODE>mysql</CODE> actually is
stored on your system.  If you do not do this, you will get a <CODE>Broken
pipe</CODE> error when you run <CODE>mysqlaccess</CODE>.

</OL>

<P>
After everything has been unpacked and installed, you should
test your distribution.

</P>
<P>
You can start the MySQL server with the following command:

</P>

<PRE>
shell&#62; bin/mysqld_safe --user=mysql &#38;
</PRE>

<P>
For versions of MySQL older than 4.0, substitute <CODE>bin/safe_mysqld</CODE>
for <CODE>bin/mysqld_safe</CODE> in the command.

</P>
<P>
More information about <CODE>mysqld_safe</CODE> is given in
section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H2><A NAME="Installing_source" HREF="manual_toc.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A></H2>

<P>
<A NAME="IDX215"></A>
<A NAME="IDX216"></A>
<A NAME="IDX217"></A>

</P>

<P>
Before you proceed with the source installation, check first to see whether our
binary is available for your platform and whether it will work for you. We
put a lot of effort into making sure that our binaries are built with the
best possible options.

</P>
<P>
To obtain a source distribution for MySQL, section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

</P>
<P>
MySQL source distributions are provided as compressed <CODE>tar</CODE>
archives and have names of the form <TT>`mysql-VERSION.tar.gz'</TT>, where
<CODE>VERSION</CODE> is a number like <CODE>4.0.20</CODE>.

</P>
<P>
You need the following tools to build and install MySQL from source:

</P>

<UL>
<LI>

GNU <CODE>gunzip</CODE> to uncompress the distribution.

<LI>

A reasonable <CODE>tar</CODE> to unpack the distribution. GNU <CODE>tar</CODE> is known
to work. Some operating systems come with a pre-installed version of
<CODE>tar</CODE> that is known to have problems.  For example, Mac OS X <CODE>tar</CODE>
and Sun <CODE>tar</CODE> are known to have problems with long filenames.  On Mac
OS X, you can use the pre-installed <CODE>gnutar</CODE> program.  On other systems
with a deficient <CODE>tar</CODE>, you should install GNU <CODE>tar</CODE> first.

<LI>

A working ANSI C++ compiler.  <CODE>gcc</CODE> 2.95.2 or later, <CODE>egcs</CODE> 1.0.2 or later or <CODE>egcs 2.91.66</CODE>, SGI C++, and SunPro C++ are some of the
compilers that are known to work.  <CODE>libg++</CODE> is not needed when
using <CODE>gcc</CODE>.  <CODE>gcc</CODE> 2.7.x has a bug that makes it impossible
to compile some perfectly legal C++ files, such as
<TT>`sql/sql_base.cc'</TT>.  If you have only <CODE>gcc</CODE> 2.7.x, you must
upgrade your <CODE>gcc</CODE> to be able to compile MySQL. <CODE>gcc</CODE>
2.8.1 is also known to have problems on some platforms, so it should be
avoided if a new compiler exists for the platform.

<CODE>gcc</CODE> 2.95.2 or later is recommended when compiling MySQL
3.23.x.

<LI>

A good <CODE>make</CODE> program.  GNU <CODE>make</CODE> is always recommended and is
sometimes required.  If you have problems, we recommend trying GNU
<CODE>make</CODE> 3.75 or newer.
</UL>

<P>
If you are using a recent version of <CODE>gcc</CODE>, recent enough to understand the
<CODE>-fno-exceptions</CODE> option, it is <EM>very important</EM> that you use
it. Otherwise, you may compile a binary that crashes randomly. We also
recommend that you use <CODE>-felide-constructors</CODE> and <CODE>-fno-rtti</CODE> along
with <CODE>-fno-exceptions</CODE>. When in doubt, do the following:

</P>

<PRE>
CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors \
       -fno-exceptions -fno-rtti" ./configure \
       --prefix=/usr/local/mysql --enable-assembler \
       --with-mysqld-ldflags=-all-static
</PRE>

<P>
On most systems, this will give you a fast and stable binary.

</P>
<P>
If you run into problems, <EM>please always use <CODE>mysqlbug</CODE></EM> when
posting questions to a MySQL mailing list.  Even if the problem
isn't a bug, <CODE>mysqlbug</CODE> gathers system information that will help others
solve your problem.  By not using <CODE>mysqlbug</CODE>, you lessen the likelihood
of getting a solution to your problem.  You will find <CODE>mysqlbug</CODE> in the
<TT>`scripts'</TT> directory after you unpack the distribution.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

</P>



<H3><A NAME="Quick_install" HREF="manual_toc.html#Quick_install">2.3.1  Source Installation Overview</A></H3>

<P>
The basic commands you must execute to install a MySQL source
distribution are:

</P>

<PRE>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
shell&#62; gunzip &#60; mysql-VERSION.tar.gz | tar -xvf -
shell&#62; cd mysql-VERSION
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; make
shell&#62; make install
shell&#62; cp support-files/my-medium.cnf /etc/my.cnf
shell&#62; cd /usr/local/mysql
shell&#62; bin/mysql_install_db --user=mysql
shell&#62; chown -R root  .
shell&#62; chown -R mysql var
shell&#62; chgrp -R mysql .
shell&#62; bin/mysqld_safe --user=mysql &#38;
</PRE>

<P>
For versions of MySQL older than 4.0, substitute <CODE>bin/safe_mysqld</CODE>
for <CODE>bin/mysqld_safe</CODE> in the final command.

</P>
<P>
If you start from a source RPM, do the following:

</P>

<PRE>
shell&#62; rpm --rebuild --clean MySQL-VERSION.src.rpm
</PRE>

<P>
This will make a binary RPM that you can install.

</P>
<P>
<STRONG>Note:</STRONG> This procedure does not set up any passwords for MySQL
accounts.  After following the procedure, proceed to section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>,
for post-installation setup and testing.

</P>
<P>
A more detailed version of the preceding description for installing
MySQL from a source distribution follows:

</P>

<OL>

<LI>

Add a login user and group for <CODE>mysqld</CODE> to run as:


<PRE>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
</PRE>

These commands add the <CODE>mysql</CODE> group and the <CODE>mysql</CODE> user.  The
syntax for <CODE>useradd</CODE> and <CODE>groupadd</CODE> may differ slightly on different
versions of Unix.  They may also be called <CODE>adduser</CODE> and <CODE>addgroup</CODE>.

You might want to call the user and group something else instead
of <CODE>mysql</CODE>.  If so, substitute the appropriate name in the
following steps.

<LI>

Pick the directory under which you want to unpack the distribution, and move
into it.

<LI>

Obtain a distribution file from one of the sites listed in
section <A HREF="manual.html#Getting_MySQL">2.1.3  How to Get MySQL</A>.

<LI>

Unpack the distribution into the current directory:

<PRE>
shell&#62; gunzip &#60; /path/to/mysql-VERSION.tar.gz | tar xvf -
</PRE>

This command creates a directory named <TT>`mysql-VERSION'</TT>.

With GNU <CODE>tar</CODE>, no separate invocation of <CODE>gunzip</CODE> is necessary.
You can use the following alternative command to uncompress and extract
the distribution:


<PRE>
shell&#62; tar zxvf /path/to/mysql-VERSION-OS.tar.gz
</PRE>

<LI>

Change location into the top-level directory of the unpacked distribution:


<PRE>
shell&#62; cd mysql-VERSION
</PRE>

Note that currently you must configure and build MySQL from
this top-level directory.  You cannot build it in a different
directory.

<LI>

Configure the release and compile everything:


<PRE>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; make
</PRE>

When you run <CODE>configure</CODE>, you might want to specify some options.
Run <CODE>./configure --help</CODE> for a list of options.
section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>, discusses some of the
more useful options.

If <CODE>configure</CODE> fails and you are going to send mail to a MySQL mailing
list to ask for assistance, please include any
lines from <TT>`config.log'</TT> that you think can help solve the problem.  Also
include the last couple of lines of output from <CODE>configure</CODE>.
Post the bug report using the <CODE>mysqlbug</CODE>
script.  See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

If the compile fails, see section <A HREF="manual.html#Compilation_problems">2.3.4  Dealing with Problems Compiling MySQL</A>, for help.

<LI>

Install the distribution:


<PRE>
shell&#62; make install
</PRE>

If you want to set up an option file, use one of those present in the
<TT>`support-files'</TT> directory as a template. For example:


<PRE>
shell&#62; cp support-files/my-medium.cnf /etc/my.cnf
</PRE>

You might need to run these commands as <CODE>root</CODE>.

If you want to configure support for <CODE>InnoDB</CODE> tables, you should edit the
<CODE>/etc/my.cnf</CODE> file, remove the <CODE>#</CODE> character before the
option lines that start with <CODE>innodb_...</CODE>, and modify the option values
to be what you want.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>
and section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.

<LI>

Change location into the installation directory:


<PRE>
shell&#62; cd /usr/local/mysql
</PRE>

<LI>

If you haven't installed MySQL before, you must create the MySQL grant tables:


<PRE>
shell&#62; bin/mysql_install_db --user=mysql
</PRE>

If you run the command as <CODE>root</CODE>, you should use the <CODE>--user</CODE>
option as shown.  The value of the option should be the name of the login
account that you created in the first step to use for running the server.
If you run the command while logged in as that user, you can omit the
<CODE>--user</CODE> option.

Note that for MySQL versions older than 3.22.10,
<CODE>mysql_install_db</CODE> left the server running after creating the grant
tables.  This is no longer true; you will need to restart the server after
performing the remaining steps in this procedure.

<LI>

Change ownership of binaries to <CODE>root</CODE> and ownership of the data
directory to the user that you will run <CODE>mysqld</CODE> as.  Assuming that you
are located in the installation directory (<TT>`/usr/local/mysql'</TT>), the
commands look like this:


<PRE>
shell&#62; chown -R root  .
shell&#62; chown -R mysql var
shell&#62; chgrp -R mysql .
</PRE>

The first command changes the owner attribute of the files to the
<CODE>root</CODE> user. The second changes the owner attribute of the
data directory to the <CODE>mysql</CODE> user. The third changes the
group attribute to the <CODE>mysql</CODE> group.

<LI>

If you would like MySQL to start automatically when you boot your
machine, you can copy <CODE>support-files/mysql.server</CODE> to the location where
your system has its startup files.  More information can be found in the
<CODE>support-files/mysql.server</CODE> script itself and in
section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.

<LI>

<A NAME="IDX218"></A>
<A NAME="IDX219"></A>
<A NAME="IDX220"></A>
You can set up new accounts using the <CODE>bin/mysql_setpermission</CODE> script if
you install the <CODE>DBI</CODE> and <CODE>DBD::mysql</CODE> Perl modules.
For instructions, see section <A HREF="manual.html#Perl_support">2.7  Perl Installation Notes</A>.

</OL>

<P>
After everything has been installed, you should initialize and test your
distribution using this command:

</P>

<PRE>
shell&#62; /usr/local/mysql/bin/mysqld_safe --user=mysql &#38;
</PRE>

<P>
For versions of MySQL older than 4.0, substitute <CODE>safe_mysqld</CODE>
for <CODE>mysqld_safe</CODE> in the command.

</P>
<P>
If that command fails immediately and prints <CODE>mysqld ended</CODE>, you can
find some information in the file <TT>`host_name.err'</TT> in the data directory.

</P>
<P>
More information about <CODE>mysqld_safe</CODE> is given in
section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>
<P>
<STRONG>Note:</STRONG>
The accounts that are listed in the MySQL grant tables initially have no
passwords.  After starting the server, you should set up passwords for
them using the instructions in section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H3><A NAME="configure_options" HREF="manual_toc.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A></H3>

<P>
<A NAME="IDX221"></A>
<A NAME="IDX222"></A>
<A NAME="IDX223"></A>
<A NAME="IDX224"></A>
<A NAME="IDX225"></A>
<A NAME="IDX226"></A>

</P>
<P>
The <CODE>configure</CODE> script gives you a great deal of control over how
you configure a MySQL source distribution.  Typically you do this
using options on the <CODE>configure</CODE> command line.  You can also affect
<CODE>configure</CODE> using certain environment variables.  See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.  For a list of options supported by <CODE>configure</CODE>, run
this command:

</P>

<PRE>
shell&#62; ./configure --help
</PRE>

<P>
Some of the more commonly used <CODE>configure</CODE> options are described here:

</P>

<UL>
<LI>

To compile just the MySQL client libraries and client programs and
not the server, use the <CODE>--without-server</CODE> option:


<PRE>
shell&#62; ./configure --without-server
</PRE>

If you don't have a C++ compiler, <CODE>mysql</CODE> will not compile (it is the
one client program that requires C++).  In this case,
you can remove the code in <CODE>configure</CODE> that tests for the C++ compiler
and then run <CODE>./configure</CODE> with the <CODE>--without-server</CODE> option. The
compile step will still try to build <CODE>mysql</CODE>, but you can ignore any
warnings about <TT>`mysql.cc'</TT>.  (If <CODE>make</CODE> stops, try <CODE>make -k</CODE>
to tell it to continue with the rest of the build even if errors occur.)

<LI>

If you want to get an embedded MySQL library (<CODE>libmysqld.a</CODE>) you should
use the <CODE>--with-embedded-server</CODE> option.

<LI>

If you don't want your log files and database directories located under
<TT>`/usr/local/var'</TT>, use a <CODE>configure</CODE> command something like one
of these:


<PRE>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; ./configure --prefix=/usr/local \
           --localstatedir=/usr/local/mysql/data
</PRE>

The first command changes the installation prefix so that everything is
installed under <TT>`/usr/local/mysql'</TT> rather than the default of
<TT>`/usr/local'</TT>.  The second command preserves the default installation
prefix, but overrides the default location for database directories
(normally <TT>`/usr/local/var'</TT>) and changes it to
<CODE>/usr/local/mysql/data</CODE>.  After you have compiled MySQL, you can
change these options with option files. See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

<A NAME="IDX227"></A>
<A NAME="IDX228"></A>
<A NAME="IDX229"></A>
<LI>

If you are using Unix and you want the MySQL socket located somewhere
other than the default location (normally in the directory <TT>`/tmp'</TT> or
<TT>`/var/run'</TT>), use a <CODE>configure</CODE> command like this:


<PRE>
shell&#62; ./configure \
           --with-unix-socket-path=/usr/local/mysql/tmp/mysql.sock
</PRE>

The socket filename must be an absolute pathname.
You can also later change the location of <TT>`mysql.sock'</TT> by using a MySQL
option file. See section <A HREF="manual.html#Problems_with_mysql.sock">A.4.5  How to Protect or Change the MySQL Socket File <TT>`/tmp/mysql.sock'</TT></A>.

<A NAME="IDX230"></A>
<A NAME="IDX231"></A>
<LI>

If you want to compile statically linked programs (for example, to make a
binary distribution, to get more speed, or to work around problems with some
Red Hat Linux distributions), run <CODE>configure</CODE> like this:


<PRE>
shell&#62; ./configure --with-client-ldflags=-all-static \
           --with-mysqld-ldflags=-all-static
</PRE>

<A NAME="IDX232"></A>
<A NAME="IDX233"></A>
<A NAME="IDX234"></A>
<A NAME="IDX235"></A>
<A NAME="IDX236"></A>
<A NAME="IDX237"></A>
<A NAME="IDX238"></A>
<LI>

If you are using <CODE>gcc</CODE> and don't have <CODE>libg++</CODE> or <CODE>libstdc++</CODE>
installed, you can tell <CODE>configure</CODE> to use <CODE>gcc</CODE> as your C++
compiler:


<PRE>
shell&#62; CC=gcc CXX=gcc ./configure
</PRE>

When you use <CODE>gcc</CODE> as your C++ compiler, it will not attempt to link in
<CODE>libg++</CODE> or <CODE>libstdc++</CODE>.  This may be a good idea to do even if you
have these libraries installed, because some versions of them have
caused strange problems for MySQL users in the past.

The following list indicates some compilers and environment variable settings
that are commonly used with each one.

<A NAME="IDX239"></A>
<A NAME="IDX240"></A>
<A NAME="IDX241"></A>
<A NAME="IDX242"></A>
<A NAME="IDX243"></A>
<A NAME="IDX244"></A>
<A NAME="IDX245"></A>
<A NAME="IDX246"></A>

<DL COMPACT>

<DT><CODE>gcc</CODE> 2.7.2:
<DD>

<PRE>
CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors"
</PRE>

<DT><CODE>egcs</CODE> 1.0.3a:
<DD>

<PRE>
CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors \
-fno-exceptions -fno-rtti"
</PRE>

<DT><CODE>gcc</CODE> 2.95.2:
<DD>

<PRE>
CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro \
-felide-constructors -fno-exceptions -fno-rtti"
</PRE>

<DT><CODE>pgcc</CODE> 2.90.29 or newer:
<DD>

<PRE>
CFLAGS="-O3 -mpentiumpro -mstack-align-double" CXX=gcc \
CXXFLAGS="-O3 -mpentiumpro -mstack-align-double \
-felide-constructors -fno-exceptions -fno-rtti"
</PRE>

</DL>

In most cases, you can get a reasonably optimized MySQL binary by using the
options from the preceding list and adding the following options to the
<CODE>configure</CODE> line:


<PRE>
--prefix=/usr/local/mysql --enable-assembler \
--with-mysqld-ldflags=-all-static
</PRE>

The full <CODE>configure</CODE> line would, in other words, be something like the
following for all recent <CODE>gcc</CODE> versions:


<PRE>
CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro \
-felide-constructors -fno-exceptions -fno-rtti" ./configure \
--prefix=/usr/local/mysql --enable-assembler \
--with-mysqld-ldflags=-all-static
</PRE>

The binaries we provide on the MySQL Web site at
<a HREF="http://www.mysql.com/">http://www.mysql.com/</a> are all compiled with full optimization and
should be perfect for most users.  See section <A HREF="manual.html#MySQL_binaries">2.1.2.5  MySQL Binaries Compiled by MySQL AB</A>.  There are some
configuration settings you can tweak to make an even faster binary, but these
are only for advanced users.  See section <A HREF="manual.html#Compile_and_link_options">7.5.3  How Compiling and Linking Affects the Speed of MySQL</A>.

If the build fails and produces errors about your compiler or linker not
being able to create the shared library <TT>`libmysqlclient.so.#'</TT> (where
<SAMP>`#'</SAMP> is a version number), you can work around this problem by giving the
<CODE>--disable-shared</CODE> option to <CODE>configure</CODE>.  In this case,
<CODE>configure</CODE> will not build a shared <TT>`libmysqlclient.so.#'</TT> library.

<A NAME="IDX247"></A>
<A NAME="IDX248"></A>
<LI>

You can configure MySQL not to use <CODE>DEFAULT</CODE> column values for
non-<CODE>NULL</CODE> columns (that is, columns that are not allowed to be
<CODE>NULL</CODE>). See section <A HREF="manual.html#constraint_NOT_NULL">1.8.6.2  Constraint <CODE>NOT NULL</CODE> and <CODE>DEFAULT</CODE> Values</A>.

<A NAME="IDX249"></A>
<A NAME="IDX250"></A>
<A NAME="IDX251"></A>
<A NAME="IDX252"></A>

<PRE>
shell&#62; CXXFLAGS=-DDONT_USE_DEFAULT_FIELDS ./configure
</PRE>

The effect of this flag is to cause any <CODE>INSERT</CODE> statement to fail unless
it includes explicit values for all columns that require a non-<CODE>NULL</CODE>
value.

<A NAME="IDX253"></A>
<A NAME="IDX254"></A>
<A NAME="IDX255"></A>
<A NAME="IDX256"></A>
<LI>

By default, MySQL uses the <CODE>latin1</CODE> ISO-8859-1 character set. To
change the default set, use the <CODE>--with-charset</CODE> option:

<PRE>
shell&#62; ./configure --with-charset=CHARSET
</PRE>

<CODE>CHARSET</CODE> may be one of <CODE>big5</CODE>, <CODE>cp1251</CODE>, <CODE>cp1257</CODE>,
<CODE>czech</CODE>, <CODE>danish</CODE>, <CODE>dec8</CODE>, <CODE>dos</CODE>, <CODE>euc_kr</CODE>,
<CODE>gb2312</CODE>, <CODE>gbk</CODE>, <CODE>german1</CODE>, <CODE>hebrew</CODE>, <CODE>hp8</CODE>,
<CODE>hungarian</CODE>, <CODE>koi8_ru</CODE>, <CODE>koi8_ukr</CODE>, <CODE>latin1</CODE>,
<CODE>latin2</CODE>, <CODE>sjis</CODE>, <CODE>swe7</CODE>, <CODE>tis620</CODE>, <CODE>ujis</CODE>,
<CODE>usa7</CODE>, or <CODE>win1251ukr</CODE>.
See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

As of MySQL 4.1.1, the default collation may also be specified. MySQL uses
the <CODE>latin1_swedish_ci</CODE> collation. To change this, use the
<CODE>--with-collation</CODE> option:


<PRE>
shell&#62; ./configure --with-collation=COLLATION
</PRE>

To change both the character set and the collation, use both the
<CODE>--with-charset</CODE> and <CODE>--with-collation</CODE> options.
The collation must be a legal collation for the character set.
(Use the <CODE>SHOW COLLATION</CODE> statement to determine which collations are
available for each character set.)

If you want to convert characters between the server and the client,
you should take a look at the <CODE>SET CHARACTER SET</CODE> statement.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<A NAME="IDX257"></A>
<STRONG>Warning:</STRONG> If you change character sets after having created any
tables, you will have to run <CODE>myisamchk -r -q --set-character-set=charset</CODE>
on every table. Your
indexes may be sorted incorrectly otherwise.  (This can happen if you
install MySQL, create some tables, then reconfigure
MySQL to use a different character set and reinstall it.)

With the <CODE>configure</CODE> option <CODE>--with-extra-charsets=LIST</CODE>, you can
define which additional character sets should be compiled into the server.
<CODE>LIST</CODE> is either a list of character set names separated by spaces,
<CODE>complex</CODE> to include all character sets that can't be dynamically loaded,
or <CODE>all</CODE> to include all character sets into the binaries.

<LI>

To configure MySQL with debugging code, use the <CODE>--with-debug</CODE>
option:

<PRE>
shell&#62; ./configure --with-debug
</PRE>

This causes a safe memory allocator to be included that can find some errors
and that provides output about what is happening.
See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>.

<LI>

If your client programs are using threads, you also must compile a
thread-safe version of the MySQL client library with the
<CODE>--enable-thread-safe-client</CODE> configure option. This will create a
<CODE>libmysqlclient_r</CODE> library with which you should link your threaded
applications.  See section <A HREF="manual.html#Threaded_clients">20.2.14  How to Make a Threaded Client</A>.

<LI>

Options that pertain to particular systems can be found in the
system-specific section of this manual.
See section <A HREF="manual.html#Operating_System_Specific_Notes">2.6  Operating System-Specific Notes</A>.
</UL>



<H3><A NAME="Installing_source_tree" HREF="manual_toc.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A></H3>

<P>
<A NAME="IDX258"></A>
<A NAME="IDX259"></A>
<A NAME="IDX260"></A>

</P>
<P>
<STRONG>Caution</STRONG>: You should read this section only if you are interested
in helping us test our new code. If you just want to get MySQL up
and running on your system, you should use a standard release distribution
(either a binary or source distribution will do).

</P>
<P>
To obtain our most recent development source tree, use these instructions:

</P>

<OL>
<LI>

Download <CODE>BitKeeper</CODE> from
<a HREF="http://www.bitmover.com/cgi-bin/download.cgi">http://www.bitmover.com/cgi-bin/download.cgi</a>.  You will need
<CODE>Bitkeeper</CODE> 3.0 or newer to access our repository.

<LI>

Follow the instructions to install it.

<LI>

After <CODE>BitKeeper</CODE> has been installed, first go to the directory you
want to work from, and then use one of the following commands to clone
the MySQL version branch of your choice:

To clone the old 3.23 branch, use this command:


<PRE>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-3.23 mysql-3.23
</PRE>

To clone the 4.0 stable (production) branch, use this command:


<PRE>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-4.0 mysql-4.0
</PRE>

To clone the 4.1 alpha branch, use this command:


<PRE>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-4.1 mysql-4.1
</PRE>

To clone the 5.0 development branch, use this command:


<PRE>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-5.0 mysql-5.0
</PRE>

In the preceding examples, the source tree will be set up in the
<TT>`mysql-3.23/'</TT>, <TT>`mysql-4.0/'</TT>, <TT>`mysql-4.1/'</TT>, or <TT>`mysql-5.0/'</TT>
subdirectory of your current directory.

If you are behind a firewall and can only initiate HTTP connections,
you can also use <CODE>BitKeeper</CODE> via HTTP.

If you are required to use a proxy server, set the environment
variable <CODE>http_proxy</CODE> to point to your proxy:


<PRE>
shell&#62; export http_proxy="http://your.proxy.server:8080/"
</PRE>

Now, simply replace the <CODE>bk://</CODE> with <CODE>http://</CODE> when doing
a clone. Example:


<PRE>
shell&#62; bk clone http://mysql.bkbits.net/mysql-4.1 mysql-4.1
</PRE>

The initial download of the source tree may take a while, depending on the
speed of your connection. Please be patient.

<LI>

You will need GNU <CODE>make</CODE>, <CODE>autoconf</CODE> 2.53 (or newer),
<CODE>automake</CODE> 1.5, <CODE>libtool</CODE> 1.5, and <CODE>m4</CODE> to run the next
set of commands. Even though many operating systems already come with their
own implementation of <CODE>make</CODE>, chances are high that the compilation
will fail with strange error messages. Therefore, it is highly recommended
that you use GNU <CODE>make</CODE> (sometimes named <CODE>gmake</CODE>) instead.

Fortunately, a large number of operating systems already ship with the GNU
toolchain preinstalled or supply installable packages of these. In any case,
they can also be downloaded from the following locations:


<UL>
<LI>

http://www.gnu.org/software/autoconf/
<LI>

http://www.gnu.org/software/automake/
<LI>

http://www.gnu.org/software/libtool/
<LI>

http://www.gnu.org/software/m4/
<LI>

http://www.gnu.org/software/make/
</UL>

If you are trying to configure MySQL 4.1 or later, you will also need GNU
<CODE>bison</CODE> 1.75 or later.  Older versions of <CODE>bison</CODE> may report this
error:


<PRE>
sql_yacc.yy:#####: fatal error: maximum table size (32767) exceeded
</PRE>

Note: The maximum table size is not actually exceeded,
the error is caused by bugs in older versions of <CODE>bison</CODE>.

Versions of MySQL before version 4.1 may also compile with other
<CODE>yacc</CODE> implementations (for example, BSD <CODE>yacc</CODE> 91.7.30). For later
versions, GNU <CODE>bison</CODE> is required.

The following example shows the typical commands required to configure a
source tree. The first <CODE>cd</CODE> command changes location into the top-level
directory of the tree; replace <TT>`mysql-4.0'</TT> with the appropriate directory
name.


<PRE>
shell&#62; cd mysql-4.0
shell&#62; bk -r edit
shell&#62; aclocal; autoheader; autoconf; automake
shell&#62; (cd innobase; aclocal; autoheader; autoconf; automake)
shell&#62; (cd bdb/dist; sh s_all)
shell&#62; ./configure  # Add your favorite options here
make
</PRE>

The command lines that change directory into the <TT>`innobase'</TT> and
<TT>`bdb/dist'</TT> directories are used to configure the <CODE>InnoDB</CODE> and
Berkeley DB (<CODE>BDB</CODE>) storage engines.  You can omit these command lines if
you to not require <CODE>InnoDB</CODE> or <CODE>BDB</CODE> support.

If you get some strange errors during this stage, verify that you really
have <CODE>libtool</CODE> installed.

A collection of our standard configuration scripts is located in the
<TT>`BUILD/'</TT> subdirectory.  You may find it more convenient to use the
<TT>`BUILD/compile-pentium-debug'</TT> script than the preceding set of
shell commands. To compile on a different architecture,
modify the script by removing flags that are Pentium-specific.

<LI>

When the build is done, run <CODE>make install</CODE>.  Be careful with this
on a production machine; the command may overwrite your live release
installation.  If you have another installation of MySQL, we
recommend that you run <CODE>./configure</CODE> with different values for the
<CODE>--prefix</CODE>, <CODE>--with-tcp-port</CODE>, and <CODE>--unix-socket-path</CODE> options
than those used for your production server.

<LI>

Play hard with your new installation and try to make the new features
crash.  Start by running <CODE>make test</CODE>.  See section <A HREF="manual.html#MySQL_test_suite">22.1.2  MySQL Test Suite</A>.

<LI>

If you have gotten to the <CODE>make</CODE> stage and the distribution does
not compile, please report it in our bugs database at
<a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>.  If you
have installed the latest versions of the required GNU tools, and they
crash trying to process our configuration files, please report that also.
However, if you execute <CODE>aclocal</CODE> and get a <CODE>command not found</CODE>
error or a similar problem, do not report it.  Instead, make sure that all
the necessary tools are installed and that your <CODE>PATH</CODE> variable is
set correctly so that your shell can find them.

<LI>

After the initial <CODE>bk clone</CODE> operation to obtain the source tree, you
should run <CODE>bk pull</CODE> periodically to get updates.

<LI>

You can examine the change history for the tree with all the diffs by using
<CODE>bk revtool</CODE>.  If you see some funny diffs or code that you have a
question about, do not hesitate to send email to the MySQL <CODE>internals</CODE>
mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
Also, if you think you have a better idea
on how to do something, send an email message to the same address with a patch.
<CODE>bk diffs</CODE> will produce a patch for you after you have made changes
to the source. If you do not have the time to code your idea, just send
a description.

<LI>

<CODE>BitKeeper</CODE> has a nice help utility that you can access via
<CODE>bk helptool</CODE>.

<LI>

Please note that any commits (made via <CODE>bk ci</CODE> or <CODE>bk citool</CODE>) will
trigger the posting of a message with the changeset to our internals
mailing list, as well as the usual openlogging.org submission with
just the changeset comments.
Generally, you wouldn't need to use commit (since the public tree will
not allow <CODE>bk push</CODE>), but rather use the <CODE>bk diffs</CODE> method
described previously.

</OL>

<P>
You can also browse changesets, comments, and source code online. For example,
to browse this information for MySQL 4.1, go to
<a HREF="http://mysql.bkbits.net:8080/mysql-4.1">http://mysql.bkbits.net:8080/mysql-4.1</a>.

</P>
<P>
The manual is in a separate tree that can be cloned with:

</P>

<PRE>
shell&#62; bk clone bk://mysql.bkbits.net/mysqldoc mysqldoc
</PRE>

<P>
There are also public BitKeeper trees for MySQL Control Center and
Connector/ODBC. They can be cloned respectively as follows.

</P>
<P>
To clone MySQL Control center, use this command:

</P>

<PRE>
shell&#62; bk clone http://mysql.bkbits.net/mysqlcc mysqlcc
</PRE>

<P>
To clone Connector/ODBC, use this command:

</P>

<PRE>
shell&#62; bk clone http://mysql.bkbits.net/myodbc3 myodbc3
</PRE>



<H3><A NAME="Compilation_problems" HREF="manual_toc.html#Compilation_problems">2.3.4  Dealing with Problems Compiling MySQL</A></H3>

<P>
<A NAME="IDX261"></A>
<A NAME="IDX262"></A>
<A NAME="IDX263"></A>
<A NAME="IDX264"></A>
<A NAME="IDX265"></A>

</P>
<P>
All MySQL programs compile cleanly for us with no warnings on
Solaris or Linux using <CODE>gcc</CODE>.  On other systems, warnings may occur due to
differences in system include files.  See section <A HREF="manual.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A> for warnings
that may occur when using MIT-pthreads.  For other problems, check
the following list.

</P>
<P>
The solution to many problems involves reconfiguring.  If you do need to
reconfigure, take note of the following:

</P>
<P>
<A NAME="IDX266"></A>
<A NAME="IDX267"></A>
<A NAME="IDX268"></A>
<A NAME="IDX269"></A>

<UL>
<LI>

If <CODE>configure</CODE> is run after it already has been run, it may use
information that was gathered during its previous invocation.  This
information is stored in <TT>`config.cache'</TT>.  When <CODE>configure</CODE> starts
up, it looks for that file and reads its contents if it exists, on the
assumption that the information is still correct.  That assumption is invalid
when you reconfigure.

<LI>

Each time you run <CODE>configure</CODE>, you must run <CODE>make</CODE> again
to recompile.  However, you may want to remove old object files from previous
builds first because they were compiled using different configuration options.
</UL>

<P>
To prevent old configuration information or object files from being used,
run these commands before re-running <CODE>configure</CODE>:

</P>

<PRE>
shell&#62; rm config.cache
shell&#62; make clean
</PRE>

<P>
Alternatively, you can run <CODE>make distclean</CODE>.

</P>
<P>
The following list describes some of the problems when compiling MySQL
that have been found to occur most often:

</P>

<UL>
<LI>

<A NAME="IDX270"></A>
<A NAME="IDX271"></A>
<A NAME="IDX272"></A>
<A NAME="IDX273"></A>
<A NAME="IDX274"></A>
<A NAME="IDX275"></A>
If you get errors such as the ones shown here when compiling
<TT>`sql_yacc.cc'</TT>, you have probably run out of memory or swap space:


<PRE>
Internal compiler error: program cc1plus got fatal signal 11
Out of virtual memory
Virtual memory exhausted
</PRE>

The problem is that <CODE>gcc</CODE> requires a huge amount of memory to compile
<TT>`sql_yacc.cc'</TT> with inline functions.  Try running <CODE>configure</CODE> with
the <CODE>--with-low-memory</CODE> option:


<PRE>
shell&#62; ./configure --with-low-memory
</PRE>

This option causes <CODE>-fno-inline</CODE> to be added to the compile line if you
are using <CODE>gcc</CODE> and <CODE>-O0</CODE> if you are using something else.  You
should try the <CODE>--with-low-memory</CODE> option even if you have so much
memory and swap space that you think you can't possibly have run out.  This
problem has been observed to occur even on systems with generous hardware
configurations and the <CODE>--with-low-memory</CODE> option usually fixes it.

<LI>

By default, <CODE>configure</CODE> picks <CODE>c++</CODE> as the compiler name and
GNU <CODE>c++</CODE> links with <CODE>-lg++</CODE>.  If you are using <CODE>gcc</CODE>,
that behavior can cause problems during configuration such as this:

<A NAME="IDX276"></A>

<PRE>
configure: error: installation or configuration problem:
C++ compiler cannot create executables.
</PRE>

<A NAME="IDX277"></A>
<A NAME="IDX278"></A>
You might also observe problems during compilation related to
<CODE>g++</CODE>, <CODE>libg++</CODE>, or <CODE>libstdc++</CODE>.

One cause of these problems is that you may not have <CODE>g++</CODE>, or you may
have <CODE>g++</CODE> but not <CODE>libg++</CODE>, or <CODE>libstdc++</CODE>.  Take a look at
the <TT>`config.log'</TT> file.  It should contain the exact reason why your C++
compiler didn't work.  To work around these problems, you can use <CODE>gcc</CODE>
as your C++ compiler.  Try setting the environment variable <CODE>CXX</CODE> to
<CODE>"gcc -O3"</CODE>.  For example:

<A NAME="IDX279"></A>
<A NAME="IDX280"></A>

<PRE>
shell&#62; CXX="gcc -O3" ./configure
</PRE>

This works because <CODE>gcc</CODE> compiles C++ sources as well as <CODE>g++</CODE>
does, but does not link in <CODE>libg++</CODE> or <CODE>libstdc++</CODE> by default.

Another way to fix these problems is to install <CODE>g++</CODE>,
<CODE>libg++</CODE>, and <CODE>libstdc++</CODE>.  We would, however, like to recommend
you to not use <CODE>libg++</CODE> or <CODE>libstdc++</CODE> with MySQL because this will
only increase the binary size of mysqld without giving you any benefits.
Some versions of these libraries have also caused strange problems for
MySQL users in the past.

<A NAME="IDX281"></A>
<A NAME="IDX282"></A>
Using <CODE>gcc</CODE> as the C++ compiler is also required if you want to
compile MySQL with RAID functionality (see section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A> for more info
on RAID table type) and you are using GNU <CODE>gcc</CODE> version 3 and above. If
you get errors like those following during the linking stage when you
configure MySQL to compile with the option <CODE>--with-raid</CODE>, try to use
<CODE>gcc</CODE> as your C++ compiler by defining the <CODE>CXX</CODE> environment
variable:


<PRE>
gcc -O3 -DDBUG_OFF -rdynamic -o isamchk isamchk.o sort.o  libnisam.a
../mysys/libmysys.a ../dbug/libdbug.a ../strings/libmystrings.a
 -lpthread -lz -lcrypt -lnsl -lm -lpthread
../mysys/libmysys.a(raid.o)(.text+0x79): In function
`my_raid_create':: undefined reference to `operator new(unsigned)'
../mysys/libmysys.a(raid.o)(.text+0xdd): In function
`my_raid_create':: undefined reference to `operator delete(void*)'
../mysys/libmysys.a(raid.o)(.text+0x129): In function
`my_raid_open':: undefined reference to `operator new(unsigned)'
../mysys/libmysys.a(raid.o)(.text+0x189): In function
`my_raid_open':: undefined reference to `operator delete(void*)'
../mysys/libmysys.a(raid.o)(.text+0x64b): In function
`my_raid_close':: undefined reference to `operator delete(void*)'
collect2: ld returned 1 exit status
</PRE>

<LI>

If your compile fails with errors such as any of the following,
you must upgrade your version of <CODE>make</CODE> to GNU <CODE>make</CODE>:


<PRE>
making all in mit-pthreads
make: Fatal error in reader: Makefile, line 18:
Badly formed macro assignment
</PRE>

Or:

<PRE>
make: file `Makefile' line 18: Must be a separator (:
</PRE>

Or:

<PRE>
pthread.h: No such file or directory
</PRE>

<A NAME="IDX283"></A>
<A NAME="IDX284"></A>
<A NAME="IDX285"></A>
<A NAME="IDX286"></A>
Solaris and FreeBSD are known to have troublesome <CODE>make</CODE> programs.

GNU <CODE>make</CODE> Version 3.75 is known to work.

<A NAME="IDX287"></A>
<A NAME="IDX288"></A>
<A NAME="IDX289"></A>
<A NAME="IDX290"></A>
<A NAME="IDX291"></A>
<A NAME="IDX292"></A>
<A NAME="IDX293"></A>
<A NAME="IDX294"></A>
<LI>

If you want to define flags to be used by your C or C++ compilers, do so by
adding the flags to the <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE> environment
variables.  You can also specify the compiler names this way using <CODE>CC</CODE>
and <CODE>CXX</CODE>.  For example:


<PRE>
shell&#62; CC=gcc
shell&#62; CFLAGS=-O3
shell&#62; CXX=gcc
shell&#62; CXXFLAGS=-O3
shell&#62; export CC CFLAGS CXX CXXFLAGS
</PRE>

See section <A HREF="manual.html#MySQL_binaries">2.1.2.5  MySQL Binaries Compiled by MySQL AB</A>, for a list of flag definitions that have been found
to be useful on various systems.

<LI>

If you get an error message like this,
you need to upgrade your <CODE>gcc</CODE> compiler:


<PRE>
client/libmysql.c:273: parse error before `__attribute__'
</PRE>

<CODE>gcc</CODE> 2.8.1 is known to work, but we recommend using <CODE>gcc</CODE> 2.95.2 or
<CODE>egcs</CODE> 1.0.3a instead.

<LI>

If you get errors such as those shown here when compiling <CODE>mysqld</CODE>,
<CODE>configure</CODE> didn't correctly detect the type of the last argument to
<CODE>accept()</CODE>, <CODE>getsockname()</CODE>, or <CODE>getpeername()</CODE>:


<PRE>
cxx: Error: mysqld.cc, line 645: In this statement, the referenced
     type of the pointer value ''length'' is ''unsigned long'',
     which is not compatible with ''int''.
new_sock = accept(sock, (struct sockaddr *)&#38;cAddr, &#38;length);
</PRE>

To fix this, edit the <TT>`config.h'</TT> file (which is generated by
<CODE>configure</CODE>).  Look for these lines:


<PRE>
/* Define as the base type of the last arg to accept */
#define SOCKET_SIZE_TYPE XXX
</PRE>

Change <CODE>XXX</CODE> to <CODE>size_t</CODE> or <CODE>int</CODE>, depending on your
operating system.  (Note that you will have to do this each time you run
<CODE>configure</CODE> because <CODE>configure</CODE> regenerates <TT>`config.h'</TT>.)

<LI>

The <TT>`sql_yacc.cc'</TT> file is generated from <TT>`sql_yacc.yy'</TT>.  Normally
the build process doesn't need to create <TT>`sql_yacc.cc'</TT>, because
MySQL comes with an already generated copy.  However, if you do need
to re-create it, you might encounter this error:


<PRE>
"sql_yacc.yy", line xxx fatal: default action causes potential...
</PRE>

This is a sign that your version of <CODE>yacc</CODE> is deficient.
You probably need to install <CODE>bison</CODE> (the GNU version of <CODE>yacc</CODE>)
and use that instead.

<LI>

On Debian Linux 3.0, you need to install <CODE>gawk</CODE> instead of the default
<CODE>mawk</CODE> if you want to compile MySQL 4.1 or higher with Berkeley DB
support.

<LI>

If you need to debug <CODE>mysqld</CODE> or a MySQL client, run
<CODE>configure</CODE> with the <CODE>--with-debug</CODE> option, then recompile and
link your clients with the new client library.  See section <A HREF="manual.html#Debugging_client">D.2  Debugging a MySQL Client</A>.

<LI>

If you get a compilation error on Linux (for example, SuSE Linux 8.1 or Red Hat
Linux 7.3) similar to the following one:


<PRE>
libmysql.c:1329: warning: passing arg 5 of `gethostbyname_r' from
incompatible pointer type
libmysql.c:1329: too few arguments to function `gethostbyname_r'
libmysql.c:1329: warning: assignment makes pointer from integer
without a cast
make[2]: *** [libmysql.lo] Error 1
</PRE>

By default, the <CODE>configure</CODE> script attempts to determine the correct
number of arguments by using <CODE>g++</CODE> the GNU C++ compiler. This test
yields wrong results if <CODE>g++</CODE> is not installed. There are two ways
to work around this problem:


<UL>
<LI>

Make sure that the GNU C++ <CODE>g++</CODE> is installed. On some Linux
distributions, the required package is called <CODE>gpp</CODE>; on others, it
is named <CODE>gcc-c++</CODE>.
<LI>

Use <CODE>gcc</CODE> as your C++ compiler by setting the <CODE>CXX</CODE> environment
variable to <CODE>gcc</CODE>:

<PRE>
export CXX="gcc"
</PRE>

</UL>

Please note that you need to run <CODE>configure</CODE> again afterward.

</UL>



<H3><A NAME="MIT-pthreads" HREF="manual_toc.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A></H3>

<P>
<A NAME="IDX295"></A>
<A NAME="IDX296"></A>

</P>
<P>
This section describes some of the issues involved in using MIT-pthreads.

</P>
<P>
On Linux, you should <EM>not</EM> use MIT-pthreads. Use the
installed LinuxThreads implementation instead.
See section <A HREF="manual.html#Linux">2.6.1  Linux Notes</A>.

</P>
<P>
If your system does not provide native thread support, you will need to
build MySQL using the MIT-pthreads package.  This includes
older FreeBSD systems, SunOS 4.x, Solaris 2.4 and earlier, and some others.
See section <A HREF="manual.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A>.

</P>
<P>
Beginning with MySQL 4.0.2, MIT-pthreads are no longer part of
the source distribution. If you require this package, you need to download
it separately from
http://www.mysql.com/Downloads/Contrib/pthreads-1_60_beta6-mysql.tar.gz

</P>
<P>
After downloading, extract this source archive into the top level of the
MySQL source directory. It will create a new subdirectory
<CODE>mit-pthreads</CODE>.

</P>

<UL>
<LI>

On most systems, you can force MIT-pthreads to be used by running
<CODE>configure</CODE> with the <CODE>--with-mit-threads</CODE> option:


<PRE>
shell&#62; ./configure --with-mit-threads
</PRE>

Building in a non-source directory is not supported when using
MIT-pthreads because we want to minimize our changes to this code.

<LI>

The checks that determine whether to use MIT-pthreads occur only
during the part of the configuration process that deals with the server
code.  If you have configured the distribution using <CODE>--without-server</CODE>
to build only the client code, clients will not know whether
MIT-pthreads is being used and will use Unix socket connections by default.
Because Unix socket files do not work under MIT-pthreads on some platforms, this
means you will need to use <CODE>-h</CODE> or <CODE>--host</CODE> when you run client
programs.

<LI>

When MySQL is compiled using MIT-pthreads, system locking is
disabled by default for performance reasons.  You can tell the server to use
system locking with the <CODE>--external-locking</CODE> option.  This is needed
only if you want to be able to run two MySQL servers against the same data
files, which is not recommended.

<LI>

Sometimes the pthread <CODE>bind()</CODE> command fails to bind to a socket without
any error message (at least on Solaris).  The result is that all connections
to the server fail.  For example:


<PRE>
shell&#62; mysqladmin version
mysqladmin: connect to server at '' failed;
error: 'Can't connect to mysql server on localhost (146)'
</PRE>

The solution to this is to kill the <CODE>mysqld</CODE> server and restart it.
This has only happened to us when we have forced down the server and done
a restart immediately.

<LI>

With MIT-pthreads, the <CODE>sleep()</CODE> system call isn't interruptible with
<CODE>SIGINT</CODE> (break).  This is only noticeable when you run
<CODE>mysqladmin --sleep</CODE>.  You must wait for the <CODE>sleep()</CODE> call to
terminate before the interrupt is served and the process stops.

<LI>

When linking, you may receive warning messages like these (at least on
Solaris); they can be ignored:


<PRE>
ld: warning: symbol `_iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
ld: warning: symbol `__iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
</PRE>

<LI>

Some other warnings also can be ignored:


<PRE>
implicit declaration of function `int strtoll(...)'
implicit declaration of function `int strtoul(...)'
</PRE>

<LI>

We haven't gotten <CODE>readline</CODE> to work with MIT-pthreads.  (This isn't
needed, but may be interesting for someone.)
</UL>



<H3><A NAME="Windows_source_build" HREF="manual_toc.html#Windows_source_build">2.3.6  Installing MySQL from Source on Windows</A></H3>

<P>
These instructions describe how to build MySQL binaries from source
for versions 4.1 and above on Windows. Instructions are provided
for building binaries from a standard source distribution or from
the BitKeeper tree that contains the latest development source.

</P>
<P>
<STRONG>Note:</STRONG>
The instructions in this document are strictly for users who want
to test MySQL on Windows from the latest source distribution or
from the BitKeeper tree.  For production use, MySQL AB does not
advise using a MySQL server built by yourself from source.  Normally,
it is best to use precompiled binary distributions of MySQL that
are built specifically for optimal performance on Windows by MySQL
AB.  Instructions for installing a binary distributions are available
at section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.

</P>
<P>
To build MySQL on Windows from source, you need the following
compiler and resources available on your Windows system:

</P>

<UL>
<LI>

VC++ 6.0 compiler (updated with 4 or 5 SP and pre-processor package).
The pre-processor package is necessary for the macro assembler.
More details can be found at
<a HREF="http://msdn.microsoft.com/vstudio/downloads/updates/sp/vs6/sp5/faq.aspx">http://msdn.microsoft.com/vstudio/downloads/updates/sp/vs6/sp5/faq.aspx</a>.

<LI>

Approximately 45MB disk space.

<LI>

64MB RAM.

</UL>

<P>
You'll also need a MySQL source distribution for Windows.  There
are two ways you can get a source distribution for MySQL version
4.1 and above:

</P>

<OL>
<LI>

Obtain a source distribution packaged by MySQL AB for the particular
version of MySQL in which you are interested.  Prepackaged source
distributions are available for released versions of MySQL and can
be obtained from <a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.

<LI>

You can package a source distribution yourself from the latest
BitKeeper developer source tree. If you plan to do this, you must
create the package on a Unix system and then transfer it to your
Windows system.  (The reason for this is that some of the configuration
and build steps require tools that work only on Unix.)  The BitKeeper
approach thus requires:


<UL>
<LI>

A system running Unix, or a Unix-like system such as Linux.

<LI>

BitKeeper 3.0 installed on that system. You can obtain
BitKeeper from <a HREF="http://www.bitkeeper.com/">http://www.bitkeeper.com/</a>.

</UL>

</OL>

<P>
If you are using a Windows source distribution, you can go directly to
section <A HREF="manual.html#Windows_VC++_Build">2.3.6.1  Building MySQL Using VC++</A>. To build from the BitKeeper tree, proceed to
section <A HREF="manual.html#Windows_BitKeeper_Build">2.3.6.2  Creating a Windows Source Package from the Latest Development Source</A>.

</P>
<P>
If you find something not working as expected, or you have
suggestions about ways to improve the current build process
on Windows, please send a message to the <CODE>win32</CODE> mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>



<H4><A NAME="Windows_VC++_Build" HREF="manual_toc.html#Windows_VC++_Build">2.3.6.1  Building MySQL Using VC++</A></H4>

<P>
<STRONG>Note:</STRONG>
VC++ workspace files for MySQL 4.1 and above are compatible with
Microsoft Visual Studio 6.0 and above (7.0/.NET) editions and tested
by MySQL AB staff before each release.

</P>
<P>
Follow this procedure to build MySQL:

</P>

<OL>
<LI>

Create a work directory (for example, <TT>`C:\workdir'</TT>).
<LI>

Unpack the source distribution in the aforementioned directory using
<CODE>WinZip</CODE> or other Windows tool that can read <TT>`.zip'</TT> files.
<LI>

Start the VC++ 6.0 compiler.
<LI>

In the <CODE>File</CODE> menu, select <CODE>Open Workspace</CODE>.
<LI>

Open the <TT>`mysql.dsw'</TT> workspace you find in the work directory.
<LI>

From the <CODE>Build</CODE> menu,
select the <CODE>Set Active Configuration</CODE> menu.
<LI>

Click over the screen selecting <CODE>mysqld - Win32 Debug</CODE>
and click OK.
<LI>

Press <CODE>F7</CODE> to begin the build of the debug server, libraries, and
some client applications.
<LI>

Compile the release versions that you want in the same way.
<LI>

Debug versions of the programs and libraries are placed in the
<TT>`client_debug'</TT> and <TT>`lib_debug'</TT> directories.
Release versions of the programs and libraries are placed in the
<TT>`client_release'</TT> and <TT>`lib_release'</TT> directories.
Note that if you want to build both debug and release versions,
you can select the <CODE>Build All</CODE> option from the <CODE>Build</CODE> menu.
<LI>

Test the server.  The server built using the preceding instructions
will expect that the MySQL base directory and data directory are
<TT>`C:\mysql'</TT> and <TT>`C:\mysql\data'</TT> by default. If you want
to test your server using the source tree root directory and its
data directory as the base directory and data directory, you will
need to tell the server their pathnames. You can either do this on
the command line with the <CODE>--basedir</CODE> and <CODE>--datadir</CODE>
options, or place appropriate options in an option file (the <TT>`my.ini'</TT>
file in your Windows directory or <TT>`C:\my.cnf'</TT>).  If you have
an existing data directory elsewhere that you want to use, you can
specify its pathname instead.
<LI>

Start your server from the <TT>`client_release'</TT> or <TT>`client_debug'</TT>
directory, depending on which server you want to use. The
general server startup instructions are at section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.
You'll need to adapt the instructions appropriately if you
want to use a different base directory or data directory.
<LI>

When the server is running in standalone fashion or as a service
based on your configuration, try to connect to it from the <CODE>mysql</CODE>
interactive command-line utility that exists in your <TT>`client_release'</TT>
or <TT>`client_debug'</TT> directory.

</OL>

<P>
When you are satisfied that the programs you have built are working
correctly, stop the server. Then install MySQL as follows:

</P>

<OL>
<LI>

Create the directories where you want to install MySQL.  For example,
to install into
<TT>`C:\mysql'</TT>, use these commands:


<PRE>
C:\&#62; mkdir C:\mysql
C:\&#62; mkdir C:\mysql\bin
C:\&#62; mkdir C:\mysql\data
C:\&#62; mkdir C:\mysql\share
C:\&#62; mkdir C:\mysql\scripts
</PRE>

If you want to compile other clients and link them to MySQL, you should
also create several additional directories:


<PRE>
C:\&#62; mkdir C:\mysql\include
C:\&#62; mkdir C:\mysql\lib
C:\&#62; mkdir C:\mysql\lib\debug
C:\&#62; mkdir C:\mysql\lib\opt
</PRE>

If you want to benchmark MySQL, create this directory:


<PRE>
C:\&#62; mkdir C:\mysql\sql-bench
</PRE>

Benchmarking requires Perl support.

<LI>

From the <TT>`workdir'</TT> directory, copy into the <CODE>C:\mysql</CODE> directory the
following directories:


<PRE>
C:\&#62; cd \workdir
C:\workdir&#62; copy client_release\*.exe C:\mysql\bin
C:\workdir&#62; copy client_debug\mysqld.exe C:\mysql\bin\mysqld-debug.exe
C:\workdir&#62; xcopy scripts\*.* C:\mysql\scripts /E
C:\workdir&#62; xcopy share\*.* C:\mysql\share /E
</PRE>

If you want to compile other clients and link them to MySQL, you should
also copy several libraries and header files:


<PRE>
C:\workdir&#62; copy lib_debug\mysqlclient.lib C:\mysql\lib\debug
C:\workdir&#62; copy lib_debug\libmysql.* C:\mysql\lib\debug
C:\workdir&#62; copy lib_debug\zlib.* C:\mysql\lib\debug
C:\workdir&#62; copy lib_release\mysqlclient.lib C:\mysql\lib\opt
C:\workdir&#62; copy lib_release\libmysql.* C:\mysql\lib\opt
C:\workdir&#62; copy lib_release\zlib.* C:\mysql\lib\opt
C:\workdir&#62; copy include\*.h C:\mysql\include
C:\workdir&#62; copy libmysql\libmysql.def C:\mysql\include
</PRE>

If you want to benchmark MySQL, you should also do this:


<PRE>
C:\workdir&#62; xcopy sql-bench\*.* C:\mysql\bench /E
</PRE>

</OL>

<P>
Set up and start the server in the same way as for the binary
Windows distribution.
See section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.

</P>



<H4><A NAME="Windows_BitKeeper_Build" HREF="manual_toc.html#Windows_BitKeeper_Build">2.3.6.2  Creating a Windows Source Package from the Latest Development Source</A></H4>

<P>
To create a Windows source package from the current
BitKeeper source tree, use the following instructions. Please
note that this procedure must be performed on a system
running a Unix or Unix-like operating system.  For example, the procedure
is known to work well on Linux.

</P>

<OL>
<LI>

Clone the BitKeeper source tree for MySQL (version 4.1 or above,
as desired).  For more information on how to clone the source tree,
see the instructions at section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.

<LI>

Configure and build the distribution so that you have a server
binary to work with.  One way to do this is to run the following
command in the top-level directory of your source tree:


<PRE>
shell&#62; ./BUILD/compile-pentium-max
</PRE>

<LI>

After making sure that the build process completed successfully,
run the following utility script from top-level directory of your
source tree:


<PRE>
shell&#62; ./scripts/make_win_src_distribution
</PRE>

This script creates a Windows source package to be used on your
Windows system.  You can supply different options to the script
based on your needs. It accepts the following options:

<DL COMPACT>

<DT><CODE>--help</CODE>
<DD>
Show this help message.

<DT><CODE>--debug</CODE>
<DD>
Print information about script operations, do not create package.

<DT><CODE>--tmp</CODE>
<DD>
Specify the temporary location.

<DT><CODE>--suffix</CODE>
<DD>
Suffix name for the package.

<DT><CODE>--dirname</CODE>
<DD>
Directory name to copy files (intermediate).

<DT><CODE>--silent</CODE>
<DD>
Do not print verbose list of files processed.

<DT><CODE>--tar</CODE>
<DD>
Create <TT>`tar.gz'</TT> package instead of <TT>`.zip'</TT> package.
</DL>

By default, <CODE>make_win_src_distribution</CODE> creates a Zip-format
archive with the name <TT>`mysql-VERSION-win-src.zip'</TT>, where
<CODE>VERSION</CODE> represents the version of your MySQL source tree.
 
<LI>

Copy or upload to your Windows machine the Windows source package
that you have just created. To compile it, use the instructions in
section <A HREF="manual.html#Windows_VC++_Build">2.3.6.1  Building MySQL Using VC++</A>.

</OL>



<H3><A NAME="Windows_client_compiling" HREF="manual_toc.html#Windows_client_compiling">2.3.7  Compiling MySQL Clients on Windows</A></H3>

<P>
<A NAME="IDX297"></A>
<A NAME="IDX298"></A>

</P>
<P>
In your source files, you should include <TT>`my_global.h'</TT> before
<TT>`mysql.h'</TT>:

</P>

<PRE>
#include &#60;my_global.h&#62;
#include &#60;mysql.h&#62;
</PRE>

<P>
<TT>`my_global.h'</TT> includes any other files needed for Windows compatibility
(such as <TT>`windows.h'</TT>) if you compile your program on Windows.

</P>
<P>
You can either link your code with the dynamic <TT>`libmysql.lib'</TT> library,
which is just a wrapper to load in <TT>`libmysql.dll'</TT> on demand, or link
with the static <TT>`mysqlclient.lib'</TT> library.

</P>
<P>
The MySQL client libraries are compiled as threaded
libraries, so you should also compile your code to be multi-threaded.

</P>



<H2><A NAME="Post-installation" HREF="manual_toc.html#Post-installation">2.4  Post-Installation Setup and Testing</A></H2>

<P>
<A NAME="IDX299"></A>
<A NAME="IDX300"></A>
<A NAME="IDX301"></A>

</P>
<P>
After installing MySQL, there are some issues you should address.  For
example, on Unix, you should initialize the data directory and create the
MySQL grant tables.  On all platforms, an important security concern is that
the initial accounts in the grant tables have no passwords.  You should
assign passwords to prevent unauthorized access to the MySQL server.

</P>
<P>
The following sections include post-installation procedures that are specific
to Windows systems and to Unix systems. Another section, section <A HREF="manual.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A>, applies to all platforms; it describes what to do if you have
trouble getting the server to start.  section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A> also applies
to all platforms. You should follow its instructions to make sure that you
have properly protected your MySQL accounts by assigning passwords to them.

</P>
<P>
When you are ready to create additional user accounts, you can find
information on the MySQL access control system and account management in
section <A HREF="manual.html#Privilege_system">5.4  The MySQL Access Privilege System</A> and section <A HREF="manual.html#User_Account_Management">5.5  MySQL User Account Management</A>.

</P>



<H3><A NAME="Windows_post-installation" HREF="manual_toc.html#Windows_post-installation">2.4.1  Windows Post-Installation Procedures</A></H3>

<P>
On Windows, the data directory and the grant tables do not have to be
created. MySQL Windows distributions include the grant tables already set up
with a set of preinitialized accounts in the <CODE>mysql</CODE> database under the
data directory.  However, you should assign passwords to the accounts.
The procedure for this is given in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.

</P>
<P>
Before setting up passwords, you might want to try running some client
programs to make sure that you can connect to the server and that it is
operating properly.  Make sure the server is running (see section <A HREF="manual.html#Windows_server_first_start">2.2.1.5  Starting the Server for the First Time</A>), then issue the following commands to verify that you can
retrieve information from the server.  The output should be similar to
what is shown here:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqlshow
+-----------+
| Databases |
+-----------+
| mysql     |
| test      |
+-----------+

C:\&#62; C:\mysql\bin\mysqlshow mysql
Database: mysql
+--------------+
|    Tables    |
+--------------+
| columns_priv |
| db           |
| func         |
| host         |
| tables_priv  |
| user         |
+--------------+

C:\&#62; C:\mysql\bin\mysql -e "SELECT Host,Db,User FROM db" mysql
+------+-------+------+
| host | db    | user |
+------+-------+------+
| %    | test% |      |
+------+-------+------+
</PRE>

<P>
If you are running a version of WIndows that supports services and you want
the MySQL server to run automatically when Windows starts, see section <A HREF="manual.html#NT_start">2.2.1.7  Starting MySQL as a Windows Service</A>.

</P>



<H3><A NAME="Unix_post-installation" HREF="manual_toc.html#Unix_post-installation">2.4.2  Unix Post-Installation Procedures</A></H3>

<P>
After installing MySQL on Unix, you need to initialize the grant tables,
start the server, and make sure that the server works okay.  You may also
wish to arrange for the server to be started and stopped automatically when
your system starts and stops.  You should also assign passwords to the
accounts in the grant tables.

</P>
<P>
On Unix, the grant tables are set up by the <CODE>mysql_install_db</CODE> program.
For some installation methods, this program is run for you automatically:

</P>

<UL>
<LI>

If you install MySQL on Linux using RPM distributions, the server RPM runs
<CODE>mysql_install_db</CODE>.
<LI>

If you install MySQL on Mac OS X using a PKG distribution, the installer runs
<CODE>mysql_install_db</CODE>.
</UL>

<P>
Otherwise, you'll need to run <CODE>mysql_install_db</CODE> yourself.

</P>
<P>
The following procedure describes how to initialize the grant tables (if
that has not already been done) and then start the server. It also suggests
some commands that you can use to test whether the server is accessible
and working properly.  For information about starting and stopping the
server automatically, see section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.

</P>
<P>
After you complete the procedure and have the server running, you should
assign passwords to the accounts created by <CODE>mysql_install_db</CODE>.
Instructions for doing so are given in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.

</P>
<P>
In the examples shown here, the server runs under the user ID of the
<CODE>mysql</CODE> login account. This assumes that such an account exists.
Either create the account if it does not exist, or substitute the name of a
different existing login account that you plan to use for running the
server.

</P>
<P>
<A NAME="IDX302"></A>
<A NAME="IDX303"></A>
<A NAME="IDX304"></A>

</P>

<OL>
<LI>

Change location into the top-level directory of your MySQL installation,
represented here by <CODE>BASEDIR</CODE>:


<PRE>
shell&#62; cd BASEDIR
</PRE>

<CODE>BASEDIR</CODE> is likely to be something like <TT>`/usr/local/mysql'</TT> or
<TT>`/usr/local'</TT>.  The following steps assume that you are located in this
directory.

<LI>

If necessary, run the <CODE>mysql_install_db</CODE> program to set up the initial
MySQL grant tables containing the privileges that determine how users are
allowed to connect to the server. You'll need to do this if you used a
distribution type that doesn't run the program for you.

Typically, <CODE>mysql_install_db</CODE> needs to be run only the first time you
install MySQL, so you can skip this step if you are upgrading an existing
installation, However, <CODE>mysql_install_db</CODE> does not overwrite any
existing privilege tables, so it should be safe to run in any circumstances.

To initialize the grant tables, use one of the following commands,
depending on whether <CODE>mysql_install_db</CODE> is located in the <CODE>bin</CODE>
or <CODE>scripts</CODE> directory:


<PRE>
shell&#62; bin/mysql_install_db --user=mysql
shell&#62; scripts/mysql_install_db --user=mysql
</PRE>

The <CODE>mysql_install_db</CODE> script creates the data directory, the
<CODE>mysql</CODE> database that holds all database privileges, and the <CODE>test</CODE>
database that you can use to test MySQL. The script also creates privilege
table entries for <CODE>root</CODE> accounts and anonymous-user accounts.
The accounts have no passwords initially.  A description of their initial
privileges is given in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.  Briefly, these privileges
allow the MySQL <CODE>root</CODE> user to do anything, and allow anybody to create
or use databases with a name of <CODE>test</CODE> or starting with <CODE>test_</CODE>.

It is important to make sure that the database directories and files are
owned by the <CODE>mysql</CODE> login account so that the server has read and
write access to them when you run it later. To ensure this, the <CODE>--user</CODE>
option should be used as shown if you run <CODE>mysql_install_db</CODE> as
<CODE>root</CODE>. Otherwise, you should execute the script while logged in as
<CODE>mysql</CODE>, in which case you can omit the <CODE>--user</CODE> option from the
command.

<CODE>mysql_install_db</CODE> creates several tables in the <CODE>mysql</CODE> database:
<CODE>user</CODE>, <CODE>db</CODE>, <CODE>host</CODE>, <CODE>tables_priv</CODE>,
<CODE>columns_priv</CODE>, <CODE>func</CODE>, and possibly others depending on your
version of MySQL.

If you don't want to have the <CODE>test</CODE> database, you can remove it with
<CODE>mysqladmin -u root drop test</CODE> after starting the server.

If you have problems with <CODE>mysql_install_db</CODE>, see
section <A HREF="manual.html#mysql_install_db">2.4.2.1  Problems Running <CODE>mysql_install_db</CODE></A>.

There are some alternatives to running the <CODE>mysql_install_db</CODE>
script as it is provided in the MySQL distribution:

<A NAME="IDX305"></A>
<A NAME="IDX306"></A>


<UL>
<LI>

If you want the initial privileges to be different from the standard
defaults, you can modify <CODE>mysql_install_db</CODE> before you run it.
However, a preferable technique is to use <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> to
change the privileges after the grant tables have been set up.  In other
words, you can run <CODE>mysql_install_db</CODE>, and then use <CODE>mysql -u root
mysql</CODE> to connect to the server as the MySQL <CODE>root</CODE> user so that you
can issue the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements.

If you want to install MySQL on a lot of machines with the
same privileges, you can put the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements in
a file and execute the file as a script using <CODE>mysql</CODE> after running
<CODE>mysql_install_db</CODE>. For example:


<PRE>
shell&#62; bin/mysql_install_db --user=mysql
shell&#62; bin/mysql -u root &#60; your_script_file
</PRE>

By doing this, you can avoid having to issue the statements manually on each
machine.

<LI>

It is possible to re-create the grant tables completely after they have
already been created.  You might want to do this if you're just learning how
to use <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> and have made so many modifications
after running <CODE>mysql_install_db</CODE> that you want to wipe out the tables
and start over.

To re-create the grant tables, remove all the <TT>`.frm'</TT>, <TT>`.MYI'</TT>, and
<TT>`.MYD'</TT> files in the directory containing the <CODE>mysql</CODE> database.
(This is the directory named <TT>`mysql'</TT> under the data directory, which is
listed as the <CODE>datadir</CODE> value when you run <CODE>mysqld --help</CODE>.) Then
run the <CODE>mysql_install_db</CODE> script again.

<STRONG>Note:</STRONG> For MySQL versions older than 3.22.10, you should not
delete the <TT>`.frm'</TT> files.  If you accidentally do this, you should copy
them back into the <TT>`mysql'</TT> directory from your MySQL distribution
before running <CODE>mysql_install_db</CODE>.

<LI>

You can start <CODE>mysqld</CODE> manually using the <CODE>--skip-grant-tables</CODE>
option and add the privilege information yourself using <CODE>mysql</CODE>:


<PRE>
shell&#62; bin/mysqld_safe --user=mysql --skip-grant-tables &#38;
shell&#62; bin/mysql mysql
</PRE>

From <CODE>mysql</CODE>, manually execute the SQL commands contained in
<CODE>mysql_install_db</CODE>.  Make sure that you run <CODE>mysqladmin
flush-privileges</CODE> or <CODE>mysqladmin reload</CODE> afterward to tell the server to
reload the grant tables.

Note that by not using <CODE>mysql_install_db</CODE>, you not only have to
populate the grant tables manually, you also have to create them first.
</UL>

<LI>

Start the MySQL server:


<PRE>
shell&#62; bin/mysqld_safe --user=mysql &#38;
</PRE>

For versions of MySQL older than 4.0, substitute <CODE>bin/safe_mysqld</CODE>
for <CODE>bin/mysqld_safe</CODE> in this command.

It is important that the MySQL server be run using an unprivileged
(non-<CODE>root</CODE>) login account.  To ensure this, the <CODE>--user</CODE>
option should be used as shown if you run <CODE>mysql_safe</CODE> as
<CODE>root</CODE>. Otherwise, you should execute the script while logged in as
<CODE>mysql</CODE>, in which case you can omit the <CODE>--user</CODE> option from the
command.

Further instructions for running MySQL as an unprivileged user are given in
section <A HREF="manual.html#Changing_MySQL_user">A.3.2  How to Run MySQL as a Normal User</A>.

If you neglected to create the grant tables before proceeding to this step,
the following message will appear in the error log file when you start the
server:

<A NAME="IDX307"></A>

<PRE>
mysqld: Can't find file: 'host.frm'
</PRE>

If you have other problems starting the server, see section <A HREF="manual.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A>.

<LI>

Use <CODE>mysqladmin</CODE> to verify that the server is running.  The following
commands provide simple tests to check whether the server is up and responding
to connections:


<PRE>
shell&#62; bin/mysqladmin version
shell&#62; bin/mysqladmin variables
</PRE>

The output from <CODE>mysqladmin version</CODE> varies slightly depending on your
platform and version of MySQL, but should be similar to that shown here:


<PRE>
shell&#62; bin/mysqladmin version
mysqladmin  Ver 8.40 Distrib 4.0.18, for linux on i586
Copyright (C) 2000 MySQL AB &#38; MySQL Finland AB &#38; TCX DataKonsult AB
This software comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to modify and redistribute it under the GPL license

Server version          4.0.18-log
Protocol version        10
Connection              Localhost via Unix socket
TCP port                3306
UNIX socket             /tmp/mysql.sock
Uptime:                 16 sec

Threads: 1  Questions: 9  Slow queries: 0
Opens: 7  Flush tables: 2  Open tables: 0
Queries per second avg: 0.000
Memory in use: 132K  Max memory used: 16773K
</PRE>

To see what else you can do with <CODE>mysqladmin</CODE>,
invoke it with the <CODE>--help</CODE> option.

<LI>

Verify that you can shut down the server:
<A NAME="IDX308"></A>
<A NAME="IDX309"></A>


<PRE>
shell&#62; bin/mysqladmin -u root shutdown
</PRE>

<LI>

Verify that you can restart the server.  Do this by using <CODE>mysqld_safe</CODE> or
by invoking <CODE>mysqld</CODE> directly.  For example:

<A NAME="IDX310"></A>
<A NAME="IDX311"></A>


<PRE>
shell&#62; bin/mysqld_safe --user=mysql --log &#38;
</PRE>

If <CODE>mysqld_safe</CODE> fails, see section <A HREF="manual.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A>.

<LI>

Run some simple tests to verify that you can retrieve information from the
server.  The output should be similar to what is shown here:


<PRE>
shell&#62; bin/mysqlshow
+-----------+
| Databases |
+-----------+
| mysql     |
| test      |
+-----------+

shell&#62; bin/mysqlshow mysql
Database: mysql
+--------------+
|    Tables    |
+--------------+
| columns_priv |
| db           |
| func         |
| host         |
| tables_priv  |
| user         |
+--------------+

shell&#62; bin/mysql -e "SELECT Host,Db,User FROM db" mysql
+------+--------+------+
| host | db     | user |
+------+--------+------+
| %    | test   |      |
| %    | test_% |      |
+------+--------+------+
</PRE>

<LI>

There is a benchmark suite in the <TT>`sql-bench'</TT> directory (under the
MySQL installation directory) that you can use to compare how
MySQL performs on different platforms. The benchmark suite is written in
Perl. It uses the Perl DBI module to provide a database-independent interface
to the various databases, and some other additional Perl modules are required
to run the benchmark suite. You must have the following modules installed:


<PRE>
DBI
DBD::mysql
Data::Dumper
Data::ShowTable
</PRE>

These modules can be obtained from CPAN <a HREF="http://www.cpan.org/">http://www.cpan.org/</a>.
See section <A HREF="manual.html#Perl_installation">2.7.1  Installing Perl on Unix</A>.

The <TT>`sql-bench/Results'</TT> directory contains the results from many runs
against different databases and platforms.  To run all tests, execute these
commands:


<PRE>
shell&#62; cd sql-bench
shell&#62; perl run-all-tests
</PRE>

If you don't have the <TT>`sql-bench'</TT> directory, you probably installed MySQL
using RPM files other than the source RPM.  (The source RPM includes the
<TT>`sql-bench'</TT> benchmark directory.)  In this case, you must first install
the benchmark suite before you can use it.  Beginning with MySQL 3.22,
there are separate benchmark RPM files named
<TT>`mysql-bench-VERSION-i386.rpm'</TT> that contain benchmark code and data.

If you have a source distribution, there are also tests in its <TT>`tests'</TT>
subdirectory that you can run. For example, to run <TT>`auto_increment.tst'</TT>,
execute this command from the top-level directory of your source distribution:


<PRE>
shell&#62; mysql -vvf test &#60; ./tests/auto_increment.tst
</PRE>

The expected result of the test can be found in the
<TT>`./tests/auto_increment.res'</TT> file.

<LI>

At this point, you should have the server running. However, none of the
initial MySQL accounts have a password, so you should assign passwords
using the instructions in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.
</OL>



<H4><A NAME="mysql_install_db" HREF="manual_toc.html#mysql_install_db">2.4.2.1  Problems Running <CODE>mysql_install_db</CODE></A></H4>
<P>
<A NAME="IDX312"></A>
<A NAME="IDX313"></A>

</P>
<P>
The purpose of the <CODE>mysql_install_db</CODE> script is to generate new MySQL
privilege tables.  It will not overwrite existing MySQL privilege tables,
and it will not affect any other data.

</P>
<P>
If you want to re-create your privilege tables, first stop
the <CODE>mysqld</CODE> server if it's running. Then rename the <TT>`mysql'</TT>
directory under the data directory to save it, and then run
<CODE>mysql_install_db</CODE>.  For example:

</P>

<PRE>
shell&#62; mv mysql-data-directory/mysql mysql-data-directory/mysql-old
shell&#62; mysql_install_db --user=mysql
</PRE>

<P>
This section lists problems you might encounter when you run
<CODE>mysql_install_db</CODE>:

</P>
<DL COMPACT>

<DT><STRONG><CODE>mysql_install_db</CODE> doesn't install the grant tables</STRONG>
<DD>
You may find that <CODE>mysql_install_db</CODE> fails to install the grant
tables and terminates after displaying the following messages:


<PRE>
Starting mysqld daemon with databases from XXXXXX
mysqld ended
</PRE>

In this case, you should examine the error log file very carefully.  The log
should be located in the directory <TT>`XXXXXX'</TT> named by the error message,
and should indicate why <CODE>mysqld</CODE> didn't start.  If you don't understand
what happened, include the log when you post a bug report.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

<DT><STRONG>There is already a <CODE>mysqld</CODE> process running</STRONG>
<DD>
This indicates that the server is already running, in which case the grant
tables probably have already been created. If so, you don't have to run
<CODE>mysql_install_db</CODE> at all because it need be run only once (when you
install MySQL the first time).

<DT><STRONG>Installing a second <CODE>mysqld</CODE> server doesn't work when one server is running</STRONG>
<DD>
This can happen when you already have an existing MySQL installation, but
want to put a new installation in a different location.  For example, you
might have a production installation already, but you want to create a
second installation for testing purposes.  Generally the problem that occurs
when you try to run a second server is that it tries to use a network
interface that is already in use by the first server.  In this case, you
will see one of the following error messages:


<PRE>
Can't start server: Bind on TCP/IP port:
Address already in use
Can't start server: Bind on unix socket...
</PRE>

For instructions on setting up multiple servers, see section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A>.

<DT><STRONG>You don't have write access to <TT>`/tmp'</TT></STRONG>
<DD>
<A NAME="IDX314"></A>
<A NAME="IDX315"></A>
<A NAME="IDX316"></A>

If you don't have write access to create temporary files or a Unix socket
file in the default location (the <TT>`/tmp'</TT> directory), an error will
occur when you run <CODE>mysql_install_db</CODE> or the <CODE>mysqld</CODE> server.

You can specify different temporary directory and Unix socket file locations
by executing these commands prior to starting <CODE>mysql_install_db</CODE> or
<CODE>mysqld</CODE>:

<A NAME="IDX317"></A>
<A NAME="IDX318"></A>
<A NAME="IDX319"></A>
<A NAME="IDX320"></A>

<PRE>
shell&#62; TMPDIR=/some_tmp_dir/
shell&#62; MYSQL_UNIX_PORT=/some_tmp_dir/mysql.sock
shell&#62; export TMPDIR MYSQL_UNIX_PORT
</PRE>

<TT>`some_tmp_dir'</TT> should be the full pathname to some directory for which you
have write permission.

After this, you should be able to run <CODE>mysql_install_db</CODE> and start
the server with these commands:


<PRE>
shell&#62; scripts/mysql_install_db --user=mysql
shell&#62; bin/mysqld_safe --user=mysql &#38;
</PRE>

If <CODE>mysql_install_db</CODE> is located in <TT>`bin'</TT>, modify the first command
to use <CODE>bin/mysql_install_db</CODE>.

See section <A HREF="manual.html#Problems_with_mysql.sock">A.4.5  How to Protect or Change the MySQL Socket File <TT>`/tmp/mysql.sock'</TT></A>.
See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</DL>



<H4><A NAME="Automatic_start" HREF="manual_toc.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A></H4>

<P>
<A NAME="IDX321"></A>
<A NAME="IDX322"></A>
<A NAME="IDX323"></A>

</P>
<P>
Generally, you start the <CODE>mysqld</CODE> server in one of these ways:

</P>

<UL>

<LI>

By invoking <CODE>mysqld</CODE> directly. This works on any platform.

<LI>

By running the MySQL server as a Windows service.
This can be done on versions of Windows that support services (such as
NT, 2000, and XP). The service can be set to start the server automatically
when Windows starts, or as a manual service that you start on request.
For instructions, see section <A HREF="manual.html#NT_start">2.2.1.7  Starting MySQL as a Windows Service</A>.

<LI>

By invoking <CODE>mysqld_safe</CODE>, which tries to determine the proper options
for <CODE>mysqld</CODE> and then runs it with those options.  This script is
used on systems based on BSD Unix.
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

<LI>

By invoking <CODE>mysql.server</CODE>.  This script is used primarily at
system startup and shutdown on systems that use System V-style run
directories, where it usually is installed under the name <CODE>mysql</CODE>.
The <CODE>mysql.server</CODE> script starts the server by invoking <CODE>mysqld_safe</CODE>.
See section <A HREF="manual.html#mysql.server">5.1.4  The <CODE>mysql.server</CODE> Server Startup Script</A>.

<LI>

On Mac OS X, you can install a separate MySQL Startup Item package to
enable the automatic startup of MySQL on system startup.
The Startup Item starts the server by invoking <CODE>mysql.server</CODE>.
See section <A HREF="manual.html#Mac_OS_X_installation">2.2.3  Installing MySQL on Mac OS X</A> for details.

</UL>

<P>
The <CODE>mysql.server</CODE> and <CODE>mysqld_safe</CODE> scripts and the Mac OS X
Startup Item can be used to start the server manually, or automatically at
system startup time. <CODE>mysql.server</CODE> and the Startup Item also can be
used to stop the server.

</P>
<P>
To start or stop the server manually using the <CODE>mysql.server</CODE> script,
invoke it with <CODE>start</CODE> or <CODE>stop</CODE> arguments:

</P>

<PRE>
shell&#62; mysql.server start
shell&#62; mysql.server stop
</PRE>

<P>
Before <CODE>mysql.server</CODE> starts the server, it changes location to the
MySQL installation directory, and then invokes <CODE>mysqld_safe</CODE>.  If you
want the server to run as some specific user, add an appropriate <CODE>user</CODE>
option to the <CODE>[mysqld]</CODE> group of the <TT>`/etc/my.cnf'</TT> option file,
as shown later in this section.
(It is possible that you'll need to edit <CODE>mysql.server</CODE>
if you've installed a binary distribution of MySQL in a non-standard
location.  Modify it to <CODE>cd</CODE> into the proper directory before it runs
<CODE>mysqld_safe</CODE>.  If you do this, your modified version of
<CODE>mysql.server</CODE> may be overwritten if you upgrade MySQL in the future,
so you should make a copy of your edited version that you can reinstall.)

</P>
<P>
<CODE>mysql.server stop</CODE> brings down the server by sending a signal to it.
You can also stop the server manually by executing <CODE>mysqladmin
shutdown</CODE>.

</P>
<P>
To start and stop MySQL automatically on your server, you need to add start
and stop commands to the appropriate places in your <TT>`/etc/rc*'</TT> files.

</P>
<P>
If you use the Linux server RPM package (<CODE>MySQL-server-VERSION.rpm</CODE>),
the <CODE>mysql.server</CODE> script will already have been installed in the
<TT>`/etc/init.d'</TT> directory with the name <TT>`mysql'</TT>. You need not
install it manually. See section <A HREF="manual.html#Linux-RPM">2.2.2  Installing MySQL on Linux</A> for more information on the Linux
RPM packages.

</P>
<P>
Some vendors provide RPM packages that install a startup script under a
different name such as <CODE>mysqld</CODE>.

</P>
<P>
If you install MySQL from a source distribution or using a binary
distribution format that does not install <CODE>mysql.server</CODE> automatically,
you can install it manually. The script can be found in the
<TT>`support-files'</TT> directory under the MySQL installation directory or in
a MySQL source tree.

</P>
<P>
To install <CODE>mysql.server</CODE> manually, copy it to the <TT>`/etc/init.d'</TT>
directory with the name <CODE>mysql</CODE>, and then make it executable.  Do this
by changing location into the appropriate directory where
<CODE>mysql.server</CODE> is located and executing these commands:

</P>

<PRE>
shell&#62; cp mysql.server /etc/init.d/mysql
shell&#62; chmod +x /etc/init.d/mysql
</PRE>

<P>
Older Red Hat systems use the <TT>`/etc/rc.d/init.d'</TT> directory rather than
<TT>`/etc/init.d'</TT>. Adjust the preceding commands accordingly. Alternatively,
first create <TT>`/etc/init.d'</TT> as a symbolic link that points to
<TT>`/etc/rc.d/init.d'</TT>:

</P>

<PRE>
shell&#62; cd /etc
shell&#62; ln -s rc.d/init.d .
</PRE>

<P>
After installing the script, the commands needed to activate it to run
at system startup depend on your operating system.  On Linux, you can use
<CODE>chkconfig</CODE>:

</P>

<PRE>
shell&#62; chkconfig --add mysql
</PRE>

<P>
On some Linux systems, the following command also seems to be necessary to
fully enable the <CODE>mysql</CODE> script:

</P>

<PRE>
shell&#62; chkconfig --level 345 mysql on
</PRE>

<P>
On FreeBSD, startup scripts generally should go in
<TT>`/usr/local/etc/rc.d/'</TT>. The <CODE>rc(8)</CODE> manual page states that
scripts in this directory are executed only if their basename matches the
<CODE>*.sh</CODE> shell filename pattern.  Any other files or directories present
within the directory are silently ignored. In other words, on FreeBSD, you
should install the <TT>`mysql.server'</TT> script as
<TT>`/usr/local/etc/rc.d/mysql.server.sh'</TT> to enable automatic startup.

</P>
<P>
As an alternative to the preceding setup, some operating systems also use
<TT>`/etc/rc.local'</TT> or <TT>`/etc/init.d/boot.local'</TT> to start additional
services on startup. To start up MySQL using this method, you could append
a command like the one following to the appropriate startup file:

</P>

<PRE>
/bin/sh -c 'cd /usr/local/mysql; ./bin/mysqld_safe --user=mysql &#38;'
</PRE>

<P>
For other systems, consult your operating system documentation to see how
to install startup scripts.

</P>
<P>
<A NAME="IDX324"></A>
You can add options for <CODE>mysql.server</CODE> in a global
<TT>`/etc/my.cnf'</TT> file.  A typical <TT>`/etc/my.cnf'</TT> file might look like
this:

</P>

<PRE>
[mysqld]
datadir=/usr/local/mysql/var
socket=/var/tmp/mysql.sock
port=3306
user=mysql

[mysql.server]
basedir=/usr/local/mysql
</PRE>

<P>
The <CODE>mysql.server</CODE> script understands the following options:
<CODE>basedir</CODE>, <CODE>datadir</CODE>, and <CODE>pid-file</CODE>.  If specified, they
<EM>must</EM> be placed in an option file, not on the command line.
<CODE>mysql.server</CODE> understands only <CODE>start</CODE> and <CODE>stop</CODE> as
command-line arguments.

</P>
<P>
The following table shows which option groups the server and each startup
script read from option files:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Script</STRONG> </TD><TD> <STRONG>Option Groups</STRONG>
</TD></TR>
<TR><TD><CODE>mysqld</CODE> </TD><TD> <CODE>[mysqld]</CODE>, <CODE>[server]</CODE>, <CODE>[mysqld-major-version]</CODE>
</TD></TR>
<TR><TD><CODE>mysql.server</CODE> </TD><TD> <CODE>[mysql.server]</CODE>, <CODE>[mysqld]</CODE>
</TD></TR>
<TR><TD><CODE>mysqld_safe</CODE> </TD><TD> <CODE>[mysqld]</CODE>, <CODE>[server]</CODE>, <CODE>[mysqld_safe]</CODE>
</TD></TR>
</TABLE>

<P>
<CODE>[mysqld-major-version]</CODE> means that groups with names like
<CODE>[mysqld-4.0]</CODE>, <CODE>[mysqld-4.1]</CODE>, and <CODE>[mysqld-5.0]</CODE> will be
read by servers having versions 4.0.x, 4.1.x, 5.0.x, and so forth.  This
feature was added in MySQL 4.0.14. It can be used to specify options that will
be read only by servers within a given release series.

</P>
<P>
For backward compatibility, <CODE>mysql.server</CODE> also reads the
<CODE>[mysql_server]</CODE> group and <CODE>mysqld_safe</CODE> also reads the
<CODE>[safe_mysqld]</CODE> group. However, you should update your option
files to use the <CODE>[mysql.server]</CODE> and <CODE>[mysqld_safe]</CODE> groups instead
when you begin using MySQL 4.0 or later.

</P>
<P>
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>



<H4><A NAME="Starting_server" HREF="manual_toc.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A></H4>
<P>
<A NAME="IDX325"></A>
<A NAME="IDX326"></A>

</P>
<P>
If you have problems starting the server, here are some things you can try:

</P>

<UL>
<LI>

Specify any special options needed by the storage engines you are using.

<LI>

Make sure that the server knows where to find the data directory.

<LI>

Make sure the server can use the data directory.  The ownership and
permissions of the data directory and its contents must be set such that
the server can access and modify them.

<LI>

Check the error log to see why the server doesn't start.

<LI>

Verify that the network interfaces the server wants to use are available.

</UL>

<P>
Some storage engines have options that control their behavior.
You can create a <TT>`my.cnf'</TT> file and set startup options
for the engines you plan to use.
If you are going to use storage engines that support transactional tables
(<CODE>InnoDB</CODE>, <CODE>BDB</CODE>), be sure that you have them configured the
way you want before starting the server:

</P>

<UL>
<LI>

If you are using <CODE>InnoDB</CODE> tables, refer to the <CODE>InnoDB</CODE>-specific
startup options.  In MySQL 3.23, you must configure <CODE>InnoDB</CODE> explicitly
or the server will fail to start.  From MySQL 4.0 on, <CODE>InnoDB</CODE> uses default
values for its configuration options if you specify none.
See section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.

<LI>

If you are using <CODE>BDB</CODE> (Berkeley DB) tables, you should familiarize
yourself with the different <CODE>BDB</CODE>-specific startup options.
See section <A HREF="manual.html#BDB_start">15.4.3  <CODE>BDB</CODE> Startup Options</A>.

</UL>

<P>
When the <CODE>mysqld</CODE> server starts, it changes location to the data
directory.  This is where it expects to find databases and where it expects
to write log files. On Unix, the server also writes the pid (process ID)
file in the data directory.

</P>
<P>
The data directory location is hardwired in when the server is compiled.
This is where the server looks for the data directory by default. If
the data directory is located somewhere else on your system, the server will
not work properly.  You can find out what the default path settings are by
invoking <CODE>mysqld</CODE> with the <CODE>--verbose</CODE> and <CODE>--help</CODE> options.
(Prior to MySQL 4.1, omit the <CODE>--verbose</CODE> option.)

</P>
<P>
If the defaults don't match the MySQL installation layout on your system,
you can override them by specifying options on the command line to
<CODE>mysqld</CODE> or <CODE>mysqld_safe</CODE>. You can also list the options in an
option file.

</P>
<P>
To specify the location of the data directory explicitly, use the
<CODE>--datadir</CODE> option. However, normally you can tell <CODE>mysqld</CODE> the
location of the base directory under which MySQL is installed and it will
look for the data directory there.  You can do this with the <CODE>--basedir</CODE>
option.

</P>
<P>
To check the effect of specifying path options, invoke <CODE>mysqld</CODE> with
those options followed by the <CODE>--verbose</CODE> and <CODE>--help</CODE> options.
For example, if you change location into the directory where <CODE>mysqld</CODE> is
installed, and then run the following command, it
will show the effect of starting the server with a base
directory of <TT>`/usr/local'</TT>:

</P>

<PRE>
shell&#62; ./mysqld --basedir=/usr/local --verbose --help
</PRE>

<P>
You can specify other options such as <CODE>--datadir</CODE> as well, but note
that <CODE>--verbose</CODE> and <CODE>--help</CODE> must be the last options.  (Prior to
MySQL 4.1, omit the <CODE>--verbose</CODE> option.)

</P>
<P>
Once you determine the path settings you want, start the server without
<CODE>--verbose</CODE> and <CODE>--help</CODE>.

</P>
<P>
If <CODE>mysqld</CODE> is currently running, you can find out what path settings
it is using by executing this command:

</P>

<PRE>
shell&#62; mysqladmin variables
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysqladmin -h host_name variables
</PRE>

<P>
<CODE>host_name</CODE> is the name of the server host.

</P>
<P>
If you get <CODE>Errcode 13</CODE> (which means <CODE>Permission denied</CODE>) when
starting <CODE>mysqld</CODE>, this means that the access privileges of the data
directory or its contents do not allow the server access.  In this case, you
change the permissions for the involved files and directories so that the
server has the right to use them.  You can also start the server as
<CODE>root</CODE>, but this can raise security issues and should be avoided.

</P>
<P>
On Unix, change location into the data directory and check the ownership of
the data directory and its contents to make sure the server has access. For
example, if the data directory is <TT>`/usr/local/mysql/var'</TT>, use these
commands:

</P>

<PRE>
shell&#62; cd /usr/local/mysql/var
shell&#62; ls -l
</PRE>

<P>
If the data directory, or files or subdirectories are not owned by the
account that you use for running the server, change their ownership
to that account:

</P>

<PRE>
shell&#62; chown -R mysql .
shell&#62; chgrp -R mysql .
</PRE>

<P>
If the server fails to start up correctly, check the error log file to
see if you can find out why.  Log files are located in the data directory
(typically <TT>`C:\mysql\data'</TT> on Windows, <TT>`/usr/local/mysql/data'</TT>
for a Unix binary distribution, and <TT>`/usr/local/var'</TT> for a Unix source
distribution).  Look in the data directory for files with names of the form
<TT>`host_name.err'</TT> and <TT>`host_name.log'</TT>, where <CODE>host_name</CODE> is the
name of your server host. (Older servers on Windows use <TT>`mysql.err'</TT>
as the error log name.)  Then check the last few lines of these files.
On Unix, you can use <CODE>tail</CODE> to display the last few lines:

</P>

<PRE>
shell&#62; tail host_name.err
shell&#62; tail host_name.log
</PRE>

<P>
The error log contains information that indicates why the server couldn't
start.  For example, you might see something like this in the log:

</P>

<PRE>
000729 14:50:10  bdb:  Recovery function for LSN 1 27595 failed
000729 14:50:10  bdb:  warning: ./test/t1.db: No such file or directory
000729 14:50:10  Can't init databases
</PRE>

<P>
This means that you didn't start <CODE>mysqld</CODE> with the
<CODE>--bdb-no-recover</CODE> option and Berkeley DB found something wrong with
its own log files when it tried to recover your databases.  To be able to
continue, you should move away the old Berkeley DB log files from the
database directory to some other place, where you can later examine them.
The <CODE>BDB</CODE> log files are named in sequence beginning with
<TT>`log.0000000001'</TT>, where the number increases over time.

</P>
<P>
If you are running <CODE>mysqld</CODE> with <CODE>BDB</CODE> table support and
<CODE>mysqld</CODE> dumps core at startup, this could be due to problems with the
<CODE>BDB</CODE> recovery log.  In this case, you can try starting <CODE>mysqld</CODE>
with <CODE>--bdb-no-recover</CODE>.  If that helps, then you should remove
all <CODE>BDB</CODE> log files from the data directory and try starting <CODE>mysqld</CODE>
again without the <CODE>--bdb-no-recover</CODE> option.

</P>
<P>
If either of the following errors occur, it means that some other program
(perhaps another <CODE>mysqld</CODE> server) is already using the TCP/IP port or
Unix socket file that <CODE>mysqld</CODE> is trying to use:

</P>

<PRE>
Can't start server: Bind on TCP/IP port: Address already in use
Can't start server: Bind on unix socket...
</PRE>

<P>
Use <CODE>ps</CODE> to determine whether you have another <CODE>mysqld</CODE> server
running. If so, shut down the server before starting <CODE>mysqld</CODE> again.
(If another server is running, and you really want to run multiple servers,
you can find information about how to do so in section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A>.)

</P>
<P>
If no other server is running, try to execute the command <CODE>telnet
your-host-name tcp-ip-port-number</CODE>.  (The default MySQL port number is
3306.) Then press Enter a couple of times.  If you don't get an error
message like <CODE>telnet: Unable to connect to remote host: Connection
refused</CODE>, some other program is using the TCP/IP port that <CODE>mysqld</CODE> is
trying to use.  You'll need to track down what program this is and disable
it, or else tell <CODE>mysqld</CODE> to listen to a different port with the
<CODE>--port</CODE> option.  In this case, you'll also need to specify the port
number for client programs when connecting to the server via TCP/IP.

</P>
<P>
Another reason the port might be inaccessible is that you have a firewall
running that blocks connections to it. If so, modify the firewall settings to
allow access to the port.

</P>
<P>
If the server starts but you can't connect to it, you should make sure
that you have an entry in <TT>`/etc/hosts'</TT> that looks like this:

</P>

<PRE>
127.0.0.1       localhost
</PRE>

<P>
This problem occurs only on systems that don't have a working thread
library and for which MySQL must be configured to use MIT-pthreads.

</P>
<P>
If you can't get <CODE>mysqld</CODE> to start, you can try to make a trace file
to find the problem by using the <CODE>--debug</CODE> option.
See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

</P>



<H3><A NAME="Default_privileges" HREF="manual_toc.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A></H3>

<P>
<A NAME="IDX327"></A>
<A NAME="IDX328"></A>
<A NAME="IDX329"></A>
<A NAME="IDX330"></A>
<A NAME="IDX331"></A>
<A NAME="IDX332"></A>
<A NAME="IDX333"></A>
<A NAME="IDX334"></A>
<A NAME="IDX335"></A>

</P>
<P>
Part of the MySQL installation process is to set up the <CODE>mysql</CODE> database
containing the grant tables:

</P>

<UL>
<LI>

Windows distributions contain preinitialized grant tables that are installed
automatically.
<LI>

On Unix, the grant tables are populated by the <CODE>mysql_install_db</CODE>
program. Some installation methods run this program for you. Others require
that you execute it manually. For details, see section <A HREF="manual.html#Unix_post-installation">2.4.2  Unix Post-Installation Procedures</A>.
</UL>

<P>
The grant tables define the initial MySQL user accounts and their access
privileges.  These accounts are set up as follows:

</P>

<UL>

<LI>

Two accounts are created with a username of <CODE>root</CODE>.  These are
superuser accounts that can do anything.  The initial <CODE>root</CODE> account
passwords are empty, so anyone can connect to the MySQL server as <CODE>root</CODE>
<EM>without a password</EM> and be granted all privileges.


<UL>

<LI>

On Windows, one <CODE>root</CODE> account is for connecting from the local host
and the other allows connections from any host.

<LI>

On Unix, both <CODE>root</CODE> accounts are for connections from the local host.
Connections must be made from the local host by specifying a hostname of
<CODE>localhost</CODE> for one account, or the actual hostname or IP number for
the other.

</UL>

<LI>

<A NAME="IDX336"></A>
Two anonymous-user accounts are created, each with an empty username.
The anonymous accounts have no passwords, so anyone can use them to connect
to the MySQL server.


<UL>

<LI>

On Windows, one anonymous account is for connections from the local host.
It has all privileges, just like the <CODE>root</CODE> accounts.
The other is for connections from any host and has all privileges for the
<CODE>test</CODE> database or other databases with names that start with <CODE>test</CODE>.

<LI>

On Unix, both anonymous accounts are for connections from the local host.
Connections must be made from the local host by specifying a hostname of
<CODE>localhost</CODE> for one account, or the actual hostname or IP number for
the other.  These accounts have all privileges for the <CODE>test</CODE> database
or other databases with names that start with <CODE>test_</CODE>.

</UL>

</UL>

<P>
As noted, none of the initial accounts have passwords.  This means that
your MySQL installation is unprotected until you do something about it:

</P>

<UL>

<LI>

If you want to prevent clients from connecting as anonymous users without a
password, you should either assign passwords to the anonymous accounts or else
remove them.

<LI>

You should assign passwords to the MySQL <CODE>root</CODE> accounts.

</UL>

<P>
The following instructions describe how to set up passwords for the
initial MySQL accounts, first for the anonymous accounts and then for the
<CODE>root</CODE> accounts.  Replace ``<CODE>newpwd</CODE>'' in the examples with the
actual password that you want to use.  The instructions also cover how
to remove the anonymous accounts, should you prefer not to allow anonymous
access at all.

</P>
<P>
You might want to defer setting the passwords until later, so that you
don't need to specify them while you perform additional setup or testing.
However, be sure to set them before using your installation for any real
production work.

</P>
<P>
To assign passwords to the anonymous accounts, you can use either
<CODE>SET PASSWORD</CODE> or <CODE>UPDATE</CODE>.  In both cases, be sure to encrypt the
password using the <CODE>PASSWORD()</CODE> function.

</P>
<P>
To use <CODE>SET PASSWORD</CODE> on Windows, do this:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; SET PASSWORD FOR ''@'localhost' = PASSWORD('newpwd');
mysql&#62; SET PASSWORD FOR ''@'%' = PASSWORD('newpwd');
</PRE>

<P>
To use <CODE>SET PASSWORD</CODE> on Unix, do this:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; SET PASSWORD FOR ''@'localhost' = PASSWORD('newpwd');
mysql&#62; SET PASSWORD FOR ''@'host_name' = PASSWORD('newpwd');
</PRE>

<P>
In the second <CODE>SET PASSWORD</CODE> statement, replace <CODE>host_name</CODE>
with the name of the server host.  This is the name that is specified in
the <CODE>Host</CODE> column of the non-<CODE>localhost</CODE> record for <CODE>root</CODE>
in the <CODE>user</CODE> table.  If you don't know what hostname this is, issue
the following statement before using <CODE>SET PASSWORD</CODE>:

</P>

<PRE>
mysql&#62; SELECT Host, User FROM mysql.user;
</PRE>

<P>
Look for the record that has <CODE>root</CODE> in the <CODE>User</CODE> column and
something other than <CODE>localhost</CODE> in the <CODE>Host</CODE> column. Then use that
<CODE>Host</CODE> value in the second <CODE>SET PASSWORD</CODE> statement.

</P>
<P>
The other way to assign passwords to the anonymous accounts is by using
<CODE>UPDATE</CODE> to modify the <CODE>user</CODE> table directly.  Connect to the
server as <CODE>root</CODE> and issue an <CODE>UPDATE</CODE> statement that assigns a
value to the <CODE>Password</CODE> column of the appropriate <CODE>user</CODE> table
records.  The procedure is the same for Windows and Unix.  The following
<CODE>UPDATE</CODE> statement assigns a password to both anonymous accounts at
once:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; UPDATE mysql.user SET Password = PASSWORD('newpwd')
    -&#62;     WHERE User = '';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
After you update the passwords in the <CODE>user</CODE> table directly using
<CODE>UPDATE</CODE>, you must tell the server to re-read the grant tables with
<CODE>FLUSH PRIVILEGES</CODE>. Otherwise, the change will go unnoticed until you
restart the server.

</P>
<P>
If you prefer to remove the anonymous accounts instead, do so as follows:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; DELETE FROM mysql.user WHERE User = '';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The <CODE>DELETE</CODE> statement applies both to Windows and to Unix.
On Windows, if you want to remove only the anonymous account that has the same
privileges as <CODE>root</CODE>, do this instead:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; DELETE FROM mysql.user WHERE Host='localhost' AND User='';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
This account allows anonymous access but has full privileges, so removing
it improves security.

</P>
<P>
You can assign passwords to the <CODE>root</CODE> accounts in several ways. The
following discussion demonstrates three methods:

</P>

<UL>
<LI>

Use the <CODE>SET PASSWORD</CODE> statement
<LI>

Use the <CODE>mysqladmin</CODE> command-line client program
<LI>

Use the <CODE>UPDATE</CODE> statement
</UL>

<P>
To assign passwords using <CODE>SET PASSWORD</CODE>, connect to the server as
<CODE>root</CODE> and issue two <CODE>SET PASSWORD</CODE> statements.
Be sure to encrypt the password using the <CODE>PASSWORD()</CODE> function.

</P>
<P>
For Windows, do this:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; SET PASSWORD FOR 'root'@'localhost' = PASSWORD('newpwd');
mysql&#62; SET PASSWORD FOR 'root'@'%' = PASSWORD('newpwd');
</PRE>

<P>
For Unix, do this:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; SET PASSWORD FOR 'root'@'localhost' = PASSWORD('newpwd');
mysql&#62; SET PASSWORD FOR 'root'@'host_name' = PASSWORD('newpwd');
</PRE>

<P>
In the second <CODE>SET PASSWORD</CODE> statement, replace <CODE>host_name</CODE> with
the name of the server host.  This is the same hostname that you used when
you assigned the anonymous account passwords.

</P>
<P>
To assign passwords to the <CODE>root</CODE> accounts using <CODE>mysqladmin</CODE>,
execute the following commands:

</P>

<PRE>
shell&#62; mysqladmin -u root password "newpwd"
shell&#62; mysqladmin -u root -h host_name password "newpwd"
</PRE>

<P>
These commands apply both to Windows and to Unix.  In the second command,
replace <CODE>host_name</CODE> with the name of the server host.  The double
quotes around the password are not always necessary, but you should use
them if the password contains spaces or other characters that are special
to your command interpreter.

</P>
<P>
If you are using a server from a <EM>very</EM> old version of MySQL, the
<CODE>mysqladmin</CODE> commands to set the password will fail with the message
<CODE>parse error near 'SET password'</CODE>.  The solution to this problem is
to upgrade the server to a newer version of MySQL.

</P>
<P>
You can also use <CODE>UPDATE</CODE> to modify the <CODE>user</CODE> table directly.
The following <CODE>UPDATE</CODE> statement assigns a password to both <CODE>root</CODE>
accounts at once:

</P>

<PRE>
shell&#62; mysql -u root
mysql&#62; UPDATE mysql.user SET Password = PASSWORD('newpwd')
    -&#62;     WHERE User = 'root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The <CODE>UPDATE</CODE> statement applies both to Windows and to Unix.

</P>
<P>
After the passwords have been set, you must supply the appropriate
password whenever you connect to the server.
For example, if you want to use <CODE>mysqladmin</CODE> to shut
down the server, you can do so using this command:

</P>

<PRE>
shell&#62; mysqladmin -u root -p shutdown
Enter password: (enter root password here)
</PRE>

<P>
<STRONG>Note:</STRONG> If you forget your <CODE>root</CODE> password after setting it up,
the procedure for resetting it is covered in section <A HREF="manual.html#Resetting_permissions">A.4.1  How to Reset the Root Password</A>.

</P>
<P>
To set up new accounts, you can use the <CODE>GRANT</CODE> statement. For
instructions, see section <A HREF="manual.html#Adding_users">5.5.2  Adding New User Accounts to MySQL</A>.

</P>



<H2><A NAME="Upgrade" HREF="manual_toc.html#Upgrade">2.5  Upgrading/Downgrading MySQL</A></H2>

<P>
<A NAME="IDX337"></A>
<A NAME="IDX338"></A>

</P>
<P>
As a general rule, we recommend that when upgrading from one release series to
another, you should go to the next series rather than skipping a series. For
example, if you currently are running MySQL 3.23 and wish to upgrade to a
newer series, upgrade to MySQL 4.0 rather than to 4.1 or 5.0.

</P>
<P>
The following items form a checklist of things you should do whenever you
perform an upgrade:

</P>

<UL>
<LI>

Read the change log for the release series to which you are upgrading to see
what new features you can use. For example, before upgrading from MySQL 4.1 to
5.0, read the 5.0 news items.
See section <A HREF="manual.html#News">C  MySQL Change History</A>.

<LI>

Before you do an upgrade, back up your databases.

<LI>

If you are running MySQL Server on Windows, see section <A HREF="manual.html#Windows_upgrading">2.5.7  Upgrading MySQL Under Windows</A>.

<LI>

If you are using replication, see section <A HREF="manual.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A>
for information on upgrading your replication setup.

<LI>

An upgrade may involve changes to the grant tables that are stored in the
<CODE>mysql</CODE> database.) Occasionally new columns or tables are added to
support new features.  To take advantage of these features, be sure that
your grant tables are up to date.  The upgrade procedure is described in
section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</UL>

<P>
You can always move the MySQL format files and data files between different
versions on the same architecture as long as you stay within versions for
the same release series of MySQL. The current production release series is
4.0. If you change the character set when running MySQL, you must run
<CODE>myisamchk -r -q --set-character-set=charset</CODE> on all <CODE>MyISAM</CODE> tables.
Otherwise, your indexes may not be ordered correctly, because changing the
character set may also change the sort order.

</P>
<P>
If you upgrade or downgrade from one release series to another, there may be
incompatibilities in table storage formats. In this case, you can use
<CODE>mysqldump</CODE> to dump your tables before upgrading. After upgrading, reload
the dump file using <CODE>mysql</CODE> to re-create your tables.

</P>
<P>
If you are cautious about using new versions, you can always rename your old
<CODE>mysqld</CODE> before installing a newer one. For example, if you are using
MySQL 4.0.18 and want to upgrade to 4.1.1, rename your current server from
<CODE>mysqld</CODE> to <CODE>mysqld-4.0.18</CODE>.  If your new <CODE>mysqld</CODE> then does
something unexpected, you can simply shut it down and restart with your old
<CODE>mysqld</CODE>.

</P>
<P>
If, after an upgrade, you experience problems with recompiled client programs,
such as <CODE>Commands out of sync</CODE> or unexpected core dumps, you probably have
used old header or library files when compiling your programs.  In this
case, you should check the date for your <TT>`mysql.h'</TT> file and
<TT>`libmysqlclient.a'</TT> library to verify that they are from the new
MySQL distribution.  If not, recompile your programs with the new
headers and libraries.

</P>
<P>
If problems occur, such as that the new <CODE>mysqld</CODE> server doesn't want to
start or that you can't connect without a password, verify that you don't
have some old <TT>`my.cnf'</TT> file from your previous installation.  You can
check this with the <CODE>-name --print-defaults</CODE> option (for example,
<CODE>mysqld --print-defaults</CODE>).  If this displays
anything other than the program name, you have an active <TT>`my.cnf'</TT>
file that affects server or client operation.

</P>
<P>
It is a good idea to rebuild and reinstall the Perl <CODE>DBD::mysql</CODE>
module whenever you install a new release of MySQL. The same applies to other
MySQL interfaces as well, such as the Python <CODE>MySQLdb</CODE> module.

</P>



<H3><A NAME="Upgrading-from-4.1" HREF="manual_toc.html#Upgrading-from-4.1">2.5.1  Upgrading from Version 4.1 to 5.0</A></H3>

<P>
<A NAME="IDX339"></A>
<A NAME="IDX340"></A>

</P>
<P>
In general, you should do the following when upgrading to MySQL 5.0 from 4.1:

</P>

<UL>

<LI>

Read the 5.0 news items to see what significant new features you can use in
5.0.
See section <A HREF="manual.html#News-5.0.x">C.1  Changes in release 5.0.x (Development)</A>.

<LI>

If you are running MySQL Server on Windows, see section <A HREF="manual.html#Windows_upgrading">2.5.7  Upgrading MySQL Under Windows</A>.

<LI>

MySQL 5.0 adds support for stored procedures. This support requires the
<CODE>proc</CODE> table in the <CODE>mysql</CODE> database.
To create this file, you should run the <CODE>mysql_fix_privilege_tables</CODE>
script as described in section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

<LI>

If you are using replication, see section <A HREF="manual.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A>
for information on upgrading your replication setup.

</UL>



<H3><A NAME="Upgrading-from-4.0" HREF="manual_toc.html#Upgrading-from-4.0">2.5.2  Upgrading from Version 4.0 to 4.1</A></H3>

<P>
<A NAME="IDX341"></A>
<A NAME="IDX342"></A>

</P>
<P>
In general, you should do the following when upgrading to MySQL 4.1 from 4.0:

</P>

<UL>
<LI>

Check the items in the change lists found later in this section to see whether
any of them might affect your applications.

<LI>

Read the 4.1 news items to see what significant new features you can use in 4.1.
See section <A HREF="manual.html#News-4.1.x">C.2  Changes in release 4.1.x (Alpha)</A>.

<LI>

If you are running MySQL Server on Windows, see section <A HREF="manual.html#Windows_upgrading">2.5.7  Upgrading MySQL Under Windows</A>.

<STRONG>Important note:</STRONG>
Early alpha Windows distributions for MySQL 4.1 do not contain an
installer program.  See section <A HREF="manual.html#Windows_binary_installation">2.2.1.2  Installing a Windows Binary Distribution</A> for instructions on
how to install such a distribution.

<LI>

After upgrading, update the grant tables to have the new longer
<CODE>Password</CODE> column that is needed for secure handling of passwords.  The
procedure uses <CODE>mysql_fix_privilege_tables</CODE> and is described in
section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.  Implications of the password-handling change
for applications are given later in this section.  If you don't do this,
MySQL will not us the new more secure protocol to authenticate.

<LI>

If you are using replication, see section <A HREF="manual.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A>
for information on upgrading your replication setup.

<LI>

The Berkeley DB table handler is updated to DB 4.1 (from 3.2) which has
a new log format. If you have to downgrade back to 4.0 you must use
<CODE>mysqldump</CODE> to dump your <CODE>BDB</CODE> tables in text format and delete
all <CODE>log.XXXXXXXXXX</CODE> files before you start MySQL 4.0 and read back
the data.

<LI>

Character set support has been improved.  If you have table columns that
store character data represented in a character set that the 4.1 server
now supports directly, you can convert the columns to the proper character
set using the instructions in section <A HREF="manual.html#Charset-conversion">11.10.2  Converting 4.0 Character Columns to 4.1 Format</A>.

<LI>

If you are using an old <CODE>DBD-mysql</CODE> module
(<CODE>Msql-MySQL-modules</CODE>) you have to upgrade to use the newer
<CODE>DBD-mysql</CODE> module. Anything above <CODE>DBD-mysql</CODE> 2.xx should be fine.

If you don't upgrade, some commands (such as <CODE>DBI-&#62;do()</CODE>) will not
notice error conditions correctly.

<LI>

Option <CODE>--defaults-file=option-file-name</CODE> will now give an error if
the option file doesn't exists.
</UL>

<P>
Several visible behaviors have changed between MySQL 4.0 and MySQL 4.1 to fix
some critical bugs and make MySQL more compatible with the ANSI SQL
standard. These changes may affect your applications.

</P>
<P>
Some of the 4.1 behaviors can be tested in 4.0 before performing
a full upgrade to 4.1. We have added to later MySQL 4.0 releases
(from 4.0.12 on) a <CODE>--new</CODE> startup option for <CODE>mysqld</CODE>.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
This option gives you the 4.1 behavior for the most critical changes.
You can also enable these behaviors for a given client connection with
the <CODE>SET @@new=1</CODE> command, or turn them off if they are on with
<CODE>SET @@new=0</CODE>.

</P>

<P>
If you believe that some of the 4.1 changes will affect you,
we recommend that before upgrading to 4.1, you download
the latest MySQL 4.0 version and run it with the <CODE>--new</CODE> option by
adding the following to your config file:

</P>

<PRE>
[mysqld-4.0]
new
</PRE>

<P>
That way you can test the new behaviors in 4.0 to make sure that your
applications work with them. This will help you have a smooth, painless
transition when you perform a full upgrade to 4.1 later. Putting the
<CODE>--new</CODE> option in the <CODE>[mysqld-4.0]</CODE> option group ensures
that you don't accidentally later run the 4.1
version with the <CODE>--new</CODE> option.

</P>
<P>
The following lists describe changes that may affect applications and that
you should watch out for when upgrading to version 4.1:

</P>
<P>
<STRONG>Server Changes:</STRONG>

</P>

<UL>

<LI>

All tables and string columns now have a character set.
See section <A HREF="manual.html#Charset">11  Character Set Support</A>.
Character set information is displayed by
<CODE>SHOW CREATE TABLE</CODE> and <CODE>mysqldump</CODE>.
(MySQL versions 4.0.6 and above can read the new dump files; older
versions cannot.)
This change should not affect applications that use only one character set.

<LI>

The table definition format used in <TT>`.frm'</TT> files
has changed slightly in 4.1.  MySQL 4.0 versions from 4.0.11 on can
read the new <TT>`.frm'</TT> format directly, but older versions cannot.
If you need to move tables from 4.1 to a version earlier than 4.0.11, you
should use <CODE>mysqldump</CODE>.
See section <A HREF="manual.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A>.

<LI>

<STRONG>Important note:</STRONG> If you upgrade to InnoDB-4.1.1 or higher, it is
difficult to downgrade back to 4.0 or 4.1.0! That is because earlier
versions of <CODE>InnoDB</CODE> are not aware of multiple tablespaces.

<LI>

If you are running multiple servers on the same Windows machine, you should
use a different <CODE>--shared_memory_base_name</CODE> option for each server.

<LI>

The interface to aggregated UDF functions has changed a bit. You must now
declare a <CODE>xxx_clear()</CODE> function for each aggregate function <CODE>XXX()</CODE>.

</UL>

<P>
<STRONG>Client Changes:</STRONG>

</P>

<UL>

<LI>

<CODE>mysqldump</CODE> now has the <CODE>--opt</CODE> and <CODE>--quote-names</CODE> options
enabled by default. You can turn them off with <CODE>--skip-opt</CODE> and
<CODE>--skip-quote-names</CODE>.

</UL>

<P>
<STRONG>SQL Changes:</STRONG>

</P>

<UL>

<LI>

String comparison now works according to SQL standard: Instead of
stripping end spaces before comparison, we now extend the shorter string
with spaces.  The problem with this is that now <CODE>'a' &#62; 'a\t'</CODE>,
which it wasn't before.  If you have any tables where you
have a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column in which the last character in the
column may be less than <CODE>ASCII(32)</CODE>, you should use <CODE>REPAIR TABLE</CODE> or
<CODE>myisamchk</CODE> to ensure that the table is correct.

<LI>

When using multiple-table <CODE>DELETE</CODE> statements, you have to use the
alias of the tables from which you want to delete, not the actual table name.
For example, instead of doing this:


<PRE>
DELETE test FROM test AS t1, test2 WHERE ...
</PRE>

Do this:


<PRE>
DELETE t1 FROM test AS t1, test2 WHERE ...
</PRE>

<LI>

<CODE>TIMESTAMP</CODE> is now returned as a string in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE>
format.  (The <CODE>--new</CODE> option can be used from 4.0.12 on to
make a 4.0 server behave as 4.1 in this respect.)  If you want to have
the value returned as a number (as MySQL 4.0 does) you should add <CODE>+0</CODE> to
<CODE>TIMESTAMP</CODE> columns when you retrieve them:


<PRE>
mysql&#62; SELECT ts_col + 0 FROM tbl_name;
</PRE>

Display widths for <CODE>TIMESTAMP</CODE> columns are no longer supported.
For example, if you declare a column as <CODE>TIMESTAMP(10)</CODE>, the <CODE>(10)</CODE>
is ignored.

These changes were necessary for SQL standards compliance. In a future
version, a further change will be made (backward compatible with this
change), allowing the timestamp length to indicate the desired number of
digits for fractions of a second.

<LI>

Binary values such as <CODE>0xFFDF</CODE> now are assumed to be strings instead of
numbers.  This fixes some problems with character sets where it's
convenient to input a string as a binary value.  With this change,
you should use <CODE>CAST()</CODE> if you want to compare binary values
numerically as integers:


<PRE>
mysql&#62; SELECT CAST(0xFEFF AS UNSIGNED INTEGER)
    -&#62;        &#60; CAST(0xFF AS UNSIGNED INTEGER);
        -&#62; 0
</PRE>

If you don't use <CODE>CAST()</CODE>, a lexical string comparison will be done:


<PRE>
mysql&#62; SELECT 0xFEFF &#60; 0xFF;
        -&#62; 1
</PRE>

Using binary items in a numeric context or comparing them using the
<CODE>=</CODE> operator should work as before.  (The <CODE>--new</CODE> option can
be used from 4.0.13 on to make a 4.0 server behave as 4.1 in this respect.)

<LI>

For functions that produce a <CODE>DATE</CODE>, <CODE>DATETIME</CODE>, or <CODE>TIME</CODE>
value, the result returned to the client now is fixed up to have a temporal
type. For example, in MySQL 4.1, you get this result:


<PRE>
mysql&#62; SELECT CAST('2001-1-1' AS DATETIME);
       -&#62; '2001-01-01 00:00:00'
</PRE>

In MySQL 4.0, the result is different:


<PRE>
mysql&#62; SELECT CAST('2001-1-1' AS DATETIME);
       -&#62; '2001-01-01'
</PRE>

<LI>

<CODE>DEFAULT</CODE> values no longer can be specified for <CODE>AUTO_INCREMENT</CODE>
columns. (In 4.0, a <CODE>DEFAULT</CODE> value is silently ignored; in 4.1,
an error occurs.)

<LI>

<CODE>LIMIT</CODE> no longer accepts negative arguments.
Use some large number (maximum 18446744073709551615) instead of -1.

<LI>

<CODE>SERIALIZE</CODE> is no longer a valid mode value for the <CODE>sql_mode</CODE>
variable.  You should use <CODE>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE</CODE>
instead. <CODE>SERIALIZE</CODE> is no longer valid for the <CODE>--sql-mode</CODE> option
for <CODE>mysqld</CODE>, either. Use <CODE>--transaction-isolation=SERIALIZABLE</CODE>
instead.

</UL>

<P>
<STRONG>C API Changes:</STRONG>

</P>

<UL>

<LI>

Some C API calls such as <CODE>mysql_real_query()</CODE> now return <CODE>1</CODE> on error,
not <CODE>-1</CODE>.  You may have to change some old applications if they use
constructs like this:


<PRE>
if (mysql_real_query(mysql_object, query, query_length) == -1)
{
  printf("Got error");
}
</PRE>

Change the call to test for a non-zero value instead:


<PRE>
if (mysql_real_query(mysql_object, query, query_length) != 0)
{
  printf("Got error");
}
</PRE>

</UL>

<P>
<STRONG>Password-Handling Changes:</STRONG>

</P>
<P>
The password hashing mechanism has changed in 4.1 to provide better
security, but this may cause compatibility problems if you still have
clients that use the client library from 4.0 or earlier.  (It is very likely that you will
have 4.0 clients in situations where clients connect from remote hosts
that have not yet upgraded to 4.1.)  The following list indicates some
possible upgrade strategies.  They represent various tradeoffs between
the goal of compatibility with old clients and the goal of security.

</P>

<UL>

<LI>

Only upgrade the client to use 4.1 client libraries (not the server). No
behavior will change (except the return value of some API calls), but
you cannot use any of the new features provided by the 4.1 client/server
protocol, either.  (MySQL 4.1 has an extended client/server protocol
that offers such features as prepared statements and multiple result
sets.)  See section <A HREF="manual.html#C_API_Prepared_statements">20.2.4  C API Prepared Statements</A>.

<LI>

Upgrade to 4.1 and run the <CODE>mysql_fix_privilege_tables</CODE> script
to widen the <CODE>Password</CODE> column in the <CODE>user</CODE> table so
that it can hold long password hashes.  But run the server with the
<CODE>--old-passwords</CODE> option to provide backward compatibility that
allows pre-4.1 clients to continue to connect to their short-hash
accounts.
Eventually, when all your clients are upgraded to 4.1, you can stop using the
<CODE>--old-passwords</CODE> server option. You can also change the passwords for
your MySQL accounts to use the new more secure format.

<LI>

Upgrade to 4.1 and run the <CODE>mysql_fix_privilege_tables</CODE> script to widen the
<CODE>Password</CODE> column in the <CODE>user</CODE> table.  If you know that all clients
also have been upgraded to 4.1, don't run the server with the
<CODE>--old-passwords</CODE> option.  Instead, change the passwords on all existing
accounts so that they have the new format.  A pure-4.1 installation
is the most secure.

</UL>

<P>
Further background on password hashing with respect to client authentication
and password-changing operations may be found in section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A> and
section <A HREF="manual.html#Old_client">A.2.3  <CODE>Client does not support authentication protocol</CODE></A>.

</P>



<H3><A NAME="Upgrading-from-3.23" HREF="manual_toc.html#Upgrading-from-3.23">2.5.3  Upgrading from Version 3.23 to 4.0</A></H3>

<P>
<A NAME="IDX343"></A>
<A NAME="IDX344"></A>

</P>
<P>
In general, you should do the following when upgrading to MySQL 4.0 from 3.23:

</P>

<UL>
<LI>

Check the items in the change lists found later in this section to see whether
any of them might affect your applications.

<LI>

Read the 4.0 news items to see what significant new features you can use in 4.0.
See section <A HREF="manual.html#News-4.0.x">C.3  Changes in release 4.0.x (Production)</A>.

<LI>

If you are running MySQL Server on Windows, see section <A HREF="manual.html#Windows_upgrading">2.5.7  Upgrading MySQL Under Windows</A>.

<LI>

After upgrading,
update the grant tables to add new privileges and features.  The
procedure uses the <CODE>mysql_fix_privilege_tables</CODE> script and is described
in section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

<LI>

If you are using replication, see section <A HREF="manual.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A>
for information on upgrading your replication setup.

<LI>

Edit any MySQL startup scripts or option files to not use any of the
deprecated options described later in this section.

<LI>

Convert your old <CODE>ISAM</CODE> files to <CODE>MyISAM</CODE> files. One way to do this
is with the
<CODE>mysql_convert_table_format</CODE> script. (This is a Perl script;
it requires that DBI be installed.) To convert the tables in a given database,
use this command:


<PRE>
shell&#62; mysql_convert_table_format database db_name
</PRE>

Note that this should be used only if all tables in the given database
are <CODE>ISAM</CODE> or <CODE>MyISAM</CODE> tables. To avoid converting tables
of other types to <CODE>MyISAM</CODE>, you can explicitly list the names
of your <CODE>ISAM</CODE> tables after the database name on the command
line.

Individual tables can be changed to <CODE>MyISAM</CODE> by using the following
<CODE>ALTER TABLE</CODE> statement for each table to be converted:


<PRE>
mysql&#62; ALTER TABLE tbl_name TYPE=MyISAM;
</PRE>

If you are not sure of the table type for a given table, use this statement:


<PRE>
mysql&#62; SHOW TABLE STATUS LIKE 'tbl_name';
</PRE>

<LI>

Ensure that you don't have any MySQL clients that use shared libraries
(like the Perl <CODE>DBD::mysql</CODE> module). If you do, you should recompile
them, because the data structures used in <TT>`libmysqlclient.so'</TT> have changed.
The same applies to other MySQL interfaces as well, such as the Python
<CODE>MySQLdb</CODE> module.

</UL>

<P>
MySQL 4.0 will work even if you don't perform the preceding actions, but you
will not be able to use the new security privileges in MySQL 4.0 and you
may run into problems when upgrading later to MySQL 4.1 or newer.  The
<CODE>ISAM</CODE> file format still works in MySQL 4.0, but is deprecated and
is not compiled in by default as of MySQL 4.1. <CODE>MyISAM</CODE> tables should
be used instead.

</P>
<P>
Old clients should work with a Version 4.0 server without any problems.

</P>
<P>
Even if you perform the preceding actions, you can still downgrade to MySQL
3.23.52 or newer if you run into problems with the MySQL 4.0 series.  In
this case, you must use <CODE>mysqldump</CODE> to dump any tables that use
full-text indexes and reload the dump file into the 3.23 server.  This is
necessary because 4.0 uses a new format for full-text indexing.

</P>
<P>
The following lists describe changes that may affect applications and that
you should watch out for when upgrading to version 4.0:

</P>
<P>
<STRONG>Server Changes:</STRONG>

</P>

<UL>

<LI>

MySQL 4.0 has a lot of new privileges in the <CODE>mysql.user</CODE> table.
See section <A HREF="manual.html#Privileges_provided">5.4.3  Privileges Provided by MySQL</A>.

To get these new privileges to work, you must update the grant tables.
The procedure is described in section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.
Until you do this, all
accounts have the <CODE>SHOW DATABASES</CODE>, <CODE>CREATE TEMPORARY TABLES</CODE>,
and <CODE>LOCK TABLES</CODE> privileges. <CODE>SUPER</CODE> and <CODE>EXECUTE</CODE>
privileges take their value from <CODE>PROCESS</CODE>.
<CODE>REPLICATION SLAVE</CODE> and <CODE>REPLICATION CLIENT</CODE> take their
values from <CODE>FILE</CODE>.

If you have any scripts that create new MySQL user accounts, you may want to change
them to use the new privileges.  If you are not using <CODE>GRANT</CODE>
commands in the scripts, this is a good time to change your scripts to use
<CODE>GRANT</CODE> instead of modifying the grant tables directly.

From version 4.0.2 on, the option <CODE>--safe-show-database</CODE> is deprecated
(and no longer does anything). See section <A HREF="manual.html#Privileges_options">5.3.3  Startup Options for <CODE>mysqld</CODE> Concerning Security</A>.

If you get <CODE>Access denied</CODE> errors for new users in version 4.0.2 and up, you
should check whether you need some of the new grants that you didn't need
before.  In particular, you will need <CODE>REPLICATION SLAVE</CODE>
(instead of <CODE>FILE</CODE>) for new slave servers.

<LI>

<CODE>safe_mysqld</CODE> has been renamed to <CODE>mysqld_safe</CODE>.  For backward
compatibility, binary distributions will for some time include
<CODE>safe_mysqld</CODE> as a symlink to <CODE>mysqld_safe</CODE>.

<LI>

<CODE>InnoDB</CODE> support is now included by default in binary distributions.
If you build MySQL from source, <CODE>InnoDB</CODE> is configured in by default.
If you do not use <CODE>InnoDB</CODE> and want to save memory when running a
server that has <CODE>InnoDB</CODE> support enabled, use the <CODE>--skip-innodb</CODE>
server startup option. To compile MySQL without <CODE>InnoDB</CODE> support, run
<CODE>configure</CODE> with the <CODE>--without-innodb</CODE> option.

<LI>

Values for the startup parameters <CODE>myisam_max_extra_sort_file_size</CODE> and
<CODE>myisam_max_extra_sort_file_size</CODE> now are given in bytes
(they were given in megabytes before 4.0.3).

<LI>

<CODE>mysqld</CODE> now has the option <CODE>--temp-pool</CODE> enabled by default
because this gives better performance with some operating systems (most
notably Linux).

<LI>

The <CODE>mysqld</CODE> startup options <CODE>--skip-locking</CODE> and
<CODE>--enable-locking</CODE> were renamed to <CODE>--skip-external-locking</CODE>
and <CODE>--external-locking</CODE>.

<LI>

External system locking of <CODE>MyISAM</CODE>/<CODE>ISAM</CODE> files is now
turned off by default.  Your can turn this on by doing
<CODE>--external-locking</CODE>. (However, this is never needed for most users.)

<LI>

The following startup variables and options have been renamed:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Old Name</STRONG> </TD><TD> <STRONG>New Name</STRONG>
</TD></TR>
<TR><TD><CODE>myisam_bulk_insert_tree_size</CODE> </TD><TD> <CODE>bulk_insert_buffer_size</CODE>
</TD></TR>
<TR><TD><CODE>query_cache_startup_type</CODE> </TD><TD> <CODE>query_cache_type</CODE>
</TD></TR>
<TR><TD><CODE>record_buffer</CODE> </TD><TD> <CODE>read_buffer_size</CODE>
</TD></TR>
<TR><TD><CODE>record_rnd_buffer</CODE> </TD><TD> <CODE>read_rnd_buffer_size</CODE>
</TD></TR>
<TR><TD><CODE>sort_buffer</CODE> </TD><TD> <CODE>sort_buffer_size</CODE>
</TD></TR>
<TR><TD><CODE>warnings</CODE> </TD><TD> <CODE>log-warnings</CODE>
</TD></TR>
<TR><TD><CODE>--err-log</CODE> </TD><TD> <CODE>--log-error</CODE> (for <CODE>mysqld_safe</CODE>)
</TD></TR>
</TABLE>

The startup options <CODE>record_buffer</CODE>, <CODE>sort_buffer</CODE>, and
<CODE>warnings</CODE> will still work in MySQL 4.0 but are deprecated.
</UL>

<P>
<STRONG>SQL Changes:</STRONG>

</P>

<UL>

<LI>

The following SQL variables have been renamed:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Old Name</STRONG> </TD><TD> <STRONG>New Name</STRONG>
</TD></TR>
<TR><TD><CODE>SQL_BIG_TABLES</CODE> </TD><TD> <CODE>BIG_TABLES</CODE>
</TD></TR>
<TR><TD><CODE>SQL_LOW_PRIORITY_UPDATES</CODE> </TD><TD> <CODE>LOW_PRIORITY_UPDATES</CODE>
</TD></TR>
<TR><TD><CODE>SQL_MAX_JOIN_SIZE</CODE> </TD><TD> <CODE>MAX_JOIN_SIZE</CODE>
</TD></TR>
<TR><TD><CODE>SQL_QUERY_CACHE_TYPE</CODE> </TD><TD> <CODE>QUERY_CACHE_TYPE</CODE>
</TD></TR>
</TABLE>
The old names still work in MySQL 4.0 but are deprecated.

<LI>

You have to use <CODE>SET GLOBAL SQL_SLAVE_SKIP_COUNTER=skip_count</CODE> instead of
<CODE>SET SQL_SLAVE_SKIP_COUNTER=skip_count</CODE>.

<LI>

<CODE>SHOW MASTER STATUS</CODE> now returns an empty set if binary logging is not
enabled.

<LI>

<CODE>SHOW SLAVE STATUS</CODE> now returns an empty set if the slave is not
initialized.

<LI>

<CODE>SHOW INDEX</CODE> has two more columns than it had in 3.23 (<CODE>Null</CODE> and
<CODE>Index_type</CODE>).

<LI>

The format of <CODE>SHOW OPEN TABLES</CODE> has changed.

<LI>

<CODE>ORDER BY col_name DESC</CODE> sorts <CODE>NULL</CODE> values last, as of
MySQL 4.0.11. In 3.23 and in earlier 4.0 versions, this was not
always consistent.

<LI>

<CODE>CHECK</CODE>, <CODE>LOCALTIME</CODE>, and <CODE>LOCALTIMESTAMP</CODE>
now are reserved words.

<LI>

<CODE>DOUBLE</CODE> and <CODE>FLOAT</CODE> columns now honor the
<CODE>UNSIGNED</CODE> flag on storage (before, <CODE>UNSIGNED</CODE> was ignored for
these columns).

<LI>

The result of all bitwise operators (<CODE>|</CODE>, <CODE>&#38;</CODE>, <CODE>&#60;&#60;</CODE>,
<CODE>&#62;&#62;</CODE>, and <CODE>~</CODE>) is now unsigned.  This may cause problems if you
are using them in a context where you want a signed result.
See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.

<STRONG>Note:</STRONG> When you use subtraction between integer values where
one is of type <CODE>UNSIGNED</CODE>, the result will be unsigned.  In other
words, before upgrading to MySQL 4.0, you should check your application
for cases in which you are subtracting a value from an unsigned entity and
want a negative answer or subtracting an unsigned value from an
integer column. You can disable this behavior by using the
<CODE>--sql-mode=NO_UNSIGNED_SUBTRACTION</CODE> option when starting
<CODE>mysqld</CODE>.  See section <A HREF="manual.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

<LI>

You should use integers to store values in <CODE>BIGINT</CODE> columns (instead
of using strings, as you did in MySQL 3.23).  Using strings will still
work, but using integers is more efficient.

<LI>

In MySQL 3.23, <CODE>INSERT INTO ... SELECT</CODE> always had <CODE>IGNORE</CODE> enabled.
As of 4.0.1, MySQL will stop (and possibly roll back) by default in case of
an error unless you specify <CODE>IGNORE</CODE>.

<LI>

You should use <CODE>TRUNCATE TABLE</CODE> when you want to delete all rows
from a table and you don't need to obtain a count of the number of rows
that were deleted.  (<CODE>DELETE FROM tbl_name</CODE> returns a row count in
4.0 and doesn't reset the <CODE>AUTO_INCREMENT</CODE> counter, and
<CODE>TRUNCATE TABLE</CODE> is faster.)

<LI>

You will get an error if you have an active <CODE>LOCK TABLES</CODE> or
transaction when trying to execute <CODE>TRUNCATE TABLE</CODE> or <CODE>DROP
DATABASE</CODE>.

<LI>

To use <CODE>MATCH ... AGAINST (... IN BOOLEAN MODE)</CODE> full-text searches
with your tables, you must rebuild their indexes with <CODE>REPAIR TABLE
tbl_name USE_FRM</CODE>.  If you attempt a boolean full-text search without
rebuilding the indexes this way, the search will return incorrect results.
See section <A HREF="manual.html#Fulltext_Fine-tuning">13.6.4  Fine-Tuning MySQL Full-Text Search</A>.

<LI>

<CODE>LOCATE()</CODE> and <CODE>INSTR()</CODE> are case-sensitive if one of the
arguments is a binary string. Otherwise they are case-insensitive.

<LI>

<CODE>STRCMP()</CODE> now uses the current character set when performing comparisons.
This makes the default comparison behavior not case sensitive unless
one or both of the operands are binary strings.

<LI>

<CODE>HEX(string)</CODE> now returns the characters in <CODE>string</CODE> converted to
hexadecimal.  If you want to convert a number to hexadecimal, you should
ensure that you call <CODE>HEX()</CODE> with a numeric argument.

<LI>

<CODE>RAND(seed)</CODE> returns a different random number series in 4.0 than in
3.23; this was done to further differentiate <CODE>RAND(seed)</CODE> and
<CODE>RAND(seed+1)</CODE>.

<LI>

The default type returned by <CODE>IFNULL(A,B)</CODE> is now set to be the
more ``general'' of the types of <CODE>A</CODE> and <CODE>B</CODE>. (The general-to-specific
order is string, <CODE>REAL</CODE>, <CODE>INTEGER</CODE>).

</UL>

<P>
<STRONG>C API Changes:</STRONG>

</P>

<UL>

<LI>

The old C API functions <CODE>mysql_drop_db()</CODE>, <CODE>mysql_create_db()</CODE>, and
<CODE>mysql_connect()</CODE> are no longer supported unless you compile
MySQL with <CODE>CFLAGS=-DUSE_OLD_FUNCTIONS</CODE>.  However, it is preferable
to change client programs to use the new 4.0 API instead.

<LI>

In the <CODE>MYSQL_FIELD</CODE> structure, <CODE>length</CODE> and <CODE>max_length</CODE> have
changed from <CODE>unsigned int</CODE> to <CODE>unsigned long</CODE>. This should not
cause any problems, except that they may generate warning messages when
used as arguments in the <CODE>printf()</CODE> class of functions.

<LI>

Multi-threaded clients should use <CODE>mysql_thread_init()</CODE> and
<CODE>mysql_thread_end()</CODE>. See section <A HREF="manual.html#Threaded_clients">20.2.14  How to Make a Threaded Client</A>.

</UL>

<P>
<STRONG>Other Changes:</STRONG>

</P>

<UL>

<LI>

If you want to recompile the Perl <CODE>DBD::mysql</CODE> module, use a recent
version.  Version 2.9003 is recommended. Versions older than 1.2218 should
not be used because they use the deprecated <CODE>mysql_drop_db()</CODE> call.

</UL>



<H3><A NAME="Upgrading-from-3.22" HREF="manual_toc.html#Upgrading-from-3.22">2.5.4  Upgrading from Version 3.22 to 3.23</A></H3>

<P>
<A NAME="IDX345"></A>
<A NAME="IDX346"></A>

</P>
<P>
MySQL 3.22 and 3.21 clients will work without any problems with a MySQL
3.23 server.

</P>
<P>
When upgrading to MySQL 3.23 from an earlier version, note the following
changes:

</P>
<P>
<STRONG>Table Changes:</STRONG>

</P>

<UL>

<LI>

MySQL 3.23 supports tables of the new <CODE>MyISAM</CODE> type and the old
<CODE>ISAM</CODE> type.  By default, all new tables are created with type
<CODE>MyISAM</CODE> unless you start <CODE>mysqld</CODE> with the
<CODE>--default-table-type=isam</CODE> option.  You don't have to convert your old
<CODE>ISAM</CODE> tables to use them with MySQL 3.23.  You can convert an
<CODE>ISAM</CODE> table to <CODE>MyISAM</CODE> format with <CODE>ALTER TABLE tbl_name
TYPE=MyISAM</CODE> or the Perl script <CODE>mysql_convert_table_format</CODE>.

<LI>

All tables that use the <CODE>tis620</CODE> character set must be fixed
with <CODE>myisamchk -r</CODE> or <CODE>REPAIR TABLE</CODE>.

<LI>

If you are using the <CODE>german</CODE> character sort order for <CODE>ISAM</CODE>
tables, you must repair them with <CODE>isamchk -r</CODE>, because we have made
some changes in the sort order.

</UL>

<P>
<STRONG>Client Program Changes:</STRONG>

</P>

<UL>
<LI>

The MySQL client <CODE>mysql</CODE> is now by default started with the
<CODE>--no-named-commands (-g)</CODE> option. This option can be disabled with
<CODE>--enable-named-commands (-G)</CODE>. This may cause incompatibility problems in
some cases--for example, in SQL scripts that use named commands without a
semicolon.  Long format commands still work from the first line.

<LI>

If you want your <CODE>mysqldump</CODE> files to be compatible between
MySQL 3.22 and 3.23, you should not use the
<CODE>--opt</CODE> or <CODE>--all</CODE> option to <CODE>mysqldump</CODE>.

</UL>

<P>
<STRONG>SQL Changes:</STRONG>

</P>

<UL>
<LI>

If you do a <CODE>DROP DATABASE</CODE> on a symbolically linked database, both the
link and the original database are deleted.  This didn't happen in MySQL 3.22
because <CODE>configure</CODE> didn't detect the availability of the
<CODE>readlink()</CODE> system call.

<LI>

<CODE>OPTIMIZE TABLE</CODE> now works only for <CODE>MyISAM</CODE> tables.
For other table types, you can use <CODE>ALTER TABLE</CODE> to optimize the table.
During <CODE>OPTIMIZE TABLE</CODE>, the table is now locked to prevent it from being
used by other threads.

<LI>

Date functions that work on parts of dates (such as <CODE>MONTH()</CODE>) will now
return 0 for <CODE>0000-00-00</CODE> dates. In MySQL 3.22, these functions returned
<CODE>NULL</CODE>.

<LI>

The default return type of <CODE>IF()</CODE> now depends on both arguments,
not just the first one.

<LI>

<CODE>AUTO_INCREMENT</CODE> columns should not be used to store negative
numbers. The reason for this is that negative numbers caused problems
when wrapping from -1 to 0.  You should not store 0 in <CODE>AUTO_INCREMENT</CODE>
columns, either; <CODE>CHECK TABLE</CODE> will complain about 0 values because
they may change if you dump and restore the table.  <CODE>AUTO_INCREMENT</CODE>
for <CODE>MyISAM</CODE> tables is now handled at a lower level and is much
faster than before. In addition, for <CODE>MyISAM</CODE> tables, old numbers
are no longer reused, even if you delete rows from the table.

<LI>

<CODE>CASE</CODE>, <CODE>DELAYED</CODE>, <CODE>ELSE</CODE>, <CODE>END</CODE>, <CODE>FULLTEXT</CODE>,
<CODE>INNER</CODE>, <CODE>RIGHT</CODE>, <CODE>THEN</CODE>, and <CODE>WHEN</CODE> now are reserved words.

<LI>

<CODE>FLOAT(p)</CODE> now is a true floating-point type and not a value with a
fixed number of decimals.

<LI>

When declaring columns using a <CODE>DECIMAL(length,dec)</CODE> type, the
<CODE>length</CODE> argument no longer includes a place for the sign or the
decimal point.

<LI>

A <CODE>TIME</CODE> string must now be of one of the following formats:
<CODE>[[[DAYS] [H]H:]MM:]SS[.fraction]</CODE> or
<CODE>[[[[[H]H]H]H]MM]SS[.fraction]</CODE>.

<LI>

<CODE>LIKE</CODE> now compares strings using the same character comparison rules
as for the <CODE>=</CODE> operator.  If you require the old behavior, you can
compile MySQL with the <CODE>CXXFLAGS=-DLIKE_CMP_TOUPPER</CODE> flag.

<LI>

<CODE>REGEXP</CODE> now is case insensitive if neither of the strings is a binary
string.

<LI>

When you check or repair <CODE>MyISAM</CODE> (<TT>`.MYI'</TT>) tables, you should use
the <CODE>CHECK TABLE</CODE> statement or the <CODE>myisamchk</CODE> command. For
<CODE>ISAM</CODE> (<TT>`.ISM'</TT>) tables, use the <CODE>isamchk</CODE> command.

<LI>

Check all your calls to <CODE>DATE_FORMAT()</CODE> to make sure that there is a
<SAMP>`%'</SAMP> before each format character.
(MySQL 3.22 already allowed this syntax, but now <SAMP>`%'</SAMP> is required.)

<LI>

In MySQL Version 3.22, the output of <CODE>SELECT DISTINCT ...</CODE> was
almost always sorted.  In Version 3.23, you must use <CODE>GROUP BY</CODE> or
<CODE>ORDER BY</CODE> to obtain sorted output.

<LI>

<CODE>SUM()</CODE> now returns <CODE>NULL</CODE> instead of 0 if
there are no matching rows. This is required by standard SQL.

<LI>

An <CODE>AND</CODE> or <CODE>OR</CODE> with <CODE>NULL</CODE> values will now return
<CODE>NULL</CODE> instead of 0. This mostly affects queries that use <CODE>NOT</CODE>
on an <CODE>AND/OR</CODE> expression as <CODE>NOT NULL</CODE> = <CODE>NULL</CODE>.

<LI>

<CODE>LPAD()</CODE> and <CODE>RPAD()</CODE> now shorten the result string if it's longer
than the length argument.

</UL>

<P>
<STRONG>C API Changes:</STRONG>

</P>

<UL>
<LI>

<CODE>mysql_fetch_fields_direct()</CODE> now is a function instead of a macro.
It now returns a pointer to a <CODE>MYSQL_FIELD</CODE> instead of a
<CODE>MYSQL_FIELD</CODE>.

<LI>

<CODE>mysql_num_fields()</CODE> no longer can be used on a <CODE>MYSQL*</CODE> object (it's
now a function that takes a <CODE>MYSQL_RES*</CODE> value as an argument). With a
<CODE>MYSQL*</CODE> object, you now should use <CODE>mysql_field_count()</CODE> instead.

</UL>



<H3><A NAME="Upgrading-from-3.21" HREF="manual_toc.html#Upgrading-from-3.21">2.5.5  Upgrading from Version 3.21 to 3.22</A></H3>

<P>
<A NAME="IDX347"></A>
<A NAME="IDX348"></A>

</P>
<P>
Nothing that affects compatibility has changed between versions 3.21 and 3.22.
The only pitfall is that new tables that are created with <CODE>DATE</CODE> type
columns will use the new way to store the date. You can't access these new
columns from an old version of <CODE>mysqld</CODE>.

</P>
<P>
When upgrading to MySQL 3.23 from an earlier version, note the following
changes:

</P>

<UL>
<LI>

After installing MySQL Version 3.22, you should start the new server
and then run the <CODE>mysql_fix_privilege_tables</CODE> script. This will add the
new privileges that you need to use the <CODE>GRANT</CODE> command.  If you forget
this, you will get <CODE>Access denied</CODE> when you try to use <CODE>ALTER
TABLE</CODE>, <CODE>CREATE INDEX</CODE>, or <CODE>DROP INDEX</CODE>. The procedure for updating
the grant tables is described in section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

<LI>

The C API interface to <CODE>mysql_real_connect()</CODE> has changed.  If you have
an old client program that calls this function, you must place a <CODE>0</CODE> for
the new <CODE>db</CODE> argument (or recode the client to send the <CODE>db</CODE>
element for faster connections).  You must also call <CODE>mysql_init()</CODE>
before calling <CODE>mysql_real_connect()</CODE>.  This change was done to allow
the new <CODE>mysql_options()</CODE> function to save options in the <CODE>MYSQL</CODE>
handler structure.

<LI>

The <CODE>mysqld</CODE> variable <CODE>key_buffer</CODE> has been renamed to
<CODE>key_buffer_size</CODE>, but you can still use the old name in your
startup files.

</UL>



<H3><A NAME="Upgrading-from-3.20" HREF="manual_toc.html#Upgrading-from-3.20">2.5.6  Upgrading from Version 3.20 to 3.21</A></H3>

<P>
<A NAME="IDX349"></A>

</P>
<P>
If you are running a version older than Version 3.20.28 and want to
switch to Version 3.21, you need to do the following:

</P>
<P>
You can start the <CODE>mysqld</CODE> Version 3.21 server with the
<CODE>--old-protocol</CODE> option to use it with clients from a Version 3.20
distribution.  In this case, the server uses the old pre-3.21
<CODE>password()</CODE> checking rather than the new method. Also, the new client
function <CODE>mysql_errno()</CODE> will not return any server error, only
<CODE>CR_UNKNOWN_ERROR</CODE>. The function does work for client errors.

</P>
<P>
If you are <EM>not</EM> using the <CODE>--old-protocol</CODE> option to
<CODE>mysqld</CODE>, you will need to make the following changes:

</P>

<UL>

<LI>

All client code must be recompiled. If you are using ODBC, you must get
the new <CODE>MyODBC</CODE> 2.x driver.

<LI>

The <CODE>scripts/add_long_password</CODE> script must be run to convert the
<CODE>Password</CODE> field in the <CODE>mysql.user</CODE> table to <CODE>CHAR(16)</CODE>.

<LI>

All passwords must be reassigned in the <CODE>mysql.user</CODE> table to get 62-bit
rather than 31-bit passwords.

<LI>

The table format hasn't changed, so you don't have to convert any tables.

</UL>

<P>
MySQL 3.20.28 and above can handle the new <CODE>user</CODE> table
format without affecting clients. If you have a MySQL version earlier
than 3.20.28, passwords will no longer work with it if you convert the
<CODE>user</CODE> table. So to be safe, you should first upgrade to at least Version
3.20.28 and then upgrade to Version 3.21.

</P>
<P>
<A NAME="IDX350"></A>
The new client code works with a 3.20.x <CODE>mysqld</CODE> server, so
if you experience problems with 3.21.x, you can use the old 3.20.x server
without having to recompile the clients again.

</P>
<P>
If you are not using the <CODE>--old-protocol</CODE> option to <CODE>mysqld</CODE>,
old clients will be unable to connect and will issue the following error
message:

</P>

<PRE>
ERROR: Protocol mismatch. Server Version = 10 Client Version = 9
</PRE>

<P>
The Perl DBI interface also supports the old
<CODE>mysqlperl</CODE> interface.  The only change you have to make if you use
<CODE>mysqlperl</CODE> is to change the arguments to the <CODE>connect()</CODE> function.
The new arguments are: <CODE>host</CODE>, <CODE>database</CODE>, <CODE>user</CODE>,
and <CODE>password</CODE> (note that the <CODE>user</CODE> and <CODE>password</CODE> arguments
have changed places).

</P>
<P>
The following changes may affect queries in old applications:

</P>

<UL>

<LI>

<CODE>HAVING</CODE> must now be specified before any <CODE>ORDER BY</CODE> clause.

<LI>

The parameters to <CODE>LOCATE()</CODE> have been swapped.

<LI>

There are some new reserved words. The most notable are <CODE>DATE</CODE>,
<CODE>TIME</CODE>, and <CODE>TIMESTAMP</CODE>.

</UL>



<H3><A NAME="Windows_upgrading" HREF="manual_toc.html#Windows_upgrading">2.5.7  Upgrading MySQL Under Windows</A></H3>

<P>
<A NAME="IDX351"></A>

</P>
<P>
When upgrading MySQL under Windows, please follow these steps:

</P>

<OL>

<LI>

Download the latest Windows distribution of MySQL.

<LI>

Choose a time of day with low usage, where a maintenance break is
acceptable.

<LI>

Alert the users who still are active about the maintenance break.

<LI>

Stop the running MySQL Server (for example, with <CODE>NET STOP MySQL</CODE> or with
the <CODE>Services</CODE> utility if you
are running MySQL as a service, or with <CODE>mysqladmin shutdown</CODE> otherwise).

<LI>

Exit the <CODE>WinMySQLAdmin</CODE> program if it is running.

<LI>

Run the installation script of the Windows distribution by
clicking the Install button in WinZip and following the installation
steps of the script.

<STRONG>Important note:</STRONG>
Early alpha Windows distributions for MySQL 4.1 do not contain an
installer program.  See section <A HREF="manual.html#Windows_binary_installation">2.2.1.2  Installing a Windows Binary Distribution</A> for instructions on
how to install such a distribution.

<LI>

You may either overwrite your old MySQL installation (usually located at
<TT>`C:\mysql'</TT>), or install it into a different directory, such as
<CODE>C:\mysql4</CODE>. Overwriting the old installation is recommended.

<LI>

Restart the server. For example, use <CODE>NET START MySQL</CODE> if you run MySQL
as a service, or invoke <CODE>mysqld</CODE> directly otherwise.

<LI>

Update the grant tables. The procedure is described in
section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</OL>

<P>
Possible error situations:

<PRE>
A system error has occurred.
System error 1067 has occurred.
The process terminated unexpectedly.
</PRE>

<P>
This error means that your option file (by default <TT>`C:\my.cnf'</TT>)
contains an option that cannot be recognized by MySQL. You can verify
that this is the case by trying to restart MySQL with the <TT>`my.cnf'</TT>
file renamed to prevent the server from using it (for example, rename
<TT>`C:\my.cnf'</TT> to <TT>`C:\my_cnf.old'</TT>).  Once you have verified it, you
need to identify which option is the culprit. Create a new <TT>`my.cnf'</TT> file
and move parts of the old file to it (restarting the server after you move
each part) until you determine which option causes server startup to fail.

</P>



<H3><A NAME="Upgrading-grant-tables" HREF="manual_toc.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A></H3>

<P>
<A NAME="IDX352"></A>
<A NAME="IDX353"></A>

</P>
<P>
Some releases introduce changes to the structure of the grant tables
(the tables in the <CODE>mysql</CODE> database)
to add new  privileges or features. To make sure that your grant tables
are current when you update to a new version of MySQL, you should update
your grant tables as well.

</P>
<P>
On Unix or Unix-like systems, update the grant tables by running the
<CODE>mysql_fix_privilege_tables</CODE> script:

</P>

<PRE>
shell&#62; mysql_fix_privilege_tables
</PRE>

<P>
You must run this script while the server is running. It attempts to
connect to the server running on the local host as <CODE>root</CODE>.
If your <CODE>root</CODE> account requires a password, indicate the password
on the command line.  For MySQL 4.1 and up, specify the password like this:

</P>

<PRE>
shell&#62; mysql_fix_privilege_tables --password=root_password
</PRE>

<P>
Prior to MySQL 4.1, specify the password like this:

</P>

<PRE>
shell&#62; mysql_fix_privilege_tables root_password
</PRE>

<P>
The <CODE>mysql_fix_privilege_tables</CODE> script performs any actions
necessary to convert your grant tables to the current format. You
might see some <CODE>Duplicate column name</CODE> warnings as it runs; you can
ignore them.

</P>
<P>
After running the script, stop the server and restart it.

</P>
<P>
On Windows systems, there isn't an easy way to update the grant tables
until MySQL 4.0.15.  From version 4.0.15 on, MySQL distributions include a
<CODE>mysql_fix_privilege_tables.sql</CODE> SQL script that you can run using
the <CODE>mysql</CODE> client.  If your MySQL installation is located at
<TT>`C:\mysql'</TT>, the commands look like this: 

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysql -u root -p mysql
mysql&#62; SOURCE C:\mysql\scripts\mysql_fix_privilege_tables.sql
</PRE>

<P>
If your installation is located in some other directory, adjust the
pathnames appropriately.

</P>
<P>
The <CODE>mysql</CODE> command will prompt you for the <CODE>root</CODE> password; enter it
when prompted.

</P>
<P>
As with the Unix procedure, you might see some <CODE>Duplicate column name</CODE>
warnings as <CODE>mysql</CODE> processes the statements in the
<CODE>mysql_fix_privilege_tables.sql</CODE> script; you can ignore them.

</P>
<P>
After running the script, stop the server and restart it.

</P>



<H3><A NAME="Upgrading-to-arch" HREF="manual_toc.html#Upgrading-to-arch">2.5.9  Copying MySQL Databases to Another Machine</A></H3>

<P>
<A NAME="IDX354"></A>
<A NAME="IDX355"></A>
<A NAME="IDX356"></A>

</P>
<P>
If you are using MySQL Version 3.23 or later, you can copy the <TT>`.frm'</TT>,
<TT>`.MYI'</TT>, and <TT>`.MYD'</TT> files for <CODE>MyISAM</CODE> tables between different
architectures that support the same floating-point format.  (MySQL takes care
of any byte-swapping issues.)
See section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.

</P>
<P>
The MySQL <CODE>ISAM</CODE> data and index files (<TT>`.ISD'</TT> and <TT>`*.ISM'</TT>,
respectively) are architecture dependent and in some cases operating
system dependent.  If you want to move your applications to another
machine that has a different architecture or operating system than your
current machine, you should not try to move a database by simply copying
the files to the other machine. Use <CODE>mysqldump</CODE> instead.

</P>
<P>
By default, <CODE>mysqldump</CODE> will create a file containing SQL statements.
You can then transfer the file to the other machine and feed it as input
to the <CODE>mysql</CODE> client.

</P>
<P>
Try <CODE>mysqldump --help</CODE> to see what options are available.
If you are moving the data to a newer version of MySQL, you should use
<CODE>mysqldump --opt</CODE> to take advantage of any optimizations that result
in a dump file that is smaller and can be processed faster.

</P>
<P>
The easiest (although not the fastest) way to move a database between two
machines is to run the following commands on the machine on which the
database is located:

</P>

<PRE>
shell&#62; mysqladmin -h 'other hostname' create db_name
shell&#62; mysqldump --opt db_name \
        | mysql -h 'other hostname' db_name
</PRE>

<P>
If you want to copy a database from a remote machine over a slow network,
you can use:

</P>

<PRE>
shell&#62; mysqladmin create db_name
shell&#62; mysqldump -h 'other hostname' --opt --compress db_name \
        | mysql db_name
</PRE>

<P>
You can also store the result in a file, then transfer the file to the
target machine and load the file into the database there.  For example,
you can dump a database to a file on the source machine like this:

</P>

<PRE>
shell&#62; mysqldump --quick db_name | gzip &#62; db_name.contents.gz
</PRE>

<P>
(The file created in this example is compressed.) Transfer the file
containing the database contents to the target machine and run these commands
there:

</P>

<PRE>
shell&#62; mysqladmin create db_name
shell&#62; gunzip &#60; db_name.contents.gz | mysql db_name
</PRE>

<P>
<A NAME="IDX357"></A>
<A NAME="IDX358"></A>
You can also use <CODE>mysqldump</CODE> and <CODE>mysqlimport</CODE> to transfer
the database.
For big tables, this is much faster than simply using <CODE>mysqldump</CODE>.
In the following commands, <CODE>DUMPDIR</CODE> represents the full pathname
of the directory you use to store the output from <CODE>mysqldump</CODE>.

</P>
<P>
First, create the directory for the output files and dump the database:

</P>

<PRE>
shell&#62; mkdir DUMPDIR
shell&#62; mysqldump --tab=DUMPDIR db_name
</PRE>

<P>
Then transfer the files in the <CODE>DUMPDIR</CODE> directory to some corresponding
directory on the target machine and load the files into MySQL
there:

</P>

<PRE>
shell&#62; mysqladmin create db_name           # create database
shell&#62; cat DUMPDIR/*.sql | mysql db_name   # create tables in database
shell&#62; mysqlimport db_name DUMPDIR/*.txt   # load data into tables
</PRE>

<P>
Also, don't forget to copy the <CODE>mysql</CODE> database because that is where the
<CODE>user</CODE>, <CODE>db</CODE>, and <CODE>host</CODE> grant tables are stored.  You may have
to run commands as the MySQL <CODE>root</CODE> user on the new machine
until you have the <CODE>mysql</CODE> database in place.

</P>
<P>
After you import the <CODE>mysql</CODE> database on the new machine, execute
<CODE>mysqladmin flush-privileges</CODE> so that the server reloads the grant table
information.

</P>



<H2><A NAME="Operating_System_Specific_Notes" HREF="manual_toc.html#Operating_System_Specific_Notes">2.6  Operating System-Specific Notes</A></H2>



<H3><A NAME="Linux" HREF="manual_toc.html#Linux">2.6.1  Linux Notes</A></H3>

<P>
This section discusses issues that have been found to occur on Linux.
The first few subsections describe general operating system-related issues,
problems that can occur when using binary or source distributions, and
post-installation issues. The remaining subsections discuss problems that occur
with Linux on specific platforms.

</P>
<P>
Note that most of these problems occur on older versions of Linux. If you are
running a recent version, you likely will see none of them.

</P>



<H4><A NAME="Linux-OS" HREF="manual_toc.html#Linux-OS">2.6.1.1  Linux Operating System Notes</A></H4>

<P>
MySQL needs at least Linux Version 2.0.

</P>
<P>
<STRONG>Warning:</STRONG>
We have seen some strange problems with Linux 2.2.14 and MySQL on SMP
systems.  We also have reports from some MySQL users that they have
encountered serious stability problems using MySQL with kernel 2.2.14.
If you are using this kernel, you should upgrade to 2.2.19 (or newer) or to
a 2.4 kernel.  If you have a multiple-CPU box, then you should seriously
consider using 2.4 because it will give you a significant speed boost.
Your system also will be more stable.

</P>

<P>
When using LinuxThreads, you will see a minimum of three <CODE>mysqld</CODE> processes
running.  These are in fact threads.  There will be one thread for the
LinuxThreads manager, one thread to handle connections, and one thread
to handle alarms and signals.

</P>



<H4><A NAME="Binary_notes-Linux" HREF="manual_toc.html#Binary_notes-Linux">2.6.1.2  Linux Binary Distribution Notes</A></H4>

<P>
<A NAME="IDX359"></A>
<A NAME="IDX360"></A>

</P>
<P>
The Linux-Intel binary and RPM releases of MySQL are configured
for the highest possible speed.  We are always trying to use the fastest
stable compiler available.

</P>
<P>
The binary release is linked with <CODE>-static</CODE>, which means you do not
normally need to worry about which version of the system libraries you
have. You need not install LinuxThreads, either.  A program linked with
<CODE>-static</CODE> is slightly larger than a dynamically linked program,
but also slightly faster (3-5%).  However, one problem with a statically
linked program is that you can't use user-defined functions (UDFs).
If you are going to write or use UDFs (this is something for C or C++
programmers only), you must compile MySQL yourself using dynamic linking.

</P>
<P>
A known issue with binary distributions is that on older Linux
systems that use <CODE>libc</CODE> (such as Red Hat 4.x or Slackware), you will get
some non-fatal problems with hostname resolution. If your system uses
<CODE>libc</CODE> rather than <CODE>glibc2</CODE>,
you probably will encounter some difficulties with hostname resolution and
<CODE>getpwnam()</CODE>. This happens because <CODE>glibc</CODE>
unfortunately depends on some external libraries to implement hostname
resolution and <CODE>getpwent()</CODE>, even when compiled with <CODE>-static</CODE>.
These problems manifest themselves in two ways:

</P>

<UL>
<LI>

You probably will see  the following error message when you run
<CODE>mysql_install_db</CODE>:


<PRE>
Sorry, the host 'xxxx' could not be looked up
</PRE>

You can deal with this by executing
<CODE>mysql_install_db --force</CODE>, which will not execute the
<CODE>resolveip</CODE> test in <CODE>mysql_install_db</CODE>.  The downside is that
you can't use hostnames in the grant tables: Except for <CODE>localhost</CODE>,
you must use IP numbers instead.  If you are using an old version of MySQL
that doesn't support <CODE>--force</CODE>, you must manually remove the
<CODE>resolveip</CODE> test in <CODE>mysql_install</CODE> using an editor.

<LI>

You also may see
the following error when you try to run <CODE>mysqld</CODE> with the <CODE>--user</CODE>
option:


<PRE>
getpwnam: No such file or directory
</PRE>

To work around this, start
<CODE>mysqld</CODE> with <CODE>su</CODE> rather than by specifying the <CODE>--user</CODE>
option. This causes the system itself to change the user ID of the
<CODE>mysqld</CODE> process so that <CODE>mysqld</CODE> need not do so.

</UL>

<P>
Another solution, which solves both problems, is to not use a binary
distribution.  Get a MySQL source distribution (in RPM or <CODE>tar.gz</CODE>
format) and install that instead.

</P>
<P>
On some Linux 2.2 versions, you may get the error <CODE>Resource
temporarily unavailable</CODE> when clients make a lot of new connections to
a <CODE>mysqld</CODE> server over TCP/IP.  The problem is that Linux has a
delay between the time that you close a TCP/IP socket and the time that
the system actually frees it.  There is room for only a finite number
of TCP/IP slots, so you will encounter the resource-unavailable error if
clients attempt too many new TCP/IP connections during a short time. For
example, you may see the error when you run the MySQL <TT>`test-connect'</TT>
benchmark over TCP/IP.

</P>
<P>
We have inquired about this problem a few times on different Linux mailing
lists but have never been able to find a suitable resolution.  The only
known ``fix'' is for the clients to use persistent connections, or,
if you are running the database server and clients on the same machine,
to use Unix socket file connections rather than TCP/IP connections.

</P>



<H4><A NAME="Source_notes-Linux" HREF="manual_toc.html#Source_notes-Linux">2.6.1.3  Linux Source Distribution Notes</A></H4>

<P>
<A NAME="IDX361"></A>
<A NAME="IDX362"></A>

</P>
<P>
The following notes regarding <CODE>glibc</CODE> apply only to the situation
when you build MySQL
yourself. If you are running Linux on an x86 machine, in most cases it is
much better for you to just use our binary. We link our binaries against
the best patched version of <CODE>glibc</CODE> we can come up with and with the
best compiler options, in an attempt to make it suitable for a high-load
server.  For a typical user, even for setups with a lot of concurrent
connections or tables exceeding the 2GB limit, our binary is
the best choice in most cases.  After reading the following text, if you
are in doubt about what to do, try our binary first to see whether it meets
your needs.  If you discover that it is not good enough, then
you may want to try your own build.  In that case, we would appreciate
a note about it so that we can build a better binary next time.

</P>
<P>
MySQL uses LinuxThreads on Linux.  If you are using an old
Linux version that doesn't have <CODE>glibc2</CODE>, you must install
LinuxThreads before trying to compile MySQL.   You can get
LinuxThreads at <a HREF="http://dev.mysql.com/downloads/os-linux.html">http://dev.mysql.com/downloads/os-linux.html</a>.

</P>
<P>
Note that <CODE>glibc</CODE> versions before and including Version 2.1.1 have
a fatal bug in <CODE>pthread_mutex_timedwait()</CODE> handling, which is used
when you issue <CODE>INSERT DELAYED</CODE> statements.  We recommend that you not use
<CODE>INSERT DELAYED</CODE> before upgrading <CODE>glibc</CODE>.

</P>
<P>
Note that Linux kernel and the LinuxThread library can by default
only have 1,024 threads.  If you plan to have more than 1,000 concurrent
connections, you will need to make some changes to LinuxThreads:

</P>

<UL>
<LI>

Increase <CODE>PTHREAD_THREADS_MAX</CODE> in
<TT>`sysdeps/unix/sysv/linux/bits/local_lim.h'</TT> to 4096 and decrease
<CODE>STACK_SIZE</CODE> in <TT>`linuxthreads/internals.h'</TT> to 256KB. The
paths are relative to the root of <CODE>glibc</CODE>. (Note that MySQL will
not be stable with around 600-1000 connections if <CODE>STACK_SIZE</CODE>
is the default of 2MB.)

<LI>

Recompile LinuxThreads to produce a new <TT>`libpthread.a'</TT> library,
and relink MySQL against it.

</UL>

<P>
The page <a HREF="http://www.volano.com/linuxnotes.html">http://www.volano.com/linuxnotes.html</a> contains additional
information about circumventing thread limits in LinuxThreads.

</P>
<P>
There is another issue that greatly hurts MySQL performance, especially on
SMP systems.  The mutex implementation in LinuxThreads in <CODE>glibc</CODE>
2.1 is very bad for programs with many threads that hold the mutex
only for a short time.  This produces a paradoxical result: If you link
MySQL against an unmodified LinuxThreads, removing processors from an
SMP actually improves MySQL performance in many cases.  We have made a
patch available for <CODE>glibc</CODE> 2.1.3 to correct this behavior
(<a HREF="http://www.mysql.com/Downloads/Linux/linuxthreads-2.1-patch">http://www.mysql.com/Downloads/Linux/linuxthreads-2.1-patch</a>).

</P>
<P>
With <CODE>glibc</CODE> 2.2.2,
MySQL 3.23.36 will use the adaptive mutex, which is much
better than even the patched one in <CODE>glibc</CODE> 2.1.3. Be warned, however,
that under some conditions, the current mutex code in <CODE>glibc</CODE> 2.2.2
overspins, which hurts MySQL performance. The likelihood that this condition
will occur can be reduced by renicing the <CODE>mysqld</CODE> process to the highest
priority. We have also been able to correct the overspin behavior with
a patch, available at
<a HREF="http://www.mysql.com/Downloads/Linux/linuxthreads-2.2.2.patch">http://www.mysql.com/Downloads/Linux/linuxthreads-2.2.2.patch</a>.
It combines the correction of overspin, maximum number of
threads, and stack spacing all in one. You will need to apply it in the
<CODE>linuxthreads</CODE> directory with
<CODE>patch -p0 &#60;/tmp/linuxthreads-2.2.2.patch</CODE>.
We hope it will be included in
some form in future releases of <CODE>glibc</CODE> 2.2. In any case, if
you link against <CODE>glibc</CODE> 2.2.2, you still need to correct
<CODE>STACK_SIZE</CODE> and <CODE>PTHREAD_THREADS_MAX</CODE>. We hope that the defaults
will be corrected to some more acceptable values for high-load
MySQL setup in the future, so that the commands needed to produce
your own build can be reduced to <CODE>./configure; make; make install</CODE>.

</P>
<P>
We recommend that you use these patches to build a special static
version of <CODE>libpthread.a</CODE> and use it only for statically linking
against MySQL. We know that the patches are safe for MySQL
and significantly improve its performance, but we cannot say anything
about other applications. If you link other applications that require
LinuxThreads against the
patched static version of the library, or build a patched shared version and
install it on your system, you do so at your own risk.

</P>
<P>
If you experience any strange problems during the installation of
MySQL, or with some common utilities hanging, it is very likely that
they are either library or compiler related. If this is the case, using our
binary will resolve them.

</P>
<P>
If you link your own MySQL client programs, you may see the following error at
runtime:

</P>

<PRE>
ld.so.1: fatal: libmysqlclient.so.#:
open failed: No such file or directory
</PRE>

<P>
This problem can be avoided by one of the following methods:

</P>

<UL>
<LI>

Link clients with the <CODE>-Wl,r/full/path/to/libmysqlclient.so</CODE>
flag rather than with <CODE>-Lpath</CODE>).

<LI>

Copy <CODE>libmysqclient.so</CODE> to <TT>`/usr/lib'</TT>.

<A NAME="IDX363"></A>
<A NAME="IDX364"></A>
<LI>

Add the pathname of the directory where <TT>`libmysqlclient.so'</TT> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable before running your client.
</UL>

<P>
If you are using the Fujitsu compiler (<CODE>fcc/FCC</CODE>), you will have
some problems compiling MySQL because the Linux header files are very
<CODE>gcc</CODE> oriented.
The following <CODE>configure</CODE> line should work with <CODE>fcc/FCC</CODE>:

</P>

<PRE>
CC=fcc CFLAGS="-O -K fast -K lib -K omitfp -Kpreex -D_GNU_SOURCE \
    -DCONST=const -DNO_STRTOLL_PROTO" \
CXX=FCC CXXFLAGS="-O -K fast -K lib \
    -K omitfp -K preex --no_exceptions --no_rtti -D_GNU_SOURCE \
    -DCONST=const -Dalloca=__builtin_alloca -DNO_STRTOLL_PROTO \
    '-D_EXTERN_INLINE=static __inline'" \
./configure \
    --prefix=/usr/local/mysql --enable-assembler \
    --with-mysqld-ldflags=-all-static --disable-shared \
    --with-low-memory
</PRE>



<H4><A NAME="Linux-post-install" HREF="manual_toc.html#Linux-post-install">2.6.1.4  Linux Post-Installation Notes</A></H4>

<P>
<CODE>mysql.server</CODE> can be found in the <TT>`support-files'</TT> directory under
the MySQL installation directory or in a MySQL source tree.  You can install
it as <TT>`/etc/init.d/mysql'</TT> for automatic MySQL startup and shutdown.
See section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.

</P>
<P>
If MySQL can't open enough files or connections, it may be that
you haven't configured Linux to handle enough files.

</P>
<P>
In Linux 2.2 and onward, you can check the number of allocated
file handles as follows:

</P>

<PRE>
shell&#62; cat /proc/sys/fs/file-max
shell&#62; cat /proc/sys/fs/dquot-max
shell&#62; cat /proc/sys/fs/super-max
</PRE>

<P>
If you have more than 16MB of memory, you should add something like the
following to your init scripts (for example, <TT>`/etc/init.d/boot.local'</TT> on SuSE Linux):

</P>

<PRE>
echo 65536 &#62; /proc/sys/fs/file-max
echo 8192 &#62; /proc/sys/fs/dquot-max
echo 1024 &#62; /proc/sys/fs/super-max
</PRE>

<P>
You can also run the <CODE>echo</CODE> commands from the command line as <CODE>root</CODE>,
but these settings will be lost the next time your computer restarts.

</P>
<P>
Alternatively, you can set these parameters on startup by using the
<CODE>sysctl</CODE> tool, which is used by many Linux distributions (SuSE has
added it as well, beginning with SuSE Linux 8.0). Just put the following
values into a file named <TT>`/etc/sysctl.conf'</TT>:

</P>

<PRE>
# Increase some values for MySQL
fs.file-max = 65536
fs.dquot-max = 8192
fs.super-max = 1024
</PRE>

<P>
You should also add the following to <TT>`/etc/my.cnf'</TT>:

</P>

<PRE>
[mysqld_safe]
open-files-limit=8192
</PRE>

<P>
This should allow the server a limit of 8,192 for the combined number of
connections and open files.

</P>
<P>
The <CODE>STACK_SIZE</CODE> constant in LinuxThreads controls the spacing of thread
stacks in the address space.  It needs to be large enough so that there will
be plenty of room for each individual thread stack, but small enough
to keep the stack of some threads from running into the global <CODE>mysqld</CODE>
data.  Unfortunately, as we have experimentally discovered, the Linux
implementation of <CODE>mmap()</CODE> will successfully unmap an already mapped
region if you ask it to map out an address already in use, zeroing out the data
on the entire page instead of returning an error.  So, the safety of
<CODE>mysqld</CODE> or any other threaded application depends on ``gentlemanly''
behavior of the code that creates threads.  The user must take measures to
make sure that the number of running threads at any time is sufficiently low for
thread stacks to stay away from the global heap.  With <CODE>mysqld</CODE>, you
should enforce this behavior by setting a reasonable value for
the <CODE>max_connections</CODE> variable.

</P>
<P>
If you build MySQL yourself, you can patch LinuxThreads for better stack use.
See section <A HREF="manual.html#Source_notes-Linux">2.6.1.3  Linux Source Distribution Notes</A>.
If you do not want to patch
LinuxThreads, you should set <CODE>max_connections</CODE> to a value no higher
than 500.  It should be even less if you have a large key buffer,  large
heap tables, or some other things that make <CODE>mysqld</CODE> allocate a lot
of memory, or if you are running a 2.2 kernel with a 2GB patch. If you are
using our binary or RPM version 3.23.25 or later, you can safely set
<CODE>max_connections</CODE> at 1500, assuming no large key buffer or heap tables
with lots of data.  The more you reduce <CODE>STACK_SIZE</CODE> in LinuxThreads
the more threads you can safely create.  We recommend values between
128KB and 256KB.

</P>
<P>
If you use a lot of concurrent connections, you may suffer from a ``feature''
in the 2.2 kernel that attempts to prevent fork bomb attacks by penalizing
a process for forking or cloning a child.  This causes MySQL
not to scale well as you increase the number of concurrent clients.  On
single-CPU systems, we have seen this manifested as very slow thread
creation: It may take a long time to connect to MySQL
(as long as one minute), and it may take just as long to shut it down.  On
multiple-CPU systems, we have observed a gradual drop in query speed as
the number of clients increases.  In the process of trying to find a
solution, we have received a kernel patch from one of our users who
claimed it made a lot of difference for his site.  The patch is available at
<a HREF="http://www.mysql.com/Downloads/Patches/linux-fork.patch">http://www.mysql.com/Downloads/Patches/linux-fork.patch</a>. We have
now done rather extensive testing of this patch on both development and
production systems.  It has significantly
improved MySQL performance without causing any problems and we now
recommend it to our users who still run high-load servers on
2.2 kernels.

</P>
<P>
This issue has been fixed in the 2.4 kernel, so if you are not satisfied
with the current performance of your system, rather than patching
your 2.2 kernel, it might be easier to upgrade to 2.4. On SMP systems,
upgrading also will give you a nice SMP boost in addition to fixing the
fairness bug.

</P>
<P>
We have tested MySQL on the 2.4 kernel on a two-CPU machine and found MySQL
scales <STRONG>much</STRONG> better. There was virtually no slowdown on query
throughput all the way up to 1,000 clients, and the MySQL scaling factor
(computed as the ratio of maximum throughput to the throughput for one
client) was 180%.  We have observed similar results on a four-CPU system:
Virtually no slowdown as the number of clients was increased up to 1,000,
and a 300% scaling factor. Based on these results, for a high-load SMP
server using a 2.2 kernel, we definitely recommend upgrading to the 2.4
kernel at this point.

</P>
<P>
We have discovered that it is essential to run the <CODE>mysqld</CODE> process
with the highest possible priority on the 2.4 kernel to achieve maximum
performance.  This can be done by adding a <CODE>renice -20 $$</CODE> command
to <CODE>mysqld_safe</CODE>. In our testing on a four-CPU machine, increasing
the priority resulted in a 60% throughput increase with 400 clients.

</P>
<P>
We are currently also trying to collect more information on how well
MySQL performs with a 2.4 kernel on four-way and eight-way systems. If you have
access such a system and have done some benchmarks, please send an email
message to <a HREF="mailto:benchmarks@mysql.com">benchmarks@mysql.com</a> with the results. We will review
them for inclusion in the manual.

</P>
<P>
If you see a dead <CODE>mysqld</CODE> server process with <CODE>ps</CODE>, this usually
means that you have found a bug in MySQL or you have a corrupted
table. See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
To get a core dump on Linux if <CODE>mysqld</CODE> dies with a <CODE>SIGSEGV</CODE> signal,
you can start <CODE>mysqld</CODE> with the <CODE>--core-file</CODE> option.  Note
that you also probably need to raise the core file size by adding
<CODE>ulimit -c 1000000</CODE> to <CODE>mysqld_safe</CODE> or starting
<CODE>mysqld_safe</CODE> with <CODE>--core-file-size=1000000</CODE>.
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>



<H4><A NAME="Linux-x86" HREF="manual_toc.html#Linux-x86">2.6.1.5  Linux x86 Notes</A></H4>

<P>
MySQL requires <CODE>libc</CODE> Version 5.4.12 or newer. It's known to
work with <CODE>libc</CODE> 5.4.46.  <CODE>glibc</CODE> Version 2.0.6 and later should
also work. There have been some problems with the <CODE>glibc</CODE> RPMs from
Red Hat, so if you have problems, check whether there are any updates.
The <CODE>glibc</CODE> 2.0.7-19 and 2.0.7-29 RPMs are known to work.

</P>
<P>
If you are using Red Hat 8.0 or a new <CODE>glibc</CODE> 2.2.x library, you may see
<CODE>mysqld</CODE> die in <CODE>gethostbyaddr()</CODE>. This happens because the new
<CODE>glibc</CODE> library requires a stack size greater than 128KB for this call.
To fix the problem, start <CODE>mysqld</CODE> with the <CODE>--thread-stack=192K</CODE>
option.  (Use <CODE>-O thread_stack=192K</CODE> before MySQL 4.)
This stack size is now the default on MySQL 4.0.10 and above, so you should
not see the problem.

</P>
<P>
If you are using <CODE>gcc</CODE> 3.0 and above to compile MySQL, you must install
the <CODE>libstdc++v3</CODE> library before compiling MySQL; if you don't do
this, you will get an error about a missing <CODE>__cxa_pure_virtual</CODE>
symbol during linking.

</P>
<P>
On some older Linux distributions, <CODE>configure</CODE> may produce an error
like this:

</P>

<PRE>
Syntax error in sched.h. Change _P to __P in the
/usr/include/sched.h file.
See the Installation chapter in the Reference Manual.
</PRE>

<P>
Just do what the error message says. Add an extra underscore to the
<CODE>_P</CODE> macro name that has only one underscore, then try again.

</P>
<P>
You may get some warnings when compiling. Those shown here can be ignored:

</P>

<PRE>
mysqld.cc -o objs-thread/mysqld.o
mysqld.cc: In function `void init_signals()':
mysqld.cc:315: warning: assignment of negative value `-1' to
`long unsigned int'
mysqld.cc: In function `void * signal_hand(void *)':
mysqld.cc:346: warning: assignment of negative value `-1' to
`long unsigned int'
</PRE>

<P>
If <CODE>mysqld</CODE> always dumps core when it starts, the problem may be that
you have an old <TT>`/lib/libc.a'</TT>.  Try renaming it, then remove
<TT>`sql/mysqld'</TT> and do a new <CODE>make install</CODE> and try again.  This
problem has been reported on some Slackware installations.

</P>
<P>
If you get the following error when linking <CODE>mysqld</CODE>,
it means that your <TT>`libg++.a'</TT> is not installed correctly:

</P>

<PRE>
/usr/lib/libc.a(putc.o): In function `_IO_putc':
putc.o(.text+0x0): multiple definition of `_IO_putc'
</PRE>

<P>
You can avoid using <TT>`libg++.a'</TT> by running <CODE>configure</CODE> like this:

</P>

<PRE>
shell&#62; CXX=gcc ./configure
</PRE>

<P>
If <CODE>mysqld</CODE> crashes immediately and you are running Red Hat Version 5.0
with a version of <CODE>glibc</CODE> older than 2.0.7-5, you should make sure that
you have installed all <CODE>glibc</CODE> patches.  There is a lot of information
about this in the MySQL mail archives, available online at
<a HREF="http://lists.mysql.com/">http://lists.mysql.com/</a>.

</P>



<H4><A NAME="Linux-SPARC" HREF="manual_toc.html#Linux-SPARC">2.6.1.6  Linux SPARC Notes</A></H4>

<P>
In some implementations, <CODE>readdir_r()</CODE> is broken.  The symptom is
that the <CODE>SHOW DATABASES</CODE> statement always returns an empty set.
This can be fixed by removing <CODE>HAVE_READDIR_R</CODE> from <TT>`config.h'</TT>
after configuring and before compiling.

</P>



<H4><A NAME="Linux-Alpha" HREF="manual_toc.html#Linux-Alpha">2.6.1.7  Linux Alpha Notes</A></H4>

<P>
MySQL 3.23.12 is the first MySQL version that is
tested on Linux-Alpha.  If you plan to use MySQL on Linux-Alpha,
you should ensure that you have this version or newer.

</P>
<P>
We have tested MySQL on Alpha with our benchmarks and test suite,
and it appears to work nicely. 

</P>
<P>
We currently build the MySQL binary packages on SuSE Linux 7.0 for AXP,
kernel 2.4.4-SMP, Compaq C compiler (V6.2-505) and Compaq C++ compiler
(V6.3-006) on a Compaq DS20 machine with an Alpha EV6 processor.

</P>
<P>
You can find the preceding compilers at
<a HREF="http://www.support.compaq.com/alpha-tools/">http://www.support.compaq.com/alpha-tools/</a>.  By using these compilers
rather than <CODE>gcc</CODE>, we get about 9-14% better MySQL performance.

</P>
<P>
Note that until MySQL version 3.23.52 and 4.0.2, we optimized the binary for
the current CPU only (by using the <CODE>-fast</CODE> compile option). This means
that for older versions, you can use our Alpha binaries only if you have an
Alpha EV6 processor.

</P>
<P>
For all following releases, we added the <CODE>-arch generic</CODE> flag
to our compile options, which makes sure that the binary runs on all Alpha
processors. We also compile statically to avoid library problems.
The <CODE>configure</CODE> command looks like this:

</P>

<PRE>
CC=ccc CFLAGS="-fast -arch generic" CXX=cxx \
CXXFLAGS="-fast -arch generic -noexceptions -nortti" \
./configure --prefix=/usr/local/mysql --disable-shared \
    --with-extra-charsets=complex --enable-thread-safe-client \
    --with-mysqld-ldflags=-non_shared --with-client-ldflags=-non_shared
</PRE>

<P>
If you want to use <CODE>egcs</CODE>, the following <CODE>configure</CODE> line worked
for us:

</P>

<PRE>
CFLAGS="-O3 -fomit-frame-pointer" CXX=gcc \
CXXFLAGS="-O3 -fomit-frame-pointer -felide-constructors \
    -fno-exceptions -fno-rtti" \
./configure --prefix=/usr/local/mysql --disable-shared
</PRE>

<P>
Some known problems when running MySQL on Linux-Alpha:

</P>

<UL>
<LI>

Debugging threaded applications like MySQL will not work with
<CODE>gdb 4.18</CODE>.  You should use <CODE>gdb</CODE> 5.1 instead!

<LI>

If you try linking <CODE>mysqld</CODE> statically when using <CODE>gcc</CODE>, the
resulting image will dump core at startup time.  In other words, <EM>do not</EM>
use <CODE>--with-mysqld-ldflags=-all-static</CODE> with <CODE>gcc</CODE>.
</UL>



<H4><A NAME="Linux-PowerPC" HREF="manual_toc.html#Linux-PowerPC">2.6.1.8  Linux PowerPC Notes</A></H4>

<P>
MySQL should work on MkLinux with the newest <CODE>glibc</CODE> package
(tested with <CODE>glibc</CODE> 2.0.7).

</P>



<H4><A NAME="Linux-MIPS" HREF="manual_toc.html#Linux-MIPS">2.6.1.9  Linux MIPS Notes</A></H4>

<P>
To get MySQL to work on Qube2 (Linux Mips), you need the
newest <CODE>glibc</CODE> libraries. <CODE>glibc-2.0.7-29C2</CODE> is known to
work.  You must also use the <CODE>egcs</CODE> C++ compiler
(<CODE>egcs-1.0.2-9</CODE>, <CODE>gcc 2.95.2</CODE> or newer).

</P>



<H4><A NAME="Linux-IA-64" HREF="manual_toc.html#Linux-IA-64">2.6.1.10  Linux IA-64 Notes</A></H4>

<P>
To get MySQL to compile on Linux IA-64, we use the following <CODE>configure</CODE>
command for building with <CODE>gcc</CODE> 2.96:

</P>

<PRE>
CC=gcc \
CFLAGS="-O3 -fno-omit-frame-pointer" \
CXX=gcc \
CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors \
    -fno-exceptions -fno-rtti" \
    ./configure --prefix=/usr/local/mysql \
    "--with-comment=Official MySQL binary" \
    --with-extra-charsets=complex
</PRE>

<P>
On IA-64, the MySQL client binaries use shared libraries. This means
that if you install our binary distribution at a location other than
<TT>`/usr/local/mysql'</TT>, you need to add the path of the directory
where you have <TT>`libmysqlclient.so'</TT> installed either to the
<TT>`/etc/ld.so.conf'</TT> file or to the value of your <CODE>LD_LIBRARY_PATH</CODE>
environment variable.

</P>
<P>
See section <A HREF="manual.html#Link_errors">A.3.1  Problems Linking to the MySQL Client Library</A>.

</P>



<H3><A NAME="Mac_OS_X" HREF="manual_toc.html#Mac_OS_X">2.6.2  Mac OS X Notes</A></H3>

<P>
On Mac OS X, <CODE>tar</CODE> cannot handle long filenames. If you need to unpack a
<TT>`.tar.gz'</TT> distribution, use <CODE>gnutar</CODE> instead.

</P>



<H4><A NAME="Mac_OS_X_10.x" HREF="manual_toc.html#Mac_OS_X_10.x">2.6.2.1  Mac OS X 10.x (Darwin)</A></H4>

<P>
MySQL should work without any problems on Mac OS X 10.x 
(Darwin).

</P>
<P>
Our binary for Mac OS X is compiled on Darwin 6.3 with the following
<CODE>configure</CODE> line:

</P>

<PRE>
CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc \
CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors \
    -fno-exceptions -fno-rtti" \
    ./configure --prefix=/usr/local/mysql \
    --with-extra-charsets=complex --enable-thread-safe-client \
    --enable-local-infile --disable-shared
</PRE>

<P>
See section <A HREF="manual.html#Mac_OS_X_installation">2.2.3  Installing MySQL on Mac OS X</A>.

</P>


<H4><A NAME="Mac_OS_X_Server" HREF="manual_toc.html#Mac_OS_X_Server">2.6.2.2  Mac OS X Server 1.2 (Rhapsody)</A></H4>

<P>
For current versions of Mac OS X Server, no operating system changes are
necessary before compiling MySQL.  Compiling for the Server platform is
the same as for the client version of Mac OS X. (However, note that MySQL
comes preinstalled on Mac OS X Server, so you need not build it yourself.)

</P>
<P>
For older versions (Mac OS X Server 1.2, a.k.a. Rhapsody), you must
first install a pthread package before trying to configure MySQL.

</P>

<P>
See section <A HREF="manual.html#Mac_OS_X_installation">2.2.3  Installing MySQL on Mac OS X</A>.

</P>



<H3><A NAME="Solaris" HREF="manual_toc.html#Solaris">2.6.3  Solaris Notes</A></H3>

<P>
<A NAME="IDX365"></A>
<A NAME="IDX366"></A>
<A NAME="IDX367"></A>
<A NAME="IDX368"></A>
<A NAME="IDX369"></A>

</P>
<P>
On Solaris, you may run into trouble even before you get the MySQL
distribution unpacked!  Solaris <CODE>tar</CODE> can't handle long file names, so
you may see an error like this when you unpack MySQL:

</P>

<PRE>
x mysql-3.22.12-beta/bench/Results/ATIS-mysql_odbc-NT_4.0-cmp-db2,
informix,ms-sql,mysql,oracle,solid,sybase, 0 bytes, 0 tape blocks
tar: directory checksum error
</PRE>

<P>
In this case, you must use GNU <CODE>tar</CODE> (<CODE>gtar</CODE>) to unpack the
distribution.  You can find a precompiled copy for Solaris at
<a HREF="http://dev.mysql.com/downloads/os-solaris.html">http://dev.mysql.com/downloads/os-solaris.html</a>.

</P>
<P>
Sun native threads work only on Solaris 2.5 and higher.  For Version 2.4 and
earlier, MySQL automatically uses MIT-pthreads.
See section <A HREF="manual.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A>.

</P>
<P>
If you get the following error from <CODE>configure</CODE>,
it means that you have something wrong with your compiler installation:

</P>

<PRE>
checking for restartable system calls... configure: error can not
run test programs while cross compiling
</PRE>

<P>
In this case, you should upgrade your compiler to a newer version.  You may
also be able to solve this problem by inserting the following row into the
<TT>`config.cache'</TT> file:

</P>

<PRE>
ac_cv_sys_restartable_syscalls=${ac_cv_sys_restartable_syscalls='no'}
</PRE>

<P>
If you are using Solaris on a SPARC, the recommended compiler is
<CODE>gcc</CODE> 2.95.2 or 3.2. You can find this at <a HREF="http://gcc.gnu.org/">http://gcc.gnu.org/</a>.
Note that <CODE>egcs</CODE> 1.1.1 and <CODE>gcc</CODE> 2.8.1 don't work reliably on
SPARC!

</P>
<P>
The recommended <CODE>configure</CODE> line when using <CODE>gcc</CODE> 2.95.2 is:

</P>

<PRE>
CC=gcc CFLAGS="-O3" \
CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti" \
./configure --prefix=/usr/local/mysql --with-low-memory \
    --enable-assembler
</PRE>

<P>
If you have an UltraSPARC system, you can get 4% better performance by adding
<CODE>-mcpu=v8 -Wa,-xarch=v8plusa</CODE> to the <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE>
environment variables.

</P>
<P>
If you have Sun's Forte 5.0 (or newer) compiler, you can
run <CODE>configure</CODE> like this:

</P>

<PRE>
CC=cc CFLAGS="-Xa -fast -native -xstrconst -mt" \
CXX=CC CXXFLAGS="-noex -mt" \
./configure --prefix=/usr/local/mysql --enable-assembler
</PRE>

<P>
To create a 64-bit binary with Sun's Forte compiler, use the
following configuration options:

</P>

<PRE>
CC=cc CFLAGS="-Xa -fast -native -xstrconst -mt -xarch=v9" \
CXX=CC CXXFLAGS="-noex -mt -xarch=v9" ASFLAGS="-xarch=v9" \
./configure --prefix=/usr/local/mysql --enable-assembler
</PRE>

<P>
To create a 64-bit Solaris binary using <CODE>gcc</CODE>, add <CODE>-m64</CODE> to
<CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE>. This works only with MySQL
4.0 and up; MySQL 3.23 does not include the required modifications to
support this.

</P>
<P>
In the MySQL benchmarks, we got a 4% speedup on an UltraSPARC when using
Forte 5.0 in 32-bit mode compared to using <CODE>gcc</CODE> 3.2 with the <CODE>-mcpu</CODE>
flag.

</P>
<P>
If you create a 64-bit <CODE>mysqld</CODE> binary, it is 4% slower than the 32-bit
binary, but can handle more threads and memory.

</P>
<P>
If you get a problem with <CODE>fdatasync</CODE> or <CODE>sched_yield</CODE>,
you can fix this by adding <CODE>LIBS=-lrt</CODE> to the configure line

</P>
<P>
For compilers older than WorkShop 5.3, you might have to edit the
<CODE>configure</CODE> script. Change this line:

</P>

<PRE>
#if !defined(__STDC__) || __STDC__ != 1
</PRE>

<P>
To this:

</P>

<PRE>
#if !defined(__STDC__)
</PRE>

<P>
If you turn on <CODE>__STDC__</CODE> with the <CODE>-Xc</CODE> option, the Sun compiler
can't compile with the Solaris <TT>`pthread.h'</TT> header file.  This is a Sun
bug (broken compiler or broken include file).

</P>
<P>
If <CODE>mysqld</CODE> issues the following error message when you run it, you have
tried to compile MySQL with the Sun compiler without enabling the <CODE>-mt</CODE>
multi-thread option:

</P>

<PRE>
libc internal error: _rmutex_unlock: rmutex not held
</PRE>

<P>
Add <CODE>-mt</CODE> to <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE> and recompile.

</P>
<P>
If you are using the SFW version of <CODE>gcc</CODE> (which comes with Solaris 8),
you must add <TT>`/opt/sfw/lib'</TT> to the environment variable
<CODE>LD_LIBRARY_PATH</CODE> before running <CODE>configure</CODE>.

</P>
<P>
If you are using the <CODE>gcc</CODE> available from <CODE>sunfreeware.com</CODE>, you may
have many problems.  To avoid this, you should recompile <CODE>gcc</CODE> and GNU
<CODE>binutils</CODE> on the machine where you will be running them.

</P>
<P>
If you get the following error when compiling MySQL with <CODE>gcc</CODE>,
it means that your <CODE>gcc</CODE> is not configured for your version of Solaris:

</P>

<PRE>
shell&#62; gcc -O3 -g -O2 -DDBUG_OFF  -o thr_alarm ...
./thr_alarm.c: In function `signal_hand':
./thr_alarm.c:556: too many arguments to function `sigwait'
</PRE>

<P>
The proper thing to do in this case is to get the newest version of
<CODE>gcc</CODE> and compile it with your current <CODE>gcc</CODE> compiler.  At
least for Solaris 2.5, almost all binary versions of <CODE>gcc</CODE> have
old, unusable include files that will break all programs that use
threads, and possibly other programs!

</P>
<P>
Solaris doesn't provide static versions of all system libraries
(<CODE>libpthreads</CODE> and <CODE>libdl</CODE>), so you can't compile MySQL
with <CODE>--static</CODE>.  If you try to do so, you will get one of the following
errors:

</P>

<PRE>
ld: fatal: library -ldl: not found
undefined reference to `dlopen'
cannot find -lrt
</PRE>

<P>
If you link your own MySQL client programs, you may see the following error at
runtime:

</P>

<PRE>
ld.so.1: fatal: libmysqlclient.so.#:
open failed: No such file or directory
</PRE>

<P>
This problem can be avoided by one of the following methods:

</P>

<UL>
<LI>

Link clients with the <CODE>-Wl,r/full/path/to/libmysqlclient.so</CODE>
flag rather than with <CODE>-Lpath</CODE>).

<LI>

Copy <CODE>libmysqclient.so</CODE> to <TT>`/usr/lib'</TT>.

<A NAME="IDX370"></A>
<A NAME="IDX371"></A>
<LI>

Add the pathname of the directory where <TT>`libmysqlclient.so'</TT> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable before running your client.
</UL>

<P>
If you have problems with <CODE>configure</CODE> trying to link with <CODE>-lz</CODE> when
you don't have <CODE>zlib</CODE> installed, you have two options:

</P>

<UL>
<LI>

If you want to be able to use the compressed communication protocol,
you need to get and install <CODE>zlib</CODE> from <CODE>ftp.gnu.org</CODE>.

<LI>

Run <CODE>configure</CODE> with the <CODE>--with-named-z-libs=no</CODE> option when
building MySQL.
</UL>

<P>
If you are using <CODE>gcc</CODE> and have problems with loading user-defined
functions (UDFs) into MySQL, try adding <CODE>-lgcc</CODE> to the link line
for the UDF.

</P>
<P>
If you would like MySQL to start automatically, you can copy
<TT>`support-files/mysql.server'</TT> to <TT>`/etc/init.d'</TT> and create a
symbolic link to it named <TT>`/etc/rc3.d/S99mysql.server'</TT>.

</P>
<P>
If too many processes try to connect very rapidly to <CODE>mysqld</CODE>, you will
see this error in the MySQL log:

</P>

<PRE>
Error in accept: Protocol error
</PRE>

<P>
You might try starting the server with the <CODE>--back_log=50</CODE>
option as a workaround for this.  (Use <CODE>-O back_log=50</CODE> before MySQL 4.)

</P>
<P>
Solaris doesn't support core files for <CODE>setuid()</CODE> applications, so
you can't get a core file from <CODE>mysqld</CODE> if you are using the
<CODE>--user</CODE> option.

</P>



<H4><A NAME="Solaris_2.7" HREF="manual_toc.html#Solaris_2.7">2.6.3.1  Solaris 2.7/2.8 Notes</A></H4>

<P>
Normally, you can use a Solaris 2.6 binary on Solaris 2.7 and 2.8.  Most
of the Solaris 2.6 issues also apply for Solaris 2.7 and 2.8.

</P>
<P>
MySQL 3.23.4 and above should be able to detect new versions of
Solaris automatically and enable workarounds for the following problems.

</P>
<P>
Solaris 2.7 / 2.8 has some bugs in the include files.  You may see the
following error when you use <CODE>gcc</CODE>:

</P>

<PRE>
/usr/include/widec.h:42: warning: `getwc' redefined
/usr/include/wchar.h:326: warning: this is the location of the previous
definition
</PRE>

<P>
If this occurs, you can fix the problem by copying
<CODE>/usr/include/widec.h</CODE> to
<CODE>.../lib/gcc-lib/os/gcc-version/include</CODE> and changing line 41 from this:

</P>

<PRE>
#if     !defined(lint) &#38;& !defined(__lint)
</PRE>

<P>
To this:

</P>

<PRE>
#if     !defined(lint) &#38;& !defined(__lint) &#38;& !defined(getwc)
</PRE>

<P>
Alternatively, you can edit <TT>`/usr/include/widec.h'</TT> directly.  Either
way, after you make the fix, you should remove <TT>`config.cache'</TT> and run
<CODE>configure</CODE> again.

</P>
<P>
If you get the following errors when you run <CODE>make</CODE>, it's because
<CODE>configure</CODE> didn't detect the <TT>`curses.h'</TT> file (probably
because of the error in <TT>`/usr/include/widec.h'</TT>):

</P>

<PRE>
In file included from mysql.cc:50:
/usr/include/term.h:1060: syntax error before `,'
/usr/include/term.h:1081: syntax error before `;'
</PRE>

<P>
The solution to this problem is to do one of the following:

</P>

<UL>
<LI>

Configure with <CODE>CFLAGS=-DHAVE_CURSES_H CXXFLAGS=-DHAVE_CURSES_H ./configure</CODE>.

<LI>

Edit <TT>`/usr/include/widec.h'</TT> as indicated in the preceding discussion
and re-run <CODE>configure</CODE>.

<LI>

Remove the <CODE>#define HAVE_TERM</CODE> line from the <TT>`config.h'</TT> file and
run <CODE>make</CODE> again.
</UL>

<P>
If your linker can't find <CODE>-lz</CODE> when linking
client programs, the problem is probably that your <TT>`libz.so'</TT> file is
installed in <TT>`/usr/local/lib'</TT>.  You can fix this problem by one of the
following methods:

</P>

<UL>
<LI>

Add <TT>`/usr/local/lib'</TT> to <CODE>LD_LIBRARY_PATH</CODE>.

<LI>

Add a link to <TT>`libz.so'</TT> from <TT>`/lib'</TT>.

<LI>

If you are using Solaris 8, you can install the optional <CODE>zlib</CODE> from your
Solaris 8 CD distribution.

<LI>

Run <CODE>configure</CODE> with the <CODE>--with-named-z-libs=no</CODE> option when
building MySQL.
</UL>



<H4><A NAME="Solaris_x86" HREF="manual_toc.html#Solaris_x86">2.6.3.2  Solaris x86 Notes</A></H4>

<P>
On Solaris 8 on x86, <CODE>mysqld</CODE> will dump core if you remove the
debug symbols using <CODE>strip</CODE>.

</P>
<P>
If you are using <CODE>gcc</CODE> or <CODE>egcs</CODE> on Solaris x86 and you
experience problems with core dumps under load, you should use the
following <CODE>configure</CODE> command:

</P>

<PRE>
CC=gcc CFLAGS="-O3 -fomit-frame-pointer -DHAVE_CURSES_H" \
CXX=gcc \
CXXFLAGS="-O3 -fomit-frame-pointer -felide-constructors \
    -fno-exceptions -fno-rtti -DHAVE_CURSES_H" \
./configure --prefix=/usr/local/mysql
</PRE>

<P>
This will avoid problems with the <CODE>libstdc++</CODE> library and with C++
exceptions.

</P>
<P>
If this doesn't help, you should compile a debug version and run
it with a trace file or under <CODE>gdb</CODE>.
See section <A HREF="manual.html#Using_gdb_on_mysqld">D.1.3  Debugging <CODE>mysqld</CODE> under <CODE>gdb</CODE></A>.

</P>



<H3><A NAME="BSD_Notes" HREF="manual_toc.html#BSD_Notes">2.6.4  BSD Notes</A></H3>

<P>
This section provides information about using MySQL on variants of BSD Unix.

</P>



<H4><A NAME="FreeBSD" HREF="manual_toc.html#FreeBSD">2.6.4.1  FreeBSD Notes</A></H4>

<P>
FreeBSD 4.x or newer is recommended for running MySQL, because the thread
package is much more integrated.
To get a secure and stable system, you should use only FreeBSD kernels
that are marked <CODE>-RELEASE</CODE>.

</P>
<P>
The easiest (and preferred) way to install MySQL is to use the
<CODE>mysql-server</CODE> and <CODE>mysql-client</CODE> ports available at
<a HREF="http://www.freebsd.org/">http://www.freebsd.org/</a>.
Using these ports gives you the following benefits:

</P>

<UL>
<LI>

A working MySQL with all optimizations enabled that are known to work on your
version of FreeBSD.

<LI>

Automatic configuration and build.

<LI>

Startup scripts installed in <TT>`/usr/local/etc/rc.d'</TT>.

<LI>

The ability to use <CODE>pkg_info -L</CODE> to see which files are installed.

<LI>

The ability to use <CODE>pkg_delete</CODE> to remove MySQL if you no longer want it
on your machine.
</UL>

<P>
It is recommended you use MIT-pthreads on FreeBSD 2.x, and native threads on
Versions 3 and up. It is possible to run with native threads on some late
2.2.x versions, but you may encounter problems shutting down <CODE>mysqld</CODE>.

</P>
<P>
Unfortunately, certain function calls on FreeBSD are not yet fully thread-safe.
Most notably, this includes the <CODE>gethostbyname()</CODE> function, which is
used by MySQL to convert hostnames into IP addresses. Under certain
circumstances, the <CODE>mysqld</CODE> process will suddenly cause 100%
CPU load and will be unresponsive. If you encounter this problem, try to start
MySQL using the <CODE>--skip-name-resolve</CODE> option.

</P>
<P>
Alternatively, you can link MySQL on FreeBSD 4.x against the LinuxThreads
library, which avoids a few of the problems that the native FreeBSD thread
implementation has. For a very good comparison of LinuxThreads versus native
threads, see Jeremy Zawodny's article <CITE>FreeBSD or Linux for your
MySQL Server?</CITE> at
<a HREF="http://jeremy.zawodny.com/blog/archives/000697.html">http://jeremy.zawodny.com/blog/archives/000697.html</a>.

</P>
<P>
A known problem when using LinuxThreads on FreeBSD is that
<CODE>wait_timeout</CODE> is not working (probably a signal handling problem in
FreeBSD/LinuxThreads).  This is supposed to be fixed in FreeBSD 5.0.
The symptom is that persistent connections can hang for a very long
time without getting closed down.

</P>
<P>
The MySQL build process requires GNU make (<CODE>gmake</CODE>) to work.  If
GNU <CODE>make</CODE> is not available, you must install it first before compiling
MySQL.

</P>
<P>
The recommended way to compile and install MySQL on FreeBSD with
<CODE>gcc</CODE> (2.95.2 and up) is:

</P>

<PRE>
CC=gcc CFLAGS="-O2 -fno-strength-reduce" \
    CXX=gcc CXXFLAGS="-O2 -fno-rtti -fno-exceptions \
    -felide-constructors -fno-strength-reduce" \
    ./configure --prefix=/usr/local/mysql --enable-assembler
gmake
gmake install
cd /usr/local/mysql
bin/mysql_install_db --user=mysql
bin/mysqld_safe &#38;
</PRE>

<P>
If you notice that <CODE>configure</CODE> will use MIT-pthreads, you should read
the MIT-pthreads notes.  See section <A HREF="manual.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A>.

</P>
<P>
If you get an error from <CODE>make install</CODE> that it can't find
<TT>`/usr/include/pthreads'</TT>, <CODE>configure</CODE> didn't detect that you need
MIT-pthreads. To fix this problem, remove <TT>`config.cache'</TT>, then re-run
<CODE>configure</CODE> with the <CODE>--with-mit-threads</CODE> option.

</P>

<P>
Be sure that your name resolver setup is correct.  Otherwise, you may
experience resolver delays or failures when connecting to <CODE>mysqld</CODE>.
Also make sure that the <CODE>localhost</CODE> entry in the <TT>`/etc/hosts'</TT> file is
correct.  The file should start with a line similar to this:

</P>

<PRE>
127.0.0.1       localhost localhost.your.domain
</PRE>

<P>
FreeBSD is known to have a very low default file handle limit.
See section <A HREF="manual.html#Not_enough_file_handles">A.2.17  File Not Found</A>.  Start the server by using the
<CODE>--open-files-limit</CODE> option for <CODE>mysqld_safe</CODE>, or raise
the limits for the <CODE>mysqld</CODE> user in <TT>`/etc/login.conf'</TT> and
rebuild it with <CODE>cap_mkdb /etc/login.conf</CODE>.  Also be sure that you set
the appropriate class for this user in the password file if you are not
using the default (use <CODE>chpass mysqld-user-name</CODE>).
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>
<P>
If you have a lot of memory, you should consider rebuilding
the kernel to allow MySQL to use more than 512MB of RAM.
Take a look at <CODE>option MAXDSIZ</CODE> in the LINT config
file for more information.

</P>
<P>
If you get problems with the current date in MySQL, setting the
<CODE>TZ</CODE> variable will probably help.  See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</P>



<H4><A NAME="NetBSD" HREF="manual_toc.html#NetBSD">2.6.4.2  NetBSD Notes</A></H4>

<P>
To compile on NetBSD, you need GNU <CODE>make</CODE>. Otherwise, the build process will
fail when <CODE>make</CODE> tries to run <CODE>lint</CODE> on C++ files.

</P>



<H4><A NAME="OpenBSD" HREF="manual_toc.html#OpenBSD">2.6.4.3  OpenBSD 2.5 Notes</A></H4>

<P>
On OpenBSD Version 2.5, you can compile MySQL with native threads
with the following options:

</P>

<PRE>
CFLAGS=-pthread CXXFLAGS=-pthread ./configure --with-mit-threads=no
</PRE>



<H4><A NAME="OpenBSD_2.8" HREF="manual_toc.html#OpenBSD_2.8">2.6.4.4  OpenBSD 2.8 Notes</A></H4>

<P>
Our users have reported that OpenBSD 2.8 has a threading bug that causes
problems with MySQL.  The OpenBSD Developers have fixed the problem,
but as of January 25, 2001, it's only available in the ``-current'' branch.
The symptoms of this threading bug are slow response, high load, high CPU
usage, and crashes.

</P>
<P>
If you get an error like <CODE>Error in accept:: Bad file descriptor</CODE> or
error 9 when trying to open tables or directories, the problem is probably
that you have not allocated enough file descriptors for MySQL.

</P>
<P>
In this case, try starting <CODE>mysqld_safe</CODE> as <CODE>root</CODE> with the following
options:

</P>

<PRE>
mysqld_safe --user=mysql --open-files-limit=2048 &#38;
</PRE>



<H4><A NAME="BSDI" HREF="manual_toc.html#BSDI">2.6.4.5  BSD/OS Version 2.x Notes</A></H4>

<P>
If you get the following error when compiling MySQL, your
<CODE>ulimit</CODE> value for virtual memory is too low:

</P>

<PRE>
item_func.h: In method
`Item_func_ge::Item_func_ge(const Item_func_ge &#38;)':
item_func.h:28: virtual memory exhausted
make[2]: *** [item_func.o] Error 1
</PRE>

<P>
Try using <CODE>ulimit -v 80000</CODE> and run <CODE>make</CODE> again.  If this
doesn't work and you are using <CODE>bash</CODE>, try switching to <CODE>csh</CODE>
or <CODE>sh</CODE>; some BSDI users have reported problems with <CODE>bash</CODE>
and <CODE>ulimit</CODE>.

</P>
<P>
If you are using <CODE>gcc</CODE>, you may also use have to use the
<CODE>--with-low-memory</CODE> flag for <CODE>configure</CODE> to be able to compile
<TT>`sql_yacc.cc'</TT>.

</P>
<P>
If you get problems with the current date in MySQL, setting the
<CODE>TZ</CODE> variable will probably help.  See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</P>



<H4><A NAME="BSDI3" HREF="manual_toc.html#BSDI3">2.6.4.6  BSD/OS Version 3.x Notes</A></H4>

<P>
Upgrade to BSD/OS Version 3.1.  If that is not possible, install
BSDIpatch M300-038.

</P>
<P>
Use the following command when configuring MySQL:

</P>

<PRE>
env CXX=shlicc++ CC=shlicc2 \
./configure \
    --prefix=/usr/local/mysql \
    --localstatedir=/var/mysql \
    --without-perl \
    --with-unix-socket-path=/var/mysql/mysql.sock
</PRE>

<P>
The following is also known to work:

</P>

<PRE>
env CC=gcc CXX=gcc CXXFLAGS=-O3 \
./configure \
    --prefix=/usr/local/mysql \
    --with-unix-socket-path=/var/mysql/mysql.sock
</PRE>

<P>
You can change the directory locations if you wish, or just use the
defaults by not specifying any locations.

</P>
<P>
If you have problems with performance under heavy load, try using the
<CODE>--skip-thread-priority</CODE> option to <CODE>mysqld</CODE>!  This will run
all threads with the same priority. On BSDI Version 3.1, this gives better
performance, at least until BSDI fixes its thread scheduler.

</P>
<P>
If you get the error <CODE>virtual memory exhausted</CODE> while compiling,
you should try using <CODE>ulimit -v 80000</CODE> and running <CODE>make</CODE> again.
If this doesn't work and you are using <CODE>bash</CODE>, try switching to
<CODE>csh</CODE> or <CODE>sh</CODE>; some BSDI users have reported problems with
<CODE>bash</CODE> and <CODE>ulimit</CODE>.

</P>



<H4><A NAME="BSDI4" HREF="manual_toc.html#BSDI4">2.6.4.7  BSD/OS Version 4.x Notes</A></H4>

<P>
BSDI Version 4.x has some thread-related bugs.  If you want to use
MySQL on this, you should install all thread-related patches.  At
least M400-023 should be installed.

</P>
<P>
On some BSDI Version 4.x systems, you may get problems with shared libraries.
The symptom is that you can't execute any client programs, for example,
<CODE>mysqladmin</CODE>.  In this case, you need to reconfigure not to use
shared libraries with the <CODE>--disable-shared</CODE> option to configure.

</P>
<P>
Some customers have had problems on BSDI 4.0.1 that the <CODE>mysqld</CODE>
binary after a while can't open tables.  This is because some
library/system-related bug causes <CODE>mysqld</CODE> to change current
directory without asking for this!

</P>
<P>
The fix is to either upgrade MySQL to at least version 3.23.34 or, after
running <CODE>configure</CODE>, remove the line <CODE>#define HAVE_REALPATH</CODE> from
<CODE>config.h</CODE> before running <CODE>make</CODE>.

</P>
<P>
Note that this means that you can't symbolically link a database
directories to another database directory or symbolic link a table to
another database on BSDI!  (Making a symbolic link to another disk is okay).

</P>



<H3><A NAME="Other_Unix_Notes" HREF="manual_toc.html#Other_Unix_Notes">2.6.5  Other Unix Notes</A></H3>



<H4><A NAME="HP-UX_10.20" HREF="manual_toc.html#HP-UX_10.20">2.6.5.1  HP-UX Version 10.20 Notes</A></H4>

<P>
There are a couple of small problems when compiling MySQL on
HP-UX.  We recommend that you use <CODE>gcc</CODE> instead of the HP-UX native
compiler, because <CODE>gcc</CODE> produces better code!

</P>
<P>
We recommend using <CODE>gcc</CODE> 2.95 on HP-UX.  Don't use high optimization
flags (such as <CODE>-O6</CODE>) because they may not be safe on HP-UX.

</P>
<P>
The following <CODE>configure</CODE> line should work with <CODE>gcc</CODE> 2.95:

</P>

<PRE>
CFLAGS="-I/opt/dce/include -fpic" \
CXXFLAGS="-I/opt/dce/include -felide-constructors -fno-exceptions \
-fno-rtti" \
CXX=gcc \
./configure --with-pthread \
    --with-named-thread-libs='-ldce' \
    --prefix=/usr/local/mysql --disable-shared
</PRE>

<P>
The following <CODE>configure</CODE> line should work with <CODE>gcc</CODE> 3.1:

</P>

<PRE>
CFLAGS="-DHPUX -I/opt/dce/include -O3 -fPIC" CXX=gcc \
CXXFLAGS="-DHPUX -I/opt/dce/include -felide-constructors \
    -fno-exceptions -fno-rtti -O3 -fPIC" \
./configure --prefix=/usr/local/mysql \
    --with-extra-charsets=complex --enable-thread-safe-client \
    --enable-local-infile  --with-pthread \
    --with-named-thread-libs=-ldce --with-lib-ccflags=-fPIC
    --disable-shared
</PRE>



<H4><A NAME="HP-UX_11.x" HREF="manual_toc.html#HP-UX_11.x">2.6.5.2  HP-UX Version 11.x Notes</A></H4>

<P>
For HP-UX Version 11.x, we recommend MySQL 3.23.15 or later.

</P>
<P>
Because of some critical bugs in the standard HP-UX libraries, you should
install the following patches before trying to run MySQL on HP-UX 11.0:

</P>

<PRE>
PHKL_22840 Streams cumulative
PHNE_22397 ARPA cumulative
</PRE>

<P>
This will solve the problem of getting <CODE>EWOULDBLOCK</CODE> from <CODE>recv()</CODE>
and <CODE>EBADF</CODE> from <CODE>accept()</CODE> in threaded applications.

</P>
<P>
If you are using <CODE>gcc</CODE> 2.95.1 on an unpatched HP-UX 11.x system,
you will get the error:

</P>

<PRE>
In file included from /usr/include/unistd.h:11,
                 from ../include/global.h:125,
                 from mysql_priv.h:15,
                 from item.cc:19:
/usr/include/sys/unistd.h:184: declaration of C function ...
/usr/include/sys/pthread.h:440: previous declaration ...
In file included from item.h:306,
                 from mysql_priv.h:158,
                 from item.cc:19:
</PRE>

<P>
The problem is that HP-UX doesn't define <CODE>pthreads_atfork()</CODE> consistently.
It has conflicting prototypes in
<TT>`/usr/include/sys/unistd.h'</TT>:184 and
<TT>`/usr/include/sys/pthread.h'</TT>:440 (details below).

</P>
<P>
One solution is to copy <TT>`/usr/include/sys/unistd.h'</TT> into
<TT>`mysql/include'</TT> and edit <TT>`unistd.h'</TT> and change it to match
the definition in <TT>`pthread.h'</TT>.  Change this line:

</P>

<PRE>
extern int pthread_atfork(void (*prepare)(), void (*parent)(),
                                          void (*child)());
</PRE>

<P>
To look like this:

</P>

<PRE>
extern int pthread_atfork(void (*prepare)(void), void (*parent)(void),
                                          void (*child)(void));
</PRE>

<P>
After making the change, the following <CODE>configure</CODE> line should work:

</P>

<PRE>
CFLAGS="-fomit-frame-pointer -O3 -fpic" CXX=gcc \
CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti -O3" \
./configure --prefix=/usr/local/mysql --disable-shared
</PRE>

<P>
If you are using MySQL 4.0.5 with the HP-UX compiler, you can use the following
command (which has been tested with <CODE>cc</CODE> B.11.11.04):

</P>

<PRE>
CC=cc CXX=aCC CFLAGS=+DD64 CXXFLAGS=+DD64 ./configure \
    --with-extra-character-set=complex
</PRE>

<P>
You can ignore any errors of the following type:

</P>

<PRE>
aCC: warning 901: unknown option: `-3': use +help for online
documentation
</PRE>

<P>
If you get the following error from <CODE>configure</CODE>,
verify that you don't have the path to the K&#38;R compiler before the path
to the HP-UX C and C++ compiler:

</P>

<PRE>
checking for cc option to accept ANSI C... no
configure: error: MySQL requires a ANSI C compiler (and a C++ compiler).
Try gcc. See the Installation chapter in the Reference Manual.
</PRE>

<P>
Another reason for not being able to compile is that you didn't define
the <CODE>+DD64</CODE> flags as just described.

</P>
<P>
Another possibility for HP-UX 11 is to use MySQL binaries for HP-UX 10.20.
We have received reports from some users that these binaries work fine on
HP-UX 11.00. If you encounter problems, be sure to check your HP-UX patch
level.

</P>


<H4><A NAME="IBM-AIX" HREF="manual_toc.html#IBM-AIX">2.6.5.3  IBM-AIX notes</A></H4>

<P>
<A NAME="IDX372"></A>

</P>
<P>
Automatic detection of <CODE>xlC</CODE> is missing from Autoconf, so a number of
variables need to be set before running <CODE>configure</CODE>. The following
example uses the IBM compiler:

</P>

<PRE>
export CC="xlc_r -ma -O3 -qstrict -qoptimize=3 -qmaxmem=8192 "
export CXX="xlC_r -ma -O3 -qstrict -qoptimize=3 -qmaxmem=8192"
export CFLAGS="-I /usr/local/include"
export LDFLAGS="-L /usr/local/lib"
export CPPFLAGS=$CFLAGS
export CXXFLAGS=$CFLAGS

./configure --prefix=/usr/local \
                --localstatedir=/var/mysql \
                --sysconfdir=/etc/mysql \
                --sbindir='/usr/local/bin' \
                --libexecdir='/usr/local/bin' \
                --enable-thread-safe-client \
                --enable-large-files
</PRE>

<P>
The preceding options are used to compile the MySQL distribution that
can be found at <a HREF="http://www-frec.bull.com/">http://www-frec.bull.com/</a>.

</P>
<P>
If you change the <CODE>-O3</CODE> to <CODE>-O2</CODE> in the preceding <CODE>configure</CODE>
line, you must also remove the <CODE>-qstrict</CODE> option. This is a limitation in
the IBM C compiler.

</P>
<P>
If you are using <CODE>gcc</CODE> or <CODE>egcs</CODE> to compile MySQL, you
<STRONG>must</STRONG> use the <CODE>-fno-exceptions</CODE> flag, because the exception
handling in <CODE>gcc</CODE>/<CODE>egcs</CODE> is not thread-safe!  (This is tested with
<CODE>egcs</CODE> 1.1.)  There are also some known problems with IBM's assembler
that may cause it to generate bad code when used with <CODE>gcc</CODE>.

</P>
<P>
We recommend the following <CODE>configure</CODE> line with <CODE>egcs</CODE> and
<CODE>gcc 2.95</CODE> on AIX:

</P>

<PRE>
CC="gcc -pipe -mcpu=power -Wa,-many" \
CXX="gcc -pipe -mcpu=power -Wa,-many" \
CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti" \
./configure --prefix=/usr/local/mysql --with-low-memory
</PRE>

<P>
The <CODE>-Wa,-many</CODE> option is necessary for the compile to be successful.
IBM is aware of this problem but is in no hurry to fix it because of the
workaround that is available.  We don't know if the <CODE>-fno-exceptions</CODE>
is required with <CODE>gcc 2.95</CODE>, but because MySQL doesn't use exceptions
and the option generates faster code, we recommend that you should always
use it with <CODE>egcs / gcc</CODE>.

</P>
<P>
If you get a problem with assembler code, try changing the <CODE>-mcpu=xxx</CODE>
option to match your CPU. Typically <CODE>power2</CODE>, <CODE>power</CODE>, or
<CODE>powerpc</CODE> may need to be used.  Alternatively, you might need to use
<CODE>604</CODE> or <CODE>604e</CODE>. We are not positive but suspect that
<CODE>power</CODE> would likely be safe most of the time, even on
a power2 machine.

</P>
<P>
If you don't know what your CPU is, execute a <CODE>uname -m</CODE> command.  It
will produce a string that looks like <CODE>000514676700</CODE>, with a format of
<CODE>xxyyyyyymmss</CODE> where <CODE>xx</CODE> and <CODE>ss</CODE> are always <CODE>00</CODE>,
<CODE>yyyyyy</CODE> is a unique system ID and <CODE>mm</CODE> is the ID of the CPU Planar.
A chart of these values can be found at
<a HREF="http://publib.boulder.ibm.com/doc_link/en_US/a_doc_lib/cmds/aixcmds5/uname.htm">http://publib.boulder.ibm.com/doc_link/en_US/a_doc_lib/cmds/aixcmds5/uname.htm</a>.
This will give you a machine type and a machine model you can use to
determine what type of CPU you have.

</P>
<P>
If you have problems with signals (MySQL dies unexpectedly
under high load), you may have found an OS bug with threads and
signals.  In this case, you can tell MySQL not to use signals by
configuring as follows:

</P>

<PRE>
CFLAGS=-DDONT_USE_THR_ALARM CXX=gcc \
CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti \
-DDONT_USE_THR_ALARM" \
./configure --prefix=/usr/local/mysql --with-debug \
    --with-low-memory
</PRE>

<P>
This doesn't affect the performance of MySQL, but has the side
effect that you can't kill clients that are ``sleeping'' on a connection with
<CODE>mysqladmin kill</CODE> or <CODE>mysqladmin shutdown</CODE>.  Instead, the client
will die when it issues its next command.

</P>
<P>
On some versions of AIX, linking with <CODE>libbind.a</CODE> makes
<CODE>getservbyname</CODE> core dump.  This is an AIX bug and should be reported
to IBM.

</P>
<P>
For AIX 4.2.1 and <CODE>gcc</CODE>, you have to make the following changes.

</P>
<P>
After configuring, edit <TT>`config.h'</TT> and <TT>`include/my_config.h'</TT>
and change the line that says this:

</P>

<PRE>
#define HAVE_SNPRINTF 1
</PRE>

<P>
to this:

</P>

<PRE>
#undef HAVE_SNPRINTF
</PRE>

<P>
And finally, in <TT>`mysqld.cc'</TT>, you need to add a prototype for initgoups.

</P>

<PRE>
#ifdef _AIX41
extern "C" int initgroups(const char *,int);
#endif
</PRE>

<P>
If you need to allocate a lot of memory to the <CODE>mysqld</CODE> process, it's not
enough to just use <CODE>ulimit -d unlimited</CODE>. You may also have to modify
<CODE>mysqld_safe</CODE> to add a line something like this:

</P>

<PRE>
export LDR_CNTRL='MAXDATA=0x80000000'
</PRE>

<P>
You can find more about using a lot of memory at
<a HREF="http://publib16.boulder.ibm.com/pseries/en_US/aixprggd/genprogc/lrg_prg_support.htm">http://publib16.boulder.ibm.com/pseries/en_US/aixprggd/genprogc/lrg_prg_support.htm</a>.

</P>


<H4><A NAME="SunOS" HREF="manual_toc.html#SunOS">2.6.5.4  SunOS 4 Notes</A></H4>

<P>
On SunOS 4, MIT-pthreads is needed to compile MySQL. This in turn
means you will need GNU <CODE>make</CODE>.

</P>
<P>
Some SunOS 4 systems have problems with dynamic libraries and <CODE>libtool</CODE>.
You can use the following <CODE>configure</CODE> line to avoid this problem:

</P>

<PRE>
./configure --disable-shared --with-mysqld-ldflags=-all-static
</PRE>

<P>
When compiling <CODE>readline</CODE>, you may get warnings about duplicate defines.
These can be ignored.

</P>
<P>
When compiling <CODE>mysqld</CODE>, there will be some <CODE>implicit declaration
of function</CODE> warnings. These may be ignored.

</P>



<H4><A NAME="Alpha-DEC-UNIX" HREF="manual_toc.html#Alpha-DEC-UNIX">2.6.5.5  Alpha-DEC-UNIX Notes (Tru64)</A></H4>

<P>
If you are using <CODE>egcs</CODE> 1.1.2 on Digital Unix, you should upgrade to
<CODE>gcc</CODE> 2.95.2, because <CODE>egcs</CODE> on DEC has some serious bugs!

</P>
<P>
When compiling threaded programs under Digital Unix, the documentation
recommends using the <CODE>-pthread</CODE> option for <CODE>cc</CODE> and <CODE>cxx</CODE> and
the <CODE>-lmach -lexc</CODE> libraries (in addition to <CODE>-lpthread</CODE>).  You
should run <CODE>configure</CODE> something like this:

</P>

<PRE>
CC="cc -pthread" CXX="cxx -pthread -O" \
./configure --with-named-thread-libs="-lpthread -lmach -lexc -lc"
</PRE>

<P>
When compiling <CODE>mysqld</CODE>, you may see a couple of warnings like this:

</P>

<PRE>
mysqld.cc: In function void handle_connections()':
mysqld.cc:626: passing long unsigned int *' as argument 3 of
accept(int,sockadddr *, int *)'
</PRE>

<P>
You can safely ignore these warnings.  They occur because <CODE>configure</CODE>
can detect only errors, not warnings.

</P>
<P>
If you start the server directly from the command line, you may have problems
with it dying when you log out.  (When you log out, your outstanding processes
receive a <CODE>SIGHUP</CODE> signal.)  If so, try starting the server like this:

</P>

<PRE>
nohup mysqld [options] &#38;
</PRE>

<P>
<CODE>nohup</CODE> causes the command following it to ignore any <CODE>SIGHUP</CODE>
signal sent from the terminal.  Alternatively, start the server by running
<CODE>mysqld_safe</CODE>, which invokes <CODE>mysqld</CODE> using <CODE>nohup</CODE> for you.
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

</P>
<P>
If you get a problem when compiling <TT>`mysys/get_opt.c'</TT>, just remove the
<CODE>#define _NO_PROTO</CODE> line from the start of that file.

</P>
<P>
If you are using Compaq's CC compiler, the following <CODE>configure</CODE> line
should work:

</P>

<PRE>
CC="cc -pthread"
CFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed all -arch host"
CXX="cxx -pthread"
CXXFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed all \
    -arch host -noexceptions -nortti"
export CC CFLAGS CXX CXXFLAGS
./configure \
    --prefix=/usr/local/mysql \
    --with-low-memory \
    --enable-large-files \
    --enable-shared=yes \
    --with-named-thread-libs="-lpthread -lmach -lexc -lc"
gnumake
</PRE>

<P>
If you get a problem with <CODE>libtool</CODE> when compiling with shared libraries
as just shown, when linking <CODE>mysql</CODE>, you should be able to get around
this by issuing these commands:

</P>

<PRE>
cd mysql
/bin/sh ../libtool --mode=link cxx -pthread  -O3 -DDBUG_OFF \
    -O4 -ansi_alias -ansi_args -fast -inline speed \
    -speculate all \ -arch host  -DUNDEF_HAVE_GETHOSTBYNAME_R \
    -o mysql  mysql.o readline.o sql_string.o completion_hash.o \
    ../readline/libreadline.a -lcurses \
    ../libmysql/.libs/libmysqlclient.so  -lm
cd ..
gnumake
gnumake install
scripts/mysql_install_db
</PRE>



<H4><A NAME="Alpha-DEC-OSF1" HREF="manual_toc.html#Alpha-DEC-OSF1">2.6.5.6  Alpha-DEC-OSF/1 Notes</A></H4>

<P>
If you have problems compiling and have DEC <CODE>CC</CODE> and <CODE>gcc</CODE>
installed, try running <CODE>configure</CODE> like this:

</P>

<PRE>
CC=cc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql
</PRE>

<P>
If you get problems with the <TT>`c_asm.h'</TT> file, you can create and use
a 'dummy' <TT>`c_asm.h'</TT> file with:

</P>

<PRE>
touch include/c_asm.h
CC=gcc CFLAGS=-I./include \
CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql
</PRE>

<P>
Note that the following problems with the <CODE>ld</CODE> program can be fixed
by downloading the latest DEC (Compaq) patch kit from:
<a HREF="http://ftp.support.compaq.com/public/unix/">http://ftp.support.compaq.com/public/unix/</a>.

</P>
<P>
On OSF/1 V4.0D and compiler "DEC C V5.6-071 on Digital Unix V4.0 (Rev. 878),"
the compiler had some strange behavior (undefined <CODE>asm</CODE> symbols).
<CODE>/bin/ld</CODE> also appears to be broken (problems with <CODE>_exit
undefined</CODE> errors occurring while linking <CODE>mysqld</CODE>).  On this system, we
have managed to compile MySQL with the following <CODE>configure</CODE>
line, after replacing <CODE>/bin/ld</CODE> with the version from OSF 4.0C:

</P>

<PRE>
CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql
</PRE>

<P>
With the Digital compiler "C++ V6.1-029," the following should work:

</P>

<PRE>
CC=cc -pthread
CFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed \
       -speculate all -arch host
CXX=cxx -pthread
CXXFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed \
         -speculate all -arch host -noexceptions -nortti
export CC CFLAGS CXX CXXFLAGS
./configure --prefix=/usr/mysql/mysql \
            --with-mysqld-ldflags=-all-static --disable-shared \
            --with-named-thread-libs="-lmach -lexc -lc"
</PRE>

<P>
In some versions of OSF/1, the <CODE>alloca()</CODE> function is broken. Fix
this by removing the line in <TT>`config.h'</TT> that defines <CODE>'HAVE_ALLOCA'</CODE>.

</P>
<P>
The <CODE>alloca()</CODE> function also may have an incorrect prototype in
<CODE>/usr/include/alloca.h</CODE>.  This warning resulting from this can be ignored.

</P>
<P>
<CODE>configure</CODE> will use the following thread libraries automatically:
<CODE>--with-named-thread-libs="-lpthread -lmach -lexc -lc"</CODE>.

</P>
<P>
When using <CODE>gcc</CODE>, you can also try running <CODE>configure</CODE> like this:

</P>

<PRE>
CFLAGS=-D_PTHREAD_USE_D4 CXX=gcc CXXFLAGS=-O3 ./configure ...
</PRE>

<P>
If you have problems with signals (MySQL dies unexpectedly
under high load), you may have found an OS bug with threads and
signals. In this case, you can tell MySQL not to use signals by
configuring with:

</P>

<PRE>
CFLAGS=-DDONT_USE_THR_ALARM \
CXXFLAGS=-DDONT_USE_THR_ALARM \
./configure ...
</PRE>

<P>
This doesn't affect the performance of MySQL, but has the side
effect that you can't kill clients that are ``sleeping'' on a connection with
<CODE>mysqladmin kill</CODE> or <CODE>mysqladmin shutdown</CODE>.  Instead, the client
will die when it issues its next command.

</P>
<P>
With <CODE>gcc</CODE> 2.95.2, you will probably run into the following compile error:

</P>

<PRE>
sql_acl.cc:1456: Internal compiler error in `scan_region',
at except.c:2566
Please submit a full bug report.
</PRE>

<P>
To fix this, you should change to the <CODE>sql</CODE> directory and do a
cut-and-paste of the last <CODE>gcc</CODE> line, but change <CODE>-O3</CODE> to
<CODE>-O0</CODE> (or add <CODE>-O0</CODE> immediately after <CODE>gcc</CODE> if you don't
have any <CODE>-O</CODE> option on your compile line).  After this is done, you
can just change back to the top-level directory and run <CODE>make</CODE>
again.

</P>



<H4><A NAME="SGI-Irix" HREF="manual_toc.html#SGI-Irix">2.6.5.7  SGI Irix Notes</A></H4>

<P>
If you are using Irix Version 6.5.3 or newer, <CODE>mysqld</CODE> will be able to
create threads only if you run it as a user with <CODE>CAP_SCHED_MGT</CODE>
privileges (like <CODE>root</CODE>) or give the <CODE>mysqld</CODE> server this privilege
with the following shell command:

</P>

<PRE>
chcap "CAP_SCHED_MGT+epi" /opt/mysql/libexec/mysqld
</PRE>

<P>
You may have to undefine some symbols in <TT>`config.h'</TT> after running
<CODE>configure</CODE> and before compiling.

</P>
<P>
In some Irix implementations, the <CODE>alloca()</CODE> function is broken.  If the
<CODE>mysqld</CODE> server dies on some <CODE>SELECT</CODE> statements, remove the lines
from <TT>`config.h'</TT> that define <CODE>HAVE_ALLOC</CODE> and <CODE>HAVE_ALLOCA_H</CODE>.
If <CODE>mysqladmin create</CODE> doesn't work, remove the line from <TT>`config.h'</TT>
that defines <CODE>HAVE_READDIR_R</CODE>.  You may have to remove the
<CODE>HAVE_TERM_H</CODE> line as well.

</P>
<P>
SGI recommends that you install all the patches on this page as a set:
<a HREF="http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html">http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html</a>

</P>
<P>
At the very minimum, you should install the latest kernel rollup, the
latest <CODE>rld</CODE> rollup, and the latest <CODE>libc</CODE> rollup.

</P>
<P>
You definitely need all the POSIX patches on this page, for pthreads support:

</P>
<P>
<a HREF="http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html">http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html</a>

</P>
<P>
If you get the something like the following error when compiling
<TT>`mysql.cc'</TT>:

</P>

<PRE>
"/usr/include/curses.h", line 82: error(1084):
invalid combination of type
</PRE>

<P>
Type the following in the top-level directory of your MySQL source
tree:

</P>

<PRE>
extra/replace bool curses_bool &#60; /usr/include/curses.h \
           &#62; include/curses.h
make
</PRE>

<P>
There have also been reports of scheduling problems.  If only one thread is
running, performance is slow.  Avoid this by starting another client.  This may
lead to a two-to-tenfold increase in execution speed thereafter for the other
thread.  This is a poorly understood problem with Irix threads; you may have
to improvise to find solutions until this can be fixed.

</P>
<P>
If you are compiling with <CODE>gcc</CODE>, you can use the following
<CODE>configure</CODE> command:

</P>

<PRE>
CC=gcc CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql --enable-thread-safe-client \
    --with-named-thread-libs=-lpthread
</PRE>

<P>
On Irix 6.5.11 with native Irix C and C++ compilers ver. 7.3.1.2, the
following is reported to work

</P>

<PRE>
CC=cc CXX=CC CFLAGS='-O3 -n32 -TARG:platform=IP22 -I/usr/local/include \
-L/usr/local/lib' CXXFLAGS='-O3 -n32 -TARG:platform=IP22 \
-I/usr/local/include -L/usr/local/lib' \
./configure --prefix=/usr/local/mysql --with-innodb --with-berkeley-db \
    --with-libwrap=/usr/local \
    --with-named-curses-libs=/usr/local/lib/libncurses.a
</PRE>



<H4><A NAME="SCO" HREF="manual_toc.html#SCO">2.6.5.8  SCO Notes</A></H4>

<P>
The current port is tested only on ``sco3.2v5.0.5,'' ``sco3.2v5.0.6,'' 
and ``sco3.2v5.0.7'' systems.  There has also been a lot of progress on a
port to ``sco 3.2v4.2.''

</P>
<P>
For the moment, the recommended compiler on OpenServer is <CODE>gcc</CODE> 2.95.2.
With this, you should be able to compile MySQL with just:

</P>

<PRE>
CC=gcc CXX=gcc ./configure ... (options)
</PRE>


<OL>
<LI>

For OpenServer 5.0.x, you need to use gcc-2.95.2p1 or newer from the
Skunkware.  <a HREF="http://www.sco.com/skunkware/">http://www.sco.com/skunkware/</a> and choose browser
OpenServer packages or by FTP to ftp2.caldera.com in the
<TT>`pub/skunkware/osr5/devtools/gcc'</TT> directory.

<LI>

You need the port of GCC 2.5.x for this product and the Development
system.  They are required on this version of SCO Unix.  You cannot
just use the GCC Dev system.

<LI>

You should get the FSU Pthreads package and install it first.  
This can be found at
<a HREF="http://moss.csc.ncsu.edu/~mueller/ftp/pub/PART/pthreads.tar.gz">http://moss.csc.ncsu.edu/~mueller/ftp/pub/PART/pthreads.tar.gz</a>.
You can also get a precompiled package from
<a HREF="http://www.mysql.com/Downloads/SCO/FSU-threads-3.5c.tar.gz">http://www.mysql.com/Downloads/SCO/FSU-threads-3.5c.tar.gz</a>.

<LI>

FSU Pthreads can be compiled with SCO Unix 4.2 with tcpip, or using
OpenServer 3.0 or Open Desktop 3.0 (OS 3.0 ODT 3.0) with the SCO 
Development System installed using a good port of GCC 2.5.x. For ODT or OS
3.0, you will need a good port of GCC 2.5.x. There are a lot of problems
without a good port.  The port for this product requires the SCO Unix
Development system.  Without it, you are missing the libraries and the
linker that is needed.

<LI>

To build FSU Pthreads on your system, do the following:


<OL>
<LI>

Run <CODE>./configure</CODE> in the <TT>`threads/src'</TT> directory and select
the SCO OpenServer option. This command copies <TT>`Makefile.SCO5'</TT> to
<TT>`Makefile'</TT>.

<LI>

Run <CODE>make</CODE>.

<LI>

To install in the default <TT>`/usr/include'</TT> directory, login as root,
then <CODE>cd</CODE> to the <TT>`thread/src'</TT> directory, and run <CODE>make
install</CODE>.
</OL>

<LI>

Remember to use GNU <CODE>make</CODE> when making MySQL.

<LI>

If you don't start <CODE>mysqld_safe</CODE> as <CODE>root</CODE>, you probably will get only the
default 110 open files per process.  <CODE>mysqld</CODE> will write a note about this
in the log file.

<LI>

With SCO 3.2V5.0.5, you should use FSU Pthreads version 3.5c or newer.
You should also use <CODE>gcc</CODE> 2.95.2 or newer!

The following <CODE>configure</CODE> command should work:


<PRE>
./configure --prefix=/usr/local/mysql --disable-shared
</PRE>

<LI>

With SCO 3.2V4.2, you should use FSU Pthreads version 3.5c or newer.
The following <CODE>configure</CODE> command should work:


<PRE>
CFLAGS="-D_XOPEN_XPG4" CXX=gcc CXXFLAGS="-D_XOPEN_XPG4" \
./configure \
    --prefix=/usr/local/mysql \
    --with-named-thread-libs="-lgthreads -lsocket -lgen -lgthreads" \
    --with-named-curses-libs="-lcurses"
</PRE>

You may get some problems with some include files. In this case, you can
find new SCO-specific include files at
<a HREF="http://www.mysql.com/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz">http://www.mysql.com/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz</a>.
You should unpack this file in the <TT>`include'</TT> directory of your
MySQL source tree.
</OL>

<P>
SCO development notes:

</P>

<UL>
<LI>

MySQL should automatically detect FSU Pthreads and link <CODE>mysqld</CODE>
with <CODE>-lgthreads -lsocket -lgthreads</CODE>.

<LI>

The SCO development libraries are re-entrant in FSU Pthreads.
SCO claims that its libraries' functions are re-entrant, so they must
be re-entrant with FSU Pthreads.  FSU Pthreads on OpenServer tries to use
the SCO scheme to make re-entrant libraries.

<LI>

FSU Pthreads (at least the version at <a HREF="http://www.mysql.com/">http://www.mysql.com/</a>) comes
linked with GNU <CODE>malloc</CODE>.  If you encounter problems with memory usage,
make sure that <TT>`gmalloc.o'</TT> is included in <TT>`libgthreads.a'</TT> and
<TT>`libgthreads.so'</TT>.

<LI>

In FSU Pthreads, the following system calls are pthreads-aware: <CODE>read()</CODE>,
<CODE>write()</CODE>, <CODE>getmsg()</CODE>, <CODE>connect()</CODE>, <CODE>accept()</CODE>,
<CODE>select()</CODE>, and <CODE>wait()</CODE>.

<LI>

The CSSA-2001-SCO.35.2 (the patch is listed in custom as
erg711905-dscr_remap security patch (version 2.0.0)) breaks FSU threads and
makes <CODE>mysqld</CODE> unstable.  You have to remove this one if you want to run
<CODE>mysqld</CODE> on an OpenServer 5.0.6 machine.

<LI>

SCO provides operating system patches at
<a HREF="ftp://ftp.sco.com/pub/openserver5">ftp://ftp.sco.com/pub/openserver5</a> for OpenServer 5.0.x 

<LI>

SCO provides security fixes and <CODE>libsocket.so.2</CODE> at
<a HREF="ftp://ftp.sco.com/pub/security/OpenServer">ftp://ftp.sco.com/pub/security/OpenServer</a> and
<a HREF="ftp://ftp.sco.com/pub/security/sse">ftp://ftp.sco.com/pub/security/sse</a> for OpenServer 5.0.x

<LI>

pre-OSR506 security fixes. Also, the <CODE>telnetd</CODE> fix at
<a HREF="ftp://stage.caldera.com/pub/security/openserver/">ftp://stage.caldera.com/pub/security/openserver/</a> or
<a HREF="ftp://stage.caldera.com/pub/security/openserver/CSSA-2001-SCO.10/">ftp://stage.caldera.com/pub/security/openserver/CSSA-2001-SCO.10/</a>
as both <CODE>libsocket.so.2</CODE> and <CODE>libresolv.so.1</CODE> with instructions for
installing on pre-OSR506 systems.

It's probably a good idea to install these patches before trying to
compile/use MySQL.
</UL>



<H4><A NAME="SCO_UnixWare" HREF="manual_toc.html#SCO_UnixWare">2.6.5.9  SCO UnixWare Version 7.1.x Notes</A></H4>

<P>
On UnixWare 7.1.0, you must use a version of MySQL at least as recent as
3.22.13 to get fixes for some portability and OS problems.

</P>
<P>
We have been able to compile MySQL with the following <CODE>configure</CODE>
command on UnixWare Version 7.1.x:

</P>

<PRE>
CC=cc CXX=CC ./configure --prefix=/usr/local/mysql
</PRE>

<P>
If you want to use <CODE>gcc</CODE>, you must use <CODE>gcc</CODE> 2.95.2 or newer.
  

<PRE>
CC=gcc CXX=g++ ./configure --prefix=/usr/local/mysql
</PRE>

<P>
  
SCO provides operating system patches at
<a HREF="ftp://ftp.sco.com/pub/unixware7">ftp://ftp.sco.com/pub/unixware7</a> for UnixWare 7.1.1 and 7.1.3 
and at
<a HREF="ftp://ftp.sco.com/pub/openunix8">ftp://ftp.sco.com/pub/openunix8</a> for OpenUNIX 8.0.0.
  
SCO provides information about security fixes at
<a HREF="ftp://ftp.sco.com/pub/security/OpenUNIX">ftp://ftp.sco.com/pub/security/OpenUNIX</a> for OpenUNIX
and at
<a HREF="ftp://ftp.sco.com/pub/security/UnixWare">ftp://ftp.sco.com/pub/security/UnixWare</a> for UnixWare.

</P>



<H3><A NAME="OS_2" HREF="manual_toc.html#OS_2">2.6.6  OS/2 Notes</A></H3>

<P>
MySQL uses quite a few open files. Because of this, you should add
something like the following to your <TT>`CONFIG.SYS'</TT> file:

</P>

<PRE>
SET EMXOPT=-c -n -h1024
</PRE>

<P>
If you don't do this, you will probably run into the following error:

</P>

<PRE>
File 'xxxx' not found (Errcode: 24)
</PRE>

<P>
When using MySQL with OS/2 Warp 3, FixPack 29 or above is
required.  With OS/2 Warp 4, FixPack 4 or above is required. This is a
requirement of the Pthreads library.  MySQL must be installed
on a partition with a type that supports long filenames, such as HPFS, FAT32,
and so on.

</P>
<P>
The <TT>`INSTALL.CMD'</TT> script must be run from OS/2's own <TT>`CMD.EXE'</TT>
and may not work with replacement shells such as <TT>`4OS2.EXE'</TT>.

</P>
<P>
The <TT>`scripts/mysql-install-db'</TT> script has been renamed.  It is now called
<TT>`install.cmd'</TT> and is a REXX script, which will set up the default
MySQL security settings and create the WorkPlace Shell icons
for MySQL.

</P>
<P>
Dynamic module support is compiled in but not fully tested. Dynamic
modules should be compiled using the Pthreads runtime library.

</P>

<PRE>
gcc -Zdll -Zmt -Zcrtdll=pthrdrtl -I../include -I../regex -I.. \
    -o example udf_example.cc -L../lib -lmysqlclient udf_example.def
mv example.dll example.udf
</PRE>

<P>
<STRONG>Note:</STRONG> Due to limitations in OS/2, UDF module name stems must not
exceed eight characters. Modules are stored in the <TT>`/mysql2/udf'</TT>
directory; the <CODE>safe-mysqld.cmd</CODE> script will put this directory in
the <CODE>BEGINLIBPATH</CODE> environment variable. When using UDF modules,
specified extensions are ignored--it is assumed to be <TT>`.udf'</TT>.
For example, in Unix, the shared module might be named <TT>`example.so'</TT>
and you would load a function from it like this:

</P>

<PRE>
mysql&#62; CREATE FUNCTION metaphon RETURNS STRING SONAME 'example.so';
</PRE>

<P>
In OS/2, the module would be named <TT>`example.udf'</TT>, but you would not
specify the module extension:

</P>

<PRE>
mysql&#62; CREATE FUNCTION metaphon RETURNS STRING SONAME 'example';
</PRE>



<H3><A NAME="BeOS" HREF="manual_toc.html#BeOS">2.6.7  BeOS Notes</A></H3>

<P>
We have in the past talked with some BeOS developers who have said that
MySQL is 80% ported to BeOS, but we haven't heard from them
in a while.

</P>



<H2><A NAME="Perl_support" HREF="manual_toc.html#Perl_support">2.7  Perl Installation Notes</A></H2>

<P>
<A NAME="IDX373"></A>
<A NAME="IDX374"></A>

</P>
<P>
Perl support for MySQL is provided by means of the <CODE>DBI</CODE>/<CODE>DBD</CODE>
client interface. The interface requires Perl Version 5.6.0 or later.
It <EM>will not work</EM> if you have an older version of Perl.

</P>
<P>
If you want to use transactions with Perl DBI, you need to have
<CODE>DBD::mysql</CODE> version 1.2216 or newer. Version 2.9003 or newer
is recommended.

</P>
<P>
Note that if you are using MySQL 4.1 client library, you must use
<CODE>DBD::mysql</CODE> 2.9003 or newer.

</P>
<P>
As of Version 3.22.8, Perl support is no longer included with MySQL
distributions. You can obtain the necessary modules from
<a HREF="http://search.cpan.org">http://search.cpan.org</a> for Unix, or by using the ActiveState
<CODE>ppm</CODE> program on Windows. The following sections describe how to do
this.

</P>
<P>
Perl support for MySQL must be installed if you want to run the MySQL
benchmark scripts.
See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.

</P>



<H3><A NAME="Perl_installation" HREF="manual_toc.html#Perl_installation">2.7.1  Installing Perl on Unix</A></H3>

<P>
MySQL Perl support requires that you've installed MySQL client programming
support (libraries and header files).  Most installation methods install
the necessary files. However, if you installed MySQL from RPM files
on Linux, be sure that you've installed the developer RPM.  The client
programs are in the client RPM, but client programming support is in
the developer RPM.

</P>
<P>
If you want to install Perl support, the files you will need can
be obtained from the CPAN (Comprehensive Perl Archive Network) at
<a HREF="http://search.cpan.org">http://search.cpan.org</a>.

</P>
<P>
The easiest way to install Perl modules on Unix is to use the <CODE>CPAN</CODE>
module. For example:

</P>

<PRE>
shell&#62; perl -MCPAN -e shell
cpan&#62; install DBI
cpan&#62; install DBD::mysql
</PRE>

<P>
The <CODE>DBD::mysql</CODE> installation runs a number of tests.
These tests require being able to connect to the local MySQL server
as the anonymous user with no password. If you have removed anonymous
accounts or assigned them passwords, the tests fail. You can use <CODE>force
install DBD::mysql</CODE> to ignore the failed tests.

</P>
<P>
<CODE>DBI</CODE> requires the <CODE>Data::Dumper</CODE> module. It may already be
installed; if not, you should install it before installing <CODE>DBI</CODE>.

</P>
<P>
It is also possible to download the module distributions in the form of
compressed <CODE>tar</CODE> archives and build the modules manually. For example,
to unpack and build a DBI distribution, use a procedure such as this:

</P>

<OL>
<LI>

Unpack the distribution into the current directory:

<PRE>
shell&#62; gunzip &#60; DBI-VERSION.tar.gz | tar xvf -
</PRE>

This command creates a directory named <TT>`DBI-VERSION'</TT>.

<LI>

Change location into the top-level directory of the unpacked distribution:

<PRE>
shell&#62; cd DBI-VERSION
</PRE>

<LI>

Build the distribution and compile everything:

<PRE>
shell&#62; perl Makefile.PL
shell&#62; make
shell&#62; make test
shell&#62; make install
</PRE>

</OL>

<P>
The <CODE>make test</CODE> command is important because it verifies that the
module is working.  Note that when you run that command during the
<CODE>DBD::mysql</CODE> installation to exercise the interface code, the
MySQL server must be running or the test will fail.

</P>
<P>
It is a good idea to rebuild and reinstall the <CODE>DBD::mysql</CODE>
distribution whenever you install a new release of MySQL,
particularly if you notice symptoms such as that all your <CODE>DBI</CODE> scripts
fail after you upgrade MySQL.

</P>
<P>
If you don't have access rights to install Perl modules in the system directory
or if you want to install local Perl modules, the following reference may be
useful:
<a HREF="http://servers.digitaldaze.com/extensions/perl/modules.html#modules">http://servers.digitaldaze.com/extensions/perl/modules.html#modules</a>

</P>
<P>
Look under the heading ``Installing New Modules that Require Locally
Installed Modules.''

</P>



<H3><A NAME="ActiveState_Perl" HREF="manual_toc.html#ActiveState_Perl">2.7.2  Installing ActiveState Perl on Windows</A></H3>

<P>
<A NAME="IDX375"></A>
<A NAME="IDX376"></A>
<A NAME="IDX377"></A>

</P>
<P>
On Windows, you should do the following to install the MySQL
<CODE>DBD</CODE> module with ActiveState Perl:

</P>

<UL>
<LI>

Get ActiveState Perl from
<a HREF="http://www.activestate.com/Products/ActivePerl/">http://www.activestate.com/Products/ActivePerl/</a>
and install it.

<LI>

Open a console window (a ``DOS window'').

<LI>

If required, set the <CODE>HTTP_proxy</CODE> variable. For example, you might try:


<PRE>
set HTTP_proxy=my.proxy.com:3128
</PRE>

<LI>

Start the PPM program:


<PRE>
C:\&#62; C:\perl\bin\ppm.pl
</PRE>

<LI>

If you have not already done so, install <CODE>DBI</CODE>:


<PRE>
ppm&#62; install DBI
</PRE>

<LI>

If this succeeds, run the following command:


<PRE>
install \
ftp://ftp.de.uu.net/pub/CPAN/authors/id/JWIED/DBD-mysql-1.2212.x86.ppd
</PRE>

</UL>

<P>
This procedure should work at least with ActiveState Perl Version 5.6.

</P>
<P>
If you can't get the procedure to work, you should instead install the
<CODE>MyODBC</CODE> driver and connect to the MySQL server through
ODBC:

</P>

<PRE>
use DBI;
$dbh= DBI-&#62;connect("DBI:ODBC:$dsn",$user,$password) ||
  die "Got error $DBI::errstr when connecting to $dsn\n";
</PRE>



<H3><A NAME="Perl_support_problems" HREF="manual_toc.html#Perl_support_problems">2.7.3  Problems Using the Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> Interface</A></H3>

<P>
<A NAME="IDX378"></A>
<A NAME="IDX379"></A>

</P>
<P>
If Perl reports that it can't find the <TT>`../mysql/mysql.so'</TT> module,
then the problem is probably that Perl can't locate the shared library
<TT>`libmysqlclient.so'</TT>.

</P>
<P>
You should be able to fix this by one of the following methods:

</P>

<UL>
<LI>

Compile the <CODE>DBD::mysql</CODE> distribution with <CODE>perl
Makefile.PL -static -config</CODE> rather than <CODE>perl Makefile.PL</CODE>.

<LI>

Copy <TT>`libmysqlclient.so'</TT> to the directory where your other shared
libraries are located (probably <TT>`/usr/lib'</TT> or <TT>`/lib'</TT>).

<LI>

Modify the <CODE>-L</CODE> options used to compile <CODE>DBD::mysql</CODE> to reflect
the actual location of <TT>`libmysqlclient.so'</TT>.

<LI>

On Linux, you can add the pathname of the directory where
<TT>`libmysqlclient.so'</TT> is located to the <TT>`/etc/ld.so.conf'</TT> file.

<A NAME="IDX380"></A>
<A NAME="IDX381"></A>
<A NAME="IDX382"></A>
<A NAME="IDX383"></A>
<LI>

Add the pathname of the directory where <TT>`libmysqlclient.so'</TT> is located
to the <CODE>LD_RUN_PATH</CODE> environment variable. Some systems use
<CODE>LD_LIBRARY_PATH</CODE> instead.
</UL>

<P>
Note that you may also need to modify the <CODE>-L</CODE> options if there are
other libraries that the linker fails to find. For example, if the linker
cannot find <CODE>libc</CODE> because it is in <TT>`/lib'</TT> and the link command
specifies <CODE>-L/usr/lib</CODE>, change the <CODE>-L</CODE> option to <CODE>-L/lib</CODE>
or add <CODE>-L/lib</CODE> to the existing link command.

</P>
<P>
If you get the following errors from <CODE>DBD::mysql</CODE>,
you are probably using <CODE>gcc</CODE> (or using an old binary compiled with
<CODE>gcc</CODE>):

</P>

<PRE>
/usr/bin/perl: can't resolve symbol '__moddi3'
/usr/bin/perl: can't resolve symbol '__divdi3'
</PRE>

<P>
Add <CODE>-L/usr/lib/gcc-lib/... -lgcc</CODE> to the link command when the
<TT>`mysql.so'</TT> library gets built (check the output from <CODE>make</CODE> for
<TT>`mysql.so'</TT> when you compile the Perl client).  The <CODE>-L</CODE> option
should specify the pathname of the directory where <TT>`libgcc.a'</TT> is located
on your system.

</P>
<P>
Another cause of this problem may be that Perl and MySQL aren't both
compiled with <CODE>gcc</CODE>.  In this case, you can solve the mismatch by
compiling both with <CODE>gcc</CODE>.

</P>
<P>
You may see the following error from <CODE>DBD::mysql</CODE>
when you run the tests:

</P>

<PRE>
t/00base............install_driver(mysql) failed:
Can't load '../blib/arch/auto/DBD/mysql/mysql.so' for module DBD::mysql:
../blib/arch/auto/DBD/mysql/mysql.so: undefined symbol:
uncompress at /usr/lib/perl5/5.00503/i586-linux/DynaLoader.pm line 169.
</PRE>

<P>
This means that you need to include the <CODE>-lz</CODE> compression library on the
link line. That can be done by changing the following line in the file
<TT>`lib/DBD/mysql/Install.pm'</TT>:

</P>

<PRE>
$sysliblist .= " -lm";
</PRE>

<P>
Change that line to:

</P>

<PRE>
$sysliblist .= " -lm -lz";
</PRE>

<P>
After this, you <STRONG>must</STRONG> run <CODE>make realclean</CODE> and then
proceed with the installation from the beginning.

</P>
<P>
If you want to install DBI on SCO, you have to edit the
<TT>`Makefile'</TT> in DBI-xxx and each subdirectory.

</P>
<P>
Note that the following assumes <CODE>gcc</CODE> 2.95.2 or newer:

</P>

<PRE>
OLD:                                  NEW:
CC = cc                               CC = gcc
CCCDLFLAGS = -KPIC -W1,-Bexport       CCCDLFLAGS = -fpic
CCDLFLAGS = -wl,-Bexport              CCDLFLAGS =

LD = ld                               LD = gcc -G -fpic
LDDLFLAGS = -G -L/usr/local/lib       LDDLFLAGS = -L/usr/local/lib
LDFLAGS = -belf -L/usr/local/lib      LDFLAGS = -L/usr/local/lib

LD = ld                               LD = gcc -G -fpic
OPTIMISE = -Od                        OPTIMISE = -O1

OLD:
CCCFLAGS = -belf -dy -w0 -U M_XENIX -DPERL_SCO5 -I/usr/local/include

NEW:
CCFLAGS = -U M_XENIX -DPERL_SCO5 -I/usr/local/include
</PRE>

<P>
This is because the Perl dynaloader will not load the <CODE>DBI</CODE> modules
if they were compiled with <CODE>icc</CODE> or <CODE>cc</CODE>.

</P>
<P>
If you want to use the Perl module on a system that doesn't support
dynamic linking (like SCO), you can generate a static version of
Perl that includes <CODE>DBI</CODE> and <CODE>DBD::mysql</CODE>.  The way this works
is that you generate a version of Perl with the <CODE>DBI</CODE> code linked
in and install it on top of your current Perl.  Then you use that to
build a version of Perl that additionally has the <CODE>DBD</CODE> code linked
in, and install that.

</P>
<P>
On SCO, you must have the following environment variables set:

</P>

<PRE>
LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib:/usr/progressive/lib
</PRE>

<P>
Or:

</P>

<PRE>
LD_LIBRARY_PATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:\
    /usr/progressive/lib:/usr/skunk/lib
LIBPATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:\
    /usr/progressive/lib:/usr/skunk/lib
MANPATH=scohelp:/usr/man:/usr/local1/man:/usr/local/man:\
    /usr/skunk/man:
</PRE>

<P>
First, create a Perl that includes a statically linked <CODE>DBI</CODE> module by
running these commands in the directory where your <CODE>DBI</CODE> distribution is
located:

</P>

<PRE>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</PRE>

<P>
Then you must install the new Perl. The output of <CODE>make perl</CODE> will
indicate the exact <CODE>make</CODE> command you will need to execute to perform
the installation.  On SCO, this is
<CODE>make -f Makefile.aperl inst_perl MAP_TARGET=perl</CODE>.

</P>
<P>
Next, use the just-created Perl to create another Perl that also includes a
statically linked <CODE>DBD::mysql</CODE> by running these commands in the
directory where your <CODE>DBD::mysql</CODE> distribution is located:

</P>

<PRE>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</PRE>

<P>
Finally, you should install this new Perl.  Again, the output of <CODE>make
perl</CODE> indicates the command to use.

</P>



<H1><A NAME="Tutorial" HREF="manual_toc.html#Tutorial">3  MySQL Tutorial</A></H1>

<P>
<A NAME="IDX384"></A>
<A NAME="IDX385"></A>
<A NAME="IDX386"></A>
<A NAME="IDX387"></A>

</P>

<P>
This chapter provides a tutorial introduction to MySQL by showing
how to use the <CODE>mysql</CODE> client program to create and use a simple
database.  <CODE>mysql</CODE> (sometimes referred to as the ``terminal monitor'' or
just ``monitor'') is an interactive program that allows you to connect to a
MySQL server, run queries, and view the results.  <CODE>mysql</CODE> may
also be used in batch mode: you place your queries in a file beforehand, then
tell <CODE>mysql</CODE> to execute the contents of the file.  Both ways of using
<CODE>mysql</CODE> are covered here.

</P>
<P>
To see a list of options provided by <CODE>mysql</CODE>, invoke it with
the <CODE>--help</CODE> option:

</P>

<PRE>
shell&#62; mysql --help
</PRE>

<P>
This chapter assumes that <CODE>mysql</CODE> is installed on your machine and that
a MySQL server is available to which you can connect.  If this is
not true, contact your MySQL administrator.  (If <STRONG>you</STRONG> are the
administrator, you will need to consult other sections of this manual.)

</P>
<P>
This chapter describes the entire process of setting up and using a
database.  If you are interested only in accessing an already-existing
database, you may want to skip over the sections that describe how to
create the database and the tables it contains.

</P>
<P>
Because this chapter is tutorial in nature, many details are necessarily
omitted.  Consult the relevant sections of the manual for more
information on the topics covered here.

</P>



<H2><A NAME="Connecting-disconnecting" HREF="manual_toc.html#Connecting-disconnecting">3.1  Connecting to and Disconnecting from the Server</A></H2>

<P>
<A NAME="IDX388"></A>
<A NAME="IDX389"></A>
<A NAME="IDX390"></A>
<A NAME="IDX391"></A>

</P>
<P>
To connect to the server, you'll usually need to provide a MySQL
username when you invoke <CODE>mysql</CODE> and, most likely, a password.  If the
server runs on a machine other than the one where you log in, you'll also
need to specify a hostname.  Contact your administrator to find out what
connection parameters you should use to connect (that is, what host, username,
and password to use).  Once you know the proper parameters, you should be
able to connect like this:

</P>

<PRE>
shell&#62; mysql -h host -u user -p
Enter password: ********
</PRE>

<P>
<CODE>host</CODE> and <CODE>user</CODE> represent the hostname where your MySQL server is
running and the username of your MySQL account.  Substitute appropriate values
for your setup.
The <CODE>********</CODE> represents your password; enter it when <CODE>mysql</CODE>
displays the <CODE>Enter password:</CODE> prompt.

</P>
<P>
If that works, you should see some introductory information followed by a
<CODE>mysql&#62;</CODE> prompt:

</P>


<PRE>
shell&#62; mysql -h host -u user -p
Enter password: ********
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 25338 to server version: 4.0.14-log

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&#62;
</PRE>

<P>
The prompt tells you that <CODE>mysql</CODE> is ready for you to enter commands.

</P>
<P>
Some MySQL installations allow users to connect as the anonymous
(unnamed) user to the server running on the local host.  If this is the case
on your machine, you should be able to connect to that server by invoking
<CODE>mysql</CODE> without any options:

</P>

<PRE>
shell&#62; mysql
</PRE>

<P>
After you have connected successfully, you can disconnect any time by typing
<CODE>QUIT</CODE> (or <CODE>\q</CODE>) at the <CODE>mysql&#62;</CODE> prompt:

</P>

<PRE>
mysql&#62; QUIT
Bye
</PRE>

<P>
On Unix, you can also disconnect by pressing Control-D.

</P>
<P>
Most examples in the following sections assume that you are connected to the
server.  They indicate this by the <CODE>mysql&#62;</CODE> prompt.

</P>



<H2><A NAME="Entering_queries" HREF="manual_toc.html#Entering_queries">3.2  Entering Queries</A></H2>

<P>
<A NAME="IDX392"></A>
<A NAME="IDX393"></A>
<A NAME="IDX394"></A>

</P>
<P>
Make sure that you are connected to the server, as discussed in the previous
section.  Doing so will not in itself select any database to work with, but
that's okay.  At this point, it's more important to find out a little about
how to issue queries than to jump right in creating tables, loading data
into them, and retrieving data from them.  This section describes the basic
principles of entering commands, using several queries you can try out to
familiarize yourself with how <CODE>mysql</CODE> works.

</P>
<P>
Here's a simple command that asks the server to tell you its version number
and the current date.  Type it in as shown here following the <CODE>mysql&#62;</CODE>
prompt and press Enter:

</P>

<PRE>
mysql&#62; SELECT VERSION(), CURRENT_DATE;
+--------------+--------------+
| VERSION()    | CURRENT_DATE |
+--------------+--------------+
| 3.22.20a-log | 1999-03-19   |
+--------------+--------------+
1 row in set (0.01 sec)
mysql&#62;
</PRE>

<P>
This query illustrates several things about <CODE>mysql</CODE>:

</P>

<UL>
<LI>

A command normally consists of an SQL statement followed by a semicolon.
(There are some exceptions where a semicolon may be omitted.  <CODE>QUIT</CODE>,
mentioned earlier, is one of them.  We'll get to others later.)

<LI>

When you issue a command, <CODE>mysql</CODE> sends it to the server for execution
and displays the results, then prints another <CODE>mysql&#62;</CODE> prompt to indicate
that it is ready for another command.

<LI>

<CODE>mysql</CODE> displays query output in tabular form (rows and columns).  The
first row contains labels for the columns.  The rows following are the query
results.  Normally, column labels are the names of the columns you fetch from
database tables.  If you're retrieving the value of an expression rather than
a table column (as in the example just shown), <CODE>mysql</CODE> labels the column
using the expression itself.

<LI>

<CODE>mysql</CODE> shows how many rows were returned and how long the query took
to execute, which gives you a rough idea of server performance.  These values
are imprecise because they represent wall clock time (not CPU or machine
time), and because they are affected by factors such as server load and
network latency.  (For brevity, the ``rows in set'' line is not shown in
the remaining examples in this chapter.)
</UL>

<P>
Keywords may be entered in any lettercase.  The following queries are
equivalent:

</P>

<PRE>
mysql&#62; SELECT VERSION(), CURRENT_DATE;
mysql&#62; select version(), current_date;
mysql&#62; SeLeCt vErSiOn(), current_DATE;
</PRE>

<P>
Here's another query.  It demonstrates that you can use <CODE>mysql</CODE> as a
simple calculator:

</P>

<PRE>
mysql&#62; SELECT SIN(PI()/4), (4+1)*5;
+-------------+---------+
| SIN(PI()/4) | (4+1)*5 |
+-------------+---------+
|    0.707107 |      25 |
+-------------+---------+
</PRE>

<P>
The queries shown thus far have been relatively short, single-line
statements.  You can even enter multiple statements on a single line.
Just end each one with a semicolon:

</P>

<PRE>
mysql&#62; SELECT VERSION(); SELECT NOW();
+--------------+
| VERSION()    |
+--------------+
| 3.22.20a-log |
+--------------+

+---------------------+
| NOW()               |
+---------------------+
| 1999-03-19 00:15:33 |
+---------------------+
</PRE>

<P>
A command need not be given all on a single line, so lengthy commands that
require several lines are not a problem.  <CODE>mysql</CODE> determines where your
statement ends by looking for the terminating semicolon, not by looking for
the end of the input line.  (In other words, <CODE>mysql</CODE>
accepts free-format input:  it collects input lines but does not execute them
until it sees the semicolon.)

</P>
<P>
Here's a simple multiple-line statement:

</P>

<PRE>
mysql&#62; SELECT
    -&#62; USER()
    -&#62; ,
    -&#62; CURRENT_DATE;
+--------------------+--------------+
| USER()             | CURRENT_DATE |
+--------------------+--------------+
| joesmith@localhost | 1999-03-18   |
+--------------------+--------------+
</PRE>

<P>
In this example, notice how the prompt changes from <CODE>mysql&#62;</CODE> to
<CODE>-&#62;</CODE> after you enter the first line of a multiple-line query.  This is
how <CODE>mysql</CODE> indicates that it hasn't seen a complete statement and is
waiting for the rest.  The prompt is your friend, because it provides
valuable feedback.  If you use that feedback, you will always be aware of
what <CODE>mysql</CODE> is waiting for.

</P>
<P>
If you decide you don't want to execute a command that you are in the
process of entering, cancel it by typing <CODE>\c</CODE>:

</P>

<PRE>
mysql&#62; SELECT
    -&#62; USER()
    -&#62; \c
mysql&#62;
</PRE>

<P>
Here, too, notice the prompt.  It switches back to <CODE>mysql&#62;</CODE> after you
type <CODE>\c</CODE>, providing feedback to indicate that <CODE>mysql</CODE> is ready
for a new command.

</P>
<P>
The following table shows each of the prompts you may see and summarizes what
they mean about the state that <CODE>mysql</CODE> is in:

</P>
<P>
<A NAME="IDX395"></A>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Prompt</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>mysql&#62;</CODE> </TD><TD> Ready for new command.
</TD></TR>
<TR><TD><CODE>    -&#62;</CODE> </TD><TD> Waiting for next line of multiple-line command.
</TD></TR>
<TR><TD><CODE>    '&#62;</CODE> </TD><TD> Waiting for next line, collecting a string that begins with a single quote (<SAMP>`''</SAMP>).
</TD></TR>
<TR><TD><CODE>    "&#62;</CODE> </TD><TD> Waiting for next line, collecting a string that begins with a double quote (<SAMP>`"'</SAMP>).
</TD></TR>
<TR><TD><CODE>    `&#62;</CODE> </TD><TD> Waiting for next line, collecting an identifier that begins with a backtick (<SAMP>``'</SAMP>).
</TD></TR>
</TABLE>

</P>
<P>
Multiple-line statements commonly occur by accident when you intend to
issue a command on a single line, but forget the terminating semicolon.  In
this case, <CODE>mysql</CODE> waits for more input:

</P>

<PRE>
mysql&#62; SELECT USER()
    -&#62;
</PRE>

<P>
If this happens to you (you think you've entered a statement but the only
response is a <CODE>-&#62;</CODE> prompt), most likely <CODE>mysql</CODE> is waiting for the
semicolon.  If you don't notice what the prompt is telling you, you might sit
there for a while before realising what you need to do.  Enter a semicolon to
complete the statement, and <CODE>mysql</CODE> will execute it:

</P>

<PRE>
mysql&#62; SELECT USER()
    -&#62; ;
+--------------------+
| USER()             |
+--------------------+
| joesmith@localhost |
+--------------------+
</PRE>

<P>
The <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts occur during string collection.
In MySQL, you can write strings surrounded by either <SAMP>`''</SAMP>
or <SAMP>`"'</SAMP> characters (for example, <CODE>'hello'</CODE> or <CODE>"goodbye"</CODE>),
and <CODE>mysql</CODE> lets you enter strings that span multiple lines.  When you
see a <CODE>'&#62;</CODE> or <CODE>"&#62;</CODE> prompt, it means that you've entered a line
containing a string that begins with a <SAMP>`''</SAMP> or <SAMP>`"'</SAMP> quote character,
but have not yet entered the matching quote that terminates the string.
That's fine if you really are entering a multiple-line string, but how likely
is that?  Not very.  More often, the <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts indicate
that you've inadvertantly left out a quote character.  For example:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE name = 'Smith AND age &#60; 30;
    '&#62;
</PRE>

<P>
If you enter this <CODE>SELECT</CODE> statement, then press Enter and wait for the
result, nothing will happen.  Instead of wondering why this
query takes so long, notice the clue provided by the <CODE>'&#62;</CODE> prompt.  It
tells you that <CODE>mysql</CODE> expects to see the rest of an unterminated
string.  (Do you see the error in the statement?  The string <CODE>'Smith</CODE> is
missing the second quote.)

</P>
<P>
At this point, what do you do?  The simplest thing is to cancel the command.
However, you cannot just type <CODE>\c</CODE> in this case, because <CODE>mysql</CODE>
interprets it as part of the string that it is collecting!  Instead, enter
the closing quote character (so <CODE>mysql</CODE> knows you've finished the
string), then type <CODE>\c</CODE>:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE name = 'Smith AND age &#60; 30;
    '&#62; '\c
mysql&#62;
</PRE>

<P>
The prompt changes back to <CODE>mysql&#62;</CODE>, indicating that <CODE>mysql</CODE>
is ready for a new command.

</P>
<P>
The <CODE>`&#62;</CODE> prompt is similar to th <CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts,
but indicates that you have begun but not completed a backtick-quoted
identifier.

</P>
<P>
It's important to know what the <CODE>'&#62;</CODE>, <CODE>"&#62;</CODE>, and <CODE>`&#62;</CODE> prompts signify,
because if you mistakenly enter an unterminated string, any further lines you
type will appear to be ignored by <CODE>mysql</CODE>---including a line
containing <CODE>QUIT</CODE>!  This can be quite confusing, especially if you
don't know that you need to supply the terminating quote before you can
cancel the current command.

</P>



<H2><A NAME="Database_use" HREF="manual_toc.html#Database_use">3.3  Creating and Using a Database</A></H2>

<P>
<A NAME="IDX396"></A>
<A NAME="IDX397"></A>
<A NAME="IDX398"></A>

</P>

<P>
Now that you know how to enter commands, it's time to access a database.

</P>
<P>
Suppose that you have several pets in your home (your menagerie) and you'd
like to keep track of various types of information about them.  You can do so
by creating tables to hold your data and loading them with the desired
information.  Then you can answer different sorts of questions about your
animals by retrieving data from the tables.  This section shows you how to:

</P>

<UL>
<LI>

Create a database
<LI>

Create a table
<LI>

Load data into the table
<LI>

Retrieve data from the table in various ways
<LI>

Use multiple tables
</UL>

<P>
The menagerie database will be simple (deliberately), but it is not difficult
to think of real-world situations in which a similar type of database might
be used.  For example, a database like this could be used by a farmer to keep
track of livestock, or by a veterinarian to keep track of patient records.
A menagerie distribution containing some of the queries and sample data used
in the following sections can be obtained from the MySQL Web site.
It's available in either compressed <CODE>tar</CODE> format
(<a HREF="http://www.mysql.com/Downloads/Contrib/Examples/menagerie.tar.gz">http://www.mysql.com/Downloads/Contrib/Examples/menagerie.tar.gz</a>)
or Zip format
(<a HREF="http://www.mysql.com/Downloads/Contrib/Examples/menagerie.zip">http://www.mysql.com/Downloads/Contrib/Examples/menagerie.zip</a>).

</P>
<P>
Use the <CODE>SHOW</CODE> statement to find out what databases currently exist
on the server:

</P>

<PRE>
mysql&#62; SHOW DATABASES;
+----------+
| Database |
+----------+
| mysql    |
| test     |
| tmp      |
+----------+
</PRE>

<P>
The list of databases is probably different on your machine, but the
<CODE>mysql</CODE> and <CODE>test</CODE> databases are likely to be among them.  The
<CODE>mysql</CODE> database is required because it describes user access
privileges.  The <CODE>test</CODE> database is often provided as a workspace for
users to try things out.

</P>
<P>
Note that you may not see all databases if you don't have the
<CODE>SHOW DATABASES</CODE> privilege. See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</P>
<P>
If the <CODE>test</CODE> database exists, try to access it:

</P>

<PRE>
mysql&#62; USE test
Database changed
</PRE>

<P>
Note that <CODE>USE</CODE>, like <CODE>QUIT</CODE>, does not require a semicolon.  (You
can terminate such statements with a semicolon if you like; it does no harm.)
The <CODE>USE</CODE> statement is special in another way, too:  it must be given on
a single line.

</P>
<P>
You can use the <CODE>test</CODE> database (if you have access to it) for the
examples that follow, but anything you create in that database can be
removed by anyone else with access to it.  For this reason, you should
probably ask your MySQL administrator for permission to use a
database of your own.  Suppose that you want to call yours <CODE>menagerie</CODE>.  The
administrator needs to execute a command like this:

</P>

<PRE>
mysql&#62; GRANT ALL ON menagerie.* TO 'your_mysql_name'@'your_client_host';
</PRE>

<P>
where <CODE>your_mysql_name</CODE> is the MySQL username assigned to
you and <CODE>your_client_host</CODE> is the host from which you connect to the
server.

</P>



<H3><A NAME="Creating_database" HREF="manual_toc.html#Creating_database">3.3.1  Creating and Selecting a Database</A></H3>

<P>
<A NAME="IDX399"></A>
<A NAME="IDX400"></A>

</P>
<P>
If the administrator creates your database for you when setting up your
permissions, you can begin using it.  Otherwise, you need to create it
yourself:

</P>

<PRE>
mysql&#62; CREATE DATABASE menagerie;
</PRE>

<P>
Under Unix, database names are case-sensitive (unlike SQL keywords), so you
must always refer to your database as <CODE>menagerie</CODE>, not as
<CODE>Menagerie</CODE>, <CODE>MENAGERIE</CODE>, or some other variant.  This is also true
for table names.  (Under Windows, this restriction does not apply, although
you must refer to databases and tables using the same lettercase throughout a
given query.)

</P>
<P>
Creating a database does not select it for use; you must do that explicitly.
To make <CODE>menagerie</CODE> the current database, use this command:

</P>

<PRE>
mysql&#62; USE menagerie
Database changed
</PRE>

<P>
Your database needs to be created only once, but you must select it for use
each time you begin a <CODE>mysql</CODE> session.  You can do this by issuing a
<CODE>USE</CODE> statement as shown in the example.  Alternatively, you can select the
database on the command line when you invoke <CODE>mysql</CODE>.  Just specify its
name after any connection parameters that you might need to provide.  For
example:

</P>

<PRE>
shell&#62; mysql -h host -u user -p menagerie
Enter password: ********
</PRE>

<P>
Note that <CODE>menagerie</CODE> is not your password on the command just shown.
If you want to supply your password on the command line after the <CODE>-p</CODE>
option, you must do so with no intervening space (for example, as
<CODE>-pmypassword</CODE>, not as <CODE>-p mypassword</CODE>).  However, putting your
password on the command line is not recommended, because doing so exposes it
to snooping by other users logged in on your machine.

</P>



<H3><A NAME="Creating_tables" HREF="manual_toc.html#Creating_tables">3.3.2  Creating a Table</A></H3>

<P>
<A NAME="IDX401"></A>
<A NAME="IDX402"></A>

</P>
<P>
Creating the database is the easy part, but at this point it's empty, as
<CODE>SHOW TABLES</CODE> will tell you:

</P>

<PRE>
mysql&#62; SHOW TABLES;
Empty set (0.00 sec)
</PRE>

<P>
The harder part is deciding what the structure of your database should be:
what tables you will need and what columns will be in each of them.

</P>
<P>
You'll want a table that contains a record for each of your pets.  This can
be called the <CODE>pet</CODE> table, and it should contain, as a bare minimum,
each animal's name.  Because the name by itself is not very interesting, the
table should contain other information.  For example, if more than one person
in your family keeps pets, you might want to list each animal's owner.  You
might also want to record some basic descriptive information such as species
and sex.

</P>
<P>
How about age?  That might be of interest, but it's not a good thing to store
in a database.  Age changes as time passes, which means you'd have to update
your records often.  Instead, it's better to store a fixed value such as
date of birth.  Then, whenever you need age, you can calculate it as the
difference between the current date and the birth date.  MySQL
provides functions for doing date arithmetic, so this is not difficult.
Storing birth date rather than age has other advantages, too:

</P>

<UL>
<LI>

You can use the database for tasks such as generating reminders for upcoming
pet birthdays.  (If you think this type of query is somewhat silly, note that
it is the same question you might ask in the context of a business database
to identify clients to whom you'll soon need to send out birthday greetings,
for that computer-assisted personal touch.)

<LI>

You can calculate age in relation to dates other than the current date.  For
example, if you store death date in the database, you can easily calculate
how old a pet was when it died.
</UL>

<P>
You can probably think of other types of information that would be useful in
the <CODE>pet</CODE> table, but the ones identified so far are sufficient for now:
name, owner, species, sex, birth, and death.

</P>
<P>
Use a <CODE>CREATE TABLE</CODE> statement to specify the layout of your table:

</P>

<PRE>
mysql&#62; CREATE TABLE pet (name VARCHAR(20), owner VARCHAR(20),
    -&#62; species VARCHAR(20), sex CHAR(1), birth DATE, death DATE);
</PRE>

<P>
<CODE>VARCHAR</CODE> is a good choice for the <CODE>name</CODE>, <CODE>owner</CODE>, and
<CODE>species</CODE> columns because the column values will vary in length.  The
lengths of those columns need not all be the same, and need not be
<CODE>20</CODE>.  You can pick any length from <CODE>1</CODE> to <CODE>255</CODE>, whatever
seems most reasonable to you.  (If you make a poor choice and it turns
out later that you need a longer field, MySQL provides an
<CODE>ALTER TABLE</CODE> statement.)

</P>
<P>
Several types of values can be chosen to represent sex in animal records,
such as <CODE>'m'</CODE>
and <CODE>'f'</CODE>, or perhaps <CODE>'male'</CODE> and <CODE>'female'</CODE>.  It's simplest
to use the single characters <CODE>'m'</CODE> and <CODE>'f'</CODE>.

</P>
<P>
The use of the <CODE>DATE</CODE> data type for the <CODE>birth</CODE> and <CODE>death</CODE>
columns is a fairly obvious choice.

</P>
<P>
Now that you have created a table, <CODE>SHOW TABLES</CODE> should produce some
output:

</P>

<PRE>
mysql&#62; SHOW TABLES;
+---------------------+
| Tables in menagerie |
+---------------------+
| pet                 |
+---------------------+
</PRE>

<P>
To verify that your table was created the way you expected, use
a <CODE>DESCRIBE</CODE> statement:

</P>

<PRE>
mysql&#62; DESCRIBE pet;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(20) | YES  |     | NULL    |       |
| owner   | varchar(20) | YES  |     | NULL    |       |
| species | varchar(20) | YES  |     | NULL    |       |
| sex     | char(1)     | YES  |     | NULL    |       |
| birth   | date        | YES  |     | NULL    |       |
| death   | date        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
</PRE>

<P>
You can use <CODE>DESCRIBE</CODE> any time, for example, if you forget the names of
the columns in your table or what types they have.

</P>



<H3><A NAME="Loading_tables" HREF="manual_toc.html#Loading_tables">3.3.3  Loading Data into a Table</A></H3>

<P>
<A NAME="IDX403"></A>
<A NAME="IDX404"></A>
<A NAME="IDX405"></A>

</P>
<P>
After creating your table, you need to populate it.  The <CODE>LOAD DATA</CODE> and
<CODE>INSERT</CODE> statements are useful for this.

</P>
<P>
Suppose that your pet records can be described as shown here.
(Observe that MySQL expects dates in <CODE>'YYYY-MM-DD'</CODE> format;
this may be different from what you are used to.)

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>name</STRONG> </TD><TD> <STRONG>owner</STRONG> </TD><TD> <STRONG>species</STRONG> </TD><TD> <STRONG>sex</STRONG> </TD><TD> <STRONG>birth</STRONG> </TD><TD> <STRONG>death</STRONG>
</TD></TR>
<TR><TD>Fluffy </TD><TD> Harold </TD><TD> cat </TD><TD> f </TD><TD> 1993-02-04 </TD><TD>
</TD></TR>
<TR><TD>Claws </TD><TD> Gwen </TD><TD> cat </TD><TD> m </TD><TD> 1994-03-17 </TD><TD>
</TD></TR>
<TR><TD>Buffy </TD><TD> Harold </TD><TD> dog </TD><TD> f </TD><TD> 1989-05-13 </TD><TD>
</TD></TR>
<TR><TD>Fang </TD><TD> Benny </TD><TD> dog </TD><TD> m </TD><TD> 1990-08-27 </TD><TD>
</TD></TR>
<TR><TD>Bowser </TD><TD> Diane </TD><TD> dog </TD><TD> m </TD><TD> 1979-08-31 </TD><TD> 1995-07-29
</TD></TR>
<TR><TD>Chirpy </TD><TD> Gwen </TD><TD> bird </TD><TD> f </TD><TD> 1998-09-11 </TD><TD>
</TD></TR>
<TR><TD>Whistler </TD><TD> Gwen </TD><TD> bird </TD><TD> </TD><TD> 1997-12-09 </TD><TD>
</TD></TR>
<TR><TD>Slim </TD><TD> Benny </TD><TD> snake </TD><TD> m </TD><TD> 1996-04-29 </TD><TD>
</TD></TR>
</TABLE>

<P>
Because you are beginning with an empty table, an easy way to populate it is to
create a text file containing a row for each of your animals, then load the
contents of the file into the table with a single statement.

</P>
<P>
You could create a text file <TT>`pet.txt'</TT> containing one record per line,
with values separated by tabs, and given in the order in which the columns
were listed in the <CODE>CREATE TABLE</CODE> statement.  For missing values (such
as unknown sexes or death dates for animals that are still living), you can
use <CODE>NULL</CODE> values.  To represent these in your text file, use
<CODE>\N</CODE> (backslash, capital-N).  For example, the record for Whistler the
bird would look like
this (where the whitespace between values is a single tab character):

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>name</STRONG> </TD><TD> <STRONG>owner</STRONG> </TD><TD> <STRONG>species</STRONG> </TD><TD> <STRONG>sex</STRONG> </TD><TD> <STRONG>birth</STRONG> </TD><TD> <STRONG>death</STRONG>
</TD></TR>
<TR><TD><CODE>Whistler</CODE> </TD><TD> <CODE>Gwen</CODE> </TD><TD> <CODE>bird</CODE> </TD><TD> <CODE>\N</CODE> </TD><TD> <CODE>1997-12-09</CODE> </TD><TD> <CODE>\N</CODE>
</TD></TR>
</TABLE>

<P>
To load the text file <TT>`pet.txt'</TT> into the <CODE>pet</CODE> table, use this
command:

</P>

<PRE>
mysql&#62; LOAD DATA LOCAL INFILE 'pet.txt' INTO TABLE pet;
</PRE>

<P>
Note that if you created the file on Windows with an editor that uses
<CODE>\r\n</CODE> as a line terminator, you should use:

</P>

<PRE>
mysql&#62; LOAD DATA LOCAL INFILE 'pet.txt' INTO TABLE pet
    -&#62; LINES TERMINATED BY '\r\n';
</PRE>

<P>
You can specify the column value separator and end of line marker explicitly
in the <CODE>LOAD DATA</CODE> statement if you wish, but the defaults are tab and
linefeed.  These are sufficient for the statement to read the file
<TT>`pet.txt'</TT> properly.

</P>
<P>
If the statement fails, it is likely that your MySQL installation does not
have local file capability enabled by default.  See
section <A HREF="manual.html#LOAD_DATA_LOCAL">5.3.4  Security Issues with <CODE>LOAD DATA LOCAL</CODE></A> for information on how to
change this.

</P>
<P>
When you want to add new records one at a time, the <CODE>INSERT</CODE> statement
is useful.  In its simplest form, you supply values for each column, in the
order in which the columns were listed in the <CODE>CREATE TABLE</CODE> statement.
Suppose that Diane gets a new hamster named Puffball.  You could add a new record
using an <CODE>INSERT</CODE> statement like this:

</P>

<PRE>
mysql&#62; INSERT INTO pet
    -&#62; VALUES ('Puffball','Diane','hamster','f','1999-03-30',NULL);
</PRE>

<P>
Note that string and date values are specified as quoted strings here.  Also,
with <CODE>INSERT</CODE>, you can insert <CODE>NULL</CODE> directly to represent a
missing value.  You do not use <CODE>\N</CODE> like you do with <CODE>LOAD DATA</CODE>.

</P>
<P>
From this example, you should be able to see that there would be a lot more
typing involved to load
your records initially using several <CODE>INSERT</CODE> statements rather
than a single <CODE>LOAD DATA</CODE> statement.

</P>



<H3><A NAME="Retrieving_data" HREF="manual_toc.html#Retrieving_data">3.3.4  Retrieving Information from a Table</A></H3>

<P>
<A NAME="IDX406"></A>
<A NAME="IDX407"></A>
<A NAME="IDX408"></A>
<A NAME="IDX409"></A>

</P>

<P>
The <CODE>SELECT</CODE> statement is used to pull information from a table.
The general form of the statement is:

</P>

<PRE>
SELECT what_to_select
FROM which_table
WHERE conditions_to_satisfy;
</PRE>

<P>
<CODE>what_to_select</CODE> indicates what you want to see.  This can be a list of
columns, or <CODE>*</CODE> to indicate ``all columns.'' <CODE>which_table</CODE>
indicates the table from which you want to retrieve data.  The <CODE>WHERE</CODE>
clause is optional.  If it's present, <CODE>conditions_to_satisfy</CODE> specifies
conditions that rows must satisfy to qualify for retrieval.

</P>



<H4><A NAME="Selecting_all" HREF="manual_toc.html#Selecting_all">3.3.4.1  Selecting All Data</A></H4>

<P>
The simplest form of <CODE>SELECT</CODE> retrieves everything from a table:

</P>

<PRE>
mysql&#62; SELECT * FROM pet;
+----------+--------+---------+------+------------+------------+
| name     | owner  | species | sex  | birth      | death      |
+----------+--------+---------+------+------------+------------+
| Fluffy   | Harold | cat     | f    | 1993-02-04 | NULL       |
| Claws    | Gwen   | cat     | m    | 1994-03-17 | NULL       |
| Buffy    | Harold | dog     | f    | 1989-05-13 | NULL       |
| Fang     | Benny  | dog     | m    | 1990-08-27 | NULL       |
| Bowser   | Diane  | dog     | m    | 1979-08-31 | 1995-07-29 |
| Chirpy   | Gwen   | bird    | f    | 1998-09-11 | NULL       |
| Whistler | Gwen   | bird    | NULL | 1997-12-09 | NULL       |
| Slim     | Benny  | snake   | m    | 1996-04-29 | NULL       |
| Puffball | Diane  | hamster | f    | 1999-03-30 | NULL       |
+----------+--------+---------+------+------------+------------+
</PRE>

<P>
This form of <CODE>SELECT</CODE> is useful if you want to review your entire table,
for example, after you've just loaded it with your initial dataset.  For
example, you may happen to think that the birth date for Bowser doesn't seem
quite right.  Consulting your original pedigree
papers, you find that the correct birth year should be 1989, not 1979.

</P>
<P>
There are least a couple of ways to fix this:

</P>

<UL>
<LI>

Edit the file <TT>`pet.txt'</TT> to correct the error, then empty the table
and reload it using <CODE>DELETE</CODE> and <CODE>LOAD DATA</CODE>:


<PRE>
mysql&#62; DELETE FROM pet;
mysql&#62; LOAD DATA LOCAL INFILE 'pet.txt' INTO TABLE pet;
</PRE>

However, if you do this, you must also re-enter the record for Puffball.

<LI>

Fix only the erroneous record with an <CODE>UPDATE</CODE> statement:


<PRE>
mysql&#62; UPDATE pet SET birth = '1989-08-31' WHERE name = 'Bowser';
</PRE>

The <CODE>UPDATE</CODE> changes only the record in question and does not require you
to reload the table.
</UL>



<H4><A NAME="Selecting_rows" HREF="manual_toc.html#Selecting_rows">3.3.4.2  Selecting Particular Rows</A></H4>

<P>
<A NAME="IDX410"></A>
<A NAME="IDX411"></A>

</P>
<P>
As shown in the preceding section, it is easy to retrieve an entire table.
Just omit the <CODE>WHERE</CODE> clause from the <CODE>SELECT</CODE> statement.
But typically you don't want
to see the entire table, particularly when it becomes large.  Instead,
you're usually more interested in answering a particular question, in which
case you specify some constraints on the information you want.  Let's look at
some selection queries in terms of questions about your pets that they
answer.

</P>
<P>
You can select only particular rows from your table.  For example, if you want
to verify the change that you made to Bowser's birth date, select Bowser's
record like this:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name = 'Bowser';
+--------+-------+---------+------+------------+------------+
| name   | owner | species | sex  | birth      | death      |
+--------+-------+---------+------+------------+------------+
| Bowser | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+-------+---------+------+------------+------------+
</PRE>

<P>
The output confirms that the year is correctly recorded now as 1989, not 1979.

</P>
<P>
String comparisons normally are case-insensitive, so you can specify the
name as <CODE>'bowser'</CODE>, <CODE>'BOWSER'</CODE>, etc.  The query result will be
the same.

</P>
<P>
You can specify conditions on any column, not just <CODE>name</CODE>.  For example,
if you want to know which animals were born after 1998, test the <CODE>birth</CODE>
column:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE birth &#62;= '1998-1-1';
+----------+-------+---------+------+------------+-------+
| name     | owner | species | sex  | birth      | death |
+----------+-------+---------+------+------------+-------+
| Chirpy   | Gwen  | bird    | f    | 1998-09-11 | NULL  |
| Puffball | Diane | hamster | f    | 1999-03-30 | NULL  |
+----------+-------+---------+------+------------+-------+
</PRE>

<P>
You can combine conditions, for example, to locate female dogs:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE species = 'dog' AND sex = 'f';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
The preceding query uses the <CODE>AND</CODE> logical operator.  There is also an
<CODE>OR</CODE> operator:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE species = 'snake' OR species = 'bird';
+----------+-------+---------+------+------------+-------+
| name     | owner | species | sex  | birth      | death |
+----------+-------+---------+------+------------+-------+
| Chirpy   | Gwen  | bird    | f    | 1998-09-11 | NULL  |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL  |
| Slim     | Benny | snake   | m    | 1996-04-29 | NULL  |
+----------+-------+---------+------+------------+-------+
</PRE>

<P>
<CODE>AND</CODE> and <CODE>OR</CODE> may be intermixed, although <CODE>AND</CODE> has higher
precedence than <CODE>OR</CODE>.  If you use both operators, it's a good idea
to use parentheses to indicate explicitly how conditions should be grouped:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE (species = 'cat' AND sex = 'm')
    -&#62; OR (species = 'dog' AND sex = 'f');
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>



<H4><A NAME="Selecting_columns" HREF="manual_toc.html#Selecting_columns">3.3.4.3  Selecting Particular Columns</A></H4>

<P>
<A NAME="IDX412"></A>
<A NAME="IDX413"></A>

</P>
<P>
If you don't want to see entire rows from your table, just name the columns
in which you're interested, separated by commas.  For example, if you want to
know when your animals were born, select the <CODE>name</CODE> and <CODE>birth</CODE>
columns:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet;
+----------+------------+
| name     | birth      |
+----------+------------+
| Fluffy   | 1993-02-04 |
| Claws    | 1994-03-17 |
| Buffy    | 1989-05-13 |
| Fang     | 1990-08-27 |
| Bowser   | 1989-08-31 |
| Chirpy   | 1998-09-11 |
| Whistler | 1997-12-09 |
| Slim     | 1996-04-29 |
| Puffball | 1999-03-30 |
+----------+------------+
</PRE>

<P>
To find out who owns pets, use this query:

</P>

<PRE>
mysql&#62; SELECT owner FROM pet;
+--------+
| owner  |
+--------+
| Harold |
| Gwen   |
| Harold |
| Benny  |
| Diane  |
| Gwen   |
| Gwen   |
| Benny  |
| Diane  |
+--------+
</PRE>

<P>
<A NAME="IDX414"></A>
However, notice that the query simply retrieves the <CODE>owner</CODE> field from
each record, and some of them appear more than once.  To minimize the output,
retrieve each unique output record just once by adding the keyword
<CODE>DISTINCT</CODE>:

</P>

<PRE>
mysql&#62; SELECT DISTINCT owner FROM pet;
+--------+
| owner  |
+--------+
| Benny  |
| Diane  |
| Gwen   |
| Harold |
+--------+
</PRE>

<P>
You can use a <CODE>WHERE</CODE> clause to combine row selection with column
selection.  For example, to get birth dates for dogs and cats only,
use this query:

</P>

<PRE>
mysql&#62; SELECT name, species, birth FROM pet
    -&#62; WHERE species = 'dog' OR species = 'cat';
+--------+---------+------------+
| name   | species | birth      |
+--------+---------+------------+
| Fluffy | cat     | 1993-02-04 |
| Claws  | cat     | 1994-03-17 |
| Buffy  | dog     | 1989-05-13 |
| Fang   | dog     | 1990-08-27 |
| Bowser | dog     | 1989-08-31 |
+--------+---------+------------+
</PRE>



<H4><A NAME="Sorting_rows" HREF="manual_toc.html#Sorting_rows">3.3.4.4  Sorting Rows</A></H4>

<P>
<A NAME="IDX415"></A>
<A NAME="IDX416"></A>
<A NAME="IDX417"></A>
<A NAME="IDX418"></A>
<A NAME="IDX419"></A>

</P>
<P>
You may have noticed in the preceding examples that the result rows are
displayed in no particular order.  It's often easier to examine
query output when the rows are sorted in some meaningful way.  To sort a
result, use an <CODE>ORDER BY</CODE> clause.

</P>
<P>
Here are animal birthdays, sorted by date:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet ORDER BY birth;
+----------+------------+
| name     | birth      |
+----------+------------+
| Buffy    | 1989-05-13 |
| Bowser   | 1989-08-31 |
| Fang     | 1990-08-27 |
| Fluffy   | 1993-02-04 |
| Claws    | 1994-03-17 |
| Slim     | 1996-04-29 |
| Whistler | 1997-12-09 |
| Chirpy   | 1998-09-11 |
| Puffball | 1999-03-30 |
+----------+------------+
</PRE>

<P>
On character type columns, sorting--like all other comparison
operations--is normally performed in a case-insensitive fashion.
This means that the order will be undefined for columns that are identical
except for their case. You can force a case-sensitive sort for a column
by using the <CODE>BINARY</CODE> cast: <CODE>ORDER BY BINARY col_name</CODE>.

</P>
<P>
The default sort order is ascending, with smallest values first.
To sort in reverse (descending) order, add the <CODE>DESC</CODE> keyword to the
name of the column you are sorting by:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet ORDER BY birth DESC;
+----------+------------+
| name     | birth      |
+----------+------------+
| Puffball | 1999-03-30 |
| Chirpy   | 1998-09-11 |
| Whistler | 1997-12-09 |
| Slim     | 1996-04-29 |
| Claws    | 1994-03-17 |
| Fluffy   | 1993-02-04 |
| Fang     | 1990-08-27 |
| Bowser   | 1989-08-31 |
| Buffy    | 1989-05-13 |
+----------+------------+
</PRE>

<P>
You can sort on multiple columns, and you can sort columns in different
directions.  For example, to sort by type of
animal in ascending order, then by birth date within animal type in descending
order (youngest animals first), use the following query:

</P>

<PRE>
mysql&#62; SELECT name, species, birth FROM pet
    -&#62; ORDER BY species, birth DESC;
+----------+---------+------------+
| name     | species | birth      |
+----------+---------+------------+
| Chirpy   | bird    | 1998-09-11 |
| Whistler | bird    | 1997-12-09 |
| Claws    | cat     | 1994-03-17 |
| Fluffy   | cat     | 1993-02-04 |
| Fang     | dog     | 1990-08-27 |
| Bowser   | dog     | 1989-08-31 |
| Buffy    | dog     | 1989-05-13 |
| Puffball | hamster | 1999-03-30 |
| Slim     | snake   | 1996-04-29 |
+----------+---------+------------+
</PRE>

<P>
Note that the <CODE>DESC</CODE> keyword applies only to the column name immediately
preceding it (<CODE>birth</CODE>); it does not affect the <CODE>species</CODE> column sort
order.

</P>



<H4><A NAME="Date_calculations" HREF="manual_toc.html#Date_calculations">3.3.4.5  Date Calculations</A></H4>

<P>
<A NAME="IDX420"></A>
<A NAME="IDX421"></A>
<A NAME="IDX422"></A>
<A NAME="IDX423"></A>

</P>
<P>
MySQL provides several functions that you can use to perform
calculations on dates, for example, to calculate ages or extract
parts of dates.

</P>
<P>
To determine how many years old each of your pets is, compute the
difference in the year part of the current date and the birth date, then
subtract one if the current date occurs earlier in the calendar year than
the birth date.  The following query shows, for each pet, the birth date,
the current date, and the age in years.

</P>

<PRE>
mysql&#62; SELECT name, birth, CURDATE(),
    -&#62; (YEAR(CURDATE())-YEAR(birth))
    -&#62; - (RIGHT(CURDATE(),5)&#60;RIGHT(birth,5))
    -&#62; AS age
    -&#62; FROM pet;
+----------+------------+------------+------+
| name     | birth      | CURDATE()  | age  |
+----------+------------+------------+------+
| Fluffy   | 1993-02-04 | 2003-08-19 |   10 |
| Claws    | 1994-03-17 | 2003-08-19 |    9 |
| Buffy    | 1989-05-13 | 2003-08-19 |   14 |
| Fang     | 1990-08-27 | 2003-08-19 |   12 |
| Bowser   | 1989-08-31 | 2003-08-19 |   13 |
| Chirpy   | 1998-09-11 | 2003-08-19 |    4 |
| Whistler | 1997-12-09 | 2003-08-19 |    5 |
| Slim     | 1996-04-29 | 2003-08-19 |    7 |
| Puffball | 1999-03-30 | 2003-08-19 |    4 |
+----------+------------+------------+------+
</PRE>

<P>
Here, <CODE>YEAR()</CODE> pulls out the year part of a date and <CODE>RIGHT()</CODE>
pulls off the rightmost five characters that represent the <CODE>MM-DD</CODE>
(calendar year) part of the date.  The part of the expression that
compares the <CODE>MM-DD</CODE> values evaluates to 1 or 0, which adjusts the
year difference down a year if <CODE>CURDATE()</CODE> occurs earlier in
the year than <CODE>birth</CODE>.  The full expression is somewhat ungainly,
so an alias (<CODE>age</CODE>) is used to make the output column label more
meaningful.

</P>
<P>
The query works, but the result could be scanned more easily if the rows
were presented in some order.  This can be done by adding an <CODE>ORDER
BY name</CODE> clause to sort the output by name:

</P>

<PRE>
mysql&#62; SELECT name, birth, CURDATE(),
    -&#62; (YEAR(CURDATE())-YEAR(birth))
    -&#62; - (RIGHT(CURDATE(),5)&#60;RIGHT(birth,5))
    -&#62; AS age
    -&#62; FROM pet ORDER BY name;
+----------+------------+------------+------+
| name     | birth      | CURDATE()  | age  |
+----------+------------+------------+------+
| Bowser   | 1989-08-31 | 2003-08-19 |   13 |
| Buffy    | 1989-05-13 | 2003-08-19 |   14 |
| Chirpy   | 1998-09-11 | 2003-08-19 |    4 |
| Claws    | 1994-03-17 | 2003-08-19 |    9 |
| Fang     | 1990-08-27 | 2003-08-19 |   12 |
| Fluffy   | 1993-02-04 | 2003-08-19 |   10 |
| Puffball | 1999-03-30 | 2003-08-19 |    4 |
| Slim     | 1996-04-29 | 2003-08-19 |    7 |
| Whistler | 1997-12-09 | 2003-08-19 |    5 |
+----------+------------+------------+------+
</PRE>

<P>
To sort the output by <CODE>age</CODE> rather than <CODE>name</CODE>, just use a
different <CODE>ORDER BY</CODE> clause:

</P>

<PRE>
mysql&#62; SELECT name, birth, CURDATE(),
    -&#62; (YEAR(CURDATE())-YEAR(birth))
    -&#62; - (RIGHT(CURDATE(),5)&#60;RIGHT(birth,5))
    -&#62; AS age
    -&#62; FROM pet ORDER BY age;
+----------+------------+------------+------+
| name     | birth      | CURDATE()  | age  |
+----------+------------+------------+------+
| Chirpy   | 1998-09-11 | 2003-08-19 |    4 |
| Puffball | 1999-03-30 | 2003-08-19 |    4 |
| Whistler | 1997-12-09 | 2003-08-19 |    5 |
| Slim     | 1996-04-29 | 2003-08-19 |    7 |
| Claws    | 1994-03-17 | 2003-08-19 |    9 |
| Fluffy   | 1993-02-04 | 2003-08-19 |   10 |
| Fang     | 1990-08-27 | 2003-08-19 |   12 |
| Bowser   | 1989-08-31 | 2003-08-19 |   13 |
| Buffy    | 1989-05-13 | 2003-08-19 |   14 |
+----------+------------+------------+------+
</PRE>

<P>
A similar query can be used to determine age at death for animals that have
died.  You determine which animals these are by checking whether the
<CODE>death</CODE> value is <CODE>NULL</CODE>.  Then, for those with non-<CODE>NULL</CODE>
values, compute the difference between the <CODE>death</CODE> and <CODE>birth</CODE>
values:

</P>

<PRE>
mysql&#62; SELECT name, birth, death,
    -&#62; (YEAR(death)-YEAR(birth)) - (RIGHT(death,5)&#60;RIGHT(birth,5))
    -&#62; AS age
    -&#62; FROM pet WHERE death IS NOT NULL ORDER BY age;
+--------+------------+------------+------+
| name   | birth      | death      | age  |
+--------+------------+------------+------+
| Bowser | 1989-08-31 | 1995-07-29 |    5 |
+--------+------------+------------+------+
</PRE>

<P>
The query uses <CODE>death IS NOT NULL</CODE> rather than <CODE>death &#60;&#62; NULL</CODE>
because <CODE>NULL</CODE> is a special value that cannot be compared using the usual
comparison operators.  This is discussed later.
See section <A HREF="manual.html#Working_with_NULL">3.3.4.6  Working with <CODE>NULL</CODE> Values</A>.

</P>
<P>
What if you want to know which animals have birthdays next month?  For this
type of calculation, year and day are irrelevant; you simply want to extract
the month part of the <CODE>birth</CODE> column.  MySQL provides several
date-part extraction functions, such as <CODE>YEAR()</CODE>, <CODE>MONTH()</CODE>, and
<CODE>DAYOFMONTH()</CODE>.  <CODE>MONTH()</CODE> is the appropriate function here.  To
see how it works, run a simple query that displays the value of both
<CODE>birth</CODE> and <CODE>MONTH(birth)</CODE>:

</P>

<PRE>
mysql&#62; SELECT name, birth, MONTH(birth) FROM pet;
+----------+------------+--------------+
| name     | birth      | MONTH(birth) |
+----------+------------+--------------+
| Fluffy   | 1993-02-04 |            2 |
| Claws    | 1994-03-17 |            3 |
| Buffy    | 1989-05-13 |            5 |
| Fang     | 1990-08-27 |            8 |
| Bowser   | 1989-08-31 |            8 |
| Chirpy   | 1998-09-11 |            9 |
| Whistler | 1997-12-09 |           12 |
| Slim     | 1996-04-29 |            4 |
| Puffball | 1999-03-30 |            3 |
+----------+------------+--------------+
</PRE>

<P>
Finding animals with birthdays in the upcoming month is easy, too.  Suppose
that the current month is April.  Then the month value is <CODE>4</CODE> and you look
for animals born in May (month <CODE>5</CODE>) like this:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet WHERE MONTH(birth) = 5;
+-------+------------+
| name  | birth      |
+-------+------------+
| Buffy | 1989-05-13 |
+-------+------------+
</PRE>

<P>
There is a small complication if the current month is December.
You don't just add one to the month number (<CODE>12</CODE>) and look for animals
born in month <CODE>13</CODE>, because there is no such month.  Instead, you look for
animals born in January (month <CODE>1</CODE>).

</P>
<P>
You can even write the query so that it works no matter what the current
month is.  That way you don't have to use a particular month number
in the query.  <CODE>DATE_ADD()</CODE> allows you to add a time interval to a
given date.  If you add a month to the value of <CODE>CURDATE()</CODE>, then extract
the month part with <CODE>MONTH()</CODE>, the result produces the month in which to
look for birthdays:

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet
    -&#62; WHERE MONTH(birth) = MONTH(DATE_ADD(CURDATE(),INTERVAL 1 MONTH));
</PRE>

<P>
A different way to accomplish the same task is to add <CODE>1</CODE> to get the
next month after the current one (after using the modulo function (<CODE>MOD</CODE>)
to wrap around the month value to <CODE>0</CODE> if it is currently
<CODE>12</CODE>):

</P>

<PRE>
mysql&#62; SELECT name, birth FROM pet
    -&#62; WHERE MONTH(birth) = MOD(MONTH(CURDATE()), 12) + 1;
</PRE>

<P>
Note that <CODE>MONTH</CODE> returns a number between <CODE>1</CODE> and <CODE>12</CODE>. And
<CODE>MOD(something,12)</CODE> returns a number between <CODE>0</CODE> and <CODE>11</CODE>. So the
addition has to be after the <CODE>MOD()</CODE>, otherwise we would go from
November (<CODE>11</CODE>) to January (<CODE>1</CODE>).

</P>



<H4><A NAME="Working_with_NULL" HREF="manual_toc.html#Working_with_NULL">3.3.4.6  Working with <CODE>NULL</CODE> Values</A></H4>

<P>
<A NAME="IDX424"></A>
<A NAME="IDX425"></A>

</P>
<P>
The <CODE>NULL</CODE> value can be surprising until you get used to it.
Conceptually, <CODE>NULL</CODE> means missing value or unknown value and it
is treated somewhat differently than other values.  To test for <CODE>NULL</CODE>,
you cannot use the arithmetic comparison operators such as <CODE>=</CODE>, <CODE>&#60;</CODE>,
or <CODE>&#60;&#62;</CODE>.  To demonstrate this for yourself, try the following query:

</P>

<PRE>
mysql&#62; SELECT 1 = NULL, 1 &#60;&#62; NULL, 1 &#60; NULL, 1 &#62; NULL;
+----------+-----------+----------+----------+
| 1 = NULL | 1 &#60;&#62; NULL | 1 &#60; NULL | 1 &#62; NULL |
+----------+-----------+----------+----------+
|     NULL |      NULL |     NULL |     NULL |
+----------+-----------+----------+----------+
</PRE>

<P>
Clearly you get no meaningful results from these comparisons.  Use
the <CODE>IS NULL</CODE> and <CODE>IS NOT NULL</CODE> operators instead:

</P>

<PRE>
mysql&#62; SELECT 1 IS NULL, 1 IS NOT NULL;
+-----------+---------------+
| 1 IS NULL | 1 IS NOT NULL |
+-----------+---------------+
|         0 |             1 |
+-----------+---------------+
</PRE>

<P>
Note that in MySQL, <CODE>0</CODE> or <CODE>NULL</CODE> means false and anything else means
true. The default truth value from a boolean operation is <CODE>1</CODE>.

</P>
<P>
This special treatment of <CODE>NULL</CODE> is why, in the previous section, it
was necessary to determine which animals are no longer alive using
<CODE>death IS NOT NULL</CODE> instead of <CODE>death &#60;&#62; NULL</CODE>.

</P>
<P>
Two <CODE>NULL</CODE> values are regarded as equal in a <CODE>GROUP BY</CODE>.

</P>
<P>
When doing an <CODE>ORDER BY</CODE>, <CODE>NULL</CODE> values are presented first if you
do <CODE>ORDER BY ... ASC</CODE> and last if you do <CODE>ORDER BY ... DESC</CODE>.

</P>
<P>
Note that MySQL 4.0.2 to 4.0.10 incorrectly always sorts <CODE>NULL</CODE> values
first regardless of the sort direction.

</P>



<H4><A NAME="Pattern_matching" HREF="manual_toc.html#Pattern_matching">3.3.4.7  Pattern Matching</A></H4>

<P>
<A NAME="IDX426"></A>
<A NAME="IDX427"></A>
<A NAME="IDX428"></A>

</P>
<P>
MySQL provides standard SQL pattern matching as well as a form of
pattern matching based on extended regular expressions similar to those used
by Unix utilities such as <CODE>vi</CODE>, <CODE>grep</CODE>, and <CODE>sed</CODE>.

</P>
<P>
SQL pattern matching allows you to use <SAMP>`_'</SAMP> to match any single
character and <SAMP>`%'</SAMP> to match an arbitrary number of characters (including
zero characters).  In MySQL, SQL patterns are case-insensitive by
default.  Some examples are shown here.  Note that you do not use <CODE>=</CODE>
or <CODE>&#60;&#62;</CODE> when you use SQL patterns; use the <CODE>LIKE</CODE> or <CODE>NOT
LIKE</CODE> comparison operators instead.

</P>
<P>
To find names beginning with <SAMP>`b'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE 'b%';
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
</PRE>

<P>
To find names ending with <SAMP>`fy'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE '%fy';
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
</PRE>

<P>
To find names containing a <SAMP>`w'</SAMP>:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE '%w%';
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
</PRE>

<P>
To find names containing exactly five characters, use five instances of
the <SAMP>`_'</SAMP> pattern character:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name LIKE '_____';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
The other type of pattern matching provided by MySQL uses extended
regular expressions.  When you test for a match for this type of pattern, use
the <CODE>REGEXP</CODE> and <CODE>NOT REGEXP</CODE> operators (or <CODE>RLIKE</CODE> and
<CODE>NOT RLIKE</CODE>, which are synonyms).

</P>
<P>
Some characteristics of extended regular expressions are:

</P>

<UL>
<LI>

<SAMP>`.'</SAMP> matches any single character.

<LI>

A character class <SAMP>`[...]'</SAMP> matches any character within the brackets.
For example, <SAMP>`[abc]'</SAMP> matches <SAMP>`a'</SAMP>, <SAMP>`b'</SAMP>, or <SAMP>`c'</SAMP>.  To name a
range of characters, use a dash.  <SAMP>`[a-z]'</SAMP> matches any letter,
whereas <SAMP>`[0-9]'</SAMP> matches any digit.

<LI>

<SAMP>`*'</SAMP> matches zero or more instances of the thing preceding it.  For
example, <SAMP>`x*'</SAMP> matches any number of <SAMP>`x'</SAMP> characters,
<SAMP>`[0-9]*'</SAMP> matches any number of digits, and <SAMP>`.*'</SAMP> matches any
number of anything.

<LI>

A <CODE>REGEXP</CODE> pattern match succeed if
the pattern matches anywhere in the value being tested.
(This differs from a <CODE>LIKE</CODE> pattern match, which succeeds only if the
pattern matches the entire value.)

<LI>

To anchor a pattern so that it must match the beginning or end of the value
being tested, use <SAMP>`^'</SAMP> at the beginning or <SAMP>`$'</SAMP> at the end of the
pattern.
</UL>

<P>
To demonstrate how extended regular expressions work, the <CODE>LIKE</CODE> queries
shown previously are rewritten here to use <CODE>REGEXP</CODE>.

</P>
<P>
To find names beginning with <SAMP>`b'</SAMP>, use <SAMP>`^'</SAMP> to match the beginning of
the name:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP '^b';
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
</PRE>

<P>
Prior to MySQL Version 3.23.4, <CODE>REGEXP</CODE> is case-sensitive,
and the previous query will return no rows. In this case, to match either
lowercase or uppercase <SAMP>`b'</SAMP>, use this query instead:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP '^[bB]';
</PRE>

<P>
From MySQL 3.23.4 on, if you really want to force a <CODE>REGEXP</CODE> comparison to
be case-sensitive, use the <CODE>BINARY</CODE> keyword to make one of the
strings a binary string. This query will match only lowercase <SAMP>`b'</SAMP>
at the beginning of a name:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP BINARY '^b';
</PRE>

<P>
To find names ending with <SAMP>`fy'</SAMP>, use <SAMP>`$'</SAMP> to match the end of the
name:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP 'fy$';
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
</PRE>

<P>
To find names containing a <SAMP>`w'</SAMP>, use this query:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP 'w';
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
</PRE>

<P>
Because a regular expression pattern matches if it occurs anywhere in the
value, it is not necessary in the previous query to put a wildcard on either
side of the pattern to get it to match the entire value like it would be if
you used an SQL pattern.

</P>
<P>
To find names containing exactly five characters, use <SAMP>`^'</SAMP> and <SAMP>`$'</SAMP>
to match the beginning and end of the name, and five instances of <SAMP>`.'</SAMP>
in between:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP '^.....$';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>

<P>
You could also write the previous query using the <SAMP>`{n}'</SAMP>
``repeat-<CODE>n</CODE>-times'' operator:

</P>

<PRE>
mysql&#62; SELECT * FROM pet WHERE name REGEXP '^.{5}$';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
</PRE>



<H4><A NAME="Counting_rows" HREF="manual_toc.html#Counting_rows">3.3.4.8  Counting Rows</A></H4>

<P>
<A NAME="IDX429"></A>
<A NAME="IDX430"></A>
<A NAME="IDX431"></A>

</P>
<P>
Databases are often used to answer the question, ``How often does a certain
type of data occur in a table?''  For example, you might want to know how
many pets you have, or how many pets each owner has, or you might want to
perform various kinds of census operations on your animals.

</P>
<P>
Counting the total number of animals you have is the same question as ``How
many rows are in the <CODE>pet</CODE> table?'' because there is one record per pet.
<CODE>COUNT(*)</CODE> counts the number of rows, so
the query to count your animals looks like this:

</P>

<PRE>
mysql&#62; SELECT COUNT(*) FROM pet;
+----------+
| COUNT(*) |
+----------+
|        9 |
+----------+
</PRE>

<P>
Earlier, you retrieved the names of the people who owned pets.  You can
use <CODE>COUNT()</CODE> if you want to find out how many pets each owner has:

</P>

<PRE>
mysql&#62; SELECT owner, COUNT(*) FROM pet GROUP BY owner;
+--------+----------+
| owner  | COUNT(*) |
+--------+----------+
| Benny  |        2 |
| Diane  |        2 |
| Gwen   |        3 |
| Harold |        2 |
+--------+----------+
</PRE>

<P>
Note the use of <CODE>GROUP BY</CODE> to group together all records for each
<CODE>owner</CODE>.  Without it, all you get is an error message:

</P>

<PRE>
mysql&#62; SELECT owner, COUNT(*) FROM pet;
ERROR 1140: Mixing of GROUP columns (MIN(),MAX(),COUNT()...)
with no GROUP columns is illegal if there is no GROUP BY clause
</PRE>

<P>
<CODE>COUNT()</CODE> and <CODE>GROUP BY</CODE> are useful for characterizing your
data in various ways.  The following examples show different ways to
perform animal census operations.

</P>
<P>
Number of animals per species:

</P>

<PRE>
mysql&#62; SELECT species, COUNT(*) FROM pet GROUP BY species;
+---------+----------+
| species | COUNT(*) |
+---------+----------+
| bird    |        2 |
| cat     |        2 |
| dog     |        3 |
| hamster |        1 |
| snake   |        1 |
+---------+----------+
</PRE>

<P>
Number of animals per sex:

</P>

<PRE>
mysql&#62; SELECT sex, COUNT(*) FROM pet GROUP BY sex;
+------+----------+
| sex  | COUNT(*) |
+------+----------+
| NULL |        1 |
| f    |        4 |
| m    |        4 |
+------+----------+
</PRE>

<P>
(In this output, <CODE>NULL</CODE> indicates that the sex is unknown.)

</P>
<P>
Number of animals per combination of species and sex:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| bird    | NULL |        1 |
| bird    | f    |        1 |
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
| hamster | f    |        1 |
| snake   | m    |        1 |
+---------+------+----------+
</PRE>

<P>
You need not retrieve an entire table when you use <CODE>COUNT()</CODE>.  For
example, the previous query, when performed just on dogs and cats, looks like
this:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet
    -&#62; WHERE species = 'dog' OR species = 'cat'
    -&#62; GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
+---------+------+----------+
</PRE>

<P>
Or, if you wanted the number of animals per sex only for known-sex animals:

</P>

<PRE>
mysql&#62; SELECT species, sex, COUNT(*) FROM pet
    -&#62; WHERE sex IS NOT NULL
    -&#62; GROUP BY species, sex;
+---------+------+----------+
| species | sex  | COUNT(*) |
+---------+------+----------+
| bird    | f    |        1 |
| cat     | f    |        1 |
| cat     | m    |        1 |
| dog     | f    |        1 |
| dog     | m    |        2 |
| hamster | f    |        1 |
| snake   | m    |        1 |
+---------+------+----------+
</PRE>



<H4><A NAME="Multiple_tables" HREF="manual_toc.html#Multiple_tables">3.3.4.9  Using More Than one Table</A></H4>

<P>
<A NAME="IDX432"></A>

</P>
<P>
The <CODE>pet</CODE> table keeps track of which pets you have.  If you want to
record other information about them, such as events in their lives like
visits to the vet or when litters are born, you need another table.  What
should this table look like? It needs:

</P>

<UL>
<LI>

To contain the pet name so you know which animal each event pertains
to.

<LI>

A date so you know when the event occurred.

<LI>

A field to describe the event.

<LI>

An event type field, if you want to be able to categorize events.
</UL>

<P>
Given these considerations, the <CODE>CREATE TABLE</CODE> statement for the
<CODE>event</CODE> table might look like this:

</P>

<PRE>
mysql&#62; CREATE TABLE event (name VARCHAR(20), date DATE,
    -&#62; type VARCHAR(15), remark VARCHAR(255));
</PRE>

<P>
As with the <CODE>pet</CODE> table, it's easiest to load the initial records
by creating a tab-delimited text file containing the information:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>name</STRONG> </TD><TD> <STRONG>date</STRONG> </TD><TD> <STRONG>type</STRONG> </TD><TD> <STRONG>remark</STRONG>
</TD></TR>
<TR><TD>Fluffy </TD><TD> 1995-05-15 </TD><TD> litter </TD><TD> 4 kittens, 3 female, 1 male
</TD></TR>
<TR><TD>Buffy </TD><TD> 1993-06-23 </TD><TD> litter </TD><TD> 5 puppies, 2 female, 3 male
</TD></TR>
<TR><TD>Buffy </TD><TD> 1994-06-19 </TD><TD> litter </TD><TD> 3 puppies, 3 female
</TD></TR>
<TR><TD>Chirpy </TD><TD> 1999-03-21 </TD><TD> vet </TD><TD> needed beak straightened
</TD></TR>
<TR><TD>Slim </TD><TD> 1997-08-03 </TD><TD> vet </TD><TD> broken rib
</TD></TR>
<TR><TD>Bowser </TD><TD> 1991-10-12 </TD><TD> kennel </TD><TD>
</TD></TR>
<TR><TD>Fang </TD><TD> 1991-10-12 </TD><TD> kennel </TD><TD>
</TD></TR>
<TR><TD>Fang </TD><TD> 1998-08-28 </TD><TD> birthday </TD><TD> Gave him a new chew toy
</TD></TR>
<TR><TD>Claws </TD><TD> 1998-03-17 </TD><TD> birthday </TD><TD> Gave him a new flea collar
</TD></TR>
<TR><TD>Whistler </TD><TD> 1998-12-09 </TD><TD> birthday </TD><TD> First birthday
</TD></TR>
</TABLE>

<P>
Load the records like this:

</P>

<PRE>
mysql&#62; LOAD DATA LOCAL INFILE 'event.txt' INTO TABLE event;
</PRE>

<P>
Based on what you've learned from the queries you've run on the <CODE>pet</CODE>
table, you should be able to perform retrievals on the records in the
<CODE>event</CODE> table; the principles are the same.  But when is the
<CODE>event</CODE> table by itself insufficient to answer questions you might ask?

</P>
<P>
Suppose that you want to find out the ages at which each pet had its
litters. We saw earlier how to calculate ages from two dates.
The litter date of the mother is in the
<CODE>event</CODE> table, but to calculate her age on that date you need her
birth date, which is stored in the <CODE>pet</CODE> table.
This means the query requires both tables:

</P>

<PRE>
mysql&#62; SELECT pet.name,
    -&#62; (YEAR(date)-YEAR(birth)) - (RIGHT(date,5)&#60;RIGHT(birth,5)) AS age,
    -&#62; remark
    -&#62; FROM pet, event
    -&#62; WHERE pet.name = event.name AND type = 'litter';
+--------+------+-----------------------------+
| name   | age  | remark                      |
+--------+------+-----------------------------+
| Fluffy |    2 | 4 kittens, 3 female, 1 male |
| Buffy  |    4 | 5 puppies, 2 female, 3 male |
| Buffy  |    5 | 3 puppies, 3 female         |
+--------+------+-----------------------------+
</PRE>

<P>
There are several things to note about this query:

</P>

<UL>
<LI>

The <CODE>FROM</CODE> clause lists two tables because the query needs to pull
information from both of them.

<LI>

When combining (joining) information from multiple tables, you need to
specify how records in one table can be matched to records in the other.
This is easy because they both have a <CODE>name</CODE> column.  The query uses
<CODE>WHERE</CODE> clause to match up records in the two tables based on the
<CODE>name</CODE> values.

<LI>

Because the <CODE>name</CODE> column occurs in both tables, you must be specific
about which table you mean when referring to the column.  This is done
by prepending the table name to the column name.
</UL>

<P>
You need not have two different tables to perform a join.  Sometimes it is
useful to join a table to itself, if you want to compare records in a table
to other records in that same table.  For example, to find breeding pairs
among your pets, you can join the <CODE>pet</CODE> table with itself to produce
candidate pairs of males and females of like species:

</P>

<PRE>
mysql&#62; SELECT p1.name, p1.sex, p2.name, p2.sex, p1.species
    -&#62; FROM pet AS p1, pet AS p2
    -&#62; WHERE p1.species = p2.species AND p1.sex = 'f' AND p2.sex = 'm';
+--------+------+--------+------+---------+
| name   | sex  | name   | sex  | species |
+--------+------+--------+------+---------+
| Fluffy | f    | Claws  | m    | cat     |
| Buffy  | f    | Fang   | m    | dog     |
| Buffy  | f    | Bowser | m    | dog     |
+--------+------+--------+------+---------+
</PRE>

<P>
In this query, we specify aliases for the table name in order
to refer to the columns and keep straight which instance of the table
each column reference is associated with.

</P>



<H2><A NAME="Getting_information" HREF="manual_toc.html#Getting_information">3.4  Getting Information About Databases and Tables</A></H2>

<P>
<A NAME="IDX433"></A>
<A NAME="IDX434"></A>
<A NAME="IDX435"></A>

</P>
<P>
What if you forget the name of a database or table, or what the structure of
a given table is (for example, what its columns are called)?  MySQL
addresses this problem through several statements that provide information
about the databases and tables it supports.

</P>
<P>
You have already seen <CODE>SHOW DATABASES</CODE>, which lists the databases
managed by the server.  To find out which database is currently selected,
use the <CODE>DATABASE()</CODE> function:

</P>

<PRE>
mysql&#62; SELECT DATABASE();
+------------+
| DATABASE() |
+------------+
| menagerie  |
+------------+
</PRE>

<P>
If you haven't selected any database yet, the result is <CODE>NULL</CODE>
(or the empty string before MySQL 4.1.1).

</P>
<P>
To find out what tables the current database contains (for example, when
you're not sure about the name of a table), use this command:

</P>

<PRE>
mysql&#62; SHOW TABLES;
+---------------------+
| Tables in menagerie |
+---------------------+
| event               |
| pet                 |
+---------------------+
</PRE>

<P>
If you want to find out about the structure of a table, the <CODE>DESCRIBE</CODE>
command is useful; it displays information about each of a table's columns:

</P>

<PRE>
mysql&#62; DESCRIBE pet;
+---------+-------------+------+-----+---------+-------+
| Field   | Type        | Null | Key | Default | Extra |
+---------+-------------+------+-----+---------+-------+
| name    | varchar(20) | YES  |     | NULL    |       |
| owner   | varchar(20) | YES  |     | NULL    |       |
| species | varchar(20) | YES  |     | NULL    |       |
| sex     | char(1)     | YES  |     | NULL    |       |
| birth   | date        | YES  |     | NULL    |       |
| death   | date        | YES  |     | NULL    |       |
+---------+-------------+------+-----+---------+-------+
</PRE>

<P>
<CODE>Field</CODE> indicates the column name, <CODE>Type</CODE> is the data type for
the column, <CODE>NULL</CODE> indicates whether the column can contain
<CODE>NULL</CODE> values, <CODE>Key</CODE> indicates whether the column is
indexed, and <CODE>Default</CODE> specifies the column's default value.

</P>
<P>
If you have indexes on a table,
<CODE>SHOW INDEX FROM tbl_name</CODE> produces information about them.

</P>



<H2><A NAME="Batch_mode" HREF="manual_toc.html#Batch_mode">3.5  Using <CODE>mysql</CODE> in Batch Mode</A></H2>

<P>
<A NAME="IDX436"></A>
<A NAME="IDX437"></A>
<A NAME="IDX438"></A>
<A NAME="IDX439"></A>
<A NAME="IDX440"></A>

</P>
<P>
In the previous sections, you used <CODE>mysql</CODE> interactively to enter
queries and view the results.  You can also run <CODE>mysql</CODE> in batch
mode.  To do this, put the commands you want to run in a file, then
tell <CODE>mysql</CODE> to read its input from the file:

</P>

<PRE>
shell&#62; mysql &#60; batch-file
</PRE>

<P>
If you are running <CODE>mysql</CODE> under Windows and have some special
characters in the file that cause problems, you can do this:

</P>

<PRE>
dos&#62; mysql -e "source batch-file"
</PRE>

<P>
If you need to specify connection parameters on the command line, the
command might look like this:

</P>

<PRE>
shell&#62; mysql -h host -u user -p &#60; batch-file
Enter password: ********
</PRE>

<P>
When you use <CODE>mysql</CODE> this way, you are creating a script file, then
executing the script.

</P>
<P>
If you want the script to continue even if some of the statements in it
produce errors, you should
use the <CODE>--force</CODE> command-line option.

</P>
<P>
Why use a script?  Here are a few reasons:

</P>

<UL>
<LI>

If you run a query repeatedly (say, every day or every week), making it a
script allows you to avoid retyping it each time you execute it.

<LI>

You can generate new queries from existing ones that are similar by copying
and editing script files.

<LI>

Batch mode can also be useful while you're developing a query, particularly
for multiple-line commands or multiple-statement sequences of commands.  If
you make a mistake, you don't have to retype everything.  Just edit your
script to correct the error, then tell <CODE>mysql</CODE> to execute it again.

<LI>

If you have a query that produces a lot of output, you can run the output
through a pager rather than watching it scroll off the top of your screen:


<PRE>
shell&#62; mysql &#60; batch-file | more
</PRE>

<LI>

You can catch the output in a file for further processing:


<PRE>
shell&#62; mysql &#60; batch-file &#62; mysql.out
</PRE>

<LI>

You can distribute your script to other people so they can run the commands,
too.

<LI>

Some situations do not allow for interactive use, for example, when you run
a query from a <CODE>cron</CODE> job.  In this case, you must use batch mode.
</UL>

<P>
The default output format is different (more concise) when you run
<CODE>mysql</CODE> in batch mode than when you use it interactively.  For
example, the output of <CODE>SELECT DISTINCT species FROM pet</CODE> looks like
this when <CODE>mysql</CODE> is run interactively:

</P>

<PRE>
+---------+
| species |
+---------+
| bird    |
| cat     |
| dog     |
| hamster |
| snake   |
+---------+
</PRE>

<P>
In batch mode, the output looks like this instead:

</P>

<PRE>
species
bird
cat
dog
hamster
snake
</PRE>

<P>
If you want to get the interactive output format in batch mode, use
<CODE>mysql -t</CODE>.  To echo to the output the commands that are executed, use
<CODE>mysql -vvv</CODE>.

</P>
<P>
You can also use scripts from the <CODE>mysql</CODE> prompt by
using the <CODE>source</CODE> or <CODE>\.</CODE> command:

</P>

<PRE>
mysql&#62; source filename;
mysql&#62; \. filename;
</PRE>



<H2><A NAME="Examples" HREF="manual_toc.html#Examples">3.6  Examples of Common Queries</A></H2>

<P>
<A NAME="IDX441"></A>
<A NAME="IDX442"></A>

</P>
<P>
Here are examples of how to solve some common problems with
MySQL.

</P>
<P>
Some of the examples use the table <CODE>shop</CODE> to hold the price of each
article (item number) for certain traders (dealers).  Supposing that each
trader has a single fixed price per article, then (<CODE>article</CODE>,
<CODE>dealer</CODE>) is a primary key for the records.

</P>
<P>
Start the command-line tool <CODE>mysql</CODE> and select a database:

</P>

<PRE>
shell&#62; mysql your-database-name
</PRE>

<P>
(In most MySQL installations, you can use the database name <CODE>test</CODE>).

</P>
<P>
You can create and populate the example table with these statements:

</P>

<PRE>
mysql&#62; CREATE TABLE shop (
    -&#62; article INT(4) UNSIGNED ZEROFILL DEFAULT '0000' NOT NULL,
    -&#62; dealer  CHAR(20)                 DEFAULT ''     NOT NULL,
    -&#62; price   DOUBLE(16,2)             DEFAULT '0.00' NOT NULL,
    -&#62; PRIMARY KEY(article, dealer));
mysql&#62; INSERT INTO shop VALUES
    -&#62; (1,'A',3.45),(1,'B',3.99),(2,'A',10.99),(3,'B',1.45),
    -&#62; (3,'C',1.69),(3,'D',1.25),(4,'D',19.95);
</PRE>

<P>
After issuing the statements, the table should have the following contents:

</P>

<PRE>
mysql&#62; SELECT * FROM shop;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | A      |  3.45 |
|    0001 | B      |  3.99 |
|    0002 | A      | 10.99 |
|    0003 | B      |  1.45 |
|    0003 | C      |  1.69 |
|    0003 | D      |  1.25 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>



<H3><A NAME="example-Maximum-column" HREF="manual_toc.html#example-Maximum-column">3.6.1  The Maximum Value for a Column</A></H3>

<P>
``What's the highest item number?''

</P>

<PRE>
SELECT MAX(article) AS article FROM shop;

+---------+
| article |
+---------+
|       4 |
+---------+
</PRE>



<H3><A NAME="example-Maximum-row" HREF="manual_toc.html#example-Maximum-row">3.6.2  The Row Holding the Maximum of a Certain Column</A></H3>

<P>
``Find number, dealer, and price of the most expensive article.''

</P>
<P>
In standard SQL (and MySQL Version 4.1) this is easily done with a subquery:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop
WHERE  price=(SELECT MAX(price) FROM shop);
</PRE>

<P>
In MySQL versions prior to 4.1, just do it in two steps:

</P>

<OL>
<LI>

Get the maximum price value from the table with a <CODE>SELECT</CODE> statement.

<PRE>
mysql&#62; SELECT MAX(price) FROM shop;
+------------+
| MAX(price) |
+------------+
|      19.95 |
+------------+
</PRE>

<LI>

Using the value 19.95 shown by the previous query to be the maximum
article price, write a query to locate and display the corresponding record:

<PRE>
mysql&#62; SELECT article, dealer, price
    -&#62; FROM   shop
    -&#62; WHERE  price=19.95;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>

</OL>

<P>
Another solution is to sort all rows descending by price and only
get the first row using the MySQL-specific <CODE>LIMIT</CODE> clause:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop
ORDER BY price DESC
LIMIT 1;
</PRE>

<P>
<STRONG>Note:</STRONG>  If there were several most expensive articles, each with a
price of 19.95, the <CODE>LIMIT</CODE> solution would show only one of them!

</P>



<H3><A NAME="example-Maximum-column-group" HREF="manual_toc.html#example-Maximum-column-group">3.6.3  Maximum of Column per Group</A></H3>

<P>
``What's the highest price per article?''

</P>

<PRE>
SELECT article, MAX(price) AS price
FROM   shop
GROUP BY article

+---------+-------+
| article | price |
+---------+-------+
|    0001 |  3.99 |
|    0002 | 10.99 |
|    0003 |  1.69 |
|    0004 | 19.95 |
+---------+-------+
</PRE>



<H3><A NAME="example-Maximum-column-group-row" HREF="manual_toc.html#example-Maximum-column-group-row">3.6.4  The Rows Holding the Group-wise Maximum of a Certain Field</A></H3>

<P>
``For each article, find the dealer or dealers with the most expensive price.''

</P>
<P>
In standard SQL (and MySQL Version 4.1 or greater), the problem can be solved
with a subquery like this:

</P>

<PRE>
SELECT article, dealer, price
FROM   shop s1
WHERE  price=(SELECT MAX(s2.price)
              FROM shop s2
              WHERE s1.article = s2.article);
</PRE>

<P>
In MySQL versions prior to 4.1, it's best do it in several steps:

</P>

<OL>
<LI>

Get the list of (article,maxprice) pairs.
<LI>

For each article, get the corresponding rows that have the stored maximum
price.
</OL>

<P>
This can easily be done with a temporary table and a join:

</P>

<PRE>
CREATE TEMPORARY TABLE tmp (
        article INT(4) UNSIGNED ZEROFILL DEFAULT '0000' NOT NULL,
        price   DOUBLE(16,2)             DEFAULT '0.00' NOT NULL);

LOCK TABLES shop READ;

INSERT INTO tmp SELECT article, MAX(price) FROM shop GROUP BY article;

SELECT shop.article, dealer, shop.price FROM shop, tmp
WHERE shop.article=tmp.article AND shop.price=tmp.price;

UNLOCK TABLES;

DROP TABLE tmp;
</PRE>

<P>
If you don't use a <CODE>TEMPORARY</CODE> table, you must also lock the <CODE>tmp</CODE>
table.

</P>
<P>
``Can it be done with a single query?''

</P>
<P>
Yes, but only by using a quite inefficient trick called the
``MAX-CONCAT trick'':

</P>

<PRE>
SELECT article,
       SUBSTRING( MAX( CONCAT(LPAD(price,6,'0'),dealer) ), 7) AS dealer,
  0.00+LEFT(      MAX( CONCAT(LPAD(price,6,'0'),dealer) ), 6) AS price
FROM   shop
GROUP BY article;

+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0001 | B      |  3.99 |
|    0002 | A      | 10.99 |
|    0003 | C      |  1.69 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>

<P>
The last example can be made a bit more efficient by doing the
splitting of the concatenated column in the client.

</P>



<H3><A NAME="example-user-variables" HREF="manual_toc.html#example-user-variables">3.6.5  Using User Variables</A></H3>

<P>
You can use MySQL user variables to remember results without
having to store them in temporary variables in the client.
See section <A HREF="manual.html#Variables">10.3  User Variables</A>.

</P>
<P>
For example, to find the articles with the highest and lowest price you
can do this:

</P>

<PRE>
mysql&#62; SELECT @min_price:=MIN(price),@max_price:=MAX(price) FROM shop;
mysql&#62; SELECT * FROM shop WHERE price=@min_price OR price=@max_price;
+---------+--------+-------+
| article | dealer | price |
+---------+--------+-------+
|    0003 | D      |  1.25 |
|    0004 | D      | 19.95 |
+---------+--------+-------+
</PRE>



<H3><A NAME="example-Foreign_keys" HREF="manual_toc.html#example-Foreign_keys">3.6.6  Using Foreign Keys</A></H3>

<P>
<A NAME="IDX443"></A>
<A NAME="IDX444"></A>

</P>
<P>
In MySQL 3.23.44 and up, <CODE>InnoDB</CODE> tables support checking of
foreign key constraints. See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.
See also section <A HREF="manual.html#ANSI_diff_Foreign_Keys">1.8.5.5  Foreign Keys</A>.

</P>
<P>
You don't actually need foreign keys to join two tables.
For table types other than <CODE>InnoDB</CODE>,
the only things MySQL currently doesn't do are 1)
<CODE>CHECK</CODE> to make sure that the keys you use
really exist in the table or tables you're referencing and 2)
automatically delete rows from a table with a foreign key
definition. Using your keys to join tables will work just fine:

</P>

<PRE>
CREATE TABLE person (
    id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
    name CHAR(60) NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE shirt (
    id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
    style ENUM('t-shirt', 'polo', 'dress') NOT NULL,
    color ENUM('red', 'blue', 'orange', 'white', 'black') NOT NULL,
    owner SMALLINT UNSIGNED NOT NULL REFERENCES person(id),
    PRIMARY KEY (id)
);

INSERT INTO person VALUES (NULL, 'Antonio Paz');

INSERT INTO shirt VALUES
(NULL, 'polo', 'blue', LAST_INSERT_ID()),
(NULL, 'dress', 'white', LAST_INSERT_ID()),
(NULL, 't-shirt', 'blue', LAST_INSERT_ID());

INSERT INTO person VALUES (NULL, 'Lilliana Angelovska');

INSERT INTO shirt VALUES
(NULL, 'dress', 'orange', LAST_INSERT_ID()),
(NULL, 'polo', 'red', LAST_INSERT_ID()),
(NULL, 'dress', 'blue', LAST_INSERT_ID()),
(NULL, 't-shirt', 'white', LAST_INSERT_ID());

SELECT * FROM person;
+----+---------------------+
| id | name                |
+----+---------------------+
|  1 | Antonio Paz         |
|  2 | Lilliana Angelovska |
+----+---------------------+

SELECT * FROM shirt;
+----+---------+--------+-------+
| id | style   | color  | owner |
+----+---------+--------+-------+
|  1 | polo    | blue   |     1 |
|  2 | dress   | white  |     1 |
|  3 | t-shirt | blue   |     1 |
|  4 | dress   | orange |     2 |
|  5 | polo    | red    |     2 |
|  6 | dress   | blue   |     2 |
|  7 | t-shirt | white  |     2 |
+----+---------+--------+-------+

SELECT s.* FROM person p, shirt s
 WHERE p.name LIKE 'Lilliana%'
   AND s.owner = p.id
   AND s.color &#60;&#62; 'white';

+----+-------+--------+-------+
| id | style | color  | owner |
+----+-------+--------+-------+
|  4 | dress | orange |     2 |
|  5 | polo  | red    |     2 |
|  6 | dress | blue   |     2 |
+----+-------+--------+-------+
</PRE>



<H3><A NAME="Searching_on_two_keys" HREF="manual_toc.html#Searching_on_two_keys">3.6.7  Searching on Two Keys</A></H3>

<P>
<A NAME="IDX445"></A>
<A NAME="IDX446"></A>
<A NAME="IDX447"></A>

</P>
<P>
MySQL doesn't yet optimize when you search on two different
keys combined with <CODE>OR</CODE> (searching on one key with different <CODE>OR</CODE>
parts is optimized quite well):

</P>

<PRE>
SELECT field1_index, field2_index FROM test_table
WHERE field1_index = '1' OR  field2_index = '1'
</PRE>

<P>
The reason is that we haven't yet had time to come up with an efficient
way to handle this in the general case. (The <CODE>AND</CODE> handling is,
in comparison, now completely general and works very well.)

</P>
<P>
In MySQL 4.0 and up, you can solve this problem efficiently by using a
<CODE>UNION</CODE> that combines the output of two separate <CODE>SELECT</CODE>
statements.
See section <A HREF="manual.html#UNION">14.1.7.2  <CODE>UNION</CODE> Syntax</A>.
Each <CODE>SELECT</CODE> searches only one key and can be optimized:

</P>

<PRE>
SELECT field1_index, field2_index
    FROM test_table WHERE field1_index = '1'
UNION
SELECT field1_index, field2_index
    FROM test_table WHERE field2_index = '1';
</PRE>

<P>
Prior to MySQL 4.0, you can achieve the same effect by using a
<CODE>TEMPORARY</CODE> table and separate <CODE>SELECT</CODE> statements.
This type of optimization is also very good if
you are using very complicated queries where the SQL server does the
optimizations in the wrong order.

</P>

<PRE>
CREATE TEMPORARY TABLE tmp
SELECT field1_index, field2_index
    FROM test_table WHERE field1_index = '1';
INSERT INTO tmp
SELECT field1_index, field2_index
    FROM test_table WHERE field2_index = '1';
SELECT * from tmp;
DROP TABLE tmp;
</PRE>

<P>
This method of solving the problem is in effect a <CODE>UNION</CODE> of two queries.

</P>


<H3><A NAME="Calculating_days" HREF="manual_toc.html#Calculating_days">3.6.8  Calculating Visits Per Day</A></H3>

<P>
<A NAME="IDX448"></A>
<A NAME="IDX449"></A>
<A NAME="IDX450"></A>
<A NAME="IDX451"></A>

</P>
<P>
The following example shows how you can use the bit group functions
to calculate the number of days per month a user has visited a Web page.

</P>

<PRE>
CREATE TABLE t1 (year YEAR(4), month INT(2) UNSIGNED ZEROFILL,
             day INT(2) UNSIGNED ZEROFILL);
INSERT INTO t1 VALUES(2000,1,1),(2000,1,20),(2000,1,30),(2000,2,2),
            (2000,2,23),(2000,2,23);
</PRE>

<P>
The example table contains year-month-day values representing visits by users
to the page. To determine how many different days in each month these visits
occur, use this query:

</P>

<PRE>
SELECT year,month,BIT_COUNT(BIT_OR(1&#60;&#60;day)) AS days FROM t1
       GROUP BY year,month;
</PRE>

<P>
Which returns:

</P>

<PRE>
+------+-------+------+
| year | month | days |
+------+-------+------+
| 2000 |    01 |    3 |
| 2000 |    02 |    2 |
+------+-------+------+
</PRE>

<P>
The query calculates how many different days appear in the table for each
year/month combination, with automatic removal of duplicate entries.

</P>



<H3><A NAME="example-AUTO_INCREMENT" HREF="manual_toc.html#example-AUTO_INCREMENT">3.6.9  Using <CODE>AUTO_INCREMENT</CODE></A></H3>

<P>
<A NAME="IDX452"></A>
<A NAME="IDX453"></A>
<A NAME="IDX454"></A>
The <CODE>AUTO_INCREMENT</CODE> attribute can be used to generate a unique
identity for new rows:

</P>

<PRE>
CREATE TABLE animals (
             id MEDIUMINT NOT NULL AUTO_INCREMENT,
             name CHAR(30) NOT NULL,
             PRIMARY KEY (id)
             );
INSERT INTO animals (name) VALUES ('dog'),('cat'),('penguin'),
                                  ('lax'),('whale'),('ostrich');
SELECT * FROM animals;
</PRE>

<P>
Which returns:

</P>

<PRE>
+----+---------+
| id | name    |
+----+---------+
|  1 | dog     |
|  2 | cat     |
|  3 | penguin |
|  4 | lax     |
|  5 | whale   |
|  6 | ostrich |
+----+---------+
</PRE>

<P>
You can retrieve the most recent <CODE>AUTO_INCREMENT</CODE> value with the
<CODE>LAST_INSERT_ID()</CODE> SQL function or the <CODE>mysql_insert_id()</CODE> C API
function. These functions are connection-specific, so their return value
is not affected by another connection also doing inserts.

</P>
<P>
Note: For a multiple-row insert,
<CODE>LAST_INSERT_ID()</CODE>/<CODE>mysql_insert_id()</CODE> will actually return the
<CODE>AUTO_INCREMENT</CODE> key from the <STRONG>first</STRONG> of the inserted rows.
This allows multiple-row inserts to be reproduced correctly on other servers
in a replication setup.

</P>
<P>
For <CODE>MyISAM</CODE> and <CODE>BDB</CODE> tables you can specify <CODE>AUTO_INCREMENT</CODE>
on a secondary column in a multiple-column index.  In this case, the generated
value for the <CODE>AUTO_INCREMENT</CODE> column is calculated as
<CODE>MAX(auto_increment_column)+1 WHERE prefix=given-prefix</CODE>.  This is
useful when you want to put data into ordered groups.

</P>

<PRE>
CREATE TABLE animals (
             grp ENUM('fish','mammal','bird') NOT NULL,
             id MEDIUMINT NOT NULL AUTO_INCREMENT,
             name CHAR(30) NOT NULL,
             PRIMARY KEY (grp,id)
             );
INSERT INTO animals (grp,name) VALUES('mammal','dog'),('mammal','cat'),
                  ('bird','penguin'),('fish','lax'),('mammal','whale'),
                  ('bird','ostrich');
SELECT * FROM animals ORDER BY grp,id;
</PRE>

<P>
Which returns:

</P>

<PRE>
+--------+----+---------+
| grp    | id | name    |
+--------+----+---------+
| fish   |  1 | lax     |
| mammal |  1 | dog     |
| mammal |  2 | cat     |
| mammal |  3 | whale   |
| bird   |  1 | penguin |
| bird   |  2 | ostrich |
+--------+----+---------+
</PRE>

<P>
Note that in this case (when the <CODE>AUTO_INCREMENT</CODE> column is part of a
multiple-column index), <CODE>AUTO_INCREMENT</CODE> values will be reused if you
delete the row with the biggest <CODE>AUTO_INCREMENT</CODE> value in any group.
This happens even for <CODE>MyISAM</CODE> tables, for which <CODE>AUTO_INCREMENT</CODE>
values normally are not reused.)

</P>


<H2><A NAME="Twin" HREF="manual_toc.html#Twin">3.7  Queries from the Twin Project</A></H2>

<P>
<A NAME="IDX455"></A>
<A NAME="IDX456"></A>

</P>
<P>
At Analytikerna and Lentus, we have been doing the systems and field work
for a big research project. This project is a collaboration between the
Institute of Environmental Medicine at Karolinska Institutet Stockholm
and the Section on Clinical Research in Aging and Psychology at the
University of Southern California.

</P>
<P>
The project involves a screening part where all twins in Sweden older
than 65 years are interviewed by telephone. Twins who meet certain
criteria are passed on to the next stage. In this latter stage, twins who
want to participate are visited by a doctor/nurse team. Some of the
examinations include physical and neuropsychological examination,
laboratory testing, neuroimaging, psychological status assessment, and family
history collection. In addition, data are collected on medical and
environmental risk factors.

</P>
<P>
More information about Twin studies can be found at:
<a HREF="http://www.mep.ki.se/twinreg/index_en.html">http://www.mep.ki.se/twinreg/index_en.html</a>

</P>
<P>
The latter part of the project is administered with a Web interface
written using Perl and MySQL.

</P>
<P>
Each night all data from the interviews is moved into a MySQL
database.

</P>



<H3><A NAME="Twin_pool" HREF="manual_toc.html#Twin_pool">3.7.1  Find All Non-distributed Twins</A></H3>

<P>
The following query is used to determine who goes into the second part of the
project:

</P>

<PRE>
SELECT
    CONCAT(p1.id, p1.tvab) + 0 AS tvid,
    CONCAT(p1.christian_name, ' ', p1.surname) AS Name,
    p1.postal_code AS Code,
    p1.city AS City,
    pg.abrev AS Area,
    IF(td.participation = 'Aborted', 'A', ' ') AS A,
    p1.dead AS dead1,
    l.event AS event1,
    td.suspect AS tsuspect1,
    id.suspect AS isuspect1,
    td.severe AS tsevere1,
    id.severe AS isevere1,
    p2.dead AS dead2,
    l2.event AS event2,
    h2.nurse AS nurse2,
    h2.doctor AS doctor2,
    td2.suspect AS tsuspect2,
    id2.suspect AS isuspect2,
    td2.severe AS tsevere2,
    id2.severe AS isevere2,
    l.finish_date
FROM
    twin_project AS tp
    /* For Twin 1 */
    LEFT JOIN twin_data AS td ON tp.id = td.id
              AND tp.tvab = td.tvab
    LEFT JOIN informant_data AS id ON tp.id = id.id
              AND tp.tvab = id.tvab
    LEFT JOIN harmony AS h ON tp.id = h.id
              AND tp.tvab = h.tvab
    LEFT JOIN lentus AS l ON tp.id = l.id
              AND tp.tvab = l.tvab
    /* For Twin 2 */
    LEFT JOIN twin_data AS td2 ON p2.id = td2.id
              AND p2.tvab = td2.tvab
    LEFT JOIN informant_data AS id2 ON p2.id = id2.id
              AND p2.tvab = id2.tvab
    LEFT JOIN harmony AS h2 ON p2.id = h2.id
              AND p2.tvab = h2.tvab
    LEFT JOIN lentus AS l2 ON p2.id = l2.id
              AND p2.tvab = l2.tvab,
    person_data AS p1,
    person_data AS p2,
    postal_groups AS pg
WHERE
    /* p1 gets main twin and p2 gets his/her twin. */
    /* ptvab is a field inverted from tvab */
    p1.id = tp.id AND p1.tvab = tp.tvab AND
    p2.id = p1.id AND p2.ptvab = p1.tvab AND
    /* Just the sceening survey */
    tp.survey_no = 5 AND
    /* Skip if partner died before 65 but allow emigration (dead=9) */
    (p2.dead = 0 OR p2.dead = 9 OR
     (p2.dead = 1 AND
      (p2.death_date = 0 OR
       (((TO_DAYS(p2.death_date) - TO_DAYS(p2.birthday)) / 365)
        &#62;= 65))))
    AND
    (
    /* Twin is suspect */
    (td.future_contact = 'Yes' AND td.suspect = 2) OR
    /* Twin is suspect - Informant is Blessed */
    (td.future_contact = 'Yes' AND td.suspect = 1
                               AND id.suspect = 1) OR
    /* No twin - Informant is Blessed */
    (ISNULL(td.suspect) AND id.suspect = 1
                        AND id.future_contact = 'Yes') OR
    /* Twin broken off - Informant is Blessed */
    (td.participation = 'Aborted'
     AND id.suspect = 1 AND id.future_contact = 'Yes') OR
    /* Twin broken off - No inform - Have partner */
    (td.participation = 'Aborted' AND ISNULL(id.suspect)
                                  AND p2.dead = 0))
    AND
    l.event = 'Finished'
    /* Get at area code */
    AND SUBSTRING(p1.postal_code, 1, 2) = pg.code
    /* Not already distributed */
    AND (h.nurse IS NULL OR h.nurse=00 OR h.doctor=00)
    /* Has not refused or been aborted */
    AND NOT (h.status = 'Refused' OR h.status = 'Aborted'
    OR h.status = 'Died' OR h.status = 'Other')
ORDER BY
    tvid;
</PRE>

<P>
Some explanations:
<DL COMPACT>

<DT><CODE>CONCAT(p1.id, p1.tvab) + 0 AS tvid</CODE>
<DD>
We want to sort on the concatenated <CODE>id</CODE> and <CODE>tvab</CODE> in
numerical order. Adding <CODE>0</CODE> to the result causes MySQL to
treat the result as a number.
<DT>column <CODE>id</CODE>
<DD>
This identifies a pair of twins. It is a key in all tables.
<DT>column <CODE>tvab</CODE>
<DD>
This identifies a twin in a pair. It has a value of <CODE>1</CODE> or <CODE>2</CODE>.
<DT>column <CODE>ptvab</CODE>
<DD>
This is an inverse of <CODE>tvab</CODE>. When <CODE>tvab</CODE> is <CODE>1</CODE> this is
<CODE>2</CODE>, and vice versa. It exists to save typing and to make it easier for
MySQL to optimize the query.
</DL>

<P>
This query demonstrates, among other things, how to do lookups on a table
from the same table with a join (<CODE>p1</CODE> and <CODE>p2</CODE>). In the example,
this is used to check whether a twin's partner died before the age of 65. If
so, the row is not returned.

</P>
<P>
All of the above exist in all tables with twin-related information. We
have a key on both <CODE>id,tvab</CODE> (all tables), and <CODE>id,ptvab</CODE>
(<CODE>person_data</CODE>) to make queries faster.

</P>
<P>
On our production machine (A 200MHz UltraSPARC), this query returns
about 150-200 rows and takes less than one second.

</P>
<P>
The current number of records in the tables used in the query:
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Rows</STRONG>
</TD></TR>
<TR><TD><CODE>person_data</CODE> </TD><TD> 71074
</TD></TR>
<TR><TD><CODE>lentus</CODE> </TD><TD> 5291
</TD></TR>
<TR><TD><CODE>twin_project</CODE> </TD><TD> 5286
</TD></TR>
<TR><TD><CODE>twin_data</CODE> </TD><TD> 2012
</TD></TR>
<TR><TD><CODE>informant_data</CODE> </TD><TD> 663
</TD></TR>
<TR><TD><CODE>harmony</CODE> </TD><TD> 381
</TD></TR>
<TR><TD><CODE>postal_groups</CODE> </TD><TD> 100
</TD></TR>
</TABLE>

</P>



<H3><A NAME="Twin_event" HREF="manual_toc.html#Twin_event">3.7.2  Show a Table of Twin Pair Status</A></H3>

<P>
Each interview ends with a status code called <CODE>event</CODE>. The query
shown here is used to display a table over all twin pairs combined by
event. This indicates in how many pairs both twins are finished, in how many
pairs one twin is finished and the other refused, and so on.

</P>

<PRE>
SELECT
        t1.event,
        t2.event,
        COUNT(*)
FROM
        lentus AS t1,
        lentus AS t2,
        twin_project AS tp
WHERE
        /* We are looking at one pair at a time */
        t1.id = tp.id
        AND t1.tvab=tp.tvab
        AND t1.id = t2.id
        /* Just the sceening survey */
        AND tp.survey_no = 5
        /* This makes each pair only appear once */
        AND t1.tvab='1' AND t2.tvab='2'
GROUP BY
        t1.event, t2.event;

</PRE>



<H2><A NAME="Apache" HREF="manual_toc.html#Apache">3.8  Using MySQL with Apache</A></H2>

<P>
<A NAME="IDX457"></A>

</P>
<P>
There are programs that let you authenticate your users from a MySQL
database and also let you write your log files into a MySQL table.

</P>
<P>
You can change the Apache logging format to be easily readable by
MySQL by putting the following into the Apache configuration file:

</P>

<PRE>
LogFormat \
        "\"%h\",%{%Y%m%d%H%M%S}t,%&#62;s,\"%b\",\"%{Content-Type}o\",  \
        \"%U\",\"%{Referer}i\",\"%{User-Agent}i\""
</PRE>

<P>
To load a log file in that format into MySQL, you can use a statement
something like this:

</P>

<PRE>
LOAD DATA INFILE '/local/access_log' INTO TABLE tbl_name
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\'
</PRE>

<P>
The named table should be created to have columns that correspond to those
that the <CODE>LogFormat</CODE> line writes to the log file.

</P>



<H1><A NAME="Using_MySQL_Programs" HREF="manual_toc.html#Using_MySQL_Programs">4  Using MySQL Programs</A></H1>

<P>
This chapter provides a brief overview of the programs provided by MySQL AB
and discusses how to specify options when you run these programs.
Most programs have options that are specific to their own operation, but the
syntax for specifying options is similar for all of them. Later chapters
provide more detailed descriptions of individual programs, including which
options they recognize.

</P>



<H2><A NAME="Program_Overview" HREF="manual_toc.html#Program_Overview">4.1  Overview of MySQL Programs</A></H2>

<P>
MySQL AB provides several types of programs:

</P>
<DL COMPACT>

<DT>The MYSQL server and server startup scripts:
<DD>

<UL>
<LI>

<CODE>mysqld</CODE> is the MySQL server
<LI>

<CODE>mysqld_safe</CODE>, <CODE>mysql.server</CODE>, and <CODE>mysqld_multi</CODE> are server
startup scripts
<LI>

<CODE>mysql_install_db</CODE> initializes the data directory and the initial
databases
</UL>

<DT>Client programs that access the server:
<DD>

<UL>
<LI>

<CODE>mysql</CODE> is a command-line client for executing SQL statements interactively
or in batch mode
<LI>

<CODE>mysqlcc</CODE> (MySQL Control Center) is an interactive graphical tool for
executing SQL statements and administration
<LI>

<CODE>mysqladmin</CODE> is an administrative client
<LI>

<CODE>mysqlcheck</CODE> performs table maintenance operations
<LI>

<CODE>mysqldump</CODE> and <CODE>mysqlhotcopy</CODE> make database backups
<LI>

<CODE>mysqlimport</CODE> imports data files
<LI>

<CODE>mysqlshow</CODE> displays information about databases and tables
</UL>

<DT>Utility programs that operate independently of the server:
<DD>

<UL>
<LI>

<CODE>myisamchk</CODE> performs table maintenance operations
<LI>

<CODE>myisampack</CODE> produces compressed, read-only tables
<LI>

<CODE>mysqlbinlog</CODE> is a tool for processing binary log files
<LI>

<CODE>perror</CODE> displays error code meanings
</UL>

</DL>

<P>
More information on running the server can be found in
section <A HREF="manual.html#Database_Administration">14.5  Database Administration Statements</A>.
Client and utility programs are described in more detail in
section <A HREF="manual.html#Client-Side_Scripts">8  MySQL Client and Utility Programs</A>.

</P>
<P>
Most MySQL distribution formats include all of these programs, except for
those programs that are platform-specific. (For example, the server startup
scripts are not used on Windows.) The exception is that RPM distributions are
more specialized. There is one RPM for the server, another for the client
programs, and so forth. If you appear to be missing one or more programs,
see section <A HREF="manual.html#Installing">2  Installing MySQL</A> for information on distributions and what they contain.
It may be that you need to install something else.

</P>


<H2><A NAME="Invoking_Programs" HREF="manual_toc.html#Invoking_Programs">4.2  Invoking MySQL Programs</A></H2>

<P>
To invoke a MySQL program at the command line (that is, from your shell or
command prompt), enter the program name followed by any options or other
arguments needed to instruct the program what you want it to do. The following
commands show some sample program invocations. ``<CODE>shell&#62;</CODE>'' represents
the prompt for your command interpreter; it is not part of what you type.

</P>

<PRE>
shell&#62; mysql test
shell&#62; mysqladmin extended-status variables
shell&#62; mysqlshow --help
shell&#62; mysqldump --user=root personnel
</PRE>

<P>
Arguments that begin with a dash are option arguments. They typically specify
the type of connection a program should make to the server or affect its
operational mode. Options have a syntax that is described in
section <A HREF="manual.html#Program_Options">4.3  Specifying Program Options</A>.

</P>
<P>
Non-option arguments (arguments with no leading dash) provide additional
information to the program. For example, the <CODE>mysql</CODE> program interprets
the first non-option argument as a database name, so the command
<CODE>mysql test</CODE> indicates that you want to use the <CODE>test</CODE> database.

</P>
<P>
Later sections that describe individual programs indicate which options a
program understands and describe the meaning of any additional non-option
arguments.

</P>
<P>
Some options are common to a number of programs. The most common of these are
the <CODE>--host</CODE>, <CODE>--user</CODE>, and <CODE>--password</CODE> options that specify
connection parameters. They indicate the host where the MySQL server is
running, and the username and password of your MySQL account. All MySQL client
programs understand these options; they allow you to specify which server to
connect to and the account to use on that server.

</P>
<P>
<A NAME="IDX458"></A>
<A NAME="IDX459"></A>

</P>
<P>
Note that you may find it necessary to invoke MySQL programs using the
pathname to the <TT>`bin'</TT> directory in which they are installed. This is
likely to be the case if you get a ``program not found'' error whenever
you attempt to run a MySQL program from any directory other than the
<TT>`bin'</TT> directory.  To make it more convenient to use MySQL, you
can add the pathname of the <TT>`bin'</TT> directory to your <CODE>PATH</CODE>
environment variable setting. Then to run a program you need only type
its name, not its entire pathname.

</P>
<P>
Consult the documentation for your command interpreter for instructions on
setting your <CODE>PATH</CODE>; the syntax for setting environment variables is
interpreter-specific.

</P>



<H2><A NAME="Program_Options" HREF="manual_toc.html#Program_Options">4.3  Specifying Program Options</A></H2>

<P>
You can provide options for MySQL programs in several ways:

</P>

<UL>

<LI>

On the command line following the program name. This is most common for
options that apply to a specific invocation of the program.

<LI>

In an option file that the program reads when it starts. This is common for
options that you want the program to use each time it runs.

<LI>

In environment variables. These are useful for options that you want to apply
each time the program runs, although in practice option files are used more
commonly for this purpose.
(section <A HREF="manual.html#Multiple_Unix_servers">5.9.2  Running Multiple Servers on Unix</A> discusses one situation in which environment
variables can be very helpful. It describes a handy technique that uses such
variables to specify the TCP/IP port number and Unix socket file for both
the server and client programs.)

</UL>

<P>
MySQL programs determine which options are given by examining environment
variables first, then option files, then the command line.
If an option is specified multiple times, the last occurrence takes
precedence.
This means that environment variables have the lowest precedence and
command-line options the highest.

</P>
<P>
You can take advantage of the way that MySQL programs process options by
specifying the default values for a program's options in an option file. Then
you need not type them each time you run the program, but can override the
defaults if necessary by using command-line options.

</P>



<H3><A NAME="Command-line_options" HREF="manual_toc.html#Command-line_options">4.3.1  Using Options on the Command Line</A></H3>

<P>
Program options specified on the command line follow these rules:

</P>

<UL>

<LI>

Options are given after the command name.

<LI>

An option argument begins with one dash or two dashes, depending on whether
it has a short name or a long name. Many options have both forms.
For example, <CODE>-?</CODE> and <CODE>--help</CODE> are the short and long forms
of the option that instructs a MySQL program to display a help message.

<LI>

Option names are case sensitive.  <CODE>-v</CODE> and <CODE>-V</CODE> are both legal and
have different meanings. (They are the corresponding short forms of the
<CODE>--verbose</CODE> and <CODE>--version</CODE> options.)

<LI>

Some options take a value following the option name.
For example, <CODE>-h localhost</CODE> or <CODE>--host=localhost</CODE> indicate
the MySQL server host to a client program.  The option value
tells the program the name of the host where the MySQL server is running.

<LI>

For a long option that takes a value, separate the option name and the value by an <SAMP>`='</SAMP> sign.
For a short option that takes a value, the option value can immediately follow the option letter,
or there can be a space between.
(<CODE>-hlocalhost</CODE> and <CODE>-h localhost</CODE> are equivalent.)
An exception to this rule is the option for specifying your MySQL password.
This option can be given in long form as <CODE>--password=pass_val</CODE> or as
<CODE>--password</CODE>. In the latter case (with no password value given), the
program will prompt you for the password.
The password option also may be given in short form as <CODE>-ppass_val</CODE> or as
<CODE>-p</CODE>. However, for the short form, if the password value is given, it
must follow the option letter with <EM>no intervening space</EM>. The reason for
this is that if a space follows the option letter, the program has no way to
tell whether a following argument is supposed to be the password value or some
other kind of argument.  Consequently, the following two commands have two
completely different meanings:


<PRE>
shell&#62; mysql -ptest
shell&#62; mysql -p test
</PRE>

The first command instructs <CODE>mysql</CODE> to use a password value of
<CODE>test</CODE>, but specifies no default database.
The second instructs <CODE>mysql</CODE> to prompt for the password value
and to use <CODE>test</CODE> as the default database.

</UL>

<P>
MySQL 4.0 introduced some additional flexibility in the way you specify
options. These changes were made in MySQL 4.0.2. Some of them relate to the way
you specify options that have ``enabled'' and ``disabled'' states, and to the
use of options that might be present in one version of MySQL but not another.
Those capabilities are discussed in this section.
Another change pertains to the way you use options to set program variables.
section <A HREF="manual.html#Program_variables">4.3.4  Using Options to Set Program Variables</A> discusses that topic further.

</P>

<P>
Some options control behavior that can be turned on or off. For example,
the <CODE>mysql</CODE> client supports a <CODE>--column-names</CODE> option that
determines whether or not to display a row of column names at the beginning
of query results. By default, this option is enabled. However, you may
want to disable it in some instances, such as when sending the output
of <CODE>mysql</CODE> into another program that expects to see only data and
not an initial header line.

</P>
<P>
To disable column names, you can specify the option using any of these forms:

</P>

<PRE>
--disable-column-names
--skip-column-names
--column-names=0
</PRE>

<P>
The <CODE>--disable</CODE> and <CODE>--skip</CODE> prefixes and the <CODE>=0</CODE> suffix
all have the same effect: They turn the option off.

</P>
<P>
The ``enabled'' form of the option may be specified in any of these ways:

</P>

<PRE>
--column-names
--enable-column-names
--column-names=1
</PRE>

<P>
Another change to option processing introduced in MySQL 4.0 is that you
can use the <CODE>--loose</CODE> prefix for command-line options. If an option
is prefixed by <CODE>--loose</CODE>, the program will not exit with
an error if it does not recognize the option, but instead will issue
only a warning:

</P>

<PRE>
shell&#62; mysql --loose-no-such-option
mysql: WARNING: unknown option '--no-such-option'
</PRE>

<P>
The <CODE>--loose</CODE> prefix can be useful when you run programs from
multiple installations of MySQL on the same machine, at least if all the
versions are as recent as 4.0.2.  This prefix is particularly useful when you
list options in an option file.  An option that may not be recognized by all
versions of a program can be given using the <CODE>--loose</CODE>
prefix (or <CODE>loose</CODE> in an option file). Versions of the program that do
not recognize the option will issue a warning and ignore it. This
strategy requires that versions involved be 4.0.2 or later, because
earlier versions know nothing of the <CODE>--loose</CODE> convention.

</P>



<H3><A NAME="Option_files" HREF="manual_toc.html#Option_files">4.3.2  Using Option Files</A></H3>

<P>
<A NAME="IDX460"></A>
<A NAME="IDX461"></A>
<A NAME="IDX462"></A>
<A NAME="IDX463"></A>

</P>
<P>
MySQL programs can read startup options from option
files (also sometimes called configuration files).
Option files provide a convenient way to specify commonly used options so that
they need not be entered on the command line each time you run a program.
Option file capability is available from MySQL 3.22 on.

</P>
<P>
The following programs support option files:  <CODE>mysql</CODE>,
<CODE>mysqladmin</CODE>, <CODE>mysqld</CODE>, <CODE>mysqld_safe</CODE>, <CODE>mysql.server</CODE>,
<CODE>mysqldump</CODE>, <CODE>mysqlimport</CODE>, <CODE>mysqlshow</CODE>, <CODE>mysqlcheck</CODE>,
<CODE>mysqlhotcopy</CODE>,
<CODE>myisamchk</CODE>, and <CODE>myisampack</CODE>.

</P>
<P>
On Windows, MySQL programs read startup options from the following files:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Filename</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TD></TR>
<TR><TD><CODE>windows-dir\my.ini</CODE> </TD><TD> Global options
</TD></TR>
<TR><TD><CODE>C:\my.cnf</CODE> </TD><TD> Global options
</TD></TR>
</TABLE>

<P>
<CODE>windows-dir</CODE> represents the location of your Windows directory.
This is commonly <TT>`C:\Windows'</TT> or <TT>`C:\WinNT'</TT>. Check the value of the
<CODE>WINDIR</CODE> environment variable to see where this directory is located on
your system.

</P>
<P>
On Unix, MySQL programs read startup options from the following files:

</P>
<P>
<A NAME="IDX464"></A>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Filename</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TD></TR>
<TR><TD><CODE>/etc/my.cnf</CODE> </TD><TD> Global options
</TD></TR>
<TR><TD><CODE>DATADIR/my.cnf</CODE> </TD><TD> Server-specific options
</TD></TR>
<TR><TD><CODE>defaults-extra-file</CODE> </TD><TD> The file specified with <CODE>--defaults-extra-file=path</CODE>, if any
</TD></TR>
<TR><TD><CODE>~/.my.cnf</CODE> </TD><TD> User-specific options
</TD></TR>
</TABLE>

</P>
<P>
<CODE>DATADIR</CODE> represents the location of the MySQL data directory. Typically
this is <TT>`/usr/local/mysql/data'</TT> for a binary installation or
<TT>`/usr/local/var'</TT> for a source installation.  Note that this is the data
directory location that was specified at configuration time, not the
one specified with <CODE>--datadir</CODE> when <CODE>mysqld</CODE> starts.
Use of <CODE>--datadir</CODE> at runtime has no effect on where the server
looks for option files, because it looks for them before processing any
command-line arguments.

</P>
<P>
MySQL looks for option files in the order just listed and reads any that
exist. If an option file that you want to use does not exist, create it
with a plain text editor.
If multiple option files exist, an option specified in a file read later takes
precedence over the same option specified in a file read earlier.

</P>
<P>
Any long option that may be given on the command line when running a
MySQL program can be given in an option file as well.  To get the list
of available options for a program, run it with the <CODE>--help</CODE> option.

</P>
<P>
The syntax for
specifying options in an option file is similar to command-line syntax, except
that you omit the leading two dashes. For example, <CODE>--quick</CODE> or
<CODE>--host=localhost</CODE> on the command line should be specified as
<CODE>quick</CODE> or <CODE>host=localhost</CODE> in an option file.
To specify an option of the form <CODE>--loose-opt_name</CODE>
in an option file, write it as <CODE>loose-opt_name</CODE>.

</P>
<P>
Empty lines in option files are ignored. Non-empty lines can take any
of the following forms:

</P>
<DL COMPACT>

<DT><CODE>#comment</CODE>
<DD>
<DT><CODE>;comment</CODE>
<DD>
Comment lines start with <SAMP>`#'</SAMP> or <SAMP>`;'</SAMP>. As of MySQL 4.0.14, 
a <SAMP>`#'</SAMP>-comment can start in the middle of a line as well.

<DT><CODE>[group]</CODE>
<DD>
<CODE>group</CODE> is the name of the program or group for which you want to set
options.  After a group line, any <CODE>opt_name</CODE> or <CODE>set-variable</CODE> lines
apply to the named group until the end of the option file or another group
line is given.

<DT><CODE>opt_name</CODE>
<DD>
This is equivalent to <CODE>--opt_name</CODE> on the command line.

<DT><CODE>opt_name=value</CODE>
<DD>
This is equivalent to <CODE>--opt_name=value</CODE> on the command line.
In an option file, you can have spaces around the <SAMP>`='</SAMP> character,
something that is not true on the command line.
As of
MySQL 4.0.16, you can quote the value with double quotes or single quotes.
This is useful if the value contains a <SAMP>`#'</SAMP> comment character or whitespace.

<DT><CODE>set-variable = var_name=value</CODE>
<DD>
Set the program variable <CODE>var_name</CODE> to the given value.
This is equivalent to <CODE>--set-variable=var_name=value</CODE> on the
command line.
Spaces are allowed around the first <SAMP>`='</SAMP> character but not around
the second.
This syntax is deprecated as of MySQL 4.0.
See section <A HREF="manual.html#Program_variables">4.3.4  Using Options to Set Program Variables</A> for more information on setting program variables.
</DL>

<P>
Note that for options and values, all leading and trailing blanks are
automatically deleted.  You may use the escape sequences <SAMP>`\b'</SAMP>,
<SAMP>`\t'</SAMP>, <SAMP>`\n'</SAMP>, <SAMP>`\r'</SAMP>, <SAMP>`\\'</SAMP>, and <SAMP>`\s'</SAMP> in option values
to represent the backspace, tab, newline, carriage return, and space characters.

</P>
<P>
On Windows, if an option value represents a pathname, you should specify the
value using <SAMP>`/'</SAMP> rather than <SAMP>`\'</SAMP> as the pathname separator. If you
use <SAMP>`\'</SAMP>, you must double it as <SAMP>`\\'</SAMP>,
because <SAMP>`\'</SAMP> is the escape character in MySQL.

</P>
<P>
If an option group name is the same as a program name, options in the group
apply specifically to that program.

</P>
<P>
The <CODE>[client]</CODE> option group is read by all client programs
(but not by <CODE>mysqld</CODE>). This allows you to specify options that apply to
every client. For example, <CODE>[client]</CODE> is the perfect group to use
to specify the password that you use to connect to the server.  (But make
sure that the option file is readable and writable only by yourself, so that other
people cannot find out your password.) Be sure not
to put an option in the <CODE>[client]</CODE> group unless it is recognized by
<EM>all</EM> client programs.

</P>
<P>
As of MySQL 4.0.14, if you want to create option groups that should be
read only by one specific <CODE>mysqld</CODE> server release series, you can do this by
using groups with names of <CODE>[mysqld-4.0]</CODE>, <CODE>[mysqld-4.1]</CODE>, and so
forth. The following group indicates that the <CODE>--new</CODE> option should be
used only by MySQL servers with 4.0.x version numbers:

</P>

<PRE>
[mysqld-4.0]
new
</PRE>

<P>
Here is a typical global option file:

</P>

<PRE>
[client]
port=3306
socket=/tmp/mysql.sock

[mysqld]
port=3306
socket=/tmp/mysql.sock
key_buffer_size=16M
max_allowed_packet=1M

[mysqldump]
quick
</PRE>

<P>
Here is a typical user option file:

</P>

<PRE>
[client]
# The following password will be sent to all standard MySQL clients
password="my_password"

[mysql]
no-auto-rehash
set-variable = connect_timeout=2

[mysqlhotcopy]
interactive-timeout

</PRE>

<P>
<A NAME="IDX465"></A>
If you have a source distribution, you will find sample option
files named <TT>`my-xxxx.cnf'</TT> in the <TT>`support-files'</TT> directory.
If you have a binary distribution, look in the <TT>`support-files'</TT>
directory under your MySQL installation directory (typically <TT>`C:\mysql'</TT>
on Windows or <TT>`/usr/local/mysql'</TT> on Unix).  Currently
there are sample option files for small, medium, large, and very
large systems. To experiment with one of these files, copy it to
<TT>`C:\my.cnf'</TT> on Windows or to <TT>`.my.cnf'</TT> in your home directory on
Unix.

</P>
<P>
All MySQL programs that support option files handle the
following command-line options:

</P>
<DL COMPACT>

<DT><CODE>--no-defaults</CODE>
<DD>
Don't read any option files.

<DT><CODE>--print-defaults</CODE>
<DD>
Print the program name and all options that it will get from option files.

<DT><CODE>--defaults-file=path_name</CODE>
<DD>
Use only the given option file. <CODE>path_name</CODE> is the full pathname
to the file.

<DT><CODE>--defaults-extra-file=path_name</CODE>
<DD>
Read this option file after the global option file but before the user
option file. <CODE>path_name</CODE> is the full pathname to the file.

</DL>

<P>
Note that to work properly, each of these options must immediately
follow the command name on the command line, with the exception
that <CODE>--print-defaults</CODE> may be used immediately after
<CODE>--defaults-file</CODE> or <CODE>--defaults-extra-file</CODE>.

</P>

<P>
In shell scripts, you can use the <CODE>my_print_defaults</CODE> program to parse the
option files. The following example shows the output that
<CODE>my_print_defaults</CODE> might produce when asked to show the options found in
the <CODE>[client]</CODE> and <CODE>[mysql]</CODE> groups:

</P>

<PRE>

shell&#62; my_print_defaults client mysql
--port=3306
--socket=/tmp/mysql.sock
--no-auto-rehash
</PRE>

<P>
Note for developers:  Option file handling is implemented in the C client
library simply by
processing all matching options (that is, options in the appropriate group)
before any command-line arguments. This works nicely for programs that use
the last instance of an option that is specified multiple times. If you have
a C or C++ program that handles multiply specified options this way but doesn't
read option files, you need add only two lines to give it that capability.
Check the source code of any of the standard MySQL clients to see
how to do this.

</P>
<P>
Several other language interfaces to MySQL are based on the C client library,
and some of them provide a way to access option file contents. These include
Perl and Python. See the documentation for your preferred interface for
details.

</P>



<H3><A NAME="Environment_variable_options" HREF="manual_toc.html#Environment_variable_options">4.3.3  Using Environment Variables to Specify Options</A></H3>

<P>
<A NAME="IDX466"></A>

</P>
<P>
To specify an option using an environment variable, set the variable using the
syntax appropriate for your comment processor. For example, on Windows or
NetWare,
you can set the <CODE>USER</CODE> variable to specify your MySQL account name.
To do so, use this syntax:

</P>

<PRE>
SET USER=your_name
</PRE>

<P>
The syntax on Unix depends on your shell. Suppose that you want to specify the
TCP/IP port number using the <CODE>MYSQL_TCP_PORT</CODE> variable. The syntax for
Bourne shell and variants (<CODE>sh</CODE>, <CODE>bash</CODE>, <CODE>zsh</CODE>, etc.) is:

</P>

<PRE>
MYSQL_TCP_PORT=3306
</PRE>

<P>
For <CODE>csh</CODE> and <CODE>tcsh</CODE>, use this syntax:

</P>

<PRE>
setenv MYSQL_TCP_PORT 3306
</PRE>

<P>
The commands to set environment variables can be executed at your command
prompt to take effect immediately. These settings persist until you log out.
To have the settings take effect each time you log in,
place the appropriate command or commands in a startup file that your
command interpreter reads each time it starts. Typical startup files are
<TT>`AUTOEXEC.BAT'</TT> for Windows, <TT>`.bash_profile'</TT> for <CODE>bash</CODE>, or
<TT>`.tcshrc'</TT> for <CODE>tcsh</CODE>. Consult the documentation for your command
interpreter for specific details.

</P>
<P>
section <A HREF="manual.html#Environment_variables">E  Environment Variables</A> lists all environment variables that affect MySQL
program operation.

</P>



<H3><A NAME="Program_variables" HREF="manual_toc.html#Program_variables">4.3.4  Using Options to Set Program Variables</A></H3>

<P>
<A NAME="IDX467"></A>
<A NAME="IDX468"></A>

</P>

<P>
Many MySQL programs have internal variables that can be set at runtime.
As of MySQL 4.0.2, program
variables are set the same way as any other long option that takes a value.
For example, <CODE>mysql</CODE> has a <CODE>max_allowed_packet</CODE> variable that
controls the maximum size of its communication buffer.
To set the <CODE>max_allowed_packet</CODE> variable for <CODE>mysql</CODE> to a value of
64MB, use either of the following commands:

</P>

<PRE>
shell&#62; mysql --max_allowed_packet=6710740
shell&#62; mysql --max_allowed_packet=64M
</PRE>

<P>
The first command specifies the value in bytes. The second specifies the value
in megabytes. Variable values can have a suffix of <CODE>K</CODE>, <CODE>M</CODE>, or
<CODE>G</CODE> (either uppercase or lowercase) to indicate units of kilobytes,
megabytes, or gigabytes.

</P>
<P>
In an option file, the variable setting is given without the leading dashes:

</P>

<PRE>
[mysql]
max_allowed_packet=6710740
</PRE>

<P>
Or:

</P>

<PRE>
[mysql]
max_allowed_packet=64M
</PRE>

<P>
If you like, underscores in a variable name can be specified as dashes.

</P>
<P>
Prior to MySQL 4.0.2, program variable names are not recognized as option
names.
Instead, use the <CODE>--set-variable</CODE> option to assign a value to a variable:

</P>

<PRE>
shell&#62; mysql --set-variable=max_allowed_packet=6710740
shell&#62; mysql --set-variable=max_allowed_packet=64M
</PRE>

<P>
In an option file, omit the leading dashes:

</P>

<PRE>
[mysql]
set-variable = max_allowed_packet=6710740
</PRE>

<P>
Or:

</P>

<PRE>
[mysql]
set-variable = max_allowed_packet=64M
</PRE>

<P>
With <CODE>--set-variable</CODE>, underscores in variable names cannot be given as
dashes for versions of MySQL older than 4.0.2.

</P>
<P>
The <CODE>--set-variable</CODE> option is still recognized in MySQL 4.0.2 and up,
but is deprecated.

</P>
<P>
Some server variables can be set at runtime. For details, see
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A> and section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>



<H1><A NAME="MySQL_Database_Administration" HREF="manual_toc.html#MySQL_Database_Administration">5  Database Administration</A></H1>

<P>
This chapter covers topics that deal with administering a MySQL installation,
such as configuring the server, managing user accounts, and performing backups.

</P>



<H2><A NAME="Server-Side_Scripts" HREF="manual_toc.html#Server-Side_Scripts">5.1  The MySQL Server and Server Startup Scripts</A></H2>

<P>
The MySQL server, <CODE>mysqld</CODE>, is the main program that does most of the
work in a MySQL installation. The server is accompanied by several related
scripts that perform setup operations when you install MySQL or that are
helper programs to assist you in starting and stopping the server.

</P>
<P>
This section provides an overview of the server and related programs, and
information about server startup scripts. Information about configuring the
server itself is given in section <A HREF="manual.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A>.

</P>



<H3><A NAME="Server-Side_Overview" HREF="manual_toc.html#Server-Side_Overview">5.1.1  Overview of the Server-Side Scripts and Utilities</A></H3>

<P>
<A NAME="IDX469"></A>

</P>
<P>
All MySQL programs take many different options. However, every
MySQL program provides a <CODE>--help</CODE> option that you can use
to get a description of the program's options. For example, try
<CODE>mysqld --help</CODE>.

</P>
<P>
You can override default options for all standard programs by specifying
options on the command line or in an option file.
section <A HREF="manual.html#Program_Options">4.3  Specifying Program Options</A>.

</P>
<P>
The following list briefly describes the MySQL server and server-related
programs:

</P>
<DL COMPACT>

<DT><CODE>mysqld</CODE>
<DD>
<A NAME="IDX470"></A>
The SQL daemon (that is, the MySQL server). To use client programs, this
program must be running, because clients gain access to databases by
connecting to the server.
See section <A HREF="manual.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A>.

<DT><CODE>mysqld-max</CODE>
<DD>
<A NAME="IDX471"></A>
A version of the server that includes additional features.
See section <A HREF="manual.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A>.

<DT><CODE>mysqld_safe</CODE>
<DD>
<A NAME="IDX472"></A>
A server startup script.
<CODE>mysqld_safe</CODE> attempts to start <CODE>mysqld-max</CODE> if it exists, and
<CODE>mysqld</CODE> otherwise.
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.

<DT><CODE>mysql.server</CODE>
<DD>
<A NAME="IDX473"></A>
A server startup script.
This script is used on systems that use run directories containing scripts
that start system services for particular run levels. It invokes
<CODE>mysqld_safe</CODE> to start the MySQL server.
See section <A HREF="manual.html#mysql.server">5.1.4  The <CODE>mysql.server</CODE> Server Startup Script</A>.

<DT><CODE>mysqld_multi</CODE>
<DD>
<A NAME="IDX474"></A>
A server startup script that can start or stop multiple servers installed
on the system.
See section <A HREF="manual.html#mysqld_multi">5.1.5  The <CODE>mysqld_multi</CODE> Program for Managing Multiple MySQL Servers</A>.

<DT><CODE>mysql_install_db</CODE>
<DD>
<A NAME="IDX475"></A>
This script creates the MySQL grant tables with default privileges. It is
usually executed only once, when first installing MySQL on a system.

<DT><CODE>mysql_fix_privilege_tables</CODE>
<DD>
<A NAME="IDX476"></A>
This script is used after an upgrade install operation, to update the grant
tables with any changes that have been made in newer versions of MySQL.

</DL>

<P>
There are several other programs that also are run on the server host:

</P>

<DL COMPACT>

<DT><CODE>myisamchk</CODE>
<DD>
<A NAME="IDX477"></A>
A utility to describe, check, optimize, and repair <CODE>MyISAM</CODE> tables.
<CODE>myisamchk</CODE> is described in
section <A HREF="manual.html#Table_maintenance">5.6.2  Using <CODE>myisamchk</CODE> for Table Maintenance and Crash Recovery</A>.

<DT><CODE>make_binary_distribution</CODE>
<DD>
<A NAME="IDX478"></A>
This program makes a binary release of a compiled MySQL. This could be sent
by FTP to <TT>`/pub/mysql/Incoming'</TT> on <CODE>support.mysql.com</CODE> for the
convenience of other MySQL users.

<DT><CODE>mysqlbug</CODE>
<DD>
<A NAME="IDX479"></A>
The MySQL bug reporting script.  It can be used to
send a bug report to the MySQL list. (You can also visit
http://bugs.mysql.com/ to file a bug report online.)

</DL>



<H3><A NAME="mysqld-max" HREF="manual_toc.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A></H3>

<P>
<A NAME="IDX480"></A>

</P>
<P>
A MySQL-Max server is a version of the <CODE>mysqld</CODE> MySQL server that
has been built to include additional features.

</P>
<P>
The distribution to use depends on your platform:

</P>

<UL>
<LI>

For Windows, the MySQL binary distributions include both the standard server
(<CODE>mysqld.exe</CODE>) and the MySQL-Max server (<CODE>mysqld-max.exe</CODE>), so you
need not get a special distribution. Just use a regular Windows
distribution, available at
<a HREF="http://dev.mysql.com/downloads/mysql-4.0.html">http://dev.mysql.com/downloads/mysql-4.0.html</a>.
See section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>.

<LI>

For Linux, if you install MySQL using RPM distributions, use the regular
<CODE>MySQL-server</CODE> RPM first to install a standard server named
<CODE>mysqld</CODE>.  Then use the <CODE>MySQL-Max</CODE> RPM to install a server named
<CODE>mysqld-max</CODE>.  The <CODE>MySQL-Max</CODE> RPM presupposes that you have
already installed the regular server RPM.  See section <A HREF="manual.html#Linux-RPM">2.2.2  Installing MySQL on Linux</A> for more
information on the Linux RPM packages.

<LI>

All other MySQL-Max distributions contain a single server that is named
<CODE>mysqld</CODE> but that has the additional features included.

</UL>

<P>
You can find the MySQL-Max binaries on the MySQL AB Web site at
<a HREF="http://dev.mysql.com/downloads/mysql-4.0.html">http://dev.mysql.com/downloads/mysql-4.0.html</a>.

</P>
<P>
MySQL AB builds the MySQL-Max servers by using the following
<CODE>configure</CODE> options:

</P>
<DL COMPACT>

<DT><CODE>--with-server-suffix=-max</CODE>
<DD>
This option adds a <CODE>-max</CODE> suffix to the <CODE>mysqld</CODE> version string.

<DT><CODE>--with-innodb</CODE>
<DD>
This option enables support for the <CODE>InnoDB</CODE> storage engine.  MySQL-Max
servers always include <CODE>InnoDB</CODE> support, but this option actually is
used only for MySQL 3.23 because <CODE>InnoDB</CODE> is not included by default
until MySQL 4.  From MySQL 4 on, <CODE>InnoDB</CODE> is included by default in
binary distributions, so you do not need a MySQL-Max server to obtain
<CODE>InnoDB</CODE> support.

<DT><CODE>--with-bdb</CODE>
<DD>
This option enables support for the Berkeley DB (<CODE>BDB</CODE>) storage engine.

<DT><CODE>CFLAGS=-DUSE_SYMDIR</CODE>
<DD>
This define enables symbolic link support for Windows.

</DL>

<P>
MySQL-Max binary distributions are a convenience for those who wish to install
precompiled programs. If you build MySQL using a source distribution, you can
build your own Max-like server by enabling the same features at configuration
time that the MySQL-Max binary distributions are built with.

</P>
<P>
MySQL-Max servers include the BerkeleyDB (<CODE>BDB</CODE>) storage engine
whenever possible, but not all platforms support <CODE>BDB</CODE>.  The following
table shows which platforms allow MySQL-Max binaries to include <CODE>BDB</CODE>:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>System</STRONG> </TD><TD> <CODE>BDB</CODE> <STRONG>Support</STRONG>
</TD></TR>
<TR><TD>AIX 4.3 </TD><TD> N
</TD></TR>
<TR><TD>HP-UX 11.0 </TD><TD> N
</TD></TR>
<TR><TD>Linux-Alpha </TD><TD> N
</TD></TR>
<TR><TD>Linux-IA-64 </TD><TD> N
</TD></TR>
<TR><TD>Linux-Intel </TD><TD> Y
</TD></TR>
<TR><TD>Mac OS X </TD><TD> N
</TD></TR>
<TR><TD>NetWare </TD><TD> N
</TD></TR>
<TR><TD>SCO OSR5 </TD><TD> Y
</TD></TR>
<TR><TD>Solaris-Intel </TD><TD> N
</TD></TR>
<TR><TD>Solaris-SPARC </TD><TD> Y
</TD></TR>
<TR><TD>UnixWare </TD><TD> Y
</TD></TR>
<TR><TD>Windows/NT </TD><TD> Y
</TD></TR>
</TABLE>

<P>
To find out which storage engines your server supports, issue the following
statement:

</P>

<PRE>
mysql&#62; SHOW ENGINES;
</PRE>

<P>
Before MySQL 4.1.2, use the following statement instead and check the value
of the variable for the storage engine in which you are interested:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_%';
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| have_bdb         | NO       |
| have_crypt       | YES      |
| have_innodb      | YES      |
| have_isam        | NO       |
| have_raid        | NO       |
| have_symlink     | DISABLED |
| have_openssl     | NO       |
| have_query_cache | YES      |
+------------------+----------+
</PRE>

<P>
The values in the second column indicate the server's level of support for
each feature:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Value</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>YES</CODE> </TD><TD> The feature is supported and is active.
</TD></TR>
<TR><TD><CODE>NO</CODE> </TD><TD> The feature is not supported.
</TD></TR>
<TR><TD><CODE>DISABLED</CODE> </TD><TD> The feature is supported but has been disabled.
</TD></TR>
</TABLE>

<P>
A value of <CODE>NO</CODE> means that the server was compiled without support
for the feature, so it cannot be activated at runtime.

</P>
<P>
A value of <CODE>DISABLED</CODE> occurs either because the server was
started with an option that disables the feature, or because not
all options required to enable it were given. In the latter case, the
<CODE>hostname.err</CODE> error log file should contain a reason indicating why
the option is disabled.

</P>
<P>
One situation in which you might see <CODE>DISABLED</CODE> occurs with MySQL 3.23
when the <CODE>InnoDB</CODE> storage engine is compiled in. In MySQL 3.23, you
must supply at least the <CODE>innodb_data_file_path</CODE> option at runtime to
set up the <CODE>InnoDB</CODE> tablespace. Without this option, <CODE>InnoDB</CODE>
disables itself.
See section <A HREF="manual.html#InnoDB_in_MySQL_3.23">16.3  <CODE>InnoDB</CODE> in MySQL 3.23</A>.
You can specify configuration options for the <CODE>BDB</CODE> storage engine, too,
but <CODE>BDB</CODE> will not disable itself if you do not provide them.
See section <A HREF="manual.html#BDB_start">15.4.3  <CODE>BDB</CODE> Startup Options</A>.

</P>
<P>
You might also see <CODE>DISABLED</CODE> for the <CODE>InnoDB</CODE>, <CODE>BDB</CODE>, or
<CODE>ISAM</CODE> storage engines if the server was compiled to support them, but
was started with the <CODE>--skip-innodb</CODE>, <CODE>--skip-bdb</CODE>, or
<CODE>--skip-isam</CODE> options at runtime.

</P>
<P>
As of Version 3.23, all MySQL servers support <CODE>MyISAM</CODE> tables, because
<CODE>MyISAM</CODE> is the default storage engine.

</P>



<H3><A NAME="mysqld_safe" HREF="manual_toc.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A></H3>

<P>
<A NAME="IDX481"></A>
<A NAME="IDX482"></A>
<A NAME="IDX483"></A>
<A NAME="IDX484"></A>
<A NAME="IDX485"></A>

</P>
<P>
<CODE>mysqld_safe</CODE> is the recommended way to start a <CODE>mysqld</CODE>
server on Unix and NetWare.  <CODE>mysqld_safe</CODE> adds some safety features
such as restarting the server when an error occurs and logging runtime
information to an error log file. NetWare-specific behaviors are listed
later in this section.

</P>
<P>
<STRONG>Note:</STRONG>
Before MySQL 4.0, <CODE>mysqld_safe</CODE> is named <CODE>safe_mysqld</CODE>.
To preserve backward compatibility, MySQL binary distributions for
some time will include <CODE>safe_mysqld</CODE> as a symbolic link to
<CODE>mysqld_safe</CODE>.

</P>
<P>
By default, <CODE>mysqld_safe</CODE> tries to start an executable named
<CODE>mysqld-max</CODE> if it exists, or <CODE>mysqld</CODE> otherwise.
Be aware of the implications of this behavior:

</P>

<UL>

<LI>

On Linux, the <CODE>MySQL-Max</CODE> RPM relies on this <CODE>mysqld_safe</CODE>
behavior. The RPM installs an executable named <CODE>mysqld-max</CODE>, which
causes <CODE>mysqld_safe</CODE> to automatically use that executable from that
point on.

<LI>

If you install a MySQL-Max distribution that includes a server named
<CODE>mysqld-max</CODE>, then upgrade later to a non-Max version of MySQL,
<CODE>mysqld_safe</CODE> will still attempt to run the old <CODE>mysqld-max</CODE>
server.  If you perform such an upgrade, you should manually remove the old
<CODE>mysqld-max</CODE> server to ensure that <CODE>mysqld_safe</CODE> runs the new
<CODE>mysqld</CODE> server.

</UL>

<P>
To override the default behavior and specify explicitly which server you
want to run, specify a <CODE>--mysqld</CODE> or <CODE>--mysqld-version</CODE> option to
<CODE>mysqld_safe</CODE>..

</P>
<P>
Many of the options to <CODE>mysqld_safe</CODE> are the same as the options to
<CODE>mysqld</CODE>. See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
Note that all options specified to <CODE>mysqld_safe</CODE> on the command line are
passed to <CODE>mysqld</CODE>.  If you want to use any options that are specific
to <CODE>mysqld_safe</CODE> and that <CODE>mysqld</CODE> doesn't support, do not specify
them on the command line. Instead, list them in the <CODE>[mysqld_safe]</CODE> group
of an option file.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
<CODE>mysqld_safe</CODE> reads all options from the <CODE>[mysqld]</CODE>,
<CODE>[server]</CODE>, and <CODE>[mysqld_safe]</CODE> sections in option files.
(For backward compatibility, it also reads <CODE>[safe_mysqld]</CODE>
sections, although you should rename such sections to <CODE>[mysqld_safe]</CODE>
when you begin using MySQL 4.0 or later.)

</P>
<P>
<CODE>mysqld_safe</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--basedir=path</CODE>
<DD>
The path to the MySQL installation directory.

<DT><CODE>--core-file-size=size</CODE>
<DD>
The size of the core file <CODE>mysqld</CODE> should be able to create. The option
value is passed to <CODE>ulimit -c</CODE>.

<DT><CODE>--datadir=path</CODE>
<DD>
The path to the data directory.

<DT><CODE>--defaults-extra-file=path</CODE>
<DD>
The name of an option file to be read in addition to the usual option files.

<DT><CODE>--defaults-file=path</CODE>
<DD>
The name of an option file to be read instead of the usual option files.

<DT><CODE>--err-log=path</CODE>
<DD>
The old form of the <CODE>--log-error</CODE> option, to be used before MySQL 4.0.

<DT><CODE>--ledir=path</CODE>
<DD>
The path to the directory containing the <CODE>mysqld</CODE> program.
Use this option to explicitly indicate the location of the server.

<DT><CODE>--log-error=path</CODE>
<DD>
Write the error log to the given file. See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.

<DT><CODE>--mysqld=prog_name</CODE>
<DD>
The name of the server program (in the <CODE>ledir</CODE> directory) that you
want to start. This option is needed if you use the MySQL binary distribution
but have the data directory outside of the binary distribution.

<DT><CODE>--mysqld-version=suffix</CODE>
<DD>
This option is similar to the <CODE>--mysqld</CODE> option, but you specify only
the suffix for the server program name. The basename is assumed to be
<CODE>mysqld</CODE>.  For example, if you use <CODE>--mysqld-version=max</CODE>,
<CODE>mysqld_safe</CODE> will start the <CODE>mysqld-max</CODE> program in the
<CODE>ledir</CODE> directory.  If the argument to <CODE>--mysqld-version</CODE> is
empty, <CODE>mysqld_safe</CODE> uses <CODE>mysqld</CODE> in the <CODE>ledir</CODE> directory.

<DT><CODE>--nice=priority</CODE>
<DD>
Use the <CODE>nice</CODE> program to set the server's scheduling priority to the
given value.  This option was added in MySQL 4.0.14.

<DT><CODE>--no-defaults</CODE>
<DD>
Do not read any option files.

<DT><CODE>--open-files-limit=count</CODE>
<DD>
The number of files <CODE>mysqld</CODE> should be able to open. The option value
is passed to <CODE>ulimit -n</CODE>. Note that you need to start
<CODE>mysqld_safe</CODE> as <CODE>root</CODE> for this to work properly!

<DT><CODE>--pid-file=path</CODE>
<DD>
The path to the process ID file.

<DT><CODE>--port=port_num</CODE>
<DD>
The port number to use when listening for TCP/IP connections.

<DT><CODE>--socket=path</CODE>
<DD>
The Unix socket file to use for local connections.

<DT><CODE>--timezone=zone</CODE>
<DD>
Set the <CODE>TZ</CODE> time zone environment variable to the given option value.
Consult your operating system documentation for legal time zone
specification formats.

<DT><CODE>--user={user_name | user_id}</CODE>
<DD>
Run the <CODE>mysqld</CODE> server as the user having the name <CODE>user_name</CODE> or
the numeric user ID <CODE>user_id</CODE>.
(``User'' in this context refers to a system login account, not a MySQL user
listed in the grant tables.)

</DL>

<P>
The <CODE>mysqld_safe</CODE> script is written so that it normally can start a
server that was installed from either a source or a binary distribution of
MySQL, even though these types of distributions typically install the server
in slightly different locations.
(See section <A HREF="manual.html#Installation_layouts">2.1.5  Installation Layouts</A>.)
<CODE>mysqld_safe</CODE> expects one of the following conditions to be true:

</P>

<UL>
<LI>

The server and databases can be found relative to the directory from which
<CODE>mysqld_safe</CODE> is invoked.  For binary distributions, <CODE>mysqld_safe</CODE>
looks under its working directory for <TT>`bin'</TT> and <TT>`data'</TT>
directories.  For source distributions, it looks for <TT>`libexec'</TT> and
<TT>`var'</TT> directories.  This condition should be met if you execute
<CODE>mysqld_safe</CODE> from your MySQL installation directory (for example,
<TT>`/usr/local/mysql'</TT> for a binary distribution).

<LI>

If the server and databases cannot be found relative to the working
directory, <CODE>mysqld_safe</CODE> attempts to locate them by absolute pathnames.
Typical locations are <TT>`/usr/local/libexec'</TT> and <TT>`/usr/local/var'</TT>.
The actual locations are determined from the values configured into the
distribution at the time it was built.  They should be correct if MySQL
is installed in the location specified at configuration time.
</UL>

<P>
Because <CODE>mysqld_safe</CODE> will try to find the server and databases relative
to its own working directory, you can install a binary distribution of
MySQL anywhere, as long as you run <CODE>mysqld_safe</CODE> from the
MySQL installation directory:

</P>

<PRE>
shell&#62; cd mysql_installation_directory
shell&#62; bin/mysqld_safe &#38;
</PRE>

<P>
If <CODE>mysqld_safe</CODE> fails, even when invoked from the MySQL
installation directory, you can specify the <CODE>--ledir</CODE> and
<CODE>--datadir</CODE> options to indicate the directories in which the server and
databases are located on your system.

</P>
<P>
Normally, you should not edit the <CODE>mysqld_safe</CODE> script.  Instead,
configure <CODE>mysqld_safe</CODE> by using command-line options or options in the
<CODE>[mysqld_safe]</CODE> section of a <TT>`my.cnf'</TT> option file.  In rare cases,
it might be necessary to edit <CODE>mysqld_safe</CODE> to get it to start the server
properly. However, if you do this, your modified version of
<CODE>mysqld_safe</CODE> might be overwritten if you upgrade MySQL in the future, so
you should make a copy of your edited version that you can reinstall.

</P>
<P>
On NetWare, <CODE>mysqld_safe</CODE> is a NetWare Loadable Module (NLM) that is
ported from the original Unix shell script.  It does the following:

</P>

<OL>
<LI>

Runs a number of system and option checks.

<LI>

Runs a check on <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables.

<LI>

Provides a screen presence for the MySQL server.

<LI>

Starts <CODE>mysqld</CODE>, monitors it, and restarts it if it terminates in error.

<LI>

Sends error messages from <CODE>mysqld</CODE> to the <TT>`hostname.err'</TT> file in the
data directory.

<LI>

Sends <CODE>mysqld_safe</CODE> screen output to the <TT>`hostname.safe'</TT> file in the
data directory.

</OL>



<H3><A NAME="mysql.server" HREF="manual_toc.html#mysql.server">5.1.4  The <CODE>mysql.server</CODE> Server Startup Script</A></H3>

<P>
MySQL distributions on Unix include a script named <CODE>mysql.server</CODE>.
It can be used on systems such as Linux and Solaris that use System V-style
run directories to start and stop system services. It is also used by the Mac
OS X Startup Item for MySQL.

</P>
<P>
<CODE>mysql.server</CODE> can be found in the <TT>`support-files'</TT> directory under
your MySQL installation directory or in a MySQL source tree.

</P>
<P>
Note that if you use the Linux server RPM package
(<CODE>MySQL-server-VERSION.rpm</CODE>), the <CODE>mysql.server</CODE> script will
already have been installed in the <TT>`/etc/init.d'</TT> directory with the
name <TT>`mysql'</TT>. You need not install it manually. See
section <A HREF="manual.html#Linux-RPM">2.2.2  Installing MySQL on Linux</A> for more information on the Linux RPM packages.

</P>
<P>
If you install MySQL from a source distribution or using a binary distribution
format that does not install <CODE>mysql.server</CODE> automatically, you can
install it manually. Instructions are provided in section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.

</P>
<P>
<CODE>mysql.server</CODE> reads options from the <CODE>[mysql.server]</CODE> and
<CODE>[mysqld]</CODE> sections of option files.  (For backward compatibility,
it also reads <CODE>[mysql_server]</CODE> sections, although you should rename such
sections to <CODE>[mysql.server]</CODE> when you begin using MySQL 4.0 or later.)

</P>



<H3><A NAME="mysqld_multi" HREF="manual_toc.html#mysqld_multi">5.1.5  The <CODE>mysqld_multi</CODE> Program for Managing Multiple MySQL Servers</A></H3>

<P>
<A NAME="IDX486"></A>
<A NAME="IDX487"></A>
<A NAME="IDX488"></A>
<A NAME="IDX489"></A>

</P>
<P>
<CODE>mysqld_multi</CODE> is meant for managing several <CODE>mysqld</CODE>
processes that listen for connections on different Unix socket files and
TCP/IP ports.  It can start or stop servers, or report their current status.

</P>
<P>
The program searches for groups named <CODE>[mysqld#]</CODE> in <TT>`my.cnf'</TT> (or
in the file named by the <CODE>--config-file</CODE> option).  <CODE>#</CODE> can be any
positive integer.  This number is referred to in the following discussion as
the option group number, or GNR.  Group numbers distinguish option groups
from one another and are used as arguments to <CODE>mysqld_multi</CODE> to specify
which servers you want to start, stop, or obtain a status report for.
Options listed in these groups are the same that you would use in the
<CODE>[mysqld]</CODE> group used for starting <CODE>mysqld</CODE>.  (See, for example,
section <A HREF="manual.html#Automatic_start">2.4.2.2  Starting and Stopping MySQL Automatically</A>.) However, when using multiple servers it is necessary
that each one use its own value for options such as the Unix socket file and
TCP/IP port number. For more information on which options must be unique per
server in a multiple-server environment, see section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A>.

</P>
<P>
To invoke <CODE>mysqld_multi</CODE>, use the following syntax:

</P>

<PRE>
shell&#62; mysqld_multi [options] {start|stop|report} [GNR[,GNR]...]
</PRE>

<P>
<CODE>start</CODE>, <CODE>stop</CODE>, and <CODE>report</CODE> indicate which operation you
want to perform. You can perform the designated operation on a single server
or multiple servers, depending on the GNR list that follows the option name.
If there is no list, <CODE>mysqld_multi</CODE> performs the operation for all
servers in the option file.

</P>
<P>
Each GNR value represents an option group number or range of group numbers.
The value should be the number at the end of the group name in the
option file.  For example, the GNR for a group named <CODE>[mysqld17]</CODE>
is <CODE>17</CODE>.  To specify a range of numbers, separate the first and last
numbers by a dash.  The GNR value <CODE>10-13</CODE> represents groups
<CODE>[mysqld10]</CODE> through <CODE>[mysqld13]</CODE>.  Multiple groups or group
ranges can be specified on the command line, separated by commas.  There
must be no whitespace characters (spaces or tabs) in the GNR list; anything
after a whitespace character is ignored.

</P>
<P>
This command starts a single server using option group <CODE>[mysqld17]</CODE>:

</P>

<PRE>
shell&#62; mysqld_multi start 17
</PRE>

<P>
This command stops several servers, using option groups <CODE>[mysql8]</CODE>
and <CODE>[mysqld10]</CODE> through <CODE>[mysqld13]</CODE>:

</P>

<PRE>
shell&#62; mysqld_multi start 8,10-13
</PRE>

<P>
For an example of how you might set up an option file, use this command:

</P>

<PRE>
shell&#62; mysqld_multi --example
</PRE>

<P>
<CODE>mysqld_multi</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--config-file=name</CODE>
<DD>
<A NAME="IDX490"></A>
Specify the name of an alternative option file. This affects where
<CODE>mysqld_multi</CODE> looks for <CODE>[mysqld#]</CODE> option groups.  Without this
option, all options are read from the usual <TT>`my.cnf'</TT> file.  The option
does not affect where <CODE>mysqld_multi</CODE> reads its own options, which are
always taken from the <CODE>[mysqld_multi]</CODE> group in the usual <TT>`my.cnf'</TT>
file.

<DT><CODE>--example</CODE>
<DD>
<A NAME="IDX491"></A>
Display a sample option file.

<DT><CODE>--help</CODE>
<DD>
<A NAME="IDX492"></A>
Display a help message and exit.

<DT><CODE>--log=name</CODE>
<DD>
<A NAME="IDX493"></A>
Specify the name of the log file. If the file exists, log output is appended
to it.

<DT><CODE>--mysqladmin=prog_name</CODE>
<DD>
<A NAME="IDX494"></A>
The <CODE>mysqladmin</CODE> binary to be used to stop servers.

<DT><CODE>--mysqld=prog_name</CODE>
<DD>
<A NAME="IDX495"></A>
The <CODE>mysqld</CODE> binary to be used. Note that you can specify
<CODE>mysqld_safe</CODE> as the value for this option also. The options are passed
to <CODE>mysqld</CODE>. Just make sure that you have the directory where <CODE>mysqld</CODE> is
located in your <CODE>PATH</CODE>
environment variable setting or fix <CODE>mysqld_safe</CODE>.

<DT><CODE>--no-log</CODE>
<DD>
<A NAME="IDX496"></A>
Print log information to stdout rather than to the log file. By default,
output goes to the log file.

<DT><CODE>--password=password</CODE>
<DD>
<A NAME="IDX497"></A>
The password of the MySQL account to use when invoking <CODE>mysqladmin</CODE>.
Note that the password value is not optional for this option, unlike for other MySQL clients.

<DT><CODE>--tcp-ip</CODE>
<DD>
<A NAME="IDX498"></A>
Connect to each MySQL server via the TCP/IP port instead of the Unix socket
file.  (If a socket file is missing, the server might still be running,
but accessible only via the TCP/IP port.)  By default, connections are
made using the Unix socket file.  This option affects <CODE>stop</CODE> and
<CODE>report</CODE> operations.

<DT><CODE>--user=user_name</CODE>
<DD>
<A NAME="IDX499"></A>
The username of the MySQL account to use when invoking <CODE>mysqladmin</CODE>.

<DT><CODE>--version</CODE>
<DD>
<A NAME="IDX500"></A>
Display version information and exit.

</DL>

<P>
Some notes about <CODE>mysqld_multi</CODE>:

</P>

<UL>
<LI>

Make sure that the MySQL account used for stopping the <CODE>mysqld</CODE> servers
(with the <CODE>mysqladmin</CODE> program) has the same username and password for
each server. Also, make sure that the account has the <CODE>SHUTDOWN</CODE>
privilege. If the servers that you want to manage have many different
usernames or passwords for the administrative accounts, you might want to
create an account on each server that has the same username and password.
For example, you might set up a common <CODE>multi_admin</CODE> account by
executing the following commands for each server:


<PRE>
shell&#62; mysql -u root -S /tmp/mysql.sock -proot_password
mysql&#62; GRANT SHUTDOWN ON *.*
    -&#62; TO 'multi_admin'@'localhost' IDENTIFIED BY 'multipass';
</PRE>

See section <A HREF="manual.html#Privileges">5.4.2  How the Privilege System Works</A>.
You will have to do this for each <CODE>mysqld</CODE> server. Change the
connection parameters appropriately when connecting to each one.  Note that
the host part of the account name must allow you to connect as
<CODE>multi_admin</CODE> from the host where you want to run <CODE>mysqld_multi</CODE>.

<LI>

The
<CODE>--pid-file</CODE> option is very important if you are using <CODE>mysqld_safe</CODE>
to start <CODE>mysqld</CODE> (for example, <CODE>--mysqld=mysqld_safe</CODE>) Every
<CODE>mysqld</CODE> should have its own process ID file. The advantage of
using <CODE>mysqld_safe</CODE> instead of <CODE>mysqld</CODE> is
that <CODE>mysqld_safe</CODE> ``guards'' its <CODE>mysqld</CODE> process and will
restart it if the process terminates due to a signal
sent using <CODE>kill -9</CODE>, or for other reasons, such as a segmentation
fault. Please note that the
<CODE>mysqld_safe</CODE> script might require that you start it from a certain
place. This means that you might have to change location to a certain directory
before running <CODE>mysqld_multi</CODE>. If you have problems starting,
please see the <CODE>mysqld_safe</CODE> script. Check especially the lines:


<PRE>
----------------------------------------------------------------
MY_PWD=`pwd`
# Check if we are starting this relative (for the binary release)
if test -d $MY_PWD/data/mysql -a -f ./share/mysql/english/errmsg.sys -a \
 -x ./bin/mysqld
----------------------------------------------------------------
</PRE>

See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.
The test performed by these lines should be successful, or you might encounter
problems.

<LI>

The Unix socket file and the TCP/IP port must be different for every
<CODE>mysqld</CODE>.

<LI>

You might want to use the <CODE>--user</CODE> option for <CODE>mysqld</CODE>, but in order
to do this you need to run the <CODE>mysqld_multi</CODE> script as the Unix
<CODE>root</CODE> user. Having the option in the option file doesn't matter; you
will just get a warning, if you are not the superuser and the <CODE>mysqld</CODE>
processes are started under your own Unix account. <STRONG>Important</STRONG>: Make
sure that the data directory is fully accessible to the Unix account that
the specific <CODE>mysqld</CODE> process is started as. <EM>Do not</EM> use the
Unix root account for this, unless you <EM>know</EM> what you are doing.

<LI>

<STRONG>Most important</STRONG>: Before using <CODE>mysqld_multi</CODE> be sure that you
understand the meanings of the options that are passed to the <CODE>mysqld</CODE>
servers and <EM>why</EM> you would want to have separate <CODE>mysqld</CODE>
processes.  Beware of the dangers of using multiple <CODE>mysqld</CODE> servers
with the same data directory.  Use separate data directories, unless you
<EM>know</EM> what you are doing.  Starting multiple servers with the same
data directory <EM>will not</EM> give you extra performance in a threaded
system.
See section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A>.

</UL>

<P>
The following example shows how you might set up an option file for use with
<CODE>mysqld_multi</CODE>.  The first and fifth <CODE>[mysqld#]</CODE> group were
intentionally left out from the example to illustrate that you can have
``gaps'' in the option file. This gives you more flexibility.  The order in
which the <CODE>mysqld</CODE> programs are started or stopped depends on the order
in which they appear in the option file.

</P>

<PRE>
# This file should probably be in your home dir (~/.my.cnf)
# or /etc/my.cnf
# Version 2.1 by Jani Tolonen

[mysqld_multi]
mysqld     = /usr/local/bin/mysqld_safe
mysqladmin = /usr/local/bin/mysqladmin
user       = multi_admin
password   = multipass

[mysqld2]
socket     = /tmp/mysql.sock2
port       = 3307
pid-file   = /usr/local/mysql/var2/hostname.pid2
datadir    = /usr/local/mysql/var2
language   = /usr/local/share/mysql/english
user       = john

[mysqld3]
socket     = /tmp/mysql.sock3
port       = 3308
pid-file   = /usr/local/mysql/var3/hostname.pid3
datadir    = /usr/local/mysql/var3
language   = /usr/local/share/mysql/swedish
user       = monty

[mysqld4]
socket     = /tmp/mysql.sock4
port       = 3309
pid-file   = /usr/local/mysql/var4/hostname.pid4
datadir    = /usr/local/mysql/var4
language   = /usr/local/share/mysql/estonia
user       = tonu

[mysqld6]
socket     = /tmp/mysql.sock6
port       = 3311
pid-file   = /usr/local/mysql/var6/hostname.pid6
datadir    = /usr/local/mysql/var6
language   = /usr/local/share/mysql/japanese
user       = jani
</PRE>

<P>
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>



<H2><A NAME="Configuring_MySQL" HREF="manual_toc.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A></H2>

<P>
This section discusses MySQL server configuration topics:

</P>

<UL>
<LI>

Startup options that the server supports
<LI>

How to set the server SQL mode
<LI>

Server system variables
<LI>

Server status variables
</UL>



<H3><A NAME="Server_options" HREF="manual_toc.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A></H3>

<P>
<A NAME="IDX501"></A>
<A NAME="IDX502"></A>
<A NAME="IDX503"></A>

</P>
<P>
When you start the <CODE>mysqld</CODE> server, you can specify program options
using any of the methods described in section <A HREF="manual.html#Program_Options">4.3  Specifying Program Options</A>. The most
common methods are to provide options in an option file or on the command
line. However, in most cases it is desirable to make sure that the server uses
the same options each time it runs. The best way to ensure this is to
list them in an option file.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
<CODE>mysqld</CODE> reads options from the <CODE>[mysqld]</CODE> and <CODE>[server]</CODE>
groups.  <CODE>mysqld_safe</CODE> reads options from the <CODE>[mysqld]</CODE>,
<CODE>[server]</CODE>, <CODE>[mysqld_safe]</CODE>, and <CODE>[safe_mysqld]</CODE>
groups.  <CODE>mysql.server</CODE> reads options from the <CODE>[mysqld]</CODE>
and <CODE>[mysql.server]</CODE> groups.  An embedded MySQL server usually reads
options from the <CODE>[server]</CODE>, <CODE>[embedded]</CODE>, and <CODE>[xxxxx_SERVER]</CODE>
groups, where <CODE>xxxxx</CODE> is the name of the application into which the
server is embedded.

</P>
<P>
<CODE>mysqld</CODE> accepts many command-line options.
For a list, execute <CODE>mysqld --help</CODE>. Before MySQL 4.1.1, <CODE>--help</CODE>
prints the full help message. As of 4.1.1, it prints a brief message; to see
the full list, use <CODE>mysqld --verbose --help</CODE>.

</P>
<P>
The following list shows some of the most common server options.
Additional options are described elsewhere:

</P>

<UL>

<LI>

Options that affect security:
See section <A HREF="manual.html#Privileges_options">5.3.3  Startup Options for <CODE>mysqld</CODE> Concerning Security</A>.

<LI>

SSL-related options:
See section <A HREF="manual.html#SSL_options">5.5.7.5  SSL Command-Line Options</A>.

<LI>

Binary log control options:
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

<LI>

Replication-related options:
See section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>.

<LI>

Options specific to particular storage engines:
See section <A HREF="manual.html#MyISAM_start">15.1.1  <CODE>MyISAM</CODE> Startup Options</A>,
section <A HREF="manual.html#BDB_start">15.4.3  <CODE>BDB</CODE> Startup Options</A>,
section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.

</UL>

<P>
You can also set the value of a server system variable by using the variable
name as an option, as described later in this section.

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a short help message and exit.
Before MySQL 4.1.1, <CODE>--help</CODE> displays the full help message.
As of 4.1.1, it displays an abbreviated message only.  Use both the
<CODE>--verbose</CODE> and <CODE>--help</CODE> options to see the full message.

<DT><CODE>--ansi</CODE>
<DD>
Use standard SQL syntax instead of MySQL syntax.  See section <A HREF="manual.html#ANSI_mode">1.8.3  Running MySQL in ANSI Mode</A>.
For more precise control over the server SQL mode, use the <CODE>--sql-mode</CODE>
option instead.

<DT><CODE>--basedir=path, -b path</CODE>
<DD>
The path to the MySQL installation directory. All paths are usually resolved
relative to this.

<DT><CODE>--big-tables</CODE>
<DD>
Allow large result sets by saving all temporary sets on file.  This option
prevents most ``table full'' errors, but also slows down queries for which
in-memory tables would suffice.  Since Version 3.23.2, MySQL is able to
handle large result sets automatically by using memory for small temporary
tables and switching to disk tables where necessary.

<DT><CODE>--bind-address=IP</CODE>
<DD>
The IP address to bind to.

<DT><CODE>--console</CODE>
<DD>
Write the error log messages to stderr/stdout even if <CODE>--log-error</CODE>
is specified.  On Windows, <CODE>mysqld</CODE> will not close the console screen if
this option is used.

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--chroot=path</CODE>
<DD>
Put the <CODE>mysqld</CODE> server in a closed environment during startup by using the
<CODE>chroot()</CODE> system call. This is a recommended security measure as of
MySQL 4.0. (MySQL 3.23 is not able to provide a <CODE>chroot()</CODE> jail that is
100% closed.)  Note that use of this option somewhat limits <CODE>LOAD
DATA INFILE</CODE> and <CODE>SELECT ... INTO OUTFILE</CODE>.

<DT><CODE>--core-file</CODE>
<DD>
Write a core file if <CODE>mysqld</CODE> dies.  For some systems, you must also
specify the <CODE>--core-file-size</CODE> option to <CODE>mysqld_safe</CODE>.
See section <A HREF="manual.html#mysqld_safe">5.1.3  The <CODE>mysqld_safe</CODE> Server Startup Script</A>.
Note that on some systems, such as Solaris, you will
not get a core file if you are also using the <CODE>--user</CODE> option.

<DT><CODE>--datadir=path, -h path</CODE>
<DD>
The path to the data directory.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
If MySQL is configured with <CODE>--with-debug</CODE>, you can use this
option to get a trace file of what <CODE>mysqld</CODE> is doing.
The <CODE>debug_options</CODE> string often is <CODE>'d:t:o,file_name'</CODE>.
See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

<DT><CODE>--default-character-set=charset</CODE>
<DD>
Use <CODE>charset</CODE> as the default character set.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--default-collation=collation</CODE>
<DD>
Use <CODE>collation</CODE> as the default collation.
This option is available as of MySQL 4.1.1.
See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--default-storage-engine=type</CODE>
<DD>
This option is a synonym for <CODE>--default-table-type</CODE>.
It is available as of MySQL 4.1.2.

<DT><CODE>--default-table-type=type</CODE>
<DD>
Set the default table type for tables.  See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<DT><CODE>--delay-key-write[= OFF | ON | ALL]</CODE>
<DD>
How the <CODE>DELAYED KEYS</CODE> option should be used.
Delayed key writing causes key buffers not to be flushed between writes for
<CODE>MyISAM</CODE> tables.
<CODE>OFF</CODE> disables delayed key writes.
<CODE>ON</CODE> enables delayed key writes for those tables that were created with
the <CODE>DELAYED KEYS</CODE> option.
<CODE>ALL</CODE> delays key writes for all <CODE>MyISAM</CODE> tables.
Available as of MySQL 4.0.3.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>. See section <A HREF="manual.html#MyISAM_start">15.1.1  <CODE>MyISAM</CODE> Startup Options</A>.

<STRONG>Note:</STRONG> If you set this variable to ALL, you should not use
<CODE>MyISAM</CODE> tables from another program (such as from another MySQL server or
with <CODE>myisamchk</CODE>) when the table is in use. Doing so will lead to index
corruption.

<DT><CODE>--delay-key-write-for-all-tables</CODE>
<DD>
Old form of <CODE>--delay-key-write=ALL</CODE> for use prior to MySQL 4.0.3.
As of 4.0.3, use <CODE>--delay-key-write</CODE> instead.

<DT><CODE>--des-key-file=file_name</CODE>
<DD>
Read the default keys used by <CODE>DES_ENCRYPT()</CODE> and <CODE>DES_DECRYPT()</CODE>
from this file.

<DT><CODE>--enable-named-pipe</CODE>
<DD>
Enable support for named pipes.
This option applies only on Windows NT, 2000, and XP systems, and can be used
only with the <CODE>mysqld-nt</CODE> and <CODE>mysqld-max-nt</CODE> servers that support
named pipe connections.

<DT><CODE>--exit-info, -T</CODE>
<DD>
This is a bit mask of different flags you can use for debugging the
<CODE>mysqld</CODE> server. Do not use this option unless you know
exactly what it does!

<DT><CODE>--external-locking</CODE>
<DD>
Enable system locking.  Note that if you use this option on a system on
which <CODE>lockd</CODE> does not fully work (as on Linux), you will easily get
<CODE>mysqld</CODE> to deadlock.
This option previously was named <CODE>--enable-locking</CODE>.

<STRONG>Note:</STRONG> If you use this option to enable updates to <CODE>MyISAM</CODE>
tables from many MySQL processes, you have to ensure that these conditions are
satisfied:


<UL>
<LI>

You should not use the query cache for queries that use tables that are
updated by another process.
<LI>

You should not use <CODE>--delay-key-write=ALL</CODE> or <CODE>DELAY_KEY_WRITE=1</CODE>
on any shared tables.
</UL>

The easiest way to ensure this is to always use <CODE>--external-locking</CODE>
together with <CODE>--delay-key-write=OFF --query-cache-size=0</CODE>.

(This is not done by default because in many setups it's useful to have a
mixture of the above options.)

<DT><CODE>--flush</CODE>
<DD>
Flush all changes to disk after each SQL statement.  Normally MySQL
does a write of all changes to disk only after each SQL statement and lets
the operating system handle the synching to disk.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

<DT><CODE>--init-file=file</CODE>
<DD>
Read SQL statements from this file at startup.
Each statement must be on a single line and should not include comments.

<DT><CODE>--language=lang_name, -L lang_name</CODE>
<DD>
Client error messages in given language.  <CODE>lang_name</CODE> can be given as the
language name or as the full pathname to the directory where the language
files are installed.
See section <A HREF="manual.html#Languages">5.7.2  Setting the Error Message Language</A>.

<DT><CODE>--log[=file], -l [file]</CODE>
<DD>
Log connections and queries to this file. See section <A HREF="manual.html#Query_log">5.8.2  The General Query Log</A>. If you don't
specify a filename, MySQL will use <CODE>hostname.log</CODE> as the filename.

<DT><CODE>--log-bin=[file]</CODE>
<DD>
Log all queries that change data to this file. Used for backup and
replication.  See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.  If you don't specify a filename,
MySQL will use <CODE>hostname-bin</CODE> as the filename.

<DT><CODE>--log-bin-index[=file]</CODE>
<DD>
The index file for binary log file names. See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.
If you don't specify a filename, MySQL will use <CODE>hostname-bin.index</CODE> as
the filename.

<DT><CODE>--log-error[=file]</CODE>
<DD>
Log errors and startup messages to this file. See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.
If you don't specify a filename, MySQL will use <CODE>hostname.err</CODE> as the filename.

<DT><CODE>--log-isam[=file]</CODE>
<DD>
Log all <CODE>ISAM</CODE>/<CODE>MyISAM</CODE> changes to this file (used only when
debugging <CODE>ISAM</CODE>/<CODE>MyISAM</CODE>).

<DT><CODE>--log-long-format</CODE>
<DD>
Log some extra information to the log files (update log, binary update log,
and slow queries log, whatever log has been activated). For example, 
username and timestamp are logged for queries. If you are using 
<CODE>--log-slow-queries</CODE> and <CODE>--log-long-format</CODE>, then
queries that are not using indexes also are logged to the slow query log.
Note that <CODE>--log-long-format</CODE> is deprecated as of MySQL version
4.1, when <CODE>--log-short-format</CODE> was introduced (the long log format
is the default setting since version 4.1). Also note that starting with 
MySQL 4.1, the <CODE>--log-queries-not-using-indexes</CODE> option is available 
for the purpose of logging queries that do not use indexes to the slow 
queries log.

<DT><CODE>--log-queries-not-using-indexes</CODE>
<DD>
If you are using this option with <CODE>--log-slow-queries</CODE>, then
queries that are not using indexes also  are logged to the slow query log. This 
option is available as of MySQL 4.1. See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>--log-short-format</CODE>
<DD>
Log less information to the log files (update log, binary update log, 
and slow queries log, whatever log has been activated). For example, 
username and timestamp are not logged for queries. This options was 
introduced in MySQL 4.1.

<DT><CODE>--log-slow-queries[=file]</CODE>
<DD>
Log all queries that have taken more than <CODE>long_query_time</CODE> seconds 
to execute to file. Note that the default for the amount of information 
logged has changed in MySQL 4.1. See the <CODE>--log-long-format</CODE> and 
<CODE>--log-long-format</CODE> options for details. See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>--log-update[=file]</CODE>
<DD>
Log updates to <CODE>file.#</CODE> where <CODE>#</CODE> is a unique number if not
given. See section <A HREF="manual.html#Update_log">5.8.3  The Update Log</A>. The update log is deprecated and is
removed in MySQL 5.0.0; you should use the binary log instead
(<CODE>--log-bin</CODE>). See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>. Starting from version 5.0.0,
using <CODE>--log-update</CODE> will just turn on the binary log instead
(see section <A HREF="manual.html#News-5.0.0">C.1.2  Changes in release 5.0.0 (22 Dec 2003: Alpha)</A>).

<DT><CODE>--log-warnings, -W</CODE>
<DD>
Print out warnings such as <CODE>Aborted connection...</CODE> to the
<TT>`.err'</TT> file. Enabling this option is recommended, for example, if you
use replication (you will get more information about what is happening,
such as messages about network failures and reconnections).
This option is enabled by default as of MySQL 4.1.2; to disable it, use
<CODE>--skip-log-warnings</CODE>.
See section <A HREF="manual.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

This option was named <CODE>--warnings</CODE> before MySQL 4.0.

<DT><CODE>--low-priority-updates</CODE>
<DD>
Table-modifying operations (<CODE>INSERT</CODE>/<CODE>DELETE</CODE>/<CODE>UPDATE</CODE>)
will have lower priority than selects.  It can also be done via
<CODE>{INSERT | REPLACE | UPDATE | DELETE} LOW_PRIORITY ...</CODE> to lower
the priority of only one query, or by
<CODE>SET LOW_PRIORITY_UPDATES=1</CODE> to change the priority in one
thread.  See section <A HREF="manual.html#Table_locking">7.3.2  Table Locking Issues</A>.

<DT><CODE>--memlock</CODE>
<DD>
Lock the <CODE>mysqld</CODE> process in memory.  This works on systems such as
Solaris that support the <CODE>mlockall()</CODE> system call.  This
might help if you have a problem where the operating system is causing
<CODE>mysqld</CODE> to swap on disk.
Note that use of this option requires that you run the server as <CODE>root</CODE>,
which is normally not a good idea for security reasons.

<DT><CODE>--myisam-recover [=option[,option...]]]</CODE>
<DD>
Set the <CODE>MyISAM</CODE> storage engine recovery mode.
The option value is any combination of the values
of <CODE>DEFAULT</CODE>, <CODE>BACKUP</CODE>, <CODE>FORCE</CODE>, or <CODE>QUICK</CODE>.
If you specify multiple values, separate them by commas.
You can also use a value of <CODE>""</CODE> to disable this
option. If this option is used, <CODE>mysqld</CODE> will on open check if the
table is marked as crashed or if the table wasn't closed properly.
(The last option works only if you are running with
<CODE>--skip-external-locking</CODE>.)  If this is the case, <CODE>mysqld</CODE> will run
a check on the table. If the table was corrupted, <CODE>mysqld</CODE> will
attempt to repair it.

The following options affect how the repair works:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><CODE>DEFAULT</CODE> </TD><TD> The same as not giving any option to
                    <CODE>--myisam-recover</CODE>.

</TD></TR>
<TR><TD><CODE>BACKUP</CODE> </TD><TD> If the data file was changed during recovery, save a
                    backup of the <TT>`tbl_name.MYD'</TT> file as
                    <TT>`tbl_name-datetime.BAK'</TT>.

</TD></TR>
<TR><TD><CODE>FORCE</CODE> </TD><TD> Run recovery even if we will lose more than one row
                    from the <TT>`.MYD'</TT> file.

</TD></TR>
<TR><TD><CODE>QUICK</CODE> </TD><TD> Don't check the rows in the table if there aren't any
                    delete blocks.

</TD></TR>
</TABLE>

Before a table is automatically repaired, MySQL will add a note
about this in the error log.  If you want to be able to recover from most
problems without user intervention, you should use the options
<CODE>BACKUP,FORCE</CODE>.  This will force a repair of a table even if some rows
would be deleted, but it will keep the old data file as a backup so that
you can later examine what happened.

<DT><CODE>--new</CODE>
<DD>
From version 4.0.12, the <CODE>--new</CODE> option can be used to make the server
behave as 4.1 in certain respects, easing a 4.0 to 4.1 upgrade:

<UL>
<LI>

<CODE>TIMESTAMP</CODE> is returned as a string with the format
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE>.
See section <A HREF="manual.html#Column_types">12  Column Types</A>.
</UL>

This option can be used to help you see how your applications will behave in
MySQL 4.1, without actually upgrading to 4.1.

<DT><CODE>--pid-file=path</CODE>
<DD>
The path to the process ID file used by <CODE>mysqld_safe</CODE>.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The port number to use when listening for TCP/IP connections.

<DT><CODE>--old-protocol, -o</CODE>
<DD>
Use the 3.20 protocol for compatibility with some very old clients.
See section <A HREF="manual.html#Upgrading-from-3.20">2.5.6  Upgrading from Version 3.20 to 3.21</A>.

<DT><CODE>--one-thread</CODE>
<DD>
Only use one thread (for debugging under Linux).
This option is available only if the server is built with debugging enabled.
See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>.

<DT><CODE>--open-files-limit=</CODE>
<DD>
To change the number of file descriptors available to <CODE>mysqld</CODE>.
If this is not set or set to 0, then <CODE>mysqld</CODE> will use this value
to reserve file descriptors to use with <CODE>setrlimit()</CODE>.  If this
value is 0 then <CODE>mysqld</CODE> will reserve <CODE>max_connections*5</CODE> or
<CODE>max_connections + table_cache*2</CODE> (whichever is larger) number of
files.  You should try increasing this if <CODE>mysqld</CODE> gives you the
error 'Too many open files'.

<DT><CODE>--safe-mode</CODE>
<DD>
Skip some optimize stages.

<DT><CODE>--safe-show-database</CODE>
<DD>
With this option, the <CODE>SHOW DATABASES</CODE> statement displays the names
of only those databases for which the user has some kind of privilege.
As of MySQL 4.0.2, this option is deprecated and doesn't do anything
(it is enabled by default), because there is now a <CODE>SHOW DATABASES</CODE>
privilege that can be used to control access to database
names on a per-account basis. See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

<DT><CODE>--safe-user-create</CODE>
<DD>
If this is enabled, a user can't create new users with the <CODE>GRANT</CODE>
statement, if the user doesn't have <CODE>INSERT</CODE> privilege to the
<CODE>mysql.user</CODE> table or any column in this table.

<DT><CODE>--skip-bdb</CODE>
<DD>
Disable the <CODE>BDB</CODE> storage engine. This saves memory and might speed
up some operations.
Do not use this operation if you require <CODE>BDB</CODE> tables.

<DT><CODE>--skip-concurrent-insert</CODE>
<DD>
Turn off the ability to select and insert at the same time on <CODE>MyISAM</CODE>
tables. (This is to be used only if you think you have found a bug in this
feature.)

<DT><CODE>--skip-delay-key-write</CODE>
<DD>
Ignore the <CODE>DELAY_KEY_WRITE</CODE> option for all tables.
As of MySQL 4.0.3, you should use <CODE>--delay-key-write=OFF</CODE> instead.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

<DT><CODE>--skip-external-locking</CODE>
<DD>
Don't use system locking.  To use <CODE>isamchk</CODE> or <CODE>myisamchk</CODE>, you must
shut down the server.  See section <A HREF="manual.html#Stability">1.2.3  MySQL Stability</A>.  Note that in MySQL Version
3.23, you can use <CODE>CHECK TABLE</CODE> and <CODE>REPAIR TABLE</CODE> to check and
repair <CODE>MyISAM</CODE> tables.
This option previously was named <CODE>--skip-locking</CODE>.

<DT><CODE>--skip-grant-tables</CODE>
<DD>
This option causes the server not to use the privilege system at all.  This
gives everyone <STRONG>full access</STRONG> to all databases!  (You can tell a running
server to start using the grant tables again by executing a <CODE>mysqladmin
flush-privileges</CODE> or <CODE>mysqladmin reload</CODE> command, or by issuing a
<CODE>FLUSH PRIVILEGES</CODE> statement.)

<DT><CODE>--skip-host-cache</CODE>
<DD>
Do not use the internal hostname cache for faster name-IP resolution. Instead,
query the DNS server every time a client connects.  See section <A HREF="manual.html#DNS">7.5.5  How MySQL Uses DNS</A>.

<DT><CODE>--skip-innodb</CODE>
<DD>
Disable the <CODE>InnoDB</CODE> storage engine.  This saves memory and disk
space and might speed up some operations.
Do not use this operation if you require <CODE>InnoDB</CODE> tables.

<DT><CODE>--skip-isam</CODE>
<DD>
Disable the <CODE>ISAM</CODE> storage engine.  As of MySQL 4.1, <CODE>ISAM</CODE> is
disabled by default, so this option applies only if the server was configured
with support for <CODE>ISAM</CODE>.
This option was added in MySQL 4.1.1.

<DT><CODE>--skip-name-resolve</CODE>
<DD>
Do not resolve hostnames when checking client connections. Use only IP
numbers. If you use this option, all <CODE>Host</CODE> column values in the
grant tables must be IP numbers or <CODE>localhost</CODE>.  See section <A HREF="manual.html#DNS">7.5.5  How MySQL Uses DNS</A>.

<DT><CODE>--skip-networking</CODE>
<DD>
Don't listen for TCP/IP connections at all.  All interaction with
<CODE>mysqld</CODE> must be made via named pipes (on Windows) or Unix socket files
(on Unix).  This option is highly recommended for systems where only local
clients are allowed.  See section <A HREF="manual.html#DNS">7.5.5  How MySQL Uses DNS</A>.

<DT><CODE>--skip-new</CODE>
<DD>
Don't use new, possibly wrong routines.

<DT><CODE>--skip-symlink</CODE>
<DD>
This is the old form of <CODE>--skip-symbolic-links</CODE>, for use before MySQL
4.0.13.

<DT><CODE>--symbolic-links, --skip-symbolic-links</CODE>
<DD>
Enable or disable symbolic link support. This option has different effects on
Windows and Unix:


<UL>
<LI>

On Windows, enabling symbolic links allows you to establish a symbolic
link to a database directory by creating a
<CODE>directory.sym</CODE> file that contains the path to the real directory.
See section <A HREF="manual.html#Windows_symbolic_links">7.6.1.3  Using Symbolic Links for Databases on Windows</A>.

<LI>

On Unix, enabling symbolic links means that you can link a
<CODE>MyISAM</CODE> index file or data file to another directory with
the <CODE>INDEX DIRECTORY</CODE> or <CODE>DATA DIRECTORY</CODE> options of the
<CODE>CREATE TABLE</CODE> statement.  If you delete or rename the table,
the files that its symbolic links point to also are deleted or
renamed. See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.
</UL>

This option was added in MySQL 4.0.13.

<DT><CODE>--skip-safemalloc</CODE>
<DD>
If MySQL is configured with <CODE>--with-debug=full</CODE>, all MySQL programs
check for memory overruns during each memory allocation and memory
freeing operation.  This checking is very slow, so for the server you
can avoid it when you don't need it by using the <CODE>--skip-safemalloc</CODE>
option.

<DT><CODE>--skip-show-database</CODE>
<DD>
With this option, the <CODE>SHOW DATABASES</CODE> statement is allowed only to
users who have the <CODE>SHOW DATABASES</CODE> privilege, and the statement
displays all database names.  Without this option, <CODE>SHOW DATABASES</CODE> is
allowed to all users, but displays each database name only if the user has
some privilege for the database or has the <CODE>SHOW DATABASES</CODE> privilege.

<DT><CODE>--skip-stack-trace</CODE>
<DD>
Don't write stack traces.  This option is useful when you are running
<CODE>mysqld</CODE> under a debugger. On some systems, you also must use
this option to get a core file. See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>.

<DT><CODE>--skip-thread-priority</CODE>
<DD>
Disable using thread priorities for faster response time.

<DT><CODE>--socket=path</CODE>
<DD>
On Unix, this option specifies the Unix socket file to
use for local connections. The default value is <TT>`/tmp/mysql.sock'</TT>.
On Windows, the option specifies the pipe name to use for local connections
that use a named pipe. The default value is <CODE>MySQL</CODE>.

<DT><CODE>--sql-mode=value[,value[,value...]]</CODE>
<DD>
Set the SQL mode for MySQL. See section <A HREF="manual.html#SQL_mode">1.8.2  Selecting SQL Modes</A>. This option was added in 3.23.41.

<DT><CODE>--temp-pool</CODE>
<DD>
This option causes most temporary files created by the
server to use a small set of names, rather than a unique name for
each new file. This works around a problem in the Linux kernel
dealing with creating many
new files with different names. With the old behavior, Linux seems to
``leak'' memory, because it's being allocated to the directory entry cache
rather than to the disk cache.

<DT><CODE>--transaction-isolation=level</CODE>
<DD>
Sets the default transaction isolation level, which can be
<CODE>READ-UNCOMMITTED</CODE>,
<CODE>READ-COMMITTED</CODE>,
<CODE>REPEATABLE-READ</CODE>, or
<CODE>SERIALIZABLE</CODE>.
See section <A HREF="manual.html#SET_TRANSACTION">14.4.6  <CODE>SET TRANSACTION</CODE> Syntax</A>.

<DT><CODE>--tmpdir=path, -t path</CODE>
<DD>
The path of the directory to use for creating temporary files. It might be
useful if your default <CODE>/tmp</CODE> directory resides on a partition that
is too small to hold temporary tables.  Starting from MySQL 4.1, this
option accepts several paths that are used in round-robin fashion. Paths
should be separated by colon characters (<SAMP>`:'</SAMP>) on Unix and semicolon
characters (<SAMP>`;'</SAMP>) on Windows, NetWare, and OS/2.
If the MySQL server is acting as a replication slave, you should not set
<CODE>--tmpdir</CODE> to point to a directory on a memory-based filesystem or to a
directory that is cleared when the server host restarts.  A replication
slave needs some of its temporary files to survive a machine restart so that
it can replicate temporary tables or <CODE>LOAD DATA INFILE</CODE> operations. If
files in the temporary file directory are lost when the server restarts,
replication will fail.

<DT><CODE>--user={user_name | user_id}, -u {user_name | user_id}</CODE>
<DD>
Run the <CODE>mysqld</CODE> server as the user having the name <CODE>user_name</CODE> or
the numeric user ID <CODE>user_id</CODE>.
(``User'' in this context refers to a system login account, not a MySQL user
listed in the grant tables.)

This option is <STRONG>mandatory</STRONG> when starting <CODE>mysqld</CODE> as <CODE>root</CODE>.
The server will change its user ID during its startup sequence, causing it
to run as that particular user rather than as <CODE>root</CODE>.
See section <A HREF="manual.html#Security_guidelines">5.3.1  General Security Guidelines</A>.

Starting from MySQL 3.23.56 and 4.0.12:
To avoid a possible security hole where a user adds a <CODE>--user=root</CODE>
option to some <TT>`my.cnf'</TT> file (thus causing the server to run as
<CODE>root</CODE>), <CODE>mysqld</CODE> uses only the first
<CODE>--user</CODE> option specified and produces a warning if there are multiple
<CODE>--user</CODE> options. Options in <TT>`/etc/my.cnf'</TT> and
<TT>`datadir/my.cnf'</TT> are processed before
command-line options, so it is recommended that you
put a <CODE>--user</CODE> option in <TT>`/etc/my.cnf'</TT> and specify a value other than
<CODE>root</CODE>. The option in <TT>`/etc/my.cnf'</TT> will be found before any other
<CODE>--user</CODE> options, which ensures that the server runs as a user other
than <CODE>root</CODE>, and that a warning results if any other <CODE>--user</CODE> option
is found.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.
</DL>

<P>
You can assign a value to a server system variable by using an option of
the form <CODE>--var_name=value</CODE>. For example, <CODE>--key_buffer_size=32M</CODE>
sets the <CODE>key_buffer_size</CODE> variable to a value of 32MB.

</P>
<P>
Note that when setting a variable to a value, MySQL might automatically
correct it to stay within a given range, or adjust the value to the
closest allowable value if only certain values are allowed.

</P>
<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
You can find a full description for all variables in section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.  The section on tuning server parameters includes information
on how to optimize them.  See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
You can change the values of most system variables for a running server with the
<CODE>SET</CODE> statement. See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
If you want to restrict the maximum value that a startup option can be set to
with <CODE>SET</CODE>, you can define this by using the
<CODE>--maximum-var_name</CODE> command-line option.

</P>



<H3><A NAME="Server_SQL_mode" HREF="manual_toc.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A></H3>

<P>
The MySQL server can operate in different SQL modes, and (as of MySQL 4.1)
can apply these
modes differentially for different clients. This allows applications to
tailor server operation to their own requirements.

</P>
<P>
Modes define what SQL syntax MySQL should support and what kind of data
validation checks it should perform.  This makes it easier
to use MySQL in different environments and to use MySQL together
with other database servers.

</P>
<P>
You can set the default SQL mode by starting <CODE>mysqld</CODE> with the
<CODE>--sql-mode="modes"</CODE> option. Beginning with MySQL 4.1, you can also
change the mode after startup time by setting the <CODE>sql_mode</CODE> variable
with a <CODE>SET [SESSION|GLOBAL] sql_mode='modes'</CODE> statement.
Setting the <CODE>GLOBAL</CODE> variable affects the operation of all clients that
connect from that time on. Setting the <CODE>SESSION</CODE> variable affects only
the current client.
<CODE>modes</CODE> is a list of different modes separated by comma (<SAMP>`,'</SAMP>)
characters.
You can retrieve the current mode by issuing a <CODE>SELECT @@sql_mode</CODE>
statement. The default value is empty (no modes set).

</P>
<P>
The value also can be empty
(<CODE>--sql-mode=""</CODE>) if you want to reset it.

</P>
<P>
The following list describes the supported modes:

</P>
<DL COMPACT>

<DT><CODE>ANSI_QUOTES</CODE>
<DD>
Treat <SAMP>`"'</SAMP> as an identifier quote character (like the MySQL Server
<SAMP>``'</SAMP> quote character) and not as a string quote character. You can still
use <SAMP>``'</SAMP> to quote identifers in ANSI mode. With <CODE>ANSI_QUOTES</CODE>
enabled, you cannot use double quotes to quote a literal string, because it
will be interpreted as an identifier.
(New in MySQL 4.0.0.)

<DT><CODE>IGNORE_SPACE</CODE>
<DD>
Allow spaces between a function name and the <SAMP>`('</SAMP> character.  This forces
all function names to be treated as reserved words. As a result, if you want
to access any database, table, or column name that is a reserved word, you
must quote it.  For example, because there is a <CODE>USER()</CODE> function, the
name of the <CODE>user</CODE> table in the <CODE>mysql</CODE> database and the <CODE>User</CODE>
column in that table become reserved, so you must quote them:


<PRE>
SELECT "User" FROM mysql."user";
</PRE>

(New in MySQL 4.0.0.)

<DT><CODE>NO_AUTO_VALUE_ON_ZERO</CODE>
<DD>
<CODE>NO_AUTO_VALUE_ON_ZERO</CODE> affects handling of <CODE>AUTO_INCREMENT</CODE>
columns. Normally, you generate the next sequence number for the column by
inserting either <CODE>NULL</CODE> or <CODE>0</CODE> into it.
<CODE>NO_AUTO_VALUE_ON_ZERO</CODE> suppresses this behavior for <CODE>0</CODE> so that
only <CODE>NULL</CODE> generates the next sequence number. This mode can be useful
if <CODE>0</CODE> has been stored in a table's <CODE>AUTO_INCREMENT</CODE> column. (This
is not a recommended practice, by the way.)  For example, if you dump the
table with <CODE>mysqldump</CODE> and then reload it, normally MySQL generates
new sequence numbers when it encounters the <CODE>0</CODE> values, resulting in a
table with different contents than the one that was dumped. Enabling
<CODE>NO_AUTO_VALUE_ON_ZERO</CODE> before reloading the dump file solves this
problem. (As of MySQL 4.1.1, <CODE>mysqldump</CODE> automatically includes
statements in the dump output to enable <CODE>NO_AUTO_VALUE_ON_ZERO</CODE>.) (New
in MySQL 4.1.1.)

<DT><CODE>NO_DIR_IN_CREATE</CODE>
<DD>
When creating a table, ignore all <CODE>INDEX DIRECTORY</CODE> and <CODE>DATA
DIRECTORY</CODE> directives. This option is useful on slave replication servers.
(New in MySQL 4.0.15.)

<DT><CODE>NO_FIELD_OPTIONS</CODE>
<DD>
Don't print MySQL field-specific options in the output of <CODE>SHOW CREATE
TABLE</CODE>. This mode is used by <CODE>mysqldump</CODE> in portability mode.
(New in MySQL 4.1.1.)

<DT><CODE>NO_KEY_OPTIONS</CODE>
<DD>
Don't print MySQL index-specific options in the output of <CODE>SHOW CREATE
TABLE</CODE>. This mode is used by <CODE>mysqldump</CODE> in portability mode.
(New in MySQL 4.1.1.)

<DT><CODE>NO_TABLE_OPTIONS</CODE>
<DD>
Don't print MySQL table-specific options (such as <CODE>ENGINE</CODE>) in the
output of <CODE>SHOW CREATE TABLE</CODE>. This mode is used by <CODE>mysqldump</CODE> in
portability mode.
(New in MySQL 4.1.1.)

<DT><CODE>NO_UNSIGNED_SUBTRACTION</CODE>
<DD>
In subtraction operations, don't mark the result as <CODE>UNSIGNED</CODE> if one
of the operands is unsigned. Note that this makes <CODE>UNSIGNED BIGINT</CODE> not
100% usable in all contexts. See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.
(New in MySQL 4.0.2.)

<DT><CODE>ONLY_FULL_GROUP_BY</CODE>
<DD>
Don't allow queries that in the <CODE>GROUP BY</CODE> part refer to a not
selected column.
(New in MySQL 4.0.0.)

<DT><CODE>PIPES_AS_CONCAT</CODE>
<DD>
Treat <CODE>||</CODE> as a string concatenation operator (same as <CODE>CONCAT()</CODE>)
rather than as a synonym for <CODE>OR</CODE>.
(New in MySQL 4.0.0.)

<DT><CODE>REAL_AS_FLOAT</CODE>
<DD>
Treat <CODE>REAL</CODE> as a synonym for <CODE>FLOAT</CODE> rather than as a synonym for
<CODE>DOUBLE</CODE>.
(New in MySQL 4.0.0.)

</DL>

<P>
The following special modes are provided as shorthand for combinations of
mode values from the preceding list.
They are available as of MySQL 4.1.1.

</P>
<DL COMPACT>

<DT><CODE>ANSI</CODE>
<DD>
Equivalent to
<CODE>REAL_AS_FLOAT</CODE>, <CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>ONLY_FULL_GROUP_BY</CODE>. See section <A HREF="manual.html#ANSI_mode">1.8.3  Running MySQL in ANSI Mode</A>.

<DT><CODE>DB2</CODE>
<DD>
Equivalent to
<CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>NO_KEY_OPTIONS</CODE>, <CODE>NO_TABLE_OPTIONS</CODE>, <CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>MAXDB</CODE>
<DD>
Equivalent to
<CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>NO_KEY_OPTIONS</CODE>, <CODE>NO_TABLE_OPTIONS</CODE>, <CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>MSSQL</CODE>
<DD>
Equivalent to
<CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>NO_KEY_OPTIONS</CODE>, <CODE>NO_TABLE_OPTIONS</CODE>, <CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>MYSQL323</CODE>
<DD>
Equivalent to
<CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>MYSQL40</CODE>
<DD>
Equivalent to
<CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>ORACLE</CODE>
<DD>
Equivalent to
<CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>NO_KEY_OPTIONS</CODE>, <CODE>NO_TABLE_OPTIONS</CODE>, <CODE>NO_FIELD_OPTIONS</CODE>.

<DT><CODE>POSTGRESQL</CODE>
<DD>
Equivalent to
<CODE>PIPES_AS_CONCAT</CODE>, <CODE>ANSI_QUOTES</CODE>, <CODE>IGNORE_SPACE</CODE>, <CODE>NO_KEY_OPTIONS</CODE>, <CODE>NO_TABLE_OPTIONS</CODE>, <CODE>NO_FIELD_OPTIONS</CODE>.

</DL>



<H3><A NAME="Server_system_variables" HREF="manual_toc.html#Server_system_variables">5.2.3  Server System Variables</A></H3>

<P>
<A NAME="IDX504"></A>
<A NAME="IDX505"></A>
<A NAME="IDX506"></A>
<A NAME="IDX507"></A>

</P>

<P>
The server maintains many system variables that indicate how it is configured.
All of them have default values. They can be set at server startup
using options on the command line or in option
files. Most of them can be set at runtime using the
<CODE>SET</CODE> statement.

</P>

<P>
Beginning with MySQL 4.0.3,
the <CODE>mysqld</CODE> server maintains two kinds of variables.
Global variables affect the overall operation of the server.
Session variables affect its operation for individual client connections.

</P>
<P>
When the server starts, it initializes all global variables to their default
values. These defaults can be changed by options specified in option files
or on the command line.  After the server starts, those global variables
that are dynamic can be changed by connecting to the server and issuing
a <CODE>SET GLOBAL var_name</CODE> statement. To change a global variable,
you must have the <CODE>SUPER</CODE> privilege.

</P>
<P>
The server also maintains a set of session variables for each client
that connects. The client's session variables are initialized at connect
time using the current values of the corresponding global variables. For
those session variables that are dynamic, the client can change them
by issuing a <CODE>SET SESSION var_name</CODE> statement. Setting a session
variable requires no special privilege, but a client can change only its
own session variables, not those of any other client.

</P>
<P>
A change to a global variable is visible to any client that accesses that
global variable. However, it affects the corresponding session variable
that is initialized from the global variable only for clients that connect
after the change.  It does not affect the session variable for any client
that is already connected (not even that of the client that issues the
<CODE>SET GLOBAL</CODE> statement).

</P>
<P>
When setting a variable using a startup option, variable values can be given
with a suffix of <CODE>K</CODE>, <CODE>M</CODE>, or <CODE>G</CODE> to indicate kilobytes,
megabytes, or gigabytes, respectively. For example, the following command
starts the server with a key buffer size of 16 megabytes:

</P>

<PRE>
mysqld --key_buffer_size=16M
</PRE>

<P>
Before MySQL 4.0, use this syntax instead:

</P>

<PRE>
mysqld --set-variable=key_buffer_size=16M
</PRE>

<P>
The lettercase of suffix letters does not matter; <CODE>16M</CODE> and <CODE>16m</CODE> are
equivalent.

</P>
<P>
At runtime, use the <CODE>SET</CODE> statement to set system variables. In this
context, suffix letters cannot be used, but the value can take the form of an
expression:

</P>

<PRE>
mysql&#62; SET sort_buffer_size = 10 * 1024 * 1024;
</PRE>

<P>
To specify explicitly whether to set the global or session variable, use the
<CODE>GLOBAL</CODE> or <CODE>SESSION</CODE> options:

</P>

<PRE>
mysql&#62; SET GLOBAL sort_buffer_size = 10 * 1024 * 1024;
mysql&#62; SET SESSION sort_buffer_size = 10 * 1024 * 1024;
</PRE>

<P>
Without either option, the statement sets the session variable.

</P>
<P>
The variables that can be set at runtime are listed in
section <A HREF="manual.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A>.

</P>
<P>
If you want to restrict the maximum value to which a system variable can
be set with the <CODE>SET</CODE> statement, you can specify this maximum
by using an option of the form <CODE>--maximum-var_name</CODE> at server
startup. For example, to prevent the value of <CODE>query_cache_size</CODE>
from being increased to more than 32MB at runtime, use the option
<CODE>--maximum-query_cache_size=32M</CODE>. This feature is available as of MySQL
4.0.2.

</P>
<P>
You can view system variables and their values by using the
<CODE>SHOW VARIABLES</CODE> statement.  Many variables have both global and
session values. See section <A HREF="manual.html#System_Variables">10.4  System Variables</A> for more information.

</P>

<PRE>
mysql&#62; SHOW VARIABLES;
+---------------------------------+------------------------------+
| Variable_name                   | Value                        |
+---------------------------------+------------------------------|
| back_log                        | 50                           |
| basedir                         | /usr/local/mysql             |
| bdb_cache_size                  | 8388572                      |
| bdb_home                        | /usr/local/mysql             |
| bdb_log_buffer_size             | 32768                        |
| bdb_logdir                      |                              |
| bdb_max_lock                    | 10000                        |
| bdb_shared_data                 | OFF                          |
| bdb_tmpdir                      | /tmp/                        |
| bdb_version                     | Sleepycat Software: ...      |
| binlog_cache_size               | 32768                        |
| bulk_insert_buffer_size         | 8388608                      |
| character_set                   | latin1                       |
| character_sets                  | latin1 big5 czech euc_kr     |
| concurrent_insert               | ON                           |
| connect_timeout                 | 5                            |
| convert_character_set           |                              |
| datadir                         | /usr/local/mysql/data/       |
| default_week_format             | 0                            |
| delay_key_write                 | ON                           |
| delayed_insert_limit            | 100                          |
| delayed_insert_timeout          | 300                          |
| delayed_queue_size              | 1000                         |
| flush                           | OFF                          |
| flush_time                      | 0                            |
| ft_boolean_syntax               | + -&#62;&#60;()~*:""&#38;|               |
| ft_max_word_len                 | 84                           |
| ft_min_word_len                 | 4                            |
| ft_query_expansion_limit        | 20                           |
| ft_stopword_file                | (built-in)                   |
| have_bdb                        | YES                          |
| have_innodb                     | YES                          |
| have_isam                       | YES                          |
| have_openssl                    | YES                          |
| have_query_cache                | YES                          |
| have_raid                       | NO                           |
| have_symlink                    | DISABLED                     |
| init_file                       |                              |
| innodb_additional_mem_pool_size | 1048576                      |
| innodb_buffer_pool_size         | 8388608                      |
| innodb_data_file_path           | ibdata1:10M:autoextend       |
| innodb_data_home_dir            |                              |
| innodb_fast_shutdown            | ON                           |
| innodb_file_io_threads          | 4                            |
| innodb_flush_log_at_trx_commit  | 1                            |
| innodb_flush_method             |                              |
| innodb_force_recovery           | 0                            |
| innodb_lock_wait_timeout        | 50                           |
| innodb_log_arch_dir             |                              |
| innodb_log_archive              | OFF                          |
| innodb_log_buffer_size          | 1048576                      |
| innodb_log_file_size            | 5242880                      |
| innodb_log_files_in_group       | 2                            |
| innodb_log_group_home_dir       | ./                           |
| innodb_mirrored_log_groups      | 1                            |
| innodb_thread_concurrency       | 8                            |
| interactive_timeout             | 28800                        |
| join_buffer_size                | 131072                       |
| key_buffer_size                 | 16773120                     |
| key_cache_age_threshold         | 300                          |
| key_cache_block_size            | 1024                         |
| key_cache_division_limit        | 100                          |
| language                        | /usr/local/mysql/share/...   |
| large_files_support             | ON                           |
| local_infile                    | ON                           |
| locked_in_memory                | OFF                          |
| log                             | OFF                          |
| log_bin                         | OFF                          |
| log_slave_updates               | OFF                          |
| log_slow_queries                | OFF                          |
| log_update                      | OFF                          |
| log_warnings                    | OFF                          |
| long_query_time                 | 10                           |
| low_priority_updates            | OFF                          |
| lower_case_table_names          | 0                            |
| max_allowed_packet              | 1047552                      |
| max_binlog_cache_size           | 4294967295                   |
| max_binlog_size                 | 1073741824                   |
| max_connect_errors              | 10                           |
| max_connections                 | 100                          |
| max_delayed_threads             | 20                           |
| max_error_count                 | 64                           |
| max_heap_table_size             | 16777216                     |
| max_join_size                   | 4294967295                   |
| max_relay_log_size              | 0                            |
| max_sort_length                 | 1024                         |
| max_tmp_tables                  | 32                           |
| max_user_connections            | 0                            |
| max_write_lock_count            | 4294967295                   |
| myisam_max_extra_sort_file_size | 268435456                    |
| myisam_max_sort_file_size       | 2147483647                   |
| myisam_recover_options          | force                        |
| myisam_repair_threads           | 1                            |
| myisam_sort_buffer_size         | 8388608                      |
| net_buffer_length               | 16384                        |
| net_read_timeout                | 30                           |
| net_retry_count                 | 10                           |
| net_write_timeout               | 60                           |
| open_files_limit                | 1024                         |
| pid_file                        | /usr/local/mysql/name.pid    |
| port                            | 3306                         |
| protocol_version                | 10                           |
| query_cache_limit               | 1048576                      |
| query_cache_size                | 0                            |
| query_cache_type                | ON                           |
| read_buffer_size                | 131072                       |
| read_rnd_buffer_size            | 262144                       |
| rpl_recovery_rank               | 0                            |
| server_id                       | 0                            |
| skip_external_locking           | ON                           |
| skip_networking                 | OFF                          |
| skip_show_database              | OFF                          |
| slave_net_timeout               | 3600                         |
| slow_launch_time                | 2                            |
| socket                          | /tmp/mysql.sock              |
| sort_buffer_size                | 2097116                      |
| sql_mode                        |                              |
| table_cache                     | 64                           |
| table_type                      | MYISAM                       |
| thread_cache_size               | 3                            |
| thread_stack                    | 131072                       |
| timezone                        | EEST                         |
| tmp_table_size                  | 33554432                     |
| tmpdir                          | /tmp/:/mnt/hd2/tmp/          |
| tx_isolation                    | READ-COMMITTED               |
| version                         | 4.0.4-beta                   |
| wait_timeout                    | 28800                        |
+---------------------------------+------------------------------+
</PRE>

<P>
<A NAME="IDX508"></A>

</P>
<P>
Most system variables are described here.  <CODE>InnoDB</CODE> system variables
are listed at
section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.

</P>
<P>
Values for buffer sizes, lengths, and stack sizes are given in bytes unless
otherwise specified.

</P>
<P>
Information on tuning these variables can be found in section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
The system variables have the following meanings.  Variables with no
version indicated have been present since at least MySQL 3.22.

</P>
<DL COMPACT>

<DT><CODE>ansi_mode</CODE>
<DD>
Is <CODE>ON</CODE> if <CODE>mysqld</CODE> was started with <CODE>--ansi</CODE>.
See section <A HREF="manual.html#ANSI_mode">1.8.3  Running MySQL in ANSI Mode</A>.
This variable was added in MySQL 3.23.6 and removed in 3.23.41.

<DT><CODE>back_log</CODE>
<DD>
The number of outstanding connection requests MySQL can have. This
comes into play when the main MySQL thread gets very
many connection requests in a very short time. It then takes some time
(although very little) for the main thread to check the connection and start
a new thread. The <CODE>back_log</CODE> value indicates how many requests can be
stacked during this short time before MySQL momentarily stops
answering new requests. You need to increase this only if you expect a large
number of connections in a short period of time.

In other words, this value is the size of the listen queue for incoming
TCP/IP connections.  Your operating system has its own limit on the size
of this queue.  The manual page for the Unix <CODE>listen(2)</CODE> system
call should have more details.  Check your OS documentation for the
maximum value for this variable.  Attempting to set <CODE>back_log</CODE>
higher than your operating system limit will be ineffective.

<DT><CODE>basedir</CODE>
<DD>
The MySQL installation base directory. This variable can be set with the
<CODE>--basedir</CODE> option.

<DT><CODE>bdb_cache_size</CODE>
<DD>
The size of the buffer that is allocated for caching indexes and rows for
<CODE>BDB</CODE> tables.  If you don't use <CODE>BDB</CODE> tables, you should start
<CODE>mysqld</CODE> with <CODE>--skip-bdb</CODE> to not waste memory for this cache.
This variable was added in MySQL 3.23.14.

<DT><CODE>bdb_home</CODE>
<DD>
The base directory for <CODE>BDB</CODE> tables.  This should be assigned the same
value as the <CODE>datadir</CODE> variable.
This variable was added in MySQL 3.23.14.

<DT><CODE>bdb_log_buffer_size</CODE>
<DD>
The size of the buffer that is allocated for caching indexes and rows for
<CODE>BDB</CODE> tables.  If you don't use <CODE>BDB</CODE> tables, you should set this
to 0 or start <CODE>mysqld</CODE> with <CODE>--skip-bdb</CODE> to not waste memory for
this cache.
This variable was added in MySQL 3.23.31.

<DT><CODE>bdb_logdir</CODE>
<DD>
The directory where the <CODE>BDB</CODE> storage engine writes its log files.
This variable can be set with the <CODE>--bdb-logdir</CODE> option.
This variable was added in MySQL 3.23.14.

<DT><CODE>bdb_max_lock</CODE>
<DD>
The maximum number of locks you can have active on a <CODE>BDB</CODE> table
(10,000 by default). You should increase this if errors such as the
following occur when you perform long transactions or when <CODE>mysqld</CODE> has
to examine many rows to calculate a query:


<PRE>
bdb: Lock table is out of available locks
Got error 12 from ...
</PRE>

This variable was added in MySQL 3.23.29.

<DT><CODE>bdb_shared_data</CODE>
<DD>
Is <CODE>ON</CODE> if you are using <CODE>--bdb-shared-data</CODE>.
This variable was added in MySQL 3.23.29.

<DT><CODE>bdb_tmpdir</CODE>
<DD>
The value of the <CODE>--bdb-tmpdir</CODE> option.
This variable was added in MySQL 3.23.14.

<DT><CODE>bdb_version</CODE>
<DD>
The BDB storage engine version.
This variable was added in MySQL 3.23.31.

<DT><CODE>binlog_cache_size</CODE>
<DD>
The size of the cache to hold the SQL statements for the binary log during
a transaction.  A binary log cache is allocated for each client if the
server supports any transactional storage engines and, starting from MySQL
4.1.2, if the server has binary log enabled (<CODE>log-bin</CODE> option). If you
often use big, multiple-statement transactions, you can increase this to get
more performance.
The <CODE>Binlog_cache_use</CODE> and <CODE>Binlog_cache_disk_use</CODE> status variables
can be useful for tuning the size of this variable.
This variable was added in MySQL 3.23.29.
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

<DT><CODE>bulk_insert_buffer_size</CODE>
<DD>
<CODE>MyISAM</CODE> uses a special tree-like cache to make bulk inserts faster for
<CODE>INSERT ... SELECT</CODE>, <CODE>INSERT ... VALUES (...), (...), ...</CODE>, and
<CODE>LOAD DATA INFILE</CODE>. This variable limits
the size of the cache tree in bytes per thread. Setting it to 0
disables this optimization.
<STRONG>Note:</STRONG> This cache is used only when adding data to a non-empty table.
The default value is 8MB.
This variable was added in MySQL 4.0.3.
This variable previously was named <CODE>myisam_bulk_insert_tree_size</CODE>.

<DT><CODE>character_set</CODE>
<DD>
The default character set.
This variable was added in MySQL 3.23.3, then
removed in MySQL 4.1.1 and replaced by the various
<CODE>character_set_xxx</CODE> variables.

<DT><CODE>character_set_client</CODE>
<DD>
The character set for statements that arrive from the client.
This variable was added in MySQL 4.1.1.

<DT><CODE>character_set_connection</CODE>
<DD>
The character set used for literals that do not have a character set
introducer, for some functions, and for number-to-string conversion.
This variable was added in MySQL 4.1.1.

<DT><CODE>character_set_database</CODE>
<DD>
The character set used by the default database.
The server sets this variable whenever the default database changes.
If there is no default database, the variable has the same value as
<CODE>character_set_server</CODE>.
This variable was added in MySQL 4.1.1.

<DT><CODE>character_set_results</CODE>
<DD>
The character set used for returning query results to the client.
This variable was added in MySQL 4.1.1.

<DT><CODE>character_set_server</CODE>
<DD>
This variable was added in MySQL 4.1.1.

<DT><CODE>character_set_system</CODE>
<DD>
The character set used by the server for storing identifiers.
The value is always <CODE>utf8</CODE>.
This variable was added in MySQL 4.1.1.

<DT><CODE>character_sets</CODE>
<DD>
The supported character sets.
This variable was added in MySQL 3.23.15.

<DT><CODE>collation_connection</CODE>
<DD>
This variable was added in MySQL 4.1.1.

<DT><CODE>collation_database</CODE>
<DD>
The collation used by the default database.
The server sets this variable whenever the default database changes.
If there is no default database, the variable has the same value as
<CODE>collation_server</CODE>.
This variable was added in MySQL 4.1.1.

<DT><CODE>collation_server</CODE>
<DD>
This variable was added in MySQL 4.1.1.

<DT><CODE>concurrent_insert</CODE>
<DD>
If <CODE>ON</CODE> (the default), MySQL allows <CODE>INSERT</CODE> and <CODE>SELECT</CODE>
statements to run concurrently for <CODE>MyISAM</CODE> tables that have no free
blocks in the middle.  You can turn this option off by starting
<CODE>mysqld</CODE> with <CODE>--safe</CODE> or <CODE>--skip-new</CODE>.
This variable was added in MySQL 3.23.7.

<DT><CODE>connect_timeout</CODE>
<DD>
<A NAME="IDX509"></A>
The number of seconds the <CODE>mysqld</CODE> server waits for a connect
packet before responding with <CODE>Bad handshake</CODE>.

<DT><CODE>datadir</CODE>
<DD>
The MySQL data directory. This variable can be set with the
<CODE>--datadir</CODE> option.

<DT><CODE>default_week_format</CODE>
<DD>
The default mode value to use for the <CODE>WEEK()</CODE> function.
This variable is available as of MySQL 4.0.14.

<DT><CODE>delay_key_write</CODE>
<DD>
This option applies only to <CODE>MyISAM</CODE> tables. It can have one of the
following values to affect handling of the <CODE>DELAY_KEY_WRITE</CODE> table
option that can be given in <CODE>CREATE TABLE</CODE> statements.

<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><CODE>OFF</CODE> </TD><TD> <CODE>DELAYED_KEY_WRITE</CODE> is ignored.

</TD></TR>
<TR><TD><CODE>ON</CODE> </TD><TD> MySQL honors the <CODE>DELAY_KEY_WRITE</CODE> option
for <CODE>CREATE TABLE</CODE>. This is the default value.

</TD></TR>
<TR><TD><CODE>ALL</CODE> </TD><TD> All new opened tables are treated as if they were
created with the <CODE>DELAY_KEY_WRITE</CODE> option enabled.

</TD></TR>
</TABLE>

If <CODE>DELAY_KEY_WRITE</CODE> is enabled, this means that the key buffer for
tables with this option are not flushed on every index update, but
only when a table is closed.  This will speed up writes on keys a lot,
but if you use this feature, you should add automatic checking of all
<CODE>MyISAM</CODE> tables by starting the server with the <CODE>--myisam-recover</CODE>
option (for example, <CODE>--myisam-recover=BACKUP,FORCE</CODE>).
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.  See section <A HREF="manual.html#MyISAM_start">15.1.1  <CODE>MyISAM</CODE> Startup Options</A>.

Note that <CODE>--external-lock</CODE> doesn't offer any protection against
index corruption for tables that use delayed key writes.

This variable was added in MySQL 3.23.8.

<DT><CODE>delayed_insert_limit</CODE>
<DD>
After inserting <CODE>delayed_insert_limit</CODE> delayed rows, the <CODE>INSERT
DELAYED</CODE> handler thread checks whether there are any <CODE>SELECT</CODE>
statements pending. If so, it allows them to execute before continuing to
insert delayed rows.

<DT><CODE>delayed_insert_timeout</CODE>
<DD>
How long an <CODE>INSERT DELAYED</CODE> handler thread should wait for
<CODE>INSERT</CODE> statements before terminating.

<DT><CODE>delayed_queue_size</CODE>
<DD>
How many rows to queue when handling <CODE>INSERT DELAYED</CODE>
statements.  If the queue becomes full, any client that issues an
<CODE>INSERT DELAYED</CODE> statement will wait until there is room in the queue
again.

<DT><CODE>flush</CODE>
<DD>
This is <CODE>ON</CODE> if you have started <CODE>mysqld</CODE> with the <CODE>--flush</CODE>
option.
This variable was added in MySQL 3.22.9.

<DT><CODE>flush_time</CODE>
<DD>
If this is set to a non-zero value, all tables will be closed every
<CODE>flush_time</CODE> seconds to free up resources and sync unflushed data to
disk.  We recommend this option only on Windows 9x or Me, or on systems
with minimal resources available.
This variable was added in MySQL 3.22.18.

<DT><CODE>ft_boolean_syntax</CODE>
<DD>
The list of operators supported by boolean full-text searches performed using
<CODE>IN BOOLEAN MODE</CODE>.
This variable was added in MySQL 4.0.1.
See section <A HREF="manual.html#Fulltext_Boolean">13.6.1  Boolean Full-Text Searches</A>.

The default variable value is <CODE>'+ -&#62;&#60;()~*:""&#38;|'</CODE>. The rules for
changing the value are as follows:


<UL>
<LI>

Operator function is determined by position within the string.

<LI>

The replacement value must be 14 characters.

<LI>

Each character must be an ASCII non-alphanumeric character.

<LI>

Either the first or second character must be a space.

<LI>

No duplicates are allowed except the phrase quoting operators in positions
11 and 12. These two characters are not required to be the same, but they
are the only two that may be.

<LI>

Positions 10, 13, and 14 (which by default are set to <SAMP>`:'</SAMP>, <SAMP>`&#38;'</SAMP>, and
<SAMP>`|'</SAMP>) are reserved for future extensions.

</UL>

<DT><CODE>ft_max_word_len</CODE>
<DD>
The maximum length of the word to be included in a <CODE>FULLTEXT</CODE> index.
This variable was added in MySQL 4.0.0.

<STRONG>Note:</STRONG> <CODE>FULLTEXT</CODE> indexes must be rebuilt after changing
this variable.

<DT><CODE>ft_min_word_len</CODE>
<DD>
The minimum length of the word to be included in a <CODE>FULLTEXT</CODE> index.
This variable was added in MySQL 4.0.0.

<STRONG>Note:</STRONG> <CODE>FULLTEXT</CODE> indexes must be rebuilt after changing
this variable.

<DT><CODE>ft_query_expansion_limit</CODE>
<DD>
The number of top matches to use for full-text searches performed using
<CODE>WITH QUERY EXPANSION</CODE>.
This variable was added in MySQL 4.1.1.

<DT><CODE>ft_stopword_file</CODE>
<DD>
The file from which to read the list of stopwords for full-text searches.
All the words from the file are used; comments are <STRONG>not</STRONG> honored.
By default, a built-in list of stopwords is used (as defined in the
<TT>`myisam/ft_static.c'</TT> file).  Setting this variable to an empty string
(<CODE>''</CODE>) disables stopword filtering.  This variable was added in
MySQL 4.0.10.

<STRONG>Note:</STRONG> <CODE>FULLTEXT</CODE> indexes must be rebuilt after changing
this variable.

<DT><CODE>group_concat_max_len</CODE>
<DD>
The maximum allowed result length for the <CODE>GROUP_CONCAT()</CODE> function.
This variable was added in MySQL 4.1.0.

<DT><CODE>have_bdb</CODE>
<DD>
<CODE>YES</CODE> if <CODE>mysqld</CODE> supports <CODE>BDB</CODE> tables. <CODE>DISABLED</CODE>
if <CODE>--skip-bdb</CODE> is used.
This variable was added in MySQL 3.23.30.

<DT><CODE>have_innodb</CODE>
<DD>
<CODE>YES</CODE> if <CODE>mysqld</CODE> supports <CODE>InnoDB</CODE> tables. <CODE>DISABLED</CODE>
if <CODE>--skip-innodb</CODE> is used.
This variable was added in MySQL 3.23.37.

<DT><CODE>have_innodb</CODE>
<DD>
<CODE>YES</CODE> if <CODE>mysqld</CODE> supports <CODE>ISAM</CODE> tables. <CODE>DISABLED</CODE>
if <CODE>--skip-isam</CODE> is used.
This variable was added in MySQL 3.23.30.

<DT><CODE>have_raid</CODE>
<DD>
<CODE>YES</CODE> if <CODE>mysqld</CODE> supports the <CODE>RAID</CODE> option.
This variable was added in MySQL 3.23.30.

<DT><CODE>have_openssl</CODE>
<DD>
<CODE>YES</CODE> if <CODE>mysqld</CODE> supports SSL (encryption) of the client/server
protocol.
This variable was added in MySQL 3.23.43.

<DT><CODE>init_connect</CODE>
<DD>
A string to be executed by the server for each client that connects.
The string consists of one or more SQL statements. To specify multiple
statements, separate them by semicolon characters.
This variable was added in MySQL 4.1.2.

For example, each client begins by default with autocommit mode enabled.
There is no global server variable to specify that autocommit should be
disabled by default, but <CODE>init_connect</CODE> can be used to achieve the
same effect:


<PRE>
SET GLOBAL init_connect='SET AUTOCOMMIT=0';
</PRE>

This variable can also be set on the command line or in an option file.
To set the variable as just shown using an option file, include these
lines:


<PRE>
[mysqld]
init_connect='SET AUTOCOMMIT=0'
</PRE>

<DT><CODE>init_file</CODE>
<DD>
The name of the file specified with the <CODE>--init-file</CODE> option when you
start the server.  This is a file containing SQL statements that you want
the server to execute when it starts.
Each statement must be on a single line and should not include comments.
This variable was added in MySQL 3.23.2.

<DT><CODE>init_slave</CODE>
<DD>
This variable is similar to <CODE>init_connect</CODE>, but is a string to be
executed by a slave server each time the SQL thread starts.  The format of
the string is the same as for the <CODE>init_connect</CODE> variable.
This variable was added in MySQL 4.1.2.

<DT><CODE>innodb_xxx</CODE>
<DD>
The <CODE>InnoDB</CODE> system variables are listed at
section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.

<DT><CODE>interactive_timeout</CODE>
<DD>
The number of seconds the server waits for activity on an interactive
connection before closing it.  An interactive client is defined as a
client that uses the <CODE>CLIENT_INTERACTIVE</CODE> option to
<CODE>mysql_real_connect()</CODE>.  See also <CODE>wait_timeout</CODE>.

<DT><CODE>join_buffer_size</CODE>
<DD>
The size of the buffer that is used for full joins (joins that do not use
indexes).  Normally the best way to get fast joins is to add indexes.
Increase the value of <CODE>join_buffer_size</CODE> to get a faster full join when
adding indexes is not possible.  One join buffer is allocated for each full
join between two tables. For a complex join between several tables for which
indexes are not used, multiple join buffers might be necessary.

<DT><CODE>key_buffer_size</CODE>
<DD>
<A NAME="IDX510"></A>
Index blocks for <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables are buffered and are
shared by all threads.  <CODE>key_buffer_size</CODE> is the size of the buffer
used for index blocks.  The key buffer is also known as the key cache.

Increase the value to get better index handling (for all reads and multiple
writes) to as much as you can afford. Using a value that is 25% of total
memory on a machine that mainly runs MySQL is quite common.  However, if you
make the value too large (for example, more than 50% of your total memory)
your system might start to page and become extremely slow. Remember that
MySQL relies on the operating system to perform filesystem caching for data
reads, so you must leave some room for the filesystem cache.

For even more speed when writing many rows at the same time, use
<CODE>LOCK TABLES</CODE>.  See section <A HREF="manual.html#LOCK_TABLES">14.4.5  <CODE>LOCK TABLES</CODE> and <CODE>UNLOCK TABLES</CODE> Syntax</A>.

You can check the performance of the key buffer by issuing a <CODE>SHOW
STATUS</CODE> statement and examining the <CODE>Key_read_requests</CODE>,
<CODE>Key_reads</CODE>, <CODE>Key_write_requests</CODE>, and <CODE>Key_writes</CODE> status
variables.
See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

The <CODE>Key_reads/Key_read_requests</CODE> ratio should normally be
less than 0.01.  The <CODE>Key_writes/Key_write_requests</CODE> ratio is usually
near 1 if you are using mostly updates and deletes, but might be much
smaller if you tend to do updates that affect many rows at the same time or
if you are using the <CODE>DELAY_KEY_WRITE</CODE> table option.

The fraction of the key buffer in use can be determined using
<CODE>key_buffer_size</CODE> in conjunction with the <CODE>Key_blocks_used</CODE> status
variable and the buffer blocksize.  From MySQL 4.1.1 on, the buffer block
size is available from the <CODE>key_cache_block_size</CODE> server variable. The
fraction of the buffer in use is:


<PRE>
(Key_blocks_used * key_cache_block_size) / key_buffer_size
</PRE>

Before MySQL 4.1.1, key cache blocks are 1024 bytes, so the fraction of the
key buffer in use is:


<PRE>
(Key_blocks_used * 1024) / key_buffer_size
</PRE>

See section <A HREF="manual.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A>.

<DT><CODE>key_cache_age_threshold</CODE>
<DD>
This value controls the demotion of buffers from the hot sub-chain of a key
cache to the warm sub-chain.
Lower values cause demotion to happen more quickly.
The minimum value is 100.
The default value is 300.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A>.

<DT><CODE>key_cache_block_size</CODE>
<DD>
The size in bytes of blocks in the key cache.
The default value is 1024.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A>.

<DT><CODE>key_cache_division_limit</CODE>
<DD>
The division point between the hot and warm sub-chains of the key cache
buffer chain. The value is the percentage of the buffer chain to use for
the warm sub-chain.  Allowable values range from 1 to 100.
The default value is 100.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A>.

<DT><CODE>language</CODE>
<DD>
The language used for error messages.

<DT><CODE>large_file_support</CODE>
<DD>
Whether <CODE>mysqld</CODE> was compiled with options for big file support.
This variable was added in MySQL 3.23.28.

<DT><CODE>local_infile</CODE>
<DD>
Whether <CODE>LOCAL</CODE> is supported for <CODE>LOAD DATA INFILE</CODE> statements.
This variable was added in MySQL 4.0.3.

<DT><CODE>locked_in_memory</CODE>
<DD>
Whether <CODE>mysqld</CODE> was locked in memory with <CODE>--memlock</CODE>.
This variable was added in MySQL 3.23.25.

<DT><CODE>log</CODE>
<DD>
Whether logging of all queries to the general query log is enabled.
See section <A HREF="manual.html#Query_log">5.8.2  The General Query Log</A>.

<DT><CODE>log_bin</CODE>
<DD>
Whether the binary log is enabled.
This variable was added in MySQL 3.23.14.
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

<DT><CODE>log_slave_updates</CODE>
<DD>
Whether updates received by a slave server from a master server should be
logged to the slave's own binary log. Binary logging must be enabled on the
slave for this to have any effect.
This variable was added in MySQL 3.23.17.
See section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>.

<DT><CODE>log_slow_queries</CODE>
<DD>
Whether slow queries should be logged.  ``Slow'' is determined by the value
of the <CODE>long_query_time</CODE> variable.
This variable was added in MySQL 4.0.2.
See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>log_update</CODE>
<DD>
Whether the update log is enabled.  This variable was added in MySQL 3.22.18.
Note that the binary log is preferable to the update log, which
is unavailable as of MySQL 5.0.
See section <A HREF="manual.html#Update_log">5.8.3  The Update Log</A>.

<DT><CODE>long_query_time</CODE>
<DD>
If a query takes longer than this many seconds, the <CODE>Slow_queries</CODE> counter
is incremented. If you are using the <CODE>--log-slow-queries</CODE> option, the query
is logged to the slow query log file. This value is measured in real
time, not CPU time, so a query that is under the threshold on a lightly
loaded system might be above the threshold on a heavily loaded one.
See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>low_priority_updates</CODE>
<DD>
If set to <CODE>1</CODE>, all <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, and
<CODE>LOCK TABLE WRITE</CODE> statements wait until there is no pending
<CODE>SELECT</CODE> or <CODE>LOCK TABLE READ</CODE> on the affected table.
This variable previously was named <CODE>sql_low_priority_updates</CODE>.
It was added in MySQL 3.22.5.

<DT><CODE>lower_case_table_names</CODE>
<DD>
If set to 1, table names are stored in lowercase on disk and table name
comparisons are not case sensitive.  This variable was added in MySQL 3.23.6.
If set to 2 (new in 4.0.18), table names are stored as given but compared
in lowercase.  From MySQL 4.0.2, this option also applies to database names.
From 4.1.1, it also applies to table aliases.
See section <A HREF="manual.html#Name_case_sensitivity">10.2.2  Identifier Case Sensitivity</A>.

Note that you should <EM>not</EM> set this variable to 0 if you are running
MySQL on a system that does not have case-sensitive filenames (such as
Windows or Mac OS X).  New in 4.0.18:  If this variable is 0 and the
filesystem on which the data directory is located does not have
case-sensitive filenames, MySQL automatically sets
<CODE>lower_case_table_names</CODE> to 2.

<DT><CODE>max_allowed_packet</CODE>
<DD>
The maximum size of one packet or any generated/intermediate string.

The packet message buffer is initialized to <CODE>net_buffer_length</CODE>
bytes, but can grow up to <CODE>max_allowed_packet</CODE> bytes when needed.
This value by default is small, to catch big (possibly wrong) packets.

You must increase this value if you are using big <CODE>BLOB</CODE> columns or
long strings. It should be as big as the biggest <CODE>BLOB</CODE> you want to
use.  The protocol limit for <CODE>max_allowed_packet</CODE> is 16MB before
MySQL 4.0 and 1GB thereafter.

<DT><CODE>max_binlog_cache_size</CODE>
<DD>
If a multiple-statement transaction requires more than this amount of memory,
you will get the error <CODE>Multi-statement transaction required more than
'max_binlog_cache_size' bytes of storage</CODE>.
This variable was added in MySQL 3.23.29.

<DT><CODE>max_binlog_size</CODE>
<DD>
If a write to the binary log exceeds the given value, rotate the binary
logs.  You cannot set this variable to more than 1GB or to less than 4096
bytes.  (The minimum before MYSQL 4.0.14 is 1024 bytes.) The default value
is 1GB.  This variable was added in MySQL 3.23.33.

Note if you are using transactions: A transaction is written in one chunk to
the binary log, hence it is never split between several binary logs.
Therefore, if you have big transactions, you might see binary logs bigger than
<CODE>max_binlog_size</CODE>.

If <CODE>max_relay_log_size</CODE> is 0, the value of <CODE>max_binlog_size</CODE>
applies to relay logs as well. <CODE>max_relay_log_size</CODE> was added in
MySQL 4.0.14.

<DT><CODE>max_connect_errors</CODE>
<DD>
If there are more than this number of interrupted connections from a host,
that host is blocked from further connections.  You can unblock blocked hosts
with the <CODE>FLUSH HOSTS</CODE> statement.

<DT><CODE>max_connections</CODE>
<DD>
The number of simultaneous client connections allowed. Increasing this value
increases the number of file descriptors that <CODE>mysqld</CODE> requires.  See
section <A HREF="manual.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A> for comments on file descriptor limits.
See section <A HREF="manual.html#Too_many_connections">A.2.6  <CODE>Too many connections</CODE></A>.

<DT><CODE>max_delayed_threads</CODE>
<DD>
Don't start more than this number of threads to handle <CODE>INSERT DELAYED</CODE>
statements.  If you try to insert data into a new table after all <CODE>INSERT
DELAYED</CODE> threads are in use, the row will be inserted as if the
<CODE>DELAYED</CODE> attribute wasn't specified. If you set this to 0, MySQL
never creates a thread to handle <CODE>DELAYED</CODE> rows; in effect, this
disables <CODE>DELAYED</CODE> entirely.
This variable was added in MySQL 3.23.0.

<DT><CODE>max_error_count</CODE>
<DD>
The maximum number of error, warning, and note messages to be stored for
display by <CODE>SHOW ERRORS</CODE> or <CODE>SHOW WARNINGS</CODE>.
This variable was added in MySQL 4.1.0.

<DT><CODE>max_heap_table_size</CODE>
<DD>
This variable sets the maximum size to which <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>)
tables are allowed to grow.  The value of the variable is used to calculate
<CODE>MEMORY</CODE> table <CODE>MAX_ROWS</CODE> values.  Setting this variable has no
effect on any existing <CODE>MEMORY</CODE> table, unless the table is re-created
with a statement such as <CODE>CREATE TABLE</CODE> or <CODE>TRUNCATE TABLE</CODE>, or
altered with <CODE>ALTER TABLE</CODE>.
This variable was added in MySQL 3.23.0.

<DT><CODE>max_insert_delayed_threads</CODE>
<DD>
This variable is a synonym for <CODE>max_delayed_threads</CODE>.
It was added in MySQL 4.0.19.

<DT><CODE>max_join_size</CODE>
<DD>
Don't allow <CODE>SELECT</CODE> statements that probably will need to examine
more than <CODE>max_join_size</CODE> row combinations or are likely to do more
than <CODE>max_join_size</CODE> disk seeks.  By setting this value, you can catch
<CODE>SELECT</CODE> statements where keys are not used properly and that would
probably take a long time.  Set it if your users tend to perform joins
that lack a <CODE>WHERE</CODE> clause, that take a long time, or that return
millions of rows.

Setting this variable to a value other than <CODE>DEFAULT</CODE> resets
the <CODE>SQL_BIG_SELECTS</CODE> value to <CODE>0</CODE>.  If you set the
<CODE>SQL_BIG_SELECTS</CODE> value again, the <CODE>max_join_size</CODE> variable
is ignored.

If a query result already is in the query cache, no result size
check is performed, because the result has already been computed and it will
not burden the server to send it to the client.

This variable previously was named <CODE>sql_max_join_size</CODE>.

<DT><CODE>max_relay_log_size</CODE>
<DD>
If a write by a replication slave to its relay log exceeds the given value,
rotate the relay log.  This variable enables you to put different size
constraints on relay logs and binary logs.  However, setting the variable to
0 makes MySQL use <CODE>max_binlog_size</CODE> for both binary logs and relay
logs.  You must set <CODE>max_relay_log_size</CODE> to between 4096 bytes and 1GB
(inclusive), or to 0. The default value is 0.  This variable was added in
MySQL 4.0.14.
See section <A HREF="manual.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>.

<DT><CODE>max_seeks_for_key</CODE>
<DD>
Limit the assumed maximum number of seeks when looking up rows based on a
key.  The MySQL optimizer will assume that no more than this number of key
seeks will be required when searching for matching rows in a table by
scanning a key, regardless of the actual cardinality of the key.  By setting
this to a low value (100?), you can force MySQL to prefer keys instead of
table scans.
This variable was added in MySQL 4.0.14.

<DT><CODE>max_sort_length</CODE>
<DD>
The number of bytes to use when sorting <CODE>BLOB</CODE> or <CODE>TEXT</CODE>
values. Only the first <CODE>max_sort_length</CODE> bytes of each value
are used; the rest are ignored.

<DT><CODE>max_tmp_tables</CODE>
<DD>
(This option doesn't yet do anything.)
The maximum number of temporary tables a client can keep open at the same time.

<DT><CODE>max_user_connections</CODE>
<DD>
The maximum number of simultaneous connections allowed to any given MySQL
account.  A value of 0 means ``no limit.''
This variable was added in MySQL 3.23.34.

<DT><CODE>max_write_lock_count</CODE>
<DD>
After this many write locks, allow some read locks to run in between.
This variable was added in MySQL 3.23.7.

<DT><CODE>myisam_data_pointer_size</CODE>
<DD>
Default pointer size in bytes to be used by <CODE>CREATE TABLE</CODE> for
<CODE>MyISAM</CODE> tables when no <CODE>MAX_ROWS</CODE> option is specified.  This
variable cannot be less than 2 or larger than 8.  The default value is 4.
This variable was added in MySQL 4.1.2.
See section <A HREF="manual.html#Full_table">A.2.11  <CODE>The table is full</CODE></A>.

<DT><CODE>myisam_max_extra_sort_file_size</CODE>
<DD>
If the temporary file used for fast <CODE>MyISAM</CODE> index creation would be
larger than using the key cache by the amount specified here, prefer the key
cache method.  This is mainly used to force long character keys in large
tables to use the slower key cache method to create the index.
This variable was added in MySQL 3.23.37.
<STRONG>Note:</STRONG> The value is given in megabytes before 4.0.3 and
in bytes thereafter.

<DT><CODE>myisam_max_sort_file_size</CODE>
<DD>
The maximum size of the temporary file MySQL is allowed to use while
re-creating a <CODE>MyISAM</CODE> index (during <CODE>REPAIR TABLE</CODE>, <CODE>ALTER
TABLE</CODE>, or <CODE>LOAD DATA INFILE</CODE>).  If the file size would be bigger than
this value, the index will be created using the key cache instead, which is
slower.
This variable was added in MySQL 3.23.37.
<STRONG>Note:</STRONG> The value is given in megabytes before 4.0.3 and
in bytes thereafter.

<DT><CODE>myisam_recover_options</CODE>
<DD>
The value of the <CODE>--myisam-recover</CODE> option.
This variable was added in MySQL 3.23.36.

<DT><CODE>myisam_repair_threads</CODE>
<DD>
If this value is greater than 1, <CODE>MyISAM</CODE> table indexes are created in
parallel (each index in its own thread) during the <CODE>Repair by sorting</CODE>
process.  The default value is 1.  <STRONG>Note:</STRONG> Multi-threaded repair is
still <EM>alpha</EM> quality code.
This variable was added in MySQL 4.0.13.

<DT><CODE>myisam_sort_buffer_size</CODE>
<DD>
The buffer that is allocated when sorting <CODE>MyISAM</CODE> indexes during a
<CODE>REPAIR TABLE</CODE> or when creating indexes with <CODE>CREATE INDEX</CODE> or
<CODE>ALTER TABLE</CODE>.
This variable was added in MySQL 3.23.16.

<DT><CODE>named_pipe</CODE>
<DD>
On Windows, indicates whether the server supports connections over named
pipes.
This variable was added in MySQL 3.23.50.

<DT><CODE>net_buffer_length</CODE>
<DD>
The communication buffer is reset to this size between queries. This should
not normally be changed, but if you have very little memory, you can set it
to the expected length of SQL statements sent by clients.  If statements
exceed this length, the buffer is automatically enlarged, up to
<CODE>max_allowed_packet</CODE> bytes.

<DT><CODE>net_read_timeout</CODE>
<DD>
The number of seconds to wait for more data from a connection before
aborting the read.
When the server is reading from the client, <CODE>net_read_timeout</CODE> is the
timeout value controlling when to abort.
When the server is writing to the client, <CODE>net_write_timeout</CODE> is the
timeout value controlling when to abort.
See also <CODE>slave_net_timeout</CODE>.
This variable was added in MySQL 3.23.20.

<DT><CODE>net_retry_count</CODE>
<DD>
If a read on a communication port is interrupted, retry this many times
before giving up.  This value should be set quite high on FreeBSD because
internal interrupts are sent to all threads.
This variable was added in MySQL 3.23.7.

<DT><CODE>net_write_timeout</CODE>
<DD>
The number of seconds to wait for a block to be written to a connection before
aborting the write.
See also <CODE>net_read_timeout</CODE>.
This variable was added in MySQL 3.23.20.

<DT><CODE>open_files_limit</CODE>
<DD>
The number of files that the operating system allows <CODE>mysqld</CODE> to open.
This is the real value allowed by the system and might be different from the
value you gave <CODE>mysqld</CODE> as a startup option.  The value is 0 on systems
where MySQL can't change the number of open files.  This variable was added
in MySQL 3.23.20.

<DT><CODE>pid_file</CODE>
<DD>
The pathname of the process ID (PID) file. This variable can be set
with the <CODE>--pid-file</CODE> option.
This variable was added in MySQL 3.23.23.

<DT><CODE>port</CODE>
<DD>
The port on which the server listens for TCP/IP connections.  This variable
can be set with the <CODE>--port</CODE> option.

<DT><CODE>protocol_version</CODE>
<DD>
The version of the client/server protocol used by the MySQL server.
This variable was added in MySQL 3.23.18.

<DT><CODE>query_alloc_block_size</CODE>
<DD>
The allocation size of memory blocks that are allocated for objects created
during query parsing and execution. If you have problems with memory
fragmentation, it might help to increase this a bit.  This variable was added
in MySQL 4.0.16.

<DT><CODE>query_cache_limit</CODE>
<DD>
Don't cache results that are bigger than this. The default value is 1MB.
This variable was added in MySQL 4.0.1.

<DT><CODE>query_cache_min_res_unit</CODE>
<DD>
The minimum size for blocks allocated by the query cache.
The default value is 4KB. Tuning information for this variable
is given in section <A HREF="manual.html#Query_Cache_Configuration">5.10.3  Query Cache Configuration</A>.
This variable is present from MySQL 4.1.

<DT><CODE>query_cache_size</CODE>
<DD>
The amount of memory allocated for caching query results.  The default value
is 0, which disables the query cache.  Note that this amount of memory will
be allocated even if <CODE>query_cache_type</CODE> is set to 0.
This variable was added in MySQL 4.0.1.

<DT><CODE>query_cache_type</CODE>
<DD>
Set query cache type. Setting the <CODE>GLOBAL</CODE> value sets the type for all
clients that connect thereafter. Individual clients can set the
<CODE>SESSION</CODE> value to affect their own use of the query cache.

<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><CODE>0</CODE> or <CODE>OFF</CODE> </TD><TD> Don't cache or retrieve results.
Note that this will not deallocate the query cache buffer. To
do that, you should set <CODE>query_cache_size</CODE> to 0.

</TD></TR>
<TR><TD><CODE>1</CODE> or <CODE>ON</CODE> </TD><TD> Cache all query results except for those that
begin with <CODE>SELECT SQL_NO_CACHE</CODE>.

</TD></TR>
<TR><TD><CODE>2</CODE> or <CODE>DEMAND</CODE> </TD><TD> Cache results only for queries that
begin with <CODE>SELECT SQL_CACHE</CODE>.

</TD></TR>
</TABLE>

This variable was added in MySQL 4.0.3.

<DT><CODE>query_cache_wlock_invalidate</CODE>
<DD>
Normally, when one client acquires a <CODE>WRITE</CODE> lock on a <CODE>MyISAM</CODE>
table, other clients are not blocked from issuing queries for the table if
the query results are present in the query cache. Setting this variable to
1 causes acquisition of a <CODE>WRITE</CODE> lock for a table to invalidate
any queries in the query cache that refer to the table. This forces other
clients that attempt to access the table to wait while the lock is in effect.
This variable was added in MySQL 4.0.19.

<DT><CODE>query_prealloc_size</CODE>
<DD>
The size of the persistent buffer used for query parsing and execution.
This buffer is not freed between queries.
If you are running complex queries, a larger <CODE>query_prealloc_size</CODE> value
might be helpful in improving performance, because it can reduce the need for
the server to perform memory allocation during query execution operations.
This variable was added in MySQL 4.0.16.

<DT><CODE>range_alloc_block_size</CODE>
<DD>
The size of blocks that are allocated when doing range optimization.
This variable was added in MySQL 4.0.16.

<DT><CODE>read_buffer_size</CODE>
<DD>
Each thread that does a sequential scan allocates a buffer of this
size for each table it scans. If you do many sequential scans, you might
want to increase this value.
This variable was added in MySQL 4.0.3.
Previously, it was named <CODE>record_buffer</CODE>.

<DT><CODE>read_only</CODE>
<DD>
When the variable is set to <CODE>ON</CODE> for a replication slave server, it
causes the slave to allow no updates except from slave threads or from users
with the <CODE>SUPER</CODE> privilege.  This can be useful to ensure that a slave
server accepts no updates from clients.
This variable was added in MySQL 4.0.14.

<DT><CODE>read_rnd_buffer_size</CODE>
<DD>
When reading rows in sorted order after a sort, the rows are read through
this buffer to avoid disk seeks.  Setting the variable to a large value can
improve <CODE>ORDER BY</CODE> performance by a lot.  However, this is a buffer
allocated for each client, so you should not set the global variable to a
large value. Instead, change the session variable from within only those
clients that need to run large queries.
This variable was added in MySQL 4.0.3.
Previously, it was named <CODE>record_rnd_buffer</CODE>.

<DT><CODE>safe_show_database</CODE>
<DD>
Don't show databases for which the user has no database or
table privileges. This can improve security if you're concerned about
people being able to see what databases other users have. See also
<CODE>skip_show_database</CODE>.

This variable was removed in MySQL 4.0.5. Instead, use the <CODE>SHOW
DATABASES</CODE> privilege to control access by MySQL accounts to database names.

<DT><CODE>secure_auth</CODE>
<DD>
If the MySQL server has been started with the <CODE>--secure-auth</CODE> option,
it blocks connections from all accounts that have passwords stored in the old 
(pre-4.1) format. In that case, the value of this variable is <CODE>ON</CODE>, 
otherwise it is <CODE>OFF</CODE>.

You should enable this option if you want to prevent all usage of passwords
in old format (and hence insecure communication over the network).
This variable was added in MySQL 4.1.1.

Note that server startup will fail with an error if this option is enabled
and the privilege tables are in pre-4.1 format.

When used as a client-side option, the client refuses to connect to a server
if the server requires a password in old format for the client account.

<DT><CODE>server_id</CODE>
<DD>
The value of the <CODE>--server-id</CODE> option. It is used for master and slave
replication servers.
This variable was added in MySQL 3.23.26.

<DT><CODE>skip_external_locking</CODE>
<DD>
Is <CODE>OFF</CODE> if <CODE>mysqld</CODE> uses external locking.
This variable was added in MySQL 4.0.3.
Previously, it was named <CODE>skip_locking</CODE>.

<DT><CODE>skip_networking</CODE>
<DD>
Is <CODE>ON</CODE> if we allow only local (non-TCP/IP) connections.  On Unix,
local connections use a Unix socket file.  On Windows, local connections use
a named pipe.  On NetWare, only TCP/IP connections are supported, so do not
set this variable to <CODE>ON</CODE>.
This variable was added in MySQL 3.22.23.

<DT><CODE>skip_show_database</CODE>
<DD>
This prevents people from using the <CODE>SHOW DATABASES</CODE> statement if they
don't have the <CODE>SHOW DATABASES</CODE> privilege. This can improve security if
you're concerned about people being able to see what databases other users
have. See also <CODE>safe_show_database</CODE>.
This variable was added in MySQL 3.23.4.  As of MySQL 4.0.2, its effect also
depends on the <CODE>SHOW DATABASES</CODE> privilege: If the variable value is
<CODE>ON</CODE>, the <CODE>SHOW DATABASES</CODE> statement is allowed only to users who
have the <CODE>SHOW DATABASES</CODE> privilege, and the statement displays all
database names.  If the value is <CODE>OFF</CODE>, <CODE>SHOW DATABASES</CODE> is
allowed to all users, but displays each database name only if the user has
some privilege for the database or has the <CODE>SHOW DATABASES</CODE> privilege.

<DT><CODE>slave_net_timeout</CODE>
<DD>
The number of seconds to wait for more data from a master/slave connection
before aborting the read.
This variable was added in MySQL 3.23.40.

<DT><CODE>slow_launch_time</CODE>
<DD>
If creating a thread takes longer than this many seconds, the server
increments the <CODE>Slow_launch_threads</CODE> status variable.
This variable was added in MySQL 3.23.15.

<DT><CODE>socket</CODE>
<DD>
On Unix, this is the Unix socket file used for local client connections.  On
Windows, this is the name of the named pipe used for local client
connections.

<DT><CODE>sort_buffer_size</CODE>
<DD>
Each thread that needs to do a sort allocates a buffer of this
size. Increase this value for faster <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE>
operations.
See section <A HREF="manual.html#Temporary_files">A.4.4  Where MySQL Stores Temporary Files</A>.

<DT><CODE>sql_mode</CODE>
<DD>
The current server SQL mode.
This variable was added in MySQL 3.23.41.
See section <A HREF="manual.html#SQL_mode">1.8.2  Selecting SQL Modes</A>.

<DT><CODE>storage_engine</CODE>
<DD>
This variable is a synonym for <CODE>table_type</CODE>.
It was added in MySQL 4.1.2.

<DT><CODE>table_cache</CODE>
<DD>
The number of open tables for all threads. Increasing this value
increases the number of file descriptors that <CODE>mysqld</CODE> requires.
You can check whether you need to increase the table cache by checking the
<CODE>Opened_tables</CODE> status variable.
See section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>.
If the value of <CODE>Opened_tables</CODE> is large and you don't do <CODE>FLUSH
TABLES</CODE> a lot (which just forces all tables to be closed and reopened),
then you should increase the value of the <CODE>table_cache</CODE> variable.

For more information about the table cache, see section <A HREF="manual.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A>.

<DT><CODE>table_type</CODE>
<DD>
The default table type (storage engine).
To set the table type at server startup, use the <CODE>--default-table-type</CODE>
option.
This variable was added in MySQL 3.23.0.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

<DT><CODE>thread_cache_size</CODE>
<DD>
How many threads the server should cache for reuse.  When a client
disconnects, the client's threads are put in the cache if there aren't
already <CODE>thread_cache_size</CODE> threads there.  Requests for threads are
satisfied by reusing threads taken from the cache if possible, and only when
the cache is empty is a new thread created.  This variable can be increased
to improve performance if you have a lot of new connections. (Normally this
doesn't give a notable performance improvement if you have a good thread
implementation.)  By examining the difference between the <CODE>Connections</CODE>
and <CODE>Threads_created</CODE> status variables (see section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>
for details) you can see how efficient the thread cache is.
This variable was added in MySQL 3.23.16.

<DT><CODE>thread_concurrency</CODE>
<DD>
On Solaris, <CODE>mysqld</CODE> calls <CODE>thr_setconcurrency()</CODE> with this value.
This function allows applications to give the threads system a hint about
the desired number of threads that should be run at the same time.
This variable was added in MySQL 3.23.7.

<DT><CODE>thread_stack</CODE>
<DD>
The stack size for each thread.  Many of the limits detected by the
<CODE>crash-me</CODE> test are dependent on this value. The default is
large enough for normal operation.  See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.

<DT><CODE>timezone</CODE>
<DD>
The time zone for the server.  This is set from the <CODE>TZ</CODE> environment
variable when <CODE>mysqld</CODE> is started.  The time zone also can be set by
giving a <CODE>--timezone</CODE> argument to <CODE>mysqld_safe</CODE>.
This variable was added in MySQL 3.23.15.
See section <A HREF="manual.html#Timezone_problems">A.4.6  Time Zone Problems</A>.

<DT><CODE>tmp_table_size</CODE>
<DD>
If an in-memory temporary table exceeds this size, MySQL
automatically converts it to an on-disk <CODE>MyISAM</CODE> table.
Increase the value of <CODE>tmp_table_size</CODE> if you do many advanced
<CODE>GROUP BY</CODE> queries and you have lots of memory.

<DT><CODE>tmpdir</CODE>
<DD>
The directory used for temporary files and temporary tables.
Starting from MySQL 4.1, this variable can be set to a list of
several paths that are used in round-robin fashion. Paths
should be separated by colon characters (<SAMP>`:'</SAMP>) on Unix and semicolon
characters (<SAMP>`;'</SAMP>) on Windows, NetWare, and OS/2.

This feature can be used to
spread the load between several physical disks.
If the MySQL server is acting as a replication slave, you should not set
<CODE>tmpdir</CODE> to point to a directory on a memory-based filesystem or to a
directory that is cleared when the server host restarts.  A replication
slave needs some of its temporary files to survive a machine restart so that
it can replicate temporary tables or <CODE>LOAD DATA INFILE</CODE> operations. If
files in the temporary file directory are lost when the server restarts,
replication will fail.

This variable was added in MySQL 3.22.4.

<DT><CODE>transaction_alloc_block_size</CODE>
<DD>
The allocation size of memory blocks that are allocated for storing queries
that are part of a transaction to be stored in the binary log when doing a
commit.  This variable was added in MySQL 4.0.16.

<DT><CODE>transaction_prealloc_size</CODE>
<DD>
The size of the persistent buffer for <CODE>transaction_alloc_blocks</CODE> that
is not freed between queries. By making this big enough to fit all queries
in a common transaction, you can avoid a lot of <CODE>malloc()</CODE> calls.  This
variable was added in MySQL 4.0.16.

<DT><CODE>tx_isolation</CODE>
<DD>
The default transaction isolation level.
This variable was added in MySQL 4.0.3.

<DT><CODE>version</CODE>
<DD>
The version number for the server.

<DT><CODE>wait_timeout</CODE>
<DD>
The number of seconds the server waits for activity on a non-interactive
connection before closing it.

On thread startup, the session <CODE>wait_timeout</CODE> value is initialized from
the global <CODE>wait_timeout</CODE> value or from the global
<CODE>interactive_timeout</CODE> value, depending on the type of client (as
defined by the <CODE>CLIENT_INTERACTIVE</CODE> connect option to
<CODE>mysql_real_connect()</CODE>). See also <CODE>interactive_timeout</CODE>.

</DL>



<H4><A NAME="Dynamic_System_Variables" HREF="manual_toc.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A></H4>

<P>
Beginning with MySQL 4.0.3, many server system variables are dynamic and can
be set at runtime using <CODE>SET GLOBAL</CODE> or <CODE>SET SESSION</CODE>. You can also
select their values using <CODE>SELECT</CODE>.
See section <A HREF="manual.html#System_Variables">10.4  System Variables</A>.

</P>
<P>
The following table shows the full list of all dynamic system variables.
The last column indicates for each variable whether <CODE>GLOBAL</CODE> or
<CODE>SESSION</CODE> (or both) apply.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Variable Name</STRONG> </TD><TD> <STRONG>Value Type</STRONG> </TD><TD> <STRONG>Type</STRONG>
</TD></TR>
<TR><TD><CODE>autocommit</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>big_tables</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>binlog_cache_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>bulk_insert_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>character_set_client</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>character_set_connection</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>character_set_results</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>character_set_server</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>collation_connection</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>collation_server</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>concurrent_insert</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>connect_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>convert_character_set</CODE> </TD><TD> string </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>default_week_format</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>delay_key_write</CODE> </TD><TD> <CODE>OFF</CODE> | <CODE>ON</CODE> | <CODE>ALL</CODE> </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>delayed_insert_limit</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>delayed_insert_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>delayed_queue_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>error_count</CODE> </TD><TD> numeric </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>flush</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>flush_time</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>foreign_key_checks</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>ft_boolean_syntax</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>group_concat_max_len</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>identity</CODE> </TD><TD> numeric </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>insert_id</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>interactive_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>join_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>key_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>last_insert_id</CODE> </TD><TD> numeric </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>local_infile</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>log_warnings</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>long_query_time</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>low_priority_updates</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_allowed_packet</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_binlog_cache_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_binlog_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_connect_errors</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_connections</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_delayed_threads</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_error_count</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_heap_table_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_insert_delayed_threads</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_join_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_relay_log_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_seeks_for_key</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_sort_length</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>max_tmp_tables</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_user_connections</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>max_write_lock_count</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>myisam_max_extra_sort_file_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>myisam_max_sort_file_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>myisam_repair_threads</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>myisam_sort_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>net_buffer_length</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>net_read_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>net_retry_count</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>net_write_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>query_alloc_block_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>query_cache_limit</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>query_cache_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>query_cache_type</CODE> </TD><TD> enumeration </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>query_cache_wlock_invalidate</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>query_prealloc_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>range_alloc_block_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>read_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>read_only</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>read_rnd_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>rpl_recovery_rank</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>safe_show_database</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>server_id</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>slave_compressed_protocol</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>slave_net_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>slow_launch_time</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>sort_buffer_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_auto_is_null</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_big_selects</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_big_tables</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_buffer_result</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_log_bin</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_log_off</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_log_update</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_low_priority_updates</CODE> </TD><TD> boolean </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_max_join_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_quote_show_create</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_safe_updates</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_select_limit</CODE> </TD><TD> numeric </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>sql_slave_skip_counter</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>sql_warnings</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>storage_engine</CODE> </TD><TD> enumeration </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>table_cache</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>table_type</CODE> </TD><TD> enumeration </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>thread_cache_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE>
</TD></TR>
<TR><TD><CODE>timestamp</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>tmp_table_size</CODE> </TD><TD> enumeration </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>transaction_alloc_block_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>transaction_prealloc_size</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>tx_isolation</CODE> </TD><TD> enumeration </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>unique_checks</CODE> </TD><TD> boolean </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>wait_timeout</CODE> </TD><TD> numeric </TD><TD> <CODE>GLOBAL</CODE> | <CODE>SESSION</CODE>
</TD></TR>
<TR><TD><CODE>warning_count</CODE> </TD><TD> numeric </TD><TD> <CODE>SESSION</CODE>
</TD></TR>
</TABLE>

<P>
Variables that are marked as ``string'' take a string value.  Variables that
are marked as ``numeric'' take a numeric value. Variables that are
marked as ``boolean'' can be set to 0, 1, <CODE>ON</CODE> or <CODE>OFF</CODE>. Variables
that are marked as ``enumeration'' normally should be set to one of the
available values for the variable, but can also be set to the number that
corresponds to the desired enumeration value.  For enumeration-valued system
variables, the first enumeration value corresponds to 0. This differs
from <CODE>ENUM</CODE> columns, for which the first enumeration value corresponds
to 1.

</P>



<H3><A NAME="Server_status_variables" HREF="manual_toc.html#Server_status_variables">5.2.4  Server Status Variables</A></H3>

<P>
<A NAME="IDX511"></A>
<A NAME="IDX512"></A>

</P>
<P>
The server maintains many status variables that provide information about its
operations. You can view these variables and their values by using the
<CODE>SHOW STATUS</CODE> statement:

</P>


<PRE>
mysql&#62; SHOW STATUS;
+--------------------------+------------+
| Variable_name            | Value      |
+--------------------------+------------+
| Aborted_clients          | 0          |
| Aborted_connects         | 0          |
| Bytes_received           | 155372598  |
| Bytes_sent               | 1176560426 |
| Connections              | 30023      |
| Created_tmp_disk_tables  | 0          |
| Created_tmp_files        | 60         |
| Created_tmp_tables       | 8340       |
| Delayed_errors           | 0          |
| Delayed_insert_threads   | 0          |
| Delayed_writes           | 0          |
| Flush_commands           | 1          |
| Handler_delete           | 462604     |
| Handler_read_first       | 105881     |
| Handler_read_key         | 27820558   |
| Handler_read_next        | 390681754  |
| Handler_read_prev        | 6022500    |
| Handler_read_rnd         | 30546748   |
| Handler_read_rnd_next    | 246216530  |
| Handler_update           | 16945404   |
| Handler_write            | 60356676   |
| Key_blocks_used          | 14955      |
| Key_read_requests        | 96854827   |
| Key_reads                | 162040     |
| Key_write_requests       | 7589728    |
| Key_writes               | 3813196    |
| Max_used_connections     | 0          |
| Not_flushed_delayed_rows | 0          |
| Not_flushed_key_blocks   | 0          |
| Open_files               | 2          |
| Open_streams             | 0          |
| Open_tables              | 1          |
| Opened_tables            | 44600      |
| Qcache_free_blocks       | 36         |
| Qcache_free_memory       | 138488     |
| Qcache_hits              | 79570      |
| Qcache_inserts           | 27087      |
| Qcache_lowmem_prunes     | 3114       |
| Qcache_not_cached        | 22989      |
| Qcache_queries_in_cache  | 415        |
| Qcache_total_blocks      | 912        |
| Questions                | 2026873    |
| Select_full_join         | 0          |
| Select_full_range_join   | 0          |
| Select_range             | 99646      |
| Select_range_check       | 0          |
| Select_scan              | 30802      |
| Slave_open_temp_tables   | 0          |
| Slave_running            | OFF        |
| Slow_launch_threads      | 0          |
| Slow_queries             | 0          |
| Sort_merge_passes        | 30         |
| Sort_range               | 500        |
| Sort_rows                | 30296250   |
| Sort_scan                | 4650       |
| Table_locks_immediate    | 1920382    |
| Table_locks_waited       | 0          |
| Threads_cached           | 0          |
| Threads_connected        | 1          |
| Threads_created          | 30022      |
| Threads_running          | 1          |
| Uptime                   | 80380      |
+--------------------------+------------+
</PRE>

<P>
Many status variables are reset to 0 by the <CODE>FLUSH STATUS</CODE> statement.

</P>
<P>
The status variables have the following meanings.  The <CODE>Com_xxx</CODE>
statement counter variables were added beginning with MySQL 3.23.47. The
<CODE>Qcache_xxx</CODE> query cache variables were added beginning with MySQL
4.0.1. Otherwise, variables with no version indicated have been present since
at least MySQL 3.22.

</P>
<DL COMPACT>

<DT><CODE>Aborted_clients</CODE>
<DD>
The number of connections that were aborted because the client died without
closing the connection properly.
See section <A HREF="manual.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

<DT><CODE>Aborted_connects</CODE>
<DD>
The number of tries to connect to the MySQL server that failed. See section <A HREF="manual.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

<DT><CODE>Binlog_cache_use</CODE>
<DD>
The number of transactions that used the temporary binary log cache.
This variable was added in MySQL 4.1.2.

<DT><CODE>Binlog_cache_disk_use</CODE>
<DD>
The number of transactions that used the temporary binary log cache but that
exceeded the value of <CODE>binlog_cache_size</CODE> and used a temporary file to
store statements from the transaction.
This variable was added in MySQL 4.1.2.

<DT><CODE>Bytes_received</CODE>
<DD>
The number of bytes received from all clients.
This variable was added in MySQL 3.23.7.

<DT><CODE>Bytes_sent</CODE>
<DD>
The number of bytes sent to all clients.
This variable was added in MySQL 3.23.7.

<DT><CODE>Com_xxx</CODE>
<DD>
The number of times each <CODE>xxx</CODE> statement has been executed.
There is one status variable for each type of statement. For example,
<CODE>Com_delete</CODE> and <CODE>Com_insert</CODE> count <CODE>DELETE</CODE> and <CODE>INSERT</CODE>
statements.

<DT><CODE>Connections</CODE>
<DD>
The number of connection attempts (successful or not) to the MySQL server.

<DT><CODE>Created_tmp_disk_tables</CODE>
<DD>
The number of temporary tables on disk created automatically
by the server while executing statements.
This variable was added in MySQL 3.23.24.

<DT><CODE>Created_tmp_files</CODE>
<DD>
How many temporary files <CODE>mysqld</CODE> has created.
This variable was added in MySQL 3.23.28.

<DT><CODE>Created_tmp_tables</CODE>
<DD>
The number of in-memory temporary tables created automatically by the
server while executing statements.
If <CODE>Created_tmp_disk_tables</CODE> is big, you may want to increase the
<CODE>tmp_table_size</CODE> value to cause temporary tables to be memory-based
instead of disk-based.

<DT><CODE>Delayed_errors</CODE>
<DD>
The number of rows written with <CODE>INSERT DELAYED</CODE> for which some error
occurred (probably <CODE>duplicate key</CODE>).

<DT><CODE>Delayed_insert_threads</CODE>
<DD>
The number of <CODE>INSERT DELAYED</CODE> handler threads in use.

<DT><CODE>Delayed_writes</CODE>
<DD>
The number of <CODE>INSERT DELAYED</CODE> rows written.

<DT><CODE>Flush_commands</CODE>
<DD>
The number of executed <CODE>FLUSH</CODE> statements.

<DT><CODE>Handler_commit</CODE>
<DD>
The number of internal <CODE>COMMIT</CODE> statements.
This variable was added in MySQL 4.0.2.

<DT><CODE>Handler_delete</CODE>
<DD>
The number of times a row was deleted from a table.

<DT><CODE>Handler_read_first</CODE>
<DD>
The number of times the first entry was read from an index.  If this is
high, it suggests that the server is doing a lot of full index scans; for
example, <CODE>SELECT col1 FROM foo</CODE>, assuming that <CODE>col1</CODE> is indexed.

<DT><CODE>Handler_read_key</CODE>
<DD>
The number of requests to read a row based on a key. If this is high, it is
a good indication that your queries and tables are properly indexed.

<DT><CODE>Handler_read_next</CODE>
<DD>
The number of requests to read the next row in key order. This will be
incremented if you are querying an index column with a range constraint or
if you are doing an index scan.

<DT><CODE>Handler_read_prev</CODE>
<DD>
The number of requests to read the previous row in key order.  This read
method is mainly used to optimize <CODE>ORDER BY ... DESC</CODE>.
This variable was added in MySQL 3.23.6.

<DT><CODE>Handler_read_rnd</CODE>
<DD>
The number of requests to read a row based on a fixed position.  This will
be high if you are doing a lot of queries that require sorting of the
result.
You probably have a lot of queries that require MySQL to scan whole tables
or you have joins that don't use keys properly.

<DT><CODE>Handler_read_rnd_next</CODE>
<DD>
The number of requests to read the next row in the data file.
This will be high if you are doing a lot of table scans. Generally this suggests that your tables
are not properly indexed or that your queries are not written to take advantage of the indexes you
have.

<DT><CODE>Handler_rollback</CODE>
<DD>
The number of internal <CODE>ROLLBACK</CODE> statements.
This variable was added in MySQL 4.0.2.

<DT><CODE>Handler_update</CODE>
<DD>
The number of requests to update a row in a table.

<DT><CODE>Handler_write</CODE>
<DD>
The number of requests to insert a row in a table.

<DT><CODE>Key_blocks_used</CODE>
<DD>
The number of used blocks in the key cache.
You can use this value to determine how much of the key cache is in use;
see the discussion of <CODE>key_buffer_size</CODE> in
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

<DT><CODE>Key_read_requests</CODE>
<DD>
The number of requests to read a key block from the cache.

<DT><CODE>Key_reads</CODE>
<DD>
The number of physical reads of a key block from disk.
If <CODE>Key_reads</CODE> is big, then your <CODE>key_buffer_size</CODE> value is
probably too small.  The <STRONG>cache miss rate</STRONG> can be calculated with
<CODE>Key_reads</CODE>/<CODE>Key_read_requests</CODE>.

<DT><CODE>Key_write_requests</CODE>
<DD>
The number of requests to write a key block to the cache.

<DT><CODE>Key_writes</CODE>
<DD>
The number of physical writes of a key block to disk.

<DT><CODE>Max_used_connections</CODE>
<DD>
The maximum number of connections that have been in use simultaneously since
the server started.

<DT><CODE>Not_flushed_delayed_rows</CODE>
<DD>
The number of rows waiting to be written in <CODE>INSERT DELAY</CODE> queues.

<DT><CODE>Not_flushed_key_blocks</CODE>
<DD>
The number of key blocks in the key cache that have changed but haven't yet
been flushed to disk.

<DT><CODE>Open_files</CODE>
<DD>
The number of files that are open.

<DT><CODE>Open_streams</CODE>
<DD>
The number of streams that are open (used mainly for logging).

<DT><CODE>Open_tables</CODE>
<DD>
The number of tables that are open.

<DT><CODE>Opened_tables</CODE>
<DD>
The number of tables that have been opened.
If <CODE>Opened_tables</CODE> is big, your <CODE>table_cache</CODE>
value is probably too small.

<DT><CODE>Qcache_free_blocks</CODE>
<DD>
Number of free memory blocks in query cache.

<DT><CODE>Qcache_free_memory</CODE>
<DD>
Amount of free memory for query cache.

<DT><CODE>Qcache_hits</CODE>
<DD>
Number of cache hits.

<DT><CODE>Qcache_inserts</CODE>
<DD>
Number of queries added to the cache.

<DT><CODE>Qcache_lowmem_prunes</CODE>
<DD>
Number of queries that were deleted from cache because of low memory.

<DT><CODE>Qcache_not_cached</CODE>
<DD>
Number of non-cached queries
(not cachable, or due to <CODE>query_cache_type</CODE>).

<DT><CODE>Qcache_queries_in_cache</CODE>
<DD>
Number of queries registered in the cache.

<DT><CODE>Qcache_total_blocks</CODE>
<DD>
Total number of blocks in query cache.

<DT><CODE>Questions</CODE>
<DD>
The number of queries that have been sent to the server.

<DT><CODE>Rpl_status</CODE>
<DD>
Status of failsafe replication (not yet implemented).

<DT><CODE>Select_full_join</CODE>
<DD>
The number of joins that do not use indexes.  If this value is not 0, you
should carefully check the indexes of your tables.
This variable was added in MySQL 3.23.25.

<DT><CODE>Select_full_range_join</CODE>
<DD>
The number of joins where we used a range search on a reference table.
This variable was added in MySQL 3.23.25.

<DT><CODE>Select_range</CODE>
<DD>
The number of joins where we used ranges on the first table. (It's normally
not critical even if this is big.)
This variable was added in MySQL 3.23.25.

<DT><CODE>Select_range_check</CODE>
<DD>
The number of joins without keys where we check for key usage after each row.
(If this is not 0, you should carefully check the indexes of your tables.)
This variable was added in MySQL 3.23.25.

<DT><CODE>Select_scan</CODE>
<DD>
The number of joins where we did a full scan of the first table.
This variable was added in MySQL 3.23.25.

<DT><CODE>Slave_open_temp_tables</CODE>
<DD>
The number of temporary tables currently open by the slave SQL thread.
This variable was added in MySQL 3.23.29.

<DT><CODE>Slave_running</CODE>
<DD>
Is <CODE>ON</CODE> if this is a slave that is connected to a master.
This variable was added in MySQL 3.23.16.

<DT><CODE>Slow_launch_threads</CODE>
<DD>
The number of threads that have taken more than <CODE>slow_launch_time</CODE> to
create.
This variable was added in MySQL 3.23.15.

<DT><CODE>Slow_queries</CODE>
<DD>
The number of queries that have taken more than <CODE>long_query_time</CODE> seconds. See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>Sort_merge_passes</CODE>
<DD>
The number of merge passes the sort algorithm has had to do. If this value is
large, you should consider increasing the value of the <CODE>sort_buffer_size</CODE>
system variable.
This variable was added in MySQL 3.23.28.

<DT><CODE>Sort_range</CODE>
<DD>
The number of sorts that were done with ranges.
This variable was added in MySQL 3.23.25.

<DT><CODE>Sort_rows</CODE>
<DD>
The number of sorted rows.
This variable was added in MySQL 3.23.25.

<DT><CODE>Sort_scan</CODE>
<DD>
The number of sorts that were done by scanning the table.
This variable was added in MySQL 3.23.25.

<DT><CODE>Ssl_xxx</CODE>
<DD>
Variables used for SSL connections.
These variables were added in MySQL 4.0.0.

<DT><CODE>Table_locks_immediate</CODE>
<DD>
The number of times that a table lock was acquired immediately. This
variable was added as of MySQL 3.23.33.

<DT><CODE>Table_locks_waited</CODE>
<DD>
The number of times that a table lock could not be acquired immediately and a
wait was needed. If this is high, and you have performance problems, you
should first optimize your queries, and then either split your table or
tables or use replication.  This variable was added as of MySQL 3.23.33.

<DT><CODE>Threads_cached</CODE>
<DD>
The number of threads in the thread cache.
This variable was added in MySQL 3.23.17.

<DT><CODE>Threads_connected</CODE>
<DD>
The number of currently open connections.

<DT><CODE>Threads_created</CODE>
<DD>
The number of threads created to handle connections.
If <CODE>Threads_created</CODE> is big, you may want to increase the
<CODE>thread_cache_size</CODE> value.  The cache hit rate can be calculated
with <CODE>Threads_created</CODE>/<CODE>Connections</CODE>.
This variable was added in MySQL 3.23.31.

<DT><CODE>Threads_running</CODE>
<DD>
The number of threads that are not sleeping.

<DT><CODE>Uptime</CODE>
<DD>
The number of seconds the server has been up.

</DL>



<H2><A NAME="Security" HREF="manual_toc.html#Security">5.3  General Security Issues</A></H2>

<P>
<A NAME="IDX513"></A>

</P>
<P>
This section describes some general security issues to be aware of and what
you can do to make your MySQL installation more secure against attack or
misuse. For information specifically about the access control system that
MySQL uses for setting up user accounts and checking database access, see
section <A HREF="manual.html#Privilege_system">5.4  The MySQL Access Privilege System</A>.

</P>



<H3><A NAME="Security_guidelines" HREF="manual_toc.html#Security_guidelines">5.3.1  General Security Guidelines</A></H3>

<P>
Anyone using MySQL on a computer connected to the Internet
should read this section to avoid the most common security mistakes.

</P>
<P>
In discussing security, we emphasize the necessity of fully protecting the
entire server host (not just the MySQL server) against all types
of applicable attacks: eavesdropping, altering, playback, and denial of
service. We do not cover all aspects of availability and fault tolerance
here.

</P>
<P>
MySQL uses security based on Access Control Lists (ACLs) for all
connections, queries, and other operations that users can attempt to
perform. There is also some support for SSL-encrypted connections
between MySQL clients and servers. Many of the concepts
discussed here are not specific to MySQL at all; the same
general ideas apply to almost all applications.

</P>
<P>
When running MySQL, follow these guidelines whenever possible:

</P>

<UL>
<LI>

<STRONG>Do not ever give anyone (except MySQL <CODE>root</CODE> accounts) access
to the <CODE>user</CODE> table in the <CODE>mysql</CODE> database!</STRONG>  This is critical.
<STRONG>The encrypted password is the real password in MySQL.</STRONG> Anyone who
knows the password that is listed in the <CODE>user</CODE> table and has access
to the host listed for the account <STRONG>can easily log in as that user</STRONG>.

<LI>

Learn the MySQL access privilege system. The <CODE>GRANT</CODE> and
<CODE>REVOKE</CODE> statements are used for controlling access to MySQL. Do
not grant any more privileges than necessary. Never grant privileges to all
hosts.

Checklist:

<UL>
<LI>

Try <CODE>mysql -u root</CODE>. If you are able to connect successfully to the
server without being asked for a password, you have problems. Anyone
can connect to your MySQL server as the MySQL
<CODE>root</CODE> user with full privileges!
Review the MySQL installation instructions, paying particular
attention to the item about setting a <CODE>root</CODE> password.
<LI>

Use the <CODE>SHOW GRANTS</CODE> statement and check to see who has access to
what.  Then use the <CODE>REVOKE</CODE> statement to remove those privileges that
are not necessary.
</UL>

<LI>

Do not store any plain-text passwords in your database. If your
computer becomes compromised, the intruder can take the full list of
passwords and use them. Instead, use <CODE>MD5()</CODE>, <CODE>SHA1()</CODE>, or
some other one-way hashing function.
<LI>

Do not choose passwords from dictionaries. There are special programs to
break them. Even passwords like ``xfish98'' are very bad.  Much better is
``duag98'' which contains the same word ``fish'' but typed one key to the
left on a standard QWERTY keyboard. Another method is to use ``Mhall'' which
is taken from the first characters of each word in the sentence ``Mary had
a little lamb.'' This is easy to remember and type, but difficult to guess
for someone who does not know it.
<LI>

Invest in a firewall. This protects you from at least 50% of all types of
exploits in any software. Put MySQL behind the firewall or in
a demilitarized zone (DMZ).

Checklist:

<UL>
<LI>

Try to scan your ports from the Internet using a tool such as
<CODE>nmap</CODE>. MySQL uses port 3306 by default. This port should
not be accessible from untrusted hosts. Another simple way to check whether
or not your MySQL port is open is to try the following command
from some remote machine, where <CODE>server_host</CODE> is the host where
your MySQL server runs:


<PRE>
shell&#62; telnet server_host 3306
</PRE>

If you get a connection and some garbage characters, the port is
open, and should be closed on your firewall or router, unless you really
have a good reason to keep it open. If <CODE>telnet</CODE> just hangs or the
connection is refused, everything is OK; the port is blocked.
</UL>

<LI>

Do not trust any data entered by users of your applications. They can try to trick your
code by entering special or escaped character sequences in Web forms,
URLs, or whatever application you have built. Be sure that your
application remains secure if a user enters something like ``<CODE>; DROP
DATABASE mysql;</CODE>''. This is an extreme example, but large security leaks
and data loss might occur as a result of hackers using similar techniques,
if you do not prepare for them.

A common mistake is to protect only string data values.  Remember to check
numeric data as well.  If an application generates a query such as
<CODE>SELECT * FROM table WHERE ID=234</CODE> when a user enters the value
<CODE>234</CODE>, the user can enter the value <CODE>234 OR 1=1</CODE> to cause the
application to generate the query <CODE>SELECT * FROM table WHERE ID=234 OR
1=1</CODE>.  As a result, the server retrieves every record in the table.  This
exposes every record and causes excessive server load.  The simplest way to
protect from this type of attack is to use apostrophes around the numeric
constants: <CODE>SELECT * FROM table WHERE ID='234'</CODE>. If the user enters
extra information, it all becomes part of the string. In numeric context,
MySQL automatically converts this string to a number and strips any trailing
non-numeric characters from it.

Sometimes people think that if a database contains only publicly available
data, it need not be protected. This is incorrect.  Even if it is allowable
to display any record in the database, you should still protect against
denial of service attacks (for example, those that are based on the
technique in the preceding paragraph that causes the server to waste
resources). Otherwise, your server becomes unresponsive to legitimate users.

Checklist:

<UL>
<LI>

Try to enter <SAMP>`''</SAMP> and <SAMP>`"'</SAMP> in all your Web forms. If you get any kind
of MySQL error, investigate the problem right away.
<LI>

Try to modify any dynamic URLs by adding <CODE>%22</CODE> (<SAMP>`"'</SAMP>), <CODE>%23</CODE>
(<SAMP>`#'</SAMP>), and <CODE>%27</CODE> (<SAMP>`''</SAMP>) in the URL.
<LI>

Try to modify data types in dynamic URLs from numeric ones to character
ones containing characters from previous examples. Your application
should be safe against this and similar attacks.
<LI>

Try to enter characters, spaces, and special symbols rather than numbers in
numeric fields. Your application should remove them before passing them to
MySQL or else generate an error. Passing
unchecked values to MySQL is very dangerous!
<LI>

Check data sizes before passing them to MySQL.
<LI>

Consider having your application connect to the database using a
different username than the one you use for administrative purposes. Do
not give your applications any access privileges they do not need.
</UL>

<LI>

Many application programming interfaces provide a means of escaping special
characters in data values. Properly used, this prevents application users from
entering values that cause the application to generate statements that have a
different effect than you intend:

<UL>
<LI>

Users of PHP:
Use the <CODE>mysql_escape_string()</CODE> function, which
is based on the function of the same name in the MySQL C API.
Prior to PHP 4.0.3, use  <CODE>addslashes()</CODE> instead.
<LI>

Users of MySQL C API:
Use the <CODE>mysql_real_escape_string()</CODE> API call.
<LI>

Users of MySQL++:
Use the <CODE>escape</CODE> and <CODE>quote</CODE> modifiers for query streams.
<LI>

Users of Perl DBI:
Use the <CODE>quote()</CODE> method or use placeholders.
<LI>

Users of Java JDBC:
Use a <CODE>PreparedStatement</CODE> object and placeholders.
</UL>

Other programming interfaces might have similar capabilities.

<LI>

Do not transmit plain (unencrypted) data over the Internet. This information is
accessible to everyone who has the time and ability to intercept it and use
it for their own purposes. Instead, use an encrypted protocol such as SSL or
SSH. MySQL supports internal SSL connections as of Version 4.0.0.
SSH port-forwarding can be used to create an encrypted (and compressed)
tunnel for the communication.
<LI>

Learn to use the <CODE>tcpdump</CODE> and <CODE>strings</CODE> utilities. For most cases,
you can check whether MySQL data streams are unencrypted
by issuing a command like the following:


<PRE>
shell&#62; tcpdump -l -i eth0 -w - src or dst port 3306 | strings
</PRE>

(This works under Linux and should work with small modifications under other
systems.)  Warning: If you do not see plaintext data, this doesn't always
mean that the information actually is encrypted. If you need high security,
you should consult with a security expert.
</UL>



<H3><A NAME="Security_against_attack" HREF="manual_toc.html#Security_against_attack">5.3.2  Making MySQL Secure Against Attackers</A></H3>

<P>
<A NAME="IDX514"></A>
<A NAME="IDX515"></A>

</P>
<P>
When you connect to a MySQL server, you should use a password.  The password
is not transmitted in clear text over the connection. Password handling during
the client connection sequence was upgraded in MySQL 4.1.1 to be very secure.
If you are using an older version of MySQL, or are still using pre-4.1.1-style
passwords, the encryption
algorithm is less strong and with some effort a clever attacker that can
sniff the traffic between the client and the server can crack the password.
(See section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A> for a discussion of the different password handling
methods.)
If the connection between the client and the server goes through an
untrusted network, you should use an SSH tunnel to encrypt the communication.

</P>
<P>
All other information is transferred as text that can be read by anyone who
is able to watch the connection.  If you are concerned about this, you can
use the compressed protocol (in MySQL Version 3.22 and above) to make
traffic much more difficult to decipher.  To make the connection even more
secure, you should use SSH to get an encrypted TCP/IP connection between a
MySQL server and a MySQL client.  You can find an <CODE>Open Source</CODE> SSH
client at <a HREF="http://www.openssh.org/">http://www.openssh.org/</a>, and a commercial SSH client at
<a HREF="http://www.ssh.com/">http://www.ssh.com/</a>.

</P>
<P>
If you are using MySQL 4.0 or newer, you can also use internal OpenSSL support.
See section <A HREF="manual.html#Secure_connections">5.5.7  Using Secure Connections</A>.

</P>
<P>
To make a MySQL system secure, you should strongly consider the
following suggestions:

</P>

<UL>
<LI>

Use passwords for all MySQL users. A client program does not necessarily
know the identity of the person running it. It is common for client/server
applications that the user can specify any username to the client program.
For example, anyone can use the <CODE>mysql</CODE> program to connect as any other
person simply by invoking it as <CODE>mysql -u other_user db_name</CODE> if
<CODE>other_user</CODE> has no password. If all users have a password,
connecting using another user's account becomes much more difficult.

To change the password for a user, use the <CODE>SET PASSWORD</CODE> statement.
It is also possible to update the <CODE>user</CODE> table in the <CODE>mysql</CODE>
database directly.  For example, to change the password of all MySQL accounts
that have a username of <CODE>root</CODE>, do this:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; UPDATE user SET Password=PASSWORD('newpwd')
    -&#62; WHERE User='root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<LI>

Don't run the MySQL server as the Unix <CODE>root</CODE> user.  This is
very dangerous, because any user with the <CODE>FILE</CODE> privilege will be able
to create files as <CODE>root</CODE> (for example, <CODE>~root/.bashrc</CODE>). To
prevent this, <CODE>mysqld</CODE> refuses to run as <CODE>root</CODE> unless that
is specified explicitly using a <CODE>--user=root</CODE> option.

<CODE>mysqld</CODE> can be run as an ordinary unprivileged user instead.
You can also create a separate Unix account named <CODE>mysql</CODE> to make
everything even more secure (use the account only for administering MySQL).
To start <CODE>mysqld</CODE> as another Unix user, add a <CODE>user</CODE>
option that specifies the username to the <CODE>[mysqld]</CODE> group of the
<TT>`/etc/my.cnf'</TT> option file or the <TT>`my.cnf'</TT> option file in the
server's data directory. For example:


<PRE>
[mysqld]
user=mysql
</PRE>

This causes the server to start as the designated user whether you
start it manually or by using <CODE>mysqld_safe</CODE> or <CODE>mysql.server</CODE>.
For more details, see section <A HREF="manual.html#Changing_MySQL_user">A.3.2  How to Run MySQL as a Normal User</A>.

Note that running <CODE>mysql</CODE> as a Unix user other than <CODE>root</CODE> does not
mean that you need to change the <CODE>root</CODE> username in the <CODE>user</CODE>
table. Usernames for MySQL accounts have nothing to do with usernames for Unix
accounts.

<LI>

Don't allow the use of symlinks to tables. (This can be disabled with the
<CODE>--skip-symlink</CODE> option.) This is especially important if you run
<CODE>mysqld</CODE> as <CODE>root</CODE>, because anyone that has write access to the
server's data directory could then delete any file in the system!
See section <A HREF="manual.html#Symbolic_links_to_tables">7.6.1.2  Using Symbolic Links for Tables on Unix</A>.

<LI>

Make sure that the only Unix user with read or write privileges in the
database directories is the user that <CODE>mysqld</CODE> runs as.

<LI>

Don't grant the <CODE>PROCESS</CODE> or <CODE>SUPER</CODE> privilege to non-administrative users.
The output of <CODE>mysqladmin processlist</CODE> shows the text of the currently
executing queries, so any user who is allowed to execute that command
might be able to see if another user issues an <CODE>UPDATE user SET
password=PASSWORD('not_secure')</CODE> query.

<CODE>mysqld</CODE> reserves an extra connection for users who have the
<CODE>SUPER</CODE> privilege (<CODE>PROCESS</CODE> before MySQL 4.0.2), so that a MySQL
<CODE>root</CODE> user can log in and check server activity even if all normal
connections are in use.

The <CODE>SUPER</CODE> privilege
can be used to terminate client connections, change server operation by
changing the value of system variables, and control replication servers.

<LI>

Don't grant the <CODE>FILE</CODE> privilege to non-administrative users.
Any user that has this privilege can write a file anywhere in the
filesystem with the privileges of the <CODE>mysqld</CODE> daemon!  To make
this a bit safer, files generated with <CODE>SELECT ... INTO OUTFILE</CODE>
will not overwrite existing files and are writable by everyone.

<A NAME="IDX516"></A>

The <CODE>FILE</CODE> privilege may also be used to read any file that is
world-readable or accessible to the Unix user that the server runs as.
With this privilege, you can read any file into a database table.
This could be abused, for example, by using <CODE>LOAD DATA</CODE> to load
<TT>`/etc/passwd'</TT> into a table, which then can be displayed with
<CODE>SELECT</CODE>.

<LI>

If you don't trust your DNS, you should use IP numbers rather than
hostnames in the grant tables. In any case, you should be very careful
about creating grant table entries using hostname values that contain
wildcards!

<LI>

If you want to restrict the number of connections allowed to a single account,
you can do so by setting the <CODE>max_user_connections</CODE> variable in
<CODE>mysqld</CODE>.
The <CODE>GRANT</CODE> statement also supports resource control options for limiting
the extent of server use allowed to an account.
</UL>



<H3><A NAME="Privileges_options" HREF="manual_toc.html#Privileges_options">5.3.3  Startup Options for <CODE>mysqld</CODE> Concerning Security</A></H3>

<P>
The following <CODE>mysqld</CODE> options affect security:

</P>
<DL COMPACT>

<DT><CODE>--local-infile[={0|1}]</CODE>
<DD>
If you start the server with <CODE>--local-infile=0</CODE>, clients cannot use
<CODE>LOCAL</CODE> in <CODE>LOAD DATA</CODE> statements.
See section <A HREF="manual.html#LOAD_DATA_LOCAL">5.3.4  Security Issues with <CODE>LOAD DATA LOCAL</CODE></A>.

<DT><CODE>--safe-show-database</CODE>
<DD>
With this option, the <CODE>SHOW DATABASES</CODE> statement displays the names
of only those databases for which the user has some kind of privilege.
As of MySQL 4.0.2, this option is deprecated and doesn't do anything
(it is enabled by default), because there is now a <CODE>SHOW DATABASES</CODE>
privilege that can be used to control access to database
names on a per-account basis. See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

<DT><CODE>--safe-user-create</CODE>
<DD>
If this is enabled, a user cannot create new users with the <CODE>GRANT</CODE>
statement unless the user has the <CODE>INSERT</CODE> privilege for the
<CODE>mysql.user</CODE> table.  If you want a user to have the ability to create
new users with those privileges that the user has right to grant, you should
grant the user the following privilege:


<PRE>
mysql&#62; GRANT INSERT(user) ON mysql.user TO 'user'@'hostname';
</PRE>

This will ensure that the user can't change any privilege columns directly,
but has to use the <CODE>GRANT</CODE> statement to give privileges to other users.

<DT><CODE>--skip-grant-tables</CODE>
<DD>
This option causes the server not to use the privilege system at all. This
gives everyone <STRONG>full access</STRONG> to all databases!  (You can tell a running
server to start using the grant tables again by executing a <CODE>mysqladmin
flush-privileges</CODE> or <CODE>mysqladmin reload</CODE> command, or by issuing a
<CODE>FLUSH PRIVILEGES</CODE> statement.)

<DT><CODE>--skip-name-resolve</CODE>
<DD>
Hostnames are not resolved.  All <CODE>Host</CODE> column values in the grant
tables must be IP numbers or <CODE>localhost</CODE>.

<DT><CODE>--skip-networking</CODE>
<DD>
Don't allow TCP/IP connections over the network.  All connections to
<CODE>mysqld</CODE> must be made via Unix socket files.
This option is unsuitable when using a MySQL version prior to 3.23.27 with
the MIT-pthreads package, because Unix socket files were not supported by
MIT-pthreads at that time.

<DT><CODE>--skip-show-database</CODE>
<DD>
With this option, the <CODE>SHOW DATABASES</CODE> statement is allowed only to
users who have the <CODE>SHOW DATABASES</CODE> privilege, and the statement
displays all database names.  Without this option, <CODE>SHOW DATABASES</CODE> is
allowed to all users, but displays each database name only if the user has
some privilege for the database or has the <CODE>SHOW DATABASES</CODE> privilege.

</DL>



<H3><A NAME="LOAD_DATA_LOCAL" HREF="manual_toc.html#LOAD_DATA_LOCAL">5.3.4  Security Issues with <CODE>LOAD DATA LOCAL</CODE></A></H3>

<P>
The <CODE>LOAD DATA</CODE> statement can load a file that is located on the
server host, or it can load a file that is located on the client host when
the <CODE>LOCAL</CODE> keyword is specified.

</P>
<P>
There are two potential security issues with supporting the <CODE>LOCAL</CODE>
version of <CODE>LOAD DATA</CODE> statements:

</P>

<UL>
<LI>

The transfer of the file from the client host to the server host is initiated
by the MySQL server. In theory, a patched server could be built that would
tell the client program to transfer a file of the server's choosing rather
than the file named by the client in the <CODE>LOAD DATA</CODE> statement. Such a
server could access any file on the client host to which the client user has
read access.

<LI>

In a Web environment where the clients are connecting from a Web
server, a user could use <CODE>LOAD DATA LOCAL</CODE> to read any files
that the Web server process has read access to (assuming that a user could
run any command against the SQL server). In this environment, the client with
respect to the MySQL server actually is the Web server, not the program being
run by the user connecting to the Web server.

</UL>

<P>
To deal with these problems, we changed how <CODE>LOAD DATA
LOCAL</CODE> is handled as of MySQL 3.23.49 and MySQL 4.0.2 (4.0.13 on Windows):

</P>

<UL>

<LI>

By default, all MySQL clients and libraries in binary distributions are
compiled with the <CODE>--enable-local-infile</CODE> option, to be compatible
with MySQL 3.23.48 and before.

<LI>

If you build MySQL from source but don't use the <CODE>--enable-local-infile</CODE>
option to <CODE>configure</CODE>, <CODE>LOAD DATA LOCAL</CODE> cannot be used
by any client unless it is written explicitly to invoke
<CODE>mysql_options(... MYSQL_OPT_LOCAL_INFILE, 0)</CODE>.
See section <A HREF="manual.html#mysql_options">20.2.3.167  <CODE>mysql_options()</CODE></A>.

<LI>

You can disable all <CODE>LOAD DATA LOCAL</CODE> commands from the server side
by starting <CODE>mysqld</CODE> with the <CODE>--local-infile=0</CODE> option.

<LI>

For the <CODE>mysql</CODE> command-line client, <CODE>LOAD DATA LOCAL</CODE> can be
enabled by specifying the <CODE>--local-infile[=1]</CODE> option, or disabled with
the <CODE>--local-infile=0</CODE> option.  Similarly, for <CODE>mysqlimport</CODE>,
the <CODE>--local</CODE> or <CODE>-L</CODE> option enables local data file loading. In
any case, successful use of a local loading operation requires that the
server is enabled to allow it.

<LI>

If <CODE>LOAD DATA LOCAL INFILE</CODE> is disabled, either in the server or
the client, a client that attempts to issue such a statement receives the
following error message:


<PRE>
ERROR 1148: The used command is not allowed with this MySQL version
</PRE>

</UL>



<H2><A NAME="Privilege_system" HREF="manual_toc.html#Privilege_system">5.4  The MySQL Access Privilege System</A></H2>

<P>
<A NAME="IDX517"></A>
<A NAME="IDX518"></A>
<A NAME="IDX519"></A>
<A NAME="IDX520"></A>

</P>
<P>
MySQL has an advanced but non-standard security/privilege
system.  This section describes how it works.

</P>



<H3><A NAME="What_Privileges" HREF="manual_toc.html#What_Privileges">5.4.1  What the Privilege System Does</A></H3>

<P>
<A NAME="IDX521"></A>
<A NAME="IDX522"></A>
<A NAME="IDX523"></A>

</P>
<P>
The primary function of the MySQL privilege system is to
authenticate a user connecting from a given host, and to associate that user
with privileges on a database such as
<CODE>SELECT</CODE>, <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, and <CODE>DELETE</CODE>.

</P>
<P>
Additional functionality includes the ability to have an anonymous user and
to grant privileges for MySQL-specific functions such as <CODE>LOAD
DATA INFILE</CODE> and administrative operations.

</P>



<H3><A NAME="Privileges" HREF="manual_toc.html#Privileges">5.4.2  How the Privilege System Works</A></H3>

<P>
<A NAME="IDX524"></A>

</P>
<P>
The MySQL privilege system ensures that all users may perform only the
operations allowed to them.  As a user, when you connect to a
MySQL server, your identity is determined by <STRONG>the host from
which you connect</STRONG> and <STRONG>the username you specify</STRONG>.  The system grants
privileges according to your identity and <STRONG>what you want to do</STRONG>.

</P>
<P>
MySQL considers both your hostname and username in identifying you
because there is little reason to assume that a given username belongs to
the same person everywhere on the Internet.  For example, the user
<CODE>joe</CODE> who connects from <CODE>office.com</CODE> need not be the same
person as the user <CODE>joe</CODE> who connects from <CODE>elsewhere.com</CODE>.
MySQL handles this by allowing you to distinguish users on different
hosts that happen to have the same name:  You can grant <CODE>joe</CODE> one set
of privileges for connections from <CODE>office.com</CODE>, and a different set
of privileges for connections from <CODE>elsewhere.com</CODE>.

</P>
<P>
MySQL access control involves two stages:

</P>

<UL>
<LI>

Stage 1: The server checks whether you are even allowed to connect.

<LI>

Stage 2: Assuming that you can connect, the server checks each statement you issue
to see whether you have sufficient privileges to perform it.  For
example, if you try to select rows from a table in a database or drop a table
from the database, the server verifies that you have the <CODE>SELECT</CODE>
privilege for the table or the <CODE>DROP</CODE> privilege for the database.
</UL>

<P>
Note that if your privileges are changed (either by yourself or someone
else) while you are connected, those changes will not necessarily take
effect immediately for the next statement you issue.  See section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A> for details.

</P>
<P>
The server stores privilege information in the grant tables of the
<CODE>mysql</CODE> database (that is, in the database named <CODE>mysql</CODE>).
The MySQL server reads the contents of these tables into memory when it
starts and re-reads them under the circumstances indicated in section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A>. Access-control decisions are based on the in-memory copies of the
grant tables.

</P>
<P>
Normally, you manipulate the contents of the grant tables indirectly by using
the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements to set up accounts and control
the privileges available to each one.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.
The discussion here describes the underlying structure of the grant tables and
how the server uses their contents when interacting with clients.

</P>
<P>
The server uses the <CODE>user</CODE>, <CODE>db</CODE>, and <CODE>host</CODE> tables in the
<CODE>mysql</CODE> database at both stages of access control.  The columns in these
grant tables are shown here:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table Name</STRONG>
 </TD><TD> <STRONG>user</STRONG> </TD><TD> <STRONG>db</STRONG> </TD><TD> <STRONG>host</STRONG>

</TD></TR>
<TR><TD><STRONG>Scope columns</STRONG>
 </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>User</CODE> </TD><TD> <CODE>Db</CODE> </TD><TD> <CODE>Db</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Password</CODE> </TD><TD> <CODE>User</CODE> </TD><TD>

</TD></TR>
<TR><TD><STRONG>Privilege columns</STRONG>
 </TD><TD> <CODE>Select_priv</CODE> </TD><TD> <CODE>Select_priv</CODE> </TD><TD> <CODE>Select_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Insert_priv</CODE> </TD><TD> <CODE>Insert_priv</CODE> </TD><TD> <CODE>Insert_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Update_priv</CODE> </TD><TD> <CODE>Update_priv</CODE> </TD><TD> <CODE>Update_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Delete_priv</CODE> </TD><TD> <CODE>Delete_priv</CODE> </TD><TD> <CODE>Delete_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Index_priv</CODE> </TD><TD> <CODE>Index_priv</CODE> </TD><TD> <CODE>Index_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Alter_priv</CODE> </TD><TD> <CODE>Alter_priv</CODE> </TD><TD> <CODE>Alter_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Create_priv</CODE> </TD><TD> <CODE>Create_priv</CODE> </TD><TD> <CODE>Create_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Drop_priv</CODE> </TD><TD> <CODE>Drop_priv</CODE> </TD><TD> <CODE>Drop_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Grant_priv</CODE> </TD><TD> <CODE>Grant_priv</CODE> </TD><TD> <CODE>Grant_priv</CODE>

</TD></TR>
<TR><TD></TD><TD> <CODE>References_priv</CODE> </TD><TD> <CODE>References_priv</CODE> </TD><TD> <CODE>References_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Reload_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Shutdown_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Process_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>File_priv</CODE> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <CODE>Show_db_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Super_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Create_tmp_table_priv</CODE> </TD><TD> <CODE>Create_tmp_table_priv</CODE> </TD><TD> <CODE>Create_tmp_table_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Lock_tables_priv</CODE> </TD><TD> <CODE>Lock_tables_priv</CODE> </TD><TD> <CODE>Lock_tables_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Execute_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Repl_slave_priv</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>Repl_client_priv</CODE> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <CODE>ssl_type</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>ssl_cipher</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>x509_issuer</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>x509_subject</CODE> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <CODE>max_questions</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>max_updates</CODE> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <CODE>max_connections</CODE> </TD><TD> </TD><TD> 
</TD></TR>
</TABLE>

<P>
During the second stage of access control (request verification), the server
may, if the request involves tables, additionally consult the
<CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables that provide finer control
at the table and column levels.  The columns in these
tables are shown here:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table Name</STRONG> </TD><TD> <STRONG>tables_priv</STRONG> </TD><TD> <STRONG>columns_priv</STRONG>

</TD></TR>
<TR><TD><STRONG>Scope columns</STRONG> </TD><TD> <CODE>Host</CODE> </TD><TD> <CODE>Host</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Db</CODE> </TD><TD> <CODE>Db</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>User</CODE> </TD><TD> <CODE>User</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Table_name</CODE> </TD><TD> <CODE>Table_name</CODE>
</TD></TR>
<TR><TD></TD><TD> </TD><TD> <CODE>Column_name</CODE>

</TD></TR>
<TR><TD><STRONG>Privilege columns</STRONG> </TD><TD> <CODE>Table_priv</CODE> </TD><TD> <CODE>Column_priv</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Column_priv</CODE> </TD><TD>

</TD></TR>
<TR><TD><STRONG>Other columns</STRONG> </TD><TD> <CODE>Timestamp</CODE> </TD><TD> <CODE>Timestamp</CODE>
</TD></TR>
<TR><TD></TD><TD> <CODE>Grantor</CODE> </TD><TD>
</TD></TR>
</TABLE>

<P>
The <CODE>Timestamp</CODE> and <CODE>Grantor</CODE> columns currently are unused and are
discussed no further here.

</P>
<P>
Each grant table contains scope columns and privilege columns:

</P>

<UL>
<LI>

Scope columns determine the scope of each entry (row) in the tables; that is, the
context in which the entry applies.  For example, a <CODE>user</CODE> table entry
with <CODE>Host</CODE> and <CODE>User</CODE> values of <CODE>'thomas.loc.gov'</CODE> and
<CODE>'bob'</CODE> would be used for authenticating connections made to the server
from the host <CODE>thomas.loc.gov</CODE> by a client that specifies a username of
<CODE>bob</CODE>.  Similarly, a <CODE>db</CODE>
table entry with <CODE>Host</CODE>, <CODE>User</CODE>, and <CODE>Db</CODE> column values of
<CODE>'thomas.loc.gov'</CODE>, <CODE>'bob'</CODE> and <CODE>'reports'</CODE> would be used when
<CODE>bob</CODE> connects from the host <CODE>thomas.loc.gov</CODE> to access the
<CODE>reports</CODE> database.  The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE>
tables contain scope columns indicating tables or table/column combinations
to which each entry applies.

<LI>

Privilege columns indicate the privileges granted by a table entry; that is,
what operations can be performed.  The server combines the information in the
various grant tables to form a complete description of a user's privileges.
The rules used to do this are described in section <A HREF="manual.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A>.

</UL>

<P>
Scope columns contain strings. They are declared as shown here; the default value for
each is the empty string:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Name</STRONG> </TD><TD> <STRONG>Type</STRONG>
</TD></TR>
<TR><TD><CODE>Host</CODE> </TD><TD> <CODE>CHAR(60)</CODE>
</TD></TR>
<TR><TD><CODE>User</CODE> </TD><TD> <CODE>CHAR(16)</CODE>
</TD></TR>
<TR><TD><CODE>Password</CODE> </TD><TD> <CODE>CHAR(16)</CODE>
</TD></TR>
<TR><TD><CODE>Db</CODE> </TD><TD> <CODE>CHAR(64)</CODE>
</TD></TR>
<TR><TD><CODE>Table_name</CODE> </TD><TD> <CODE>CHAR(60)</CODE>
</TD></TR>
<TR><TD><CODE>Column_name</CODE> </TD><TD> <CODE>CHAR(60)</CODE>
</TD></TR>
</TABLE>

<P>
Before MySQL 3.23, the <CODE>Db</CODE> column is <CODE>CHAR(32)</CODE> in some tables
and <CODE>CHAR(60)</CODE> in others.

</P>
<P>
<A NAME="IDX525"></A>
For access-checking purposes, comparisons of <CODE>Host</CODE> values are
case-insensitive.  <CODE>User</CODE>, <CODE>Password</CODE>, <CODE>Db</CODE>, and
<CODE>Table_name</CODE> values are case-sensitive.
<CODE>Column_name</CODE> values are case-insensitive in MySQL Version
3.22.12 or later.

</P>
<P>
In the <CODE>user</CODE>, <CODE>db</CODE>, and <CODE>host</CODE> tables, each privilege
is listed in a separate column that is declared as
<CODE>ENUM('N','Y') DEFAULT 'N'</CODE>. In other words, each privilege can disabled
or enabled, with the default being disabled.

</P>
<P>
In the <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables, the privilege
columns are declared as <CODE>SET</CODE> columns. Values in these columns can
contain any combination of the privileges controlled by the table:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table Name</STRONG>
 </TD><TD> <STRONG>Column Name</STRONG>
 </TD><TD> <STRONG>Possible Set Elements</STRONG>
</TD></TR>
<TR><TD><CODE>tables_priv</CODE>
 </TD><TD> <CODE>Table_priv</CODE>
 </TD><TD> <CODE>'Select', 'Insert', 'Update', 'Delete', 'Create', 'Drop', 'Grant', 'References', 'Index', 'Alter'</CODE>
</TD></TR>
<TR><TD><CODE>tables_priv</CODE>
 </TD><TD> <CODE>Column_priv</CODE>
 </TD><TD> <CODE>'Select', 'Insert', 'Update', 'References'</CODE>
</TD></TR>
<TR><TD><CODE>columns_priv</CODE>
 </TD><TD> <CODE>Column_priv</CODE>
 </TD><TD> <CODE>'Select', 'Insert', 'Update', 'References'</CODE>
</TD></TR>
</TABLE>

<P>
Briefly, the server uses the grant tables as follows:

</P>

<UL>
<LI>

The <CODE>user</CODE> table scope columns determine whether to reject or allow
incoming connections.  For allowed connections, any privileges granted in
the <CODE>user</CODE> table indicate the user's global (superuser) privileges.
These privileges apply to <STRONG>all</STRONG> databases on the server.

<LI>

The <CODE>db</CODE> table scope columns determine which users can access which
databases from which hosts.  The privilege columns determine which operations
are allowed. A privilege granted at the database level applies to the database
and to all its tables.

<LI>

The <CODE>host</CODE> table is used in conjunction with the <CODE>db</CODE> table when you
want a given <CODE>db</CODE> table entry to apply to several hosts.  For example,
if you want a user to be able to use a database from several hosts in
your network, leave the <CODE>Host</CODE> value empty in the user's <CODE>db</CODE> table
entry, then populate the <CODE>host</CODE> table with an entry for each of those
hosts.  This mechanism is described more detail in section <A HREF="manual.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A>.

<STRONG>Note:</STRONG> The <CODE>host</CODE> table is not affected by the <CODE>GRANT</CODE> and
<CODE>REVOKE</CODE> statements. Most MySQL installations need not use this table at
all.

<LI>

The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables are similar to
the <CODE>db</CODE> table, but are more fine-grained: They apply at the
table and column levels rather than at the database level.
A privilege granted at the table level applies to the table and to all its
columns.
A privilege granted at the column level applies only to a specific column.
</UL>

<P>
Administrative privileges (such as <CODE>RELOAD</CODE> or <CODE>SHUTDOWN</CODE>)
are specified only in the <CODE>user</CODE> table.  This is because
administrative operations are operations on the server itself and are not
database-specific, so there is no reason to list these privileges in the
other grant tables.  In fact, to determine whether you can perform an
administrative operation, the server need consult only the <CODE>user</CODE> table.

</P>
<P>
The <CODE>FILE</CODE> privilege also is specified only in the <CODE>user</CODE> table.
It is not an administrative privilege as such, but your ability to read or
write files on the server host is independent of the database you are
accessing.

</P>
<P>
The <CODE>mysqld</CODE> server reads the contents of the grant tables into memory
when it starts. You can tell it to re-read the tables by issuing a <CODE>FLUSH
PRIVILEGES</CODE> statement or executing a <CODE>mysqladmin flush-privileges</CODE> or
<CODE>mysqladmin reload</CODE> command.
Changes to the grant tables take effect as indicated in
section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A>.

</P>
<P>
When you modify the contents of the grant tables, it is a good idea to make
sure that your changes set up privileges the way you want. One way to check
the privileges for a given account is to use the <CODE>SHOW GRANTS</CODE> statement.
For example, to determine the privileges that are granted to an account with
<CODE>Host</CODE> and <CODE>User</CODE> values of <CODE>pc84.example.com</CODE> and <CODE>bob</CODE>,
issue this statement:

</P>

<PRE>
mysql&#62; SHOW GRANTS FOR 'bob'@'pc84.example.com';
</PRE>

<P>
A useful
diagnostic tool is the <CODE>mysqlaccess</CODE> script, which Yves Carlier has
provided for the MySQL distribution.  Invoke <CODE>mysqlaccess</CODE> with
the <CODE>--help</CODE> option to find out how it works.
Note that <CODE>mysqlaccess</CODE> checks access using only the <CODE>user</CODE>,
<CODE>db</CODE>, and <CODE>host</CODE> tables.  It does not check table or column
privileges specified in the <CODE>tables_priv</CODE> or <CODE>columns_priv</CODE> tables.

</P>
<P>
For additional help in diagnosing privilege-related problems, see
section <A HREF="manual.html#Access_denied">5.4.8  Causes of <CODE>Access denied</CODE> Errors</A>.  For general advice on security issues, see
section <A HREF="manual.html#Security">5.3  General Security Issues</A>.

</P>



<H3><A NAME="Privileges_provided" HREF="manual_toc.html#Privileges_provided">5.4.3  Privileges Provided by MySQL</A></H3>

<P>
<A NAME="IDX526"></A>

</P>
<P>
Information about account privileges is stored in the <CODE>user</CODE>, <CODE>db</CODE>,
<CODE>host</CODE>, <CODE>tables_priv</CODE>, and <CODE>columns_priv</CODE> tables in the
<CODE>mysql</CODE> database.  The MySQL server reads the contents of these
tables into memory when it starts and re-reads them under the circumstances
indicated in section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A>.  Access-control decisions are based
on the in-memory copies of the grant tables.

</P>
<P>
The names used in this manual to refer to the privileges provided by
MySQL are shown in the following table, along with the table column name
associated with each privilege in the grant tables and the context in
which the privilege applies. Further information about the meaning of
each privilege may be found at section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Privilege</STRONG> </TD><TD> <STRONG>Column</STRONG> </TD><TD> <STRONG>Context</STRONG>
</TD></TR>
<TR><TD><CODE>ALTER</CODE> </TD><TD> <CODE>Alter_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>DELETE</CODE> </TD><TD> <CODE>Delete_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>INDEX</CODE> </TD><TD> <CODE>Index_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>INSERT</CODE> </TD><TD> <CODE>Insert_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>SELECT</CODE> </TD><TD> <CODE>Select_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>UPDATE</CODE> </TD><TD> <CODE>Update_priv</CODE> </TD><TD> tables
</TD></TR>
<TR><TD><CODE>CREATE</CODE> </TD><TD> <CODE>Create_priv</CODE> </TD><TD> databases, tables, or indexes
</TD></TR>
<TR><TD><CODE>DROP</CODE> </TD><TD> <CODE>Drop_priv</CODE> </TD><TD> databases or tables
</TD></TR>
<TR><TD><CODE>GRANT</CODE> </TD><TD> <CODE>Grant_priv</CODE> </TD><TD> databases or tables
</TD></TR>
<TR><TD><CODE>REFERENCES</CODE> </TD><TD> <CODE>References_priv</CODE> </TD><TD> databases or tables
</TD></TR>
<TR><TD><CODE>CREATE TEMPORARY TABLES</CODE> </TD><TD> <CODE>Create_tmp_table_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>EXECUTE</CODE> </TD><TD> <CODE>Execute_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>FILE</CODE> </TD><TD> <CODE>File_priv</CODE> </TD><TD> file access on server host
</TD></TR>
<TR><TD><CODE>LOCK TABLES</CODE> </TD><TD> <CODE>Lock_tables_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>PROCESS</CODE> </TD><TD> <CODE>Process_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>RELOAD</CODE> </TD><TD> <CODE>Reload_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>REPLICATION CLIENT</CODE> </TD><TD> <CODE>Repl_client_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>REPLICATION SLAVE</CODE> </TD><TD> <CODE>Repl_slave_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>SHOW DATABASES</CODE> </TD><TD> <CODE>Show_db_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>SHUTDOWN</CODE> </TD><TD> <CODE>Shutdown_priv</CODE> </TD><TD> server administration
</TD></TR>
<TR><TD><CODE>SUPER</CODE> </TD><TD> <CODE>Super_priv</CODE> </TD><TD> server administration
</TD></TR>
</TABLE>

<P>
The <CODE>CREATE TEMPORARY TABLES</CODE>, <CODE>EXECUTE</CODE>, <CODE>LOCK TABLES</CODE>,
<CODE>REPLICATION CLIENT</CODE>, <CODE>REPLICATION SLAVE</CODE>, <CODE>SHOW DATABASES</CODE>,
and <CODE>SUPER</CODE> privileges were added in MySQL 4.0.2.

</P>
<P>
The <CODE>EXECUTE</CODE> and <CODE>REFERENCES</CODE> privileges currently are unused.

</P>
<P>
The <CODE>SELECT</CODE>, <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, and <CODE>DELETE</CODE>
privileges allow you to perform operations on rows in existing tables in
a database.

</P>
<P>
<CODE>SELECT</CODE> statements require the <CODE>SELECT</CODE> privilege only if they
actually retrieve rows from a table.  Some <CODE>SELECT</CODE> statements do not
access tables and can be executed without permission for any database.
For example, you can use the <CODE>mysql</CODE> client as a simple calculator
to evaluate expressions that make no reference to tables:

</P>

<PRE>
mysql&#62; SELECT 1+1;
mysql&#62; SELECT PI()*2;
</PRE>

<P>
The <CODE>CREATE</CODE> and <CODE>DROP</CODE> privileges allow you to create new
databases and tables, or to drop (remove) existing databases and tables.
Note that if you grant the <CODE>DROP</CODE> privilege for the <CODE>mysql</CODE>
database to a user, that user can drop the database in which the
MySQL access privileges are stored!

</P>
<P>
The <CODE>INDEX</CODE> privilege allows you to create or drop (remove) indexes.
Note that <CODE>INDEX</CODE> applies to existing tables.
If you have the <CODE>CREATE</CODE> privilege for a table, you can include index
definitions in the <CODE>CREATE TABLE</CODE> statement.

</P>
<P>
The <CODE>ALTER</CODE> privilege allows you to use <CODE>ALTER TABLE</CODE> to change the
structure of or rename tables.

</P>
<P>
The <CODE>GRANT</CODE> privilege allows you to give to other users those
privileges that you yourself possess.

</P>
<P>
The <CODE>FILE</CODE> privilege gives you permission to read and write files on
the server host using the <CODE>LOAD DATA INFILE</CODE> and <CODE>SELECT ... INTO
OUTFILE</CODE> statements. A user who has the <CODE>FILE</CODE> privilege can read any
file on the server host that is either world-readable or readable by the MySQL
server. (Note that this implies the user can read any file in any database
directory, because the server can access any of those files.)
The <CODE>FILE</CODE> privilege also allows the user to create new files in any
directory where the MySQL server has write access. (Existing files cannot be
overwritten.)

</P>
<P>
The remaining privileges are used for administrative operations. Many of
them can be performed by using the <CODE>mysqladmin</CODE> program or by
issuing SQL statements.  The following table shows which <CODE>mysqladmin</CODE>
commands each administrative privilege allows you to execute:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Privilege</STRONG> </TD><TD> <STRONG>Commands Permitted to Privilege Holders</STRONG>
</TD></TR>
<TR><TD><CODE>RELOAD</CODE> </TD><TD> <CODE>flush-hosts</CODE>, <CODE>flush-logs</CODE>, <CODE>flush-privileges</CODE>, <CODE>flush-status</CODE>, <CODE>flush-tables</CODE>, <CODE>flush-threads</CODE>, <CODE>refresh</CODE>, and <CODE>reload</CODE>
</TD></TR>
<TR><TD><CODE>SHUTDOWN</CODE> </TD><TD> <CODE>shutdown</CODE>
</TD></TR>
<TR><TD><CODE>PROCESS</CODE> </TD><TD> <CODE>processlist</CODE>
</TD></TR>
<TR><TD><CODE>SUPER</CODE> </TD><TD> <CODE>kill</CODE>
</TD></TR>
</TABLE>

<P>
The <CODE>reload</CODE> command tells the server to re-read the grant tables
into memory.  <CODE>flush-privileges</CODE> is a synonym for <CODE>reload</CODE>.
The <CODE>refresh</CODE> command closes and reopens the log files and flushes
all tables.  The other <CODE>flush-*</CODE> commands perform functions similar to
<CODE>refresh</CODE>, but are more specific and may be preferable in some instances.
For example, if you want to flush just the log files, <CODE>flush-logs</CODE>
is a better choice than <CODE>refresh</CODE>.

</P>
<P>
The <CODE>shutdown</CODE> command shuts down the server. This command can be issued
only from <CODE>mysqladmin</CODE>. There is no corresponding SQL statement.

</P>
<P>
The <CODE>processlist</CODE> command displays information about the threads
executing within the server (that is, about the statements being executed by
clients associated with other accounts).
The <CODE>kill</CODE> command terminates server threads.
You can always display or kill your own threads, but you need the
<CODE>PROCESS</CODE> privilege to display threads initiated by other users and
the <CODE>SUPER</CODE> privilege to kill them.
See section <A HREF="manual.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A>. Prior to MySQL 4.0.2 when <CODE>SUPER</CODE> was
introduced, the <CODE>PROCESS</CODE> privilege controls the ability to both see and
terminate threads for other clients.

</P>
<P>
The <CODE>CREATE TEMPORARY TABLES</CODE> privilege allows the use of the keyword
<CODE>TEMPORARY</CODE> in <CODE>CREATE TABLE</CODE> statements.

</P>
<P>
The <CODE>LOCK TABLES</CODE> privilege allows the use of explicit <CODE>LOCK TABLES</CODE>
statements to lock tables for which you have the <CODE>SELECT</CODE> privilege.
This includes the use of write locks, which prevents anyone else from reading
the locked table.

</P>
<P>
The <CODE>REPLICATION CLIENT</CODE> privilege allows the use of <CODE>SHOW MASTER
STATUS</CODE> and <CODE>SHOW SLAVE STATUS</CODE>.

</P>
<P>
The <CODE>REPLICATION SLAVE</CODE> privilege should be granted to accounts that are
used by slave servers when they connect to the current server as their master.
Without this privilege, the slave cannot request updates that have been made
to databases on the master server.

</P>
<P>
The <CODE>SHOW DATABASES</CODE> privilege allows the account to see database names
by issuing the <CODE>SHOW DATABASE</CODE> statement. Accounts that do not have this
privilege see only databases for which they have some privileges, and cannot
use the statement at all if the server was started with the
<CODE>--skip-show-database</CODE> option.

</P>
<P>
It is a good idea in general to grant privileges to only those accounts
that need them, but you should exercise particular caution in granting
administrative privileges:

</P>

<UL>
<LI>

The <CODE>GRANT</CODE> privilege allows users to give their privileges to
other users.  Two users with different privileges and with the <CODE>GRANT</CODE>
privilege are able to combine privileges.

<LI>

The <CODE>ALTER</CODE> privilege may be used to subvert the privilege system
by renaming tables.

<LI>

The <CODE>FILE</CODE> privilege can be abused to read into a database table any
files that the MySQL server can read on the server host. This includes all
world-readable files and files in the server's data directory. The table
can then be accessed using <CODE>SELECT</CODE> to transfer its contents to the
client host.

<LI>

The <CODE>SHUTDOWN</CODE> privilege can be abused to deny service to other
users entirely by terminating the server.

<LI>

The <CODE>PROCESS</CODE> privilege can be used to view the plain text of
currently executing queries, including queries that set or change passwords.

<LI>

The <CODE>SUPER</CODE> privilege can be used to terminate other clients or change
how the server operates.

<LI>

Privileges granted for the <CODE>mysql</CODE> database itself can be used to
change passwords and other access privilege information.  Passwords are
stored encrypted, so a malicious user cannot simply read them to know the
plain text password.  However, a user with write access to the <CODE>user</CODE>
table <CODE>Password</CODE> column can change an account's password, and then
connect to the MySQL server using that account.

</UL>

<P>
There are some things that you cannot do with the MySQL
privilege system:

</P>

<UL>
<LI>

You cannot explicitly specify that a given user should be denied access.
That is, you cannot explicitly match a user and then refuse the connection.

<LI>

You cannot specify that a user has privileges to create or drop tables
in a database but not to create or drop the database itself.
</UL>



<H3><A NAME="Connecting" HREF="manual_toc.html#Connecting">5.4.4  Connecting to the MySQL Server</A></H3>

<P>
<A NAME="IDX527"></A>
<A NAME="IDX528"></A>
<A NAME="IDX529"></A>
<A NAME="IDX530"></A>

</P>
<P>
MySQL client programs generally expect you to specify connection
parameters when you want to access a MySQL server:

</P>

<UL>
<LI>

The name of the host where the MySQL server is running
<LI>

Your username
<LI>

Your password
</UL>

<P>
For example, the
<CODE>mysql</CODE> client can be started as follows from a command-line prompt
(indicated here by <CODE>shell&#62;</CODE>):

</P>

<PRE>
shell&#62; mysql -h host_name -u user_name -pyour_pass
</PRE>

<P>
Alternate forms of the <CODE>-h</CODE>, <CODE>-u</CODE>, and <CODE>-p</CODE> options are
<CODE>--host=host_name</CODE>, <CODE>--user=user_name</CODE>, and
<CODE>--password=your_pass</CODE>.  Note that there is <EM>no space</EM> between
<CODE>-p</CODE> or <CODE>--password=</CODE> and the password following it.

</P>
<P>
If you use a <CODE>-p</CODE> or <CODE>--password</CODE> option but do not specify the
password value, the client program will prompt you to enter the password.
The password is not displayed as you enter it.
This is more secure than giving the password on the command line.
Any user on your system may be able to see a password specified on the command
line by executing a command such as <CODE>ps auxww</CODE>.
See section <A HREF="manual.html#Password_security">5.5.6  Keeping Your Password Secure</A>.

</P>
<P>
MySQL client programs use default values for any connection parameter option
that you do not specify:

</P>

<UL>
<LI>

The default hostname is <CODE>localhost</CODE>.

<LI>

The default username is <CODE>ODBC</CODE> on Windows and your Unix login name
on Unix.

<LI>

No password is supplied if <CODE>-p</CODE> is missing.
</UL>

<P>
Thus, for a Unix user with a login name of <CODE>joe</CODE>, all of the following
commands are equivalent:

</P>

<PRE>
shell&#62; mysql -h localhost -u joe
shell&#62; mysql -h localhost
shell&#62; mysql -u joe
shell&#62; mysql
</PRE>

<P>
Other MySQL clients behave similarly.

</P>
<P>
You can specify different default values to be used when you
make a connection so that you need not enter them on the command line each
time you invoke a client program.  This can be done in a couple of ways:

</P>

<UL>
<LI>

<A NAME="IDX531"></A>
You can specify connection parameters in the <CODE>[client]</CODE> section of an
option file.  The relevant section of the file might look like this:


<PRE>
[client]
host=host_name
user=user_name
password=your_pass
</PRE>

Option files are discussed further in section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

<LI>

<A NAME="IDX532"></A>
<A NAME="IDX533"></A>
<A NAME="IDX534"></A>
<A NAME="IDX535"></A>
<A NAME="IDX536"></A>
<A NAME="IDX537"></A>
You can specify some connection parameters using environment variables.  The
host can be specified for <CODE>mysql</CODE> using <CODE>MYSQL_HOST</CODE>.  The
MySQL username can be specified using <CODE>USER</CODE> (this is for
Windows and NetWare only).  The password can be specified using
<CODE>MYSQL_PWD</CODE>,
although this is insecure; see section <A HREF="manual.html#Password_security">5.5.6  Keeping Your Password Secure</A>.
For a list of variables, see section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.
</UL>



<H3><A NAME="Connection_access" HREF="manual_toc.html#Connection_access">5.4.5  Access Control, Stage 1: Connection Verification</A></H3>

<P>
<A NAME="IDX538"></A>
<A NAME="IDX539"></A>
<A NAME="IDX540"></A>
<A NAME="IDX541"></A>

</P>
<P>
When you attempt to connect to a MySQL server, the server accepts or
rejects the connection based on your identity and whether you can
verify your identity by supplying the correct password.  If not, the server
denies access to you completely.  Otherwise, the server accepts the
connection, then enters Stage 2 and waits for requests.

</P>
<P>
Your identity is based on two pieces of information:

</P>

<UL>
<LI>

The client host from which you connect

<LI>

Your MySQL username
</UL>

<P>
Identity checking is performed using the three <CODE>user</CODE> table scope columns
(<CODE>Host</CODE>, <CODE>User</CODE>, and <CODE>Password</CODE>).  The server accepts the
connection only if the <CODE>Host</CODE> and <CODE>User</CODE> columns in some
<CODE>user</CODE> table record match the client hostname and username,
and the client supplies the password specified in that record.

</P>
<P>
<CODE>Host</CODE> values in the <CODE>user</CODE> table may be specified as follows:

</P>

<UL>
<LI>

A <CODE>Host</CODE> value may be a hostname or an IP number, or <CODE>'localhost'</CODE>
to indicate the local host.

<LI>

<A NAME="IDX542"></A>
You can use the wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> in <CODE>Host</CODE>
column values.
These have the same meaning as for pattern-matching operations
performed with the <CODE>LIKE</CODE> operator.
For example, a <CODE>Host</CODE> value of <CODE>'%'</CODE> matches any hostname, whereas a
value of <CODE>'%.mysql.com'</CODE> matches any host in the <CODE>mysql.com</CODE> domain.

<LI>

<A NAME="IDX543"></A>
As of MySQL Version 3.23, for <CODE>Host</CODE> values specified as
IP numbers, you can specify a netmask indicating how many address bits to
use for the network number. For example:


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON db.*
    -&#62; TO david@'192.58.197.0/255.255.255.0';
</PRE>

This allows <CODE>david</CODE> to connect from any client host having an IP number
<CODE>client_ip</CODE> for which the following condition is true:


<PRE>
client_ip &#38; netmask = host_ip
</PRE>

That is, for the <CODE>GRANT</CODE> statement just shown:


<PRE>
client_ip &#38; 255.255.255.0 = 192.58.197.0
</PRE>

IP numbers that satisfy this condition and can connect to the
MySQL server are those that lie in the range from <CODE>192.58.197.0</CODE> to
<CODE>192.58.197.255</CODE>.

<LI>

A blank <CODE>Host</CODE> value in a <CODE>db</CODE> table record means that its
privileges should be combined with those in the entry in the <CODE>host</CODE>
table that matches the client hostname.  The privileges are combined
using an AND (intersection) operation, not OR (union).  You can find more
information about the <CODE>host</CODE> table in section <A HREF="manual.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A>.

A blank <CODE>Host</CODE> value in the other grant tables is the same as <CODE>'%'</CODE>.

</UL>

<P>
Because you can use IP wildcard values in the <CODE>Host</CODE> column
(for example, <CODE>'144.155.166.%'</CODE> to match every host on a
subnet), someone could try to exploit this capability by naming a host
<CODE>144.155.166.somewhere.com</CODE>.  To foil such attempts, MySQL disallows
matching on hostnames that start with digits and a dot. Thus, if you have
a host named something like <CODE>1.2.foo.com</CODE>, its name will never match
the <CODE>Host</CODE> column of the grant tables.  An IP wildcard value can
match only IP numbers, not hostnames.

</P>
<P>
<A NAME="IDX544"></A>
In the <CODE>User</CODE> column, wildcard characters are not allowed, but you can
specify a blank value, which matches any name.  If the <CODE>user</CODE> table
entry that matches an incoming connection has a blank username, the user is
considered to be an anonymous user with no name, not a user with the
name that the client actually specified.  This means that a blank username
is used for all further access checking for the duration of the connection
(that is, during Stage 2).

</P>
<P>
The <CODE>Password</CODE> column can be blank.  This is not a wildcard and does
not mean that any password matches. It means that the user must connect
without specifying a password.

</P>
<P>
<A NAME="IDX545"></A>
Non-blank <CODE>Password</CODE> values in the <CODE>user</CODE> table represent
encrypted passwords.  MySQL does not store passwords in plaintext form for
anyone to see.  Rather, the password supplied by a user who is attempting to
connect is encrypted (using the <CODE>PASSWORD()</CODE> function). The encrypted
password then is used during the connection process when checking whether
the password is correct. (This is done without the encrypted password ever
traveling over the connection.)  Note that from MySQL's point of view, the
encrypted password is the REAL password, so you should not give anyone
access to it!  In particular, don't give non-administrative users read
access to the tables in the <CODE>mysql</CODE> database!

</P>
<P>
From version 4.1 on, MySQL employs a stronger authentication method that has
better password protection during the connection process than in earlier
versions. It is secure even if TCP/IP packets are sniffed or the
<CODE>mysql</CODE> database is captured.  Password encryption is discussed further
in section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A>.

</P>
<P>
The following examples show how various combinations of <CODE>Host</CODE> and
<CODE>User</CODE> values in the <CODE>user</CODE> table apply to incoming
connections:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>Host</CODE> <STRONG>Value</STRONG> </TD><TD> <CODE>User</CODE> <STRONG>Value</STRONG> </TD><TD> <STRONG>Connections Matched by Entry</STRONG>
</TD></TR>
<TR><TD><CODE>'thomas.loc.gov'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from <CODE>thomas.loc.gov</CODE>
</TD></TR>
<TR><TD><CODE>'thomas.loc.gov'</CODE> </TD><TD> <CODE>''</CODE> </TD><TD> Any user, connecting from <CODE>thomas.loc.gov</CODE>
</TD></TR>
<TR><TD><CODE>'%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host
</TD></TR>
<TR><TD><CODE>'%'</CODE> </TD><TD> <CODE>''</CODE> </TD><TD> Any user, connecting from any host
</TD></TR>
<TR><TD><CODE>'%.loc.gov'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host in the <CODE>loc.gov</CODE> domain
</TD></TR>
<TR><TD><CODE>'x.y.%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from <CODE>x.y.net</CODE>, <CODE>x.y.com</CODE>, <CODE>x.y.edu</CODE>, and so on. (this is probably not useful)
</TD></TR>
<TR><TD><CODE>'144.155.166.177'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from the host with IP address <CODE>144.155.166.177</CODE>
</TD></TR>
<TR><TD><CODE>'144.155.166.%'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> <CODE>fred</CODE>, connecting from any host in the <CODE>144.155.166</CODE> class C subnet
</TD></TR>
<TR><TD><CODE>'144.155.166.0/255.255.255.0'</CODE> </TD><TD> <CODE>'fred'</CODE> </TD><TD> Same as previous example
</TD></TR>
</TABLE>

<P>
It is possible for the client hostname and username of
an incoming connection to match more than one entry in the
<CODE>user</CODE> table.  The preceding set of examples demonstrates this:
Several of the entries shown match a connection from <CODE>thomas.loc.gov</CODE> by
<CODE>fred</CODE>.

</P>
<P>
When multiple matches are possible, the server must determine which of them to
use.  It resolves this issue as follows:

</P>

<UL>
<LI>

Whenever the server reads the <CODE>user</CODE> table into memory, it sorts the
entries.
<LI>

When a client attempts to connect, the server looks through the entries in
sorted order.
<LI>

The server uses the first entry that matches the client hostname and username.
</UL>

<P>
To see how this works, suppose that the <CODE>user</CODE> table looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| %         | root     | ...
| %         | jeffrey  | ...
| localhost | root     | ...
| localhost |          | ...
+-----------+----------+-
</PRE>

<P>
When the server reads in the table, it orders the entries with the
most-specific <CODE>Host</CODE> values first.  Literal hostnames and IP numbers
are the most specific. The pattern <CODE>'%'</CODE> means ``any host'' and is
least specific.  Entries with the same <CODE>Host</CODE> value are ordered with
the most-specific <CODE>User</CODE> values first (a blank <CODE>User</CODE> value means
``any user'' and is least specific). For the <CODE>user</CODE> table just shown,
the result after sorting looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| localhost | root     | ...
| localhost |          | ...
| %         | jeffrey  | ...
| %         | root     | ...
+-----------+----------+-
</PRE>

<P>
<A NAME="IDX546"></A>
<A NAME="IDX547"></A>
<A NAME="IDX548"></A>
When a client attempts to connect, the server looks through the sorted entries
and uses the first match found.  For a connection from <CODE>localhost</CODE> by
<CODE>jeffrey</CODE>, two of the entries in the table match:
the one with <CODE>Host</CODE> and <CODE>User</CODE> values of <CODE>'localhost'</CODE> and
<CODE>''</CODE>, and the one with values of <CODE>'%'</CODE> and <CODE>'jeffrey'</CODE>.
The <CODE>'localhost'</CODE> entry appears first in sorted order, so that is the one
the server uses.

</P>
<P>
Here is another example.  Suppose that the <CODE>user</CODE> table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| %              | jeffrey  | ...
| thomas.loc.gov |          | ...
+----------------+----------+-
</PRE>

<P>
The sorted table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| thomas.loc.gov |          | ...
| %              | jeffrey  | ...
+----------------+----------+-
</PRE>

<P>
A connection by <CODE>jeffrey</CODE> from <CODE>thomas.loc.gov</CODE> is matched by the
first entry, whereas a connection by <CODE>jeffrey</CODE> from <CODE>whitehouse.gov</CODE>
is matched by the second.

</P>
<P>
It is a common misconception to think that for a given username, all entries
that explicitly name that user will be used first when the server attempts to
find a match for the connection.  This is simply not true.  The previous
example illustrates this, where a connection from <CODE>thomas.loc.gov</CODE> by
<CODE>jeffrey</CODE> is first matched not by the entry containing <CODE>'jeffrey'</CODE>
as the <CODE>User</CODE> column value, but by the entry with no username!
(As a result, <CODE>jeffrey</CODE> will be authenticated as an anonymous user, even
though he specified a username when connecting.)

</P>
<P>
If you are able to connect to the server, but your privileges are not
what you expect, you probably are being authenticated as some other
account.  To find out what account the server used to authenticate
you, use the <CODE>CURRENT_USER()</CODE> function. It returns a value in
<CODE>user_name@host_name</CODE> format that indicates the <CODE>User</CODE>
and <CODE>Host</CODE> values from the matching <CODE>user</CODE> table record.
Suppose that <CODE>jeffrey</CODE> connects and issues the following query:

</P>

<PRE>
mysql&#62; SELECT CURRENT_USER();
+----------------+
| CURRENT_USER() |
+----------------+
| @localhost     |
+----------------+
</PRE>

<P>
The result shown here indicates that the matching <CODE>user</CODE> table entry
had a blank <CODE>User</CODE> column value.  In other words, the server is
treating <CODE>jeffrey</CODE> as an anonymous user.

</P>
<P>
The <CODE>CURRENT_USER()</CODE> function is available as of MySQL 4.0.6.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.
Another thing you can do to diagnose authentication problems is to print
out the <CODE>user</CODE> table and sort it by hand to see where the first
match is being made.

</P>



<H3><A NAME="Request_access" HREF="manual_toc.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A></H3>

<P>
Once you establish a connection, the server enters Stage 2 of access
control.  For each request that comes in on the connection, the server
determines what operation you want to perform, then checks whether you have
sufficient privileges to do so.  This is where the privilege columns in the
grant tables come into play.  These privileges can come from any of the
<CODE>user</CODE>, <CODE>db</CODE>, <CODE>host</CODE>, <CODE>tables_priv</CODE>, or
<CODE>columns_priv</CODE> tables.  (You may find it helpful to refer to
section <A HREF="manual.html#Privileges">5.4.2  How the Privilege System Works</A>, which lists the columns present in each of the grant
tables.)

</P>
<P>
The <CODE>user</CODE> table grants privileges that are assigned to you on a global
basis and that apply no matter what the current database is.  For example, if
the <CODE>user</CODE> table grants you the <CODE>DELETE</CODE> privilege, you can
delete rows from any database on the server host!  In other words,
<CODE>user</CODE> table privileges are superuser privileges.  It is wise to grant
privileges in the <CODE>user</CODE> table only to superusers such as
database administrators.  For other users, you should leave the privileges
in the <CODE>user</CODE> table set to <CODE>'N'</CODE> and grant privileges at more
specific levels only. You can grant privileges for particular databases,
tables, or columns.

</P>
<P>
<A NAME="IDX549"></A>
<A NAME="IDX550"></A>
<A NAME="IDX551"></A>
The <CODE>db</CODE> and <CODE>host</CODE> tables grant database-specific privileges.
Values in the scope columns of these tables can take the following forms:

</P>

<UL>
<LI>

The wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> can be used in the <CODE>Host</CODE>
and <CODE>Db</CODE> columns of either table.  These have the same meaning as for
pattern-matching operations performed with the <CODE>LIKE</CODE> operator.  If you
want to use either character literally when granting privileges, you must
escape it with a backslash.  For example, to include <SAMP>`_'</SAMP> character
as part of a database name, specify it as <SAMP>`\_'</SAMP> in the <CODE>GRANT</CODE>
statement.

<LI>

A <CODE>'%'</CODE> <CODE>Host</CODE> value in the <CODE>db</CODE> table means ``any host.'' A
blank <CODE>Host</CODE> value in the <CODE>db</CODE> table means ``consult the
<CODE>host</CODE> table for further information'' (a process that is described later
in this section).

<LI>

A <CODE>'%'</CODE> or blank <CODE>Host</CODE> value in the <CODE>host</CODE> table means ``any
host.''

<LI>

A <CODE>'%'</CODE> or blank <CODE>Db</CODE> value in either table means ``any database.''

<LI>

A blank <CODE>User</CODE> value in either table matches the anonymous user.
</UL>

<P>
<A NAME="IDX552"></A>
<A NAME="IDX553"></A>
<A NAME="IDX554"></A>
<A NAME="IDX555"></A>

</P>
<P>
The server reads in and sorts the <CODE>db</CODE> and <CODE>host</CODE> tables at the
same time that it reads the <CODE>user</CODE> table.  The server sorts the <CODE>db</CODE>
table based on the <CODE>Host</CODE>, <CODE>Db</CODE>, and <CODE>User</CODE> scope columns,
and sorts the <CODE>host</CODE> table based on the <CODE>Host</CODE> and <CODE>Db</CODE>
scope columns.  As with the <CODE>user</CODE> table, sorting puts the
most-specific values first and least-specific values last, and when the
server looks for matching entries, it uses the first match that it finds.

</P>
<P>
<A NAME="IDX556"></A>
<A NAME="IDX557"></A>

</P>
<P>
The <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables grant table-specific and
column-specific privileges.  Values in the scope columns of these tables can
take the following form:

</P>

<UL>
<LI>

The wildcard characters <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> can be used in the <CODE>Host</CODE>
column of either table.  These have the same meaning as for pattern-matching
operations performed with the <CODE>LIKE</CODE> operator.

<LI>

A <CODE>'%'</CODE> or blank <CODE>Host</CODE> value in either table means ``any host.''

<LI>

The <CODE>Db</CODE>, <CODE>Table_name</CODE>, and <CODE>Column_name</CODE> columns cannot contain
wildcards or be blank in either table.
</UL>

<P>
The server sorts the <CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables based
on the <CODE>Host</CODE>, <CODE>Db</CODE>, and <CODE>User</CODE> columns.  This is similar to
<CODE>db</CODE> table sorting, but simpler because only the <CODE>Host</CODE> column can
contain wildcards.

</P>
<P>
The request verification process is described here.  (If you are familiar
with the access-checking source code, you will notice that the description
here differs slightly from the algorithm used in the code.  The description
is equivalent to what the code actually does; it differs only to make the
explanation simpler.)

</P>
<P>
For requests that require administrative privileges such as <CODE>SHUTDOWN</CODE> or
<CODE>RELOAD</CODE>, the
server checks only the <CODE>user</CODE> table entry because that is the only table
that specifies administrative privileges.  Access is granted if the entry
allows the requested operation and denied otherwise.  For example, if you
want to execute <CODE>mysqladmin shutdown</CODE> but your <CODE>user</CODE> table entry
doesn't grant the <CODE>SHUTDOWN</CODE> privilege to you, the server denies access
without even checking the <CODE>db</CODE> or <CODE>host</CODE> tables.  (They
contain no <CODE>Shutdown_priv</CODE> column, so there is no need to do so.)

</P>
<P>
For database-related requests (<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, and so on), the
server first checks the user's global (superuser) privileges by looking in
the <CODE>user</CODE> table entry.  If the entry allows the requested operation,
access is granted.  If the global privileges in the <CODE>user</CODE> table are
insufficient, the server determines the user's database-specific privileges
by checking the <CODE>db</CODE> and <CODE>host</CODE> tables:

</P>

<OL>
<LI>

The server looks in the <CODE>db</CODE> table for a match on the <CODE>Host</CODE>,
<CODE>Db</CODE>, and <CODE>User</CODE> columns.  The <CODE>Host</CODE> and <CODE>User</CODE> columns are
matched to the connecting user's hostname and MySQL username.  The
<CODE>Db</CODE> column is matched to the database that the user wants to access.  If
there is no entry for the <CODE>Host</CODE> and <CODE>User</CODE>, access is denied.

<LI>

If there is a matching <CODE>db</CODE> table entry and its <CODE>Host</CODE> column is
not blank, that entry defines the user's database-specific privileges.

<LI>

If the matching <CODE>db</CODE> table entry's <CODE>Host</CODE> column is blank, it
signifies that the <CODE>host</CODE> table enumerates which hosts should be allowed
access to the database.  In this case, a further lookup is done in the
<CODE>host</CODE> table to find a match on the <CODE>Host</CODE> and <CODE>Db</CODE> columns.
If no <CODE>host</CODE> table entry matches, access is denied.  If there is a
match, the user's database-specific privileges are computed as the
intersection (<STRONG>not</STRONG> the union!) of the privileges in the <CODE>db</CODE> and
<CODE>host</CODE> table entries; that is, the privileges that are <CODE>'Y'</CODE> in both
entries.  (This way you can grant general privileges in the <CODE>db</CODE> table
entry and then selectively restrict them on a host-by-host basis using the
<CODE>host</CODE> table entries.)
</OL>

<P>
After determining the database-specific privileges granted by the <CODE>db</CODE>
and <CODE>host</CODE> table entries, the server adds them to the global privileges
granted by the <CODE>user</CODE> table.  If the result allows the requested
operation, access is granted.  Otherwise, the server successively
checks the user's table and column privileges in the <CODE>tables_priv</CODE>
and <CODE>columns_priv</CODE> tables, adds those to the user's privileges,
and allows or denies access based on the result.

</P>
<P>
Expressed in boolean terms, the preceding description of how a user's
privileges are calculated may be summarized like this:

</P>

<PRE>
global privileges
OR (database privileges AND host privileges)
OR table privileges
OR column privileges
</PRE>

<P>
It may not be apparent why, if the global <CODE>user</CODE> entry privileges are
initially found to be insufficient for the requested operation, the server
adds those privileges to the database, table, and column privileges
later. The reason is that a request might require more than one type of
privilege.  For example, if you execute an <CODE>INSERT INTO ...  SELECT</CODE>
statement, you need both the <CODE>INSERT</CODE> and the <CODE>SELECT</CODE> privileges.
Your privileges might be such that the <CODE>user</CODE> table entry grants one
privilege and the <CODE>db</CODE> table entry grants the other.  In this case, you
have the necessary privileges to perform the request, but the server cannot
tell that from either table by itself; the privileges granted by the entries
in both tables must be combined.

</P>
<P>
<A NAME="IDX558"></A>
<A NAME="IDX559"></A>

</P>
<P>
The <CODE>host</CODE> table is not affected by the <CODE>GRANT</CODE> or <CODE>REVOKE</CODE>
statements, so it is unused in most MySQL installations. If you modify
it directly, you can use it for some specialized purposes, such as to to
maintain a list of secure servers.  For example, at TcX, the <CODE>host</CODE>
table contains a list of all machines on the local network. These are
granted all privileges.

</P>
<P>
You can also use the <CODE>host</CODE> table to indicate hosts that are <STRONG>not</STRONG>
secure.  Suppose that you have a machine <CODE>public.your.domain</CODE> that is located
in a public area that you do not consider secure.  You can allow access to
all hosts on your network except that machine by using <CODE>host</CODE> table
entries
like this:

</P>

<PRE>
+--------------------+----+-
| Host               | Db | ...
+--------------------+----+-
| public.your.domain | %  | ... (all privileges set to 'N')
| %.your.domain      | %  | ... (all privileges set to 'Y')
+--------------------+----+-
</PRE>

<P>
<A NAME="IDX560"></A>
<A NAME="IDX561"></A>
<A NAME="IDX562"></A>
<A NAME="IDX563"></A>

</P>
<P>
Naturally, you should always test your entries in the grant tables (for
example, by using <CODE>mysqlaccess</CODE>) to make sure that your access privileges are
actually set up the way you think they are.

</P>



<H3><A NAME="Privilege_changes" HREF="manual_toc.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A></H3>

<P>
When <CODE>mysqld</CODE> starts, all grant table contents are read into memory and
become effective for access control at that point.

</P>
<P>
When the server reloads the grant tables, privileges for
existing client connections are affected as follows:

</P>

<UL>
<LI>

Table and column privilege changes take effect with the client's next
request.

<LI>

Database privilege changes take effect at the next <CODE>USE db_name</CODE>
statement.

<LI>

Changes to global privileges and passwords take effect the next time
the client connects.
</UL>

<P>
If you modify the grant tables using <CODE>GRANT</CODE>, <CODE>REVOKE</CODE>, or
<CODE>SET PASSWORD</CODE>, the server notices these changes and reloads the
grant tables into memory again immediately.

</P>
<P>
If you modify the grant tables directly using statements such as
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, or <CODE>DELETE</CODE>, your changes have
no effect on privilege checking until you either restart the server
or tell it to reload the tables.  To reload the grant tables manually,
issue a <CODE>FLUSH PRIVILEGES</CODE> statement or execute a <CODE>mysqladmin
flush-privileges</CODE> or <CODE>mysqladmin reload</CODE> command.

</P>
<P>
If you change the grant tables directly but forget to reload them, your
changes will have <EM>no effect</EM> until you restart the server.  This may
leave you wondering why your changes don't seem to make any difference!

</P>



<H3><A NAME="Access_denied" HREF="manual_toc.html#Access_denied">5.4.8  Causes of <CODE>Access denied</CODE> Errors</A></H3>

<P>
If you encounter problems when you try to connect to the
MySQL server, the following items describe some courses of
action you can take to correct the problem.

</P>

<UL>
<LI>

Make sure that the server is running. If it is not running, you cannot connect to it.
For example, if you attempt to connect to the server and see a message such
as one of those following, one cause might be that the server is not running:


<PRE>
shell&#62; mysql
ERROR 2003: Can't connect to MySQL server on 'host_name' (111)
shell&#62; mysql
ERROR 2002: Can't connect to local MySQL server through socket
'/tmp/mysql.sock' (111)
</PRE>

It might also be that the server is running, but you are trying to connect
using a TCP/IP port, named pipe, or Unix socket file different from those
on which the server is listening. To correct this when you invoke a client
program, specify a <CODE>--port</CODE> option to indicate the proper port, or a
<CODE>--socket</CODE> option to indicate the proper named pipe or Unix socket
file.

<LI>

The grant tables must be properly set up so that the server can use them for
access control.  For installations on Windows using a binary distribution
or on Linux using a server RPM distribution, the installation process
initializes the <CODE>mysql</CODE> database containing the grant tables. For
other MySQL installation types, you should initialize the grant tables
manually by running the <CODE>mysql_install_db</CODE> script.
See section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.

One way to determine whether you need to initialize the grant tables is to
look for a <TT>`mysql'</TT> directory under the data directory. (The data
directory normally is named <TT>`data'</TT> or <TT>`var'</TT> and is located under
your MySQL installation directory.)  Make sure that you have a file named
<TT>`user.MYD'</TT> in the <TT>`mysql'</TT> database directory.  If you do not,
execute the <CODE>mysql_install_db</CODE> script.  After running this script and
starting the server, test the initial privileges by executing this command:


<PRE>
shell&#62; mysql -u root test
</PRE>

The server should let you connect without error.

<LI>

After a fresh installation, you should connect to the server and set up
your users and their access permissions:


<PRE>
shell&#62; mysql -u root mysql
</PRE>

The server should let you connect because the MySQL <CODE>root</CODE> user
has no password initially.  That is also a security risk, so setting the
password for the
<CODE>root</CODE> accounts is something you should do while you're setting up
your other MySQL users.
For instructions on setting the initial passwords, see section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.

<LI>

<A NAME="IDX564"></A>
If you have updated an existing MySQL installation to a newer version, did
you run the <CODE>mysql_fix_privilege_tables</CODE> script?  If not, do so. The
structure of the grant tables changes occasionally when new capabilities are
added, so after an upgrade you should always make sure that your tables have
the current structure. For instructions, see section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

<LI>

If a client program receives the following error message when it tries
to connect, it means that the server expects passwords in a newer format
than the client is capable of generating:


<PRE>
shell&#62; mysql
Client does not support authentication protocol requested
by server; consider upgrading MySQL client
</PRE>

For instructions on how to deal with this, see section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A>.

<LI>

If you try to connect as <CODE>root</CODE> and get the following error,
it means that you don't have an entry in the <CODE>user</CODE> table with a
<CODE>User</CODE> column value of <CODE>'root'</CODE> and that <CODE>mysqld</CODE> cannot
resolve the hostname for your client:


<PRE>
Access denied for user: '@unknown' to database mysql
</PRE>

In this case, you must restart the server with the <CODE>--skip-grant-tables</CODE>
option and edit your <TT>`/etc/hosts'</TT> or <TT>`\windows\hosts'</TT> file to
add an entry for your host.

<LI>

<A NAME="IDX565"></A>
<A NAME="IDX566"></A>
<A NAME="IDX567"></A>
<A NAME="IDX568"></A>
Remember that client programs will use connection parameters specified
in option files or environment variables.  If a client program seems to
be sending incorrect default connection parameters when you don't specify
them on the command line, check your environment and any applicable option
files. For example, if you get <CODE>Access denied</CODE> when you run a client
without any options, make sure that you haven't specified an old password in
any of your option files!

You can suppress the use of option files with the <CODE>--no-defaults</CODE>
option as follows:


<PRE>
shell&#62; mysqladmin --no-defaults -u root ver
</PRE>

The option files that clients use are listed in section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.
Environment variables are listed in section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

<LI>

If you get the following error, it means that you are using an incorrect
<CODE>root</CODE> password:


<PRE>
shell&#62; mysqladmin -u root -pxxxx ver
Access denied for user: 'root@localhost' (Using password: YES)
</PRE>

If the preceding error occurs even when you haven't specified a password,
it means that you have an incorrect password listed in some option
file. Try the <CODE>--no-defaults</CODE> option as described in the previous item.

For information on changing passwords, see section <A HREF="manual.html#Passwords">5.5.5  Assigning Account Passwords</A>.

If you have lost the <CODE>root</CODE> password, you can restart <CODE>mysqld</CODE>
with <CODE>--skip-grant-tables</CODE> to change the password.
See section <A HREF="manual.html#Resetting_permissions">A.4.1  How to Reset the Root Password</A>.

<LI>

If you change a password by using <CODE>SET PASSWORD</CODE>, <CODE>INSERT</CODE>, or
<CODE>UPDATE</CODE>, you must encrypt the password using the <CODE>PASSWORD()</CODE>
function.  If you do not use <CODE>PASSWORD()</CODE> for these statements,
the password will not work. For example, the following statement sets a
password, but fails to encrypt it, so the user will not be able to connect
afterward:


<PRE>
mysql&#62; SET PASSWORD FOR 'abe'@'host_name' = 'eagle';
</PRE>

Instead, set the password like this:


<PRE>
mysql&#62; SET PASSWORD FOR 'abe'@'host_name' = PASSWORD('eagle');
</PRE>

The <CODE>PASSWORD()</CODE> function is unnecessary when you specify a password
using the <CODE>GRANT</CODE> statement or the <CODE>mysqladmin password</CODE> command,
both of which automatically use <CODE>PASSWORD()</CODE> to encrypt the password.
See section <A HREF="manual.html#Passwords">5.5.5  Assigning Account Passwords</A>.

<LI>

<CODE>localhost</CODE> is a synonym for your local hostname, and is also the
default host to which clients try to connect if you specify no host
explicitly.  However, connections to <CODE>localhost</CODE> on Unix systems
do not work if you are using a MySQL version older than 3.23.27 that uses
MIT-pthreads: <CODE>localhost</CODE> connections are made using Unix socket files,
which were not supported by MIT-pthreads at that time.

To avoid this problem on such systems, you can use a <CODE>--host=127.0.0.1</CODE>
option to name the server host explicitly.  This will make a TCP/IP
connection to the local <CODE>mysqld</CODE> server. You can also use TCP/IP by
specifying a <CODE>--host</CODE> option that uses the actual hostname of the
local host.  In this case, the hostname must be specified in a <CODE>user</CODE>
table entry on the server host, even though you are running the client
program on the same host as the server.

<LI>

If you get an <CODE>Access denied</CODE> error when trying to connect to the
database with <CODE>mysql -u user_name</CODE>, you may have a problem
with the <CODE>user</CODE> table. Check this by executing <CODE>mysql -u root
mysql</CODE> and issuing this SQL statement:


<PRE>
mysql&#62; SELECT * FROM user;
</PRE>

The result should include an entry with the <CODE>Host</CODE> and <CODE>User</CODE>
columns matching your computer's hostname and your MySQL username.

<LI>

The <CODE>Access denied</CODE> error message will tell you who you are trying
to log in as, the client host from which you are trying to connect, and whether
or not you were using a password. Normally, you should have one entry in
the <CODE>user</CODE> table that exactly matches the hostname and username
that were given in the error message. For example, if you get an error
message that contains <CODE>Using password: NO</CODE>, it means that you
tried to log in without an password.

<LI>

If the following error occurs when you try to connect from a host other than
the one on which the MySQL server is running, it means that there is no row
in the <CODE>user</CODE> table with a <CODE>Host</CODE> value that matches the client
host:


<PRE>
Host ... is not allowed to connect to this MySQL server
</PRE>

You can fix this by invoking the command-line tool <CODE>mysql</CODE> on the server
host and setting up an account for the combination of client hostname and
username that you are using when trying to connect.

If you don't know the IP number
or hostname of the machine from which you are connecting, you should put
an entry with <CODE>'%'</CODE> as the <CODE>Host</CODE> column value in the <CODE>user</CODE>
table and restart <CODE>mysqld</CODE> with the <CODE>--log</CODE> option on the server
machine.  After trying to connect from the client machine, the information
in the MySQL log will indicate how you really did connect.  (Then replace
the <CODE>'%'</CODE> in the <CODE>user</CODE> table entry with the actual hostname
that shows up in the log.  Otherwise, you'll have a system that is insecure
because it allows connections from any host for the given username.)

On Linux, another reason that this error might occur is that you are using
a binary MySQL version that is compiled with a different version of the
<CODE>glibc</CODE> library than the one you are using.  In this case, you should
either upgrade your operating system or <CODE>glibc</CODE>, or download a source
distribution of MySQL version and compile it yourself.  A source RPM is
normally trivial to compile and install, so this isn't a big problem.

<LI>

If you specify a hostname when trying to connect, but get an error message
where the hostname is not shown or is an IP number,
it means that the MySQL server got an error when trying to resolve the
IP number of the client host to a name:


<PRE>
shell&#62; mysqladmin -u root -pxxxx -h some-hostname ver
Access denied for user: 'root@' (Using password: YES)
</PRE>

This indicates a DNS problem.  To fix it, execute <CODE>mysqladmin
flush-hosts</CODE> to reset the internal DNS hostname cache. See section <A HREF="manual.html#DNS">7.5.5  How MySQL Uses DNS</A>.

Some permanent solutions are:


<UL>
<LI>

Try to find out what is wrong with your DNS server and fix it.

<LI>

Specify IP numbers rather than hostnames in the MySQL grant tables.

<LI>

Put an entry for the client machine name in <CODE>/etc/hosts</CODE>.

<LI>

Start <CODE>mysqld</CODE> with the <CODE>--skip-name-resolve</CODE> option.

<LI>

Start <CODE>mysqld</CODE> with the <CODE>--skip-host-cache</CODE> option.

<LI>

On Unix, if you are running the server and the client on the same machine,
connect to <CODE>localhost</CODE>. Unix connections to <CODE>localhost</CODE> use a Unix
socket file rather than TCP/IP.

<LI>

On Windows, if you are running the server and the client on the same machine
and the server supports named pipe connections, connect to the hostname
<CODE>.</CODE> (period). Connections to <CODE>.</CODE> use a named pipe rather than
TCP/IP.
</UL>

<LI>

If <CODE>mysql -u root test</CODE> works but <CODE>mysql -h your_hostname -u root
test</CODE> results in <CODE>Access denied</CODE> (where <CODE>your_hostname</CODE> is the
actual hostname of the local host), you may not have the correct name
for your host in the <CODE>user</CODE> table.  A common problem here is that the
<CODE>Host</CODE> value in the user table entry specifies an unqualified hostname,
but your system's name resolution routines return a fully qualified domain
name (or vice versa).  For example, if you have an entry with host
<CODE>'tcx'</CODE> in the <CODE>user</CODE> table, but your DNS tells MySQL that
your hostname is <CODE>'tcx.subnet.se'</CODE>, the entry will not work. Try adding
an entry to the <CODE>user</CODE> table that contains the IP number of your host as
the <CODE>Host</CODE> column value.  (Alternatively, you could add an entry to the
<CODE>user</CODE> table with a <CODE>Host</CODE> value that contains a wildcard; for
example, <CODE>'tcx.%'</CODE>.  However, use of hostnames ending with <SAMP>`%'</SAMP> is
<STRONG>insecure</STRONG> and is <STRONG>not</STRONG> recommended!)

<LI>

If <CODE>mysql -u user_name test</CODE> works but <CODE>mysql -u user_name
other_db_name</CODE> doesn't work, you have not granted database access for
<CODE>other_db_name</CODE> to the given user.

<LI>

If <CODE>mysql -u user_name</CODE> works when executed on the server host, but
<CODE>mysql -h host_name -u user_name</CODE> doesn't work when executed on a
remote client host, you have not enabled access to the server for the given
username from the remote host.

<LI>

If you can't figure out why you get <CODE>Access denied</CODE>, remove from the
<CODE>user</CODE> table all entries that have <CODE>Host</CODE> values containing
wildcards (entries that contain <SAMP>`%'</SAMP> or <SAMP>`_'</SAMP>).  A very common error
is to insert a new entry with <CODE>Host</CODE>=<CODE>'%'</CODE> and
<CODE>User</CODE>=<CODE>'some user'</CODE>, thinking that this will allow you to specify
<CODE>localhost</CODE> to connect from the same machine.  The reason that this
doesn't work is that the default privileges include an entry with
<CODE>Host</CODE>=<CODE>'localhost'</CODE> and <CODE>User</CODE>=<CODE>''</CODE>.  Because that entry
has a <CODE>Host</CODE> value <CODE>'localhost'</CODE> that is more specific than
<CODE>'%'</CODE>, it is used in preference to the new entry when connecting from
<CODE>localhost</CODE>!  The correct procedure is to insert a second entry with
<CODE>Host</CODE>=<CODE>'localhost'</CODE> and <CODE>User</CODE>=<CODE>'some_user'</CODE>, or to
delete the entry with <CODE>Host</CODE>=<CODE>'localhost'</CODE> and
<CODE>User</CODE>=<CODE>''</CODE>.
After deleting the entry, remember to issue a <CODE>FLUSH PRIVILEGES</CODE>
statement to reload the grant tables.

<LI>

If you get the following error, you may have a problem with the <CODE>db</CODE> or
<CODE>host</CODE> table:


<PRE>
Access to database denied
</PRE>

If the entry selected from the <CODE>db</CODE> table has an empty value in the
<CODE>Host</CODE> column, make sure that there are one or more corresponding entries in
the <CODE>host</CODE> table specifying which hosts the <CODE>db</CODE> table entry
applies to.

<LI>

If you are able to connect to the MySQL server, but get an <CODE>Access
denied</CODE> message whenever you issue a <CODE>SELECT ...  INTO OUTFILE</CODE> or
<CODE>LOAD DATA INFILE</CODE> statement, your entry in the <CODE>user</CODE> table
doesn't have the <CODE>FILE</CODE> privilege enabled.

<LI>

If you change the grant tables directly (for example, by using <CODE>INSERT</CODE>,
<CODE>UPDATE</CODE>, or <CODE>DELETE</CODE> statements) and your changes seem to be
ignored, remember that you must issue a <CODE>FLUSH PRIVILEGES</CODE> statement
or execute a <CODE>mysqladmin flush-privileges</CODE> command to cause the server
to re-read the privilege tables. Otherwise, your changes have no effect
until the next time the server is restarted.  Remember that after you set
the <CODE>root</CODE> password with an <CODE>UPDATE</CODE> command, you won't need
to specify the new password until after you flush the privileges, because
the server won't know you've changed the password yet!

<LI>

If your privileges seem to have changed in the middle of a session, it may
be that a MySQL administrator has changed them.  Reloading the grant tables
affects new client connections, but it also affects existing connections
as indicated in section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A>.

<LI>

If you have access problems with a Perl, PHP, Python, or ODBC program, try to
connect to the server with <CODE>mysql -u user_name db_name</CODE> or <CODE>mysql
-u user_name -pyour_pass db_name</CODE>.  If you are able to connect using the
<CODE>mysql</CODE> client, the problem lies with your program, not with the
access privileges.  (Note that there is no space between <CODE>-p</CODE> and the
password; you can also use the <CODE>--password=your_pass</CODE> syntax to specify
the password. If you use the <CODE>-p</CODE> option alone, MySQL will
prompt you for the password.)

<LI>

For testing, start the <CODE>mysqld</CODE> server with the
<CODE>--skip-grant-tables</CODE> option.  Then you can change the MySQL
grant tables and use the <CODE>mysqlaccess</CODE> script to check whether
your modifications have the desired effect.  When you are satisfied with your
changes, execute <CODE>mysqladmin flush-privileges</CODE> to tell the <CODE>mysqld</CODE>
server to start using the new grant tables.  (Reloading the
grant tables overrides the <CODE>--skip-grant-tables</CODE> option.  This allows
you to tell the server to begin using the grant tables again without stopping
and restarting it.)

<LI>

If everything else fails, start the <CODE>mysqld</CODE> server with a debugging
option (for example, <CODE>--debug=d,general,query</CODE>). This will print host and
user information about attempted connections, as well as information about
each command issued. See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

<LI>

If you have any other problems with the MySQL grant tables and
feel you must post the problem to the mailing list, always provide a
dump of the MySQL grant tables. You can dump the tables with
the <CODE>mysqldump mysql</CODE> command. As always, post your problem using
the <CODE>mysqlbug</CODE> script.  See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.  In some cases, you may need
to restart <CODE>mysqld</CODE> with <CODE>--skip-grant-tables</CODE> to run
<CODE>mysqldump</CODE>.

</UL>



<H3><A NAME="Password_hashing" HREF="manual_toc.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A></H3>

<P>
MySQL user accounts are listed in the <CODE>user</CODE> table of the <CODE>mysql</CODE>
database. Each MySQL account is assigned a password, although
what is stored in the <CODE>Password</CODE> column of the <CODE>user</CODE> table is not the
plaintext version of the password, but a hash value computed from
it.  Password hash values are computed by the <CODE>PASSWORD()</CODE> function.

</P>
<P>
MySQL uses passwords in two phases of client/server communication:

</P>

<UL>

<LI>

When a client attempts to connect to the server, there is an initial
authentication step in which the client must present a password that has
a hash value matching the hash value stored in the <CODE>user</CODE> table for
the account that the client wants to use.

<LI>

After the client connects, it can (if it has sufficient privileges) set or
change the password hashes for accounts listed in the <CODE>user</CODE> table.
The client can do this by using the <CODE>PASSWORD()</CODE> function to generate a
password hash, or by using the <CODE>GRANT</CODE> or <CODE>SET PASSWORD</CODE>
statements.

</UL>

<P>
In other words, the server <EM>uses</EM> hash values during authentication when
a client first attempts to connect. The server <EM>generates</EM> hash values
if a connected client invokes the <CODE>PASSWORD()</CODE> function or uses a
<CODE>GRANT</CODE>
or <CODE>SET PASSWORD</CODE> statement to set or change a password.

</P>
<P>
The password hashing mechanism was updated in MySQL 4.1 to provide
better security and to reduce the risk of passwords being intercepted.
However, this new mechanism is understood only by the 4.1 server and
4.1 clients, which can result in some compatibility problems.
A 4.1 client can connect to a pre-4.1 server, because the client
understands both the old and new password hashing mechanisms. However,
a pre-4.1 client that attempts to connect to a 4.1 server may run into
difficulties.  For example, a 4.0 <CODE>mysql</CODE> client that attempts to connect
to a 4.1 server may fail with the following error message:

</P>

<PRE>
shell&#62; mysql -h localhost -u root
Client does not support authentication protocol requested
by server; consider upgrading MySQL client
</PRE>

<P>
The following discussion describes the differences between the old and
new password mechanisms, and what you should do if you upgrade your
server to 4.1 but need to maintain backward compatibility with pre-4.1
clients.

</P>
<P>
<STRONG>Note:</STRONG> This discussion contrasts 4.1 behavior with pre-4.1 behavior,
but the 4.1 behavior described here actually begins with 4.1.1. MySQL
4.1.0 is an ``odd'' release because it has a slightly different mechanism
than that implemented in 4.1.1 and up.  Differences between 4.1.0 and
more recent versions are described further in section <A HREF="manual.html#Password_hashing_4.1.0">5.4.9.2  Password Hashing in MySQL 4.1.0</A>.

</P>
<P>
Prior to MySQL 4.1, password hashes computed by the <CODE>PASSWORD()</CODE> function
are 16 bytes long.  Such hashes look like this:

</P>

<PRE>
mysql&#62; SELECT PASSWORD('mypass');
+--------------------+
| PASSWORD('mypass') |
+--------------------+
| 6f8c114b58f2ce9e   |
+--------------------+
</PRE>

<P>
The <CODE>Password</CODE> column of the <CODE>user</CODE> table (in which these hashes are stored)
also is 16 bytes long before MySQL 4.1.

</P>
<P>
As of MySQL 4.1, the <CODE>PASSWORD()</CODE> function has been modified to produce
a longer 41-byte hash value:

</P>

<PRE>
mysql&#62; SELECT PASSWORD('mypass');
+-----------------------------------------------+
| PASSWORD('mypass')                            |
+-----------------------------------------------+
| *43c8aa34cdc98eddd3de1fe9a9c2c2a9f92bb2098d75 |
+-----------------------------------------------+
</PRE>

<P>
Accordingly, the <CODE>Password</CODE> column in the <CODE>user</CODE> table also must be 41
bytes long to store these values:

</P>

<UL>
<LI>

If you perform a new installation of MySQL 4.1, the <CODE>Password</CODE> column
will be made 41 bytes long automatically.

<LI>

If you upgrade an older installation to 4.1, you should run the
<CODE>mysql_fix_privilege_tables</CODE> script to increase the length of the
<CODE>Password</CODE>
column from 16 to 41 bytes. (The script does not change existing
password values, which remain 16 bytes long.)

</UL>

<P>
A widened <CODE>Password</CODE> column can store password hashes in both the old and
new formats. The format of any given password hash value can be
determined two ways:

</P>

<UL>
<LI>

The obvious difference is the length (16 bytes versus 41 bytes).

<LI>

A second difference is that password hashes in the new format always
begin with a <SAMP>`*'</SAMP> character, whereas passwords in the old format never do.

</UL>

<P>
The longer password hash format has better cryptographic properties, and
client authentication based on long hashes is more secure than that
based on the older short hashes.

</P>
<P>
The differences between short and long password hashes are relevant
both for how the server uses passwords during authentication and for
how it generates password hashes for connected clients that perform
password-changing operations.

</P>
<P>
The way in which the server uses password hashes during authentication
is affected by the width of the <CODE>Password</CODE> column:

</P>

<UL>

<LI>

If the column is short, only short-hash authentication is used.

<LI>

If the column is long, it can hold either short or long hashes, and
the server can use either format:


<UL>

<LI>

Pre-4.1 clients can connect, although because they know only about
the old hashing mechanism, they can authenticate only for accounts that
have short hashes.

<LI>

4.1 clients can authenticate for accounts that have short or long hashes.

</UL>

</UL>

<P>
For short-hash accounts, the authentication process is actually a bit
more secure for 4.1 clients than for older clients.  In terms of security,
the gradient from least to most secure is:

</P>

<UL>

<LI>

Pre-4.1 client authenticating for account with short password hash

<LI>

4.1 client authenticating for account with short password hash

<LI>

4.1 client authenticating for account with long password hash

</UL>

<P>
The way in which the server generates password hashes for connected
clients is affected by the width of the <CODE>Password</CODE> column and by the
<CODE>--old-passwords</CODE> option.  A 4.1 server generates long hashes only if certain
conditions are met:
The <CODE>Password</CODE> column must be wide enough to hold long
values and the <CODE>--old-passwords</CODE> option must not be given.
These conditions apply as follows:

</P>

<UL>

<LI>

The <CODE>Password</CODE> column must be wide enough to hold long hashes (41 bytes).
If the column has not been updated and still has the pre-4.1 width of
16 bytes, the server notices that long hashes cannot fit into it and
generates only short hashes when a client performs password-changing
operations using <CODE>PASSWORD()</CODE>, <CODE>GRANT</CODE>, or <CODE>SET PASSWORD</CODE>.
This is the behavior that
occurs if you have upgraded to 4.1 but have not yet run the
<CODE>mysql_fix_privilege_tables</CODE> script to widen the <CODE>Password</CODE> column.

<LI>

If the <CODE>Password</CODE> column is wide, it can store either short or long
password hashes. In this case, <CODE>PASSWORD()</CODE>, <CODE>GRANT</CODE>, and <CODE>SET PASSWORD</CODE>
generate long hashes unless the server was started with the
<CODE>--old-passwords</CODE> option. That option forces the server to generate
short password hashes instead.

</UL>

<P>
The purpose of the <CODE>--old-passwords</CODE> option is to allow you to maintain
backward compatibility with pre-4.1 clients under circumstances where
the server would otherwise generate long password hashes. The option doesn't
affect authentication (4.1 clients can still use accounts that have
long password hashes), but it does prevent creation of a long
password hash in the <CODE>user</CODE> table as the result of a password-changing
operation. Were that to occur, the account no longer could be used
by pre-4.1 clients. Without the <CODE>--old-passwords</CODE> option, the following
undesirable scenario is possible:

</P>

<UL>

<LI>

An old client connects to an account that has a short password hash.

<LI>

The client changes its own password. Without <CODE>--old-passwords</CODE>,
this results in the account having a long password hash.

<LI>

The next time the old client attempts to connect to the account, it cannot,
because the account now has a long password hash that requires the new
hashing mechanism during authentication. (Once an account has a long
password hash in the user table, only 4.1 clients can authenticate for it,
because pre-4.1 clients do not understand long hashes.)

</UL>

<P>
This scenario illustrates that, if you must support older pre-4.1 clients,
it is dangerous to run a 4.1 server without using the <CODE>--old-passwords</CODE>
option.  By running the server with <CODE>--old-passwords</CODE>, password-changing
operations will not generate long password hashes and thus do not cause
accounts to become inaccessible to older clients. (Those clients cannot
inadvertently lock themselves out by changing their password and ending
up with a long password hash.)

</P>
<P>
The downside of the <CODE>--old-passwords</CODE> option is that any passwords you
create or change will use short hashes, even for 4.1 clients. Thus, you
lose the additional security provided by long password hashes. If you want
to create an account that has a long hash (for example, for use by 4.1
clients), you must do so while running the server without
<CODE>--old-passwords</CODE>.

</P>
<P>
The following scenarios are possible for running a 4.1 server:

</P>
<P>
<STRONG>Scenario 1:</STRONG> Short <CODE>Password</CODE> column in user table:

</P>

<UL>

<LI>

Only short hashes can be stored in the <CODE>Password</CODE> column.

<LI>

The server uses only short hashes during client authentication.

<LI>

For connected clients, password hash-generating operations
involving <CODE>PASSWORD()</CODE>, <CODE>GRANT</CODE>, or <CODE>SET PASSWORD</CODE> use short hashes
exclusively.  Any change to an account's password results in
that account having a short password hash.

<LI>

The <CODE>--old-passwords</CODE> option can be used but is superfluous because
with a short <CODE>Password</CODE> column, the server will generate only short
password hashes anyway.

</UL>

<P>
<STRONG>Scenario 2:</STRONG> Long <CODE>Password</CODE> column; server not started with
<CODE>--old-passwords</CODE> option:

</P>

<UL>

<LI>

Short or long hashes can be stored in the <CODE>Password</CODE> column.

<LI>

4.1 clients can authenticate for accounts that have short or long
hashes.

<LI>

Pre-4.1 clients can authenticate only for accounts that have short
hashes.

<LI>

For connected clients, password hash-generating operations involving
<CODE>PASSWORD()</CODE>, <CODE>GRANT</CODE>, or <CODE>SET PASSWORD</CODE> use long hashes
exclusively.  A change to an account's password results in that account
having a long password hash.

</UL>

<P>
As indicated earlier, a danger in this scenario is that it is possible for
accounts that have a short password hash to become inaccessible to pre-4.1
clients. A change to such an account's password made via <CODE>GRANT</CODE>,
<CODE>PASSWORD()</CODE>, or <CODE>SET PASSWORD</CODE> results in the account being
given a long password hash. From that point on, no pre-4.1 client can
authenticate to that account until the client upgrades to 4.1.

</P>
<P>
To deal with this problem, you can change a password in a special way.
For example, normally you use <CODE>SET PASSWORD</CODE> as follows to change
an account password:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR
    -&#62; 'some_user'@'some_host' = PASSWORD('mypass');
</PRE>

<P>
To change the password but create a short hash, use the
<CODE>OLD_PASSWORD()</CODE> function instead:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR
    -&#62; 'some_user'@'some_host' = OLD_PASSWORD('mypass');
</PRE>

<P>
<CODE>OLD_PASSWORD()</CODE> is useful for situations in which you explicitly want
to generate a short hash.

</P>
<P>
<STRONG>Scenario 3:</STRONG> Long <CODE>Password</CODE> column; server started with
<CODE>--old-passwords</CODE> option:

</P>

<UL>

<LI>

Short or long hashes can be stored in the <CODE>Password</CODE> column.

<LI>

4.1 clients can authenticate for accounts that have short or long
hashes (but note that it is possible to create long hashes only when
the server is started without <CODE>--old-passwords</CODE>).

<LI>

Pre-4.1 clients can authenticate only for accounts that have short
hashes.

<LI>

For connected clients, password hash-generating operations
involving <CODE>PASSWORD()</CODE>, <CODE>GRANT</CODE>, or <CODE>SET PASSWORD</CODE> use short hashes
exclusively.  Any change to an account's password results in that
account having a short password hash.

</UL>

<P>
In this scenario, you cannot create accounts that have long password
hashes, because the <CODE>--old-passwords</CODE> option prevents generation of long hashes.  Also,
if you create an account with a long hash before using the
<CODE>--old-passwords</CODE>
option, changing the account's password while <CODE>--old-passwords</CODE> is in
effect results in the account being given a short password, causing it
to lose the security benefits of a longer hash.

</P>
<P>
The disadvantages for these scenarios may be summarized as follows:

</P>
<P>
In scenario 1, you cannot take advantage of longer hashes that provide more
secure authentication.

</P>
<P>
In scenario 2, accounts with short hashes become inaccessible to pre-4.1
clients if you change their passwords without explicitly using
<CODE>OLD_PASSWORD()</CODE>.

</P>
<P>
In scenario 3, <CODE>--old-passwords</CODE> prevents accounts with short hashes from
becoming inaccessible, but password-changing operations cause accounts
with long hashes to revert to short hashes, and you cannot change them
back to long hashes while <CODE>--old-passwords</CODE> is in effect.

</P>



<H4><A NAME="Application_password_use" HREF="manual_toc.html#Application_password_use">5.4.9.1  Implications of Password Hashing Changes for Application Programs</A></H4>

<P>
An upgrade to MySQL 4.1 can cause a compatibility issue for
applications that use <CODE>PASSWORD()</CODE> to generate passwords for their own
purposes. (Applications really should not do this, because <CODE>PASSWORD()</CODE>
should be used only to manage passwords for MySQL accounts. But some
applications use <CODE>PASSWORD()</CODE> for their own purposes anyway.)  If you upgrade to
4.1 and run the server under conditions where it generates long password
hashes, an application that uses <CODE>PASSWORD()</CODE> for its own passwords will
break.  The recommended course of action is to modify the application to
use another function, such as <CODE>SHA1()</CODE> or <CODE>MD5()</CODE>, to produce hashed values.
If that is not possible, you can use the <CODE>OLD_PASSWORD()</CODE> function, which
is provided to generate short hashes in the old format. (But note that
<CODE>OLD_PASSWORD()</CODE> may one day no longer be supported.)

</P>
<P>
If the server is running under circumstances where it generates short hashes,
<CODE>OLD_PASSWORD()</CODE> is available but is equivalent to <CODE>PASSWORD()</CODE>.

</P>


<H4><A NAME="Password_hashing_4.1.0" HREF="manual_toc.html#Password_hashing_4.1.0">5.4.9.2  Password Hashing in MySQL 4.1.0</A></H4>

<P>
Password hashing in MySQL 4.1.0 differs from hashing in 4.1.1 and up.
The 4.1.0 differences are:

</P>

<UL>

<LI>

Password hashes are 45 bytes long rather than 41 bytes.

<LI>

The <CODE>PASSWORD()</CODE> function is non-repeatable.  That is, with a given
argument <CODE>X</CODE>, successive calls to <CODE>PASSWORD(X)</CODE> generate different
results.

</UL>

<P>
These differences make authentication in 4.1.0 incompatible with that of
releases that follow it.  If you have upgraded to MySQL 4.1.0, it is
recommended that you upgrade to a newer version as soon as possible. After
you do, reassign any long passwords in the <CODE>user</CODE> table so that they are
compatible with the 41-byte format.

</P>



<H2><A NAME="User_Account_Management" HREF="manual_toc.html#User_Account_Management">5.5  MySQL User Account Management</A></H2>

<P>
This section describes how to set up accounts for clients of your MySQL
server. It discusses the following topics:

</P>

<UL>
<LI>

The meaning of account names and passwords as used in MySQL and how that
compares to names and passwords used by your operating system

<LI>

How to set up new accounts and remove existing accounts

<LI>

How to change passwords

<LI>

Guidelines for using passwords securely

<LI>

How to use secure connections with SSL

</UL>



<H3><A NAME="User_names" HREF="manual_toc.html#User_names">5.5.1  MySQL Usernames and Passwords</A></H3>

<P>
<A NAME="IDX569"></A>
<A NAME="IDX570"></A>

</P>
<P>
A MySQL account is defined in terms of a username and the client host or hosts
from which the user can connect to the server. The account also has a
password.
There are several distinctions between the way usernames and passwords are
used by MySQL and the way they are used by your operating system:

</P>

<UL>
<LI>

Usernames, as used by MySQL for authentication purposes, have nothing to do
with usernames (login names) as used by Windows or Unix.  On Unix, most
MySQL clients by default try to log in using the current Unix username as
the MySQL username, but that is for convenience only. The default can be
overridden easily, because client programs allow any username to be
specified with a <CODE>-u</CODE> or <CODE>--user</CODE> option. Because this means
that anyone can attempt to connect to the server using any username, you
can't make a database secure in any way unless all MySQL accounts have
passwords.  Anyone who specifies a username for an account that
has no password will be able to connect successfully to the server.

<LI>

MySQL usernames can be up to 16 characters long. Operating system usernames
might have a different maximum length. For example, Unix usernames typically
are limited to eight characters.

<LI>

MySQL passwords have nothing to do with passwords for logging in to your
operating system.  There is no necessary connection between the password
you use to log in to a Windows or Unix machine and the password you use
to access the MySQL server on that machine.

<LI>

MySQL encrypts passwords using its own algorithm. This encryption is
different from that used during the Unix login process.  MySQL password
encryption is the same as that implemented by the <CODE>PASSWORD()</CODE> SQL
function.  Unix password encryption is the same as that implemented by the
<CODE>ENCRYPT()</CODE> SQL function.  See the descriptions of the
<CODE>PASSWORD()</CODE> and <CODE>ENCRYPT()</CODE> functions in section <A HREF="manual.html#Encryption_functions">13.8.2  Encryption Functions</A>.  From version 4.1 on, MySQL employs a stronger authentication
method that has better password protection during the connection process
than in earlier versions. It is secure even if TCP/IP packets are sniffed or
the <CODE>mysql</CODE> database is captured.  (In earlier versions, even though
passwords are stored in encrypted form in the <CODE>user</CODE> table, knowledge
of the encrypted password value could be used to connect to the MySQL
server.)

</UL>

<P>
When you install MySQL, the grant tables are populated with an initial set of
accounts. These accounts have names and access privileges that are described
in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>, which also discusses how to assign passwords
to them.  Thereafter, you normally set up, modify, and remove MySQL accounts
using the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</P>
<P>
When you connect to a MySQL server with a command-line client, you
should specify the username and password for the account that you want to use:

</P>

<PRE>
shell&#62; mysql --user=monty --password=guess db_name
</PRE>

<P>
If you prefer short options, the command looks like this:

</P>

<PRE>
shell&#62; mysql -u monty -pguess db_name
</PRE>

<P>
There must be <EM>no space</EM> between the <CODE>-p</CODE> option and the
following password value.
See section <A HREF="manual.html#Connecting">5.4.4  Connecting to the MySQL Server</A>.

</P>
<P>
The preceding commands include the pasword value on the command line, which
can be a security risk.
See section <A HREF="manual.html#Password_security">5.5.6  Keeping Your Password Secure</A>.
To avoid this, specify the <CODE>--password</CODE> or <CODE>-p</CODE> option without any
following password value:

</P>

<PRE>
shell&#62; mysql --user=monty --password db_name
shell&#62; mysql -u monty -p db_name
</PRE>

<P>
Then the client program will print a prompt and wait for you to enter
the password.
(In these examples, <CODE>db_name</CODE> is <EM>not</EM> interpreted as a
password, because it is separated from the preceding password option by a
space.)

</P>
<P>
On some systems, the library call that MySQL uses to prompt for a password
automatically limits the password to eight characters.  That is a problem
with the system library, not with MySQL.  Internally, MySQL doesn't have
any limit for the length of the password.  To work around the problem,
change your MySQL password to a value that is eight or fewer characters
long, or put your password in an option file.

</P>



<H3><A NAME="Adding_users" HREF="manual_toc.html#Adding_users">5.5.2  Adding New User Accounts to MySQL</A></H3>

<P>
<A NAME="IDX571"></A>
<A NAME="IDX572"></A>

</P>
<P>
<A NAME="IDX573"></A>
<A NAME="IDX574"></A>
<A NAME="IDX575"></A>
<A NAME="IDX576"></A>
<A NAME="IDX577"></A>

</P>
<P>
You can create MySQL accounts in two ways:

</P>

<UL>
<LI>

By using <CODE>GRANT</CODE> statements
<LI>

By manipulating the MySQL grant tables directly
</UL>

<P>
The preferred method is to use <CODE>GRANT</CODE> statements, because they are
more concise and less error-prone. <CODE>GRANT</CODE> is available as of MySQL
3.22.11; its syntax is described in
section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</P>
<P>
Another option for creating accounts is to use one of several available
third-party programs that offer capabilities for MySQL account
administration.  <CODE>phpMyAdmin</CODE> is one such program.

</P>
<P>
The following examples show how to use the <CODE>mysql</CODE> client program to
set up new users.  These examples assume that privileges are set up
according to the defaults described in section <A HREF="manual.html#Default_privileges">2.4.3  Securing the Initial MySQL Accounts</A>.  This means
that to make changes, you must connect to the MySQL server as the MySQL
<CODE>root</CODE> user, and the <CODE>root</CODE> account must have the <CODE>INSERT</CODE>
privilege for the <CODE>mysql</CODE> database and the <CODE>RELOAD</CODE> administrative
privilege.

</P>
<P>
First, use the <CODE>mysql</CODE> program to connect to the server as the
MySQL <CODE>root</CODE> user:

</P>

<PRE>
shell&#62; mysql --user=root mysql
</PRE>

<P>
If you have assigned a password to the <CODE>root</CODE> account, you'll also
need to supply a <CODE>--password</CODE> or <CODE>-p</CODE> option for this <CODE>mysql</CODE>
command and also for those later in this section.

</P>
<P>
After connecting to the server as <CODE>root</CODE>, you can add new accounts.  The following
statements use <CODE>GRANT</CODE> to set up four new accounts:

</P>

<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO 'monty'@'localhost'
    -&#62;     IDENTIFIED BY 'some_pass' WITH GRANT OPTION;
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO 'monty'@'%'
    -&#62;     IDENTIFIED BY 'some_pass' WITH GRANT OPTION;
mysql&#62; GRANT RELOAD,PROCESS ON *.* TO 'admin'@'localhost';
mysql&#62; GRANT USAGE ON *.* TO 'dummy'@'localhost';
</PRE>

<P>
The accounts created by these <CODE>GRANT</CODE> statements have the
following properties:

</P>

<UL>
<LI>

Two of the accounts have a username of <CODE>monty</CODE> and a password of
<CODE>some_pass</CODE>. Both accounts are superuser accounts with full privileges
to do anything. One account (<CODE>'monty'@'localhost'</CODE>) can be used only
when connecting from the local host. The other (<CODE>'monty'@'%'</CODE>) can be
used to connect from any other host.  Note that it is necessary to have both
accounts for <CODE>monty</CODE> to be able to connect from anywhere as
<CODE>monty</CODE>.  Without the <CODE>localhost</CODE> account, the anonymous-user
account for <CODE>localhost</CODE> that is created by <CODE>mysql_install_db</CODE>
would take precedence when <CODE>monty</CODE> connects from the local host. As a
result, <CODE>monty</CODE> would be treated as an anonymous user.  The reason for
this is that the anonymous-user account has a more specific <CODE>Host</CODE>
column value than the <CODE>'monty'@'%'</CODE> account and thus comes earlier in
the <CODE>user</CODE> table sort order.  (<CODE>user</CODE> table sorting is discussed
in section <A HREF="manual.html#Connection_access">5.4.5  Access Control, Stage 1: Connection Verification</A>.)

<LI>

One account has a username of <CODE>admin</CODE> and no password.  This account
can be used only by connecting from the local host.  It is granted the
<CODE>RELOAD</CODE> and <CODE>PROCESS</CODE> administrative privileges.  These
privileges allow the <CODE>admin</CODE> user to execute the <CODE>mysqladmin
reload</CODE>, <CODE>mysqladmin refresh</CODE>, and <CODE>mysqladmin flush-*</CODE> commands,
as well as <CODE>mysqladmin processlist</CODE> .  No privileges are granted for
accessing any databases. You could add such privileges later by issuing
additional <CODE>GRANT</CODE> statements.

<LI>

One account has a username of <CODE>dummy</CODE> and no password.  This account
can be used only by connecting from the local host.  No privileges are
granted. The <CODE>USAGE</CODE> privilege in the <CODE>GRANT</CODE> statement allows you
to create an account without giving it any privileges. It has the effect of
setting all the global privileges to <CODE>'N'</CODE>.  It is assumed that you
will grant specific privileges to the account later.

</UL>

<P>
<A NAME="IDX578"></A>
<A NAME="IDX579"></A>

</P>
<P>
As an alternative to <CODE>GRANT</CODE>, you can create the same accounts
directly by issuing <CODE>INSERT</CODE> statements and then telling
the server to reload the grant tables:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user
    -&#62;     VALUES('localhost','monty',PASSWORD('some_pass'),
    -&#62;     'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO user
    -&#62;     VALUES('%','monty',PASSWORD('some_pass'),
    -&#62;     'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO user SET Host='localhost',User='admin',
    -&#62;     Reload_priv='Y', Process_priv='Y';
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('localhost','dummy','');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The reason for using <CODE>FLUSH PRIVILEGES</CODE> when you create accounts with
<CODE>INSERT</CODE> is to tell the server to re-read the grant tables.
Otherwise, the changes will go unnoticed until you restart the server. (With
<CODE>GRANT</CODE>, <CODE>FLUSH PRIVILEGES</CODE> is unnecessary.)

</P>
<P>
The reason for using the <CODE>PASSWORD()</CODE> function with <CODE>INSERT</CODE> is to
encrypt the password. The <CODE>GRANT</CODE> statement encrypts the password for
you, so <CODE>PASSWORD()</CODE> is unnecessary.

</P>
<P>
The <CODE>'Y'</CODE> values enable privileges for the accounts.  Depending on your
MySQL version, you may have to use a different number of <CODE>'Y'</CODE> values
in the first two <CODE>INSERT</CODE> statements. (Versions prior to 3.22.11 have
fewer privilege columns, and versions from 4.0.2 on have more.)  For the
<CODE>admin</CODE> account, the more readable extended <CODE>INSERT</CODE> syntax using
<CODE>SET</CODE> that is available starting with Version 3.22.11 is used.

</P>
<P>
In the <CODE>INSERT</CODE> statement for the <CODE>dummy</CODE> account, only the
<CODE>Host</CODE>, <CODE>User</CODE>, and <CODE>Password</CODE> columns in the <CODE>user</CODE>
table record are assigned values. None of the privilege columns are set
explicitly, so MySQL assigns them all the default value of <CODE>'N'</CODE>.
This is equivalent to what <CODE>GRANT USAGE</CODE> does.

</P>
<P>
Note that to set up a superuser account, it is necessary only to create a
<CODE>user</CODE> table entry with the privilege columns set to <CODE>'Y'</CODE>.
<CODE>user</CODE> table privileges are global, so no entries in any of the other
grant tables are needed.

</P>
<P>
The next examples create three accounts and give them access to specific
databases. Each of them has a username of <CODE>custom</CODE> and password of
<CODE>obscure</CODE>.

</P>
<P>
To create the accounts with <CODE>GRANT</CODE>, use the following statements:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON bankaccount.*
    -&#62;     TO 'custom'@'localhost'
    -&#62;     IDENTIFIED BY 'obscure';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON expenses.*
    -&#62;     TO 'custom'@'whitehouse.gov'
    -&#62;     IDENTIFIED BY 'obscure';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON customer.*
    -&#62;     TO 'custom'@'server.domain'
    -&#62;     IDENTIFIED BY 'obscure';
</PRE>

<P>
The three accounts can be used as follows:

</P>

<UL>
<LI>

The first account can
access the <CODE>bankaccount</CODE> database, but only from the local host.
<LI>

The second account can access
the <CODE>expenses</CODE> database, but only from the host <CODE>whitehouse.gov</CODE>.
<LI>

The third account can access
the <CODE>customer</CODE> database, but only from the host <CODE>server.domain</CODE>.
</UL>

<P>
To set up the <CODE>custom</CODE> accounts without <CODE>GRANT</CODE>, use <CODE>INSERT</CODE>
statements as follows to modify the grant tables directly:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('localhost','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('whitehouse.gov','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('server.domain','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('localhost','bankaccount','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('whitehouse.gov','expenses','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('server.domain','customer','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The first three <CODE>INSERT</CODE> statements add <CODE>user</CODE> table entries that
allow the user <CODE>custom</CODE> to connect from the various hosts with the given
password, but grant no global privileges (all privileges are set to the
default value of <CODE>'N'</CODE>).  The next three <CODE>INSERT</CODE> statements add
<CODE>db</CODE> table entries that grant privileges to <CODE>custom</CODE> for the
<CODE>bankaccount</CODE>, <CODE>expenses</CODE>, and <CODE>customer</CODE> databases, but only
when accessed from the proper hosts.  As usual when you modify the grant
tables directly, you tell the server to reload them with
<CODE>FLUSH PRIVILEGES</CODE> so that the privilege changes take effect.

</P>
<P>
If you want to give a specific user access from all machines in a given
domain (for example, <CODE>mydomain.com</CODE>), you can issue a <CODE>GRANT</CODE>
statement that uses the <SAMP>`%'</SAMP> wildcard character in the host part of the
account name:

</P>

<PRE>
mysql&#62; GRANT ...
    -&#62;     ON *.*
    -&#62;     TO 'myname'@'%.mydomain.com'
    -&#62;     IDENTIFIED BY 'mypass';
</PRE>

<P>
To do the same thing by modifying the grant tables directly, do this:

</P>

<PRE>
mysql&#62; INSERT INTO user (Host,User,Password,...)
   -&#62;      VALUES('%.mydomain.com','myname',PASSWORD('mypass'),...);
mysql&#62; FLUSH PRIVILEGES;
</PRE>



<H3><A NAME="Removing_users" HREF="manual_toc.html#Removing_users">5.5.3  Removing User Accounts from MySQL</A></H3>

<P>
<A NAME="IDX580"></A>
<A NAME="IDX581"></A>
<A NAME="IDX582"></A>
<A NAME="IDX583"></A>
<A NAME="IDX584"></A>
<A NAME="IDX585"></A>
<A NAME="IDX586"></A>
<A NAME="IDX587"></A>

</P>
<P>
To remove an account, use the <CODE>DROP USER</CODE> statement, which was added in
MySQL 4.1.1.  For older versions of MySQL, use <CODE>DELETE</CODE> instead.
The account removal procedure is described in section <A HREF="manual.html#Drop_user">14.5.1.1  <CODE>DROP USER</CODE> Syntax</A>.

</P>



<H3><A NAME="User_resources" HREF="manual_toc.html#User_resources">5.5.4  Limiting Account Resources</A></H3>

<P>
Before MySQL 4.0.2, the only available method for limiting use of MySQL
server resources has been to set the <CODE>max_user_connections</CODE> system
variable to a non-zero value. But that method is strictly global.  It does
not allow for management of individual accounts. Also, it limits only the
number of simultaneous connections made using a single account, not
what a client can do once connected. Both types of control are
interest to many MySQL administrators, particularly those for Internet
Service Providers.

</P>
<P>
Starting from MySQL 4.0.2, you can limit the following server resources for
individual accounts:

</P>

<UL>
<LI>

The number of queries that an account can issue per hour
<LI>

The number of updates that an account can issue per hour
<LI>

The number of times an account can connect to the server per hour
</UL>

<P>
Any statement that a client can issue counts against the query limit.
Only statements that modify databases or tables count against the update
limit.

</P>
<P>
An account in this context is a single record in the <CODE>user</CODE> table. Each
account is uniquely identified by its <CODE>User</CODE> and <CODE>Host</CODE> column
values.

</P>
<P>
As a prerequisite for using this feature, the <CODE>user</CODE> table in the
<CODE>mysql</CODE> database must contain the resource-related columns.  Resource
limits are stored in the <CODE>max_questions</CODE>, <CODE>max_updates</CODE>, and
<CODE>max_connections</CODE> columns.  If your <CODE>user</CODE> table doesn't have
these columns, it needs to be upgraded; see section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</P>
<P>
To set resource limits with a <CODE>GRANT</CODE> statement, use a <CODE>WITH</CODE>
clause that names each resource to be limited and a per-hour count
indicating the limit value.  For example, to create a new account that can
access the <CODE>customer</CODE> database, but only in a limited fashion, issue
this statement:

</P>

<PRE>
mysql&#62; GRANT ALL ON customer.* TO 'francis'@'localhost'
    -&#62;     IDENTIFIED BY 'frank'
    -&#62;     WITH MAX_QUERIES_PER_HOUR 20
    -&#62;          MAX_UPDATES_PER_HOUR 10
    -&#62;          MAX_CONNECTIONS_PER_HOUR 5;
</PRE>

<P>
The limit types need not all be named in the <CODE>WITH</CODE> clause, but those
named can be present in any order. The value for each limit should be an
integer representing a count per hour. If the <CODE>GRANT</CODE> statement has no
<CODE>WITH</CODE> clause, the limits are each set to the default value of zero
(that is, no limit).

</P>
<P>
To set or change limits for an existing account, use a <CODE>GRANT USAGE</CODE>
statement at the global level (<CODE>ON *.*</CODE>). The following statement
changes the query limit for <CODE>francis</CODE> to 100:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'francis'@'localhost'
    -&#62;     WITH MAX_QUERIES_PER_HOUR 100;
</PRE>

<P>
This statement leaves the account's existing privileges unchanged and
modifies only the limit values specified.

</P>
<P>
To remove an existing limit, set its value to zero. For example, to remove the
limit on how many times per hour <CODE>francis</CODE> can connect, use this
statement:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'francis'@'localhost'
    -&#62;     WITH MAX_CONNECTIONS_PER_HOUR 0;
</PRE>

<P>
Resource-use counting takes place when any account has a non-zero limit
placed on its use of any of the resources.

</P>
<P>
As the server runs, it counts the number of times each account uses
resources.  If an account reaches its limit on number of connections within
the last hour, further connections for the account are rejected until that
hour is up. Similarly, if the account reaches its limit on the number of
queries or updates, further queries or updates are rejected until the hour
is up. In all such cases, an appropriate error message is issued.

</P>
<P>
Resource counting is done per account, not per client. For example, if your
account has a query limit of 50, you cannot increase your limit to 100 by
making two simultaneous client connections to the server.  Queries issued on
both connections are counted together.

</P>
<P>
The current resource-use counts can be reset globally for all accounts, or
individually for a given count:

</P>

<UL>
<LI>

To reset the current counts to zero for all accounts, issue a <CODE>FLUSH
USER_RESOURCES</CODE> statement. The counts also can be reset by reloading the
grant tables (for example, with a <CODE>FLUSH PRIVILEGES</CODE> statement or a
<CODE>mysqladmin reload</CODE> command).
<LI>

The counts for an individual account can be set to zero by re-granting
it any of its limits. To do this, use <CODE>GRANT USAGE</CODE> as described earlier
and specify a limit value equal to the value that the account
already has.

</UL>



<H3><A NAME="Passwords" HREF="manual_toc.html#Passwords">5.5.5  Assigning Account Passwords</A></H3>

<P>
<A NAME="IDX588"></A>
<A NAME="IDX589"></A>

</P>
<P>
<A NAME="IDX590"></A>
<A NAME="IDX591"></A>

</P>
<P>
Passwords may be assigned from the command line by using the <CODE>mysqladmin</CODE>
command:

</P>

<PRE>
shell&#62; mysqladmin -u user_name -h host_name password "newpwd"
</PRE>

<P>
The account for which this command resets the password is the one with a
<CODE>user</CODE> table record that matches <CODE>user_name</CODE> in the <CODE>User</CODE>
column and the client host <EM>from which you connect</EM> in the
<CODE>Host</CODE> column.

</P>
<P>
Another way to assign a password to an account is to issue a <CODE>SET
PASSWORD</CODE> statement:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR 'jeffrey'@'%' = PASSWORD('biscuit');
</PRE>

<P>
Only users such as <CODE>root</CODE> with update access to the <CODE>mysql</CODE>
database can change the password for other users.  If you are not connected
as an anonymous user, you can change your own password by omitting the
<CODE>FOR</CODE> clause:

</P>

<PRE>
mysql&#62; SET PASSWORD = PASSWORD('biscuit');
</PRE>

<P>
You can also use a <CODE>GRANT USAGE</CODE> statement at the global level
(<CODE>ON *.*</CODE>) to assign a password to an account without affecting the
account's current privileges:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'jeffrey'@'%' IDENTIFIED BY 'biscuit';
</PRE>

<P>
Although it is generally preferable to assign passwords using one of the
preceding methods, you can also do so by modifying the <CODE>user</CODE> table
directly:

</P>

<UL>
<LI>

To establish a password when creating a new account, provide a
value for the <CODE>Password</CODE> column:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62; VALUES('%','jeffrey',PASSWORD('biscuit'));
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<LI>

To change the password for an existing account, use <CODE>UPDATE</CODE> to set the
<CODE>Password</CODE> column value:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; UPDATE user SET Password = PASSWORD('bagel')
    -&#62; WHERE Host = '%' AND User = 'francis';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

</UL>

<P>
When you assign an account a password using <CODE>SET PASSWORD</CODE>,
<CODE>INSERT</CODE>, or <CODE>UPDATE</CODE>, you must use the <CODE>PASSWORD()</CODE> function
to encrypt it.  (The only exception is that you need not use
<CODE>PASSWORD()</CODE> if the password is empty.) <CODE>PASSWORD()</CODE> is
necessary because the <CODE>user</CODE> table stores passwords in encrypted form,
not as plaintext.  If you forget that fact, you are likely to set passwords
like this:

</P>

<PRE>
shell&#62; mysql -u root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62; VALUES('%','jeffrey','biscuit');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The result is that the literal value <CODE>'biscuit'</CODE> is stored as the
password in the <CODE>user</CODE> table, not the encrypted value.  When
<CODE>jeffrey</CODE> attempts to connect to the server using this password, the
value is encrypted and compared to the value stored in the <CODE>user</CODE>
table.  However, the stored value is the literal string <CODE>'biscuit'</CODE>, so
the comparison fails and the server rejects the connection:

</P>

<PRE>
shell&#62; mysql -u jeffrey -pbiscuit test
Access denied
</PRE>

<P>
If you set passwords using the <CODE>GRANT ... IDENTIFIED BY</CODE> statement or
the <CODE>mysqladmin password</CODE> command, they both take care of encrypting
the password for you.  The <CODE>PASSWORD()</CODE> function is unnecessary.

</P>
<P>
<STRONG>Note:</STRONG> <CODE>PASSWORD()</CODE> encryption is different from Unix password
encryption.
See section <A HREF="manual.html#User_names">5.5.1  MySQL Usernames and Passwords</A>.

</P>



<H3><A NAME="Password_security" HREF="manual_toc.html#Password_security">5.5.6  Keeping Your Password Secure</A></H3>

<P>
On an administrative level, you should never grant access to the
<CODE>mysql.user</CODE> table to any non-administrative accounts. Passwords in the
<CODE>user</CODE> table are stored in encrypted form, but in versions of MySQL
earlier than 4.1, knowing the encrypted password for an account makes it
possible to connect to the server using that account.

</P>
<P>
When you run a client program to connect to the MySQL server, it is
inadvisable to specify your password in a way that exposes it to discovery
by other users.  The methods you can use to specify your password when you
run client programs are listed here, along with an assessment of the risks
of each method:

</P>

<UL>
<LI>

<A NAME="IDX592"></A>
<A NAME="IDX593"></A>
Use a <CODE>-pyour_pass</CODE> or <CODE>--password=your_pass</CODE> option on the command
line.  For example:


<PRE>
shell&#62; mysql -u francis -pfrank db_name
</PRE>

This is convenient but insecure, because your password becomes visible to
system status programs such as <CODE>ps</CODE> that may be invoked by other users
to display command lines.  MySQL clients typically overwrite the
command-line password argument with zeros during their initialization
sequence, but there is still a brief interval during which the value is
visible.

<LI>

Use a <CODE>-p</CODE> or <CODE>--password</CODE> option with no password value
specified.  In this case, the client program solicits the password from
the terminal:


<PRE>
shell&#62; mysql -u francis
Enter password: ********
</PRE>

The <SAMP>`*'</SAMP> characters represent your password. The password is not
displayed as you enter it.

It is more secure to enter your password this way than to specify it on the
command line because it is not visible to other users.  However, this method
of entering a password is suitable only for programs that you run
interactively.  If you want to invoke a client from a script that runs
non-interactively, there is no opportunity to enter the password from the
terminal. On some systems, you may even find that the first line of your
script is read and interpreted (incorrectly) as your password!

<LI>

<A NAME="IDX594"></A>
Store your password in an option file.  For example, on Unix you can list your
password in the <CODE>[client]</CODE> section of the <TT>`.my.cnf'</TT> file in your
home directory:


<PRE>
[client]
password=your_pass
</PRE>

If you store your password in <TT>`.my.cnf'</TT>, the file should not be
accessible to anyone but yourself. To ensure this, set the file access mode to
<CODE>400</CODE> or <CODE>600</CODE>. For example:


<PRE>
shell&#62; chmod 600 .my.cnf
</PRE>

section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A> discusses option files in more detail.

<LI>

Store your password in the <CODE>MYSQL_PWD</CODE> environment variable.
This method of specifying your MySQL password must be considered
extremely insecure and should not be used.  Some versions of <CODE>ps</CODE>
include an option to display the environment of running processes. If you
set <CODE>MYSQL_PWD</CODE>, your password will be exposed to any other user who
runs <CODE>ps</CODE>.  Even on systems without such a version of <CODE>ps</CODE>, it is
unwise to assume that there are no other methods by which users can examine
process environments.
See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</UL>

<P>
All in all, the safest methods are to have the client program prompt for the
password or to specify the password in a properly protected option file.

</P>


<H3><A NAME="Secure_connections" HREF="manual_toc.html#Secure_connections">5.5.7  Using Secure Connections</A></H3>

<P>
<A NAME="IDX595"></A>
<A NAME="IDX596"></A>

</P>
<P>
Beginning with version 4.0.0, MySQL has support for secure (encrypted)
connections between MySQL clients and the server using the Secure Sockets
Layer (SSL) protocol.  This section discusses how to use SSL connections.
It also describes a way to set up SSH on Windows.

</P>
<P>
The standard configuration of MySQL is intended to be as fast as possible,
so encrypted connections are not used by default.  Doing so would make the
client/server protocol much slower.  Encrypting data is a CPU-intensive
operation that requires the computer to do additional work and can delay
other MySQL tasks.  For applications that require the security provided by
encrypted connections, the extra computation is warranted.

</P>
<P>
MySQL allows encryption to be enabled on a per-connection basis. You can
choose a normal unencrypted connection or a secure encrypted SSL connection
according the requirements of individual applications.

</P>



<H4><A NAME="Secure_basics" HREF="manual_toc.html#Secure_basics">5.5.7.1  Basic SSL Concepts</A></H4>

<P>
To understand how MySQL
uses SSL, it's necessary to explain some basic SSL and X509 concepts. People
who are already familiar with them can skip this part.

</P>
<P>
By default, MySQL uses unencrypted connections between the client and the
server. This means that someone with access to the network could watch all
your traffic and look at the data being sent or received.  They could even
change the data while it is in transit between client and server. To improve
security a little, you can compress client/server traffic by using the
<CODE>--compress</CODE> option when invoking client programs.  However, this will
not foil a determined attacker.

</P>
<P>
<A NAME="IDX597"></A>
When you need to move information over a network in a secure fashion,
an unencrypted connection is unacceptable.  Encryption is the way to make
any kind of data unreadable. In fact, today's practice requires many
additional security elements from encryption algorithms.  They should resist
many kind of known attacks such as changing the order of encrypted messages
or replaying data twice.

</P>
<P>
SSL is a protocol that uses different encryption algorithms to ensure that
data received over a public network can be trusted. It has mechanisms to
detect any data change, loss, or replay. SSL also incorporates algorithms
that provide identity verification using the X509 standard.

</P>
<P>
<A NAME="IDX598"></A>
X509 makes it possible to identify someone on the Internet.  It is most
commonly used in e-commerce applications. In basic terms, there should be
some company called a ``Certificate Authority'' (or CA) that assigns electronic
certificates to anyone who needs them. Certificates rely on asymmetric
encryption algorithms that have two encryption keys (a public key and a
secret key). A certificate owner can show the certificate to another party
as proof of identity. A certificate consists of its owner's public key. Any
data encrypted with this public key can be decrypted only using the
corresponding secret key, which is held by the owner of the certificate.

</P>
<P>
If you need more information about SSL, X509, or encryption, use your
favorite Internet search engine to search for keywords in which you are
interested.

</P>


<H4><A NAME="Secure_requirements" HREF="manual_toc.html#Secure_requirements">5.5.7.2  Requirements</A></H4>

<P>
To use SSL connections between the MySQL server and client programs, your
system must be able to support OpenSSL and your version of MySQL must be
4.0.0 or newer.

</P>
<P>
To get secure connections to work with MySQL, you must do the following:

</P>

<OL>
<LI>

Install the OpenSSL library. We have tested MySQL with OpenSSL 0.9.6.
If you need OpenSSL, visit <a HREF="http://www.openssl.org">http://www.openssl.org</a>.
<LI>

When you configure MySQL, run the <CODE>configure</CODE> script with the
<CODE>--with-vio</CODE> and <CODE>--with-openssl</CODE> options.
<LI>

Make sure that you have upgraded your grant tables to include the SSL-related
columns in the <CODE>mysql.user</CODE> table.
This is necessary if your grant tables date from a version prior to MySQL
4.0.0.  The upgrade procedure is described in section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.
<LI>

To check whether a running <CODE>mysqld</CODE> server supports OpenSSL,
examine the value of the <CODE>have_openssl</CODE> system variable:


<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_openssl';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| have_openssl  | YES   |
+---------------+-------+
</PRE>

If the value is <CODE>YES</CODE>, the server supports OpenSSL connections.
</OL>



<H4><A NAME="Secure_create_certs" HREF="manual_toc.html#Secure_create_certs">5.5.7.3  Setting Up SSL Certificates for MySQL</A></H4>

<P>
Here is an example for setting up SSL certificates for MySQL:

</P>

<PRE>
DIR=`pwd`/openssl
PRIV=$DIR/private

mkdir $DIR $PRIV $DIR/newcerts
cp /usr/share/ssl/openssl.cnf $DIR
replace ./demoCA $DIR -- $DIR/openssl.cnf

# Create necessary files: $database, $serial and $new_certs_dir 
# directory (optional)

touch $DIR/index.txt
echo "01" &#62; $DIR/serial

#
# Generation of Certificate Authority(CA)
#

openssl req -new -x509 -keyout $PRIV/cakey.pem -out $DIR/cacert.pem \
    -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# ................++++++
# .........++++++
# writing new private key to '/home/monty/openssl/private/cakey.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be incorporated
# into your certificate request.
# What you are about to enter is what is called a Distinguished Name or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL admin
# Email Address []:

#
# Create server request and key
#
openssl req -new -keyout $DIR/server-key.pem -out \
    $DIR/server-req.pem -days 3600 -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# ..++++++
# ..........++++++
# writing new private key to '/home/monty/openssl/server-key.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be incorporated
# into your certificate request.
# What you are about to enter is what is called a Distinguished Name or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL server
# Email Address []:
# 
# Please enter the following 'extra' attributes
# to be sent with your certificate request
# A challenge password []:
# An optional company name []:

#
# Remove the passphrase from the key (optional)
#

openssl rsa -in $DIR/server-key.pem -out $DIR/server-key.pem

#
# Sign server cert
#
openssl ca  -policy policy_anything -out $DIR/server-cert.pem \
    -config $DIR/openssl.cnf -infiles $DIR/server-req.pem

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Enter PEM pass phrase:
# Check that the request matches the signature
# Signature ok
# The Subjects Distinguished Name is as follows
# countryName           :PRINTABLE:'FI'
# organizationName      :PRINTABLE:'MySQL AB'
# commonName            :PRINTABLE:'MySQL admin'
# Certificate is to be certified until Sep 13 14:22:46 2003 GMT (365 days)
# Sign the certificate? [y/n]:y
# 
# 
# 1 out of 1 certificate requests certified, commit? [y/n]y
# Write out database with 1 new entries
# Data Base Updated

#
# Create client request and key
#
openssl req -new -keyout $DIR/client-key.pem -out \
    $DIR/client-req.pem -days 3600 -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# .....................................++++++
# .............................................++++++
# writing new private key to '/home/monty/openssl/client-key.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be incorporated
# into your certificate request.
# What you are about to enter is what is called a Distinguished Name or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL user
# Email Address []:
# 
# Please enter the following 'extra' attributes
# to be sent with your certificate request
# A challenge password []:
# An optional company name []:

#
# Remove a passphrase from the key (optional)
#
openssl rsa -in $DIR/client-key.pem -out $DIR/client-key.pem

#
# Sign client cert
#

openssl ca  -policy policy_anything -out $DIR/client-cert.pem \
    -config $DIR/openssl.cnf -infiles $DIR/client-req.pem

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Enter PEM pass phrase:
# Check that the request matches the signature
# Signature ok
# The Subjects Distinguished Name is as follows
# countryName           :PRINTABLE:'FI'
# organizationName      :PRINTABLE:'MySQL AB'
# commonName            :PRINTABLE:'MySQL user'
# Certificate is to be certified until Sep 13 16:45:17 2003 GMT (365 days)
# Sign the certificate? [y/n]:y
# 
# 
# 1 out of 1 certificate requests certified, commit? [y/n]y
# Write out database with 1 new entries
# Data Base Updated

#
# Create a my.cnf file that you can use to test the certificates
#

cnf=""
cnf="$cnf [client]"
cnf="$cnf ssl-ca=$DIR/cacert.pem"
cnf="$cnf ssl-cert=$DIR/client-cert.pem"
cnf="$cnf ssl-key=$DIR/client-key.pem"
cnf="$cnf [mysqld]"
cnf="$cnf ssl-ca=$DIR/cacert.pem"
cnf="$cnf ssl-cert=$DIR/server-cert.pem"
cnf="$cnf ssl-key=$DIR/server-key.pem"
echo $cnf | replace " " '
' &#62; $DIR/my.cnf
</PRE>

<P>
To test SSL connections, start the server as follows, where <CODE>$DIR</CODE> is the
pathname to the directory where the sample <TT>`my.cnf'</TT> option file is
located:

</P>

<PRE>
shell&#62; mysqld --defaults-file=$DIR/my.cnf &#38;
</PRE>

<P>
Then invoke a client program using the same option file:

</P>

<PRE>
shell&#62; mysql --defaults-file=$DIR/my.cnf
</PRE>

<P>
If you have a MySQL source distribution, you can also test your setup by
modifying the preceding <TT>`my.cnf'</TT> file to refer to the demonstration
certificate and key files in the <TT>`SSL'</TT> directory of the distribution.

</P>



<H4><A NAME="Secure_GRANT" HREF="manual_toc.html#Secure_GRANT">5.5.7.4  SSL <CODE>GRANT</CODE> Options</A></H4>

<P>
<A NAME="IDX599"></A>
<A NAME="IDX600"></A>
<A NAME="IDX601"></A>

</P>
<P>
MySQL can check X509 certificate attributes in addition to the usual
authentication that is based on the username and password.  To specify
SSL-related options for a MySQL account, use the <CODE>REQUIRE</CODE> clause of
the <CODE>GRANT</CODE> statement.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</P>
<P>
There are different possibilities for limiting connection types for an account:

</P>

<UL>
<LI>

If an account has no SSL or X509 requirements, unencrypted connections are
allowed if the username and password are valid. However, encrypted
connections also can be used at the client's option, if the client has the
proper certificate and key files.

<LI>

<CODE>REQUIRE SSL</CODE> option limits the server to allow only SSL
encrypted connections for the account. Note that this option can be omitted
if there are any ACL records that allow non-SSL connections.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE SSL;
</PRE>

<LI>

<CODE>REQUIRE X509</CODE> means that the client must have a valid certificate
but that the exact certificate, issuer, and subject do not matter.
The only requirement is that it should be possible to verify its
signature with one of the CA certificates.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE X509;
</PRE>

<LI>

<CODE>REQUIRE ISSUER 'issuer'</CODE> places the restriction on connection attempts
that the client must present a valid X509 certificate issued by CA
<CODE>'issuer'</CODE>.  If the client presents a certificate that is valid but has
a different issuer, the server rejects the connection.  Use of X509
certificates always implies encryption, so the <CODE>SSL</CODE> option is
unneccessary.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <CODE>ISSUER</CODE> value should be entered as a single string.

<LI>

<CODE>REQUIRE SUBJECT 'subject'</CODE> places the restriction on connection
attempts that the client must present a valid X509 certificate with subject
<CODE>'subject'</CODE> on it.  If the client presents a certificate that is valid
but has a different subject, the server rejects the connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <CODE>SUBJECT</CODE> value should be entered as a single string.

<LI>

<CODE>REQUIRE CIPHER 'cipher'</CODE> is needed to ensure that strong enough ciphers
and key lengths will be used. SSL itself can be weak if old algorithms
with short encryption keys are used. Using this option, we can ask for
some exact cipher method to allow a connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

</UL>

<P>
The <CODE>SUBJECT</CODE>, <CODE>ISSUER</CODE>, and <CODE>CIPHER</CODE> options can be
combined in the <CODE>REQUIRE</CODE> clause like this:

</P>

<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

<P>
Note that the <CODE>SUBJECT</CODE> and <CODE>ISSUER</CODE> values each should be entered
as a single string.

</P>
<P>
Starting from MySQL 4.0.4, the <CODE>AND</CODE> keyword is optional between
<CODE>REQUIRE</CODE> options.

</P>
<P>
The order of the options does not matter, but no option can be specified
twice.

</P>



<H4><A NAME="SSL_options" HREF="manual_toc.html#SSL_options">5.5.7.5  SSL Command-Line Options</A></H4>

<P>
<A NAME="IDX602"></A>

</P>
<P>
The following list describes options that are used for specifying the
use of SSL, certificate files, and key files.
These options are available beginning with MySQL 4.0. They may
be given on the command line or in an option file.

</P>
<DL COMPACT>

<DT><CODE>--ssl</CODE>
<DD>
For the server, this option specifies that the server allows SSL connections.
For a client program, it allows the client to connect to the server using SSL.
This option is not sufficient in itself to cause an SSL connection to be used.
You must also specify the
<CODE>--ssl-ca</CODE>, <CODE>--ssl-cert</CODE>, and <CODE>--ssl-key</CODE> options.

This option is more often used in its opposite form to indicate that SSL
should <STRONG>not</STRONG> be used. To do this, specify the option as
<CODE>--skip-ssl</CODE> or <CODE>--ssl=0</CODE>.

Note that use of <CODE>--ssl</CODE> doesn't <STRONG>require</STRONG> an SSL connection.
For example, if the server or client is compiled without SSL support,
a normal unencrypted connection will be used.

The secure way to ensure that an SSL connection will be used is
to create an account on the server that includes a
<CODE>REQUIRE SSL</CODE> clause in the <CODE>GRANT</CODE> statement.
Then use this account to connect to the server, with both a server and client
that have SSL support enabled.

<DT><CODE>--ssl-ca=file_name</CODE>
<DD>
The path to a file with a list of trusted SSL CAs.

<DT><CODE>--ssl-capath=directory_name</CODE>
<DD>
The path to a directory that contains trusted 
SSL CA certificates in pem format.

<DT><CODE>--ssl-cert=file_name</CODE>
<DD>
The name of the SSL certificate file to use
for establishing a secure connection.

<DT><CODE>--ssl-cipher=cipher_list</CODE>
<DD>
A list of allowable ciphers to use for SSL encryption.
<CODE>cipher_list</CODE> has the same format as the <CODE>openssl ciphers</CODE>
command.

Example: <CODE>--ssl-cipher=ALL:-AES:-EXP</CODE>

<DT><CODE>--ssl-key=file_name</CODE>
<DD>
The name of the SSL key file to use
for establishing a secure connection.

</DL>



<H4><A NAME="Windows_and_SSH" HREF="manual_toc.html#Windows_and_SSH">5.5.7.6  Connecting to MySQL Remotely from Windows with SSH</A></H4>

<P>
<A NAME="IDX603"></A>
<A NAME="IDX604"></A>

</P>
<P>
Here is a note about how to connect to get a secure connection to remote
MySQL server with SSH (by David Carlson <a HREF="mailto:dcarlson@mplcomm.com">dcarlson@mplcomm.com</a>):

</P>

<OL>
<LI>

Install an SSH client on your Windows machine.  As a user, the best non-free
one I've found is from <CODE>SecureCRT</CODE> from <a HREF="http://www.vandyke.com/">http://www.vandyke.com/</a>.
Another option is <CODE>f-secure</CODE> from <a HREF="http://www.f-secure.com/">http://www.f-secure.com/</a>. You
can also find some free ones on <CODE>Google</CODE> at
<a HREF="http://directory.google.com/Top/Computers/Security/Products_and_Tools/Cryptography/SSH/Clients/Windows/">http://directory.google.com/Top/Computers/Security/Products_and_Tools/Cryptography/SSH/Clients/Windows/</a>.

<LI>

Start your Windows SSH client.
Set <CODE>Host_Name = yourmysqlserver_URL_or_IP</CODE>.
Set <CODE>userid=your_userid</CODE> to log in to your server. This <CODE>userid</CODE>
value may not be the same as the username of your MySQL account.

<LI>

Set up port forwarding. Either do a remote forward (Set <CODE>local_port: 3306</CODE>, <CODE>remote_host: yourmysqlservername_or_ip</CODE>, <CODE>remote_port: 3306</CODE> )
or a local forward (Set <CODE>port: 3306</CODE>,  <CODE>host: localhost</CODE>, <CODE>remote port: 3306</CODE>).

<LI>

Save everything, otherwise you'll have to redo it the next time.

<LI>

Log in to your server with the SSH session you just created.

<LI>

On your Windows machine, start some ODBC application (such as Access).

<LI>

Create a new file in Windows and link to MySQL using the ODBC
driver the same way you normally do, except type in <CODE>localhost</CODE>
for the MySQL host server--not <CODE>yourmysqlservername</CODE>.
</OL>

<P>
You should now have an ODBC connection to MySQL, encrypted using SSH.

</P>



<H2><A NAME="Disaster_Prevention" HREF="manual_toc.html#Disaster_Prevention">5.6  Disaster Prevention and Recovery</A></H2>

<P>
This section discusses how to make database backups and how to perform
table maintenance.  The syntax of the SQL statements described here is
given in section <A HREF="manual.html#Database_Administration">14.5  Database Administration Statements</A>.

</P>



<H3><A NAME="Backup" HREF="manual_toc.html#Backup">5.6.1  Database Backups</A></H3>

<P>
<A NAME="IDX605"></A>
<A NAME="IDX606"></A>

</P>
<P>
Because MySQL tables are stored as files, it is easy to do a
backup. To get a consistent backup, do a <CODE>LOCK TABLES</CODE> on the
relevant tables, followed by <CODE>FLUSH TABLES</CODE> for the tables.
See section <A HREF="manual.html#LOCK_TABLES">14.4.5  <CODE>LOCK TABLES</CODE> and <CODE>UNLOCK TABLES</CODE> Syntax</A>.
See section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>.
You need only a read lock; this allows other clients to continue to
query the tables while you are making a copy of the files in the
database directory.  The <CODE>FLUSH TABLES</CODE> statement is needed to ensure that
the all active index pages are written to disk before you start the backup.

</P>

<P>
If you want to make an SQL-level backup of a table, you can use
<CODE>SELECT INTO ... OUTFILE</CODE> or <CODE>BACKUP TABLE</CODE>.
For <CODE>SELECT INTO ... OUTFILE</CODE>, the output file cannot already exist.
For <CODE>BACKUP TABLE</CODE>, the same is true as of
MySQL 3.23.56 and 4.0.12, because this would be a security risk.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.
See section <A HREF="manual.html#BACKUP_TABLE">14.5.2.2  <CODE>BACKUP TABLE</CODE> Syntax</A>.

</P>
<P>
Another way to back up a database is to use the <CODE>mysqldump</CODE> program or
the <CODE>mysqlhotcopy script</CODE>. See section <A HREF="manual.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A>.
See section <A HREF="manual.html#mysqlhotcopy">8.9  The <CODE>mysqlhotcopy</CODE> Database Backup Program</A>.

</P>

<OL>
<LI>

Do a full backup of your database:


<PRE>
shell&#62; mysqldump --tab=/path/to/some/dir --opt db_name
</PRE>

Or:


<PRE>
shell&#62; mysqlhotcopy db_name /path/to/some/dir
</PRE>

You can also simply copy all table files (<TT>`*.frm'</TT>, <TT>`*.MYD'</TT>, and
<TT>`*.MYI'</TT> files) as long as the server isn't updating anything.
The <CODE>mysqlhotcopy</CODE> script uses this method.  (But note that these
methods
will not work if your database contains <CODE>InnoDB</CODE> tables.  <CODE>InnoDB</CODE>
does not store table contents in database directories, and <CODE>mysqlhotcopy</CODE>
works only for <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables.)

<LI>

<A NAME="IDX607"></A>
Stop <CODE>mysqld</CODE> if it's running, then start it with the
<CODE>--log-bin[=file_name]</CODE> option.  See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>. The binary
log files provide you with the information you need to replicate
changes to the database that are made subsequent to the point at which
you executed <CODE>mysqldump</CODE>.
</OL>

<P>
If your MySQL server is a slave replication server, then regardless of the
backup method you choose, you should also back up the
<TT>`master.info'</TT> and <TT>`relay-log.info'</TT> files
when you back up your slave's data. These files
are always needed to resume replication after you restore
the slave's data. If your slave is subject to replicating <CODE>LOAD
DATA INFILE</CODE> commands, you should also back up any <TT>`SQL_LOAD-*'</TT> files
that may exist in the directory specified by the <CODE>--slave-load-tmpdir</CODE>
option. (This location defaults to the value of the <CODE>tmpdir</CODE> variable
if not specified.) The slave needs these files to resume
replication of any interrupted <CODE>LOAD DATA INFILE</CODE> operations. 

</P>
<P>
If you have to restore something, try to recover your tables using
<CODE>REPAIR TABLE</CODE> or <CODE>myisamchk -r</CODE> first.  That should work in
99.9% of all cases.  If <CODE>myisamchk</CODE> fails, try the following procedure.
Note that it will work only if you have enabled binary logging by starting
MySQL with the <CODE>--log-bin</CODE> option; see section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>

<OL>
<LI>

Restore the original <CODE>mysqldump</CODE> backup, or binary backup.
<LI>

Execute the following command to re-run the updates in the binary logs:


<PRE>
shell&#62; mysqlbinlog hostname-bin.[0-9]* | mysql
</PRE>

In your case, you may want to re-run only certain binary logs, from
certain positions (usually you want to re-run all binary logs from the
date of the restored backup, excepting possibly some incorrect queries).
See section <A HREF="manual.html#mysqlbinlog">8.5  The <CODE>mysqlbinlog</CODE> Binary Log Utility</A> for more information on
the <CODE>mysqlbinlog</CODE> utility and how to use it.

If you are using the update logs instead,
you can process their contents like this:


<PRE>
shell&#62; ls -1 -t -r hostname.[0-9]* | xargs cat | mysql
</PRE>

<CODE>ls</CODE> is used to sort the update log filenames into the right order.

</OL>

<P>
You can also do selective backups of individual files:

</P>

<UL>
<LI>

To dump the table, use
<CODE>SELECT * INTO OUTFILE 'file_name' FROM tbl_name</CODE>.

<LI>

To reload the table, use and restore with
<CODE>LOAD DATA INFILE 'file_name' REPLACE ...</CODE>
To avoid duplicate records, the table must have a <CODE>PRIMARY KEY</CODE> or a
<CODE>UNIQUE</CODE> index. The <CODE>REPLACE</CODE> keyword causes old records
to be replaced with new ones when a new record duplicates an old record on
a unique key value.

</UL>

<P>
If you have performance problems with your server while making backups, one
strategy that can help is to set up replication and perform backups on the
slave rather than on the master.
See section <A HREF="manual.html#Replication_Intro">6.1  Introduction to Replication</A>.

</P>
<P>
If you are using a Veritas filesystem, you can make a backup like this:

</P>

<OL>
<LI>

From a client program, execute: <CODE>FLUSH TABLES WITH READ LOCK</CODE>.

<LI>

From another shell, execute: <CODE>mount vxfs snapshot</CODE>.

<LI>

From the first client, execute: <CODE>UNLOCK TABLES</CODE>.

<LI>

Copy files from the snapshot.

<LI>

Unmount the snapshot.
</OL>



<H3><A NAME="Table_maintenance" HREF="manual_toc.html#Table_maintenance">5.6.2  Using <CODE>myisamchk</CODE> for Table Maintenance and Crash Recovery</A></H3>

<P>
The following text discusses how to use <CODE>myisamchk</CODE> to check or repair
<CODE>MyISAM</CODE> tables (tables with <TT>`.MYI'</TT> and <TT>`.MYD'</TT> files).
The same concepts apply to using <CODE>isamchk</CODE> to check or repair
<CODE>ISAM</CODE> tables (tables with <TT>`.ISM'</TT> and <TT>`.ISD'</TT> files).
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
You can use the <CODE>myisamchk</CODE> utility to get information about your
database tables or to check, repair, or optimize them.  The following
sections describe how to invoke <CODE>myisamchk</CODE> (including a
description of its options), how to set up a table maintenance schedule,
and how to use <CODE>myisamchk</CODE> to perform its various functions.

</P>
<P>
Even though table repair with <CODE>myisamchk</CODE> is quite secure, it's
always a good idea to make a backup <EM>before</EM> doing a repair (or any
maintenance operation that could make a lot of changes to a table)

</P>
<P>
<CODE>myisamchk</CODE> operations that affect indexes can cause
<CODE>FULLTEXT</CODE> indexes to be rebuilt with full-text parameters that
are incompatible with the values used by the MySQL server. To avoid this,
read the instructions in
section <A HREF="manual.html#myisamchk_general_options">5.6.2.2  General Options for <CODE>myisamchk</CODE></A>.

</P>
<P>
An alternative to using <CODE>myisamchk</CODE> for checking or repairing
<CODE>MyISAM</CODE> tables is to use the <CODE>CHECK TABLE</CODE> or <CODE>REPAIR TABLE</CODE>
statements, which are available as of MySQL 3.23.13.
See section <A HREF="manual.html#CHECK_TABLE">14.5.2.3  <CODE>CHECK TABLE</CODE> Syntax</A> and section <A HREF="manual.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A>.

</P>
<P>
In most cases, you can also use the <CODE>OPTIMIZE TABLES</CODE> statement to
optimize and repair tables, but this is not as fast or reliable (in case
of really serious problems) as <CODE>myisamchk</CODE>.  On the other hand,
<CODE>OPTIMIZE TABLE</CODE> is easier to use and you don't have to worry about
flushing tables.
See section <A HREF="manual.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A>.

</P>
<P>
The <CODE>mysqlcheck</CODE> client program provides a command-line interface to the
<CODE>CHECK TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, and <CODE>OPTIMIZE TABLE</CODE> statements.

</P>



<H4><A NAME="myisamchk_syntax" HREF="manual_toc.html#myisamchk_syntax">5.6.2.1  <CODE>myisamchk</CODE> Invocation Syntax</A></H4>

<P>
Invoke <CODE>myisamchk</CODE> like this:

</P>

<PRE>
shell&#62; myisamchk [options] tbl_name
</PRE>

<P>
The <CODE>options</CODE> specify what you want <CODE>myisamchk</CODE> to do.  They are
described in the following sections.  You can also get a list of options by
invoking <CODE>myisamchk --help</CODE>.

</P>
<P>
With no options, <CODE>myisamchk</CODE> simply checks your table as the default
operation.  To get more information or to tell <CODE>myisamchk</CODE> to take
corrective action, specify options as described in the following discussion.

</P>
<P>
<CODE>tbl_name</CODE> is the database table you want to check or repair.  If you run
<CODE>myisamchk</CODE> somewhere other than in the database directory, you must
specify the path to the database directory, because <CODE>myisamchk</CODE> has no
idea where the
database is located.  In fact <CODE>myisamchk</CODE> doesn't actually care whether
the files you are working on are located in a database directory. You can
copy the files that correspond to a database table into some other location and
perform recovery operations on them there.

</P>
<P>
You can name several tables on the <CODE>myisamchk</CODE> command line if you
wish.  You can also specify a table by naming its index file (the file with
the <TT>`.MYI'</TT> suffix). This allows you to specify all tables in a
directory by using the pattern <TT>`*.MYI'</TT>.  For example, if you are in a
database directory, you can check all the <CODE>MyISAM</CODE> tables in that
directory like this:

</P>

<PRE>
shell&#62; myisamchk *.MYI
</PRE>

<P>
If you are not in the database directory, you can check all the tables there
by specifying the path to the directory:

</P>

<PRE>
shell&#62; myisamchk /path/to/database_dir/*.MYI
</PRE>

<P>
You can even check all tables in all databases by specifying a wildcard
with the path to the MySQL data directory:

</P>

<PRE>
shell&#62; myisamchk /path/to/datadir/*/*.MYI
</PRE>

<P>
The recommended way to quickly check all <CODE>MyISAM</CODE> and <CODE>ISAM</CODE>
tables is:

</P>

<PRE>
shell&#62; myisamchk --silent --fast /path/to/datadir/*/*.MYI
shell&#62; isamchk --silent /path/to/datadir/*/*.ISM
</PRE>

<P>
If you want to check all <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables and repair any
that are corrupted, you can use the following commands:

</P>

<PRE>
shell&#62; myisamchk --silent --force --fast --update-state \
          -O key_buffer=64M -O sort_buffer=64M \
          -O read_buffer=1M -O write_buffer=1M \
          /path/to/datadir/*/*.MYI
shell&#62; isamchk --silent --force -O key_buffer=64M \
          -O sort_buffer=64M -O read_buffer=1M -O write_buffer=1M \
          /path/to/datadir/*/*.ISM
</PRE>

<P>
These commands assume that you have more than 64MB free.
For more information about memory allocation with <CODE>myisamchk</CODE>, see
section <A HREF="manual.html#myisamchk_memory">5.6.2.6  <CODE>myisamchk</CODE> Memory Usage</A>.

</P>
<P>
You must ensure that no other program is using the tables while you are
running <CODE>myisamchk</CODE>.

</P>
<P>
When you run <CODE>myisamchk</CODE>, it may display the following error message:

</P>

<PRE>
warning: clients are using or haven't closed the table properly
</PRE>

<P>
This means that you are trying to check a table that has been updated by
another program (such as the <CODE>mysqld</CODE> server) that hasn't yet closed
the file or that has died without closing the file properly.

</P>
<P>
If <CODE>mysqld</CODE> is running, you must force it to flush any table
modifications that are still buffered in memory by using <CODE>FLUSH
TABLES</CODE>. You should then ensure that no one is using the tables while you
are running <CODE>myisamchk</CODE>.  In MySQL Version 3.23, the easiest way to
avoid this problem is to use <CODE>CHECK TABLE</CODE> instead of <CODE>myisamchk</CODE>
to check tables.

</P>


<H4><A NAME="myisamchk_general_options" HREF="manual_toc.html#myisamchk_general_options">5.6.2.2  General Options for <CODE>myisamchk</CODE></A></H4>

<P>
<A NAME="IDX608"></A>
<A NAME="IDX609"></A>

</P>
<P>
The options described in this section can be used for any
type of table maintenance operation performed by <CODE>myisamchk</CODE>.
The sections following this one describe options that pertain only to specific
operations, such as table checking or repairing.

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--debug=debug_options, -# debug_options</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--silent, -s</CODE>
<DD>
Silent mode.  Write output only when errors occur. You can use <CODE>-s</CODE>
twice (<CODE>-ss</CODE>) to make <CODE>myisamchk</CODE> very silent.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Print more information. This can be used with <CODE>-d</CODE> and
<CODE>-e</CODE>. Use <CODE>-v</CODE> multiple times (<CODE>-vv</CODE>, <CODE>-vvv</CODE>) for even
more output.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

<DT><CODE>--wait, -w</CODE>
<DD>
Instead of terminating with an error if the table is locked, wait until the
table is unlocked before continuing.  Note that if you are running
<CODE>mysqld</CODE> with the <CODE>--skip-external-locking</CODE> option, the table can
be locked only by another <CODE>myisamchk</CODE> command.

</DL>

<P>
You can also set the following variables by using <CODE>--var_name=value</CODE>
options:

</P>
<P>
<A NAME="IDX610"></A>
<A NAME="IDX611"></A>
<A NAME="IDX612"></A>
<A NAME="IDX613"></A>
<A NAME="IDX614"></A>
<A NAME="IDX615"></A>
<A NAME="IDX616"></A>
<A NAME="IDX617"></A>
<A NAME="IDX618"></A>
<A NAME="IDX619"></A>

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Variable</STRONG> </TD><TD> <STRONG>Default Value</STRONG>
</TD></TR>
<TR><TD><CODE>decode_bits</CODE> </TD><TD> 9
</TD></TR>
<TR><TD><CODE>ft_max_word_len</CODE> </TD><TD> version-dependent
</TD></TR>
<TR><TD><CODE>ft_min_word_len</CODE> </TD><TD> 4
</TD></TR>
<TR><TD><CODE>ft_stopword_file</CODE> </TD><TD> built-in list
</TD></TR>
<TR><TD><CODE>key_buffer_size</CODE> </TD><TD> 523264
</TD></TR>
<TR><TD><CODE>myisam_block_size</CODE> </TD><TD> 1024
</TD></TR>
<TR><TD><CODE>read_buffer_size</CODE> </TD><TD> 262136
</TD></TR>
<TR><TD><CODE>sort_buffer_size</CODE> </TD><TD> 2097144
</TD></TR>
<TR><TD><CODE>sort_key_blocks</CODE> </TD><TD> 16
</TD></TR>
<TR><TD><CODE>write_buffer_size</CODE> </TD><TD> 262136
</TD></TR>
</TABLE>

<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
The possible <CODE>myisamchk</CODE> variables and their default values
can be examined with <CODE>myisamchk --help</CODE>:

</P>
<P>
<CODE>sort_buffer_size</CODE> is used when the keys are repaired by sorting
keys, which is the normal case when you use <CODE>--recover</CODE>.

</P>
<P>
<CODE>key_buffer_size</CODE> is used when you are checking the table with
<CODE>--extend-check</CODE> or when the keys are repaired by inserting keys
row by row into the table (like when doing normal inserts). Repairing
through the key buffer is used in the following cases:

</P>

<UL>

<LI>

If you use <CODE>--safe-recover</CODE>.

<LI>

If the temporary files needed to sort the keys would be more than twice as
big as when creating the key file directly.  This is often the case when you
have large key values for  <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, or <CODE>TEXT</CODE>
columns, because the sort operation needs to store the complete key values
as it proceeds. If you have lots of temporary space and you can force
<CODE>myisamchk</CODE> to repair by sorting, you can use the <CODE>--sort-recover</CODE>
option.

</UL>

<P>
Repairing through the key buffer takes much less disk space than using
sorting, but is also much slower.

</P>
<P>
If you want a faster repair, set the <CODE>key_buffer_size</CODE> and
<CODE>sort_buffer_size</CODE> variables to about 25% of your available memory.
You can set both variables to large values, because only one of them is used
at a time.

</P>
<P>
The <CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>, and
<CODE>myisam_block_size</CODE> variables are available as of MySQL 4.0.0.
<CODE>ft_stopword_file</CODE> is available as of MySQL 4.0.19.

</P>
<P>
<CODE>myisam_block_size</CODE> is the size used for index blocks.

</P>
<P>
<CODE>ft_min_word_len</CODE> and <CODE>ft_max_word_len</CODE> indicate the minimum and
maximum word length for <CODE>FULLTEXT</CODE> indexes. <CODE>ft_stopword_file</CODE>
names the stopword file. These need to be set under the following
circumstances.

</P>
<P>
If you use <CODE>myisamchk</CODE> to perform an operation that modifies
table indexes (such as repair or analyze), the <CODE>FULLTEXT</CODE> indexes
are rebuilt using the default full-text parameter values for minimum and
maximum word length and the stopword file unless you specify otherwise.
This can result in queries failing.

</P>
<P>
The problem occurs because these parameters are known only by the server.
They are not stored in <CODE>MyISAM</CODE> index files.  To avoid the problem if
you have modified the minimum or maximum word length or the stopword file in
the server, specify the same <CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>,
and <CODE>ft_stopword_file</CODE> values to <CODE>myisamchk</CODE> that you use for
<CODE>mysqld</CODE>. For example, if you have set the minimum word length to 3,
you can repair a table with <CODE>myisamchk</CODE> like this:

</P>

<PRE>
shell&#62; myisamchk --recover --ft_min_word_len=3 tbl_name.MYI
</PRE>

<P>
To ensure that <CODE>myisamchk</CODE> and the server use the same values for
full-text parameters, you can place each one in both the <CODE>[mysqld]</CODE>
and <CODE>[myisamchk]</CODE> sections of an option file:

</P>

<PRE>
[mysqld]
ft_min_word_len=3

[myisamchk]
ft_min_word_len=3
</PRE>

<P>
An alternative to using <CODE>myisamchk</CODE> is to use the <CODE>REPAIR TABLE</CODE>,
<CODE>ANALYZE TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, or <CODE>ALTER TABLE</CODE>.
These statements are performed by the server, which knows the proper
full-text parameter values to use.

</P>



<H4><A NAME="myisamchk_check_options" HREF="manual_toc.html#myisamchk_check_options">5.6.2.3  Check Options for <CODE>myisamchk</CODE></A></H4>

<P>
<A NAME="IDX620"></A>
<A NAME="IDX621"></A>

</P>
<P>
<CODE>myisamchk</CODE> supports the following options for table checking operations:

</P>
<DL COMPACT>

<DT><CODE>--check, -c</CODE>
<DD>
Check the table for errors. This is the default operation if you specify no
option that selects an operation type explicitly.

<DT><CODE>--check-only-changed, -C</CODE>
<DD>
Check only tables that have changed since the last check.

<DT><CODE>--extend-check, -e</CODE>
<DD>
Check the table very thoroughly. This is quite slow if the table has many
indexes.  This option should only be used in extreme cases.  Normally,
<CODE>myisamchk</CODE> or <CODE>myisamchk --medium-check</CODE> should
be able to determine whether there are any errors in the table.

If you are using <CODE>--extend-check</CODE> and have plenty of memory, setting
the <CODE>key_buffer_size</CODE> variable to a large value will help the repair
operation run faster.

<DT><CODE>--fast, -F</CODE>
<DD>
Check only tables that haven't been closed properly.

<DT><CODE>--force, -f</CODE>
<DD>
Do a repair operation automatically if
<CODE>myisamchk</CODE> finds any errors in the table.
The repair type is the same as that specified with the <CODE>--repair</CODE> or
<CODE>-r</CODE> option.

<DT><CODE>--information, -i</CODE>
<DD>
Print informational statistics about the table that is checked.

<DT><CODE>--medium-check, -m</CODE>
<DD>
Do a check that is faster than an <CODE>--extend-check</CODE> operation.
This finds only 99.99% of all errors, which should be good enough in most cases.

<DT><CODE>--read-only, -T</CODE>
<DD>
Don't mark the table as checked. This is useful if you use <CODE>myisamchk</CODE>
to check a table that is in use by some other application that doesn't
use locking, such as <CODE>mysqld</CODE> when run with the
<CODE>--skip-external-locking</CODE> option.

<DT><CODE>--update-state, -U</CODE>
<DD>
Store information in the <TT>`.MYI'</TT> file to indicate when the table was
checked and whether the table crashed.  This should be used to get full benefit of the
<CODE>--check-only-changed</CODE> option, but you shouldn't use this
option if the <CODE>mysqld</CODE> server is using the table and you are
running it with the <CODE>--skip-external-locking</CODE> option.

</DL>



<H4><A NAME="myisamchk_repair_options" HREF="manual_toc.html#myisamchk_repair_options">5.6.2.4  Repair Options for <CODE>myisamchk</CODE></A></H4>

<P>
<A NAME="IDX622"></A>
<A NAME="IDX623"></A>

</P>
<P>
<CODE>myisamchk</CODE> supports the following options for table repair operations:

</P>
<DL COMPACT>

<DT><CODE>--backup, -B</CODE>
<DD>
Make a backup of the <TT>`.MYD'</TT> file as <TT>`filename-time.BAK'</TT>

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--correct-checksum</CODE>
<DD>
Correct the checksum information for the table.

<DT><CODE>--data-file-length=#, -D #</CODE>
<DD>
Maximum length of the data file (when re-creating data file when it's ``full'').

<DT><CODE>--extend-check, -e</CODE>
<DD>
Do a repair that tries to
to recover every possible row from the data file.
Normally this will also find a lot of garbage rows. Don't use this option
unless you are totally desperate.

<DT><CODE>--force, -f</CODE>
<DD>
Overwrite old temporary files (files with names like <TT>`tbl_name.TMD'</TT>)
instead of aborting.

<DT><CODE>--keys-used=#, -k #</CODE>
<DD>
For <CODE>myisamchk</CODE>, the option value indicates which indexes to update.
Each binary bit of the option value corresponds to a table index, where the
first index is bit 0.
For <CODE>isamchk</CODE>, the option value indicates that only the first <CODE>#</CODE> of
the table indexes should be updated.
In either case, an option value of 0 disables updates to all indexes, which
can be used to get faster inserts.
Deactivated indexes can be reactivated by using <CODE>myisamchk -r</CODE>
or (<CODE>isamchk -r</CODE>).

<DT><CODE>--no-symlinks, -l</CODE>
<DD>
Do not follow symbolic links. Normally <CODE>myisamchk</CODE> repairs the
table that a symlink points to.  This option doesn't exist as of MySQL 4.0,
because versions from 4.0 on will not remove symlinks during repair operations.

<DT><CODE>--parallel-recover, -p</CODE>
<DD>
Uses the same technique as <CODE>-r</CODE> and <CODE>-n</CODE>, but creates
all the keys in parallel, using different threads.
This option was added in MySQL 4.0.2.
<STRONG>This is alpha code. Use at your own risk!</STRONG>

<DT><CODE>--quick, -q</CODE>
<DD>
Achieve a faster repair by not modifying the data file. You can specify this
option twice to force <CODE>myisamchk</CODE> to modify the original data file in
case of duplicate keys.

<DT><CODE>--recover, -r</CODE>
<DD>
Do a repair that can fix almost any problem except unique keys that aren't
unique (which is an extremely unlikely error with <CODE>ISAM</CODE>/<CODE>MyISAM</CODE>
tables).  If you want to recover a table, this is the option to try
first. You should try <CODE>-o</CODE> only if <CODE>myisamchk</CODE> reports that the
table can't be recovered by <CODE>-r</CODE>.  (Note that in the unlikely case
that <CODE>-r</CODE> fails, the data file is still intact.)

If you have lots of memory, you should increase the value of
<CODE>sort_buffer_size</CODE>.

<DT><CODE>--safe-recover, -o</CODE>
<DD>
Do a repair using
an old recovery method that reads through all rows in order and updates
all index trees based on the rows found.  This is an order of magnitude
slower than <CODE>-r</CODE>, but can handle a couple of very unlikely cases that
<CODE>-r</CODE> cannot.  This recovery method also uses much less disk
space than <CODE>-r</CODE>. Normally, you should repair first with
<CODE>-r</CODE>, and then with <CODE>-o</CODE> only if <CODE>-r</CODE> fails.

If you have lots of memory, you should increase the value of
<CODE>key_buffer_size</CODE>.

<DT><CODE>--set-character-set=name</CODE>
<DD>
Change the character set used by the table indexes.

<DT><CODE>--sort-recover, -n</CODE>
<DD>
Force <CODE>myisamchk</CODE> to use sorting to resolve the keys even if the
temporary files should be very big.

<DT><CODE>--tmpdir=path, -t path</CODE>
<DD>
Path of the directory to be used for storing temporary files. If this is not
set, <CODE>myisamchk</CODE> uses the value of the <CODE>TMPDIR</CODE> environment variable.
Starting from MySQL 4.1, <CODE>tmpdir</CODE> can be set to a list of directory paths
that will be used successively in round-robin fashion for creating
temporary files. The separator character between directory names should be
colon (<SAMP>`:'</SAMP>) on Unix and semicolon (<SAMP>`;'</SAMP>) on Windows, NetWare, and
OS/2.

<DT><CODE>--unpack, -u</CODE>
<DD>
Unpack a table that was packed with <CODE>myisampack</CODE>.
</DL>



<H4><A NAME="myisamchk_other_options" HREF="manual_toc.html#myisamchk_other_options">5.6.2.5  Other Options for <CODE>myisamchk</CODE></A></H4>

<P>
<CODE>myisamchk</CODE> supports the following options for actions other than
table checks and repairs:

</P>
<DL COMPACT>

<DT><CODE>--analyze, -a</CODE>
<DD>
Analyze the distribution of keys. This improves join performance by enabling
the join optimizer to better choose the order in which to join the tables
and which keys it should use. To obtain information about the distribution,
use a <CODE>myisamchk --description --verbose tbl_name</CODE> command or the
<CODE>SHOW KEYS FROM tbl_name</CODE> statement.

<DT><CODE>--description, -d</CODE>
<DD>
Print some descriptive information about the table.

<DT><CODE>--set-auto-increment[=value], -A[value]</CODE>
<DD>
Force <CODE>AUTO_INCREMENT</CODE> numbering for new records to start at the given
value (or higher, if there are already records with <CODE>AUTO_INCREMENT</CODE>
values this large). If <CODE>value</CODE> is not specified, <CODE>AUTO_INCREMENT</CODE>
number for new records begins with the largest value currently in the table,
plus one.

<DT><CODE>--sort-index, -S</CODE>
<DD>
Sort the index tree blocks in high-low order.
This optimizes seeks and makes table scanning by key faster.

<DT><CODE>--sort-records=#, -R #</CODE>
<DD>
Sort records according to a particular index.  This makes your data much
more localized and may speed up range-based <CODE>SELECT</CODE> and <CODE>ORDER
BY</CODE> operations that use this index. (The first time you use this option to
sort a table, it may be very slow.) To determine a table's index numbers,
use <CODE>SHOW KEYS</CODE>, which displays a table's indexes in the same order
that <CODE>myisamchk</CODE> sees them.  Indexes are numbered beginning with 1.

</DL>



<H4><A NAME="myisamchk_memory" HREF="manual_toc.html#myisamchk_memory">5.6.2.6  <CODE>myisamchk</CODE> Memory Usage</A></H4>

<P>
<A NAME="IDX624"></A>

</P>
<P>
Memory allocation is important when you run <CODE>myisamchk</CODE>.
<CODE>myisamchk</CODE> uses no more memory than you specify with the <CODE>-O</CODE>
options.  If you are going to use <CODE>myisamchk</CODE> on very large tables,
you should first decide how much memory you want it to use.  The default
is to use only about 3MB to perform repairs.  By using larger values, you can
get <CODE>myisamchk</CODE> to operate faster.  For example, if you have more
than 32MB RAM, you could use options such as these (in addition to any
other options you might specify):

</P>

<PRE>
shell&#62; myisamchk -O sort=16M -O key=16M -O read=1M -O write=1M ...
</PRE>

<P>
Using <CODE>-O sort=16M</CODE> should probably be enough for most cases.

</P>
<P>
Be aware that <CODE>myisamchk</CODE> uses temporary files in <CODE>TMPDIR</CODE>. If
<CODE>TMPDIR</CODE> points to a memory filesystem, you may easily get out of
memory errors. If this happens, set <CODE>TMPDIR</CODE> to point at some directory
located on a filesystem
with more space and run <CODE>myisamchk</CODE> again.

</P>
<P>
When repairing, <CODE>myisamchk</CODE> will also need a lot of disk space:

</P>

<UL>
<LI>

Double the size of the record file (the original one and a copy).  This
space is not needed if you do a repair with <CODE>--quick</CODE>; in this
case, only the index file is re-created.  This space is needed on the same
filesystem as the original record file! (The copy is created in the
same directory as the original.)

<LI>

Space for the new index file that replaces the old one. The old index file
is truncated at the start of the repair operation, so you usually ignore
this space.  This space is needed on the same filesystem as the original
index file!

<LI>

When using <CODE>--recover</CODE> or <CODE>--sort-recover</CODE>
(but not when using <CODE>--safe-recover</CODE>), you will need space for a
sort buffer. The amount of space required is:


<PRE>
(largest_key + row_pointer_length) * number_of_rows * 2
</PRE>

You can check the length of the keys and the <CODE>row_pointer_length</CODE>
with <CODE>myisamchk -dv tbl_name</CODE>.  This space is allocated in the temporary
directory (specified by <CODE>TMPDIR</CODE> or <CODE>--tmpdir=#</CODE>).

</UL>

<P>
If you have a problem with disk space during repair, you can try to use
<CODE>--safe-recover</CODE> instead of <CODE>--recover</CODE>.

</P>



<H4><A NAME="Crash_recovery" HREF="manual_toc.html#Crash_recovery">5.6.2.7  Using <CODE>myisamchk</CODE> for Crash Recovery</A></H4>

<P>
<A NAME="IDX625"></A>
<A NAME="IDX626"></A>

</P>
<P>
If you run <CODE>mysqld</CODE> with <CODE>--skip-external-locking</CODE> (which is the
default on some systems, such as Linux), you can't reliably use <CODE>myisamchk</CODE>
to check a table when <CODE>mysqld</CODE> is using the same table.  If you
can be sure that no one is accessing the tables through <CODE>mysqld</CODE>
while you run <CODE>myisamchk</CODE>, you only have to do <CODE>mysqladmin
flush-tables</CODE> before you start checking the tables.  If you can't
guarantee this, then you must stop <CODE>mysqld</CODE> while you
check the tables.  If you run <CODE>myisamchk</CODE> while <CODE>mysqld</CODE> is updating
the tables, you may get a warning that a table is corrupt even when it
isn't.

</P>
<P>
If you are not using <CODE>--skip-external-locking</CODE>, you can use
<CODE>myisamchk</CODE> to check tables at any time.  While you do this, all clients
that try to update the table will wait until <CODE>myisamchk</CODE> is ready before
continuing.

</P>
<P>
If you use <CODE>myisamchk</CODE> to repair or optimize tables, you
<STRONG>must</STRONG> always ensure that the <CODE>mysqld</CODE> server is not using
the table (this also applies if you are using <CODE>--skip-external-locking</CODE>).
If you don't take down <CODE>mysqld</CODE>, you should at least do a
<CODE>mysqladmin flush-tables</CODE> before you run <CODE>myisamchk</CODE>.
Your tables <STRONG>may become corrupted</STRONG> if the server and <CODE>myisamchk</CODE>
access the tables simultaneously.

</P>
<P>
This section describes how to check for and deal with data corruption
in MySQL databases.  If your tables get corrupted frequently you should
try to find the reason why.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
The <CODE>MyISAM</CODE> table section contains reason for why a table could be
corrupted. See section <A HREF="manual.html#MyISAM_table_problems">15.1.4  <CODE>MyISAM</CODE> Table Problems</A>.

</P>
<P>
When performing crash recovery, it is important to understand that each table
<CODE>tbl_name</CODE> in a database corresponds to three files in the database
directory:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>File</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TD></TR>
<TR><TD><TT>`tbl_name.frm'</TT> </TD><TD> Definition (format) file
</TD></TR>
<TR><TD><TT>`tbl_name.MYD'</TT> </TD><TD> Data file
</TD></TR>
<TR><TD><TT>`tbl_name.MYI'</TT> </TD><TD> Index file
</TD></TR>
</TABLE>

<P>
Each of these three file types is subject to corruption in various ways, but
problems occur most often in data files and index files.

</P>
<P>
<CODE>myisamchk</CODE> works by creating a copy of the <TT>`.MYD'</TT> data file
row by row. It ends the repair stage by removing the old <TT>`.MYD'</TT>
file and renaming the new file to the original file name.  If you use
<CODE>--quick</CODE>, <CODE>myisamchk</CODE> does not create a temporary <TT>`.MYD'</TT>
file, but instead assumes that the <TT>`.MYD'</TT> file is correct and only
generates a new index file without touching the <TT>`.MYD'</TT> file. This is
safe, because <CODE>myisamchk</CODE> automatically detects whether the <TT>`.MYD'</TT>
file is corrupt and aborts the repair if it is.  You can also specify
the <CODE>--quick</CODE> option twice to <CODE>myisamchk</CODE>.  In this case,
<CODE>myisamchk</CODE> does not abort on some errors (such as duplicate-key
errors) but instead tries to resolve them by modifying the <TT>`.MYD'</TT>
file. Normally the use of two <CODE>--quick</CODE> options is useful only if you
have too little free disk space to perform a normal repair.  In this case,
you should at least make a backup before running <CODE>myisamchk</CODE>.

</P>



<H4><A NAME="Check" HREF="manual_toc.html#Check">5.6.2.8  How to Check <CODE>MyISAM</CODE> Tables for Errors</A></H4>

<P>
<A NAME="IDX627"></A>
<A NAME="IDX628"></A>
<A NAME="IDX629"></A>

</P>
<P>
To check a <CODE>MyISAM</CODE> table, use the following commands:

</P>
<DL COMPACT>

<DT><CODE>myisamchk tbl_name</CODE>
<DD>
This finds 99.99% of all errors. What it can't find is corruption that
involves <STRONG>only</STRONG> the data file (which is very unusual). If you want
to check a table, you should normally run <CODE>myisamchk</CODE> without options or
with either the <CODE>-s</CODE> or <CODE>--silent</CODE> option.

<DT><CODE>myisamchk -m tbl_name</CODE>
<DD>
This finds 99.999% of all errors. It first checks all index entries for
errors and then reads through all rows. It calculates a checksum for
all keys in the rows and verifies that the checksum matches the checksum
for the keys in the index tree.

<DT><CODE>myisamchk -e tbl_name</CODE>
<DD>
This does a complete and thorough check of all data (<CODE>-e</CODE> means
``extended check''). It does a check-read of every key for each row to verify
that they indeed point to the correct row.  This may take a long time for a
large table that has many indexes.  Normally, <CODE>myisamchk</CODE> stops after
the first error it finds. If you want to obtain more information, you can
add the <CODE>--verbose</CODE> (<CODE>-v</CODE>) option.  This causes <CODE>myisamchk</CODE>
to keep going, up through a maximum of 20 errors.

<DT><CODE>myisamchk -e -i tbl_name</CODE>
<DD>
Like the previous command, but the <CODE>-i</CODE> option tells <CODE>myisamchk</CODE> to
print some informational statistics, too.

</DL>

<P>
In most cases, a simple <CODE>myisamchk</CODE> with no arguments other than the
table name is sufficient to check a table.

</P>



<H4><A NAME="Repair" HREF="manual_toc.html#Repair">5.6.2.9  How to Repair Tables</A></H4>

<P>
<A NAME="IDX630"></A>
<A NAME="IDX631"></A>

</P>
<P>
The discussion in this section describes how to use <CODE>myisamchk</CODE> on
<CODE>MyISAM</CODE> tables (extensions <TT>`.MYI'</TT> and <TT>`.MYD'</TT>).  If you
are using <CODE>ISAM</CODE> tables (extensions <TT>`.ISM'</TT> and <TT>`.ISD'</TT>),
you should use <CODE>isamchk</CODE> instead; the concepts are similar.

</P>
<P>
Starting with MySQL Version 3.23.14, you can repair <CODE>MyISAM</CODE>
tables with the <CODE>REPAIR TABLE</CODE> command.
See section <A HREF="manual.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A>.

</P>
<P>
The symptoms of a corrupted table include queries that abort unexpectedly
and observable errors such as these:

</P>

<UL>
<LI>

<TT>`tbl_name.frm'</TT> is locked against change
<LI>

Can't find file <TT>`tbl_name.MYI'</TT> (Errcode: ###)
<LI>

Unexpected end of file
<LI>

Record file is crashed
<LI>

Got error ### from table handler
</UL>

<P>
To get more information about the error you can run <CODE>perror ###</CODE>,
where <CODE>###</CODE> is the error number. The following example shows how to use
<CODE>perror</CODE> to find the meanings for the most common error numbers that
indicate a problem with a table:

</P>

<PRE>
shell&#62; perror 126 127 132 134 135 136 141 144 145
126 = Index file is crashed / Wrong file format
127 = Record-file is crashed
132 = Old database file
134 = Record was already deleted (or record file crashed)
135 = No more room in record file
136 = No more room in index file
141 = Duplicate unique key or constraint on write or update
144 = Table is crashed and last repair failed
145 = Table was marked as crashed and should be repaired
</PRE>

<P>
Note that error 135 (no more room in record file), is not an error that
can be fixed by a simple repair. In this case, you have to use <CODE>ALTER
TABLE</CODE> to increase the <CODE>MAX_ROWS</CODE> and <CODE>AVG_ROW_LENGTH</CODE> table option
values:

</P>

<PRE>
ALTER TABLE tbl_name MAX_ROWS=xxx AVG_ROW_LENGTH=yyy;
</PRE>

<P>
If you don't know the current table option values, use <CODE>SHOW CREATE TABLE
tbl_name</CODE>.

</P>
<P>
You can also use this technique for error 136 (no more room in index file).

</P>
<P>
For the other errors, you must repair your tables. <CODE>myisamchk</CODE> can
usually detect and fix most problems that occur.

</P>
<P>
The repair process involves up to four stages, described here. Before you
begin, you should <CODE>cd</CODE> to the database directory and check the
permissions of the table files. Make sure that they are readable by the Unix user
that <CODE>mysqld</CODE> runs as (and to you, because you need to access the files
you are checking).  If it turns out you need to modify files, they must also
be writable by you.

</P>
<P>
If you are using MySQL 3.23.16 and above, you can (and
should) use the <CODE>CHECK TABLE</CODE> and <CODE>REPAIR TABLE</CODE> statements to
check and repair <CODE>MyISAM</CODE> tables.
See section <A HREF="manual.html#CHECK_TABLE">14.5.2.3  <CODE>CHECK TABLE</CODE> Syntax</A>
and section <A HREF="manual.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A>.

</P>
<P>
The options that you can use for table maintenance with <CODE>myisamchk</CODE>
and <CODE>isamchk</CODE> are described in several of the earlier subsections of
section <A HREF="manual.html#Table_maintenance">5.6.2  Using <CODE>myisamchk</CODE> for Table Maintenance and Crash Recovery</A>.

</P>
<P>
The following section is for the cases where the above command fails or
if you want to use the extended features that <CODE>myisamchk</CODE> and
<CODE>isamchk</CODE> provide.

</P>
<P>
If you are going to repair a table from the command line, you must first
stop the <CODE>mysqld</CODE> server. Note that when you do
<CODE>mysqladmin shutdown</CODE> on a remote server, the <CODE>mysqld</CODE> server
will still be alive for a while after <CODE>mysqladmin</CODE> returns, until
all queries are stopped and all keys have been flushed to disk.

</P>
<P>
<STRONG>Stage 1: Checking your tables</STRONG>

</P>
<P>
Run <CODE>myisamchk *.MYI</CODE> or <CODE>myisamchk -e *.MYI</CODE> if you have
more time.  Use the <CODE>-s</CODE> (silent) option to suppress unnecessary
information.

</P>
<P>
If the <CODE>mysqld</CODE> server is down, you should use the <CODE>--update-state</CODE>
option to tell <CODE>myisamchk</CODE> to mark the table as 'checked'.

</P>
<P>
You have to repair only those tables for which <CODE>myisamchk</CODE> announces an
error.  For such tables, proceed to Stage 2.

</P>
<P>
If you get weird errors when checking (such as <CODE>out of
memory</CODE> errors), or if <CODE>myisamchk</CODE> crashes, go to Stage 3.

</P>
<P>
<STRONG>Stage 2: Easy safe repair</STRONG>

</P>
<P>
Note: If you want a repair operation to go much faster, you should set the
values of the <CODE>sort_buffer_size</CODE> and <CODE>key_buffer_size</CODE> variables
each to about 25% of your available memory when running <CODE>myisamchk</CODE>
or <CODE>isamchk</CODE>.

</P>
<P>
First, try <CODE>myisamchk -r -q tbl_name</CODE> (<CODE>-r -q</CODE> means ``quick
recovery mode''). This will attempt to repair the index file without
touching the data file.  If the data file contains everything that it
should and the delete links point at the correct locations within the
data file, this should work, and the table is fixed. Start repairing the
next table.  Otherwise, use the following procedure:

</P>

<OL>
<LI>

Make a backup of the data file before continuing.

<LI>

Use <CODE>myisamchk -r tbl_name</CODE> (<CODE>-r</CODE> means ``recovery mode''). This will
remove incorrect records and deleted records from the data file and
reconstruct the index file.

<LI>

If the preceding step fails, use <CODE>myisamchk --safe-recover tbl_name</CODE>.
Safe recovery mode uses an old recovery method that handles a few cases that
regular recovery mode doesn't (but is slower).
</OL>

<P>
If you get weird errors when repairing (such as <CODE>out of
memory</CODE> errors), or if <CODE>myisamchk</CODE> crashes, go to Stage 3.

</P>
<P>
<STRONG>Stage 3: Difficult repair</STRONG>

</P>
<P>
You should reach this stage only if the first 16KB block in the index file is
destroyed or contains incorrect information, or if the index file is
missing.  In this case, it's necessary to create a new index file. Do so as
follows:

</P>

<OL>
<LI>

Move the data file to some safe place.

<LI>

Use the table description file to create new (empty) data and index files:


<PRE>
shell&#62; mysql db_name
mysql&#62; SET AUTOCOMMIT=1;
mysql&#62; TRUNCATE TABLE tbl_name;
mysql&#62; quit
</PRE>

If your SQL version doesn't have <CODE>TRUNCATE TABLE</CODE>, use <CODE>DELETE FROM
tbl_name</CODE> instead.

<LI>

Copy the old data file back onto the newly created data file.
(Don't just move the old file back onto the new file; you want to retain
a copy in case something goes wrong.)
</OL>

<P>
Go back to Stage 2.  <CODE>myisamchk -r -q</CODE> should work now.  (This shouldn't
be an endless loop.)

</P>
<P>
As of MySQL 4.0.2, you can also use <CODE>REPAIR TABLE ... USE_FRM</CODE>,
which performs the whole procedure automatically.

</P>
<P>
<STRONG>Stage 4: Very difficult repair</STRONG>

</P>
<P>
You should reach this stage only if the <TT>`.frm'</TT> description file has also
crashed. That should never happen, because the description file isn't changed
after the table is created:

</P>

<OL>
<LI>

Restore the description file from a backup and go back to Stage 3.  You can
also restore the index file and go back to Stage 2.  In the latter case, you
should start with <CODE>myisamchk -r</CODE>.

<LI>

If you don't have a backup but know exactly how the table was created,
create a copy of the table in another database.  Remove the new data file,
then move the <TT>`.frm'</TT> description and <TT>`.MYI'</TT> index files from the
other database to your crashed database.  This gives you new description
and index files, but leaves the <TT>`.MYD'</TT> data file alone.  Go back to
Stage 2 and attempt to reconstruct the index file.

</OL>



<H4><A NAME="Optimisation" HREF="manual_toc.html#Optimisation">5.6.2.10  Table Optimization</A></H4>

<P>
<A NAME="IDX632"></A>
<A NAME="IDX633"></A>

</P>
<P>
To coalesce fragmented records and eliminate wasted space resulting from
deleting or updating records, run <CODE>myisamchk</CODE> in recovery mode:

</P>

<PRE>
shell&#62; myisamchk -r tbl_name
</PRE>

<P>
You can optimize a table in the same way by using the SQL <CODE>OPTIMIZE TABLE</CODE>
statement.  <CODE>OPTIMIZE TABLE</CODE> does a repair of the table and a key
analysis, and also sorts the index tree to give faster key lookups.
There is also no possibility of unwanted interaction between a utility
and the server, because the server does all the work when you use
<CODE>OPTIMIZE TABLE</CODE>. See section <A HREF="manual.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A>.

</P>
<P>
<CODE>myisamchk</CODE> also has a number of other options you can use to improve
the performance of a table:

</P>

<UL>
<LI><CODE>-S</CODE>, <CODE>--sort-index</CODE>

<LI><CODE>-R index_num</CODE>, <CODE>--sort-records=index_num</CODE>

<LI><CODE>-a</CODE>, <CODE>--analyze</CODE>

</UL>

<P>
For a full description of the options, see section <A HREF="manual.html#myisamchk_syntax">5.6.2.1  <CODE>myisamchk</CODE> Invocation Syntax</A>.

</P>



<H3><A NAME="Maintenance_regimen" HREF="manual_toc.html#Maintenance_regimen">5.6.3  Setting Up a Table Maintenance Regimen</A></H3>

<P>
<A NAME="IDX634"></A>
<A NAME="IDX635"></A>

</P>
<P>
It is a good idea to perform table checks on a regular basis rather than
waiting for problems to occur.
One way to check and repair <CODE>MyISAM</CODE> tables is
with the <CODE>CHECK TABLE</CODE> and <CODE>REPAIR TABLE</CODE> statements.
These are available starting with MySQL Version 3.23.13.
See section <A HREF="manual.html#CHECK_TABLE">14.5.2.3  <CODE>CHECK TABLE</CODE> Syntax</A> and
section <A HREF="manual.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A>.

</P>
<P>
Another way to check tables is to use <CODE>myisamchk</CODE>.  For maintenance
purposes, you can use <CODE>myisamchk -s</CODE>.  The <CODE>-s</CODE> option (short for
<CODE>--silent</CODE>) causes <CODE>myisamchk</CODE> to run in silent mode, printing
messages only when errors occur.

</P>
<P>
<A NAME="IDX636"></A>
It's also a good idea to check tables when the server starts.
For example, whenever the machine has done a restart in the middle of an
update, you usually need to check all the tables that could have been
affected. (This is an ``expected crashed table.'') You could add a test to
<CODE>mysqld_safe</CODE> that runs <CODE>myisamchk</CODE> to check all tables that have
been modified during the last 24 hours if there is an old <TT>`.pid'</TT>
(process ID) file left after a restart.  (The <TT>`.pid'</TT> file is created by
<CODE>mysqld</CODE> when it starts and removed when it terminates normally.  The
presence of a <TT>`.pid'</TT> file at system startup time indicates that
<CODE>mysqld</CODE> terminated abnormally.)

</P>
<P>
An even better test would be to check any table whose last-modified time
is more recent than that of the <TT>`.pid'</TT> file.

</P>
<P>
You should also check your tables regularly during normal system
operation.  At MySQL AB, we run a <CODE>cron</CODE> job to check all
our important tables once a week, using a line like this in a <TT>`crontab'</TT>
file:

</P>

<PRE>
35 0 * * 0 /path/to/myisamchk --fast --silent /path/to/datadir/*/*.MYI
</PRE>

<P>
This prints out information about crashed tables so that we can examine and
repair them when needed.

</P>
<P>
Because we haven't had any unexpectedly crashed tables (tables that become
corrupted for reasons other than hardware trouble)
for a couple of years now (this is really true), once a week is
more than enough for us.

</P>
<P>
We recommend that to start with, you execute <CODE>myisamchk -s</CODE> each
night on all tables that have been updated during the last 24 hours,
until you come to trust MySQL as much as we do.

</P>
<P>
<A NAME="IDX637"></A>
Normally you don't need to maintain MySQL tables that much.  If
you are changing tables with dynamic-sized rows (tables with <CODE>VARCHAR</CODE>,
<CODE>BLOB</CODE>, or <CODE>TEXT</CODE> columns) or have tables with many deleted rows
you may want to from time to time (once a month?) defragment/reclaim space
from the tables.

</P>
<P>
You can do this by using <CODE>OPTIMIZE TABLE</CODE> on the tables in question.
If you can stop the <CODE>mysqld</CODE> server for a while, change location into the
data directory and use this command while the server is stopped:

</P>

<PRE>
shell&#62; myisamchk -r -s --sort-index  -O sort_buffer_size=16M */*.MYI
</PRE>

<P>
For <CODE>ISAM</CODE> tables, the command is similar:

</P>

<PRE>
shell&#62; myisamchk -r -s --sort-index  -O sort_buffer_size=16M */*.MYI
</PRE>



<H3><A NAME="Table-info" HREF="manual_toc.html#Table-info">5.6.4  Getting Information About a Table</A></H3>

<P>
<A NAME="IDX638"></A>

</P>
<P>
To obtain a description of a table or statistics about it, use the commands shown
here. We explain some of the information in more detail later:

</P>

<UL>
<LI><CODE>myisamchk -d tbl_name</CODE>

Runs <CODE>myisamchk</CODE> in ``describe mode'' to produce a description of
your table. If you start the MySQL server using the
<CODE>--skip-external-locking</CODE> option, <CODE>myisamchk</CODE> may report an error
for a table that is updated while it runs.  However, because <CODE>myisamchk</CODE>
doesn't change the table in describe mode, there is no risk of
destroying data.

<LI><CODE>myisamchk -d -v tbl_name</CODE>

Adding <CODE>-v</CODE> runs <CODE>myisamchk</CODE> in verbose mode so that it produces
more information about what it is doing.

<LI><CODE>myisamchk -eis tbl_name</CODE>

Shows only the most important information from a table. This operation is slow
because it must read the entire table.

<LI><CODE>myisamchk -eiv tbl_name</CODE>

This is like <CODE>-eis</CODE>, but tells you what is being done.

</UL>

<P>
<A NAME="IDX639"></A>
<A NAME="IDX640"></A>

</P>
<P>
Sample output for some of these commands follows. They are based on a table
with these data and index file sizes:

</P>

<PRE>
-rw-rw-r--   1 monty    tcx     317235748 Jan 12 17:30 company.MYD
-rw-rw-r--   1 davida   tcx      96482304 Jan 12 18:35 company.MYM
</PRE>

<P>
Example of <CODE>myisamchk -d</CODE> output:

</P>

<PRE>
MyISAM file:     company.MYI
Record format:   Fixed length
Data records:    1403698  Deleted blocks:         0
Recordlength:    226

table description:
Key Start Len Index   Type
1   2     8   unique  double
2   15    10  multip. text packed stripped
3   219   8   multip. double
4   63    10  multip. text packed stripped
5   167   2   multip. unsigned short
6   177   4   multip. unsigned long
7   155   4   multip. text
8   138   4   multip. unsigned long
9   177   4   multip. unsigned long
    193   1           text
</PRE>

<P>
Example of <CODE>myisamchk -d -v</CODE> output:

</P>

<PRE>
MyISAM file:         company
Record format:       Fixed length
File-version:        1
Creation time:       1999-10-30 12:12:51
Recover time:        1999-10-31 19:13:01
Status:              checked
Data records:           1403698  Deleted blocks:              0
Datafile parts:         1403698  Deleted data:                0
Datafilepointer (bytes):      3  Keyfile pointer (bytes):     3
Max datafile length: 3791650815  Max keyfile length: 4294967294
Recordlength:               226

table description:
Key Start Len Index   Type                  Rec/key     Root Blocksize
1   2     8   unique  double                      1 15845376      1024
2   15    10  multip. text packed stripped        2 25062400      1024
3   219   8   multip. double                     73 40907776      1024
4   63    10  multip. text packed stripped        5 48097280      1024
5   167   2   multip. unsigned short           4840 55200768      1024
6   177   4   multip. unsigned long            1346 65145856      1024
7   155   4   multip. text                     4995 75090944      1024
8   138   4   multip. unsigned long              87 85036032      1024
9   177   4   multip. unsigned long             178 96481280      1024
    193   1           text
</PRE>

<P>
Example of <CODE>myisamchk -eis</CODE> output:

</P>

<PRE>
Checking MyISAM file: company
Key:  1:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
Key:  2:  Keyblocks used:  98%  Packed:   50%  Max levels:  4
Key:  3:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
Key:  4:  Keyblocks used:  99%  Packed:   60%  Max levels:  3
Key:  5:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  6:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  7:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  8:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  9:  Keyblocks used:  98%  Packed:    0%  Max levels:  4
Total:    Keyblocks used:  98%  Packed:   17%

Records:          1403698    M.recordlength:     226
Packed:             0%
Recordspace used:     100%   Empty space:          0%
Blocks/Record:   1.00
Record blocks:    1403698    Delete blocks:        0
Recorddata:     317235748    Deleted data:         0
Lost space:             0    Linkdata:             0

User time 1626.51, System time 232.36
Maximum resident set size 0, Integral resident set size 0
Non physical pagefaults 0, Physical pagefaults 627, Swaps 0
Blocks in 0 out 0, Messages in 0 out 0, Signals 0
Voluntary context switches 639, Involuntary context switches 28966
</PRE>

<P>
Example of <CODE>myisamchk -eiv</CODE> output:

</P>

<PRE>
Checking MyISAM file: company
Data records: 1403698   Deleted blocks:       0
- check file-size
- check delete-chain
block_size 1024:
index  1:
index  2:
index  3:
index  4:
index  5:
index  6:
index  7:
index  8:
index  9:
No recordlinks
- check index reference
- check data record references index: 1
Key:  1:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
- check data record references index: 2
Key:  2:  Keyblocks used:  98%  Packed:   50%  Max levels:  4
- check data record references index: 3
Key:  3:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
- check data record references index: 4
Key:  4:  Keyblocks used:  99%  Packed:   60%  Max levels:  3
- check data record references index: 5
Key:  5:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 6
Key:  6:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 7
Key:  7:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 8
Key:  8:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 9
Key:  9:  Keyblocks used:  98%  Packed:    0%  Max levels:  4
Total:    Keyblocks used:   9%  Packed:   17%

- check records and index references
[LOTS OF ROW NUMBERS DELETED]

Records:         1403698   M.recordlength:   226   Packed:           0%
Recordspace used:    100%  Empty space:        0%  Blocks/Record: 1.00
Record blocks:   1403698   Delete blocks:      0
Recorddata:    317235748   Deleted data:       0
Lost space:            0   Linkdata:           0

User time 1639.63, System time 251.61
Maximum resident set size 0, Integral resident set size 0
Non physical pagefaults 0, Physical pagefaults 10580, Swaps 0
Blocks in 4 out 0, Messages in 0 out 0, Signals 0
Voluntary context switches 10604, Involuntary context switches 122798
</PRE>

<P>
Explanations for the types of information <CODE>myisamchk</CODE> produces are
given here.  ``Keyfile'' refers to the index file.  ``Record'' and ``row''
are synonymous:

</P>

<UL>
<LI><CODE>MyISAM file</CODE>

Name of the <CODE>MyISAM</CODE> (index) file.

<LI><CODE>File-version</CODE>

Version of <CODE>MyISAM</CODE> format. Currently always 2.

<LI><CODE>Creation time</CODE>

When the data file was created.

<LI><CODE>Recover time</CODE>

When the index/data file was last reconstructed.

<LI><CODE>Data records</CODE>

How many records are in the table.

<LI><CODE>Deleted blocks</CODE>

How many deleted blocks still have reserved space.
You can optimize your table to minimize this space.
See section <A HREF="manual.html#Optimisation">5.6.2.10  Table Optimization</A>.

<LI><CODE>Data file parts</CODE>

For dynamic record format, this indicates how many data blocks there are. For
an optimized table without fragmented records, this is the same as <CODE>Data
records</CODE>.

<LI><CODE>Deleted data</CODE>

How many bytes of unreclaimed deleted data there are.
You can optimize your table to minimize this space.
See section <A HREF="manual.html#Optimisation">5.6.2.10  Table Optimization</A>.

<LI><CODE>Data file pointer</CODE>

The size of the data file pointer, in bytes. It is usually 2, 3, 4, or 5
bytes. Most tables manage with 2 bytes, but this cannot be controlled
from MySQL yet. For fixed tables, this is a record address. For
dynamic tables, this is a byte address.

<LI><CODE>Keyfile pointer</CODE>

The size of the index file pointer, in bytes. It is usually 1, 2, or 3
bytes. Most tables manage with 2 bytes, but this is calculated
automatically by MySQL. It is always a block address.

<LI><CODE>Max datafile length</CODE>

How long the table's data file can become, in bytes.

<LI><CODE>Max keyfile length</CODE>

How long the table's index file can become, in bytes.

<LI><CODE>Recordlength</CODE>

How much space each record takes, in bytes.

<LI><CODE>Record format</CODE>

The format used to store table rows.
The preceding examples use <CODE>Fixed length</CODE>.
Other possible values are <CODE>Compressed</CODE> and <CODE>Packed</CODE>.

<LI><CODE>table description</CODE>

A list of all keys in the table. For each key, <CODE>myisamchk</CODE> displays
some low-level information:


<UL>
<LI><CODE>Key</CODE>

This key's number.

<LI><CODE>Start</CODE>

Where in the record this index part starts.

<LI><CODE>Len</CODE>

How long this index part is. For packed numbers, this should always be
the full length of the column. For strings, it may be shorter than the full
length of the indexed column, because you can index a prefix of a string
column.

<LI><CODE>Index</CODE>

Whether a key value can exist multiple times in the index. Values are
<CODE>unique</CODE> or <CODE>multip.</CODE> (multiple).

<LI><CODE>Type</CODE>

What data type this index part has. This is a <CODE>MyISAM</CODE> data type
with the options <CODE>packed</CODE>, <CODE>stripped</CODE>, or <CODE>empty</CODE>.

<LI><CODE>Root</CODE>

Address of the root index block.

<LI><CODE>Blocksize</CODE>

The size of each index block. By default this is 1024, but the value may be
changed at compile time when MySQL is built from source.

<LI><CODE>Rec/key</CODE>

This is a statistical value used by the optimizer. It tells how many
records there are per value for this key. A unique key always has a
value of 1. This may be updated after a table is loaded (or greatly
changed) with <CODE>myisamchk -a</CODE>. If this is not updated at all, a default
value of 30 is given.
</UL>

For the table shown in the examples, there are two <CODE>table description</CODE>
lines for the ninth index. This indicates that it is a multiple-part index
with two parts.

<LI><CODE>Keyblocks used</CODE>

What percentage of the keyblocks are used. When a table has just been
reorganized with <CODE>myisamchk</CODE>, as for the table in the examples, the
values are very high (very near the theoretical maximum).

<LI><CODE>Packed</CODE>

MySQL tries to pack keys with a common suffix. This can only be used
for indexes on <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, or <CODE>DECIMAL</CODE> columns. For
long indexed strings that have similar leftmost parts,
this can significantly reduce the space used. In the third example
above, the fourth key is 10 characters long and a 60% reduction in space is
achieved.

<LI><CODE>Max levels</CODE>

How deep the B-tree for this key is. Large tables with long key values get high
values.

<LI><CODE>Records</CODE>

How many rows are in the table.

<LI><CODE>M.recordlength</CODE>

The average record length.  This is the exact record length for tables
with fixed-length records, because all records have the same length.

<LI><CODE>Packed</CODE>

MySQL strips spaces from the end of strings. The <CODE>Packed</CODE>
value indicates the percentage of savings achieved by doing this.

<LI><CODE>Recordspace used</CODE>

What percentage of the data file is used.

<LI><CODE>Empty space</CODE>

What percentage of the data file is unused.

<LI><CODE>Blocks/Record</CODE>

Average number of blocks per record (that is, how many links a fragmented
record is composed of). This is always 1.0 for fixed-format tables. This
value should stay as close to 1.0 as possible. If it gets too big, you can
reorganize the table with <CODE>myisamchk</CODE>.
See section <A HREF="manual.html#Optimisation">5.6.2.10  Table Optimization</A>.

<LI><CODE>Recordblocks</CODE>

How many blocks (links) are used. For fixed format, this is the same as the number
of records.

<LI><CODE>Deleteblocks</CODE>

How many blocks (links) are deleted.

<LI><CODE>Recorddata</CODE>

How many bytes in the data file are used.

<LI><CODE>Deleted data</CODE>

How many bytes in the data file are deleted (unused).

<LI><CODE>Lost space</CODE>

If a record is updated to a shorter length, some space is lost. This is
the sum of all such losses, in bytes.

<LI><CODE>Linkdata</CODE>

When the dynamic table format is used, record fragments are linked with
pointers (4 to 7 bytes each). <CODE>Linkdata</CODE> is the sum of the amount of
storage used by all such pointers.

</UL>

<P>
If a table has been compressed with <CODE>myisampack</CODE>, <CODE>myisamchk
-d</CODE> prints additional information about each table column.  See
section <A HREF="manual.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A>, for an example of this
information and a description of what it means.

</P>


<H2><A NAME="Localisation" HREF="manual_toc.html#Localisation">5.7  MySQL Localization and International Usage</A></H2>



<H3><A NAME="Character_sets" HREF="manual_toc.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A></H3>

<P>
<A NAME="IDX641"></A>
<A NAME="IDX642"></A>
<A NAME="IDX643"></A>

</P>
<P>
By default, MySQL uses the ISO-8859-1 (Latin1) character set
with sorting according to Swedish/Finnish rules. These defaults are suitable
for the United States and most of western Europe.

</P>
<P>
All MySQL binary distributions are compiled with
<CODE>--with-extra-charsets=complex</CODE>.  This adds code to all
standard programs that enables them to handle <CODE>latin1</CODE> and all multi-byte
character sets within the binary. Other character sets will be
loaded from a character-set definition file when needed.

</P>
<P>
The character set determines what characters are allowed in names. It also
determines how strings are sorted by the <CODE>ORDER BY</CODE> and <CODE>GROUP
BY</CODE> clauses of the <CODE>SELECT</CODE> statement.

</P>
<P>
You can change the character set with the <CODE>--default-character-set</CODE>
option when you start the server.  The character sets available depend
on the <CODE>--with-charset=charset</CODE> and <CODE>--with-extra-charsets=
list-of-charset | complex | all | none</CODE> options to <CODE>configure</CODE>, and the
character set configuration files listed in
<TT>`SHAREDIR/charsets/Index'</TT>.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

</P>
<P>
As of MySQL 4.1.1, you can also change the character set collation with the
<CODE>--default-collation</CODE> option when you start the server.  The collation
must be a legal collation for the default character set.  (Use the
<CODE>SHOW COLLATION</CODE> statement to determine which collations are available
for each character set.)
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

</P>
<P>
If you change the character set when running MySQL, that may also
change the sort order.  Consequently, you must run <CODE>myisamchk -r -q
--set-character-set=charset</CODE> on all tables, or your indexes may not be
ordered correctly.

</P>
<P>
When a client connects to a MySQL server, the server indicates to the
client what the server's default character set is.  The client will switch
to use this character set for this connection.

</P>
<P>
You should use <CODE>mysql_real_escape_string()</CODE> when escaping strings
for an SQL query.  <CODE>mysql_real_escape_string()</CODE> is identical to the
old <CODE>mysql_escape_string()</CODE> function, except that it takes the <CODE>MYSQL</CODE>
connection handle as the first parameter so that the appropriate character set
can be taken into account when escaping characters.

</P>
<P>
If the client is compiled with different paths than where the server is
installed and the user who configured MySQL didn't include all character
sets in the MySQL binary, you must tell the client where it can find the
additional character sets it will need if the server runs with a different
character set than the client.

</P>
<P>
You can do this by specifying a <CODE>--character-sets-dir</CODE> option to
indicate the path to the directory in which the dynamic MySQL character
sets are stored. For example, you can put the following in an option file:

</P>

<PRE>
[client]
character-sets-dir=/usr/local/mysql/share/mysql/charsets
</PRE>

<P>
You can force the client to use specific character set as follows:

</P>

<PRE>
[client]
default-character-set=character-set-name
</PRE>

<P>
This is normally unnecessary, however.

</P>



<H4><A NAME="German_character_set" HREF="manual_toc.html#German_character_set">5.7.1.1  Using the German Character Set</A></H4>

<P>
To get German sorting order, you should start <CODE>mysqld</CODE> with a
<CODE>--default-character-set=latin1_de</CODE> option.  This will give you the
following characteristics:

</P>

<UL>
<LI>

When sorting and comparing strings, the following mapping is performed on the
strings before doing the comparison:


<PRE>
@"a  -&#62;  ae
@"o  -&#62;  oe
@"u  -&#62;  ue
@ss{}  -&#62;  ss
</PRE>

<LI>

All accented characters are converted to their unaccented uppercase
counterpart.  All letters are converted to uppercase.

<LI>

When comparing strings with <CODE>LIKE</CODE>, the one-character to two-character mapping
is not done. All letters are converted to uppercase. Accents are removed
from all letters except <CODE>@"U</CODE>, <CODE>@"u</CODE>, <CODE>@"O</CODE>, <CODE>@"o</CODE>,
<CODE>@"A</CODE>, and <CODE>@"a</CODE>.

</UL>



<H3><A NAME="Languages" HREF="manual_toc.html#Languages">5.7.2  Setting the Error Message Language</A></H3>

<P>
<A NAME="IDX644"></A>
<A NAME="IDX645"></A>
<A NAME="IDX646"></A>
<A NAME="IDX647"></A>

</P>
<P>
By default, <CODE>mysqld</CODE> produces error messages in English, but they can
also be displayed in any of these other languages:
Czech, Danish, Dutch, Estonian, French, German, Greek,
Hungarian, Italian, Japanese, Korean, Norwegian, Norwegian-ny, Polish,
Portuguese, Romanian, Russian, Slovak, Spanish, or Swedish.

</P>
<P>
To start <CODE>mysqld</CODE> with a particular language for error messages, use a the
<CODE>--languag</CODE> or <CODE>-L</CODE> option. The option value can be a language name
or the full path to the error message file.
For example:

</P>

<PRE>
shell&#62; mysqld --language=swedish
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysqld --language=/usr/local/share/swedish
</PRE>

<P>
Note that the language name should be specified in lowercase.

</P>
<P>
The language files are located (by default) in the
<TT>`share/<VAR>LANGUAGE</VAR>'</TT> directory under the MySQL base
directory.

</P>
<P>
To change the error message file, you should edit the <TT>`errmsg.txt'</TT> file,
and then execute the following command to generate the <TT>`errmsg.sys'</TT> file:

</P>

<PRE>
shell&#62; comp_err errmsg.txt errmsg.sys
</PRE>

<P>
If you upgrade to a newer version of MySQL, remember to repeat
your changes with the new <TT>`errmsg.txt'</TT> file.

</P>



<H3><A NAME="Adding_character_set" HREF="manual_toc.html#Adding_character_set">5.7.3  Adding a New Character Set</A></H3>

<P>
<A NAME="IDX648"></A>
<A NAME="IDX649"></A>

</P>
<P>
This section discusses the procedure for adding add another character set to
MySQL.  You must have a MySQL source distribution to use these instructions.

</P>
<P>
To choose the proper procedure, decide whether the character
set is simple or complex:

</P>

<UL>

<LI>

If the character set does not need to use special string collating routines
for sorting and does not need multi-byte character support, it is simple.

<LI>

If it needs either of those features, it is complex.

</UL>

<P>
For example, <CODE>latin1</CODE> and <CODE>danish</CODE> are simple character sets,
whereas <CODE>big5</CODE> and <CODE>czech</CODE> are complex character sets.

</P>
<P>
In the following procedures, the name of your character
set is represented by <CODE>MYSET</CODE>.

</P>
<P>
For a simple character set, do the following:

</P>

<OL>
<LI>

Add <CODE>MYSET</CODE> to the end of the <TT>`sql/share/charsets/Index'</TT> file.
Assign a unique number to it.

<LI>

Create the file <TT>`sql/share/charsets/MYSET.conf'</TT>.
(You can use a copy of <TT>`sql/share/charsets/latin1.conf'</TT> as the basis for
this file.)

The syntax for the file is very simple:


<UL>
<LI>

Comments start with a <SAMP>`#'</SAMP> character and proceed to the end of the line.
<LI>

Words are separated by arbitrary amounts of whitespace.
<LI>

When defining the character set, every word must be a number in hexadecimal
format.
<LI>

The <CODE>ctype</CODE> array takes up the first 257 words. The
<CODE>to_lower[]</CODE>, <CODE>to_upper[]</CODE> and <CODE>sort_order[]</CODE> arrays take up
256 words each after that.
</UL>

See section <A HREF="manual.html#Character_arrays">5.7.4  The Character Definition Arrays</A>.

<LI>

Add the character set name to the <CODE>CHARSETS_AVAILABLE</CODE> and
<CODE>COMPILED_CHARSETS</CODE> lists in <CODE>configure.in</CODE>.

<LI>

Reconfigure, recompile, and test.

</OL>

<P>
For a complex character set, do the following:

</P>

<OL>
<LI>

Create the file <TT>`strings/ctype-MYSET.c'</TT> in the MySQL source
distribution.

<LI>

Add <CODE>MYSET</CODE> to the end of the <TT>`sql/share/charsets/Index'</TT> file.
Assign a unique number to it.

<LI>

Look at one of the existing <TT>`ctype-*.c'</TT> files (such as
<TT>`strings/ctype-big5.c'</TT>) to see what needs to be defined.
Note that the
arrays in your file must have names like <CODE>ctype_MYSET</CODE>,
<CODE>to_lower_MYSET</CODE>, and so on.  These correspond to the arrays
for a simple character set. See section <A HREF="manual.html#Character_arrays">5.7.4  The Character Definition Arrays</A>.

<LI>

Near the top of the file, place a special comment like this:


<PRE>
/*
 * This comment is parsed by configure to create ctype.c,
 * so don't change it unless you know what you are doing.
 *
 * .configure. number_MYSET=MYNUMBER
 * .configure. strxfrm_multiply_MYSET=N
 * .configure. mbmaxlen_MYSET=N
 */
</PRE>

The <CODE>configure</CODE> program uses this comment to include
the character set into the MySQL library automatically.

The <CODE>strxfrm_multiply</CODE> and <CODE>mbmaxlen</CODE> lines are explained in
the following sections.  You need include them only if you need the string
collating functions or the multi-byte character set functions,
respectively.

<LI>

You should then create some of the following functions:


<UL>
<LI><CODE>my_strncoll_MYSET()</CODE>

<LI><CODE>my_strcoll_MYSET()</CODE>

<LI><CODE>my_strxfrm_MYSET()</CODE>

<LI><CODE>my_like_range_MYSET()</CODE>

</UL>

See section <A HREF="manual.html#String_collating">5.7.5  String Collating Support</A>.

<LI>

Add the character set name to the <CODE>CHARSETS_AVAILABLE</CODE> and
<CODE>COMPILED_CHARSETS</CODE> lists in <CODE>configure.in</CODE>.

<LI>

Reconfigure, recompile, and test.
</OL>

<P>
The <TT>`sql/share/charsets/README'</TT> file includes additional instructions.

</P>
<P>
If you want to have the character set included in the MySQL
distribution, mail a patch to the MySQL <CODE>internals</CODE> mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>



<H3><A NAME="Character_arrays" HREF="manual_toc.html#Character_arrays">5.7.4  The Character Definition Arrays</A></H3>

<P>
<CODE>to_lower[]</CODE> and <CODE>to_upper[]</CODE> are simple arrays that hold the
lowercase and uppercase characters corresponding to each member of the
character set.  For example:

</P>

<PRE>
to_lower['A'] should contain 'a'
to_upper['a'] should contain 'A'
</PRE>

<P>
<CODE>sort_order[]</CODE> is a map indicating how characters should be ordered for
comparison and sorting purposes. Quite often (but not for all character sets)
this is the same as <CODE>to_upper[]</CODE>, which means that sorting will be
case-insensitive. MySQL will sort characters based on the value of
<CODE>sort_order[character]</CODE>.  For more complicated sorting rules, see
the discussion of string collating in section <A HREF="manual.html#String_collating">5.7.5  String Collating Support</A>.

</P>
<P>
<CODE>ctype[]</CODE> is an array of bit values, with one element for one character.
(Note that <CODE>to_lower[]</CODE>, <CODE>to_upper[]</CODE>, and <CODE>sort_order[]</CODE>
are indexed by character value, but <CODE>ctype[]</CODE> is indexed by character
value + 1.  This is an old legacy convention to be able to handle <CODE>EOF</CODE>.)

</P>
<P>
You can find the following bitmask definitions in <TT>`m_ctype.h'</TT>:

</P>

<PRE>
#define _U      01      /* Uppercase */
#define _L      02      /* Lowercase */
#define _N      04      /* Numeral (digit) */
#define _S      010     /* Spacing character */
#define _P      020     /* Punctuation */
#define _C      040     /* Control character */
#define _B      0100    /* Blank */
#define _X      0200    /* heXadecimal digit */
</PRE>

<P>
The <CODE>ctype[]</CODE> entry for each character should be the union of the
applicable bitmask values that describe the character.  For example,
<CODE>'A'</CODE> is an uppercase character (<CODE>_U</CODE>) as well as a
hexadecimal digit (<CODE>_X</CODE>), so <CODE>ctype['A'+1]</CODE> should contain the
value:

</P>

<PRE>
_U + _X = 01 + 0200 = 0201
</PRE>



<H3><A NAME="String_collating" HREF="manual_toc.html#String_collating">5.7.5  String Collating Support</A></H3>

<P>
<A NAME="IDX650"></A>
<A NAME="IDX651"></A>

</P>
<P>
If the sorting rules for your language are too complex to be handled
with the simple <CODE>sort_order[]</CODE> table, you need to use the string
collating functions.

</P>
<P>
Right now the best documentation for this is the character sets that are
already implemented.  Look at the <CODE>big5</CODE>, <CODE>czech</CODE>, <CODE>gbk</CODE>,
<CODE>sjis</CODE>, and <CODE>tis160</CODE> character sets for examples.

</P>
<P>
You must specify the <CODE>strxfrm_multiply_MYSET=N</CODE> value in the
special comment at the top of the file.  <CODE>N</CODE> should be set to
the maximum ratio the strings may grow during <CODE>my_strxfrm_MYSET</CODE> (it
must be a positive integer).

</P>



<H3><A NAME="Multi-byte_characters" HREF="manual_toc.html#Multi-byte_characters">5.7.6  Multi-byte Character Support</A></H3>

<P>
<A NAME="IDX652"></A>
<A NAME="IDX653"></A>

</P>
<P>
If your want to add support for a new character set that includes
multi-byte characters, you need to use the multi-byte character
functions.

</P>
<P>
Right now the best documentation on this is the character sets that are
already implemented.  Look at the <CODE>euc_kr</CODE>, <CODE>gb2312</CODE>,
<CODE>gbk</CODE>, <CODE>sjis</CODE>, and <CODE>ujis</CODE> character sets for
examples. These are implemented in the <TT>`ctype-'charset'.c'</TT> files
in the <TT>`strings'</TT> directory.

</P>
<P>
You must specify the <CODE>mbmaxlen_MYSET=N</CODE> value in the special
comment at the top of the source file.  <CODE>N</CODE> should be set to the
size in bytes of the largest character in the set.

</P>


<H3><A NAME="Problems_with_character_sets" HREF="manual_toc.html#Problems_with_character_sets">5.7.7  Problems With Character Sets</A></H3>

<P>
If you try to use a character set that is not compiled into your binary,
you might run into the following problems:

</P>

<UL>
<LI>

Your program has an incorrect path to where the character sets are stored.
(Default <TT>`/usr/local/mysql/share/mysql/charsets'</TT>).
This can be fixed by using the <CODE>--character-sets-dir</CODE>
option when you run the program in question.
<LI>

The character set is a multi-byte character set that can't be loaded
dynamically.  In this case, you must recompile the program with
support for the character set.
<LI>

The character set is a dynamic character set, but you don't have a
configure file for it.  In this case, you should install the configure
file for the character set from a new MySQL distribution.
<LI>

If your <TT>`Index'</TT> file doesn't contain the name for the character set, your
program will display the following error message:


<PRE>
ERROR 1105: File '/usr/local/share/mysql/charsets/?.conf'
not found (Errcode: 2)
</PRE>

In this case, you should either get a new <CODE>Index</CODE> file or manually add
the name of any missing character sets to the current file.
</UL>

<P>
For <CODE>MyISAM</CODE> tables, you can check the character set name and number for a
table with <CODE>myisamchk -dvv tbl_name</CODE>.

</P>



<H2><A NAME="Log_Files" HREF="manual_toc.html#Log_Files">5.8  The MySQL Log Files</A></H2>

<P>
<A NAME="IDX654"></A>

</P>
<P>
MySQL has several different log files that can help you find
out what's going on inside <CODE>mysqld</CODE>:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Log File</STRONG> </TD><TD> <STRONG>Types of Information Logged to File</STRONG>
</TD></TR>
<TR><TD>The error log </TD><TD> Problems encountering starting, running, or stopping <CODE>mysqld</CODE>.
</TD></TR>
<TR><TD>The isam log </TD><TD> Logs all changes to the <CODE>ISAM</CODE> tables. Used only for debugging the isam code.
</TD></TR>
<TR><TD>The query log </TD><TD> Established client connections and executed statements.
</TD></TR>
<TR><TD>The update log </TD><TD> Statements that change data. This log is deprecated.
</TD></TR>
<TR><TD>The binary log </TD><TD> Stores all statements that change data. Also used for replication.
</TD></TR>
<TR><TD>The slow log </TD><TD> Stores all queries that took more than <CODE>long_query_time</CODE> seconds to execute or didn't use indexes.
</TD></TR>
</TABLE>

<P>
By default, all logs are created in the <CODE>mysqld</CODE> data directory.  You can
force <CODE>mysqld</CODE> to close and reopen the log files (or in some cases
switch to a new log) by flushing the logs. Log flushing occurs when you
issue a <CODE>FLUSH LOGS</CODE> statement or execute <CODE>mysqladmin flush-logs</CODE> or
<CODE>mysqladmin refresh</CODE>.
See section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>.

</P>
<P>
If you are using MySQL replication capabilities, slave replication servers
maintain additional log files called relay logs. These are discussed in
section <A HREF="manual.html#Replication">6  Replication in MySQL</A>.

</P>



<H3><A NAME="Error_log" HREF="manual_toc.html#Error_log">5.8.1  The Error Log</A></H3>

<P>
The error log file contains information indicating when <CODE>mysqld</CODE>
was started and stopped and also any critical errors that occur while the
server is running.

</P>
<P>
If <CODE>mysqld</CODE> dies unexpectedly and <CODE>mysqld_safe</CODE> needs to
restart it, <CODE>mysqld_safe</CODE> will write a <CODE>restarted
mysqld</CODE> message to the error log.  If
<CODE>mysqld</CODE> notices a table that needs to be automatically checked or
repaired, it writes a message to the error log.

</P>
<P>
On some operating systems, the error log will contain a stack trace if
<CODE>mysqld</CODE> dies. The trace can be used to determine where
<CODE>mysqld</CODE> died.  See section <A HREF="manual.html#Using_stack_trace">D.1.4  Using a Stack Trace</A>.

</P>
<P>
Beginning with MySQL 4.0.10, you can specify where <CODE>mysqld</CODE> stores the
error log file with the option <CODE>--log-error[=file_name]</CODE>. If no
<CODE>file_name</CODE> value is given, <CODE>mysqld</CODE> uses the name
<TT>`host_name.err'</TT> and writes the file in the data directory.
(Prior to MySQL 4.0.10, the Windows error log name is <TT>`mysql.err'</TT>.)
If you execute <CODE>FLUSH LOGS</CODE>, the error log will be renamed with a suffix
of <CODE>-old</CODE> and <CODE>mysqld</CODE> creates a new empty log file.

</P>
<P>
In older MySQL versions on Unix, error log handling was done by
<CODE>mysqld_safe</CODE> which redirected the error file to
<CODE>host_name.err</CODE>.  You could change this filename by specifying a
<CODE>--err-log=filename</CODE> option to <CODE>mysqld_safe</CODE>.

</P>
<P>
If you don't specify <CODE>--log-error</CODE>, or (on Windows) if you use the
<CODE>--console</CODE> option, errors are written to stderr, the standard error
output. Usually this is your terminal.

</P>
<P>
On Windows, error output is always written to the <CODE>.err</CODE> file if
<CODE>--console</CODE> is not given.

</P>


<H3><A NAME="Query_log" HREF="manual_toc.html#Query_log">5.8.2  The General Query Log</A></H3>

<P>
<A NAME="IDX655"></A>
<A NAME="IDX656"></A>

</P>
<P>
If you want to know what happens within <CODE>mysqld</CODE>, you should start
it with the <CODE>--log[=file_name]</CODE> or <CODE>-l [file_name]</CODE> option.
If no <CODE>file_name</CODE> value is given, the default name is
<TT>`hostname.log'</TT>
This will log all connections and statements to the log file.
This log can be very useful when you suspect an error in a client and want
to know exactly what the client sent to <CODE>mysqld</CODE>.

</P>
<P>
Older versions of the <CODE>mysql.server</CODE> script (from MySQL 3.23.4 to 3.23.8)
pass <CODE>safe_mysqld</CODE> a <CODE>--log</CODE> option to enable the general query log.
If you need better performance when you start using MySQL in a production
environment, you can remove the <CODE>--log</CODE> option from <CODE>mysql.server</CODE>
or change it to <CODE>--log-bin</CODE>. See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>
<P>
<CODE>mysqld</CODE> writes statements to the query log in the order that it
receives them.  This may be different from the order in which they are
executed.  This is in contrast to the update log and the binary log, which
are written after the query is executed, but before any locks are released.

</P>
<P>
Server restarts and log flushing do not cause a new general query log file
to be generated (although flushing closes and reopens it). On Unix, you can
rename the file and create a new one by using the following commands:

</P>

<PRE>
shell&#62; mv hostname.log hostname-old.log
shell&#62; mysqladmin flush-logs
shell&#62; cp hostname-old.log to-backup-directory
shell&#62; rm hostname-old.log
</PRE>

<P>
On Windows, you cannot rename the log file while the server has it open.
You must stop the server and rename the log. Then restart the server to create
a new log.

</P>



<H3><A NAME="Update_log" HREF="manual_toc.html#Update_log">5.8.3  The Update Log</A></H3>

<P>
<A NAME="IDX657"></A>
<A NAME="IDX658"></A>

</P>
<P>
<STRONG>Note:</STRONG> The update log has been deprecated and replaced by the binary
log. See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.  The binary log can do anything the old update log
could do, and more. <STRONG>The update log is unavailable as of MySQL
5.0.0</STRONG>.

</P>
<P>
When started with the <CODE>--log-update[=file_name]</CODE> option,
<CODE>mysqld</CODE> writes a log file containing all SQL statements that update
data. If no <CODE>file_name</CODE> value is given, the default name is name of the host
machine. If a filename is given, but it doesn't contain a leading path, the file
is written in the data directory. If <TT>`file_name'</TT> doesn't have an
extension, <CODE>mysqld</CODE> creates log files with names of the form
<TT>`file_name.###'</TT>, where <CODE>###</CODE> is a number that is incremented each
time you start the server or flush the logs.

</P>
<P>
<STRONG>Note:</STRONG> For this naming scheme to work, you must not create
your own files with the same names as those that might be used for the log
file sequence.

</P>
<P>
Update logging is smart because it logs only statements that really update
data. So, an <CODE>UPDATE</CODE> or a <CODE>DELETE</CODE> with a <CODE>WHERE</CODE> that finds no
rows is not written to the log. It even skips <CODE>UPDATE</CODE> statements that
set a column to the value it already has.

</P>
<P>
The update logging is done immediately after a query completes but before
any locks are released or any commit is done. This ensures that statements
are logged in execution order.

</P>
<P>
If you want to update a database from update log files, you could do the
following (assuming that your update logs have names of the form
<TT>`file_name.###'</TT>):

</P>

<PRE>
shell&#62; ls -1 -t -r file_name.[0-9]* | xargs cat | mysql
</PRE>

<P>
<CODE>ls</CODE> is used to sort the update log filenames into the right order.

</P>
<P>
This can be useful if you have to revert to backup files after a crash
and you want to redo the updates that occurred between the time of the backup
and the crash.

</P>



<H3><A NAME="Binary_log" HREF="manual_toc.html#Binary_log">5.8.4  The Binary Log</A></H3>

<P>
<A NAME="IDX659"></A>
<A NAME="IDX660"></A>

</P>
<P>
The binary log has replaced the old update log, which is unavailable
starting from MySQL 5.0. The binary log contains all information that is
available in the update log in a more efficient format and in a manner
that is transactionally safe.

</P>
<P>
The binary log, like the old update log, logs only statements that really
update data. So an <CODE>UPDATE</CODE> or a <CODE>DELETE</CODE> with a <CODE>WHERE</CODE>
that finds no rows is not written to the log. It even skips <CODE>UPDATE</CODE>
statements that set a column to the value it already has.

</P>
<P>
The binary log also contains information about how long each statement took
that updated the database.  It doesn't contain statements that don't modify
any data.  If you want to log all statements (for example, to identify a problem
query) you should use the general query log. See section <A HREF="manual.html#Query_log">5.8.2  The General Query Log</A>.

</P>
<P>
The primary purpose of the binary log is to be able to update the database
during a restore operation as fully as possible, because the binary log will
contain all updates done after a backup was made.

</P>
<P>
The binary log is also used on master replication servers as a record of the
statements to be sent to slave servers.
See section <A HREF="manual.html#Replication">6  Replication in MySQL</A>.

</P>
<P>
Running the server with the binary log enabled makes performance about 1%
slower. However, the benefits of the binary log for restore operations and
in allowing you to set up replication generally outweigh this minor
performance decrement.

</P>
<P>
When started with the <CODE>--log-bin[=file_name]</CODE> option, <CODE>mysqld</CODE>
writes a log file containing all SQL commands that update data. If no
<CODE>file_name</CODE> value is given, the default name is the name of the host machine followed
by <CODE>-bin</CODE>. If file name is given, but it doesn't contain a path, the
file is written in the data directory.

</P>
<P>
If you supply an extension in the log name (for example,
<CODE>--log-bin=filename.extension</CODE>), the
extension is silently removed and ignored.

</P>
<P>
<CODE>mysqld</CODE> appends a numeric extension to the binary log name. The number
is incremented each time you start the server or flush the logs.
A new binary log also is created
automatically when the current log's size reaches 
<CODE>max_binlog_size</CODE>. A binary log may become larger than
<CODE>max_binlog_size</CODE> if you are using large transactions: A transaction is
written to the binary log in one piece, never split between binary logs.

</P>
<P>
To be able to know which different binary log files have been used,
<CODE>mysqld</CODE> also creates a binary log index file that
contains the name of all used binary log files. By default this has the
same name as the binary log file, with the extension <CODE>'.index'</CODE>.
You can change the name of the binary log index file with the
<CODE>--log-bin-index=[file_name]</CODE> option.
You should not manually edit this file while <CODE>mysqld</CODE> is running;
doing this would confuse <CODE>mysqld</CODE>.

</P>
<P>
You can delete all binary log files with the <CODE>RESET MASTER</CODE> statement,
or only some of them with <CODE>PURGE MASTER LOGS</CODE>.
See section <A HREF="manual.html#RESET">14.5.4.5  <CODE>RESET</CODE> Syntax</A> and section <A HREF="manual.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A>.

</P>
<P>
You can use the following options to <CODE>mysqld</CODE> to affect what is logged
to the binary log. Note also the discussion that follows this option list.

</P>
<DL COMPACT>

<DT><CODE>--binlog-do-db=db_name</CODE>
<DD>
Tells the master that it should log updates to the binary log if the
current database
(that is, the one selected by <CODE>USE</CODE>)
is <CODE>db_name</CODE>. All others
databases that are not explicitly mentioned are ignored.
Note that if you use this you should ensure that you only do updates in
the current database.

An example of what does not work as you might expect: If the server is
started with <CODE>binlog-do-db=sales</CODE>, and you do
<CODE>USE prices; UPDATE sales.january SET amount=amount+1000;</CODE>,
this statement will not be written into the binary log.

<DT><CODE>--binlog-ignore-db=db_name</CODE>
<DD>
Tells the master that updates where the current database
(that is, the one selected by <CODE>USE</CODE>) is
<CODE>db_name</CODE> should not be stored in the binary log.  Note that if
you use this you should ensure that you only do updates in the current
database.

An example of what does not work as you might expect: If the server is
started with <CODE>binlog-ignore-db=sales</CODE>, and you do
<CODE>USE prices; UPDATE sales.january SET amount=amount+1000;</CODE>,
this statement will be written into the binary log.

</DL>

<P>
To log or ignore multiple databases, specify the appropriate option multiple
times, once for each database.

</P>
<P>
The rules for logging or ignoring updates to the binary log are evaluated in
the following order:

</P>

<OL>
<LI>

Are there <CODE>binlog-do-db</CODE> or <CODE>binlog-ignore-db</CODE> rules?

<UL>
<LI>No:

Write the statement to the binary log and exit.
<LI>Yes:

Go to the next step.
</UL>

<LI>

So, there are some rules (<CODE>binlog-do-db</CODE> or
<CODE>binlog-ignore-db</CODE> or both). Is there a current database (has any
database been selected by <CODE>USE</CODE>?)?

<UL>
<LI>No:

Do <STRONG>NOT</STRONG> write the statement, and exit.
<LI>Yes:

Go to the next step.
</UL>

<LI>

There is a current database. Are there some <CODE>binlog-do-db</CODE> rules?

<UL>
<LI>Yes:

Does the current database match any of the <CODE>binlog-do-db</CODE>
rules?

<UL>
<LI>Yes:

Write the statement and exit.
<LI>No:

Do <STRONG>NOT</STRONG> write the statement, and exit.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

There are some <CODE>binlog-ignore-db</CODE> rules.
Does the current database match any of the <CODE>binlog-ignore-db</CODE>
rules?

<UL>
<LI>Yes:

Do not write the statement, and exit.
<LI>No:

Write the query and exit.
</UL>

</OL>

<P>
So, for example, a slave running with only <CODE>binlog-do-db=sales</CODE>
will not write to the binary log any statement whose current database is
different from <CODE>sales</CODE> (in other words, <CODE>binlog-do-db</CODE> can
sometimes mean ``ignore other databases'').

</P>
<P>
If you are using replication, you should not delete old binary log
files until you are sure that no slave will ever need to use them.
One way to do this is to do <CODE>mysqladmin flush-logs</CODE> once a day and then
remove any logs that are more than three days old. You can remove them
manually, or preferably using <CODE>PURGE MASTER LOGS</CODE>
(see section <A HREF="manual.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A>) which will also safely update the binary 
log index file for you  (and which can take a date argument since
MySQL 4.1)

</P>
<P>
A client with the <CODE>SUPER</CODE> privilege can disable binary
logging of its own statements by using a <CODE>SET
SQL_LOG_BIN=0</CODE> statement. See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
You can examine the binary log file with the <CODE>mysqlbinlog</CODE> utility.
This can be useful when you want to reprocess statements in the log.
For example, you can update a MySQL server from the binary log
as follows:

</P>

<PRE>
shell&#62; mysqlbinlog log-file | mysql -h server_name
</PRE>

<P>
See section <A HREF="manual.html#mysqlbinlog">8.5  The <CODE>mysqlbinlog</CODE> Binary Log Utility</A> for more information on the
<CODE>mysqlbinlog</CODE> utility and how to use it.

</P>
<P>
If you are using transactions, you must
use the MySQL binary log for backups instead of the old update log.

</P>
<P>
The binary logging is done immediately after a query completes but before
any locks are released or any commit is done. This ensures that the log
will be logged in the execution order.

</P>
<P>
Updates to non-transactional tables are stored in the binary log
immediately after execution.  For transactional tables such as <CODE>BDB</CODE>
or <CODE>InnoDB</CODE> tables, all updates (<CODE>UPDATE</CODE>, <CODE>DELETE</CODE>,
or <CODE>INSERT</CODE>) that change tables are cached until a <CODE>COMMIT</CODE>
statement is received by the server. At that point, <CODE>mysqld</CODE> writes the
whole transaction to the binary log before the <CODE>COMMIT</CODE> is executed.
When the thread that handles the transaction starts, it allocates a buffer
of <CODE>binlog_cache_size</CODE> to buffer queries.  If a statement is bigger
than this, the thread opens a temporary file to store the transaction.  The
temporary file is deleted when the thread ends.

</P>
<P>
The <CODE>max_binlog_cache_size</CODE> (default 4G) can be used to restrict the
total size used to cache a multiple-statement transaction.  If a transaction
is larger than this, it will fail and roll back.

</P>
<P>
If you are using the update log or binary log, concurrent inserts will
be converted to normal inserts when using <CODE>CREATE ... SELECT</CODE> or
<CODE>INSERT ... SELECT</CODE>.
This is to ensure that you can re-create an exact copy of your tables by
applying the log on a backup.

</P>
<P>
The binary log format is different in versions 3.23, 4.0, and 5.0.0.
Those format changes were required to implement enhancements to replication.
MySQL 4.1 has the same binary log format as 4.0.

</P>


<H3><A NAME="Slow_query_log" HREF="manual_toc.html#Slow_query_log">5.8.5  The Slow Query Log</A></H3>

<P>
<A NAME="IDX661"></A>
<A NAME="IDX662"></A>

</P>
<P>
When started with the <CODE>--log-slow-queries[=file_name]</CODE> option,
<CODE>mysqld</CODE> writes a log file containing all SQL statements that took
more than <CODE>long_query_time</CODE> seconds to execute. The time to acquire
the initial table locks are not counted as execution time.

</P>
<P>
If no <CODE>file_name</CODE> value is given, the default is the name of the
host machine with a suffix of <CODE>-slow.log</CODE>. If a filename is given,
but doesn't contain a path, the file is written in the data directory.

</P>
<P>
A statement is logged to the slow query log after it has been executed
and after all locks have been released. Log order may be different from
execution order.

</P>
<P>
The slow query log can be used to find queries that take a long time to
execute and are therefore candidates for optimization. However, examining a long
slow query log can become a difficult task. To make this easier, you
can pipe the slow query log through the <CODE>mysqldumpslow</CODE> command to
get a summary of the queries that appear in the log.

</P>

<P>
If you also use the <CODE>--log-long-format</CODE> when logging slow queries,
then queries that are not using indexes are logged as well.  See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>



<H3><A NAME="Log_file_maintenance" HREF="manual_toc.html#Log_file_maintenance">5.8.6  Log File Maintenance</A></H3>

<P>
<A NAME="IDX663"></A>
<A NAME="IDX664"></A>
<A NAME="IDX665"></A>

</P>
<P>
The MySQL Server can create a number of different log files that make
it easy to see what is going on. See section <A HREF="manual.html#Log_Files">5.8  The MySQL Log Files</A>. However, you must
clean up these files regularly to ensure that the logs don't take up
too much disk space.

</P>
<P>
When using MySQL with logging enabled, you will want to back up and remove
old log files from time to time and tell MySQL to start logging to new files.
See section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>.

</P>
<P>
On a Linux (Red Hat) installation, you can use the
<CODE>mysql-log-rotate</CODE> script for this. If you installed MySQL
from an RPM distribution, the script should have been installed
automatically.  Note that you should be careful with this script if you are
using the binary log for replication! (You should not remove binary logs until
you are certain that their contents have been processed by all slaves.)

</P>
<P>
On other systems, you must install a short script yourself that you
start from <CODE>cron</CODE> to handle log files.

</P>
<P>
You can force MySQL to start using new log files by using
<CODE>mysqladmin flush-logs</CODE> or by using the SQL statement <CODE>FLUSH LOGS</CODE>.
If you are using MySQL Version 3.21, you must use <CODE>mysqladmin refresh</CODE>.

</P>
<P>
A log flushing operation does the following:

</P>

<UL>
<LI>

If standard logging (<CODE>--log</CODE>) or slow query logging
(<CODE>--log-slow-queries</CODE>) is used, closes and reopens the log file
(<TT>`mysql.log'</TT> and <TT>``hostname`-slow.log'</TT> as default).
<LI>

If update logging (<CODE>--log-update</CODE>) or binary logging (<CODE>--log-bin</CODE>)
is used, closes the log and opens a new log file with a higher sequence number.
</UL>

<P>
If you are using only an update log, you only have to flush the logs and then
move away the old update log files to a backup.
If you are using the normal logging, you can do something like:

</P>

<PRE>
shell&#62; cd mysql-data-directory
shell&#62; mv mysql.log mysql.old
shell&#62; mysqladmin flush-logs
</PRE>

<P>
Then make a backup and remove <TT>`mysql.old'</TT>.

</P>



<H2><A NAME="Multiple_servers" HREF="manual_toc.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A></H2>

<P>
<A NAME="IDX666"></A>
<A NAME="IDX667"></A>
<A NAME="IDX668"></A>
<A NAME="IDX669"></A>
<A NAME="IDX670"></A>

</P>

<P>
In some cases, you might want to run multiple <CODE>mysqld</CODE> servers
on the same machine.  You might want to test a new
MySQL release while leaving your existing production setup undisturbed.
Or you may want to give different users access to different <CODE>mysqld</CODE>
servers that they manage themselves.  (For example, you might be an
Internet Service Provider that wants to provide independent MySQL
installations for different customers.)

</P>
<P>
To run multiple servers on a single machine, each server must have
unique values for several operating parameters. These can be set on the
command line or in option files.
See section <A HREF="manual.html#Program_Options">4.3  Specifying Program Options</A>.

</P>
<P>
At least the following options must be different for each server:

</P>

<UL>
<LI><CODE>--port=port_num</CODE>

<CODE>--port</CODE> controls the port number for TCP/IP connections.

<LI><CODE>--socket=path</CODE>

<CODE>--socket</CODE> controls the socket file path on Unix and the name of the
named pipe on Windows. On Windows, it's necessary to specify distinct pipe names
only for those servers that support named pipe connections.

<LI><CODE>--shared-memory-base-name=name</CODE>

This option currently is used only on Windows.
It designates the shared memory name used by a
Windows server to allow clients to connect via shared memory.
This option is new in MySQL 4.1.

<LI><CODE>--pid-file=path</CODE>

This option is used only on Unix.
It indicates the name of the file in which the server writes its process ID.

</UL>

<P>
If you use the following log file options, they must be different for
each server:

</P>


<UL>
<LI><CODE>--log=path</CODE>

<LI><CODE>--log-bin=path</CODE>

<LI><CODE>--log-update=path</CODE>

<LI><CODE>--log-error=path</CODE>

<LI><CODE>--log-isam=path</CODE>

<LI><CODE>--bdb-logdir=path</CODE>

</UL>

<P>
Log file options are described in section <A HREF="manual.html#Log_file_maintenance">5.8.6  Log File Maintenance</A>.

</P>
<P>
If you want more performance, you can also specify the following options
differently for each server, to spread the load between several physical disks:

</P>

<UL>
<LI><CODE>--tmpdir=path</CODE>

<LI><CODE>--bdb-tmpdir=path</CODE>

</UL>

<P>
Having different temporary directories is also recommended for the reason
that it is easier to determine which MySQL server created any given
temporary file.

</P>
<P>
Generally, each server should also use a different data directory, which is
specified using the <CODE>--datadir=path</CODE> option.

</P>
<P>
<STRONG>Warning:</STRONG> Normally you should never have two servers that
update data in the same databases!  This may lead to unpleasant
surprises if your operating system doesn't support fault-free system
locking!  If (despite this warning) you run multiple servers using
the same data directory and they have logging enabled, you must
use the appropriate options to specify log file names that are
unique to each server.  Otherwise, the servers will try to log to
the same files.

</P>
<P>
This warning against sharing a data directory among servers also applies
in an NFS environment.  Allowing multiple MySQL servers to access a common
data directory over NFS is a <STRONG>bad idea</STRONG>!

</P>

<UL>

<LI>

The primary problem is that NFS will become the speed bottleneck.
It is not meant for such use.

<LI>

Another risk with NFS is that you will have to come up with a way
to make sure that two or more servers do not interfere with each
other.  Usually NFS file locking is handled by the <CODE>lockd</CODE>
daemon, but at the moment there is no platform that will perform
locking 100% reliably in every situation.

</UL>

<P>
Make it easy for yourself: Forget about sharing a data directory
among servers over NFS. A better solution is to have one computer
that contains several CPUs and use an operating system that
handles threads efficiently.

</P>
<P>
If you have multiple MySQL installations in different locations, normally
you can specify the base installation directory for each server with the
<CODE>--basedir=path</CODE> option to cause each server to use a different data
directory, log files, and PID file. (The defaults for all these values are
determined relative to the base directory). In that case, the only other
options you need to specify are the <CODE>--socket</CODE> and <CODE>--port</CODE>
options.  For example, suppose that you install different versions of MySQL using
<TT>`.tar'</TT> file binary distributions. These will install in different
locations, so you can start the server for each installation using the
command <CODE>./bin/mysqld_safe</CODE> under its corresponding base directory.
<CODE>mysqld_safe</CODE> will determine the proper
<CODE>--basedir</CODE> option to pass to <CODE>mysqld</CODE>, and you need specify
only the <CODE>--socket</CODE> and <CODE>--port</CODE> options to <CODE>mysqld_safe</CODE>.
(For versions of MySQL older than 4.0, use <CODE>safe_mysqld</CODE>
rather than <CODE>mysqld_safe</CODE>.)

</P>
<P>
As discussed in the following sections, it is possible to start additional
servers by setting environment variables or by specifying appropriate
command-line options.  However, if you need to run multiple servers on
a more permanent basis, it will be more convenient to use option files
to specify for each server those option values that must be unique to it.

</P>



<H3><A NAME="Multiple_Windows_servers" HREF="manual_toc.html#Multiple_Windows_servers">5.9.1  Running Multiple Servers on Windows</A></H3>

<P>
You can run multiple servers on Windows by starting them manually from the
command line, each with appropriate operating parameters. On Windows NT-based
systems, you also have the option of installing several servers as Windows services
and running them that way. General instructions for running MySQL servers
from the command line or as services are given in section <A HREF="manual.html#Windows_installation">2.2.1  Installing MySQL on Windows</A>. This section
describes how to make sure that you start each server with different values for
those startup options that must be unique per server, such as the data
directory.  (These options are described in section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A>.)

</P>



<H4><A NAME="Multiple_Windows_command-line_servers" HREF="manual_toc.html#Multiple_Windows_command-line_servers">5.9.1.1  Starting Multiple Windows Servers at the Command Line</A></H4>

<P>
To start multiple servers manually from the command line, you can specify the appropriate options on
the command line or in an option file. It's more convenient to place the
options in an option file, but it's necessary to make sure that each server
gets its own set of options. To do this, create an option file for each
server and tell the server the filename with a <CODE>--defaults-file</CODE> option
when you run it.

</P>
<P>
Suppose that you want to run <CODE>mysqld</CODE> on port 3307 with a
data directory of <TT>`C:\mydata1'</TT>, and <CODE>mysqld-max</CODE> on port 3308 with a
data directory of <TT>`C:\mydata2'</TT>. (To do this, make sure that before you
start the servers, each data directory exists and has its own copy of the
<CODE>mysql</CODE> database that contains the grant tables.)

</P>
<P>
Then create two option
files. For example, create one file named <TT>`C:\my-opts1.cnf'</TT> that looks
like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata1
port = 3307
</PRE>

<P>
Create a second file named <TT>`C:\my-opts2.cnf'</TT> that looks like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata2
port = 3308
</PRE>

<P>
Then start each server with its own option file:

</P>

<PRE>
C:\&#62; mysqld --defaults-file=C:\my-opts1.cnf
C:\&#62; mysqld-max --defaults-file=C:\my-opts2.cnf
</PRE>

<P>
On NT, each server will start in the foreground (no new prompt appears until
the server exits later); you'll need to issue those two commands in separate
console windows.

</P>
<P>
To shut down the servers, you must connect to the appropriate port number:

</P>

<PRE>
C:\&#62; mysqladmin --port=3307 shutdown
C:\&#62; mysqladmin --port=3308 shutdown
</PRE>

<P>
Servers configured as just described will allow clients to connect over
TCP/IP.  If your version of Windows supports named pipes and you also want
to allow named pipe connections, use the <CODE>mysqld-nt</CODE> or
<CODE>mysqld-max-nt</CODE> servers and specify options that enable the named pipe
and specify its name. Each server that supports named pipe connections must
use a unique pipe name.  For example, the <TT>`C:\my-opts1.cnf'</TT> file might
be written like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata1
port = 3307
enable-named-pipe
socket = mypipe1
</PRE>

<P>
Then start the server this way:

</P>

<PRE>
C:\&#62; mysqld-nt --defaults-file=C:\my-opts1.cnf
</PRE>

<P>
<TT>`C:\my-opts2.cnf'</TT> would be modified similarly for use by the second
server.

</P>


<H4><A NAME="Multiple_Windows_services" HREF="manual_toc.html#Multiple_Windows_services">5.9.1.2  Starting Multiple Windows Servers as Services</A></H4>

<P>
On NT-based systems, a MySQL server can be run as a Windows service. The
procedures for installing, controlling, and removing a single MySQL service are
described in section <A HREF="manual.html#NT_start">2.2.1.7  Starting MySQL as a Windows Service</A>.

</P>
<P>
As of MySQL 4.0.2, you can install multiple servers as services.
In this case, you must make sure that each server uses a different
service name in addition to all the other parameters that must be unique per
server.

</P>
<P>
For the following instructions, assume that you want to run the <CODE>mysqld-nt</CODE>
server from two different versions of MySQL that are installed at
<TT>`C:\mysql-4.0.8'</TT> and <TT>`C:\mysql-4.0.17'</TT>, respectively. (This might be
the case if you're running 4.0.8 as your production server, but want to test
4.0.17 before upgrading to it.)

</P>
<P>
The following principles apply when installing a MySQL service with the
<CODE>--install</CODE> or <CODE>--install-manual</CODE> option:

</P>

<UL>

<LI>

If you specify no service name, the server uses the default service name of
<CODE>MySQL</CODE> and the server reads options from the <CODE>[mysqld]</CODE> group in
the standard option files.

<LI>

If you specify a service name after the
<CODE>--install</CODE> option, the server ignores the <CODE>[mysqld]</CODE> option
group and instead reads options from the group that has the same name as the
service. The server reads options from the standard option files.

<LI>

If you specify a <CODE>--defaults-file</CODE> option after the service name,
the server ignores the standard option files and reads options only from the
<CODE>[mysqld]</CODE> group of the named file.

</UL>

<P>
Note: Before MySQL 4.0.17, only a server installed using the default service
name (<CODE>MySQL</CODE>) or one installed explicitly with a service name of
<CODE>mysqld</CODE> will read the <CODE>[mysqld]</CODE> group in the standard option
files. As of 4.0.17, all servers read the <CODE>[mysqld]</CODE> group if they read
the standard option files, even if they are installed using another service
name. This allows you to use the <CODE>[mysqld]</CODE> group for options that should
be used by all MySQL services, and an option group named after each service
for use by the server installed with that service name.

</P>

<P>
Based on the preceding information, you have several ways to set
up multiple services.  The following instructions describe some
examples. Before trying any of them, be sure that you shut down and
remove any existing MySQL services first.

</P>

<UL>

<LI>

<STRONG>Approach 1:</STRONG>
Specify the options for all services in one of the standard option files.
To do this, use a different service name for each server.
Suppose that you want to run the 4.0.8 <CODE>mysqld-nt</CODE> using the service
name of <CODE>mysqld1</CODE> and the 4.0.17 <CODE>mysqld-nt</CODE> using the service name <CODE>mysqld2</CODE>.
In this case, you can use the <CODE>[mysqld1]</CODE> group for 4.0.8 and the
<CODE>[mysqld2]</CODE> group for 4.0.17.
For example, you can set up <TT>`C:\my.cnf'</TT> like this:


<PRE>
# options for mysqld1 service
[mysqld1]
basedir = C:/mysql-4.0.8
port = 3307
enable-named-pipe
socket = mypipe1

# options for mysqld2 service
[mysqld2]
basedir = C:/mysql-4.0.17
port = 3308
enable-named-pipe
socket = mypipe2
</PRE>

Install the services as follows, using the full server pathnames to ensure
that Windows registers the correct executable program for each service:


<PRE>
C:\&#62; C:\mysql-4.0.8\bin\mysqld-nt --install mysqld1
C:\&#62; C:\mysql-4.0.17\bin\mysqld-nt --install mysqld2
</PRE>

To start the services, use the services manager, or use <CODE>NET START</CODE>
with the appropriate service names:


<PRE>
C:\&#62; NET START mysqld1
C:\&#62; NET START mysqld2
</PRE>

To stop the services, use the services manager, or use <CODE>NET STOP</CODE>
with the appropriate service names:


<PRE>
C:\&#62; NET STOP mysqld1
C:\&#62; NET STOP mysqld2
</PRE>

<LI>

<STRONG>Approach 2:</STRONG>
Specify options for each server in separate files and use
<CODE>--defaults-file</CODE> when you install the services to tell each server
what file to use.  In this case, each file should list options using a
<CODE>[mysqld]</CODE> group.

With this approach, to specify options for the 4.0.8 <CODE>mysqld-nt</CODE>,
create a file <TT>`C:\my-opts1.cnf'</TT> that looks like this:


<PRE>
[mysqld]
basedir = C:/mysql-4.0.8
port = 3307
enable-named-pipe
socket = mypipe1
</PRE>

For the 4.0.17 <CODE>mysqld-nt</CODE>, create a file
<TT>`C:\my-opts2.cnf'</TT> that looks like this:


<PRE>
[mysqld]
basedir = C:/mysql-4.0.17
port = 3308
enable-named-pipe
socket = mypipe2
</PRE>

Install the services as follows (enter each command on a single line):


<PRE>
C:\&#62; C:\mysql-4.0.8\bin\mysqld-nt --install mysqld1
           --defaults-file=C:\my-opts1.cnf
C:\&#62; C:\mysql-4.0.17\bin\mysqld-nt --install mysqld2
           --defaults-file=C:\my-opts2.cnf
</PRE>

To use a <CODE>--defaults-file</CODE> option when you install a MySQL server as a
service, you must precede the option with the service name.

After installing the services, start and stop them the same way as in the
preceding example.

</UL>

<P>
To remove multiple services, use <CODE>mysqld --remove</CODE> for each one,
specifying a service name following the <CODE>--remove</CODE> option. If the
service name is the default (<CODE>MySQL</CODE>), you can omit it..

</P>



<H3><A NAME="Multiple_Unix_servers" HREF="manual_toc.html#Multiple_Unix_servers">5.9.2  Running Multiple Servers on Unix</A></H3>

<P>
The easiest way is to run multiple servers on Unix is to compile them
with different TCP/IP ports and Unix socket files so that each one is listening on
different network interfaces. Also, by compiling in different base directories
for each installation, that automatically results in different compiled-in
data directory, log file, and PID file locations for each of your servers.

</P>
<P>
Assume that an existing server is configured for the default TCP/IP port
number (3306) and Unix socket file (<TT>`/tmp/mysql.sock'</TT>).  To configure a
new server to have different operating parameters, use a <CODE>configure</CODE>
command something like this:

</P>

<PRE>
shell&#62; ./configure --with-tcp-port=port_number \
             --with-unix-socket-path=file_name \
             --prefix=/usr/local/mysql-4.0.17
</PRE>

<P>
Here, <CODE>port_number</CODE> and <CODE>file_name</CODE> must be different from the
default TCP/IP port number and Unix socket file pathname, and the
<CODE>--prefix</CODE> value should specify an installation directory different
than the one under which the existing MySQL installation is located.

</P>
<P>
If you have a MySQL server listening on a given port number, you can use the
following command to find out what operating parameters it is using for
several important configurable variables, including the base directory and
Unix socket filename:

</P>

<PRE>
shell&#62; mysqladmin --host=host_name --port=port_number variables
</PRE>

<P>
With the information displayed by that command, you can tell what option
values <STRONG>not</STRONG> to use when configuring an additional server.

</P>
<P>
Note that if you specify ``<CODE>localhost</CODE>'' as a hostname, <CODE>mysqladmin</CODE>
will default to using a Unix socket file connection rather than TCP/IP.
In MySQL 4.1, you can explicitly specify the connection protocol to use by
using the <CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE> option.

</P>
<P>
You don't have to compile a new MySQL server just to start with a different
Unix socket file and TCP/IP port number.  It is also possible to specify
those values at runtime. One way to do so is by using command-line options:

</P>

<PRE>
shell&#62; /path/to/mysqld_safe --socket=file_name --port=port_number
</PRE>

<P>
To start a second server, provide different <CODE>--socket</CODE> and
<CODE>--port</CODE> option values, and pass a a <CODE>--datadir=path</CODE> option to
<CODE>mysqld_safe</CODE> so that the server uses a different data directory.

</P>
<P>
Another way to achieve a similar effect is to use environment variables
to set the Unix socket filename and TCP/IP port number:

</P>
<P>
<A NAME="IDX671"></A>
<A NAME="IDX672"></A>
<A NAME="IDX673"></A>
<A NAME="IDX674"></A>

<PRE>
shell&#62; MYSQL_UNIX_PORT=/tmp/mysqld-new.sock
shell&#62; MYSQL_TCP_PORT=3307
shell&#62; export MYSQL_UNIX_PORT MYSQL_TCP_PORT
shell&#62; scripts/mysql_install_db
shell&#62; bin/mysqld_safe --datadir=/path/to/datadir &#38;
</PRE>

<P>
This is a quick way of starting a second server to use
for testing.  The nice thing about this method is that the environment
variable settings will apply to any client programs that you invoke from
the same shell. Thus, connections for those clients automatically will
be directed to the second server!

</P>
<P>
section <A HREF="manual.html#Environment_variables">E  Environment Variables</A> includes a list of other environment
variables you can use to affect <CODE>mysqld</CODE>.

</P>
<P>
For automatic server execution, your startup script that is executed
at boot time should execute the following command once for each
server with an appropriate option file path for each command:

</P>

<PRE>
mysqld_safe --defaults-file=path-to-option-file
</PRE>

<P>
Each option file should contain option values specific to a given server.

</P>
<P>
On Unix,
the <CODE>mysqld_multi</CODE> script is another way to start multiple servers.
See section <A HREF="manual.html#mysqld_multi">5.1.5  The <CODE>mysqld_multi</CODE> Program for Managing Multiple MySQL Servers</A>.

</P>



<H3><A NAME="Multiple-server_clients" HREF="manual_toc.html#Multiple-server_clients">5.9.3  Using Client Programs in a Multiple-Server Environment</A></H3>

<P>
When you want to connect with a client program to a MySQL server that is
listening to different network interfaces than those compiled into your
client, you can use one of the following methods:

</P>

<UL>
<LI>

Start the client with <CODE>--host=host_name --port=port_number</CODE> to connect
via TCP/IP to a remote server, with <CODE>--host=127.0.0.1
--port=port_number</CODE> to connect via TCP/IP to a local server, or with
<CODE>--host=localhost --socket=file_name</CODE> to connect to a local server via
a Unix socket file or a Windows named pipe.

<LI>

As of MySQL 4.1, start the client with <CODE>--protocol=tcp</CODE> to connect
via TCP/IP, <CODE>--protocol=socket</CODE> to connect via a Unix socket file,
<CODE>--protocol=pipe</CODE> to connect via a named pipe, or
<CODE>--protocol=memory</CODE> to connect via shared memory.  For TCP/IP
connections, you may also need to specify <CODE>--host</CODE> and <CODE>--port</CODE>
options.  For the other types of connections, you may need to specify
a <CODE>--socket</CODE> option to specify a Unix socket file or named pipe name, or a
<CODE>--shared-memory-base-name</CODE> option to specify the shared memory name.
Shared memory connections are supported only on Windows.

<LI>

<A NAME="IDX675"></A>
<A NAME="IDX676"></A>
<A NAME="IDX677"></A>
<A NAME="IDX678"></A>
On Unix, set the <CODE>MYSQL_UNIX_PORT</CODE> and <CODE>MYSQL_TCP_PORT</CODE>
environment variables to point to the Unix socket file and TCP/IP port
number before you start your clients.  If you normally use a specific socket
file or port number, you can place commands to set these environment
variables in your <TT>`.login'</TT> file so that they apply each time you log
in.
See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

<LI>

<A NAME="IDX679"></A>
<A NAME="IDX680"></A>
Specify the default Unix socket file and TCP/IP port number in the
<CODE>[client]</CODE> group of an option file. For example, you can use
<TT>`C:\my.cnf'</TT> on Windows, or the <TT>`.my.cnf'</TT> file in your home
directory on Unix.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

<LI>

In a C program, you can specify the socket file or port number arguments in the
<CODE>mysql_real_connect()</CODE> call.  You can also have the program read
option files by calling <CODE>mysql_options()</CODE>.
See section <A HREF="manual.html#C_API_functions">20.2.3  C API Function Descriptions</A>.

<LI>

If you are using the Perl <CODE>DBD::mysql</CODE> module, you can read options
from MySQL option files. For example:


<PRE>
$dsn = "DBI:mysql:test;mysql_read_default_group=client;"
        . "mysql_read_default_file=/usr/local/mysql/data/my.cnf";
$dbh = DBI-&#62;connect($dsn, $user, $password);
</PRE>

See section <A HREF="manual.html#Perl">20.6  MySQL Perl API</A>.

Other programming interfaces may provide similar capabilities for reading
option files.

</UL>



<H2><A NAME="Query_Cache" HREF="manual_toc.html#Query_Cache">5.10  The MySQL Query Cache</A></H2>

<P>
<A NAME="IDX681"></A>
<A NAME="IDX682"></A>

</P>
<P>
From version 4.0.1 on, <CODE>MySQL Server</CODE> features a <CODE>Query Cache</CODE>.
When in use, the query cache stores the text of a <CODE>SELECT</CODE> query
together with the corresponding result that was sent to the client.
If the identical query is received later, the server retrieves
the results from the query cache rather than parsing and executing the
query again.

</P>
<P>
<STRONG>Note:</STRONG> The query cache does not return stale data. When data
is modified, any relevant entries in the query cache are flushed.

</P>
<P>
The query cache is extremely useful in an environment where (some)
tables don't change very often and you have a lot of identical queries.
This is a typical situation for many Web servers that generate a lot of
dynamic pages based on database content.

</P>
<P>
<STRONG>Note:</STRONG> It doesn't work in an environment where you have many
mysqld servers updating the same MyISAM tables.

</P>
<P>
Some performance data for the query cache follow. These results were 
generated by running the MySQL benchmark suite on a Linux Alpha
2 x 500MHz with 2GB RAM and a 64MB query cache.

</P>

<UL>

<LI>

If all the queries you're performing are simple (such as selecting a row
from a table with one row), but still differ so that the queries cannot be
cached, the overhead for having the query cache active is 13%.  This could
be regarded as the worst case scenario. In real life, queries tend to be
much more complicated, so the overhead is normally significantly lower.

<LI>

Searches for a single row in a single-row table are 238% faster with the
query cache than without it.  This can be regarded as close to the minimum
speedup to be expected for a query that is cached.

</UL>

<P>
To disable the query cache at server startup, set the
<CODE>query_cache_size</CODE> system variable to 0.  By disabling the query cache
code, there is no noticeable overhead.  Query cache capabilities can be
excluded from the server entirely by using the <CODE>--without-query-cache</CODE>
option to <CODE>configure</CODE> when compiling MySQL.

</P>



<H3><A NAME="Query_Cache_How" HREF="manual_toc.html#Query_Cache_How">5.10.1  How the Query Cache Operates</A></H3>

<P>
This section describes how the query cache works when it is operational.
section <A HREF="manual.html#Query_Cache_Configuration">5.10.3  Query Cache Configuration</A> describes how to control whether or not it
is operational.

</P>
<P>
Queries are compared before parsing, so the following two queries are
regarded as different by the query cache:

</P>

<PRE>
SELECT * FROM tbl_name
Select * from tbl_name
</PRE>

<P>
Queries must
be exactly the same (byte for byte) to be seen as identical.
In addition, query strings that are identical may be treated as different for
otther reasons.
Queries that use different databases, different protocol versions,
or different default character sets are considered different
queries and are cached separately.

</P>
<P>
If a query result is returned from query cache, the server increments the
<CODE>Qcache_hits</CODE> status variable, not <CODE>Com_select</CODE>.
See section <A HREF="manual.html#Query_Cache_Status_and_Maintenance">5.10.4  Query Cache Status and Maintenance</A>.

</P>
<P>
If a table changes, then all cached queries that used the table become
invalid and are removed from the cache.  This includes queries that use
<CODE>MERGE</CODE> tables that map to the changed table.  A table can be changed
by many types of statements, such as <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
<CODE>DELETE</CODE>, <CODE>TRUNCATE</CODE>, <CODE>ALTER TABLE</CODE>, <CODE>DROP TABLE</CODE>, or
<CODE>DROP DATABASE</CODE>.

</P>
<P>
Transactional <CODE>InnoDB</CODE> tables that have been changed are invalidated
when a <CODE>COMMIT</CODE> is performed.

</P>
<P>
In MySQL 4.0, the query cache is disabled within transactions (it does
not return results). Beginning with MySQL 4.1.1, the query cache also
works within transactions when using <CODE>InnoDB</CODE> tables (it uses the
table version number to detect whether or not its contents are still current).

</P>
<P>
Before MySQL 5.0, a query that begins with a leading comment might be cached,
but could not be fetched from the cache. This problem is fixed in MySQL 5.0.

</P>
<P>
A query cannot be cached if it contains any of the following functions:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Function</STRONG>
 </TD><TD> <STRONG>Function</STRONG>
 </TD><TD> <STRONG>Function</STRONG>
</TD></TR>
<TR><TD><CODE>BENCHMARK()</CODE>
 </TD><TD> <CODE>CONNECTION_ID()</CODE>
 </TD><TD> <CODE>CURDATE()</CODE>
</TD></TR>
<TR><TD><CODE>CURRENT_DATE()</CODE>
 </TD><TD> <CODE>CURRENT_TIME()</CODE>
 </TD><TD> <CODE>CURRENT_TIMESTAMP()</CODE>
</TD></TR>
<TR><TD><CODE>CURTIME()</CODE>
 </TD><TD> <CODE>DATABASE()</CODE>
 </TD><TD> <CODE>ENCRYPT()</CODE> with one parameter
</TD></TR>
<TR><TD><CODE>FOUND_ROWS()</CODE>
 </TD><TD> <CODE>GET_LOCK()</CODE>
 </TD><TD> <CODE>LAST_INSERT_ID()</CODE>
</TD></TR>
<TR><TD><CODE>LOAD_FILE()</CODE>
 </TD><TD> <CODE>MASTER_POS_WAIT()</CODE>
 </TD><TD> <CODE>NOW()</CODE>
</TD></TR>
<TR><TD><CODE>RAND()</CODE>
 </TD><TD> <CODE>RELEASE_LOCK()</CODE>
 </TD><TD> <CODE>SYSDATE()</CODE>
</TD></TR>
<TR><TD><CODE>UNIX_TIMESTAMP()</CODE> with no parameters
 </TD><TD> <CODE>USER()</CODE>
</TD></TR>
</TABLE>

<P>
A query also will not be cached under these conditions:

</P>

<UL>
<LI>

It contains user-defined functions (UDFs).

<LI>

It contains user variables.

<LI>

It refers to the tables in the <CODE>mysql</CODE> system database.

<LI>

It is of any of the following forms:


<PRE>
SELECT ... IN SHARE MODE
SELECT ... INTO OUTFILE ...
SELECT ... INTO DUMPFILE ...
SELECT * FROM ... WHERE autoincrement_col IS NULL
</PRE>

The last form is not cached because it is used as the ODBC workaround for
obtaining the last insert ID value.
See section <A HREF="manual.html#ODBC_and_last_insert_id">20.3.6  How to Get the Value of an <CODE>AUTO_INCREMENT</CODE> Column in ODBC</A>.

<LI>

It uses <CODE>TEMPORARY</CODE> tables.

<LI>

It does not use any tables.

<LI>

The user has a column privilege for any of the involved tables.

Before a query is fetched from the query cache, MySQL checks that
the user has <CODE>SELECT</CODE> privilege for all the involved databases and
tables. If this is not the case, the cached result will not be used.

</UL>

<P>
The query cache does work for <CODE>SELECT SQL_CALC_FOUND_ROWS ...</CODE> and
<CODE>SELECT FOUND_ROWS()</CODE> type queries.  <CODE>FOUND_ROWS()</CODE> returns
the correct value even if the preceding query was fetched from the cache
because the number of found rows is also stored in the cache.

</P>



<H3><A NAME="Query_Cache_in_SELECT" HREF="manual_toc.html#Query_Cache_in_SELECT">5.10.2  Query Cache <CODE>SELECT</CODE> Options</A></H3>

<P>
There are two query cache-related options that may be
specified in a <CODE>SELECT</CODE> statement:

</P>
<P>
<A NAME="IDX683"></A>
<A NAME="IDX684"></A>

</P>
<DL COMPACT>

<DT><CODE>SQL_CACHE</CODE>
<DD>
The query result is cached if the value of the <CODE>query_cache_type</CODE>
system variable is <CODE>ON</CODE> or <CODE>DEMAND</CODE>.

<DT><CODE>SQL_NO_CACHE</CODE>
<DD>
The query result is not cached.

</DL>



<H3><A NAME="Query_Cache_Configuration" HREF="manual_toc.html#Query_Cache_Configuration">5.10.3  Query Cache Configuration</A></H3>

<P>
Several <CODE>mysqld</CODE> system variables control query cache operation.
These can be set in an option file or on the command line
when starting <CODE>mysqld</CODE>.
The query cache-related system variables all have names that begin with
<CODE>query_cache_</CODE>. They are described briefly in section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>, with additional configuration information given here.

</P>
<P>
To set the size of the query cache, set the <CODE>query_cache_size</CODE> system
variable. Setting it to 0 disables the query cache. The default cache size
is 0; that is, the query cache is disabled.

</P>
<P>
Assuming that the query cache is enabled, the <CODE>query_cache_type</CODE> variable
influences how it works. This variable can be set to the following values:

</P>

<UL>
<LI>

A value of <CODE>0</CODE> or <CODE>OFF</CODE> prevents caching or retrieval of cached
results.

<LI>

A value of <CODE>1</CODE> or <CODE>ON</CODE> allows caching except of those statements
that begin with <CODE>SELECT SQL_NO_CACHE</CODE>.

<LI>

A value of <CODE>2</CODE> or <CODE>DEMAND</CODE> causes caching of only those statements
that begin with <CODE>SELECT SQL_CACHE</CODE>.

</UL>

<P>
Setting the <CODE>GLOBAL</CODE> <CODE>query_cache_type</CODE> determines query cache
behavior for all clients that connect after the change is made. Individual
clients can control cache behavior for their own connection by setting the
<CODE>SESSION</CODE> value of <CODE>query_cache_type</CODE>. For example, a client
can disable use of the query cache for its own queries like this:

</P>

<PRE>
mysql&#62; SET SESSION query_cache_type = OFF;
</PRE>

<P>
To control the maximum size of individual query results that can be cached,
set the <CODE>query_cache_limit</CODE> variable. The default value is 1MB.

</P>
<P>
The result of a query (the data sent to the client) is stored in the query
cache during result retrieval. Therefore the data is usually not handled in
one big chunk. The query cache allocates blocks for storing this data on
demand, so when one block is filled, a new block is allocated.  Because
memory allocation operation is costly (time wise), the query cache allocates
blocks with a minimum size given by the <CODE>query_cache_min_res_unit</CODE>
system variable.  When a query is executed, the last result block is trimmed
to the actual data size so that unused memory is freed.
Depending on the types of queries your server executes, you might find it
helpful to tune the value of <CODE>query_cache_min_res_unit</CODE>:

</P>

<UL>

<LI>

The default value of <CODE>query_cache_min_res_unit</CODE> is 4KB. This should
be adequate for most cases.

<LI>

If you have a lot of queries with small results, the default block size may
lead to memory fragmentation, as indicated by a large number of free blocks.
Fragmentation can cause the query cache to have to delete queries from the
cache due to lack of memory.  In this case, you should decrease the value of
<CODE>query_cache_min_res_unit</CODE>.  The number of free blocks and queries
removed due to pruning are given by the values of the
<CODE>Qcache_free_blocks</CODE> and <CODE>Qcache_lowmem_prunes</CODE> status variables.

<LI>

If most of your queries have large results (check the
<CODE>Qcache_total_blocks</CODE> and <CODE>Qcache_queries_in_cache</CODE> status
variables), you can increase performance by increasing
<CODE>query_cache_min_res_unit</CODE>. However, be careful to not make it too
large (see the previous item).

</UL>

<P>
<CODE>query_cache_min_res_unit</CODE> is present from MySQL 4.1.

</P>



<H3><A NAME="Query_Cache_Status_and_Maintenance" HREF="manual_toc.html#Query_Cache_Status_and_Maintenance">5.10.4  Query Cache Status and Maintenance</A></H3>

<P>
You can check whether the query cache is present in your MySQL server using
the following statement:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_query_cache';
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| have_query_cache | YES   |
+------------------+-------+
</PRE>

<P>
You can defragment the query cache to better utilize its memory
with the <CODE>FLUSH QUERY CACHE</CODE> statement.
The statement does not remove any queries from the cache.

</P>
<P>
The <CODE>RESET QUERY CACHE</CODE> statement removes all query results from the
query cache.  The <CODE>FLUSH TABLES</CODE> statement also does this.

</P>
<P>
To monitor query cache performance, use <CODE>SHOW STATUS</CODE> to view
the cache status variables:

</P>

<PRE>
mysql&#62; SHOW STATUS LIKE 'Qcache%';
+-------------------------+--------+
| Variable_name           | Value  |
+-------------------------+--------+
| Qcache_free_blocks      | 36     |
| Qcache_free_memory      | 138488 |
| Qcache_hits             | 79570  |
| Qcache_inserts          | 27087  |
| Qcache_lowmem_prunes    | 3114   |
| Qcache_not_cached       | 22989  |
| Qcache_queries_in_cache | 415    |
| Qcache_total_blocks     | 912    |
+-------------------------+--------+
</PRE>

<P>
Descriptions of each of these variables are given in
section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>.  Some uses for them are described here.

</P>
<P>
&#60;total number of SELECT queries&#62; =
<CODE>Com_select</CODE> + <CODE>Qcache_hits</CODE> + &#60;queries with errors found by parser&#62;

</P>
<P>
<CODE>Com_select</CODE> =
<CODE>Qcache_inserts</CODE> + <CODE>Qcache_not_cached</CODE> +
&#60;queries with errors found during fields/rights check&#62;

</P>
<P>
The query cache uses variable-length blocks, so <CODE>Qcache_total_blocks</CODE>
and <CODE>Qcache_free_blocks</CODE> may indicate query cache memory fragmentation.
After <CODE>FLUSH QUERY CACHE</CODE>, only a single free block remains.

</P>
<P>
Note: Every cached query requires a minimum of two blocks (one for the query
text and one or more for the query results). Also, every table that is used
by a query requires one block. However, if two or more queries use the same
table, only one block needs to be allocated.

</P>
<P>
The information provided by the <CODE>Qcache_lowmem_prunes</CODE> status variable
can help you tune the query cache size. It counts the number of queries that
have been removed from the cache to free up memory for caching new queries.
The query cache uses a least recently used (LRU) strategy to decide which
queries to remove from the cache. Tuning information is given in section <A HREF="manual.html#Query_Cache_Configuration">5.10.3  Query Cache Configuration</A>.

</P>



<H1><A NAME="Replication" HREF="manual_toc.html#Replication">6  Replication in MySQL</A></H1>

<P>
<A NAME="IDX685"></A>
<A NAME="IDX686"></A>
<A NAME="IDX687"></A>
<A NAME="IDX688"></A>

</P>

<P>
Replication capabilities allowing the databases on one MySQL server to be
duplicated on another were introduced in MySQL 3.23.15.
This chapter describes the various replication features provided by MySQL.
It introduces replication concepts, shows how to set up replication servers,
and serves as a reference to the available replication options.
It also provides a list of
frequently asked questions (with answers), and troubleshooting advice for
solving problems.

</P>
<P>
For a description of the syntax of replication-related SQL statements, see
section <A HREF="manual.html#Replication_SQL">14.6  Replication Statements</A>.

</P>
<P>
We suggest that you visit our Web site at <a HREF="http://www.mysql.com">http://www.mysql.com</a>
often and read updates to this chapter. Replication is constantly being
improved, and we update the manual frequently with the most current
information.

</P>


<H2><A NAME="Replication_Intro" HREF="manual_toc.html#Replication_Intro">6.1  Introduction to Replication</A></H2>

<P>
MySQL 3.23.15 and up features support for one-way replication.
One server acts as the master, while one or more other servers
act as slaves.  The master server writes updates to its binary log files,
and maintains an index of the files to keep track of log rotation.  These logs
serve as a record of updates to be sent to slave servers.  When a
slave server connects to the master server, it informs the master of its last
position within the logs since the last successfully propagated update.
The slave catches up any updates that have occurred since then, and then
blocks and waits for the master to notify it of new updates.

</P>
<P>
A slave server can also serve as a master if you want to set up chained
replication servers.

</P>
<P>
Note that when you are using replication, all updates to the
tables that are replicated
should be performed on the master server. Otherwise, you must always be
careful to avoid conflicts between updates that users make to tables on the
master and updates that they make to tables on the slave.

</P>
<P>
One-way replication has benefits for robustness, speed, and system
administration:

</P>

<UL>

<LI>

Robustness is increased with a master/slave setup.
In the event of problems with the master, you can switch to the slave as a
backup.

<LI>

Better response time for clients can be achieved by splitting the load
for processing client queries between the master and slave servers.
<CODE>SELECT</CODE> queries may be sent to the slave to reduce the query
processing load of the master. Statements that modify data should still
be sent to the master so that the master and slave do not get out of sync.
This load-balancing strategy is effective if non-updating queries dominate,
but that is the normal case.

<LI>

Another benefit of using replication is that you can perform backups using a
slave server without disturbing the master. The master continues to process
updates while the backup is being made.
See section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>.

</UL>



<H2><A NAME="Replication_Implementation" HREF="manual_toc.html#Replication_Implementation">6.2  Replication Implementation Overview</A></H2>

<P>
<A NAME="IDX689"></A>

</P>
<P>
MySQL replication is based on the master server keeping track of all changes
to your databases (updates, deletes, and so on) in the binary logs. Therefore,
to use replication, you must enable binary logging on the master server.
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>
<P>
Each slave server receives from the master the saved updates that the
master has recorded in its binary log, so that the slave can execute the
same updates on its copy of the data.

</P>
<P>
It is <STRONG>very important</STRONG> to realize that the binary log is simply a
record starting from the fixed point in time at which you enable binary
logging. Any slaves that you set up will need copies of the databases on
your master as they existed at the moment you enabled binary
logging on the master. If you start your slaves with databases that are not the same
as what was on the master <STRONG>when the binary log was
started</STRONG>, your slaves may fail.

</P>
<P>
One way to copy the master's data to the slave is to use the <CODE>LOAD
DATA FROM MASTER</CODE> statement.  Be aware that <CODE>LOAD DATA FROM MASTER</CODE>
is available only as of MySQL 4.0.0 and currently works only if all the
tables on the master are <CODE>MyISAM</CODE> type. Also, this statement acquires a
global read lock, so no updates on the master are possible while the tables
are being transferred to the slave. When we implement lock-free hot table
backup (in MySQL 5.0), this global read lock will no longer be necessary.

</P>
<P>
Due to these limitations, we recommend that at this point  you use
<CODE>LOAD DATA FROM MASTER</CODE> only if the dataset on the master is relatively
small, or if a prolonged read lock on the master is acceptable. While the
actual speed of <CODE>LOAD DATA FROM MASTER</CODE> may vary from system to system,
a good rule of thumb for how long it will take is 1 second per 1MB of data.
That is only a rough estimate, but you should get close to it if both
master and slave are equivalent to 700MHz Pentium performance and are
connected through a 100MBit/s network.

</P>
<P>
After the slave has been set up with a copy of the master's data, it
will simply connect to the master and wait for updates to process. If
the master goes away or the slave loses connectivity with your master,
it will keep trying to connect periodically until it is able to reconnect
and resume listening for updates. The retry interval is controlled by the
<CODE>--master-connect-retry</CODE> option. The default is 60 seconds.

</P>
<P>
Each slave keeps track of where it left off. The master server has no
knowledge of how many slaves there are or which ones are up to date at
any given time.

</P>



<H2><A NAME="Replication_Implementation_Details" HREF="manual_toc.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A></H2>

<P>
MySQL replication capabilities are implemented using three threads (one
on the master server and two on the slave).  When <CODE>START SLAVE</CODE> is
issued, the slave creates an I/O thread.  The I/O thread connects to the
master and asks it to send the statements recorded in its binary logs. The
master creates a thread to send the binary log contents to the slave.
This thread can be identified as the <CODE>Binlog Dump</CODE> thread in the
output of <CODE>SHOW PROCESSLIST</CODE> on the master.  The slave I/O thread
reads what the master <CODE>Binlog Dump</CODE> thread sends and simply copies
it to some local files in the slave's data directory called relay logs.
The third thread is the SQL thread, which the slave creates to read the
relay logs and execute the updates they contain.

</P>
<P>
In the preceding description, there are three threads per slave. For a
master that has multiple slaves, it creates one thread for each currently
connected slave, and each slave has its own I/O and SQL threads.

</P>
<P>
For versions of MySQL before 4.0.2, replication involves only two threads
(one on the master and one on the slave). The slave I/O and SQL threads
are combined as a single thread, and no relay log files are used.

</P>
<P>
The advantage of using two slave threads is that statement reading and
execution are separated into two independent tasks. The task of reading
statements is not slowed down if statement execution is slow.  For example,
if the slave server has not been running for a while, its I/O thread can
quickly fetch all the binary log contents from the master when the slave starts,
even if the SQL thread lags far behind and may take hours to catch up.
If the slave stops before the SQL thread has executed all the fetched
statements, the I/O thread has at least fetched everything so that a
safe copy of the statements is locally stored in the slave's relay logs
for execution when next the slave starts. This allows the binary logs to be
purged on the master, because it no longer need wait for the slave to
fetch their contents.

</P>
<P>
The <CODE>SHOW PROCESSLIST</CODE> statement provides information that tells you
what is happening on the master and on the slave regarding replication.

</P>
<P>
The following example illustrates how the three threads show up in
<CODE>SHOW PROCESSLIST</CODE>.  The output format is that used by <CODE>SHOW
PROCESSLIST</CODE> as of MySQL version 4.0.15, when the content of the
<CODE>State</CODE> column was changed to be more meaningful compared to
earlier versions.

</P>
<P>
On the master server, the output from <CODE>SHOW PROCESSLIST</CODE> looks like this:

</P>

<PRE>
mysql&#62; SHOW PROCESSLIST\G
*************************** 1. row ***************************
     Id: 2
   User: root
   Host: localhost:32931
     db: NULL
Command: Binlog Dump
   Time: 94
  State: Has sent all binlog to slave; waiting for binlog to
         be updated
   Info: NULL
</PRE>

<P>
Here, thread 2 is a replication thread for a connected slave. The information
indicates that all outstanding updates have been sent to the slave and that
the master is waiting for more updates to occur.

</P>
<P>
On the slave server, the output from <CODE>SHOW PROCESSLIST</CODE> looks like this:

</P>

<PRE>
mysql&#62; SHOW PROCESSLIST\G
*************************** 1. row ***************************
     Id: 10
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 11
  State: Waiting for master to send event
   Info: NULL
*************************** 2. row ***************************
     Id: 11
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 11
  State: Has read all relay log; waiting for the slave I/O
         thread to update it
   Info: NULL
</PRE>

<P>
This information indicates that thread 10 is the I/O thread that is
communicating with the master server, and thread 11 is the SQL thread that
is processing the updates stored in the relay logs.  Currently, both threads
are idle, waiting for further updates.

</P>
<P>
Note that the value in the <CODE>Time</CODE> column can tell how late the slave
is compared to the master.
See section <A HREF="manual.html#Replication_FAQ">6.9  Replication FAQ</A>.

</P>



<H3><A NAME="Master_thread_states" HREF="manual_toc.html#Master_thread_states">6.3.1  Replication Master Thread States</A></H3>

<P>
The following list shows the most common states you will see in the
<CODE>State</CODE> column for the master's <CODE>Binlog Dump</CODE> thread. If you
don't see any <CODE>Binlog Dump</CODE> threads on a master server, replication
is not running. That is, no slaves currently are connected.

</P>
<DL COMPACT>

<DT><CODE>Sending binlog event to slave</CODE>
<DD>
Binary logs consist of events, where an event is usually an update statement
plus some other information. The thread has read an event from the binary
log and is sending it to the slave.

<DT><CODE>Finished reading one binlog; switching to next binlog</CODE>
<DD>
The thread has finished reading a binary log file and is opening
the next one to send to the slave.

<DT><CODE>Has sent all binlog to slave; waiting for binlog to be updated</CODE>
<DD>
The thread has read all outstanding updates from the binary logs and sent
them to the slave. It is idle, waiting for new events to appear in the
binary log resulting from new update statements being executed on the master.

<DT><CODE>Waiting to finalize termination</CODE>
<DD>
A very brief state that occurs as the thread is stopping.

</DL>



<H3><A NAME="Slave_I_O_thread_states" HREF="manual_toc.html#Slave_I_O_thread_states">6.3.2  Replication Slave I/O Thread States</A></H3>

<P>
The following list shows the most common states you will see in the
<CODE>State</CODE> column for a slave server I/O thread. Beginning with MySQL
4.1.1, this state also appears in the <CODE>Slave_IO_State</CODE> column displayed
by the <CODE>SHOW SLAVE STATUS</CODE> statement. This means that you can get a
good view of what is happening by using only <CODE>SHOW SLAVE STATUS</CODE>.

</P>
<DL COMPACT>

<DT><CODE>Connecting to master</CODE>
<DD>
The thread is attempting to connect to the master.

<DT><CODE>Checking master version</CODE>
<DD>
A very brief state that occurs just after the connection to the master
is established.

<DT><CODE>Registering slave on master</CODE>
<DD>
A very brief state that occurs just after the connection to the master
is established.

<DT><CODE>Requesting binlog dump</CODE>
<DD>
A very brief state that occurs just after the connection to the master is
established.  The thread sends to the master a request for the contents
of its binary logs, starting from the requested binary log filename and
position.

<DT><CODE>Waiting to reconnect after a failed binlog dump request</CODE>
<DD>
If the binary log dump request failed (due to disconnection), the
thread goes into this state while it sleeps, then tries to reconnect
periodically. The interval between retries can
be specified using the
<CODE>--master-connect-retry</CODE> option.

<DT><CODE>Reconnecting after a failed binlog dump request</CODE>
<DD>
The thread is trying to reconnect to the master.

<DT><CODE>Waiting for master to send event</CODE>
<DD>
The thread has connected to the master and is waiting for binary log events
to arrive. This can last for a long time if the master is idle. If the
wait lasts for <CODE>slave_read_timeout</CODE> seconds, a timeout will occur.
At that point, the thread will consider the connection to be broken and
make an attempt to reconnect.

<DT><CODE>Queueing master event to the relay log</CODE>
<DD>
The thread has read an event and is copying it to the relay log so that the SQL
thread can process it.

<DT><CODE>Waiting to reconnect after a failed master event read</CODE>
<DD>
An error occurred while reading (due to disconnection). The thread is sleeping
for <CODE>master-connect-retry</CODE> seconds before attempting to reconnect.

<DT><CODE>Reconnecting after a failed master event read</CODE>
<DD>
The thread is trying to reconnect to the master. When connection is established
again, the state will become <CODE>Waiting for master to send event</CODE>.

<DT><CODE>Waiting for the slave SQL thread to free enough relay log space</CODE>
<DD>
You are using a non-zero <CODE>relay_log_space_limit</CODE> value, and the relay
logs have grown so much that their combined size exceeds this value.
The I/O thread is waiting until the SQL
thread frees enough space by processing relay log contents so that it can
delete some relay log files.

<DT><CODE>Waiting for slave mutex on exit</CODE>
<DD>
A very brief state that occurs as the thread is stopping.

</DL>



<H3><A NAME="Slave_SQL_thread_states" HREF="manual_toc.html#Slave_SQL_thread_states">6.3.3  Replication Slave SQL Thread States</A></H3>

<P>
The following list shows the most common states you will see in the
<CODE>State</CODE> column for a slave server SQL thread:

</P>
<DL COMPACT>

<DT><CODE>Reading event from the relay log</CODE>
<DD>
The thread has read an event from the relay log so that it can process it.

<DT><CODE>Has read all relay log; waiting for the slave I/O thread to update it</CODE>
<DD>
The thread has processed all events in the relay log files and is waiting for
the I/O thread to write new events to the relay log.

<DT><CODE>Waiting for slave mutex on exit</CODE>
<DD>
A very brief state that occurs as the thread is stopping.

</DL>

<P>
The <CODE>State</CODE> column for the I/O thread may also show the text of
a statement.  This indicates that the thread has read an event from the
relay log, extracted the statement from it, and is executing it.

</P>



<H3><A NAME="Slave_logs" HREF="manual_toc.html#Slave_logs">6.3.4  Replication Relay and Status Files</A></H3>

<P>
By default, relay logs are named using filenames of the form
<TT>`host_name-relay-bin.nnn'</TT>, where <CODE>host_name</CODE> is the name of the
slave server host and <CODE>nnn</CODE> is a sequence number.
Successive relay log files are created using successive sequence numbers,
beginning with <CODE>000001</CODE> (<CODE>001</CODE> in MySQL 4.0 or older).
The slave keeps track of relay logs currently in use in an index file.
The default relay log index filename is
<TT>`host_name-relay-bin.index'</TT>.
By default, these files are created in the slave's data directory.
The default filenames may be overridden with the <CODE>--relay-log</CODE> and
<CODE>--relay-log-index</CODE> server options.
See section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>.

</P>
<P>
Relay logs have the same format as binary logs, so you can use
<CODE>mysqlbinlog</CODE> to read them.  A relay log is automatically deleted by
the SQL thread as soon as it has executed all its events and no longer needs
it). There is no explicit mechanism for deleting relay logs, because the SQL
thread takes care of doing so. However, from MySQL 4.0.14, <CODE>FLUSH LOGS</CODE>
rotates relay logs, which will influence when the SQL thread deletes them.

</P>
<P>
A new relay log is created under the following conditions:

</P>

<UL>

<LI>

When the I/O thread starts for the first time
after the slave server starts.
(In MySQL 5.0, a new relay log is created each time the I/O thread
starts, not just the first time.)

<LI>

When the logs are flushed; for example, with <CODE>FLUSH LOGS</CODE> or
<CODE>mysqladmin flush-logs</CODE>. (This creates a new relay log only as of MySQL
4.0.14.)

<LI>

When the size of the current relay log file becomes too large. The meaning of
``too large'' is determined as follows:

<UL>
<LI>

<CODE>max_relay_log_size</CODE>, if <CODE>max_relay_log_size</CODE> &#62; 0
<LI>

<CODE>max_binlog_size</CODE>, if <CODE>max_relay_log_size</CODE> = 0
or MySQL is older than 4.0.14
</UL>

</UL>

<P>
A slave replication server creates two additional small files in the
data directory.  These are status files and are named <TT>`master.info'</TT>
and <TT>`relay-log.info'</TT> by default.  They contain information like
that shown in the output of the <CODE>SHOW SLAVE STATUS</CODE> statement
(see section <A HREF="manual.html#Replication_Slave_SQL">14.6.2  SQL Statements for Controlling Slave Servers</A> for a description of this statement).
As disk files, they survive a slave server's shutdown. The next time the
slave starts up, it reads these files to determine how far it has proceeded
in reading binary logs from the master and in processing its own relay logs.

</P>
<P>
The <TT>`master.info'</TT> file is updated by the I/O thread.
Before MySQL 4.1,
the correspondence between the lines in the file and the
columns displayed by <CODE>SHOW SLAVE STATUS</CODE> is as follows:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Line</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>1 </TD><TD> <CODE>Master_Log_File</CODE>
</TD></TR>
<TR><TD>2 </TD><TD> <CODE>Read_Master_Log_Pos</CODE>
</TD></TR>
<TR><TD>3 </TD><TD> <CODE>Master_Host</CODE>
</TD></TR>
<TR><TD>4 </TD><TD> <CODE>Master_User</CODE>
</TD></TR>
<TR><TD>5 </TD><TD> Password (not shown by <CODE>SHOW SLAVE STATUS</CODE>)
</TD></TR>
<TR><TD>6 </TD><TD> <CODE>Master_Port</CODE>
</TD></TR>
<TR><TD>7 </TD><TD> <CODE>Connect_Retry</CODE>
</TD></TR>
</TABLE>

<P>
As of MySQL 4.1, the file includes a line count and information about
SSL options:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Line</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>1 </TD><TD> Number of lines in the file
</TD></TR>
<TR><TD>2 </TD><TD> <CODE>Master_Log_File</CODE>
</TD></TR>
<TR><TD>3 </TD><TD> <CODE>Read_Master_Log_Pos</CODE>
</TD></TR>
<TR><TD>4 </TD><TD> <CODE>Master_Host</CODE>
</TD></TR>
<TR><TD>5 </TD><TD> <CODE>Master_User</CODE>
</TD></TR>
<TR><TD>6 </TD><TD> Password (not shown by <CODE>SHOW SLAVE STATUS</CODE>)
</TD></TR>
<TR><TD>7 </TD><TD> <CODE>Master_Port</CODE>
</TD></TR>
<TR><TD>8 </TD><TD> <CODE>Connect_Retry</CODE>
</TD></TR>
<TR><TD>9 </TD><TD> <CODE>Master_SSL_Allowed</CODE>
</TD></TR>
<TR><TD>10 </TD><TD> <CODE>Master_SSL_CA_File</CODE>
</TD></TR>
<TR><TD>11 </TD><TD> <CODE>Master_SSL_CA_Path</CODE>
</TD></TR>
<TR><TD>12 </TD><TD> <CODE>Master_SSL_Cert</CODE>
</TD></TR>
<TR><TD>13 </TD><TD> <CODE>Master_SSL_Cipher</CODE>
</TD></TR>
<TR><TD>14 </TD><TD> <CODE>Master_SSL_Key</CODE>
</TD></TR>
</TABLE>

<P>
The <TT>`relay-log.info'</TT> file is updated by the SQL thread.
The correspondence between the lines in the file and the
columns displayed by <CODE>SHOW SLAVE STATUS</CODE> is as follows:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Line</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>1 </TD><TD> <CODE>Relay_Log_File</CODE>
</TD></TR>
<TR><TD>2 </TD><TD> <CODE>Relay_Log_Pos</CODE>
</TD></TR>
<TR><TD>3 </TD><TD> <CODE>Relay_Master_Log_File</CODE>
</TD></TR>
<TR><TD>4 </TD><TD> <CODE>Exec_Master_Log_Pos</CODE>
</TD></TR>
</TABLE>

<P>
When you back up your slave's data, you should back up these two small files
as well, along with the relay log files. They are needed to resume
replication after you restore the slave's data.  If you lose the relay logs
but still have the <TT>`relay-log.info'</TT> file, you can check it to determine
how far the SQL thread has executed in the master binary logs. Then you
can use <CODE>CHANGE MASTER TO</CODE> with the <CODE>MASTER_LOG_FILE</CODE> and
<CODE>MASTER_LOG_POS</CODE> options to tell the slave to re-read the binary
logs from that point.  This requires that the binary logs still exist on
the master server.

</P>
<P>
If your slave is subject to replicating <CODE>LOAD DATA INFILE</CODE> statements,
you should also back up any <TT>`SQL_LOAD-*'</TT> files that exist in the
directory that the slave uses for this purpose.  The slave needs these files
to resume replication of any interrupted <CODE>LOAD DATA INFILE</CODE> operations.
The directory location is specified using the <CODE>--slave-load-tmpdir</CODE>
option.  Its default value, if not specified, is the value of the <CODE>tmpdir</CODE>
variable.

</P>


<H2><A NAME="Replication_HOWTO" HREF="manual_toc.html#Replication_HOWTO">6.4  How to Set Up Replication</A></H2>

<P>
Here is a quick description of how to set up complete replication of
your current MySQL server. It assumes that you want to replicate all
your databases and have not configured replication before. You will need
to shut down your master server briefly to complete the steps outlined
here.

</P>
<P>
The procedure is written in terms of setting up a single slave, but you can
use it to set up multiple slaves.

</P>
<P>
While this method is the most straightforward way to set up a slave,
it is not the only one. For example, if you already have a snapshot
of the master's data, and
the master already has its server ID set and binary logging enabled, you can
set up a slave without shutting down the master or even blocking updates to it.
For more details, please see section <A HREF="manual.html#Replication_FAQ">6.9  Replication FAQ</A>.

</P>
<P>
If you want to administer a MySQL replication setup, we suggest that
you read this entire chapter through and try all statements mentioned in
section <A HREF="manual.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A> and section <A HREF="manual.html#Replication_Slave_SQL">14.6.2  SQL Statements for Controlling Slave Servers</A>.  You should
also familiarize yourself with replication startup options described in
section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>.

</P>
<P>
Note that this procedure and some of the replication SQL statements
in later sections refer to the <CODE>SUPER</CODE> privilege. Prior to MySQL
4.0.2, use the <CODE>PROCESS</CODE> privilege instead.

</P>

<OL>
<LI>

Make sure that you have a recent version of MySQL installed on the master
and slaves, and that these versions are compatible according to the table
shown in section <A HREF="manual.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A>.

Please do not report bugs until you have verified that the problem is present
in the latest release.

<LI>

Set up an account on the master server that the slave server can use to
connect. This account must be given the <CODE>REPLICATION SLAVE</CODE> privilege.
If the account is used only for replication
(which is recommended), you don't need to grant any additional privileges.

Suppose that your domain is <CODE>mydomain.com</CODE> and you want to create an
account with a username of <CODE>repl</CODE> such that slave servers can use the
account to access the master server from any host in your domain using a
password of <CODE>slavepass</CODE>.
To create the account, this use <CODE>GRANT</CODE> statement:


<PRE>
mysql&#62; GRANT REPLICATION SLAVE ON *.*
    -&#62; TO 'repl'@'%.mydomain.com' IDENTIFIED BY 'slavepass';
</PRE>

For MySQL versions older than 4.0.2, the <CODE>REPLICATION CLIENT</CODE> privilege
does not exist. Grant the <CODE>FILE</CODE> privilege instead:


<PRE>
mysql&#62; GRANT FILE ON *.*
    -&#62; TO 'repl'@'%.mydomain.com' IDENTIFIED BY 'slavepass';
</PRE>

If you plan to use the <CODE>LOAD TABLE FROM MASTER</CODE> or <CODE>LOAD DATA
FROM MASTER</CODE> statements from the slave host, you will need to grant this
account additional privileges:


<UL>

<LI>

Grant the account the <CODE>SUPER</CODE> and <CODE>RELOAD</CODE> global privileges.

<LI>

Grant the <CODE>SELECT</CODE> privilege for all tables that
you want to load. Any master tables from which the account cannot
<CODE>SELECT</CODE> will be ignored by <CODE>LOAD DATA FROM MASTER</CODE>.
</UL>

<LI>

If you are using only <CODE>MyISAM</CODE> tables, flush all the tables and block
write statements by executing a <CODE>FLUSH TABLES WITH READ LOCK</CODE> statement.


<PRE>
mysql&#62; FLUSH TABLES WITH READ LOCK;
</PRE>

Leave the client running from which you issue the <CODE>FLUSH TABLES</CODE>
statement so that the read lock remains in effect. (If you exit the client,
the lock is released.) Then take a snapshot of the data on your master server.

The easiest way to create a snapshot is to use an archiving program to make a
binary backup of the databases in your master's data directory. 
For example, use <CODE>tar</CODE> on Unix, or <CODE>PowerArchiver</CODE>, <CODE>WinRAR</CODE>,
<CODE>WinZip</CODE>, or any similar software on Windows.
To use <CODE>tar</CODE> to create an archive that includes all
databases, change location into the master server's data directory, then
execute this command:


<PRE>
shell&#62; tar -cvf /tmp/mysql-snapshot.tar .
</PRE>

If you want the archive to include only a database called <CODE>this_db</CODE>, use
this command instead:


<PRE>
shell&#62; tar -cvf /tmp/mysql-snapshot.tar ./this_db
</PRE>

Then copy the archive file to the <TT>`/tmp'</TT> directory on the slave server
host. On that machine, change location into the slave's data directory, and
unpack the archive file using this command:


<PRE>
shell&#62; tar -xvf /tmp/mysql-snapshot.tar
</PRE>

You may not want to replicate the <CODE>mysql</CODE> database if the slave
server has a different set of user accounts from those that exist on the
master. In this case, you should exclude it from the archive. You also
need not include any log files in the archive, or the <TT>`master.info'</TT>
or <TT>`relay-log.info'</TT> files.

While the read lock placed by <CODE>FLUSH TABLES WITH READ LOCK</CODE> is in effect,
read the value of the current binary log name and offset on the master:


<PRE>
mysql &#62; SHOW MASTER STATUS;
+---------------+----------+--------------+------------------+
| File          | Position | Binlog_Do_DB | Binlog_Ignore_DB |
+---------------+----------+--------------+------------------+
| mysql-bin.003 | 73       | test         | manual,mysql     |
+---------------+----------+--------------+------------------+
</PRE>

The <CODE>File</CODE> column shows the name of the log,  while <CODE>Position</CODE> shows
the offset. In this example, the binary log value is
<CODE>mysql-bin.003</CODE> and the offset is 73. Record the values. You will need
to use them later when you are setting up the slave. They represent the
replication coordinates at which the slave should begin processing new updates
from the master.

After you have taken the snapshot and recorded the log name and offset,
you can re-enable write activity on the master:


<PRE>
mysql&#62; UNLOCK TABLES;
</PRE>

If you are using <CODE>InnoDB</CODE> tables, ideally you should use the <CODE>InnoDB Hot
Backup</CODE> tool.  It takes a consistent snapshot without acquiring any locks on
the master server, and records the log name and offset corresponding to the
snapshot to be later used on the slave.  <CODE>InnoDB Hot Backup</CODE> is a non-free
(commercial) additional tool that is not included in the standard MySQL distribution.
See the <CODE>InnoDB Hot Backup</CODE> home page at <a HREF="http://www.innodb.com/manual.php">http://www.innodb.com/manual.php</a>
for detailed information and screenshots.

Without the <CODE>Hot Backup</CODE> tool, the quickest way to take a binary snapshot
of <CODE>InnoDB</CODE> tables is to shut down the master server and copy the
<CODE>InnoDB</CODE> data files, log files, and table definition files (<CODE>.frm</CODE>
files). To record the current log file name and offset, you should issue
the following statements before you shut down the server:


<PRE>
mysql&#62; FLUSH TABLES WITH READ LOCK;
mysql&#62; SHOW MASTER STATUS;
</PRE>

Then record the log name and the offset from the output of <CODE>SHOW MASTER
STATUS</CODE> as was shown earlier. After recording the log name and the offset,
shut down the server <EM>without</EM> unlocking the tables to make sure that the
server goes down with the snapshot corresponding to the current log file
and offset:


<PRE>
shell&#62; mysqladmin -u root shutdown
</PRE>

An alternative that works for both <CODE>MyISAM</CODE> and <CODE>InnoDB</CODE>
tables is to take an SQL dump of the master instead of a binary copy as
described in the preceding discussion. For this, you can use <CODE>mysqldump
--master-data</CODE> on your master and later load the SQL dump file into your
slave. However, this is slower than doing a binary copy.

If the master has been previously running without <CODE>--log-bin</CODE> enabled,
the log name and position values displayed by <CODE>SHOW MASTER STATUS</CODE>
or <CODE>mysqldump</CODE> will be empty. In that case, the values that you will
need to use later when specifying the slave's log file and position are
the empty string (<CODE>''</CODE>) and <CODE>4</CODE>.

<LI>

Make sure that the <CODE>[mysqld]</CODE> section of the <TT>`my.cnf'</TT> file on
the master host includes a <CODE>log-bin</CODE> option. The section should also
have a <CODE>server-id=master_id</CODE> option, where <CODE>master_id</CODE> must be
a positive integer value from 1 to 2^32 - 1. For example:


<PRE>
[mysqld]
log-bin
server-id=1
</PRE>

If those options are not present, add them and restart the server.

<LI>

Stop the server that is to be used as a slave server and add the following to
its <TT>`my.cnf'</TT> file:


<PRE>
[mysqld]
server-id=slave_id
</PRE>

The <CODE>slave_id</CODE> value, like the <CODE>master_id</CODE> value, must
be a positive integer value from 1 to 2^32 - 1. In addition, it is very
important that the ID of the slave be different from the ID of the
master. For example:


<PRE>
[mysqld]
server-id=2
</PRE>

If you are setting up multiple slaves, each one must have a unique
<CODE>server-id</CODE> value that differs from that of the master and from each
of the other slaves.  Think of <CODE>server-id</CODE> values as something similar
to IP addresses: These IDs uniquely identify each server instance in the
community of replication partners.

If you don't specify a <CODE>server-id</CODE> value, it will be set to 1 if
you have not defined <CODE>master-host</CODE>, else it will be set to 2. Note
that in the case of <CODE>server-id</CODE> omission, a master will refuse
connections from all slaves, and a slave will refuse to connect to a
master. Thus, omitting <CODE>server-id</CODE> is good only for backup with a
binary log.

<LI>

If you made a binary backup of the master server's data, copy it to the
slave server's data directory before starting the slave.  Make sure that the
privileges on the files and directories are correct. The user that the server
MySQL runs as must able to read and write the files, just as on the master.

If you made a backup using <CODE>mysqldump</CODE>, start the slave first (see next
step).

<LI>

Start the slave server. If it has been replicating previously,
start the slave server with the <CODE>--skip-slave-start</CODE> option so that it
doesn't immediately try to connect to its master.
You also may want to start the slave server with the
<CODE>--log-warnings</CODE> option, to get more messages about
problems (for example, network or connection problems).

<LI>

If you made a backup of the master server's data using <CODE>mysqldump</CODE>, load
the dump file into the slave server:


<PRE>
shell&#62; mysql -u root -p &#60; dump_file.sql
</PRE>

<LI>

Execute the following statement on the slave, replacing the option values
with the actual values relevant to your system:


<PRE>
mysql&#62; CHANGE MASTER TO
    -&#62;     MASTER_HOST='master_host_name',
    -&#62;     MASTER_USER='replication_user_name',
    -&#62;     MASTER_PASSWORD='replication_password',
    -&#62;     MASTER_LOG_FILE='recorded_log_file_name',
    -&#62;     MASTER_LOG_POS=recorded_log_position;
</PRE>

The following table shows the maximum length for the string options:

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>MASTER_HOST</CODE> </TD><TD> 60
</TD></TR>
<TR><TD><CODE>MASTER_USER</CODE> </TD><TD> 16
</TD></TR>
<TR><TD><CODE>MASTER_PASSWORD</CODE> </TD><TD> 32
</TD></TR>
<TR><TD><CODE>MASTER_LOG_FILE</CODE> </TD><TD> 255
</TD></TR>
</TABLE>

<LI>

Start the slave threads:


<PRE>
mysql&#62; START SLAVE; 
</PRE>

</OL>

<P>
After you have performed this procedure, the slave should connect to the master
and catch up on any updates that have occurred since the snapshot was taken.

</P>
<P>
If you have forgotten to set the <CODE>server-id</CODE> value for the master, slaves will
not be able to connect to it.

</P>
<P>
If you have forgotten to set the <CODE>server-id</CODE> value for the slave, you will get
the following error in its error log:

</P>

<PRE>
Warning: one should set server_id to a non-0 value if
master_host is set.  The server will not act as a slave.
</PRE>

<P>
You will also find error messages in the slave's error log if it
is not able to replicate for any other reason.

</P>
<P>
Once a slave is replicating, you will find in its data directory one
file named
<TT>`master.info'</TT> and another named <TT>`relay-log.info'</TT>.
The slave uses these two files to keep track of how much
of the master's binary log it has processed. <STRONG>Do not</STRONG> remove or
edit these files, unless you really know what you are doing and understand
the implications. Even in that case,
it is preferred that you use the <CODE>CHANGE MASTER TO</CODE> statement.

</P>
<P>
<STRONG>Note:</STRONG> The content of <TT>`master.info'</TT> overrides some
options specified on the command line or in <TT>`my.cnf'</TT>
See section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A> for more details.

</P>
<P>
Once you have a snapshot, you can use it to set up other slaves by
following the slave portion of the procedure just described. You do not need to
take another snapshot of the master; you can use the same one for each slave.

</P>



<H2><A NAME="Replication_Compatibility" HREF="manual_toc.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A></H2>

<P>
The original binary log format was developed in MySQL 3.23. It changed in
MySQL 4.0, and again in MySQL 5.0. This has consequences when you upgrade
servers in a replication setup, as described in section <A HREF="manual.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A>.

</P>
<P>
As far as replication is concerned, any MySQL 4.1.x version and any 4.0.x
version are identical, because they all use the same binary log format.
Thus, any servers from these versions are compatible, and replication between
them should work seamlessly.
The exceptions to this compatibility is that versions from MySQL 4.0.0 to
4.0.2 were very early development versions that should not be used anymore.
(These were the alpha versions in the 4.0 release series.  Compatibility for
them is still documented in the manual included with their distributions.)

</P>
<P>
The following table indicates master/slave replication compatibility between
different versions of MySQL.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD></TD><TD> </TD><TD> <STRONG>Master</STRONG> </TD><TD> <STRONG>Master</STRONG> </TD><TD> <STRONG>Master</STRONG>
</TD></TR>
<TR><TD></TD><TD> </TD><TD> <STRONG>3.23.33 and up</STRONG> </TD><TD> <STRONG>4.0.3 and up or any 4.1.x</STRONG> </TD><TD> <STRONG>5.0.0</STRONG>
</TD></TR>
<TR><TD><STRONG>Slave</STRONG> </TD><TD> <STRONG>3.23.33 and up</STRONG> </TD><TD> yes </TD><TD> no </TD><TD> no
</TD></TR>
<TR><TD><STRONG>Slave</STRONG> </TD><TD> <STRONG>4.0.3 and up</STRONG> </TD><TD> yes </TD><TD> yes </TD><TD> no
</TD></TR>
<TR><TD><STRONG>Slave</STRONG> </TD><TD> <STRONG>5.0.0</STRONG> </TD><TD> yes </TD><TD> yes </TD><TD> yes
</TD></TR>
</TABLE>

<P>
As a general rule, we recommended using recent MySQL versions,
because replication capabilities are continually being improved.
We also recommend using the same version for both the master and the slave.

</P>



<H2><A NAME="Replication_Upgrade" HREF="manual_toc.html#Replication_Upgrade">6.6  Upgrading a Replication Setup</A></H2>

<P>
When you upgrade servers that participate in a replication setup, the
procedure for upgrading depends on the current server versions and the
version to which you are upgrading.

</P>



<H3><A NAME="Replication_upgrade_4.0" HREF="manual_toc.html#Replication_upgrade_4.0">6.6.1  Upgrading Replication to 4.0 or 4.1</A></H3>

<P>
This section applies to upgrading replication from MySQL 3.23 to 4.0 or 4.1.
A 4.0 server should be 4.0.3 or newer, as mentioned in section <A HREF="manual.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A>.

</P>
<P>
When you upgrade a master from MySQL 3.23 to MySQL 4.0 or 4.1, you should
first ensure that all the slaves of this master are already at 4.0 or 4.1. If
that is not the case, you should first upgrade your slaves: Shut down each
one, upgrade it, restart it, and restart replication.

</P>

<P>
The upgrade can safely be done using the following procedure, assuming that you
have a 3.23 master to upgrade and the slaves are 4.0 or 4.1.  Note that
after the master has been upgraded, you should not restart replication using
any old 3.23 binary logs, because this will unfortunately confuse the 4.0 or
4.1 slave.

</P>

<OL>
<LI>

Block all updates on the master by issuing a <CODE>FLUSH TABLES WITH READ LOCK</CODE>
statement.
<LI>

Wait until all the slaves have caught up with all changes from the master
server.
Use <CODE>SHOW MASTER STATUS</CODE> on the master to obtain its current binary log
file and position. Then, for each slave, use those values with a <CODE>SELECT
MASTER_POS_WAIT()</CODE> statement. The statement will block on the slave and return
when the slave has caught up. Then run <CODE>STOP SLAVE</CODE> on the slave.
<LI>

Stop the master server and upgrade it to MySQL 4.0 or 4.1.
<LI>

Restart the master server and record the name of its newly
created binary log. You can obtain the name of the file by issuing a
<CODE>SHOW MASTER STATUS</CODE> statement on the master. Then issue these
statements on each slave:


<PRE>
mysql&#62; CHANGE MASTER TO MASTER_LOG_FILE='binary_log_name',
    -&#62;     MASTER_LOG_POS=4;
mysql&#62; START SLAVE;
</PRE>

</OL>



<H3><A NAME="Replication_upgrade_5.0" HREF="manual_toc.html#Replication_upgrade_5.0">6.6.2  Upgrading Replication to 5.0</A></H3>

<P>
This section applies to upgrading replication from MySQL 3.23, 4.0, or 4.1
to 5.0.0.  A 4.0 server should be 4.0.3 or newer, as mentioned in
section <A HREF="manual.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A>.

</P>
<P>
First, note that MySQL 5.0.0 is an alpha release. It is intended to work
better than older versions (easier upgrade, replication of some important
session variables such as <CODE>sql_mode</CODE>; see section <A HREF="manual.html#News-5.0.0">C.1.2  Changes in release 5.0.0 (22 Dec 2003: Alpha)</A>).  However
it has not yet been extensively tested. As with any alpha release, we
recommend that you not use it in critical production environments yet.

</P>
<P>
When you upgrade a master from MySQL 3.23 or 4.0 or 4.1 to 5.0.0, you should
first ensure that all the slaves of this master are already 5.0.0. If that's
not the case, you should first upgrade your slaves.  To upgrade each slave,
just shut it down, upgrade it to 5.0.0, restart it, and restart replication.
The 5.0.0 slave will be able to read its old relay logs that were written
before the upgrade and execute the statements they contain. Relay logs
created by the slave after the upgrade will be in 5.0.0 format.

</P>
<P>
After the slaves have been upgraded, shut down your master, upgrade it to
5.0.0, and restart it.  The 5.0.0 master will be able to read its old binary
logs that were written before the upgrade and send them to the 5.0.0 slaves.
The slaves will recognize the old format and handle it properly. Binary logs
created by master after the upgrade will be in 5.0.0 format. These too will
be recognized by the 5.0.0 slaves.

</P>
<P>
In other words, there are no measures to take when upgrading to 5.0.0,
except that slaves must be 5.0.0 before you can upgrade the master to 5.0.0.
Note that downgrading from 5.0.0 to older versions does not work so
automatically: You must ensure that any 5.0.0 binary logs or relay logs have
been fully processed, so that you can remove them before proceeding with the
downgrade.

</P>



<H2><A NAME="Replication_Features" HREF="manual_toc.html#Replication_Features">6.7  Replication Features and Known Problems</A></H2>

<P>
<A NAME="IDX690"></A>
<A NAME="IDX691"></A>
<A NAME="IDX692"></A>
<A NAME="IDX693"></A>
<A NAME="IDX694"></A>
<A NAME="IDX695"></A>

</P>
<P>
The following list explains
what is supported and what is not.
Additional <CODE>InnoDB</CODE>-specific information about replication is given in
section <A HREF="manual.html#InnoDB_and_MySQL_Replication">16.7.5  <CODE>InnoDB</CODE> and MySQL Replication</A>.

</P>

<UL>

<LI>

Replication will be done correctly with <CODE>AUTO_INCREMENT</CODE>,
<CODE>LAST_INSERT_ID()</CODE>, and <CODE>TIMESTAMP</CODE> values.

<LI>

The <CODE>USER()</CODE>, <CODE>UUID()</CODE>, and <CODE>LOAD_FILE()</CODE> functions
are replicated without changes and will thus not work reliably on the
slave. This is also true for <CODE>CONNECTION_ID()</CODE> in slave versions
older than 4.1.1.
The <STRONG>new</STRONG> <CODE>PASSWORD()</CODE> function in MySQL 4.1 is well
replicated in masters from 4.1.1 and up; your slaves also must be 4.1.1 or above
to replicate it. If you have older slaves and need to replicate
<CODE>PASSWORD()</CODE> from your 4.1.x master, you must start your master
with the <CODE>--old-password</CODE> option, so that it uses the old implementation
of <CODE>PASSWORD()</CODE>. (Note that the <CODE>PASSWORD()</CODE> implementation in
MySQL 4.1.0 differs from every other version of MySQL. It is best to avoid
4.1.0 in a replication situation.)

<LI>

The <CODE>FOREIGN_KEY_CHECKS</CODE> variable is replicated as of version 4.0.14.
The <CODE>sql_mode</CODE>, <CODE>UNIQUE_CHECKS</CODE>, and <CODE>SQL_AUTO_IS_NULL</CODE>
variables are replicated as of 5.0.0.  The <CODE>SQL_SELECT_LIMIT</CODE> and
<CODE>table_type</CODE> variables are not yet replicated.

<LI>

You must use the same character set (<CODE>--default-character-set</CODE>)
on the master and the slave. Otherwise, you may get duplicate-key errors on
the slave, because a key that is regarded as unique in the master character
set may not be unique in the slave character set. Character sets will
be replicated in 5.0.x.

<LI>

It is possible to replicate transactional tables on the master using
non-transactional tables on the slave. For example, you can replicate an
<CODE>InnoDB</CODE> master table as a <CODE>MyISAM</CODE> slave table. However, if you do
this, you will have problems if
the slave is stopped in the middle of a <CODE>BEGIN/COMMIT</CODE> block, because
the slave will restart at the beginning of the <CODE>BEGIN</CODE> block.
This issue is on our TODO and will be fixed in the near future.

<LI>

Update statements that make use of user variables (that is, variables of the
form <CODE>@var_name</CODE>) are badly replicated in 3.23 and 4.0. This is fixed
in 4.1. Note that user variable names are case insensitive starting from
version 5.0.  You should take this into account when setting up replication
between 5.0 and an older version.

<LI>

The slave can connect to the master using SSL if
both are 4.1.1 or newer.

<LI>

If a <CODE>DATA DIRECTORY</CODE> or <CODE>INDEX DIRECTORY</CODE> clause is used in a
<CODE>CREATE TABLE</CODE> statement on the master server, the clause is also used
on the slave. This can cause problems if no corresponding directory exists
in the slave host filesystem or exists but is not accessible to the slave
server.  Starting from MySQL 4.0.15, there is a <CODE>sql_mode</CODE> option
called <CODE>NO_DIR_IN_CREATE</CODE>. If the slave server is run with its SQL mode
set to include this option, it will simply ignore the clauses before
replicating the <CODE>CREATE TABLE</CODE> statement.  The result is that the
<CODE>MyISAM</CODE> data and index files are created in the table's database
directory.

<LI>

Although we have never heard of it actually occurring, it is theoretically
possible for the data on the master and slave to become different if a
query is designed in such a way that the data modification is
non-deterministic; that is, left to the will of the query optimizer. (That
generally is not a good practice anyway, even outside of replication!)
For a detailed explanation of this issue, see
section <A HREF="manual.html#Open_bugs">1.8.7.3  Open Bugs and Design Deficiencies in MySQL</A>.

<LI>

Before MySQL 4.1.1,
<CODE>FLUSH</CODE>, <CODE>ANALYZE TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, and <CODE>REPAIR
TABLE</CODE> statements
are not written to the binary log and thus are
not replicated to the slaves. This is not normally a problem as
these statements do not modify table data. However, it can cause difficulties
under certain circumstances. If you
replicate the privilege tables in the <CODE>mysql</CODE> database and
update those tables directly without using the
<CODE>GRANT</CODE> statement, you
must issue a <CODE>FLUSH PRIVILEGES</CODE> statement on your slaves to put
the new privileges into effect. Also if you use
<CODE>FLUSH TABLES</CODE> when renaming a <CODE>MyISAM</CODE> table that is part of a
<CODE>MERGE</CODE> table, you will have to issue <CODE>FLUSH TABLES</CODE>
manually on the slaves.
As of MySQL 4.1.1, these statements are written to the binary log
(unless you specify <CODE>NO_WRITE_TO_BINLOG</CODE>, or its alias <CODE>LOCAL</CODE>).
Exceptions are that <CODE>FLUSH LOGS</CODE>, <CODE>FLUSH MASTER</CODE>,
<CODE>FLUSH SLAVE</CODE>, and <CODE>FLUSH TABLES WITH READ LOCK</CODE> are not logged in
any case.  (Any of them may cause problems if replicated to a slave.)
For a syntax example, see section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>.

<LI>

MySQL only supports one master and many slaves. Later we will
add a voting algorithm to automatically change master if something goes
wrong with the current master. We will also introduce ``agent'' processes
to help do load balancing by sending <CODE>SELECT</CODE> queries to different
slaves.

<LI>

When a server shuts down and restarts, its <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables become empty.
As of MySQL 4.0.18, the master replicates this effect as follows:
The first time that the master uses each <CODE>MEMORY</CODE> table after startup,
it notifies slaves that the table needs to be emptied by writing a
<CODE>DELETE FROM</CODE> for the table to its binary log.
See section <A HREF="manual.html#HEAP">15.3  The <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) Storage Engine</A> for more details.

<LI>

Temporary tables are replicated with the exception of the case that you
shut down the slave server (not just the slave threads) and you have some
replicated temporary tables that are used in update statements that have
not yet been executed on the slave.  If you shut down the slave server,
the temporary tables needed by those updates no longer are available when
the slave starts again.  To avoid this problem, do not shut down the
slave while it has temporary tables open. Instead, use this procedure:


<OL>

<LI>

Issue a <CODE>STOP SLAVE</CODE> statement.

<LI>

Use <CODE>SHOW STATUS</CODE> to check the value of the <CODE>Slave_open_temp_tables</CODE>
variable.

<LI>

If the value is 0, issue a <CODE>mysqladmin shutdown</CODE> command to
shut down the slave.

<LI>

If the value is not 0, restart the slave threads with <CODE>START SLAVE</CODE>.

<LI>

Repeat the procedure later to see if you have better luck next time.

</OL>

We have plans to fix this problem in the near future.

<LI>

It is safe to connect servers in a circular
master/slave relationship with the <CODE>--log-slave-updates</CODE> option specified.
Note, however, that many statements will not work correctly in this kind of
setup unless your client code is written to take care of the potential
problems that can occur from updates that occur in different sequence
on different servers.

This means that you can create a setup such as this:


<PRE>
A -&#62; B -&#62; C -&#62; A
</PRE>

Server IDs are encoded in the binary log events, so server A will know when
an event that it reads was originally created by itself and will not
execute the event (unless server A was started with the
<CODE>--replicate-same-server-id</CODE> option, which is meaningful only in rare
setups). Thus, there will be no infinite loop.  But this circular
setup will work only if you perform no conflicting
updates between the tables.  In other words, if you insert data in both
A and C, you should never insert a row in A that may have a key that
conflicts with with a row inserted in C.  You should also not update
the same rows on two servers if the order in which the updates are
applied is significant.

<LI>

If a statement on the slave produces an error, the slave SQL thread
terminates, and the slave writes a message to its error log. You should
then connect to the slave manually, fix the problem (for
example, a non-existent table), and then run <CODE>START SLAVE</CODE>.

<LI>

It is safe to shut down a master server and restart it later.
If a slave loses its connection to the master, the slave tries to reconnect
immediately. If that fails, the slave retries periodically. (The default is
to retry every 60 seconds. This may be changed with the
<CODE>--master-connect-retry</CODE> option.)
The slave will also be able to deal with
network connectivity outages. However, the slave will notice the
network outage only after receiving no data from the master for
<CODE>slave_net_timeout</CODE> seconds. If your outages are short, you may want
to decrease <CODE>slave_net_timeout</CODE>.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

<LI>

Shutting down the slave (cleanly) is also safe, as it keeps track of where
it left off.  Unclean shutdowns might produce problems, especially if disk
cache was not flushed to disk before the system went down. Your system fault
tolerance will be greatly increased if you have a good uninterruptible power
supply.

<LI>

Due to the non-transactional nature of <CODE>MyISAM</CODE> tables, it is possible
to have a statement that only partially updates a table and returns an
error code. This can happen, for example, on a multiple-row insert that has
one row violating a key constraint, or if a long update statement is killed
after updating some of the rows. If that happens on the master, the slave
thread will exit and wait for the DBA to decide what to do about it unless
the error code is legitimate and the statement execution results in the same
error code. If this error code validation behavior is not desirable, some or
all errors can be masked out (ignored) with the <CODE>--slave-skip-errors</CODE>
option.  This option is available starting with MySQL 3.23.47.

<LI>

If you update transactional tables from non-transactional tables inside a
<CODE>BEGIN/COMMIT</CODE> segment, updates to the binary log may be out of sync
if some thread changes the non-transactional table before the
transaction commits.  This is because the transaction is written to the
binary log only when it is committed.

<LI>

Before version 4.0.15, any update to a non-transactional table is written to
the binary log at once when the update is made, whereas transactional
updates are written on <CODE>COMMIT</CODE> or not written at all if you use
<CODE>ROLLBACK</CODE>. You must take this into account when updating both
transactional tables and non-transactional tables within the same
transaction. (This is true not only for replication, but also if you are
using binary logging for backups.) In version 4.0.15, we changed the logging
behavior for transactions that mix updates to transactional and
non-transactional tables, which solves the problems (order of statements is
good in the binary log, and all needed statements are written to the binary log
even in case of <CODE>ROLLBACK</CODE>). The problem that remains is when a second
connection updates the non-transactional table while the first connection's
transaction is not finished yet; wrong order can still occur, because the
second connection's update will be written immediately after it is done.

<LI>

When a 4.x slave replicates a <CODE>LOAD DATA INFILE</CODE> from a 3.23 master, the
values of the <CODE>Exec_Master_Log_Pos</CODE> and <CODE>Relay_Log_Space</CODE> columns of
<CODE>SHOW SLAVE STATUS</CODE> become incorrect.
The incorrectness of <CODE>Exec_Master_Log_Pos</CODE> will cause a problem when you
stop and restart replication; so it is a good idea to correct the value before
this, by doing <CODE>FLUSH LOGS</CODE> on the master.
These bugs are already fixed in MySQL 5.0.0 slaves.

</UL>

<P>
The following table lists replication problems in MySQL 3.23 that are
fixed in MySQL 4.0:

</P>

<UL>
<LI>

<CODE>LOAD DATA INFILE</CODE> is handled properly, as long as the data file
still resides on the master server at the time of update
propagation.

<LI>

<CODE>LOAD DATA LOCAL INFILE</CODE> is no longer skipped on the slave as it
was in 3.23.

<LI>

In 3.23, <CODE>RAND()</CODE> in updates does not replicate properly.
Use <CODE>RAND(some_non_rand_expr)</CODE> if you are replicating updates with
<CODE>RAND()</CODE>. You can, for example, use <CODE>UNIX_TIMESTAMP()</CODE> for the
argument to <CODE>RAND()</CODE>.
</UL>



<H2><A NAME="Replication_Options" HREF="manual_toc.html#Replication_Options">6.8  Replication Startup Options</A></H2>

<P>
On both the master and the slave, you must use the <CODE>server-id</CODE> option
to establish a unique replication ID for each server. You should pick a unique
positive integer in the range from 1 to 2^32 - 1 for each master and slave.
Example: <CODE>server-id=3</CODE>

</P>
<P>
The options that you can use on the master server for controlling binary
logging are described in section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>
<P>
The following table describes the options you can use on slave replication servers.
You can specify them on the command line or in an option file.

</P>
<P>
Some slave server replication options are handled in a special way, in the
sense that they are ignored if a <TT>`master.info'</TT> file exists when the slave
starts and contains values for the options.
The following options are handled this way:

</P>

<UL>
<LI><CODE>--master-host</CODE>

<LI><CODE>--master-user</CODE>

<LI><CODE>--master-password</CODE>

<LI><CODE>--master-port</CODE>

<LI><CODE>--master-connect-retry</CODE>

</UL>

<P>
As of MySQL 4.1.1, the following options also are handled specially:

</P>

<UL>
<LI><CODE>--master-ssl</CODE>

<LI><CODE>--master-ssl-ca</CODE>

<LI><CODE>--master-ssl-capath</CODE>

<LI><CODE>--master-ssl-cert</CODE>

<LI><CODE>--master-ssl-cipher</CODE>

<LI><CODE>--master-ssl-key</CODE>

</UL>

<P>
The <TT>`master.info'</TT> file format in 4.1.1 changed to include values
corresponding to the SSL options. In addition, the 4.1.1 file format includes
as its first line the number of lines in the file. If you upgrade an older
server to 4.1.1, the new server upgrades the <TT>`master.info'</TT> file to the
new format automatically when it starts.  However, if you downgrade a 4.1.1
or newer server to a version older than 4.1.1, you should manually remove
the first line before starting the older server for the first time.  Note
that, in this case, the downgraded server no longer can use an SSL connection
to communicate with the master.

</P>
<P>
If no <TT>`master.info'</TT> file exists when the slave server starts,
it uses values for those options that are specified in option files
or on the command line.  This will occur when you start the server
as a replication slave for the very first time, or when you have run
<CODE>RESET SLAVE</CODE> and shut down and restarted the slave server.

</P>
<P>
If the <TT>`master.info'</TT> file exists when the slave server starts, the
server ignores those options. Instead, it uses the values found in the
<TT>`master.info'</TT> file.

</P>
<P>
If you restart the slave server with different values of the startup options
that correspond to values in the <TT>`master.info'</TT> file, the different
values have no effect, because the server continues to use the
<TT>`master.info'</TT> file. To use different values, you must either restart
after removing the <TT>`master.info'</TT> file or (preferably) use the
<CODE>CHANGE MASTER TO</CODE> statement to reset the values while the slave is
running.

</P>
<P>
Suppose that you specify this option in your <TT>`my.cnf'</TT> file:

</P>

<PRE>
[mysqld]
master-host=some_host
</PRE>

<P>
The first time you start the server as a replication slave, it reads and
uses that option from the <TT>`my.cnf'</TT> file.  The server then records the
value in the <TT>`master.info'</TT> file.  The next time you start the server,
it reads the master host value from the <TT>`master.info'</TT> file only and
ignores the value in the option file.  If you modify the <TT>`my.cnf'</TT> file
to specify a different master host of <CODE>some_other_host</CODE>, the change
still will have no effect.  You should use <CODE>CHANGE MASTER TO</CODE> instead.

</P>
<P>
Because the server gives an existing <TT>`master.info'</TT> file precedence
over the startup options just described, you might prefer not to use startup
options for these values at all, and instead specify them by using the
<CODE>CHANGE MASTER TO</CODE> statement.
See section <A HREF="manual.html#CHANGE_MASTER_TO">14.6.2.1  <CODE>CHANGE MASTER TO</CODE> Syntax</A>.

</P>
<P>
This example shows a more extensive use of startup options to configure a
slave server:

</P>

<PRE>
[mysqld]
server-id=2
master-host=db-master.mycompany.com
master-port=3306
master-user=pertinax
master-password=freitag
master-connect-retry=60
report-host=db-slave.mycompany.com
</PRE>

<P>
The following list describes startup options for controlling replication:
Many of these options can be reset while the server is running by using the
<CODE>CHANGE MASTER TO</CODE> statement. Others, such as the <CODE>--replicate-*</CODE>
options, can be set only when the slave server starts. We plan to fix this.

</P>
<DL COMPACT>

<DT><CODE>--log-slave-updates</CODE>
<DD>
Normally, updates received from a master server by a slave are not logged to
its binary log. This option tells the slave to log the updates performed by
its SQL thread to the slave's own binary log.  For this option to have any
effect, the slave must also be started with the <CODE>--log-bin</CODE> option to
enable binary logging.  <CODE>--log-slave-updates</CODE> is used when you want to
chain replication servers.  For example, you might want a setup like this:


<PRE>
A -&#62; B -&#62; C
</PRE>

That is, A serves as the master for the slave B, and B serves as the master
for the slave C. For this to work, B must be both a master and a slave.
You must start both A and B with <CODE>--log-bin</CODE> to enable binary logging,
and B with the <CODE>--log-slave-updates</CODE> option.

<DT><CODE>--log-warnings</CODE>
<DD>
Makes the slave print more messages about what it is doing. For
example, it will warn you that it succeeded in reconnecting after a
network/connection failure, and warn you about how each slave thread started.
This option is enabled by default as of MySQL 4.1.2; to disable it, use
<CODE>--skip-log-warnings</CODE>.

This option is not limited to replication use only. It produces warnings
across a spectrum of server activities.

<DT><CODE>--master-connect-retry=seconds</CODE>
<DD>
The number of seconds the slave thread sleeps before retrying to connect to
the master in case the master goes down or the connection is lost.  The
value in the <TT>`master.info'</TT> file takes precedence if it can be read.  If
not set, the default is 60.

<DT><CODE>--master-host=host</CODE>
<DD>
The hostname or IP number of the master replication server.
If this option is not given, the slave
thread will not be started.  The value in <TT>`master.info'</TT>
takes precedence if it can be read.

<DT><CODE>--master-info-file=file_name</CODE>
<DD>
The name to use for the file in which the slave records
information about the master.
The default name is <TT>`mysql.info'</TT> in the data directory.

<DT><CODE>--master-password=password</CODE>
<DD>
The password of the account that the slave thread uses for authentication when
connecting to the master.
The value in the <TT>`master.info'</TT> file takes precedence if it can be read.
If not set, an empty password is assumed.

<DT><CODE>--master-port=port_number</CODE>
<DD>
The TCP/IP port the master is listening on.
The value in the <TT>`master.info'</TT> file takes precedence if it can be read.
If not set, the compiled-in setting is assumed. If you have not tinkered with
<CODE>configure</CODE> options, this should be 3306.

<DT><CODE>--master-ssl</CODE>
<DD>
<DT><CODE>--master-ssl-ca=file_name</CODE>
<DD>
<DT><CODE>--master-ssl-capath=directory_name</CODE>
<DD>
<DT><CODE>--master-ssl-cert=file_name</CODE>
<DD>
<DT><CODE>--master-ssl-cipher=cipher_list</CODE>
<DD>
<DT><CODE>--master-ssl-key=file_name</CODE>
<DD>
These options are used for setting up a secure replication connection to
the master server using SSL.
Their meanings are the same as the corresponding
<CODE>--ssl</CODE>,
<CODE>--ssl-ca</CODE>,
<CODE>--ssl-capath</CODE>,
<CODE>--ssl-cert</CODE>,
<CODE>--ssl-cipher</CODE>,
<CODE>--ssl-key</CODE>
options described in
section <A HREF="manual.html#SSL_options">5.5.7.5  SSL Command-Line Options</A>.
The values in the <TT>`master.info'</TT> file take precedence if they can be read.

These options are operational as of MySQL 4.1.1.

<DT><CODE>--master-user=username</CODE>
<DD>
The username of the account that the slave thread uses for authentication when
connecting to the master. The account must have the
<CODE>REPLICATION SLAVE</CODE> privilege. (Prior to MySQL 4.0.2, it must have the
<CODE>FILE</CODE> privilege instead.)
The value in the <TT>`master.info'</TT> file takes precedence if it can be read.
If the master user is not set, user <CODE>test</CODE> is assumed.

<DT><CODE>--max-relay-log-size=#</CODE>
<DD>
To rotate the relay log automatically.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

This option is available as of MySQL 4.0.14.

<DT><CODE>--read-only</CODE>
<DD>
This option causes the slave to allow no updates except from slave threads
or from users with the <CODE>SUPER</CODE> privilege.  This can be useful to ensure
that a slave server accepts no updates from clients.

This option is available as of MySQL 4.0.14.

<DT><CODE>--relay-log=file_name</CODE>
<DD>
The name for the relay log. The default name is
<CODE>host_name-relay-bin.nnn</CODE>, where <CODE>host_name</CODE> is the name of
the slave server host and <CODE>nnn</CODE> indicates that relay logs are
created in numbered sequence.
You can specify the option to create hostname-independent relay log names, or
if your relay logs tend to be big (and you don't want to decrease
<CODE>max_relay_log_size</CODE>) and you need to put them on some area
different from the data directory, or if you want to increase speed by
balancing load between disks.

<DT><CODE>--relay-log-index=file_name</CODE>
<DD>
The location and name that should be used for the relay
log index file. The default name is
<CODE>host_name-relay-bin.index</CODE>, where <CODE>host_name</CODE> is the name of
the slave server.

<DT><CODE>--relay-log-info-file=file_name</CODE>
<DD>
The name to use for the file in which the slave records
information about the relay logs. The default name is
<TT>`relay-log.info'</TT> in the data directory.

<DT><CODE>--relay-log-purge={0|1}</CODE>
<DD>
Disables or enables automatic purging of relay logs as soon as they are not
needed any more.  The default value is 1 (enabled).  This is a global
variable that can be changed dynamically with <CODE>SET GLOBAL
relay_log_purge</CODE>.

This option is available as of MySQL 4.1.1.

<DT><CODE>--relay-log-space-limit=#</CODE>
<DD>
Places an upper limit on the total size of all relay logs on the slave (a
value of 0 means ``unlimited''). This is useful for a slave server host that
has limited disk space.  When the limit is reached, the I/O thread stops
reading binary log events from the master server until the SQL thread has
caught up and deleted some now unused relay logs. Note that this limit is
not absolute: There are cases where the SQL thread needs more events
before it can delete relay logs.
In that case, the I/O thread will exceed the limit until it
becomes possible for the SQL thread to delete some relay logs. Not doing so
would cause a deadlock (which is what happens before MySQL 4.0.13).  You
should not set <CODE>--relay-log-space-limit</CODE> to less than twice the value
of <CODE>--max-relay-log-size</CODE> (or <CODE>--max-binlog-size</CODE> if
<CODE>--max-relay-log-size</CODE> is 0). In that case, there is a chance that the
I/O thread will wait for free space because <CODE>--relay-log-space-limit</CODE>
is exceeded, but the SQL thread will have no relay log to purge and be
unable to satisfy the I/O thread. This forces the I/O thread to temporarily
ignore <CODE>--relay-log-space-limit</CODE>.

<DT><CODE>--replicate-do-db=db_name</CODE>
<DD>
Tells the slave to restrict replication to statements where
the default database (that is, the one selected by <CODE>USE</CODE>)
is <CODE>db_name</CODE>.
To specify more than one database, use this option multiple
times, once for each database. Note that this will not replicate
cross-database statements such as <CODE>UPDATE some_db.some_table
SET foo='bar'</CODE> while having selected a different database or no database. If you
need cross-database updates to work, make sure that you have MySQL 3.23.28 or
later, and use <CODE>--replicate-wild-do-table=db_name.%</CODE>.
Please read the notes that follow this option list.

An example of what does not work as you might expect: If the slave is
started with <CODE>--replicate-do-db=sales</CODE> and you issue the following
statements on the master, the <CODE>UPDATE</CODE> statement will not be
replicated:


<PRE>
USE prices;
UPDATE sales.january SET amount=amount+1000;
</PRE>

If you need cross-database updates to work, 
use <CODE>--replicate-wild-do-table=db_name.%</CODE> instead.

The main reason for this ``just-check-the-default-database''
behavior is that it's difficult from the statement
alone to know whether or not it should be replicated (for example, if you
are using multiple-table <CODE>DELETE</CODE> or multiple-table <CODE>UPDATE</CODE>
statements
that go across multiple databases).  It's also very fast to just check
the default database.

<DT><CODE>--replicate-do-table=db_name.tbl_name</CODE>
<DD>
Tells the slave thread to restrict replication to the specified table.
To specify more than one table, use this option multiple times, once
for each table.  This will work for cross-database updates, in
contrast to <CODE>--replicate-do-db</CODE>. 
Please read the notes that follow this option list.

<DT><CODE>--replicate-ignore-db=db_name</CODE>
<DD>
Tells the slave to not replicate any statement where the default
database (that is, the one selected by <CODE>USE</CODE>)
is <CODE>db_name</CODE>. To specify more than one database to
ignore, use this option multiple times, once for each database.
You should not use this option if you are using cross-table updates
and you don't want these updates to be replicated.
Please read the notes that follow this option list.

An example of what does not work as you might expect: If the slave is
started with <CODE>--replicate-ignore-db=sales</CODE> and you issue the following
statements on the master, the <CODE>UPDATE</CODE> statement will be replicated:


<PRE>
USE prices;
UPDATE sales.january SET amount=amount+1000;
</PRE>

If you need cross-database updates to work, 
use <CODE>--replicate-wild-ignore-table=db_name.%</CODE> instead.

<DT><CODE>--replicate-ignore-table=db_name.tbl_name</CODE>
<DD>
Tells the slave thread to not replicate any statement that updates the
specified table (even if any other tables might be updated by the same
statement). To specify more than one table to ignore, use this option
multiple times, once for each table. This will work for cross-database
updates, in contrast to <CODE>--replicate-ignore-db</CODE>.
Please read the notes that follow this option list.

<DT><CODE>--replicate-wild-do-table=db_name.tbl_name</CODE>
<DD>
Tells the slave thread to restrict replication to statements where any of
the updated tables match the specified database and table name patterns.
Patterns can contain the <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> wildcard characters, which have
the same meaning as for the <CODE>LIKE</CODE> pattern-matching operator.  To specify
more than one table, use this option multiple times, once for each
table.  This will work for cross-database updates.
Please read the notes that follow this option list.

Example: <CODE>--replicate-wild-do-table=foo%.bar%</CODE> will replicate only
updates that use a table where the database name starts with <CODE>foo</CODE>
and the table name starts with <CODE>bar</CODE>.

If the table name pattern is <CODE>%</CODE>, it matches any table name and the
option also applies to database-level statements (<CODE>CREATE DATABASE</CODE>, <CODE>DROP DATABASE</CODE>, and
<CODE>ALTER DATABASE</CODE>).
For example, if you use <CODE>--replicate-wild-do-table=foo%.%</CODE>,
database-level statements statements are replicated
if the database name matches the pattern <CODE>foo%</CODE>.

To include literal wildcard characters in the database or table name
patterns, escape them with a backslash.  For example, to replicate all tables
of a database that is named <CODE>my_own%db</CODE>, but not replicate tables
from the <CODE>my1ownAABCdb</CODE> database, you should escape the <SAMP>`_'</SAMP> and
<SAMP>`%'</SAMP> characters like this: <CODE>--replicate-wild-do-table=my\_own\%db</CODE>.
If you're using the option on the command line, you might need to double
the backslashes or quote the option value, depending on your command
interpreter.  For example, with the <CODE>bash</CODE> shell, you would need to
type <CODE>--replicate-wild-do-table=my\\_own\\%db</CODE>.

<DT><CODE>--replicate-wild-ignore-table=db_name.tbl_name</CODE>
<DD>
Tells the slave thread to not replicate a statement where any table matches the
given wildcard pattern. To specify more than one table to ignore, use
this option multiple times, once for each table. This will work for
cross-database updates.
Please read the notes that follow this option list.

Example: <CODE>--replicate-wild-ignore-table=foo%.bar%</CODE> will not replicate
updates that use a table where the database name starts with <CODE>foo</CODE>
and the table name starts with <CODE>bar</CODE>.

For information about how matching works, see the description of
the <CODE>--replicate-wild-ignore-table</CODE> option.
The rules for including literal wildcard characters in the option value
are the same as for
<CODE>--replicate-wild-ignore-table</CODE> as well.

<DT><CODE>--replicate-rewrite-db=from_name-&#62;to_name</CODE>
<DD>
Tells the slave to translate the default database
(that is, the one selected by <CODE>USE</CODE>)
to <CODE>to_name</CODE> if it was <CODE>from_name</CODE> on the master.
Only statements involving tables are affected
(not statements such as <CODE>CREATE DATABASE</CODE>, <CODE>DROP DATABASE</CODE>,
and <CODE>ALTER DATABASE</CODE>),
and only if <CODE>from_name</CODE> was the default database on the master.
This will not work for cross-database updates.
Note that the database name translation is done before <CODE>--replicate-*</CODE>
rules are tested.

If you use this option on the command line and the <SAMP>`&#62;'</SAMP> character is
special to your command interpreter, quote the option value. For example:


<PRE>
shell&#62; mysqld --replicate-rewrite-db="olddb-&#62;newdb"
</PRE>

<DT><CODE>--replicate-same-server-id</CODE>
<DD>
To be used on slave servers.  Usually you can should the default setting of
0, to prevent infinite loops in circular replication.  If set to 1, this
slave will not skip events having its own server id; normally this is useful
only in rare configurations.  Cannot be set to 1 if
<CODE>--log-slave-updates</CODE> is used.
Be careful that starting from MySQL 4.1, by default the slave I/O thread does
not even write binlog events to the relay log if they have the slave's server
id (this optimization helps save disk usage compared to 4.0). So if you want to
use <CODE>--replicate-same-server-id</CODE> in 4.1 versions, be sure to start the
slave with this option before you make the slave read its own events which you
want the slave SQL thread to execute.

<DT><CODE>--report-host=host</CODE>
<DD>
The hostname or IP number of the slave to be reported to the master during
slave registration. This value will appear in the output of <CODE>SHOW SLAVE
HOSTS</CODE> on the master server. Leave the value unset if you do not want the
slave to register itself with the master. Note that it is not sufficient for
the master to simply read the IP number of the slave from the TCP/IP socket
after the slave connects. Due to <CODE>NAT</CODE> and other routing issues, that IP
may not be valid for connecting to the slave from the master or other hosts.

This option is available as of MySQL 4.0.0.

<DT><CODE>--report-port=port_number</CODE>
<DD>
The TCP/IP port for connecting to the slave, to be reported to the
master during slave registration.  Set it only if the slave is listening
on a non-default port or if you have a special tunnel from the master or
other clients to the slave. If you are not sure, leave this option unset.

This option is available as of MySQL 4.0.0.

<DT><CODE>--skip-slave-start</CODE>
<DD>
Tells the slave server not to start the slave threads when the server starts.
To start the threads later, use a <CODE>START SLAVE</CODE> statement.

<DT><CODE>--slave_compressed_protocol=#</CODE>
<DD>
If this option is set to
1, use compression on the slave/client protocol if both the
slave and the master support it.

<DT><CODE>--slave-load-tmpdir=file_name</CODE>
<DD>
The name of the directory where the slave creates temporary files.
This option is by default equal to the value of the <CODE>tmpdir</CODE> system variable.
When the slave SQL thread replicates a <CODE>LOAD DATA INFILE</CODE> statement, it
extracts the to-be-loaded file from the relay log into temporary files,
then loads these into the table. If the file loaded on the master was
huge, the temporary files on the slave will be huge, too. Therefore, it might
be advisable to use this option to tell the slave to put temporary files in
a directory located in some filesystem that has a lot of available space.
In that case, you may also use the <CODE>--relay-log</CODE> option to place
the relay logs in that filesystem, because the relay logs
will be huge as well.
<CODE>--slave-load-tmpdir</CODE> should point to a disk-based filesystem, not a
memory-based one: The slave needs the
temporary files used to replicate <CODE>LOAD DATA INFILE</CODE> to survive a
machine's restart.
The directory also should not be one that is cleared by the operating system
during the system startup process.

<DT><CODE>--slave-net-timeout=#</CODE>
<DD>
The number of seconds to wait for more data from the master before aborting
the read, considering the connection broken, and trying to reconnect. The first
retry occurs immediately after the timeout. The interval between retries is
controlled by the <CODE>--master-connect-retry</CODE> option.

<DT><CODE>--slave-skip-errors= [err_code1,err_code2,... | all]</CODE>
<DD>
Normally, replication stops when an error occurs, which gives you the
opportunity to resolve the inconsistency in the data manually.  This option
tells the slave SQL thread to continue replication when a statement returns
any of the errors listed in the option value.

Do not use this option unless you fully understand why you are getting the
errors.  If there are no bugs in your replication setup and client programs,
and no bugs in MySQL itself, an error that stops replication should never
occur.  Indiscriminate use of this option will result in slaves becoming
hopelessly out of sync with the master, and you will have no idea why.

For error codes, you should use the numbers provided by the error message in
your slave error log and in the output of <CODE>SHOW SLAVE STATUS</CODE>. A full list
of error messages can be found in the source distribution in the
<TT>`Docs/mysqld_error.txt'</TT> file.
The server error codes also are listed at section <A HREF="manual.html#Error-returns">21.1  Error Returns</A>.

You can (but should not) also use the very non-recommended value of <CODE>all</CODE>
which will ignore all error messages and keep barging along regardless of what
happens.  Needless to say, if you use it, we make no promises regarding your
data integrity. Please do not complain if your data on the slave is not
anywhere close to what it is on the master in this case. You have been
warned.

Examples:


<PRE>
--slave-skip-errors=1062,1053
--slave-skip-errors=all
</PRE>

</DL>

<P>
The <CODE>--replicate-*</CODE> rules are evaluated as follows to determine whether a
statement will be executed by the slave or ignored:

</P>

<OL>
<LI>

Are there some <CODE>--replicate-do-db</CODE> or <CODE>--replicate-ignore-db</CODE>
rules?


<UL>
<LI>Yes:

Test them as for <CODE>--binlog-do-db</CODE> and <CODE>--binlog-ignore-db</CODE>
(see section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>). What is the result of the test?


<UL>
<LI>Ignore the statement:

Ignore it and exit.
<LI>Execute the statement:

Don't execute it immediately, defer the decision, go to the next step.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

Are there some <CODE>--replicate-*-table</CODE> rules?


<UL>
<LI>No:

Execute the query and exit.
<LI>Yes:

Go to the next step. Only tables that are to be updated are compared
to the rules (<CODE>INSERT INTO sales SELECT * FROM prices</CODE>: only
<CODE>sales</CODE> will be compared to the rules). If several tables are to be
updated (multiple-table statement),
the first matching table (matching ``do'' or ``ignore'') wins.
That is, the first table is compared to the rules. Then, if no decision could
be mad, the second table is compared to the rules, and so forth.
</UL>

<LI>

Are there some <CODE>--replicate-do-table</CODE> rules?


<UL>
<LI>Yes:

Does the table match any of them?

<UL>
<LI>Yes:

Execute the query and exit.
<LI>No:

Go to the next step.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

Are there some <CODE>--replicate-ignore-table</CODE> rules?


<UL>
<LI>Yes:

Does the table match any of them?

<UL>
<LI>Yes:

Ignore the query and exit.
<LI>No:

Go to the next step.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

Are there some <CODE>--replicate-wild-do-table</CODE> rules?


<UL>
<LI>Yes:

Does the table match any of them?


<UL>
<LI>Yes:

Execute the query and exit.
<LI>No:

Go to the next step.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

Are there some <CODE>--replicate-wild-ignore-table</CODE> rules?


<UL>
<LI>Yes:

Does the table match any of them?


<UL>
<LI>Yes:

Ignore the query and exit.
<LI>No:

Go to the next step.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

No <CODE>--replicate-*-table</CODE> rule was matched.
Is there another table to test against these rules?


<UL>
<LI>Yes:

Loop.
<LI>No:

We have tested all tables to be updated and could not match any rule.
Are there <CODE>--replicate-do-table</CODE> or <CODE>--replicate-wild-do-table</CODE>
rules?

<UL>
<LI>Yes:

Ignore the query and exit.
<LI>No:

Execute the query and exit.
</UL>

</UL>

</OL>



<H2><A NAME="Replication_FAQ" HREF="manual_toc.html#Replication_FAQ">6.9  Replication FAQ</A></H2>

<P>
<STRONG>Q</STRONG>: How do I configure a slave if the master is already running
and I do not want to stop it?

</P>
<P>
<STRONG>A</STRONG>: There are several options. If you have taken a backup of the
master at some point and recorded the binary log name and offset (from the
output of <CODE>SHOW MASTER STATUS</CODE> ) corresponding to the snapshot, use
the following procedure:

</P>

<OL>
<LI>

Make sure that the slave is assigned a unique server ID.
<LI>

Execute the following statement on the slave, filling in appropriate values for each
option:


<PRE>
mysql&#62; CHANGE MASTER TO
    -&#62;     MASTER_HOST='master_host_name',
    -&#62;     MASTER_USER='master_user_name',
    -&#62;     MASTER_PASSWORD='master_pass',
    -&#62;     MASTER_LOG_FILE='recorded_log_file_name',
    -&#62;     MASTER_LOG_POS=recorded_log_position;
</PRE>

<LI>

Execute <CODE>START SLAVE</CODE> on the slave.
</OL>

<P>
If you do not have a backup of the master server already, here is a quick
procedure for creating one. All steps should be performed on the master host.

</P>

<OL>
<LI>

Issue this statement:


<PRE>
mysql&#62; FLUSH TABLES WITH READ LOCK;
</PRE>

<LI>

With the lock still in place, execute this command (or a variation of it):


<PRE>
shell&#62; tar zcf /tmp/backup.tar.gz /var/lib/mysql
</PRE>

<LI>

Issue this statement and
make sure to record the output, which you will need later:


<PRE>
mysql&#62; SHOW MASTER STATUS;
</PRE>

<LI>

Release the lock:


<PRE>
mysql&#62; UNLOCK TABLES;
</PRE>

</OL>

<P>
An alternative is to make an SQL dump of the master instead of a binary copy
as in the preceding procedure. To do this, you can use <CODE>mysqldump
--master-data</CODE> on your master and later load the SQL dump into your slave.
However, this is slower than making a binary copy.

</P>
<P>
No matter which of the two methods you use, afterward follow the
instructions for the case when you have a snapshot and have recorded the log
name and offset. You can use the same snapshot to set up several slaves.
Once you have the snapshot of the master, you can wait to set up a slave as
long as the binary logs of the master are left intact.  The two practical
limitations on the length of time you can wait are the amount of disk space
available to retain binary logs on the master and the length of time it
will take the slave to catch up.

</P>
<P>
You can also use <CODE>LOAD DATA FROM MASTER</CODE>.  This is a convenient
statement that transfers a snapshot to the slave and adjusts the log name
and offset all at once. In the future, <CODE>LOAD DATA FROM MASTER</CODE> will be
the recommended way to set up a slave.  Be warned, however, that it works
only for <CODE>MyISAM</CODE> tables and it may hold a read lock for a long time.
It is not yet implemented as efficiently as we would like. If you have large
tables, the preferred method at this time is still to make a binary snapshot
on the master server after executing <CODE>FLUSH TABLES WITH READ LOCK</CODE>.

</P>
<P>
<STRONG>Q</STRONG>: Does the slave need to be connected to the master all the time?

</P>
<P>
<STRONG>A</STRONG>: No, it does not. The slave can go down or stay
disconnected for hours or even days, then reconnect and catch up on the
updates.
For example, you can set up a master/slave relationship over a dial-up link
where the link is up only sporadically and
for short periods of time. The implication of this is that, at any
given time, the slave is not guaranteed to be in sync with the master
unless you take some special measures. In the future, we will have the
option to block the master until at least one slave is in sync.

</P>
<P>
<STRONG>Q</STRONG>: How do I know how late a slave is compared to the
master? In other words, how do I know the date of the last query
replicated by the slave?

</P>
<P>
<STRONG>A</STRONG>: 
If the slave is 4.1.1 or newer, read the <CODE>Seconds_Behind_Master</CODE> column
in <CODE>SHOW SLAVE STATUS</CODE>. For older versions, the following applies.
This is possible only if <CODE>SHOW PROCESSLIST</CODE> on the slave shows that the
SQL thread is running (or for MySQL 3.23, that the slave thread is running),
and that the thread has executed at least one event from the master.
See section <A HREF="manual.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>.

</P>
<P>
When the slave SQL thread executes an event read from the master, it
modifies its own time to the event timestamp (this is why <CODE>TIMESTAMP</CODE>
is well replicated). In the <CODE>Time</CODE> column in the output of
<CODE>SHOW PROCESSLIST</CODE>, the number of seconds displayed for the slave SQL
thread is the number of seconds between the timestamp of the last replicated
event and the real time of the slave machine. You can use this to determine
the date of the last replicated event. Note that if your slave has been
disconnected from the master for one hour, and then reconnects, you may
immediately see <CODE>Time</CODE> values like 3600 for the slave SQL thread in
<CODE>SHOW PROCESSLIST</CODE>. This would be because the slave is executing
statements that are one hour old.

</P>
<P>
<STRONG>Q</STRONG>: How do I force the master to block updates until the slave catches
up?

</P>
<P>
<STRONG>A</STRONG>: Use the following procedure:

</P>

<OL>

<LI>

On the master, execute these statements:


<PRE>
mysql&#62; FLUSH TABLES WITH READ LOCK;
mysql&#62; SHOW MASTER STATUS;
</PRE>

Record the log name and the offset from the output of the <CODE>SHOW</CODE>
statement. These are the replication coordinates.

<LI>

On the slave, issue the following statement, where the arguments to the
<CODE>MASTER_POS_WAIT()</CODE> function are the replication coordinate values
obtained in the previous step:


<PRE>
mysql&#62; SELECT MASTER_POS_WAIT('log_name', log_offset);
</PRE>

The <CODE>SELECT</CODE> statement will block until the slave reaches the specified
log file and offset. At that point, the slave will be in sync with the master
and the statement will return.

<LI>

On the master, issue the following statement to allow the master to begin
processing updates again:


<PRE>
mysql&#62; UNLOCK TABLES;
</PRE>

</OL>

<P>
<STRONG>Q</STRONG>: What issues should I be aware of when setting up two-way
replication?

</P>
<P>
<STRONG>A</STRONG>: MySQL replication currently does not support any
locking protocol between master and slave to guarantee the atomicity of
a distributed (cross-server) update. In other words, it is possible
for client A to make an update to  co-master 1, and in the meantime,
before it propagates to co-master 2, client B could make an update to
co-master 2 that will make the update of client A work differently than
it did on co-master 1. Thus, when the update of client A makes it
to co-master 2, it will produce  tables that are different than
what you have on co-master 1, even after all the updates from co-master
2 have also propagated. This means that you should not co-chain two servers
in a two-way replication relationship unless you are sure that your updates
can safely happen in any order, or unless you take care of mis-ordered
updates somehow in the client code.

</P>
<P>
You must also realize that two-way replication actually does not improve
performance very much (if at all), as far as updates are concerned. Both
servers need to do the same number of updates each, as you would have
one server do. The only difference is that there will be a little less
lock contention, because the updates originating on another server will
be serialized in one slave thread. Even this benefit might be
offset by network delays.

</P>
<P>
<A NAME="IDX696"></A>
<A NAME="IDX697"></A>
<STRONG>Q</STRONG>: How can I use replication to improve performance of my system?

</P>
<P>
<STRONG>A</STRONG>: You should set up one server as the master and direct all
writes to it. Then configure as many slaves as you have the budget and
rackspace for, and distribute the reads among the master and the slaves.
You can also start the slaves with the <CODE>--skip-innodb</CODE>, <CODE>--skip-bdb</CODE>,
<CODE>--low-priority-updates</CODE>, and <CODE>--delay-key-write=ALL</CODE> options
to get speed improvements on the slave end.  In this case, the slave will
use non-transactional <CODE>MyISAM</CODE> tables instead of <CODE>InnoDB</CODE> and
<CODE>BDB</CODE> tables to get more speed.

</P>
<P>
<STRONG>Q</STRONG>: What should I do to prepare client code in my own applications
to use performance-enhancing replication?

</P>
<P>
<STRONG>A</STRONG>:
If the part of your code that is responsible for database access has
been properly abstracted/modularized, converting it to run with a
replicated setup should be very smooth and easy. Just change the
implementation of your database access to send all writes to the master,
and to send reads to either the master or a slave.
If your code does not have this level of abstraction,
setting up a replicated system will give you the opportunity and motivation
to it clean up.
You should start by creating a wrapper library or module with the following
functions:

</P>

<UL>
<LI>

<CODE>safe_writer_connect()</CODE>
<LI>

<CODE>safe_reader_connect()</CODE>
<LI>

<CODE>safe_reader_statement()</CODE>
<LI>

<CODE>safe_writer_statement()</CODE>
</UL>

<P>
<CODE>safe_</CODE> in each function name means that the function will take care
of handling all the error conditions.
You can use different names for the
functions. The important thing is to have a unified interface for connecting
for reads, connecting for writes, doing a read, and doing a write.

</P>
<P>
You should then convert your client code to use the wrapper library.
This may be a painful and scary process at first, but it will pay off in
the long run. All applications that use the approach just described will be
able to take advantage of a master/slave configuration, even one involving
multiple slaves.  The
code will be a lot easier to maintain, and adding troubleshooting
options will be trivial. You will just need to modify one or two
functions; for example, to log how long each statement took, or which
statement, among your many thousands, gave you an error.

</P>
<P>
If you have
written a lot of code already, you may want to automate the conversion
task by using the <CODE>replace</CODE> utility that comes with standard MySQL
distributions, or just write your own conversion script.  Ideally, your
code already uses consistent programming style conventions. If not, then you
are probably better off rewriting it anyway, or at least going through
and manually regularizing it to use a consistent style.

</P>
<P>
<STRONG>Q</STRONG>: When and how much can MySQL replication improve the performance
of my system?

</P>
<P>
<STRONG>A</STRONG>: MySQL replication is most beneficial for a system
with frequent reads and infrequent writes. In theory, by using a
single-master/multiple-slave setup, you can scale the system by adding more
slaves until you either run out of network bandwidth, or your update
load grows to the point that the master cannot handle it.

</P>
<P>
In order to determine how many slaves you can get before the added benefits
begin to level out, and how much you can improve performance of your site,
you need to know your query patterns, and to determine empirically by
benchmarking the relationship between the throughput for reads (reads per
second, or <CODE>max_reads</CODE>) and for writes (<CODE>max_writes</CODE>) on a typical
master and a typical slave. The example here shows a rather simplified
calculation of what you can get with replication for a hypothetical system.

</P>
<P>
Let's say that system load consists of 10% writes and 90% reads, and we
have determined by benchmarking that <CODE>max_reads</CODE> is 1200 -
2 * <CODE>max_writes</CODE>.  In other words, the system can do 1,200 reads per
second with no writes, the average write is twice as slow as the average
read, and the relationship is linear. Let us suppose that the master
and each slave have the same capacity, and that we have one master and N
slaves. Then we have for each server (master or slave):

</P>
<P>
<CODE>reads = 1200 - 2 * writes</CODE>

</P>
<P>
<CODE>reads = 9 * writes / (N + 1) </CODE> (reads are split, but writes go
to all servers)

</P>
<P>
<CODE>9 * writes / (N + 1) + 2 * writes = 1200</CODE>

</P>
<P>
<CODE>writes = 1200 / (2 + 9/(N+1)) </CODE>

</P>
<P>
The last equation indicates that the maximum number of writes for N slaves,
given a maximum possible read rate of 1,200 per minute and a ratio of nine
reads per write.

</P>
<P>
This analysis yields the following conclusions:

</P>

<UL>

<LI>

If N = 0 (which means we have no replication), our system can handle about
1200/11 = 109 writes per second.

<LI>

If N = 1, we get up to 184 writes per second.

<LI>

If N = 8, we get up to 400 writes per second.

<LI>

If N = 17, we get up to 480 writes per second.

<LI>

Eventually, as N approaches infinity (and our budget negative infinity),
we can get very close to 600 writes per second, increasing system
throughput about 5.5 times. However, with only eight servers, we increased
it almost four times already.

</UL>

<P>
Note that these computations assume infinite network bandwidth and
neglect several other factors that could turn out to be significant on
your system. In many cases, you may not be able to perform a computation
similar to the just shown that will accurately predict what will happen
on your system if you add N replication slaves. However, answering the
following questions should help you decide whether and how much
replication will improve the performance of your system:

</P>

<UL>
<LI>

What is the read/write ratio on your system?
<LI>

How much more write load can one server handle if you reduce the reads?
<LI>

For how many slaves do you have bandwidth available on your network?
</UL>

<P>
<STRONG>Q</STRONG>: How can I use replication to provide redundancy/high
availability?

</P>
<P>
<STRONG>A</STRONG>: With the currently available features, you would have to
set up a master and a slave (or several slaves), and write a script
that will monitor the
master to see whether it is up. Then instruct your applications and
the slaves to change master in case of failure. Some suggestions:

</P>

<UL>
<LI>

To tell a slave to change its master, use the <CODE>CHANGE MASTER TO</CODE>
statement.
<LI>

A good way to keep your applications informed as to the location of the
master is by having a dynamic DNS entry for the master.
With <CODE>bind</CODE> you can use <TT>`nsupdate'</TT> to dynamically update your DNS.
<LI>

You should run your slaves with the <CODE>--log-bin</CODE> option and without
<CODE>--log-slave-updates</CODE>. This way the slave will be ready to become a
master as soon as you issue <CODE>STOP SLAVE</CODE>; <CODE>RESET MASTER</CODE>, and
<CODE>CHANGE MASTER TO</CODE> on the other slaves.
For example, assume that you have the following setup:


<PRE>
       WC   
        \  
         v
 WC----&#62; M
       / | \  
      /  |  \     
     v   v   v
    S1   S2  S3  
</PRE>

M means the master, S the slaves, WC the clients that issue database writes
and reads; clients that issue only database reads are not represented,
because they need not switch.  S1, S2, and S3 are slaves running with
<CODE>--log-bin</CODE> and without <CODE>--log-slave-updates</CODE>.
Because updates received by a slave from the master are not logged in the
binary log unless <CODE>--log-slave-updates</CODE> is specified, the binary log on
each slave is empty.  If for some reason M becomes unavailable, you can
pick one slave to become the new master. For example, if you pick S1,
all WC should be redirected to S1, and S2 and S3 should replicate from S1.

Make sure that all slaves have processed any statements in their relay log.
On each slave, issue <CODE>STOP SLAVE IO_THREAD</CODE>, then check the output
of <CODE>SHOW PROCESSLIST</CODE> until you see <CODE>Has read all relay log</CODE>.
When this is true for all slaves, they can be reconfigured to the new setup.
On the slave S1 being promoted to become the master, issue
<CODE>STOP SLAVE</CODE> and  <CODE>RESET MASTER</CODE>.

On the other slaves S2 and S3, use <CODE>STOP SLAVE</CODE> and <CODE>CHANGE MASTER
TO MASTER_HOST='S1'</CODE> (where <CODE>'S1'</CODE> represents the real hostname of
S1). To <CODE>CHANGE MASTER</CODE>, add all information about how to connect to
S1 from S2 or S3 (user, password, port). In <CODE>CHANGE MASTER</CODE>, there is
no need to specify the name of S1's binary log or binary log position to
read from: We know it is the first binary log and position 4, which are
the defaults for <CODE>CHANGE MASTER</CODE>. Finally, use <CODE>START SLAVE</CODE>
on S2 and S3.

Then instruct all WC to direct their statements to S1. From that point on,
all updates statements sent by WC to S1 are written to the binary log of S1,
which will contain exactly every update statement sent to S1 since M died.

The result is this configuration:


<PRE>
       WC   
      /   
      |  
 WC   |  M(unavailable)
  \   | 
   \  | 
    v v
     S1&#60;--S2  S3  
      ^       |
      +-------+
</PRE>

When M is up again, you just have to issue on it the same <CODE>CHANGE
MASTER</CODE> as the one issued on S2 and S3, so that M becomes a slave of S1 and
picks all the WC writes it has missed while it was down. Now to make M a
master again (because it is the most powerful machine, for example), use
the preceding procedure as if S1 was unavailable and M was to be the new
master. During the procedure, don't forget to run <CODE>RESET MASTER</CODE> on M
before making S1, S2,  and S3 slaves of M. Otherwise, they may pick up old
WC writes from before the point at which M became unavailable.

</UL>

<P>
We are currently working on integrating an automatic master election
system into MySQL, but until it is ready, you will have to
create your own monitoring tools.

</P>



<H2><A NAME="Replication_Problems" HREF="manual_toc.html#Replication_Problems">6.10  Troubleshooting Replication</A></H2>

<P>
If you have followed the instructions, and your replication setup is not
working, first check the following:

</P>

<UL>
<LI>

<STRONG>Check the error log for messages</STRONG>. Many users have lost time
by not doing this early enough.

<LI>

Is the master logging to the binary log? Check with <CODE>SHOW MASTER STATUS</CODE>.
If it is, <CODE>Position</CODE> will be non-zero. If not, verify that you are
running the master with the <CODE>log-bin</CODE> and <CODE>server-id</CODE> options.

<LI>

Is the slave running? Use <CODE>SHOW SLAVE STATUS</CODE> to check whether the
<CODE>Slave_IO_Running</CODE> and <CODE>Slave_SQL_Running</CODE> values are both
<CODE>Yes</CODE>.
If not, verify the options that were used when starting the slave server.

<LI>

If the slave is running, did it establish a connection to the master? Use
<CODE>SHOW PROCESSLIST</CODE>, find the I/O and SQL threads and check their 
<CODE>State</CODE> column to see how they display.
See section <A HREF="manual.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>.
If the I/O thread state says <CODE>Connecting to master</CODE>, verify the
privileges for the replication user on the master, master hostname, your
DNS setup, whether the master is actually running, and whether it is reachable
from the slave.

<LI>

If the slave was running before but now has stopped, the reason usually is
that some statement that succeeded on the master failed on the slave. This
should never happen if you have taken a proper snapshot of the master, and
never modify the data on the slave outside of the slave thread. If it does,
it is a bug or you have encountered one of the known replication limitations
described in section <A HREF="manual.html#Replication_Features">6.7  Replication Features and Known Problems</A>.  If it is a bug, see
section <A HREF="manual.html#Replication_Bugs">6.11  Reporting Replication Bugs</A> for instructions on how to report it.

<LI>

If a statement that succeeded on the master refuses to run on the slave, and
it is not feasible to do a full database resynchronization (that is, to
delete the slave's database and copy a new snapshot from the master), try
the following:


<OL>
<LI>

Determine whether
the slave's table is different from the
master's. Try to understand how this happened.
Then make the slave's table
identical to the master's and run <CODE>START SLAVE</CODE>.

<LI>

If the preceding step does not work or does not apply, try to understand
whether it would
be safe to make the update manually (if needed) and then ignore the next
statement from the master.

<LI>

If you decide that you can skip the next statement from the master, issue
the following statements:


<PRE>
mysql&#62; SET GLOBAL SQL_SLAVE_SKIP_COUNTER = n;
mysql&#62; START SLAVE;
</PRE>

The value of <CODE>n</CODE> should be 1 if the next statement from the master
does not use <CODE>AUTO_INCREMENT</CODE> or <CODE>LAST_INSERT_ID()</CODE>. Otherwise,
the value should be 2.  The reason for using a value of 2 for statements
that use <CODE>AUTO_INCREMENT</CODE> or <CODE>LAST_INSERT_ID()</CODE> is that they
take two events in the binary log of the master.

<LI>

If you are sure that the slave started out perfectly synchronized with the master,
and no one has updated the tables involved outside of slave thread, then
presumably the discrepancy is the result of a bug. If you are running the most
recent version, please report the problem. If you are running an older
version of MySQL, try upgrading.
</OL>

</UL>



<H2><A NAME="Replication_Bugs" HREF="manual_toc.html#Replication_Bugs">6.11  Reporting Replication Bugs</A></H2>

<P>
When you have determined that there is no user error involved, and replication
still either does not work at all or is unstable, it is time to send
us a bug report. We need to get as much information as possible from you to be able
to track down the bug. Please do spend some time and effort preparing a good
bug report. 

</P>
<P>
If you have a repeatable test case that demonstrates the bug, please
enter it into our bugs database
at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>. If you have a phantom problem (one that
you cannot duplicate ``at will''), use the following procedure:

</P>

<OL>
<LI>

Verify that no user error is involved. For example, if you update the
slave outside of the slave thread, the data will go out of sync, and you can
have unique key violations on updates. In this case, the slave thread will
stop and wait for you to clean up the tables manually to bring them in sync.
This is not a replication problem. It is a problem of outside interference
that causes replication to fail.

<LI>

Run the slave with the <CODE>--log-slave-updates</CODE> and <CODE>--log-bin</CODE>
options.
They will cause the slave to log the updates that it receives from the master
into its own binary logs.

<LI>

Save all evidence before resetting the replication state. If we have no
information or only sketchy information, it becomes difficult or impossible
for us to track down the problem. The evidence you should collect is:


<UL>
<LI>

All binary logs from the master

<LI>

All binary logs from the slave

<LI>

The output of <CODE>SHOW MASTER STATUS</CODE> from the master at the time
you have discovered the problem

<LI>

The output of <CODE>SHOW SLAVE STATUS</CODE> from the master at the time
you have discovered the problem

<LI>

Error logs from the master and the slave
</UL>

<LI>

Use <CODE>mysqlbinlog</CODE> to examine the binary logs. The following should
be helpful
to find the trouble query, for example:

<PRE>
shell&#62; mysqlbinlog -j pos_from_slave_status \
           /path/to/log_from_slave_status | head
</PRE>

</OL>

<P>
Once you have collected the evidence for the phantom problem, try hard to
isolate it into a separate test case first. Then enter the problem into
our bugs database at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a> with as much
information as possible.

</P>



<H1><A NAME="MySQL_Optimisation" HREF="manual_toc.html#MySQL_Optimisation">7  MySQL Optimization</A></H1>

<P>
Optimization is a complex task because ultimately it requires
understanding of the entire system. Although it may be possible to perform some
local optimizations with little knowledge of your system or application,
the more optimal you want your system to become, the more you will have
to know about it.

</P>
<P>
This chapter tries to explain and give some examples of different
ways to optimize MySQL.  Remember, however, that there are
always additional ways to make the system
even faster, although they may require increasing effort to achieve.

</P>



<H2><A NAME="Optimise_Overview" HREF="manual_toc.html#Optimise_Overview">7.1  Optimization Overview</A></H2>

<P>
The most important factor in making a system fast is the basic
design. You also need to know what kinds of things your system will be
doing, and what your bottlenecks are.

</P>
<P>
The most common system bottlenecks are:

</P>

<UL>
<LI>Disk seeks.

It takes time for the disk to find a piece of data. With modern disks,
the mean time for this is usually lower than 10ms, so we can in
theory do about 100 seeks a second. This time improves slowly with new
disks and is very hard to optimize for a single table. The way to
optimize seek time is to distribute the data onto more than one disk.

<LI>Disk reading and writing.

When the disk is at the correct position, we need to read the data. With
modern disks, one disk delivers at least 10-20MB/s throughput. This
is easier to optimize than seeks because you can read in parallel from
multiple disks.

<LI>CPU cycles.

When we have the data in main memory (or if it was already
there), we need to process it to get our result. Having small
tables compared to the amount of memory is the most common limiting
factor. But with small tables, speed is usually not the problem.

<LI>Memory bandwidth.

When the CPU needs more data than can fit in the CPU cache, main
memory bandwidth becomes a bottleneck. This is an uncommon bottleneck
for most systems, but one to be aware of.
</UL>



<H3><A NAME="Design_Limitations" HREF="manual_toc.html#Design_Limitations">7.1.1  MySQL Design Limitations and Tradeoffs</A></H3>

<P>
<A NAME="IDX698"></A>
<A NAME="IDX699"></A>

</P>
<P>
When using the <CODE>MyISAM</CODE> storage engine, MySQL uses extremely fast table
locking that allows multiple readers or a single writer. The biggest problem
with this storage engine occurs when you have a steady stream of mixed
updates and slow selects on a single table.  If this is a problem for
certain tables, you can use another table type for them. See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
MySQL can work with both transactional and non-transactional tables.
To be able to work smoothly with non-transactional tables (which can't
roll back if something goes wrong), MySQL has the following rules:

</P>
<P>
<A NAME="IDX700"></A>

<UL>
<LI>

All columns have default values.
<LI>

If you insert a ``wrong'' value in a column, such as a too-large numerical
value into a numerical column, MySQL sets the column to the ``best possible
value'' instead of giving an error.  For numerical values, this is 0,
the smallest possible value or the largest possible value. For strings,
this is either the empty string or the longest possible string that can
be stored in the column.
<LI>

All calculated expressions return a value that can be used instead of
signaling an error condition. For example, 1/0 returns <CODE>NULL</CODE>.
</UL>

<P>
The implication of these rules is that you should not use MySQL to check
column content. Instead, you should check values within your application before
storing them in the database.

</P>
<P>
For more information about this, see section <A HREF="manual.html#Constraints">1.8.6  How MySQL Deals with Constraints</A> and section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>.

</P>


<H3><A NAME="Portability" HREF="manual_toc.html#Portability">7.1.2  Designing Applications for Portability</A></H3>

<P>
<A NAME="IDX701"></A>
<A NAME="IDX702"></A>
<A NAME="IDX703"></A>

</P>
<P>
Because all SQL servers implement different parts of standard SQL,
it takes work to write portable SQL applications.  It is very easy to
achieve portability for very simple selects and inserts, but becomes more
difficult the more capabilities you require.  If you want an application
that is fast with many database systems, it becomes even harder!

</P>
<P>
To make a complex application portable, you need to determine which SQL
servers it must work with, then determine what features those servers
support.

</P>
<P>
All database systems have some weak points. That is, they have different
design compromises that lead to different behavior.

</P>
<P>
You can use the MySQL <CODE>crash-me</CODE> program to find functions, types, and
limits that you can use with a selection of database servers.
<CODE>crash-me</CODE> does not check for every possible feature, but it is still
reasonably comprehensive, performing about 450 tests.

</P>
<P>
An example of the type of information <CODE>crash-me</CODE> can provide is that
you shouldn't have column names longer than 18 characters
if you want to be able to use Informix or DB2.

</P>
<P>
The <CODE>crash-me</CODE> program and the MySQL benchmarks are all very database
independent.  By taking a look at how they are written, you can get
a feeling for what you have to do to make your own applications database
independent.  The programs can be found in the <TT>`sql-bench'</TT> directory
of MySQL source distributions. They are written in Perl and use the DBI
database interface.  Use of DBI in itself solves part of the portability
problem because it provides database-independent access methods.

</P>
<P>
For <CODE>crash-me</CODE> results, visit
<a HREF="http://dev.mysql.com/tech-resources/crash-me.php">http://dev.mysql.com/tech-resources/crash-me.php</a>.
See <a HREF="http://dev.mysql.com/tech-resources/benchmarks/">http://dev.mysql.com/tech-resources/benchmarks/</a> for the results
from the benchmarks.

</P>
<P>
If you strive for database independence, you need to get a good feeling
for each SQL server's bottlenecks. For example, MySQL is very fast in
retrieving and updating records for <CODE>MyISAM</CODE> tables, but will have
a problem in mixing slow readers and writers on the same table. Oracle,
on the other hand, has a big problem when you try to access rows that
you have recently updated (until they are flushed to disk). Transactional
databases in general are not very good at generating summary tables from
log tables, because in this case row locking is almost useless.

</P>
<P>
To make your application <EM>really</EM> database independent, you need to define
an easily extendable interface through which you manipulate your data. As
C++ is available on most systems, it makes sense to use a C++ class-based
interface to the databases.

</P>
<P>
If you use some feature that is specific to a given database system (such
as the <CODE>REPLACE</CODE> statement, which is specific to MySQL), you should
implement the same feature for other SQL servers by coding an alternative
method. Although the alternative may be slower, it will allow the other
servers to perform the same tasks.

</P>
<P>
With MySQL, you can use the <CODE>/*!  */</CODE> syntax to add MySQL-specific
keywords to a query.  The code inside <CODE>/**/</CODE> will be treated as a
comment (and ignored) by most other SQL servers.

</P>
<P>
If high performance is more important than exactness, as in some
Web applications, it is possible to create an application layer that
caches all results to give you even higher performance. By letting
old results ``expire'' after a while, you can keep the cache reasonably
fresh.  This provides a method to handle high load spikes, in which case
you can dynamically increase the cache and set the expiration timeout higher
until things get back to normal.

</P>
<P>
In this case, the table creation information should contain information
of the initial size of the cache and how often the table should normally
be refreshed.

</P>
<P>
An alternative to implementing an application cache is to use the MySQL query
cache. By enabling the query cache, the server handles the details of
determining whether a query result can be reused. This simplifies your
application.
See section <A HREF="manual.html#Query_Cache">5.10  The MySQL Query Cache</A>.

</P>



<H3><A NAME="Internal_use" HREF="manual_toc.html#Internal_use">7.1.3  What We Have Used MySQL For</A></H3>

<P>
<A NAME="IDX704"></A>
<A NAME="IDX705"></A>

</P>
<P>
This section describes an early application for MySQL.

</P>
<P>
During MySQL initial development, the features of MySQL
were made to fit our largest customer, which handled data warehousing for a
couple of the largest retailers in Sweden.

</P>
<P>
From all stores, we got weekly summaries of all bonus card transactions,
and were expected to provide useful information for the store owners
to help them find how their advertising campaigns were affecting their
own customers.

</P>
<P>
The volume of data was quite huge (about seven million summary transactions
per month), and we had data for 4-10 years that we needed to present to
the users.  We got weekly requests from our customers, who wanted to get
``instant'' access to new reports from this data.

</P>
<P>
We solved this problem by storing all information per month in compressed
``transaction'' tables. We had a set of simple macros that
generated summary tables grouped by different criteria (product group,
customer id, store, and so on) from the tables in which the transactions
were stored.  The reports were Web pages that were dynamically generated
by a small Perl script. This script parsed a Web page, executed the SQL
statements in it, and inserted the results. We would have used PHP or
mod_perl instead, but they were not available at the time.

</P>
<P>
For graphical data, we wrote a simple tool in C that could process SQL
query results and produce GIF images based on those results.  This tool also
was dynamically executed from the Perl script that parses the Web pages.

</P>
<P>
In most cases, a new report could be created simply by copying an existing
script and modifying the SQL query in it.  In some cases, we needed to
add more columns to an existing summary table or generate a new one.
This also was quite simple because we kept all transaction-storage tables
on disk.  (This amounted to about 50GB of transaction tables and 200GB
of other customer data.)

</P>
<P>
We also let our customers access the summary tables directly with ODBC
so that the advanced users could experiment with the data themselves.

</P>
<P>
This system worked well and we had no problems handling the data with
quite modest Sun Ultra SPARCstation hardware (2x200MHz). Eventually the
system was migrated to Linux.

</P>



<H3><A NAME="MySQL_Benchmarks" HREF="manual_toc.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A></H3>

<P>
<A NAME="IDX706"></A>
<A NAME="IDX707"></A>

</P>
<P>
This section should contain a technical description of the MySQL
benchmark suite (and <CODE>crash-me</CODE>), but that description has not yet
been written. Currently, you can get a good idea of the benchmarks by
looking at the code and results in the <TT>`sql-bench'</TT> directory in any
MySQL source distribution.

</P>
<P>
This benchmark suite is meant to tell any user what operations a given
SQL implementation performs well or poorly.

</P>
<P>
Note that this benchmark is single-threaded, so it measures the minimum
time for the operations performed. We plan to add multi-threaded tests to
the benchmark suite in the future.

</P>
<P>
The following tables show some comparative benchmark results for several
database servers when accessed through ODBC on a Windows NT 4.0 machine.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Reading 2000000 rows by index</STRONG> </TD><TD> <STRONG>Seconds</STRONG> </TD><TD> <STRONG>Seconds</STRONG>
</TD></TR>
<TR><TD>mysql </TD><TD> 367 </TD><TD> 249
</TD></TR>
<TR><TD>mysql_odbc </TD><TD> 464 </TD><TD>
</TD></TR>
<TR><TD>db2_odbc </TD><TD> 1206 </TD><TD>
</TD></TR>
<TR><TD>informix_odbc </TD><TD> 121126 </TD><TD>
</TD></TR>
<TR><TD>ms-sql_odbc </TD><TD> 1634 </TD><TD>
</TD></TR>
<TR><TD>oracle_odbc </TD><TD> 20800 </TD><TD>
</TD></TR>
<TR><TD>solid_odbc </TD><TD> 877 </TD><TD>
</TD></TR>
<TR><TD>sybase_odbc </TD><TD> 17614 </TD><TD>
</TD></TR>
</TABLE>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Inserting 350768 rows</STRONG> </TD><TD> <STRONG>Seconds</STRONG> </TD><TD> <STRONG>Seconds</STRONG>
</TD></TR>
<TR><TD>mysql </TD><TD> 381 </TD><TD> 206
</TD></TR>
<TR><TD>mysql_odbc </TD><TD> 619 </TD><TD>
</TD></TR>
<TR><TD>db2_odbc </TD><TD> 3460 </TD><TD>
</TD></TR>
<TR><TD>informix_odbc </TD><TD> 2692 </TD><TD>
</TD></TR>
<TR><TD>ms-sql_odbc </TD><TD> 4012 </TD><TD>
</TD></TR>
<TR><TD>oracle_odbc </TD><TD> 11291 </TD><TD>
</TD></TR>
<TR><TD>solid_odbc </TD><TD> 1801 </TD><TD>
</TD></TR>
<TR><TD>sybase_odbc </TD><TD> 4802 </TD><TD>
</TD></TR>
</TABLE>

<P>
For the preceding tests, MySQL was run with an index cache size of 8MB.

</P>
<P>
Note that Oracle is not included because it asked to be removed. All
Oracle benchmarks have to be passed by Oracle! We believe that makes
Oracle benchmarks <STRONG>very</STRONG> biased because the above benchmarks are
supposed to show what a standard installation can do for a single
client.

</P>
<P>
To use the benchmark suite, the following requirements must be satisfied:

</P>

<UL>
<LI>

The benchmark suite is provided with MySQL source distributions.
You can either download a released distribution from
<a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>, or use the current development
source tree (see section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>).

<LI>

The benchmark scripts are written in Perl and use the Perl DBI module to
access database servers, so DBI must be installed.  You will also need
the server-specific DBD drivers for each of the servers you want to test.
For example, to test MySQL, PostgreSQL, and DB2, you must have the
<CODE>DBD::mysql</CODE>, <CODE>DBD::Pg</CODE>, and <CODE>DBD::DB2</CODE> modules installed.
See section <A HREF="manual.html#Perl_support">2.7  Perl Installation Notes</A>.

</UL>

<P>
After you obtain a MySQL source distribution, you will find the benchmark
suite located in its <TT>`sql-bench'</TT> directory.  To run the benchmark tests,
build MySQL, then
change location into the <TT>`sql-bench'</TT> directory and execute the <CODE>run-all-tests</CODE>
script:

</P>

<PRE>
shell&#62; cd sql-bench
shell&#62; perl run-all-tests --server=server_name
</PRE>

<P>
<CODE>server_name</CODE> is one of supported servers. To get a list of
all options and supported servers, invoke this command:

</P>

<PRE>
shell&#62; perl run-all-tests --help
</PRE>

<P>
<A NAME="IDX708"></A>
The <CODE>crash-me</CODE> script also is located in the <TT>`sql-bench'</TT> directory.
<CODE>crash-me</CODE> tries to determine what features a database supports and
what its capabilities and limitations are by actually running
queries. For example, it determines:

</P>

<UL>
<LI>

What column types are supported
<LI>

How many indexes are supported
<LI>

What functions are supported
<LI>

How big a query can be
<LI>

How big a <CODE>VARCHAR</CODE> column can be
</UL>

<P>
You can find the results from <CODE>crash-me</CODE> for many different database
servers at <a HREF="http://dev.mysql.com/tech-resources/crash-me.php">http://dev.mysql.com/tech-resources/crash-me.php</a>.
For more information about benchmark results, visit
<a HREF="http://dev.mysql.com/tech-resources/benchmarks/">http://dev.mysql.com/tech-resources/benchmarks/</a>.

</P>



<H3><A NAME="Custom_Benchmarks" HREF="manual_toc.html#Custom_Benchmarks">7.1.5  Using Your Own Benchmarks</A></H3>

<P>
<A NAME="IDX709"></A>
<A NAME="IDX710"></A>

</P>
<P>
You should definitely benchmark your application and database to find
out where the bottlenecks are.  By fixing a bottleneck (or by replacing it
with a ``dummy module''), you can then easily identify the next
bottleneck.  Even if the overall performance for your
application currently is acceptable, you should at least make a plan for each
bottleneck, and decide how to solve it if someday you really need the
extra performance.

</P>
<P>
For an example of portable benchmark programs, look at the MySQL
benchmark suite. See section <A HREF="manual.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>. You
can take any program from this suite and modify it for your needs. By doing
this, you can try different solutions to your problem and test which really is
fastest for you.

</P>
<P>
Another free benchmark suite is the <CODE>Open Source Database Benchmark</CODE>,
available at <a HREF="http://osdb.sourceforge.net/">http://osdb.sourceforge.net/</a>.

</P>
<P>
It is very common for a problem to occur only when the system is very
heavily loaded. We have had many customers who contact us when they
have a (tested) system in production and have encountered load problems. In
most cases, performance problems turn out to be due to issues of basic
database design (for example, table scans are <EM>not good</EM> at high load) or
problems with the operating system or libraries. Most of the time, these
problems would be a <EM>lot</EM> easier to fix if the systems were not
already in production.

</P>
<P>
To avoid problems like this, you should put some effort into benchmarking
your whole application under the worst possible load!  You can use
Super Smack for this. It is available at
<a HREF="http://jeremy.zawodny.com/mysql/super-smack/">http://jeremy.zawodny.com/mysql/super-smack/</a>.
As the name suggests, it can bring a system to its knees if you ask it,
so make sure to use it only on your development systems.

</P>



<H2><A NAME="Query_Speed" HREF="manual_toc.html#Query_Speed">7.2  Optimizing <CODE>SELECT</CODE> Statements and Other Queries</A></H2>

<P>
<A NAME="IDX711"></A>
<A NAME="IDX712"></A>
<A NAME="IDX713"></A>

</P>
<P>
First, one factor affects all statements: The more complex your permission
setup is, the more overhead you will have.

</P>
<P>
Using simpler permissions when you issue <CODE>GRANT</CODE> statements enables
MySQL to reduce permission-checking overhead when clients execute
statements.  For example, if you don't grant any table-level or column-level
privileges, the server need not ever check the contents of the
<CODE>tables_priv</CODE> and <CODE>columns_priv</CODE> tables. Similarly, if you place
no resource limits on any accounts, the server does not have to perform
resource counting.  If you have a very high query volume, it may be worth
the time to use a simplified grant structure to reduce permission-checking
overhead.

</P>
<P>
If your problem is with some specific MySQL expression or function, you can
use the <CODE>BENCHMARK()</CODE> function from the <CODE>mysql</CODE> client program
to perform a timing test. Its syntax is
<CODE>BENCHMARK(loop_count,expression)</CODE>. For example:

</P>

<PRE>
mysql&#62; SELECT BENCHMARK(1000000,1+1);
+------------------------+
| BENCHMARK(1000000,1+1) |
+------------------------+
|                      0 |
+------------------------+
1 row in set (0.32 sec)
</PRE>

<P>
This result was obtained on a Pentium II 400MHz system. It shows that
MySQL can execute 1,000,000 simple addition expressions in 0.32 seconds
on that system.

</P>
<P>
All MySQL functions should be very optimized, but there may be some
exceptions. <CODE>BENCHMARK()</CODE> is a great tool to find out if this is a
problem with your query.

</P>



<H3><A NAME="EXPLAIN" HREF="manual_toc.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A></H3>

<P>
<A NAME="IDX714"></A>
<A NAME="IDX715"></A>

</P>


<PRE>
EXPLAIN tbl_name
</PRE>

<P>
Or:

</P>

<PRE>
EXPLAIN SELECT select_options
</PRE>

<P>
The <CODE>EXPLAIN</CODE> statement can be used either as a synonym for
<CODE>DESCRIBE</CODE> or as a way to obtain information about how MySQL will execute
a <CODE>SELECT</CODE> statement:

</P>

<UL>
<LI>

The <CODE>EXPLAIN tbl_name</CODE> syntax is synonymous with <CODE>DESCRIBE tbl_name</CODE>
or
<CODE>SHOW COLUMNS FROM tbl_name</CODE>.
<LI>

When you precede a <CODE>SELECT</CODE> statement with the keyword <CODE>EXPLAIN</CODE>,
MySQL explains how it would process the <CODE>SELECT</CODE>, providing
information about how tables are joined and in which order.
</UL>

<P>
This section provides information about the second use of <CODE>EXPLAIN</CODE>.

</P>
<P>
With the help of <CODE>EXPLAIN</CODE>, you can see when you must add indexes
to tables to get a faster <CODE>SELECT</CODE> that uses indexes to find
records.

</P>
<P>
You should frequently run <CODE>ANALYZE TABLE</CODE> to update table statistics
such as cardinality of keys, which can affect the choices the optimizer
makes. See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A>.

</P>
<P>
You can also see whether the optimizer joins the tables in an optimal order.
To force the optimizer to use a join order corresponding to the order
in which the tables are named in the <CODE>SELECT</CODE> statement, begin the
statement with <CODE>SELECT STRAIGHT_JOIN</CODE> rather than just <CODE>SELECT</CODE>.

</P>
<P>
<CODE>EXPLAIN</CODE> returns a row of information for each table used in the
<CODE>SELECT</CODE> statement. The tables are listed in the output in the order
that MySQL would read them while processing the query.  MySQL resolves
all joins using a single-sweep
multi-join method. This means that MySQL reads a row from the first
table, then finds a matching row in the second table, then in the third table,
and so on. When all tables are processed, it outputs the selected columns and
backtracks through the table list until a table is found for which there are
more matching rows. The next row is read from this table and the process
continues with the next table.

</P>
<P>
In MySQL version 4.1, the <CODE>EXPLAIN</CODE> output format was changed to work
better with constructs such as <CODE>UNION</CODE> statements, subqueries, and
derived tables. Most notable is the addition of two new columns: <CODE>id</CODE>
and <CODE>select_type</CODE>. You will not see these columns when using servers
older than MySQL 4.1.

</P>
<P>
Each output row from <CODE>EXPLAIN</CODE> provides information about one table, and
each row consists of the following columns:

</P>
<DL COMPACT>

<DT><CODE>id</CODE>
<DD>
The <CODE>SELECT</CODE> identifier. This is the sequential number of the
<CODE>SELECT</CODE> within the query.

<DT><CODE>select_type</CODE>
<DD>
The type of <CODE>SELECT</CODE>, which can be any of the following:

<DL COMPACT>

<DT><CODE>SIMPLE</CODE>
<DD>
Simple <CODE>SELECT</CODE> (not using <CODE>UNION</CODE> or subqueries)

<DT><CODE>PRIMARY</CODE>
<DD>
Outermost <CODE>SELECT</CODE>

<DT><CODE>UNION</CODE>
<DD>
Second or later <CODE>SELECT</CODE> statement in a <CODE>UNION</CODE>

<DT><CODE>DEPENDENT UNION</CODE>
<DD>
Second or later <CODE>SELECT</CODE> statement in a <CODE>UNION</CODE>, dependent on outer
subquery

<DT><CODE>SUBQUERY</CODE>
<DD>
First <CODE>SELECT</CODE> in subquery

<DT><CODE>DEPENDENT SUBQUERY</CODE>
<DD>
First <CODE>SELECT</CODE> in subquery, dependent on outer subquery

<DT><CODE>DERIVED</CODE>
<DD>
Derived table <CODE>SELECT</CODE> (subquery in <CODE>FROM</CODE> clause)
</DL>

<DT><CODE>table</CODE>
<DD>
The table to which the row of output refers.

<DT><CODE>type</CODE>
<DD>
The join type. The different join types are listed here, ordered from the
best type to the worst:

<DL COMPACT>

<DT><CODE>system</CODE>
<DD>
<A NAME="IDX716"></A>
<A NAME="IDX717"></A>
The table has only one row (= system table). This is a special case of
the <CODE>const</CODE> join type.

<DT><CODE>const</CODE>
<DD>
<A NAME="IDX718"></A>
<A NAME="IDX719"></A>
The table has at most one matching row, which will be read at the start
of the query. Because there is only one row, values from the column in
this row can be regarded as constants by the rest of the
optimizer. <CODE>const</CODE> tables are very fast because they are read only once!

<CODE>const</CODE> is used when you compare all parts of a
<CODE>PRIMARY KEY</CODE> or <CODE>UNIQUE</CODE> index with constant values. In the
following queries, <CODE>tbl_name</CODE> can be used as a <CODE>const</CODE> table:


<PRE>
SELECT * FROM tbl_name WHERE primary_key=1;

SELECT * FROM tbl_name
WHERE primary_key_part1=1 AND primary_key_part2=2;
</PRE>

<DT><CODE>eq_ref</CODE>
<DD>
One row will be read from this table for each combination of rows from
the previous tables.  Other than the <CODE>const</CODE> types, this is the best
possible join type.  It is used when all parts of an index are used by
the join and the index is a <CODE>PRIMARY KEY</CODE> or <CODE>UNIQUE</CODE> index.

<CODE>eq_ref</CODE> can be used for indexed columns that are compared using the
<CODE>=</CODE> operator.  The comparison value can be a constant or an expression
that uses columns from tables that are read before this table.

In the following examples, MySQL can use an <CODE>eq_ref</CODE> join to process
<CODE>ref_table</CODE>:


<PRE>
SELECT * FROM ref_table,other_table
WHERE ref_table.key_column=other_table.column;

SELECT * FROM ref_table,other_table
WHERE ref_table.key_column_part1=other_table.column
AND ref_table.key_column_part2=1;
</PRE>

<DT><CODE>ref</CODE>
<DD>
All rows with matching index values will be read from this table for
each combination of rows from the previous tables.  <CODE>ref</CODE> is used
if the join uses only a leftmost prefix of the key or if the key is not
a <CODE>PRIMARY KEY</CODE> or <CODE>UNIQUE</CODE> index (in other words, if the join
cannot select a single row based on the key value).  If the key that is
used matches only a few rows, this is a good join type.

<CODE>ref</CODE> can be used for indexed columns that are compared using the <CODE>=</CODE>
operator.

In the following examples, MySQL can use a <CODE>ref</CODE> join to process
<CODE>ref_table</CODE>:


<PRE>
SELECT * FROM ref_table WHERE key_column=expr;

SELECT * FROM ref_table,other_table
WHERE ref_table.key_column=other_table.column;

SELECT * FROM ref_table,other_table
WHERE ref_table.key_column_part1=other_table.column
AND ref_table.key_column_part2=1;
</PRE>

<DT><CODE>ref_or_null</CODE>
<DD>
This join type is like <CODE>ref</CODE>, but with the addition that MySQL will
do an extra search for rows that contain <CODE>NULL</CODE> values.  This join
type optimization is new for MySQL 4.1.1 and is mostly used when resolving
subqueries.

In the following examples, MySQL can use a <CODE>ref_or_null</CODE> join to process
<CODE>ref_table</CODE>:


<PRE>
SELECT * FROM ref_table
WHERE key_column=expr OR key_column IS NULL; 
</PRE>

See section <A HREF="manual.html#IS_NULL_optimisation">7.2.6  How MySQL Optimizes <CODE>IS NULL</CODE></A>.

<DT><CODE>index_merge</CODE>
<DD>
This join type indicates that the <CODE>Index Merge</CODE> optimization is used.
In this case, the <CODE>key</CODE> column contains a list of indexes used, and
<CODE>key_len</CODE> contains a list of the longest key parts for the indexes
used.  For more information, see section <A HREF="manual.html#OR_optimizations">7.2.5  How MySQL Optimizes <CODE>OR</CODE> Clauses</A>.

<DT><CODE>unique_subquery</CODE>
<DD>
This type replaces <CODE>ref</CODE> for some <CODE>IN</CODE> subqueries of the following
form:

<PRE>
value IN (SELECT primary_key FROM single_table WHERE some_expr) 
</PRE>

<CODE>unique_subquery</CODE> is just an index lookup function that replaces the
subquery completely for better efficiency.

<DT><CODE>index_subquery</CODE>
<DD>
This join type is similar to
<CODE>unique_subquery</CODE>. It replaces <CODE>IN</CODE> subqueries, but
it works for non-unique indexes in subqueries of the following form:


<PRE>
value IN (SELECT key_column FROM single_table WHERE some_expr) 
</PRE>

<DT><CODE>range</CODE>
<DD>
Only rows that are in a given range will be retrieved, using an index to
select the rows.  The <CODE>key</CODE> column indicates which index is used.
The <CODE>key_len</CODE> contains the longest key part that was used.
The <CODE>ref</CODE> column will be <CODE>NULL</CODE> for this type.

<CODE>range</CODE> can be used for when a key column is compared to a
constant using any of the <CODE>=</CODE>, <CODE>&#60;&#62;</CODE>, <CODE>&#62;</CODE>, <CODE>&#62;=</CODE>, <CODE>&#60;</CODE>,
<CODE>&#60;=</CODE>, <CODE>IS NULL</CODE>, <CODE>&#60;=&#62;</CODE>, <CODE>BETWEEN</CODE>, or <CODE>IN</CODE> operators:


<PRE>
SELECT * FROM tbl_name
WHERE key_column = 10;

SELECT * FROM tbl_name
WHERE key_column BETWEEN 10 and 20;

SELECT * FROM tbl_name
WHERE key_column IN (10,20,30);

SELECT * FROM tbl_name
WHERE key_part1= 10 AND key_part2 IN (10,20,30);
</PRE>

<DT><CODE>index</CODE>
<DD>
This join type is the same as <CODE>ALL</CODE>, except that only the index tree
is scanned.  This usually is faster than <CODE>ALL</CODE>, because the index
file usually is smaller than the data file.

MySQL can use this join type when the query uses only columns that are
part of a single index.

<DT><CODE>ALL</CODE>
<DD>
A full table scan will be done for each combination of rows from the
previous tables.  This is normally not good if the table is the first
table not marked <CODE>const</CODE>, and usually <EM>very</EM> bad in all other
cases. Normally, you can avoid <CODE>ALL</CODE> by adding indexes that allow row
retrieval from the table based on constant values or column values from
earlier tables.
</DL>

<DT><CODE>possible_keys</CODE>
<DD>
The <CODE>possible_keys</CODE> column indicates which indexes MySQL could use to
find the rows in this table. Note that this column is totally independent of
the order of the tables as displayed in the output from <CODE>EXPLAIN</CODE>. That
means that some of the keys in <CODE>possible_keys</CODE> might not be usable in
practice with the generated table order.

If this column is <CODE>NULL</CODE>, there are no relevant indexes. In this case,
you may be able to improve the performance of your query by examining
the <CODE>WHERE</CODE> clause to see whether it refers to some column or columns
that would be suitable for indexing.  If so, create an appropriate index
and check the query with <CODE>EXPLAIN</CODE> again.
See section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.

To see what indexes a table has, use <CODE>SHOW INDEX FROM tbl_name</CODE>.

<DT><CODE>key</CODE>
<DD>
The <CODE>key</CODE> column indicates the key (index) that MySQL actually decided
to use. The key is <CODE>NULL</CODE> if no index was chosen. To force MySQL
to use or ignore an index listed in the <CODE>possible_keys</CODE> column, use
<CODE>FORCE INDEX</CODE>, <CODE>USE INDEX</CODE>, or <CODE>IGNORE INDEX</CODE> in your query.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

For <CODE>MyISAM</CODE> and <CODE>BDB</CODE> tables, running <CODE>ANALYZE TABLE</CODE>
will help the optimizer choose better indexes.  For <CODE>MyISAM</CODE> tables,
<CODE>myisamchk --analyze</CODE> will do the same.  See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A> and section <A HREF="manual.html#Table_maintenance">5.6.2  Using <CODE>myisamchk</CODE> for Table Maintenance and Crash Recovery</A>.

<DT><CODE>key_len</CODE>
<DD>
The <CODE>key_len</CODE> column indicates the length of the key that MySQL
decided to use.  The length is <CODE>NULL</CODE> if the <CODE>key</CODE> column says
<CODE>NULL</CODE>. Note that the value of <CODE>key_len</CODE> allows you to determine
how many parts of a multiple-part key MySQL will actually use.

<DT><CODE>ref</CODE>
<DD>
The <CODE>ref</CODE> column shows which columns or constants are used with the
<CODE>key</CODE> to select rows from the table.

<DT><CODE>rows</CODE>
<DD>
The <CODE>rows</CODE> column indicates the number of rows MySQL
believes it must examine to execute the query.

<DT><CODE>Extra</CODE>
<DD>
This column contains additional information about how MySQL will
resolve the query. Here is an explanation of the different text
strings that can appear in this column:

<DL COMPACT>

<DT><CODE>Distinct</CODE>
<DD>
MySQL will stop searching for more rows for the current row
combination after it has found the first matching row.

<DT><CODE>Not exists</CODE>
<DD>
MySQL was able to do a <CODE>LEFT JOIN</CODE> optimization on the
query and will not examine more rows in this table for the previous row
combination after it finds one row that matches the <CODE>LEFT JOIN</CODE> criteria.

Here is an example of the type of query that can be optimized this way:


<PRE>
SELECT * FROM t1 LEFT JOIN t2 ON t1.id=t2.id
WHERE t2.id IS NULL;
</PRE>

Assume that <CODE>t2.id</CODE> is defined as <CODE>NOT NULL</CODE>.  In this case,
MySQL will scan <CODE>t1</CODE> and look up the rows in <CODE>t2</CODE> using the values
of <CODE>t1.id</CODE>. If MySQL finds a matching row in <CODE>t2</CODE>, it knows that
<CODE>t2.id</CODE> can never be <CODE>NULL</CODE>, and will not scan through the rest
of the rows in <CODE>t2</CODE> that have the same <CODE>id</CODE> value.  In other
words, for each row in <CODE>t1</CODE>, MySQL needs to do only a single lookup
in <CODE>t2</CODE>, regardless of how many rows actually match in <CODE>t2</CODE>.

<DT><CODE><CODE>range checked for each record (index map: #)</CODE></CODE>
<DD>
MySQL found no good index to use.  Instead, for each row combination in
the preceding tables, it will do a check to determine which index to use
(if any), and use it to retrieve the rows from the table.  This is not
very fast, but is faster than performing a join with no index at all.

<DT><CODE>Using filesort</CODE>
<DD>
MySQL will need to do an extra pass to find out how to retrieve
the rows in sorted order.  The sort is done by going through all rows
according to the join type and storing the sort key and pointer to
the row for all rows that match the <CODE>WHERE</CODE> clause. The keys then are
sorted and the rows are retrieved in sorted order.

<DT><CODE>Using index</CODE>
<DD>
The column information is retrieved from the table using only
information in the index tree without having to do an additional seek to
read the actual row.  This strategy can be used when the query uses only
columns that are part of a single index.

<DT><CODE>Using temporary</CODE>
<DD>
To resolve the query, MySQL will need to create a temporary table to hold
the result.  This typically happens if the query contains <CODE>GROUP BY</CODE>
and <CODE>ORDER BY</CODE> clauses that list columns differently.

<DT><CODE>Using where</CODE>
<DD>
A <CODE>WHERE</CODE> clause will be used to restrict which rows to match
against the next table or send to the client. Unless you specifically intend
to fetch or examine all rows from the table, you may have something wrong
in your query if the <CODE>Extra</CODE> value is not <CODE>Using where</CODE>
and the table join type is <CODE>ALL</CODE> or <CODE>index</CODE>.
</DL>

If you want to make your queries as fast as possible, you should look out for
<CODE>Extra</CODE> values of <CODE>Using filesort</CODE> and <CODE>Using temporary</CODE>.
</DL>

<P>
You can get a good indication of how good a join is by taking the
product of the values in the <CODE>rows</CODE> column of the <CODE>EXPLAIN</CODE>
output. This should tell you roughly how many rows MySQL must examine to
execute the query.  If you restrict queries with the <CODE>max_join_size</CODE>
system variable, this product also is used to determine which multiple-table
<CODE>SELECT</CODE> statements to execute.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
The following example shows how a multiple-table join can be optimized
progressively based on the information provided by <CODE>EXPLAIN</CODE>.

</P>
<P>
Suppose that you have the <CODE>SELECT</CODE> statement shown here and you plan to
examine it using <CODE>EXPLAIN</CODE>:

</P>

<PRE>
EXPLAIN SELECT tt.TicketNumber, tt.TimeIn,
            tt.ProjectReference, tt.EstimatedShipDate,
            tt.ActualShipDate, tt.ClientID,
            tt.ServiceCodes, tt.RepetitiveID,
            tt.CurrentProcess, tt.CurrentDPPerson,
            tt.RecordVolume, tt.DPPrinted, et.COUNTRY,
            et_1.COUNTRY, do.CUSTNAME
        FROM tt, et, et AS et_1, do
        WHERE tt.SubmitTime IS NULL
            AND tt.ActualPC = et.EMPLOYID
            AND tt.AssignedPC = et_1.EMPLOYID
            AND tt.ClientID = do.CUSTNMBR;
</PRE>

<P>
For this example, make the following assumptions:

</P>

<UL>
<LI>

The columns being compared have been declared as follows:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Column</STRONG> </TD><TD> <STRONG>Column Type</STRONG>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ActualPC</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>AssignedPC</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ClientID</CODE> </TD><TD> <CODE>CHAR(10)</CODE>
</TD></TR>
<TR><TD><CODE>et</CODE> </TD><TD> <CODE>EMPLOYID</CODE> </TD><TD> <CODE>CHAR(15)</CODE>
</TD></TR>
<TR><TD><CODE>do</CODE> </TD><TD> <CODE>CUSTNMBR</CODE> </TD><TD> <CODE>CHAR(15)</CODE>
</TD></TR>
</TABLE>

<LI>

The tables have the following indexes:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Table</STRONG> </TD><TD> <STRONG>Index</STRONG>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ActualPC</CODE>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>AssignedPC</CODE>
</TD></TR>
<TR><TD><CODE>tt</CODE> </TD><TD> <CODE>ClientID</CODE>
</TD></TR>
<TR><TD><CODE>et</CODE> </TD><TD> <CODE>EMPLOYID</CODE> (primary key)
</TD></TR>
<TR><TD><CODE>do</CODE> </TD><TD> <CODE>CUSTNMBR</CODE> (primary key)
</TD></TR>
</TABLE>

<LI>

The <CODE>tt.ActualPC</CODE> values are not evenly distributed.
</UL>

<P>
Initially, before any optimizations have been performed, the <CODE>EXPLAIN</CODE>
statement produces the following information:

</P>

<PRE>
table type possible_keys key  key_len ref  rows  Extra
et    ALL  PRIMARY       NULL NULL    NULL 74
do    ALL  PRIMARY       NULL NULL    NULL 2135
et_1  ALL  PRIMARY       NULL NULL    NULL 74
tt    ALL  AssignedPC,   NULL NULL    NULL 3872
           ClientID,
           ActualPC
      range checked for each record (key map: 35)
</PRE>

<P>
Because <CODE>type</CODE> is <CODE>ALL</CODE> for each table, this output indicates
that MySQL is generating a Cartesian product of all the tables; that is,
every combination of rows.  This will take quite a long time, because the
product of the number of rows in each table must be examined.  For the case
at hand, this product is <CODE>74 * 2135 * 74 * 3872 = 45,268,558,720</CODE> rows.
If the tables were bigger, you can only imagine how long it would take.

</P>
<P>
One problem here is that MySQL can use indexes on columns more efficiently
if they are declared the same. (For <CODE>ISAM</CODE> tables, indexes may not be
used at all unless the columns are declared the same.)  In this context,
<CODE>VARCHAR</CODE> and <CODE>CHAR</CODE> are the same unless they are declared as
different lengths. Because <CODE>tt.ActualPC</CODE> is declared as <CODE>CHAR(10)</CODE>
and <CODE>et.EMPLOYID</CODE> is declared as <CODE>CHAR(15)</CODE>, there is a length
mismatch.

</P>
<P>
To fix this disparity between column lengths, use <CODE>ALTER TABLE</CODE> to
lengthen <CODE>ActualPC</CODE> from 10 characters to 15 characters:

</P>

<PRE>
mysql&#62; ALTER TABLE tt MODIFY ActualPC VARCHAR(15);
</PRE>

<P>
Now <CODE>tt.ActualPC</CODE> and <CODE>et.EMPLOYID</CODE> are both <CODE>VARCHAR(15)</CODE>.
Executing the <CODE>EXPLAIN</CODE> statement again produces this result:

</P>

<PRE>
table type   possible_keys key     key_len ref         rows    Extra
tt    ALL    AssignedPC,   NULL    NULL    NULL        3872    Using
             ClientID,                                         where
             ActualPC
do    ALL    PRIMARY       NULL    NULL    NULL        2135
      range checked for each record (key map: 1)
et_1  ALL    PRIMARY       NULL    NULL    NULL        74
      range checked for each record (key map: 1)
et    eq_ref PRIMARY       PRIMARY 15      tt.ActualPC 1
</PRE>

<P>
This is not perfect, but is much better: The product of the <CODE>rows</CODE>
values is now less by a factor of 74. This version is executed in a couple
of seconds.

</P>
<P>
A second alteration can be made to eliminate the column length mismatches
for the <CODE>tt.AssignedPC = et_1.EMPLOYID</CODE> and <CODE>tt.ClientID =
do.CUSTNMBR</CODE> comparisons:

</P>

<PRE>
mysql&#62; ALTER TABLE tt MODIFY AssignedPC VARCHAR(15),
    -&#62;                MODIFY ClientID   VARCHAR(15);
</PRE>

<P>
Now <CODE>EXPLAIN</CODE> produces the output shown here:

</P>

<PRE>
table type   possible_keys key      key_len ref           rows Extra
et    ALL    PRIMARY       NULL     NULL    NULL          74
tt    ref    AssignedPC,   ActualPC 15      et.EMPLOYID   52   Using
             ClientID,                                         where
             ActualPC
et_1  eq_ref PRIMARY       PRIMARY  15      tt.AssignedPC 1
do    eq_ref PRIMARY       PRIMARY  15      tt.ClientID   1
</PRE>

<P>
This is almost as good as it can get.

</P>
<P>
The remaining problem is that, by default, MySQL assumes that values
in the <CODE>tt.ActualPC</CODE> column are evenly distributed, and that is not the
case for the <CODE>tt</CODE> table.  Fortunately, it is easy to tell MySQL
to analyze the key distribution:

</P>

<PRE>
mysql&#62; &#60;userinput&#62;ANALYZE TABLE tt;&#60;/userinput&#62;
</PRE>

<P>
Now the join is perfect, and <CODE>EXPLAIN</CODE> produces this result:

</P>

<PRE>
table type   possible_keys key     key_len ref           rows Extra
tt    ALL    AssignedPC    NULL    NULL    NULL          3872 Using
             ClientID,                                        where
             ActualPC
et    eq_ref PRIMARY       PRIMARY 15      tt.ActualPC   1
et_1  eq_ref PRIMARY       PRIMARY 15      tt.AssignedPC 1
do    eq_ref PRIMARY       PRIMARY 15      tt.ClientID   1
</PRE>

<P>
Note that the <CODE>rows</CODE> column in the output from <CODE>EXPLAIN</CODE> is an
educated guess from the MySQL join optimizer.  You should check whether the
numbers are even close to the truth.  If not, you may get better performance
by using <CODE>STRAIGHT_JOIN</CODE> in your <CODE>SELECT</CODE> statement and trying
to list the tables in a different order in the <CODE>FROM</CODE> clause.

</P>



<H3><A NAME="Estimating_performance" HREF="manual_toc.html#Estimating_performance">7.2.2  Estimating Query Performance</A></H3>

<P>
<A NAME="IDX720"></A>
<A NAME="IDX721"></A>
<A NAME="IDX722"></A>

</P>
<P>
In most cases, you can estimate the performance by counting disk seeks.
For small tables, you can usually find a row in one disk seek (because the
index is probably cached).  For bigger tables, you can estimate that,
using B-tree indexes, you will need this many seeks to find a row:
<CODE>log(row_count) / log(index_block_length / 3 * 2 /
(index_length + data_pointer_length)) +
1</CODE>.

</P>
<P>
In MySQL, an index block is usually 1024 bytes and the data
pointer is usually 4 bytes. For a 500,000-row table with an
index length of 3 bytes (medium integer), the formula indicates
<CODE>log(500,000)/log(1024/3*2/(3+4)) + 1</CODE> = <CODE>4</CODE> seeks.

</P>
<P>
This index would require storage of about 500,000 * 7 * 3/2 = 5.2MB
(assuming a typical index buffer fill ration of 2/3), so
you will probably have much of the index in memory and you will probably
need only one or two calls to read data to find the row.

</P>
<P>
For writes, however, you will need four seek requests (as above) to find
where to place the new index and normally two seeks to update the index
and write the row.

</P>
<P>
Note that the preceding discussion doesn't mean that your application
performance will slowly degenerate by log N!  As long as everything
is cached by the OS or SQL server, things will become only marginally
slower as the table gets bigger. After the data gets too big to be cached,
things will start to go much slower until your applications is only bound
by disk-seeks (which increase by log N). To avoid this, increase the key
cache size as the data grows.  For <CODE>MyISAM</CODE> tables, the key cache
size is controlled by the <CODE>key_buffer_size</CODE> system variable.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>



<H3><A NAME="SELECT_speed" HREF="manual_toc.html#SELECT_speed">7.2.3  Speed of <CODE>SELECT</CODE> Queries</A></H3>

<P>
<A NAME="IDX723"></A>

</P>
<P>
<A NAME="IDX724"></A>

</P>
<P>
In general, when you want to make a slow <CODE>SELECT ... WHERE</CODE> query
faster, the first thing to check is whether you can add an index.
All references between different tables should usually be done with
indexes. You can use the <CODE>EXPLAIN</CODE> statement to determine which
indexes are used for a <CODE>SELECT</CODE>.
See section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A> and
section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

</P>
<P>
Some general tips for speeding up queries on <CODE>MyISAM</CODE> tables:

</P>

<UL>
<LI>

To help MySQL optimize queries better, use <CODE>ANALYZE TABLE</CODE> or
run <CODE>myisamchk --analyze</CODE> on a table after it has been loaded with
data. This updates a value for each index part that indicates the average
number of rows that have the same value.  (For unique indexes, this is
always 1.)  MySQL will use this to decide which index to choose when you
join two tables based on a non-constant expression.  You can check the
result from the table analysis by using <CODE>SHOW INDEX FROM tbl_name</CODE>
and examining the <CODE>Cardinality</CODE> value.  <CODE>myisamchk --description
--verbose</CODE> shows index distribution information.

<LI>

To sort an index and data according to an index, use <CODE>myisamchk
--sort-index --sort-records=1</CODE> (if you want to sort on index 1). This is
a good way to make queries faster if you have a unique index from which
you want to read all records in order according to the index.  Note that
the first time you sort a large table this way, it may take a long time.
</UL>



<H3><A NAME="Where_optimisations" HREF="manual_toc.html#Where_optimisations">7.2.4  How MySQL Optimizes <CODE>WHERE</CODE> Clauses</A></H3>

<P>
<A NAME="IDX725"></A>

</P>
<P>
<A NAME="IDX726"></A>

</P>
<P>
This section discusses optimizations that can be made for processing
<CODE>WHERE</CODE> clauses. The examples use <CODE>SELECT</CODE> statements, but
the same optimizations apply for <CODE>WHERE</CODE> clauses in <CODE>DELETE</CODE>
and <CODE>UPDATE</CODE> statements.

</P>
<P>
Note that work on the MySQL optimizer is ongoing, so this section is
incomplete. MySQL does many optimizations, not all of which are documented
here.

</P>
<P>
Some of the optimizations performed by MySQL are listed here:

</P>

<UL>
<LI>

Removal of unnecessary parentheses:

<PRE>
   ((a AND b) AND c OR (((a AND b) AND (c AND d))))
-&#62; (a AND b AND c) OR (a AND b AND c AND d)
</PRE>

<LI>

Constant folding:

<PRE>
   (a&#60;b AND b=c) AND a=5
-&#62; b&#62;5 AND b=c AND a=5
</PRE>

<LI>

Constant condition removal (needed because of constant folding):

<PRE>
   (B&#62;=5 AND B=5) OR (B=6 AND 5=5) OR (B=7 AND 5=6)
-&#62; B=5 OR B=6
</PRE>

<LI>

Constant expressions used by indexes are evaluated only once.
<LI>

<CODE>COUNT(*)</CODE> on a single table without a <CODE>WHERE</CODE> is retrieved
directly from the table information for <CODE>MyISAM</CODE> and <CODE>HEAP</CODE> tables.
This is also done for any <CODE>NOT NULL</CODE> expression when used with only one
table.
<LI>

Early detection of invalid constant expressions. MySQL quickly
detects that some <CODE>SELECT</CODE> statements are impossible and returns no rows.
<LI>

<CODE>HAVING</CODE> is merged with <CODE>WHERE</CODE> if you don't use <CODE>GROUP BY</CODE>
or group functions (<CODE>COUNT()</CODE>, <CODE>MIN()</CODE>, and so on).
<LI>

For each table in a join, a simpler <CODE>WHERE</CODE> is constructed to get a fast
<CODE>WHERE</CODE> evaluation for the table and also to skip records as
soon as possible.
<A NAME="IDX727"></A>
<A NAME="IDX728"></A>
<LI>

All constant tables are read first before any other tables in the query.
A constant table is any of the following:

<UL>
<LI>

An empty table or a table with one row.
<LI>

A table that is used with a <CODE>WHERE</CODE> clause on a <CODE>PRIMARY KEY</CODE>
or a <CODE>UNIQUE</CODE> index, where all index parts are compared to constant
expressions and are defined as <CODE>NOT NULL</CODE>.
</UL>

All of the following tables are used as constant tables:

<PRE>
SELECT * FROM t WHERE primary_key=1;
SELECT * FROM t1,t2
    WHERE t1.primary_key=1 AND t2.primary_key=t1.id;
</PRE>

<LI>

The best join combination for joining the tables is found by trying all
possibilities. If all columns in <CODE>ORDER BY</CODE> and <CODE>GROUP
BY</CODE> clauses come from the same table, that table is preferred first when
joining.
<LI>

If there is an <CODE>ORDER BY</CODE> clause and a different <CODE>GROUP BY</CODE>
clause, or if the <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE> contains columns
from tables other than the first table in the join queue, a temporary
table is created.
<LI>

If you use <CODE>SQL_SMALL_RESULT</CODE>, MySQL uses an in-memory
temporary table.
<LI>

Each table index is queried, and the best index is used unless the optimizer
believes that it will be more efficient to use a table scan. At one time, a
scan was used based on whether the best index spanned more than 30% of the
table.  Now the optimizer is more complex and bases its estimate on
additional factors such as table size, number of rows, and I/O block size,
so a fixed percentage no longer determines the choice between using an index
or a scan.
<LI>

In some cases, MySQL can read rows from the index without even
consulting the data file.  If all columns used from the index are numeric,
only the index tree is used to resolve the query.
<LI>

Before each record is output, those that do not match the <CODE>HAVING</CODE> clause
are skipped.
</UL>

<P>
Some examples of queries that are very fast:

</P>

<PRE>
SELECT COUNT(*) FROM tbl_name;

SELECT MIN(key_part1),MAX(key_part1) FROM tbl_name;

SELECT MAX(key_part2) FROM tbl_name
    WHERE key_part1=constant;

SELECT ... FROM tbl_name
    ORDER BY key_part1,key_part2,... LIMIT 10;

SELECT ... FROM tbl_name
    ORDER BY key_part1 DESC, key_part2 DESC, ... LIMIT 10;
</PRE>

<P>
The following queries are resolved using only the index tree, assuming
that the indexed columns are numeric:

</P>

<PRE>
SELECT key_part1,key_part2 FROM tbl_name WHERE key_part1=val;

SELECT COUNT(*) FROM tbl_name
    WHERE key_part1=val1 AND key_part2=val2;

SELECT key_part2 FROM tbl_name GROUP BY key_part1;
</PRE>

<P>
The following queries use indexing to retrieve the rows in sorted
order without a separate sorting pass:

</P>

<PRE>
SELECT ... FROM tbl_name
    ORDER BY key_part1,key_part2,... ;

SELECT ... FROM tbl_name
    ORDER BY key_part1 DESC, key_part2 DESC, ... ;
</PRE>



<H3><A NAME="OR_optimizations" HREF="manual_toc.html#OR_optimizations">7.2.5  How MySQL Optimizes <CODE>OR</CODE> Clauses</A></H3>

<P>
<A NAME="IDX729"></A>
<A NAME="IDX730"></A>
<A NAME="IDX731"></A>

</P>
<P>
The <CODE>Index Merge</CODE> method is used to retrieve rows with several
<CODE>ref</CODE>, <CODE>ref_or_null</CODE>, or <CODE>range</CODE> scans and merge the
results into one.
This method is employed when the table condition is a disjunction of
conditions for which <CODE>ref</CODE>, <CODE>ref_or_null</CODE>, or <CODE>range</CODE>
could be used with different keys.

</P>
<P>
This ``join'' type optimization is new in MySQL 5.0.0, and represents
a significant change in behavior with regard to indexes, because the
<EM>old</EM> rule was that the server is only ever able to use at most
one index for each referenced table.

</P>
<P>
In <CODE>EXPLAIN</CODE> output, this method appears as <CODE>index_merge</CODE> in the
<CODE>type</CODE> column. In this case, the <CODE>key</CODE> column contains a list of
indexes used, and <CODE>key_len</CODE> contains a list of the longest key parts
for those indexes.

</P>
<P>
Examples:

</P>

<PRE>
SELECT * FROM tbl_name WHERE key_part1 = 10 OR key_part2 = 20;

SELECT * FROM tbl_name
    WHERE (key_part1 = 10 OR key_part2 = 20) AND non_key_part=30;

SELECT * FROM t1,t2
    WHERE (t1.key1 IN (1,2) OR t1.key2 LIKE 'value%')
    AND t2.key1=t1.some_col

SELECT * FROM t1,t2
    WHERE t1.key1=1
    AND (t2.key1=t1.some_col OR t2.key2=t1.some_col2)
</PRE>



<H3><A NAME="IS_NULL_optimisation" HREF="manual_toc.html#IS_NULL_optimisation">7.2.6  How MySQL Optimizes <CODE>IS NULL</CODE></A></H3>

<P>
<A NAME="IDX732"></A>
<A NAME="IDX733"></A>

</P>
<P>
MySQL can do the same optimization on <CODE>col_name IS NULL</CODE> that it can do
with <CODE>col_name = constant_value</CODE>.  For example, MySQL can use
indexes and ranges to search for <CODE>NULL</CODE> with <CODE>IS NULL</CODE>.

</P>

<PRE>
SELECT * FROM tbl_name WHERE key_col IS NULL;

SELECT * FROM tbl_name WHERE key_col &#60;=&#62; NULL;

SELECT * FROM tbl_name
    WHERE key_col=const1 OR key_col=const2 OR key_col IS NULL;
</PRE>

<P>
If a <CODE>WHERE</CODE> clause includes a <CODE>col_name IS NULL</CODE> condition for a
column that is declared as <CODE>NOT NULL</CODE>, that expression will be
optimized away.  This optimization does not occur in cases when the column
might produce <CODE>NULL</CODE> anyway; for example, if it comes from a table on
the right side of a <CODE>LEFT JOIN</CODE>.

</P>
<P>
MySQL 4.1.1 and up can additionally optimize the combination <CODE>col_name =
expr AND col_name IS NULL</CODE>, a form that is common in resolved subqueries.
<CODE>EXPLAIN</CODE> will show <CODE>ref_or_null</CODE> when this
optimization is used.

</P>
<P>
This optimization can handle one <CODE>IS NULL</CODE> for any key part.

</P>
<P>
Some examples of queries that are optimized, assuming that there is an index
on columns <CODE>a</CODE> and <CODE>b</CODE> of table <CODE>t2</CODE>:

</P>

<PRE>
SELECT * FROM t1 WHERE t1.a=expr OR t1.a IS NULL;

SELECT * FROM t1,t2 WHERE t1.a=t2.a OR t2.a IS NULL;

SELECT * FROM t1,t2
    WHERE (t1.a=t2.a OR t2.a IS NULL) AND t2.b=t1.b;

SELECT * FROM t1,t2
    WHERE t1.a=t2.a AND (t2.b=t1.b OR t2.b IS NULL);

SELECT * FROM t1,t2
    WHERE (t1.a=t2.a AND t2.a IS NULL AND ...)
    OR (t1.a=t2.a AND t2.a IS NULL AND ...);
</PRE>

<P>
<CODE>ref_or_null</CODE> works by first doing a read on the reference key,
and then a separate search for rows with a <CODE>NULL</CODE> key value.

</P>
<P>
Note that the optimization can handle only one <CODE>IS NULL</CODE> level.
In the following query, MySQL will use key lookups only on the expression
<CODE>(t1.a=t2.a AND t2.a IS NULL)</CODE> and not be able to use the key part on
<CODE>b</CODE>:

</P>

<PRE>
SELECT * FROM t1,t2
     WHERE (t1.a=t2.a AND t2.a IS NULL)
     OR (t1.b=t2.b AND t2.b IS NULL);
</PRE>



<H3><A NAME="DISTINCT_optimisation" HREF="manual_toc.html#DISTINCT_optimisation">7.2.7  How MySQL Optimizes <CODE>DISTINCT</CODE></A></H3>

<P>
<A NAME="IDX734"></A>

</P>
<P>
<A NAME="IDX735"></A>

</P>
<P>
<CODE>DISTINCT</CODE> combined with <CODE>ORDER BY</CODE> will
need a temporary table in many cases.

</P>
<P>
Note that because <CODE>DISTINCT</CODE> may use <CODE>GROUP BY</CODE>, you should be
aware of how MySQL works with columns in <CODE>ORDER BY</CODE> or <CODE>HAVING</CODE>
clauses that are not part of the selected columns.
See section <A HREF="manual.html#GROUP-BY-hidden-fields">13.9.3  <CODE>GROUP BY</CODE> with Hidden Fields</A>.

</P>
<P>
When combining <CODE>LIMIT row_count</CODE> with <CODE>DISTINCT</CODE>, MySQL stops
as soon as it finds <CODE>row_count</CODE> unique rows.

</P>
<P>
If you don't use columns from all tables named in a query, MySQL stops
scanning the not-used tables as soon as it finds the first match.
In the following case, assuming that <CODE>t1</CODE> is used before <CODE>t2</CODE>
(which you can check with <CODE>EXPLAIN</CODE>), MySQL stops reading from <CODE>t2</CODE>
(for any particular row in <CODE>t1</CODE>) when the first row in <CODE>t2</CODE>
is found:

</P>

<PRE>
SELECT DISTINCT t1.a FROM t1,t2 where t1.a=t2.a;
</PRE>



<H3><A NAME="LEFT_JOIN_optimisation" HREF="manual_toc.html#LEFT_JOIN_optimisation">7.2.8  How MySQL Optimizes <CODE>LEFT JOIN</CODE> and <CODE>RIGHT JOIN</CODE></A></H3>

<P>
<A NAME="IDX736"></A>

</P>
<P>
<A NAME="IDX737"></A>

</P>
<P>
<CODE>A LEFT JOIN B join_condition</CODE> is implemented in MySQL as follows:

</P>

<UL>
<LI>

Table <CODE>B</CODE> is set to depend on table <CODE>A</CODE> and all tables
on which <CODE>A</CODE> depends.

<LI>

Table <CODE>A</CODE> is set to depend on all tables (except <CODE>B</CODE>)
that are used in the <CODE>LEFT JOIN</CODE> condition.

<LI>

The <CODE>LEFT JOIN</CODE> condition is used to decide how to retrieve rows
from table B. (In other words, any condition in the <CODE>WHERE</CODE> clause
is not used.)

<LI>

All standard join optimizations are done, with the exception that a table is
always read after all tables on which it depends.  If there is a circular
dependence, MySQL issues an error.

<LI>

All standard <CODE>WHERE</CODE> optimizations are done.

<LI>

If there is a row in <CODE>A</CODE> that matches the <CODE>WHERE</CODE> clause, but there
is no row in <CODE>B</CODE> that matches the <CODE>ON</CODE> condition,
an extra <CODE>B</CODE> row is generated with all columns set to <CODE>NULL</CODE>.

<LI>

If you use <CODE>LEFT JOIN</CODE> to find rows that don't exist in some
table and you have the following test: <CODE>col_name IS NULL</CODE> in the
<CODE>WHERE</CODE> part, where <CODE>col_name</CODE> is a column that is declared as
<CODE>NOT NULL</CODE>, MySQL stops searching for more rows
(for a particular key combination) after it has found one row that
matches the <CODE>LEFT JOIN</CODE> condition.
</UL>

<P>
<CODE>RIGHT JOIN</CODE> is implemented analogously to <CODE>LEFT JOIN</CODE>, with the
roles of the tables reversed.

</P>
<P>
The join optimizer calculates the order in which tables should be joined.
The table read order forced by <CODE>LEFT JOIN</CODE> and <CODE>STRAIGHT JOIN</CODE>
helps the join optimizer do its work much more quickly, because there are
fewer table permutations to check.
Note that this means that if you do a query of the following type,
MySQL will do a full scan on <CODE>b</CODE> because the <CODE>LEFT JOIN</CODE> forces
it to be read before <CODE>d</CODE>:

</P>

<PRE>
SELECT *
    FROM a,b LEFT JOIN c ON (c.key=a.key) LEFT JOIN d ON (d.key=a.key)
    WHERE b.key=d.key;
</PRE>

<P>
The fix in this case is to rewrite the query as follows:

</P>

<PRE>
SELECT *
    FROM b,a LEFT JOIN c ON (c.key=a.key) LEFT JOIN d ON (d.key=a.key)
    WHERE b.key=d.key;
</PRE>

<P>
Starting from 4.0.14, MySQL does the following <CODE>LEFT JOIN</CODE> optimization:
If the <CODE>WHERE</CODE> condition is always false for the generated
<CODE>NULL</CODE> row, the <CODE>LEFT JOIN</CODE> is changed to a normal join.

</P>
<P>
For example, the <CODE>WHERE</CODE> clause would be
false in the following query
if <CODE>t2.column1</CODE> would be <CODE>NULL</CODE>:

</P>

<PRE>
SELECT * FROM t1 LEFT JOIN t2 ON (column1) WHERE t2.column2=5;
</PRE>

<P>
Therefore, it's safe to convert the query to a normal join:

</P>

<PRE>
SELECT * FROM t1,t2 WHERE t2.column2=5 AND t1.column1=t2.column1;
</PRE>

<P>
This can be made faster because MySQL can now use table <CODE>t2</CODE> before
table <CODE>t1</CODE> if this would result in a better query plan.  To force a
specific table order, use <CODE>STRAIGHT JOIN</CODE>.

</P>


<H3><A NAME="ORDER_BY_optimisation" HREF="manual_toc.html#ORDER_BY_optimisation">7.2.9  How MySQL Optimizes <CODE>ORDER BY</CODE></A></H3>

<P>
In some cases, MySQL can use an index to satisfy an <CODE>ORDER BY</CODE> or
<CODE>GROUP BY</CODE> clause without doing any extra sorting.

</P>
<P>
The index can also be used even if the <CODE>ORDER BY</CODE> doesn't match the
index exactly, as long as all the unused index parts and all the extra
are <CODE>ORDER BY</CODE> columns are constants in the <CODE>WHERE</CODE>
clause. The following queries will use the index to resolve the
<CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE> part:

</P>

<PRE>
SELECT * FROM t1 ORDER BY key_part1,key_part2,...
SELECT * FROM t1 WHERE key_part1=constant ORDER BY key_part2
SELECT * FROM t1 WHERE key_part1=constant GROUP BY key_part2
SELECT * FROM t1 ORDER BY key_part1 DESC, key_part2 DESC
SELECT * FROM t1
    WHERE key_part1=1 ORDER BY key_part1 DESC, key_part2 DESC
</PRE>

<P>
In some cases, MySQL <EM>cannot</EM> use indexes to resolve the <CODE>ORDER
BY</CODE>, although it still will use indexes to find the rows that
match the <CODE>WHERE</CODE> clause. These cases include the following:

</P>

<UL>
<LI>

You use <CODE>ORDER BY</CODE> on different keys:


<PRE>
SELECT * FROM t1 ORDER BY key1, key2;
</PRE>

<LI>

You use <CODE>ORDER BY</CODE> on non-consecutive key parts:


<PRE>
SELECT * FROM t1 WHERE key2=constant ORDER BY key_part2;
</PRE>

<LI>

You mix <CODE>ASC</CODE> and <CODE>DESC</CODE>:


<PRE>
SELECT * FROM t1 ORDER BY key_part1 DESC, key_part2 ASC;
</PRE>

<LI>

The key used to fetch the rows is not the same as the one used in
the <CODE>ORDER BY</CODE>:


<PRE>
SELECT * FROM t1 WHERE key2=constant ORDER BY key1;
</PRE>

<LI>

You are joining many tables, and the columns in the <CODE>ORDER
BY</CODE> are not all from the first non-constant table that is used to
retrieve rows. (This is the first table in the <CODE>EXPLAIN</CODE> output that
doesn't have a <CODE>const</CODE> join type.)

<LI>

You have different <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> expressions.

<LI>

The type of table index used doesn't store rows in order.  For example, this
is true for a <CODE>HASH</CODE> index in a <CODE>HEAP</CODE> table.

</UL>

<P>
In those cases where MySQL must sort the result, it uses the following
algorithm:

</P>

<OL>

<LI>

Read all rows according to key or by table scanning.
Rows that don't match the <CODE>WHERE</CODE> clause are skipped.

<LI>

Store the sort key values in a buffer. The size of the buffer is the value of
the <CODE>sort_buffer_size</CODE> system variable.

<LI>

When the buffer gets full, run a qsort (quicksort) on it and store the
result in a temporary file.  Save a pointer to the sorted block.  (If all
rows fit into the sort buffer, no temporary file is created.)

<LI>

Repeat the preceding steps until all rows have been read.

<LI>

Do a multi-merge of up to <CODE>MERGEBUFF</CODE> (7) regions to one block in
another temporary file.  Repeat until all blocks from the first file
are in the second file.

<LI>

Repeat the following until there are fewer than <CODE>MERGEBUFF2</CODE> (15)
blocks left.

<LI>

On the last multi-merge, only the pointer to the row (the last part of
the sort key) is written to a result file.

<LI>

Read the rows in sorted order by using the row pointers in the result file.
To optimize this, we read in a big block of row pointers, sort them, and use
them to read the rows in sorted order into a row buffer. The size of the
buffer is the value of the <CODE>read_rnd_buffer_size</CODE> system variable.
The code for this step is in the <TT>`sql/records.cc'</TT> source file.

</OL>

<P>
With <CODE>EXPLAIN SELECT ... ORDER BY</CODE>, you can check whether MySQL can use
indexes to resolve the query.  It cannot if you see <CODE>Using filesort</CODE> in
the <CODE>Extra</CODE> column.
See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

</P>
<P>
If you want to increase <CODE>ORDER BY</CODE> speed, first see whether you can get
MySQL to use indexes rather than an extra sorting phase. If this is not
possible, you can try the following strategies:

</P>

<UL>
<LI>

Increase the size of the <CODE>sort_buffer_size</CODE> variable.
<LI>

Increase the size of the <CODE>read_rnd_buffer_size</CODE> variable.
<LI>

Change <CODE>tmpdir</CODE> to point to a dedicated filesystem with lots of empty
space.  If you use MySQL 4.1 or later, this option accepts several paths
that are used in round-robin fashion. Paths should be separated by colon
characters (<SAMP>`:'</SAMP>) on Unix and semicolon characters (<SAMP>`;'</SAMP>) on
Windows, NetWare, and OS/2.  You can use this feature to spread the load
across several directories.  <EM>Note:</EM> The paths should be for
directories in filesystems that are located on different <EM>physical</EM>
disks, not different partitions of the same disk.

</UL>

<P>
By default, MySQL sorts all <CODE>GROUP BY col1, col2, ...</CODE> queries as if
you specified <CODE>ORDER BY col1, col2, ...</CODE> in the query as well. If you
include an <CODE>ORDER BY</CODE> clause explicitly that contains the same column
list,  MySQL optimizes it away without any speed penalty, although the sorting
still occurs.  If a query includes <CODE>GROUP BY</CODE> but you want to avoid the
overhead of sorting the result, you can suppress sorting by specifying
<CODE>ORDER BY NULL</CODE>. For example:

</P>

<PRE>
INSERT INTO foo
SELECT a, COUNT(*) FROM bar GROUP BY a ORDER BY NULL;
</PRE>



<H3><A NAME="LIMIT_optimisation" HREF="manual_toc.html#LIMIT_optimisation">7.2.10  How MySQL Optimizes <CODE>LIMIT</CODE></A></H3>

<P>
<A NAME="IDX738"></A>

</P>
<P>
<A NAME="IDX739"></A>

</P>
<P>
In some cases, MySQL will handle a query differently when you are
using <CODE>LIMIT row_count</CODE> and not using <CODE>HAVING</CODE>:

</P>

<UL>
<LI>

If you are selecting only a few rows with <CODE>LIMIT</CODE>, MySQL
uses indexes in some cases when normally it would prefer to do a
full table scan.
<LI>

If you use <CODE>LIMIT row_count</CODE> with <CODE>ORDER BY</CODE>, MySQL ends the
sorting as soon as it has found the first <CODE>row_count</CODE> lines rather
than sorting the whole table.
<LI>

When combining <CODE>LIMIT row_count</CODE> with <CODE>DISTINCT</CODE>, MySQL stops
as soon as it finds <CODE>row_count</CODE> unique rows.
<LI>

In some cases, a <CODE>GROUP BY</CODE> can be resolved by reading the key in order
(or doing a sort on the key) and then calculating summaries until the
key value changes.  In this case, <CODE>LIMIT row_count</CODE> will not calculate any
unnecessary <CODE>GROUP BY</CODE> values.
<LI>

As soon as MySQL has sent the required number of rows to the client, it
aborts the query unless you are using <CODE>SQL_CALC_FOUND_ROWS</CODE>.
<LI>

<CODE>LIMIT 0</CODE> always quickly returns an empty set.  This is useful
to check the query or to get the column types of the result columns.
<LI>

When the server uses temporary tables to resolve the query, the
<CODE>LIMIT row_count</CODE> is used to calculate how much space is required.
</UL>



<H3><A NAME="How_to_avoid_table_scan" HREF="manual_toc.html#How_to_avoid_table_scan">7.2.11  How to Avoid Table Scans</A></H3>

<P>
<A NAME="IDX740"></A>

</P>
<P>
The output from <CODE>EXPLAIN</CODE> will show <CODE>ALL</CODE> in the <CODE>type</CODE>
column when MySQL uses a table scan to resolve a query. This usually happens
under the following conditions:

</P>

<UL>
<LI>

The table is so small that it's faster to do a table scan than a key lookup.
This is a common case for tables with fewer than 10 rows and a short row length.
<LI>

There are no usable restrictions in the <CODE>ON</CODE> or <CODE>WHERE</CODE> clause
for indexed columns.
<LI>

You are comparing indexed columns with constant values and MySQL has
calculated (based on the index tree) that the constants cover too large a
part of the table and that a table scan would be faster.
See section <A HREF="manual.html#Where_optimisations">7.2.4  How MySQL Optimizes <CODE>WHERE</CODE> Clauses</A>.
<LI>

You are using a key with low cardinality (many rows match the key value)
through another column.  In this case, MySQL assumes that by using the
key it will probably do a lot of key lookups and that a table scan
would be faster.
</UL>

<P>
For small tables, a table scan often is appropriate. For large tables, try
the following techniques to avoid having the optimizer incorrectly choose
a table scan:

</P>

<UL>
<LI>

Use <CODE>ANALYZE TABLE tbl_name</CODE> to update the key distributions for the
scanned table.  See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A>.

<LI>

Use <CODE>FORCE INDEX</CODE> for the scanned table to tell MySQL that table
scans are very expensive compared to using the given index.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.


<PRE>
SELECT * FROM t1, t2 FORCE INDEX (index_for_column)
WHERE t1.col_name=t2.col_name;
</PRE>

<LI>

Start <CODE>mysqld</CODE> with the <CODE>--max-seeks-for-key=1000</CODE> option or use
<CODE>SET max_seeks_for_key=1000</CODE> to tell the optimizer to assume that no
key scan will cause more than 1,000 key seeks.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
</UL>



<H3><A NAME="Insert_speed" HREF="manual_toc.html#Insert_speed">7.2.12  Speed of <CODE>INSERT</CODE> Queries</A></H3>

<P>
<A NAME="IDX741"></A>

</P>
<P>
<A NAME="IDX742"></A>
<A NAME="IDX743"></A>

</P>
<P>
The time to insert a record is determined by the following factors,
where the numbers indicate approximate proportions:

</P>

<UL>
<LI>

Connecting:              (3)
<LI>

Sending query to server: (2)
<LI>

Parsing query:           (2)
<LI>

Inserting record:        (1 x size of record)
<LI>

Inserting indexes:       (1 x number of indexes)
<LI>

Closing:                 (1)
</UL>

<P>
This does not take into consideration the initial overhead to open tables,
which is done once for each concurrently running query.

</P>
<P>
The size of the table slows down the insertion of indexes by log N,
assuming B-tree indexes.

</P>
<P>
You can use the following methods to speed up inserts:

</P>

<UL>

<LI>

If you are inserting many rows from the same client at the same time, use
<CODE>INSERT</CODE> statements with multiple <CODE>VALUES</CODE> lists to insert several
rows at a time.  This is much faster (many times faster in some cases) than
using separate single-row <CODE>INSERT</CODE> statements.  If you are adding data
to a non-empty table, you may tune the <CODE>bulk_insert_buffer_size</CODE>
variable to make it even faster.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

<LI>

If you are inserting a lot of rows from different clients, you can get
higher speed by using the <CODE>INSERT DELAYED</CODE> statement. See section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>.

<LI>

With <CODE>MyISAM</CODE> tables you can insert rows at the same time
<CODE>SELECT</CODE> statements are running if there are no deleted rows in the
tables.

<LI>

When loading a table from a text file, use <CODE>LOAD DATA INFILE</CODE>. This
is usually 20 times faster than using a lot of <CODE>INSERT</CODE> statements.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

<LI>

With some extra work, it is possible to make <CODE>LOAD DATA INFILE</CODE> run even
faster when the table has many indexes. Use the following procedure:


<OL>

<LI>

Optionally create the table with <CODE>CREATE TABLE</CODE>.

<LI>

Execute a <CODE>FLUSH TABLES</CODE> statement or a <CODE>mysqladmin flush-tables</CODE>
command.

<LI>

Use <CODE>myisamchk --keys-used=0 -rq /path/to/db/tbl_name</CODE>. This will
remove all use of all indexes for the table.

<LI>

Insert data into the table with <CODE>LOAD DATA INFILE</CODE>. This will not
update any indexes and will therefore be very fast.

<LI>

If you are going to only read the table in the future, use <CODE>myisampack</CODE>
to make it smaller. See section <A HREF="manual.html#Compressed_format">15.1.3.3  Compressed Table Characteristics</A>.

<LI>

Re-create the indexes with <CODE>myisamchk -r -q
/path/to/db/tbl_name</CODE>. This will create the index tree in memory before
writing it to disk, which is much faster because it avoids lots of disk
seeks. The resulting index tree is also perfectly balanced.

<LI>

Execute a <CODE>FLUSH TABLES</CODE> statement or a <CODE>mysqladmin flush-tables</CODE>
command.

</OL>

Note that <CODE>LOAD DATA INFILE</CODE> also performs the preceding optimization
if you insert into an empty <CODE>MyISAM</CODE> table; the main difference is that you can let
<CODE>myisamchk</CODE> allocate much more temporary memory for the index creation
than you might want the server to allocate for index re-creation when it
executes the <CODE>LOAD DATA INFILE</CODE> statement.

As of MySQL 4.0, you can also use
<CODE>ALTER TABLE tbl_name DISABLE KEYS</CODE> instead of
<CODE>myisamchk --keys-used=0 -rq /path/to/db/tbl_name</CODE> and
<CODE>ALTER TABLE tbl_name ENABLE KEYS</CODE> instead of
<CODE>myisamchk -r -q /path/to/db/tbl_name</CODE>. This way you can also skip the
<CODE>FLUSH TABLES</CODE> steps.

<LI>

You can speed up multiple-statement <CODE>INSERT</CODE> operations that are done
with multiple statements by locking your tables:


<PRE>
LOCK TABLES a WRITE;
INSERT INTO a VALUES (1,23),(2,34),(4,33);
INSERT INTO a VALUES (8,26),(6,29);
UNLOCK TABLES;
</PRE>

A performance benefit occurs because the index buffer is flushed to disk only
onc, after all <CODE>INSERT</CODE> statements have completed. Normally there would
be as many index buffer flushes as there are different <CODE>INSERT</CODE>
statements. Explicit locking statements are not needed if you can insert
all rows with a single statement.

For transactional tables, you should use <CODE>BEGIN/COMMIT</CODE> instead of
<CODE>LOCK TABLES</CODE> to get a speedup.

Locking also lowers the total time of multiple-connection tests, although the
maximum wait time for individual connections might go up because they wait for
locks.  For example:


<PRE>
Connection 1 does 1000 inserts
Connections 2, 3, and 4 do 1 insert
Connection 5 does 1000 inserts
</PRE>

If you don't use locking, connections 2, 3, and 4 will finish before 1 and
5. If you use locking, connections 2, 3, and 4 probably will not finish
before 1 or 5, but the total time should be about 40% faster.

<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, and <CODE>DELETE</CODE> operations are very
fast in MySQL, but you will obtain better overall performance by
adding locks around everything that does more than about five inserts or
updates in a row.  If you do very many inserts in a row, you could do a
<CODE>LOCK TABLES</CODE> followed by an <CODE>UNLOCK TABLES</CODE> once in a while
(about each 1,000 rows) to allow other threads access to the table. This
would still result in a nice performance gain.

<CODE>INSERT</CODE> is still much slower for loading data than <CODE>LOAD DATA
INFILE</CODE>, even when using the strategies just outlined.

<LI>

To get some more speed for <CODE>MyISAM</CODE> tables, for both <CODE>LOAD DATA
INFILE</CODE> and <CODE>INSERT</CODE>, enlarge the key cache by increasing the
<CODE>key_buffer_size</CODE> system variable.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</UL>



<H3><A NAME="Update_speed" HREF="manual_toc.html#Update_speed">7.2.13  Speed of <CODE>UPDATE</CODE> Queries</A></H3>

<P>
Update queries are optimized as a <CODE>SELECT</CODE> query with the additional
overhead of a write. The speed of the write depends on the amount of
data being updated and the number of indexes that are updated.  Indexes that
are not changed will not be updated.

</P>
<P>
Also, another way to get fast updates is to delay updates and then do
many updates in a row later. Doing many updates in a row is much quicker
than doing one at a time if you lock the table.

</P>
<P>
Note that for a <CODE>MyISAM</CODE> table that uses dynamic record format,
updating a record to a longer total length may split the record.  If you do
this often, it is very important to use <CODE>OPTIMIZE TABLE</CODE> occasionally.
See section <A HREF="manual.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A>.

</P>



<H3><A NAME="Delete_speed" HREF="manual_toc.html#Delete_speed">7.2.14  Speed of <CODE>DELETE</CODE> Queries</A></H3>

<P>
The time to delete individual records is exactly proportional to the number
of indexes. To delete records more quickly, you can increase the size of the
key cache.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
If you want to delete all rows in the table, use <CODE>TRUNCATE TABLE
tbl_name</CODE> rather than <CODE>DELETE FROM tbl_name</CODE>.
See section <A HREF="manual.html#TRUNCATE">14.1.9  <CODE>TRUNCATE</CODE> Syntax</A>.

</P>



<H3><A NAME="Tips" HREF="manual_toc.html#Tips">7.2.15  Other Optimization Tips</A></H3>

<P>
<A NAME="IDX744"></A>
<A NAME="IDX745"></A>

</P>
<P>
This section lists a number of miscellaneous tips for improving query
processing speed:

</P>

<UL>

<LI>

Use persistent connections to the database to avoid connection
overhead. If you can't use persistent connections and you are initiating many
new connections to the database, you may want to change the value
of the <CODE>thread_cache_size</CODE> variable. See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

<LI>

Always check whether all your queries really use the indexes you have created
in the tables. In MySQL, you can do this with the <CODE>EXPLAIN</CODE>
statement. See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

<LI>

Try to avoid complex <CODE>SELECT</CODE> queries on <CODE>MyISAM</CODE> tables that are
updated frequently, to avoid problems with table locking that occur
due to contention between readers and writers.

<LI>

With <CODE>MyISAM</CODE> tables that have no deleted rows, you can insert rows at
the end at the same time another query is reading from the table.  If this
is important for you, you should consider using the table in ways that avoid
deleting rows. Another possibility is to run <CODE>OPTIMIZE TABLE</CODE> after you
have deleted a lot of rows.

<LI>

Use <CODE>ALTER TABLE ... ORDER BY expr1, expr2, ...</CODE> if you mostly
retrieve rows in <CODE>expr1, expr2, ...</CODE> order.  By using this option after
extensive changes to the table, you may be able to get higher performance.

<LI>

In some cases, it may make sense to introduce a column that is ``hashed''
based on information from other columns. If this column is short and
reasonably unique, it may be much faster than a big index on many
columns. In MySQL, it's very easy to use this extra column:


<PRE>
SELECT * FROM tbl_name
    WHERE hash_col=MD5(CONCAT(col1,col2))
    AND col1='constant' AND col2='constant';
</PRE>

<LI>

For <CODE>MyISAM</CODE> tables that change a lot, you should try to avoid all
variable-length columns (<CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, and <CODE>TEXT</CODE>). The
table will use dynamic record format if it includes even a single
variable-length column.
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<LI>

It's normally not useful to split a table into different tables just
because the rows get ``big.'' To access a row, the biggest performance
hit is the disk seek to find the first byte of the row. After finding
the data, most modern disks can read the whole row fast enough for most
applications. The only cases where it really matters to split up a table is if
it's a <CODE>MyISAM</CODE> table with dynamic record format (see above) that you can
change to a fixed record size,
or if you very often need to scan the table but do not need
most of the columns. See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<LI>

If you very often need to calculate results such as counts based on
information from a lot of rows, it's probably much
better to introduce a new table and update the counter in real time. An
update of the following form is very fast:


<PRE>
UPDATE tbl_name SET count_col=count_col+1 WHERE key_col=constant;
</PRE>

This is really important when you use MySQL storage engines such as
<CODE>MyISAM</CODE> and <CODE>ISAM</CODE> that have only table-level locking (multiple
readers / single writers). This will also give better performance with most
databases, because the row locking manager in this case will have less to do.

<LI>

If you need to collect statistics from large log tables, use summary tables
instead of scanning the entire log table. Maintaining the summaries should be
much faster than trying to calculate statistics ``live.'' It's much faster to
regenerate new summary tables from the logs when things change
(depending on business decisions) than to have to change the running
application!

<LI>

If possible, you should classify reports as ``live'' or ``statistical,''
where data needed for statistical reports is created only from summary
tables that are generated periodically from the live data.

<LI>

Take advantage of the fact that columns have default values. Insert
values explicitly only when the value to be inserted differs from the
default. This reduces the parsing that MySQL needs to do and
improves the insert speed.

<LI>

In some cases, it's convenient to pack and store data into a <CODE>BLOB</CODE>
column. In this case, you must add some extra code in your application to
pack and unpack information in the <CODE>BLOB</CODE> values, but this may save a
lot of accesses at some stage.  This is practical when you have data that
doesn't conform to a rows-and-columns table structure.

<LI>

Normally, you should try to keep all data non-redundant (what
is called "third normal form" in database theory). However, do not be
afraid to duplicate information or create summary tables if necessary
to gain more speed.

<LI>

Stored procedures or UDFs (user-defined functions) may be a good way to get
more performance for some tasks. However, if you use a database system that
does not support these capabilities, you should always have another way to
perform the same tasks, even if the alternative method is slower.

<LI>

You can always gain something by caching queries or answers in your
application and then performing many inserts or updates together.  If
your database supports table locks (like MySQL and Oracle),
this should help to ensure that the index cache is only flushed once
after all updates.

<LI>

Use <CODE>INSERT DELAYED</CODE> when you do not need to know when your
data is written. This speeds things up because many records can be written
with a single disk write.

<LI>

Use <CODE>INSERT LOW_PRIORITY</CODE> when you want to give <CODE>SELECT</CODE>
statements higher priority than your inserts.

<LI>

Use <CODE>SELECT HIGH_PRIORITY</CODE> to get retrievals that jump the
queue. That is, the <CODE>SELECT</CODE> is done even if there is another client
waiting to do a write.

<LI>

Use multiple-row <CODE>INSERT</CODE> statements to store many rows with one
SQL statement (many SQL servers support this).

<LI>

Use <CODE>LOAD DATA INFILE</CODE> to load large amounts of data. This is
faster than using <CODE>INSERT</CODE> statements.

<LI>

Use <CODE>AUTO_INCREMENT</CODE> columns to generate unique values.

<LI>

Use <CODE>OPTIMIZE TABLE</CODE> once in a while to avoid fragmentation
with <CODE>MyISAM</CODE> tables
when
using a dynamic table format.
See section <A HREF="manual.html#MyISAM_table_formats">15.1.3  <CODE>MyISAM</CODE> Table Storage Formats</A>.

<LI>

Use <CODE>HEAP</CODE> tables when possible to get more speed.
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<LI>

When using a normal Web server setup, images should be stored as
files. That is, store only a file reference in the database.  The main
reason for this is that a normal Web server is much better at caching
files than database contents, so it's much easier to get a fast
system if you are using files.

<LI>

Use in-memory tables for non-critical data that is accessed often, such as
information about the last displayed banner for users who don't have
cookies enabled in their Web browser.

<LI>

Columns with identical information in different tables should be
declared to have identical data types. Before MySQL 3.23, you
get slow joins otherwise.

Try to keep column names simple. For example, in a table named <CODE>customer</CODE>,
use a column name of <CODE>name</CODE> instead of <CODE>customer_name</CODE>. To make
your names portable to other SQL servers, you should keep them shorter than
18 characters.

<LI>

If you need really high speed, you should take a look at the low-level
interfaces for data storage that the different SQL servers support!  For
example, by accessing the MySQL <CODE>MyISAM</CODE> storage engine directly, you could
get a speed increase of two to five times compared to using the SQL interface.
To be able to do this, the data must be on the same server as
the application, and usually it should only be accessed by one process
(because external file locking is really slow).  One could eliminate these
problems by introducing low-level <CODE>MyISAM</CODE> commands in the
MySQL server (this could be one easy way to get more
performance if needed).  By carefully designing the database interface,
it should be quite easy to support this types of optimization.

<LI>

If you are using numerical data, it's faster in many cases to access
information from a database (using a live connection) than to access a text
file. Information in the database is likely to be stored in a more compact
format than in the text file, so accessing it will involve fewer disk
accesses.  You will also save code in your application because you don't
have to parse your text files to find line and column boundaries.

<LI>

Replication can provide a performance benefit for some operations. You can
distribute client retrievals among replication servers to split up the load.
To avoid slowing down the master while making backups, you can make backups
using a slave server.
See section <A HREF="manual.html#Replication">6  Replication in MySQL</A>.

<LI>

Declaring a <CODE>MyISAM</CODE> table with the <CODE>DELAY_KEY_WRITE=1</CODE> table
option makes index updates faster because they are not flushed to disk
until the table is closed.  The downside is that if something kills the
server while such a table is open, you should ensure that they are okay by
running the server with the <CODE>--myisam-recover</CODE> option, or by
running <CODE>myisamchk</CODE> before restarting the server.  (However, even in
this case, you should not lose anything by using <CODE>DELAY_KEY_WRITE</CODE>,
because the key information can always be generated from the data rows.)

</UL>



<H2><A NAME="Locking_Issues" HREF="manual_toc.html#Locking_Issues">7.3  Locking Issues</A></H2>



<H3><A NAME="Internal_locking" HREF="manual_toc.html#Internal_locking">7.3.1  Locking Methods</A></H3>

<P>
<A NAME="IDX746"></A>
<A NAME="IDX747"></A>
<A NAME="IDX748"></A>
<A NAME="IDX749"></A>
<A NAME="IDX750"></A>
<A NAME="IDX751"></A>
<A NAME="IDX752"></A>
<A NAME="IDX753"></A>
<A NAME="IDX754"></A>

</P>
<P>
Currently, MySQL supports table-level locking for <CODE>ISAM</CODE>,
<CODE>MyISAM</CODE>, and <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables, page-level locking
for <CODE>BDB</CODE> tables, and row-level locking for <CODE>InnoDB</CODE> tables.

</P>
<P>
In many cases, you can make an educated guess about which locking type is best
for an application, but generally it's very hard to say that a given
lock type is better than another. Everything depends on the application
and different parts of an application may require different lock types.

</P>
<P>
To decide whether you want to use a storage engine with row-level locking,
you will want to look at what your application does and what mix of select
and update statements it uses.  For example, most Web applications do lots
of selects, very few deletes, updates based mainly on key values, and
inserts into some specific tables.  The base MySQL <CODE>MyISAM</CODE> setup is
very well tuned for this.

</P>
<P>
Table locking in MySQL is deadlock-free for storage engines that use
table-level locking.  Deadlock avoidance is managed by always requesting all
needed locks at once at the beginning of a query and always locking the
tables in the same order.

</P>
<P>
The table-locking method MySQL uses for <CODE>WRITE</CODE> locks works as follows:

</P>

<UL>

<LI>

If there are no locks on the table, put a write lock on it.

<LI>

Otherwise, put the lock request in the write lock queue.

</UL>

<P>
The table-locking method MySQL uses for <CODE>READ</CODE> locks works as follows:

</P>

<UL>

<LI>

If there are no write locks on the table, put a read lock on it.

<LI>

Otherwise, put the lock request in the read lock queue.

</UL>

<P>
When a lock is released, the lock is made available to the threads
in the write lock queue, then to the threads in the read lock queue.

</P>
<P>
This means that if you have many updates for a table, <CODE>SELECT</CODE>
statements will wait until there are no more updates.

</P>
<P>
Starting in MySQL 3.23.33, you can analyze the table lock contention
on your system by checking the <CODE>Table_locks_waited</CODE> and
<CODE>Table_locks_immediate</CODE> status variables:

</P>

<PRE>
mysql&#62; SHOW STATUS LIKE 'Table%';
+-----------------------+---------+
| Variable_name         | Value   |
+-----------------------+---------+
| Table_locks_immediate | 1151552 |
| Table_locks_waited    | 15324   |
+-----------------------+---------+
</PRE>

<P>
<A NAME="IDX755"></A>

</P>
<P>
As of MySQL 3.23.7 (3.23.25 for Windows), you can freely mix concurrent
<CODE>INSERT</CODE> and <CODE>SELECT</CODE> statements for a <CODE>MyISAM</CODE> table without
locks if the <CODE>INSERT</CODE> statements are non-conflicting.  That is, you can
insert rows into a <CODE>MyISAM</CODE> table at the same time other clients are
reading from it.  No conflict occurs if the data file contains no free
blocks in the middle, because in that case, records always are inserted at
the end of the data file.  (Holes can result from rows having been deleted
from or updated in the middle of the table.) If there are holes, concurrent
inserts are re-enabled automatically when all holes have been filled with
new data,

</P>
<P>
If you want to do many <CODE>INSERT</CODE> and <CODE>SELECT</CODE> operations on a table
when concurrent inserts are not possible, you can insert rows in a temporary
table and update the real table with the records from the temporary table
once in a while.  This can be done with the following code:

</P>

<PRE>
mysql&#62; LOCK TABLES real_table WRITE, insert_table WRITE;
mysql&#62; INSERT INTO real_table SELECT * FROM insert_table;
mysql&#62; TRUNCATE TABLE insert_table;
mysql&#62; UNLOCK TABLES;
</PRE>

<P>
<CODE>InnoDB</CODE> uses row locks and <CODE>BDB</CODE> uses page locks. For the
<CODE>InnoDB</CODE> and <CODE>BDB</CODE> storage engines, deadlock is possible. This is
because <CODE>InnoDB</CODE> automatically acquires row locks and <CODE>BDB</CODE>
acquires page locks during the processing of SQL statements, not at the
start of the transaction.

</P>
<P>
Advantages of row-level locking:

</P>

<UL>
<LI>

Fewer lock conflicts when accessing different rows in many threads.
<LI>

Fewer changes for rollbacks.
<LI>

Makes it possible to lock a single row a long time.
</UL>

<P>
Disadvantages of row-level locking:

</P>

<UL>
<LI>

Takes more memory than page-level or table-level locks.
<LI>

Is slower than page-level or table-level locks when used on a large part of
the table because you must acquire many more locks.
<LI>

Is definitely much worse than other locks if you often do <CODE>GROUP
BY</CODE> operations on a large part of the data or if you often must scan the
entire table.
<LI>

With higher-level locks, you can also more easily support locks of
different types to tune the application, because the lock overhead is less
than for row-level locks.
</UL>

<P>
Table locks are superior to page-level or row-level locks in the
following cases:

</P>

<UL>
<LI>

Most statements for the table are reads.
<LI>

Read and updates on strict keys, where you update or delete
a row that can be fetched with a single key read:


<PRE>
UPDATE tbl_name SET column=value WHERE unique_key_col=key_value;
DELETE FROM tbl_name WHERE unique_key_col=key_value;
</PRE>

<LI>

<CODE>SELECT</CODE> combined with concurrent <CODE>INSERT</CODE> statements, and very
few <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> statements.
<LI>

Many scans or <CODE>GROUP BY</CODE> operations on the entire table without any writers.
</UL>

<P>
Options other than row-level or page-level locking:

</P>
<P>
Versioning (such as we use in MySQL for concurrent inserts) where
you can have one writer at the same time as many readers.  This means
that the database/table supports different views for the data depending
on when you started to access it. Other names for this are time travel,
copy on write, or copy on demand.

</P>
<P>
Copy on demand is in many cases much better than page-level or row-level
locking. However, the worst case does use much more memory than
when using normal locks.

</P>
<P>
Instead of using row-level locks, you can use application-level locks,
such as <CODE>GET_LOCK()</CODE> and <CODE>RELEASE_LOCK()</CODE> in MySQL. These are
advisory locks, so they work only in well-behaved applications.

</P>



<H3><A NAME="Table_locking" HREF="manual_toc.html#Table_locking">7.3.2  Table Locking Issues</A></H3>

<P>
<A NAME="IDX756"></A>

</P>
<P>
To achieve a very high lock speed, MySQL uses table locking (instead of
page, row, or column locking) for all storage engines except <CODE>InnoDB</CODE>
and <CODE>BDB</CODE>.

</P>
<P>
For <CODE>InnoDB</CODE> and <CODE>BDB</CODE> tables, MySQL only uses table locking if
you explicitly lock the table with <CODE>LOCK TABLES</CODE>.  For these table
types, we recommend you to not use <CODE>LOCK TABLES</CODE> at all, because
<CODE>InnoDB</CODE> uses automatic row-level locking and <CODE>BDB</CODE> uses
page-level locking to ensure transaction isolation.

</P>
<P>
For large tables, table locking is much better than row locking for most
applications, but there are some pitfalls.

</P>
<P>
Table locking enables many threads to read from a table at the same
time, but if a thread wants to write to a table, it must first get
exclusive access.  During the update, all other threads that want to
access this particular table must wait until the update is done.

</P>
<P>
Table updates normally are considered to be more important than table
retrievals, so they are given higher priority.  This should ensure that
updates to a table are not ``starved'' even if there is heavy <CODE>SELECT</CODE>
activity for the table.

</P>
<P>
Table locking causes problems in cases such as when
a thread is waiting because the disk is full and free space needs to become
available before the thread can proceed. In this case, all
threads that want to access the problem table will also be put in a waiting
state until more disk space is made available.

</P>
<P>
Table locking is also disadvantageous under the following scenario:

</P>

<UL>

<LI>

A client issues a <CODE>SELECT</CODE> that takes a long time to run.

<LI>

Another client then issues an <CODE>UPDATE</CODE> on the same table. This client
will wait until the <CODE>SELECT</CODE> is finished.

<LI>

Another client issues another <CODE>SELECT</CODE> statement on the same table.
Because
<CODE>UPDATE</CODE> has higher priority than <CODE>SELECT</CODE>, this <CODE>SELECT</CODE>
will wait for the <CODE>UPDATE</CODE> to finish.  It will also wait for the first
<CODE>SELECT</CODE> to finish!
</UL>

<P>
The following list describes some ways to avoid or reduce contention caused by
table locking:

</P>

<UL>
<LI>

Try to get the <CODE>SELECT</CODE> statements to run faster. You might have to
create some summary tables to do this.

<LI>

Start <CODE>mysqld</CODE> with <CODE>--low-priority-updates</CODE>.  This gives
all statements that update (modify) a table lower priority than <CODE>SELECT</CODE>
statements. In this case, the second <CODE>SELECT</CODE> statement in the preceding
scenario would execute before the <CODE>INSERT</CODE> statement, and would not need
to wait for the first <CODE>SELECT</CODE> to finish.

<LI>

You can specify that all updates issued in a specific connection should be done
with low priority by using the <CODE>SET LOW_PRIORITY_UPDATES=1</CODE> statement.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<LI>

You can give a specific <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, or <CODE>DELETE</CODE>
statement lower priority with the <CODE>LOW_PRIORITY</CODE> attribute.

<LI>

You can give a specific <CODE>SELECT</CODE> statement higher priority with the
<CODE>HIGH_PRIORITY</CODE> attribute. See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

<LI>

Starting from MySQL 3.23.7, you can start <CODE>mysqld</CODE> with a low value for
the <CODE>max_write_lock_count</CODE> system variable to force MySQL to
temporarily elevate the priority of all <CODE>SELECT</CODE> statements that are
waiting for a table after a specific number of inserts to the table occur.
This allows <CODE>READ</CODE> locks after a certain number of <CODE>WRITE</CODE> locks.

<LI>

If you have problems with <CODE>INSERT</CODE> combined with <CODE>SELECT</CODE>, switch
to using <CODE>MyISAM</CODE> tables, which support concurrent <CODE>SELECT</CODE> and
<CODE>INSERT</CODE> statements.

<LI>

If you mix inserts and deletes on the same table, <CODE>INSERT DELAYED</CODE>
may be of great help.
See section <A HREF="manual.html#INSERT_DELAYED">14.1.4.2  <CODE>INSERT DELAYED</CODE> Syntax</A>.

<LI>

If you have problems with mixed <CODE>SELECT</CODE> and <CODE>DELETE</CODE> statements,
the <CODE>LIMIT</CODE> option to <CODE>DELETE</CODE> may help.
See section <A HREF="manual.html#DELETE">14.1.1  <CODE>DELETE</CODE> Syntax</A>.

<LI>

Using <CODE>SQL_BUFFER_RESULT</CODE> with <CODE>SELECT</CODE> statements can help to
make the duration of table locks shorter.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

<LI>

You could change the locking code in <TT>`mysys/thr_lock.c'</TT> to use a
single queue.  In this case, write locks and read locks would have the same
priority, which might help some applications.

</UL>

<P>
Here are some tips about table locking in MySQL:

</P>

<UL>

<LI>

Concurrent users are not a problem if you don't mix updates with selects
that need to examine many rows in the same table.

<LI>

You can use <CODE>LOCK TABLES</CODE> to speed up things (many updates within
a single lock is much faster than updates without locks).  Splitting
table contents into separate tables may also help.

<LI>

If you encounter speed problems with table locks in MySQL, you may be able
to improve performance by converting some of your tables to <CODE>InnoDB</CODE> or
<CODE>BDB</CODE> tables.
See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>. See section <A HREF="manual.html#BDB">15.4  The <CODE>BDB</CODE> (<CODE>BerkeleyDB</CODE>) Storage Engine</A>.
</UL>



<H2><A NAME="Optimising_Database_Structure" HREF="manual_toc.html#Optimising_Database_Structure">7.4  Optimizing Database Structure</A></H2>



<H3><A NAME="Design" HREF="manual_toc.html#Design">7.4.1  Design Choices</A></H3>

<P>
<A NAME="IDX757"></A>
<A NAME="IDX758"></A>
<A NAME="IDX759"></A>

</P>
<P>
MySQL keeps row data and index data in separate files. Many (almost all)
other databases mix row and index data in the same file. We believe that the
MySQL choice is better for a very wide range of modern systems.

</P>
<P>
Another way to store the row data is to keep the information for each
column in a separate area (examples are SDBM and Focus). This will cause a
performance hit for every query that accesses more than one column. Because
this degenerates so quickly when more than one column is accessed,
we believe that this model is not good for general-purpose databases.

</P>
<P>
The more common case is that the index and data are stored together
(as in Oracle/Sybase, et al). In this case, you will find the row
information at the leaf page of the index. The good thing with this
layout is that it, in many cases, depending on how well the index is
cached, saves a disk read.  The bad things with this layout are:

</P>

<UL>
<LI>

Table scanning is much slower because you have to read through the indexes
to get at the data.
<LI>

You can't use only the index table to retrieve data for a query.
<LI>

You use more space because you must duplicate indexes from the nodes
(you can't store the row in the nodes).
<LI>

Deletes will degenerate the table over time (because indexes in nodes are
usually not updated on delete).
<LI>

It's harder to cache only the index data.
</UL>



<H3><A NAME="Data_size" HREF="manual_toc.html#Data_size">7.4.2  Make Your Data as Small as Possible</A></H3>

<P>
<A NAME="IDX760"></A>
<A NAME="IDX761"></A>
<A NAME="IDX762"></A>
<A NAME="IDX763"></A>
<A NAME="IDX764"></A>

</P>
<P>
One of the most basic optimizations is to design your tables to take as
little space on the disk as possible. This can give huge improvements
because disk reads are faster, and smaller tables normally require less main
memory while their contents are being actively processed during query
execution.  Indexing also is a smaller resource burden if done on smaller
columns.

</P>
<P>
MySQL supports a lot of different table types and row formats.  For each
table, you can decide which storage/index method to use.  Choosing the
right table format for your application may give you a big performance gain.
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
You can get better performance on a table and minimize storage space
using the techniques listed here:

</P>

<UL>
<LI>

Use the most efficient (smallest) data types possible. MySQL has
many specialized types that save disk space and memory.

<LI>

Use the smaller integer types if possible to get smaller tables. For
example, <CODE>MEDIUMINT</CODE> is often better than <CODE>INT</CODE>.

<LI>

Declare columns to be <CODE>NOT NULL</CODE> if possible. It makes everything
faster and you save one bit per column. If you really need
<CODE>NULL</CODE> in your application, you should definitely use it. Just avoid
having it on all columns by default.

<LI>

For <CODE>MyISAM</CODE> tables, if you don't have any variable-length columns
(<CODE>VARCHAR</CODE>, <CODE>TEXT</CODE>, or <CODE>BLOB</CODE> columns), a fixed-size record
format is used. This is faster but unfortunately may waste some space.
See section <A HREF="manual.html#MyISAM_table_formats">15.1.3  <CODE>MyISAM</CODE> Table Storage Formats</A>.

<LI>

The primary index of a table should be as short as possible. This makes
identification of each row easy and efficient.

<LI>

Create only the indexes that you really need. Indexes are good for
retrieval but bad when you need to store things fast. If you mostly
access a table by searching on a combination of columns, make an index
on them. The first index part should be the most used column. If you are
<EM>always</EM> using many columns, you should use the column with more
duplicates first to get better compression of the index.

<LI>

If it's very likely that a column has a unique prefix on the first number of
characters, it's better to index only this prefix. MySQL supports an index
on the leftmost part of a character column. Shorter indexes are faster not
only because they take less disk space, but also because they will give you
more hits in the index cache and thus fewer disk seeks.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

<LI>

In some circumstances, it can be beneficial to split into two a table that is
scanned very often. This is especially true if it is a dynamic
format table and it is possible to use a smaller static format table that
can be used to find the relevant rows when scanning the table.
</UL>



<H3><A NAME="Indexes" HREF="manual_toc.html#Indexes">7.4.3  Column Indexes</A></H3>

<P>
<A NAME="IDX765"></A>
<A NAME="IDX766"></A>
<A NAME="IDX767"></A>

</P>
<P>
All MySQL column types can be indexed.  Use of indexes on the
relevant columns is the best way to improve the performance of <CODE>SELECT</CODE>
operations.

</P>
<P>
The maximum number of indexes per table and the maximum index length is
defined per storage engine. See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>. All storage engines support at
least 16 indexes per table and a total index length of at least 256 bytes.
Most storage engines have higher limits.

</P>
<P>
With <CODE>col_name(length)</CODE> syntax in an index specification, you can create
an index that uses only the first <CODE>length</CODE> characters of a <CODE>CHAR</CODE>
or <CODE>VARCHAR</CODE> column. Indexing only a prefix of column values like this
can make the index file much smaller.
See section <A HREF="manual.html#Indexes">7.4.3  Column Indexes</A>.

</P>
<P>
<A NAME="IDX768"></A>
<A NAME="IDX769"></A>
<A NAME="IDX770"></A>
<A NAME="IDX771"></A>
The <CODE>MyISAM</CODE> and (as of MySQL 4.0.14) <CODE>InnoDB</CODE> storage engines also
support indexing on <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns.  When indexing
a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column, you <EM>must</EM> specify a prefix
length for the index. For example:

</P>

<PRE>
CREATE TABLE test (blob_col BLOB, INDEX(blob_col(10)));
</PRE>

<P>
Prefixes can be up to 255 bytes long (or 1000 bytes for <CODE>MyISAM</CODE>
and <CODE>InnoDB</CODE> tables as of MySQL 4.1.2).  Note that prefix limits
are measured in bytes, whereas the prefix length in <CODE>CREATE TABLE</CODE>
statements is interpreted as number of characters.  Take this into account
when specifying a prefix length for a column that uses a multi-byte
character set.

</P>
<P>
As of MySQL 3.23.23, you can also create <CODE>FULLTEXT</CODE> indexes.
They are used for full-text searches. Only the <CODE>MyISAM</CODE> table type
supports <CODE>FULLTEXT</CODE> indexes and only for <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>,
and <CODE>TEXT</CODE> columns.  Indexing always happens over the entire column and
partial (prefix) indexing is not supported. See section <A HREF="manual.html#Fulltext_Search">13.6  Full-Text Search Functions</A> for
details.

</P>
<P>
As of MySQL 4.1.0, you can create indexes on spatial column types.
Currently, spatial types are supported only by the <CODE>MyISAM</CODE> storage
engine. Spatial indexes use R-trees.

</P>
<P>
The <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) storage engine supports hash indexes.
As of MySQL 4.1.0, the engine also supports B-tree indexes.

</P>



<H3><A NAME="Multiple-column_indexes" HREF="manual_toc.html#Multiple-column_indexes">7.4.4  Multiple-Column Indexes</A></H3>

<P>
<A NAME="IDX772"></A>
<A NAME="IDX773"></A>
<A NAME="IDX774"></A>

</P>
<P>
MySQL can create indexes on multiple columns.  An index may consist of up to
15 columns. For certain column types, you can index a prefix of the column
(see section <A HREF="manual.html#Indexes">7.4.3  Column Indexes</A>).

</P>
<P>
A multiple-column index can be considered a sorted array containing values
that are created by concatenating the values of the indexed columns.

</P>
<P>
MySQL uses multiple-column indexes in such a way that queries are
fast when you specify a known quantity for the first column of the index in a
<CODE>WHERE</CODE> clause, even if you don't specify values for the other columns.

</P>
<P>
Suppose that a table has the following specification:

</P>

<PRE>
CREATE TABLE test (
    id INT NOT NULL,
    last_name CHAR(30) NOT NULL,
    first_name CHAR(30) NOT NULL,
    PRIMARY KEY (id),
    INDEX name (last_name,first_name));
</PRE>

<P>
The <CODE>name</CODE> index is an index over <CODE>last_name</CODE> and
<CODE>first_name</CODE>.  The index can be used for queries that specify
values in a known range for <CODE>last_name</CODE>, or for both <CODE>last_name</CODE>
and <CODE>first_name</CODE>.
Therefore, the <CODE>name</CODE> index will be used in the following queries:

</P>

<PRE>
SELECT * FROM test WHERE last_name='Widenius';

SELECT * FROM test
    WHERE last_name='Widenius' AND first_name='Michael';

SELECT * FROM test
    WHERE last_name='Widenius'
    AND (first_name='Michael' OR first_name='Monty');

SELECT * FROM test
    WHERE last_name='Widenius'
    AND first_name &#62;='M' AND first_name &#60; 'N';
</PRE>

<P>
However, the <CODE>name</CODE> index will <EM>not</EM> be used in the following
queries:

</P>

<PRE>
SELECT * FROM test WHERE first_name='Michael';

SELECT * FROM test
    WHERE last_name='Widenius' OR first_name='Michael';
</PRE>

<P>
The manner in which MySQL uses indexes to improve query performance is
discussed further in the next section.

</P>



<H3><A NAME="MySQL_indexes" HREF="manual_toc.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A></H3>

<P>
<A NAME="IDX775"></A>

</P>
<P>
Indexes are used to find rows with specific column values
fast. Without an index, MySQL has to start with the first record
and then read through the whole table to find the relevant
rows. The bigger the table, the more this costs. If the table has an index
for the columns in question, MySQL can quickly determine the position to
seek to in the middle of the data file without having to look at all the
data. If a table has 1,000 rows, this is at least 100 times faster than
reading sequentially. Note that if you need to access almost all 1,000
rows, it is faster to read sequentially, because that minimizes disk seeks.

</P>
<P>
Most MySQL indexes (<CODE>PRIMARY KEY</CODE>, <CODE>UNIQUE</CODE>, <CODE>INDEX</CODE>, and
<CODE>FULLTEXT</CODE>) are stored in B-trees. Exceptions are that indexes on
spatial column types use R-trees, and <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables
support hash indexes.

</P>
<P>
Strings are automatically prefix- and end-space compressed.
See section <A HREF="manual.html#CREATE_INDEX">14.2.4  <CODE>CREATE INDEX</CODE> Syntax</A>.

</P>
<P>
In general, indexes are used as described in the following discussion.
Characteristics specific to hash indexes (as used in <CODE>MEMORY</CODE> tables)
are described at the end of this section.

</P>

<UL>

<LI>

To quickly find the rows that match a <CODE>WHERE</CODE> clause.

<LI>

To eliminate rows from consideration.  If there is a choice between multiple
indexes, MySQL normally uses the index that finds the smallest number of
rows.

<LI>

To retrieve rows from other tables when performing joins.

<LI>

To find the <CODE>MIN()</CODE> or <CODE>MAX()</CODE> value for a specific indexed column
<CODE>key_col</CODE>. This is optimized by a preprocessor that checks whether you are
using <CODE>WHERE key_part_# = constant</CODE> on all key parts that occur before
<CODE>key_col</CODE> in the index.  In this case, MySQL will do a single key
lookup for each <CODE>MIN()</CODE> or <CODE>MAX()</CODE> expression and replace it
with a constant.  If all expressions are replaced with constants, the
query will return at once. For example:


<PRE>
SELECT MIN(key_part2),MAX(key_part2)
FROM tbl_name WHERE key_part1=10;
</PRE>

<LI>

To sort or group a table if the sorting or grouping is done on a leftmost
prefix of a usable key (for example, <CODE>ORDER BY key_part1, key_part2</CODE>).
 If all key parts are followed by <CODE>DESC</CODE>, the key is read in
reverse order.
See section <A HREF="manual.html#ORDER_BY_optimisation">7.2.9  How MySQL Optimizes <CODE>ORDER BY</CODE></A>.

<LI>

In some cases, a query can be optimized to retrieve values without
consulting the data rows. If a query uses only columns from a table that are
numeric and that form a leftmost prefix for some key, the selected values
may be retrieved from the index tree for greater speed:


<PRE>
SELECT key_part3 FROM tbl_name WHERE key_part1=1
</PRE>

</UL>

<P>
Suppose that you issue the following <CODE>SELECT</CODE> statement:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE col1=val1 AND col2=val2;
</PRE>

<P>
If a multiple-column index exists on <CODE>col1</CODE> and <CODE>col2</CODE>, the
appropriate rows can be fetched directly. If separate single-column
indexes exist on <CODE>col1</CODE> and <CODE>col2</CODE>, the optimizer tries to
find the most restrictive index by deciding which index will find fewer
rows and using that index to fetch the rows.

</P>
<P>
<A NAME="IDX776"></A>
<A NAME="IDX777"></A>
If the table has a multiple-column index, any leftmost prefix of the
index can be used by the optimizer to find rows. For example, if you
have a three-column index on <CODE>(col1, col2, col3)</CODE>, you have indexed
search capabilities on <CODE>(col1)</CODE>, <CODE>(col1, col2)</CODE>, and
<CODE>(col1, col2, col3)</CODE>.

</P>
<P>
MySQL can't use a partial index if the columns don't form a
leftmost prefix of the index.  Suppose that you have the <CODE>SELECT</CODE>
statements shown here:

</P>

<PRE>
SELECT * FROM tbl_name WHERE col1=val1;
SELECT * FROM tbl_name WHERE col2=val2;
SELECT * FROM tbl_name WHERE col2=val2 AND col3=val3;
</PRE>

<P>
If an index exists on <CODE>(col1, col2, col3)</CODE>, only the first of the preceding
queries uses the index. The second and third queries do involve
indexed columns, but <CODE>(col2)</CODE> and <CODE>(col2, col3)</CODE> are not
leftmost prefixes of <CODE>(col1, col2, col3)</CODE>.

</P>
<P>
An index is used for columns that you compare with the <CODE>=</CODE>, <CODE>&#62;</CODE>,
<CODE>&#62;=</CODE>, <CODE>&#60;</CODE>, <CODE>&#60;=</CODE>, or <CODE>BETWEEN</CODE> operators.

</P>
<P>
<A NAME="IDX778"></A>
<A NAME="IDX779"></A>
<A NAME="IDX780"></A>
<A NAME="IDX781"></A>
MySQL also uses indexes for <CODE>LIKE</CODE> comparisons if the argument
to <CODE>LIKE</CODE> is a constant string that doesn't start with a wildcard
character.  For example, the following <CODE>SELECT</CODE> statements use indexes:

</P>

<PRE>
SELECT * FROM tbl_name WHERE key_col LIKE 'Patrick%';
SELECT * FROM tbl_name WHERE key_col LIKE 'Pat%_ck%';
</PRE>

<P>
In the first statement, only rows with <CODE>'Patrick' &#60;= key_col &#60;
'Patricl'</CODE> are considered.  In the second statement, only rows with
<CODE>'Pat' &#60;= key_col &#60; 'Pau'</CODE> are considered.

</P>
<P>
The following <CODE>SELECT</CODE> statements will not use indexes:

<PRE>
SELECT * FROM tbl_name WHERE key_col LIKE '%Patrick%';
SELECT * FROM tbl_name WHERE key_col LIKE other_col;
</PRE>

<P>
In the first statement, the <CODE>LIKE</CODE> value begins with a wildcard
character.  In the second statement, the <CODE>LIKE</CODE> value is not a
constant.

</P>
<P>
MySQL 4.0 and up performs an additional <CODE>LIKE</CODE> optimization.  If you use
<CODE>... LIKE '%string%'</CODE> and <CODE>string</CODE> is longer than three characters,
MySQL will use the <CODE>Turbo Boyer-Moore</CODE> algorithm to initialize the
pattern for the string and then use this pattern to perform the search
quicker.

</P>
<P>
<A NAME="IDX782"></A>
<A NAME="IDX783"></A>
Searching using <CODE>col_name IS NULL</CODE> will use indexes if <CODE>col_name</CODE>
is indexed.

</P>
<P>
Any index that doesn't span all <CODE>AND</CODE> levels in the <CODE>WHERE</CODE> clause
is not used to optimize the query. In other words, to be able to use an
index, a prefix of the index must be used in every <CODE>AND</CODE> group.

</P>
<P>
The following <CODE>WHERE</CODE> clauses use indexes:

<PRE>
... WHERE index_part1=1 AND index_part2=2 AND other_column=3
    /* index = 1 OR index = 2 */
... WHERE index=1 OR A=10 AND index=2
    /* optimized like "index_part1='hello'" */
... WHERE index_part1='hello' AND index_part3=5
    /* Can use index on index1 but not on index2 or index3 */
... WHERE index1=1 AND index2=2 OR index1=3 AND index3=3;
</PRE>

<P>
These <CODE>WHERE</CODE> clauses do <EM>not</EM> use indexes:

</P>


<PRE>
    /* index_part1 is not used */
... WHERE index_part2=1 AND index_part3=2 
    /* Index is not used in both AND parts */
... WHERE index=1 OR A=10                 
    /* No index spans all rows  */
... WHERE index_part1=1 OR index_part2=10
</PRE>

<P>
Sometimes MySQL will not use an index, even if one is available.  One way
this occurs is when the optimizer estimates that using the index would
require MySQL to access a large percentage of the rows in the table.
(In this case, a table scan is probably much faster, because it will
require many fewer seeks.) However, if such a query uses <CODE>LIMIT</CODE> to
only retrieve part of the rows, MySQL will use an index anyway, because
it can much more quickly find the few rows to return in the result.

</P>
<P>
Hash indexes have somewhat different characteristics than those just
discussed:

</P>

<UL>

<LI>

They are used only for <CODE>=</CODE> or <CODE>&#60;=&#62;</CODE> comparisons (but are
<EM>very</EM> fast).

<LI>

The optimizer cannot use a hash index to speed up <CODE>ORDER BY</CODE>
operations. (This type of index cannot be used to search for the next entry
in order.)

<LI>

MySQL cannot determine approximately how many rows there
are between two values (this is used by the range optimizer to decide which
index to use).  This may affect some queries if you change a <CODE>MyISAM</CODE>
table to a <CODE>MEMORY</CODE> table.

<LI>

Only whole keys can be used to search for a row. (With a B-tree index,
any prefix of the key can be used to find rows.)

</UL>



<H3><A NAME="MyISAM_key_cache" HREF="manual_toc.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A></H3>

<P>
<A NAME="IDX784"></A>
<A NAME="IDX785"></A>

</P>

<P>
To minimize disk I/O, the <CODE>MyISAM</CODE> storage engine employs a strategy that
is used by many database management systems. It exploits a cache
mechanism to keep the most frequently accessed table blocks in memory:

</P>

<UL>
<LI>

For index blocks, a special structure called the key cache (key buffer)
is maintained. The structure contains a number of block buffers where the
most-used index blocks are placed.

<LI>

For data blocks, MySQL uses no special cache. Instead it relies on the
native operating system filesystem cache.

</UL>

<P>
This section first describes the basic operation of the <CODE>MyISAM</CODE> key
cache. Then it discusses changes made in MySQL 4.1 that improve key cache
performance and that enable you to better control cache operation:

</P>

<UL>
<LI>

Access to the key cache no longer is serialized among threads. Multiple
threads can access the cache concurrently.

<LI>

You can set up multiple key caches and assign table indexes to specific
caches.

</UL>

<P>
The key cache mechanism also is used for <CODE>ISAM</CODE> tables.  However, the
significance of this fact is on the wane.  <CODE>ISAM</CODE> table use has been
decreasing since MySQL 3.23 when <CODE>MyISAM</CODE> was introduced. MySQL 4.1
carries this trend further; the <CODE>ISAM</CODE> storage engine is disabled by
default.

</P>
<P>
You can control the size of the key cache by means of the
<CODE>key_buffer_size</CODE> system variable.  If this variable is set equal
to zero, no key cache is used.  The key cache also is not used if the
<CODE>key_buffer_size</CODE> value is too small to allocate the minimal number
of block buffers (8).

</P>
<P>
When the key cache is not operational, index files are accessed using only
the native filesystem buffering provided by the operating system.  (In other
words, table index blocks are accessed using the same strategy as that
employed for table data blocks.)

</P>
<P>
An index block is a contiguous unit of access to the <CODE>MyISAM</CODE> index files.
Usually the size of an index block is equal to the size of nodes of the
index B-tree. (Indexes are represented on disk using a B-tree data structure.
Nodes at the bottom of the tree are leaf nodes. Nodes above the leaf nodes
are non-leaf nodes.)

</P>
<P>
All block buffers in a key cache structure are the same size. This size can
be equal to, greater than, or less than the size of a table index block.
Usually one these two values is a multiple of the other.

</P>
<P>
When data from any table index block must be accessed, the server first
checks whether it is available in some block buffer of the key cache. If
it is, the server accesses data in the key cache rather than on disk.
That is, it reads from the cache or writes into it rather than reading
from or writing to disk. Otherwise, the server chooses a cache block
buffer containing a different table index block (or blocks) and replaces
the data there by a copy of required table index block.  As soon as the
new index block is in the cache, the index data can be accessed.

</P>
<P>
If it happens that a block selected for replacement has been modified,
the block is considered ``dirty.'' In this case, before being replaced, its
contents are flushed to the table index from which it came.

</P>
<P>
Usually the server follows an LRU (Least Recently Used) strategy: When
choosing a block for replacement, it selects the least recently used index
block. To be able to make such a choice easy, the key cache module maintains
a special queue (LRU chain) of all used blocks.  When a block is accessed,
it is placed at the end of the queue.  When blocks need to be replaced,
blocks at the beginning of the queue are the least recently used and become
the first candidates for eviction.

</P>



<H4><A NAME="Shared_key_cache" HREF="manual_toc.html#Shared_key_cache">7.4.6.1  Shared Key Cache Access</A></H4>

<P>
Prior to MySQL 4.1, access to the key cache is serialized:
No two threads can access key cache buffers simultaneously.
The server processes a request for an index block only after it has
finished processing the previous request. As a result, a request for an
index block not present in any key cache buffer blocks access by other
threads while a buffer is being updated to contain the requested index block.

</P>
<P>
Starting from version 4.1.0, the server supports shared access to the key
cache:

</P>

<UL>
<LI>

A buffer that is not being updated can be accessed by multiple threads.

<LI>

A buffer that is being updated causes threads that need to use it to wait
until the update is complete.

<LI>

Multiple threads can initiate requests that result in cache block
replacements, as long as they do not interfere with each other (that is,
as long as they need different index blocks, and thus cause different
cache blocks to be replaced).

</UL>

<P>
Shared access to the key cache allows the server to improve throughput
significantly.

</P>



<H4><A NAME="Multiple_key_caches" HREF="manual_toc.html#Multiple_key_caches">7.4.6.2  Multiple Key Caches</A></H4>

<P>
Shared access to the key cache improves performance but does not eliminate
contention among threads entirely. They still compete for control structures
that manage access to the key cache buffers. To reduce key cache access
contention further, MySQL 4.1.1 offers the feature of multiple key caches.
This allows you to assign different table indexes to different key caches.

</P>
<P>
When there can be multiple key caches, the server must know which cache to
use when processing queries for a given <CODE>MyISAM</CODE> table. By default, all
<CODE>MyISAM</CODE> table indexes are cached in the default key cache. To assign
table indexes to a specific key cache, use the <CODE>CACHE INDEX</CODE> statement.

</P>
<P>
For example, the following statement assigns indexes from the tables
<CODE>t1</CODE>, <CODE>t2</CODE>, and <CODE>t3</CODE> to the key cache named <CODE>hot_cache</CODE>:

</P>

<PRE>
mysql&#62; CACHE INDEX t1, t2, t3 IN hot_cache;
+---------+--------------------+----------+----------+
| Table   | Op                 | Msg_type | Msg_text |
+---------+--------------------+----------+----------+
| test.t1 | assign_to_keycache | status   | OK       |
| test.t2 | assign_to_keycache | status   | OK       |
| test.t3 | assign_to_keycache | status   | OK       |
+---------+--------------------+----------+----------+
</PRE>

<P>
<STRONG>Note:</STRONG> If the server has been built with the <CODE>ISAM</CODE> storage
engine enabled, <CODE>ISAM</CODE> tables use the key cache mechanism. However,
<CODE>ISAM</CODE> indexes use only the default key cache and cannot be reassigned to
a different cache.

</P>
<P>
The key cache referred to in a <CODE>CACHE INDEX</CODE> statement can be created
by setting its size with a <CODE>SET GLOBAL</CODE> parameter setting statement or by
using server startup options.  For example:

</P>

<PRE>
mysql&#62; SET GLOBAL keycache1.key_buffer_size=128*1024;
</PRE>

<P>
To destroy a key cache, set its size to zero:

</P>

<PRE>
mysql&#62; SET GLOBAL keycache1.key_buffer_size=0;
</PRE>

<P>
Key cache variables are structured system variables that have a name and
components. For <CODE>keycache1.key_buffer_size</CODE>, <CODE>keycache1</CODE> is the
cache variable name and <CODE>key_buffer_size</CODE> is the cache component.
See section <A HREF="manual.html#Structured_System_Variables">10.4.1  Structured System Variables</A> for a description of the syntax used
for referring to structured key cache system variables.

</P>
<P>
By default, table indexes are assigned to the main (default) key cache
created at the server startup. When a key cache is destroyed, all indexes
assigned to it are reassigned to the default key cache.

</P>
<P>
For a busy server, we recommend a strategy that uses three key caches:

</P>

<UL>

<LI>

A hot key cache that takes up 20% of the space allocated for all key
caches. This is used for tables that are heavily used for searches but that
are not updated.

<LI>

A cold key cache that takes up 20% of the space allocated for all key
caches.  This is used for medium-sized intensively modified tables,
such as temporary tables.

<LI>

A warm key cache that takes up 60% of the key cache space.  This is the
default key cache, to be used by default for all other tables.

</UL>

<P>
One reason the use of three key caches is beneficial is that access to one
key cache structure does not block access to the others.  Queries that
access tables assigned to one cache do not compete with queries that
access tables assigned to another cache.  Performance gains occur for
other reasons as well:

</P>

<UL>

<LI>

The hot cache is used only for retrieval queries, so its contents are
never modified.  Consequently, whenever an index block needs to be pulled
in from disk, the contents of the cache block chosen for replacement need
not be flushed first.

<LI>

For an index assigned to the hot cache, if there are no queries
requiring an index scan, there is a high probability that the index
blocks corresponding to non-leaf nodes of the index B-tree will remain
in the cache.

<LI>

An update operation most frequently executed for temporary tables is
performed much faster when the updated node already is in the cache and need
not be read in from disk first. If the size of the indexes of the temporary
tables are comparable with the size of cold key cache, the probability is
very high that the updated node already will be in the cache.

</UL>



<H4><A NAME="Midpoint_insertion" HREF="manual_toc.html#Midpoint_insertion">7.4.6.3  Midpoint Insertion Strategy</A></H4>

<P>
By default, the key cache management system of MySQL 4.1 uses the LRU
strategy for choosing key cache blocks to be evicted, but it also supports a
more sophisticated method called the "midpoint insertion strategy."

</P>
<P>
When using the midpoint insertion strategy, the LRU chain is divided into
two parts: a hot sub-chain and a warm sub-chain. The division point between
two parts is not fixed, but the key cache management system takes care that
the warm part is not ``too short,'' always containing at least
<CODE>key_cache_division_limit</CODE> percent of the key cache blocks.
<CODE>key_cache_division_limit</CODE> is a component of structured key cache
variables, so its value is a parameter that can be set per cache.

</P>
<P>
When an index block is read from a table into the key cache, it is placed
at the end of the warm sub-chain. After a certain number of hits (accesses
of the block), it is promoted to the hot sub-chain.  At present, the number
of hits required to promote a block (3) is the same for all index blocks.
In the future, we will allow the hit count to depend on the B-tree level
of the node corresponding to an index block: Fewer hits will be required
for promotion of an index block if it contains a non-leaf node from the
upper levels of the index B-tree than if it contains a leaf node.

</P>
<P>
A block promoted into the hot sub-chain is placed at the end of the chain.
The block then circulates within this sub-chain. If the block stays at the
beginning of the sub-chain for a long enough time, it is demoted to the warm
chain. This time is determined by the value of the
<CODE>key_cache_age_threshold</CODE> component of the key cache.

</P>
<P>
The threshold value prescribes that, for a key cache containing <CODE>N</CODE>
blocks, the block at the beginning of the hot sub-chain not accessed within
the last <CODE>N*key_cache_age_threshold/100</CODE> hits is to be moved to the
beginning of the warm sub-chain. It then becomes the first candidate for
eviction, because blocks for replacement always are taken from the beginning
of the warm sub-chain.

</P>
<P>
The midpoint insertion strategy allows you to keep more-valued blocks
always in the cache. If you prefer to use the plain LRU strategy, leave the
<CODE>key_cache_division_limit</CODE> value set to its default of 100.

</P>
<P>
The midpoint insertion strategy helps to improve performance when execution
of a query that requires an index scan effectively pushes out of the cache
all the index blocks corresponding to valuable high-level B-tree nodes. To
avoid this, you must use a midpoint insertion strategy with the
<CODE>key_cache_division_limit</CODE> set to much less than 100.  Then valuable
frequently hit nodes will be preserved in the hot sub-chain during an index
scan operation as well.

</P>



<H4><A NAME="Index_preloading" HREF="manual_toc.html#Index_preloading">7.4.6.4  Index Preloading</A></H4>

<P>
If there are enough blocks in a key cache to hold blocks of an entire
index, or at least the blocks corresponding to its non-leaf nodes, then
it makes sense to preload the key cache with index blocks before starting
to use it. Preloading allows you to put the table index blocks into a key
cache buffer in the most efficient way: by reading the index blocks from
disk sequentially.

</P>
<P>
Without preloading, the blocks still will be placed into the key cache as
needed by queries. Although the blocks will stay
in the cache, because there are enough buffers for all of them, they will be
fetched from disk in a random order, not sequentially.

</P>
<P>
To preload an index into a cache, use the <CODE>LOAD INDEX INTO CACHE</CODE>
statement. For example,
the following statement preloads nodes (index blocks) of indexes of the
tables <CODE>t1</CODE> and <CODE>t2</CODE>:

</P>

<PRE>
mysql&#62; LOAD INDEX INTO CACHE t1, t2 IGNORE LEAVES;
+---------+--------------+----------+----------+
| Table   | Op           | Msg_type | Msg_text |
+---------+--------------+----------+----------+
| test.t1 | preload_keys | status   | OK       |
| test.t2 | preload_keys | status   | OK       |
+---------+--------------+----------+----------+
</PRE>

<P>
The <CODE>IGNORE LEAVES</CODE> modifier causes only blocks for the non-leaf
nodes of the index to be preloaded. Thus,
the statement shown preloads all index blocks from <CODE>t1</CODE>, but only
blocks for the non-leaf nodes from <CODE>t2</CODE>.

</P>
<P>
If an index has been assigned to a key cache using a
<CODE>CACHE INDEX</CODE> statement, preloading places index blocks into that cache.
Otherwise, the index is loaded into the default key cache.

</P>



<H4><A NAME="Key_cache_block_size" HREF="manual_toc.html#Key_cache_block_size">7.4.6.5  Key Cache Block Size</A></H4>

<P>
MySQL 4.1 introduces a new <CODE>key_cache_block_size</CODE> variable on
a per-key cache basis. This variable specifies the size of the block
buffers for a key cache.  It is intended to allow tuning of the performance
of I/O operations for index files.

</P>
<P>
The best performance for I/O operations is achieved when the size of
read buffers is equal to the size of the native operating system I/O
buffers. But setting the size of key nodes equal to the size of the I/O buffer
does not always ensure the best overall performance. When reading the
big leaf nodes, the server pulls in a lot of unnecessary data, effectively
preventing reading other leaf nodes.

</P>
<P>
Currently, you cannot control the size of the index blocks in a table.  This
size is set by the server when the <TT>`.MYI'</TT> index file is created,
depending on the size of the keys in the indexes present in the table
definition.  In most cases, it is set equal to the I/O buffer size. In the
future, this will be changed and then <CODE>key_cache_block_size</CODE> variable
will be fully employed.

</P>



<H4><A NAME="Key_cache_restructuring" HREF="manual_toc.html#Key_cache_restructuring">7.4.6.6  Restructuring a Key Cache</A></H4>

<P>
A key cache can be restructured at any time by updating its parameter
values.  For example:

</P>

<PRE>
mysql&#62; SET GLOBAL cold_cache.key_buffer_size=4*1024*1024;
</PRE>

<P>
If you assign to either the <CODE>key_buffer_size</CODE> or
<CODE>key_cache_block_size</CODE> key cache component a value that differs from
the component's current value, the server destroys the cache's old
structure and creates a new one based on the new values.  If the cache
contains any dirty blocks, the server saves them to disk before destroying
and re-creating the cache. Restructuring does not occur if you set other key
cache parameters.

</P>
<P>
When restructuring a key cache, the server first flushes the contents of any
dirty buffers to disk. After that, the cache contents become unavailable.
However, restructuring does not block queries that need to use indexes
assigned to the cache.  Instead, the server directly accesses the table
indexes using native filesystem caching.  Filesystem caching is not as
efficient as using a key cache, so although queries will execute, a slowdown
can be anticipated.  Once the cache has been restructured, it becomes
available again for caching indexes assigned to it, and the use of filesystem
caching for the indexes ceases.

</P>



<H3><A NAME="Open_tables" HREF="manual_toc.html#Open_tables">7.4.7  How MySQL Counts Open Tables</A></H3>

<P>
<A NAME="IDX786"></A>
<A NAME="IDX787"></A>

</P>
<P>
When you execute a <CODE>mysqladmin status</CODE> command, you'll see something
like this:

</P>

<PRE>
Uptime: 426 Running threads: 1 Questions: 11082
Reloads: 1 Open tables: 12
</PRE>

<P>
The <CODE>Open tables</CODE> value of 12 can be somewhat puzzling if you have
only six tables.

</P>
<P>
MySQL is multi-threaded, so there may be many clients issuing queries for a
given table simultaneously. To minimize the problem with multiple client threads
having different states on the same table, the table is opened independently
by each concurrent thread. This takes some memory but normally increases
performance.  With <CODE>MyISAM</CODE> tables, one extra file descriptor is
required for the data file for each client that has the table open. (By
contrast, the index file descriptor is shared between all threads.) The
<CODE>ISAM</CODE> storage engine shares this behavior.

</P>
<P>
You can read more about this topic in the next section. See section <A HREF="manual.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A>.

</P>


<H3><A NAME="Table_cache" HREF="manual_toc.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A></H3>

<P>
<A NAME="IDX788"></A>

</P>
<P>
<A NAME="IDX789"></A>
<A NAME="IDX790"></A>
<A NAME="IDX791"></A>
<A NAME="IDX792"></A>
<A NAME="IDX793"></A>

</P>
<P>
The <CODE>table_cache</CODE>, <CODE>max_connections</CODE>, and <CODE>max_tmp_tables</CODE>
system variables affect the maximum number of files the server keeps open.
If you increase one or more of these values, you may run up against a limit
imposed by your operating system on the per-process number of open file
descriptors.  Many operating systems allow you to increase the open-files
limit, although the method varies widely from system to system.  Consult your
operating system documentation to determine whether it is possible to
increase the limit and how to do so.

</P>
<P>
<CODE>table_cache</CODE> is related to <CODE>max_connections</CODE>.  For example,
for 200 concurrent running connections, you should have a table cache size of
at least <CODE>200 * N</CODE>, where <CODE>N</CODE> is the maximum number of tables
in a join.  You also need to reserve some extra file descriptors for
temporary tables and files.

</P>
<P>
Make sure that your operating system can handle the number of open file
descriptors implied by the <CODE>table_cache</CODE> setting.  If
<CODE>table_cache</CODE> is set too high, MySQL may run out of file
descriptors and refuse connections, fail to perform queries, and be very
unreliable.  You also have to take into account that the <CODE>MyISAM</CODE> storage
engine needs two file descriptors for each unique open table. You can
increase the number of file descriptors available for MySQL with
the <CODE>--open-files-limit</CODE> startup option to <CODE>mysqld_safe</CODE>.
See section <A HREF="manual.html#Not_enough_file_handles">A.2.17  File Not Found</A>.

</P>
<P>
The cache of open tables will be kept at a level of <CODE>table_cache</CODE>
entries. The default value is 64; this can be changed with the
<CODE>--table_cache</CODE> option to <CODE>mysqld</CODE>.  Note that MySQL may
temporarily open even more tables to be able to execute queries.

</P>
<P>
An unused table is closed and removed from the table cache under the
following circumstances:

</P>

<UL>
<LI>

When the cache is full and a thread tries to open a table that is not in
the cache.
<LI>

When the cache contains more than <CODE>table_cache</CODE> entries and
a thread is no longer using a table.
<LI>

When a table flushing operation occurs. This happens when someone issues a
<CODE>FLUSH TABLES</CODE> statement or executes a <CODE>mysqladmin flush-tables</CODE>
or <CODE>mysqladmin refresh</CODE> command.
</UL>

<P>
When the table cache fills up, the server uses the following procedure
to locate a cache entry to use:

</P>

<UL>
<LI>

Tables that are not currently in use are released, in least recently used
order.

<LI>

If a new table needs to be opened, but the cache is full and no tables
can be released, the cache is temporarily extended as necessary.
</UL>

<P>
When the cache is in a temporarily extended state and a table goes from a used
to unused state, the table is closed and released from the cache.

</P>

<P>
A table is opened for each concurrent access. This means the table needs
to be opened twice if two threads access the same table or if a thread
accesses the table twice in the same query (for example, by joining the
table to itself).  Each concurrent open requires an entry in the table
cache. The first open of any table takes two file descriptors: one for the
data file and one for the index file.  Each additional use of the table
takes only one file descriptor, for the data file.  The index file
descriptor is shared among all threads.

</P>
<P>
If you are opening a table with the <CODE>HANDLER tbl_name OPEN</CODE>
statement, a dedicated table object is allocated for the thread.
This table object is not shared by other threads and is not closed
until the thread calls <CODE>HANDLER tbl_name CLOSE</CODE> or the thread
terminates.  When this happens, the table is put back in the table cache
(if the cache isn't full).
See section <A HREF="manual.html#HANDLER">14.1.3  <CODE>HANDLER</CODE> Syntax</A>.

</P>
<P>
You can determine whether your table cache is too small by checking the
<CODE>mysqld</CODE> status variable <CODE>Opened_tables</CODE>:

</P>

<PRE>
mysql&#62; SHOW STATUS LIKE 'Opened_tables';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| Opened_tables | 2741  |
+---------------+-------+
</PRE>

<P>
If the value is quite big, even when you haven't issued a lot of <CODE>FLUSH
TABLES</CODE> statements, you should increase your table cache size.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A> and section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>.

</P>



<H3><A NAME="Creating_many_tables" HREF="manual_toc.html#Creating_many_tables">7.4.9  Drawbacks to Creating Many Tables in the Same Database</A></H3>

<P>
<A NAME="IDX794"></A>

</P>
<P>
If you have many <CODE>MyISAM</CODE> or <CODE>ISAM</CODE> tables in a database
directory, open, close, and create operations will be slow.  If you execute
<CODE>SELECT</CODE> statements on many different tables, there will be a little
overhead when the table cache is full, because for every table that has to
be opened, another must be closed. You can reduce this overhead by making
the table cache larger.

</P>



<H2><A NAME="Optimising_the_Server" HREF="manual_toc.html#Optimising_the_Server">7.5  Optimizing the MySQL Server</A></H2>



<H3><A NAME="System" HREF="manual_toc.html#System">7.5.1  System Factors and Startup Parameter Tuning</A></H3>

<P>
<A NAME="IDX795"></A>
<A NAME="IDX796"></A>
<A NAME="IDX797"></A>

</P>
<P>
We start with system-level factors, because some of these decisions must be
made very early to achieve large performance gains. In other cases, a quick
look at this section may suffice. However, it is always nice to have a sense
of how much can be gained by changing things at this level.

</P>
<P>
The default operating system to use is very important!  To get the best
use of multiple-CPU machines, you should use Solaris (because its threads
implementation works really well) or Linux (because the 2.2 kernel has
really good SMP support).  Note that older Linux kernels have a 2GB filesize
limit by default. If you have such a kernel and a desperate need for files
larger than 2GB, you should get the Large File Support (LFS) patch for the
ext2 filesystem.  Other filesystems such as ReiserFS and XFS do not have
this 2GB limitation.

</P>
<P>
Before using MySQL in production, we advise you to test it on your intended
platform.

</P>
<P>
<A NAME="IDX798"></A>
Other tips:

<UL>

<LI>

If you have enough RAM, you could remove all swap devices. Some
operating systems will use a swap device in some contexts even if you
have free memory.

<LI>

Use the <CODE>--skip-external-locking</CODE> MySQL option to avoid external
locking.  This option is on by default as of MySQL 4.0.
Before that, it is on by default when compiling with
MIT-pthreads, because <CODE>flock()</CODE> isn't fully supported by
MIT-pthreads on all platforms.  It's also on default for Linux
because Linux file locking is not yet safe.

Note that the <CODE>--skip-external-locking</CODE> option will not affect MySQL's
functionality as long as you run only one server. Just remember to take
down the server (or lock and flush the relevant tables) before you run
<CODE>myisamchk</CODE>. On some systems this option is mandatory, because the
external locking does not work in any case.

The only case when you can't use <CODE>--skip-external-locking</CODE> is if you run
multiple MySQL <EM>servers</EM> (not clients) on the same data,
or if you run <CODE>myisamchk</CODE> to check (not repair) a table without telling
the server to flush and lock the tables first.

You can still use <CODE>LOCK TABLES</CODE> and <CODE>UNLOCK TABLES</CODE> even if you
are using <CODE>--skip-external-locking</CODE>.
</UL>



<H3><A NAME="Server_parameters" HREF="manual_toc.html#Server_parameters">7.5.2  Tuning Server Parameters</A></H3>

<P>
<A NAME="IDX799"></A>
<A NAME="IDX800"></A>
<A NAME="IDX801"></A>
<A NAME="IDX802"></A>

</P>
<P>
You can determine the default buffer sizes used by the <CODE>mysqld</CODE> server
with this command (prior to MySQL 4.1, omit <CODE>--verbose</CODE>):

</P>

<PRE>
shell&#62; mysqld --verbose --help
</PRE>

<P>
<A NAME="IDX803"></A>
<A NAME="IDX804"></A>
This command produces a list of all <CODE>mysqld</CODE> options and configurable
system variables. The output includes the default variable values and
looks something like this:

</P>

<PRE>
back_log                 current value: 5
bdb_cache_size           current value: 1048540
binlog_cache_size        current value: 32768
connect_timeout          current value: 5
delayed_insert_limit     current value: 100
delayed_insert_timeout   current value: 300
delayed_queue_size       current value: 1000
flush_time               current value: 0
interactive_timeout      current value: 28800
join_buffer_size         current value: 131072
key_buffer_size          current value: 1048540
long_query_time          current value: 10
lower_case_table_names   current value: 0
max_allowed_packet       current value: 1048576
max_binlog_cache_size    current value: 4294967295
max_connect_errors       current value: 10
max_connections          current value: 100
max_delayed_threads      current value: 20
max_heap_table_size      current value: 16777216
max_join_size            current value: 4294967295
max_sort_length          current value: 1024
max_tmp_tables           current value: 32
max_write_lock_count     current value: 4294967295
myisam_sort_buffer_size  current value: 8388608
net_buffer_length        current value: 16384
net_read_timeout         current value: 30
net_retry_count          current value: 10
net_write_timeout        current value: 60
read_buffer_size         current value: 131072
read_rnd_buffer_size     current value: 262144
slow_launch_time         current value: 2
sort_buffer              current value: 2097116
table_cache              current value: 64
thread_concurrency       current value: 10
thread_stack             current value: 131072
tmp_table_size           current value: 1048576
wait_timeout             current value: 28800
</PRE>

<P>
If there is a <CODE>mysqld</CODE> server currently running, you can see what
values it actually is using for the system variables by connecting to it and
issuing this statement:

</P>

<PRE>
mysql&#62; SHOW VARIABLES;
</PRE>

<P>
You can also see some statistical and status indicators for a running server
by issuing this statement:

</P>

<PRE>
mysql&#62; SHOW STATUS;
</PRE>

<P>
System variable and status information also can be obtained using
<CODE>mysqladmin</CODE>:

</P>

<PRE>
shell&#62; mysqladmin variables
shell&#62; mysqladmin extended-status
</PRE>

<P>
You can find a full description for all system and status variables in
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A> and section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>.

</P>
<P>
MySQL uses algorithms that are very scalable, so you can usually run with
very little memory. However, normally you will get better performance by
giving MySQL more memory.

</P>
<P>
When tuning a MySQL server, the two most important variables to configure
are <CODE>key_buffer_size</CODE> and <CODE>table_cache</CODE>.  You should first feel
confident that you have these set appropriately before trying to change
any other variables.

</P>
<P>
The following examples indicate some typical variable values for different
runtime configurations. The examples use the <CODE>mysqld_safe</CODE> script and
use <CODE>--var_name=value</CODE> syntax to set the variable <CODE>var_name</CODE> to the value
<CODE>value</CODE>.  This syntax is available as of MySQL 4.0.  For older versions
of MySQL, take the following differences into account:

</P>

<UL>
<LI>

Use <CODE>safe_mysqld</CODE> rather than <CODE>mysqld_safe</CODE>.

<LI>

Set variables using <CODE>--set-variable=var_name=value</CODE> or <CODE>-O
var_name=value</CODE> syntax.

<LI>

For variable names that end in <CODE>_size</CODE>, you may need to specify them
without <CODE>_size</CODE>. For example, the old name for <CODE>sort_buffer_size</CODE> is
<CODE>sort_buffer</CODE>. The old name for <CODE>read_buffer_size</CODE> is
<CODE>record_buffer</CODE>. To see which variables your version of the server
recognizes, use <CODE>mysqld --help</CODE>.

</UL>

<P>
If you have at least 256MB of memory and many tables and want maximum
performance with a moderate number of clients, you should use something
like this:

</P>

<PRE>
shell&#62; mysqld_safe --key_buffer_size=64M --table_cache=256 \
           --sort_buffer_size=4M --read_buffer_size=1M &#38;
</PRE>

<P>
If you have only 128MB of memory and only a few tables, but you still do a
lot of sorting, you can use something like this:

</P>

<PRE>
shell&#62; mysqld_safe --key_buffer_size=16M --sort_buffer_size=1M
</PRE>

<P>
If there are very many simultaneous connections, swapping problems
may occur unless <CODE>mysqld</CODE> has been configured to use very
little memory for each connection. <CODE>mysqld</CODE> performs better
if you have enough memory for all connections.

</P>
<P>
With little memory and lots of connections, use something like this:

</P>

<PRE>
shell&#62; mysqld_safe --key_buffer_size=512K --sort_buffer_size=100K \
           --read_buffer_size=100K &#38;
</PRE>

<P>
Or even this:

</P>

<PRE>
shell&#62; mysqld_safe --key_buffer_size=512K --sort_buffer_size=16K \
           --table_cache=32 --read_buffer_size=8K \
           --net_buffer_length=1K &#38;
</PRE>

<P>
If you are doing <CODE>GROUP BY</CODE> or <CODE>ORDER BY</CODE> operations on tables
that are much larger than your available memory, you should increase the
value of <CODE>read_rnd_buffer_size</CODE> to speed up the reading of rows after
sorting operations.

</P>
<P>
When you have installed MySQL, the <TT>`support-files'</TT> directory will
contain some different <TT>`my.cnf'</TT> sample files: <TT>`my-huge.cnf'</TT>,
<TT>`my-large.cnf'</TT>, <TT>`my-medium.cnf'</TT>, and <TT>`my-small.cnf'</TT>. You can
use these as a basis for optimizing your system.

</P>
<P>
Note that if you specify an option on the command line for <CODE>mysqld</CODE> or
<CODE>mysqld_safe</CODE>, it remains in effect only for that invocation of the server.
To use the option every time the server runs, put it in an option file.

</P>
<P>
To see the effects of a parameter change, do something like this (prior to
MySQL 4.1, omit <CODE>--verbose</CODE>):

</P>

<PRE>
shell&#62; mysqld --key_buffer_size=32M --verbose --help
</PRE>

<P>
The variable values are listed near the end of the output.
Make sure that the <CODE>--verbose</CODE> and <CODE>--help</CODE> options are
last. Otherwise, the effect of any options listed after them on the command
line will not be reflected in the output.

</P>
<P>
For information on tuning the <CODE>InnoDB</CODE> storage engine, see
section <A HREF="manual.html#InnoDB_tuning">16.12  <CODE>InnoDB</CODE> Performance Tuning Tips</A>.

</P>



<H3><A NAME="Compile_and_link_options" HREF="manual_toc.html#Compile_and_link_options">7.5.3  How Compiling and Linking Affects the Speed of MySQL</A></H3>

<P>
<A NAME="IDX805"></A>
<A NAME="IDX806"></A>
<A NAME="IDX807"></A>
<A NAME="IDX808"></A>

</P>
<P>
Most of the following tests were performed on Linux with the
MySQL benchmarks, but they should give some indication for
other operating systems and workloads.

</P>
<P>
You get the fastest executables when you link with <CODE>-static</CODE>.

</P>
<P>
On Linux, you will get the fastest code when compiling with <CODE>pgcc</CODE>
and <CODE>-O3</CODE>.  You need about 200MB memory to compile <TT>`sql_yacc.cc'</TT>
with these options, because <CODE>gcc/pgcc</CODE> needs a lot of memory to
make all functions inline. You should also set <CODE>CXX=gcc</CODE> when
configuring MySQL to avoid inclusion of the <CODE>libstdc++</CODE>
library, which is not needed. Note that with some versions of <CODE>pgcc</CODE>,
the resulting code will run only on true Pentium processors, even if you
use the compiler option indicating that you want the resulting code to work on
all x586-type processors (such as AMD).

</P>
<P>
By just using a better compiler and better compiler options, you can
get a 10-30% speed increase in your application.  This is particularly
important if you compile the MySQL server yourself.

</P>
<P>
We have tested both the Cygnus CodeFusion and Fujitsu compilers, but
when we tested them, neither was sufficiently bug-free to allow
MySQL to be compiled with optimizations enabled.

</P>
<P>
The standard MySQL binary distributions are compiled with support for all
character sets.  When you compile MySQL yourself, you should include support
only for the character sets that you are going to use. This is controlled by
the <CODE>--with-charset</CODE> option to <CODE>configure</CODE>.

</P>
<P>
Here is a list of some measurements that we have made:

</P>

<UL>

<LI>

If you use <CODE>pgcc</CODE> and compile everything with <CODE>-O6</CODE>, the
<CODE>mysqld</CODE> server is 1% faster than with <CODE>gcc</CODE> 2.95.2.

<LI>

If you link dynamically (without <CODE>-static</CODE>), the result is 13%
slower on Linux.  Note that you still can use a dynamically linked
MySQL library for your client applications. It is the server that is most
critical for performance.

<LI>

If you strip your <CODE>mysqld</CODE> binary with <CODE>strip mysqld</CODE>,
the resulting binary can be up to 4% faster.

<LI>

For a connection from a client to a server running on the same host,
if you connect using TCP/IP rather than a Unix socket file, performance is 7.5%
slower. (On Unix, if you connect to the hostname <CODE>localhost</CODE>,
MySQL uses a socket file by default.)

<LI>

For TCP/IP connections from a client to a server, connecting to a remote
server on another host will be 8-11% slower than connecting to the local
server on the same host, even for connections over 100Mb/s Ethernet.

<LI>

When running our benchmark tests using secure connections (all data
encrypted with internal SSL support) performance was 55% slower than for
unencrypted connections.

<LI>

If you compile with <CODE>--with-debug=full</CODE>, most queries will be 20% slower.
Some queries may take substantially longer; for example,
the MySQL benchmarks ran 35% slower.  If you use <CODE>--with-debug</CODE> (without
<CODE>=full</CODE>),
the slowdown will be only 15%.  For a version of <CODE>mysqld</CODE> that has
been compiled with <CODE>--with-debug=full</CODE>, you can disable memory
checking at runtime by starting it with the <CODE>--skip-safemalloc</CODE>
option. The execution speed should then be close to that obtained when
configuring with <CODE>--with-debug</CODE>.

<LI>

On a Sun UltraSPARC-IIe, a server compiled with Forte 5.0 is 4% faster than
one compiled with <CODE>gcc</CODE> 3.2.

<LI>

On a Sun UltraSPARC-IIe, a server compiled with Forte 5.0 is 4% faster in
32-bit mode than in 64-bit mode.

<LI>

Compiling with <CODE>gcc</CODE> 2.95.2 for UltraSPARC with the
<CODE>-mcpu=v8 -Wa,-xarch=v8plusa</CODE> options gives 4% more performance.

<LI>

On Solaris 2.5.1, MIT-pthreads is 8-12% slower than Solaris native
threads on a single processor. With more load or CPUs, the difference should
be larger.

<LI>

Compiling on Linux-x86 using <CODE>gcc</CODE> without frame pointers
(<CODE>-fomit-frame-pointer</CODE> or <CODE>-fomit-frame-pointer -ffixed-ebp</CODE>)
makes <CODE>mysqld</CODE> 1-4% faster.
</UL>

<P>
Binary MySQL distributions for Linux that are provided by MySQL AB used
to be compiled with <CODE>pgcc</CODE>. We had to go back to regular <CODE>gcc</CODE>
due to a bug in <CODE>pgcc</CODE> that would generate code that does
not run on AMD. We will continue using <CODE>gcc</CODE> until that bug is resolved.
In the meantime, if you have a non-AMD machine, you can get a faster
binary by compiling with <CODE>pgcc</CODE>.  The standard MySQL
Linux binary is linked statically to make it faster and more portable.

</P>



<H3><A NAME="Memory_use" HREF="manual_toc.html#Memory_use">7.5.4  How MySQL Uses Memory</A></H3>

<P>
<A NAME="IDX809"></A>

</P>
<P>
The following list indicates some of the ways that the <CODE>mysqld</CODE> server
uses memory.  Where applicable, the name of the system variable relevant
to the memory use is given:

</P>

<UL>
<LI>

The key buffer (variable <CODE>key_buffer_size</CODE>) is shared by all
threads; other buffers used by the server are allocated as
needed. See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

<LI>

Each connection uses some thread-specific space:


<UL>
<LI>

A stack (default 64KB, variable <CODE>thread_stack</CODE>)

<LI>

A connection buffer (variable <CODE>net_buffer_length</CODE>)

<LI>

A result buffer (variable <CODE>net_buffer_length</CODE>)

</UL>

The connection buffer and result buffer are
dynamically enlarged up to <CODE>max_allowed_packet</CODE> when needed.  While
a query is running, a copy of the current query string is also allocated.

<LI>

All threads share the same base memory.

<LI>

Only compressed <CODE>ISAM</CODE> and <CODE>MyISAM</CODE> tables are memory mapped.  This
is because the 32-bit memory space of 4GB is not large enough for most
big tables. When systems with a 64-bit address space become more
common, we may add general support for memory mapping.

<LI>

Each request that performs a sequential scan of a table allocates a read buffer
(variable <CODE>read_buffer_size</CODE>).

<LI>

When reading rows in ``random'' order (for example, after a sort), a
random-read buffer may be allocated to avoid disk seeks.
(variable <CODE>read_rnd_buffer_size</CODE>).

<LI>

All joins are done in one pass, and most joins can be done without even
using a temporary table. Most temporary tables are memory-based (<CODE>HEAP</CODE>)
tables.  Temporary tables with a large record length (calculated as the
sum of all column lengths) or that contain <CODE>BLOB</CODE> columns are
stored on disk.

One problem before MySQL 3.23.2 is that if an internal in-memory
heap table exceeds the size of <CODE>tmp_table_size</CODE>, the error <CODE>The
table tbl_name is full</CODE> occurs. From 3.23.2 on, this is handled
automatically by changing the in-memory heap table to a disk-based
<CODE>MyISAM</CODE> table as necessary. To work around this problem for older
servers, you can increase the temporary table size by setting the
<CODE>tmp_table_size</CODE> option to <CODE>mysqld</CODE>, or by setting the SQL option
<CODE>SQL_BIG_TABLES</CODE> in the client program.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

In MySQL 3.20, the maximum size of the temporary table is
<CODE>record_buffer*16</CODE>; if you are using this version, you have to increase
the value of <CODE>record_buffer</CODE>. You can also start <CODE>mysqld</CODE> with the
<CODE>--big-tables</CODE> option to always store temporary tables on disk.
However, this will affect the speed of many complicated queries.

<LI>

Most requests that perform a sort allocate a sort buffer and zero to two temporary
files depending on the result set size. See section <A HREF="manual.html#Temporary_files">A.4.4  Where MySQL Stores Temporary Files</A>.

<LI>

Almost all parsing and calculating is done in a local memory store. No
memory overhead is needed for small items, so the normal slow memory
allocation and freeing is avoided. Memory is allocated only for
unexpectedly large strings; this is done with <CODE>malloc()</CODE> and
<CODE>free()</CODE>.

<LI>

For each <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> table that is opened, the index file
is opened once and the data file is opened once for each concurrently running
thread. For each concurrent thread, a table structure, column structures for
each column, and a buffer of size <CODE>3 * N</CODE> are allocated (where <CODE>N</CODE>
is the maximum row length, not counting <CODE>BLOB</CODE> columns). A <CODE>BLOB</CODE>
column requires five to eight bytes plus the length of the <CODE>BLOB</CODE> data.
The <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> storage engines maintain one extra row
buffer for internal use.

<LI>

For each table having <CODE>BLOB</CODE> columns, a buffer is enlarged dynamically
to read in larger <CODE>BLOB</CODE> values. If you scan a table, a buffer as large
as the largest <CODE>BLOB</CODE> value is allocated.

<LI>

Handler structures for all in-use tables are saved in a cache and managed as a
FIFO. By default, the cache has 64 entries. If a table has been used by two
running threads at the same time, the cache contains two entries for the
table. See section <A HREF="manual.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A>.

<LI>

A <CODE>FLUSH TABLES</CODE> statement or  <CODE>mysqladmin flush-tables</CODE> command
closes all tables that are not in use and marks all in-use tables to be
closed when the currently executing thread finishes. This effectively frees
most in-use memory.

</UL>

<P>
<CODE>ps</CODE> and other system status programs may report that <CODE>mysqld</CODE>
uses a lot of memory. This may be caused by thread stacks on different
memory addresses. For example, the Solaris version of <CODE>ps</CODE> counts
the unused memory between stacks as used memory. You can verify this by
checking available swap with <CODE>swap -s</CODE>. We have tested
<CODE>mysqld</CODE> with several memory-leakage detectors (both commercial and open
source), so there should be no memory leaks.

</P>



<H3><A NAME="DNS" HREF="manual_toc.html#DNS">7.5.5  How MySQL Uses DNS</A></H3>

<P>
<A NAME="IDX810"></A>
<A NAME="IDX811"></A>

</P>
<P>
When a new client connects to <CODE>mysqld</CODE>, <CODE>mysqld</CODE> spawns a
new thread to handle the request.  This thread first checks whether the
hostname is in the hostname cache. If not, the thread attempts to resolve the
hostname:

</P>

<UL>
<LI>

If the operating system supports the thread-safe <CODE>gethostbyaddr_r()</CODE> and
<CODE>gethostbyname_r()</CODE> calls, the thread uses them to perform hostname
resolution.

<LI>

If the operating system doesn't support the thread-safe calls, the
thread locks a mutex and calls <CODE>gethostbyaddr()</CODE> and
<CODE>gethostbyname()</CODE> instead. In this case, no other thread
can resolve hostnames that are not in the hostname cache until the
first thread unlocks the mutex.

</UL>

<P>
You can disable DNS hostname lookups by starting <CODE>mysqld</CODE> with the
<CODE>--skip-name-resolve</CODE> option.  However, in this case, you can use only IP
numbers in the MySQL grant tables.

</P>
<P>
If you have a very slow DNS and many hosts, you can get more performance by
either disabling DNS lookups with <CODE>--skip-name-resolve</CODE> or by
increasing the <CODE>HOST_CACHE_SIZE</CODE> define (default value: 128) and
recompiling <CODE>mysqld</CODE>.

</P>
<P>
You can disable the hostname cache by starting the server with the
<CODE>--skip-host-cache</CODE> option. To clear the hostname cache, issue a
<CODE>FLUSH HOSTS</CODE> statement or execute the <CODE>mysqladmin flush-hosts</CODE>
command.

</P>
<P>
If you want to disallow TCP/IP connections entirely, start <CODE>mysqld</CODE> with
the <CODE>--skip-networking</CODE> option.

</P>



<H2><A NAME="Disk_issues" HREF="manual_toc.html#Disk_issues">7.6  Disk Issues</A></H2>

<P>
<A NAME="IDX812"></A>
<A NAME="IDX813"></A>

</P>

<UL>
<LI>

Disk seeks are a big performance bottleneck. This problem becomes more
apparent when the amount of data starts to grow so
large that effective caching becomes impossible. For large databases
where you access data more or less randomly, you can be sure that you
will need at least one disk seek to read and a couple of disk seeks to
write things. To minimize this problem, use disks with low seek times.

<LI>

Increase the number of available disk spindles (and thereby reduce
the seek overhead) by either symlinking files to different disks or striping
the disks:

<DL COMPACT>

<DT>Using symbolic links
<DD>
This means that, for <CODE>MyISAM</CODE> tables, you symlink the index file and/or
data file from their usual location in the data directory to another disk
(that may also be striped). This makes both the seek and read times better,
assuming that the disk is not used for other purposes as well. See section <A HREF="manual.html#Symbolic_links">7.6.1  Using Symbolic Links</A>.

<DT>Striping
<DD>
<A NAME="IDX814"></A>
Striping means that you have many disks and put the first block on the
first disk, the second block on the second disk, and the Nth block on the
(N mod number_of_disks) disk, and so on. This means if your normal data
size is less than the stripe size (or perfectly aligned), you will get
much better performance. Striping is very dependent on the operating system
and the stripe size, so benchmark your application with different
stripe sizes. See section <A HREF="manual.html#Custom_Benchmarks">7.1.5  Using Your Own Benchmarks</A>.

Note that the speed difference for striping is <EM>very</EM> dependent on
the parameters. Depending on how you set the striping parameters and number
of disks, you may get differences measured in orders of magnitude. Note
that you have to choose to optimize for random or sequential access.

</DL>

<LI>

For reliability you may want to use RAID 0+1 (striping plus mirroring), but
in this case, you will need 2*N drives to hold N drives of data. This is
probably the best option if you have the money for it!  However, you may
also have to invest in some volume-management software to handle it
efficiently.

<LI>

A good option is to vary the RAID level according to how critical a type of
data is. For example, store semi-important data that can be regenerated
on a RAID 0 disk, but store really important data such as host information
and logs on a RAID 0+1 or RAID N disk. RAID N can be a problem if you
have many writes, due to the time required to update the parity bits.

<LI>

On Linux, you can get much more performance by using <CODE>hdparm</CODE> to
configure your disk's interface.  (Up to 100% under load is not uncommon.)
The following <CODE>hdparm</CODE> options should be quite good for MySQL, and
probably for many other applications:


<PRE>
hdparm -m 16 -d 1
</PRE>

Note that performance and reliability when using this command depends
on your hardware, so we strongly suggest that you test your system
thoroughly after using <CODE>hdparm</CODE>.  Please consult the <CODE>hdparm</CODE>
manual page for more information.  If <CODE>hdparm</CODE> is not used wisely,
filesystem corruption may result, so back up everything before
experimenting!

<LI>

You can also set the parameters for the filesystem that the database uses:

If you don't need to know when files were last accessed (which is
not really useful on a database server), you can mount your
filesystems with the <CODE>-o noatime</CODE> option.  That skips updates
to the last access time in inodes on the filesystem, which avoids
some disk seeks.

On many operating systems, you can set a filesystem to be updated
asynchronously by mounting it with the <CODE>-o async</CODE> option.  If your
computer is reasonably stable, this should give you more performance without
sacrificing too much reliability.  (This flag is on by default on Linux.)

</UL>



<H3><A NAME="Symbolic_links" HREF="manual_toc.html#Symbolic_links">7.6.1  Using Symbolic Links</A></H3>

<P>
<A NAME="IDX815"></A>
<A NAME="IDX816"></A>

</P>
<P>
You can move tables and databases from the database directory to other
locations and replace them with symbolic links to the new locations.
You might want to do this, for example, to move a database to a file
system with more free space or increase the speed of your system by
spreading your tables to different disk.

</P>
<P>
The recommended way to do this is to just symlink databases to a
different disk. Symlink tables only as a last resort.

</P>



<H4><A NAME="Symbolic_links_to_databases" HREF="manual_toc.html#Symbolic_links_to_databases">7.6.1.1  Using Symbolic Links for Databases on Unix</A></H4>

<P>
<A NAME="IDX817"></A>

</P>
<P>
On Unix, the way to symlink a database is to first create a directory on some
disk where you have free space and then create a symlink to it from
the MySQL data directory.

</P>

<PRE>
shell&#62; mkdir /dr1/databases/test
shell&#62; ln -s /dr1/databases/test /path/to/datadir
</PRE>

<P>
MySQL doesn't support linking one directory to multiple
databases.  Replacing a database directory with a symbolic link will
work fine as long as you don't make a symbolic link between databases.
Suppose that you have a database <CODE>db1</CODE> under the MySQL data
directory, and then make a symlink <CODE>db2</CODE> that points to <CODE>db1</CODE>:

</P>

<PRE>
shell&#62; cd /path/to/datadir
shell&#62; ln -s db1 db2
</PRE>

<P>
Now, for any table <CODE>tbl_a</CODE> in <CODE>db1</CODE>, there also appears to be
a table <CODE>tbl_a</CODE> in <CODE>db2</CODE>.  If one client updates <CODE>db1.tbl_a</CODE>
and another client updates <CODE>db2.tbl_a</CODE>, there will be problems.

</P>
<P>
If you really need to do this, you can change one of the source files.
The file to modify depends on your version of MySQL. For MySQL 4.0 and up,
look for the following statement in the <TT>`mysys/my_symlink.c'</TT> file:

</P>

<PRE>
if (!(MyFlags &#38; MY_RESOLVE_LINK) || 
    (!lstat(filename,&#38;stat_buff) &#38;& S_ISLNK(stat_buff.st_mode)))
</PRE>

<P>
Before MySQL 4.0, look for this statement in the <TT>`mysys/mf_format.c'</TT> file:

</P>

<PRE>
if (flag &#38; 32 || (!lstat(to,&#38;stat_buff) &#38;& S_ISLNK(stat_buff.st_mode)))
</PRE>

<P>
Change the statement to this:

</P>

<PRE>
if (1)
</PRE>

<P>
On Windows, you can use internal symbolic links to directories by compiling
MySQL with <CODE>-DUSE_SYMDIR</CODE>. This allows you to put different
databases on different disks. See section <A HREF="manual.html#Windows_symbolic_links">7.6.1.3  Using Symbolic Links for Databases on Windows</A>.

</P>



<H4><A NAME="Symbolic_links_to_tables" HREF="manual_toc.html#Symbolic_links_to_tables">7.6.1.2  Using Symbolic Links for Tables on Unix</A></H4>

<P>
<A NAME="IDX818"></A>

</P>
<P>
Before MySQL 4.0, you should not symlink tables unless you are
<EM>very</EM> careful with them. The problem is that if you run <CODE>ALTER
TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, or <CODE>OPTIMIZE TABLE</CODE> on a symlinked
table, the symlinks will be removed and replaced by the original
files. This happens because these statements work by creating a
temporary file in the database directory and replacing the original
file with the temporary file when the statement operation is complete.

</P>
<P>
You should not symlink tables on systems that don't have a fully
working <CODE>realpath()</CODE> call. (At least Linux and Solaris support
<CODE>realpath()</CODE>). You can check whether your system supports symbolic links
by issuing a <CODE>SHOW VARIABLES LIKE 'have_symlink'</CODE> statement.

</P>
<P>
In MySQL 4.0, symlinks are fully supported only for <CODE>MyISAM</CODE>
tables.  For other table types, you will probably get strange problems
if you try to use symbolic links on files in the operating system with
any of the preceding statements.

</P>
<P>
The handling of symbolic links for <CODE>MyISAM</CODE> tables in MySQL 4.0 works
the following way:

</P>

<UL>
<LI>

In the data directory, you will always have the table definition
file, the data file, and the index file. The data file and index file
can be moved elsewhere and replaced in the data directory by
symlinks. The definition file cannot.

<LI>

You can symlink the data file and the index file independently to different
directories.

<LI>

The symlinking can be done manually from the command line with <CODE>ln -s</CODE>
if <CODE>mysqld</CODE> is not running. With SQL, you can instruct the server to
perform the symlinking by using the <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX
DIRECTORY</CODE> options to <CODE>CREATE TABLE</CODE>.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<LI>

<CODE>myisamchk</CODE> will not replace a symlink with the data file or index file.
It works directly on the file a symlink points to. Any temporary files
are created in the directory where the data file or index file is
located.

<LI>

When you drop a table that is using symlinks, both the symlink and the
file the symlink points to are dropped.  This is a good reason why you
should <EM>not</EM> run <CODE>mysqld</CODE> as <CODE>root</CODE> or allow
users to have write access to the MySQL database directories.

<LI>

If you rename a table with <CODE>ALTER TABLE ... RENAME</CODE> and you don't move
the table to another database, the symlinks in the database directory
are renamed to the new names and the data file and index file are
renamed accordingly.

<LI>

If you use <CODE>ALTER TABLE ... RENAME</CODE> to move a table to another database,
the table is moved to the other database directory. The old
symlinks and the files to which they pointed are deleted.  In other words,
the new table will not be symlinked.

<LI>

If you are not using symlinks, you should use the <CODE>--skip-symbolic-links</CODE>
option to <CODE>mysqld</CODE> to ensure that no one can use <CODE>mysqld</CODE> to drop
or rename a file outside of the data directory.
</UL>

<P>
<CODE>SHOW CREATE TABLE</CODE> doesn't report if a table has symbolic links
prior to MySQL 4.0.15. This is also true for <CODE>mysqldump</CODE>, which uses
<CODE>SHOW CREATE TABLE</CODE> to generate <CODE>CREATE TABLE</CODE> statements.

</P>
<P>
Table symlink operations that are not yet supported:

</P>
<P>
<A NAME="IDX819"></A>

<UL>
<LI>

<CODE>ALTER TABLE</CODE> ignores the <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX
DIRECTORY</CODE> table options.
<LI>

<CODE>BACKUP TABLE</CODE> and <CODE>RESTORE TABLE</CODE> don't respect symbolic
links.
<LI>

The <TT>`.frm'</TT> file must <EM>never</EM> be a symbolic link (as indicated
previously, only the data and index files can be symbolic links).  Attempting
to do this (for example, to make synonyms) will produce incorrect results.
Suppose that you have a database <CODE>db1</CODE> under the MySQL data directory,
a table <CODE>tbl1</CODE> in this database, and in the <CODE>db1</CODE> directory you
make a symlink <CODE>tbl2</CODE> that points to <CODE>tbl1</CODE>:


<PRE>
shell&#62; cd /path/to/datadir/db1
shell&#62; ln -s tbl1.frm tbl2.frm
shell&#62; ln -s tbl1.MYD tbl2.MYD
shell&#62; ln -s tbl1.MYI tbl2.MYI
</PRE>

Now there will be problems if one thread reads <CODE>db1.tbl1</CODE> and another
thread updates <CODE>db1.tbl2</CODE>:


<UL>
<LI>

The query cache will be fooled (it will believe <CODE>tbl1</CODE> has not been
updated so will return out-of-date results).
<LI>

<CODE>ALTER</CODE> statements on <CODE>tbl2</CODE> will also fail.
</UL>

</UL>



<H4><A NAME="Windows_symbolic_links" HREF="manual_toc.html#Windows_symbolic_links">7.6.1.3  Using Symbolic Links for Databases on Windows</A></H4>

<P>
<A NAME="IDX820"></A>
<A NAME="IDX821"></A>
<A NAME="IDX822"></A>

</P>
<P>
Beginning with MySQL 3.23.16, the <CODE>mysqld-max</CODE>
and <CODE>mysql-max-nt</CODE> servers for Windows are
compiled with the <CODE>-DUSE_SYMDIR</CODE> option.  This allows you to put a
database directory on a different disk by setting up a symbolic link to it.
This is similar to the way that symbolic links work on Unix, although the
procedure for setting up the link is different.

</P>
<P>
As of MySQL 4.0, symbolic links are enabled by default. If you don't need them,
you can disable them with the <CODE>skip-symbolic-links</CODE> option:

</P>

<PRE>
[mysqld]
skip-symbolic-links
</PRE>

<P>
Before MySQL 4.0, symbolic links are disabled by default. To enable them,
you should put the following entry in your <TT>`my.cnf'</TT> or <TT>`my.ini'</TT>
file:

</P>

<PRE>
[mysqld]
symbolic-links
</PRE>

<P>
On Windows, you make a symbolic link to a MySQL database by creating a file
in the data directory that contains the path to the destination directory.
The file should be named <TT>`db_name.sym'</TT>, where <CODE>db_name</CODE> is the
database name.

</P>
<P>
Suppose that the MySQL data directory is <TT>`C:\mysql\data'</TT>
and you want to have database <CODE>foo</CODE> located at <TT>`D:\data\foo'</TT>.
Set up a symlink like this:

</P>

<OL>

<LI>

Make sure that the <TT>`D:\data\foo'</TT> directory exists by creating it if
necessary.  If you
already have a database directory named <TT>`foo'</TT> in the data directory,
you should move it to <TT>`D:\data'</TT>. Otherwise, the symbolic link will be
ineffective.  To avoid problems, the server should not be running when you
move the database directory.

<LI>

Create a file <TT>`C:\mysql\data\foo.sym'</TT> that contains the pathname
<CODE>D:\data\foo\</CODE>.

</OL>

<P>
After that, all tables created in the database <CODE>foo</CODE> will be created in
<TT>`D:\data\foo'</TT>.  Note that the symbolic link will not be used if a
directory with the database name exists in the MySQL data directory.

</P>



<H1><A NAME="Client-Side_Scripts" HREF="manual_toc.html#Client-Side_Scripts">8  MySQL Client and Utility Programs</A></H1>

<P>
There are many different MySQL client programs that connect to the server to
access databases or perform administrative tasks. Other utilities are
available as well. These do not communicate with the server but perform
MySQL-related operations.

</P>
<P>
This chapter provides a brief overview of these programs and then a more
detailed description of each one.  The descriptions indicate how to invoke the
programs and the options they understand.
See section <A HREF="manual.html#Using_MySQL_Programs">4  Using MySQL Programs</A> for general information on invoking programs
and specifying program options.

</P>



<H2><A NAME="Client-Side_Overview" HREF="manual_toc.html#Client-Side_Overview">8.1  Overview of the Client-Side Scripts and Utilities</A></H2>

<P>
The following list briefly describes the MySQL client programs and utilities:

</P>

<DL COMPACT>

<DT><CODE>myisampack</CODE>
<DD>
<A NAME="IDX823"></A>
A utility that compresses <CODE>MyISAM</CODE> tables to produce smaller read-only
tables.
See section <A HREF="manual.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A>.

<DT><CODE>mysql</CODE>
<DD>
<A NAME="IDX824"></A>
The command-line tool for interactively entering SQL statements or executing
them from a file in batch mode.
See section <A HREF="manual.html#mysql">8.3  <CODE>mysql</CODE>, the Command-Line Tool</A>.

<DT><CODE>mysqlaccess</CODE>
<DD>
<A NAME="IDX825"></A>
A script that checks the access privileges for a host, user, and database
combination.

<DT><CODE>mysqladmin</CODE>
<DD>
<A NAME="IDX826"></A>
A client that performs administrative operations, such as creating or
dropping databases, reloading the grant tables, flushing tables to disk, and
reopening log files.  <CODE>mysqladmin</CODE> can also be used to retrieve version,
process, and status information from the server.
See section <A HREF="manual.html#mysqladmin">8.4  <CODE>mysqladmin</CODE>, Administering a MySQL Server</A>.

<DT><CODE>mysqlbinlog</CODE>
<DD>
<A NAME="IDX827"></A>
A utility for reading statements from a binary log. The log of executed
statements contained in the binary log files can be used to help recover
from a crash.
See section <A HREF="manual.html#mysqlbinlog">8.5  The <CODE>mysqlbinlog</CODE> Binary Log Utility</A>.

<DT><CODE>mysqlcc</CODE>
<DD>
<A NAME="IDX828"></A>
A client that provides a graphical interface for interacting with the
server.
See section <A HREF="manual.html#mysqlcc">8.6  <CODE>mysqlcc</CODE>, the MySQL Control Center</A>.

<DT><CODE>mysqlcheck</CODE>
<DD>
<A NAME="IDX829"></A>
A table-maintenance client that checks, repairs, analyzes, and optimizes
tables.
See section <A HREF="manual.html#Using_mysqlcheck">8.7  The <CODE>mysqlcheck</CODE> Table Maintenance and Repair Program</A>.

<DT><CODE>mysqldump</CODE>
<DD>
<A NAME="IDX830"></A>
A client that dumps a MySQL database into a file as SQL statements or
as tab-separated text files. Enhanced freeware originally by Igor Romanenko.
See section <A HREF="manual.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A>.

<DT><CODE>mysqlhotcopy</CODE>
<DD>
<A NAME="IDX831"></A>
A utility that quickly makes backups of <CODE>MyISAM</CODE> or <CODE>ISAM</CODE> tables
while the server is running.
See section <A HREF="manual.html#mysqlhotcopy">8.9  The <CODE>mysqlhotcopy</CODE> Database Backup Program</A>.

<DT><CODE>mysqlimport</CODE>
<DD>
<A NAME="IDX832"></A>
A client that imports text files into their respective tables using
<CODE>LOAD DATA INFILE</CODE>.
See section <A HREF="manual.html#mysqlimport">8.10  The <CODE>mysqlimport</CODE> Data Import Program</A>.

<DT><CODE>mysqlshow</CODE>
<DD>
<A NAME="IDX833"></A>
A client that displays information about databases, tables, columns,
and indexes.
See section <A HREF="manual.html#mysqlshow">8.11  <CODE>mysqlshow</CODE>, Showing Databases, Tables, and Columns</A>.

<DT><CODE>perror</CODE>
<DD>
<A NAME="IDX834"></A>
A utility that displays the meaning of system or MySQL error codes.
See section <A HREF="manual.html#perror">8.12  <CODE>perror</CODE>, Explaining Error Codes</A>.

<DT><CODE>replace</CODE>
<DD>
<A NAME="IDX835"></A>
A utility program that changes strings in place in
files or on the standard input.
See section <A HREF="manual.html#replace_utility">8.13  The <CODE>replace</CODE> String-replacement Utility</A>.

</DL>

<P>
Each MySQL program takes many different options. However, every MySQL program
provides a <CODE>--help</CODE> option that you can use to get a full description
of the program's different options. For example, try <CODE>mysql --help</CODE>.

</P>
<P>
<A NAME="IDX836"></A>

</P>
<P>
MySQL clients that communicate with the server using the
<CODE>mysqlclient</CODE> library use the following environment variables:

</P>
<P>
<A NAME="IDX837"></A>
<A NAME="IDX838"></A>
<A NAME="IDX839"></A>
<A NAME="IDX840"></A>
<A NAME="IDX841"></A>
<A NAME="IDX842"></A>
<A NAME="IDX843"></A>
<A NAME="IDX844"></A>

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>MYSQL_UNIX_PORT</CODE>
@tab The default Unix socket file; used for connections to <CODE>localhost</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TCP_PORT</CODE>
@tab The default port number; used for TCP/IP connections
</TD></TR>
<TR><TD><CODE>MYSQL_PWD</CODE>
@tab The default password
</TD></TR>
<TR><TD><CODE>MYSQL_DEBUG</CODE>
@tab Debug trace options when debugging
</TD></TR>
<TR><TD><CODE>TMPDIR</CODE>
@tab The directory where temporary tables and files are created
</TD></TR>
</TABLE>

<P>
Use of <CODE>MYSQL_PWD</CODE> is insecure.
See section <A HREF="manual.html#Password_security">5.5.6  Keeping Your Password Secure</A>.

</P>
<P>
You can override the default option values or values specified in
environment variables for all standard programs by specifying options in an
option file or on the command line.
section <A HREF="manual.html#Program_Options">4.3  Specifying Program Options</A>.

</P>



<H2><A NAME="myisampack" HREF="manual_toc.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A></H2>

<P>
<A NAME="IDX845"></A>
<A NAME="IDX846"></A>
<A NAME="IDX847"></A>
<A NAME="IDX848"></A>
<A NAME="IDX849"></A>

</P>
<P>
The <CODE>myisampack</CODE> utility compresses <CODE>MyISAM</CODE> tables.
<CODE>myisampack</CODE> works by compressing each column in the table separately.
Usually, <CODE>myisampack</CODE> packs the data file 40%-70%.

</P>
<P>
When the table is used later, the information needed to decompress columns
is read into memory.  This results in much better performance when accessing
individual records, because you only have to uncompress exactly one record,
not a much larger disk block as when using Stacker on MS-DOS.

</P>
<P>
MySQL uses <CODE>mmap()</CODE> when possible to perform memory mapping on
compressed tables. If <CODE>mmap()</CODE> doesn't work, MySQL falls back to
normal read/write file operations.

</P>
<P>
A similar utility, <CODE>pack_isam</CODE>, compresses <CODE>ISAM</CODE> tables. Because
<CODE>ISAM</CODE> tables are deprecated, this section discusses only
<CODE>myisampack</CODE>, but the general procedures for using <CODE>myisampack</CODE>
are also true for <CODE>pack_isam</CODE> unless otherwise specified.

</P>
<P>
Please note the following:

</P>

<UL>

<LI>

If the <CODE>mysqld</CODE> server was invoked with the
<CODE>--skip-external-locking</CODE> option, it is not a good idea to invoke
<CODE>myisampack</CODE> if the table might be updated during the packing process.

<LI>

After packing a table, it becomes read-only. This is generally intended
(such as when accessing packed tables on a CD). Allowing writes
to a packed table is on our TODO list, but with low priority.

<LI>

<CODE>myisampack</CODE> can pack <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns.
The older <CODE>pack_isam</CODE> program for <CODE>ISAM</CODE> tables cannot.

</UL>

<P>
Invoke <CODE>myisampack</CODE> like this:

</P>

<PRE>
shell&#62; myisampack [options] filename ...
</PRE>

<P>
Each filename should be the name of an index (<TT>`.MYI'</TT>) file.  If you
are not in the database directory, you should specify the pathname to the
file.  It is permissible to omit the <TT>`.MYI'</TT> extension.

</P>
<P>
<CODE>myisampack</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--backup, -b</CODE>
<DD>
Make a backup of the table data file using the name <TT>`tbl_name.OLD'</TT>.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--force, -f</CODE>
<DD>
Produce a packed table even if it becomes larger than the original or if
the temporary file from an earlier invocation of <CODE>myisampack</CODE> exists.
(<CODE>myisampack</CODE> creates a temporary file named <TT>`tbl_name.TMD'</TT> while
it compresses the table.  If you kill <CODE>myisampack</CODE>, the <TT>`.TMD'</TT>
file might not be deleted.)  Normally, <CODE>myisampack</CODE> exits with an
error if it finds that <TT>`tbl_name.TMD'</TT> exists.  With <CODE>--force</CODE>,
<CODE>myisampack</CODE> packs the table anyway.

<DT><CODE>--join=big_tbl_name, -j big_tbl_name</CODE>
<DD>
Join all tables named on the command line into a single table
<CODE>big_tbl_name</CODE>.  All tables that are to be combined <STRONG>must</STRONG>
have identical structure (same column names and types, same indexes,
and so forth).

<DT><CODE>--packlength=#, -p #</CODE>
<DD>
Specify the record length storage size, in bytes.  The value should be 1, 2,
or 3.  <CODE>myisampack</CODE> stores all rows with length pointers of 1, 2, or 3
bytes.  In most normal cases, <CODE>myisampack</CODE> can determine the right length
value before it begins packing the file, but it may notice during the packing
process that it could have used a shorter length. In this case,
<CODE>myisampack</CODE> will print a note that the next time you pack the same file,
you could use a shorter record length.

<DT><CODE>--silent, -s</CODE>
<DD>
Silent mode.  Write output only when errors occur.

<DT><CODE>--test, -t</CODE>
<DD>
Don't actually pack the table, just test packing it.

<DT><CODE>--tmp_dir=path, -T path</CODE>
<DD>
Use the named directory as the location in which to write the temporary table.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Write information about the progress of the packing operation
and its result.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

<DT><CODE>--wait, -w</CODE>
<DD>
Wait and retry if the table is in use.  If the <CODE>mysqld</CODE> server was
invoked with the <CODE>--skip-external-locking</CODE> option, it is not a good idea
to invoke <CODE>myisampack</CODE> if the table might be updated during the
packing process.

</DL>

<P>
<A NAME="IDX850"></A>
The following sequence of commands illustrates a typical table compression
session:

</P>

<PRE>
shell&#62; ls -l station.*
-rw-rw-r--   1 monty    my         994128 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          53248 Apr 17 19:00 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&#62; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-02-02  3:06:43
Data records:              1192  Deleted blocks:              0
Datafile parts:            1192  Deleted data:                0
Datafile pointer (bytes):     2  Keyfile pointer (bytes):     2
Max datafile length:   54657023  Max keyfile length:   33554431
Recordlength:               834
Record format: Fixed length

table description:
Key Start Len Index   Type                 Root  Blocksize    Rec/key
1   2     4   unique  unsigned long        1024       1024          1
2   32    30  multip. text                10240       1024          1

Field Start Length Type
1     1     1
2     2     4
3     6     4
4     10    1
5     11    20
6     31    1
7     32    30
8     62    35
9     97    35
10    132   35
11    167   4
12    171   16
13    187   35
14    222   4
15    226   16
16    242   20
17    262   20
18    282   20
19    302   30
20    332   4
21    336   4
22    340   1
23    341   8
24    349   8
25    357   8
26    365   2
27    367   2
28    369   4
29    373   4
30    377   1
31    378   2
32    380   8
33    388   4
34    392   4
35    396   4
36    400   4
37    404   1
38    405   4
39    409   4
40    413   4
41    417   4
42    421   4
43    425   4
44    429   20
45    449   30
46    479   1
47    480   1
48    481   79
49    560   79
50    639   79
51    718   79
52    797   8
53    805   1
54    806   1
55    807   20
56    827   4
57    831   4

shell&#62; myisampack station.MYI
Compressing station.MYI: (1192 records)
- Calculating statistics

normal:     20  empty-space:   16  empty-zero:     12  empty-fill:  11
pre-space:   0  end-space:     12  table-lookups:   5  zero:         7
Original trees:  57  After join: 17
- Compressing file
87.14%
Remember to run myisamchk -rq on compressed tables

shell&#62; ls -l station.*
-rw-rw-r--   1 monty    my         127874 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          55296 Apr 17 19:04 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&#62; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-04-17 19:04:26
Data records:               1192  Deleted blocks:              0
Datafile parts:             1192  Deleted data:                0
Datafile pointer (bytes):      3  Keyfile pointer (bytes):     1
Max datafile length:    16777215  Max keyfile length:     131071
Recordlength:                834
Record format: Compressed

table description:
Key Start Len Index   Type                 Root  Blocksize    Rec/key
1   2     4   unique  unsigned long       10240       1024          1
2   32    30  multip. text                54272       1024          1

Field Start Length Type                         Huff tree  Bits
1     1     1      constant                             1     0
2     2     4      zerofill(1)                          2     9
3     6     4      no zeros, zerofill(1)                2     9
4     10    1                                           3     9
5     11    20     table-lookup                         4     0
6     31    1                                           3     9
7     32    30     no endspace, not_always              5     9
8     62    35     no endspace, not_always, no empty    6     9
9     97    35     no empty                             7     9
10    132   35     no endspace, not_always, no empty    6     9
11    167   4      zerofill(1)                          2     9
12    171   16     no endspace, not_always, no empty    5     9
13    187   35     no endspace, not_always, no empty    6     9
14    222   4      zerofill(1)                          2     9
15    226   16     no endspace, not_always, no empty    5     9
16    242   20     no endspace, not_always              8     9
17    262   20     no endspace, no empty                8     9
18    282   20     no endspace, no empty                5     9
19    302   30     no endspace, no empty                6     9
20    332   4      always zero                          2     9
21    336   4      always zero                          2     9
22    340   1                                           3     9
23    341   8      table-lookup                         9     0
24    349   8      table-lookup                        10     0
25    357   8      always zero                          2     9
26    365   2                                           2     9
27    367   2      no zeros, zerofill(1)                2     9
28    369   4      no zeros, zerofill(1)                2     9
29    373   4      table-lookup                        11     0
30    377   1                                           3     9
31    378   2      no zeros, zerofill(1)                2     9
32    380   8      no zeros                             2     9
33    388   4      always zero                          2     9
34    392   4      table-lookup                        12     0
35    396   4      no zeros, zerofill(1)               13     9
36    400   4      no zeros, zerofill(1)                2     9
37    404   1                                           2     9
38    405   4      no zeros                             2     9
39    409   4      always zero                          2     9
40    413   4      no zeros                             2     9
41    417   4      always zero                          2     9
42    421   4      no zeros                             2     9
43    425   4      always zero                          2     9
44    429   20     no empty                             3     9
45    449   30     no empty                             3     9
46    479   1                                          14     4
47    480   1                                          14     4
48    481   79     no endspace, no empty               15     9
49    560   79     no empty                             2     9
50    639   79     no empty                             2     9
51    718   79     no endspace                         16     9
52    797   8      no empty                             2     9
53    805   1                                          17     1
54    806   1                                           3     9
55    807   20     no empty                             3     9
56    827   4      no zeros, zerofill(2)                2     9
57    831   4      no zeros, zerofill(1)                2     9
</PRE>

<P>
<CODE>myisampack</CODE> displays the following kinds of information:

</P>
<DL COMPACT>

<DT><CODE>normal</CODE>
<DD>
The number of columns for which no extra packing is used.

<DT><CODE>empty-space</CODE>
<DD>
The number of columns containing
values that are only spaces; these will occupy one bit.

<DT><CODE>empty-zero</CODE>
<DD>
The number of columns containing
values that are only binary zeros; these will occupy one bit.

<DT><CODE>empty-fill</CODE>
<DD>
The number of integer columns that don't occupy the full byte range of their
type; these are changed to a smaller type.  For example, a <CODE>BIGINT</CODE>
column (eight bytes) can be stored as a <CODE>TINYINT</CODE> column (one byte) if
all its values are in the range from <CODE>-128</CODE> to <CODE>127</CODE>.

<DT><CODE>pre-space</CODE>
<DD>
The number of decimal columns that are stored with leading spaces. In this
case, each value will contain a count for the number of leading spaces.

<DT><CODE>end-space</CODE>
<DD>
The number of columns that have a lot of trailing spaces.  In this case, each
value will contain a count for the number of trailing spaces.

<DT><CODE>table-lookup</CODE>
<DD>
The column had only a small number of different values, which were
converted to an <CODE>ENUM</CODE> before Huffman compression.

<DT><CODE>zero</CODE>
<DD>
The number of columns for which all values are zero.

<DT><CODE>Original trees</CODE>
<DD>
The initial number of Huffman trees.

<DT><CODE>After join</CODE>
<DD>
The number of distinct Huffman trees left after joining
trees to save some header space.
</DL>

<P>
After a table has been compressed, <CODE>myisamchk -dvv</CODE> prints additional
information about each column:

</P>
<DL COMPACT>

<DT><CODE>Type</CODE>
<DD>
The column type. The value may contain any of the following descriptors:

<DL COMPACT>

<DT><CODE>constant</CODE>
<DD>
All rows have the same value.

<DT><CODE>no endspace</CODE>
<DD>
Don't store endspace.

<DT><CODE>no endspace, not_always</CODE>
<DD>
Don't store endspace and don't do endspace compression for all values.

<DT><CODE>no endspace, no empty</CODE>
<DD>
Don't store endspace. Don't store empty values.

<DT><CODE>table-lookup</CODE>
<DD>
The column was converted to an <CODE>ENUM</CODE>.

<DT><CODE>zerofill(n)</CODE>
<DD>
The most significant <CODE>n</CODE> bytes in the value are always 0 and are not
stored.

<DT><CODE>no zeros</CODE>
<DD>
Don't store zeros.

<DT><CODE>always zero</CODE>
<DD>
Zero values are stored using one bit.
</DL>

<DT><CODE>Huff tree</CODE>
<DD>
The number of the Huffman tree associated with the column.

<DT><CODE>Bits</CODE>
<DD>
The number of bits used in the Huffman tree.
</DL>

<P>
After you run <CODE>myisampack</CODE>, you must run
<CODE>myisamchk</CODE> to re-create any indexes.  At this time, you
can also sort the index blocks and create statistics needed for
the MySQL optimizer to work more efficiently:

</P>

<PRE>
shell&#62; myisamchk -rq --sort-index --analyze tbl_name.MYI
</PRE>

<P>
A similar procedure applies for <CODE>ISAM</CODE> tables. After using
<CODE>pack_isam</CODE>, use <CODE>isamchk</CODE> to re-create the indexes:

</P>

<PRE>
shell&#62; isamchk -rq --sort-index --analyze tbl_name.ISM
</PRE>

<P>
After you have installed the packed table into the MySQL database directory,
you should execute <CODE>mysqladmin flush-tables</CODE> to force <CODE>mysqld</CODE>
to start using the new table.

</P>
<P>
To unpack a packed table, use the <CODE>--unpack</CODE> option to <CODE>myisamchk</CODE>
or <CODE>isamchk</CODE>.

</P>



<H2><A NAME="mysql" HREF="manual_toc.html#mysql">8.3  <CODE>mysql</CODE>, the Command-Line Tool</A></H2>

<P>
<A NAME="IDX851"></A>
<A NAME="IDX852"></A>
<A NAME="IDX853"></A>
<A NAME="IDX854"></A>
<A NAME="IDX855"></A>

</P>

<P>
<CODE>mysql</CODE> is a simple SQL shell (with GNU <CODE>readline</CODE> capabilities).
It supports interactive and non-interactive use. When used interactively,
query results are presented in an ASCII-table format. When used
non-interactively (for example, as a filter), the result is presented in
tab-separated format.  The output format can be changed using command-line
options.

</P>
<P>
If you have problems due to insufficient memory for large result sets, use the
<CODE>--quick</CODE> option!  This forces <CODE>mysql</CODE> to retrieve results from
the server a row at a time rather than retrieving the entire result set
and buffering it in memory before displaying it.  This is done by using
<CODE>mysql_use_result()</CODE> rather than <CODE>mysql_store_result()</CODE> to
retrieve the result set.

</P>
<P>
Using <CODE>mysql</CODE> is very easy. Invoke it from the prompt of your command
interpreter as follows:

</P>

<PRE>
shell&#62; mysql db_name
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysql --user=user_name --password=your_password db_name
</PRE>

<P>
Then type an SQL statement, end it with <SAMP>`;'</SAMP>, <CODE>\g</CODE>, or <CODE>\G</CODE>
and press Enter.

</P>
<P>
You can run a script simply like this:

</P>

<PRE>
shell&#62; mysql db_name &#60; script.sql &#62; output.tab
</PRE>

<P>
<A NAME="IDX856"></A>
<A NAME="IDX857"></A>
<A NAME="IDX858"></A>
<A NAME="IDX859"></A>
<CODE>mysql</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
<A NAME="IDX860"></A>
Display a help message and exit.

<DT><CODE>--batch, -B</CODE>
<DD>
<A NAME="IDX861"></A>
Print results using tab as the column separator, with each row on a new line.
With this option, <CODE>mysql</CODE> doesn't use the history file.

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
<A NAME="IDX862"></A>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--compress, -C</CODE>
<DD>
<A NAME="IDX863"></A>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--database=db_name, -D db_name</CODE>
<DD>
<A NAME="IDX864"></A>
The database to use. This is useful mainly in an option file.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
<A NAME="IDX865"></A>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.
The default is <CODE>'d:t:o,/tmp/mysql.trace'</CODE>.

<DT><CODE>--debug-info, -T</CODE>
<DD>
<A NAME="IDX866"></A>
Print some debugging information when the program exits.

<DT><CODE>--default-character-set=charset</CODE>
<DD>
<A NAME="IDX867"></A>
Use <CODE>charset</CODE> as the default character set.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--execute=statement, -e statement</CODE>
<DD>
<A NAME="IDX868"></A>
Execute the statement and quit. The default output format is like that produced with
<CODE>--batch</CODE>.

<DT><CODE>--force, -f</CODE>
<DD>
<A NAME="IDX869"></A>
Continue even if an SQL error occurs.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
<A NAME="IDX870"></A>
Connect to the MySQL server on the given host.

<DT><CODE>--html, -H</CODE>
<DD>
<A NAME="IDX871"></A>
Produce HTML output.

<DT><CODE>--ignore-space, -i</CODE>
<DD>
<A NAME="IDX872"></A>
Ignore spaces after function names.
The effect of this is described in the discussion for <CODE>IGNORE_SPACE</CODE> in
section <A HREF="manual.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

<DT><CODE>--local-infile[={0|1}]</CODE>
<DD>
<A NAME="IDX873"></A>
Enable or disable <CODE>LOCAL</CODE> capability for <CODE>LOAD DATA INFILE</CODE>.
With no value, the option enables <CODE>LOCAL</CODE>. It may be given as
<CODE>--local-infile=0</CODE> or <CODE>--local-infile=1</CODE> to explicitly disable
or enable <CODE>LOCAL</CODE>. Enabling <CODE>LOCAL</CODE> has no effect if the server
does not also support it.

<DT><CODE>--named-commands, -G</CODE>
<DD>
<A NAME="IDX874"></A>
Named commands are <EM>enabled</EM>.  Long format commands are allowed as
well as shortened \* commands. For example, <CODE>quit</CODE> and <CODE>\q</CODE> both
are recognized.

<DT><CODE>--no-auto-rehash, -A</CODE>
<DD>
<A NAME="IDX875"></A>
No automatic rehashing.  This option causes <CODE>mysql</CODE> to start faster,
but you must issue the <CODE>rehash</CODE> command if you want to use table and
column name completion.

<DT><CODE>--no-beep, -b</CODE>
<DD>
<A NAME="IDX876"></A>
Do not beep when errors occur.

<DT><CODE>--no-named-commands, -g</CODE>
<DD>
<A NAME="IDX877"></A>
Named commands are disabled. Use the <CODE>\*</CODE> form only, or use
named commands only at the beginning of a line ending with a semicolon
(<SAMP>`;'</SAMP>). As of MySQL 3.23.22, <CODE>mysql</CODE> starts with this option
<EM>enabled</EM> by default!  However, even with this option, long-format
commands still work from the first line.

<DT><CODE>--no-pager</CODE>
<DD>
<A NAME="IDX878"></A>
Do not use a pager for displaying query output.
Output paging is discussed further in
section <A HREF="manual.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A>.

<DT><CODE>--no-tee</CODE>
<DD>
<A NAME="IDX879"></A>
Do not copy output to a file.
Tee files are discussed further in
section <A HREF="manual.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A>.

<DT><CODE>--one-database, -O</CODE>
<DD>
<A NAME="IDX880"></A>
Ignore statements except those for the default database named on the
command line.  This is useful for skipping updates to other databases in
the binary log.

<DT><CODE>--pager[=command]</CODE>
<DD>
<A NAME="IDX881"></A>
Use the given command for paging query output.  If the command is
omitted, the default pager is the value of your <CODE>PAGER</CODE> environment
variable. Valid pagers are <CODE>less</CODE>, <CODE>more</CODE>, <CODE>cat [&#62;
filename]</CODE>, and so forth.  This option works only on Unix.  It does not
work in batch mode.
Output paging is discussed further in
section <A HREF="manual.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A>.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
<A NAME="IDX882"></A>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
<A NAME="IDX883"></A>
The TCP/IP port number to use for the connection.

<DT><CODE>--prompt=format_str</CODE>
<DD>
<A NAME="IDX884"></A>
Set the prompt to the specified format. The default is <CODE>mysql&#62;</CODE>.
The special sequences that the prompt can contain are described in
section <A HREF="manual.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A>.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
<A NAME="IDX885"></A>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--quick, -q</CODE>
<DD>
<A NAME="IDX886"></A>
Don't cache each query result, print it row-by-row. This may slow down
the server if the output is suspended.  With this option, <CODE>mysql</CODE>
doesn't use the history file.

<DT><CODE>--raw, -r</CODE>
<DD>
<A NAME="IDX887"></A>
Write column values without escape conversion. Often used with the
<CODE>--batch</CODE> option.

<DT><CODE>--reconnect</CODE>
<DD>
<A NAME="IDX888"></A>
If the connection to the server is lost, automatically try to reconnect. A
single reconnect attempt is made each time the connection is lost.  To
suppress reconnection behavior, use <CODE>--skip-reconnect</CODE>.
New in MySQL 4.1.0.

<DT><CODE>--safe-updates, --i-am-a-dummy, -U</CODE>
<DD>
<A NAME="IDX889"></A>
Allow only <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> statements that specify rows
to affect using key values.  If you have this option in an option file,
you can override it by using <CODE>--safe-updates</CODE> on the command line.
See section <A HREF="manual.html#mysql_Tips">8.3.3  <CODE>mysql</CODE> Tips</A> for more information about
this option.

<DT><CODE>--silent, -s</CODE>
<DD>
<A NAME="IDX890"></A>
Silent mode. Produce less output.  This option can be given multiple times
to produce less and less output.

<DT><CODE>--skip-column-names, -N</CODE>
<DD>
<A NAME="IDX891"></A>
Don't write column names in results.

<DT><CODE>--skip-line-numbers, -L</CODE>
<DD>
<A NAME="IDX892"></A>
Don't write line numbers for errors. Useful when you want to compare result
files that include error messages.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
<A NAME="IDX893"></A>
The socket file to use for the connection.

<DT><CODE>--table, -t</CODE>
<DD>
<A NAME="IDX894"></A>
Display
output in table format. This is the default for interactive use, but can be
used to produce table output in batch mode.

<DT><CODE>--tee=file_name</CODE>
<DD>
<A NAME="IDX895"></A>
Append a copy of output to the given file. This option does not
work in batch mode.  Tee files are discussed further in
section <A HREF="manual.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A>.

<DT><CODE>--unbuffered, -n</CODE>
<DD>
<A NAME="IDX896"></A>
Flush the buffer after each query.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
<A NAME="IDX897"></A>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
<A NAME="IDX898"></A>
Verbose mode. Produce more output. This option can be given multiple times
to produce more and more output.
(For example, <CODE>-v -v -v</CODE> produces the table output format even in batch
mode.)

<DT><CODE>--version, -V</CODE>
<DD>
<A NAME="IDX899"></A>
Display version information and exit.

<DT><CODE>--vertical, -E</CODE>
<DD>
<A NAME="IDX900"></A>
Print the rows of query output vertically. Without this option, you can
specify vertical output for individual statements by terminating them
with <CODE>\G</CODE>.

<DT><CODE>--wait, -w</CODE>
<DD>
<A NAME="IDX901"></A>
If the connection cannot be established, wait and retry instead of aborting.

<DT><CODE>--xml, -X</CODE>
<DD>
<A NAME="IDX902"></A>
Produce XML output.

</DL>

<P>
You can also set the following variables by using <CODE>--var_name=value</CODE>
options:

</P>
<P>
<A NAME="IDX903"></A>
<A NAME="IDX904"></A>
<A NAME="IDX905"></A>
<A NAME="IDX906"></A>
<A NAME="IDX907"></A>
<A NAME="IDX908"></A>

</P>
<DL COMPACT>

<DT><CODE>connect_timeout</CODE>
<DD>
The number of seconds before connection timeout.
(Default value is 0.)

<DT><CODE>max_allowed_packet</CODE>
<DD>
The maximum packet length to send to or receive from the server.
(Default value is 16MB.)

<DT><CODE>max_join_size</CODE>
<DD>
The automatic limit for rows in a join when using <CODE>--safe-updates</CODE>.
(Default value is 1,000,000.)

<DT><CODE>net_buffer_length</CODE>
<DD>
The buffer size for TCP/IP and socket communication.
(Default value is 16KB.)

<DT><CODE>select_limit</CODE>
<DD>
The automatic limit for <CODE>SELECT</CODE> statements when using
<CODE>--safe-updates</CODE>.
(Default value is 1,000.)

</DL>

<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
<A NAME="IDX909"></A>
<A NAME="IDX910"></A>
<A NAME="IDX911"></A>
<A NAME="IDX912"></A>
<A NAME="IDX913"></A>
<A NAME="IDX914"></A>
<A NAME="IDX915"></A>

</P>
<P>
On Unix, the <CODE>mysql</CODE> client writes a record of executed statements to a
history file.  By default, the history file is named <TT>`.mysql_history'</TT>
and is created in your home directory.  To specify a different file,
set the value of the <CODE>MYSQL_HISTFILE</CODE> environment variable.

</P>
<P>
If you do not want to maintain a history file, first remove
<TT>`.mysql_history'</TT> if it exists, and then use either of the following
techniques:

</P>

<UL>

<LI>

Set the <CODE>MYSQL_HISTFILE</CODE> variable to <TT>`/dev/null'</TT>. To cause this
setting to take effect each time you log in, put the setting in one of
your shell's startup files.

<LI>

Create <TT>`.mysql_histfile'</TT> as a symbolic link to <TT>`/dev/null'</TT>:


<PRE>
shell&#62; ln -s /dev/null $HOME/.mysql_history
</PRE>

You need do this only once.

</UL>



<H3><A NAME="mysql_Commands" HREF="manual_toc.html#mysql_Commands">8.3.1  <CODE>mysql</CODE> Commands</A></H3>

<P>
<CODE>mysql</CODE> sends SQL statements that you issue to the server to be
executed.  There is also a set of commands that <CODE>mysql</CODE> itself
interprets.  For a list of these commands, type <CODE>help</CODE> or <CODE>\h</CODE> at
the <CODE>mysql&#62;</CODE> prompt:

</P>
<P>
<A NAME="IDX916"></A>

<PRE>
mysql&#62; help

MySQL commands:
?         (\h)    Synonym for `help'.
clear     (\c)    Clear command.
connect   (\r)    Reconnect to the server.
                  Optional arguments are db and host.
delimiter (\d)    Set query delimiter.
edit      (\e)    Edit command with $EDITOR.
ego       (\G)    Send command to mysql server,
                  display result vertically.
exit      (\q)    Exit mysql. Same as quit.
go        (\g)    Send command to mysql server.
help      (\h)    Display this help.
nopager   (\n)    Disable pager, print to stdout.
notee     (\t)    Don't write into outfile.
pager     (\P)    Set PAGER [to_pager].
                  Print the query results via PAGER.
print     (\p)    Print current command.
prompt    (\R)    Change your mysql prompt.
quit      (\q)    Quit mysql.
rehash    (\#)    Rebuild completion hash.
source    (\.)    Execute an SQL script file.
                  Takes a file name as an argument.
status    (\s)    Get status information from the server.
system    (\!)    Execute a system shell command.
tee       (\T)    Set outfile [to_outfile].
                  Append everything into given outfile.
use       (\u)    Use another database.
                  Takes database name as argument.
</PRE>

<P>
The <CODE>edit</CODE>, <CODE>nopager</CODE>, <CODE>pager</CODE>, and <CODE>system</CODE> commands
work only in Unix.

</P>
<P>
<A NAME="IDX917"></A>
The <CODE>status</CODE> command provides some information about the
connection and the server you are using. If you are running in
<CODE>--safe-updates</CODE> mode, <CODE>status</CODE> also prints the values for
the <CODE>mysql</CODE> variables that affect your queries.

</P>
<P>
To log queries and their output, use the <CODE>tee</CODE> command.  All the data
displayed on the screen will be appended into a given file. This can be very
useful for debugging purposes also.  You can enable this feature on the
command line with the <CODE>--tee</CODE> option, or interactively with the <CODE>tee</CODE>
command.  The <CODE>tee</CODE> file can be disabled interactively with the
<CODE>notee</CODE> command. Executing <CODE>tee</CODE> again re-enables logging.
Without a parameter, the previous file will be used. Note that <CODE>tee</CODE>
flushes query results to the file after each statement, just before <CODE>mysql</CODE>
prints its next prompt.

</P>
<P>
Browsing or searching query results in interactive mode by using Unix
programs such as <CODE>less</CODE>, <CODE>more</CODE>, or any other similar program is
now possible with the <CODE>--pager</CODE> option. If you specify no value for the
option, <CODE>mysql</CODE> checks the value of the <CODE>PAGER</CODE> environment
variable and sets the pager to that.  Output paging can be enabled
interactively with the <CODE>pager</CODE> command and disabled with
<CODE>nopager</CODE>.  The command takes an optional argument; if given, the
paging program is set to that. With no argument, the pager is set to the
pager that was set on the command line, or <CODE>stdout</CODE> if no pager was
specified.

</P>
<P>
Output paging works only in Unix because it uses the <CODE>popen()</CODE>
function, which doesn't exist on Windows. For Windows, the <CODE>tee</CODE>
option can be used instead to save query output, although this is not as
convenient as <CODE>pager</CODE> for browsing output in some situations.

</P>
<P>
A few tips about the <CODE>pager</CODE> command:

</P>

<UL>
<LI>

You can use it to write to a file and the results will go only to the file:


<PRE>
mysql&#62; pager cat &#62; /tmp/log.txt
</PRE>

You can also pass any options for the program that you want to use as your
pager:


<PRE>
mysql&#62; pager less -n -i -S
</PRE>

<LI>

In the preceding example, note the <CODE>-S</CODE> option. You may find it very
useful for browsing wide query results.  Sometimes a very wide result set is
difficult to read on the screen.  The <CODE>-S</CODE> option to <CODE>less</CODE> can
make the result set much more readable because you can scroll it
horizontally using the left-arrow and right-arrow keys.  You can also use
<CODE>-S</CODE> interactively within <CODE>less</CODE> to switch the horizontal-browse
mode on and off.  For more information, read the <CODE>less</CODE> manual page:


<PRE>
shell&#62; man less
</PRE>

<LI>

You can specify very complex pager commands for handling query output:


<PRE>
mysql&#62; pager cat | tee /dr1/tmp/res.txt \
          | tee /dr2/tmp/res2.txt | less -n -i -S
</PRE>

In this example, the command would send query results to two files in two
different directories on two different filesystems mounted on <TT>`/dr1'</TT>
and <TT>`/dr2'</TT>, yet still display the results onscreen via <CODE>less</CODE>.

</UL>

<P>
You can also combine the <CODE>tee</CODE> and <CODE>pager</CODE> functions. Have a
<CODE>tee</CODE> file enabled and <CODE>pager</CODE> set to <CODE>less</CODE>, and you will be
able to browse the results using the <CODE>less</CODE> program and still have
everything appended into a file the same time. The difference between the
Unix <CODE>tee</CODE> used with the <CODE>pager</CODE> command and the <CODE>mysql</CODE>
built-in <CODE>tee</CODE> command is that the built-in <CODE>tee</CODE> works even if
you don't have the Unix <CODE>tee</CODE> available. The built-in <CODE>tee</CODE> also
logs everything that is printed on the screen, whereas the Unix <CODE>tee</CODE>
used with <CODE>pager</CODE> doesn't log quite that much. Additionally, <CODE>tee</CODE>
file logging can be turned on and off interactively from within
<CODE>mysql</CODE>. This is useful when you want to log some queries to a file,
but not others.

</P>
<P>
<A NAME="IDX918"></A>
From MySQL 4.0.2 on, the default <CODE>mysql&#62;</CODE> prompt can be reconfigured.
The string for defining the prompt can contain the following special
sequences:

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>\v</CODE> </TD><TD> The server version
</TD></TR>
<TR><TD><CODE>\d</CODE> </TD><TD> The current database
</TD></TR>
<TR><TD><CODE>\h</CODE> </TD><TD> The server host
</TD></TR>
<TR><TD><CODE>\p</CODE> </TD><TD> The current TCP/IP host
</TD></TR>
<TR><TD><CODE>\u</CODE> </TD><TD> Your username
</TD></TR>
<TR><TD><CODE>\U</CODE> </TD><TD> Your full <CODE>user_name@host_name</CODE> account name
</TD></TR>
<TR><TD><CODE>\\</CODE> </TD><TD> A literal <SAMP>`\'</SAMP> backslash character
</TD></TR>
<TR><TD><CODE>\n</CODE> </TD><TD> A newline character
</TD></TR>
<TR><TD><CODE>\t</CODE> </TD><TD> A tab character
</TD></TR>
<TR><TD><CODE>\ </CODE> </TD><TD> A space (a space follows the backslash)
</TD></TR>
<TR><TD><CODE>\_</CODE> </TD><TD> A space
</TD></TR>
<TR><TD><CODE>\R</CODE> </TD><TD> The current time, in 24-hour military time (0-23)
</TD></TR>
<TR><TD><CODE>\r</CODE> </TD><TD> The current time, standard 12-hour time (1-12)
</TD></TR>
<TR><TD><CODE>\m</CODE> </TD><TD> Minutes of the current time
</TD></TR>
<TR><TD><CODE>\y</CODE> </TD><TD> The current year, two digits
</TD></TR>
<TR><TD><CODE>\Y</CODE> </TD><TD> The current year, four digits
</TD></TR>
<TR><TD><CODE>\D</CODE> </TD><TD> The full current date
</TD></TR>
<TR><TD><CODE>\s</CODE> </TD><TD> Seconds of the current time
</TD></TR>
<TR><TD><CODE>\w</CODE> </TD><TD> The current day of the week in three-letter format (Mon, Tue, ...)
</TD></TR>
<TR><TD><CODE>\P</CODE> </TD><TD> am/pm
</TD></TR>
<TR><TD><CODE>\o</CODE> </TD><TD> The current month in numeric format
</TD></TR>
<TR><TD><CODE>\O</CODE> </TD><TD> The current month in three-letter format (Jan, Feb, ...)
</TD></TR>
<TR><TD><CODE>\c</CODE> </TD><TD> A counter that increments for each statement you issue
</TD></TR>
</TABLE>

<P>
<SAMP>`\'</SAMP> followed by any other letter just becomes that letter.

</P>
<P>
If you specify the <CODE>prompt</CODE> command with no argument, <CODE>mysql</CODE> resets
the prompt to the default of <CODE>mysql&#62;</CODE>.

</P>
<P>
You can set the prompt in several ways:

</P>

<UL>
<LI>Use an environment variable

You can set the <CODE>MYSQL_PS1</CODE> environment variable to a prompt string.  For
example:


<PRE>
shell&#62; export MYSQL_PS1="(\u@\h) [\d]&#62; "
</PRE>

<LI>Use an option file

You can set the <CODE>prompt</CODE> option in the <CODE>[mysql]</CODE> group of any MySQL
option file, such as <TT>`/etc/my.cnf'</TT> or the <TT>`.my.cnf'</TT> file in
your home directory.
For example:


<PRE>
[mysql]
prompt=(\\u@\\h) [\\d]&#62;\\_
</PRE>

In this example, note that the backslashes are doubled.
If you set the prompt using the <CODE>prompt</CODE> option in an option
file, it is advisable to double the backslashes when using the special
prompt options.  There is
some overlap in the set of allowable prompt options and the set of special
escape sequences that are recognized in option files.
(These sequences are listed in section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.)
The overlap may cause you problems if you use single backslashes.
For example, <CODE>\s</CODE> will be interpreted as a space rather than as the
current seconds value. The following example shows how to define a prompt
within an option file to
include the current time in <CODE>HH:MM:SS&#62;</CODE> format:


<PRE>
[mysql]
prompt="\\r:\\m:\\s&#62; "
</PRE>

<LI>Use a command-line option

You can set the <CODE>--prompt</CODE> option on the command line to <CODE>mysql</CODE>.
For example:


<PRE>
shell&#62; mysql --prompt="(\u@\h) [\d]&#62; "
(user@host) [database]&#62; 
</PRE>

<LI>Interactively

You can change your prompt interactively by using the <CODE>prompt</CODE> (or
<CODE>\R</CODE>) command.  For example:


<PRE>
mysql&#62; prompt (\u@\h) [\d]&#62;\_
PROMPT set to '(\u@\h) [\d]&#62;\_'
(user@host) [database]&#62; 
(user@host) [database]&#62; prompt
Returning to default PROMPT of mysql&#62; 
mysql&#62; 
</PRE>

</UL>



<H3><A NAME="Batch_Commands" HREF="manual_toc.html#Batch_Commands">8.3.2  Executing SQL Statements from a Text File</A></H3>

<P>
The <CODE>mysql</CODE> client typically is used interactively, like this:

</P>

<PRE>
shell&#62; mysql db_name
</PRE>

<P>
However, it's also possible to put your SQL statements in a file and then
tell <CODE>mysql</CODE> to read its input from that file.  To do so, create a text
file <TT>`text_file'</TT> that contains the statements you wish to execute.
Then invoke <CODE>mysql</CODE> as shown here:

</P>

<PRE>
shell&#62; mysql db_name &#60; text_file
</PRE>

<P>
You can also start your text file with a <CODE>USE db_name</CODE> statement.  In
this case, it is unnecessary to specify the database name on the command
line:

</P>

<PRE>
shell&#62; mysql &#60; text_file
</PRE>

<P>
If you are already running <CODE>mysql</CODE>, you can execute an SQL
script file using the <CODE>source</CODE> or <CODE>\.</CODE> command:

</P>

<PRE>
mysql&#62; source filename;
mysql&#62; \. filename;
</PRE>

<P>
For more information about batch mode, see section <A HREF="manual.html#Batch_mode">3.5  Using <CODE>mysql</CODE> in Batch Mode</A>.

</P>



<H3><A NAME="mysql_Tips" HREF="manual_toc.html#mysql_Tips">8.3.3  <CODE>mysql</CODE> Tips</A></H3>

<P>
This section describes some techniques that can help you use <CODE>mysql</CODE> more
effectively.

</P>



<H4><A NAME="Vertical_query_results" HREF="manual_toc.html#Vertical_query_results">8.3.3.1  Displaying Query Results Vertically</A></H4>

<P>
Some query results are much more readable when displayed vertically, instead
of in the usual horizontal table format. For example, longer text values that
include newlines often are much easier to read with vertical output:

</P>

<PRE>
mysql&#62; SELECT * FROM mails WHERE LENGTH(txt) &#60; 300 LIMIT 300,1\G
*************************** 1. row ***************************
  msg_nro: 3068
     date: 2000-03-01 23:29:50
time_zone: +0200
mail_from: Monty
    reply: monty@no.spam.com
  mail_to: "Thimble Smith" &#60;tim@no.spam.com&#62;
      sbj: UTF-8
      txt: &#62;&#62;&#62;&#62;&#62; "Thimble" == Thimble Smith writes:

Thimble&#62; Hi.  I think this is a good idea.  Is anyone familiar
Thimble&#62; with UTF-8 or Unicode? Otherwise, I'll put this on my
Thimble&#62; TODO list and see what happens.

Yes, please do that.

Regards,
Monty
     file: inbox-jani-1
     hash: 190402944
1 row in set (0.09 sec)
</PRE>



<H4><A NAME="safe-updates" HREF="manual_toc.html#safe-updates">8.3.3.2  Using the <CODE>--safe-updates</CODE> Option</A></H4>

<P>
<A NAME="IDX919"></A>

</P>
<P>
For beginners, a useful startup option is <CODE>--safe-updates</CODE> (or
<CODE>--i-am-a-dummy</CODE>, which has the same effect).  This option was
introduced in MySQL 3.23.11.  It is helpful for cases when you might
have issued a <CODE>DELETE FROM tbl_name</CODE> statement but forgotten the
<CODE>WHERE</CODE> clause. Normally, such a statement will delete all rows from the
table.  With <CODE>--safe-updates</CODE>, you can delete rows only by specifying
the key values that identify them. This helps prevent accidents.

</P>
<P>
When you use the <CODE>--safe-updates</CODE> option, <CODE>mysql</CODE> issues the
following statement when it connects to the MySQL server:

</P>

<PRE>
SET SQL_SAFE_UPDATES=1,SQL_SELECT_LIMIT=1000,
    SQL_MAX_JOIN_SIZE=1000000;
</PRE>

<P>
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
The <CODE>SET</CODE> statement has the following effects:

</P>

<UL>
<LI>

You are not allowed to execute an <CODE>UPDATE</CODE> or <CODE>DELETE</CODE> statement
unless you specify a key constraint in the <CODE>WHERE</CODE> clause or provide a
<CODE>LIMIT</CODE> clause (or both).
For example:


<PRE>
UPDATE tbl_name SET not_key_column=# WHERE key_column=#;

UPDATE tbl_name SET not_key_column=# LIMIT 1;
</PRE>

<LI>

All large <CODE>SELECT</CODE> results are automatically limited to 1,000 rows
unless the statement includes a <CODE>LIMIT</CODE> clause.

<LI>

Multiple-table <CODE>SELECT</CODE> statements that will probably need to examine
more than 1,000,000 row combinations are aborted.

</UL>

<P>
To specify limits other than 1,000 and 1,000,000, you can override the
defaults by using <CODE>--select_limit</CODE> and <CODE>--max_join_size</CODE> options:

</P>

<PRE>
shell&#62; mysql --safe-updates --select_limit=500 --max_join_size=10000
</PRE>



<H4><A NAME="mysql_reconnect" HREF="manual_toc.html#mysql_reconnect">8.3.3.3  Disabling <CODE>mysql</CODE> Auto-Reconnect</A></H4>

<P>
If the <CODE>mysql</CODE> client loses its connection to the server while sending
a query, it will immediately and automatically try to reconnect once to the
server and send the query again.  However, even if <CODE>mysql</CODE> succeeds in
reconnecting, your first connection has ended and all your previous session
objects and settings are lost: temporary tables, the autocommit mode, and
user and session variables.  This behavior may be dangerous for you, as in
the following example where the server was shut down and restarted without
you knowing it:

</P>

<PRE>
mysql&#62; SET @a=1;
Query OK, 0 rows affected (0.05 sec)

mysql&#62; INSERT INTO t VALUES(@a);
ERROR 2006: MySQL server has gone away
No connection. Trying to reconnect...
Connection id:    1
Current database: test

Query OK, 1 row affected (1.30 sec)

mysql&#62; SELECT * FROM t;
+------+
| a    |
+------+
| NULL |
+------+
1 row in set (0.05 sec)
</PRE>

<P>
The <CODE>@a</CODE> user variable has been lost with the connection, and after
the reconnection it is undefined. If it is important to have <CODE>mysql</CODE>
terminate with an error if the connection has been lost, you can start the
<CODE>mysql</CODE> client with the <CODE>--skip-reconnect</CODE> option.

</P>



<H2><A NAME="mysqladmin" HREF="manual_toc.html#mysqladmin">8.4  <CODE>mysqladmin</CODE>, Administering a MySQL Server</A></H2>

<P>
<A NAME="IDX920"></A>
<A NAME="IDX921"></A>
<A NAME="IDX922"></A>

</P>
<P>
<CODE>mysqladmin</CODE> is a client for performing administrative operations.
You can use it to check the server's configuration and current status, create
and drop databases, and more.

</P>
<P>
Invoke <CODE>mysqladmin</CODE> like this:

</P>

<PRE>
shell&#62; mysqladmin [options] command [command-option] command ...
</PRE>

<P>
<CODE>mysqladmin</CODE> supports the following commands:

</P>
<DL COMPACT>

<DT><CODE>create databasename</CODE>
<DD>
Create a new database.

<DT><CODE>drop databasename</CODE>
<DD>
Delete a database and all its tables.

<DT><CODE>extended-status</CODE>
<DD>
Display the server status variables and their values.

<DT><CODE>flush-hosts</CODE>
<DD>
Flush all information in the host cache.

<DT><CODE>flush-logs</CODE>
<DD>
Flush all logs.

<DT><CODE>flush-privileges</CODE>
<DD>
Reload the grant tables (same as <CODE>reload</CODE>).

<DT><CODE>flush-status</CODE>
<DD>
Clear status variables.

<DT><CODE>flush-tables</CODE>
<DD>
Flush all tables.

<DT><CODE>flush-threads</CODE>
<DD>
Flush the thread cache.
(Added in MySQL 3.23.16.)

<DT><CODE>kill id,id,...</CODE>
<DD>
Kill server threads.

<DT><CODE>password new-password</CODE>
<DD>
Set a new password. This changes the password to <CODE>new-password</CODE>
for the account that you use with <CODE>mysqladmin</CODE> for connecting to the
server.

<DT><CODE>ping</CODE>
<DD>
Check whether the server is alive.

<DT><CODE>processlist</CODE>
<DD>
Show a list of active server threads. This is like the output of the
<CODE>SHOW PROCESSLIST</CODE> statement.
If the <CODE>--verbose</CODE> option is given, the output is like that of
<CODE>SHOW FULL PROCESSLIST</CODE>.

<DT><CODE>reload</CODE>
<DD>
Reload the grant tables.

<DT><CODE>refresh</CODE>
<DD>
Flush all tables and close and open log files.

<DT><CODE>shutdown</CODE>
<DD>
Stop the server.

<DT><CODE>start-slave</CODE>
<DD>
Start replication on a slave server.
(Added in MySQL 3.23.16.)

<DT><CODE>status</CODE>
<DD>
Display a short server status message.

<DT><CODE>stop-slave</CODE>
<DD>
Stop replication on a slave server.
(Added in MySQL 3.23.16.)

<DT><CODE>variables</CODE>
<DD>
Display the server system variables and their values.

<DT><CODE>version</CODE>
<DD>
Display version information from the server.
</DL>

<P>
All commands can be shortened to any unique prefix.  For example:

</P>

<PRE>
shell&#62; mysqladmin proc stat
+----+-------+-----------+----+-------------+------+-------+------+
| Id | User  | Host      | db | Command     | Time | State | Info |
+----+-------+-----------+----+-------------+------+-------+------+
| 6  | monty | localhost |    | Processlist | 0    |       |      |
+----+-------+-----------+----+-------------+------+-------+------+
Uptime: 10077  Threads: 1  Questions: 9  Slow queries: 0
Opens: 6 Flush tables: 1  Open tables: 2
Memory in use: 1092K  Max memory used: 1116K
</PRE>

<P>
<A NAME="IDX923"></A>
The <CODE>mysqladmin status</CODE> command result displays the following values:

</P>
<DL COMPACT>

<DT><CODE>Uptime</CODE>
<DD>
<A NAME="IDX924"></A>

The number of seconds the MySQL server has been running.

<DT><CODE>Threads</CODE>
<DD>
<A NAME="IDX925"></A>

The number of active threads (clients).

<DT><CODE>Questions</CODE>
<DD>
<A NAME="IDX926"></A>

The number of questions (queries) from clients since the server was started.

<DT><CODE>Slow queries</CODE>
<DD>
<A NAME="IDX927"></A>

The number of queries that have taken more than <CODE>long_query_time</CODE>
seconds.  See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

<DT><CODE>Opens</CODE>
<DD>
<A NAME="IDX928"></A>

The number of tables the server has opened.

<DT><CODE>Flush tables</CODE>
<DD>
<A NAME="IDX929"></A>
<A NAME="IDX930"></A>

The number of <CODE>flush ...</CODE>, <CODE>refresh</CODE>, and <CODE>reload</CODE> commands the
server has executed.

<DT><CODE>Open tables</CODE>
<DD>
<A NAME="IDX931"></A>

The number of tables that currently are open.

<DT><CODE>Memory in use</CODE>
<DD>
<A NAME="IDX932"></A>

The amount of
memory allocated directly by <CODE>mysqld</CODE> code.
This value is displayed only when MySQL has been compiled with
<CODE>--with-debug=full</CODE>.

<DT><CODE>Maximum memory used</CODE>
<DD>
<A NAME="IDX933"></A>

The maximum amount of memory allocated directly by <CODE>mysqld</CODE> code.
This value is displayed only when MySQL has been compiled with
<CODE>--with-debug=full</CODE>.

</DL>

<P>
If you execute <CODE>mysqladmin shutdown</CODE> when connecting to a local server
using a Unix socket file, <CODE>mysqladmin</CODE> waits until the server's process
ID file has been removed, to ensure that the server has stopped properly.

</P>
<P>
<A NAME="IDX934"></A>
<A NAME="IDX935"></A>
<A NAME="IDX936"></A>
<A NAME="IDX937"></A>

</P>
<P>
<CODE>mysqladmin</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--compress, -C</CODE>
<DD>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--count=#, -c #</CODE>
<DD>
The number of iterations to make. This works only with <CODE>--sleep</CODE>
(<CODE>-i</CODE>).

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.
The default is <CODE>'d:t:o,/tmp/mysqladmin.trace'</CODE>.

<DT><CODE>--force, -f</CODE>
<DD>
Don't ask for confirmation for the <CODE>drop database</CODE> command.
With multiple commands, continue even if an error occurs.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Connect to the MySQL server on the given host.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for the connection.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--relative, -r</CODE>
<DD>
Show the difference between the current and previous values when used with
<CODE>-i</CODE>. Currently, this option works only with the <CODE>extended-status</CODE>
command.

<DT><CODE>--silent, -s</CODE>
<DD>
Exit silently if a connection to the server cannot be established.

<DT><CODE>--sleep=delay, -i delay</CODE>
<DD>
Execute commands again and again, sleeping for <CODE>delay</CODE> seconds in
between.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use for the connection.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Print out more information on what the program does.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

<DT><CODE>--vertical, -E</CODE>
<DD>
Print output vertically. This is similar to <CODE>--relative</CODE>, but
prints output vertically.

<DT><CODE>--wait[=#], -w[#]</CODE>
<DD>
If the connection cannot be established, wait and retry instead of aborting.
If an option value is given, it indicates the number of times to retry.
The default is one time.

</DL>

<P>
You can also set the following variables by using <CODE>--var_name=value</CODE>
options:

</P>
<P>
<A NAME="IDX938"></A>
<A NAME="IDX939"></A>
<A NAME="IDX940"></A>
<A NAME="IDX941"></A>

</P>
<DL COMPACT>

<DT><CODE>connect_timeout</CODE>
<DD>
The number of seconds before connection timeout.
(Default value is 0.)

<DT><CODE>shutdown_timeout</CODE>
<DD>
The number of seconds to wait for shutdown.
(Default value is 0.)

</DL>

<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>



<H2><A NAME="mysqlbinlog" HREF="manual_toc.html#mysqlbinlog">8.5  The <CODE>mysqlbinlog</CODE> Binary Log Utility</A></H2>

<P>
<A NAME="IDX942"></A>

</P>
<P>
The binary log files that the server generates are written in binary format.
To examine these files in text format, use the <CODE>mysqlbinlog</CODE> utility.
It is available as of MySQL 3.23.14.

</P>
<P>
Invoke <CODE>mysqlbinlog</CODE> like this:

</P>

<PRE>
shell&#62; mysqlbinlog [options] log-file ...
</PRE>

<P>
For example, to display the contents of the binary log <TT>`binlog.000003'</TT>,
use this command:

</P>

<PRE>
shell&#62; mysqlbinlog binlog.0000003
</PRE>

<P>
The output includes all statements contained in <TT>`binlog.000003'</TT>,
together with other information such as the time each statement took, the
thread ID of the client that issued it, the timestamp when it was issued,
and so forth.

</P>
<P>
Normally, you use <CODE>mysqlbinlog</CODE> to read binary log files directly and
apply them to the local MySQL server. It is also possible to read binary
logs from a remote server by using the <CODE>--read-from-remote-server</CODE>
option. However, this is deprecated because we instead want to
make it easy to apply binary logs to a local MySQL server.

</P>
<P>
When you read remote binary logs, the connection parameter options can be
given to indicate how to connect to the server, but they are ignored unless
you also specify the <CODE>--read-from-remote-server</CODE> option. These options
are <CODE>--host</CODE>, <CODE>--password</CODE>, <CODE>--port</CODE>, <CODE>--protocol</CODE>,
<CODE>--socket</CODE>, and <CODE>--user</CODE>.

</P>
<P>
You can also use <CODE>mysqlbinlog</CODE> to read relay log files written by a
slave server in a replication setup. Relay logs have the same format as
binary log files.

</P>
<P>
The binary log is discussed further in section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>
<P>
<CODE>mysqlbinlog</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--database=db_name, -d db_name</CODE>
<DD>
List entries for just this database (local log only).

<DT><CODE>--force-read, -f</CODE>
<DD>
Force reading of unknown binary log events.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Get the binary log from the MySQL server on the given host.

<DT><CODE>--local-load=path, -l path</CODE>
<DD>
Prepare local temporary files for <CODE>LOAD DATA INFILE</CODE> in the specified
directory.

<DT><CODE>--offset=N, -o N</CODE>
<DD>
Skip the first <CODE>N</CODE> entries.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for connecting to a remote server.

<DT><CODE>--position=N, -j N</CODE>
<DD>
Start reading the binary log at position <CODE>N</CODE>.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--read-from-remote-server, -R</CODE>
<DD>
Read the binary log from a MySQL server.
Any connection parameter options are ignored unless this option is given as
well. These options are <CODE>--host</CODE>, <CODE>--password</CODE>, <CODE>--port</CODE>,
<CODE>--protocol</CODE>,
<CODE>--socket</CODE>, and <CODE>--user</CODE>.

<DT><CODE>--result-file=name, -r name</CODE>
<DD>
Direct output to the given file.

<DT><CODE>--short-form, -s</CODE>
<DD>
Display only the statements contained in the log, without any extra
information.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use for the connection.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to a remote server.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

</DL>

<P>
You can also set the following variable by using <CODE>--var_name=value</CODE>
options:

</P>
<P>
<A NAME="IDX943"></A>

</P>
<DL COMPACT>

<DT><CODE>open_files_limit</CODE>
<DD>
Specify the number of open file descriptors to reserve.

</DL>

<P>
You can pipe the output of <CODE>mysqlbinlog</CODE> into a <CODE>mysql</CODE> client to
execute the statements contained in the binary log. This is used to recover
from a crash when you have an old backup (see section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>):

</P>

<PRE>
shell&#62; mysqlbinlog hostname-bin.000001 | mysql
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysqlbinlog hostname-bin.[0-9]* | mysql
</PRE>

<P>
You can also redirect the output of <CODE>mysqlbinlog</CODE> to a text file
instead, if you need to modify the statement log first (for example, to
remove statements that you don't want to execute for some reason). After
editing the file, execute the statements that it contains by using it as
input to the <CODE>mysql</CODE> program.

</P>
<P>
<CODE>mysqlbinlog</CODE> has the <CODE>--position</CODE> option, which prints only
those statements with an offset in the binary log greater than or equal to
a given position.

</P>
<P>
If you have more than one binary log to execute on the MySQL server,
the safe method is to process them all using a single connection to the
server.  Here is an example that demonstrates what may be <EM>unsafe</EM>:

</P>

<PRE>
shell&#62; mysqlbinlog hostname-bin.000001 | mysql # DANGER!!
shell&#62; mysqlbinlog hostname-bin.000002 | mysql # DANGER!!
</PRE>

<P>
Processing binary logs this way using different connections to the server
will cause problems if the first log file contains a <CODE>CREATE TEMPORARY
TABLE</CODE> statement and the second log contains a statement that uses the
temporary table. When the first <CODE>mysql</CODE> process terminates, the server
will drop the temporary table. When the second <CODE>mysql</CODE> process attempts
to use the table, the server will report ``unknown table.''

</P>
<P>
To avoid problems like this, use a single connection to execute the contents
of all binary logs that you want to process.  Here is one way to do that:

</P>

<PRE>
shell&#62; mysqlbinlog hostname-bin.000001 hostname-bin.000002 | mysql
</PRE>

<P>
Another approach is to do this:

</P>

<PRE>
shell&#62; mysqlbinlog hostname-bin.000001 &#62;  /tmp/statements.sql
shell&#62; mysqlbinlog hostname-bin.000002 &#62;&#62; /tmp/statements.sql
shell&#62; mysql -e "source /tmp/statements.sql"
</PRE>

<P>
In MySQL 3.23, the binary log did not contain the data to load for
<CODE>LOAD DATA INFILE</CODE> statements. To execute such a statement from a
binary log file, the original data file was needed.  Starting from MySQL
4.0.14, the binary log does contain the data, so <CODE>mysqlbinlog</CODE> can
produce output that reproduces the <CODE>LOAD DATA INFILE</CODE> operation without
the original data file.  <CODE>mysqlbinlog</CODE> copies the data to a temporary
file and writes a <CODE>LOAD DATA LOCAL INFILE</CODE> statement that refers to the
file.  The default location of the directory where these files are written
is system-specific. To specify a directory explicitly, use the
<CODE>--local-load</CODE> option.

</P>
<P>
Because <CODE>mysqlbinlog</CODE> converts <CODE>LOAD DATA INFILE</CODE> statements to
<CODE>LOAD DATA LOCAL INFILE</CODE> statements (that is, it adds <CODE>LOCAL</CODE>),
both the client and the server that you use to process the statements must be
configured to allow <CODE>LOCAL</CODE> capability.
See section <A HREF="manual.html#LOAD_DATA_LOCAL">5.3.4  Security Issues with <CODE>LOAD DATA LOCAL</CODE></A>.

</P>
<P>
<STRONG>Warning:</STRONG> The temporary files created for <CODE>LOAD DATA LOCAL</CODE>
statements are <EM>not</EM> automatically deleted
because they are needed until you actually execute those statements.  You
should delete the temporary files yourself after you no longer need the
statement log.  The files can be found in the temporary file directory and
have names like <TT>`original_file_name-#-#'</TT>.

</P>
<P>
In the future, we will fix this problem by allowing <CODE>mysqlbinlog</CODE>
to connect directly to a <CODE>mysqld</CODE> server.  Then it will be possible
to safely remove the log files automatically as soon as the <CODE>LOAD DATA
INFILE</CODE> statements have been executed.

</P>
<P>
Before MySQL 4.1, <CODE>mysqlbinlog</CODE> could not prepare output suitable for
<CODE>mysql</CODE> if the binary log contained intertwined statements originating
from different clients that used temporary tables of the same name.  This is
fixed in MySQL 4.1.

</P>



<H2><A NAME="mysqlcc" HREF="manual_toc.html#mysqlcc">8.6  <CODE>mysqlcc</CODE>, the MySQL Control Center</A></H2>

<P>
<A NAME="IDX944"></A>
<A NAME="IDX945"></A>
<A NAME="IDX946"></A>
<A NAME="IDX947"></A>
<A NAME="IDX948"></A>

</P>
<P>
<CODE>mysqlcc</CODE>, the MySQL Control Center, is a platform-independent client that
provides a graphical user interface (GUI) to the MySQL database server.
It supports interactive use, including syntax highlighting and tab completion.
It provides database and table management, and allows server administration.

</P>

<P>
<CODE>mysqlcc</CODE> is not included with MySQL distributions, but can be downloaded
separately at <a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.
Currently, <CODE>mysqlcc</CODE> runs on Windows and Linux platforms.

</P>
<P>
Invoke <CODE>mysqlcc</CODE> by double-clicking its icon in a graphical environment.
From the command line, invoke it like this:

</P>

<PRE>
shell&#62; mysqlcc [options]
</PRE>

<P>
<A NAME="IDX949"></A>
<A NAME="IDX950"></A>
<A NAME="IDX951"></A>
<A NAME="IDX952"></A>
<CODE>mysqlcc</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
<A NAME="IDX953"></A>
Display a help message and exit.

<DT><CODE>--blocking_queries, -b</CODE>
<DD>
<A NAME="IDX954"></A>
Use blocking queries.

<DT><CODE>--compress, -C</CODE>
<DD>
<A NAME="IDX955"></A>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--connection_name=name, -c name</CODE>
<DD>
<A NAME="IDX956"></A>
This option is a synonym for <CODE>--server</CODE>.

<DT><CODE>--database=db_name, -d db_name</CODE>
<DD>
<A NAME="IDX957"></A>
The database to use. This is useful mainly in an option file.

<DT><CODE>--history_size=#, -H #</CODE>
<DD>
<A NAME="IDX958"></A>
The history size for the query window.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
<A NAME="IDX959"></A>
Connect to the MySQL server on the given host.

<DT><CODE>--local-infile[={0|1}]</CODE>
<DD>
<A NAME="IDX960"></A>
Enable or disable <CODE>LOCAL</CODE> capability for <CODE>LOAD DATA INFILE</CODE>.
With no value, the option enables <CODE>LOCAL</CODE>. It may be given as
<CODE>--local-infile=0</CODE> or <CODE>--local-infile=1</CODE> to explicitly disable
or enable <CODE>LOCAL</CODE>. Enabling <CODE>LOCAL</CODE> has no effect if the server
does not also support it.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
<A NAME="IDX961"></A>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--plugins_path=name, -g name</CODE>
<DD>
<A NAME="IDX962"></A>
The path to the directory where MySQL Control Center plugins are located.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
<A NAME="IDX963"></A>
The TCP/IP port number to use for the connection.

<DT><CODE>--query, -q</CODE>
<DD>
<A NAME="IDX964"></A>
Open a query window on startup.

<DT><CODE>--register, -r</CODE>
<DD>
<A NAME="IDX965"></A>
Open the Register Server dialog on startup.

<DT><CODE>--server=name, -s name</CODE>
<DD>
<A NAME="IDX966"></A>
The MySQL Control Center connection name.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
<A NAME="IDX967"></A>
The socket file to use for the connection.

<DT><CODE>--syntax, -y</CODE>
<DD>
<A NAME="IDX968"></A>
Enable syntax highlighting and completion.

<DT><CODE>--syntax_file=name, -Y name</CODE>
<DD>
<A NAME="IDX969"></A>
The syntax file for completion.

<DT><CODE>--translations_path=name, -T name</CODE>
<DD>
<A NAME="IDX970"></A>
The path to the directory where MySQL Control Center translations are located.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
<A NAME="IDX971"></A>
The MySQL username to use when connecting to the server.

<DT><CODE>--version, -V</CODE>
<DD>
<A NAME="IDX972"></A>
Display version information and exit.

</DL>

<P>
You can also set the following variables by using <CODE>--var_name=value</CODE>
options:

</P>
<P>
<A NAME="IDX973"></A>
<A NAME="IDX974"></A>
<A NAME="IDX975"></A>
<A NAME="IDX976"></A>
<A NAME="IDX977"></A>
<A NAME="IDX978"></A>

</P>
<DL COMPACT>

<DT><CODE>connect_timeout</CODE>
<DD>
The number of seconds before connection timeout.
(Default value is 0.)

<DT><CODE>max_allowed_packet</CODE>
<DD>
The maximum packet length to send to or receive from the server.
(Default value is 16MB.)

<DT><CODE>max_join_size</CODE>
<DD>
The automatic limit for rows in a join.
(Default value is 1,000,000.)

<DT><CODE>net_buffer_length</CODE>
<DD>
The buffer size for TCP/IP and socket communication.
(Default value is 16KB.)

<DT><CODE>select_limit</CODE>
<DD>
The automatic limit for <CODE>SELECT</CODE> statements.
(Default value is 1,000.)

</DL>

<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>



<H2><A NAME="Using_mysqlcheck" HREF="manual_toc.html#Using_mysqlcheck">8.7  The <CODE>mysqlcheck</CODE> Table Maintenance and Repair Program</A></H2>

<P>
The <CODE>mysqlcheck</CODE> client checks and repairs <CODE>MyISAM</CODE> tables.  It
can also optimize and analyze tables. <CODE>mysqlcheck</CODE> is available as of
MySQL 3.23.38.

</P>
<P>
<CODE>mysqlcheck</CODE> is similar in function to <CODE>myisamchk</CODE>, but works
differently.  The main operational difference is that <CODE>mysqlcheck</CODE> must
be used when the <CODE>mysqld</CODE> server is running, whereas <CODE>myisamchk</CODE>
should be used when it is not. The benefit of using <CODE>mysqlcheck</CODE> is
that you do not have to stop the server to check or repair your tables.

</P>
<P>
<CODE>mysqlcheck</CODE> uses the SQL statements <CODE>CHECK TABLE</CODE>, <CODE>REPAIR
TABLE</CODE>, <CODE>ANALYZE TABLE</CODE>, and <CODE>OPTIMIZE TABLE</CODE> in a convenient way
for the user. It determines which statements to use for the operation you want
to perform, then sends the statements to the server to be executed.

</P>
<P>
There are three general ways to invoke <CODE>mysqlcheck</CODE>:

</P>

<PRE>
shell&#62; mysqlcheck [options] db_name [tables]
shell&#62; mysqlcheck [options] --databases DB1 [DB2 DB3...]
shell&#62; mysqlcheck [options] --all-databases
</PRE>

<P>
If you don't name any tables or use the <CODE>--databases</CODE> or
<CODE>--all-databases</CODE> option, entire databases will be checked.

</P>
<P>
<CODE>mysqlcheck</CODE> has a special feature compared to the other clients. The
default behavior of checking tables (<CODE>--check</CODE>) can be changed by renaming
the binary. If you want to have a tool that repairs tables by default, you
should just make a copy of <CODE>mysqlcheck</CODE> named <CODE>mysqlrepair</CODE>, or make
a symbolic link to <CODE>mysqlcheck</CODE> named <CODE>mysqlrepair</CODE>. If you invoke
<CODE>mysqlrepair</CODE>, it will repair tables by default.

</P>
<P>
The following names can be used to change <CODE>mysqlcheck</CODE> default behavior:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>mysqlrepair</CODE> </TD><TD> The default option will be <CODE>--repair</CODE>
</TD></TR>
<TR><TD><CODE>mysqlanalyze</CODE> </TD><TD> The default option will be <CODE>--analyze</CODE>
</TD></TR>
<TR><TD><CODE>mysqloptimize</CODE> </TD><TD> The default option will be <CODE>--optimize</CODE>
</TD></TR>
</TABLE>

<P>
<CODE>mysqlcheck</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--all-databases, -A</CODE>
<DD>
Check all tables in all databases. This is the same as using the
<CODE>--databases</CODE> option and naming all the databases on the command line.

<DT><CODE>--all-in-1, -1</CODE>
<DD>
Instead of issuing a statement for each table, execute a single statement for
each database that names all the tables from that database to be processed.

<DT><CODE>--analyze, -a</CODE>
<DD>
Analyze the tables.

<DT><CODE>--auto-repair</CODE>
<DD>
If a checked table is corrupted, automatically fix it. Any necessary repairs
are done after all tables have been checked.

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--check, -c</CODE>
<DD>
Check the tables for errors.

<DT><CODE>--check-only-changed, -C</CODE>
<DD>
Check only tables that have changed since the last check or that haven't been
closed properly.

<DT><CODE>--compress</CODE>
<DD>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--databases, -B</CODE>
<DD>
Process all tables in the named databases. With this option, all name
arguments are regarded as database names, not as table names.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--default-character-set=charset</CODE>
<DD>
Use <CODE>charset</CODE> as the default character set.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--extended, -e</CODE>
<DD>
If you are using this option to check tables, it ensures that they are
100% consistent but will take a long time.

If you are using this option to repair tables, it runs an extended
repair that may not only take a long time to execute, but
may produce a lot of garbage rows also!

<DT><CODE>--fast, -F</CODE>
<DD>
Check only tables that haven't been closed properly.

<DT><CODE>--force, -f</CODE>
<DD>
Continue even if an SQL error occurs.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Connect to the MySQL server on the given host.

<DT><CODE>--medium-check, -m</CODE>
<DD>
Do a check that is faster than an <CODE>--extended</CODE> operation.
This finds only 99.99% of all errors, which should be good enough in most cases.

<DT><CODE>--optimize, -o</CODE>
<DD>
Optimize the tables.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for the connection.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--quick, -q</CODE>
<DD>
If you are using this option to check tables, it prevents the check
from scanning the rows to check for incorrect links. This is the fastest
check method.

If you are using this option to repair tables, it tries to repair
only the index tree. This is the fastest repair method.

<DT><CODE>--repair, -r</CODE>
<DD>
Do a repair that
can fix almost anything except unique keys that aren't unique.

<DT><CODE>--silent, -s</CODE>
<DD>
Silent mode.
Print only error messages.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use for the connection.

<DT><CODE>--tables</CODE>
<DD>
Overrides the <CODE>--databases</CODE> or <CODE>-B</CODE> option. All arguments 
following the option are regarded as table names.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.
Print information about the various stages of program operation.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

</DL>



<H2><A NAME="mysqldump" HREF="manual_toc.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A></H2>

<P>
<A NAME="IDX979"></A>
<A NAME="IDX980"></A>
<A NAME="IDX981"></A>
<A NAME="IDX982"></A>

</P>
<P>
<A NAME="IDX983"></A>
The <CODE>mysqldump</CODE> client can be used
to dump a database or a collection of databases for backup or for
transferring the data to another SQL server (not necessarily a MySQL
server).  The dump will contain SQL statements to create the table
and/or populate the table.

</P>
<P>
If you are doing a backup on the server, you should consider using
the <CODE>mysqlhotcopy</CODE> instead. See section <A HREF="manual.html#mysqlhotcopy">8.9  The <CODE>mysqlhotcopy</CODE> Database Backup Program</A>.

</P>
<P>
There are three general ways to invoke <CODE>mysqldump</CODE>:

</P>

<PRE>
shell&#62; mysqldump [options] db_name [tables]
shell&#62; mysqldump [options] --databases DB1 [DB2 DB3...]
shell&#62; mysqldump [options] --all-databases
</PRE>

<P>
If you don't name any tables or use the <CODE>--databases</CODE> or
<CODE>--all-databases</CODE> option, entire databases will be dumped.

</P>
<P>
To get a list of the options your version of <CODE>mysqldump</CODE> supports,
execute <CODE>mysqldump --help</CODE>.

</P>
<P>
If you run <CODE>mysqldump</CODE> without the <CODE>--quick</CODE> or
<CODE>--opt</CODE> option, <CODE>mysqldump</CODE> will load the whole result set into
memory before dumping the result.  This will probably be a problem if
you are dumping a big database. As of MySQL 4.1, <CODE>--opt</CODE> is on by
default, but can be disabled with <CODE>--skip-opt</CODE>.

</P>
<P>
If you are using a recent copy of the <CODE>mysqldump</CODE> program
and you are going to generate a dump that will be reloaded into a very old MySQL
server, you should not use the <CODE>--opt</CODE> or <CODE>-e</CODE> options.

</P>
<P>
Out-of-range numeric values such as <CODE>-inf</CODE> and <CODE>inf</CODE>, as well
as NaN (not-a-number) values are dumped by <CODE>mysqldump</CODE> as <CODE>NULL</CODE>.
You can see this using the following sample table:

</P>

<PRE>
mysql&#62; CREATE TABLE t (f DOUBLE);
mysql&#62; INSERT INTO t VALUES(1e+111111111111111111111);
mysql&#62; INSERT INTO t VALUES(-1e111111111111111111111);
mysql&#62; SELECT f FROM t;
+------+
| f    |
+------+
|  inf |
| -inf |
+------+
</PRE>

<P>
For this table, <CODE>mysqldump</CODE> produces the following data output:

</P>

<PRE>
--
-- Dumping data for table `t`
--

INSERT INTO t VALUES (NULL);
INSERT INTO t VALUES (NULL);
</PRE>

<P>
The significance of this behavior is that if you dump and restore the
table, the new table has contents that differ from the original contents.
Note that since MySQL 4.1.2 you cannot insert <CODE>inf</CODE> in the table,
so this <CODE>mysqldump</CODE> behavior is only relevant when you deal
with old servers.

</P>
<P>
<CODE>mysqldump</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--add-drop-table</CODE>
<DD>
Add a <CODE>DROP TABLE</CODE> statement before each <CODE>CREATE TABLE</CODE> statement.

<DT><CODE>--add-locks</CODE>
<DD>
Surround each table dump with <CODE>LOCK TABLES</CODE> and <CODE>UNLOCK TABLES</CODE>
statements. This results in faster inserts when the dump file is reloaded.
See section <A HREF="manual.html#Insert_speed">7.2.12  Speed of <CODE>INSERT</CODE> Queries</A>.

<DT><CODE>--all-databases, -A</CODE>
<DD>
Dump all tables in all databases. This is the same as using the
<CODE>--databases</CODE> option and naming all the databases on the command line.

<DT><CODE>--allow-keywords</CODE>
<DD>
Allow creation of column names that are keywords.  This works by
prefixing each column name with the table name.

<DT><CODE>--comments[={0|1}]</CODE>
<DD>
If set to <CODE>0</CODE>, suppresses additional information in the dump file such
as program version, server version, and host. <CODE>--skip-comments</CODE> has the
same effect as <CODE>--comments=0</CODE>.  The default value is <CODE>1</CODE> to not
suppress the extra information.  New in MySQL 4.0.17.

<DT><CODE>--compatible=name</CODE>
<DD>
Produce output that
is compatible with other database systems or with older MySQL servers.
The value of <CODE>name</CODE> can be
<CODE>mysql323</CODE>,
<CODE>mysql40</CODE>,
<CODE>postgresql</CODE>,
<CODE>oracle</CODE>,
<CODE>mssql</CODE>,
<CODE>db2</CODE>,
<CODE>sapdb</CODE>,
<CODE>no_key_options</CODE>,
<CODE>no_table_options</CODE>,
or
<CODE>no_field_options</CODE>.
To use several values, separate them by commas.
These values have the same meaning as the corresponding options for setting
the server SQL mode.
See section <A HREF="manual.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

This option requires a server version of 4.1.0 or higher.
With older servers, it does nothing.

<DT><CODE>--complete-insert, -c</CODE>
<DD>
Use complete <CODE>INSERT</CODE> statements that include column names.

<DT><CODE>--compress, -C</CODE>
<DD>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--create-options</CODE>
<DD>
Include all MySQL-specific table options in the <CODE>CREATE TABLE</CODE> statements.
Before MySQL 4.1.2, use <CODE>--all</CODE> instead.

<DT><CODE>--databases, -B</CODE>
<DD>
To dump several databases. Note the difference in usage. In this case, no
tables are given. All name arguments on the command line are regarded as
database names.  A <CODE>USE db_name</CODE> statement is included in the
output before each new database.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--default-character-set=charset</CODE>
<DD>
Use <CODE>charset</CODE> as the default character set.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.
If not specified, <CODE>mysqldump</CODE> 10.3 (MySQL-4.1.2) or later
uses <CODE>utf8</CODE>; earlier versions use <CODE>latin1</CODE>.

<DT><CODE>--delayed</CODE>
<DD>
Insert rows using <CODE>INSERT DELAYED</CODE> statements.

<DT><CODE>--delete-master-logs</CODE>
<DD>
On a master replication server, delete the binary
logs after performing the dump operation.
This option automatically enables <CODE>--first-slave</CODE>.
It was added in MySQL 3.23.57 (for MySQL 3.23) and MySQL 4.0.13 (for MySQL
4.0).

<DT><CODE>--disable-keys, -K</CODE>
<DD>
For each table, surround the <CODE>INSERT</CODE> statements with
<CODE>/*!40000 ALTER TABLE tbl_name DISABLE KEYS */;</CODE> and
<CODE>/*!40000 ALTER TABLE tbl_name ENABLE KEYS */;</CODE> statements.
This makes loading the dump file into a MySQL 4.0 server faster because the
indexes are created after all rows are inserted.
This option is effective only for <CODE>MyISAM</CODE> tables.

<DT><CODE>--extended-insert, -e</CODE>
<DD>
Use multiple-row <CODE>INSERT</CODE> syntax that include several <CODE>VALUES</CODE> lists.
This results in a smaller dump file and speeds up inserts when the file is
reloaded.

<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
<DT><CODE>--fields-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-optionally-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-escaped-by=...</CODE>
<DD>
<DT><CODE>--lines-terminated-by=...</CODE>
<DD>
These options are used with the <CODE>-T</CODE> option and have the same
meaning as the corresponding clauses for <CODE>LOAD DATA INFILE</CODE>.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

<DT><CODE>--first-slave, -x</CODE>
<DD>
Locks all tables across all databases.

<DT><CODE>--flush-logs, -F</CODE>
<DD>
Flush the MySQL server log files before starting the dump. Note that if you
use this option in combination with the <CODE>--all-databases</CODE> (or
<CODE>-A</CODE>) option, the logs are flushed <EM>for each database dumped</EM>.

<DT><CODE>--force, -f</CODE>
<DD>
Continue even if an SQL error occurs during a table dump.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Dump data from the MySQL server on the given host. The default host
is <CODE>localhost</CODE>.

<DT><CODE>--lock-tables, -l</CODE>
<DD>
Lock all tables before starting the dump.  The tables are locked with
<CODE>READ LOCAL</CODE> to allow concurrent inserts in the case of <CODE>MyISAM</CODE>
tables.

Please note that when dumping multiple databases, <CODE>--lock-tables</CODE> locks
tables for each database separately. So, using this option will not guarantee
that the tables in the dump file will be logically consistent between
databases.  Tables in different databases may be dumped in completely
different states.

<DT><CODE>--master-data</CODE>
<DD>
This option is like <CODE>--first-slave</CODE>, but also produces <CODE>CHANGE
MASTER TO</CODE> statements that will make your slave server start from the correct
position in the master's binary logs if you use this SQL dump of the master
to set up the slave.

<DT><CODE>--no-create-db, -n</CODE>
<DD>
This option suppresses the <CODE>CREATE DATABASE /*!32312 IF NOT EXISTS*/
db_name</CODE> statements that are otherwise included in the output if the
<CODE>--databases</CODE> or <CODE>--all-databases</CODE> option is given.

<DT><CODE>--no-create-info, -t</CODE>
<DD>
Don't write <CODE>CREATE TABLE</CODE> statements that re-create each dumped table.

<DT><CODE>--no-data, -d</CODE>
<DD>
Don't write any row information for the table.  This is very useful if you
just want to get a dump of the structure for a table.

<DT><CODE>--opt</CODE>
<DD>
This option is shorthand; it is the same as specifying <CODE>--add-drop-table
--add-locks --create-options --disable-keys --extended-insert
--lock-tables --quick --set-charset</CODE>.  It should
give you a fast dump operation and produce a dump file that can be reloaded
into a MySQL server quickly. As of MySQL 4.1, <CODE>--opt</CODE> is on by default,
but can be disabled with <CODE>--skip-opt</CODE>. To disable only certain of the
options enabled by <CODE>--opt</CODE>, use their <CODE>--skip</CODE> forms; for example,
<CODE>--skip-add-drop-table</CODE> or <CODE>--skip-quick</CODE>.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for the connection.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--quick, -q</CODE>
<DD>
This option is useful for dumping large tables.
It forces <CODE>mysqldump</CODE> to retrieve rows for a table from
the server a row at a time rather than retrieving the entire row set
and buffering it in memory before writing it out.

<DT><CODE>--quote-names, -Q</CODE>
<DD>
Quote database, table, and column names within <SAMP>``'</SAMP> characters.
If the server SQL mode includes the <CODE>ANSI_QUOTES</CODE> option, names are
quoted within <SAMP>`"'</SAMP> characters.
As of MySQL 4.1.1, <CODE>--quote-names</CODE> is on by default,
but can be disabled with <CODE>--skip-quote-names</CODE>.

<DT><CODE>--result-file=file, -r file</CODE>
<DD>
Direct output to a given file. This option should be used on Windows, because
it prevents newline <SAMP>`\n'</SAMP> characters from being converted to <SAMP>`\r\n'</SAMP>
carriage return/newline sequences.

<DT><CODE>--single-transaction</CODE>
<DD>
This option issues a <CODE>BEGIN</CODE> SQL statement before dumping data from
the server. It is mostly useful with <CODE>InnoDB</CODE> tables and
<CODE>READ COMMITTED</CODE> transaction isolation level, because in this mode it
will dump the consistent state of the database at the time then
<CODE>BEGIN</CODE> was issued without blocking any applications.

When using this option, you should keep in mind that only transactional
tables will be dumped in a consistent state. For example, any <CODE>MyISAM</CODE> or
<CODE>HEAP</CODE> tables dumped while using this option may still change
state.

The <CODE>--single-transaction</CODE> option was added in version 4.0.2.
This option is mutually exclusive with the <CODE>--lock-tables</CODE> option,
because <CODE>LOCK TABLES</CODE> causes any pending transactions to be committed
implicitly.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use when connecting to <CODE>localhost</CODE> (which is the
default host).

<DT><CODE>--skip-comments</CODE>
<DD>
See the description for the <CODE>--comments</CODE> option.

<DT><CODE>--tab=path, -T path</CODE>
<DD>
Produces tab-separated data files.  For each dumped table, <CODE>mysqldump</CODE>
creates a <TT>`tbl_name.sql'</TT> file that contains the <CODE>CREATE TABLE</CODE>
statement that creates the table, and a <TT>`tbl_name.txt'</TT> file that
contains its data.  The option value is the directory in which to write the
files.

By default, the <TT>`.txt'</TT> data files are formatted using tab characters
between column values and a newline at the end of each line.  The format can
be specified explicitly using the <CODE>--fields-xxx</CODE> and
<CODE>--lines--xxx</CODE> options.

<STRONG>Note:</STRONG> This option should be used only when <CODE>mysqldump</CODE> is run
on the same machine as the <CODE>mysqld</CODE> server. You must use a MySQL
account that has the <CODE>FILE</CODE> privilege, and the server must have
permission to write files in the directory you specify.

<DT><CODE>--tables</CODE>
<DD>
Overrides the <CODE>--databases</CODE> or <CODE>-B</CODE> option. All arguments 
following the option are regarded as table names.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Print out more information on what the program does.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

<DT><CODE>--where='where-condition', -w 'where-condition'</CODE>
<DD>
Dump only records selected by the given <CODE>WHERE</CODE> condition.  Note that
quotes around the condition are mandatory if it contains spaces or
characters that are special to your command interpreter.

Examples:


<PRE>
"--where=user='jimf'"
"-wuserid&#62;1"
"-wuserid&#60;1"
</PRE>

<DT><CODE>--xml, -X</CODE>
<DD>
Write dump output as well-formed XML.

</DL>

<P>
You can also set the following variables by using <CODE>--var_name=value</CODE>
options:

</P>
<DL COMPACT>

<DT><CODE>max_allowed_packet</CODE>
<DD>
The maximum size of the buffer for client/server communication.
The value of the variable can be up to 16MB before MySQL 4.0, and
up to 1GB from MySQL 4.0 on.
When creating multiple-row-insert statements (as with option
<CODE>--extended-insert</CODE> or <CODE>--opt</CODE>), <CODE>mysqldump</CODE> will create
rows up to <CODE>max_allowed_packet</CODE> length. If you increase this
variable, you should also ensure that the <CODE>max_allowed_packet</CODE>
variable in the MySQL server is at least this large.

<DT><CODE>net_buffer_length</CODE>
<DD>
The initial size of the buffer for client/server communication.

</DL>

<P>
It is also possible to set variables by using
<CODE>--set-variable=var_name=value</CODE> or <CODE>-O var_name=value</CODE>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
The most common use of <CODE>mysqldump</CODE> is probably for making a backup of
entire databases.

</P>

<PRE>
shell&#62; mysqldump --opt db_name &#62; backup-file.sql
</PRE>

<P>
You can read the dump file back into the server with:

</P>

<PRE>
shell&#62; mysql db_name &#60; backup-file.sql
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysql -e "source /path-to-backup/backup-file.sql" db_name
</PRE>

<P>
<CODE>mysqldump</CODE> is also very useful for populating databases by copying
data from one MySQL server to another:

</P>

<PRE>
shell&#62; mysqldump --opt db_name | mysql --host=remote-host -C db_name
</PRE>

<P>
It is possible to dump several databases with one command:

</P>

<PRE>
shell&#62; mysqldump --databases db_name1 [db_name2 ...] &#62; my_databases.sql
</PRE>

<P>
If you want to dump all databases, use the <CODE>--all-databases</CODE> option:

</P>

<PRE>
shell&#62; mysqldump --all-databases &#62; all_databases.sql
</PRE>

<P>
For more information on making backups, see section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>.

</P>



<H2><A NAME="mysqlhotcopy" HREF="manual_toc.html#mysqlhotcopy">8.9  The <CODE>mysqlhotcopy</CODE> Database Backup Program</A></H2>

<P>
<A NAME="IDX984"></A>
<A NAME="IDX985"></A>
<A NAME="IDX986"></A>
<A NAME="IDX987"></A>

</P>
<P>
<CODE>mysqlhotcopy</CODE> is a Perl script that uses <CODE>LOCK TABLES</CODE>,
<CODE>FLUSH TABLES</CODE>, and <CODE>cp</CODE> or <CODE>scp</CODE> to quickly make a backup of
a database.  It's the fastest way to make a backup of the database or single
tables, but it can be run only on the same machine where the database
directories are located.  <CODE>mysqlhotcopy</CODE> works only for backing up
<CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables. It runs on Unix, and on NetWare as of
MySQL 4.0.18.

</P>


<PRE>
shell&#62; mysqlhotcopy db_name [/path/to/new_directory]
</PRE>


<PRE>
shell&#62; mysqlhotcopy db_name_1 ... db_name_n /path/to/new_directory
</PRE>


<PRE>
shell&#62; mysqlhotcopy db_name./regex/
</PRE>

<P>
<CODE>mysqlhotcopy</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--allowold</CODE>
<DD>
Don't abort if target already exists (rename it by adding an <CODE>_old</CODE>
suffix).

<DT><CODE>--checkpoint=db_name.tbl_name</CODE>
<DD>
Insert checkpoint entries into the specified <CODE>db_name.tbl_name</CODE>.

<DT><CODE>--debug</CODE>
<DD>
Enable debug output.

<DT><CODE>--dryrun, -n</CODE>
<DD>
Report actions without doing them.

<DT><CODE>--flushlog</CODE>
<DD>
Flush logs after all tables are locked.

<DT><CODE>--keepold</CODE>
<DD>
Don't delete previous (now renamed) target when done.

<DT><CODE>--method=#</CODE>
<DD>
Method for copy (<CODE>cp</CODE> or <CODE>scp</CODE>).

<DT><CODE>--noindices</CODE>
<DD>
Don't include full index files in the backup. This makes the backup smaller
and faster.  The indexes can be reconstructed later with <CODE>myisamchk -rq</CODE>.

<DT><CODE>--password=password, -ppassword</CODE>
<DD>
The password to use when connecting to the server.  Note that the password
value is not optional for this option, unlike for other MySQL clients.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use when connecting to the local server.

<DT><CODE>--quiet, -q</CODE>
<DD>
Be silent except for errors.

<DT><CODE>--regexp=expr</CODE>
<DD>
Copy all databases with names matching the given regular expression.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The Unix socket file to use for the connection.

<DT><CODE>--suffix=str</CODE>
<DD>
The suffix for names of copied databases.

<DT><CODE>--tmpdir=path</CODE>
<DD>
The temporary directory (instead of <TT>`/tmp'</TT>).

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

</DL>

<P>
<CODE>mysqlhotcopy</CODE> reads the <CODE>[client]</CODE> and  <CODE>[mysqlhotcopy]</CODE>
option groups from option files.

</P>
<P>
To execute <CODE>mysqlhotcopy</CODE>, you must have access to the files
for the tables that you are backing up, the <CODE>SELECT</CODE> privilege
for those tables, and the <CODE>RELOAD</CODE> privilege (to be able to
execute <CODE>FLUSH TABLES</CODE>).

</P>
<P>
Use <CODE>perldoc</CODE> for additional <CODE>mysqlhotcopy</CODE> documentation:

</P>

<PRE>
shell&#62; perldoc mysqlhotcopy
</PRE>



<H2><A NAME="mysqlimport" HREF="manual_toc.html#mysqlimport">8.10  The <CODE>mysqlimport</CODE> Data Import Program</A></H2>

<P>
<A NAME="IDX988"></A>
<A NAME="IDX989"></A>
<A NAME="IDX990"></A>
<A NAME="IDX991"></A>
<A NAME="IDX992"></A>

</P>
<P>
The <CODE>mysqlimport</CODE> client provides a command-line interface to the
<CODE>LOAD DATA INFILE</CODE> SQL statement.  Most options to <CODE>mysqlimport</CODE>
correspond directly to clauses of <CODE>LOAD DATA INFILE</CODE>.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

</P>
<P>
Invoke <CODE>mysqlimport</CODE> like this:

</P>

<PRE>
shell&#62; mysqlimport [options] db_name textfile1 [textfile2 ...]
</PRE>

<P>
For each text file named on the command line, <CODE>mysqlimport</CODE> strips any
extension from the filename and uses the result to determine the name of the
table into which to import the file's contents.  For example, files named
<TT>`patient.txt'</TT>, <TT>`patient.text'</TT>, and <TT>`patient'</TT> all would be
imported into a table named <CODE>patient</CODE>.

</P>
<P>
<CODE>mysqlimport</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--columns=column_list, -c column_list</CODE>
<DD>
This option takes a comma-separated list of column names as its value. The
order of the column names indicates how to match up data file columns with
table columns.

<DT><CODE>--compress, -C</CODE>
<DD>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--delete, -D</CODE>
<DD>
Empty the table before importing the text file.

<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
<DT><CODE>--fields-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-optionally-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-escaped-by=...</CODE>
<DD>
<DT><CODE>--lines-terminated-by=...</CODE>
<DD>
These options have the same meaning as the corresponding clauses for
<CODE>LOAD DATA INFILE</CODE>. See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

<DT><CODE>--force, -f</CODE>
<DD>
Ignore errors.  For example, if a table for a text file doesn't exist,
continue processing any remaining files.  Without <CODE>--force</CODE>,
<CODE>mysqlimport</CODE> exits if a table doesn't exist.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Import data to the MySQL server on the given host. The default host
is <CODE>localhost</CODE>.

<DT><CODE>--ignore, -i</CODE>
<DD>
See the description for the <CODE>--replace</CODE> option.

<DT><CODE>--ignore-lines=n</CODE>
<DD>
Ignore the first <CODE>n</CODE> lines of the data file.

<DT><CODE>--local, -L</CODE>
<DD>
Read input files from the client host.  By default, text files are assumed to be on
the server host if you connect to <CODE>localhost</CODE> (which is the default host).

<DT><CODE>--lock-tables, -l</CODE>
<DD>
Lock <EM>all</EM> tables for writing before processing any text files. This
ensures that all tables are synchronized on the server.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for the connection.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--replace, -r</CODE>
<DD>
The <CODE>--replace</CODE> and <CODE>--ignore</CODE> options control handling of input
records that duplicate existing records on unique key values.  If you specify
<CODE>--replace</CODE>, new rows replace existing rows that have the same unique key
value. If you specify <CODE>--ignore</CODE>, input rows that duplicate an existing
row on a unique key value are skipped.  If you don't specify either option, an
error occurs when a duplicate key value is found, and the rest of the text
file is ignored.

<DT><CODE>--silent, -s</CODE>
<DD>
Silent mode.  Produce output only when errors occur.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use when connecting to <CODE>localhost</CODE> (which is the
default host).

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Print out more information what the program does.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

</DL>

<P>
Here is a sample session that demonstrates use of <CODE>mysqlimport</CODE>:

</P>

<PRE>
shell&#62; mysql -e 'CREATE TABLE imptest(id INT, n VARCHAR(30))' test
shell&#62; ed
a
100     Max Sydow
101     Count Dracula
.
w imptest.txt
32
q
shell&#62; od -c imptest.txt
0000000   1   0   0  \t   M   a   x       S   y   d   o   w  \n   1   0
0000020   1  \t   C   o   u   n   t       D   r   a   c   u   l   a  \n
0000040
shell&#62; mysqlimport --local test imptest.txt
test.imptest: Records: 2  Deleted: 0  Skipped: 0  Warnings: 0
shell&#62; mysql -e 'SELECT * FROM imptest' test
+------+---------------+
| id   | n             |
+------+---------------+
|  100 | Max Sydow     |
|  101 | Count Dracula |
+------+---------------+
</PRE>



<H2><A NAME="mysqlshow" HREF="manual_toc.html#mysqlshow">8.11  <CODE>mysqlshow</CODE>, Showing Databases, Tables, and Columns</A></H2>

<P>
<A NAME="IDX993"></A>
<A NAME="IDX994"></A>
<A NAME="IDX995"></A>
<A NAME="IDX996"></A>
<A NAME="IDX997"></A>

</P>
<P>
The <CODE>mysqlshow</CODE> client can be used to quickly look at which databases
exist, their tables, and a table's columns or indexes.

</P>
<P>
<CODE>mysqlshow</CODE> provides a command-line interface to several SQL
<CODE>SHOW</CODE> statements.  The same information can be obtained by using those
statements directly.  For example, you can issue them from the <CODE>mysql</CODE>
client program.
See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

</P>
<P>
Invoke <CODE>mysqlshow</CODE> like this:

</P>

<PRE>
shell&#62; mysqlshow [options] [db_name [tbl_name [col_name]]]
</PRE>


<UL>
<LI>

If no database is given, all matching databases are shown.
<LI>

If no table is given, all matching tables in the database are shown.
<LI>

If no column is given, all matching columns and column types in the table
are shown.
</UL>

<P>
Note that in newer MySQL versions, you see only those
database, tables, or columns for which you have some privileges.

</P>
<P>
If the last argument contains shell or SQL wildcard characters (<SAMP>`*'</SAMP>,
<SAMP>`?'</SAMP>, <SAMP>`%'</SAMP>, or <SAMP>`_'</SAMP>), only those names that are matched by the
wildcard are shown.  If a database name contains any underscores, those
should be escaped with a backslash (some Unix shells will require two) in
order to get a list of the proper tables or columns. <SAMP>`*'</SAMP> and <SAMP>`?'</SAMP>
characters are converted into SQL <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> wildcard characters.
This might cause some confusion when you try to display the columns for a
table with a <SAMP>`_'</SAMP> in the name, because in this case <CODE>mysqlshow</CODE>
shows you only the table names that match the pattern.  This is easily fixed
by adding an extra <SAMP>`%'</SAMP> last on the command line as a separate
argument.

</P>
<P>
<CODE>mysqlshow</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--help, -?</CODE>
<DD>
Display a help message and exit.

<DT><CODE>--character-sets-dir=path</CODE>
<DD>
The directory where character sets are installed.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--compress, -C</CODE>
<DD>
Compress all information sent between the client and the server if both
support compression.

<DT><CODE>--debug[=debug_options], -# [debug_options]</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>--default-character-set=charset</CODE>
<DD>
Use <CODE>charset</CODE> as the default character set.  See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<DT><CODE>--host=host_name, -h host_name</CODE>
<DD>
Connect to the MySQL server on the given host.

<DT><CODE>--keys, -k</CODE>
<DD>
Show table indexes.

<DT><CODE>--password[=password], -p[password]</CODE>
<DD>
The password to use when connecting to the server.  Note that if you use the
short option form (<CODE>-p</CODE>), you <EM>cannot</EM> have a space between the
option and the password.  If no password is given on the command line,
you will be prompted for one.

<DT><CODE>--port=port_num, -P port_num</CODE>
<DD>
The TCP/IP port number to use for the connection.

<DT><CODE>--protocol={TCP | SOCKET | PIPE | MEMORY}</CODE>
<DD>
The connection protocol to use.  New in MySQL 4.1.

<DT><CODE>--socket=path, -S path</CODE>
<DD>
The socket file to use when connecting to <CODE>localhost</CODE> (which is the
default host).

<DT><CODE>--status, -i</CODE>
<DD>
Display extra information about each table.

<DT><CODE>--user=user_name, -u user_name</CODE>
<DD>
The MySQL username to use when connecting to the server.

<DT><CODE>--verbose, -v</CODE>
<DD>
Verbose mode.  Print out more information what the program does.
This option can be used multiple times to increase the amount of information.

<DT><CODE>--version, -V</CODE>
<DD>
Display version information and exit.

</DL>



<H2><A NAME="perror" HREF="manual_toc.html#perror">8.12  <CODE>perror</CODE>, Explaining Error Codes</A></H2>

<P>
<A NAME="IDX998"></A>
<A NAME="IDX999"></A>

</P>
<P>
<A NAME="IDX1000"></A>
<A NAME="IDX1001"></A>

</P>
<P>
For most system errors, MySQL displays, in addition to an internal text
message, the system error code in one of the following styles:

</P>

<PRE>
message ... (errno: #)
message ... (Errcode: #)
</PRE>

<P>
You can find out what the error code means by either examining the
documentation for your system or by using the <CODE>perror</CODE> utility.

</P>
<P>
<CODE>perror</CODE> prints a description for a system error code or for a storage
engine (table handler) error code.

</P>
<P>
Invoke <CODE>perror</CODE> like this:

</P>

<PRE>
shell&#62; perror [options] errorcode ...
</PRE>

<P>
Example:

</P>

<PRE>
shell&#62; perror 13 64
Error code  13:  Permission denied
Error code  64:  Machine is not on the network
</PRE>

<P>
Note that the meaning of system error messages may be dependent on your
operating system. A given error code may mean different things on different
operating systems.

</P>



<H2><A NAME="replace_utility" HREF="manual_toc.html#replace_utility">8.13  The <CODE>replace</CODE> String-replacement Utility</A></H2>

<P>
<A NAME="IDX1002"></A>
<A NAME="IDX1003"></A>

</P>
<P>
The <CODE>replace</CODE> utility program changes strings in place in files or on
the standard input. It uses a finite state machine to match longer strings
first. It can be used to swap strings. For example, the following command
swaps <CODE>a</CODE> and <CODE>b</CODE> in the given files, <TT>`file1'</TT> and <TT>`file2'</TT>:

</P>

<PRE>
shell&#62; replace a b b a -- file1 file2 ...
</PRE>

<P>
Use the <CODE>--</CODE> option to indicate where the string-replacement list
ends and the filenames begin.

</P>
<P>
Any file named on the command line is modified in place, so you may want to
make a copy of the original before converting it.

</P>
<P>
If no files are named on the command line, <CODE>replace</CODE> reads the standard
input and writes to the standard output.  In this case, no <CODE>--</CODE> option is
needed.

</P>
<P>
The <CODE>replace</CODE> program is used by <CODE>msql2mysql</CODE>.
See section <A HREF="manual.html#msql2mysql">20.1.1  <CODE>msql2mysql</CODE>, Convert mSQL Programs for Use with MySQL</A>.

</P>
<P>
<CODE>replace</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>-?, -I</CODE>
<DD>
Display a help message and exit.

<DT><CODE>-# debug_options</CODE>
<DD>
Write a debugging log. The <CODE>debug_options</CODE> string often is
<CODE>'d:t:o,file_name'</CODE>.

<DT><CODE>-s</CODE>
<DD>
Silent mode.  Print out less information what the program does.

<DT><CODE>-v</CODE>
<DD>
Verbose mode.  Print out more information what the program does.

<DT><CODE>-V</CODE>
<DD>
Display version information and exit.

</DL>



<H1><A NAME="Reference" HREF="manual_toc.html#Reference">9  MySQL Language Reference</A></H1>

<P>
MySQL has a very complex, but intuitive and easy to learn SQL
interface.  The next several chapters of the manual comprise a language
reference. They describe the various commands, types,
and functions you will need to know in order to use MySQL efficiently and
effectively.  These chapters also serve as a reference to all functionality
included in MySQL. The material they contain is grouped by topic:

</P>

<UL>
<LI>

See section <A HREF="manual.html#Language_Structure">10  Language Structure</A> for information about how to write data values,
identifiers, and comments.

<LI>

See section <A HREF="manual.html#Column_types">12  Column Types</A> for information about the various column types that
MySQL supports for storing data in tables.

<LI>

See section <A HREF="manual.html#Functions">13  Functions and Operators</A> for a list of the functions and operators that you can
use when writing expressions.

<LI>

See section <A HREF="manual.html#SQL_Syntax">14  SQL Statement Syntax</A> for descriptions of the SQL statements that MySQL
supports.

</UL>

<P>
In order to use this material most effectively, you may find
it useful to refer to the various indexes.

</P>



<H1><A NAME="Language_Structure" HREF="manual_toc.html#Language_Structure">10  Language Structure</A></H1>

<P>
This chapter discusses the rules for writing the following elements of SQL
statements when using MySQL:

</P>

<UL>

<LI>

Literal values such as strings and numbers

<LI>

Identifiers such as table and column names

<LI>

User and system variables

<LI>

Comments

<LI>

Reserved words

</UL>



<H2><A NAME="Literals" HREF="manual_toc.html#Literals">10.1  Literal Values</A></H2>

<P>
<A NAME="IDX1004"></A>
<A NAME="IDX1005"></A>
<A NAME="IDX1006"></A>
<A NAME="IDX1007"></A>
<A NAME="IDX1008"></A>

</P>

<P>
This section describes how to write literal values in MySQL. These include
strings, numbers, hexadecimal values, boolean values, and <CODE>NULL</CODE>. The section also
covers the various nuances and ``gotchas'' that
you may run into when dealing with these basic types in MySQL.

</P>



<H3><A NAME="String_syntax" HREF="manual_toc.html#String_syntax">10.1.1  Strings</A></H3>

<P>
A string is a sequence of characters, surrounded by either single quote
(<SAMP>`''</SAMP>) or double quote (<SAMP>`"'</SAMP>) characters.  Examples:

</P>

<PRE>
'a string'
"another string"
</PRE>

<P>
If the server SQL mode has <CODE>ANSI_QUOTES</CODE> enabled, string literals can be
quoted only with single quotes. A string quoted with double quotes will be
interpreted as an identifier.

</P>
<P>
As of MySQL 4.1.1, string literals may have an optional character set
introducer and <CODE>COLLATE</CODE> clause:

</P>
<P>
<A NAME="IDX1009"></A>
<A NAME="IDX1010"></A>

</P>

<PRE>
[_charset_name]'string' [COLLATE collation_name]
</PRE>

<P>
Examples:

<PRE>
SELECT _latin1'string';
SELECT _latin1'string' COLLATE latin1_danish_ci;
</PRE>

<P>
For more information about these forms of string syntax, see
section <A HREF="manual.html#Charset-literal">11.3.7  Character String Literal Character Set and Collation</A>.

</P>
<P>
Within a string, certain sequences have special meaning.  Each of these
sequences begins with a backslash (<SAMP>`\'</SAMP>), known as the <EM>escape
character</EM>.  MySQL recognizes the following escape sequences:

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>\0</CODE>
@tab An ASCII 0 (<CODE>NUL</CODE>) character.

</TD></TR>
<TR><TD><CODE>\'</CODE>
<A NAME="IDX1011"></A>
 <A NAME="IDX1012"></A>
 
@tab A single quote (<SAMP>`''</SAMP>) character.

</TD></TR>
<TR><TD><CODE>\"</CODE>
<A NAME="IDX1013"></A>
 <A NAME="IDX1014"></A>
 
@tab A double quote (<SAMP>`"'</SAMP>) character.

</TD></TR>
<TR><TD><CODE>\b</CODE>
<A NAME="IDX1015"></A>
 <A NAME="IDX1016"></A>
 
@tab A backspace character.

</TD></TR>
<TR><TD><CODE>\n</CODE>
<A NAME="IDX1017"></A>
 <A NAME="IDX1018"></A>
 
@tab A newline (linefeed) character.

</TD></TR>
<TR><TD><CODE>\r</CODE>
<A NAME="IDX1019"></A>
 <A NAME="IDX1020"></A>
 <A NAME="IDX1021"></A>
 <A NAME="IDX1022"></A>
 
@tab A carriage return character.

</TD></TR>
<TR><TD><CODE>\t</CODE>
<A NAME="IDX1023"></A>
 <A NAME="IDX1024"></A>
 <A NAME="IDX1025"></A>
 
@tab A tab character.

</TD></TR>
<TR><TD><CODE>\z</CODE>
<A NAME="IDX1026"></A>
 <A NAME="IDX1027"></A>
 
@tab ASCII 26 (Control-Z).  This character can be encoded as <SAMP>`\z'</SAMP>
to allow you to
work around the problem that ASCII 26 stands for END-OF-FILE on Windows.
(ASCII 26 will cause problems if you try to use
<CODE>mysql db_name &#60; file_name</CODE>.)

</TD></TR>
<TR><TD><CODE>\\</CODE>
<A NAME="IDX1028"></A>
 <A NAME="IDX1029"></A>
 
@tab A backslash (<SAMP>`\'</SAMP>) character.

</TD></TR>
<TR><TD><CODE>\%</CODE>
<A NAME="IDX1030"></A>
 <A NAME="IDX1031"></A>
 
@tab A <SAMP>`%'</SAMP> character. See note following table.

</TD></TR>
<TR><TD><CODE>\_</CODE>
<A NAME="IDX1032"></A>
 <A NAME="IDX1033"></A>
 
@tab A <SAMP>`_'</SAMP> character. See note following table.

</TD></TR>
</TABLE>

<P>
These sequences are case sensitive. For example, <SAMP>`\b'</SAMP> is interpreted as
a backslash, but <SAMP>`\B'</SAMP> is interpreted as <SAMP>`B'</SAMP>.

</P>
<P>
The <SAMP>`\%'</SAMP> and <SAMP>`\_'</SAMP> sequences are used to search for literal
instances of <SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> in pattern-matching contexts where
they would otherwise be interpreted as wildcard characters. See section <A HREF="manual.html#String_comparison_functions">13.3.1  String Comparison Functions</A>.
Note that if you use <SAMP>`\%'</SAMP> or <SAMP>`\_'</SAMP> in other contexts, they
return the strings <SAMP>`\%'</SAMP> and <SAMP>`\_'</SAMP> and not <SAMP>`%'</SAMP> and
<SAMP>`_'</SAMP>.

</P>
<P>
In all other escape sequences, backslash is ignored.  That is,
the escaped character is interpreted as if it was not escaped.

</P>
<P>
<A NAME="IDX1036"></A>
There are several ways to include quotes within a string:

</P>

<UL>
<LI>

<A NAME="IDX1034"></A>
 <A NAME="IDX1035"></A>
 
A <SAMP>`''</SAMP> inside a string quoted with <SAMP>`''</SAMP> may be written as <SAMP>`'''</SAMP>.

<LI>

A <SAMP>`"'</SAMP> inside a string quoted with <SAMP>`"'</SAMP> may be written as <SAMP>`""'</SAMP>.

<LI>

You can precede the quote character with an escape character (<SAMP>`\'</SAMP>).

<LI>

A <SAMP>`''</SAMP> inside a string quoted with <SAMP>`"'</SAMP> needs no special treatment
and need not be doubled or escaped.  In the same way, <SAMP>`"'</SAMP> inside a
string quoted with <SAMP>`''</SAMP> needs no special treatment.
</UL>

<P>
The following <CODE>SELECT</CODE> statements demonstrate how quoting and
escaping work:

</P>

<PRE>
mysql&#62; SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+

mysql&#62; SELECT "hello", "'hello'", "''hello''", "hel""lo", "\"hello";
+-------+---------+-----------+--------+--------+
| hello | 'hello' | ''hello'' | hel"lo | "hello |
+-------+---------+-----------+--------+--------+

mysql&#62; SELECT 'This\nIs\nFour\nLines';
+--------------------+
| This
Is
Four
Lines |
+--------------------+

mysql&#62; SELECT 'disappearing\ backslash';
+------------------------+
| disappearing backslash |
+------------------------+
</PRE>

<P>
<A NAME="IDX1037"></A>

</P>
<P>
If you want to insert binary data into a string column (such as a
<CODE>BLOB</CODE>), the following characters must be represented by escape
sequences:

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><CODE>NUL</CODE>
@tab <CODE>NUL</CODE> byte (ASCII 0).
Represent this character by <SAMP>`\0'</SAMP> (a backslash followed by an ASCII <SAMP>`0'</SAMP> character).

</TD></TR>
<TR><TD><CODE>\</CODE>
@tab Backslash (ASCII 92).  Represent this character by <SAMP>`\\'</SAMP>.

</TD></TR>
<TR><TD><CODE>'</CODE>
@tab Single quote (ASCII 39).  Represent this character by <SAMP>`\''</SAMP>.

</TD></TR>
<TR><TD><CODE>"</CODE>
@tab Double quote (ASCII 34).  Represent this character by <SAMP>`\"'</SAMP>.

</TD></TR>
</TABLE>

<P>
<A NAME="IDX1038"></A>
<A NAME="IDX1039"></A>
<A NAME="IDX1040"></A>
<A NAME="IDX1041"></A>
When writing application programs, any string that might contain any of these
special characters
must be properly escaped before the string is used as a data value in an SQL
statement that is sent to the MySQL server.
You can do this in two ways:

</P>

<UL>
<LI>

Process the string with a function that escapes the special characters.
For example, in a C program, you can use the C API function
<CODE>mysql_real_escape_string()</CODE> to escape characters.
See section <A HREF="manual.html#mysql_real_escape_string">20.2.3.184  <CODE>mysql_real_escape_string()</CODE></A>.
The Perl DBI interface provides a
<CODE>quote</CODE> method to convert special characters to the proper escape
sequences.  See section <A HREF="manual.html#Perl">20.6  MySQL Perl API</A>.

<LI>

As an alternative to explicitly escaping special characters,
many MySQL APIs provide a placeholder capability
that allows you to insert special markers into a query string, and then bind
data values to them when you issue the query.  In this case, the API takes
care of escaping special characters in the values for you.

</UL>



<H3><A NAME="Number_syntax" HREF="manual_toc.html#Number_syntax">10.1.2  Numbers</A></H3>

<P>
<A NAME="IDX1042"></A>
<A NAME="IDX1043"></A>
<A NAME="IDX1044"></A>
<A NAME="IDX1045"></A>
<A NAME="IDX1046"></A>
<A NAME="IDX1047"></A>
<A NAME="IDX1048"></A>

</P>
<P>
Integers are represented as a sequence of digits. Floats use <SAMP>`.'</SAMP> as a
decimal separator.  Either type of number may be preceded by <SAMP>`-'</SAMP> to
indicate a negative value.

</P>
<P>
Examples of valid integers:

</P>

<PRE>
1221
0
-32
</PRE>

<P>
Examples of valid floating-point numbers:

</P>

<PRE>
294.42
-32032.6809e+10
148.00
</PRE>

<P>
An integer may be used in a floating-point context; it is interpreted
as the equivalent floating-point number.

</P>



<H3><A NAME="Hexadecimal_values" HREF="manual_toc.html#Hexadecimal_values">10.1.3  Hexadecimal Values</A></H3>

<P>
<A NAME="IDX1049"></A>

</P>
<P>
MySQL supports hexadecimal values.  In numeric contexts, these act
like integers (64-bit precision). In string contexts, these act like binary
strings, where each pair of hex digits is converted to a character:

</P>

<PRE>
mysql&#62; SELECT x'4D7953514C';
        -&#62; 'MySQL'
mysql&#62; SELECT 0xa+0;
        -&#62; 10
mysql&#62; SELECT 0x5061756c;
        -&#62; 'Paul'
</PRE>

<P>
In MySQL 4.1 (and in MySQL 4.0 when using the <CODE>--new</CODE> option), the default
type of of a hexadecimal value is a string.  If you want to ensure that
the value is treated as a number, you can use <CODE>CAST(... AS UNSIGNED)</CODE>:

</P>

<PRE>
mysql&#62; SELECT 0x41, CAST(0x41 AS UNSIGNED);
        -&#62; 'A', 65
</PRE>

<P>
The <CODE>0x</CODE> syntax is based on ODBC.  Hexadecimal strings are often used by
ODBC to supply values for <CODE>BLOB</CODE> columns.
The <CODE>x'hexstring'</CODE> syntax is new in 4.0 and is based on standard SQL.

</P>
<P>
Beginning with MySQL 4.0.1, you can convert a string or a number to a string
in hexadecimal format with the <CODE>HEX()</CODE> function:

</P>

<PRE>
mysql&#62; SELECT HEX('cat');
        -&#62; '636174'
mysql&#62; SELECT 0x636174;
        -&#62; 'cat'
</PRE>



<H3><A NAME="Boolean_values" HREF="manual_toc.html#Boolean_values">10.1.4  Boolean Values</A></H3>

<P>
Beginning with MySQL 4.1, the constant <CODE>TRUE</CODE> evaluates to <CODE>1</CODE> and
the constant <CODE>FALSE</CODE> evaluates to <CODE>0</CODE>. The constant names can be
written in any lettercase.

</P>

<PRE>
mysql&#62; SELECT TRUE, true, FALSE, false;
        -&#62; 1, 1, 0, 0
</PRE>



<H3><A NAME="NULL_values" HREF="manual_toc.html#NULL_values">10.1.5  <CODE>NULL</CODE> Values</A></H3>

<P>
<A NAME="IDX1050"></A>

</P>
<P>
The <CODE>NULL</CODE> value means ``no data.''
<CODE>NULL</CODE> can be written in any lettercase.

</P>
<P>
Be aware that the <CODE>NULL</CODE> value is different than values such
as <CODE>0</CODE> for numeric types or the empty string for string types.
See section <A HREF="manual.html#Problems_with_NULL">A.5.3  Problems with <CODE>NULL</CODE> Values</A>.

</P>
<P>
For text file import or export operations performed with <CODE>LOAD DATA
INFILE</CODE> or <CODE>SELECT ... INTO OUTFILE</CODE>, <CODE>NULL</CODE> is represented by
the <CODE>\N</CODE> sequence.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

</P>



<H2><A NAME="Legal_names" HREF="manual_toc.html#Legal_names">10.2  Database, Table, Index, Column, and Alias Names</A></H2>

<P>
<A NAME="IDX1051"></A>
<A NAME="IDX1052"></A>
<A NAME="IDX1053"></A>
<A NAME="IDX1054"></A>
<A NAME="IDX1055"></A>
<A NAME="IDX1056"></A>
<A NAME="IDX1057"></A>
<A NAME="IDX1058"></A>

</P>
<P>
Database, table, index, column, and alias names are identifiers.
This section describes the allowable syntax for identifiers in MySQL.

</P>
<P>
The following table describes the maximum length and allowable characters for
each type of identifier.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Identifier</STRONG> </TD><TD> <STRONG>Maximum Length (bytes)</STRONG> </TD><TD> <STRONG>Allowed Characters</STRONG>
</TD></TR>
<TR><TD>Database </TD><TD> 64 </TD><TD> Any character that is allowed in a directory name except <SAMP>`/'</SAMP>, <SAMP>`\'</SAMP>, or <SAMP>`.'</SAMP>
</TD></TR>
<TR><TD>Table </TD><TD> 64 </TD><TD> Any character that is allowed in a filename, except <SAMP>`/'</SAMP>, <SAMP>`\'</SAMP>, or <SAMP>`.'</SAMP>
</TD></TR>
<TR><TD>Column </TD><TD> 64 </TD><TD> All characters
</TD></TR>
<TR><TD>Index </TD><TD> 64 </TD><TD> All characters
</TD></TR>
<TR><TD>Alias </TD><TD> 255 </TD><TD> All characters
</TD></TR>
</TABLE>

<P>
In addition to the restrictions noted in the table, no identifier can contain
ASCII 0 or a byte with a value of 255. Before MySQL 4.1, identifier quote
characters should not be used in identifiers.

</P>
<P>
Beginning with MySQL 4.1, identifiers are stored using Unicode (UTF8).
This applies to identifiers in table definitions that stored in <TT>`.frm'</TT>
files and to identifiers stored in the grant tables in the <CODE>mysql</CODE>
database. Although Unicode identifiers can include multi-byte characters, note
that the maximum lengths shown in the table are byte counts. If an identifier
does contain multi-byte characters, the number of <EM>characters</EM> allowed in
the identifier is less than the value shown in the table.

</P>
<P>
<A NAME="IDX1059"></A>
<A NAME="IDX1060"></A>
<A NAME="IDX1061"></A>
<A NAME="IDX1062"></A>

</P>
<P>
An identifier may be quoted or unquoted.  If an identifier is a reserved
word or contains special characters, you <EM>must</EM> quote it whenever you
refer to it.  For a list of reserved words, see section <A HREF="manual.html#Reserved_words">10.6  Treatment of Reserved Words in MySQL</A>.
Special characters are those outside the set of alphanumeric characters from
the current character set, <SAMP>`_'</SAMP>, and <SAMP>`$'</SAMP>.

</P>
<P>
The quote character is the backtick (<SAMP>``'</SAMP>):

</P>

<PRE>
mysql&#62; SELECT * FROM `select` WHERE `select`.id &#62; 100;
</PRE>

<P>
If the server SQL mode includes the <CODE>ANSI_QUOTES</CODE> mode option,
it is also allowable to quote identifiers with double quotes:

</P>

<PRE>
mysql&#62; CREATE TABLE "test" (col INT);
ERROR 1064: You have an error in your SQL syntax. (...)
mysql&#62; SET sql_mode='ANSI_QUOTES';
mysql&#62; CREATE TABLE "test" (col INT);
Query OK, 0 rows affected (0.00 sec)
</PRE>

<P>
See section <A HREF="manual.html#SQL_mode">1.8.2  Selecting SQL Modes</A>.

</P>
<P>
As of MySQL 4.1, identifier quote characters can be included within an
identifier by quoting the identifier. If the character to be included within
the identifier is the same as that used to quote the identifier itself,
double the character. The following statement creates a table named <CODE>a`b</CODE>
that contains a column named <CODE>c"d</CODE>:

</P>

<PRE>
mysql&#62; CREATE TABLE `a``b` (`c"d` INT);
</PRE>

<P>
Identifier quoting was introduced in MySQL 3.23.6 to allow use of
identifiers that are reserved words or that contain special characters.
Before 3.23.6, you cannot use identifiers that require quotes, so the rules for
legal identifiers are more restrictive:

</P>

<UL>
<LI>

A name may consist of alphanumeric characters from the current character set,
<SAMP>`_'</SAMP>, and <SAMP>`$'</SAMP>. The default character set is ISO-8859-1
(Latin1). This may be changed with the <CODE>--default-character-set</CODE> option
to <CODE>mysqld</CODE>.
See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<LI>

A name may start with any character that is legal in a name.  In particular,
a name may start with a digit; this differs from many other database
systems!  However, an unquoted name cannot consist <EM>only</EM> of digits.

<LI>

You cannot use the <SAMP>`.'</SAMP> character in names because it is used to extend the
format by which you can refer to columns (see section <A HREF="manual.html#Identifier_qualifiers">10.2.1  Identifier Qualifiers</A>).
</UL>

<P>
It is recommended that you do not use names like <CODE>1e</CODE>, because
an expression like <CODE>1e+1</CODE> is ambiguous. It might be interpreted as the
expression <CODE>1e + 1</CODE> or as the number <CODE>1e+1</CODE>, depending on context.

</P>



<H3><A NAME="Identifier_qualifiers" HREF="manual_toc.html#Identifier_qualifiers">10.2.1  Identifier Qualifiers</A></H3>

<P>
MySQL allows names that consist of a single identifier or
multiple identifiers. The components of a multiple-part name should be
separated by period (<SAMP>`.'</SAMP>) characters. The initial parts of a
multiple-part name act as qualifiers that affect the context within which
the final identifier is interpreted.

</P>
<P>
In MySQL you can refer to a column using any of the following forms:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Reference</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>col_name</CODE> </TD><TD> The column <CODE>col_name</CODE>
from whichever table used in the query contains a column of that name.
</TD></TR>
<TR><TD><CODE>tbl_name.col_name</CODE> </TD><TD> The column <CODE>col_name</CODE> from table
<CODE>tbl_name</CODE> of the default database.
</TD></TR>
<TR><TD><CODE>db_name.tbl_name.col_name</CODE> </TD><TD> The column <CODE>col_name</CODE> from table
<CODE>tbl_name</CODE> of the database <CODE>db_name</CODE>.  This syntax is unavailable
before MySQL 3.22.
</TD></TR>
</TABLE>

<P>
If any components of a multiple-part name require quoting, quote them
individually rather than quoting the name as a whole. For example,
<CODE>`my-table`.`my-column`</CODE> is legal, whereas <CODE>`my-table.my-column`</CODE> is
not.

</P>
<P>
You need not specify a <CODE>tbl_name</CODE> or <CODE>db_name.tbl_name</CODE> prefix for
a column reference in a statement unless the reference would be ambiguous.
Suppose that tables <CODE>t1</CODE> and <CODE>t2</CODE> each contain a column
<CODE>c</CODE>, and you retrieve <CODE>c</CODE> in a <CODE>SELECT</CODE> statement that uses
both <CODE>t1</CODE> and <CODE>t2</CODE>.  In this case, <CODE>c</CODE> is ambiguous because it
is not unique among the tables used in the statement. You must qualify it
with a table name as <CODE>t1.c</CODE> or <CODE>t2.c</CODE> to indicate which table you
mean.  Similarly, to retrieve from a table <CODE>t</CODE> in database <CODE>db1</CODE>
and from a table <CODE>t</CODE> in database <CODE>db2</CODE> in the same statement,
you must refer to columns in those tables as <CODE>db1.t.col_name</CODE>
and <CODE>db2.t.col_name</CODE>.

</P>
<P>
<A NAME="IDX1063"></A>
<A NAME="IDX1064"></A>
The syntax <CODE>.tbl_name</CODE> means the table <CODE>tbl_name</CODE> in the current
database.  This syntax is accepted for ODBC compatibility because some ODBC
programs prefix table names with a <SAMP>`.'</SAMP> character.

</P>



<H3><A NAME="Name_case_sensitivity" HREF="manual_toc.html#Name_case_sensitivity">10.2.2  Identifier Case Sensitivity</A></H3>

<P>
<A NAME="IDX1065"></A>
<A NAME="IDX1066"></A>
<A NAME="IDX1067"></A>
<A NAME="IDX1068"></A>
<A NAME="IDX1069"></A>
<A NAME="IDX1070"></A>
<A NAME="IDX1071"></A>
<A NAME="IDX1072"></A>

</P>
<P>
In MySQL, databases correspond to directories within the data directory.
Tables within a database correspond to at least one file within the database
directory (and possibly more, depending on the storage engine).
Consequently, the case sensitivity of the
underlying operating system determines the case sensitivity of database and
table names.  This means database and table names are not case sensitive in
Windows, and case sensitive in most varieties of Unix. One notable
exception is Mac OS X, which is Unix-based but uses a default filesystem type
(HFS+) that is not
case sensitive.  However, Mac OS X also supports UFS volumes, which are case
sensitive just as on any Unix.
See section <A HREF="manual.html#Extensions_to_ANSI">1.8.4  MySQL Extensions to the SQL Standard</A>.

</P>
<P>
<STRONG>Note:</STRONG> Although database and table names are not case sensitive on
some platforms, you should not refer to a given database or table using
different
cases within the same query.  The following query would not work because it
refers to a table both as <CODE>my_table</CODE> and as <CODE>MY_TABLE</CODE>:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE MY_TABLE.col=1;
</PRE>

<P>
Column names, index names,
and column aliases are not case sensitive on any platform.

</P>
<P>
Table aliases are case sensitive before MySQL 4.1.1.  The following
query would not work because it refers to the alias both as <CODE>a</CODE> and
as <CODE>A</CODE>:

</P>

<PRE>
mysql&#62; SELECT col_name FROM tbl_name AS a
    -&#62; WHERE a.col_name = 1 OR A.col_name = 2;
</PRE>

<P>
If you have trouble remembering the allowable lettercase for database
and table names, adopt a consistent convention, such as always creating
databases and tables using lowercase names.

</P>
<P>
How table names are stored on disk and used in MySQL is defined by the
<CODE>lower_case_table_names</CODE> system variable, which you can set when
starting <CODE>mysqld</CODE>.  <CODE>lower_case_table_names</CODE> can take one of
the following values:

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Value</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>0</CODE> </TD><TD> Table and database names are stored on disk using the lettercase specified in the <CODE>CREATE TABLE</CODE> or <CODE>CREATE DATABASE</CODE> statement. Name comparisons are case sensitive.  This is the default on Unix systems. Note that if you force this to 0 with <CODE>--lower-case-table-names=0</CODE> on a case-insensitive filesystem and access <CODE>MyISAM</CODE> tablenames using different lettercases, this may lead to index corruption.

</TD></TR>
<TR><TD><CODE>1</CODE> </TD><TD> Table names are stored in lowercase on disk and name comparisons are not case sensitive. MySQL converts all table names to lowercase on storage and lookup.  This behavior also applies to database names as of MySQL 4.0.2, and to table aliases as of 4.1.1. This value is the default on Windows and Mac OS X systems.

</TD></TR>
<TR><TD><CODE>2</CODE> </TD><TD> Table and database names are stored on disk using the lettercase specified in the <CODE>CREATE TABLE</CODE> or <CODE>CREATE DATABASE</CODE> statement, but MySQL converts them to lowercase on lookup.  Name comparisons are not case sensitive.  <STRONG>Note:</STRONG> This works <EM>only</EM> on filesystems that are not case sensitive! <CODE>InnoDB</CODE> table names are stored in lowercase, as for <CODE>lower_case_table_names=1</CODE>. Setting <CODE>lower_case_table_names</CODE> to <CODE>2</CODE> can be done as of MySQL 4.0.18.

</TD></TR>
</TABLE>

<P>
If you are using MySQL on only one platform, you don't normally have to
change the <CODE>lower_case_table_names</CODE> variable. However, you may
encounter difficulties if you want to transfer tables between platforms
that differ in filesystem case sensitivity. For example, on Unix, you
can have two different tables named <CODE>my_table</CODE> and <CODE>MY_TABLE</CODE>,
but on Windows those names are considered the same.  To avoid data
transfer problems stemming from database or table name lettercase, you
have two options:

</P>

<UL>
<LI>

Use <CODE>lower_case_table_names=1</CODE> on all systems. The main disadvantage
with this is that when you use <CODE>SHOW TABLES</CODE> or <CODE>SHOW DATABASES</CODE>,
you don't see the names in their original lettercase.

<LI>

Use <CODE>lower_case_table_names=0</CODE> on Unix and <CODE>lower_case_table_names=2</CODE>
on Windows. This preserves the lettercase of database and table names.
The disadvantage of this is that you must ensure that your queries always refer
to your database and table names with the correct lettercase on Windows. If
you transfer your queries to Unix, where lettercase is significant, they will
not work if the lettercase is incorrect.
</UL>

<P>
Note that before setting <CODE>lower_case_table_names</CODE> to 1 on Unix, you must
first convert your old database and table names to lowercase before restarting
<CODE>mysqld</CODE>.

</P>


<H2><A NAME="Variables" HREF="manual_toc.html#Variables">10.3  User Variables</A></H2>

<P>
<A NAME="IDX1073"></A>
<A NAME="IDX1074"></A>
<A NAME="IDX1075"></A>

</P>
<P>
MySQL supports user variables as of version 3.23.6. You can store a value in
a user variable and refer to it later, which allows you to pass values from
one statement to another. User variables are connection-specific. That is,
a variable defined by one client cannot be seen or used by other clients.
All variables for a client connection are automatically freed when the
client exits.

</P>
<P>
User variables are written as <CODE>@var_name</CODE>, where the variable name
<CODE>var_name</CODE> may consist of alphanumeric characters from the current
character set, <SAMP>`.'</SAMP>, <SAMP>`_'</SAMP>, and <SAMP>`$'</SAMP>. The default character set
is ISO-8859-1 (Latin1). This may be changed with the
<CODE>--default-character-set</CODE> option to <CODE>mysqld</CODE>. See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>. User variable names are not case insensitive beginning with MySQL 5.0.
Before that, they are case sensitive.

</P>
<P>
One way to set a user variable is by issuing a <CODE>SET</CODE> statement:

</P>

<PRE>
SET @var_name = expr [,@var_name = expr] ...
</PRE>

<P>
For <CODE>SET</CODE>, either <CODE>=</CODE> or <CODE>:=</CODE> can be used as the assignment
operator.  The <CODE>expr</CODE> assigned to each variable can evaluate
to an integer, real, string, or <CODE>NULL</CODE> value.

</P>
<P>
You can also assign a value to a user variable in statements other than
<CODE>SET</CODE>.  In this case, the assignment operator must be <CODE>:=</CODE> and not
<CODE>=</CODE> because <CODE>=</CODE> is treated as a comparison operator
in non-<CODE>SET</CODE> statements:

</P>

<PRE>
mysql&#62; SET @t1=0, @t2=0, @t3=0;
mysql&#62; SELECT @t1:=(@t2:=1)+@t3:=4,@t1,@t2,@t3;
+----------------------+------+------+------+
| @t1:=(@t2:=1)+@t3:=4 | @t1  | @t2  | @t3  |
+----------------------+------+------+------+
|                    5 |    5 |    1 |    4 |
+----------------------+------+------+------+
</PRE>

<P>
User variables may be used where expressions are allowed.  This
does not currently include contexts that explicitly require a number, such
as in the <CODE>LIMIT</CODE> clause of a <CODE>SELECT</CODE> statement, or the
<CODE>IGNORE number LINES</CODE> clause of a <CODE>LOAD DATA</CODE> statement.

</P>
<P>
If you refer to a variable that has not been initialized, its value
is <CODE>NULL</CODE>.

</P>
<P>
<STRONG>Note:</STRONG> In a <CODE>SELECT</CODE> statement, each expression is evaluated
only when sent to the client.  This means that in a <CODE>HAVING</CODE>,
<CODE>GROUP BY</CODE>, or <CODE>ORDER BY</CODE> clause, you cannot refer to an expression
that involves variables that are set in the <CODE>SELECT</CODE> list. For example,
the following statement will <EM>not</EM> work as expected:

</P>

<PRE>
mysql&#62; SELECT (@aa:=id) AS a, (@aa+3) AS b FROM tbl_name HAVING b=5;
</PRE>

<P>
The reference to <CODE>b</CODE> in the <CODE>HAVING</CODE> clause refers to an alias
for an expression in the <CODE>SELECT</CODE> list that uses <CODE>@aa</CODE>. This
does not work as expected: <CODE>@aa</CODE> will not contain the value of the
current row, but the value of <CODE>id</CODE> from the previous selected row.

</P>
<P>
The general rule is to never assign <EM>and</EM> use the same variable in
the same statement.

</P>
<P>
Another issue with setting a variable and using it in the same statement
is that the default result type of a variable is based on the type of
the variable at the start of the statement.  The following example
illustrates this:

</P>

<PRE>
mysql&#62; SET @a='test';
mysql&#62; SELECT @a,(@a:=20) FROM tbl_name;
</PRE>

<P>
For this <CODE>SELECT</CODE> statement, MySQL will report to the client that
column one is a string and convert all accesses of <CODE>@a</CODE> to strings,
even though @a is set to a number for the second row.  After the
<CODE>SELECT</CODE> statement executes, <CODE>@a</CODE> will be regarded as a
number for the next statement.

</P>
<P>
To avoid problems with this behavior, either do not set and use the same
variable within a single statement, or else set the variable to <CODE>0</CODE>,
<CODE>0.0</CODE>, or <CODE>''</CODE> to define its type before you use it.

</P>
<P>
An unassigned variable has a value of <CODE>NULL</CODE> with a type of string.

</P>



<H2><A NAME="System_Variables" HREF="manual_toc.html#System_Variables">10.4  System Variables</A></H2>

<P>
<A NAME="IDX1076"></A>
<A NAME="IDX1077"></A>
<A NAME="IDX1078"></A>

</P>

<P>
Starting from MySQL 4.0.3, we provide better access to a lot of system
and connection variables. Many variables can be changed dynamically while
the server is running. This allows you to modify server operation without
having to stop and restart it.

</P>

<P>
The <CODE>mysqld</CODE> server maintains two kinds of variables.
Global variables affect the overall operation of the server.
Session variables affect its operation for individual client connections.

</P>
<P>
When the server starts, it initializes all global variables to their default
values. These defaults may be changed by options specified in option files
or on the command line.  After the server starts, those global variables
that are dynamic can be changed by connecting to the server and issuing
a <CODE>SET GLOBAL var_name</CODE> statement. To change a global variable,
you must have the <CODE>SUPER</CODE> privilege.

</P>
<P>
The server also maintains a set of session variables for each client
that connects. The client's session variables are initialized at connect
time using the current values of the corresponding global variables. For
those session variables that are dynamic, the client can change them
by issuing a <CODE>SET SESSION var_name</CODE> statement. Setting a session
variable requires no special privilege, but a client can change only its
own session variables, not those of any other client.

</P>
<P>
A change to a global variable is visible to any client that accesses that
global variable. However, it affects the corresponding session variable
that is intialized from the global variable only for clients that connect
after the change.  It does not affect the session variable for any client
that is already connected (not even that of the client that issues the
<CODE>SET GLOBAL</CODE> statement).

</P>
<P>
Global or session variables may be set or retrieved using several syntax
forms.  The following examples use <CODE>sort_buffer_size</CODE> as a sample variable
name.

</P>
<P>
To set the value of a <CODE>GLOBAL</CODE> variable, use one
of the following syntaxes:

</P>

<PRE>
mysql&#62; SET GLOBAL sort_buffer_size=value;
mysql&#62; SET @@global.sort_buffer_size=value;
</PRE>

<P>
To set the value of a <CODE>SESSION</CODE> variable, use one of the
following syntaxes:

</P>

<PRE>
mysql&#62; SET SESSION sort_buffer_size=value;
mysql&#62; SET @@session.sort_buffer_size=value;
mysql&#62; SET sort_buffer_size=value;
</PRE>

<P>
<CODE>LOCAL</CODE> is a synonym for <CODE>SESSION</CODE>.

</P>
<P>
If you don't specify <CODE>GLOBAL</CODE>, <CODE>SESSION</CODE>, or <CODE>LOCAL</CODE> when
setting a variable, <CODE>SESSION</CODE> is the default.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
To retrieve the value of a <CODE>GLOBAL</CODE> variable, use one of the
following statements:

</P>

<PRE>
mysql&#62; SELECT @@global.sort_buffer_size;
mysql&#62; SHOW GLOBAL VARIABLES like 'sort_buffer_size';
</PRE>

<P>
To retrieve the value of a <CODE>SESSION</CODE> variable, use one of the
following statements:

</P>

<PRE>
mysql&#62; SELECT @@sort_buffer_size;
mysql&#62; SELECT @@session.sort_buffer_size;
mysql&#62; SHOW SESSION VARIABLES like 'sort_buffer_size';
</PRE>

<P>
Here, too, <CODE>LOCAL</CODE> is a synonym for <CODE>SESSION</CODE>.

</P>
<P>
When you retrieve a variable with <CODE>SELECT @@var_name</CODE> (that is, you
do not specify <CODE>global.</CODE>, <CODE>session.</CODE>, or <CODE>local.</CODE>, MySQL returns
the <CODE>SESSION</CODE> value if it exists and the <CODE>GLOBAL</CODE> value otherwise.

</P>
<P>
For <CODE>SHOW VARIABLES</CODE>, if you do not specify <CODE>GLOBAL</CODE>,
<CODE>SESSION</CODE>, or <CODE>LOCAL</CODE>, MySQL returns the <CODE>SESSION</CODE> value.

</P>
<P>
The reason for requiring the <CODE>GLOBAL</CODE> keyword when setting
<CODE>GLOBAL</CODE>-only variables but not when retrieving them is to prevent
problems in the future.  If we remove a <CODE>SESSION</CODE>
variable with the same name as a <CODE>GLOBAL</CODE> variable, a client with the
<CODE>SUPER</CODE> privilege might accidentally change the <CODE>GLOBAL</CODE> variable
rather than just the <CODE>SESSION</CODE> variable for its own connection.  If we
add a <CODE>SESSION</CODE> variable with the same name as a <CODE>GLOBAL</CODE>
variable, a client that intends to change the <CODE>GLOBAL</CODE> variable might
find only its own <CODE>SESSION</CODE> variable changed.

</P>
<P>
Further information about system startup options and system
variables can be found in section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A> and
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
A list of the variables that can be set at runtime is given in
section <A HREF="manual.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A>.

</P>



<H3><A NAME="Structured_System_Variables" HREF="manual_toc.html#Structured_System_Variables">10.4.1  Structured System Variables</A></H3>

<P>
Structured system variables are supported beginning with MySQL 4.1.1.
A structured variable differs from a regular system variable in two
respects:

</P>

<UL>
<LI>

Its value is a structure with components that specify
server parameters considered to be closely related.
<LI>

There might be several instances of a given type of structured variable.
Each one has a different name and refers to a different resource
maintained by the server.
</UL>

<P>
Currently, MySQL supports one structured variable type. It specifies
parameters that govern the operation of key caches. A key cache structured
variable has these components:

</P>

<UL>
<LI>

<CODE>key_buffer_size</CODE>
<LI>

<CODE>key_cache_block_size</CODE>
<LI>

<CODE>key_cache_division_limit</CODE>
<LI>

<CODE>key_cache_age_threshold</CODE>
</UL>

<P>
The purpose of this section is to describe the syntax for referring to
structured variables. Key cache variables are used for syntax examples,
but specific details about how key caches operate are found elsewhere, in
section <A HREF="manual.html#MyISAM_key_cache">7.4.6  The <CODE>MyISAM</CODE> Key Cache</A>.

</P>
<P>
To refer to a component of a structured variable instance, you can use a
compound name in <CODE>instance_name.component_name</CODE> format. Examples:

</P>

<PRE>
hot_cache.key_buffer_size
hot_cache.key_cache_block_size
cold_cache.key_cache_block_size
</PRE>

<P>
For each structured system variable, an instance with the name of
<CODE>default</CODE> is always predefined.  If you refer to a component of a
structured variable without any instance name, the <CODE>default</CODE> instance
is used.  Thus, <CODE>default.key_buffer_size</CODE> and <CODE>key_buffer_size</CODE>
both refer to the same system variable.

</P>
<P>
The naming rules for structured variable instances and components are as
follows:

</P>

<UL>
<LI>

For a given type of structured variable, each instance must have a name
that is unique <EM>within</EM> variables of that type. However, instance names
need not be unique <EM>across</EM> structured variable types. For example,
each structured variable will have an instance named <CODE>default</CODE>,
so <CODE>default</CODE> is not unique across variable types.

<LI>

The names of the components of each structured variable type must be
unique across all system variable names.  If this were not true (that is, if
two different types of structured variables could share component
member names), it would not be clear which default structured variable
to use for references to member names that are not qualified by an
instance name.

<LI>

If a structured variable instance name is not legal as an unquoted identifier,
refer to it as a quoted identifier using backticks. For example,
<CODE>hot-cache</CODE> is not legal, but <CODE>`hot-cache`</CODE> is.

<LI>

<CODE>global</CODE>, <CODE>session</CODE>, and <CODE>local</CODE> are not legal instance
names. This avoids a conflict with notation such as <CODE>@@global.var_name</CODE>
for referring to non-structured system variables.

</UL>

<P>
At the moment, the first two rules have no possibility of being violated
because the only structured variable type is the one for key caches.
These rules will assume greater significance if some other type of structured
variable is created in the future.

</P>
<P>
With one exception, it is allowable to refer to structured variable
components using compound names in any context where simple variable
names can occur.  For example, you can assign a value to a structured
variable using a command-line option:

</P>

<PRE>
shell&#62; mysqld --hot_cache.key_buffer_size=64K
</PRE>

<P>
In an option file, do this:

</P>

<PRE>
[mysqld]
hot_cache.key_buffer_size=64K
</PRE>

<P>
If you start the server with such an option, it creates a key cache
named <CODE>hot_cache</CODE> with a size of 64KB in addition to the default
key cache that has a default size of 8MB.

</P>
<P>
Suppose that you start the server as follows:

</P>

<PRE>
shell&#62; mysqld --key_buffer_size=256K \
         --extra_cache.key_buffer_size=128K \
         --extra_cache.key_cache_block_size=2096
</PRE>

<P>
In this case, the server sets the size of the default key cache to 256KB.
(You could also have written <CODE>--default.key_buffer_size=256K</CODE>.)
In addition, the server creates a second key cache named <CODE>extra_cache</CODE>
that has a size of 128KB, with the size of block buffers for caching
table index blocks set to 2096 bytes.

</P>
<P>
The following example starts the server with three different key caches
having sizes in a 3:1:1 ratio:

</P>

<PRE>
shell&#62; mysqld --key_buffer_size=6M \
         --hot_cache.key_buffer_size=2M \
         --cold_cache.key_buffer_size=2M
</PRE>

<P>
Structured variable values may be set and retrieved at runtime as well.
For example, to set a key cache named <CODE>hot_cache</CODE> to a size of 10MB,
use either of these statements:

</P>

<PRE>
mysql&#62; SET GLOBAL hot_cache.key_buffer_size = 10*1024*1024;
mysql&#62; SET @@global.hot_cache.key_buffer_size = 10*1024*1024;
</PRE>

<P>
To retrieve the cache size, do this:

</P>

<PRE>
mysql&#62; SELECT @@global.hot_cache.key_buffer_size;
</PRE>

<P>
However, the following statement does not work. The variable is not
interpreted as a compound name, but as a simple string for a <CODE>LIKE</CODE>
pattern-matching operation:

</P>

<PRE>
mysql&#62; SHOW GLOBAL VARIABLES LIKE 'hot_cache.key_buffer_size';
</PRE>

<P>
This is the exception to being able to use structured variable names anywhere
a simple variable name may occur.

</P>



<H2><A NAME="Comments" HREF="manual_toc.html#Comments">10.5  Comment Syntax</A></H2>

<P>
<A NAME="IDX1079"></A>

</P>
<P>
<A NAME="IDX1080"></A>

</P>

<P>
The MySQL server supports three comment styles:

</P>

<UL>
<LI>

From a <SAMP>`#'</SAMP> character to the end of the line.

<LI>

From a <SAMP>`-- '</SAMP> sequence to the end of the line.
This style is supported as of MySQL 3.23.3.
Note that the <SAMP>`-- '</SAMP> (double-dash) comment style requires the second dash
to be followed by at least one space (or by a control character such as a
newline). This syntax differs slightly from standard SQL comment syntax, as discussed in
section <A HREF="manual.html#ANSI_diff_comments">1.8.5.7  <SAMP>`--'</SAMP> as the Start of a Comment</A>.

<LI>

From a <SAMP>`/*'</SAMP> sequence to the following <SAMP>`*/'</SAMP> sequence.
The closing sequence need not be on the same line, so this
syntax allows a comment to extend over multiple lines.

</UL>

<P>
The following example demonstrates all three comment styles:

</P>

<PRE>
mysql&#62; SELECT 1+1;     # This comment continues to the end of line
mysql&#62; SELECT 1+1;     -- This comment continues to the end of line
mysql&#62; SELECT 1 /* this is an in-line comment */ + 1;
mysql&#62; SELECT 1+
/*
this is a
multiple-line comment
*/
1;
</PRE>

<P>
The comment syntax just described applies to how the <CODE>mysqld</CODE> server
parses SQL statements. The <CODE>mysql</CODE> client program also performs some
parsing of statements before sending them to the server. (For example, it
does this to determine statement boundaries within a multiple-statement input
line.) However, there are some limitations on the way that <CODE>mysql</CODE>
parses <CODE>/* ... */</CODE> comments:

</P>

<UL>
<LI>

A single-quote, double-quote, or backtick character is taken to indicate the beginning
of a quoted string or identifier, even within a comment.  If the quote is not matched by a
second quote within the comment, the parser doesn't realize the comment has
ended.  If you are running <CODE>mysql</CODE> interactively, you can tell that it
has gotten confused like this because the prompt changes from <CODE>mysql&#62;</CODE>
to <CODE>'&#62;</CODE>, <CODE>"&#62;</CODE>, or <CODE>`&#62;</CODE>.
This problem was fixed in MySQL 4.1.1.

<LI>

A semicolon within the comment is taken to indicate the end of the current
SQL statement and anything following it to indicate the beginning of the
next statement.  This problem was fixed in MySQL 4.0.13.
</UL>

<P>
For affected versions of MySQL,
these limitations apply both when you run <CODE>mysql</CODE> interactively
and when you put commands in a file and use <CODE>mysql</CODE> in batch mode to
process the file with <CODE>mysql &#60; file_name</CODE>.

</P>



<H2><A NAME="Reserved_words" HREF="manual_toc.html#Reserved_words">10.6  Treatment of Reserved Words in MySQL</A></H2>

<P>
<A NAME="IDX1081"></A>
<A NAME="IDX1082"></A>

</P>
<P>
A common problem stems from trying to use an identifier such as a table or
column name that is the name of a built-in MySQL data type or function,
such as <CODE>TIMESTAMP</CODE> or <CODE>GROUP</CODE>.  You're allowed
to do this (for example, <CODE>ABS</CODE> is allowed as a column name). However,
by default, no whitespace is allowed in function invocations between the
function name and the following <SAMP>`('</SAMP> character. This requirement allows
a function call to be distinguished from a reference to a column name.

</P>
<P>
A side effect of this behavior is that omitting a space in some contexts
causes an identifier to be interpreted as a function name. For example, this
statement is legal:

</P>

<PRE>
mysql&#62; CREATE TABLE abs (val INT);
</PRE>

<P>
But omitting the space after <CODE>abs</CODE> causes a syntax error because the
statement then appears to invoke the <CODE>ABS()</CODE> function:

</P>

<PRE>
mysql&#62; CREATE TABLE abs(val INT);
</PRE>

<P>
If the server SQL mode includes the <CODE>IGNORE_SPACE</CODE> mode value, the
server allows function invocations to have whitespace between a function
name and the following <SAMP>`('</SAMP> character. This causes function names to be
treated as reserved words. As a result, identifiers that are the same as
function names must be quoted as described in section <A HREF="manual.html#Legal_names">10.2  Database, Table, Index, Column, and Alias Names</A>.  The server
SQL mode is controlled as described in section <A HREF="manual.html#SQL_mode">1.8.2  Selecting SQL Modes</A>.

</P>
<P>
The words in the following table are explicitly reserved in MySQL. Most of
them are forbidden by standard SQL as column and/or table names (for example,
<CODE>GROUP</CODE>).  A few are reserved because MySQL needs them and (currently)
uses a <CODE>yacc</CODE> parser.  A reserved word can be used as an identifier by
quoting it.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Word</STRONG>
 </TD><TD> <STRONG>Word</STRONG>
 </TD><TD> <STRONG>Word</STRONG>
</TD></TR>
<TR><TD><CODE>ADD</CODE>
 </TD><TD> <CODE>ALL</CODE>
 </TD><TD> <CODE>ALTER</CODE>
</TD></TR>
<TR><TD><CODE>ANALYZE</CODE>
 </TD><TD> <CODE>AND</CODE>
 </TD><TD> <CODE>AS</CODE>
</TD></TR>
<TR><TD><CODE>ASC</CODE>
 </TD><TD> <CODE>ASENSITIVE</CODE>
 </TD><TD> <CODE>AUTO_INCREMENT</CODE>
</TD></TR>
<TR><TD><CODE>BDB</CODE>
 </TD><TD> <CODE>BEFORE</CODE>
 </TD><TD> <CODE>BERKELEYDB</CODE>
</TD></TR>
<TR><TD><CODE>BETWEEN</CODE>
 </TD><TD> <CODE>BIGINT</CODE>
 </TD><TD> <CODE>BINARY</CODE>
</TD></TR>
<TR><TD><CODE>BLOB</CODE>
 </TD><TD> <CODE>BOTH</CODE>
 </TD><TD> <CODE>BY</CODE>
</TD></TR>
<TR><TD><CODE>CALL</CODE>
 </TD><TD> <CODE>CASCADE</CODE>
 </TD><TD> <CODE>CASE</CODE>
</TD></TR>
<TR><TD><CODE>CHANGE</CODE>
 </TD><TD> <CODE>CHAR</CODE>
 </TD><TD> <CODE>CHARACTER</CODE>
</TD></TR>
<TR><TD><CODE>CHECK</CODE>
 </TD><TD> <CODE>COLLATE</CODE>
 </TD><TD> <CODE>COLUMN</CODE>
</TD></TR>
<TR><TD><CODE>COLUMNS</CODE>
 </TD><TD> <CODE>CONDITION</CODE>
 </TD><TD> <CODE>CONNECTION</CODE>
</TD></TR>
<TR><TD><CODE>CONSTRAINT</CODE>
 </TD><TD> <CODE>CONTINUE</CODE>
 </TD><TD> <CODE>CREATE</CODE>
</TD></TR>
<TR><TD><CODE>CROSS</CODE>
 </TD><TD> <CODE>CURRENT_DATE</CODE>
 </TD><TD> <CODE>CURRENT_TIME</CODE>
</TD></TR>
<TR><TD><CODE>CURRENT_TIMESTAMP</CODE>
 </TD><TD> <CODE>CURSOR</CODE>
 </TD><TD> <CODE>DATABASE</CODE>
</TD></TR>
<TR><TD><CODE>DATABASES</CODE>
 </TD><TD> <CODE>DAY_HOUR</CODE>
 </TD><TD> <CODE>DAY_MICROSECOND</CODE>
</TD></TR>
<TR><TD><CODE>DAY_MINUTE</CODE>
 </TD><TD> <CODE>DAY_SECOND</CODE>
 </TD><TD> <CODE>DEC</CODE>
</TD></TR>
<TR><TD><CODE>DECIMAL</CODE>
 </TD><TD> <CODE>DECLARE</CODE>
 </TD><TD> <CODE>DEFAULT</CODE>
</TD></TR>
<TR><TD><CODE>DELAYED</CODE>
 </TD><TD> <CODE>DELETE</CODE>
 </TD><TD> <CODE>DESC</CODE>
</TD></TR>
<TR><TD><CODE>DESCRIBE</CODE>
 </TD><TD> <CODE>DETERMINISTIC</CODE>
 </TD><TD> <CODE>DISTINCT</CODE>
</TD></TR>
<TR><TD><CODE>DISTINCTROW</CODE>
 </TD><TD> <CODE>DIV</CODE>
 </TD><TD> <CODE>DOUBLE</CODE>
</TD></TR>
<TR><TD><CODE>DROP</CODE>
 </TD><TD> <CODE>ELSE</CODE>
 </TD><TD> <CODE>ELSEIF</CODE>
</TD></TR>
<TR><TD><CODE>ENCLOSED</CODE>
 </TD><TD> <CODE>ESCAPED</CODE>
 </TD><TD> <CODE>EXISTS</CODE>
</TD></TR>
<TR><TD><CODE>EXIT</CODE>
 </TD><TD> <CODE>EXPLAIN</CODE>
 </TD><TD> <CODE>FALSE</CODE>
</TD></TR>
<TR><TD><CODE>FETCH</CODE>
 </TD><TD> <CODE>FIELDS</CODE>
 </TD><TD> <CODE>FLOAT</CODE>
</TD></TR>
<TR><TD><CODE>FOR</CODE>
 </TD><TD> <CODE>FORCE</CODE>
 </TD><TD> <CODE>FOREIGN</CODE>
</TD></TR>
<TR><TD><CODE>FOUND</CODE>
 </TD><TD> <CODE>FRAC_SECOND</CODE>
 </TD><TD> <CODE>FROM</CODE>
</TD></TR>
<TR><TD><CODE>FULLTEXT</CODE>
 </TD><TD> <CODE>GRANT</CODE>
 </TD><TD> <CODE>GROUP</CODE>
</TD></TR>
<TR><TD><CODE>HAVING</CODE>
 </TD><TD> <CODE>HIGH_PRIORITY</CODE>
 </TD><TD> <CODE>HOUR_MICROSECOND</CODE>
</TD></TR>
<TR><TD><CODE>HOUR_MINUTE</CODE>
 </TD><TD> <CODE>HOUR_SECOND</CODE>
 </TD><TD> <CODE>IF</CODE>
</TD></TR>
<TR><TD><CODE>IGNORE</CODE>
 </TD><TD> <CODE>IN</CODE>
 </TD><TD> <CODE>INDEX</CODE>
</TD></TR>
<TR><TD><CODE>INFILE</CODE>
 </TD><TD> <CODE>INNER</CODE>
 </TD><TD> <CODE>INNODB</CODE>
</TD></TR>
<TR><TD><CODE>INOUT</CODE>
 </TD><TD> <CODE>INSENSITIVE</CODE>
 </TD><TD> <CODE>INSERT</CODE>
</TD></TR>
<TR><TD><CODE>INT</CODE>
 </TD><TD> <CODE>INTEGER</CODE>
 </TD><TD> <CODE>INTERVAL</CODE>
</TD></TR>
<TR><TD><CODE>INTO</CODE>
 </TD><TD> <CODE>IO_THREAD</CODE>
 </TD><TD> <CODE>IS</CODE>
</TD></TR>
<TR><TD><CODE>ITERATE</CODE>
 </TD><TD> <CODE>JOIN</CODE>
 </TD><TD> <CODE>KEY</CODE>
</TD></TR>
<TR><TD><CODE>KEYS</CODE>
 </TD><TD> <CODE>KILL</CODE>
 </TD><TD> <CODE>LEADING</CODE>
</TD></TR>
<TR><TD><CODE>LEAVE</CODE>
 </TD><TD> <CODE>LEFT</CODE>
 </TD><TD> <CODE>LIKE</CODE>
</TD></TR>
<TR><TD><CODE>LIMIT</CODE>
 </TD><TD> <CODE>LINES</CODE>
 </TD><TD> <CODE>LOAD</CODE>
</TD></TR>
<TR><TD><CODE>LOCALTIME</CODE>
 </TD><TD> <CODE>LOCALTIMESTAMP</CODE>
 </TD><TD> <CODE>LOCK</CODE>
</TD></TR>
<TR><TD><CODE>LONG</CODE>
 </TD><TD> <CODE>LONGBLOB</CODE>
 </TD><TD> <CODE>LONGTEXT</CODE>
</TD></TR>
<TR><TD><CODE>LOOP</CODE>
 </TD><TD> <CODE>LOW_PRIORITY</CODE>
 </TD><TD> <CODE>MASTER_SERVER_ID</CODE>
</TD></TR>
<TR><TD><CODE>MATCH</CODE>
 </TD><TD> <CODE>MEDIUMBLOB</CODE>
 </TD><TD> <CODE>MEDIUMINT</CODE>
</TD></TR>
<TR><TD><CODE>MEDIUMTEXT</CODE>
 </TD><TD> <CODE>MIDDLEINT</CODE>
 </TD><TD> <CODE>MINUTE_MICROSECOND</CODE>
</TD></TR>
<TR><TD><CODE>MINUTE_SECOND</CODE>
 </TD><TD> <CODE>MOD</CODE>
 </TD><TD> <CODE>NATURAL</CODE>
</TD></TR>
<TR><TD><CODE>NOT</CODE>
 </TD><TD> <CODE>NO_WRITE_TO_BINLOG</CODE>
 </TD><TD> <CODE>NULL</CODE>
</TD></TR>
<TR><TD><CODE>NUMERIC</CODE>
 </TD><TD> <CODE>ON</CODE>
 </TD><TD> <CODE>OPTIMIZE</CODE>
</TD></TR>
<TR><TD><CODE>OPTION</CODE>
 </TD><TD> <CODE>OPTIONALLY</CODE>
 </TD><TD> <CODE>OR</CODE>
</TD></TR>
<TR><TD><CODE>ORDER</CODE>
 </TD><TD> <CODE>OUT</CODE>
 </TD><TD> <CODE>OUTER</CODE>
</TD></TR>
<TR><TD><CODE>OUTFILE</CODE>
 </TD><TD> <CODE>PRECISION</CODE>
 </TD><TD> <CODE>PRIMARY</CODE>
</TD></TR>
<TR><TD><CODE>PRIVILEGES</CODE>
 </TD><TD> <CODE>PROCEDURE</CODE>
 </TD><TD> <CODE>PURGE</CODE>
</TD></TR>
<TR><TD><CODE>READ</CODE>
 </TD><TD> <CODE>REAL</CODE>
 </TD><TD> <CODE>REFERENCES</CODE>
</TD></TR>
<TR><TD><CODE>REGEXP</CODE>
 </TD><TD> <CODE>RENAME</CODE>
 </TD><TD> <CODE>REPEAT</CODE>
</TD></TR>
<TR><TD><CODE>REPLACE</CODE>
 </TD><TD> <CODE>REQUIRE</CODE>
 </TD><TD> <CODE>RESTRICT</CODE>
</TD></TR>
<TR><TD><CODE>RETURN</CODE>
 </TD><TD> <CODE>REVOKE</CODE>
 </TD><TD> <CODE>RIGHT</CODE>
</TD></TR>
<TR><TD><CODE>RLIKE</CODE>
 </TD><TD> <CODE>SECOND_MICROSECOND</CODE>
 </TD><TD> <CODE>SELECT</CODE>
</TD></TR>
<TR><TD><CODE>SENSITIVE</CODE>
 </TD><TD> <CODE>SEPARATOR</CODE>
 </TD><TD> <CODE>SET</CODE>
</TD></TR>
<TR><TD><CODE>SHOW</CODE>
 </TD><TD> <CODE>SMALLINT</CODE>
 </TD><TD> <CODE>SOME</CODE>
</TD></TR>
<TR><TD><CODE>SONAME</CODE>
 </TD><TD> <CODE>SPATIAL</CODE>
 </TD><TD> <CODE>SPECIFIC</CODE>
</TD></TR>
<TR><TD><CODE>SQL</CODE>
 </TD><TD> <CODE>SQLEXCEPTION</CODE>
 </TD><TD> <CODE>SQLSTATE</CODE>
</TD></TR>
<TR><TD><CODE>SQLWARNING</CODE>
 </TD><TD> <CODE>SQL_BIG_RESULT</CODE>
 </TD><TD> <CODE>SQL_CALC_FOUND_ROWS</CODE>
</TD></TR>
<TR><TD><CODE>SQL_SMALL_RESULT</CODE>
 </TD><TD> <CODE>SQL_TSI_DAY</CODE>
 </TD><TD> <CODE>SQL_TSI_FRAC_SECOND</CODE>
</TD></TR>
<TR><TD><CODE>SQL_TSI_HOUR</CODE>
 </TD><TD> <CODE>SQL_TSI_MINUTE</CODE>
 </TD><TD> <CODE>SQL_TSI_MONTH</CODE>
</TD></TR>
<TR><TD><CODE>SQL_TSI_QUARTER</CODE>
 </TD><TD> <CODE>SQL_TSI_SECOND</CODE>
 </TD><TD> <CODE>SQL_TSI_WEEK</CODE>
</TD></TR>
<TR><TD><CODE>SQL_TSI_YEAR</CODE>
 </TD><TD> <CODE>SSL</CODE>
 </TD><TD> <CODE>STARTING</CODE>
</TD></TR>
<TR><TD><CODE>STRAIGHT_JOIN</CODE>
 </TD><TD> <CODE>STRIPED</CODE>
 </TD><TD> <CODE>TABLE</CODE>
</TD></TR>
<TR><TD><CODE>TABLES</CODE>
 </TD><TD> <CODE>TERMINATED</CODE>
 </TD><TD> <CODE>THEN</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMPADD</CODE>
 </TD><TD> <CODE>TIMESTAMPDIFF</CODE>
 </TD><TD> <CODE>TINYBLOB</CODE>
</TD></TR>
<TR><TD><CODE>TINYINT</CODE>
 </TD><TD> <CODE>TINYTEXT</CODE>
 </TD><TD> <CODE>TO</CODE>
</TD></TR>
<TR><TD><CODE>TRAILING</CODE>
 </TD><TD> <CODE>TRUE</CODE>
 </TD><TD> <CODE>UNDO</CODE>
</TD></TR>
<TR><TD><CODE>UNION</CODE>
 </TD><TD> <CODE>UNIQUE</CODE>
 </TD><TD> <CODE>UNLOCK</CODE>
</TD></TR>
<TR><TD><CODE>UNSIGNED</CODE>
 </TD><TD> <CODE>UPDATE</CODE>
 </TD><TD> <CODE>USAGE</CODE>
</TD></TR>
<TR><TD><CODE>USE</CODE>
 </TD><TD> <CODE>USER_RESOURCES</CODE>
 </TD><TD> <CODE>USING</CODE>
</TD></TR>
<TR><TD><CODE>UTC_DATE</CODE>
 </TD><TD> <CODE>UTC_TIME</CODE>
 </TD><TD> <CODE>UTC_TIMESTAMP</CODE>
</TD></TR>
<TR><TD><CODE>VALUES</CODE>
 </TD><TD> <CODE>VARBINARY</CODE>
 </TD><TD> <CODE>VARCHAR</CODE>
</TD></TR>
<TR><TD><CODE>VARCHARACTER</CODE>
 </TD><TD> <CODE>VARYING</CODE>
 </TD><TD> <CODE>WHEN</CODE>
</TD></TR>
<TR><TD><CODE>WHERE</CODE>
 </TD><TD> <CODE>WHILE</CODE>
 </TD><TD> <CODE>WITH</CODE>
</TD></TR>
<TR><TD><CODE>WRITE</CODE>
 </TD><TD> <CODE>XOR</CODE>
 </TD><TD> <CODE>YEAR_MONTH</CODE>
</TD></TR>
<TR><TD><CODE>ZEROFILL</CODE>
 </TD><TD>  </TD><TD> </TD></TR>
</TABLE>

<P>
The following keywords are allowed by MySQL as column/table names. This
is because they are very natural names and a lot of people have already
used them.

</P>

<UL>
<LI><CODE>ACTION</CODE>

<LI><CODE>BIT</CODE>

<LI><CODE>DATE</CODE>

<LI><CODE>ENUM</CODE>

<LI><CODE>NO</CODE>

<LI><CODE>TEXT</CODE>

<LI><CODE>TIME</CODE>

<LI><CODE>TIMESTAMP</CODE>

</UL>



<H1><A NAME="Charset" HREF="manual_toc.html#Charset">11  Character Set Support</A></H1>

<P>
<A NAME="IDX1083"></A>
<A NAME="IDX1084"></A>
<A NAME="IDX1085"></A>
<A NAME="IDX1086"></A>
<A NAME="IDX1087"></A>

</P>

<P>
Improved support for character set handling was added to MySQL in Version
4.1.  The features described here are as implemented in MySQL 4.1.1.
(MySQL 4.1.0 has some but not all of these features, and some of them are
implemented differently.)

</P>
<P>
This chapter discusses the following topics:

</P>

<UL>
<LI>What are character sets and collations?

<LI>The multiple-level default system

<LI>New syntax in MySQL 4.1

<LI>Affected functions and operations

<LI>Unicode support

<LI>The meaning of each individual character set and collation

</UL>

<P>
Character set support currently is included in the <CODE>MySISAM</CODE>,
<CODE>MEMORY</CODE> (<CODE>HEAP</CODE>), and (as of MySQL 4.1.2) <CODE>InnoDB</CODE> storage
engines.  The <CODE>ISAM</CODE> storage engine does not include character set
support; there are no plans to change this, because <CODE>ISAM</CODE> is
deprecated.

</P>



<H2><A NAME="Charset-general" HREF="manual_toc.html#Charset-general">11.1  Character Sets and Collations in General</A></H2>

<P>
A <STRONG>character set</STRONG> is a set of symbols and encodings. A <STRONG>collation</STRONG> is a set of rules for comparing characters in a
character set. Let's make the distinction clear with an example of
an imaginary character set.

</P>

<P>
Suppose that we have an alphabet with four letters: <SAMP>`A'</SAMP>, <SAMP>`B'</SAMP>, <SAMP>`a'</SAMP>,
<SAMP>`b'</SAMP>. We give each letter a number: <SAMP>`A'</SAMP> = 0, <SAMP>`B'</SAMP> = 1, <SAMP>`a'</SAMP> =
2, <SAMP>`c'</SAMP> =
3. The letter <SAMP>`A'</SAMP> is a symbol, the number 0 is the <STRONG>encoding</STRONG>
for <SAMP>`A'</SAMP>, and the combination of all four letters and their
encodings is a <STRONG>character set</STRONG>.

</P>

<P>
Now, suppose that we want to compare two string values, <SAMP>`A'</SAMP> and <SAMP>`B'</SAMP>.
The simplest way to do this is to look at the encodings: 0 for
<SAMP>`A'</SAMP> and 1 for <SAMP>`B'</SAMP>. Because 0 is less than 1, we say <SAMP>`A'</SAMP> is less
than <SAMP>`B'</SAMP>. Now, what we've just done is apply a collation to our
character set. The collation is a set of rules (only one rule in
this case): ``compare the encodings.'' We call this simplest of all
possible collations a <STRONG>binary</STRONG> collation.

</P>

<P>
But what if we want to say that the lowercase and uppercase
letters are equivalent? Then we would have at least two rules: (1)
treat the lowercase letters <SAMP>`a'</SAMP> and <SAMP>`b'</SAMP> as equivalent to <SAMP>`A'</SAMP> and
<SAMP>`B'</SAMP>; (2) then compare the encodings. We call this a
<STRONG>case-insensitive</STRONG> collation. It's a little more complex than a
binary collation.

</P>

<P>
In real life, most character sets have many characters: not just
<SAMP>`A'</SAMP> and <SAMP>`B'</SAMP> but whole alphabets, sometimes multiple alphabets or
eastern writing systems with thousands of characters, along with
many special symbols and punctuation marks. Also in real life, most
collations have many rules: not just case insensitivity but also
accent insensitivity (an ``accent'' is a mark attached to a character
as in German <SAMP>`@"O'</SAMP>) and multiple-character mappings (such as the
rule that <SAMP>`@"O'</SAMP> = <SAMP>`OE'</SAMP> in one of the two German collations).

</P>
<P>
MySQL 4.1 can do these things for you:

</P>

<UL>
<LI>Store strings using a variety of character sets

<LI>Compare strings using a variety of collations

<LI>Mix strings with different character sets or collations in the

same server, the same database, or even the same table
<LI>Allow specification of character set and collation at any

level

</UL>

<P>
In these respects, not only is MySQL 4.1 far more flexible than
MySQL 4.0, it also is far ahead of other DBMSs. However, to use the
new features effectively, you will need to learn what character
sets and collations are available, how to change their defaults,
and what the various string operators do with them.

</P>



<H2><A NAME="Charset-MySQL" HREF="manual_toc.html#Charset-MySQL">11.2  Character Sets and Collations in MySQL</A></H2>

<P>
The MySQL server can support multiple character sets. To list the available
character sets, use the <CODE>SHOW CHARACTER SET</CODE> statement:

</P>


<PRE>
mysql&#62; SHOW CHARACTER SET;
+----------+-----------------------------+---------------------+
| Charset  | Description                 | Default collation   |
+----------+-----------------------------+---------------------+
| big5     | Big5 Traditional Chinese    | big5_chinese_ci     |
| dec8     | DEC West European           | dec8_swedish_ci     |
| cp850    | DOS West European           | cp850_general_ci    |
| hp8      | HP West European            | hp8_english_ci      |
| koi8r    | KOI8-R Relcom Russian       | koi8r_general_ci    |
| latin1   | ISO 8859-1 West European    | latin1_swedish_ci   |
| latin2   | ISO 8859-2 Central European | latin2_general_ci   |
...
</PRE>

<P>
The output actually includes another column that is not shown so that the
example fits better on the page.

</P>
<P>
Any given character set always has at least one collation. It may have
several collations.

</P>
<P>
To list the collations for a character set, use the <CODE>SHOW COLLATION</CODE>
statement. For example, to see the collations for the <CODE>latin1</CODE>
(``ISO-8859-1 West European'') character set, use this statement to find
those collation names that begin with <CODE>latin1</CODE>:

</P>

<PRE>
mysql&#62; SHOW COLLATION LIKE 'latin1%';
+-------------------+---------+----+---------+----------+---------+
| Collation         | Charset | Id | Default | Compiled | Sortlen |
+-------------------+---------+----+---------+----------+---------+
| latin1_german1_ci | latin1  |  5 |         |          |       0 |
| latin1_swedish_ci | latin1  |  8 | Yes     | Yes      |       1 |
| latin1_danish_ci  | latin1  | 15 |         |          |       0 |
| latin1_german2_ci | latin1  | 31 |         | Yes      |       2 |
| latin1_bin        | latin1  | 47 |         | Yes      |       1 |
| latin1_general_ci | latin1  | 48 |         |          |       0 |
| latin1_general_cs | latin1  | 49 |         |          |       0 |
| latin1_spanish_ci | latin1  | 94 |         |          |       0 |
+-------------------+---------+----+---------+----------+---------+
</PRE>

<P>
The <CODE>latin1</CODE> collations have the following meanings:

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Collation</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>latin1_bin</CODE> </TD><TD> Binary according to <CODE>latin1</CODE> encoding
</TD></TR>
<TR><TD><CODE>latin1_danish_ci</CODE> </TD><TD> Danish/Norwegian
</TD></TR>
<TR><TD><CODE>latin1_general_ci</CODE> </TD><TD> Multilingual
</TD></TR>
<TR><TD><CODE>latin1_general_cs</CODE> </TD><TD> Multilingual, case sensitive
</TD></TR>
<TR><TD><CODE>latin1_german1_ci</CODE> </TD><TD> German DIN-1
</TD></TR>
<TR><TD><CODE>latin1_german2_ci</CODE> </TD><TD> German DIN-2
</TD></TR>
<TR><TD><CODE>latin1_spanish_ci</CODE> </TD><TD> Modern Spanish
</TD></TR>
<TR><TD><CODE>latin1_swedish_ci</CODE> </TD><TD> Swedish/Finnish

</TD></TR>
</TABLE>

<P>
Collations have these general characteristics:

</P>

<UL>
<LI>

Two different character sets cannot have the same collation.

<LI>

Each character set has one collation that is the <EM>default
collation</EM>. For example, the default collation for <CODE>latin1</CODE> is
<CODE>latin1_swedish_ci</CODE>.

<LI>

There is a convention for collation names: They start
with the name of the character set with which they are associated, they
usually include a language name, and they end with <CODE>_ci</CODE> (case
insensitive), <CODE>_cs</CODE> (case sensitive), <CODE>_bin</CODE> (binary), or
<CODE>_uca</CODE>
(<a HREF="http://www.unicode.org/reports/tr10/">Unicode Collation Algorithm</a>).

</UL>



<H2><A NAME="Charset-defaults" HREF="manual_toc.html#Charset-defaults">11.3  Determining the Default Character Set and Collation</A></H2>

<P>
There are default settings for character sets and collations at
four levels: server, database, table, and connection. The following
description may appear complex, but it has been found in practice
that multiple-level defaulting leads to natural and obvious
results.

</P>



<H3><A NAME="Charset-server" HREF="manual_toc.html#Charset-server">11.3.1  Server Character Set and Collation</A></H3>

<P>
The MySQL Server has a server character set and a server collation,
which may not be null.

</P>
<P>
MySQL determines the server character set and server collation
thus:

</P>

<UL>

<LI>

According to the option settings in effect when the server starts
<LI>

According to the values set at runtime

</UL>

<P>
At the server level, the decision is simple. The server
character set and collation depend initially on the
options that you use when you start <CODE>mysqld</CODE>. You can use
<CODE>--default-character-set</CODE> for the character set, and
along with it you can add <CODE>--default-collation</CODE> for the
collation. If you don't specify a character set, that is the same as saying
<CODE>--default-character-set=latin1</CODE>. If you specify only a character set
(for example, <CODE>latin1</CODE>) but not a collation, that is the same as saying
<CODE>--default-charset=latin1</CODE> <CODE>--default-collation=latin1_swedish_ci</CODE>
because <CODE>latin1_swedish_ci</CODE> is the default collation for <CODE>latin1</CODE>.
Therefore, the following three commands all have the same effect:

</P>

<PRE>
shell&#62; mysqld
shell&#62; mysqld --default-character-set=latin1
shell&#62; mysqld --default-character-set=latin1 \
           --default-collation=latin1_swedish_ci
</PRE>

<P>
One way to change the settings is by recompiling. If you want to
change the default server character set and collation when building
from sources, use: <CODE>--with-charset</CODE> and <CODE>--with-collation</CODE>
as arguments for <CODE>configure</CODE>. For example:

</P>

<PRE>
shell&#62; ./configure --with-charset=latin1
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; ./configure --with-charset=latin1 \
           --with-collation=latin1_german1_ci
</PRE>

<P>
Both <CODE>mysqld</CODE> and <CODE>configure</CODE> verify that the character
set/collation combination is valid. If not, each program displays an error
message and terminates.

</P>
<P>
The current server character set and collation are available as the values of
the <CODE>character_set_server</CODE> and <CODE>collation_server</CODE> system variables.
These variables can be changed at runtime.

</P>



<H3><A NAME="Charset-database" HREF="manual_toc.html#Charset-database">11.3.2  Database Character Set and Collation</A></H3>

<P>
Every database has a database character set and a database
collation, which may not be null. The <CODE>CREATE DATABASE</CODE> and <CODE>ALTER
DATABASE</CODE> statements have optional clauses for specifying the
database character set and collation:

</P>

<PRE>
CREATE DATABASE db_name
    [[DEFAULT] CHARACTER SET charset_name]
    [[DEFAULT] COLLATE collation_name]

ALTER DATABASE db_name
    [[DEFAULT] CHARACTER SET charset_name]
    [[DEFAULT] COLLATE collation_name]
</PRE>

<P>
Example:

</P>

<PRE>
CREATE DATABASE db_name
    DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci;
</PRE>

<P>
MySQL chooses the database character set and database collation
thus:

</P>

<UL>
<LI>If both <CODE>CHARACTER SET X</CODE> and <CODE>COLLATE Y</CODE> were specified, then

character set <CODE>X</CODE> and collation <CODE>Y</CODE>.
<LI>If <CODE>CHARACTER SET X</CODE> was specified without <CODE>COLLATE</CODE>, then

character set <CODE>X</CODE> and its default collation.
<LI>Otherwise, the server character set and server collation.

</UL>

<P>
MySQL's <CODE>CREATE DATABASE ... DEFAULT CHARACTER SET ...</CODE> syntax is
analogous to the standard SQL <CODE>CREATE SCHEMA ... CHARACTER SET ...</CODE>
syntax. Because of this, it is possible to create databases with
different character sets and collations on the same MySQL
server.

</P>

<P>
The database character set and collation are used as default
values if the table character set and collation are not specified
in <CODE>CREATE TABLE</CODE> statements. They have no other purpose.

</P>
<P>
The character set and collation for the default database are available as
the values of the <CODE>character_set_database</CODE> and
<CODE>collation_database</CODE> system variables.  The server sets these variables
whenever the default database changes.  If there is no default database, the
variables have the same value as the corresponding server-level variables,
<CODE>character_set_server</CODE> and <CODE>collation_server</CODE>.

</P>



<H3><A NAME="Charset-table" HREF="manual_toc.html#Charset-table">11.3.3  Table Character Set and Collation</A></H3>

<P>
Every table has a table character set and a table collation, which
may not be null. The <CODE>CREATE TABLE</CODE> and <CODE>ALTER TABLE</CODE> statements
have optional clauses for specifying the table character set and
collation:

</P>

<PRE>
CREATE TABLE tbl_name ( column_list )
    [DEFAULT CHARACTER SET charset_name [COLLATE collation_name]]

ALTER TABLE tbl_name
    [DEFAULT CHARACTER SET charset_name] [COLLATE collation_name]
</PRE>

<P>
Example:

</P>

<PRE>
CREATE TABLE t1 ( ... )
    DEFAULT CHARACTER SET latin1 COLLATE latin1_danish_ci;
</PRE>

<P>
MySQL chooses the table character set and collation thus:

</P>

<UL>
<LI>If both <CODE>CHARACTER SET X</CODE> and <CODE>COLLATE Y</CODE> were specified, then

character set <CODE>X</CODE> and collation <CODE>Y</CODE>.
<LI>If <CODE>CHARACTER SET X</CODE> was specified without <CODE>COLLATE</CODE>, then

character set <CODE>X</CODE> and its default collation.
<LI>Otherwise, the database character set and collation.

</UL>

<P>
The table character set and collation are used as default
values if the column character set and collation are not specified
in individual column definitions. The table character set and
collation are MySQL extensions; there are no such things in
standard SQL.

</P>



<H3><A NAME="Charset-column" HREF="manual_toc.html#Charset-column">11.3.4  Column Character Set and Collation</A></H3>

<P>
Every ``character'' column (that is, a column of type <CODE>CHAR</CODE>,
<CODE>VARCHAR</CODE>, or <CODE>TEXT</CODE>) has a column character set and a column
collation, which may not be null. Column definition syntax has optional
clauses for specifying the column character set and collation:

</P>

<PRE>
col_name {CHAR | VARCHAR | TEXT} (col_length)
    [CHARACTER SET charset_name [COLLATE collation_name]]
</PRE>

<P>
Example:

</P>

<PRE>
CREATE TABLE Table1
(
    column1 VARCHAR(5) CHARACTER SET latin1 COLLATE latin1_german1_ci
);
</PRE>

<P>
MySQL chooses the column character set and collation thus:

</P>

<UL>
<LI>If both <CODE>CHARACTER SET X</CODE> and <CODE>COLLATE Y</CODE> were specified, then

character set <CODE>X</CODE> and collation <CODE>Y</CODE>.
<LI>If <CODE>CHARACTER SET X</CODE> was specified without <CODE>COLLATE</CODE>, then

character set <CODE>X</CODE> and its default collation.
<LI>Otherwise, the table character set and collation.

</UL>

<P>
The <CODE>CHARACTER SET</CODE> and <CODE>COLLATE</CODE> clauses are standard SQL.

</P>



<H3><A NAME="Charset-examples" HREF="manual_toc.html#Charset-examples">11.3.5  Examples of Character Set and Collation Assignment</A></H3>

<P>
The following examples show how MySQL determines default character set and
collation values.

</P>

<H4>11.3.5.1  Example 1: Table + Column Definition</H4>


<PRE>
CREATE TABLE t1
(
    c1 CHAR(10) CHARACTER SET latin1 COLLATE latin1_german1_ci
) DEFAULT CHARACTER SET latin2 COLLATE latin2_bin;
</PRE>

<P>
Here we have a column with a <CODE>latin1</CODE> character set
and a <CODE>latin1_german1_ci</CODE> collation. The definition is explicit, so
that's straightforward. Notice that there's no problem storing a
<CODE>latin1</CODE> column in a <CODE>latin2</CODE> table.

</P>

<H4>11.3.5.2  Example 2: Table + Column Definition</H4>


<PRE>
CREATE TABLE t1
(
    c1 CHAR(10) CHARACTER SET latin1
) DEFAULT CHARACTER SET latin1 COLLATE latin1_danish_ci;
</PRE>

<P>
This time we have a column with a <CODE>latin1</CODE> character
set and a default collation. Now, although it might seem natural,
the default collation is not taken from the table level. Instead,
because the default collation for <CODE>latin1</CODE> is always
<CODE>latin1_swedish_ci</CODE>,
column <CODE>c1</CODE> will have a collation of <CODE>latin1_swedish_ci</CODE> (not
<CODE>latin1_danish_ci</CODE>).

</P>

<H4>11.3.5.3  Example 3: Table + Column Definition</H4>


<PRE>
CREATE TABLE t1
(
    c1 CHAR(10)
) DEFAULT CHARACTER SET latin1 COLLATE latin1_danish_ci;
</PRE>

<P>
We have a column with a default character set and
a default collation. In this circumstance, MySQL looks up to the
table level for inspiration in determining the column character set and
collation. So, the character set for column <CODE>c1</CODE> is
<CODE>latin1</CODE> and its collation is <CODE>latin1_danish_ci</CODE>.

</P>

<H4>11.3.5.4  Example 4: Database + Table + Column Definition</H4>


<PRE>
CREATE DATABASE d1
    DEFAULT CHARACTER SET latin2 COLLATE latin2_czech_ci;
USE d1;
CREATE TABLE t1
(
    c1 CHAR(10)
);
</PRE>

<P>
We create a column without specifying its
character set and collation. We're also not specifying a character
set and a collation at the table level. In this circumstance, MySQL
looks up to the database level for inspiration. (The database's
settings become the table's settings, and thereafter become the
column's setting.) So, the character set for column <CODE>c1</CODE> is <CODE>latin2</CODE>
and its collation is <CODE>latin2_czech_ci</CODE>.

</P>



<H3><A NAME="Charset-connection" HREF="manual_toc.html#Charset-connection">11.3.6  Connection Character Sets and Collations</A></H3>

<P>
Several character set and collation system variables relate to a client's
interaction with the server. Some of these have already been mentioned in
earlier sections:

</P>

<UL>

<LI>

The server character set and collation are available as the values of the
<CODE>character_set_server</CODE> and <CODE>collation_server</CODE> variables.

<LI>

The character set and collation of the default database are available as the
values of the <CODE>character_set_database</CODE> and <CODE>collation_database</CODE>
variables.

</UL>

<P>
Additional character set and collation variables are involved in handling
traffic for the connection between a client and the server.  Every client has
connection-related character set and collation variables.

</P>
<P>
Consider what a ``connection'' is: It's what you make when you connect to
the server. The client sends SQL statements, such as queries, over the
connection to the server. The server sends responses, such as result sets,
over the connection back to the client. This leads to several questions
about character set and collation handling for client connections, each of
which can be answered in terms of system variables:

</P>

<UL>

<LI>

What character set is the query in when it leaves the client?

The server takes the <CODE>character_set_client</CODE> variable to be the
character set in which queries are sent by the client.

<LI>

What character set should the server translate a query to after receiving it?

For this, <CODE>character_set_connection</CODE> and <CODE>collation_connection</CODE>
are used by the server.  It converts queries sent by the client from
<CODE>character_set_client</CODE> to <CODE>character_set_connection</CODE>
(except for string literals that have an introducer such as <CODE>_latin1</CODE> or
<CODE>_utf8</CODE>).
<CODE>collation_connection</CODE> is important for comparisons of literal strings.
For comparisons of strings with column values, it does not matter because
columns have a higher collation precedence.

<LI>

What character set should the server translate to before shipping result
sets or error messages back to the client?

The <CODE>character_set_results</CODE> variable indicates the character set in
which the server returns query results to the client. This includes result
data such as column values, and result metadata such as column names.

</UL>

<P>
You can fine-tune the settings for these variables, or you can depend on the
defaults (in which case, you can skip this section).

</P>
<P>
There are two statements that affect the connection character sets:

</P>

<PRE>
SET NAMES 'charset_name'
SET CHARACTER SET charset_name
</PRE>

<P>
<CODE>SET NAMES</CODE> indicates what is in the SQL statement that the client
sends. Thus, <CODE>SET NAMES 'cp1251'</CODE> tells the server ``future incoming
messages from this client will be in character set <CODE>cp1251</CODE>.'' It
also specifies the character set for results that the server sends back to
the client.  (For example, it indicates what character set column values
will have if you use a <CODE>SELECT</CODE> statement.)

</P>
<P>
A <CODE>SET NAMES 'x'</CODE> statement
is equivalent to these three statements:

</P>

<PRE>
mysql&#62; SET character_set_client = x;
mysql&#62; SET character_set_results = x;
mysql&#62; SET character_set_connection = x;
</PRE>

<P>
<CODE>SET CHARACTER SET</CODE> is similar but sets the connection character set
and collation to be those of the default database.  A <CODE>SET CHARACTER SET
x</CODE> statement is equivalent to these three statements:

</P>

<PRE>
mysql&#62; SET character_set_client = x;
mysql&#62; SET character_set_results = x;
mysql&#62; SET collation_connection = @@collation_database;
</PRE>

<P>
When a client connects, it sends to the server the name of the character set
that it wants to use. The server sets the <CODE>character_set_client</CODE>,
<CODE>character_set_results</CODE>, and <CODE>character_set_connection</CODE> variables
to that character set. (In effect, the server performs a <CODE>SET NAMES</CODE>
operation using the character set.)

</P>
<P>
With the <CODE>mysql</CODE> client, it is not necessary to execute <CODE>SET NAMES</CODE>
every time you start up if you want to use a character set different from
the default. You can add the <CODE>--default-character-set</CODE>  option setting
to your <CODE>mysql</CODE> statement line, or in your option file.  For example,
the following option file setting changes the three character set variables
set to <CODE>koi8r</CODE> each time you run <CODE>mysql</CODE>:

</P>

<PRE>
[mysql]
default-character-set=koi8r
</PRE>

<P>
Example: Suppose that <CODE>column1</CODE> is defined as <CODE>CHAR(5) CHARACTER
SET latin2</CODE>.  If you do not say <CODE>SET NAMES</CODE> or <CODE>SET CHARACTER SET</CODE>,
then for <CODE>SELECT column1 FROM t</CODE>, the server will send back all the
values for <CODE>column1</CODE> using the character set that the client specified
when it connected. On the other hand, if you say <CODE>SET NAMES 'latin1'</CODE>
or <CODE>SET CHARACTER SET latin1</CODE>, then just before sending results back,
the server will convert the <CODE>latin2</CODE> values to <CODE>latin1</CODE>.
Conversion may be lossy if there are characters that are not in both
character sets.

</P>
<P>
If you do not want the server to perform any conversion, set
<CODE>character_set_results</CODE> to <CODE>NULL</CODE>:

</P>

<PRE>
mysql&#62; SET character_set_results = NULL;
</PRE>



<H3><A NAME="Charset-literal" HREF="manual_toc.html#Charset-literal">11.3.7  Character String Literal Character Set and Collation</A></H3>

<P>
Every character string literal has a character set and a collation,
which may not be null.

</P>
<P>
A character string literal may have an optional character set
introducer and <CODE>COLLATE</CODE> clause:

</P>
<P>
<A NAME="IDX1088"></A>
<A NAME="IDX1089"></A>

</P>

<PRE>
[_charset_name]'string' [COLLATE collation_name]
</PRE>

<P>
Examples:

<PRE>
SELECT 'string';
SELECT _latin1'string';
SELECT _latin1'string' COLLATE latin1_danish_ci;
</PRE>

<P>
For the simple statement <CODE>SELECT 'string'</CODE>, the string has the character
set and collation defined by the <CODE>character_set_connection</CODE> and
<CODE>collation_connection</CODE> system variables.

</P>
<P>
The <CODE>_charset_name</CODE> expression is formally called
an <EM>introducer</EM>. It tells the parser,
``the string that is about to follow is in character set <CODE>X</CODE>.''
Because this has confused people in the past, we emphasize
that an introducer does not cause any conversion, it is strictly a
signal that does not change the string's value. An introducer is
also legal before standard hex literal and numeric hex literal notation
(<CODE>x'literal'</CODE> and <CODE>0xnnnn</CODE>), and before <CODE>?</CODE> (parameter
substitution when using prepared statements within a programming language
interface).

</P>
<P>
Examples:

</P>

<PRE>
SELECT _latin1 x'AABBCC';
SELECT _latin1 0xAABBCC;
SELECT _latin1 ?;
</PRE>

<P>
MySQL determines a literal's character set and collation thus:

</P>

<UL>
<LI>If both <CODE>_X</CODE> and <CODE>COLLATE Y</CODE> were specified, then

character set <CODE>X</CODE> and collation <CODE>Y</CODE>
<LI>If <CODE>_X</CODE> is specified but <CODE>COLLATE</CODE> is not specified, then

character set <CODE>X</CODE> and its default collation
<LI>Otherwise, the character set and collation given by the

<CODE>character_set_connection</CODE> and <CODE>collation_connection</CODE> system
variables

</UL>

<P>
Examples:

</P>

<UL>
<LI>

A string with <CODE>latin1</CODE> character set and <CODE>latin1_german1_ci</CODE>
collation:


<PRE>
SELECT _latin1'M@"uller' COLLATE latin1_german1_ci;
</PRE>

<LI>

A string with <CODE>latin1</CODE> character set and its default collation (that is,
<CODE>latin1_swedish_ci</CODE>):


<PRE>
SELECT _latin1'M@"uller';
</PRE>

<LI>

A string with the connection default character set and collation:


<PRE>
SELECT 'M@"uller';
</PRE>

</UL>

<P>
Character set introducers and the <CODE>COLLATE</CODE> clause are implemented
according to standard SQL specifications.

</P>


<H3><A NAME="Charset-collate" HREF="manual_toc.html#Charset-collate">11.3.8  Using <CODE>COLLATE</CODE> in SQL Statements</A></H3>

<P>
With the <CODE>COLLATE</CODE> clause, you can override whatever the default
collation is for a comparison. <CODE>COLLATE</CODE> may be used in
various parts of SQL statements.  Here are some examples:

</P>

<UL>

<LI>With <CODE>ORDER BY</CODE>:


<PRE>
SELECT k
FROM t1
ORDER BY k COLLATE latin1_german2_ci;
</PRE>

<LI>With <CODE>AS</CODE>:


<PRE>
SELECT k COLLATE latin1_german2_ci AS k1
FROM t1
ORDER BY k1;
</PRE>

<LI>With <CODE>GROUP BY</CODE>:


<PRE>
SELECT k
FROM t1
GROUP BY k COLLATE latin1_german2_ci;
</PRE>

<LI>With aggregate functions:


<PRE>
SELECT MAX(k COLLATE latin1_german2_ci)
FROM t1;
</PRE>

<LI>With <CODE>DISTINCT</CODE>:


<PRE>
SELECT DISTINCT k COLLATE latin1_german2_ci
FROM t1;
</PRE>

<LI>With <CODE>WHERE</CODE>:


<PRE>
SELECT *
FROM t1
WHERE _latin1 'M@"uller' COLLATE latin1_german2_ci = k;
</PRE>

<LI>With <CODE>HAVING</CODE>:


<PRE>
SELECT k
FROM t1
GROUP BY k
HAVING k = _latin1 'M@"uller' COLLATE latin1_german2_ci;
</PRE>

</UL>



<H3><A NAME="Charset-collate-precedence" HREF="manual_toc.html#Charset-collate-precedence">11.3.9  <CODE>COLLATE</CODE> Clause Precedence</A></H3>

<P>
The <CODE>COLLATE</CODE> clause has high precedence (higher than <CODE>||</CODE>),
so the following two expressions are equivalent:

</P>

<PRE>
x || y COLLATE z
x || (y COLLATE z)
</PRE>



<H3><A NAME="Charset-binary-op" HREF="manual_toc.html#Charset-binary-op">11.3.10  <CODE>BINARY</CODE> Operator</A></H3>

<P>
The <CODE>BINARY</CODE> operator is a shorthand for a <CODE>COLLATE</CODE> clause.
<CODE>BINARY 'x'</CODE> is equivalent to <CODE>'x' COLLATE y</CODE>, where <CODE>y</CODE> is
the name of the binary collation for the character set of <CODE>'x'</CODE>.  Every
character set has a binary collation.  For example, the binary collation for
the <CODE>latin1</CODE> character set is <CODE>latin1_bin</CODE>, so if the column
<CODE>a</CODE> is of character set <CODE>latin1</CODE>, the following two statements have
the same effect:

</P>

<PRE>
SELECT * FROM t1 ORDER BY BINARY a;
SELECT * FROM t1 ORDER BY a COLLATE latin1_bin;
</PRE>



<H3><A NAME="Charset-collate-tricky" HREF="manual_toc.html#Charset-collate-tricky">11.3.11  Some Special Cases Where the Collation Determination Is Tricky</A></H3>

<P>
In the great majority of queries, it is obvious what collation
MySQL uses to resolve a comparison operation. For example, in the
following cases, it should be clear that the collation will be ``the
column collation of column <CODE>x</CODE>'':

</P>

<PRE>
SELECT x FROM T ORDER BY x;
SELECT x FROM T WHERE x = x;
SELECT DISTINCT x FROM T;
</PRE>

<P>
However, when multiple operands are involved, there can be
ambiguity. For example:

</P>

<PRE>
SELECT x FROM T WHERE x = 'Y';
</PRE>

<P>
Should this query use the collation of the column <CODE>x</CODE>, or of the
string literal <CODE>'Y'</CODE>?

</P>
<P>
Standard SQL resolves such questions using what used to be
called ``coercibility'' rules. The essence is: Because <CODE>x</CODE> and <CODE>'Y'</CODE>
both have collations, whose collation takes precedence? It's complex,
but the following rules take care of most situations:

</P>

<UL>

<LI>An explicit <CODE>COLLATE</CODE> clause has a coercibility of 0.

(Not coercible at all.)

<LI>A concatenation of two strings with different collations has

a coercibility of 1.

<LI>A column's collation has a coercibility of 2.

<LI>A literal's collation has a coercibility of 3.

</UL>

<P>
Those rules resolve ambiguities thus:

</P>

<UL>

<LI>Use the collation with the lowest coercibility value.

<LI>If both sides have the same coercibility, then it is an error if

the collations aren't the same.

</UL>

<P>
Examples:

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><CODE>column1 = 'A'</CODE> </TD><TD> Use collation of <CODE>column1</CODE>
</TD></TR>
<TR><TD><CODE>column1 = 'A' COLLATE x</CODE> </TD><TD> Use collation of <CODE>'A'</CODE>
</TD></TR>
<TR><TD><CODE>column1 COLLATE x = 'A' COLLATE y</CODE> </TD><TD> Error

</TD></TR>
</TABLE>

<P>
The <CODE>COERCIBILITY()</CODE> function can be used to determine the coercibility
of a string expression:

</P>

<PRE>
mysql&#62; SELECT COERCIBILITY('A' COLLATE latin1_swedish_ci);
        -&#62; 0
mysql&#62; SELECT COERCIBILITY('A');
        -&#62; 3
</PRE>

<P>
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.

</P>



<H3><A NAME="Charset-collation-charset" HREF="manual_toc.html#Charset-collation-charset">11.3.12  Collations Must Be for the Right Character Set</A></H3>

<P>
Recall that each character set has one or more
collations, and each collation is associated with one and only one
character set. Therefore, the following statement
causes an error message because the <CODE>latin2_bin</CODE> collation is not
legal with the <CODE>latin1</CODE> character set:

</P>

<PRE>
mysql&#62; SELECT _latin1 'x' COLLATE latin2_bin;
ERROR 1251: COLLATION 'latin2_bin' is not valid
for CHARACTER SET 'latin1'
</PRE>

<P>
In some cases, expressions that worked before MySQL 4.1 fail as of MySQL 4.1
if you do not take character set and collation into account. For example,
before 4.1, this statement works as is:

</P>

<PRE>
mysql&#62; SELECT SUBSTRING_INDEX(USER(),'@',1);
+-------------------------------+
| SUBSTRING_INDEX(USER(),'@',1) |
+-------------------------------+
| root                          |
+-------------------------------+
</PRE>

<P>
After an upgrade to MySQL 4.1, the statement fails:

</P>

<PRE>
mysql&#62; SELECT SUBSTRING_INDEX(USER(),'@',1);
ERROR 1267 (HY000): Illegal mix of collations
(utf8_general_ci,IMPLICIT) and (latin1_swedish_ci,COERCIBLE)
for operation 'substr_index'
</PRE>

<P>
The reason this occurs is that usernames are stored using UTF8
(see section <A HREF="manual.html#Charset-metadata">11.6  UTF8 for Metadata</A>). As a result, the <CODE>USER()</CODE> function and
the literal string <CODE>'@'</CODE> have different character sets (and thus
different collations):

</P>

<PRE>
mysql&#62; SELECT COLLATION(USER()), COLLATION('@');
+-------------------+-------------------+
| COLLATION(USER()) | COLLATION('@')    |
+-------------------+-------------------+
| utf8_general_ci   | latin1_swedish_ci |
+-------------------+-------------------+
</PRE>

<P>
One way to deal with this is to tell MySQL to interpret the literal
string as <CODE>utf8</CODE>:

</P>

<PRE>
mysql&#62; SELECT SUBSTRING_INDEX(USER(),_utf8'@',1);
+------------------------------------+
| SUBSTRING_INDEX(USER(),_utf8'@',1) |
+------------------------------------+
| root                               |
+------------------------------------+
</PRE>

<P>
Another way is to change the connection character set and collation to
<CODE>utf8</CODE>. You can do that with <CODE>SET NAMES 'utf8'</CODE> or by setting
the <CODE>character_set_connection</CODE> and <CODE>collation_connection</CODE> system
variables directly.

</P>



<H3><A NAME="Charset-collation-effect" HREF="manual_toc.html#Charset-collation-effect">11.3.13  An Example of the Effect of Collation</A></H3>

<P>
Suppose that column <CODE>X</CODE> in table <CODE>T</CODE> has these <CODE>latin1</CODE> column values:

</P>

<PRE>
Muffler
M@"uller
MX Systems
MySQL
</PRE>

<P>
And suppose that the column values are retrieved using the following
statement:

</P>

<PRE>
SELECT X FROM T ORDER BY X COLLATE collation_name;
</PRE>

<P>
The resulting order of the values for different collations is shown in this
table:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>latin1_swedish_ci</CODE> </TD><TD> <CODE>latin1_german1_ci</CODE> </TD><TD> <CODE>latin1_german2_ci</CODE>
</TD></TR>
<TR><TD>Muffler </TD><TD> Muffler </TD><TD> M@"uller
</TD></TR>
<TR><TD>MX Systems </TD><TD> M@"uller </TD><TD> Muffler
</TD></TR>
<TR><TD>M@"uller </TD><TD> MX Systems </TD><TD> MX Systems
</TD></TR>
<TR><TD>MySQL </TD><TD> MySQL </TD><TD> MySQL
</TD></TR>
</TABLE>

<P>
The table is an example that shows what the effect would
be if we used different collations in an <CODE>ORDER BY</CODE> clause. The
character that causes the different sort orders in this example is the U with
two dots over it, which the Germans call U-umlaut, but we'll call
it U-diaeresis.

</P>

<UL>

<LI>

The first column shows the result of the <CODE>SELECT</CODE> using the
Swedish/Finnish collating rule, which says that U-diaeresis sorts
with Y.

<LI>

The second column shows the result of the <CODE>SELECT</CODE> using the
German DIN-1 rule, which says that U-diaeresis sorts with U.

<LI>

The third column shows the result of the <CODE>SELECT</CODE> using the German
DIN-2 rule, which says that U-diaeresis sorts with UE.

</UL>

<P>
Three different collations, three different results. That's what
MySQL is here to handle. By using the appropriate collation, you can choose
the sort order you want.

</P>



<H2><A NAME="Charset-operations" HREF="manual_toc.html#Charset-operations">11.4  Operations Affected by Character Set Support</A></H2>

<P>
This section describes operations that take character set information
into account as of MySQL 4.1.

</P>


<H3><A NAME="Charset-result" HREF="manual_toc.html#Charset-result">11.4.1  Result Strings</A></H3>

<P>
MySQL has many operators and functions that return a string.
This section answers the question: What is the character set
and collation of such a string?

</P>
<P>
For simple functions that take string input and return a string result as
output, the output's character set and collation are the same as those of
the principal input value. For example, <CODE>UPPER(X)</CODE> returns a string
whose character string and collation are the same as that of <CODE>X</CODE>.
The same applies for
<CODE>INSTR()</CODE>,
<CODE>LCASE()</CODE>,
<CODE>LOWER()</CODE>,
<CODE>LTRIM()</CODE>,
<CODE>MID()</CODE>,
<CODE>REPEAT()</CODE>,
<CODE>REPLACE()</CODE>,
<CODE>REVERSE()</CODE>,
<CODE>RIGHT()</CODE>,
<CODE>RPAD()</CODE>,
<CODE>RTRIM()</CODE>,
<CODE>SOUNDEX()</CODE>,
<CODE>SUBSTRING()</CODE>,
<CODE>TRIM()</CODE>,
<CODE>UCASE()</CODE>, and
<CODE>UPPER()</CODE>.
(Also note: The <CODE>REPLACE()</CODE> function, unlike all other functions,
ignores the collation of the string input and performs a
case-insensitive comparison every time.)

</P>
<P>
For operations that combine multiple string inputs and return a
single string output, the ``aggregation rules'' of standard SQL apply:

</P>

<UL>
<LI>If an explicit <CODE>COLLATE X</CODE> occurs, then use <CODE>X</CODE>

<LI>If an explicit <CODE>COLLATE X</CODE> and <CODE>COLLATE Y</CODE> occur, then error

<LI>Otherwise, if all collations are <CODE>X</CODE>, then use <CODE>X</CODE>

<LI>Otherwise, the result has no collation

</UL>

<P>
For example, with <CODE>CASE ... WHEN a THEN b WHEN b THEN c COLLATE X
END</CODE>, the resultant collation is <CODE>X</CODE>. The same applies for
<CODE>CASE</CODE>,
<CODE>UNION</CODE>,
<CODE>||</CODE>,
<CODE>CONCAT()</CODE>,
<CODE>ELT()</CODE>,
<CODE>GREATEST()</CODE>,
<CODE>IF()</CODE>, and
<CODE>LEAST()</CODE>.

</P>
<P>
For operations that convert to character data, the character set and
collation of the strings that result from the operations are defined by the
<CODE>character_set_connection</CODE> and <CODE>collation_connection</CODE> system
variables.  This applies for
<CODE>CAST()</CODE>,
<CODE>CHAR()</CODE>,
<CODE>CONV()</CODE>,
<CODE>FORMAT()</CODE>,
<CODE>HEX()</CODE>, and
<CODE>SPACE()</CODE>.

</P>


<H3><A NAME="Charset-CONVERT" HREF="manual_toc.html#Charset-CONVERT">11.4.2  <CODE>CONVERT()</CODE></A></H3>

<P>
<CODE>CONVERT()</CODE> provides a way to convert data between different
character sets. The syntax is:

</P>

<PRE>
CONVERT(expr USING transcoding_name)
</PRE>

<P>
In MySQL, transcoding names are the same as the
corresponding character set names.

</P>
<P>
Examples:

</P>

<PRE>
SELECT CONVERT(_latin1'M@"uller' USING utf8);
INSERT INTO utf8table (utf8column)
    SELECT CONVERT(latin1field USING utf8) FROM latin1table;
</PRE>

<P>
<CODE>CONVERT(... USING ...)</CODE> is implemented according to the standard SQL
specification.

</P>


<H3><A NAME="Charset-CAST" HREF="manual_toc.html#Charset-CAST">11.4.3  <CODE>CAST()</CODE></A></H3>

<P>
You may also use <CODE>CAST()</CODE> to convert a string to a different character
set. The syntax is:

</P>

<PRE>
CAST( character_string AS character_data_type
    CHARACTER SET charset_name )
</PRE>

<P>
Example:

</P>

<PRE>
SELECT CAST(_latin1'test' AS CHAR CHARACTER SET utf8);
</PRE>

<P>
If you use <CODE>CAST()</CODE> without specifying <CODE>CHARACTER SET</CODE>,
the resulting character set and collation are defined by the
<CODE>character_set_connection</CODE> and <CODE>collation_connection</CODE> system
variables.  If you use <CODE>CAST()</CODE> with <CODE>CHARACTER SET X</CODE>, then
the resulting character set and collation are <CODE>X</CODE> and the default
collation of <CODE>X</CODE>.

</P>
<P>
You may not use a <CODE>COLLATE</CODE> clause inside a <CODE>CAST()</CODE>, but you may use
it outside. That is, <CODE>CAST(... COLLATE ...)</CODE> is illegal, but
<CODE>CAST(...) COLLATE ...</CODE> is legal.

</P>
<P>
Example:

</P>

<PRE>
SELECT CAST(_latin1'test' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin;
</PRE>



<H3><A NAME="Charset-SHOW" HREF="manual_toc.html#Charset-SHOW">11.4.4  <CODE>SHOW</CODE> Statements</A></H3>

<P>
Several <CODE>SHOW</CODE> statements are new or modified in MySQL 4.1 to provide
additional character set information.
<CODE>SHOW CHARACTER SET</CODE>,
<CODE>SHOW COLLATION</CODE>, and
<CODE>SHOW CREATE DATABASE</CODE> are new.
<CODE>SHOW CREATE TABLE</CODE> and
<CODE>SHOW COLUMNS</CODE> are modified.

</P>
<P>
The <CODE>SHOW CHARACTER SET</CODE> command shows all available character sets.
It takes an optional <CODE>LIKE</CODE> clause that indicates which character set
names to match.  For example:

</P>

<PRE>
mysql&#62; SHOW CHARACTER SET LIKE 'latin%';
+---------+-----------------------------+-------------------+--------+
| Charset | Description                 | Default collation | Maxlen |
+---------+-----------------------------+-------------------+--------+
| latin1  | ISO 8859-1 West European    | latin1_swedish_ci |      1 |
| latin2  | ISO 8859-2 Central European | latin2_general_ci |      1 |
| latin5  | ISO 8859-9 Turkish          | latin5_turkish_ci |      1 |
| latin7  | ISO 8859-13 Baltic          | latin7_general_ci |      1 |
+---------+-----------------------------+-------------------+--------+
</PRE>

<P>
See section <A HREF="manual.html#SHOW_CHARACTER_SET">14.5.3.2  <CODE>SHOW CHARACTER SET</CODE> Syntax</A>.

</P>
<P>
The output from <CODE>SHOW COLLATION</CODE> includes all available character
sets.
It takes an optional <CODE>LIKE</CODE> clause that indicates which collation
names to match.  For example:

</P>

<PRE>
mysql&#62; SHOW COLLATION LIKE 'latin1%';
+-------------------+---------+----+---------+----------+---------+
| Collation         | Charset | Id | Default | Compiled | Sortlen |
+-------------------+---------+----+---------+----------+---------+
| latin1_german1_ci | latin1  |  5 |         |          |       0 |
| latin1_swedish_ci | latin1  |  8 | Yes     | Yes      |       0 |
| latin1_danish_ci  | latin1  | 15 |         |          |       0 |
| latin1_german2_ci | latin1  | 31 |         | Yes      |       2 |
| latin1_bin        | latin1  | 47 |         | Yes      |       0 |
| latin1_general_ci | latin1  | 48 |         |          |       0 |
| latin1_general_cs | latin1  | 49 |         |          |       0 |
| latin1_spanish_ci | latin1  | 94 |         |          |       0 |
+-------------------+---------+----+---------+----------+---------+
</PRE>

<P>
See section <A HREF="manual.html#SHOW_COLLATION">14.5.3.3  <CODE>SHOW COLLATION</CODE> Syntax</A>.

</P>
<P>
<CODE>SHOW CREATE DATABASE</CODE> displays the <CODE>CREATE DATABASE</CODE> statement
that will create a given database. The result includes all database
options. <CODE>DEFAULT CHARACTER SET</CODE> and <CODE>COLLATE</CODE> are supported. All
database options are stored in a text file named <TT>`db.opt'</TT> that can
be found in the database directory.

</P>

<PRE>
mysql&#62; SHOW CREATE DATABASE a\G
*************************** 1. row ***************************
       Database: a
Create Database: CREATE DATABASE `a`
                 /*!40100 DEFAULT CHARACTER SET macce */
</PRE>

<P>
See section <A HREF="manual.html#SHOW_CREATE_DATABASE">14.5.3.5  <CODE>SHOW CREATE DATABASE</CODE> Syntax</A>.

</P>
<P>
<CODE>SHOW CREATE TABLE</CODE> is similar, but displays the <CODE>CREATE TABLE</CODE>
statement to create a given table. The column definitions now indicate any
character set specifications, and the table options include character set
information.

</P>
<P>
See section <A HREF="manual.html#SHOW_CREATE_TABLE">14.5.3.6  <CODE>SHOW CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
The <CODE>SHOW COLUMNS</CODE> statement displays the collations of a table's
columns when invoked as <CODE>SHOW FULL COLUMNS</CODE>.
Columns with <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, or <CODE>TEXT</CODE> data types have
non-<CODE>NULL</CODE> collations. Numeric and other non-character types have
<CODE>NULL</CODE> collations. For example:

</P>

<PRE>
mysql&#62; SHOW FULL COLUMNS FROM t;
+-------+---------+------------+------+-----+---------+-------+
| Field | Type    | Collation  | Null | Key | Default | Extra |
+-------+---------+------------+------+-----+---------+-------+
| a     | char(1) | latin1_bin | YES  |     | NULL    |       |
| b     | int(11) | NULL       | YES  |     | NULL    |       |
+-------+---------+------------+------+-----+---------+-------+
</PRE>

<P>
The character set is not part of the display. (The character set name is implied by
the collation name.)

</P>
<P>
See section <A HREF="manual.html#SHOW_COLUMNS">14.5.3.4  <CODE>SHOW COLUMNS</CODE> Syntax</A>.

</P>


<H2><A NAME="Charset-Unicode" HREF="manual_toc.html#Charset-Unicode">11.5  Unicode Support</A></H2>

<P>
There are two new (as of MySQL version 4.1) character sets for storing 
Unicode data:

</P>

<UL>
<LI>

<CODE>ucs2</CODE>, the UCS-2 Unicode character set.
<LI>

<CODE>utf8</CODE>, the UTF8 encoding of the Unicode character set.
</UL>

<P>
In UCS-2 (binary Unicode representation), every character is
represented by a two-byte Unicode code with the most significant
byte first. For example: "LATIN CAPITAL LETTER A" has the code
0x0041 and it's stored as a two-byte sequence: 0x00 0x41. "CYRILLIC
SMALL LETTER YERU" (Unicode 0x044B) is stored as a two-byte
sequence: 0x04 0x4B. For Unicode characters and their codes, please
refer to the <a HREF="http://www.unicode.org/">Unicode Home Page</a>.

</P>
<P>
A temporary restriction is that UCS-2 cannot yet be used as a client
character set. That means that <CODE>SET NAMES 'ucs2'</CODE> will not work.

</P>
<P>
The UTF8 character set (transform Unicode representation) is an
alternative way to store Unicode data. It is implemented according
to RFC2279. The idea of the UTF8 character set is that various
Unicode characters fit into byte sequences of different
lengths:

</P>

<UL>
<LI>Basic Latin letters, digits, and punctuation signs use one

byte.
<LI>Most European and Middle East script letters fit into a two-byte

sequence: extended Latin letters (with tilde, macron, acute,
grave and other accents), Cyrillic, Greek, Armenian, Hebrew,
Arabic, Syriac, and others.
<LI>Korean, Chinese, and Japanese ideographs use three-byte

sequences.

</UL>

<P>
Currently, MySQL UTF8 support does not include four-byte sequences.

</P>
<P>
Tip: To save space with UTF8, use <CODE>VARCHAR</CODE> instead of <CODE>CHAR</CODE>.
Otherwise, MySQL has to reserve 30 bytes for a <CODE>CHAR(10) CHARACTER
SET utf8</CODE> column, because that's the maximum possible length.

</P>



<H2><A NAME="Charset-metadata" HREF="manual_toc.html#Charset-metadata">11.6  UTF8 for Metadata</A></H2>

<P>
The metadata is the data about the data. Anything that
describes the database, as opposed to being the contents of the
database, is metadata. Thus column names, database names,
usernames, version names, and most of the string results from <CODE>SHOW</CODE> are
metadata.

</P>
<P>
Representation of metadata must satisfy these requirements:

</P>

<UL>

<LI>

All metadata must be in the same character set. Otherwise, <CODE>SHOW</CODE>
wouldn't work properly because different rows in the same column would be
in different character sets.

<LI>

Metadata must include all characters in all languages. Otherwise, users
wouldn't be able to name columns and tables in their own languages.

</UL>

<P>
In order to satisfy both requirements, MySQL stores metadata in a Unicode
character set, namely UTF8. This will not cause any disruption if you never
use accented characters. But if you do, you should be aware that metadata
is in UTF8.

</P>
<P>
This means that the <CODE>USER()</CODE>, <CODE>CURRENT_USER()</CODE>, and <CODE>VERSION()</CODE>
functions will have the UTF8 character set by default.  So will any
synonyms, such the <CODE>SESSION_USER()</CODE> and <CODE>SYSTEM_USER()</CODE> synonyms
for <CODE>USER()</CODE>.

</P>
<P>
The server sets the <CODE>character_set_system</CODE> system variable to the
name of the metadata character set:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'character_set_system';
+----------------------+-------+
| Variable_name        | Value |
+----------------------+-------+
| character_set_system | utf8  |
+----------------------+-------+
</PRE>

<P>
Storage of metadata using Unicode does <EM>not</EM> mean that the headers
of columns and the results of <CODE>DESCRIBE</CODE> functions will be in the
<CODE>character_set_system</CODE> character set by default.  When you say
<CODE>SELECT column1 FROM t</CODE>, the name <CODE>column1</CODE> itself will be
returned from the server to the client in the character set as determined
by the <CODE>SET NAMES</CODE> statement. More specifically, the character
set used is determined by the value of the <CODE>character_set_results</CODE>
system variable. If this variable is set to <CODE>NULL</CODE>, no conversion is
performed and the server returns metadata using its original character set
(the set indicated by <CODE>character_set_system</CODE>).

</P>
<P>
If you want the server to pass metadata results back in a
non-UTF8 character set, then use <CODE>SET NAMES</CODE> to force the
server to perform character set conversion (see section <A HREF="manual.html#Charset-connection">11.3.6  Connection Character Sets and Collations</A>),
or else set the client to do the conversion. It is
always more efficient to set the client to do the conversion, but
this option will not be available for many clients until late in
the MySQL 4.x product cycle.

</P>
<P>
If you are just using, for example, the <CODE>USER()</CODE> function for
comparison or assignment within a single statement, don't worry.
MySQL will do some automatic conversion for you.

</P>

<PRE>
SELECT * FROM Table1 WHERE USER() = latin1_column;
</PRE>

<P>
This will work because the contents of <CODE>latin1_column</CODE> are
automatically converted to UTF8 before the comparison.

</P>

<PRE>
INSERT INTO Table1 (latin1_column) SELECT USER();
</PRE>

<P>
This will work because the contents of <CODE>USER()</CODE> are automatically
converted to <CODE>latin1</CODE> before the assignment.
Automatic conversion is not fully implemented yet, but should work
correctly in a later version.

</P>

<P>
Although automatic conversion is not in the SQL standard, the
SQL standard document does say that every character set is (in
terms of supported characters) a ``subset'' of Unicode. Since it is a
well-known principle that ``what applies to a superset can apply to
a subset,'' we believe that a collation for Unicode can apply for
comparisons with non-Unicode strings.

</P>



<H2><A NAME="Charset-compatibility" HREF="manual_toc.html#Charset-compatibility">11.7  Compatibility with Other DBMSs</A></H2>

<P>
For SAP DB compatibility these two statements are the same:

<PRE>
CREATE TABLE t1 (f1 CHAR(n) UNICODE);
CREATE TABLE t1 (f1 CHAR(n) CHARACTER SET ucs2);
</PRE>



<H2><A NAME="Charset-config-file" HREF="manual_toc.html#Charset-config-file">11.8  New Character Set Configuration File Format</A></H2>

<P>
In MySQL 4.1, character set configuration is stored in XML
files, one file per character set. In previous versions, this information
was stored in <TT>`.conf'</TT> files.

</P>


<H2><A NAME="Charset-national" HREF="manual_toc.html#Charset-national">11.9  National Character Set</A></H2>

<P>
Before MySQL 4.1, <CODE>NCHAR</CODE> and <CODE>CHAR</CODE> were synonymous. ANSI
defines <CODE>NCHAR</CODE> or <CODE>NATIONAL CHAR</CODE> as a way to define that a
<CODE>CHAR</CODE>
column should use some predefined character set. MySQL 4.1 and up uses <CODE>utf8</CODE> as
that predefined character set. For example, these column type declarations
are equivalent:

</P>

<PRE>
CHAR(10) CHARACTER SET utf8
NATIONAL CHARACTER(10)
NCHAR(10)
</PRE>

<P>
As are these:

</P>

<PRE>
VARCHAR(10) CHARACTER SET utf8
NATIONAL VARCHAR(10)
NCHAR VARCHAR(10)
NATIONAL CHARACTER VARYING(10)
NATIONAL CHAR VARYING(10)
</PRE>

<P>
You can use <CODE>N'literal'</CODE> to create a string in
the national character set.
These two statements are equivalent:

</P>

<PRE>
SELECT N'some text';
SELECT _utf8'some text';
</PRE>



<H2><A NAME="Charset-upgrading" HREF="manual_toc.html#Charset-upgrading">11.10  Upgrading Character Sets from MySQL 4.0</A></H2>

<P>
Now, what about upgrading from older versions of MySQL? MySQL 4.1
is almost upward compatible with MySQL 4.0 and earlier for the
simple reason that almost all the features are new, so there's
nothing in earlier versions to conflict with. However, there are
some differences and a few things to be aware of.

</P>
<P>
Most important: The ``MySQL 4.0 character set'' has the properties
of both ``MySQL 4.1 character sets'' and ``MySQL 4.1 collations.'' You
will have to unlearn this. Henceforth, we will not bundle character
set/collation properties in the same conglomerate object.

</P>
<P>
There is a special treatment of national character sets in MySQL
4.1. <CODE>NCHAR</CODE> is not the same as <CODE>CHAR</CODE>, and <CODE>N'...'</CODE> literals
are not the same as <CODE>'...'</CODE> literals.

</P>
<P>
Finally, there is a different file format for storing information
about character sets and collations. Make sure that you have reinstalled the
<TT>`/share/mysql/charsets/'</TT> directory containing the new configuration files.

</P>
<P>
If you want to start <CODE>mysqld</CODE> from a 4.1.x distribution with data
created by MySQL 4.0, you should start the server with the same
character set and collation. In this case, you won't need to reindex
your data.

</P>
<P>
There are two ways to do so:

</P>

<PRE>
shell&#62; ./configure --with-charset=... --with-collation=...
shell&#62; ./mysqld --default-character-set=... --default-collation=...
</PRE>

<P>
If you used <CODE>mysqld</CODE> with, for example, the MySQL 4.0 <CODE>danish</CODE>
character set, you should now use the <CODE>latin1</CODE> character set and
the <CODE>latin1_danish_ci</CODE> collation:

</P>

<PRE>
shell&#62; ./configure --with-charset=latin1 \
           --with-collation=latin1_danish_ci
shell&#62; ./mysqld --default-character-set=latin1 \
           --default-collation=latin1_danish_ci
</PRE>

<P>
Use the table shown in section <A HREF="manual.html#Charset-map">11.10.1  4.0 Character Sets and Corresponding 4.1 Character Set/Collation Pairs</A> to find old 4.0 character set
names and their 4.1 character set/collation pair equivalents.

</P>
<P>
If you have non-<CODE>latin1</CODE> data stored in a 4.0 <CODE>latin1</CODE> table
and want to convert the table column definitions to reflect the actual
character set of the data, use the instructions in section <A HREF="manual.html#Charset-conversion">11.10.2  Converting 4.0 Character Columns to 4.1 Format</A>.

</P>



<H3><A NAME="Charset-map" HREF="manual_toc.html#Charset-map">11.10.1  4.0 Character Sets and Corresponding 4.1 Character Set/Collation Pairs</A></H3>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>ID</STRONG> </TD><TD> <STRONG>4.0 Character Set</STRONG> </TD><TD> <STRONG>4.1 Character Set</STRONG> </TD><TD> <STRONG>4.1 Collation</STRONG>
</TD></TR>
<TR><TD>1 </TD><TD> <CODE>big5</CODE> </TD><TD> <CODE>big5</CODE> </TD><TD> <CODE>big5_chinese_ci</CODE>
</TD></TR>
<TR><TD>2 </TD><TD> <CODE>czech</CODE> </TD><TD> <CODE>latin2</CODE> </TD><TD> <CODE>latin2_czech_ci</CODE>
</TD></TR>
<TR><TD>3 </TD><TD> <CODE>dec8</CODE> </TD><TD> <CODE>dec8</CODE> </TD><TD> <CODE>dec8_swedish_ci</CODE>
</TD></TR>
<TR><TD>4 </TD><TD> <CODE>dos</CODE> </TD><TD> <CODE>cp850</CODE> </TD><TD> <CODE>cp850_general_ci</CODE>
</TD></TR>
<TR><TD>5 </TD><TD> <CODE>german1</CODE> </TD><TD> <CODE>latin1</CODE> </TD><TD> <CODE>latin1_german1_ci</CODE>
</TD></TR>
<TR><TD>6 </TD><TD> <CODE>hp8</CODE> </TD><TD> <CODE>hp8</CODE> </TD><TD> <CODE>hp8_english_ci</CODE>
</TD></TR>
<TR><TD>7 </TD><TD> <CODE>koi8_ru</CODE> </TD><TD> <CODE>koi8r</CODE> </TD><TD> <CODE>koi8r_general_ci</CODE>
</TD></TR>
<TR><TD>8 </TD><TD> <CODE>latin1</CODE> </TD><TD> <CODE>latin1</CODE> </TD><TD> <CODE>latin1_swedish_ci</CODE>
</TD></TR>
<TR><TD>9 </TD><TD> <CODE>latin2</CODE> </TD><TD> <CODE>latin2</CODE> </TD><TD> <CODE>latin2_general_ci</CODE>
</TD></TR>
<TR><TD>10 </TD><TD> <CODE>swe7</CODE> </TD><TD> <CODE>swe7</CODE> </TD><TD> <CODE>swe7_swedish_ci</CODE>
</TD></TR>
<TR><TD>11 </TD><TD> <CODE>usa7</CODE> </TD><TD> <CODE>ascii</CODE> </TD><TD> <CODE>ascii_general_ci</CODE>
</TD></TR>
<TR><TD>12 </TD><TD> <CODE>ujis</CODE> </TD><TD> <CODE>ujis</CODE> </TD><TD> <CODE>ujis_japanese_ci</CODE>
</TD></TR>
<TR><TD>13 </TD><TD> <CODE>sjis</CODE> </TD><TD> <CODE>sjis</CODE> </TD><TD> <CODE>sjis_japanese_ci</CODE>
</TD></TR>
<TR><TD>14 </TD><TD> <CODE>cp1251</CODE> </TD><TD> <CODE>cp1251</CODE> </TD><TD> <CODE>cp1251_bulgarian_ci</CODE>
</TD></TR>
<TR><TD>15 </TD><TD> <CODE>danish</CODE> </TD><TD> <CODE>latin1</CODE> </TD><TD> <CODE>latin1_danish_ci</CODE>
</TD></TR>
<TR><TD>16 </TD><TD> <CODE>hebrew</CODE> </TD><TD> <CODE>hebrew</CODE> </TD><TD> <CODE>hebrew_general_ci</CODE>
</TD></TR>
<TR><TD>17 </TD><TD> <CODE>win1251</CODE> </TD><TD> <CODE>(removed)</CODE> </TD><TD> <CODE>(removed)</CODE>
</TD></TR>
<TR><TD>18 </TD><TD> <CODE>tis620</CODE> </TD><TD> <CODE>tis620</CODE> </TD><TD> <CODE>tis620_thai_ci</CODE>
</TD></TR>
<TR><TD>19 </TD><TD> <CODE>euc_kr</CODE> </TD><TD> <CODE>euckr</CODE> </TD><TD> <CODE>euckr_korean_ci</CODE>
</TD></TR>
<TR><TD>20 </TD><TD> <CODE>estonia</CODE> </TD><TD> <CODE>latin7</CODE> </TD><TD> <CODE>latin7_estonian_ci</CODE>
</TD></TR>
<TR><TD>21 </TD><TD> <CODE>hungarian</CODE> </TD><TD> <CODE>latin2</CODE> </TD><TD> <CODE>latin2_hungarian_ci</CODE>
</TD></TR>
<TR><TD>22 </TD><TD> <CODE>koi8_ukr</CODE> </TD><TD> <CODE>koi8u</CODE> </TD><TD> <CODE>koi8u_ukrainian_ci</CODE>
</TD></TR>
<TR><TD>23 </TD><TD> <CODE>win1251ukr</CODE> </TD><TD> <CODE>cp1251</CODE> </TD><TD> <CODE>cp1251_ukrainian_ci</CODE>
</TD></TR>
<TR><TD>24 </TD><TD> <CODE>gb2312</CODE> </TD><TD> <CODE>gb2312</CODE> </TD><TD> <CODE>gb2312_chinese_ci</CODE>
</TD></TR>
<TR><TD>25 </TD><TD> <CODE>greek</CODE> </TD><TD> <CODE>greek</CODE> </TD><TD> <CODE>greek_general_ci</CODE>
</TD></TR>
<TR><TD>26 </TD><TD> <CODE>win1250</CODE> </TD><TD> <CODE>cp1250</CODE> </TD><TD> <CODE>cp1250_general_ci</CODE>
</TD></TR>
<TR><TD>27 </TD><TD> <CODE>croat</CODE> </TD><TD> <CODE>latin2</CODE> </TD><TD> <CODE>latin2_croatian_ci</CODE>
</TD></TR>
<TR><TD>28 </TD><TD> <CODE>gbk</CODE> </TD><TD> <CODE>gbk</CODE> </TD><TD> <CODE>gbk_chinese_ci</CODE>
</TD></TR>
<TR><TD>29 </TD><TD> <CODE>cp1257</CODE> </TD><TD> <CODE>cp1257</CODE> </TD><TD> <CODE>cp1257_lithuanian_ci</CODE>
</TD></TR>
<TR><TD>30 </TD><TD> <CODE>latin5</CODE> </TD><TD> <CODE>latin5</CODE> </TD><TD> <CODE>latin5_turkish_ci</CODE>
</TD></TR>
<TR><TD>31 </TD><TD> <CODE>latin1_de</CODE> </TD><TD> <CODE>latin1</CODE> </TD><TD> <CODE>latin1_german2_ci</CODE>
</TD></TR>
</TABLE>



<H3><A NAME="Charset-conversion" HREF="manual_toc.html#Charset-conversion">11.10.2  Converting 4.0 Character Columns to 4.1 Format</A></H3>

<P>
Normally, the server runs using the <CODE>latin1</CODE> character set by default.
If you have been storing column data that actually is in some other
character set that the 4.1 server now supports directly, you can convert the
column.  However, you should avoid trying to convert directly from
<CODE>latin1</CODE> to the "real" character set. This may result in data loss.
Instead, convert the column to a binary column type, and then from the
binary type to a non-binary type with the desired character set.  Conversion
to and from binary involves no attempt at character value conversion and
preserves your data intact.  For example, suppose that you have a 4.0 table with
three columns that are used to store values represented in <CODE>latin1</CODE>,
<CODE>latin2</CODE>, and <CODE>utf8</CODE>:

</P>

<PRE>
CREATE TABLE t
(
    latin1_col CHAR(50),
    latin2_col CHAR(100),
    utf8_col CHAR(150)
);
</PRE>

<P>
After upgrading to MySQL 4.1, you want to convert this table to leave
<CODE>latin1_col</CODE> alone but change the <CODE>latin2_col</CODE> and <CODE>utf8_col</CODE>
columns to have character sets of <CODE>latin2</CODE> and <CODE>utf8</CODE>.  First,
back up your table, then convert the columns as follows:

</P>

<PRE>
ALTER TABLE t MODIFY latin2_col BINARY(100);
ALTER TABLE t MODIFY utf8_col BINARY(150);
ALTER TABLE t MODIFY latin2_col CHAR(100) CHARACTER SET latin2;
ALTER TABLE t MODIFY utf8_col CHAR(150) CHARACTER SET utf8;
</PRE>

<P>
The first two statements ``remove'' the character set information from the
<CODE>latin2_col</CODE> and <CODE>utf8_col</CODE> columns.  The second two statements
assign the proper character sets to the two columns.

</P>
<P>
If you like, you can combine the to-binary conversions and from-binary
conversions into single statements:

</P>

<PRE>
ALTER TABLE t
    MODIFY latin2_col BINARY(100),
    MODIFY utf8_col BINARY(150);
ALTER TABLE t
    MODIFY latin2_col CHAR(100) CHARACTER SET latin2,
    MODIFY utf8_col CHAR(150) CHARACTER SET utf8;
</PRE>



<H2><A NAME="Charset-charsets" HREF="manual_toc.html#Charset-charsets">11.11  Character Sets and Collations That MySQL Supports</A></H2>

<P>
Here is an annotated list of character sets and collations that
MySQL supports. Because options and installation settings differ,
some sites might not have all items listed, and some sites might
have items not listed.

</P>
<P>
MySQL supports 70+ collations for 30+ character sets. The character sets and
their default collations are displayed by the
<CODE>SHOW CHARACTER SET STATEMENT</CODE>.
(The output actually includes another column that is not shown so that the
example fits better on the page.)

</P>


<PRE>
mysql&#62; SHOW CHARACTER SET;
+----------+-----------------------------+---------------------+
| Charset  | Description                 | Default collation   |
+----------+-----------------------------+---------------------+
| big5     | Big5 Traditional Chinese    | big5_chinese_ci     |
| dec8     | DEC West European           | dec8_swedish_ci     |
| cp850    | DOS West European           | cp850_general_ci    |
| hp8      | HP West European            | hp8_english_ci      |
| koi8r    | KOI8-R Relcom Russian       | koi8r_general_ci    |
| latin1   | ISO 8859-1 West European    | latin1_swedish_ci   |
| latin2   | ISO 8859-2 Central European | latin2_general_ci   |
| swe7     | 7bit Swedish                | swe7_swedish_ci     |
| ascii    | US ASCII                    | ascii_general_ci    |
| ujis     | EUC-JP Japanese             | ujis_japanese_ci    |
| sjis     | Shift-JIS Japanese          | sjis_japanese_ci    |
| cp1251   | Windows Cyrillic            | cp1251_bulgarian_ci |
| hebrew   | ISO 8859-8 Hebrew           | hebrew_general_ci   |
| tis620   | TIS620 Thai                 | tis620_thai_ci      |
| euckr    | EUC-KR Korean               | euckr_korean_ci     |
| koi8u    | KOI8-U Ukrainian            | koi8u_general_ci    |
| gb2312   | GB2312 Simplified Chinese   | gb2312_chinese_ci   |
| greek    | ISO 8859-7 Greek            | greek_general_ci    |
| cp1250   | Windows Central European    | cp1250_general_ci   |
| gbk      | GBK Simplified Chinese      | gbk_chinese_ci      |
| latin5   | ISO 8859-9 Turkish          | latin5_turkish_ci   |
| armscii8 | ARMSCII-8 Armenian          | armscii8_general_ci |
| utf8     | UTF-8 Unicode               | utf8_general_ci     |
| ucs2     | UCS-2 Unicode               | ucs2_general_ci     |
| cp866    | DOS Russian                 | cp866_general_ci    |
| keybcs2  | DOS Kamenicky Czech-Slovak  | keybcs2_general_ci  |
| macce    | Mac Central European        | macce_general_ci    |
| macroman | Mac West European           | macroman_general_ci |
| cp852    | DOS Central European        | cp852_general_ci    |
| latin7   | ISO 8859-13 Baltic          | latin7_general_ci   |
| cp1256   | Windows Arabic              | cp1256_general_ci   |
| cp1257   | Windows Baltic              | cp1257_general_ci   |
| binary   | Binary pseudo charset       | binary              |
| geostd8  | GEOSTD8 Georgian            | geostd8_general_ci  |
+----------+-----------------------------+---------------------+
</PRE>



<H3><A NAME="Charset-Unicode-sets" HREF="manual_toc.html#Charset-Unicode-sets">11.11.1  Unicode Character Sets</A></H3>

<P>
MySQL has two Unicode character sets. You can store
texts in about 650 languages using these character sets. We have
not added a large number of collations for these two new sets yet,
but that will be happening soon. Currently, they have default
case-insensitive accent-insensitive collations, plus the binary
collation.

</P>
<P>
Currently, the <CODE>ucs2_general_uca</CODE> collation has only partial support
for the Unicode Collation Algorithm. Some characters are not supported yet.

</P>

<UL>
<LI><CODE>ucs2</CODE> (UCS-2 Unicode) collations:


<UL>
<LI><CODE>ucs2_bin</CODE>

<LI><CODE>ucs2_general_ci</CODE> (default)

<LI><CODE>ucs2_general_uca</CODE>

</UL>

<LI><CODE>utf8</CODE> (UTF-8 Unicode) collations:


<UL>
<LI><CODE>utf8_bin</CODE>

<LI><CODE>utf8_general_ci</CODE> (default)

</UL>

</UL>



<H3><A NAME="Charset-we-sets" HREF="manual_toc.html#Charset-we-sets">11.11.2  West European Character Sets</A></H3>

<P>
West European Character Sets cover most West European languages,
such as French, Spanish, Catalan, Basque, Portuguese, Italian,
Albanian, Dutch, German, Danish, Swedish, Norwegian, Finnish,
Faroese, Icelandic, Irish, Scottish, and English.

</P>

<UL>

<LI><CODE>ascii</CODE> (US ASCII) collations:


<UL>
<LI><CODE>ascii_bin</CODE>

<LI><CODE>ascii_general_ci</CODE> (default)

</UL>

<LI><CODE>cp850</CODE> (DOS West European) collations:


<UL>
<LI><CODE>cp850_bin</CODE>

<LI><CODE>cp850_general_ci</CODE> (default)

</UL>

<LI><CODE>dec8</CODE> (DEC West European) collations:


<UL>
<LI><CODE>dec8_bin</CODE>

<LI><CODE>dec8_swedish_ci</CODE> (default)

</UL>

<LI><CODE>hp8</CODE> (HP West European) collations:


<UL>
<LI><CODE>hp8_bin</CODE>

<LI><CODE>hp8_english_ci</CODE> (default)

</UL>

<LI><CODE>latin1</CODE> (ISO 8859-1 West European) collations:


<UL>
<LI><CODE>latin1_bin</CODE>

<LI><CODE>latin1_danish_ci</CODE>

<LI><CODE>latin1_general_ci</CODE>

<LI><CODE>latin1_general_cs</CODE>

<LI><CODE>latin1_german1_ci</CODE>

<LI><CODE>latin1_german2_ci</CODE>

<LI><CODE>latin1_spanish_ci</CODE>

<LI><CODE>latin1_swedish_ci</CODE> (default)

</UL>

The <CODE>latin1</CODE> is the default character set.
The <CODE>latin1_swedish_ci</CODE> collation is the default that probably is
used by the majority of MySQL customers. It is constantly stated
that this is based on the Swedish/Finnish collation rules, but you
will find Swedes and Finns who disagree with that statement.

The <CODE>latin1_german1_ci</CODE> and <CODE>latin1_german2_ci</CODE>
collations are based on the DIN-1 and DIN-2 standards,
where DIN stands for Deutsches Institut f@"ur Normung (that is,
the German answer to ANSI).
DIN-1 is called the dictionary collation and DIN-2 is called the
phone-book collation.


<UL>

<LI><CODE>latin1_german1_ci</CODE> (dictionary) rules:


<PRE>
<SAMP>`@"A'</SAMP> = <SAMP>`A'</SAMP>, <SAMP>`@"O'</SAMP> = <SAMP>`O'</SAMP>, <SAMP>`@"U'</SAMP> = <SAMP>`U'</SAMP>, <SAMP>`@ss{'</SAMP>} = <SAMP>`s'</SAMP>
</PRE>

<LI><CODE>latin1_german2_ci</CODE> (phone-book) rules:


<PRE>
<SAMP>`@"A'</SAMP> = <SAMP>`AE'</SAMP>, <SAMP>`@"O'</SAMP> = <SAMP>`OE'</SAMP>, <SAMP>`@"U'</SAMP> = <SAMP>`UE'</SAMP>, <SAMP>`@ss{'</SAMP>} = <SAMP>`ss'</SAMP>
</PRE>

</UL>

In the <CODE>latin1_spanish_ci</CODE> collation, <SAMP>`@~N'</SAMP> (N-tilde) is a
separate letter between <SAMP>`N'</SAMP> and <SAMP>`O'</SAMP>.

<LI><CODE>macroman</CODE> (Mac West European) collations:


<UL>
<LI><CODE>macroman_bin</CODE>

<LI><CODE>macroman_general_ci</CODE> (default)

</UL>

<LI><CODE>swe7</CODE> (7bit Swedish) collations:


<UL>
<LI><CODE>swe7_bin</CODE>

<LI><CODE>swe7_swedish_ci</CODE> (default)

</UL>

</UL>



<H3><A NAME="Charset-ce-sets" HREF="manual_toc.html#Charset-ce-sets">11.11.3  Central European Character Sets</A></H3>

<P>
We have some support for character sets used in the Czech Republic,
Slovakia, Hungary, Romania, Slovenia, Croatia, and Poland.

</P>

<UL>

<LI><CODE>cp1250</CODE> (Windows Central European) collations:


<UL>
<LI><CODE>cp1250_bin</CODE>

<LI><CODE>cp1250_czech_ci</CODE>

<LI><CODE>cp1250_general_ci</CODE> (default)

</UL>

<LI><CODE>cp852</CODE> (DOS Central European) collations:


<UL>
<LI><CODE>cp852_bin</CODE>

<LI><CODE>cp852_general_ci</CODE> (default)

</UL>

<LI><CODE>keybcs2</CODE> (DOS Kamenicky Czech-Slovak) collations:


<UL>
<LI><CODE>keybcs2_bin</CODE>

<LI><CODE>keybcs2_general_ci</CODE> (default)

</UL>

<LI><CODE>latin2</CODE> (ISO 8859-2 Central European) collations:


<UL>
<LI><CODE>latin2_bin</CODE>

<LI><CODE>latin2_croatian_ci</CODE>

<LI><CODE>latin2_czech_ci</CODE>

<LI><CODE>latin2_general_ci</CODE> (default)

<LI><CODE>latin2_hungarian_ci</CODE>

</UL>

<LI><CODE>macce</CODE> (Mac Central European) collations:


<UL>
<LI><CODE>macce_bin</CODE>

<LI><CODE>macce_general_ci</CODE> (default)

</UL>

</UL>



<H3><A NAME="Charset-se-me-sets" HREF="manual_toc.html#Charset-se-me-sets">11.11.4  South European and Middle East Character Sets</A></H3>


<UL>

<LI><CODE>armscii8</CODE> (ARMSCII-8 Armenian) collations:


<UL>
<LI><CODE>armscii8_bin</CODE>

<LI><CODE>armscii8_general_ci</CODE> (default)

</UL>

<LI><CODE>cp1256</CODE> (Windows Arabic) collations:


<UL>
<LI><CODE>cp1256_bin</CODE>

<LI><CODE>cp1256_general_ci</CODE> (default)

</UL>

<LI><CODE>geostd8</CODE> (GEOSTD8 Georgian) collations:


<UL>
<LI><CODE>geostd8_bin</CODE>

<LI><CODE>geostd8_general_ci</CODE> (default)

</UL>

<LI><CODE>greek</CODE> (ISO 8859-7 Greek) collations:


<UL>
<LI><CODE>greek_bin</CODE>

<LI><CODE>greek_general_ci</CODE> (default)

</UL>

<LI><CODE>hebrew</CODE> (ISO 8859-8 Hebrew) collations:


<UL>
<LI><CODE>hebrew_bin</CODE>

<LI><CODE>hebrew_general_ci</CODE> (default)

</UL>

<LI><CODE>latin5</CODE> (ISO 8859-9 Turkish) collations:


<UL>
<LI><CODE>latin5_bin</CODE>

<LI><CODE>latin5_turkish_ci</CODE> (default)

</UL>

</UL>



<H3><A NAME="Charset-baltic-sets" HREF="manual_toc.html#Charset-baltic-sets">11.11.5  Baltic Character Sets</A></H3>

<P>
The Baltic character sets cover Estonian, Latvian, and Lithuanian
languages. There are two Baltic character sets currently supported:

</P>

<UL>

<LI><CODE>cp1257</CODE> (Windows Baltic) collations:


<UL>
<LI><CODE>cp1257_bin</CODE>

<LI><CODE>cp1257_general_ci</CODE> (default)

<LI><CODE>cp1257_lithuanian_ci</CODE>

</UL>

<LI><CODE>latin7</CODE> (ISO 8859-13 Baltic) collations:


<UL>
<LI><CODE>latin7_bin</CODE>

<LI><CODE>latin7_estonian_cs</CODE>

<LI><CODE>latin7_general_ci</CODE> (default)

<LI><CODE>latin7_general_cs</CODE>

</UL>

</UL>



<H3><A NAME="Charset-cyrillic-sets" HREF="manual_toc.html#Charset-cyrillic-sets">11.11.6  Cyrillic Character Sets</A></H3>

<P>
Here are the Cyrillic character sets and collations for use with
Belarusian, Bulgarian, Russian, and Ukrainian languages.

</P>


<UL>

<LI><CODE>cp1251</CODE> (Windows Cyrillic) collations:


<UL>
<LI><CODE>cp1251_bin</CODE>

<LI><CODE>cp1251_bulgarian_ci</CODE>

<LI><CODE>cp1251_general_ci</CODE> (default)

<LI><CODE>cp1251_general_cs</CODE>

<LI><CODE>cp1251_ukrainian_ci</CODE>

</UL>

<LI><CODE>cp866</CODE> (DOS Russian) collations:


<UL>
<LI><CODE>cp866_bin</CODE>

<LI><CODE>cp866_general_ci</CODE> (default)

</UL>

<LI><CODE>koi8r</CODE> (KOI8-R Relcom Russian) collations:


<UL>
<LI><CODE>koi8r_bin</CODE>

<LI><CODE>koi8r_general_ci</CODE> (default)

</UL>

<LI><CODE>koi8u</CODE> (KOI8-U Ukrainian) collations:


<UL>
<LI><CODE>koi8u_bin</CODE>

<LI><CODE>koi8u_general_ci</CODE> (default)

</UL>

</UL>



<H3><A NAME="Charset-asian-sets" HREF="manual_toc.html#Charset-asian-sets">11.11.7  Asian Character Sets</A></H3>

<P>
The Asian character sets that we support include Chinese, Japanese,
Korean, and Thai. These can be complicated. For example, the Chinese
sets must allow for thousands of different characters.

</P>

<UL>

<LI><CODE>big5</CODE> (Big5 Traditional Chinese) collations:


<UL>
<LI><CODE>big5_bin</CODE>

<LI><CODE>big5_chinese_ci</CODE> (default)

</UL>

<LI><CODE>euckr</CODE> (EUC-KR Korean) collations:


<UL>
<LI><CODE>euckr_bin</CODE>

<LI><CODE>euckr_korean_ci</CODE> (default)

</UL>

<LI><CODE>gb2312</CODE> (GB2312 Simplified Chinese) collations:


<UL>
<LI><CODE>gb2312_bin</CODE>

<LI><CODE>gb2312_chinese_ci</CODE> (default)

</UL>

<LI><CODE>gbk</CODE> (GBK Simplified Chinese) collations:


<UL>
<LI><CODE>gbk_bin</CODE>

<LI><CODE>gbk_chinese_ci</CODE> (default)

</UL>

<LI><CODE>sjis</CODE> (Shift-JIS Japanese) collations:


<UL>
<LI><CODE>sjis_bin</CODE>

<LI><CODE>sjis_japanese_ci</CODE> (default)

</UL>

<LI><CODE>tis620</CODE> (TIS620 Thai) collations:


<UL>
<LI><CODE>tis620_bin</CODE>

<LI><CODE>tis620_thai_ci</CODE> (default)

</UL>

<LI><CODE>ujis</CODE> (EUC-JP Japanese) collations:


<UL>
<LI><CODE>ujis_bin</CODE>

<LI><CODE>ujis_japanese_ci</CODE> (default)

</UL>

</UL>



<H1><A NAME="Column_types" HREF="manual_toc.html#Column_types">12  Column Types</A></H1>

<P>
MySQL supports a number of column types in several categories: numeric
types, date and time types, and string (character) types.  This chapter
first gives an overview of these column types, and then provides a more
detailed description of the properties of the types in each category, and a
summary of the column type storage requirements.  The overview is
intentionally brief.  The more detailed descriptions should be consulted for
additional information about particular column types, such as the allowable
formats in which you can specify values.

</P>
<P>
MySQL 4.1 and up supports extensions for handing spatial
data.  Information about spatial types is provided in
section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.

</P>
<P>
<A NAME="IDX1090"></A>
<A NAME="IDX1091"></A>
<A NAME="IDX1092"></A>
<A NAME="IDX1093"></A>

</P>
<P>
Several of the column type descriptions use these conventions:

</P>
<DL COMPACT>

<DT><CODE>M</CODE>
<DD>
<A NAME="IDX1094"></A>
<A NAME="IDX1095"></A>
Indicates the maximum display size.  The maximum legal display size is 255.

<DT><CODE>D</CODE>
<DD>
<A NAME="IDX1096"></A>
<A NAME="IDX1097"></A>
Applies to floating-point and fixed-point types and indicates the number of
digits following the decimal point.  The maximum possible value is 30, but
should be no greater than <CODE>M</CODE>-2.

<DT><CODE></CODE>
<DD>
<A NAME="IDX1098"></A>
<A NAME="IDX1099"></A>
Square brackets (<SAMP>`['</SAMP> and <SAMP>`]'</SAMP>) indicate parts of type specifiers
that are optional.

</DL>

<P>
<A NAME="IDX1100"></A>

</P>


<H2><A NAME="Column_type_overview" HREF="manual_toc.html#Column_type_overview">12.1  Column Type Overview</A></H2>



<H3><A NAME="Numeric_type_overview" HREF="manual_toc.html#Numeric_type_overview">12.1.1  Overview of Numeric Types</A></H3>

<P>
A summary of the numeric column types follows. For additional information, see
section <A HREF="manual.html#Numeric_types">12.2  Numeric Types</A>.
Column storage requirements are given in section <A HREF="manual.html#Storage_requirements">12.5  Column Type Storage Requirements</A>.

</P>
<P>
If you specify <CODE>ZEROFILL</CODE> for a numeric column, MySQL
automatically adds the <CODE>UNSIGNED</CODE> attribute to the column.

</P>
<P>
<STRONG>Warning:</STRONG> You should be aware that when you use subtraction
between integer values where one is of type <CODE>UNSIGNED</CODE>, the result
will be unsigned! See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.

</P>
<DL COMPACT>

<DT><CODE>TINYINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<A NAME="IDX1101"></A>
 

A very small integer. The signed range is <CODE>-128</CODE> to <CODE>127</CODE>. The
unsigned range is <CODE>0</CODE> to <CODE>255</CODE>.

<A NAME="IDX1102"></A>
<A NAME="IDX1103"></A>
<A NAME="IDX1104"></A>
<DT><CODE>BIT</CODE>
<DD>
<DT><CODE>BOOL</CODE>
<DD>
<DT><CODE>BOOLEAN</CODE>
<DD>
These are synonyms for <CODE>TINYINT(1)</CODE>.
The <CODE>BOOLEAN</CODE> synonym was added in MySQL 4.1.0.
A value of zero is considered false. Non-zero values are considered true.

In the future,
full boolean type handling will be introduced in accordance with standard SQL.

<A NAME="IDX1105"></A>
<DT><CODE>SMALLINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A small integer. The signed range is <CODE>-32768</CODE> to <CODE>32767</CODE>. The
unsigned range is <CODE>0</CODE> to <CODE>65535</CODE>.

<A NAME="IDX1106"></A>
<DT><CODE>MEDIUMINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A medium-size integer. The signed range is <CODE>-8388608</CODE> to
<CODE>8388607</CODE>. The unsigned range is <CODE>0</CODE> to <CODE>16777215</CODE>.

<A NAME="IDX1107"></A>
<DT><CODE>INT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A normal-size integer. The signed range is <CODE>-2147483648</CODE> to
<CODE>2147483647</CODE>.  The unsigned range is <CODE>0</CODE> to <CODE>4294967295</CODE>.

<A NAME="IDX1108"></A>
<DT><CODE>INTEGER[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
This is a synonym for <CODE>INT</CODE>.

<A NAME="IDX1109"></A>
<DT><CODE>BIGINT[(M)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A large integer. The signed range is <CODE>-9223372036854775808</CODE> to
<CODE>9223372036854775807</CODE>. The unsigned range is <CODE>0</CODE> to
<CODE>18446744073709551615</CODE>.
Some things you should be aware of with respect to <CODE>BIGINT</CODE> columns:


<UL>
<LI>

<A NAME="IDX1110"></A>
All arithmetic is done using signed <CODE>BIGINT</CODE> or <CODE>DOUBLE</CODE>
values, so you shouldn't use unsigned big integers larger than
<CODE>9223372036854775807</CODE> (63 bits) except with bit functions! If you
do that, some of the last digits in the result may be wrong because of
rounding errors when converting a <CODE>BIGINT</CODE> value to a <CODE>DOUBLE</CODE>.

MySQL 4.0 can handle <CODE>BIGINT</CODE> in the following cases:


<UL>
<LI>

When using integers to store big unsigned values in a <CODE>BIGINT</CODE> column.
<LI>

In <CODE>MIN(col_name)</CODE> or <CODE>MAX(col_name)</CODE>, where <CODE>col_name</CODE> refers
to a <CODE>BIGINT</CODE> column.
<LI>

When using operators (<CODE>+</CODE>, <CODE>-</CODE>, <CODE>*</CODE>, and so on) where
both operands are integers.
</UL>

<LI>

You can always store an exact integer value in a <CODE>BIGINT</CODE> column by
storing it using a string.  In this case, MySQL performs a string-to-number
conversion that involves no intermediate double-precision representation.
<LI>

The <CODE>-</CODE>, <CODE>+</CODE>, and <CODE>*</CODE> operators will use <CODE>BIGINT</CODE>
arithmetic when both operands are integer values!  This means that if
you multiply two big integers (or results from functions that return
integers), you may get unexpected results when the result is larger than
<CODE>9223372036854775807</CODE>.
</UL>

<DT><CODE>FLOAT(p) [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<A NAME="IDX1111"></A>
<A NAME="IDX1112"></A>
<A NAME="IDX1113"></A>

A floating-point number.  <CODE>p</CODE> represents the precision. It can be from
0 to 24 for a single-precision floating-point number and from 25 to 53 for a
double-precision floating-point number. These types are like the <CODE>FLOAT</CODE>
and <CODE>DOUBLE</CODE> types described immediately following.  <CODE>FLOAT(p)</CODE>
has the same range as the corresponding <CODE>FLOAT</CODE> and <CODE>DOUBLE</CODE>
types, but the display size and number of decimals are undefined.

As of MySQL 3.23, this is a true floating-point value.  In
earlier MySQL versions, <CODE>FLOAT(p)</CODE> always has two decimals.

<A NAME="IDX1114"></A>
<A NAME="IDX1115"></A>
This syntax is provided for ODBC compatibility.

Using <CODE>FLOAT</CODE> might give you some unexpected problems because
all calculations in MySQL are done with double precision.
See section <A HREF="manual.html#No_matching_rows">A.5.7  Solving Problems with No Matching Rows</A>.

<A NAME="IDX1116"></A>
<A NAME="IDX1117"></A>
<DT><CODE>FLOAT[(M,D)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A small (single-precision) floating-point number.  Allowable values are
<CODE>-3.402823466E+38</CODE> to <CODE>-1.175494351E-38</CODE>, <CODE>0</CODE>,
and <CODE>1.175494351E-38</CODE> to <CODE>3.402823466E+38</CODE>.  If
<CODE>UNSIGNED</CODE> is specified, negative values are disallowed.  <CODE>M</CODE>
is the display width and <CODE>D</CODE> is the number of decimals.  <CODE>FLOAT</CODE>
without arguments or <CODE>FLOAT(p)</CODE> (where <CODE>p</CODE> is in the range from
0 to 24) stands for a single-precision floating-point number.

<A NAME="IDX1118"></A>
<A NAME="IDX1119"></A>
<DT><CODE>DOUBLE[(M,D)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
A normal-size (double-precision) floating-point number.
Allowable values are <CODE>-1.7976931348623157E+308</CODE> to
<CODE>-2.2250738585072014E-308</CODE>, <CODE>0</CODE>, and
<CODE>2.2250738585072014E-308</CODE> to <CODE>1.7976931348623157E+308</CODE>.  If
<CODE>UNSIGNED</CODE> is specified, negative values are disallowed.
<CODE>M</CODE> is the display width and <CODE>D</CODE> is the number of decimals.
<CODE>DOUBLE</CODE> without arguments or <CODE>FLOAT(p)</CODE> (where
<CODE>p</CODE> is in the
range from 25 to 53) stands for a double-precision floating-point number.

<A NAME="IDX1120"></A>
<A NAME="IDX1121"></A>
<DT><CODE>DOUBLE PRECISION[(M,D)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<DT><CODE>REAL[(M,D)] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
These are synonyms for <CODE>DOUBLE</CODE>.
Exception: If the server SQL mode includes the <CODE>REAL_AS_FLOAT</CODE> option,
<CODE>REAL</CODE> is a synonym for <CODE>FLOAT</CODE> rather than <CODE>DOUBLE</CODE>.

<A NAME="IDX1122"></A>
<DT><CODE>DECIMAL[(M[,D])] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
An unpacked fixed-point number.  Behaves like a <CODE>CHAR</CODE> column;
``unpacked'' means the number is stored as a string, using one character for
each digit of the value.  <CODE>M</CODE> is the total number of digits and
<CODE>D</CODE> is the number of decimals.  The decimal point and (for negative
numbers) the <SAMP>`-'</SAMP> sign are not counted in <CODE>M</CODE>, although space for
them is reserved. If <CODE>D</CODE> is 0, values have no decimal point or
fractional part.  The maximum range of <CODE>DECIMAL</CODE> values is the same as
for <CODE>DOUBLE</CODE>, but the actual range for a given <CODE>DECIMAL</CODE> column
may be constrained by the choice of <CODE>M</CODE> and <CODE>D</CODE>.  If
<CODE>UNSIGNED</CODE> is specified, negative values are disallowed.

If <CODE>D</CODE> is omitted, the default is 0.  If <CODE>M</CODE> is omitted, the
default is 10.

Prior to MySQL 3.23, the <CODE>M</CODE> argument must be large enough to
include the space needed for the sign and the decimal point.

<A NAME="IDX1123"></A>
<A NAME="IDX1124"></A>
<A NAME="IDX1125"></A>
<DT><CODE>DEC[(M[,D])] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<DT><CODE>NUMERIC[(M[,D])] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
<DT><CODE>FIXED[(M[,D])] [UNSIGNED] [ZEROFILL]</CODE>
<DD>
These are synonyms for <CODE>DECIMAL</CODE>.

The <CODE>FIXED</CODE> synonym was added in MySQL 4.1.0 for compatibility
with other servers.

</DL>



<H3><A NAME="Date_and_time_type_overview" HREF="manual_toc.html#Date_and_time_type_overview">12.1.2  Overview of Date and Time Types</A></H3>

<P>
A summary of the temporal column types follows. For additional information, see
section <A HREF="manual.html#Date_and_time_types">12.3  Date and Time Types</A>.
Column storage requirements are given in section <A HREF="manual.html#Storage_requirements">12.5  Column Type Storage Requirements</A>.

</P>
<DL COMPACT>

<DT><CODE>DATE</CODE>
<DD>
<A NAME="IDX1126"></A>
 

A date.  The supported range is <CODE>'1000-01-01'</CODE> to <CODE>'9999-12-31'</CODE>.
MySQL displays <CODE>DATE</CODE> values in <CODE>'YYYY-MM-DD'</CODE> format, but
allows you to assign values to <CODE>DATE</CODE> columns using either strings or
numbers.

<A NAME="IDX1127"></A>
<DT><CODE>DATETIME</CODE>
<DD>
A date and time combination.  The supported range is <CODE>'1000-01-01
00:00:00'</CODE> to <CODE>'9999-12-31 23:59:59'</CODE>.  MySQL displays
<CODE>DATETIME</CODE> values in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> format, but allows you
to assign values to <CODE>DATETIME</CODE> columns using either strings or numbers.

<A NAME="IDX1128"></A>
<DT><CODE>TIMESTAMP[(M)]</CODE>
<DD>
A timestamp.  The range is <CODE>'1970-01-01 00:00:00'</CODE> to partway through the
year <CODE>2037</CODE>.

A <CODE>TIMESTAMP</CODE> column is useful for recording the date and time of an
<CODE>INSERT</CODE> or <CODE>UPDATE</CODE> operation. The first <CODE>TIMESTAMP</CODE> column
in a table is automatically set to the date and time of the most recent
operation if you don't assign it a value yourself.  You can also set any
<CODE>TIMESTAMP</CODE> column to the current date and time by assigning it a
<CODE>NULL</CODE> value.

From MySQL 4.1 on, <CODE>TIMESTAMP</CODE> is returned as a string with the format
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE>. If you want to obtain the value as a number,
you should add <CODE>+0</CODE> to the timestamp column. Different timestamp
display widths are not supported.

In MySQL 4.0 and earlier, <CODE>TIMESTAMP</CODE> values are displayed in
<CODE>YYYYMMDDHHMMSS</CODE>, <CODE>YYMMDDHHMMSS</CODE>, <CODE>YYYYMMDD</CODE>, or <CODE>YYMMDD</CODE>
format, depending on whether <CODE>M</CODE> is 14 (or missing), 12,
8, or 6, but allows you to assign values to <CODE>TIMESTAMP</CODE>
columns using either strings or numbers.
The <CODE>M</CODE> argument affects only how a <CODE>TIMESTAMP</CODE> column is displayed,
not storage.  Its values always are stored using four bytes each.
From MySQL 4.0.12, the <CODE>--new</CODE> option can be used
to make the server behave as in MySQL 4.1.

Note that <CODE>TIMESTAMP(M)</CODE> columns where <CODE>M</CODE> is 8 or 14 are reported to
be numbers, whereas other <CODE>TIMESTAMP(M)</CODE> columns are reported to be
strings.  This is just to ensure that you can reliably dump and restore
the table with these types.

<A NAME="IDX1129"></A>
<DT><CODE>TIME</CODE>
<DD>
A time.  The range is <CODE>'-838:59:59'</CODE> to <CODE>'838:59:59'</CODE>.
MySQL displays <CODE>TIME</CODE> values in <CODE>'HH:MM:SS'</CODE> format, but
allows you to assign values to <CODE>TIME</CODE> columns using either strings or
numbers.

<A NAME="IDX1130"></A>
<DT><CODE>YEAR[(2|4)]</CODE>
<DD>
A year in two-digit or four-digit format. The default is four-digit format.
In four-digit format, the
allowable values are <CODE>1901</CODE> to <CODE>2155</CODE>, and <CODE>0000</CODE>.
In two-digit format, the allowable values are
<CODE>70</CODE> to <CODE>69</CODE>, representing years from
1970 to 2069.  MySQL displays <CODE>YEAR</CODE> values in
<CODE>YYYY</CODE> format, but allows you to assign values to <CODE>YEAR</CODE> columns
using either strings or numbers. The <CODE>YEAR</CODE> type is unavailable prior
to MySQL 3.22.

</DL>



<H3><A NAME="String_type_overview" HREF="manual_toc.html#String_type_overview">12.1.3  Overview of String Types</A></H3>

<P>
A summary of the string column types follows.
For additional information, see section <A HREF="manual.html#String_types">12.4  String Types</A>.
Column storage requirements are given in section <A HREF="manual.html#Storage_requirements">12.5  Column Type Storage Requirements</A>.

</P>
<P>
In some cases, MySQL may change a string column to a type different from
that given in a <CODE>CREATE TABLE</CODE> or <CODE>ALTER TABLE</CODE> statement.
See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

</P>
<P>
A change that affects many string column types is that, as of MySQL 4.1,
character column definitions can include a <CODE>CHARACTER SET</CODE> attribute to
specify the character set and, optionally, a collation for the column. This
applies to <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, the <CODE>TEXT</CODE> types, <CODE>ENUM</CODE>,
and <CODE>SET</CODE>. For example:

</P>

<PRE>
CREATE TABLE t
(
    c1 CHAR(20) CHARACTER SET utf8,
    c2 CHAR(20) CHARACTER SET latin1 COLLATE latin1_bin
);
</PRE>

<P>
This table definition creates a column named <CODE>c1</CODE> that has a character
set of <CODE>utf8</CODE> with the default collation for that character set, and a
column named <CODE>c2</CODE> that has a character set of <CODE>latin1</CODE> and the
binary collation for the character set. The binary collation is not case
sensitive.

</P>
<P>
Character column sorting and comparison are are based on the character set
assigned to the column. Before MySQL 4.1, sorting and comparison are based
on the collation of the server character set. For <CODE>CHAR</CODE> and
<CODE>VARCHAR</CODE> columns, you can declare the column with the <CODE>BINARY</CODE>
attribute to cause sorting and comparison to be case-insensitive using the
underlying character code values rather then a lexical ordering.

</P>
<P>
For more details, see section <A HREF="manual.html#Charset">11  Character Set Support</A>.

</P>
<P>
Also as of 4.1, MySQL interprets length specifications in character column
definitions in characters. (Earlier versions interpret them in bytes.)

</P>
<DL COMPACT>

<DT><CODE>[NATIONAL] CHAR(M) [BINARY | ASCII | UNICODE]</CODE>
<DD>
<A NAME="IDX1131"></A>
 <A NAME="IDX1132"></A>
 <A NAME="IDX1133"></A>
 <A NAME="IDX1134"></A>
 

A fixed-length string that is always right-padded with spaces to the
specified length when stored.  <CODE>M</CODE> represents the column length.  The
range of <CODE>M</CODE> is 0 to 255 characters (1 to 255 prior to MySQL 3.23).

<STRONG>Note:</STRONG> Trailing spaces are removed when <CODE>CHAR</CODE> values are
retrieved.

From MySQL 4.1.0, a <CODE>CHAR</CODE> column with a length specification greater
than 255 is converted to the smallest <CODE>TEXT</CODE> type that can hold values
of the given length.  For example, <CODE>CHAR(500)</CODE> is converted to
<CODE>TEXT</CODE>, and <CODE>CHAR(200000)</CODE> is converted to <CODE>MEDIUMTEXT</CODE>.
This is a compatibility feature.  However, this conversion causes the
column to become a variable-length column, and also affects trailing-space
removal.

<CODE>CHAR</CODE> is shorthand for <CODE>CHARACTER</CODE>.
<CODE>NATIONAL CHAR</CODE> (or its equivalent short form, <CODE>NCHAR</CODE>) is the
standard SQL way to define that a <CODE>CHAR</CODE> column should use the default
character set.  This is the default in MySQL.

The <CODE>BINARY</CODE> attribute causes sorting and comparisons to be
case-sensitive.

From MySQL 4.1.0 on, the <CODE>ASCII</CODE> attribute can be specified. It
assigns the <CODE>latin1</CODE> character set to a <CODE>CHAR</CODE> column.

From MySQL 4.1.1 on, the <CODE>UNICODE</CODE> attribute can be specified. It
assigns the <CODE>ucs2</CODE> character set to a <CODE>CHAR</CODE> column.

MySQL allows you to create a column of type <CODE>CHAR(0)</CODE>. This is mainly
useful when you have to be compliant with some old applications that depend
on the existence of a column but that do not actually use the value.  This
is also quite nice when you need a column that can take only two values: A
<CODE>CHAR(0)</CODE> column that is not defined as <CODE>NOT NULL</CODE> occupies only
one bit and can take only the values <CODE>NULL</CODE> and <CODE>''</CODE> (the empty
string).

<DT><CODE>CHAR</CODE>
<DD>
This is a synonym for <CODE>CHAR(1)</CODE>.

<A NAME="IDX1135"></A>
<A NAME="IDX1136"></A>
<A NAME="IDX1137"></A>
<A NAME="IDX1138"></A>
<DT><CODE>[NATIONAL] VARCHAR(M) [BINARY]</CODE>
<DD>
A variable-length string.  <CODE>M</CODE> represents the maximum column length.
The range of <CODE>M</CODE> is 0 to 255 characters (1 to 255 prior to MySQL 4.0.2).

<STRONG>Note:</STRONG> Trailing spaces are removed when <CODE>VARCHAR</CODE> values are
stored, which differs from the standard SQL specification.

From MySQL 4.1.0 on, a <CODE>VARCHAR</CODE> column with a length specification
greater than 255 is converted to the smallest <CODE>TEXT</CODE> type that can hold
values of the given length.  For example, <CODE>VARCHAR(500)</CODE> is converted
to <CODE>TEXT</CODE>, and <CODE>VARCHAR(200000)</CODE> is converted to
<CODE>MEDIUMTEXT</CODE>.  This is a compatibility feature.
However, this conversion affects trailing-space removal.

<CODE>VARCHAR</CODE> is shorthand for <CODE>CHARACTER VARYING</CODE>.

<A NAME="IDX1139"></A>
<A NAME="IDX1140"></A>
<DT><CODE>TINYBLOB</CODE>
<DD>
<DT><CODE>TINYTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 255 (2^8
- 1)
characters.

<A NAME="IDX1141"></A>
<A NAME="IDX1142"></A>
<DT><CODE>BLOB</CODE>
<DD>
<DT><CODE>TEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 65,535 (2^16
-1)
characters.

<A NAME="IDX1143"></A>
<A NAME="IDX1144"></A>
<DT><CODE>MEDIUMBLOB</CODE>
<DD>
<DT><CODE>MEDIUMTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 16,777,215
(2^24 - 1) characters.

<A NAME="IDX1145"></A>
<A NAME="IDX1146"></A>
<DT><CODE>LONGBLOB</CODE>
<DD>
<DT><CODE>LONGTEXT</CODE>
<DD>
A <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column with a maximum length of 4,294,967,295 or
4GB (2^32 - 1) characters.  Up to MySQL
3.23, the client/server protocol and <CODE>MyISAM</CODE> tables had a limit
of 16MB per communication packet / table row. From MySQL 4.0, the maximum
allowed length of <CODE>LONGBLOB</CODE> or <CODE>LONGTEXT</CODE> columns depends on the
configured maximum packet size in the client/server protocol and available
memory.

<A NAME="IDX1147"></A>
<DT><CODE>ENUM('value1','value2',...)</CODE>
<DD>
An enumeration.  A string object that can have only one value, chosen
from the list of values <CODE>'value1'</CODE>, <CODE>'value2'</CODE>, <CODE>...</CODE>,
<CODE>NULL</CODE> or the special <CODE>''</CODE> error value.  An <CODE>ENUM</CODE> column can
have a maximum of 65,535 distinct values.
<CODE>ENUM</CODE> values are represented internally as integers.

<A NAME="IDX1148"></A>
<DT><CODE>SET('value1','value2',...)</CODE>
<DD>
A set.  A string object that can have zero or more values, each of which must
be chosen from the list of values <CODE>'value1'</CODE>, <CODE>'value2'</CODE>,
<CODE>...</CODE> A <CODE>SET</CODE> column can have a maximum of 64 members.
<CODE>SET</CODE> values are represented internally as integers.
</DL>



<H2><A NAME="Numeric_types" HREF="manual_toc.html#Numeric_types">12.2  Numeric Types</A></H2>

<P>
MySQL supports all of the standard SQL numeric data types.  These
types include the exact numeric data types (<CODE>INTEGER</CODE>,
<CODE>SMALLINT</CODE>, <CODE>DECIMAL</CODE>, and <CODE>NUMERIC</CODE>), as well as the
approximate numeric data types (<CODE>FLOAT</CODE>, <CODE>REAL</CODE>, and
<CODE>DOUBLE PRECISION</CODE>). The keyword <CODE>INT</CODE> is a synonym for
<CODE>INTEGER</CODE>, and the keyword <CODE>DEC</CODE> is a synonym for
<CODE>DECIMAL</CODE>.

</P>
<P>
As an extension to the SQL standard, MySQL also supports the integer
types <CODE>TINYINT</CODE>, <CODE>MEDIUMINT</CODE>, and <CODE>BIGINT</CODE> as listed in
the following table.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Type</STRONG> </TD><TD> <STRONG>Bytes</STRONG> </TD><TD> <STRONG>Minimum Value (Signed)</STRONG> </TD><TD> <STRONG>Maximum Value (Signed)</STRONG>
</TD></TR>
<TR><TD><CODE>TINYINT</CODE> </TD><TD> 1 </TD><TD> <CODE>-128</CODE> </TD><TD> <CODE>127</CODE>
</TD></TR>
<TR><TD><CODE>SMALLINT</CODE> </TD><TD> 2 </TD><TD> <CODE>-32768</CODE> </TD><TD> <CODE>32767</CODE>
</TD></TR>
<TR><TD><CODE>MEDIUMINT</CODE> </TD><TD> 3 </TD><TD> <CODE>-8388608</CODE> </TD><TD> <CODE>8388607</CODE>
</TD></TR>
<TR><TD><CODE>INT</CODE> </TD><TD> 4 </TD><TD> <CODE>-2147483648</CODE> </TD><TD> <CODE>2147483647</CODE>
</TD></TR>
<TR><TD><CODE>BIGINT</CODE> </TD><TD> 8 </TD><TD> <CODE>-9223372036854775808</CODE> </TD><TD> <CODE>9223372036854775807</CODE>
</TD></TR>
</TABLE>

<P>
Another extension is supported by MySQL for optionally
specifying the display width of an integer value in parentheses following
the base keyword for the type (for example, <CODE>INT(4)</CODE>).  This optional
display width specification is used to left-pad the display of values
having a width less than the width specified for the column.

</P>
<P>
The display width does not constrain the range of values that can be stored
in the column, nor the number of digits that will be displayed for values
having a width exceeding that specified for the column.

</P>
<P>
When used in conjunction with the optional extension attribute
<CODE>ZEROFILL</CODE>, the default padding of spaces is replaced with zeros.
For example, for a column declared as <CODE>INT(5) ZEROFILL</CODE>, a value
of <CODE>4</CODE> is retrieved as <CODE>00004</CODE>.  Note that if you store larger
values than the display width in an integer column, you may experience
problems when MySQL generates temporary tables for some
complicated joins, because in these cases MySQL trusts that the
data did fit into the original column width.

</P>
<P>
All integer types can have an optional (non-standard) attribute
<CODE>UNSIGNED</CODE>.  Unsigned values can be used when you want to allow only
non-negative numbers in a column and you need a bigger upper numeric
range for the column.

</P>
<P>
As of MySQL 4.0.2, floating-point and fixed-point types also can be
<CODE>UNSIGNED</CODE>.  As with integer types, this attribute prevents negative
values from being stored in the column.  However, unlike the integer types,
the upper range of column values remains the same.

</P>
<P>
If you specify <CODE>ZEROFILL</CODE> for a numeric column, MySQL
automatically adds the <CODE>UNSIGNED</CODE> attribute to the column.

</P>
<P>
The <CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> types are implemented as the same
type by MySQL.  They are
used to store values for which it is important to preserve exact precision,
for example with monetary data.  When declaring a column of one of these
types, the precision and scale can be (and usually is) specified; for
example:

</P>

<PRE>
salary DECIMAL(5,2)
</PRE>

<P>
In this example, <CODE>5</CODE> is the precision and <CODE>2</CODE> is the scale.  The
precision represents the number of significant decimal digits that will be
stored for values, and the scale represents the number of digits that will
be stored following the decimal point.

</P>
<P>
MySQL stores <CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> values as strings, rather
than as binary floating-point numbers, in order to preserve the decimal
precision of those values.  One character is used for each digit of the
value, the decimal point (if the scale is greater than 0), and the <SAMP>`-'</SAMP> sign
(for negative numbers).  If the scale is 0, <CODE>DECIMAL</CODE> and
<CODE>NUMERIC</CODE> values contain no decimal point or fractional part.

</P>
<P>
Standard SQL requires that the <CODE>salary</CODE> column
be able to store any value with five digits and two decimals. In this case,
therefore, the range of values that can be stored in the <CODE>salary</CODE>
column is from <CODE>-999.99</CODE> to <CODE>999.99</CODE>.  MySQL varies from this in
two ways:

</P>

<UL>

<LI>

On the positive end of the range, the column actually can store numbers up to
<CODE>9999.99</CODE>. For positive numbers, MySQL uses the
byte reserved for the sign to extend the upper end of the range.

<LI>

<CODE>DECIMAL</CODE> columns in MySQL before 3.23 are stored differently and
cannot represent all the values required by standard SQL. This is because
for a type of <CODE>DECIMAL(M,D)</CODE>, the value of <CODE>M</CODE> includes the bytes
for the sign and the decimal point.  The range of the <CODE>salary</CODE> column
before MySQL 3.23 would be <CODE>-9.99</CODE> to <CODE>99.99</CODE>.

</UL>

<P>
In standard SQL, the syntax <CODE>DECIMAL(M)</CODE> is equivalent to
<CODE>DECIMAL(M,0)</CODE>.  Similarly, the syntax <CODE>DECIMAL</CODE> is equivalent
to <CODE>DECIMAL(M,0)</CODE>, where the implementation is allowed to decide the
value of <CODE>M</CODE>.  As of MySQL 3.23.6, both of these variant forms of the
<CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> data types are supported.  Before 3.23.6,
<CODE>M</CODE> and <CODE>D</CODE> both must be specified explicitly.

</P>
<P>
The maximum range of <CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> values is the
same as for <CODE>DOUBLE</CODE>, but the actual range for a given
<CODE>DECIMAL</CODE> or <CODE>NUMERIC</CODE> column can be constrained by the
precision or scale for a given column.  When such a column
is assigned a value with more digits following the decimal point than
are allowed by the specified scale, the value is converted to that
scale.  (The precise behavior is operating system-specific, but
generally the effect is truncation to the allowable number of digits.)
When a <CODE>DECIMAL</CODE> or <CODE>NUMERIC</CODE> column is
assigned a value that exceeds the range implied by the
specified (or default) precision and scale,
MySQL stores the value representing the corresponding end
point of that range.

</P>
<P>
For floating-point column types, MySQL uses four bytes for single-precision
values and eight bytes for double-precision values.

</P>
<P>
The <CODE>FLOAT</CODE> type is used to represent approximate numeric data types.
The SQL standard allows an optional specification of the precision
(but not the range of the exponent) in bits following the keyword
<CODE>FLOAT</CODE> in parentheses.  The MySQL implementation also supports this
optional precision specification, but the precision value is used only to
determine storage size.  A precision from 0 to 23 results in four-byte
single-precision <CODE>FLOAT</CODE> column. A precision from 24 to 53 results
in eight-byte double-precision <CODE>DOUBLE</CODE> column.

</P>
<P>
When the keyword
<CODE>FLOAT</CODE> is used for a column type without a precision specification,
MySQL uses four bytes to store the values.  MySQL also supports variant
syntax with two numbers given in parentheses following the <CODE>FLOAT</CODE>
keyword.  The first number represents the display width
and the second number specifies the number of digits to be stored and
displayed following the decimal point (as with <CODE>DECIMAL</CODE> and
<CODE>NUMERIC</CODE>).  When MySQL is asked to store a number for
such a column with more decimal digits following the decimal point than
specified for the column, the value is rounded to eliminate the extra
digits when the value is stored.

</P>
<P>
In standard SQL, the <CODE>REAL</CODE> and <CODE>DOUBLE PRECISION</CODE> types do not accept
precision specifications.  MySQL supports a variant syntax with two numbers
given in parentheses following the type name.  The first number represents
the display width and the second number specifies the number of digits to
be stored and displayed following the decimal point.
As an extension to the SQL standard, MySQL recognizes <CODE>DOUBLE</CODE>
as a synonym for the <CODE>DOUBLE PRECISION</CODE> type.  In contrast with the
standard's requirement that the precision for <CODE>REAL</CODE> be smaller than
that used for <CODE>DOUBLE PRECISION</CODE>, MySQL implements both as eight-byte
double-precision floating-point values (unless the server SQL mode
includes the <CODE>REAL_AS_FLOAT</CODE> option).

</P>
<P>
For maximum portability, code requiring storage of approximate numeric
data values should use <CODE>FLOAT</CODE> or <CODE>DOUBLE PRECISION</CODE> with no
specification of precision or number of decimal points.

</P>
<P>
When asked to store a value in a numeric column that is outside the column
type's allowable range, MySQL clips the value to the appropriate
endpoint of the range and stores the resulting value instead.

</P>
<P>
For example, the range of an <CODE>INT</CODE> column is <CODE>-2147483648</CODE>
to <CODE>2147483647</CODE>.  If you try to insert <CODE>-9999999999</CODE> into an
<CODE>INT</CODE> column, MySQL clips the value to the lower endpoint of the
range and stores <CODE>-2147483648</CODE> instead. Similarly, if you try to
insert <CODE>9999999999</CODE>, MySQL clips the value to the upper endpoint of
the range and stores <CODE>2147483647</CODE> instead.

</P>
<P>
If the <CODE>INT</CODE> column is <CODE>UNSIGNED</CODE>, the size of the column's
range is the same but its endpoints shift up to <CODE>0</CODE> and <CODE>4294967295</CODE>.
If you try to store <CODE>-9999999999</CODE> and <CODE>9999999999</CODE>,
the values stored in the column are <CODE>0</CODE> and <CODE>4294967296</CODE>.

</P>
<P>
Conversions that occur due to clipping are reported as ``warnings'' for
<CODE>ALTER TABLE</CODE>, <CODE>LOAD DATA INFILE</CODE>, <CODE>UPDATE</CODE>, and
multiple-row <CODE>INSERT</CODE> statements.

</P>



<H2><A NAME="Date_and_time_types" HREF="manual_toc.html#Date_and_time_types">12.3  Date and Time Types</A></H2>

<P>
<A NAME="IDX1149"></A>
<A NAME="IDX1150"></A>

</P>

<P>
The date and time types for representing temporal values are <CODE>DATETIME</CODE>, <CODE>DATE</CODE>,
<CODE>TIMESTAMP</CODE>, <CODE>TIME</CODE>, and <CODE>YEAR</CODE>.  Each temporal type has a
range of legal values, as well as a ``zero'' value that is used when you
specify an illegal value that MySQL cannot represent. The <CODE>TIMESTAMP</CODE>
type has special automatic updating behavior, described later on.

</P>

<P>
MySQL allows you to store certain ``not strictly legal'' date values,
such as <CODE>'1999-11-31'</CODE>.  The reason for this is that we consider date
checking to be the responsibility of the application, not the SQL server.
To make date checking faster, MySQL verifies only that the month is in the
range from 0 to 12 and that the day is in the range from 0 to 31. These ranges
are defined to include zero because MySQL allows you to store dates where the
day or month and day are zero in a <CODE>DATE</CODE> or <CODE>DATETIME</CODE> column.
This is extremely useful for applications that need to store a birthdate
for which you don't know the exact date. In this case, you simply store
the date like <CODE>'1999-00-00'</CODE> or <CODE>'1999-01-00'</CODE>.  Note that if you
store dates like these, you should not expect to get correct results for
functions such as <CODE>DATE_SUB()</CODE> or <CODE>DATE_ADD</CODE> that require
complete dates.

</P>
<P>
Here are some general considerations to keep in mind when working
with date and time types:

</P>

<UL>
<LI>

MySQL retrieves values for a given date or time type in a standard output
format, but it attempts to interpret a variety of formats for input values
that you supply (for example, when you specify a value to be assigned to
or compared to a date or time type).  Only the formats described in the
following sections are supported.  It is expected that you will supply
legal values, and unpredictable results may occur if you use values in
other formats.

<LI>

Dates containing two-digit year values are ambiguous because the century is
unknown.  MySQL interprets two-digit year values using the following
rules:


<UL>
<LI>

Year values in the range <CODE>00-69</CODE> are converted to <CODE>2000-2069</CODE>.

<LI>

Year values in the range <CODE>70-99</CODE> are converted to <CODE>1970-1999</CODE>.
</UL>

<LI>

Although MySQL tries to interpret values in several formats, 
dates always must be
given in year-month-day order (for example, <CODE>'98-09-04'</CODE>), rather than
in the month-day-year or day-month-year orders commonly used elsewhere (for
example, <CODE>'09-04-98'</CODE>, <CODE>'04-09-98'</CODE>).

<LI>

MySQL automatically converts a date or time type value to a number
if the value is used in a numeric context and vice versa.

<LI>

When MySQL encounters a value for a date or time type that is out of
range or otherwise illegal for the type (as described at the beginning of
this section), it converts the value to the ``zero'' value for that type.
The exception is that out-of-range <CODE>TIME</CODE> values are clipped to the
appropriate endpoint of the <CODE>TIME</CODE> range.

The following table shows the format of the ``zero'' value for each type:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Type</STRONG> </TD><TD> <STRONG>``Zero'' Value</STRONG>
</TD></TR>
<TR><TD><CODE>DATETIME</CODE> </TD><TD> <CODE>'0000-00-00 00:00:00'</CODE>
</TD></TR>
<TR><TD><CODE>DATE</CODE> </TD><TD> <CODE>'0000-00-00'</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP</CODE> </TD><TD> <CODE>00000000000000</CODE>
</TD></TR>
<TR><TD><CODE>TIME</CODE> </TD><TD> <CODE>'00:00:00'</CODE>
</TD></TR>
<TR><TD><CODE>YEAR</CODE> </TD><TD> <CODE>0000</CODE>
</TD></TR>
</TABLE>

<LI>

The ``zero'' values are special, but you can store or refer to them
explicitly using the values shown in the table.  You can also do this
using the values <CODE>'0'</CODE> or <CODE>0</CODE>, which are easier to write.

<LI>

``Zero'' date or time values used through Connector/ODBC are converted
automatically to <CODE>NULL</CODE> in Connector/ODBC 2.50.12 and above,
because ODBC can't handle such values.
</UL>



<H3><A NAME="DATETIME" HREF="manual_toc.html#DATETIME">12.3.1  The <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, and <CODE>TIMESTAMP</CODE> Types</A></H3>

<P>
<A NAME="IDX1151"></A>
<A NAME="IDX1152"></A>
<A NAME="IDX1153"></A>

</P>

<P>
The <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, and <CODE>TIMESTAMP</CODE> types are related.
This section describes their characteristics, how they are similar, and how
they differ.

</P>
<P>
The <CODE>DATETIME</CODE> type is used when you need values that contain both date
and time information.  MySQL retrieves and displays <CODE>DATETIME</CODE>
values in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> format.  The supported range is
<CODE>'1000-01-01 00:00:00'</CODE> to <CODE>'9999-12-31 23:59:59'</CODE>.  (``Supported''
means that although earlier values might work, there is no guarantee that
they will.)

</P>
<P>
The <CODE>DATE</CODE> type is used when you need only a date value, without a time
part.  MySQL retrieves and displays <CODE>DATE</CODE> values in
<CODE>'YYYY-MM-DD'</CODE> format.  The supported range is <CODE>'1000-01-01'</CODE> to
<CODE>'9999-12-31'</CODE>.

</P>
<P>
The <CODE>TIMESTAMP</CODE> column type has varying properties,
depending on the MySQL version and the SQL mode the server is running in.
These properties are described later in this section.

</P>
<P>
You can specify <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, and <CODE>TIMESTAMP</CODE> values using
any of a common set of formats:

</P>

<UL>
<LI>

As a string in either <CODE>'YYYY-MM-DD HH:MM:SS'</CODE> or <CODE>'YY-MM-DD
HH:MM:SS'</CODE> format.  A ``relaxed'' syntax is allowed: Any punctuation
character may be used as the delimiter between date parts or time parts.
For example, <CODE>'98-12-31 11:30:45'</CODE>, <CODE>'98.12.31 11+30+45'</CODE>,
<CODE>'98/12/31 11*30*45'</CODE>, and <CODE>'98@12@31 11^30^45'</CODE> are
equivalent.

<LI>

As a string in either <CODE>'YYYY-MM-DD'</CODE> or <CODE>'YY-MM-DD'</CODE> format.
A ``relaxed'' syntax is allowed here, too.  For example, <CODE>'98-12-31'</CODE>,
<CODE>'98.12.31'</CODE>, <CODE>'98/12/31'</CODE>, and <CODE>'98@12@31'</CODE> are
equivalent.

<LI>

As a string with no delimiters in either <CODE>'YYYYMMDDHHMMSS'</CODE> or
<CODE>'YYMMDDHHMMSS'</CODE> format, provided that the string makes sense as a
date.  For example, <CODE>'19970523091528'</CODE> and <CODE>'970523091528'</CODE> are
interpreted as <CODE>'1997-05-23 09:15:28'</CODE>, but <CODE>'971122129015'</CODE> is
illegal (it has a nonsensical minute part) and becomes <CODE>'0000-00-00
00:00:00'</CODE>.

<LI>

As a string with no delimiters in either <CODE>'YYYYMMDD'</CODE> or <CODE>'YYMMDD'</CODE>
format, provided that the string makes sense as a date.  For example,
<CODE>'19970523'</CODE> and <CODE>'970523'</CODE> are interpreted as
<CODE>'1997-05-23'</CODE>, but <CODE>'971332'</CODE> is illegal (it has nonsensical month
and day parts) and becomes <CODE>'0000-00-00'</CODE>.

<LI>

As a number in either <CODE>YYYYMMDDHHMMSS</CODE> or <CODE>YYMMDDHHMMSS</CODE>
format, provided that the number makes sense as a date.  For example,
<CODE>19830905132800</CODE> and <CODE>830905132800</CODE> are interpreted as
<CODE>'1983-09-05 13:28:00'</CODE>.

<LI>

As a number in either <CODE>YYYYMMDD</CODE> or <CODE>YYMMDD</CODE>
format, provided that the number makes sense as a date.  For example,
<CODE>19830905</CODE> and <CODE>830905</CODE> are interpreted as <CODE>'1983-09-05'</CODE>.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, or <CODE>TIMESTAMP</CODE> context, such as
<CODE>NOW()</CODE> or <CODE>CURRENT_DATE</CODE>.
</UL>

<P>
Illegal <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, or <CODE>TIMESTAMP</CODE> values are converted
to the ``zero'' value of the appropriate type (<CODE>'0000-00-00 00:00:00'</CODE>,
<CODE>'0000-00-00'</CODE>, or <CODE>00000000000000</CODE>).

</P>
<P>
For values specified as strings that include date part delimiters, it is not
necessary to specify two digits for month or day values that are less than
<CODE>10</CODE>.  <CODE>'1979-6-9'</CODE> is the same as <CODE>'1979-06-09'</CODE>.  Similarly,
for values specified as strings that include time part delimiters, it is not
necessary to specify two digits for hour, minute, or second values that are
less than <CODE>10</CODE>.  <CODE>'1979-10-30 1:2:3'</CODE> is the same as
<CODE>'1979-10-30 01:02:03'</CODE>.

</P>
<P>
Values specified as numbers should be 6, 8, 12, or 14 digits long.  If a
number is 8 or 14 digits long, it is assumed to be in <CODE>YYYYMMDD</CODE> or
<CODE>YYYYMMDDHHMMSS</CODE> format and that the year is given by the first 4
digits.  If the number is 6 or 12 digits long, it is assumed to be in
<CODE>YYMMDD</CODE> or <CODE>YYMMDDHHMMSS</CODE> format and that the year is given by the
first 2 digits.  Numbers that are not one of these lengths are interpreted
as though padded with leading zeros to the closest length.

</P>
<P>
<A NAME="IDX1154"></A>
<A NAME="IDX1155"></A>
Values specified as non-delimited strings are interpreted using their length
as given.  If the string is 8 or 14 characters long, the year is assumed to
be given by the first 4 characters.  Otherwise, the year is assumed to be
given by the first 2 characters.  The string is interpreted from left to
right to find year, month, day, hour, minute, and second values, for as many
parts as are present in the string.  This means you should not use strings
that have fewer than 6 characters.  For example, if you specify <CODE>'9903'</CODE>,
thinking that will represent March, 1999, you will find that MySQL
inserts a ``zero'' date into your table.  This is because the year and month
values are <CODE>99</CODE> and <CODE>03</CODE>, but the day part is completely missing, so
the value is not a legal date.  However, as of MySQL 3.23, you can explicitly
specify a value of zero to represent missing month or day parts.  For example,
you can use <CODE>'990300'</CODE> to insert the value <CODE>'1999-03-00'</CODE>.

</P>
<P>
You can to some extent assign values of one date type to an object
of a different date type.  However, there may be some alteration
of the value or loss of information:

</P>

<UL>
<LI>

If you assign a <CODE>DATE</CODE> value to a <CODE>DATETIME</CODE> or <CODE>TIMESTAMP</CODE>
object, the time part of the resulting value is set to <CODE>'00:00:00'</CODE>
because the <CODE>DATE</CODE> value contains no time information.

<LI>

If you assign a <CODE>DATETIME</CODE> or <CODE>TIMESTAMP</CODE> value to a <CODE>DATE</CODE>
object, the time part of the resulting value is deleted because the
<CODE>DATE</CODE> type stores no time information.

<LI>

Remember that although <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, and <CODE>TIMESTAMP</CODE>
values all can be specified using the same set of formats, the types do not
all have the same range of values.  For example, <CODE>TIMESTAMP</CODE> values
cannot be earlier than <CODE>1970</CODE> or later than <CODE>2037</CODE>.  This means
that a date such as <CODE>'1968-01-01'</CODE>, while legal as a <CODE>DATETIME</CODE> or
<CODE>DATE</CODE> value, is not a valid <CODE>TIMESTAMP</CODE> value and will be
converted to <CODE>0</CODE> if assigned to such an object.
</UL>

<P>
<A NAME="IDX1156"></A>
<A NAME="IDX1157"></A>
Be aware of certain pitfalls when specifying date values:

</P>

<UL>
<LI>

The relaxed format allowed for values specified as strings can be deceiving.
For example, a value such as <CODE>'10:11:12'</CODE> might look like a time value
because of the <SAMP>`:'</SAMP> delimiter, but if used in a date context will be
interpreted as the year <CODE>'2010-11-12'</CODE>.  The value <CODE>'10:45:15'</CODE>
will be converted to <CODE>'0000-00-00'</CODE> because <CODE>'45'</CODE> is not a legal
month.

<LI>

The MySQL server performs only basic checking on the validity of a date:
The ranges for year, month, and day are 1000 to 9999, 00 to 12, and 00
to 31, respectively.  Any date containing parts not within these ranges is subject to
conversion
to <CODE>'0000-00-00'</CODE>.  Please note that this still allows you to store
invalid dates such as <CODE>'2002-04-31'</CODE>.  To ensure that a date is valid,
perform a check in your application.

<LI>

Dates containing two-digit year values are ambiguous because the century is
unknown.  MySQL interprets two-digit year values using the following
rules:


<UL>
<LI>

Year values in the range <CODE>00-69</CODE> are converted to <CODE>2000-2069</CODE>.

<LI>

Year values in the range <CODE>70-99</CODE> are converted to <CODE>1970-1999</CODE>.
</UL>

</UL>



<H4><A NAME="TIMESTAMP_pre-4.1" HREF="manual_toc.html#TIMESTAMP_pre-4.1">12.3.1.1  <CODE>TIMESTAMP</CODE> Properties Prior to MySQL 4.1</A></H4>

<P>
The <CODE>TIMESTAMP</CODE> column type provides a type that you can use to
automatically mark <CODE>INSERT</CODE> or <CODE>UPDATE</CODE> operations with the current
date and time.  If you have multiple <CODE>TIMESTAMP</CODE> columns in a table,
only the first one is updated automatically.

</P>
<P>
Automatic updating of the first <CODE>TIMESTAMP</CODE> column in a table occurs
under any of the following conditions:

</P>

<UL>

<LI>

You explicitly set the column to <CODE>NULL</CODE>.

<LI>

The column is not specified explicitly in an <CODE>INSERT</CODE> or
<CODE>LOAD DATA INFILE</CODE> statement.

<LI>

The column is not specified explicitly in an <CODE>UPDATE</CODE> statement and some
other column changes value.  An <CODE>UPDATE</CODE> that sets a column
to the value it already has does not cause the <CODE>TIMESTAMP</CODE> column to be
updated; if you set a column to its current value, MySQL
ignores the update for efficiency.

</UL>

<P>
<CODE>TIMESTAMP</CODE> columns other than the first can also be set to the current
date and time.  Just set the column to <CODE>NULL</CODE> or to <CODE>NOW()</CODE>.

</P>
<P>
You can set any <CODE>TIMESTAMP</CODE> column to a value different from the current
date and time by setting it explicitly to the desired value.  This is true
even for the first <CODE>TIMESTAMP</CODE> column.  You can use this property if,
for example, you want a <CODE>TIMESTAMP</CODE> to be set to the current date and
time when you create a row, but not to be changed whenever the row is updated
later:

</P>

<UL>
<LI>

Let MySQL set the column when the row is created.
This initializes it to the current date and time.

<LI>

When you perform subsequent updates to other columns in the row, set
the <CODE>TIMESTAMP</CODE> column explicitly to its current value:


<PRE>
UPDATE tbl_name
    SET timestamp_col = timestamp_col,
        other_col1 = new_value1,
        other_col2 = new_value2, ...
</PRE>

</UL>

<P>
Another way to maintain a column that records row-creation time is to use
a <CODE>DATETIME</CODE> column that you initialize to <CODE>NOW()</CODE> when the row
is created and leave alone for subsequent updates.

</P>
<P>
<CODE>TIMESTAMP</CODE> values may range from the beginning of 1970 to partway
through
the year 2037, with a resolution of one second.  Values are displayed as
numbers.

</P>
<P>
The format in which MySQL retrieves and displays <CODE>TIMESTAMP</CODE>
values depends on the display size, as illustrated by the following table.  The
``full'' <CODE>TIMESTAMP</CODE> format is 14 digits, but <CODE>TIMESTAMP</CODE> columns may
be created with shorter display sizes:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Type</STRONG> </TD><TD> <STRONG>Display Format</STRONG>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(14)</CODE> </TD><TD> <CODE>YYYYMMDDHHMMSS</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(12)</CODE> </TD><TD> <CODE>YYMMDDHHMMSS</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(10)</CODE> </TD><TD> <CODE>YYMMDDHHMM</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(8)</CODE> </TD><TD> <CODE>YYYYMMDD</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(6)</CODE> </TD><TD> <CODE>YYMMDD</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(4)</CODE> </TD><TD> <CODE>YYMM</CODE>
</TD></TR>
<TR><TD><CODE>TIMESTAMP(2)</CODE> </TD><TD> <CODE>YY</CODE>
</TD></TR>
</TABLE>

<P>
All <CODE>TIMESTAMP</CODE> columns have the same storage size, regardless of
display size.  The most common display sizes are 6, 8, 12, and 14.  You can
specify an arbitrary display size at table creation time, but values of 0 or
greater than 14 are coerced to 14.  Odd-valued sizes in the range from 1 to
13 are coerced to the next higher even number.

</P>
<P>
<CODE>TIMESTAMP</CODE> columns store legal values using the full precision with
which the value was specified, regardless of the display size.  This has
several implications:

</P>

<UL>
<LI>

Always specify year, month, and day, even if your column types are
<CODE>TIMESTAMP(4)</CODE> or <CODE>TIMESTAMP(2)</CODE>.  Otherwise, the value is not
a legal date and <CODE>0</CODE> will be stored.

<LI>

If you use <CODE>ALTER TABLE</CODE> to widen a narrow <CODE>TIMESTAMP</CODE> column,
information will be displayed that previously was ``hidden.''

<LI>

Similarly, narrowing a <CODE>TIMESTAMP</CODE> column does not cause information to
be lost, except in the sense that less information is shown when the values
are displayed.

<LI>

Although <CODE>TIMESTAMP</CODE> values are stored to full precision, the only
function that operates directly on the underlying stored value is
<CODE>UNIX_TIMESTAMP()</CODE>.  Other functions operate on the formatted retrieved
value.  This means you cannot use a function such as <CODE>HOUR()</CODE> or
<CODE>SECOND()</CODE> unless the relevant part of the <CODE>TIMESTAMP</CODE> value is
included in the formatted value.  For example, the <CODE>HH</CODE> part of a
<CODE>TIMESTAMP</CODE> column is not displayed unless the display size is at least
10, so trying to use <CODE>HOUR()</CODE> on shorter <CODE>TIMESTAMP</CODE> values
produces a meaningless result.
</UL>



<H4><A NAME="TIMESTAMP_4.1" HREF="manual_toc.html#TIMESTAMP_4.1">12.3.1.2  <CODE>TIMESTAMP</CODE> Properties as of MySQL 4.1</A></H4>

<P>
From MySQL 4.1.0 on, <CODE>TIMESTAMP</CODE> properties differ from those of earlier
MySQL releases:

</P>

<UL>

<LI>

<CODE>TIMESTAMP</CODE> columns are displayed in the same format as <CODE>DATETIME</CODE>
columns.

<LI>

Display widths are not supported in the ways described in the preceding
section. In other words, you cannot use <CODE>TIMESTAMP(2)</CODE>,
<CODE>TIMESTAMP(4)</CODE>, and so on.

</UL>

<P>
In addition, if the MySQL server is running in <CODE>MAXDB</CODE> mode,
<CODE>TIMESTAMP</CODE> is identical with <CODE>DATETIME</CODE>. That is, if the server
is running in <CODE>MAXDB</CODE> mode at the time that a table is created, any
<CODE>TIMESTAMP</CODE> columns are created as <CODE>DATETIME</CODE> columns.  As a
result, such columns use <CODE>DATETIME</CODE> display format, have the same range
of values, and no automatic updating occurs.

</P>
<P>
MySQL can be run in <CODE>MAXDB</CODE> mode as of version 4.1.1.  To enable this
mode, set the server SQL mode to <CODE>MAXDB</CODE> at startup using the
<CODE>--sql-mode=MAXDB</CODE> server option or by setting the global
<CODE>sql_mode</CODE> variable at runtime:

</P>

<PRE>
mysql&#62; SET GLOBAL sql_mode=MAXDB;
</PRE>

<P>
A client can cause the server to run in <CODE>MAXDB</CODE> mode for its own
connection as follows:

</P>

<PRE>
mysql&#62; SET SESSION sql_mode=MAXDB;
</PRE>



<H3><A NAME="TIME" HREF="manual_toc.html#TIME">12.3.2  The <CODE>TIME</CODE> Type</A></H3>

<P>
<A NAME="IDX1158"></A>

</P>
<P>
MySQL retrieves and displays <CODE>TIME</CODE> values in <CODE>'HH:MM:SS'</CODE>
format (or <CODE>'HHH:MM:SS'</CODE> format for large hours values).  <CODE>TIME</CODE>
values may range from <CODE>'-838:59:59'</CODE> to <CODE>'838:59:59'</CODE>.  The reason
the hours part may be so large is that the <CODE>TIME</CODE> type may be used not
only to represent a time of day (which must be less than 24 hours), but also
elapsed time or a time interval between two events (which may be much greater
than 24 hours, or even negative).

</P>
<P>
You can specify <CODE>TIME</CODE> values in a variety of formats:

</P>

<UL>
<LI>

As a string in <CODE>'D HH:MM:SS.fraction'</CODE> format.
You can also use one of the following ``relaxed'' syntaxes:
<CODE>'HH:MM:SS.fraction'</CODE>, <CODE>'HH:MM:SS'</CODE>, <CODE>'HH:MM'</CODE>, <CODE>'D
HH:MM:SS'</CODE>, <CODE>'D HH:MM'</CODE>, <CODE>'D HH'</CODE>, or <CODE>'SS'</CODE>.  Here <CODE>D</CODE>
represents days and can have a value from 0 to 33.
Note that MySQL doesn't yet store the fraction part.

<LI>

As a string with no delimiters in <CODE>'HHMMSS'</CODE> format, provided that
it makes sense as a time.  For example, <CODE>'101112'</CODE> is understood as
<CODE>'10:11:12'</CODE>, but <CODE>'109712'</CODE> is illegal (it has a nonsensical
minute part) and becomes <CODE>'00:00:00'</CODE>.

<LI>

As a number in <CODE>HHMMSS</CODE> format, provided that it makes sense as a time.
For example, <CODE>101112</CODE> is understood as <CODE>'10:11:12'</CODE>.  The following
alternative formats are also understood: <CODE>SS</CODE>, <CODE>MMSS</CODE>, <CODE>HHMMSS</CODE>,
<CODE>HHMMSS.fraction</CODE>.  Note that MySQL doesn't yet store the
fraction part.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>TIME</CODE> context, such as <CODE>CURRENT_TIME</CODE>.
</UL>

<P>
For <CODE>TIME</CODE> values specified as strings that include a time part
delimiter, it is not necessary to specify two digits for hours, minutes, or
seconds values that are less than <CODE>10</CODE>.  <CODE>'8:3:2'</CODE> is the same as
<CODE>'08:03:02'</CODE>.

</P>
<P>
Be careful about assigning ``short'' <CODE>TIME</CODE> values to a <CODE>TIME</CODE>
column. Without colons, MySQL interprets values using the
assumption that the rightmost digits represent seconds. (MySQL
interprets <CODE>TIME</CODE> values as elapsed time rather than as time of
day.) For example, you might think of <CODE>'1112'</CODE> and <CODE>1112</CODE> as
meaning <CODE>'11:12:00'</CODE> (12 minutes after 11 o'clock), but
MySQL interprets them as <CODE>'00:11:12'</CODE> (11 minutes, 12 seconds).
Similarly, <CODE>'12'</CODE> and <CODE>12</CODE> are interpreted as <CODE>'00:00:12'</CODE>.
<CODE>TIME</CODE> values with colons, by contrast, are always treated as
time of the day. That is <CODE>'11:12'</CODE> will mean <CODE>'11:12:00'</CODE>,
not <CODE>'00:11:12'</CODE>.

</P>
<P>
Values that lie outside the <CODE>TIME</CODE> range
but are otherwise legal are clipped to the closest
endpoint of the range.  For example, <CODE>'-850:00:00'</CODE> and
<CODE>'850:00:00'</CODE> are converted to <CODE>'-838:59:59'</CODE> and
<CODE>'838:59:59'</CODE>.

</P>
<P>
Illegal <CODE>TIME</CODE> values are converted to <CODE>'00:00:00'</CODE>.  Note that
because <CODE>'00:00:00'</CODE> is itself a legal <CODE>TIME</CODE> value, there is no way
to tell, from a value of <CODE>'00:00:00'</CODE> stored in a table, whether the
original value was specified as <CODE>'00:00:00'</CODE> or whether it was illegal.

</P>



<H3><A NAME="YEAR" HREF="manual_toc.html#YEAR">12.3.3  The <CODE>YEAR</CODE> Type</A></H3>

<P>
<A NAME="IDX1159"></A>

</P>
<P>
The <CODE>YEAR</CODE> type is a one-byte type used for representing years.

</P>

<P>
MySQL retrieves and displays <CODE>YEAR</CODE> values in <CODE>YYYY</CODE>
format.  The range is <CODE>1901</CODE> to <CODE>2155</CODE>.

</P>
<P>
You can specify <CODE>YEAR</CODE> values in a variety of formats:

</P>

<UL>
<LI>

As a four-digit string in the range <CODE>'1901'</CODE> to <CODE>'2155'</CODE>.

<LI>

As a four-digit number in the range <CODE>1901</CODE> to <CODE>2155</CODE>.

<LI>

As a two-digit string in the range <CODE>'00'</CODE> to <CODE>'99'</CODE>.  Values in the
ranges <CODE>'00'</CODE> to <CODE>'69'</CODE> and <CODE>'70'</CODE> to <CODE>'99'</CODE> are
converted to <CODE>YEAR</CODE> values in the ranges <CODE>2000</CODE> to <CODE>2069</CODE> and
<CODE>1970</CODE> to <CODE>1999</CODE>.

<LI>

As a two-digit number in the range <CODE>1</CODE> to <CODE>99</CODE>.  Values in the
ranges <CODE>1</CODE> to <CODE>69</CODE> and <CODE>70</CODE> to <CODE>99</CODE> are converted to
<CODE>YEAR</CODE> values in the ranges <CODE>2001</CODE> to <CODE>2069</CODE> and <CODE>1970</CODE>
to <CODE>1999</CODE>.  Note that the range for two-digit numbers is slightly
different from the range for two-digit strings, because you cannot specify zero
directly as a number and have it be interpreted as <CODE>2000</CODE>.  You
must specify it as a string <CODE>'0'</CODE> or <CODE>'00'</CODE> or it will be
interpreted as <CODE>0000</CODE>.

<LI>

As the result of a function that returns a value that is acceptable
in a <CODE>YEAR</CODE> context, such as <CODE>NOW()</CODE>.
</UL>

<P>
Illegal <CODE>YEAR</CODE> values are converted to <CODE>0000</CODE>.

</P>



<H3><A NAME="Y2K_issues" HREF="manual_toc.html#Y2K_issues">12.3.4  Y2K Issues and Date Types</A></H3>

<P>
<A NAME="IDX1160"></A>
<A NAME="IDX1161"></A>

</P>
<P>
MySQL itself is year 2000 (Y2K) safe (see section <A HREF="manual.html#Year_2000_compliance">1.2.5  Year 2000 Compliance</A>),
but input values presented to MySQL may not be.  Any input
containing two-digit year values is ambiguous, because the century is unknown.
Such values must be interpreted into four-digit form because MySQL stores
years internally using four digits.

</P>
<P>
For <CODE>DATETIME</CODE>, <CODE>DATE</CODE>, <CODE>TIMESTAMP</CODE>, and <CODE>YEAR</CODE> types,
MySQL interprets dates with ambiguous year values using the
following rules:

</P>

<UL>
<LI>

Year values in the range <CODE>00-69</CODE> are converted to <CODE>2000-2069</CODE>.

<LI>

Year values in the range <CODE>70-99</CODE> are converted to <CODE>1970-1999</CODE>.
</UL>

<P>
Remember that these rules provide only reasonable guesses as to what your
data values mean.  If the heuristics used by MySQL do not produce the
correct values, you should provide unambiguous input containing four-digit
year values.

</P>
<P>
<CODE>ORDER BY</CODE> properly sorts <CODE>YEAR</CODE> or <CODE>TIMESTAMP</CODE> values that
have two-digit years.

</P>
<P>
Some functions like <CODE>MIN()</CODE> and <CODE>MAX()</CODE> will convert a
<CODE>TIMESTAMP</CODE> or <CODE>YEAR</CODE> to a number. This means that a value with a
two-digit year will not work properly with these functions.  The fix in this
case is to convert the <CODE>TIMESTAMP</CODE> or <CODE>YEAR</CODE> to four-digit year
format or use something like <CODE>MIN(DATE_ADD(timestamp,INTERVAL 0
DAYS))</CODE>.

</P>



<H2><A NAME="String_types" HREF="manual_toc.html#String_types">12.4  String Types</A></H2>

<P>
<A NAME="IDX1162"></A>
<A NAME="IDX1163"></A>

</P>
<P>
<A NAME="IDX1164"></A>
<A NAME="IDX1165"></A>

</P>

<P>
The string types are <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, <CODE>TEXT</CODE>,
<CODE>ENUM</CODE>, and <CODE>SET</CODE>.  This section describes how these types work
and how to use them in your queries.

</P>



<H3><A NAME="CHAR" HREF="manual_toc.html#CHAR">12.4.1  The <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> Types</A></H3>

<P>
The <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> types are similar, but differ in the
way they are stored and retrieved.

</P>
<P>
The length of a <CODE>CHAR</CODE> column is fixed to the length that you declare
when you create the table.  The length can be any value from 0 to 255.
(Before MySQL 3.23, the length of <CODE>CHAR</CODE> may be from 1 to 255.)
When <CODE>CHAR</CODE> values are stored, they are right-padded with spaces to the
specified length.  When <CODE>CHAR</CODE> values are retrieved, trailing spaces are
removed.

</P>
<P>
Values in <CODE>VARCHAR</CODE> columns are variable-length strings.  You can
declare a <CODE>VARCHAR</CODE> column to be any length from 0 to 255, just as
for <CODE>CHAR</CODE> columns.  (Before MySQL 4.0.2, the length of <CODE>VARCHAR</CODE>
may be from 1 to 255.) However, in contrast to <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>
values are stored using only as many characters as are needed, plus one byte
to record the length.  Values are not padded; instead, trailing spaces are
removed when values are stored.  This space removal differs from the
standard SQL specification.

</P>
<P>
No lettercase conversion takes place during storage or retrieval.

</P>
<P>
If you assign a value to a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column that
exceeds the column's maximum length, the value is truncated to fit.

</P>
<P>
If you need a column for which trailing spaces are not removed, consider using
a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> type.
If you want to store binary values such as results from an encryption
or compression function that might contain arbitrary byte values, use a
<CODE>BLOB</CODE> column rather than a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column to
avoid potential problems with trailing space removal that would change
data values.

</P>
<P>
The following table illustrates the differences between the two types of columns
by showing the result of storing various string values into <CODE>CHAR(4)</CODE>
and <CODE>VARCHAR(4)</CODE> columns:

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Value</STRONG> </TD><TD> <CODE>CHAR(4)</CODE> </TD><TD> <STRONG>Storage Required</STRONG> </TD><TD> <CODE>VARCHAR(4)</CODE> </TD><TD> <STRONG>Storage Required</STRONG>
</TD></TR>
<TR><TD><CODE>''</CODE> </TD><TD> <CODE>'    '</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>''</CODE> </TD><TD> 1 byte
</TD></TR>
<TR><TD><CODE>'ab'</CODE> </TD><TD> <CODE>'ab  '</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'ab'</CODE> </TD><TD> 3 bytes
</TD></TR>
<TR><TD><CODE>'abcd'</CODE> </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 5 bytes
</TD></TR>
<TR><TD><CODE>'abcdefgh'</CODE> </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 4 bytes </TD><TD> <CODE>'abcd'</CODE> </TD><TD> 5 bytes
</TD></TR>
</TABLE>

<P>
The values retrieved from the <CODE>CHAR(4)</CODE> and <CODE>VARCHAR(4)</CODE> columns
will be the same in each case, because trailing spaces are removed from
<CODE>CHAR</CODE> columns upon retrieval.

</P>
<P>
As of MySQL 4.1, values in <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns are sorted
and compared according to the collation of the character set assigned to
the column.  Before MySQL 4.1, sorting and comparison are based on
the collation of the server character set; you can declare the column
with the <CODE>BINARY</CODE> attribute to cause sorting and comparison to be
case-insensitive using the underlying character code values rather then a
lexical ordering.  <CODE>BINARY</CODE> doesn't affect how the column is stored
or retrieved.

</P>
<P>
From MySQL 4.1.0, column type <CODE>CHAR BYTE</CODE> is an alias for
<CODE>CHAR BINARY</CODE>. This is a compatibility feature.

</P>
<P>
The <CODE>BINARY</CODE> attribute is sticky.  This means that if a column marked
<CODE>BINARY</CODE> is used in an expression, the whole expression is treated as a
<CODE>BINARY</CODE> value.

</P>
<P>
From MySQL 4.1.0 on, the <CODE>ASCII</CODE> attribute can be specified for
<CODE>CHAR</CODE>. It assigns the <CODE>latin1</CODE> character set.

</P>
<P>
From MySQL 4.1.1 on, the <CODE>UNICODE</CODE> attribute can be specified for
<CODE>CHAR</CODE>. It assigns the <CODE>ucs2</CODE> character set.

</P>
<P>
MySQL may silently change the type of a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE>
column at table creation time.
See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

</P>



<H3><A NAME="BLOB" HREF="manual_toc.html#BLOB">12.4.2  The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> Types</A></H3>

<P>
<A NAME="IDX1166"></A>
<A NAME="IDX1167"></A>
<A NAME="IDX1168"></A>

</P>
<P>
A <CODE>BLOB</CODE> is a binary large object that can hold a variable amount of
data.  The four <CODE>BLOB</CODE> types, <CODE>TINYBLOB</CODE>, <CODE>BLOB</CODE>,
<CODE>MEDIUMBLOB</CODE>, and <CODE>LONGBLOB</CODE>, differ only in the maximum length of
the values they can hold.
See section <A HREF="manual.html#Storage_requirements">12.5  Column Type Storage Requirements</A>.

</P>
<P>
The four <CODE>TEXT</CODE> types, <CODE>TINYTEXT</CODE>, <CODE>TEXT</CODE>, <CODE>MEDIUMTEXT</CODE>,
and <CODE>LONGTEXT</CODE>, correspond to the four <CODE>BLOB</CODE> types and have
the same maximum lengths and storage requirements.

</P>
<P>
<CODE>BLOB</CODE> columns are treated as binary strings, whereas <CODE>TEXT</CODE>
columns are treated according to their character set.  Sorting and comparison
for <CODE>BLOB</CODE> values is not case sensitive.  As of MySQL 4.1, values in
<CODE>TEXT</CODE> columns are sorted and compared based on the collation of
the character set assigned to the column.  Before MySQL 4.1, <CODE>TEXT</CODE>
sorting and comparison are based on the collation of the server character set.

</P>
<P>
No lettercase conversion takes place during storage or retrieval.

</P>
<P>
If you assign a value to a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column that exceeds
the column type's maximum length, the value is truncated to fit.

</P>
<P>
In most respects, you can regard a <CODE>TEXT</CODE> column as a <CODE>VARCHAR</CODE>
column that can be as big as you like.  Similarly, you can regard a
<CODE>BLOB</CODE> column as a <CODE>VARCHAR BINARY</CODE> column.  The ways in which
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> differ from <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> are:

</P>

<UL>
<LI>

You can have indexes on <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns only as of
MySQL 3.23.2. Older versions of MySQL did not support indexing these column
types.

<LI>

For indexes on <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns, you must specify an index
prefix length. For <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE>, a prefix length is
optional:

<LI>

There is no trailing-space removal for <CODE>BLOB</CODE> and <CODE>TEXT</CODE>
columns when values are stored or retrieved. This differs from <CODE>CHAR</CODE>
columns (trailing spaces are removed when values are retrieved) and from
<CODE>VARCHAR</CODE> columns (trailing spaces are removed when values are stored).

<LI>

<A NAME="IDX1169"></A>
<A NAME="IDX1170"></A>
<A NAME="IDX1171"></A>
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns cannot have <CODE>DEFAULT</CODE> values.
</UL>

<P>
From version 4.1.0, <CODE>LONG</CODE> and <CODE>LONG VARCHAR</CODE> map to the
<CODE>MEDIUMTEXT</CODE> data type. This is a compatibility feature.

</P>
<P>
Connector/ODBC defines <CODE>BLOB</CODE> values as <CODE>LONGVARBINARY</CODE> and
<CODE>TEXT</CODE> values as <CODE>LONGVARCHAR</CODE>.

</P>
<P>
Because <CODE>BLOB</CODE> and <CODE>TEXT</CODE> values may be extremely long, you
may encounter some constraints in using them:

</P>

<UL>
<LI>

If you want to use <CODE>GROUP BY</CODE> or <CODE>ORDER BY</CODE> on a <CODE>BLOB</CODE> or
<CODE>TEXT</CODE> column, you must convert the column value into a fixed-length
object. The standard way to do this is with the <CODE>SUBSTRING</CODE>
function.  For example:


<PRE>
mysql&#62; SELECT comment FROM tbl_name,SUBSTRING(comment,20) AS substr
    -&#62;                 ORDER BY substr;
</PRE>

If you don't do this, only the first <CODE>max_sort_length</CODE> bytes of the
column are used when sorting.  The default value of <CODE>max_sort_length</CODE>
is 1024; this value can be changed using the <CODE>--max_sort_length</CODE>
option when starting the <CODE>mysqld</CODE> server.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

You can group on an expression involving <CODE>BLOB</CODE> or
<CODE>TEXT</CODE> values by using an alias or by specifying the column position:


<PRE>
mysql&#62; SELECT id,SUBSTRING(blob_col,1,100) AS b
    -&#62; FROM tbl_name GROUP BY b;
mysql&#62; SELECT id,SUBSTRING(blob_col,1,100)
    -&#62; FROM tbl_name GROUP BY 2;
</PRE>

<LI>

The maximum size of a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> object is determined by its
type, but the largest value you actually can transmit between the client and
server is determined by the amount of available memory and the size of the
communications buffers.  You can change the message buffer size by changing
the value of the
<CODE>max_allowed_packet</CODE> variable, but you must
do so for both the server and your client program.
For example, both <CODE>mysql</CODE> and <CODE>mysqldump</CODE> allow you to change the
client-side
<CODE>max_allowed_packet</CODE> value.
See
section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>,
section <A HREF="manual.html#mysql">8.3  <CODE>mysql</CODE>, the Command-Line Tool</A>,
and
section <A HREF="manual.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A>.
</UL>

<P>
Note that each <CODE>BLOB</CODE> or <CODE>TEXT</CODE> value is represented
internally by a separately allocated object. This is in contrast to all
other column types, for which storage is allocated once per column when
the table is opened.

</P>



<H3><A NAME="ENUM" HREF="manual_toc.html#ENUM">12.4.3  The <CODE>ENUM</CODE> Type</A></H3>

<P>
<A NAME="IDX1172"></A>

</P>
<P>
An <CODE>ENUM</CODE> is a string object with a value chosen from a list
of allowed values that are enumerated explicitly in the column specification
at table creation time.

</P>
<P>
The value may also be the empty string (<CODE>''</CODE>) or <CODE>NULL</CODE> under
certain circumstances:

</P>

<UL>
<LI>

If you insert an invalid value into an <CODE>ENUM</CODE> (that is, a string not
present in the list of allowed values), the empty string is inserted
instead as a special error value. This string can be distinguished from a
``normal'' empty string by the fact that this string has the numerical value
0. More about this later.

<LI>

If an <CODE>ENUM</CODE> column is declared to allow <CODE>NULL</CODE>, the <CODE>NULL</CODE>
value is a legal value for the column, and the default value is <CODE>NULL</CODE>.
If an <CODE>ENUM</CODE> column is declared <CODE>NOT NULL</CODE>, its default value
is the first element of the list of allowed values.
</UL>

<P>
Each enumeration value has an index:

</P>

<UL>
<LI>

Values from the list of allowable elements in the column specification are
numbered beginning with 1.

<LI>

The index value of the empty string error value is 0.  This means that you
can use the following <CODE>SELECT</CODE> statement to find rows into which invalid
<CODE>ENUM</CODE> values were assigned:


<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE enum_col=0;
</PRE>

<LI>

The index of the <CODE>NULL</CODE> value is <CODE>NULL</CODE>.
</UL>

<P>
For example, a column specified as <CODE>ENUM('one', 'two', 'three')</CODE> can
have any of the values shown here.  The index of each value is also shown:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Value</STRONG> </TD><TD> <STRONG>Index</STRONG>
</TD></TR>
<TR><TD><CODE>NULL</CODE> </TD><TD> <CODE>NULL</CODE>
</TD></TR>
<TR><TD><CODE>''</CODE> </TD><TD> 0
</TD></TR>
<TR><TD><CODE>'one'</CODE> </TD><TD> 1
</TD></TR>
<TR><TD><CODE>'two'</CODE> </TD><TD> 2
</TD></TR>
<TR><TD><CODE>'three'</CODE> </TD><TD> 3
</TD></TR>
</TABLE>

<P>
An enumeration can have a maximum of 65,535 elements.

</P>
<P>
Starting from MySQL 3.23.51, trailing spaces are automatically deleted from
<CODE>ENUM</CODE> values when the table is created.

</P>
<P>
Lettercase is irrelevant when you assign values to an <CODE>ENUM</CODE> column.
However, values retrieved from the column later are displayed using the
lettercase that was used in the column definition.

</P>
<P>
If you retrieve an <CODE>ENUM</CODE> value in a numeric context, the column value's
index is returned.  For example, you can retrieve numeric values from
an <CODE>ENUM</CODE> column like this:

</P>

<PRE>
mysql&#62; SELECT enum_col+0 FROM tbl_name;
</PRE>

<P>
If you store a number into an <CODE>ENUM</CODE> column, the number is treated as an
index, and the value stored is the enumeration member with that index.
(However, this will not work with <CODE>LOAD DATA</CODE>, which treats all
input as strings.)
It's not advisable to define an <CODE>ENUM</CODE> column with enumeration values
that look like numbers, because this can easily become confusing. For example,
the following column has enumeration members with string values of
<CODE>'0'</CODE>, <CODE>'1'</CODE>, and <CODE>'2'</CODE>,
but numeric index values of
<CODE>1</CODE>, <CODE>2</CODE>, and <CODE>3</CODE>:

</P>

<PRE>
numbers ENUM('0','1','2')
</PRE>

<P>
<CODE>ENUM</CODE> values are sorted according to the order in which the enumeration
members were listed in the column specification.  (In other words,
<CODE>ENUM</CODE> values are sorted according to their index numbers.)  For
example, <CODE>'a'</CODE> sorts before <CODE>'b'</CODE> for <CODE>ENUM('a', 'b')</CODE>, but
<CODE>'b'</CODE> sorts before <CODE>'a'</CODE> for <CODE>ENUM('b', 'a')</CODE>.  The empty
string sorts before non-empty strings, and <CODE>NULL</CODE> values sort before
all other enumeration values.
To prevent unexpected results, specify the <CODE>ENUM</CODE> list in alphabetical
order. You can also use <CODE>GROUP BY CAST(col AS VARCHAR)</CODE> or
<CODE>GROUP BY CONCAT(col)</CODE> to make sure that the column
is sorted lexically rather than by index number.

</P>
<P>
If you want to determine all possible values for an <CODE>ENUM</CODE> column,
use <CODE>SHOW COLUMNS FROM tbl_name LIKE enum_col</CODE> and parse
the <CODE>ENUM</CODE> definition in the second column of the output.

</P>



<H3><A NAME="SET" HREF="manual_toc.html#SET">12.4.4  The <CODE>SET</CODE> Type</A></H3>

<P>
<A NAME="IDX1173"></A>

</P>
<P>
A <CODE>SET</CODE> is a string object that can have zero or more values, each of
which must be chosen from a list of allowed values specified when the table
is created.  <CODE>SET</CODE> column values that consist of multiple set members
are specified with members separated by commas (<SAMP>`,'</SAMP>).  A consequence of
this is that <CODE>SET</CODE> member values cannot themselves contain commas.

</P>
<P>
For example, a column specified as <CODE>SET('one', 'two') NOT NULL</CODE> can have
any of these values:

</P>

<PRE>
''
'one'
'two'
'one,two'
</PRE>

<P>
A <CODE>SET</CODE> can have a maximum of 64 different members.

</P>
<P>
Starting from 3.23.51, trailing spaces are automatically deleted from
<CODE>SET</CODE> values when the table is created.

</P>
<P>
MySQL stores <CODE>SET</CODE> values numerically, with the low-order bit
of the stored value corresponding to the first set member.  If you retrieve a
<CODE>SET</CODE> value in a numeric context, the value retrieved has bits set
corresponding to the set members that make up the column value.  For example,
you can retrieve numeric values from a <CODE>SET</CODE> column like this:

</P>

<PRE>
mysql&#62; SELECT set_col+0 FROM tbl_name;
</PRE>

<P>
If a number is stored into a <CODE>SET</CODE> column, the bits that
are set in the binary representation of the number determine the
set members in the column value.  For a column specified as
<CODE>SET('a','b','c','d')</CODE>, the members have the following decimal and
binary values:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>SET</CODE> <STRONG>Member</STRONG> </TD><TD> <STRONG>Decimal Value</STRONG> </TD><TD> <STRONG>Binary Value</STRONG>
</TD></TR>
<TR><TD><CODE>'a'</CODE> </TD><TD> <CODE>1</CODE> </TD><TD> <CODE>0001</CODE>
</TD></TR>
<TR><TD><CODE>'b'</CODE> </TD><TD> <CODE>2</CODE> </TD><TD> <CODE>0010</CODE>
</TD></TR>
<TR><TD><CODE>'c'</CODE> </TD><TD> <CODE>4</CODE> </TD><TD> <CODE>0100</CODE>
</TD></TR>
<TR><TD><CODE>'d'</CODE> </TD><TD> <CODE>8</CODE> </TD><TD> <CODE>1000</CODE>
</TD></TR>
</TABLE>

<P>
If you assign a value of <CODE>9</CODE> to this column, that is <CODE>1001</CODE> in
binary, so the first and fourth <CODE>SET</CODE> value members <CODE>'a'</CODE> and
<CODE>'d'</CODE> are selected and the resulting value is <CODE>'a,d'</CODE>.

</P>
<P>
For a value containing more than one <CODE>SET</CODE> element, it does not matter
what order the elements are listed in when you insert the value.  It also
does not matter how many times a given element is listed in the value.
When the value is retrieved later, each element in the value will appear
once, with elements listed according to the order in which they were
specified at table creation time.  If a column is specified as
<CODE>SET('a','b','c','d')</CODE>, then <CODE>'a,d'</CODE>, <CODE>'d,a'</CODE>, and
<CODE>'d,a,a,d,d'</CODE> all will appear as <CODE>'a,d'</CODE> when retrieved.

</P>
<P>
If you set a <CODE>SET</CODE> column to an unsupported value, the value will
be ignored.

</P>
<P>
<CODE>SET</CODE> values are sorted numerically.  <CODE>NULL</CODE> values sort before
non-<CODE>NULL</CODE> <CODE>SET</CODE> values.

</P>
<P>
Normally, you perform a <CODE>SELECT</CODE> on a <CODE>SET</CODE> column using
the <CODE>FIND_IN_SET()</CODE> function or the <CODE>LIKE</CODE> operator:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE FIND_IN_SET('value',set_col)&#62;0;
mysql&#62; SELECT * FROM tbl_name WHERE set_col LIKE '%value%';
</PRE>

<P>
The first statement finds rows where <CODE>set_col</CODE> contains the
<CODE>value</CODE> set member. The second is similar, but not the same:
It finds rows where <CODE>set_col</CODE> contains <CODE>value</CODE> anywhere, even as a
substring of another set member.

</P>
<P>
The following statements also are legal:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE set_col &#38; 1;
mysql&#62; SELECT * FROM tbl_name WHERE set_col = 'val1,val2';
</PRE>

<P>
The first of these statements looks for values containing the first set
member.  The second looks for an exact match. Be careful with comparisons
of the second type. Comparing set values to <CODE>'val1,val2'</CODE> will
return different results than comparing values to <CODE>'val2,val1'</CODE>.
You should specify the values in the same order they are listed in the
column definition.

</P>
<P>
If you want to determine all possible values for a <CODE>SET</CODE> column,
use <CODE>SHOW COLUMNS FROM tbl_name LIKE set_col</CODE> and parse
the <CODE>SET</CODE> definition in the second column of the output.

</P>



<H2><A NAME="Storage_requirements" HREF="manual_toc.html#Storage_requirements">12.5  Column Type Storage Requirements</A></H2>

<P>
<A NAME="IDX1174"></A>
<A NAME="IDX1175"></A>

</P>
<P>
The storage requirements for each of the column types supported by
MySQL are listed by category.

</P>
<P>
<A NAME="IDX1176"></A>
The maximum size of a row in a <CODE>MyISAM</CODE> table is 65,534 bytes. Each 
<CODE>BLOB</CODE> and <CODE>TEXT</CODE> column accounts for only five to nine bytes 
toward this size.

</P>
<P>
If a <CODE>MyISAM</CODE> or <CODE>ISAM</CODE> table includes any variable-length column
types, the record format will also be variable length.  When a table
is created, MySQL may, under certain conditions, change a column from a
variable-length type to a fixed-length type or vice versa.  See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

</P>
<P>
<A NAME="IDX1177"></A>
<A NAME="IDX1178"></A>

</P>

<H3>12.5.1  Storage Requirements for Numeric Types</H3>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Type</STRONG> </TD><TD> <STRONG>Storage Required</STRONG>
</TD></TR>
<TR><TD><CODE>TINYINT</CODE> </TD><TD> 1 byte
</TD></TR>
<TR><TD><CODE>SMALLINT</CODE> </TD><TD> 2 bytes
</TD></TR>
<TR><TD><CODE>MEDIUMINT</CODE> </TD><TD> 3 bytes
</TD></TR>
<TR><TD><CODE>INT</CODE>, <CODE>INTEGER</CODE> </TD><TD> 4 bytes
</TD></TR>
<TR><TD><CODE>BIGINT</CODE> </TD><TD> 8 bytes
</TD></TR>
<TR><TD><CODE>FLOAT(p)</CODE> </TD><TD> 4 bytes if 0 &#60;= p &#60;= 24, 8 bytes if 25 &#60;= p &#60;= 53
</TD></TR>
<TR><TD><CODE>FLOAT</CODE> </TD><TD> 4 bytes
</TD></TR>
<TR><TD><CODE>DOUBLE [PRECISION]</CODE>, item <CODE>REAL</CODE> </TD><TD> 8 bytes
</TD></TR>
<TR><TD><CODE>DECIMAL(M,D)</CODE>, <CODE>NUMERIC(M,D)</CODE> </TD><TD> <CODE>M+2</CODE> bytes if D &#62; 0, <CODE>M+1</CODE> bytes if D = 0 (<CODE>D</CODE>+2, if <CODE>M &#60; D</CODE>)
</TD></TR>
</TABLE>

<P>
<A NAME="IDX1179"></A>
<A NAME="IDX1180"></A>
<A NAME="IDX1181"></A>
<A NAME="IDX1182"></A>

</P>

<H3>12.5.2  Storage Requirements for Date and Time Types</H3>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Type</STRONG> </TD><TD> <STRONG>Storage Required</STRONG>
</TD></TR>
<TR><TD><CODE>DATE</CODE> </TD><TD> 3 bytes
</TD></TR>
<TR><TD><CODE>DATETIME</CODE> </TD><TD> 8 bytes
</TD></TR>
<TR><TD><CODE>TIMESTAMP</CODE> </TD><TD> 4 bytes
</TD></TR>
<TR><TD><CODE>TIME</CODE> </TD><TD> 3 bytes
</TD></TR>
<TR><TD><CODE>YEAR</CODE> </TD><TD> 1 byte
</TD></TR>
</TABLE>


<H3>12.5.3  Storage Requirements for String Types</H3>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column Type</STRONG> </TD><TD> <STRONG>Storage Required</STRONG>
</TD></TR>
<TR><TD><CODE>CHAR(M)</CODE> </TD><TD> <CODE>M</CODE> bytes, 0 <CODE>&#60;= M &#60;=</CODE> 255
</TD></TR>
<TR><TD><CODE>VARCHAR(M)</CODE> </TD><TD> <CODE>L</CODE>+1 bytes, where <CODE>L &#60;= M</CODE> and
0 <CODE>&#60;= M &#60;=</CODE> 255
</TD></TR>
<TR><TD><CODE>TINYBLOB</CODE>, <CODE>TINYTEXT</CODE> </TD><TD> <CODE>L</CODE>+1 bytes,
where <CODE>L</CODE> &#60; 2^8
</TD></TR>
<TR><TD><CODE>BLOB</CODE>, <CODE>TEXT</CODE> </TD><TD> <CODE>L</CODE>+2 bytes,
where <CODE>L</CODE> &#60; 2^16
</TD></TR>
<TR><TD><CODE>MEDIUMBLOB</CODE>, <CODE>MEDIUMTEXT</CODE> </TD><TD> <CODE>L</CODE>+3 bytes,
where <CODE>L</CODE> &#60; 2^24
</TD></TR>
<TR><TD><CODE>LONGBLOB</CODE>, <CODE>LONGTEXT</CODE> </TD><TD> <CODE>L</CODE>+4 bytes,
where <CODE>L</CODE> &#60; 2^32
</TD></TR>
<TR><TD><CODE>ENUM('value1','value2',...)</CODE> </TD><TD> 1 or 2 bytes, depending on
the number of enumeration values (65,535 values maximum)
</TD></TR>
<TR><TD><CODE>SET('value1','value2',...)</CODE> </TD><TD> 1, 2, 3, 4, or 8 bytes, depending
on the number of set members (64 members maximum)
</TD></TR>
</TABLE>

<P>
<A NAME="IDX1183"></A>
<A NAME="IDX1184"></A>
<A NAME="IDX1185"></A>

</P>
<P>
<CODE>VARCHAR</CODE> and the <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types are variable-length
types. For each, the storage requirements depend on the actual length of
column values (represented by <CODE>L</CODE> in the preceding table), rather than
on the type's maximum possible size.  For example, a <CODE>VARCHAR(10)</CODE>
column can hold a string with a maximum length of 10 characters.  The actual
storage required is the length of the string (<CODE>L</CODE>), plus 1 byte to
record the length of the string.  For the string <CODE>'abcd'</CODE>, <CODE>L</CODE> is 4
and the storage requirement is 5 bytes.

</P>
<P>
The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> types require 1, 2, 3, or 4 bytes to record
the length of the column value, depending on the maximum possible length of
the type.  See section <A HREF="manual.html#BLOB">12.4.2  The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> Types</A>.

</P>
<P>
<A NAME="IDX1186"></A>
The size of an <CODE>ENUM</CODE> object is determined by the number of
different enumeration values.  One byte is used for enumerations with up
to 255 possible values.  Two bytes are used for enumerations with up to
65,535 values. See section <A HREF="manual.html#ENUM">12.4.3  The <CODE>ENUM</CODE> Type</A>.

</P>
<P>
<A NAME="IDX1187"></A>
The size of a <CODE>SET</CODE> object is determined by the number of different
set members.  If the set size is <CODE>N</CODE>, the object occupies <CODE>(N+7)/8</CODE>
bytes, rounded up to 1, 2, 3, 4, or 8 bytes.  A <CODE>SET</CODE> can have a maximum
of 64 members. See section <A HREF="manual.html#SET">12.4.4  The <CODE>SET</CODE> Type</A>.

</P>



<H2><A NAME="Choosing_types" HREF="manual_toc.html#Choosing_types">12.6  Choosing the Right Type for a Column</A></H2>

<P>
<A NAME="IDX1188"></A>
<A NAME="IDX1189"></A>

</P>
<P>
For the most efficient use of storage, try to use the most precise type in
all cases. For example, if an integer column will be used for values in the
range from <CODE>1</CODE> to <CODE>99999</CODE>, <CODE>MEDIUMINT UNSIGNED</CODE> is the
best type.  Of the types that represent all the required values, it uses
the least amount of storage.

</P>
<P>
Accurate representation of monetary values is a common problem. In MySQL,
you should use the <CODE>DECIMAL</CODE> type. This is stored as a string, so no
loss of accuracy should occur.  (Calculations on <CODE>DECIMAL</CODE> values may
still be done using double-precision operations, however.)  If accuracy
is not too important, the <CODE>DOUBLE</CODE> type may also be good enough.

</P>
<P>
For high precision, you can always convert to a fixed-point type stored
in a <CODE>BIGINT</CODE>. This allows you to do all calculations with integers
and convert results back to floating-point values only when necessary.

</P>



<H2><A NAME="Other-vendor_column_types" HREF="manual_toc.html#Other-vendor_column_types">12.7  Using Column Types from Other Database Engines</A></H2>

<P>
<A NAME="IDX1190"></A>
<A NAME="IDX1191"></A>
<A NAME="IDX1192"></A>

</P>
<P>
To make it easier to use code written for SQL implementations from other
vendors, MySQL maps column types as shown in the following table.  These
mappings make it easier to import table definitions from other database engines
into MySQL:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Other Vendor Type</STRONG> </TD><TD> <STRONG>MySQL Type</STRONG>
</TD></TR>
<TR><TD><CODE>BINARY(M)</CODE> </TD><TD> <CODE>CHAR(M) BINARY</CODE>
</TD></TR>
<TR><TD><CODE>CHAR VARYING(M)</CODE> </TD><TD> <CODE>VARCHAR(M)</CODE>
</TD></TR>
<TR><TD><CODE>FLOAT4</CODE> </TD><TD> <CODE>FLOAT</CODE>
</TD></TR>
<TR><TD><CODE>FLOAT8</CODE> </TD><TD> <CODE>DOUBLE</CODE>
</TD></TR>
<TR><TD><CODE>INT1</CODE> </TD><TD> <CODE>TINYINT</CODE>
</TD></TR>
<TR><TD><CODE>INT2</CODE> </TD><TD> <CODE>SMALLINT</CODE>
</TD></TR>
<TR><TD><CODE>INT3</CODE> </TD><TD> <CODE>MEDIUMINT</CODE>
</TD></TR>
<TR><TD><CODE>INT4</CODE> </TD><TD> <CODE>INT</CODE>
</TD></TR>
<TR><TD><CODE>INT8</CODE> </TD><TD> <CODE>BIGINT</CODE>
</TD></TR>
<TR><TD><CODE>LONG VARBINARY</CODE> </TD><TD> <CODE>MEDIUMBLOB</CODE>
</TD></TR>
<TR><TD><CODE>LONG VARCHAR</CODE> </TD><TD> <CODE>MEDIUMTEXT</CODE>
</TD></TR>
<TR><TD><CODE>LONG</CODE> </TD><TD> <CODE>MEDIUMTEXT</CODE> (MySQL 4.1.0 on)
</TD></TR>
<TR><TD><CODE>MIDDLEINT</CODE> </TD><TD> <CODE>MEDIUMINT</CODE>
</TD></TR>
<TR><TD><CODE>VARBINARY(M)</CODE> </TD><TD> <CODE>VARCHAR(M) BINARY</CODE>
</TD></TR>
</TABLE>

<P>
Column type mapping occurs at table creation time, after which the original
type specifications are discarded.  If you create a table with types used
by other vendors and then issue a <CODE>DESCRIBE tbl_name</CODE> statement,
MySQL reports the table structure using the equivalent MySQL types.

</P>



<H1><A NAME="Functions" HREF="manual_toc.html#Functions">13  Functions and Operators</A></H1>

<P>
<A NAME="IDX1193"></A>
<A NAME="IDX1194"></A>
<A NAME="IDX1195"></A>

</P>

<P>
Expressions can be used at several points in SQL statements, such as in the
<CODE>ORDER BY</CODE> or <CODE>HAVING</CODE> clauses of <CODE>SELECT</CODE> statements, in the
<CODE>WHERE</CODE> clause of a <CODE>SELECT</CODE>, <CODE>DELETE</CODE>, or <CODE>UPDATE</CODE>
statement, or in <CODE>SET</CODE> statements.  Expressions can be written using
literal values, column values, <CODE>NULL</CODE>, functions, and operators.
This chapter describes the functions and operators that are allowed for
writing expressions in MySQL.

</P>
<P>
An expression that contains <CODE>NULL</CODE> always produces a <CODE>NULL</CODE> value
unless otherwise indicated in the documentation for a particular function or
operator.

</P>
<P>
<STRONG>Note:</STRONG> By default, there must be no whitespace between a function
name and the parenthesis following it. This helps the MySQL parser
distinguish between function calls and references to tables or columns that
happen to have the same name as a function.  Spaces around function
arguments are permitted, though.

</P>
<P>
You can tell the MySQL server to accept spaces after function names by
starting it with the <CODE>--sql-mode=IGNORE_SPACE</CODE> option. Individual client
programs can request this behavior by using the
<CODE>CLIENT_IGNORE_SPACE</CODE> option for <CODE>mysql_real_connect()</CODE>.
In either case, all function names will become reserved words.
See section <A HREF="manual.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

</P>
<P>
For the sake of brevity, most examples in this chapter display the output
from the <CODE>mysql</CODE> program in abbreviated form.  Instead of showing
examples in this format:

</P>

<PRE>
mysql&#62; SELECT MOD(29,9);
+-----------+
| mod(29,9) |
+-----------+
|         2 |
+-----------+
1 rows in set (0.00 sec)
</PRE>

<P>
This format is used instead:

</P>

<PRE>
mysql&#62; SELECT MOD(29,9);
        -&#62; 2
</PRE>



<H2><A NAME="Non-typed_Operators" HREF="manual_toc.html#Non-typed_Operators">13.1  Operators</A></H2>



<H3><A NAME="Parentheses" HREF="manual_toc.html#Parentheses">13.1.1  Parentheses</A></H3>

<P>
<A NAME="IDX1196"></A>
<A NAME="IDX1197"></A>

</P>
<P>
<A NAME="IDX1198"></A>
<A NAME="IDX1199"></A>

</P>
<DL COMPACT>

<DT><CODE>( ... )</CODE>
<DD>
Use parentheses to force the order of evaluation in an expression.  For
example:


<PRE>
mysql&#62; SELECT 1+2*3;
        -&#62; 7
mysql&#62; SELECT (1+2)*3;
        -&#62; 9
</PRE>

</DL>



<H3><A NAME="Comparison_Operators" HREF="manual_toc.html#Comparison_Operators">13.1.2  Comparison Operators</A></H3>

<P>
<A NAME="IDX1200"></A>

</P>
<P>
<A NAME="IDX1201"></A>
<A NAME="IDX1202"></A>

</P>
<P>
Comparison operations result in a value of <CODE>1</CODE> (TRUE), <CODE>0</CODE> (FALSE),
or <CODE>NULL</CODE>. These operations work for both numbers and strings.  Strings
are automatically converted to numbers and numbers to strings as necessary.

</P>
<P>
MySQL performs comparisons using the following
rules:

</P>

<UL>
<LI>

If one or both arguments are <CODE>NULL</CODE>, the result of the comparison is
<CODE>NULL</CODE>, except for the <CODE>NULL</CODE>-safe <CODE>&#60;=&#62;</CODE> equality comparison
operator.

<LI>

If both arguments in a comparison operation are strings, they are compared as
strings.

<LI>

If both arguments are integers, they are compared as integers.

<LI>

Hexadecimal values are treated as binary strings if not compared to a number.

<LI>

<A NAME="IDX1203"></A>
<A NAME="IDX1204"></A>
If one of the arguments is a <CODE>TIMESTAMP</CODE> or <CODE>DATETIME</CODE> column and
the other argument is a constant, the constant is converted
to a timestamp before the comparison is performed. This is done to be more
ODBC-friendly. Note that the is not done for arguments in <CODE>IN()</CODE>!
To be safe, always use complete datetime/date/time string when doing
comparisons.

<LI>

In all other cases, the arguments are compared as floating-point (real)
numbers.
</UL>

<P>
By default, string comparisons are not case sensitive and use the
current character set (ISO-8859-1 Latin1 by default, which also works
excellently for English).

</P>
<P>
The following examples illustrate conversion of strings to numbers for comparison
operations:

</P>

<PRE>
mysql&#62; SELECT 1 &#62; '6x';
        -&#62; 0
mysql&#62; SELECT 7 &#62; '6x';
        -&#62; 1
mysql&#62; SELECT 0 &#62; 'x6';
        -&#62; 0
mysql&#62; SELECT 0 = 'x6';
        -&#62; 1
</PRE>

<P>
Note that when you are comparing a string column with a number, MySQL can't
use an index on the column to quickly look up the value.  If <CODE>str_col</CODE>
is an indexed string column, the index cannot be used when performing the
lookup in the following statement:

</P>

<PRE>
SELECT * FROM tbl_name WHERE str_col=1;
</PRE>

<P>
The reason for this is that there are many different strings that may
convert to the value <CODE>1</CODE>:  <CODE>'1'</CODE>, <CODE>' 1'</CODE>, <CODE>'1a'</CODE> ...

</P>
<DL COMPACT>

<DT><CODE>=</CODE>
<DD>
<A NAME="IDX1205"></A>
<A NAME="IDX1206"></A>
Equal:


<PRE>
mysql&#62; SELECT 1 = 0;
        -&#62; 0
mysql&#62; SELECT '0' = 0;
        -&#62; 1
mysql&#62; SELECT '0.0' = 0;
        -&#62; 1
mysql&#62; SELECT '0.01' = 0;
        -&#62; 0
mysql&#62; SELECT '.01' = 0.01;
        -&#62; 1
</PRE>

<DT><CODE>&#60;=&#62;</CODE>
<DD>
<A NAME="IDX1207"></A>
<A NAME="IDX1208"></A>
<CODE>NULL</CODE>-safe equal.
This operator performs an equality comparison like the <CODE>=</CODE> operator, but
returns <CODE>1</CODE> rather than <CODE>NULL</CODE> if both operands are <CODE>NULL</CODE>,
and <CODE>0</CODE> rather than <CODE>NULL</CODE> if one operand is <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT 1 &#60;=&#62; 1, NULL &#60;=&#62; NULL, 1 &#60;=&#62; NULL;
        -&#62; 1, 1, 0
mysql&#62; SELECT 1 = 1, NULL = NULL, 1 = NULL;
        -&#62; 1, NULL, NULL
</PRE>

<CODE>&#60;=&#62;</CODE> was added in MySQL 3.23.0.

<DT><CODE>&#60;&#62;</CODE>
<DD>
<DT><CODE>!=</CODE>
<DD>
<A NAME="IDX1209"></A>
<A NAME="IDX1210"></A>
<A NAME="IDX1211"></A>
<A NAME="IDX1212"></A>
Not equal:


<PRE>
mysql&#62; SELECT '.01' &#60;&#62; '0.01';
        -&#62; 1
mysql&#62; SELECT .01 &#60;&#62; '0.01';
        -&#62; 0
mysql&#62; SELECT 'zapp' &#60;&#62; 'zappp';
        -&#62; 1
</PRE>

<DT><CODE>&#60;=</CODE>
<DD>
<A NAME="IDX1213"></A>
<A NAME="IDX1214"></A>
Less than or equal:


<PRE>
mysql&#62; SELECT 0.1 &#60;= 2;
        -&#62; 1
</PRE>

<DT><CODE>&#60;</CODE>
<DD>
<A NAME="IDX1215"></A>
<A NAME="IDX1216"></A>
Less than:


<PRE>
mysql&#62; SELECT 2 &#60; 2;
        -&#62; 0
</PRE>

<DT><CODE>&#62;=</CODE>
<DD>
<A NAME="IDX1217"></A>
<A NAME="IDX1218"></A>
Greater than or equal:


<PRE>
mysql&#62; SELECT 2 &#62;= 2;
        -&#62; 1
</PRE>

<DT><CODE>&#62;</CODE>
<DD>
<A NAME="IDX1219"></A>
<A NAME="IDX1220"></A>
Greater than:


<PRE>
mysql&#62; SELECT 2 &#62; 2;
        -&#62; 0
</PRE>

<DT><CODE>IS NULL</CODE>
<DD>
<DT><CODE>IS NOT NULL</CODE>
<DD>
<A NAME="IDX1221"></A>
<A NAME="IDX1222"></A>
<A NAME="IDX1223"></A>
Tests whether a value is or is not <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT 1 IS NULL, 0 IS NULL, NULL IS NULL;
        -&#62; 0, 0, 1
mysql&#62; SELECT 1 IS NOT NULL, 0 IS NOT NULL, NULL IS NOT NULL;
        -&#62; 1, 1, 0
</PRE>

<A NAME="IDX1224"></A>
<A NAME="IDX1225"></A>
To be able to work well with ODBC programs, MySQL supports the following
extra features when using <CODE>IS NULL</CODE>:


<UL>
<LI>

You can find the row that contains the most recent <CODE>AUTO_INCREMENT</CODE> value
by issuing a statement of the following form immediately after generating the
value:


<PRE>
SELECT * FROM tbl_name WHERE auto_col IS NULL
</PRE>

This behavior can be disabled by setting <CODE>SQL_AUTO_IS_NULL=0</CODE>.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<LI>

For <CODE>DATE</CODE> and <CODE>DATETIME</CODE> columns that are declared as <CODE>NOT
NULL</CODE>, you can find the special date <CODE>'0000-00-00'</CODE> by using a statement
like this:


<PRE>
SELECT * FROM tbl_name WHERE date_column IS NULL
</PRE>

This is needed to get some ODBC applications to work because ODBC doesn't
support a <CODE>'0000-00-00'</CODE> date value.

</UL>

<DT><CODE>expr BETWEEN min AND max</CODE>
<DD>
<A NAME="IDX1226"></A>
If <CODE>expr</CODE> is greater than or equal to <CODE>min</CODE> and <CODE>expr</CODE> is
less than or equal to <CODE>max</CODE>, <CODE>BETWEEN</CODE> returns <CODE>1</CODE>,
otherwise it returns <CODE>0</CODE>.  This is equivalent to the expression
<CODE>(min &#60;= expr AND expr &#60;= max)</CODE> if all the arguments are of the
same type. Otherwise type conversion takes place, according to the rules
described at the beginning of this section, but applied to all the three
arguments. <STRONG>Note:</STRONG> Before MySQL
4.0.5, arguments were converted to the type of <CODE>expr</CODE> instead.


<PRE>
mysql&#62; SELECT 1 BETWEEN 2 AND 3;
        -&#62; 0
mysql&#62; SELECT 'b' BETWEEN 'a' AND 'c';
        -&#62; 1
mysql&#62; SELECT 2 BETWEEN 2 AND '3';
        -&#62; 1
mysql&#62; SELECT 2 BETWEEN 2 AND 'x-3';
        -&#62; 0
</PRE>

<DT><CODE>expr NOT BETWEEN min AND max</CODE>
<DD>
<A NAME="IDX1227"></A>
This is the same as <CODE>NOT (expr BETWEEN min AND max)</CODE>.

<DT><CODE>COALESCE(value,...)</CODE>
<DD>
<A NAME="IDX1228"></A>
<A NAME="IDX1229"></A>
Returns the first non-<CODE>NULL</CODE> value in the list.


<PRE>
mysql&#62; SELECT COALESCE(NULL,1);
        -&#62; 1
mysql&#62; SELECT COALESCE(NULL,NULL,NULL);
        -&#62; NULL
</PRE>

<CODE>COALESCE()</CODE> was added in MySQL 3.23.3.

<DT><CODE>GREATEST(value1,value2,...)</CODE>
<DD>
<A NAME="IDX1230"></A>
With two or more arguments, returns the largest (maximum-valued) argument.
The arguments are compared using the same rules as for <CODE>LEAST()</CODE>.


<PRE>
mysql&#62; SELECT GREATEST(2,0);
        -&#62; 2
mysql&#62; SELECT GREATEST(34.0,3.0,5.0,767.0);
        -&#62; 767.0
mysql&#62; SELECT GREATEST('B','A','C');
        -&#62; 'C'
</PRE>

Before MySQL 3.22.5, you can use <CODE>MAX()</CODE>
instead of <CODE>GREATEST()</CODE>.

<DT><CODE>expr IN (value,...)</CODE>
<DD>
<A NAME="IDX1231"></A>
Returns <CODE>1</CODE> if <CODE>expr</CODE> is any of the values in the <CODE>IN</CODE> list,
else returns <CODE>0</CODE>.  If all values are constants, they are
evaluated according to the type of <CODE>expr</CODE> and sorted. The search for the
item then is done using a binary search. This means <CODE>IN</CODE> is very quick
if the <CODE>IN</CODE> value list consists entirely of constants.  If <CODE>expr</CODE>
is a case-sensitive string expression, the string comparison is performed in
case-sensitive fashion.


<PRE>
mysql&#62; SELECT 2 IN (0,3,5,'wefwf');
        -&#62; 0
mysql&#62; SELECT 'wefwf' IN (0,3,5,'wefwf');
        -&#62; 1
</PRE>

The number of values in the <CODE>IN</CODE> list is only limited by the
<CODE>max_allowed_packet</CODE> value.

To comply with the SQL standard,
from MySQL 4.1 on
<CODE>IN</CODE> returns <CODE>NULL</CODE> 
not only if the expression on the left hand side is <CODE>NULL</CODE>, but also if
no match is found in the list and one of the expressions in the list is 
<CODE>NULL</CODE>.

From MySQL 4.1 on, <CODE>IN()</CODE> syntax also is used to write certain types of
subqueries.
See section <A HREF="manual.html#ANY_IN_SOME_subqueries">14.1.8.3  Subqueries with <CODE>ANY</CODE>, <CODE>IN</CODE>, and <CODE>SOME</CODE></A>.

<DT><CODE>expr NOT IN (value,...)</CODE>
<DD>
<A NAME="IDX1232"></A>
This is the same as <CODE>NOT (expr IN (value,...))</CODE>.

<DT><CODE>ISNULL(expr)</CODE>
<DD>
<A NAME="IDX1233"></A>
If <CODE>expr</CODE> is <CODE>NULL</CODE>, <CODE>ISNULL()</CODE> returns <CODE>1</CODE>, otherwise
it returns <CODE>0</CODE>.


<PRE>
mysql&#62; SELECT ISNULL(1+1);
        -&#62; 0
mysql&#62; SELECT ISNULL(1/0);
        -&#62; 1
</PRE>

Note that a comparison of <CODE>NULL</CODE> values using <CODE>=</CODE> will always be
false!

<DT><CODE>INTERVAL(N,N1,N2,N3,...)</CODE>
<DD>
<A NAME="IDX1234"></A>
Returns <CODE>0</CODE> if <CODE>N</CODE> &#60; <CODE>N1</CODE>, <CODE>1</CODE> if <CODE>N</CODE> &#60; <CODE>N2</CODE>
and so on or <CODE>-1</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>. All arguments are treated
as integers.  It is required that <CODE>N1</CODE> &#60; <CODE>N2</CODE> &#60; <CODE>N3</CODE> &#60; 
<CODE>...</CODE> &#60; <CODE>Nn</CODE> for this function to work correctly. This is because
a binary search is used (very fast).


<PRE>
mysql&#62; SELECT INTERVAL(23, 1, 15, 17, 30, 44, 200);
        -&#62; 3
mysql&#62; SELECT INTERVAL(10, 1, 10, 100, 1000);
        -&#62; 2
mysql&#62; SELECT INTERVAL(22, 23, 30, 44, 200);
        -&#62; 0
</PRE>

<DT><CODE>LEAST(value1,value2,...)</CODE>
<DD>
<A NAME="IDX1235"></A>
With two or more arguments, returns the smallest (minimum-valued) argument.
The arguments are compared using the following rules.


<UL>
<LI>

If the return value is used in an <CODE>INTEGER</CODE> context or all arguments
are integer-valued, they are compared as integers.

<LI>

If the return value is used in a <CODE>REAL</CODE> context or all arguments are
real-valued, they are compared as reals.

<LI>

If any argument is a case-sensitive string, the arguments are compared
as case-sensitive strings.

<LI>

In other cases, the arguments are compared as case-insensitive strings.
</UL>


<PRE>
mysql&#62; SELECT LEAST(2,0);
        -&#62; 0
mysql&#62; SELECT LEAST(34.0,3.0,5.0,767.0);
        -&#62; 3.0
mysql&#62; SELECT LEAST('B','A','C');
        -&#62; 'A'
</PRE>

Before MySQL 3.22.5, you can use <CODE>MIN()</CODE>
instead of <CODE>LEAST()</CODE>.

Note that the preceding conversion rules can produce strange results in some
borderline cases:


<PRE>
mysql&#62; SELECT CAST(LEAST(3600, 9223372036854775808.0) as SIGNED);
        -&#62; -9223372036854775808
</PRE>

This happens because MySQL reads <CODE>9223372036854775808.0</CODE> in an
integer context. The integer representation is not good enough to
hold the value, so it wraps to a signed integer.

</DL>



<H3><A NAME="Logical_Operators" HREF="manual_toc.html#Logical_Operators">13.1.3  Logical Operators</A></H3>

<P>
<A NAME="IDX1236"></A>
<A NAME="IDX1237"></A>

</P>
<P>
In SQL, all logical operators evaluate to TRUE, FALSE, or <CODE>NULL</CODE> (UNKNOWN).
In MySQL, these are implemented as <CODE>1</CODE> (TRUE), <CODE>0</CODE> (FALSE),
and <CODE>NULL</CODE>. Most of this is common to different SQL database servers,
although some servers may return any non-zero value for TRUE.

</P>
<DL COMPACT>

<DT><CODE>NOT</CODE>
<DD>
<DT><CODE>!</CODE>
<DD>
<A NAME="IDX1238"></A>
<A NAME="IDX1239"></A>
Logical NOT.
Evaluates to <CODE>1</CODE> if the operand is <CODE>0</CODE>,
to <CODE>0</CODE> if the operand is non-zero,
and <CODE>NOT NULL</CODE> returns <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT NOT 10;
        -&#62; 0
mysql&#62; SELECT NOT 0;
        -&#62; 1
mysql&#62; SELECT NOT NULL;
        -&#62; NULL
mysql&#62; SELECT ! (1+1);
        -&#62; 0
mysql&#62; SELECT ! 1+1;
        -&#62; 1
</PRE>

The last example produces <CODE>1</CODE> because the expression evaluates
the same way as <CODE>(!1)+1</CODE>.

<DT><CODE>AND</CODE>
<DD>
<DT><CODE>&#38;&</CODE>
<DD>
<A NAME="IDX1240"></A>
<A NAME="IDX1241"></A>
Logical AND.
Evaluates to <CODE>1</CODE> if all operands are non-zero and not <CODE>NULL</CODE>,
to <CODE>0</CODE> if one or more operands are <CODE>0</CODE>,
otherwise <CODE>NULL</CODE> is returned.


<PRE>
mysql&#62; SELECT 1 &#38;& 1;
        -&#62; 1
mysql&#62; SELECT 1 &#38;& 0;
        -&#62; 0
mysql&#62; SELECT 1 &#38;& NULL;
        -&#62; NULL
mysql&#62; SELECT 0 &#38;& NULL;
        -&#62; 0
mysql&#62; SELECT NULL &#38;& 0;
        -&#62; 0
</PRE>

Please note that MySQL versions prior to 4.0.5 stop evaluation when
a <CODE>NULL</CODE> is encountered, rather than continuing the process to
check for possible <CODE>0</CODE> values. This means that in these versions,
<CODE>SELECT (NULL AND 0)</CODE> returns <CODE>NULL</CODE> instead of <CODE>0</CODE>.
As of MySQL 4.0.5, the code has been re-engineered so that the result is
always as prescribed by the SQL standards while still using the
optimization wherever possible.

<DT><CODE>OR</CODE>
<DD>
<DT><CODE>||</CODE>
<DD>
<A NAME="IDX1242"></A>
<A NAME="IDX1243"></A>
Logical OR.
Evaluates to <CODE>1</CODE> if any operand is non-zero,
to <CODE>NULL</CODE> if any operand is <CODE>NULL</CODE>,
otherwise <CODE>0</CODE> is returned.


<PRE>
mysql&#62; SELECT 1 || 1;
        -&#62; 1
mysql&#62; SELECT 1 || 0;
        -&#62; 1
mysql&#62; SELECT 0 || 0;
        -&#62; 0
mysql&#62; SELECT 0 || NULL;
        -&#62; NULL
mysql&#62; SELECT 1 || NULL;
        -&#62; 1
</PRE>

<DT><CODE>XOR</CODE>
<DD>
<A NAME="IDX1244"></A>
Logical XOR.
Returns <CODE>NULL</CODE> if either operand is <CODE>NULL</CODE>.
For non-<CODE>NULL</CODE> operands, evaluates to <CODE>1</CODE> if an odd number
of operands is non-zero,
otherwise <CODE>0</CODE> is returned.


<PRE>
mysql&#62; SELECT 1 XOR 1;
        -&#62; 0
mysql&#62; SELECT 1 XOR 0;
        -&#62; 1
mysql&#62; SELECT 1 XOR NULL;
        -&#62; NULL
mysql&#62; SELECT 1 XOR 1 XOR 1;
        -&#62; 1
</PRE>

<CODE>a XOR b</CODE> is mathematically equal to
<CODE>(a AND (NOT b)) OR ((NOT a) and b)</CODE>.

<CODE>XOR</CODE> was added in MySQL 4.0.2.
</DL>



<H3><A NAME="Case_Sensitivity_Operators" HREF="manual_toc.html#Case_Sensitivity_Operators">13.1.4  Case-sensitivity Operators</A></H3>

<P>
<A NAME="IDX1245"></A>

</P>
<P>
<A NAME="IDX1246"></A>
<A NAME="IDX1247"></A>

</P>
<DL COMPACT>

<DT><CODE>BINARY</CODE>
<DD>
<A NAME="IDX1248"></A>
The <CODE>BINARY</CODE> operator casts the string following it to a binary string.
This is an easy way to force a column comparison to be case sensitive even
if the column isn't defined as <CODE>BINARY</CODE> or <CODE>BLOB</CODE>.


<PRE>
mysql&#62; SELECT 'a' = 'A';
        -&#62; 1
mysql&#62; SELECT BINARY 'a' = 'A';
        -&#62; 0
</PRE>

<CODE>BINARY</CODE> was added in MySQL 3.23.0. As of MySQL 4.0.2,
<CODE>BINARY str</CODE> is a shorthand for <CODE>CAST(str AS BINARY)</CODE>.
See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.

Note that in some contexts, if you cast an indexed column to <CODE>BINARY</CODE>,
MySQL will not be able to use the index efficiently.

</DL>

<P>
If you want to compare a <CODE>BLOB</CODE> value in case-insensitive fashion, you
can do so as follows:

</P>

<UL>
<LI>

Before MySQL 4.1.1, use the <CODE>UPPER()</CODE> function to convert the <CODE>BLOB</CODE>
value to uppercase before performing the comparison:


<PRE>
SELECT 'A' LIKE UPPER(blob_col) FROM tbl_name;
</PRE>

If the comparison value is lowercase, convert the <CODE>BLOB</CODE> value using
<CODE>LOWER()</CODE> instead.

<LI>

For MySQL 4.1.1 and up, <CODE>BLOB</CODE> columns have a character set of
<CODE>binary</CODE>, which has no concept of lettercase. To perform a
case-insensitive comparison, use the <CODE>CONVERT()</CODE> function to
convert the <CODE>BLOB</CODE> value to a character set that
is not case sensitive. The result is a non-binary string, so the
<CODE>LIKE</CODE> operation is not case sensitive:


<PRE>
SELECT 'A' LIKE CONVERT(blob_col USING latin1) FROM tbl_name;
</PRE>

To use a different character set, substitute its name for <CODE>latin1</CODE>
in the preceding statement.

</UL>

<P>
<CODE>CONVERT()</CODE> can be used more generally for comparing strings that
are represented in different character sets.

</P>



<H2><A NAME="Control_flow_functions" HREF="manual_toc.html#Control_flow_functions">13.2  Control Flow Functions</A></H2>

<P>
<A NAME="IDX1249"></A>
<A NAME="IDX1250"></A>

</P>
<DL COMPACT>

<DT><CODE>CASE value WHEN [compare-value] THEN result [WHEN [compare-value] THEN result ...] [ELSE result] END</CODE>
<DD>
<DT><CODE>CASE WHEN [condition] THEN result [WHEN [condition] THEN result ...] [ELSE result] END</CODE>
<DD>
<A NAME="IDX1251"></A>

The first version returns the <CODE>result</CODE> where
<CODE>value=compare-value</CODE>. The second version returns the result for
the first condition that is true. If there was no matching result
value, the result after <CODE>ELSE</CODE> is returned, or <CODE>NULL</CODE> if there is no
<CODE>ELSE</CODE> part.


<PRE>
mysql&#62; SELECT CASE 1 WHEN 1 THEN 'one'
           WHEN 2 THEN 'two' ELSE 'more' END;
        -&#62; 'one'
mysql&#62; SELECT CASE WHEN 1&#62;0 THEN 'true' ELSE 'false' END;
        -&#62; 'true'
mysql&#62; SELECT CASE BINARY 'B'
           WHEN 'a' THEN 1 WHEN 'b' THEN 2 END;
        -&#62; NULL
</PRE>

The type of the return value (<CODE>INTEGER</CODE>, <CODE>DOUBLE</CODE>, or
<CODE>STRING</CODE>) is the same as the type of the first returned value (the
expression after the first <CODE>THEN</CODE>).

<CODE>CASE</CODE> was added in MySQL 3.23.3.

<DT><CODE>IF(expr1,expr2,expr3)</CODE>
<DD>
<A NAME="IDX1252"></A>
If <CODE>expr1</CODE> is TRUE (<CODE>expr1 &#60;&#62; 0</CODE> and <CODE>expr1 &#60;&#62; NULL</CODE>) then
<CODE>IF()</CODE> returns <CODE>expr2</CODE>, else it returns <CODE>expr3</CODE>.
<CODE>IF()</CODE> returns a numeric or string value, depending on the context
in which it is used.


<PRE>
mysql&#62; SELECT IF(1&#62;2,2,3);
        -&#62; 3
mysql&#62; SELECT IF(1&#60;2,'yes','no');
        -&#62; 'yes'
mysql&#62; SELECT IF(STRCMP('test','test1'),'no','yes');
        -&#62; 'no'
</PRE>

If only one of <CODE>expr2</CODE> or <CODE>expr3</CODE> is explicitly <CODE>NULL</CODE>, the
result type of the <CODE>IF()</CODE> function is the type of non-<CODE>NULL</CODE>
expression.  (This behavior is new in MySQL 4.0.3.)

<CODE>expr1</CODE> is evaluated as an integer value, which means that if you are
testing floating-point or string values, you should do so using a comparison
operation.


<PRE>
mysql&#62; SELECT IF(0.1,1,0);
        -&#62; 0
mysql&#62; SELECT IF(0.1&#60;&#62;0,1,0);
        -&#62; 1
</PRE>

In the first case shown, <CODE>IF(0.1)</CODE> returns <CODE>0</CODE> because <CODE>0.1</CODE>
is converted to an integer value, resulting in a test of <CODE>IF(0)</CODE>.  This
may not be what you expect.  In the second case, the comparison tests the
original floating-point value to see whether it is non-zero.  The result
of the comparison is used as an integer.

The default return type of <CODE>IF()</CODE> (which may matter when it is
stored into a temporary table) is calculated in MySQL
3.23 as follows:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Expression</STRONG> </TD><TD> <STRONG>Return Value</STRONG>
</TD></TR>
<TR><TD><CODE>expr2</CODE> or <CODE>expr3</CODE> returns a string </TD><TD> string
</TD></TR>
<TR><TD><CODE>expr2</CODE> or <CODE>expr3</CODE> returns a floating-point value </TD><TD> floating-point
</TD></TR>
<TR><TD><CODE>expr2</CODE> or <CODE>expr3</CODE> returns an integer </TD><TD> integer
</TD></TR>
</TABLE>

If <CODE>expr2</CODE> and <CODE>expr3</CODE> are strings, the result is case
sensitive if either string is case sensitive (starting from MySQL
3.23.51).

<DT><CODE>IFNULL(expr1,expr2)</CODE>
<DD>
<A NAME="IDX1253"></A>
<A NAME="IDX1254"></A>
If <CODE>expr1</CODE> is not <CODE>NULL</CODE>, <CODE>IFNULL()</CODE> returns <CODE>expr1</CODE>,
else it returns <CODE>expr2</CODE>.  <CODE>IFNULL()</CODE> returns a numeric or string
value, depending on the context in which it is used.


<PRE>
mysql&#62; SELECT IFNULL(1,0);
        -&#62; 1
mysql&#62; SELECT IFNULL(NULL,10);
        -&#62; 10
mysql&#62; SELECT IFNULL(1/0,10);
        -&#62; 10
mysql&#62; SELECT IFNULL(1/0,'yes');
        -&#62; 'yes'
</PRE>

In MySQL 4.0.6 and above, the default result value of
<CODE>IFNULL(expr1,expr2)</CODE> is the more ``general'' of the two expressions,
in the order <CODE>STRING</CODE>, <CODE>REAL</CODE>, or <CODE>INTEGER</CODE>. The difference
from earlier MySQL versions is mostly notable when you create a table
based on expressions or MySQL has to internally store a value from
<CODE>IFNULL()</CODE> in a temporary table.


<PRE>
CREATE TABLE tmp SELECT IFNULL(1,'test') AS test;
</PRE>

As of MySQL 4.0.6, the type for the <CODE>test</CODE> column is <CODE>CHAR(4)</CODE>,
whereas in earlier versions the type would be <CODE>BIGINT</CODE>.

<DT><CODE>NULLIF(expr1,expr2)</CODE>
<DD>
<A NAME="IDX1255"></A>
Returns <CODE>NULL</CODE> if <CODE>expr1 = expr2</CODE> is true, else returns <CODE>expr1</CODE>.
This is the same as <CODE>CASE WHEN expr1 = expr2 THEN NULL ELSE expr1 END</CODE>.


<PRE>
mysql&#62; SELECT NULLIF(1,1);
        -&#62; NULL
mysql&#62; SELECT NULLIF(1,2);
        -&#62; 1
</PRE>

Note that MySQL evaluates <CODE>expr1</CODE> twice if the arguments are not equal.

<CODE>NULLIF()</CODE> was added in MySQL 3.23.15.

</DL>



<H2><A NAME="String_functions" HREF="manual_toc.html#String_functions">13.3  String Functions</A></H2>

<P>
<A NAME="IDX1256"></A>
<A NAME="IDX1257"></A>

</P>
<P>
String-valued functions return <CODE>NULL</CODE> if the length of the result would
be greater than the value of the <CODE>max_allowed_packet</CODE> system variable.
See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
For functions that operate on string positions,
the first position is numbered 1.

</P>
<DL COMPACT>

<DT><CODE>ASCII(str)</CODE>
<DD>
<A NAME="IDX1258"></A>
Returns the numeric value of the leftmost character of the string
<CODE>str</CODE>. Returns <CODE>0</CODE> if <CODE>str</CODE> is the empty string.  Returns
<CODE>NULL</CODE> if <CODE>str</CODE> is <CODE>NULL</CODE>.
<CODE>ASCII()</CODE> works for characters with numeric values from <CODE>0</CODE> to
<CODE>255</CODE>.


<PRE>
mysql&#62; SELECT ASCII('2');
        -&#62; 50
mysql&#62; SELECT ASCII(2);
        -&#62; 50
mysql&#62; SELECT ASCII('dx');
        -&#62; 100
</PRE>

See also the <CODE>ORD()</CODE> function.

<DT><CODE>BIN(N)</CODE>
<DD>
<A NAME="IDX1259"></A>
Returns a string representation of the binary value of <CODE>N</CODE>, where
<CODE>N</CODE> is a longlong (<CODE>BIGINT</CODE>) number.  This is equivalent to
<CODE>CONV(N,10,2)</CODE>.  Returns <CODE>NULL</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT BIN(12);
        -&#62; '1100'
</PRE>

<DT><CODE>BIT_LENGTH(str)</CODE>
<DD>
<A NAME="IDX1260"></A>
Returns the length of the string <CODE>str</CODE> in bits.


<PRE>
mysql&#62; SELECT BIT_LENGTH('text');
        -&#62; 32
</PRE>

<CODE>BIT_LENGTH()</CODE> was added in MySQL 4.0.2.

<DT><CODE>CHAR(N,...)</CODE>
<DD>
<A NAME="IDX1261"></A>
<CODE>CHAR()</CODE> interprets the arguments as integers and returns a string
consisting of the characters given by the code values of those
integers. <CODE>NULL</CODE> values are skipped.


<PRE>
mysql&#62; SELECT CHAR(77,121,83,81,'76');
        -&#62; 'MySQL'
mysql&#62; SELECT CHAR(77,77.3,'77.3');
        -&#62; 'MMM'
</PRE>

<DT><CODE>CHAR_LENGTH(str)</CODE>
<DD>
<A NAME="IDX1262"></A>

Returns the length of the string <CODE>str</CODE>, measured in characters.
A multi-byte character counts as a single character.
This means that for a string containing five two-byte characters,
<CODE>LENGTH()</CODE> returns <CODE>10</CODE>, whereas <CODE>CHAR_LENGTH()</CODE> returns
<CODE>5</CODE>.

<DT><CODE>CHARACTER_LENGTH(str)</CODE>
<DD>
<A NAME="IDX1263"></A>

<CODE>CHARACTER_LENGTH()</CODE> is a synonym for <CODE>CHAR_LENGTH()</CODE>.

<DT><CODE>COMPRESS(string_to_compress)</CODE>
<DD>
<A NAME="IDX1264"></A>
Compresses a string. This function requires MySQL to have been compiled
with a compression library such as <CODE>zlib</CODE>. Otherwise, the return
value is always <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT LENGTH(COMPRESS(REPEAT('a',1000)));
        -&#62; 21
mysql&#62; SELECT LENGTH(COMPRESS(''));
        -&#62; 0
mysql&#62; SELECT LENGTH(COMPRESS('a'));
        -&#62; 13
mysql&#62; SELECT LENGTH(COMPRESS(REPEAT('a',16)));
        -&#62; 15
</PRE>

The compressed string contents are stored the following way:

<UL>
<LI>

Empty strings are stored as empty strings.
<LI>

Non-empty strings are stored as a four-byte length of the uncompressed string
(low byte first), followed by the compressed string.  If the
string ends with space, an extra <SAMP>`.'</SAMP> character is added to avoid
problems with endspace trimming should the result be stored in a <CODE>CHAR</CODE>
or <CODE>VARCHAR</CODE> column.  (Use of <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> to store
compressed strings is not recommended. It is better to use a <CODE>BLOB</CODE>
column instead.)
</UL>

<CODE>COMPRESS()</CODE> was added in MySQL 4.1.1.

<DT><CODE>CONCAT(str1,str2,...)</CODE>
<DD>
<A NAME="IDX1265"></A>
Returns the string that results from concatenating the arguments.  Returns
<CODE>NULL</CODE> if any argument is <CODE>NULL</CODE>.  May have one or more arguments.
A numeric argument is converted to its equivalent string form.


<PRE>
mysql&#62; SELECT CONCAT('My', 'S', 'QL');
        -&#62; 'MySQL'
mysql&#62; SELECT CONCAT('My', NULL, 'QL');
        -&#62; NULL
mysql&#62; SELECT CONCAT(14.3);
        -&#62; '14.3'
</PRE>

<DT><CODE>CONCAT_WS(separator,str1,str2,...)</CODE>
<DD>
<A NAME="IDX1266"></A>

<CODE>CONCAT_WS()</CODE> stands for CONCAT With Separator and is a special form of
<CODE>CONCAT()</CODE>.  The first argument is the separator for the rest of the
arguments.
The separator is added between the strings to be concatenated.
The separator can be a string as can the rest of the
arguments. If the separator is <CODE>NULL</CODE>, the result is <CODE>NULL</CODE>.
The function skips any <CODE>NULL</CODE> values after the
separator argument.


<PRE>
mysql&#62; SELECT CONCAT_WS(',','First name','Second name','Last Name');
        -&#62; 'First name,Second name,Last Name'
mysql&#62; SELECT CONCAT_WS(',','First name',NULL,'Last Name');
        -&#62; 'First name,Last Name'
</PRE>

Before MySQL 4.0.14, <CODE>CONCAT_WS()</CODE> skips empty strings as well as
<CODE>NULL</CODE> values.

<DT><CODE>CONV(N,from_base,to_base)</CODE>
<DD>
<A NAME="IDX1267"></A>
Converts numbers between different number bases.  Returns a string
representation of the number <CODE>N</CODE>, converted from base <CODE>from_base</CODE>
to base <CODE>to_base</CODE>.  Returns <CODE>NULL</CODE> if any argument is <CODE>NULL</CODE>.
The argument <CODE>N</CODE> is interpreted as an integer, but may be specified as
an integer or a string.  The minimum base is <CODE>2</CODE> and the maximum base is
<CODE>36</CODE>.  If <CODE>to_base</CODE> is a negative number, <CODE>N</CODE> is regarded as a
signed number.  Otherwise, <CODE>N</CODE> is treated as unsigned.  <CODE>CONV()</CODE> works
with 64-bit precision.


<PRE>
mysql&#62; SELECT CONV('a',16,2);
        -&#62; '1010'
mysql&#62; SELECT CONV('6E',18,8);
        -&#62; '172'
mysql&#62; SELECT CONV(-17,10,-18);
        -&#62; '-H'
mysql&#62; SELECT CONV(10+'10'+'10'+0xa,10,10);
        -&#62; '40'
</PRE>

<DT><CODE>ELT(N,str1,str2,str3,...)</CODE>
<DD>
<A NAME="IDX1268"></A>
Returns <CODE>str1</CODE> if <CODE>N</CODE> = <CODE>1</CODE>, <CODE>str2</CODE> if <CODE>N</CODE> =
<CODE>2</CODE>, and so on.  Returns <CODE>NULL</CODE> if <CODE>N</CODE> is less than <CODE>1</CODE>
or greater than the number of arguments.  <CODE>ELT()</CODE> is the complement of
<CODE>FIELD()</CODE>.


<PRE>
mysql&#62; SELECT ELT(1, 'ej', 'Heja', 'hej', 'foo');
        -&#62; 'ej'
mysql&#62; SELECT ELT(4, 'ej', 'Heja', 'hej', 'foo');
        -&#62; 'foo'
</PRE>

<DT><CODE>EXPORT_SET(bits,on,off,[separator,[number_of_bits]])</CODE>
<DD>
<A NAME="IDX1269"></A>
Returns a string in which for every bit set in <CODE>bits</CODE>, you get an <CODE>on</CODE> 
string and for every reset bit you get an <CODE>off</CODE> string. Each string is 
separated by <CODE>separator</CODE> (default <SAMP>`,'</SAMP>), and only 
<CODE>number_of_bits</CODE> (default 64) of <CODE>bits</CODE> is used.


<PRE>
mysql&#62; SELECT EXPORT_SET(5,'Y','N',',',4)
        -&#62; Y,N,Y,N
</PRE>

<DT><CODE>FIELD(str,str1,str2,str3,...)</CODE>
<DD>
<A NAME="IDX1270"></A>
Returns the index of <CODE>str</CODE> in the <CODE>str1</CODE>, <CODE>str2</CODE>,
<CODE>str3</CODE>, <CODE>...</CODE> list.
Returns <CODE>0</CODE> if <CODE>str</CODE> is not found.
<CODE>FIELD()</CODE> is the complement of <CODE>ELT()</CODE>.


<PRE>
mysql&#62; SELECT FIELD('ej', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -&#62; 2
mysql&#62; SELECT FIELD('fo', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -&#62; 0
</PRE>

<DT><CODE>FIND_IN_SET(str,strlist)</CODE>
<DD>
<A NAME="IDX1271"></A>
Returns a value <CODE>1</CODE> to <CODE>N</CODE> if the string <CODE>str</CODE> is in the string list
<CODE>strlist</CODE> consisting of <CODE>N</CODE> substrings. A string list is a string
composed of substrings separated by <SAMP>`,'</SAMP> characters. If the first
argument is a constant string and the second is a column of type <CODE>SET</CODE>,
the <CODE>FIND_IN_SET()</CODE> function is optimized to use bit arithmetic.
Returns <CODE>0</CODE> if <CODE>str</CODE> is not in <CODE>strlist</CODE> or if <CODE>strlist</CODE>
is the empty string.  Returns <CODE>NULL</CODE> if either argument is <CODE>NULL</CODE>.
This function will not work properly if the first argument contains a comma
(<SAMP>`,'</SAMP>) character.


<PRE>
mysql&#62; SELECT FIND_IN_SET('b','a,b,c,d');
        -&#62; 2
</PRE>

<DT><CODE>HEX(N_or_S)</CODE>
<DD>
<A NAME="IDX1272"></A>

If <CODE>N_OR_S</CODE> is a number, returns a string representation of the hexadecimal
value of <CODE>N</CODE>, where <CODE>N</CODE> is a longlong (<CODE>BIGINT</CODE>) number.
This is equivalent to <CODE>CONV(N,10,16)</CODE>.

From MySQL 4.0.1 and up,
if <CODE>N_OR_S</CODE> is a string, returns a hexadecimal string of <CODE>N_OR_S</CODE>
where each character in <CODE>N_OR_S</CODE> is converted to two hexadecimal digits.


<PRE>
mysql&#62; SELECT HEX(255);
        -&#62; 'FF'
mysql&#62; SELECT 0x616263;
        -&#62; 'abc'
mysql&#62; SELECT HEX('abc');
        -&#62; 616263
</PRE>

<DT><CODE>INSERT(str,pos,len,newstr)</CODE>
<DD>
<A NAME="IDX1273"></A>
Returns the string <CODE>str</CODE>, with the substring beginning at position
<CODE>pos</CODE> and <CODE>len</CODE> characters long replaced by the string
<CODE>newstr</CODE>.


<PRE>
mysql&#62; SELECT INSERT('Quadratic', 3, 4, 'What');
        -&#62; 'QuWhattic'
</PRE>

This function is multi-byte safe.

<DT><CODE>INSTR(str,substr)</CODE>
<DD>
<A NAME="IDX1274"></A>
Returns the position of the first occurrence of substring <CODE>substr</CODE> in
string <CODE>str</CODE>. This is the same as the two-argument form of
<CODE>LOCATE()</CODE>, except that the arguments are swapped.


<PRE>
mysql&#62; SELECT INSTR('foobarbar', 'bar');
        -&#62; 4
mysql&#62; SELECT INSTR('xbar', 'foobar');
        -&#62; 0
</PRE>

This function is multi-byte safe.  In MySQL 3.23, this function is case
sensitive. For 4.0 on, it is case sensitive only if either argument is a
binary string.

<DT><CODE>LCASE(str)</CODE>
<DD>
<A NAME="IDX1275"></A>

<CODE>LCASE()</CODE> is a synonym for <CODE>LOWER()</CODE>.

<DT><CODE>LEFT(str,len)</CODE>
<DD>
<A NAME="IDX1276"></A>
Returns the leftmost <CODE>len</CODE> characters from the string <CODE>str</CODE>.


<PRE>
mysql&#62; SELECT LEFT('foobarbar', 5);
        -&#62; 'fooba'
</PRE>

<DT><CODE>LENGTH(str)</CODE>
<DD>
<A NAME="IDX1277"></A>
Returns the length of the string <CODE>str</CODE>, measured in bytes.
A multi-byte character counts as multiple bytes.
This means that for a string containing five two-byte characters,
<CODE>LENGTH()</CODE> returns <CODE>10</CODE>, whereas <CODE>CHAR_LENGTH()</CODE> returns
<CODE>5</CODE>.


<PRE>
mysql&#62; SELECT LENGTH('text');
        -&#62; 4
</PRE>

<DT><CODE>LOAD_FILE(file_name)</CODE>
<DD>
<A NAME="IDX1278"></A>
<A NAME="IDX1279"></A>
Reads the file and returns the file contents as a string.  The file
must be located on the server, you must specify the full pathname to the
file, and you must have the <CODE>FILE</CODE> privilege.  The file must
be readable by all and be smaller than <CODE>max_allowed_packet</CODE> bytes.

If the file doesn't exist or cannot be read because one of the preceding
conditions is not satisfied, the function returns <CODE>NULL</CODE>.


<PRE>
mysql&#62; UPDATE tbl_name
           SET blob_column=LOAD_FILE('/tmp/picture')
           WHERE id=1;
</PRE>

Before MySQL 3.23, you must read the file inside your application and create
an <CODE>INSERT</CODE> statement to update the database with the file contents.
If you are using the MySQL++ library, one way to do this can be found in the
MySQL++ manual, available at
<a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a>.

<DT><CODE>LOCATE(substr,str)</CODE>
<DD>
<DT><CODE>LOCATE(substr,str,pos)</CODE>
<DD>
<A NAME="IDX1280"></A>

The first syntax
returns the position of the first occurrence of substring <CODE>substr</CODE>
in string <CODE>str</CODE>.
The second syntax
returns the position of the first occurrence of substring <CODE>substr</CODE> in
string <CODE>str</CODE>, starting at position <CODE>pos</CODE>.
Returns <CODE>0</CODE> if <CODE>substr</CODE> is not in <CODE>str</CODE>.


<PRE>
mysql&#62; SELECT LOCATE('bar', 'foobarbar');
        -&#62; 4
mysql&#62; SELECT LOCATE('xbar', 'foobar');
        -&#62; 0
mysql&#62; SELECT LOCATE('bar', 'foobarbar',5);
        -&#62; 7
</PRE>

This function is multi-byte safe.  In MySQL 3.23, this function is case
sensitive. For 4.0 on, it is case sensitive only if either argument is a
binary string.

<DT><CODE>LOWER(str)</CODE>
<DD>
<A NAME="IDX1281"></A>
Returns the string <CODE>str</CODE> with all characters changed to lowercase
according to the current character set mapping (the default is ISO-8859-1
Latin1).


<PRE>
mysql&#62; SELECT LOWER('QUADRATICALLY');
        -&#62; 'quadratically'
</PRE>

This function is multi-byte safe.

<DT><CODE>LPAD(str,len,padstr)</CODE>
<DD>
<A NAME="IDX1282"></A>
Returns the string <CODE>str</CODE>, left-padded with the string <CODE>padstr</CODE>
to a length of <CODE>len</CODE> characters. If <CODE>str</CODE> is longer
than <CODE>len</CODE>, the return value is shortened to <CODE>len</CODE> characters.


<PRE>
mysql&#62; SELECT LPAD('hi',4,'??');
        -&#62; '??hi'
mysql&#62; SELECT LPAD('hi',1,'??');
        -&#62; 'h'
</PRE>

<DT><CODE>LTRIM(str)</CODE>
<DD>
<A NAME="IDX1283"></A>
Returns the string <CODE>str</CODE> with leading space characters removed.


<PRE>
mysql&#62; SELECT LTRIM('  barbar');
        -&#62; 'barbar'
</PRE>

This function is multi-byte safe.

<DT><CODE>MAKE_SET(bits,str1,str2,...)</CODE>
<DD>
<A NAME="IDX1284"></A>
Returns a set value (a string containing substrings separated by <SAMP>`,'</SAMP>
characters) consisting of the strings that have the corresponding bit in
<CODE>bits</CODE> set.  <CODE>str1</CODE> corresponds to bit 0, <CODE>str2</CODE> to bit 1,
and so on.  <CODE>NULL</CODE> values in <CODE>str1</CODE>, <CODE>str2</CODE>, <CODE>...</CODE>
are not appended to the result.


<PRE>
mysql&#62; SELECT MAKE_SET(1,'a','b','c');
        -&#62; 'a'
mysql&#62; SELECT MAKE_SET(1 | 4,'hello','nice','world');
        -&#62; 'hello,world'
mysql&#62; SELECT MAKE_SET(1 | 4,'hello','nice',NULL,'world');
        -&#62; 'hello'
mysql&#62; SELECT MAKE_SET(0,'a','b','c');
        -&#62; ''
</PRE>

<DT><CODE>MID(str,pos,len)</CODE>
<DD>
<A NAME="IDX1285"></A>

<CODE>MID(str,pos,len)</CODE> is a synonym for <CODE>SUBSTRING(str,pos,len)</CODE>.

<DT><CODE>OCT(N)</CODE>
<DD>
<A NAME="IDX1286"></A>
Returns a string representation of the octal value of <CODE>N</CODE>, where
<CODE>N</CODE> is a longlong number.  This is equivalent to <CODE>CONV(N,10,8)</CODE>.
Returns <CODE>NULL</CODE> if <CODE>N</CODE> is <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT OCT(12);
        -&#62; '14'
</PRE>

<DT><CODE>OCTET_LENGTH(str)</CODE>
<DD>
<A NAME="IDX1287"></A>

<CODE>OCTET_LENGTH()</CODE> is a synonym for <CODE>LENGTH()</CODE>.

<DT><CODE>ORD(str)</CODE>
<DD>
<A NAME="IDX1288"></A>
If the leftmost character of the string <CODE>str</CODE> is a multi-byte character,
returns the code for that character, calculated from the numeric values
of its constituent bytes using this formula:


<PRE>
  (1st byte code * 256)
+ (2nd byte code * 256^2)
+ (3rd byte code * 256^3) ...
</PRE>

If the leftmost character is not a multi-byte character, <CODE>ORD()</CODE>
returns the same value as the <CODE>ASCII()</CODE> function.


<PRE>
mysql&#62; SELECT ORD('2');
        -&#62; 50
</PRE>

<DT><CODE>POSITION(substr IN str)</CODE>
<DD>
<A NAME="IDX1289"></A>

<CODE>POSITION(substr IN str)</CODE> is a synonym for <CODE>LOCATE(substr,str)</CODE>.

<DT><CODE>QUOTE(str)</CODE>
<DD>
<A NAME="IDX1290"></A>
Quotes a string to produce a result that can be used as a properly escaped
data value in an SQL statement.  The string is returned surrounded by single
quotes and with each instance of single quote (<SAMP>`''</SAMP>), backslash (<SAMP>`\'</SAMP>),
ASCII NUL, and Control-Z preceded by a backslash.  If the argument is
<CODE>NULL</CODE>, the return value is the word ``NULL'' without surrounding
single quotes.
The <CODE>QUOTE()</CODE> function was added in MySQL 4.0.3.


<PRE>
mysql&#62; SELECT QUOTE('Don\'t');
        -&#62; 'Don\'t!'
mysql&#62; SELECT QUOTE(NULL);
        -&#62; NULL
</PRE>

<DT><CODE>REPEAT(str,count)</CODE>
<DD>
<A NAME="IDX1291"></A>
Returns a string consisting of the string <CODE>str</CODE> repeated <CODE>count</CODE>
times. If <CODE>count &#60;= 0</CODE>, returns an empty string. Returns <CODE>NULL</CODE> if
<CODE>str</CODE> or <CODE>count</CODE> are <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT REPEAT('MySQL', 3);
        -&#62; 'MySQLMySQLMySQL'
</PRE>

<DT><CODE>REPLACE(str,from_str,to_str)</CODE>
<DD>
<A NAME="IDX1292"></A>
Returns the string <CODE>str</CODE> with all occurrences of the string
<CODE>from_str</CODE> replaced by the string <CODE>to_str</CODE>.


<PRE>
mysql&#62; SELECT REPLACE('www.mysql.com', 'w', 'Ww');
        -&#62; 'WwWwWw.mysql.com'
</PRE>

This function is multi-byte safe.

<DT><CODE>REVERSE(str)</CODE>
<DD>
<A NAME="IDX1293"></A>
Returns the string <CODE>str</CODE> with the order of the characters reversed.


<PRE>
mysql&#62; SELECT REVERSE('abc');
        -&#62; 'cba'
</PRE>

This function is multi-byte safe.

<DT><CODE>RIGHT(str,len)</CODE>
<DD>
<A NAME="IDX1294"></A>
Returns the rightmost <CODE>len</CODE> characters from the string <CODE>str</CODE>.


<PRE>
mysql&#62; SELECT RIGHT('foobarbar', 4);
        -&#62; 'rbar'
</PRE>

This function is multi-byte safe.

<DT><CODE>RPAD(str,len,padstr)</CODE>
<DD>
<A NAME="IDX1295"></A>
Returns the string <CODE>str</CODE>, right-padded with the string <CODE>padstr</CODE>
to a length of <CODE>len</CODE> characters. If <CODE>str</CODE> is longer
than <CODE>len</CODE>, the return value is shortened to <CODE>len</CODE> characters.


<PRE>
mysql&#62; SELECT RPAD('hi',5,'?');
        -&#62; 'hi???'
mysql&#62; SELECT RPAD('hi',1,'?');
        -&#62; 'h'
</PRE>

This function is multi-byte safe.

<DT><CODE>RTRIM(str)</CODE>
<DD>
<A NAME="IDX1296"></A>
Returns the string <CODE>str</CODE> with trailing space characters removed.


<PRE>
mysql&#62; SELECT RTRIM('barbar   ');
        -&#62; 'barbar'
</PRE>

This function is multi-byte safe.

<DT><CODE>SOUNDEX(str)</CODE>
<DD>
<A NAME="IDX1297"></A>
Returns a soundex string from <CODE>str</CODE>. Two strings that sound almost the
same should have identical soundex strings. A standard soundex string
is four characters long, but the <CODE>SOUNDEX()</CODE> function returns an
arbitrarily long string. You can use <CODE>SUBSTRING()</CODE> on the result to get
a standard soundex string.  All non-alphabetic characters are ignored in the
given string. All international alphabetic characters outside the A-Z range
are treated as vowels.


<PRE>
mysql&#62; SELECT SOUNDEX('Hello');
        -&#62; 'H400'
mysql&#62; SELECT SOUNDEX('Quadratically');
        -&#62; 'Q36324'
</PRE>

<STRONG>Note:</STRONG> This function implements the original Soundex algorithm,
not the more popular enhanced version (also described by D. Knuth).
The difference is that original version discards vowels first and then
duplicates, whereas the enhanced version discards duplicates first and
then vowels.

<DT><CODE>expr1 SOUNDS LIKE expr2</CODE>
<DD>
<A NAME="IDX1298"></A>

This is the same as <CODE>SOUNDEX(expr1) = SOUNDEX(expr2)</CODE> (available only in MySQL 4.1 or later). 

<DT><CODE>SPACE(N)</CODE>
<DD>
<A NAME="IDX1299"></A>
Returns a string consisting of <CODE>N</CODE> space characters.


<PRE>
mysql&#62; SELECT SPACE(6);
        -&#62; '      '
</PRE>

<DT><CODE>SUBSTRING(str,pos)</CODE>
<DD>
<DT><CODE>SUBSTRING(str FROM pos)</CODE>
<DD>
<DT><CODE>SUBSTRING(str,pos,len)</CODE>
<DD>
<DT><CODE>SUBSTRING(str FROM pos FOR len)</CODE>
<DD>
<A NAME="IDX1300"></A>

The forms without a <CODE>len</CODE> argument
return a substring from string <CODE>str</CODE> starting at position <CODE>pos</CODE>.
The forms with a <CODE>len</CODE> argument
return a substring <CODE>len</CODE> characters long from string <CODE>str</CODE>,
starting at position <CODE>pos</CODE>.
The forms that use <CODE>FROM</CODE> are standard SQL syntax.


<PRE>
mysql&#62; SELECT SUBSTRING('Quadratically',5);
        -&#62; 'ratically'
mysql&#62; SELECT SUBSTRING('foobarbar' FROM 4);
        -&#62; 'barbar'
mysql&#62; SELECT SUBSTRING('Quadratically',5,6);
        -&#62; 'ratica'
</PRE>

This function is multi-byte safe.

<DT><CODE>SUBSTRING_INDEX(str,delim,count)</CODE>
<DD>
<A NAME="IDX1301"></A>
Returns the substring from string <CODE>str</CODE> before <CODE>count</CODE>
occurrences of the delimiter <CODE>delim</CODE>.
If <CODE>count</CODE> is positive, everything to the left of the final delimiter
(counting from the left) is returned.
If <CODE>count</CODE> is negative, everything to the right of the final delimiter
(counting from the right) is returned.


<PRE>
mysql&#62; SELECT SUBSTRING_INDEX('www.mysql.com', '.', 2);
        -&#62; 'www.mysql'
mysql&#62; SELECT SUBSTRING_INDEX('www.mysql.com', '.', -2);
        -&#62; 'mysql.com'
</PRE>

This function is multi-byte safe.

<DT><CODE>TRIM([[BOTH | LEADING | TRAILING] [remstr] FROM] str)</CODE>
<DD>
<A NAME="IDX1302"></A>
Returns the string <CODE>str</CODE> with all <CODE>remstr</CODE> prefixes and/or suffixes
removed. If none of the specifiers <CODE>BOTH</CODE>, <CODE>LEADING</CODE>, or
<CODE>TRAILING</CODE> is given, <CODE>BOTH</CODE> is assumed. If <CODE>remstr</CODE> is not
specified, spaces are removed.


<PRE>
mysql&#62; SELECT TRIM('  bar   ');
        -&#62; 'bar'
mysql&#62; SELECT TRIM(LEADING 'x' FROM 'xxxbarxxx');
        -&#62; 'barxxx'
mysql&#62; SELECT TRIM(BOTH 'x' FROM 'xxxbarxxx');
        -&#62; 'bar'
mysql&#62; SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz');
        -&#62; 'barx'
</PRE>

This function is multi-byte safe.

<DT><CODE>UCASE(str)</CODE>
<DD>
<A NAME="IDX1303"></A>

<CODE>UCASE()</CODE> is a synonym for <CODE>UPPER()</CODE>.

<DT><CODE>UNCOMPRESS(string_to_uncompress)</CODE>
<DD>
<A NAME="IDX1304"></A>
Uncompresses a string compressed by the <CODE>COMPRESS()</CODE> function.
If the argument is not a compressed value, the result is <CODE>NULL</CODE>.
This function requires MySQL to have been compiled with a compression library
such as <CODE>zlib</CODE>. Otherwise, the return value is always <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT UNCOMPRESS(COMPRESS('any string'));
        -&#62; 'any string'
mysql&#62; SELECT UNCOMPRESS('any string');
        -&#62; NULL
</PRE>

<CODE>UNCOMPRESS()</CODE> was added in MySQL 4.1.1.

<DT><CODE>UNCOMPRESSED_LENGTH(compressed_string)</CODE>
<DD>
<A NAME="IDX1305"></A>
Returns the length of a compressed string before compression.


<PRE>
mysql&#62; SELECT UNCOMPRESSED_LENGTH(COMPRESS(REPEAT('a',30)));
        -&#62; 30
</PRE>

<CODE>UNCOMPRESSED_LENGTH()</CODE> was added in MySQL 4.1.1.

<DT><CODE>UNHEX(str)</CODE>
<DD>
<A NAME="IDX1306"></A>

Does the opposite of <CODE>HEX(string)</CODE>. That is, it interprets each pair of
hexadecimal digits in the argument as a number and converts it to the
character represented by the number. The resulting characters are returned as
a binary string.


<PRE>
mysql&#62; SELECT UNHEX('4D7953514C');
        -&#62; 'MySQL'
mysql&#62; SELECT 0x4D7953514C;
        -&#62; 'MySQL'
mysql&#62; SELECT UNHEX(HEX('string'));
        -&#62; 'string'
mysql&#62; SELECT HEX(UNHEX('1267'));
        -&#62; '1267'
</PRE>

<CODE>UNHEX()</CODE> was added in MySQL 4.1.2.

<DT><CODE>UPPER(str)</CODE>
<DD>
<A NAME="IDX1307"></A>
Returns the string <CODE>str</CODE> with all characters changed to uppercase
according to the current character set mapping (the default is ISO-8859-1
Latin1).


<PRE>
mysql&#62; SELECT UPPER('Hej');
        -&#62; 'HEJ'
</PRE>

This function is multi-byte safe.

</DL>



<H3><A NAME="String_comparison_functions" HREF="manual_toc.html#String_comparison_functions">13.3.1  String Comparison Functions</A></H3>

<P>
<A NAME="IDX1308"></A>
<A NAME="IDX1309"></A>

</P>
<P>
MySQL automatically converts numbers to strings as necessary, and
vice versa.

</P>

<PRE>
mysql&#62; SELECT 1+'1';
        -&#62; 2
mysql&#62; SELECT CONCAT(2,' test');
        -&#62; '2 test'
</PRE>

<P>
If you want to convert a number to a string explicitly, use the <CODE>CAST()</CODE>
or <CODE>CONCAT()</CODE> function:

</P>

<PRE>
mysql&#62; SELECT 38.8, CAST(38.8 AS CHAR);
        -&#62; 38.8, '38.8'
mysql&#62; SELECT 38.8, CONCAT(38.8);
        -&#62; 38.8, '38.8'
</PRE>

<P>
<CODE>CAST()</CODE> is preferable, but it is unavailable before MySQL 4.0.2.

</P>
<P>
If a string function is given a binary string as an argument, the resulting
string is also a binary string.  A number converted to a string is treated as
a binary string.  This affects only comparisons.

</P>
<P>
<A NAME="IDX1310"></A>
<A NAME="IDX1311"></A>

</P>
<P>
Normally, if any expression in a string comparison is case sensitive, the
comparison is performed in case-sensitive fashion.

</P>
<DL COMPACT>

<DT><CODE>expr LIKE pat [ESCAPE 'escape-char']</CODE>
<DD>
<A NAME="IDX1312"></A>
Pattern matching using
SQL simple regular expression comparison. Returns <CODE>1</CODE> (TRUE) or <CODE>0</CODE>
(FALSE).  If either <CODE>expr</CODE> or <CODE>pat</CODE> is <CODE>NULL</CODE>, the result is
<CODE>NULL</CODE>.

With <CODE>LIKE</CODE> you can use the following two wildcard characters
in the pattern:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Character</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>%</CODE> </TD><TD> Matches any number of characters, even zero characters
</TD></TR>
<TR><TD><CODE>_</CODE> </TD><TD> Matches exactly one character
</TD></TR>
</TABLE>


<PRE>
mysql&#62; SELECT 'David!' LIKE 'David_';
        -&#62; 1
mysql&#62; SELECT 'David!' LIKE '%D%v%';
        -&#62; 1
</PRE>

To test for literal instances of a wildcard character, precede the character
with the escape character.  If you don't specify the <CODE>ESCAPE</CODE> character,
<SAMP>`\'</SAMP> is assumed.

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>String</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>\%</CODE> </TD><TD> Matches one <SAMP>`%'</SAMP> character
</TD></TR>
<TR><TD><CODE>\_</CODE> </TD><TD> Matches one <SAMP>`_'</SAMP> character
</TD></TR>
</TABLE>


<PRE>
mysql&#62; SELECT 'David!' LIKE 'David\_';
        -&#62; 0
mysql&#62; SELECT 'David_' LIKE 'David\_';
        -&#62; 1
</PRE>

To specify a different escape character, use the <CODE>ESCAPE</CODE> clause:


<PRE>
mysql&#62; SELECT 'David_' LIKE 'David|_' ESCAPE '|';
        -&#62; 1
</PRE>

The following two statements illustrate that string comparisons are
not case sensitive unless one of the operands is a binary string:


<PRE>
mysql&#62; SELECT 'abc' LIKE 'ABC';
        -&#62; 1
mysql&#62; SELECT 'abc' LIKE BINARY 'ABC';
        -&#62; 0
</PRE>

In MySQL, <CODE>LIKE</CODE> is allowed on numeric expressions. (This is an
extension to the standard SQL <CODE>LIKE</CODE>.)


<PRE>
mysql&#62; SELECT 10 LIKE '1%';
        -&#62; 1
</PRE>

Note: Because MySQL uses the C escape syntax in strings (for example,
<SAMP>`\n'</SAMP> to represent newline), you must double any <SAMP>`\'</SAMP> that you use in your <CODE>LIKE</CODE>
strings.  For example, to search for <SAMP>`\n'</SAMP>, specify it as <SAMP>`\\n'</SAMP>.  To
search for <SAMP>`\'</SAMP>, specify it as <SAMP>`\\\\'</SAMP> (the backslashes are stripped
once by the parser and another time when the pattern match is done, leaving
a single backslash to be matched).

<STRONG>Note:</STRONG> Currently <CODE>LIKE</CODE> is not multi-byte character safe.
Comparison is done character by character.

<DT><CODE>expr NOT LIKE pat [ESCAPE 'escape-char']</CODE>
<DD>
<A NAME="IDX1313"></A>

This is the same as <CODE>NOT (expr LIKE pat [ESCAPE 'escape-char'])</CODE>.

<DT><CODE>expr NOT REGEXP pat</CODE>
<DD>
<DT><CODE>expr NOT RLIKE pat</CODE>
<DD>
<A NAME="IDX1314"></A>

This is the same as <CODE>NOT (expr REGEXP pat)</CODE>.

<A NAME="IDX1315"></A>
<A NAME="IDX1316"></A>
<A NAME="IDX1317"></A>
<A NAME="IDX1318"></A>
<DT><CODE>expr REGEXP pat</CODE>
<DD>
<DT><CODE>expr RLIKE pat</CODE>
<DD>
Performs a pattern match of a string expression <CODE>expr</CODE> against a pattern
<CODE>pat</CODE>.  The pattern can be an extended regular expression.
The syntax for regular expressions is discussed in
section <A HREF="manual.html#Regexp">F  MySQL Regular Expressions</A>.  Returns <CODE>1</CODE> if <CODE>expr</CODE> matches <CODE>pat</CODE>, otherwise
returns <CODE>0</CODE>.  If either <CODE>expr</CODE> or <CODE>pat</CODE> is <CODE>NULL</CODE>,
the result is <CODE>NULL</CODE>.  <CODE>RLIKE</CODE> is a synonym for <CODE>REGEXP</CODE>,
provided for
<CODE>mSQL</CODE> compatibility. Note: Because MySQL uses the C escape
syntax in strings (for example, <SAMP>`\n'</SAMP> to represent newline), you must double any <SAMP>`\'</SAMP> that
you use in your <CODE>REGEXP</CODE> strings.  As of MySQL 3.23.4,
<CODE>REGEXP</CODE> is not case sensitive for normal (not binary) strings.


<PRE>
mysql&#62; SELECT 'Monty!' REGEXP 'm%y%%';
        -&#62; 0
mysql&#62; SELECT 'Monty!' REGEXP '.*';
        -&#62; 1
mysql&#62; SELECT 'new*\n*line' REGEXP 'new\\*.\\*line';
        -&#62; 1
mysql&#62; SELECT 'a' REGEXP 'A', 'a' REGEXP BINARY 'A';
        -&#62; 1  0
mysql&#62; SELECT 'a' REGEXP '^[a-d]';
        -&#62; 1
</PRE>

<CODE>REGEXP</CODE> and <CODE>RLIKE</CODE> use the current character set (ISO-8859-1
Latin1 by default) when deciding the type of a character.
However, these operators are not multi-byte safe.

<DT><CODE>STRCMP(expr1,expr2)</CODE>
<DD>
<A NAME="IDX1319"></A>
<CODE>STRCMP()</CODE>
returns <CODE>0</CODE> if the strings are the same, <CODE>-1</CODE> if the first
argument is smaller than the second according to the current sort order,
and <CODE>1</CODE> otherwise.


<PRE>
mysql&#62; SELECT STRCMP('text', 'text2');
        -&#62; -1
mysql&#62; SELECT STRCMP('text2', 'text');
        -&#62; 1
mysql&#62; SELECT STRCMP('text', 'text');
        -&#62; 0
</PRE>

As of MySQL 4.0,
<CODE>STRCMP()</CODE> uses the current character set when performing comparisons.
This makes the default comparison behavior case insensitive unless
one or both of the operands are binary strings.
Before MySQL 4.0, <CODE>STRCMP()</CODE> is case sensitive.

</DL>



<H2><A NAME="Numeric_Functions" HREF="manual_toc.html#Numeric_Functions">13.4  Numeric Functions</A></H2>



<H3><A NAME="Arithmetic_functions" HREF="manual_toc.html#Arithmetic_functions">13.4.1  Arithmetic Operators</A></H3>

<P>
<A NAME="IDX1320"></A>
The usual arithmetic operators are available. Note that in the case of
<CODE>-</CODE>, <CODE>+</CODE>, and <CODE>*</CODE>, the result is calculated with
<CODE>BIGINT</CODE> (64-bit) precision if both arguments are integers.
If one of the argument is an unsigned integer, and the other argument
is also an integer, the result will be an unsigned integer.
See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.

</P>
<P>
<A NAME="IDX1321"></A>
<A NAME="IDX1322"></A>

</P>
<DL COMPACT>

<DT><CODE>+</CODE>
<DD>
<A NAME="IDX1323"></A>
<A NAME="IDX1324"></A>
Addition:


<PRE>
mysql&#62; SELECT 3+5;
        -&#62; 8
</PRE>

<DT><CODE>-</CODE>
<DD>
<A NAME="IDX1325"></A>
<A NAME="IDX1326"></A>
Subtraction:


<PRE>
mysql&#62; SELECT 3-5;
        -&#62; -2
</PRE>

<DT><CODE>-</CODE>
<DD>
<A NAME="IDX1327"></A>
<A NAME="IDX1328"></A>
<A NAME="IDX1329"></A>
Unary minus. Changes the sign of the argument.


<PRE>
mysql&#62; SELECT - 2;
        -&#62; -2
</PRE>

Note that if this operator is used with a <CODE>BIGINT</CODE>, the return value is a
<CODE>BIGINT</CODE>!  This means that you should avoid using <CODE>-</CODE> on integers that
may have the value of <CODE>-2^63</CODE>!

<DT><CODE>*</CODE>
<DD>
<A NAME="IDX1330"></A>
<A NAME="IDX1331"></A>
Multiplication:


<PRE>
mysql&#62; SELECT 3*5;
        -&#62; 15
mysql&#62; SELECT 18014398509481984*18014398509481984.0;
        -&#62; 324518553658426726783156020576256.0
mysql&#62; SELECT 18014398509481984*18014398509481984;
        -&#62; 0
</PRE>

The result of the last expression is incorrect because the result of the
integer multiplication exceeds the 64-bit range of <CODE>BIGINT</CODE>
calculations.

<DT><CODE>/</CODE>
<DD>
<A NAME="IDX1332"></A>
<A NAME="IDX1333"></A>
Division:


<PRE>
mysql&#62; SELECT 3/5;
        -&#62; 0.60
</PRE>

Division by zero produces a <CODE>NULL</CODE> result:


<PRE>
mysql&#62; SELECT 102/(1-1);
        -&#62; NULL
</PRE>

A division will be calculated with <CODE>BIGINT</CODE> arithmetic only if performed
in a context where its result is converted to an integer!

<DT><CODE>DIV</CODE>
<DD>
<A NAME="IDX1334"></A>
Integer division.
Similar to <CODE>FLOOR()</CODE> but safe with <CODE>BIGINT</CODE> values.


<PRE>
mysql&#62; SELECT 5 DIV 2;
        -&#62; 2
</PRE>

<CODE>DIV</CODE> is new in MySQL 4.1.0.

</DL>



<H3><A NAME="Mathematical_functions" HREF="manual_toc.html#Mathematical_functions">13.4.2  Mathematical Functions</A></H3>
<P>
All mathematical functions return <CODE>NULL</CODE> in case of an error.

</P>
<P>
<A NAME="IDX1335"></A>
<A NAME="IDX1336"></A>

</P>
<DL COMPACT>

<DT><CODE>ABS(X)</CODE>
<DD>
<A NAME="IDX1337"></A>
Returns the absolute value of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT ABS(2);
        -&#62; 2
mysql&#62; SELECT ABS(-32);
        -&#62; 32
</PRE>

This function is safe to use with <CODE>BIGINT</CODE> values.

<DT><CODE>ACOS(X)</CODE>
<DD>
<A NAME="IDX1338"></A>
Returns the arc cosine of <CODE>X</CODE>, that is, the value whose cosine is
<CODE>X</CODE>. Returns <CODE>NULL</CODE> if <CODE>X</CODE> is not in the range <CODE>-1</CODE> to
<CODE>1</CODE>.


<PRE>
mysql&#62; SELECT ACOS(1);
        -&#62; 0.000000
mysql&#62; SELECT ACOS(1.0001);
        -&#62; NULL
mysql&#62; SELECT ACOS(0);
        -&#62; 1.570796
</PRE>

<DT><CODE>ASIN(X)</CODE>
<DD>
<A NAME="IDX1339"></A>
Returns the arc sine of <CODE>X</CODE>, that is, the value whose sine is
<CODE>X</CODE>. Returns <CODE>NULL</CODE> if <CODE>X</CODE> is not in the range <CODE>-1</CODE> to
<CODE>1</CODE>.


<PRE>
mysql&#62; SELECT ASIN(0.2);
        -&#62; 0.201358
mysql&#62; SELECT ASIN('foo');
        -&#62; 0.000000
</PRE>

<DT><CODE>ATAN(X)</CODE>
<DD>
<A NAME="IDX1340"></A>
Returns the arc tangent of <CODE>X</CODE>, that is, the value whose tangent is
<CODE>X</CODE>.


<PRE>
mysql&#62; SELECT ATAN(2);
        -&#62; 1.107149
mysql&#62; SELECT ATAN(-2);
        -&#62; -1.107149
</PRE>

<DT><CODE>ATAN(Y,X)</CODE>
<DD>
<DT><CODE>ATAN2(Y,X)</CODE>
<DD>
<A NAME="IDX1341"></A>
Returns the arc tangent of the two variables <CODE>X</CODE> and <CODE>Y</CODE>. It is
similar to calculating the arc tangent of <CODE>Y / X</CODE>, except that the
signs of both arguments are used to determine the quadrant of the
result.


<PRE>
mysql&#62; SELECT ATAN(-2,2);
        -&#62; -0.785398
mysql&#62; SELECT ATAN2(PI(),0);
        -&#62; 1.570796
</PRE>

<DT><CODE>CEILING(X)</CODE>
<DD>
<DT><CODE>CEIL(X)</CODE>
<DD>
<A NAME="IDX1342"></A>
Returns the smallest integer value not less than <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT CEILING(1.23);
        -&#62; 2
mysql&#62; SELECT CEIL(-1.23);
        -&#62; -1
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

The <CODE>CEIL()</CODE> alias was added in MySQL 4.0.6.

<DT><CODE>COS(X)</CODE>
<DD>
<A NAME="IDX1343"></A>
Returns the cosine of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.


<PRE>
mysql&#62; SELECT COS(PI());
        -&#62; -1.000000
</PRE>

<DT><CODE>COT(X)</CODE>
<DD>
<A NAME="IDX1344"></A>
Returns the cotangent of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT COT(12);
        -&#62; -1.57267341
mysql&#62; SELECT COT(0);
        -&#62; NULL
</PRE>

<DT><CODE>CRC32(expr)</CODE>
<DD>
<A NAME="IDX1345"></A>
Computes a cyclic redundancy check value and returns a 32-bit unsigned value.
The result is <CODE>NULL</CODE> if the argument is <CODE>NULL</CODE>.
The argument is expected be a string and will be treated as one if it is not.


<PRE>
mysql&#62; SELECT CRC32('MySQL');
        -&#62; 3259397556
</PRE>

<CODE>CRC32()</CODE> is available as of MySQL 4.1.0.

<DT><CODE>DEGREES(X)</CODE>
<DD>
<A NAME="IDX1346"></A>
Returns the argument <CODE>X</CODE>, converted from radians to degrees.


<PRE>
mysql&#62; SELECT DEGREES(PI());
        -&#62; 180.000000
</PRE>

<DT><CODE>EXP(X)</CODE>
<DD>
<A NAME="IDX1347"></A>
Returns the value of <CODE>e</CODE> (the base of natural logarithms) raised to
the power of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT EXP(2);
        -&#62; 7.389056
mysql&#62; SELECT EXP(-2);
        -&#62; 0.135335
</PRE>

<DT><CODE>FLOOR(X)</CODE>
<DD>
<A NAME="IDX1348"></A>
Returns the largest integer value not greater than <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT FLOOR(1.23);
        -&#62; 1
mysql&#62; SELECT FLOOR(-1.23);
        -&#62; -2
</PRE>

Note that the return value is converted to a <CODE>BIGINT</CODE>!

<DT><CODE>LN(X)</CODE>
<DD>
<A NAME="IDX1349"></A>
Returns the natural logarithm of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT LN(2);
        -&#62; 0.693147
mysql&#62; SELECT LN(-2);
        -&#62; NULL
</PRE>

This function was added in MySQL 4.0.3.
It is synonymous with <CODE>LOG(X)</CODE> in MySQL.

<DT><CODE>LOG(X)</CODE>
<DD>
<DT><CODE>LOG(B,X)</CODE>
<DD>
<A NAME="IDX1350"></A>
If called with one parameter, this function returns the natural logarithm
of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT LOG(2);
        -&#62; 0.693147
mysql&#62; SELECT LOG(-2);
        -&#62; NULL
</PRE>

If called with two parameters, this function returns the logarithm of
<CODE>X</CODE> for an arbitrary base <CODE>B</CODE>.

<PRE>
mysql&#62; SELECT LOG(2,65536);
        -&#62; 16.000000
mysql&#62; SELECT LOG(1,100);
        -&#62; NULL
</PRE>

The arbitrary base option was added in MySQL 4.0.3.
<CODE>LOG(B,X)</CODE> is equivalent to <CODE>LOG(X)/LOG(B)</CODE>.

<DT><CODE>LOG2(X)</CODE>
<DD>
<A NAME="IDX1351"></A>
Returns the base-2 logarithm of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT LOG2(65536);
        -&#62; 16.000000
mysql&#62; SELECT LOG2(-100);
        -&#62; NULL
</PRE>

<CODE>LOG2()</CODE> is useful for finding out how many bits a number would
require for storage.
This function was added in MySQL 4.0.3.
In earlier versions, you can use <CODE>LOG(X)/LOG(2)</CODE> instead.

<DT><CODE>LOG10(X)</CODE>
<DD>
<A NAME="IDX1352"></A>
Returns the base-10 logarithm of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT LOG10(2);
        -&#62; 0.301030
mysql&#62; SELECT LOG10(100);
        -&#62; 2.000000
mysql&#62; SELECT LOG10(-100);
        -&#62; NULL
</PRE>

<DT><CODE>MOD(N,M)</CODE>
<DD>
<DT><CODE>N % M</CODE>
<DD>
<DT><CODE>N MOD M</CODE>
<DD>
<A NAME="IDX1353"></A>
<A NAME="IDX1354"></A>
<A NAME="IDX1355"></A>
<A NAME="IDX1356"></A>
<A NAME="IDX1357"></A>
Modulo (like the <CODE>%</CODE> operator in C).
Returns the remainder of <CODE>N</CODE> divided by <CODE>M</CODE>.


<PRE>
mysql&#62; SELECT MOD(234, 10);
        -&#62; 4
mysql&#62; SELECT 253 % 7;
        -&#62; 1
mysql&#62; SELECT MOD(29,9);
        -&#62; 2
mysql&#62; SELECT 29 MOD 9;
        -&#62; 2
</PRE>

This function is safe to use with <CODE>BIGINT</CODE> values.
The <CODE>N MOD M</CODE> syntax works only as of MySQL 4.1.

<DT><CODE>PI()</CODE>
<DD>
<A NAME="IDX1358"></A>
Returns the value of PI. The default number of decimals displayed is five, but
MySQL internally uses the full double-precision value for PI.


<PRE>
mysql&#62; SELECT PI();
        -&#62; 3.141593
mysql&#62; SELECT PI()+0.000000000000000000;
        -&#62; 3.141592653589793116
</PRE>

<DT><CODE>POW(X,Y)</CODE>
<DD>
<DT><CODE>POWER(X,Y)</CODE>
<DD>
<A NAME="IDX1359"></A>
<A NAME="IDX1360"></A>
Returns the value of <CODE>X</CODE> raised to the power of <CODE>Y</CODE>.


<PRE>
mysql&#62; SELECT POW(2,2);
        -&#62; 4.000000
mysql&#62; SELECT POW(2,-2);
        -&#62; 0.250000
</PRE>

<DT><CODE>RADIANS(X)</CODE>
<DD>
<A NAME="IDX1361"></A>
Returns the argument <CODE>X</CODE>, converted from degrees to radians.


<PRE>
mysql&#62; SELECT RADIANS(90);
        -&#62; 1.570796
</PRE>

<DT><CODE>RAND()</CODE>
<DD>
<DT><CODE>RAND(N)</CODE>
<DD>
<A NAME="IDX1362"></A>
Returns a random floating-point value in the range from <CODE>0</CODE> to <CODE>1.0</CODE>.
If an integer argument <CODE>N</CODE> is specified, it is used as the seed value
(producing a repeatable sequence).


<PRE>
mysql&#62; SELECT RAND();
        -&#62; 0.9233482386203
mysql&#62; SELECT RAND(20);
        -&#62; 0.15888261251047
mysql&#62; SELECT RAND(20);
        -&#62; 0.15888261251047
mysql&#62; SELECT RAND();
        -&#62; 0.63553050033332
mysql&#62; SELECT RAND();
        -&#62; 0.70100469486881
</PRE>

You can't use a column with <CODE>RAND()</CODE> values in an <CODE>ORDER BY</CODE>
clause, because <CODE>ORDER BY</CODE> would evaluate the column multiple times.
As of MySQL 3.23, you can retrieve rows in random order like this:


<PRE>
mysql&#62; SELECT * FROM tbl_name ORDER BY RAND();
</PRE>

<CODE>ORDER BY RAND()</CODE> combined with <CODE>LIMIT</CODE> is useful for selecting
a random sample of a set of rows:


<PRE>
mysql&#62; SELECT * FROM table1, table2 WHERE a=b AND c&#60;d
    -&#62; ORDER BY RAND() LIMIT 1000;
</PRE>

Note that <CODE>RAND()</CODE> in a <CODE>WHERE</CODE> clause is re-evaluated
every time the <CODE>WHERE</CODE> is executed.

<CODE>RAND()</CODE> is not meant to be a perfect random generator, but instead a
fast way to generate ad hoc random numbers that will be portable between
platforms for the same MySQL version.

<DT><CODE>ROUND(X)</CODE>
<DD>
<DT><CODE>ROUND(X,D)</CODE>
<DD>
<A NAME="IDX1363"></A>
Returns the argument <CODE>X</CODE>, rounded to the nearest integer.
With two arguments, returns <CODE>X</CODE> rounded to <CODE>D</CODE> decimals.
If <CODE>D</CODE> is negative, the integer part of the number is zeroed out.


<PRE>
mysql&#62; SELECT ROUND(-1.23);
        -&#62; -1
mysql&#62; SELECT ROUND(-1.58);
        -&#62; -2
mysql&#62; SELECT ROUND(1.58);
        -&#62; 2
mysql&#62; SELECT ROUND(1.298, 1);
        -&#62; 1.3
mysql&#62; SELECT ROUND(1.298, 0);
        -&#62; 1
mysql&#62; SELECT ROUND(23.298, -1);
        -&#62; 20
</PRE>

Note that the behavior of <CODE>ROUND()</CODE> when the argument
is halfway between two integers depends on the C library
implementation.  Different implementations round to the nearest even number,
always up, always down, or always toward zero.  If you need
one kind of rounding, you should use a well-defined function
such as <CODE>TRUNCATE()</CODE> or <CODE>FLOOR()</CODE> instead.

<DT><CODE>SIGN(X)</CODE>
<DD>
<A NAME="IDX1364"></A>
Returns the sign of the argument as <CODE>-1</CODE>, <CODE>0</CODE>, or <CODE>1</CODE>, depending
on whether <CODE>X</CODE> is negative, zero, or positive.


<PRE>
mysql&#62; SELECT SIGN(-32);
        -&#62; -1
mysql&#62; SELECT SIGN(0);
        -&#62; 0
mysql&#62; SELECT SIGN(234);
        -&#62; 1
</PRE>

<DT><CODE>SIN(X)</CODE>
<DD>
<A NAME="IDX1365"></A>
Returns the sine of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.


<PRE>
mysql&#62; SELECT SIN(PI());
        -&#62; 0.000000
</PRE>

<DT><CODE>SQRT(X)</CODE>
<DD>
<A NAME="IDX1366"></A>
Returns the non-negative square root of <CODE>X</CODE>.


<PRE>
mysql&#62; SELECT SQRT(4);
        -&#62; 2.000000
mysql&#62; SELECT SQRT(20);
        -&#62; 4.472136
</PRE>

<DT><CODE>TAN(X)</CODE>
<DD>
<A NAME="IDX1367"></A>
Returns the tangent of <CODE>X</CODE>, where <CODE>X</CODE> is given in radians.


<PRE>
mysql&#62; SELECT TAN(PI()+1);
        -&#62; 1.557408
</PRE>

<DT><CODE>TRUNCATE(X,D)</CODE>
<DD>
<A NAME="IDX1368"></A>
Returns the number <CODE>X</CODE>, truncated to <CODE>D</CODE> decimals.  If <CODE>D</CODE>
is <CODE>0</CODE>, the result will have no decimal point or fractional part.
If <CODE>D</CODE> is negative, the integer part of the number is zeroed out.


<PRE>
mysql&#62; SELECT TRUNCATE(1.223,1);
        -&#62; 1.2
mysql&#62; SELECT TRUNCATE(1.999,1);
        -&#62; 1.9
mysql&#62; SELECT TRUNCATE(1.999,0);
        -&#62; 1
mysql&#62; SELECT TRUNCATE(-1.999,1);
        -&#62; -1.9
mysql&#62; SELECT TRUNCATE(122,-2);
       -&#62; 100
</PRE>

Starting from MySQL 3.23.51, all numbers are rounded toward zero.

Note that decimal numbers are normally not stored as exact numbers in
computers, but as double-precision values, so you may be surprised by the
following result:

<A NAME="IDX1369"></A>

<PRE>
mysql&#62; SELECT TRUNCATE(10.28*100,0);
       -&#62; 1027
</PRE>

This happens because <CODE>10.28</CODE> is actually stored as something like
<CODE>10.2799999999999999</CODE>.

</DL>



<H2><A NAME="Date_and_time_functions" HREF="manual_toc.html#Date_and_time_functions">13.5  Date and Time Functions</A></H2>

<P>
<A NAME="IDX1370"></A>
<A NAME="IDX1371"></A>

</P>
<P>
This section describes the functions that can be used to manipulate
temporal values.
See section <A HREF="manual.html#Date_and_time_types">12.3  Date and Time Types</A> for a description of the range of values
each date and time type has and the valid formats in which values may be
specified.

</P>
<P>
Here is an example that uses date functions.  The following query selects
all records with a <CODE>date_col</CODE> value from within the last 30 days:

</P>

<PRE>
mysql&#62; SELECT something FROM tbl_name
    -&#62; WHERE DATE_SUB(CURDATE(),INTERVAL 30 DAY) &#60;= date_col;
</PRE>

<P>
Note that the query also will select records with dates that lie in the
future.

</P>
<P>
Functions that expect date values usually will accept datetime values
and ignore the time part. Functions that expect time values usually will
accept datetime values and ignore the date part.

</P>
<P>
Functions that return the current date or time each are evaluated only once
per query at the start of query execution. This means that multiple references
to a function such as <CODE>NOW()</CODE> within a single query will always produce
the same result.  This principle also applies to <CODE>CURDATE()</CODE>,
<CODE>CURTIME()</CODE>, <CODE>UTC_DATE()</CODE>, <CODE>UTC_TIME()</CODE>, <CODE>UTC_TIMESTAMP()</CODE>,
and to any of their synonyms.

</P>
<P>
The return value ranges in the following function descriptions apply for
complete dates. If a date is a ``zero'' value or an incomplete date such
as <CODE>'2001-11-00'</CODE>, functions that extract a part of a date may return
<CODE>0</CODE>. For example, <CODE>DAYOFMONTH('2001-11-00')</CODE> returns <CODE>0</CODE>.

</P>
<DL COMPACT>

<DT><CODE>ADDDATE(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>ADDDATE(expr,days)</CODE>
<DD>
<A NAME="IDX1372"></A>

When invoked with the <CODE>INTERVAL</CODE> form of the second argument,
<CODE>ADDDATE()</CODE> is a synonym for <CODE>DATE_ADD()</CODE>.  The related
function <CODE>SUBDATE()</CODE> is a synonym for <CODE>DATE_SUB()</CODE>.
For information on the <CODE>INTERVAL</CODE> argument, see the
discussion for <CODE>DATE_ADD()</CODE>.


<PRE>
mysql&#62; SELECT DATE_ADD('1998-01-02', INTERVAL 31 DAY);
        -&#62; '1998-02-02'
mysql&#62; SELECT ADDDATE('1998-01-02', INTERVAL 31 DAY);
        -&#62; '1998-02-02'
</PRE>

As of MySQL 4.1.1, the second syntax is allowed, where <CODE>expr</CODE> is a date
or datetime expression and <CODE>days</CODE> is the number of days to be added to
<CODE>expr</CODE>.


<PRE>
mysql&#62; SELECT ADDDATE('1998-01-02', 31);
        -&#62; '1998-02-02'
</PRE>

<DT><CODE>ADDTIME(expr,expr2)</CODE>
<DD>
<A NAME="IDX1373"></A>

<CODE>ADDTIME()</CODE> adds <CODE>expr2</CODE> to <CODE>expr</CODE> and returns the result.
<CODE>expr</CODE> is a date or datetime expression, and <CODE>expr2</CODE> is a time
expression.


<PRE>
mysql&#62; SELECT ADDTIME('1997-12-31 23:59:59.999999',
    -&#62;                '1 1:1:1.000002');
        -&#62; '1998-01-02 01:01:01.000001'
mysql&#62; SELECT ADDTIME('01:00:00.999999', '02:00:00.999998');
        -&#62; '03:00:01.999997'
</PRE>

<CODE>ADDTIME()</CODE> was added in MySQL 4.1.1.

<DT><CODE>CURDATE()</CODE>
<DD>
<A NAME="IDX1374"></A>

Returns the current date as a value in <CODE>'YYYY-MM-DD'</CODE> or <CODE>YYYYMMDD</CODE>
format, depending on whether the function is used in a string or numeric
context.


<PRE>
mysql&#62; SELECT CURDATE();
        -&#62; '1997-12-15'
mysql&#62; SELECT CURDATE() + 0;
        -&#62; 19971215
</PRE>

<DT><CODE>CURRENT_DATE</CODE>
<DD>
<DT><CODE>CURRENT_DATE()</CODE>
<DD>
<A NAME="IDX1375"></A>

<CODE>CURRENT_DATE</CODE> and <CODE>CURRENT_DATE()</CODE> are synonyms for
<CODE>CURDATE()</CODE>.

<DT><CODE>CURTIME()</CODE>
<DD>
<A NAME="IDX1376"></A>

Returns the current time as a value in <CODE>'HH:MM:SS'</CODE> or <CODE>HHMMSS</CODE>
format, depending on whether the function is used in a string or numeric
context.


<PRE>
mysql&#62; SELECT CURTIME();
        -&#62; '23:50:26'
mysql&#62; SELECT CURTIME() + 0;
        -&#62; 235026
</PRE>

<DT><CODE>CURRENT_TIME</CODE>
<DD>
<DT><CODE>CURRENT_TIME()</CODE>
<DD>
<A NAME="IDX1377"></A>

<CODE>CURRENT_TIME</CODE> and <CODE>CURRENT_TIME()</CODE> are synonyms for
<CODE>CURTIME()</CODE>.

<DT><CODE>CURRENT_TIMESTAMP</CODE>
<DD>
<DT><CODE>CURRENT_TIMESTAMP()</CODE>
<DD>
<A NAME="IDX1378"></A>

<CODE>CURRENT_TIMESTAMP</CODE> and <CODE>CURRENT_TIMESTAMP()</CODE> are synonyms for
<CODE>NOW()</CODE>.

<DT><CODE>DATE(expr)</CODE>
<DD>
<A NAME="IDX1379"></A>

Extracts the date part of the date or datetime expression <CODE>expr</CODE>.


<PRE>
mysql&#62; SELECT DATE('2003-12-31 01:02:03');
        -&#62; '2003-12-31'
</PRE>

<CODE>DATE()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>DATEDIFF(expr,expr2)</CODE>
<DD>
<A NAME="IDX1380"></A>

<CODE>DATEDIFF()</CODE> returns the number of days between the start date
<CODE>expr</CODE> and the end date <CODE>expr2</CODE>.
<CODE>expr</CODE> and <CODE>expr2</CODE> are date or date-and-time expressions.
Only the date parts of the values are used in the calculation.


<PRE>
mysql&#62; SELECT DATEDIFF('1997-12-31 23:59:59','1997-12-30');
        -&#62; 1
mysql&#62; SELECT DATEDIFF('1997-11-30 23:59:59','1997-12-31');
        -&#62; -31
</PRE>

<CODE>DATEDIFF()</CODE> was added in MySQL 4.1.1.

<DT><CODE>DATE_ADD(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>DATE_SUB(date,INTERVAL expr type)</CODE>
<DD>
<A NAME="IDX1381"></A>
<A NAME="IDX1382"></A>

These functions perform date arithmetic.
<CODE>date</CODE> is a <CODE>DATETIME</CODE> or <CODE>DATE</CODE> value specifying the starting
date.  <CODE>expr</CODE> is an expression specifying the interval value to be added
or subtracted from the starting date.  <CODE>expr</CODE> is a string; it may start
with a <SAMP>`-'</SAMP> for negative intervals.  <CODE>type</CODE> is a keyword indicating
how the expression should be interpreted.

The <CODE>INTERVAL</CODE> keyword and the <CODE>type</CODE> specifier are not case
sensitive.

The following table shows how the <CODE>type</CODE> and <CODE>expr</CODE> arguments
are related:

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>type</CODE> <STRONG>Value</STRONG> </TD><TD> <STRONG>Expected</STRONG> <CODE>expr</CODE> <STRONG>Format</STRONG>
</TD></TR>
<TR><TD><CODE>MICROSECOND</CODE> </TD><TD> <CODE>MICROSECONDS</CODE>
</TD></TR>
<TR><TD><CODE>SECOND</CODE> </TD><TD> <CODE>SECONDS</CODE>
</TD></TR>
<TR><TD><CODE>MINUTE</CODE> </TD><TD> <CODE>MINUTES</CODE>
</TD></TR>
<TR><TD><CODE>HOUR</CODE> </TD><TD> <CODE>HOURS</CODE>
</TD></TR>
<TR><TD><CODE>DAY</CODE> </TD><TD> <CODE>DAYS</CODE>
</TD></TR>
<TR><TD><CODE>WEEK</CODE> </TD><TD> <CODE>WEEKS</CODE>
</TD></TR>
<TR><TD><CODE>MONTH</CODE> </TD><TD> <CODE>MONTHS</CODE>
</TD></TR>
<TR><TD><CODE>QUARTER</CODE> </TD><TD> <CODE>QUARTERS</CODE>
</TD></TR>
<TR><TD><CODE>YEAR</CODE> </TD><TD> <CODE>YEARS</CODE>
</TD></TR>
<TR><TD><CODE>SECOND_MICROSECOND</CODE> </TD><TD> <CODE>'SECONDS.MICROSECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>MINUTE_MICROSECOND</CODE> </TD><TD> <CODE>'MINUTES.MICROSECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>MINUTE_SECOND</CODE> </TD><TD> <CODE>'MINUTES:SECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>HOUR_MICROSECOND</CODE> </TD><TD> <CODE>'HOURS.MICROSECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>HOUR_SECOND</CODE> </TD><TD> <CODE>'HOURS:MINUTES:SECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>HOUR_MINUTE</CODE> </TD><TD> <CODE>'HOURS:MINUTES'</CODE>
</TD></TR>
<TR><TD><CODE>DAY_MICROSECOND</CODE> </TD><TD> <CODE>'DAYS.MICROSECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>DAY_SECOND</CODE> </TD><TD> <CODE>'DAYS HOURS:MINUTES:SECONDS'</CODE>
</TD></TR>
<TR><TD><CODE>DAY_MINUTE</CODE> </TD><TD> <CODE>'DAYS HOURS:MINUTES'</CODE>
</TD></TR>
<TR><TD><CODE>DAY_HOUR</CODE> </TD><TD> <CODE>'DAYS HOURS'</CODE>
</TD></TR>
<TR><TD><CODE>YEAR_MONTH</CODE> </TD><TD> <CODE>'YEARS-MONTHS'</CODE>
</TD></TR>
</TABLE>

The <CODE>type</CODE> values <CODE>DAY_MICROSECOND</CODE>, <CODE>HOUR_MICROSECOND</CODE>,
<CODE>MINUTE_MICROSECOND</CODE>, <CODE>SECOND_MICROSECOND</CODE>,
and <CODE>MICROSECOND</CODE> are allowed as of MySQL 4.1.1.
The values <CODE>QUARTER</CODE> and <CODE>WEEK</CODE> are allowed as of MySQL 5.0.0.

MySQL allows any punctuation delimiter in the <CODE>expr</CODE> format.
Those shown in the table are the suggested delimiters.  If the <CODE>date</CODE>
argument is a <CODE>DATE</CODE> value and your calculations involve only
<CODE>YEAR</CODE>, <CODE>MONTH</CODE>, and <CODE>DAY</CODE> parts (that is, no time parts), the
result is a <CODE>DATE</CODE> value.  Otherwise, the result is a <CODE>DATETIME</CODE>
value.

As of MySQL 3.23, <CODE>INTERVAL expr type</CODE> is allowed on either
side of the <CODE>+</CODE> operator if the expression on the other side is a
date or datetime value.
For the <CODE>-</CODE> operator, <CODE>INTERVAL expr type</CODE> is allowed only on
the right side, because
it makes no sense to subtract a date or datetime value from an interval.
(See examples below.)


<PRE>
mysql&#62; SELECT '1997-12-31 23:59:59' + INTERVAL 1 SECOND;
        -&#62; '1998-01-01 00:00:00'
mysql&#62; SELECT INTERVAL 1 DAY + '1997-12-31';
        -&#62; '1998-01-01'
mysql&#62; SELECT '1998-01-01' - INTERVAL 1 SECOND;
        -&#62; '1997-12-31 23:59:59'
mysql&#62; SELECT DATE_ADD('1997-12-31 23:59:59',
    -&#62;                 INTERVAL 1 SECOND);
        -&#62; '1998-01-01 00:00:00'
mysql&#62; SELECT DATE_ADD('1997-12-31 23:59:59',
    -&#62;                 INTERVAL 1 DAY);
        -&#62; '1998-01-01 23:59:59'
mysql&#62; SELECT DATE_ADD('1997-12-31 23:59:59',
    -&#62;                 INTERVAL '1:1' MINUTE_SECOND);
        -&#62; '1998-01-01 00:01:00'
mysql&#62; SELECT DATE_SUB('1998-01-01 00:00:00',
    -&#62;                 INTERVAL '1 1:1:1' DAY_SECOND);
        -&#62; '1997-12-30 22:58:59'
mysql&#62; SELECT DATE_ADD('1998-01-01 00:00:00',
    -&#62;                 INTERVAL '-1 10' DAY_HOUR);
        -&#62; '1997-12-30 14:00:00'
mysql&#62; SELECT DATE_SUB('1998-01-02', INTERVAL 31 DAY);
        -&#62; '1997-12-02'
mysql&#62; SELECT DATE_ADD('1992-12-31 23:59:59.000002',
    -&#62;            INTERVAL '1.999999' SECOND_MICROSECOND);
        -&#62; '1993-01-01 00:00:01.000001'
</PRE>

If you specify an interval value that is too short (does not include all the
interval parts that would be expected from the <CODE>type</CODE> keyword),
MySQL assumes that you have left out the leftmost parts of the interval
value.  For example, if you specify a <CODE>type</CODE> of <CODE>DAY_SECOND</CODE>, the
value of <CODE>expr</CODE> is expected to have days, hours, minutes, and seconds
parts.  If you specify a value like <CODE>'1:10'</CODE>, MySQL assumes
that the days and hours parts are missing and the value represents minutes
and seconds.  In other words, <CODE>'1:10' DAY_SECOND</CODE> is interpreted in such
a way that it is equivalent to <CODE>'1:10' MINUTE_SECOND</CODE>.  This is
analogous to the way that MySQL interprets <CODE>TIME</CODE> values
as representing elapsed time rather than as time of day.

If you add to or subtract from a date value something that
contains a time part, the result is automatically converted to a
datetime value:


<PRE>
mysql&#62; SELECT DATE_ADD('1999-01-01', INTERVAL 1 DAY);
        -&#62; '1999-01-02'
mysql&#62; SELECT DATE_ADD('1999-01-01', INTERVAL 1 HOUR);
        -&#62; '1999-01-01 01:00:00'
</PRE>

If you use really malformed dates, the result is <CODE>NULL</CODE>. If you add
<CODE>MONTH</CODE>, <CODE>YEAR_MONTH</CODE>, or <CODE>YEAR</CODE> and the resulting date
has a day that is larger than the maximum day for the new month, the day is
adjusted to the maximum days in the new month:


<PRE>
mysql&#62; SELECT DATE_ADD('1998-01-30', INTERVAL 1 MONTH);
        -&#62; '1998-02-28'
</PRE>

<DT><CODE>DATE_FORMAT(date,format)</CODE>
<DD>
<A NAME="IDX1383"></A>
Formats the <CODE>date</CODE> value according to the <CODE>format</CODE> string. The
following specifiers may be used in the <CODE>format</CODE> string:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Specifier</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>%a</CODE> </TD><TD> Abbreviated weekday name (<CODE>Sun</CODE>..<CODE>Sat</CODE>)
</TD></TR>
<TR><TD><CODE>%b</CODE> </TD><TD> Abbreviated month name (<CODE>Jan</CODE>..<CODE>Dec</CODE>)
</TD></TR>
<TR><TD><CODE>%c</CODE> </TD><TD> Month, numeric (<CODE>0</CODE>..<CODE>12</CODE>)
</TD></TR>
<TR><TD><CODE>%D</CODE> </TD><TD> Day of the month with English suffix (<CODE>0th</CODE>, <CODE>1st</CODE>, <CODE>2nd</CODE>, <CODE>3rd</CODE>, ...)
</TD></TR>
<TR><TD><CODE>%d</CODE> </TD><TD> Day of the month, numeric (<CODE>00</CODE>..<CODE>31</CODE>)
</TD></TR>
<TR><TD><CODE>%e</CODE> </TD><TD> Day of the month, numeric (<CODE>0</CODE>..<CODE>31</CODE>)
</TD></TR>
<TR><TD><CODE>%f</CODE> </TD><TD> Microseconds (<CODE>000000</CODE>..<CODE>999999</CODE>)
</TD></TR>
<TR><TD><CODE>%H</CODE> </TD><TD> Hour (<CODE>00</CODE>..<CODE>23</CODE>)
</TD></TR>
<TR><TD><CODE>%h</CODE> </TD><TD> Hour (<CODE>01</CODE>..<CODE>12</CODE>)
</TD></TR>
<TR><TD><CODE>%I</CODE> </TD><TD> Hour (<CODE>01</CODE>..<CODE>12</CODE>)
</TD></TR>
<TR><TD><CODE>%i</CODE> </TD><TD> Minutes, numeric (<CODE>00</CODE>..<CODE>59</CODE>)
</TD></TR>
<TR><TD><CODE>%j</CODE> </TD><TD> Day of year (<CODE>001</CODE>..<CODE>366</CODE>)
</TD></TR>
<TR><TD><CODE>%k</CODE> </TD><TD> Hour (<CODE>0</CODE>..<CODE>23</CODE>)
</TD></TR>
<TR><TD><CODE>%l</CODE> </TD><TD> Hour (<CODE>1</CODE>..<CODE>12</CODE>)
</TD></TR>
<TR><TD><CODE>%M</CODE> </TD><TD> Month name (<CODE>January</CODE>..<CODE>December</CODE>)
</TD></TR>
<TR><TD><CODE>%m</CODE> </TD><TD> Month, numeric (<CODE>00</CODE>..<CODE>12</CODE>)
</TD></TR>
<TR><TD><CODE>%p</CODE> </TD><TD> <CODE>AM</CODE> or <CODE>PM</CODE>
</TD></TR>
<TR><TD><CODE>%r</CODE> </TD><TD> Time, 12-hour (<CODE>hh:mm:ss</CODE> followed by <CODE>AM</CODE> or <CODE>PM</CODE>)
</TD></TR>
<TR><TD><CODE>%S</CODE> </TD><TD> Seconds (<CODE>00</CODE>..<CODE>59</CODE>)
</TD></TR>
<TR><TD><CODE>%s</CODE> </TD><TD> Seconds (<CODE>00</CODE>..<CODE>59</CODE>)
</TD></TR>
<TR><TD><CODE>%T</CODE> </TD><TD> Time, 24-hour (<CODE>hh:mm:ss</CODE>)
</TD></TR>
<TR><TD><CODE>%U</CODE> </TD><TD> Week (<CODE>00</CODE>..<CODE>53</CODE>), where Sunday is the first day of the week
</TD></TR>
<TR><TD><CODE>%u</CODE> </TD><TD> Week (<CODE>00</CODE>..<CODE>53</CODE>), where Monday is the first day of the week
</TD></TR>
<TR><TD><CODE>%V</CODE> </TD><TD> Week (<CODE>01</CODE>..<CODE>53</CODE>), where Sunday is the first day of the week; used with <CODE>%X</CODE>
</TD></TR>
<TR><TD><CODE>%v</CODE> </TD><TD> Week (<CODE>01</CODE>..<CODE>53</CODE>), where Monday is the first day of the week; used with <CODE>%x</CODE>
</TD></TR>
<TR><TD><CODE>%W</CODE> </TD><TD> Weekday name (<CODE>Sunday</CODE>..<CODE>Saturday</CODE>)
</TD></TR>
<TR><TD><CODE>%w</CODE> </TD><TD> Day of the week (<CODE>0</CODE>=Sunday..<CODE>6</CODE>=Saturday)
</TD></TR>
<TR><TD><CODE>%X</CODE> </TD><TD> Year for the week where Sunday is the first day of the week, numeric, four digits; used with <CODE>%V</CODE>
</TD></TR>
<TR><TD><CODE>%x</CODE> </TD><TD> Year for the week, where Monday is the first day of the week, numeric, four digits; used with <CODE>%v</CODE>
</TD></TR>
<TR><TD><CODE>%Y</CODE> </TD><TD> Year, numeric, four digits
</TD></TR>
<TR><TD><CODE>%y</CODE> </TD><TD> Year, numeric, two digits
</TD></TR>
<TR><TD><CODE>%%</CODE> </TD><TD> A literal <SAMP>`%'</SAMP>.
</TD></TR>
</TABLE>

All other characters are copied to the result without interpretation.

The <CODE>%v</CODE>, <CODE>%V</CODE>, <CODE>%x</CODE>, and <CODE>%X</CODE> format specifiers are
available as of MySQL 3.23.8.  <CODE>%f</CODE> is available as of MySQL 4.1.1.

As of MySQL 3.23, the <SAMP>`%'</SAMP> character is required before
format specifier characters.  In earlier versions of MySQL,
<SAMP>`%'</SAMP> was optional.

The reason the ranges for the month and day specifiers begin with zero
is that MySQL allows incomplete dates such as <CODE>'2004-00-00'</CODE> to be
stored as of MySQL 3.23.


<PRE>
mysql&#62; SELECT DATE_FORMAT('1997-10-04 22:23:00', '%W %M %Y');
        -&#62; 'Saturday October 1997'
mysql&#62; SELECT DATE_FORMAT('1997-10-04 22:23:00', '%H:%i:%s');
        -&#62; '22:23:00'
mysql&#62; SELECT DATE_FORMAT('1997-10-04 22:23:00',
                          '%D %y %a %d %m %b %j');
        -&#62; '4th 97 Sat 04 10 Oct 277'
mysql&#62; SELECT DATE_FORMAT('1997-10-04 22:23:00',
                          '%H %k %I %r %T %S %w');
        -&#62; '22 22 10 10:23:00 PM 22:23:00 00 6'
mysql&#62; SELECT DATE_FORMAT('1999-01-01', '%X %V');
        -&#62; '1998 52'
</PRE>

<DT><CODE>DAY(date)</CODE>
<DD>
<A NAME="IDX1384"></A>

<CODE>DAY()</CODE> is a synonym for <CODE>DAYOFMONTH()</CODE>.
It is available as of MySQL 4.1.1.

<DT><CODE>DAYNAME(date)</CODE>
<DD>
<A NAME="IDX1385"></A>
Returns the name of the weekday for <CODE>date</CODE>.


<PRE>
mysql&#62; SELECT DAYNAME('1998-02-05');
        -&#62; 'Thursday'
</PRE>

<DT><CODE>DAYOFMONTH(date)</CODE>
<DD>
<A NAME="IDX1386"></A>
Returns the day of the month for <CODE>date</CODE>, in the range <CODE>1</CODE> to
<CODE>31</CODE>.


<PRE>
mysql&#62; SELECT DAYOFMONTH('1998-02-03');
        -&#62; 3
</PRE>

<DT><CODE>DAYOFWEEK(date)</CODE>
<DD>
<A NAME="IDX1387"></A>
Returns the weekday index
for <CODE>date</CODE> (<CODE>1</CODE> = Sunday, <CODE>2</CODE> = Monday, ..., <CODE>7</CODE> =
Saturday).  These index values correspond to the ODBC standard.


<PRE>
mysql&#62; SELECT DAYOFWEEK('1998-02-03');
        -&#62; 3
</PRE>

<DT><CODE>DAYOFYEAR(date)</CODE>
<DD>
<A NAME="IDX1388"></A>
Returns the day of the year for <CODE>date</CODE>, in the range <CODE>1</CODE> to
<CODE>366</CODE>.


<PRE>
mysql&#62; SELECT DAYOFYEAR('1998-02-03');
        -&#62; 34
</PRE>

<DT><CODE>EXTRACT(type FROM date)</CODE>
<DD>
<A NAME="IDX1389"></A>

The <CODE>EXTRACT()</CODE> function uses the same kinds of interval type
specifiers as <CODE>DATE_ADD()</CODE> or <CODE>DATE_SUB()</CODE>, but extracts parts
from the date rather than performing date arithmetic.


<PRE>
mysql&#62; SELECT EXTRACT(YEAR FROM '1999-07-02');
       -&#62; 1999
mysql&#62; SELECT EXTRACT(YEAR_MONTH FROM '1999-07-02 01:02:03');
       -&#62; 199907
mysql&#62; SELECT EXTRACT(DAY_MINUTE FROM '1999-07-02 01:02:03');
       -&#62; 20102
mysql&#62; SELECT EXTRACT(MICROSECOND
    -&#62;                FROM '2003-01-02 10:30:00.00123');
        -&#62; 123
</PRE>

<CODE>EXTRACT()</CODE> was added in MySQL 3.23.0.

<DT><CODE>FROM_DAYS(N)</CODE>
<DD>
<A NAME="IDX1390"></A>
Given a daynumber <CODE>N</CODE>, returns a <CODE>DATE</CODE> value.


<PRE>
mysql&#62; SELECT FROM_DAYS(729669);
        -&#62; '1997-10-07'
</PRE>

<CODE>FROM_DAYS()</CODE> is not intended for use with values that precede the
advent of the Gregorian calendar (1582), because it does not take into account
the days that were lost when the calendar was changed.

<DT><CODE>FROM_UNIXTIME(unix_timestamp)</CODE>
<DD>
<DT><CODE>FROM_UNIXTIME(unix_timestamp,format)</CODE>
<DD>
<A NAME="IDX1391"></A>
Returns a representation of the <CODE>unix_timestamp</CODE> argument as a value in
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE> or <CODE>YYYYMMDDHHMMSS</CODE> format, depending on
whether the function is used in a string or numeric context.


<PRE>
mysql&#62; SELECT FROM_UNIXTIME(875996580);
        -&#62; '1997-10-04 22:23:00'
mysql&#62; SELECT FROM_UNIXTIME(875996580) + 0;
        -&#62; 19971004222300
</PRE>

If <CODE>format</CODE> is given, the result is formatted according to the
<CODE>format</CODE> string. <CODE>format</CODE> may contain the same specifiers as
those listed in the entry for the <CODE>DATE_FORMAT()</CODE> function.


<PRE>
mysql&#62; SELECT FROM_UNIXTIME(UNIX_TIMESTAMP(),
    -&#62;                      '%Y %D %M %h:%i:%s %x');
        -&#62; '2003 6th August 06:22:58 2003'
</PRE>

<DT><CODE>GET_FORMAT(DATE|TIME|TIMESTAMP, 'EUR'|'USA'|'JIS'|'ISO'|'INTERNAL')</CODE>
<DD>
<A NAME="IDX1392"></A>
Returns a format string. This function is useful in combination with the 
<CODE>DATE_FORMAT()</CODE> and the <CODE>STR_TO_DATE()</CODE> functions.
The three possible values for the first argument 
and the five possible values for the second argument result in 15 possible 
format strings (for the specifiers used, see the table in the 
<CODE>DATE_FORMAT()</CODE> function description).
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Function Call</STRONG> </TD><TD> <STRONG>Result</STRONG>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(DATE,'USA')</CODE> </TD><TD> <CODE>'%m.%d.%Y'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(DATE,'JIS')</CODE> </TD><TD> <CODE>'%Y-%m-%d'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(DATE,'ISO')</CODE> </TD><TD> <CODE>'%Y-%m-%d'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(DATE,'EUR')</CODE> </TD><TD> <CODE>'%d.%m.%Y'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(DATE,'INTERNAL')</CODE> </TD><TD> <CODE>'%Y%m%d'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIMESTAMP,'USA')</CODE> </TD><TD> <CODE>'%Y-%m-%d-%H.%i.%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIMESTAMP,'JIS')</CODE> </TD><TD> <CODE>'%Y-%m-%d %H:%i:%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIMESTAMP,'ISO')</CODE> </TD><TD> <CODE>'%Y-%m-%d %H:%i:%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIMESTAMP,'EUR')</CODE> </TD><TD> <CODE>'%Y-%m-%d-%H.%i.%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIMESTAMP,'INTERNAL')</CODE> </TD><TD> <CODE>'%Y%m%d%H%i%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIME,'USA')</CODE> </TD><TD> <CODE>'%h:%i:%s %p'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIME,'JIS')</CODE> </TD><TD> <CODE>'%H:%i:%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIME,'ISO')</CODE> </TD><TD> <CODE>'%H:%i:%s'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIME,'EUR')</CODE> </TD><TD> <CODE>'%H.%i.%S'</CODE>
</TD></TR>
<TR><TD><CODE>GET_FORMAT(TIME,'INTERNAL')</CODE> </TD><TD> <CODE>'%H%i%s'</CODE>
</TD></TR>
</TABLE>
ISO format is ISO 9075, not ISO 8601.


<PRE>
mysql&#62; SELECT DATE_FORMAT('2003-10-03',GET_FORMAT(DATE,'EUR'));
        -&#62; '03.10.2003'
mysql&#62; SELECT STR_TO_DATE('10.31.2003',GET_FORMAT(DATE,'USA'));
        -&#62; 2003-10-31
</PRE>

<CODE>GET_FORMAT()</CODE> is available as of MySQL 4.1.1.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

<DT><CODE>HOUR(time)</CODE>
<DD>
<A NAME="IDX1393"></A>
Returns the hour for <CODE>time</CODE>. The range of the return value will be
<CODE>0</CODE> to <CODE>23</CODE> for time-of-day values.


<PRE>
mysql&#62; SELECT HOUR('10:05:03');
        -&#62; 10
</PRE>

However, the range of <CODE>TIME</CODE> values actually is much larger, so
<CODE>HOUR</CODE> can return values greater than <CODE>23</CODE>.

<PRE>

mysql&#62; SELECT HOUR('272:59:59');
        -&#62; 272
</PRE>

<DT><CODE>LAST_DAY(date)</CODE>
<DD>
<A NAME="IDX1394"></A>

Takes a date or datetime value and returns the corresponding value for the
last day of the month.  Returns <CODE>NULL</CODE> if the argument is invalid.


<PRE>
mysql&#62; SELECT LAST_DAY('2003-02-05');
        -&#62; '2003-02-28'
mysql&#62; SELECT LAST_DAY('2004-02-05');
        -&#62; '2004-02-29'
mysql&#62; SELECT LAST_DAY('2004-01-01 01:01:01');
        -&#62; '2004-01-31'
mysql&#62; SELECT LAST_DAY('2003-03-32');
        -&#62; NULL
</PRE>

<CODE>LAST_DAY()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>LOCALTIME</CODE>
<DD>
<DT><CODE>LOCALTIME()</CODE>
<DD>
<A NAME="IDX1395"></A>

<CODE>LOCALTIME</CODE> and <CODE>LOCALTIME()</CODE> are synonyms for
<CODE>NOW()</CODE>.
They were added in MySQL 4.0.6.

<DT><CODE>LOCALTIMESTAMP</CODE>
<DD>
<DT><CODE>LOCALTIMESTAMP()</CODE>
<DD>
<A NAME="IDX1396"></A>

<CODE>LOCALTIMESTAMP</CODE> and <CODE>LOCALTIMESTAMP()</CODE> are synonyms for
<CODE>NOW()</CODE>.
They were added in MySQL 4.0.6.

<DT><CODE>MAKEDATE(year,dayofyear)</CODE>
<DD>
<A NAME="IDX1397"></A>

Returns a date, given year and day-of-year values.
<CODE>dayofyear</CODE> must be greater than 0 or the result will be <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT MAKEDATE(2001,31), MAKEDATE(2001,32);
        -&#62; '2001-01-31', '2001-02-01'
mysql&#62; SELECT MAKEDATE(2001,365), MAKEDATE(2004,365);
        -&#62; '2001-12-31', '2004-12-30'
mysql&#62; SELECT MAKEDATE(2001,0);
        -&#62; NULL
</PRE>

<CODE>MAKEDATE()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>MAKETIME(hour,minute,second)</CODE>
<DD>
<A NAME="IDX1398"></A>

Returns a time value calculated from the <CODE>hour</CODE>, <CODE>minute</CODE>, and
<CODE>second</CODE> arguments.


<PRE>
mysql&#62; SELECT MAKETIME(12,15,30);
        -&#62; '12:15:30'
</PRE>

<CODE>MAKETIME()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>MICROSECOND(expr)</CODE>
<DD>
<A NAME="IDX1399"></A>

Returns the microseconds from the time or datetime expression <CODE>expr</CODE> as a
number in the range from <CODE>0</CODE> to <CODE>999999</CODE>.


<PRE>
mysql&#62; SELECT MICROSECOND('12:00:00.123456');
        -&#62; 123456
mysql&#62; SELECT MICROSECOND('1997-12-31 23:59:59.000010');
        -&#62; 10
</PRE>

<CODE>MICROSECOND()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>MINUTE(time)</CODE>
<DD>
<A NAME="IDX1400"></A>
Returns the minute for <CODE>time</CODE>, in the range <CODE>0</CODE> to <CODE>59</CODE>.


<PRE>
mysql&#62; SELECT MINUTE('98-02-03 10:05:03');
        -&#62; 5
</PRE>

<DT><CODE>MONTH(date)</CODE>
<DD>
<A NAME="IDX1401"></A>
Returns the month for <CODE>date</CODE>, in the range <CODE>1</CODE> to <CODE>12</CODE>.


<PRE>
mysql&#62; SELECT MONTH('1998-02-03');
        -&#62; 2
</PRE>

<DT><CODE>MONTHNAME(date)</CODE>
<DD>
<A NAME="IDX1402"></A>
Returns the full name of the month for <CODE>date</CODE>.


<PRE>
mysql&#62; SELECT MONTHNAME('1998-02-05');
        -&#62; 'February'
</PRE>

<DT><CODE>NOW()</CODE>
<DD>
<A NAME="IDX1403"></A>

Returns the current date and time as a value in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE>
or <CODE>YYYYMMDDHHMMSS</CODE> format, depending on whether the function is used in
a string or numeric context.


<PRE>
mysql&#62; SELECT NOW();
        -&#62; '1997-12-15 23:50:26'
mysql&#62; SELECT NOW() + 0;
        -&#62; 19971215235026
</PRE>

<DT><CODE>PERIOD_ADD(P,N)</CODE>
<DD>
<A NAME="IDX1404"></A>
Adds <CODE>N</CODE> months to period <CODE>P</CODE> (in the format <CODE>YYMM</CODE> or
<CODE>YYYYMM</CODE>). Returns a value in the format <CODE>YYYYMM</CODE>.
Note that the period argument <CODE>P</CODE> is <EM>not</EM> a date value.


<PRE>
mysql&#62; SELECT PERIOD_ADD(9801,2);
        -&#62; 199803
</PRE>

<DT><CODE>PERIOD_DIFF(P1,P2)</CODE>
<DD>
<A NAME="IDX1405"></A>
Returns the number of months between periods <CODE>P1</CODE> and <CODE>P2</CODE>.
<CODE>P1</CODE> and <CODE>P2</CODE> should be in the format <CODE>YYMM</CODE> or <CODE>YYYYMM</CODE>.
Note that the period arguments <CODE>P1</CODE> and <CODE>P2</CODE> are <EM>not</EM>
date values.


<PRE>
mysql&#62; SELECT PERIOD_DIFF(9802,199703);
        -&#62; 11
</PRE>

<DT><CODE>QUARTER(date)</CODE>
<DD>
<A NAME="IDX1406"></A>
Returns the quarter of the year for <CODE>date</CODE>, in the range <CODE>1</CODE>
to <CODE>4</CODE>.


<PRE>
mysql&#62; SELECT QUARTER('98-04-01');
        -&#62; 2
</PRE>

<DT><CODE>SECOND(time)</CODE>
<DD>
<A NAME="IDX1407"></A>
Returns the second for <CODE>time</CODE>, in the range <CODE>0</CODE> to <CODE>59</CODE>.


<PRE>
mysql&#62; SELECT SECOND('10:05:03');
        -&#62; 3
</PRE>

<DT><CODE>SEC_TO_TIME(seconds)</CODE>
<DD>
<A NAME="IDX1408"></A>
Returns the <CODE>seconds</CODE> argument, converted to hours, minutes, and seconds,
as a value in <CODE>'HH:MM:SS'</CODE> or <CODE>HHMMSS</CODE> format, depending on whether
the function is used in a string or numeric context.


<PRE>
mysql&#62; SELECT SEC_TO_TIME(2378);
        -&#62; '00:39:38'
mysql&#62; SELECT SEC_TO_TIME(2378) + 0;
        -&#62; 3938
</PRE>

<DT><CODE>STR_TO_DATE(str,format)</CODE>
<DD>
<A NAME="IDX1409"></A>
This is the reverse function of the <CODE>DATE_FORMAT()</CODE> function. It takes a 
string <CODE>str</CODE> and a format string <CODE>format</CODE>, and returns a 
<CODE>DATETIME</CODE> value.
The date, time, or datetime values contained in <CODE>str</CODE> should be given 
in the format indicated by <CODE>format</CODE>. For the specifiers that can be 
used in <CODE>format</CODE>, see the table in the <CODE>DATE_FORMAT()</CODE> function 
description. All other characters are just taken verbatim, thus not being 
interpreted.
If <CODE>str</CODE> contains an illegal date, time, or datetime value, 
<CODE>STR_TO_DATE()</CODE> returns <CODE>NULL</CODE>.


<PRE>
mysql&#62; SELECT STR_TO_DATE('03.10.2003 09.20',
    -&#62;                    '%d.%m.%Y %H.%i');
        -&#62; '2003-10-03 09:20:00'
mysql&#62; SELECT STR_TO_DATE('10arp', '%carp');
        -&#62; '0000-10-00 00:00:00'
mysql&#62; SELECT STR_TO_DATE('2003-15-10 00:00:00',
    -&#62;                    '%Y-%m-%d %H:%i:%s');
        -&#62; NULL
</PRE>

<CODE>STR_TO_DATE()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>SUBDATE(date,INTERVAL expr type)</CODE>
<DD>
<DT><CODE>SUBDATE(expr,days)</CODE>
<DD>
<A NAME="IDX1410"></A>

When invoked with the <CODE>INTERVAL</CODE> form of the second argument,
<CODE>SUBDATE()</CODE> is a synonym for <CODE>DATE_SUB()</CODE>.
For information on the <CODE>INTERVAL</CODE> argument, see the
discussion for <CODE>DATE_ADD()</CODE>.


<PRE>
mysql&#62; SELECT DATE_SUB('1998-01-02', INTERVAL 31 DAY);
        -&#62; '1997-12-02'
mysql&#62; SELECT SUBDATE('1998-01-02', INTERVAL 31 DAY);
        -&#62; '1997-12-02'
</PRE>

As of MySQL 4.1.1, the second syntax is allowed, where <CODE>expr</CODE> is a date
or datetime expression and <CODE>days</CODE> is the number of days to be
subtracted from <CODE>expr</CODE>.


<PRE>
mysql&#62; SELECT SUBDATE('1998-01-02 12:00:00', 31);
        -&#62; '1997-12-02 12:00:00'
</PRE>

<DT><CODE>SUBTIME(expr,expr2)</CODE>
<DD>
<A NAME="IDX1411"></A>

<CODE>SUBTIME()</CODE> subtracts <CODE>expr2</CODE> from <CODE>expr</CODE> and returns the result.
<CODE>expr</CODE> is a date or datetime expression, and <CODE>expr2</CODE> is a time
expression.


<PRE>
mysql&#62; SELECT SUBTIME('1997-12-31 23:59:59.999999',
    -&#62;                '1 1:1:1.000002');
        -&#62; '1997-12-30 22:58:58.999997'
mysql&#62; SELECT SUBTIME('01:00:00.999999', '02:00:00.999998');
        -&#62; '-00:59:59.999999'
</PRE>

<CODE>SUBTIME()</CODE> was added in MySQL 4.1.1.

<DT><CODE>SYSDATE()</CODE>
<DD>
<A NAME="IDX1412"></A>

<CODE>SYSDATE()</CODE> is a synonym for <CODE>NOW()</CODE>.

<DT><CODE>TIME(expr)</CODE>
<DD>
<A NAME="IDX1413"></A>

Extracts the time part of the time or datetime expression <CODE>expr</CODE>.


<PRE>
mysql&#62; SELECT TIME('2003-12-31 01:02:03');
        -&#62; '01:02:03'
mysql&#62; SELECT TIME('2003-12-31 01:02:03.000123');
        -&#62; '01:02:03.000123'
</PRE>

<CODE>TIME()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>TIMEDIFF(expr,expr2)</CODE>
<DD>
<A NAME="IDX1414"></A>

<CODE>TIMEDIFF()</CODE> returns the time between the start time
<CODE>expr</CODE> and the end time <CODE>expr2</CODE>.
<CODE>expr</CODE> and <CODE>expr2</CODE> are time or date-and-time expressions, but both
must be of the same type.


<PRE>
mysql&#62; SELECT TIMEDIFF('2000:01:01 00:00:00',
    -&#62;                 '2000:01:01 00:00:00.000001');
        -&#62; '-00:00:00.000001'
mysql&#62; SELECT TIMEDIFF('1997-12-31 23:59:59.000001',
    -&#62;                 '1997-12-30 01:01:01.000002');
        -&#62; '46:58:57.999999'
</PRE>

<CODE>TIMEDIFF()</CODE> was added in MySQL 4.1.1.

<DT><CODE>TIMESTAMP(expr)</CODE>
<DD>
<DT><CODE>TIMESTAMP(expr,expr2)</CODE>
<DD>
<A NAME="IDX1415"></A>

With one argument, returns the date or datetime expression <CODE>expr</CODE>
as a datetime value.
With two arguments, adds the time expression <CODE>expr2</CODE> to the
date or datetime expression <CODE>expr</CODE> and returns a datetime value.


<PRE>
mysql&#62; SELECT TIMESTAMP('2003-12-31');
        -&#62; '2003-12-31 00:00:00'
mysql&#62; SELECT TIMESTAMP('2003-12-31 12:00:00','12:00:00');
        -&#62; '2004-01-01 00:00:00'
</PRE>

<CODE>TIMESTAMP()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>TIMESTAMPADD(interval,int_expr,datetime_expr)</CODE>
<DD>
<A NAME="IDX1416"></A>

Adds the integer expression <CODE>int_expr</CODE> to the date or datetime expression
<CODE>datetime_expr</CODE>. The unit for <CODE>int_expr</CODE> is given by the
<CODE>interval</CODE> argument, which should be one of the following values:
<CODE>FRAC_SECOND</CODE>,
<CODE>SECOND</CODE>,
<CODE>MINUTE</CODE>,
<CODE>HOUR</CODE>,
<CODE>DAY</CODE>,
<CODE>WEEK</CODE>,
<CODE>MONTH</CODE>,
<CODE>QUARTER</CODE>,
or
<CODE>YEAR</CODE>.

The <CODE>interval</CODE> value may be specified using one of keywords as shown,
or with a prefix of <CODE>SQL_TSI_</CODE>. For example, <CODE>DAY</CODE> or
<CODE>SQL_TSI_DAY</CODE> both are legal.


<PRE>
mysql&#62; SELECT TIMESTAMPADD(MINUTE,1,'2003-01-02');
        -&#62; '2003-01-02 00:01:00'
mysql&#62; SELECT TIMESTAMPADD(WEEK,1,'2003-01-02');
        -&#62; '2003-01-09'
</PRE>

<CODE>TIMESTAMPADD()</CODE> is available as of MySQL 5.0.0.

<DT><CODE>TIMESTAMPDIFF(interval,datetime_expr1,datetime_expr2)</CODE>
<DD>
<A NAME="IDX1417"></A>

Returns the integer difference between the date or datetime expressions
<CODE>datetime_expr1</CODE> and
<CODE>datetime_expr2</CODE>. The unit for the result is given by the
<CODE>interval</CODE> argument. The legal values for <CODE>interval</CODE> are the same as
those listed in the description of the <CODE>TIMESTAMPADD()</CODE> function.


<PRE>
mysql&#62; SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01');
        -&#62; 3
mysql&#62; SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01');
        -&#62; -1
</PRE>

<CODE>TIMESTAMPDIFF()</CODE> is available as of MySQL 5.0.0.

<DT><CODE>TIME_FORMAT(time,format)</CODE>
<DD>
<A NAME="IDX1418"></A>
This is used like the <CODE>DATE_FORMAT()</CODE> function, but the
<CODE>format</CODE> string may contain only those format specifiers that handle
hours, minutes, and seconds.  Other specifiers produce a <CODE>NULL</CODE> value or
<CODE>0</CODE>.

If the <CODE>time</CODE> value contains an hour part that is greater than
<CODE>23</CODE>, the <CODE>%H</CODE> and <CODE>%k</CODE> hour format specifiers produce a
value larger than the usual range of <CODE>0..23</CODE>. The other hour format
specifiers produce the hour value modulo 12.


<PRE>
mysql&#62; SELECT TIME_FORMAT('100:00:00', '%H %k %h %I %l');
        -&#62; '100 100 04 04 4'
</PRE>

<DT><CODE>TIME_TO_SEC(time)</CODE>
<DD>
<A NAME="IDX1419"></A>
Returns the <CODE>time</CODE> argument, converted to seconds.


<PRE>
mysql&#62; SELECT TIME_TO_SEC('22:23:00');
        -&#62; 80580
mysql&#62; SELECT TIME_TO_SEC('00:39:38');
        -&#62; 2378
</PRE>

<DT><CODE>TO_DAYS(date)</CODE>
<DD>
<A NAME="IDX1420"></A>
Given a date <CODE>date</CODE>, returns a daynumber (the number of days since year
0).


<PRE>
mysql&#62; SELECT TO_DAYS(950501);
        -&#62; 728779
mysql&#62; SELECT TO_DAYS('1997-10-07');
        -&#62; 729669
</PRE>

<CODE>TO_DAYS()</CODE> is not intended for use with values that precede the advent
of the Gregorian calendar (1582), because it does not take into account the
days that were lost when the calendar was changed.

Remember that MySQL converts two-digit year values in dates to
four-digit form using the rules in section <A HREF="manual.html#Date_and_time_types">12.3  Date and Time Types</A>.  For example,
<CODE>'1997-10-07'</CODE> and <CODE>'97-10-07'</CODE> are seen as identical dates:


<PRE>
mysql&#62; SELECT TO_DAYS('1997-10-07'), TO_DAYS('97-10-07');
        -&#62; 729669, 729669
</PRE>

For other dates before 1582, results from this function are undefined.

<DT><CODE>UNIX_TIMESTAMP()</CODE>
<DD>
<DT><CODE>UNIX_TIMESTAMP(date)</CODE>
<DD>
<A NAME="IDX1421"></A>
If called with no argument, returns a Unix timestamp (seconds since
<CODE>'1970-01-01 00:00:00'</CODE> GMT) as an unsigned integer. If
<CODE>UNIX_TIMESTAMP()</CODE> is called with a <CODE>date</CODE> argument, it
returns the value of the argument as seconds since <CODE>'1970-01-01
00:00:00'</CODE> GMT.  <CODE>date</CODE> may be a <CODE>DATE</CODE> string, a
<CODE>DATETIME</CODE> string, a <CODE>TIMESTAMP</CODE>, or a number in the format
<CODE>YYMMDD</CODE> or <CODE>YYYYMMDD</CODE> in local time.


<PRE>
mysql&#62; SELECT UNIX_TIMESTAMP();
        -&#62; 882226357
mysql&#62; SELECT UNIX_TIMESTAMP('1997-10-04 22:23:00');
        -&#62; 875996580
</PRE>

When <CODE>UNIX_TIMESTAMP</CODE> is used on a <CODE>TIMESTAMP</CODE> column, the function
returns the internal timestamp value directly, with no implicit
``string-to-Unix-timestamp'' conversion.
If you pass an out-of-range date to <CODE>UNIX_TIMESTAMP()</CODE>, it
returns <CODE>0</CODE>, but please note that only basic range checking is performed
(year from <CODE>1970</CODE> to <CODE>2037</CODE>, month from <CODE>01</CODE> to <CODE>12</CODE>, day
from <CODE>01</CODE> from <CODE>31</CODE>).

If you want to subtract <CODE>UNIX_TIMESTAMP()</CODE> columns, you might want to
cast the result to signed integers. See section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.

<DT><CODE>UTC_DATE</CODE>
<DD>
<DT><CODE>UTC_DATE()</CODE>
<DD>
<A NAME="IDX1422"></A>
Returns the current UTC date as a value in <CODE>'YYYY-MM-DD'</CODE> or
<CODE>YYYYMMDD</CODE> format, depending on whether the function is used in a
string or numeric context.


<PRE>
mysql&#62; SELECT UTC_DATE(), UTC_DATE() + 0;
        -&#62; '2003-08-14', 20030814
</PRE>

<CODE>UTC_DATE()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>UTC_TIME</CODE>
<DD>
<DT><CODE>UTC_TIME()</CODE>
<DD>
<A NAME="IDX1423"></A>
Returns the current UTC time as a value in <CODE>'HH:MM:SS'</CODE> or <CODE>HHMMSS</CODE>
format, depending on whether the function is used in a string or numeric
context.


<PRE>
mysql&#62; SELECT UTC_TIME(), UTC_TIME() + 0;
        -&#62; '18:07:53', 180753
</PRE>

<CODE>UTC_TIME()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>UTC_TIMESTAMP</CODE>
<DD>
<DT><CODE>UTC_TIMESTAMP()</CODE>
<DD>
<A NAME="IDX1424"></A>
Returns the current UTC date and time as a value in <CODE>'YYYY-MM-DD HH:MM:SS'</CODE>
or <CODE>YYYYMMDDHHMMSS</CODE> format, depending on whether the function is used in
a string or numeric context.


<PRE>
mysql&#62; SELECT UTC_TIMESTAMP(), UTC_TIMESTAMP() + 0;
        -&#62; '2003-08-14 18:08:04', 20030814180804
</PRE>

<CODE>UTC_TIMESTAMP()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>WEEK(date[,mode])</CODE>
<DD>
<A NAME="IDX1425"></A>
The function returns the week number for <CODE>date</CODE>.  The two-argument form
of <CODE>WEEK()</CODE> allows you to specify whether the week starts on Sunday or
Monday and whether the return value should be in the range from <CODE>0</CODE> to
<CODE>53</CODE> or from <CODE>1</CODE> to <CODE>52</CODE>. If the <CODE>mode</CODE> argument is
omitted, the value of the <CODE>default_week_format</CODE> system variable is
used (or <CODE>0</CODE> before MySQL 4.0.14).
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

The following table describes how the <CODE>mode</CODE> argument works:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Value</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>0</CODE> </TD><TD> Week starts on Sunday; return value range is <CODE>0</CODE> to
<CODE>53</CODE>; week 1 is the first week that starts in this year
</TD></TR>
<TR><TD><CODE>1</CODE> </TD><TD> Week starts on Monday; return value range is <CODE>0</CODE> to
<CODE>53</CODE>; week 1 is the first week that has more than three days in this year
</TD></TR>
<TR><TD><CODE>2</CODE> </TD><TD> Week starts on Sunday; return value range is <CODE>1</CODE> to
<CODE>53</CODE>; week 1 is the first week that starts in this year
</TD></TR>
<TR><TD><CODE>3</CODE> </TD><TD> Week starts on Monday; return value range is <CODE>1</CODE> to
<CODE>53</CODE>; week 1 is the first week that has more than three days in this year
</TD></TR>
<TR><TD><CODE>4</CODE> </TD><TD> Week starts on Sunday; return value range is <CODE>0</CODE> to
<CODE>53</CODE>; week 1 is the first week that has more than three days in this year
</TD></TR>
<TR><TD><CODE>5</CODE> </TD><TD> Week starts on Monday; return value range is <CODE>0</CODE> to
<CODE>53</CODE>; week 1 is the first week that starts in this year
</TD></TR>
<TR><TD><CODE>6</CODE> </TD><TD> Week starts on Sunday; return value range is <CODE>1</CODE> to
<CODE>53</CODE>; week 1 is the first week that has more than three days in this year
</TD></TR>
<TR><TD><CODE>7</CODE> </TD><TD> Week starts on Monday; return value range is <CODE>1</CODE> to
<CODE>53</CODE>; week 1 is the first week that starts in this year
</TD></TR>
</TABLE>

The <CODE>mode</CODE> value of <CODE>3</CODE> can be used as of MySQL 4.0.5.
Values of <CODE>4</CODE> and above can be used as of MySQL 4.0.17.


<PRE>
mysql&#62; SELECT WEEK('1998-02-20');
        -&#62; 7
mysql&#62; SELECT WEEK('1998-02-20',0);
        -&#62; 7
mysql&#62; SELECT WEEK('1998-02-20',1);
        -&#62; 8
mysql&#62; SELECT WEEK('1998-12-31',1);
        -&#62; 53
</PRE>

Note: In MySQL 4.0, <CODE>WEEK(date,0)</CODE> was changed to match the
calendar in the USA.  Before that, <CODE>WEEK()</CODE> was calculated incorrectly
for dates in the USA. (In effect, <CODE>WEEK(date)</CODE> and <CODE>WEEK(date,0)</CODE> were
incorrect for all cases.)

Note that if a date falls in the last week of the previous year, MySQL
returns <CODE>0</CODE> if you don't use <CODE>2</CODE>, <CODE>3</CODE>, <CODE>6</CODE>, or <CODE>7</CODE>
as the optional <CODE>mode</CODE> argument:


<PRE>
mysql&#62; SELECT YEAR('2000-01-01'), WEEK('2000-01-01',0);
        -&#62; 2000, 0
</PRE>

One might argue that MySQL should return <CODE>52</CODE> for the <CODE>WEEK()</CODE>
function, because the given date actually occurs in the 52nd week of 1999.  We
decided to return <CODE>0</CODE> instead because we want the function to return ``the week
number in the given year.''  This makes use of the <CODE>WEEK()</CODE>
function reliable when combined with other functions that extract a
date part from a date.

If you would prefer the result to be evaluated with respect to the year
that contains the first day of the week for the given date, you should use
<CODE>2</CODE>, <CODE>3</CODE>, <CODE>6</CODE>, or <CODE>7</CODE> as the optional <CODE>mode</CODE> argument.


<PRE>
mysql&#62; SELECT WEEK('2000-01-01',2);
        -&#62; 52
</PRE>

Alternatively, use the <CODE>YEARWEEK()</CODE> function:


<PRE>
mysql&#62; SELECT YEARWEEK('2000-01-01');
        -&#62; 199952
mysql&#62; SELECT MID(YEARWEEK('2000-01-01'),5,2);
        -&#62; '52'
</PRE>

<DT><CODE>WEEKDAY(date)</CODE>
<DD>
<A NAME="IDX1426"></A>
Returns the weekday index for
<CODE>date</CODE> (<CODE>0</CODE> = Monday, <CODE>1</CODE> = Tuesday, ... <CODE>6</CODE> = Sunday).


<PRE>
mysql&#62; SELECT WEEKDAY('1998-02-03 22:23:00');
        -&#62; 1
mysql&#62; SELECT WEEKDAY('1997-11-05');
        -&#62; 2
</PRE>

<DT><CODE>WEEKOFYEAR(date)</CODE>
<DD>
<A NAME="IDX1427"></A>

Returns the calendar week of the date as a number in the
range from <CODE>1</CODE> to <CODE>53</CODE>.


<PRE>
mysql&#62; SELECT WEEKOFYEAR('1998-02-20');
        -&#62; 8
</PRE>

<CODE>WEEKOFYEAR()</CODE> is available as of MySQL 4.1.1.

<DT><CODE>YEAR(date)</CODE>
<DD>
<A NAME="IDX1428"></A>
Returns the year for <CODE>date</CODE>, in the range <CODE>1000</CODE> to <CODE>9999</CODE>.


<PRE>
mysql&#62; SELECT YEAR('98-02-03');
        -&#62; 1998
</PRE>

<DT><CODE>YEARWEEK(date)</CODE>
<DD>
<DT><CODE>YEARWEEK(date,start)</CODE>
<DD>
Returns year and week for a date.  The <CODE>start</CODE> argument works exactly
like the <CODE>start</CODE> argument to <CODE>WEEK()</CODE>.  The year in the
result may be
different from the year in the date argument for the first and the last
week of the year.


<PRE>
mysql&#62; SELECT YEARWEEK('1987-01-01');
        -&#62; 198653
</PRE>

Note that the week number is different from what the <CODE>WEEK()</CODE>
function would return (<CODE>0</CODE>) for optional arguments <CODE>0</CODE> or <CODE>1</CODE>,
as <CODE>WEEK()</CODE> then returns the week in the context of the given year.

<CODE>YEARWEEK()</CODE> was added in MySQL 3.23.8.

</DL>



<H2><A NAME="Fulltext_Search" HREF="manual_toc.html#Fulltext_Search">13.6  Full-Text Search Functions</A></H2>

<P>
<A NAME="IDX1429"></A>
<A NAME="IDX1430"></A>
<A NAME="IDX1431"></A>

</P>

<DL COMPACT>

<DT><CODE>MATCH (col1,col2,...) AGAINST (expr [IN BOOLEAN MODE | WITH QUERY EXPANSION])</CODE>
<DD>
<A NAME="IDX1432"></A>

As of MySQL 3.23.23, MySQL has support for full-text indexing
and searching.  A full-text index in MySQL is an index of type
<CODE>FULLTEXT</CODE>.  <CODE>FULLTEXT</CODE> indexes are used with <CODE>MyISAM</CODE> tables
only and can be created from <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>,
or <CODE>TEXT</CODE> columns at <CODE>CREATE TABLE</CODE> time or added later with
<CODE>ALTER TABLE</CODE> or <CODE>CREATE INDEX</CODE>.  For large datasets, it will be
much faster to load your data into a table that has no <CODE>FULLTEXT</CODE>
index, then create the index with <CODE>ALTER TABLE</CODE> (or
<CODE>CREATE INDEX</CODE>).  Loading data into a table that already has a
<CODE>FULLTEXT</CODE> index could be significantly slower.

Constraints on full-text searching are listed in section <A HREF="manual.html#Fulltext_Restrictions">13.6.3  Full-Text Restrictions</A>.

</DL>

<P>
Full-text searching is performed with the <CODE>MATCH()</CODE> function.

</P>

<PRE>
mysql&#62; CREATE TABLE articles (
    -&#62;   id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    -&#62;   title VARCHAR(200),
    -&#62;   body TEXT,
    -&#62;   FULLTEXT (title,body)
    -&#62; );
Query OK, 0 rows affected (0.00 sec)

mysql&#62; INSERT INTO articles (title,body) VALUES
    -&#62; ('MySQL Tutorial','DBMS stands for DataBase ...'),
    -&#62; ('How To Use MySQL Well','After you went through a ...'),
    -&#62; ('Optimizing MySQL','In this tutorial we will show ...'),
    -&#62; ('1001 MySQL Tricks','1. Never run mysqld as root. 2. ...'),
    -&#62; ('MySQL vs. YourSQL','In the following database comparison ...'),
    -&#62; ('MySQL Security','When configured properly, MySQL ...');
Query OK, 6 rows affected (0.00 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql&#62; SELECT * FROM articles
    -&#62; WHERE MATCH (title,body) AGAINST ('database');
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)
</PRE>

<P>
The <CODE>MATCH()</CODE> function performs a natural language search for a string
against a text collection. A collection is a set of one or more columns
included in a <CODE>FULLTEXT</CODE> index.  The search string is given as the
argument to <CODE>AGAINST()</CODE>.  The search is performed in case-insensitive
fashion.  For every row in the table, <CODE>MATCH()</CODE> returns a relevance
value, that is, a similarity measure between the search string and the text
in that row in the columns named in the <CODE>MATCH()</CODE> list.

</P>
<P>
When <CODE>MATCH()</CODE> is used in a <CODE>WHERE</CODE> clause, as in the preceding
example,
the rows returned are automatically sorted with the highest relevance first.
Relevance values are non-negative floating-point numbers.  Zero relevance
means no similarity.  Relevance is computed based on the number of words
in the row, the number of unique words in that row, the total number of
words in the collection, and the number of documents (rows) that contain
a particular word.

</P>
<P>
For natural-language full-text searches, it is a requirement that the
columns named in the <CODE>MATCH()</CODE> function be the same columns included in
some <CODE>FULLTEXT</CODE> index in your table.  For the preceding query, note
that the columns named in the <CODE>MATCH()</CODE> function (<CODE>title</CODE> and
<CODE>body</CODE>) are the same as those named in the definition of the
<CODE>article</CODE> table's <CODE>FULLTEXT</CODE> index.  If you wanted to search the
<CODE>title</CODE> or <CODE>body</CODE> separately, you would need to create
<CODE>FULLTEXT</CODE> indexes for each column.

</P>
<P>
It is also possible to perform a boolean search or a search with query
expansion.  These search types are described in section <A HREF="manual.html#Fulltext_Boolean">13.6.1  Boolean Full-Text Searches</A> and
section <A HREF="manual.html#Fulltext_Query_Expansion">13.6.2  Full-Text Searches with Query Expansion</A>.

</P>
<P>
The preceding example is a basic illustration showing how to use the
<CODE>MATCH()</CODE> function where rows are returned in order of decreasing
relevance.  The next example shows how to retrieve the relevance values
explicitly.  Returned rows are not ordered because the <CODE>SELECT</CODE>
statement includes neither <CODE>WHERE</CODE> nor <CODE>ORDER BY</CODE> clauses:

</P>

<PRE>
mysql&#62; SELECT id, MATCH (title,body) AGAINST ('Tutorial')
    -&#62; FROM articles;
+----+-----------------------------------------+
| id | MATCH (title,body) AGAINST ('Tutorial') |
+----+-----------------------------------------+
|  1 |                        0.65545833110809 |
|  2 |                                       0 |
|  3 |                        0.66266459226608 |
|  4 |                                       0 |
|  5 |                                       0 |
|  6 |                                       0 |
+----+-----------------------------------------+
6 rows in set (0.00 sec)
</PRE>

<P>
The following example is more complex.  The query returns the relevance values
and it also sorts the rows in order of decreasing relevance. To achieve
this result, you should specify <CODE>MATCH()</CODE> twice: once in the
<CODE>SELECT</CODE> list and once in the <CODE>WHERE</CODE> clause. This causes no
additional overhead, because the MySQL optimizer notices that the
two <CODE>MATCH()</CODE> calls are identical and invokes the full-text search
code only once.

</P>

<PRE>
mysql&#62; SELECT id, body, MATCH (title,body) AGAINST
    -&#62; ('Security implications of running MySQL as root') AS score
    -&#62; FROM articles WHERE MATCH (title,body) AGAINST
    -&#62; ('Security implications of running MySQL as root');
+----+-------------------------------------+-----------------+
| id | body                                | score           |
+----+-------------------------------------+-----------------+
|  4 | 1. Never run mysqld as root. 2. ... | 1.5219271183014 |
|  6 | When configured properly, MySQL ... | 1.3114095926285 |
+----+-------------------------------------+-----------------+
2 rows in set (0.00 sec)
</PRE>

<P>
MySQL uses a very simple parser to split text into words.  A ``word'' is any
sequence of characters consisting of letters, digits, <SAMP>`''</SAMP>, or <SAMP>`_'</SAMP>.
Some words are ignored in full-text searches:

</P>

<UL>
<LI>

Any word that is too short is ignored.  The default minimum length of
words that will be found by full-text searches is four characters.

<LI>

Words in the stopword list are ignored.  A stopword is a word such as
``the'' or ``some'' that is so common that it is considered to have zero
semantic value.  There is a built-in stopword list.

</UL>

<P>
The default minimum word length and stopword list can be changed as
described in section <A HREF="manual.html#Fulltext_Fine-tuning">13.6.4  Fine-Tuning MySQL Full-Text Search</A>.

</P>

<P>
Every correct word in the collection and in the query is weighted
according to its significance in the collection or query.  This way, a
word that is present in many documents has a lower weight (and may
even have a zero weight), because it has lower semantic value in this
particular collection.  Conversely, if the word is rare, it receives a
higher weight.  The weights of the words are then combined to compute the
relevance of the row.

</P>
<P>
Such a technique works best with large collections (in fact, it was
carefully tuned this way).  For very small tables, word distribution
does not adequately reflect their semantic value, and this model
may sometimes produce bizarre results. For example, although the word
``MySQL'' is present in every row of the <CODE>articles</CODE> table, a search for
the word produces no results:

</P>

<PRE>
mysql&#62; SELECT * FROM articles
    -&#62; WHERE MATCH (title,body) AGAINST ('MySQL');
Empty set (0.00 sec)
</PRE>

<P>
The search result is empty because the word ``MySQL'' is present in at least
50% of the rows.  As such, it is effectively treated as a stopword.
For large datasets, this is the most desirable behavior--a natural language
query should not return every second row from a 1GB table. For small datasets,
it may be less desirable.

</P>
<P>
A word that matches half of rows in a table is less likely to locate relevant
documents.  In fact, it will most likely find plenty of irrelevant documents.
We all know this happens far too often when we are trying to find something on
the Internet with a search engine.  It is with this reasoning that rows
containing the word are assigned a low semantic value for <EM>the
particular dataset in which they occur</EM>.  A given word may exceed the 50%
threshold in one dataset but not another.

</P>
<P>
The 50% threshold has a significant implication when you first try
full-text searching to see how it works: If you create a table and insert only
one or two rows of text into it, every word in the text occurs in at least
50% of the rows. As a result, no search returns any results. Be sure to
insert at least three rows, and preferably many more.

</P>



<H3><A NAME="Fulltext_Boolean" HREF="manual_toc.html#Fulltext_Boolean">13.6.1  Boolean Full-Text Searches</A></H3>

<P>
As of Version 4.0.1, MySQL can also perform boolean full-text searches using
the <CODE>IN BOOLEAN MODE</CODE> modifier.

</P>

<PRE>
mysql&#62; SELECT * FROM articles WHERE MATCH (title,body)
    -&#62; AGAINST ('+MySQL -YourSQL' IN BOOLEAN MODE);
+----+-----------------------+-------------------------------------+
| id | title                 | body                                |
+----+-----------------------+-------------------------------------+
|  1 | MySQL Tutorial        | DBMS stands for DataBase ...        |
|  2 | How To Use MySQL Well | After you went through a ...        |
|  3 | Optimizing MySQL      | In this tutorial we will show ...   |
|  4 | 1001 MySQL Tricks     | 1. Never run mysqld as root. 2. ... |
|  6 | MySQL Security        | When configured properly, MySQL ... |
+----+-----------------------+-------------------------------------+
</PRE>

<P>
This query retrieves all the rows that contain the word ``MySQL''
but that do <EM>not</EM> contain
the word ``YourSQL''.

</P>
<P>
Boolean full-text searches have these characteristics:

</P>

<UL>
<LI>

They do not use the 50% threshold.

<LI>

They do not automatically sort rows in order of decreasing relevance.  You
can see this from the preceding query result: The row with the highest
relevance is the one that contains ``MySQL'' twice, but it is listed last,
not first.

<LI>

They can work even without a <CODE>FULLTEXT</CODE> index, although this would be
<EM>slow</EM>.

</UL>

<P>
The boolean full-text search capability supports the following operators:

</P>

<DL COMPACT>

<DT><CODE>+</CODE>
<DD>
A leading plus sign indicates that this word <EM>must be</EM>
present in every row returned.

<DT><CODE>-</CODE>
<DD>
A leading minus sign indicates that this word <EM>must not be</EM>
present in any row returned.

<DT><CODE>(no operator)</CODE>
<DD>
By default (when neither <CODE>+</CODE> nor <CODE>-</CODE> is specified) the word is optional,
but the rows that contain it will be rated higher. This mimics the
behavior of <CODE>MATCH() ... AGAINST()</CODE> without the <CODE>IN BOOLEAN
MODE</CODE> modifier.

<DT><CODE>&#62; &#60;</CODE>
<DD>
These two operators are used to change a word's contribution to the
relevance value that is assigned to a row.  The <CODE>&#62;</CODE> operator
increases the contribution and the <CODE>&#60;</CODE> operator decreases it.
See the example below.

<DT><CODE>( )</CODE>
<DD>
Parentheses are used to group words into subexpressions.
Parenthesized groups can be nested.

<DT><CODE>~</CODE>
<DD>
A leading tilde acts as a negation operator, causing the word's
contribution to the row relevance to be negative. It's useful for marking
noise words. A row that contains such a word will be rated lower than
others, but will not be excluded altogether, as it would be with the
<CODE>-</CODE> operator.

<DT><CODE>*</CODE>
<DD>
An asterisk is the truncation operator. Unlike the other operators, it
should be <EM>appended</EM> to the word, not prepended.

<DT><CODE>"</CODE>
<DD>
A phrase that is enclosed within double quote (<SAMP>`"'</SAMP>) characters matches only
rows that contain the phrase <EM>literally, as it was typed</EM>.

</DL>

<P>
The following examples demonstrate some search strings that use boolean
full-text operators:

</P>
<DL COMPACT>

<DT><CODE>'apple banana'</CODE>
<DD>
Find rows that contain at least one of the two words.

<DT><CODE>'+apple +juice'</CODE>
<DD>
Find rows that contain both words.

<DT><CODE>'+apple macintosh'</CODE>
<DD>
Find rows that contain the
word ``apple'', but rank rows higher if they also contain ``macintosh''.

<DT><CODE>'+apple -macintosh'</CODE>
<DD>
Find rows that contain the
word ``apple'' but not ``macintosh''.

<DT><CODE>'+apple +(&#62;turnover &#60;strudel)'</CODE>
<DD>
Find rows that contain the words
``apple'' and ``turnover'', or ``apple'' and ``strudel'' (in any
order), but rank ``apple turnover'' higher than ``apple strudel''.

<DT><CODE>'apple*'</CODE>
<DD>
Find rows that contain words such as
``apple'', ``apples'', ``applesauce'', or ``applet''.

<DT><CODE>'"some words"'</CODE>
<DD>
Find rows that contain the exact phrase ``some words'' (for example, rows
that contain ``some words of wisdom'' but not ``some noise words'').  Note
that the <SAMP>`"'</SAMP> characters that surround the phrase are operator characters
that delimit the phrase.
They are not the quotes that surround the search string
itself.

</DL>



<H3><A NAME="Fulltext_Query_Expansion" HREF="manual_toc.html#Fulltext_Query_Expansion">13.6.2  Full-Text Searches with Query Expansion</A></H3>

<P>
As of MySQL 4.1.1, full-text search supports query expansion (in particular,
its variant ``blind query expansion''). This is generally useful when a search
phrase is too short, which often means that the user is relying on implied
knowledge that the full-text search engine usually lacks. For example, a user
searching for ``database'' may really mean that ``MySQL'', ``Oracle'',
``DB2'', and ``RDBMS'' all are phrases that should match
``databases'' and should be returned, too. This is implied knowledge.

</P>
<P>
Blind query expansion (also known as automatic relevance feedback) is
enabled by adding <CODE>WITH QUERY EXPANSION</CODE> following the search phrase.
It works by performing the search twice, where the search phrase for the
second search is the original search phrase concatenated with the few top
found documents from the first search.  Thus, if one of these documents
contains the word ``databases'' and the word ``MySQL'', the second search
will find the documents that contain the word ``MySQL'' even if they do not
contain the word ``database''.  The following example shows this difference:

</P>

<PRE>
mysql&#62; SELECT * FROM articles
    -&#62; WHERE MATCH (title,body) AGAINST ('database');
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
+----+-------------------+------------------------------------------+
2 rows in set (0.00 sec)

mysql&#62; SELECT * FROM articles
    -&#62; WHERE MATCH (title,body)
    -&#62; AGAINST ('database' WITH QUERY EXPANSION);
+----+-------------------+------------------------------------------+
| id | title             | body                                     |
+----+-------------------+------------------------------------------+
|  1 | MySQL Tutorial    | DBMS stands for DataBase ...             |
|  5 | MySQL vs. YourSQL | In the following database comparison ... |
|  3 | Optimizing MySQL  | In this tutorial we will show ...        |
+----+-------------------+------------------------------------------+
3 rows in set (0.00 sec)
</PRE>

<P>
Another example could be searching for books by Georges Simenon about
Maigret, when a user is not sure how to spell ``Maigret''. A search for
``Megre and the reluctant witnesses'' will find only ``Maigret and the
Reluctant Witnesses'' without query expansion.  A search with query
expansion will find all books with the word ``Maigret'' on the second pass.

</P>
<P>
Note: Because blind query expansion tends to increase noise significantly
by returning non-relevant documents, it's only meaningful to use when a
search phrase is rather short.

</P>



<H3><A NAME="Fulltext_Restrictions" HREF="manual_toc.html#Fulltext_Restrictions">13.6.3  Full-Text Restrictions</A></H3>


<UL>
<LI>

Full-text searches are supported for <CODE>MyISAM</CODE> tables only.
<LI>

As of MySQL 4.1.1, full-text searches can be used with most multi-byte
character sets. The exception is that for Unicode, the <CODE>utf8</CODE> character
set can be used, but not the <CODE>ucs2</CODE> character set.
<LI>

As of MySQL 4.1, the use of multiple character sets within a single table
is supported. However, all columns in a <CODE>FULLTEXT</CODE> index must have
the same character set and collation.
<LI>

The <CODE>MATCH()</CODE> column list must exactly match the column list in some
<CODE>FULLTEXT</CODE> index definition for the table, unless this <CODE>MATCH()</CODE>
is <CODE>IN BOOLEAN MODE</CODE>.
<LI>

The argument to <CODE>AGAINST()</CODE> must be a constant string.
</UL>



<H3><A NAME="Fulltext_Fine-tuning" HREF="manual_toc.html#Fulltext_Fine-tuning">13.6.4  Fine-Tuning MySQL Full-Text Search</A></H3>

<P>
The MySQL full-text search capability has few user-tunable parameters yet,
although adding more is very high on the TODO.  You can exert more control
over full-text searching behavior if you have a MySQL source distribution
because some changes require source code modfications.
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.

</P>
<P>
Note that full-text search was carefully tuned for the best searching
effectiveness.  Modifying the default behavior will, in most cases,
make the search results worse.  Do not alter the MySQL sources
unless you know what you are doing!

</P>
<P>
Most full-text variables described in the following items must be set at
server startup time. For these variables, a server restart is required to
change them and you cannot modify them dynamically while the server is
running.

</P>
<P>
Some variable changes require that you rebuild the <CODE>FULLTEXT</CODE> indexes
in your tables. Instructions for doing this are given at the end of this
section.

</P>

<UL>

<LI>

The minimum and maximum length of words to be indexed is defined by the
<CODE>ft_min_word_len</CODE> and <CODE>ft_max_word_len</CODE> system variables
(available as of MySQL 4.0.0).
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
The default minimum value is four characters.  The default maximum depends
on your version of MySQL. If you change either value, you must rebuild your
<CODE>FULLTEXT</CODE> indexes.  For example, if you want three-character words to
be searchable, you can set the <CODE>ft_min_word_len</CODE> variable by putting
the following lines in an option file:


<PRE>
[mysqld]
ft_min_word_len=3
</PRE>

Then restart the server and rebuild your <CODE>FULLTEXT</CODE> indexes.
Also note particularly the remarks regarding <CODE>myisamchk</CODE> in the
instructions following this list.

<LI>

To override the default stopword list, set the <CODE>ft_stopword_file</CODE>
system variable (available as of MySQL 4.0.10).
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
The variable value should be the pathname of the file containing the stopword
list, or the empty string to disable stopword filtering. After changing the value, rebuild your <CODE>FULLTEXT</CODE> indexes.

<LI>

The 50% threshold for natural language searches is determined by the
particular weighting scheme chosen.  To disable it, look for the following
line in <TT>`myisam/ftdefs.h'</TT>:


<PRE>
#define GWS_IN_USE GWS_PROB
</PRE>

Change the line to this:


<PRE>
#define GWS_IN_USE GWS_FREQ
</PRE>

Then recompile MySQL.
There is no need to rebuild the indexes in this case.
<STRONG>Note:</STRONG> By doing this you <EM>severely</EM> decrease MySQL's ability
to provide adequate relevance values for the <CODE>MATCH()</CODE> function.
If you really need to search for such common words, it would be better to
search using <CODE>IN BOOLEAN MODE</CODE> instead, which does not observe the 50%
threshold.

<LI>

To change the operators used for boolean full-text searches, set the
<CODE>ft_boolean_syntax</CODE> system variable (available as of MySQL 4.0.1).  The
variable also can be changed while the server is running, but you must have
the <CODE>SUPER</CODE> privilege to do so.
No index rebuilding is necessary.
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A> describes the rules that define how to set this
variable.

</UL>

<P>
If you modify full-text variables that affect indexing
(<CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>, or
<CODE>ft_stopword_file</CODE>), you must rebuild your <CODE>FULLTEXT</CODE> indexes
after making the changes and restarting the server. To rebuild the indexes
in this case, it's sufficient to do a <CODE>QUICK</CODE> repair operation:

</P>

<PRE>
mysql&#62; REPAIR TABLE tbl_name QUICK;
</PRE>

<P>
With regard specifically to using the <CODE>IN BOOLEAN MODE</CODE> capability, if
you upgrade from MySQL 3.23 to 4.0 or later, it's necessary to replace the
index header as well.  To do this, do a <CODE>USE_FRM</CODE> repair operation:

</P>

<PRE>
mysql&#62; REPAIR TABLE tbl_name USE_FRM;
</PRE>

<P>
This is necessary because boolean full-text searches require a flag in the
index header that was not present in MySQL 3.23, and that is not added if
you do only a <CODE>QUICK</CODE> repair.  If you attempt a boolean full-text
search without rebuilding the indexes this way, the search will return
incorrect results.

</P>
<P>
Note that if you use <CODE>myisamchk</CODE> to perform an operation that modifies
table indexes (such as repair or analyze), the <CODE>FULLTEXT</CODE> indexes
are rebuilt using the default full-text parameter values for minimum and
maximum word length and the stopword file unless you specify otherwise.
This can result in queries failing.

</P>
<P>
The problem occurs because these parameters are known only by the server.
They are not stored in <CODE>MyISAM</CODE> index files.  To avoid the problem if
you have modified the minimum or maximum word length or the stopword file in
the server, specify the same <CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>,
and <CODE>ft_stopword_file</CODE> values to <CODE>myisamchk</CODE> that you use for
<CODE>mysqld</CODE>. For example, if you have set the minimum word length to 3,
you can repair a table with <CODE>myisamchk</CODE> like this:

</P>

<PRE>
shell&#62; myisamchk --recover --ft_min_word_len=3 tbl_name.MYI
</PRE>

<P>
To ensure that <CODE>myisamchk</CODE> and the server use the same values for
full-text parameters, you can place each one in both the <CODE>[mysqld]</CODE>
and <CODE>[myisamchk]</CODE> sections of an option file:

</P>

<PRE>
[mysqld]
ft_min_word_len=3

[myisamchk]
ft_min_word_len=3
</PRE>

<P>
An alternative to using <CODE>myisamchk</CODE> is to use the <CODE>REPAIR TABLE</CODE>,
<CODE>ANALYZE TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, or <CODE>ALTER TABLE</CODE>.
These statements are performed by the server, which knows the proper
full-text parameter values to use.

</P>



<H3><A NAME="Fulltext_TODO" HREF="manual_toc.html#Fulltext_TODO">13.6.5  Full-Text Search TODO</A></H3>


<UL>
<LI>Improved performance for all <CODE>FULLTEXT</CODE> operations.

<LI>Proximity operators.

<LI>Support for ``always-index words.'' These could be any strings

the user wants to treat as words, such as ``C++'', ``AS/400'', or ``TCP/IP''.
<LI>Support for full-text search in <CODE>MERGE</CODE> tables.

<LI>Support for the <CODE>ucs2</CODE> character set.

<LI>Make the stopword list dependent on the language of the dataset.

<LI>Stemming (dependent on the language of the dataset).

<LI>Generic user-suppliable UDF preparser.

<LI>Make the model more flexible (by adding some adjustable

parameters to <CODE>FULLTEXT</CODE> in <CODE>CREATE TABLE</CODE> and <CODE>ALTER TABLE</CODE>
statements).
</UL>



<H2><A NAME="Cast_Functions" HREF="manual_toc.html#Cast_Functions">13.7  Cast Functions</A></H2>

<DL COMPACT>

<DT><CODE>CAST(expr AS type)</CODE>
<DD>
<DT><CODE>CONVERT(expr,type)</CODE>
<DD>
<DT><CODE>CONVERT(expr USING transcoding_name)</CODE>
<DD>
<A NAME="IDX1433"></A>
<A NAME="IDX1434"></A>

The <CODE>CAST()</CODE> and <CODE>CONVERT()</CODE> functions may be used to take a
value of one type and produce a value of another type.

The <CODE>type</CODE> can be one of the following values:


<UL>
<LI>

<CODE>BINARY</CODE>
<LI>

<CODE>CHAR</CODE>
<LI>

<CODE>DATE</CODE>
<LI>

<CODE>DATETIME</CODE>
<LI>

<CODE>SIGNED [INTEGER]</CODE>
<LI>

<CODE>TIME</CODE>
<LI>

<CODE>UNSIGNED [INTEGER]</CODE>
</UL>

<CODE>CAST()</CODE> and <CODE>CONVERT()</CODE> are available as of MySQL 4.0.2.
The <CODE>CHAR</CODE> conversion type is available as of 4.0.6.
The <CODE>USING</CODE> form of <CODE>CONVERT()</CODE> is available as of 4.1.0.

<CODE>CAST()</CODE> and <CODE>CONVERT(... USING ...)</CODE> are standard SQL syntax.
The non-<CODE>USING</CODE> form of <CODE>CONVERT()</CODE> is ODBC syntax.

<CODE>CONVERT()</CODE> with <CODE>USING</CODE> is used to convert data between different
character sets.  In MySQL, transcoding names are the same as the
corresponding character set names.  For example, this statement converts
the string <CODE>'abc'</CODE> in the server's default character set to the
corresponding string in the <CODE>utf8</CODE> character set:


<PRE>
SELECT CONVERT('abc' USING utf8);
</PRE>

</DL>

<P>
The cast functions are useful when you want to create a column with
a specific type in a <CODE>CREATE ... SELECT</CODE> statement:

</P>

<PRE>
CREATE TABLE new_table SELECT CAST('2000-01-01' AS DATE);
</PRE>

<P>
The functions also can be useful for sorting <CODE>ENUM</CODE> columns in lexical
order. Normally sorting of <CODE>ENUM</CODE> columns occurs using the internal
numeric values. Casting the values to <CODE>CHAR</CODE> results in a lexical
sort:

</P>

<PRE>
SELECT enum_col FROM tbl_name ORDER BY CAST(enum_col AS CHAR);
</PRE>

<P>
<CODE>CAST(str AS BINARY)</CODE> is the same thing as <CODE>BINARY str</CODE>.
<CODE>CAST(expr AS CHAR)</CODE> treats the expression as a string with the
default character set.

</P>
<P>
<STRONG>Note:</STRONG> In MysQL 4.0, a <CODE>CAST()</CODE> to <CODE>DATE</CODE>,
<CODE>DATETIME</CODE>, or <CODE>TIME</CODE> only marks the column to be a specific
type but doesn't change the value of the column.

</P>
<P>
As of MySQL 4.1.0, the value is converted to the correct column type when
it's sent to the user (this is a feature of how the new protocol in 4.1
sends date information to the client):

</P>

<PRE>
mysql&#62; SELECT CAST(NOW() AS DATE);
       -&#62; 2003-05-26
</PRE>

<P>
As of MySQL 4.1.1, <CODE>CAST()</CODE>
also changes the result if you use it as part of a more complex expression
such as <CODE>CONCAT('Date: ',CAST(NOW() AS DATE))</CODE>.

</P>
<P>
You should not use <CODE>CAST()</CODE> to extract data in different formats but
instead use string functions like <CODE>LEFT()</CODE> or
<CODE>EXTRACT()</CODE>. See section <A HREF="manual.html#Date_and_time_functions">13.5  Date and Time Functions</A>.

</P>
<P>
To cast a string to a numeric value, you don't normally have to do
anything. Just use the string value as though it were a number:

</P>

<PRE>
mysql&#62; SELECT 1+'1';
       -&#62; 2
</PRE>

<P>
If you use a number in string context, the number automatically is
converted to a <CODE>BINARY</CODE> string.

</P>

<PRE>
mysql&#62; SELECT CONCAT('hello you ',2);
        -&#62; 'hello you 2'
</PRE>

<P>
MySQL supports arithmetic with both signed and unsigned 64-bit values.
If you are using numerical operators (such as <CODE>+</CODE>) and one of the
operands is an unsigned integer, the result is unsigned.
You can override this by using the <CODE>SIGNED</CODE> and <CODE>UNSIGNED</CODE>
cast operators to cast the operation to a signed or
unsigned 64-bit integer, respectively.

</P>

<PRE>
mysql&#62; SELECT CAST(1-2 AS UNSIGNED)
        -&#62; 18446744073709551615
mysql&#62; SELECT CAST(CAST(1-2 AS UNSIGNED) AS SIGNED);
        -&#62; -1
</PRE>

<P>
Note that if either operand is a floating-point value, the result is
a floating-point value and is not affected by the preceding rule.
(In this context, <CODE>DECIMAL</CODE> column values are regarded as
floating-point values.)

</P>

<PRE>
mysql&#62; SELECT CAST(1 AS UNSIGNED) - 2.0;
        -&#62; -1.0
</PRE>

<P>
If you are using a string in an arithmetic operation, this is converted
to a floating-point number.

</P>
<P>
The handing of unsigned values was changed in MySQL 4.0 to be able to
support <CODE>BIGINT</CODE> values properly. If you have some code that you
want to run in both MySQL 4.0 and 3.23, you probably can't
use the <CODE>CAST()</CODE> function. You can use the following technique to get
a signed result when subtracting two unsigned integer columns <CODE>ucol1</CODE> and
<CODE>ucol2</CODE>:

</P>

<PRE>
mysql&#62; SELECT (ucol1+0.0)-(ucol2+0.0) FROM ...;
</PRE>

<P>
The idea is that the columns are converted to floating-point values before
the subtraction occurs.

</P>
<P>
If you have a problem with <CODE>UNSIGNED</CODE> columns in old MySQL
applications when porting them to MySQL 4.0, you can use the
<CODE>--sql-mode=NO_UNSIGNED_SUBTRACTION</CODE> option when starting
<CODE>mysqld</CODE>.  However, as long as you use this option, you will not
be able to make efficient use of the <CODE>BIGINT UNSIGNED</CODE> column type.

</P>



<H2><A NAME="Other_Functions" HREF="manual_toc.html#Other_Functions">13.8  Other Functions</A></H2>



<H3><A NAME="Bit_functions" HREF="manual_toc.html#Bit_functions">13.8.1  Bit Functions</A></H3>

<P>
<A NAME="IDX1435"></A>
<A NAME="IDX1436"></A>
<A NAME="IDX1437"></A>

</P>
<P>
MySQL uses <CODE>BIGINT</CODE> (64-bit) arithmetic for bit operations, so
these operators have a maximum range of 64 bits.

</P>
<DL COMPACT>

<DT><CODE>|</CODE>
<DD>
<A NAME="IDX1438"></A>
<A NAME="IDX1439"></A>
Bitwise OR:


<PRE>
mysql&#62; SELECT 29 | 15;
        -&#62; 31
</PRE>

The result is an unsigned 64-bit integer.

<DT><CODE>&#38;</CODE>
<DD>
<A NAME="IDX1440"></A>
<A NAME="IDX1441"></A>
Bitwise AND:


<PRE>
mysql&#62; SELECT 29 &#38; 15;
        -&#62; 13
</PRE>

The result is an unsigned 64-bit integer.

<DT><CODE>^</CODE>
<DD>
<A NAME="IDX1442"></A>
<A NAME="IDX1443"></A>
Bitwise XOR:


<PRE>
mysql&#62; SELECT 1 ^ 1;
        -&#62; 0
mysql&#62; SELECT 1 ^ 0;
        -&#62; 1
mysql&#62; SELECT 11 ^ 3;
        -&#62; 8
</PRE>

The result is an unsigned 64-bit integer.

Bitwise XOR was added in MySQL 4.0.2.

<DT><CODE>&#60;&#60;</CODE>
<DD>
<A NAME="IDX1444"></A>
Shifts a longlong (<CODE>BIGINT</CODE>) number to the left.


<PRE>
mysql&#62; SELECT 1 &#60;&#60; 2;
        -&#62; 4
</PRE>

The result is an unsigned 64-bit integer.

<DT><CODE>&#62;&#62;</CODE>
<DD>
<A NAME="IDX1445"></A>
Shifts a longlong (<CODE>BIGINT</CODE>) number to the right.


<PRE>
mysql&#62; SELECT 4 &#62;&#62; 2;
        -&#62; 1
</PRE>

The result is an unsigned 64-bit integer.

<DT><CODE>~</CODE>
<DD>
<A NAME="IDX1446"></A>
Invert all bits.


<PRE>
mysql&#62; SELECT 5 &#38; ~1;
        -&#62; 4
</PRE>

The result is an unsigned 64-bit integer.

<DT><CODE>BIT_COUNT(N)</CODE>
<DD>
<A NAME="IDX1447"></A>
Returns the number of bits that are set in the argument <CODE>N</CODE>.


<PRE>
mysql&#62; SELECT BIT_COUNT(29);
        -&#62; 4
</PRE>

</DL>



<H3><A NAME="Encryption_functions" HREF="manual_toc.html#Encryption_functions">13.8.2  Encryption Functions</A></H3>

<P>
<A NAME="IDX1448"></A>
<A NAME="IDX1449"></A>

</P>
<P>
The functions in this section encrypt and decrypt data values.
If you want to store results from an encryption function that might contain
arbitrary byte values, use a <CODE>BLOB</CODE> column rather than a <CODE>CHAR</CODE>
or <CODE>VARCHAR</CODE> column to avoid potential problems with trailing
space removal that would change data values.

</P>
<DL COMPACT>

<DT><CODE>AES_ENCRYPT(str,key_str)</CODE>
<DD>
<DT><CODE>AES_DECRYPT(crypt_str,key_str)</CODE>
<DD>
<A NAME="IDX1450"></A>
<A NAME="IDX1451"></A>
These functions allow encryption and decryption of data using the official
AES (Advanced Encryption Standard) algorithm, previously known as "Rijndael."
Encoding with a 128-bit key length is used, but you can extend it up to
256 bits by modifying the source. We chose 128 bits because it is much
faster and it is usually secure enough.

The input arguments may be any length. If either argument is <CODE>NULL</CODE>,
the result of this function is also <CODE>NULL</CODE>.

Because AES is a block-level algorithm, padding is used to encode uneven length
strings and so the result string length may be calculated as
<CODE>16*(trunc(string_length/16)+1)</CODE>.

If <CODE>AES_DECRYPT()</CODE> detects invalid data or incorrect padding, it
returns <CODE>NULL</CODE>. However, it is possible for <CODE>AES_DECRYPT()</CODE>
to return a non-<CODE>NULL</CODE> value (possibly garbage) if the input data or
the key is invalid.

You can use the AES functions to store data in an encrypted form by
modifying your queries:


<PRE>
INSERT INTO t VALUES (1,AES_ENCRYPT('text','password'));
</PRE>

You can get even more security by not transferring the key over the
connection for each query, which can be accomplished by storing it in a
server-side variable at connection time. For example:

<PRE>
SELECT @password:='my password';
INSERT INTO t VALUES (1,AES_ENCRYPT('text',@password));
</PRE>

<CODE>AES_ENCRYPT()</CODE> and <CODE>AES_DECRYPT()</CODE> were added in MySQL 4.0.2,
and can be considered the most cryptographically secure encryption
functions currently available in MySQL.

<DT><CODE>DECODE(crypt_str,pass_str)</CODE>
<DD>
<A NAME="IDX1452"></A>
Decrypts the encrypted string <CODE>crypt_str</CODE> using <CODE>pass_str</CODE> as the
password.  <CODE>crypt_str</CODE> should be a string returned from
<CODE>ENCODE()</CODE>.

<DT><CODE>ENCODE(str,pass_str)</CODE>
<DD>
<A NAME="IDX1453"></A>
Encrypt <CODE>str</CODE> using <CODE>pass_str</CODE> as the password.
To decrypt the result, use <CODE>DECODE()</CODE>.

The result is a binary string of the same length as <CODE>str</CODE>.
If you want to save it in a column, use a <CODE>BLOB</CODE> column type.

<DT><CODE>DES_DECRYPT(crypt_str[,key_str])</CODE>
<DD>
<A NAME="IDX1454"></A>

Decrypts a string encrypted with <CODE>DES_ENCRYPT()</CODE>.
On error, this function returns <CODE>NULL</CODE>.

Note that this function works only if MySQL has been configured with
SSL support. See section <A HREF="manual.html#Secure_connections">5.5.7  Using Secure Connections</A>.

If no <CODE>key_str</CODE> argument is given, <CODE>DES_DECRYPT()</CODE> examines
the first byte of the encrypted string to determine the DES key number
that was used to encrypt the original string, and then reads the key
from the DES key file to decrypt the message.  For this to work,
the user must have the <CODE>SUPER</CODE> privilege. The key file can be specified
with the <CODE>--des-key-file</CODE> server option.

If you pass this function a <CODE>key_str</CODE> argument, that string
is used as the key for decrypting the message.

If the <CODE>crypt_str</CODE> argument doesn't look like an encrypted string,
MySQL will return the given <CODE>crypt_str</CODE>.

<CODE>DES_DECRYPT()</CODE> was added in MySQL 4.0.1.

<DT><CODE>DES_ENCRYPT(str[,(key_num|key_str)])</CODE>
<DD>
<A NAME="IDX1455"></A>

Encrypts the string with the given key using the Triple-DES algorithm.
On error, this function returns <CODE>NULL</CODE>.

Note that this function works only if MySQL has been configured with
SSL support. See section <A HREF="manual.html#Secure_connections">5.5.7  Using Secure Connections</A>.

The encryption key to use is chosen based on the second argument to
<CODE>DES_ENCRYPT()</CODE>, if one was given:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Argument</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>No argument </TD><TD>
The first key from the DES key file is used.
</TD></TR>
<TR><TD><CODE>key_num</CODE> </TD><TD>
The given key number (0-9) from the DES key file is used.
</TD></TR>
<TR><TD><CODE>key_str</CODE> </TD><TD>
The given key string is used to encrypt <CODE>str</CODE>.
</TD></TR>
</TABLE>

The key file can be specified with the <CODE>--des-key-file</CODE> server option.

The return string is a binary string where the first character
is <CODE>CHAR(128 | key_num)</CODE>.

The 128 is added to make it easier to recognize an encrypted key.
If you use a string key, <CODE>key_num</CODE> will be 127.

The string length for the result will be
<CODE>new_len = orig_len + (8-(orig_len % 8))+1</CODE>.

The DES key file has the following format:


<PRE>
key_num des_key_str
key_num des_key_str
</PRE>

Each <CODE>key_num</CODE> must be a number in the range from <CODE>0</CODE> to <CODE>9</CODE>.  Lines in
the file may be in any order.  <CODE>des_key_str</CODE> is the string that
will be used to encrypt the message.  Between the number and the key there
should be at least one space.  The first key is the default key that is
used if you don't specify any key argument to <CODE>DES_ENCRYPT()</CODE>

You can tell MySQL to read new key values from the key file with the
<CODE>FLUSH DES_KEY_FILE</CODE> command.  This requires the <CODE>RELOAD</CODE>
privilege.

One benefit of having a set of default keys is that it gives applications
a way to check for the existence of encrypted column values, without giving
the end user the right to decrypt those values.


<PRE>
mysql&#62; SELECT customer_address FROM customer_table WHERE
       crypted_credit_card = DES_ENCRYPT('credit_card_number');
</PRE>

<CODE>DES_ENCRYPT()</CODE> was added in MySQL 4.0.1.

<DT><CODE>ENCRYPT(str[,salt])</CODE>
<DD>
<A NAME="IDX1456"></A>
Encrypt <CODE>str</CODE> using the Unix <CODE>crypt()</CODE> system call. The
<CODE>salt</CODE> argument should be a string with two characters.
(As of MySQL 3.22.16, <CODE>salt</CODE> may be longer than two characters.)


<PRE>
mysql&#62; SELECT ENCRYPT('hello');
        -&#62; 'VxuFAJXVARROc'
</PRE>

<CODE>ENCRYPT()</CODE> ignores all but the first eight characters of <CODE>str</CODE>, at
least on some systems.  This behavior is determined by the implementation
of the underlying <CODE>crypt()</CODE> system call.

If <CODE>crypt()</CODE> is not available on your system, <CODE>ENCRYPT()</CODE> always
returns <CODE>NULL</CODE>.  Because of this, we recommend that you use <CODE>MD5()</CODE>
or <CODE>SHA1()</CODE> instead, because those two functions exist on all platforms.

<DT><CODE>MD5(str)</CODE>
<DD>
<A NAME="IDX1457"></A>
Calculates an MD5 128-bit checksum for the string. The value is returned
as a string of 32 hex digits,
or <CODE>NULL</CODE> if the argument was <CODE>NULL</CODE>.
The return value can, for example, be used as a hash key.


<PRE>
mysql&#62; SELECT MD5('testing');
        -&#62; 'ae2b1fca515949e5d54fb22b8ed95575'
</PRE>

This is the "RSA Data Security, Inc. MD5 Message-Digest Algorithm."

<CODE>MD5()</CODE> was added in MySQL 3.23.2.

<DT><CODE>OLD_PASSWORD(str)</CODE>
<DD>
<A NAME="IDX1458"></A>

<CODE>OLD_PASSWORD()</CODE> is available as of MySQL 4.1, when the implementation of
<CODE>PASSWORD()</CODE> was changed to improve security. <CODE>OLD_PASSWORD()</CODE>
returns the value of the pre-4.1 implementation of <CODE>PASSWORD()</CODE>.
section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A>.

<DT><CODE>PASSWORD(str)</CODE>
<DD>
<A NAME="IDX1459"></A>
Calculates and returns a password string from the plaintext password
<CODE>str</CODE>, or <CODE>NULL</CODE> if the argument was <CODE>NULL</CODE>. This is
the function that is used for encrypting MySQL passwords for storage
in the <CODE>Password</CODE> column of the <CODE>user</CODE> grant table.


<PRE>
mysql&#62; SELECT PASSWORD('badpwd');
        -&#62; '7f84554057dd964b'
</PRE>

<A NAME="IDX1460"></A>
<CODE>PASSWORD()</CODE> encryption is one-way (not reversible).

<CODE>PASSWORD()</CODE> does not perform password encryption in the same way that
Unix passwords are encrypted. See <CODE>ENCRYPT()</CODE>.

<STRONG>Note:</STRONG>
The <CODE>PASSWORD()</CODE> function is used by the authentication system in
MySQL Server, you should <EM>not</EM> use it in your own applications.
For that purpose, use <CODE>MD5()</CODE> or <CODE>SHA1()</CODE> instead.
Also see RFC 2195 for more information about handling passwords
and authentication securely in your application.

<DT><CODE>SHA1(str)</CODE>
<DD>
<DT><CODE>SHA(str)</CODE>
<DD>
<A NAME="IDX1461"></A>
<A NAME="IDX1462"></A>
Calculates an SHA1 160-bit checksum for the string, as described in
RFC 3174 (Secure Hash Algorithm). The value is returned as a string of 40 hex
digits, or <CODE>NULL</CODE> if the argument was <CODE>NULL</CODE>.
One of the possible uses for this function is as a hash key. You can
also use it as a cryptographically safe function for storing passwords.


<PRE>
mysql&#62; SELECT SHA1('abc');
        -&#62; 'a9993e364706816aba3e25717850c26c9cd0d89d'
</PRE>

<CODE>SHA1()</CODE> was added in MySQL 4.0.2, and can be considered
a cryptographically more secure equivalent of <CODE>MD5()</CODE>.
<CODE>SHA()</CODE> is synonym for <CODE>SHA1()</CODE>.

</DL>



<H3><A NAME="Information_functions" HREF="manual_toc.html#Information_functions">13.8.3  Information Functions</A></H3>

<P>
<A NAME="IDX1463"></A>
<A NAME="IDX1464"></A>

</P>
<DL COMPACT>

<DT><CODE>BENCHMARK(count,expr)</CODE>
<DD>
<A NAME="IDX1465"></A>
The <CODE>BENCHMARK()</CODE> function executes the expression <CODE>expr</CODE>
repeatedly <CODE>count</CODE> times.  It may be used to time how fast MySQL
processes the expression.  The result value is always <CODE>0</CODE>.  The intended
use is from within the <CODE>mysql</CODE> client, which reports query execution times:


<PRE>
mysql&#62; SELECT BENCHMARK(1000000,ENCODE('hello','goodbye'));
+----------------------------------------------+
| BENCHMARK(1000000,ENCODE('hello','goodbye')) |
+----------------------------------------------+
|                                            0 |
+----------------------------------------------+
1 row in set (4.74 sec)
</PRE>

The time reported is elapsed time on the client end, not CPU time on the
server end.  It is advisable to execute <CODE>BENCHMARK()</CODE> several
times, and to interpret the result with regard to how heavily loaded the
server machine is.

<DT><CODE>CHARSET(str)</CODE>
<DD>
<A NAME="IDX1466"></A>
Returns the character set of the string argument.


<PRE>
mysql&#62; SELECT CHARSET('abc');
        -&#62; 'latin1'
mysql&#62; SELECT CHARSET(CONVERT('abc' USING utf8));
        -&#62; 'utf8'
mysql&#62; SELECT CHARSET(USER());
        -&#62; 'utf8'
</PRE>

<CODE>CHARSET()</CODE> was added in MySQL 4.1.0.

<DT><CODE>COERCIBILITY(str)</CODE>
<DD>
<A NAME="IDX1467"></A>
Returns the collation coercibility value of the string argument.


<PRE>
mysql&#62; SELECT COERCIBILITY('abc' COLLATE latin1_swedish_ci);
        -&#62; 0
mysql&#62; SELECT COERCIBILITY('abc');
        -&#62; 3
mysql&#62; SELECT COERCIBILITY(USER());
        -&#62; 2
</PRE>

The return values have the following meanings:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Coercibility</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>0</CODE> </TD><TD> Explicit collation
</TD></TR>
<TR><TD><CODE>1</CODE> </TD><TD> No collation
</TD></TR>
<TR><TD><CODE>2</CODE> </TD><TD> Implicit collation
</TD></TR>
<TR><TD><CODE>3</CODE> </TD><TD> Coercible
</TD></TR>
</TABLE>

Lower values have higher precedence.

<CODE>COERCIBILITY()</CODE> was added in MySQL 4.1.1.

<DT><CODE>COLLATION(str)</CODE>
<DD>
<A NAME="IDX1468"></A>
Returns the collation for the character set of the string argument.


<PRE>
mysql&#62; SELECT COLLATION('abc');
        -&#62; 'latin1_swedish_ci'
mysql&#62; SELECT COLLATION(_utf8'abc');
        -&#62; 'utf8_general_ci'
</PRE>

<CODE>COLLATION()</CODE> was added in MySQL 4.1.0.

<DT><CODE>CONNECTION_ID()</CODE>
<DD>
<A NAME="IDX1469"></A>
Returns the connection ID (thread ID) for the connection.
Every connection has its own unique ID.


<PRE>
mysql&#62; SELECT CONNECTION_ID();
        -&#62; 23786
</PRE>

<CODE>CONNECTION_ID()</CODE> was added in MySQL 3.23.14.

<DT><CODE>CURRENT_USER()</CODE>
<DD>
<A NAME="IDX1470"></A>
Returns the username and hostname combination that the current session was authenticated
as. This value corresponds to the MySQL account that determines your
access privileges. It can be different from the value of <CODE>USER()</CODE>.


<PRE>
mysql&#62; SELECT USER();
        -&#62; 'davida@localhost'
mysql&#62; SELECT * FROM mysql.user;
ERROR 1044: Access denied for user: '@localhost' to
database 'mysql'
mysql&#62; SELECT CURRENT_USER();
        -&#62; '@localhost'
</PRE>

The example illustrates that although the client specified a username of
<CODE>davida</CODE> (as indicated by the value of the <CODE>USER()</CODE> function),
the server authenticated the client using an anonymous user account (as seen by
the empty username part of the <CODE>CURRENT_USER()</CODE> value). One way this might
occur is that there is no account listed in the grant tables for
<CODE>davida</CODE>.

<CODE>CURRENT_USER()</CODE> was added in MySQL 4.0.6.

<DT><CODE>DATABASE()</CODE>
<DD>
<A NAME="IDX1471"></A>
Returns the default (current) database name.


<PRE>
mysql&#62; SELECT DATABASE();
        -&#62; 'test'
</PRE>

If there is no default database, <CODE>DATABASE()</CODE> returns <CODE>NULL</CODE> as
of MySQL 4.1.1, and the empty string before that.

<DT><CODE>FOUND_ROWS()</CODE>
<DD>
<A NAME="IDX1472"></A>
<A NAME="IDX1473"></A>

A <CODE>SELECT</CODE> statement may include a <CODE>LIMIT</CODE> clause to restrict the
number of rows the server returns to the client.
In some cases, it is desirable to know how many rows the statement would have
returned without the <CODE>LIMIT</CODE>, but without running the statement again.
To get this row count, include a <CODE>SQL_CALC_FOUND_ROWS</CODE> option in the
<CODE>SELECT</CODE> statement, then invoke <CODE>FOUND_ROWS()</CODE> afterward:


<PRE>
mysql&#62; SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -&#62; WHERE id &#62; 100 LIMIT 10;
mysql&#62; SELECT FOUND_ROWS();
</PRE>

The second <CODE>SELECT</CODE> will return a number indicating how many rows the
first <CODE>SELECT</CODE> would have returned had it been written without the
<CODE>LIMIT</CODE> clause.
(If the preceding <CODE>SELECT</CODE> statement does not include the
<CODE>SQL_CALC_FOUND_ROWS</CODE> option, then <CODE>FOUND_ROWS()</CODE> may return
a different result when <CODE>LIMIT</CODE> is used than when it is not.)

Note that if you are using <CODE>SELECT SQL_CALC_FOUND_ROWS</CODE>, MySQL must
calculate how many rows are in the full result set.  However, this is
faster than running the query again without <CODE>LIMIT</CODE>, because the result
set need not be sent to the client.

<CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>FOUND_ROWS()</CODE> can be useful in situations
when you want to restrict the number of rows that a query returns, but also
determine the number of rows in the full result set without running the query
again. An example is a Web script that presents a paged display containing
links to the pages that show other sections of a search result. Using
<CODE>FOUND_ROWS()</CODE> allows you to determine how many other pages are needed
for the rest of the result.

The use of <CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>FOUND_ROWS()</CODE> is more complex
for <CODE>UNION</CODE> queries than for simple <CODE>SELECT</CODE> statements, because
<CODE>LIMIT</CODE> may occur at multiple places in a <CODE>UNION</CODE>. It may be applied
to individual <CODE>SELECT</CODE> statements in the <CODE>UNION</CODE>, or global to the
<CODE>UNION</CODE> result as a whole.

The intent of <CODE>SQL_CALC_FOUND_ROWS</CODE> for <CODE>UNION</CODE> is that it should
return the row count that would be returned without a global <CODE>LIMIT</CODE>.
The conditions for use of <CODE>SQL_CALC_FOUND_ROWS</CODE> with <CODE>UNION</CODE> are:


<UL>

<LI>

The <CODE>SQL_CALC_FOUND_ROWS</CODE> keyword must appear in the first <CODE>SELECT</CODE>
of the <CODE>UNION</CODE>.

<LI>

The value of <CODE>FOUND_ROWS()</CODE> is exact only if <CODE>UNION ALL</CODE> is used.
If <CODE>UNION</CODE> without <CODE>ALL</CODE> is used, duplicate removal occurs and the
value of <CODE>FOUND_ROWS()</CODE> is only approximate.

<LI>

If no <CODE>LIMIT</CODE> is present in the <CODE>UNION</CODE>, <CODE>SQL_CALC_FOUND_ROWS</CODE>
is ignored and returns the number of rows in the temporary table that is
created to process the <CODE>UNION</CODE>.

</UL>

<CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>FOUND_ROWS()</CODE> are available starting
at MySQL 4.0.0.

<DT><CODE>LAST_INSERT_ID()</CODE>
<DD>
<DT><CODE>LAST_INSERT_ID(expr)</CODE>
<DD>
<A NAME="IDX1474"></A>
Returns the last automatically generated value that was inserted into
an <CODE>AUTO_INCREMENT</CODE> column.


<PRE>
mysql&#62; SELECT LAST_INSERT_ID();
        -&#62; 195
</PRE>

The last ID that was generated is maintained in the server on a
per-connection basis. This means the value the function returns to a given
client is the most recent <CODE>AUTO_INCREMENT</CODE> value generated by that
client. The value cannot be affected by other clients, even if they generate
<CODE>AUTO_INCREMENT</CODE> values of their own. This behavior ensures that you can
retrieve your own ID without concern for the activity of other clients, and
without the need for locks or transactions.

The value of <CODE>LAST_INSERT_ID()</CODE> is not changed if you
update the <CODE>AUTO_INCREMENT</CODE> column of a row with a
non-magic value (that is, a value that is not <CODE>NULL</CODE> and not <CODE>0</CODE>).

If you insert many rows at the same time with an insert statement,
<CODE>LAST_INSERT_ID()</CODE> returns the value for the first inserted row.
The reason for this is to make it possible to easily reproduce
the same <CODE>INSERT</CODE> statement against some other server.

If you use <CODE>INSERT IGNORE</CODE> and the record is ignored, the
<CODE>AUTO_INCREMENT</CODE> counter still is incremented and
<CODE>LAST_INSERT_ID()</CODE> returns the new value.

<A NAME="IDX1475"></A>
If <CODE>expr</CODE> is given as an argument to <CODE>LAST_INSERT_ID()</CODE>,
the value of the argument is returned by the function and is remembered as the
next value to be returned by <CODE>LAST_INSERT_ID()</CODE>.  This can be used
to simulate sequences:


<UL>
<LI>

Create a table to hold the sequence counter and initialize it:


<PRE>
mysql&#62; CREATE TABLE sequence (id INT NOT NULL);
mysql&#62; INSERT INTO sequence VALUES (0);
</PRE>

<LI>

Use the table to generate sequence numbers like this:


<PRE>
mysql&#62; UPDATE sequence SET id=LAST_INSERT_ID(id+1);
mysql&#62; SELECT LAST_INSERT_ID();
</PRE>

The <CODE>UPDATE</CODE> statement increments the sequence counter and causes the
next call to <CODE>LAST_INSERT_ID()</CODE> to return the updated value.
The <CODE>SELECT</CODE> statement retrieves that value.
The C API function
<CODE>mysql_insert_id()</CODE> can also be used to get the value.
See section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

</UL>

You can generate sequences without calling <CODE>LAST_INSERT_ID()</CODE>, but the
utility of using the function this way is that the ID value is maintained in
the server as the last automatically generated value.
It is multi-user safe because multiple clients can issue the <CODE>UPDATE</CODE>
statement and get their own sequence value with the <CODE>SELECT</CODE> statement
(or <CODE>mysql_insert_id()</CODE>), without affecting or being affected by other
clients that generate their own sequence values.

Note that <CODE>mysql_insert_id()</CODE> is only updated after <CODE>INSERT</CODE>
and <CODE>UPDATE</CODE> statements, so you cannot use the C API function to
retrieve the value for <CODE>LAST_INSERT_ID(expr)</CODE> after executing other
SQL statements like <CODE>SELECT</CODE> or <CODE>SET</CODE>.

<DT><CODE>SESSION_USER()</CODE>
<DD>
<A NAME="IDX1476"></A>

<CODE>SESSION_USER()</CODE> is a synonym for <CODE>USER()</CODE>.

<DT><CODE>SYSTEM_USER()</CODE>
<DD>
<A NAME="IDX1477"></A>

<CODE>SYSTEM_USER()</CODE> is a synonym for <CODE>USER()</CODE>.

<DT><CODE>USER()</CODE>
<DD>
<A NAME="IDX1478"></A>

Returns the current MySQL username and hostname.


<PRE>
mysql&#62; SELECT USER();
        -&#62; 'davida@localhost'
</PRE>

The value indicates the username you specified when connecting to
the server, and the client host from which you connected. The value can be
different than that of <CODE>CURRENT_USER()</CODE>.

Prior to MySQL 3.22.11, the function value does not include the client
hostname.  You can extract just the username part, regardless of whether the
value includes a hostname part, like this:


<PRE>
mysql&#62; SELECT SUBSTRING_INDEX(USER(),'@',1);
        -&#62; 'davida'
</PRE>

As of MySQL 4.1, <CODE>USER()</CODE> returns a value in the <CODE>utf8</CODE> character
set, so you should also make sure that the <CODE>'@'</CODE> string literal is
interpreted in that character set:


<PRE>
mysql&#62; SELECT SUBSTRING_INDEX(USER(),_utf8'@',1);
        -&#62; 'davida'
</PRE>

<DT><CODE>VERSION()</CODE>
<DD>
<A NAME="IDX1479"></A>
Returns a string that indicates the MySQL server version.


<PRE>
mysql&#62; SELECT VERSION();
        -&#62; '4.1.2-alpha-log'
</PRE>

Note that if your version string ends with <CODE>-log</CODE> this means that
logging is enabled.

</DL>



<H3><A NAME="Miscellaneous_functions" HREF="manual_toc.html#Miscellaneous_functions">13.8.4  Miscellaneous Functions</A></H3>

<P>
<A NAME="IDX1480"></A>
<A NAME="IDX1481"></A>

</P>
<DL COMPACT>

<DT><CODE>FORMAT(X,D)</CODE>
<DD>
<A NAME="IDX1482"></A>
Formats the number <CODE>X</CODE> to a format like <CODE>'#,###,###.##'</CODE>, rounded
to <CODE>D</CODE> decimals, and returns the result as a string.
If <CODE>D</CODE> is <CODE>0</CODE>, the result will have no
decimal point or fractional part.


<PRE>
mysql&#62; SELECT FORMAT(12332.123456, 4);
        -&#62; '12,332.1235'
mysql&#62; SELECT FORMAT(12332.1,4);
        -&#62; '12,332.1000'
mysql&#62; SELECT FORMAT(12332.2,0);
        -&#62; '12,332'
</PRE>

<DT><CODE>GET_LOCK(str,timeout)</CODE>
<DD>
<A NAME="IDX1483"></A>
<A NAME="IDX1484"></A>
Tries to obtain a lock with a name given by the string <CODE>str</CODE>, with a
timeout of <CODE>timeout</CODE> seconds.  Returns <CODE>1</CODE> if the lock was obtained
successfully, <CODE>0</CODE> if the attempt timed out (for example, because another
client has already locked the name), or <CODE>NULL</CODE> if an error
occurred (such as running out of memory or the thread was killed with
<CODE>mysqladmin kill</CODE>).  If you have a lock obtained with <CODE>GET_LOCK()</CODE>,
it is released when you execute
<CODE>RELEASE_LOCK()</CODE>, execute a new <CODE>GET_LOCK()</CODE>, or your connection
terminates (either normally or abnormally).

This function can be used to implement application locks or to
simulate record locks.  Names are locked on a server-wide basis.
If a name has been locked by one client, <CODE>GET_LOCK()</CODE> blocks
any request by another client for a lock with the same name. This
allows clients that agree on a given lock name to use the name to
perform cooperative advisory locking.


<PRE>
mysql&#62; SELECT GET_LOCK('lock1',10);
        -&#62; 1
mysql&#62; SELECT IS_FREE_LOCK('lock2');
        -&#62; 1
mysql&#62; SELECT GET_LOCK('lock2',10);
        -&#62; 1
mysql&#62; SELECT RELEASE_LOCK('lock2');
        -&#62; 1
mysql&#62; SELECT RELEASE_LOCK('lock1');
        -&#62; NULL
</PRE>

Note that the second <CODE>RELEASE_LOCK()</CODE> call returns <CODE>NULL</CODE> because
the lock <CODE>'lock1'</CODE> was automatically released by the second
<CODE>GET_LOCK()</CODE> call.

<DT><CODE>INET_ATON(expr)</CODE>
<DD>
<A NAME="IDX1485"></A>
Given the dotted-quad representation of a network address as a string,
returns an integer that represents the numeric value of the address.
Addresses may be 4- or 8-byte addresses.


<PRE>
mysql&#62; SELECT INET_ATON('209.207.224.40');
        -&#62; 3520061480
</PRE>

The generated number is always in network byte order. For the example
just shown, the number is calculated as <CODE>209*256^3 + 207*256^2 +
224*256 + 40</CODE>.

As of MySQL 4.1.2, <CODE>INET_ATON()</CODE> also understands short-form IP
addresses:


<PRE>
mysql&#62; SELECT INET_ATON('127.0.0.1'), INET_ATON('127.1');
        -&#62; 2130706433, 2130706433
</PRE>

<CODE>INET_ATON()</CODE> was added in MySQL 3.23.15.

<DT><CODE>INET_NTOA(expr)</CODE>
<DD>
<A NAME="IDX1486"></A>
Given a numeric network address (4 or 8 byte), returns the dotted-quad
representation of the address as a string.


<PRE>
mysql&#62; SELECT INET_NTOA(3520061480);
        -&#62; '209.207.224.40'
</PRE>

<CODE>INET_NTOA()</CODE> was added in MySQL 3.23.15.

<DT><CODE>IS_FREE_LOCK(str)</CODE>
<DD>
<A NAME="IDX1487"></A>
Checks whether the lock named <CODE>str</CODE> is free to use (that is, not locked).
Returns <CODE>1</CODE> if the lock is free (no one is using the lock),
<CODE>0</CODE> if the lock is in use, and
<CODE>NULL</CODE> on errors (such as incorrect arguments).

<CODE>IS_FREE_LOCK()</CODE> was added in MySQL 4.0.2.

<DT><CODE>IS_USED_LOCK(str)</CODE>
<DD>
<A NAME="IDX1488"></A>
Checks whether the lock named <CODE>str</CODE> is in use (that is, locked).
If so, it returns the connection identifier of the client that holds
the lock.
Otherwise, it returns <CODE>NULL</CODE>.

<CODE>IS_USED_LOCK()</CODE> was added in MySQL 4.1.0.

<DT><CODE>MASTER_POS_WAIT(log_name,log_pos[,timeout])</CODE>
<DD>
<A NAME="IDX1489"></A>

This function is useful for control of master/slave synchronization.
It blocks until the slave has read and applied all updates up to the specified
position in the master log.
The return value is the number of log events it had to wait for to get to
the specified position.  The function returns <CODE>NULL</CODE> if the slave SQL thread
is not started, the slave's master information is not initialized, the
arguments are incorrect, or an error occurs. It returns <CODE>-1</CODE> if the
timeout has been exceeded. If the slave SQL thread stops while
<CODE>MASTER_POS_WAIT()</CODE> is waiting, the function returns <CODE>NULL</CODE>.
If the slave is already past the specified position, the function returns
immediately.

If a <CODE>timeout</CODE> value is specified, <CODE>MASTER_POS_WAIT()</CODE>
stops waiting when <CODE>timeout</CODE> seconds have elapsed. <CODE>timeout</CODE> must
be greater than 0; a zero or negative <CODE>timeout</CODE> means no timeout.

<CODE>MASTER_POS_WAIT()</CODE> was added in MySQL 3.23.32.
The <CODE>timeout</CODE> argument was added in 4.0.10.

<DT><CODE>RELEASE_LOCK(str)</CODE>
<DD>
<A NAME="IDX1490"></A>
Releases the lock named by the string <CODE>str</CODE> that was obtained with
<CODE>GET_LOCK()</CODE>. Returns <CODE>1</CODE> if the lock was released, <CODE>0</CODE> if the
lock wasn't locked by this thread (in which case the lock is not released),
and <CODE>NULL</CODE> if the named lock didn't exist.  The lock will not exist if
it was never obtained by a call to <CODE>GET_LOCK()</CODE> or if it already has
been released.

The <CODE>DO</CODE> statement is convenient to use with <CODE>RELEASE_LOCK()</CODE>.
See section <A HREF="manual.html#DO">14.1.2  <CODE>DO</CODE> Syntax</A>.

<DT><CODE>UUID()</CODE>
<DD>
<A NAME="IDX1491"></A>

Returns a Universal Unique Identifier (UUID) generated
according to ``DCE 1.1: Remote Procedure Call'' (Appendix A)
CAE (Common Applications Environment) Specifications
published by The Open Group in October 1997 (Document Number C706).

A UUID is designed as a number that is globally unique in space and
time. Two calls to <CODE>UUID()</CODE> are expected to generate two different
values, even if these calls are performed on two separate computers that are
not connected to each other.

A UUID is a 128-bit number represented by a string
of five hexadecimal numbers in <CODE>aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</CODE>
format:


<UL>

<LI>

The first three numbers are generated from a timestamp.

<LI>

The fourth number preserves temporal uniqueness in case the timestamp value loses
monotonicity (for example, due to daylight saving time).

<LI>

The fifth number is an IEEE 802 node number that provides spatial uniqueness.  A
random number is substituted if the latter is not available (for example,
because the host computer has no Ethernet card, or we do not know how to
find the hardware address of an interface on your operating system).  In
this case, spatial uniqueness cannot be guaranteed. Nevertheless, a
collision should have <EM>very</EM> low probability.

Currently, the MAC address of an interface is taken into account only on
FreeBSD and Linux. On other operating systems, MySQL uses a randomly generated
48-bit number.

</UL>


<PRE>
mysql&#62; SELECT UUID();
        -&#62; '6ccd780c-baba-1026-9564-0040f4311e29'
</PRE>

Note that <CODE>UUID()</CODE> does not yet work with replication.

<CODE>UUID()</CODE> was added in MySQL 4.1.2.

</DL>



<H2><A NAME="Group_by_functions_and_modifiers" HREF="manual_toc.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A></H2>



<H3><A NAME="GROUP-BY-Functions" HREF="manual_toc.html#GROUP-BY-Functions">13.9.1  <CODE>GROUP BY</CODE> (Aggregate) Functions</A></H3>

<P>
<A NAME="IDX1492"></A>
<A NAME="IDX1493"></A>

</P>
<P>
If you use a group function in a statement containing no <CODE>GROUP BY</CODE>
clause, it is equivalent to grouping on all rows.

</P>
<DL COMPACT>

<DT><CODE>AVG(expr)</CODE>
<DD>
<A NAME="IDX1494"></A>
Returns the average value of <CODE>expr</CODE>.


<PRE>
mysql&#62; SELECT student_name, AVG(test_score)
    -&#62;        FROM student
    -&#62;        GROUP BY student_name;
</PRE>

<DT><CODE>BIT_AND(expr)</CODE>
<DD>
<A NAME="IDX1495"></A>
Returns the bitwise <CODE>AND</CODE> of all bits in <CODE>expr</CODE>. The calculation is
performed with 64-bit (<CODE>BIGINT</CODE>) precision.

As of MySQL 4.0.17, this function returns
<CODE>18446744073709551615</CODE> if there were no matching rows.
(This is an unsigned <CODE>BIGINT</CODE> value with all bits set to 1.)
Before 4.0.17, the function returns <CODE>-1</CODE> if there were no matching rows.

<DT><CODE>BIT_OR(expr)</CODE>
<DD>
<A NAME="IDX1496"></A>
Returns the bitwise <CODE>OR</CODE> of all bits in <CODE>expr</CODE>. The calculation is
performed with 64-bit (<CODE>BIGINT</CODE>) precision.

This function returns <CODE>0</CODE> if there were no matching rows.

<DT><CODE>BIT_XOR(expr)</CODE>
<DD>
<A NAME="IDX1497"></A>
Returns the bitwise <CODE>XOR</CODE> of all bits in <CODE>expr</CODE>. The calculation is
performed with 64-bit (<CODE>BIGINT</CODE>) precision.

This function returns <CODE>0</CODE> if there were no matching rows.

This function is available as of MySQL 4.1.1.

<DT><CODE>COUNT(expr)</CODE>
<DD>
<A NAME="IDX1498"></A>
Returns a count of the number of non-<CODE>NULL</CODE> values in the rows
retrieved by a <CODE>SELECT</CODE> statement.


<PRE>
mysql&#62; SELECT student.student_name,COUNT(*)
    -&#62;        FROM student,course
    -&#62;        WHERE student.student_id=course.student_id
    -&#62;        GROUP BY student_name;

</PRE>

<CODE>COUNT(*)</CODE> is somewhat different in that it returns a count of
the number of rows retrieved, whether or not they contain <CODE>NULL</CODE>
values.

<CODE>COUNT(*)</CODE> is optimized to
return very quickly if the <CODE>SELECT</CODE> retrieves from one table, no
other columns are retrieved, and there is no <CODE>WHERE</CODE> clause.
For example:


<PRE>
mysql&#62; SELECT COUNT(*) FROM student;
</PRE>

This optimization applies only to <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables
only, because an exact record count is stored for these table types and
can be accessed very quickly. For transactional storage engines
(<CODE>InnoDB</CODE>, <CODE>BDB</CODE>), storing an exact row count is more problematic
because multiple transactions may be occurring, each of which may affect the
count.

<DT><CODE>COUNT(DISTINCT expr,[expr...])</CODE>
<DD>
<A NAME="IDX1499"></A>
<A NAME="IDX1500"></A>
Returns a count of the number of different non-<CODE>NULL</CODE> values.


<PRE>
mysql&#62; SELECT COUNT(DISTINCT results) FROM student;
</PRE>

In MySQL, you can get the number of distinct expression
combinations that don't contain <CODE>NULL</CODE> by giving a list of expressions.
In standard SQL, you would have to do a concatenation of all expressions
inside <CODE>COUNT(DISTINCT ...)</CODE>.

<CODE>COUNT(DISTINCT ...)</CODE> was added in MySQL 3.23.2.

<DT><CODE>GROUP_CONCAT(expr)</CODE>
<DD>
<A NAME="IDX1501"></A>
This function returns a string result with the concatenated values from a
group.  The full syntax is as follows:


<PRE>
GROUP_CONCAT([DISTINCT] expr [,expr ...]
             [ORDER BY {unsigned_integer | col_name | expr}
                 [ASC | DESC] [,col ...]]
             [SEPARATOR str_val])
</PRE>


<PRE>
mysql&#62; SELECT student_name,
    -&#62;     GROUP_CONCAT(test_score)
    -&#62;     FROM student 
    -&#62;     GROUP BY student_name;
</PRE>

Or:


<PRE>
mysql&#62; SELECT student_name,
    -&#62;     GROUP_CONCAT(DISTINCT test_score
    -&#62;               ORDER BY test_score DESC SEPARATOR ' ')
    -&#62;     FROM student
    -&#62;     GROUP BY student_name;
</PRE>

In MySQL, you can get the concatenated values of expression combinations.
You can eliminate duplicate values by using <CODE>DISTINCT</CODE>.
If you want to sort values in the result, you should use <CODE>ORDER BY</CODE>
clause.
To sort in reverse order, add the <CODE>DESC</CODE> (descending) keyword to the
name of the column you are sorting by in the <CODE>ORDER BY</CODE> clause. The
default is ascending order; this may be specified explicitly using the
<CODE>ASC</CODE> keyword.
<CODE>SEPARATOR</CODE> is followed by the string value that should be inserted between
values of result. The default is a comma (<SAMP>`,'</SAMP>). You can remove
the separator altogether by specifying <CODE>SEPARATOR ''</CODE>.

You can set a maximum allowed length with the
<CODE>group_concat_max_len</CODE> system variable.
The syntax to do this at runtime is as follows, where <CODE>val</CODE> is an
unsigned integer:


<PRE>
SET [SESSION | GLOBAL] group_concat_max_len = val;
</PRE>

If a maximum length has been set, the result is truncated to this
maximum length. 

Note: There are still some small limitations with <CODE>GROUP_CONCAT()</CODE>
when it comes to using <CODE>DISTINCT</CODE> together with <CODE>ORDER BY</CODE> and using
<CODE>BLOB</CODE> values. See section <A HREF="manual.html#Open_bugs">1.8.7.3  Open Bugs and Design Deficiencies in MySQL</A>.

<CODE>GROUP_CONCAT()</CODE> was added in MySQL 4.1.

<DT><CODE>MIN(expr)</CODE>
<DD>
<DT><CODE>MAX(expr)</CODE>
<DD>
<A NAME="IDX1502"></A>
<A NAME="IDX1503"></A>
Returns the minimum or maximum value of <CODE>expr</CODE>.  <CODE>MIN()</CODE> and
<CODE>MAX()</CODE> may take a string argument; in such cases they return the
minimum or maximum string value. See section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A>.


<PRE>
mysql&#62; SELECT student_name, MIN(test_score), MAX(test_score)
    -&#62;        FROM student
    -&#62;        GROUP BY student_name;
</PRE>

For <CODE>MIN()</CODE>, <CODE>MAX()</CODE>, and other aggregate functions, MySQL
currently compares <CODE>ENUM</CODE> and <CODE>SET</CODE> columns by their string
value rather than by the string's relative position in the set.
This differs from how <CODE>ORDER BY</CODE> compares them.
This will be rectified.

<DT><CODE>STD(expr)</CODE>
<DD>
<DT><CODE>STDDEV(expr)</CODE>
<DD>
<A NAME="IDX1504"></A>
<A NAME="IDX1505"></A>
<A NAME="IDX1506"></A>
<A NAME="IDX1507"></A>
Returns the standard deviation of <CODE>expr</CODE> (the square root of
<CODE>VARIANCE()</CODE>). This is an extension to standard SQL. The <CODE>STDDEV()</CODE>
form of this function is provided for Oracle compatibility.

<DT><CODE>SUM(expr)</CODE>
<DD>
<A NAME="IDX1508"></A>
Returns the sum of <CODE>expr</CODE>.  Note that if the return set has no rows,
it returns <CODE>NULL</CODE>!

<DT><CODE>VARIANCE(expr)</CODE>
<DD>
<A NAME="IDX1509"></A>
Returns the standard variance of <CODE>expr</CODE> (considering rows as the
whole population, not as a sample; so it has the number of rows as
denominator). This is an extension to 
standard SQL, available only in MySQL 4.1 or later.

</DL>



<H3><A NAME="GROUP-BY-Modifiers" HREF="manual_toc.html#GROUP-BY-Modifiers">13.9.2  <CODE>GROUP BY</CODE> Modifiers</A></H3>

<P>
<A NAME="IDX1510"></A>
<A NAME="IDX1511"></A>

</P>

<P>
As of MySQL 4.1.1, the <CODE>GROUP BY</CODE> clause allows a <CODE>WITH
ROLLUP</CODE> modifier that causes extra rows to be added to the summary
output. These rows represent higher-level (or super-aggregate) summary
operations. <CODE>ROLLUP</CODE> thus allows you to answer questions at multiple
levels of analysis with a single query. It can be used, for example,
to provide support for OLAP (Online Analytical Processing) operations.

</P>
<P>
As an illustration, suppose that a table named <CODE>sales</CODE> has <CODE>year</CODE>,
<CODE>country</CODE>,
<CODE>product</CODE>, and <CODE>profit</CODE> columns for recording sales profitability:

</P>

<PRE>
CREATE TABLE sales
(
    year    INT NOT NULL,
    country VARCHAR(20) NOT NULL,
    product VARCHAR(32) NOT NULL,
    profit  INT
);
</PRE>

<P>
The table's contents can be summarized per year with a simple <CODE>GROUP BY</CODE>
like this:

</P>

<PRE>
mysql&#62; SELECT year, SUM(profit) FROM sales GROUP BY year;
+------+-------------+
| year | SUM(profit) |
+------+-------------+
| 2000 |        4525 |
| 2001 |        3010 |
+------+-------------+
</PRE>

<P>
This output shows the total profit for each year, but if you also want
to determine the total profit summed over all years, you must add up
the individual values yourself or run an additional query.

</P>
<P>
Or you can use <CODE>ROLLUP</CODE>, which provides both levels of analysis with a
single query.
Adding a <CODE>WITH ROLLUP</CODE> modifier to the <CODE>GROUP BY</CODE> clause causes the query
to produce another row that shows the grand total over all year values:

</P>

<PRE>
mysql&#62; SELECT year, SUM(profit) FROM sales GROUP BY year WITH ROLLUP;
+------+-------------+
| year | SUM(profit) |
+------+-------------+
| 2000 |        4525 |
| 2001 |        3010 |
| NULL |        7535 |
+------+-------------+
</PRE>

<P>
The grand total super-aggregate line is identified by the value <CODE>NULL</CODE> in
the <CODE>year</CODE> column.

</P>
<P>
<CODE>ROLLUP</CODE> has a more complex effect when there are multiple <CODE>GROUP BY</CODE>
columns. In this case, each time there is a ``break'' (change in value)
in any but the last grouping column, the query produces an extra
super-aggregate summary row.

</P>
<P>
For example, without <CODE>ROLLUP</CODE>, a summary on the <CODE>sales</CODE> table based
on <CODE>year</CODE>,
<CODE>country</CODE>, and <CODE>product</CODE> might look like this:

</P>

<PRE>
mysql&#62; SELECT year, country, product, SUM(profit)
    -&#62; FROM sales
    -&#62; GROUP BY year, country, product;
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
| 2000 | USA     | Calculator |          75 |
| 2000 | USA     | Computer   |        1500 |
| 2001 | Finland | Phone      |          10 |
| 2001 | USA     | Calculator |          50 |
| 2001 | USA     | Computer   |        2700 |
| 2001 | USA     | TV         |         250 |
+------+---------+------------+-------------+
</PRE>

<P>
The output indicates summary values only at the year/country/product level of
analysis.  When <CODE>ROLLUP</CODE> is added, the query produces several extra rows:

</P>

<PRE>
mysql&#62; SELECT year, country, product, SUM(profit)
    -&#62; FROM sales
    -&#62; GROUP BY year, country, product WITH ROLLUP;
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | Finland | NULL       |        1600 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
| 2000 | India   | NULL       |        1350 |
| 2000 | USA     | Calculator |          75 |
| 2000 | USA     | Computer   |        1500 |
| 2000 | USA     | NULL       |        1575 |
| 2000 | NULL    | NULL       |        4525 |
| 2001 | Finland | Phone      |          10 |
| 2001 | Finland | NULL       |          10 |
| 2001 | USA     | Calculator |          50 |
| 2001 | USA     | Computer   |        2700 |
| 2001 | USA     | TV         |         250 |
| 2001 | USA     | NULL       |        3000 |
| 2001 | NULL    | NULL       |        3010 |
| NULL | NULL    | NULL       |        7535 |
+------+---------+------------+-------------+
</PRE>

<P>
For this query, adding <CODE>ROLLUP</CODE> causes the output to include summary
information at four levels of analysis, not just one.  Here's how to
interpret the <CODE>ROLLUP</CODE> output:

</P>

<UL>

<LI>

Following each set of product rows for a given year and country, an
extra summary row is produced showing the total for all products. These rows
have the <CODE>product</CODE> column set to <CODE>NULL</CODE>.

<LI>

Following each set of rows for a given year, an extra summary row is
produced showing the total for all countries and products. These rows
have the <CODE>country</CODE> and <CODE>products</CODE> columns set to <CODE>NULL</CODE>.

<LI>

Finally, following all other rows, an extra summary row is produced
showing the grand total for all years, countries, and products. This
row has the <CODE>year</CODE>, <CODE>country</CODE>, and <CODE>products</CODE> columns set to
<CODE>NULL</CODE>.

</UL>

<P>
<STRONG>Other Considerations When using <CODE>ROLLUP</CODE></STRONG>

</P>
<P>
The following items list some behaviors specific to the MySQL implementation
of <CODE>ROLLUP</CODE>:

</P>
<P>
When you use <CODE>ROLLUP</CODE>, you cannot also use an <CODE>ORDER BY</CODE> clause to
sort the results. In other words, <CODE>ROLLUP</CODE> and <CODE>ORDER BY</CODE> are mutually
exclusive. However, you still have some control over sort order.
<CODE>GROUP BY</CODE>
in MySQL sorts results, and you can use explicit <CODE>ASC</CODE> and <CODE>DESC</CODE> keywords
with columns named in the <CODE>GROUP BY</CODE> list to specify sort order for
individual columns.  (The higher-level summary rows added by <CODE>ROLLUP</CODE>
still appear after the rows from which they are calculated, regardless
of the sort order.)

</P>
<P>
<CODE>LIMIT</CODE> can be used to restrict the number of rows returned to the
client. <CODE>LIMIT</CODE> is applied after <CODE>ROLLUP</CODE>, so the limit applies
against the extra rows added by <CODE>ROLLUP</CODE>. For example:

</P>

<PRE>
mysql&#62; SELECT year, country, product, SUM(profit)
    -&#62; FROM sales
    -&#62; GROUP BY year, country, product WITH ROLLUP
    -&#62; LIMIT 5;
+------+---------+------------+-------------+
| year | country | product    | SUM(profit) |
+------+---------+------------+-------------+
| 2000 | Finland | Computer   |        1500 |
| 2000 | Finland | Phone      |         100 |
| 2000 | Finland | NULL       |        1600 |
| 2000 | India   | Calculator |         150 |
| 2000 | India   | Computer   |        1200 |
+------+---------+------------+-------------+
</PRE>

<P>
Using <CODE>LIMIT</CODE> with <CODE>ROLLUP</CODE> may produce results
that are more difficult to interpret, because you have less context
for understanding the super-aggregate rows.

</P>
<P>
The <CODE>NULL</CODE> indicators in each super-aggregate row are produced when the
row is sent to the client.  The server looks at the columns named in
the <CODE>GROUP BY</CODE> clause following the leftmost one that has changed value.
For any column in the result set with a name that is a lexical match to
any of those names, its value is set to <CODE>NULL</CODE>.  (If you specify grouping
columns by column number, the server identifies which columns to set to
<CODE>NULL</CODE> by number.)

</P>
<P>
Because the <CODE>NULL</CODE> values in the super-aggregate rows are placed into the
result set at such a late stage in query processing, you cannot test them
as <CODE>NULL</CODE> values within the query itself.  For example, you cannot add
<CODE>HAVING product IS NULL</CODE> to the query to eliminate from the output all
but the super-aggregate rows.

</P>
<P>
On the other hand, the <CODE>NULL</CODE> values do appear as <CODE>NULL</CODE>
on the client side and can be tested as such using any MySQL client
programming interface.

</P>


<H3><A NAME="GROUP-BY-hidden-fields" HREF="manual_toc.html#GROUP-BY-hidden-fields">13.9.3  <CODE>GROUP BY</CODE> with Hidden Fields</A></H3>

<P>
<A NAME="IDX1512"></A>
MySQL extends the use of <CODE>GROUP BY</CODE> so that you can use columns or
calculations in the <CODE>SELECT</CODE> list that don't appear in
the <CODE>GROUP BY</CODE> clause. This stands for <EM>any possible value for this
group</EM>.  You can use this to get better performance by avoiding sorting and
grouping on unnecessary items.  For example, you don't need to group on
<CODE>customer.name</CODE> in the following query:

</P>

<PRE>
mysql&#62; SELECT order.custid, customer.name, MAX(payments)
    -&#62;        FROM order,customer
    -&#62;        WHERE order.custid = customer.custid
    -&#62;        GROUP BY order.custid;
</PRE>

<P>
In standard SQL, you would have to add <CODE>customer.name</CODE> to the
<CODE>GROUP BY</CODE> clause.  In MySQL, the name is redundant if you don't run in
ANSI mode.

</P>
<P>
Do <EM>not</EM> use this feature if the columns you omit from the
<CODE>GROUP BY</CODE> part are not unique in the group!  You will get
unpredictable results.

</P>
<P>
In some cases, you can use <CODE>MIN()</CODE> and <CODE>MAX()</CODE> to obtain a specific
column value even if it isn't unique. The following gives the value of
<CODE>column</CODE> from the row containing the smallest value in the <CODE>sort</CODE>
column:

</P>

<PRE>
SUBSTR(MIN(CONCAT(RPAD(sort,6,' '),column)),7)
</PRE>

<P>
See section <A HREF="manual.html#example-Maximum-column-group-row">3.6.4  The Rows Holding the Group-wise Maximum of a Certain Field</A>.

</P>
<P>
<A NAME="IDX1513"></A>
<A NAME="IDX1514"></A>
<A NAME="IDX1515"></A>
<A NAME="IDX1516"></A>
<A NAME="IDX1517"></A>
<A NAME="IDX1518"></A>
Note that if you are using MySQL 3.22 (or earlier) or if
you are trying to follow standard SQL, you can't use expressions in <CODE>GROUP
BY</CODE> or <CODE>ORDER BY</CODE> clauses.  You can work around this limitation by
using an alias for the expression:

</P>

<PRE>
mysql&#62; SELECT id,FLOOR(value/100) AS val FROM tbl_name
    -&#62;     GROUP BY id, val ORDER BY val;
</PRE>

<P>
In MySQL 3.23 and up, aliases are unnecessary. You can use expressions 
in <CODE>GROUP BY</CODE> and <CODE>ORDER BY</CODE> clauses.  For example:

</P>

<PRE>
mysql&#62; SELECT id, FLOOR(value/100) FROM tbl_name ORDER BY RAND();
</PRE>



<H1><A NAME="SQL_Syntax" HREF="manual_toc.html#SQL_Syntax">14  SQL Statement Syntax</A></H1>

<P>
This chapter describes the syntax for the SQL statements supported in MySQL.

</P>


<H2><A NAME="Data_Manipulation" HREF="manual_toc.html#Data_Manipulation">14.1  Data Manipulation Statements</A></H2>



<H3><A NAME="DELETE" HREF="manual_toc.html#DELETE">14.1.1  <CODE>DELETE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1519"></A>

</P>
<P>
Single-table syntax:

<PRE>
DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM tbl_name
       [WHERE where_definition]
       [ORDER BY ...]
       [LIMIT row_count]
</PRE>

<P>
Multiple-table syntax:

</P>

<PRE>
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
       tbl_name[.*] [, tbl_name[.*] ...]
       FROM table_references
       [WHERE where_definition]
</PRE>

<P>
Or:

</P>

<PRE>
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
       FROM tbl_name[.*] [, tbl_name[.*] ...]
       USING table_references
       [WHERE where_definition]
</PRE>

<P>
<CODE>DELETE</CODE> deletes rows from <CODE>tbl_name</CODE> that satisfy the condition
given by <CODE>where_definition</CODE>, and returns the number of records deleted.

</P>
<P>
If you issue a <CODE>DELETE</CODE> statement with no <CODE>WHERE</CODE> clause, all
rows are deleted.  A faster way to do this, when you don't want to know
the number of deleted rows, is using <CODE>TRUNCATE TABLE</CODE>.
See section <A HREF="manual.html#TRUNCATE">14.1.9  <CODE>TRUNCATE</CODE> Syntax</A>.

</P>
<P>
In MySQL 3.23, <CODE>DELETE</CODE> without a <CODE>WHERE</CODE> clause returns zero
as the number of affected records.

</P>
<P>
In MySQL 3.23, if you really want to know how many records are deleted
when you are deleting all rows, and are willing to suffer a speed
penalty, you can use a <CODE>DELETE</CODE> statement that includes a
<CODE>WHERE</CODE> clause with an expression that is true for every row. For
example:

</P>

<PRE>
mysql&#62; DELETE FROM tbl_name WHERE 1&#62;0;
</PRE>

<P>
This is much slower than <CODE>TRUNCATE tbl_name</CODE>, because it deletes
rows one at a time.

</P>
<P>
If you delete the row containing the maximum value for an
<CODE>AUTO_INCREMENT</CODE> column, the value will be reused for an <CODE>ISAM</CODE>
or <CODE>BDB</CODE> table, but not for a <CODE>MyISAM</CODE> or <CODE>InnoDB</CODE> table.
If you delete all rows in the table with <CODE>DELETE FROM tbl_name</CODE>
(without a <CODE>WHERE</CODE>) in <CODE>AUTOCOMMIT</CODE> mode, the sequence starts
over for all table types except for <CODE>InnoDB</CODE> and (as of MySQL 4.0)
<CODE>MyISAM</CODE>. There are some exceptions to this behavior for <CODE>InnoDB</CODE>
tables, discussed in
section <A HREF="manual.html#InnoDB_auto-increment_column">16.7.3  How an <CODE>AUTO_INCREMENT</CODE> Column Works in <CODE>InnoDB</CODE></A>.

</P>
<P>
For <CODE>MyISAM</CODE> and <CODE>BDB</CODE> tables, you can specify an
<CODE>AUTO_INCREMENT</CODE> secondary column in a multiple-column key.  In this
case, reuse of values deleted from the top of the sequence occurs even
for <CODE>MyISAM</CODE> tables.
See section <A HREF="manual.html#example-AUTO_INCREMENT">3.6.9  Using <CODE>AUTO_INCREMENT</CODE></A>.

</P>
<P>
The <CODE>DELETE</CODE> statement supports the following modifiers:

</P>

<UL>

<LI>

If you specify the <CODE>LOW_PRIORITY</CODE> keyword, execution of the
<CODE>DELETE</CODE> is delayed until no other clients are reading from the table.

<LI>

For <CODE>MyISAM</CODE> tables, if you specify the <CODE>QUICK</CODE> keyword, the
storage engine does not merge index leaves during delete, which may speed up
certain kind of deletes.

<LI>

The <CODE>IGNORE</CODE> keyword causes MySQL to ignore all errors during the
process of deleting rows. (Errors encountered during the parsing stage are
processed in the usual manner.) Errors that are ignored due to the use of
this option are returned as warnings. This option first appeared in MySQL
4.1.1.

</UL>

<P>
The speed of delete operations may also be affected by factors discussed in
section <A HREF="manual.html#Delete_speed">7.2.14  Speed of <CODE>DELETE</CODE> Queries</A>.

</P>
<P>
In <CODE>MyISAM</CODE> tables, deleted records are maintained in a linked list and
subsequent <CODE>INSERT</CODE> operations reuse old record positions. To
reclaim unused space and reduce file sizes, use the <CODE>OPTIMIZE
TABLE</CODE> statement or the <CODE>myisamchk</CODE> utility to reorganize tables.
<CODE>OPTIMIZE TABLE</CODE> is easier, but <CODE>myisamchk</CODE> is faster.  See
section <A HREF="manual.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A> and section <A HREF="manual.html#Optimisation">5.6.2.10  Table Optimization</A>.

</P>
<P>
The MySQL-specific <CODE>LIMIT row_count</CODE> option to <CODE>DELETE</CODE> tells
the server the maximum number of rows to be deleted before control is
returned to the client.  This can be used to ensure that a specific
<CODE>DELETE</CODE> statement doesn't take too much time.  You can simply repeat
the <CODE>DELETE</CODE> statement until the number of affected rows is less than
the <CODE>LIMIT</CODE> value.

</P>
<P>
If the <CODE>DELETE</CODE> statement includes an <CODE>ORDER BY</CODE> clause, the rows
are deleted in the order specified by the clause. This is really useful only
in conjunction with <CODE>LIMIT</CODE>.  For example, the following statement
finds rows matching the <CODE>WHERE</CODE> clause, sorts them in <CODE>timestamp</CODE>
order, and deletes the first (oldest) one:

</P>

<PRE>
DELETE FROM somelog
WHERE user = 'jcole'
ORDER BY timestamp
LIMIT 1
</PRE>

<P>
<CODE>ORDER BY</CODE> can be used with <CODE>DELETE</CODE> beginning with MySQL 4.0.0.

</P>
<P>
From MySQL 4.0, you can specify multiple tables in the <CODE>DELETE</CODE>
statement to delete rows from one or more tables depending on a particular
condition in multiple tables. However, you cannot use <CODE>ORDER BY</CODE>
or <CODE>LIMIT</CODE> in a multiple-table <CODE>DELETE</CODE>.

</P>
<P>
The first multiple-table <CODE>DELETE</CODE> syntax is supported starting from
MySQL 4.0.0.  The second is supported starting from MySQL 4.0.2. The
<CODE>table_references</CODE> part lists the tables involved in the join.
Its syntax is described in section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>.

</P>
<P>
For the first syntax, only matching rows from the tables listed before the
<CODE>FROM</CODE> clause are deleted. For the second syntax, only matching rows
from the tables listed in the <CODE>FROM</CODE> clause (before the <CODE>USING</CODE>
clause) are deleted.  The effect is that you can delete rows from many
tables at the same time and also have additional tables that are used for
searching:

</P>

<PRE>
DELETE t1,t2 FROM t1,t2,t3 WHERE t1.id=t2.id AND t2.id=t3.id;
</PRE>

<P>
Or:

</P>

<PRE>
DELETE FROM t1,t2 USING t1,t2,t3 WHERE t1.id=t2.id AND t2.id=t3.id;
</PRE>

<P>
These statements use all three files when searching for rows to delete, but
delete matching rows only from tables <CODE>t1</CODE> and <CODE>t2</CODE>.

</P>
<P>
The examples show inner joins using the comma operator, but
multiple-table <CODE>DELETE</CODE> statements can use any type of
join allowed in <CODE>SELECT</CODE> statements, such as <CODE>LEFT JOIN</CODE>.

</P>
<P>
The syntax allows <CODE>.*</CODE> after the table names for compatibility with
<CODE>Access</CODE>.

</P>
<P>
If you use a multiple-table <CODE>DELETE</CODE> statement involving
<CODE>InnoDB</CODE> tables for which there are foreign key constraints,
the MySQL optimizer might process tables in an order that differs from
that of their parent/child relationship. In this case, the statement
fails and rolls back. Instead, delete from a single table and rely on the
<CODE>ON DELETE</CODE> capabilities that <CODE>InnoDB</CODE> provides to cause the
other tables to be modified accordingly.

</P>
<P>
<STRONG>Note:</STRONG> In MySQL 4.0, you should refer to the table names to be
deleted with the true table name. In MySQL 4.1, you must use the alias
(if one was given) when referring to a table name:

</P>
<P>
In MySQL 4.0:

</P>

<PRE>
DELETE test FROM test AS t1, test2 WHERE ...
</PRE>

<P>
In MySQL 4.1:

</P>

<PRE>
DELETE t1 FROM test AS t1, test2 WHERE ...
</PRE>

<P>
The reason we didn't make this change in 4.0 is that we didn't
want to break any old applications in 4.0 using the old syntax.

</P>


<H3><A NAME="DO" HREF="manual_toc.html#DO">14.1.2  <CODE>DO</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1520"></A>

</P>

<PRE>
DO expr [, expr] ...
</PRE>

<P>
<CODE>DO</CODE> executes the expressions but doesn't return any results.  This is
shorthand for <CODE>SELECT expr, ...</CODE>, but has the advantage that it's
slightly faster when you don't care about the result.

</P>
<P>
<CODE>DO</CODE> is useful mainly with functions that have side effects, such as
<CODE>RELEASE_LOCK()</CODE>.

</P>
<P>
<CODE>DO</CODE> was added in MySQL 3.23.47.

</P>



<H3><A NAME="HANDLER" HREF="manual_toc.html#HANDLER">14.1.3  <CODE>HANDLER</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1521"></A>

</P>

<PRE>
HANDLER tbl_name OPEN [ AS alias ]
HANDLER tbl_name READ index_name { = | &#62;= | &#60;= | &#60; } (value1,value2,...)
    [ WHERE where_condition ] [LIMIT ... ]
HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }
    [ WHERE where_condition ] [LIMIT ... ]
HANDLER tbl_name READ { FIRST | NEXT }
    [ WHERE where_condition ] [LIMIT ... ]
HANDLER tbl_name CLOSE
</PRE>

<P>
The <CODE>HANDLER</CODE> statement provides direct access to table storage engine
interfaces.  It is available for <CODE>MyISAM</CODE> tables as MySQL 4.0.0 and
<CODE>InnoDB</CODE> tables as of MySQL 4.0.3.

</P>
<P>
The <CODE>HANDLER ... OPEN</CODE> statement opens a table, making
it accessible via subsequent <CODE>HANDLER ... READ</CODE> statements.
This table object is not shared by other threads and is not closed
until the thread calls <CODE>HANDLER ... CLOSE</CODE> or the thread terminates.
If you open the table using an alias, further references to the table with
other <CODE>HANDLER</CODE> statements must use the alias rather than the table
name.

</P>
<P>
The first <CODE>HANDLER ... READ</CODE> syntax fetches a row where the index
specified satisfies the given values and the <CODE>WHERE</CODE> condition is met.
If you have a multiple-column index, specify the index column values as a
comma-separated list. Either specify values for all the columns in the
index, or specify values for a leftmost prefix of the index columns. Suppose
that an index includes three columns named <CODE>col_a</CODE>, <CODE>col_b</CODE>, and
<CODE>col_c</CODE>, in that order.  The <CODE>HANDLER</CODE> statement can specify
values for all three columns in the index, or for the columns in a leftmost
prefix. For example:

</P>

<PRE>
HANDLER ... index_name = (col_a_val,col_b_val,col_c_val) ...
HANDLER ... index_name = (col_a_val,col_b_val) ...
HANDLER ... index_name = (col_a_val) ...
</PRE>

<P>
The second <CODE>HANDLER ... READ</CODE> syntax fetches a row from the table in
index order that that matches <CODE>WHERE</CODE> condition.

</P>
<P>
The third <CODE>HANDLER ... READ</CODE> syntax fetches a row from the table in
natural row order that matches the <CODE>WHERE</CODE> condition. It is faster than
<CODE>HANDLER tbl_name READ index_name</CODE> when a full table scan is desired.
Natural row order is the order in which rows are stored in a <CODE>MyISAM</CODE>
table data file. This statement works for <CODE>InnoDB</CODE> tables as well, but
there is no such concept because there is no separate data file.

</P>
<P>
Without a <CODE>LIMIT</CODE> clause, all forms of <CODE>HANDLER ... READ</CODE> fetch a
single row if one is available. To return a specific number of rows, include a
<CODE>LIMIT</CODE> clause. It has the same syntax as for the <CODE>SELECT</CODE>
statement.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

</P>
<P>
<CODE>HANDLER ... CLOSE</CODE> closes a table that was opened with
<CODE>HANDLER ... OPEN</CODE>.

</P>
<P>
Note: To use the <CODE>HANDLER</CODE> interface to refer to a table's
<CODE>PRIMARY KEY</CODE>, use the quoted identifier <CODE>`PRIMARY`</CODE>:

</P>

<PRE>
HANDLER tbl_name READ `PRIMARY` &#62; (...);
</PRE>

<P>
<CODE>HANDLER</CODE> is a somewhat low-level statement.  For example, it does not
provide consistency.  That is, <CODE>HANDLER ... OPEN</CODE> does <EM>not</EM>
take a snapshot of the table, and does <EM>not</EM> lock the table. This
means that after a <CODE>HANDLER ... OPEN</CODE> statement is issued, table data
can be modified (by this or any other thread) and these modifications might
appear only partially in <CODE>HANDLER ... NEXT</CODE> or <CODE>HANDLER ... PREV</CODE>
scans.

</P>
<P>
There are several reasons to use the <CODE>HANDLER</CODE> interface instead of
normal <CODE>SELECT</CODE> statements:

</P>

<UL>

<LI>

<CODE>HANDLER</CODE> is faster than <CODE>SELECT</CODE>:


<UL>

<LI>

A designated storage engine handler object is allocated for the
<CODE>HANDLER ...  OPEN</CODE>. The object is reused for the following
<CODE>HANDLER</CODE> statements for the table; it need not be reinitialized for
each one.

<LI>

There is less parsing involved.

<LI>

There is no optimizer or query-checking overhead.

<LI>

The table doesn't have to be locked between two handler requests.

<LI>

The handler interface doesn't have to provide a consistent look of the
data (for example, dirty reads are allowed), so the storage engine can
use optimizations that <CODE>SELECT</CODE> doesn't normally allow.

</UL>

<LI>

<CODE>HANDLER</CODE> makes it much easier to port applications that use an
<CODE>ISAM</CODE>-like interface to MySQL.

<LI>

<CODE>HANDLER</CODE> allows you to traverse a database in a manner that is not
easy (or perhaps even impossible) to do with <CODE>SELECT</CODE>. The <CODE>HANDLER</CODE>
interface is a more natural way to look at data when working with
applications that provide an interactive user interface to the database.

</UL>



<H3><A NAME="INSERT" HREF="manual_toc.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1522"></A>

</P>

<PRE>
INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
    [INTO] tbl_name [(col_name,...)]
    VALUES ({expr | DEFAULT},...),(...),...
    [ ON DUPLICATE KEY UPDATE col_name=expr, ... ]
</PRE>

<P>
Or:

<PRE>
INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
    [INTO] tbl_name
    SET col_name={expr | DEFAULT}, ...
    [ ON DUPLICATE KEY UPDATE col_name=expr, ... ]
</PRE>

<P>
Or:

<PRE>
INSERT [LOW_PRIORITY | DELAYED] [IGNORE]
    [INTO] tbl_name [(col_name,...)]
    SELECT ...
</PRE>

<P>
<CODE>INSERT</CODE> inserts new rows into an existing table.  The <CODE>INSERT ...
VALUES</CODE> and <CODE>INSERT ... SET</CODE> forms of the statement insert rows based
on explicitly specified values.  The <CODE>INSERT ... SELECT</CODE> form inserts
rows selected from another table or tables.  The <CODE>INSERT ... VALUES</CODE>
form with multiple value lists is supported in MySQL 3.22.5 or
later.  The <CODE>INSERT ... SET</CODE> syntax is supported in MySQL
3.22.10 or later.
<CODE>INSERT ... SELECT</CODE> is discussed further in
See section <A HREF="manual.html#INSERT_SELECT">14.1.4.1  <CODE>INSERT ... SELECT</CODE> Syntax</A>.

</P>
<P>
<CODE>tbl_name</CODE> is the table into which rows should be inserted. The columns
for which the statement provides values can be specified as follows:

</P>

<UL>

<LI>

The column name list or the <CODE>SET</CODE> clause indicates the columns
explicitly.

<LI>

If you do not specify the column list for <CODE>INSERT ... VALUES</CODE> or
<CODE>INSERT ... SELECT</CODE>, values for every column in the table must be
provided in the <CODE>VALUES()</CODE> list or by the <CODE>SELECT</CODE>.  If you don't
know the order of the columns in the table, use <CODE>DESCRIBE tbl_name</CODE> to
find out.

</UL>

<P>
Column values can be given in several ways:

</P>

<UL>

<LI>

<A NAME="IDX1523"></A>
Any column not explicitly given a value is set to its default value.  For
example, if you specify a column list that doesn't name all the columns in
the table, unnamed columns are set to their default values.  Default value
assignment is described in section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

MySQL always has a default value for all columns. This is something
that is imposed on MySQL to be able to work with both transactional
and non-transactional tables.

Our view is that column content checking should be done in the
application and not in the database server.

Note: If you want <CODE>INSERT</CODE> statements to generate an error unless you
explicitly specify values for all columns that require a non-<CODE>NULL</CODE>
value, you can configure MySQL using the <CODE>DONT_USE_DEFAULT_FIELDS</CODE>
compiler option.  This behavior is available only if you compile MySQL from source.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

<LI>

You can use the keyword <CODE>DEFAULT</CODE> to explicitly set a column to its
default value. (New in MySQL 4.0.3.)  This makes it easier to write
<CODE>INSERT</CODE> statements that assign values to all but a few columns,
because it allows you to avoid writing an incomplete <CODE>VALUES</CODE> list
that does not include a value for each column in the table.
Otherwise, you would have to write out the list of column names
corresponding to each value in the <CODE>VALUES</CODE> list.

<LI>

If both the column list and the <CODE>VALUES</CODE> list are empty, <CODE>INSERT</CODE>
creates a row with each column set to its default value:


<PRE>
mysql&#62; INSERT INTO tbl_name () VALUES();
</PRE>

<LI>

An expression <CODE>expr</CODE> can refer to any column that was set earlier in a
value list.  For example, you can do this because the value for <CODE>col2</CODE>
refers to <CODE>col1</CODE>, which has already been assigned:


<PRE>
mysql&#62; INSERT INTO tbl_name (col1,col2) VALUES(15,col1*2);
</PRE>

But you cannot do this because the value for <CODE>col1</CODE> refers to
<CODE>col2</CODE>, which is assigned after <CODE>col1</CODE>:


<PRE>
mysql&#62; INSERT INTO tbl_name (col1,col2) VALUES(col2*2,15);
</PRE>

</UL>

<P>
The <CODE>INSERT</CODE> statement supports the following modifiers:

</P>

<UL>

<LI>

If you specify the <CODE>DELAYED</CODE> keyword, the server puts the row or
rows to be inserted into a buffer, and the client issuing the <CODE>INSERT
DELAYED</CODE> statement then can continue on.  If the table is busy, the server
holds the rows.  When the table becomes free, it begins inserting rows,
checking periodically to see whether there are new read requests for the
table. If there are, the delayed row queue is suspended until the table
becomes free again.
See section <A HREF="manual.html#INSERT_DELAYED">14.1.4.2  <CODE>INSERT DELAYED</CODE> Syntax</A>.

<LI>

If you specify the <CODE>LOW_PRIORITY</CODE> keyword, execution of the
<CODE>INSERT</CODE> is delayed until no other clients are reading from the
table. This includes other clients that began reading while existing
clients are reading, and while the <CODE>INSERT LOW_PRIORITY</CODE> statement
is waiting. It is possible, therefore, for a client that issues an
<CODE>INSERT LOW_PRIORITY</CODE> statement to wait for a very long time (or
even forever) in a read-heavy environment.
(This is in contrast to <CODE>INSERT DELAYED</CODE>, which lets the client
continue at once.)  See section <A HREF="manual.html#INSERT_DELAYED">14.1.4.2  <CODE>INSERT DELAYED</CODE> Syntax</A>.  Note
that <CODE>LOW_PRIORITY</CODE> should normally not be used with <CODE>MyISAM</CODE>
tables because doing so disables concurrent inserts.
See section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.

<LI>

If you specify the <CODE>IGNORE</CODE> keyword in an <CODE>INSERT</CODE> with many rows,
any rows that duplicate an existing <CODE>UNIQUE</CODE> index or <CODE>PRIMARY
KEY</CODE> value in the table are ignored and are not inserted.  If you do not
specify <CODE>IGNORE</CODE>, the insert is aborted if there is any row that
duplicates an existing key value.  You can determine with the
<CODE>mysql_info()</CODE> C API function how many rows were inserted into the
table.

</UL>

<P>
If you specify the <CODE>ON DUPLICATE KEY UPDATE</CODE> clause (new in MySQL 4.1.0), and
a row is inserted that would cause a duplicate value in a <CODE>UNIQUE</CODE> index
or
<CODE>PRIMARY KEY</CODE>, an <CODE>UPDATE</CODE> of the old row is performed. For
example,
if column <CODE>a</CODE> is declared as <CODE>UNIQUE</CODE> and already contains the value
<CODE>1</CODE>, the following two statements have identical effect:

</P>

<PRE>
mysql&#62; INSERT INTO table (a,b,c) VALUES (1,2,3)
    -&#62; ON DUPLICATE KEY UPDATE c=c+1;

mysql&#62; UPDATE table SET c=c+1 WHERE a=1;
</PRE>

<P>
<STRONG>Note:</STRONG> If column <CODE>b</CODE> is unique too, the <CODE>INSERT</CODE> would be
equivalent to this <CODE>UPDATE</CODE> statement instead:

</P>

<PRE>
mysql&#62; UPDATE table SET c=c+1 WHERE a=1 OR b=2 LIMIT 1;
</PRE>

<P>
If <CODE>a=1 OR b=2</CODE> matches several rows, only <EM>one</EM> row
is updated! In general, you should try to avoid using the
<CODE>ON DUPLICATE KEY</CODE> clause on tables with multiple <CODE>UNIQUE</CODE> keys.

</P>
<P>
As of MySQL 4.1.1, you can use the <CODE>VALUES(col_name)</CODE> function in the
<CODE>UPDATE</CODE> clause to refer to column values from the <CODE>INSERT</CODE> part
of the <CODE>INSERT ... UPDATE</CODE> statement. In other words,
<CODE>VALUES(col_name)</CODE> in the <CODE>UPDATE</CODE> clause refers to the value of
<CODE>col_name</CODE> that would be inserted if no duplicate-key conflict
occurred. This function is especially useful in multiple-row inserts. The
<CODE>VALUES()</CODE> function is meaningful only in <CODE>INSERT ... UPDATE</CODE>
statements and returns <CODE>NULL</CODE> otherwise.

</P>
<P>
Example:

</P>

<PRE>
mysql&#62; INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)
    -&#62; ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);
</PRE>

<P>
That statement is identical to the following two statements:

</P>

<PRE>
mysql&#62; INSERT INTO table (a,b,c) VALUES (1,2,3)
    -&#62; ON DUPLICATE KEY UPDATE c=3;
mysql&#62; INSERT INTO table (a,b,c) VALUES (4,5,6)
    -&#62; ON DUPLICATE KEY UPDATE c=9;
</PRE>

<P>
When you use <CODE>ON DUPLICATE KEY UPDATE</CODE>, the <CODE>DELAYED</CODE> option is
ignored.

</P>
<P>
<A NAME="IDX1524"></A>
<A NAME="IDX1525"></A>

</P>
<P>
You can find the value used for an <CODE>AUTO_INCREMENT</CODE> column by using the
<CODE>LAST_INSERT_ID()</CODE> function. From within the C API, use the
<CODE>mysql_insert_id()</CODE> function.  However, note that the two functions do
not behave quite identically under all circumstances.
The behavior of <CODE>INSERT</CODE> statements with respect to <CODE>AUTO_INCREMENT</CODE>
columns is discussed further in section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A> and
section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

</P>
<P>
If you use an <CODE>INSERT ... VALUES</CODE> statement with multiple value lists
or <CODE>INSERT ... SELECT</CODE>, the statement returns an information string in
this format:

</P>

<PRE>
Records: 100 Duplicates: 0 Warnings: 0
</PRE>

<P>
<CODE>Records</CODE> indicates the number of rows processed by the statement.
(This is not necessarily the number of rows actually inserted.
<CODE>Duplicates</CODE> can be non-zero.)
<CODE>Duplicates</CODE> indicates the number of rows that couldn't be inserted
because they would duplicate some existing unique index value.
<CODE>Warnings</CODE> indicates the number of attempts to insert column values that
were problematic in some way. Warnings can occur under any of the following
conditions:

</P>

<UL>
<LI>

Inserting <CODE>NULL</CODE> into a column that has been declared <CODE>NOT NULL</CODE>.
For multiple-row <CODE>INSERT</CODE> statements or <CODE>INSERT ... SELECT</CODE>
statements,
the column is set to the default value appropriate for the column type.
This is <CODE>0</CODE> for numeric types, the empty string (<CODE>''</CODE>) for
string types, and the ``zero'' value for date and time types.

<LI>

Setting a numeric column to a value that lies outside the column's range.
The value is clipped to the closest endpoint of the range.

<LI>

Assigning a value such as <CODE>'10.34 a'</CODE> to a numeric column.  The
trailing non-numeric text is stripped off and the remaining numeric part is
inserted.  If the string value has no leading numeric part, the column is
set to <CODE>0</CODE>.

<LI>

Inserting a string into a string column (<CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, <CODE>TEXT</CODE>, or
<CODE>BLOB</CODE>) that exceeds the column's maximum length.  The value is
truncated to the column's maximum length.

<LI>

Inserting a value into a date or time column that is illegal for the column
type.  The column is set to the appropriate zero value for the type.
</UL>

<P>
<A NAME="IDX1526"></A>

</P>
<P>
If you are using the C API, the information string can be obtained by invoking
the <CODE>mysql_info()</CODE> function.
See section <A HREF="manual.html#mysql_info">20.2.3.126  <CODE>mysql_info()</CODE></A>.

</P>
<P>
<A NAME="IDX1527"></A>
<A NAME="IDX1528"></A>

</P>



<H4><A NAME="INSERT_SELECT" HREF="manual_toc.html#INSERT_SELECT">14.1.4.1  <CODE>INSERT ... SELECT</CODE> Syntax</A></H4>


<PRE>
INSERT [LOW_PRIORITY] [IGNORE] [INTO] tbl_name [(column list)]
    SELECT ...
</PRE>

<P>
With <CODE>INSERT ... SELECT</CODE>, you can quickly insert many rows
into a table from one or many tables.

</P>
<P>
For example:

</P>

<PRE>
INSERT INTO tbl_temp2 (fld_id)
    SELECT tbl_temp1.fld_order_id
    FROM tbl_temp1 WHERE tbl_temp1.fld_order_id &#62; 100;
</PRE>

<P>
The following conditions hold for an <CODE>INSERT ... SELECT</CODE> statement:

</P>

<UL>
<LI>

Prior to MySQL 4.0.1, <CODE>INSERT ... SELECT</CODE> implicitly operates in
<CODE>IGNORE</CODE> mode.  As of MySQL 4.0.1, specify <CODE>IGNORE</CODE>
explicitly to ignore records that would cause duplicate-key violations.

<LI>

Do not use <CODE>DELAYED</CODE> with <CODE>INSERT ... SELECT</CODE>.

<LI>

Prior to MySQL 4.0.14,
the target table of the <CODE>INSERT</CODE> statement cannot appear in the
<CODE>FROM</CODE> clause of the <CODE>SELECT</CODE> part of the query.
This limitation is lifted in 4.0.14.

<LI>

<CODE>AUTO_INCREMENT</CODE> columns work as usual.

<LI>

To ensure that the binary log can be used to re-create the
original tables, MySQL will not allow concurrent inserts during
<CODE>INSERT ... SELECT</CODE>.
</UL>

<P>
You can use <CODE>REPLACE</CODE> instead of <CODE>INSERT</CODE> to overwrite old rows.
<CODE>REPLACE</CODE> is the counterpart to <CODE>INSERT IGNORE</CODE> in the treatment
of new rows that contain unique key values that duplicate old rows:
The new rows are used to replace the old rows rather than being discarded.

</P>



<H4><A NAME="INSERT_DELAYED" HREF="manual_toc.html#INSERT_DELAYED">14.1.4.2  <CODE>INSERT DELAYED</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1529"></A>
<A NAME="IDX1530"></A>

</P>
<P>
<A NAME="IDX1531"></A>

</P>

<PRE>
INSERT DELAYED ...
</PRE>

<P>
The <CODE>DELAYED</CODE> option for the <CODE>INSERT</CODE> statement is a
MySQL extension to standard SQL that is very useful if you have clients
that can't wait for the <CODE>INSERT</CODE> to complete.  This is a common
problem when you use MySQL for logging and you also
periodically run <CODE>SELECT</CODE> and <CODE>UPDATE</CODE> statements that take a
long time to complete.  <CODE>DELAYED</CODE> was introduced in MySQL
3.22.15.

</P>
<P>
When a client uses <CODE>INSERT DELAYED</CODE>, it gets an okay from the server at
once, and the row is queued to be inserted when the table is not in use by
any other thread.

</P>
<P>
Another major benefit of using <CODE>INSERT DELAYED</CODE> is that inserts
from many clients are bundled together and written in one block. This is much
faster than doing many separate inserts.

</P>
<P>
There are some constraints on the use of <CODE>DELAYED</CODE>:

</P>

<UL>

<LI>

<CODE>INSERT DELAYED</CODE> works only with <CODE>MyISAM</CODE> and <CODE>ISAM</CODE>
tables.
For <CODE>MyISAM</CODE> tables, if there are no free blocks in the middle of the
data file, concurrent <CODE>SELECT</CODE> and <CODE>INSERT</CODE> statements are supported.
Under these circumstances, you very seldom need to use <CODE>INSERT
DELAYED</CODE> with <CODE>MyISAM</CODE>. See section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.

<LI>

<CODE>INSERT DELAYED</CODE> should be used only for <CODE>INSERT</CODE> statements that
specify value lists. This is enforced as of MySQL 4.0.18.  The server ignores
<CODE>DELAYED</CODE> for <CODE>INSERT DELAYED ... SELECT</CODE> statements.

<LI>

The server ignores
<CODE>DELAYED</CODE> for <CODE>INSERT DELAYED ... ON DUPLICATE UPDATE</CODE> statements.

<LI>

Because the statement returns immediately before the rows are inserted,
you cannot use <CODE>LAST_INSERT_ID()</CODE> to get the <CODE>AUTO_INCREMENT</CODE>
value the statement might generate.

<LI>

<CODE>DELAYED</CODE> rows are not visible to <CODE>SELECT</CODE> statements until they
actually have been inserted.

</UL>

<P>
Note that currently the queued rows are held only in memory until they are
inserted into the table.  This means that if you terminate <CODE>mysqld</CODE>
forcefully (for example, with <CODE>kill -9</CODE>) or if <CODE>mysqld</CODE> dies
unexpectedly, any queued rows that have not been written to disk are lost!

</P>
<P>
The following describes in detail what happens when you use the
<CODE>DELAYED</CODE> option to <CODE>INSERT</CODE> or <CODE>REPLACE</CODE>.  In this
description, the ``thread'' is the thread that received an <CODE>INSERT
DELAYED</CODE> statement and ``handler'' is the thread that handles all
<CODE>INSERT DELAYED</CODE> statements for a particular table.

</P>

<UL>
<LI>

When a thread executes a <CODE>DELAYED</CODE> statement for a table, a handler
thread is created to process all <CODE>DELAYED</CODE> statements for the table, if
no such handler already exists.

<LI>

The thread checks whether the handler has acquired a <CODE>DELAYED</CODE>
lock already; if not, it tells the handler thread to do so.  The
<CODE>DELAYED</CODE> lock can be obtained even if other threads have a <CODE>READ</CODE>
or <CODE>WRITE</CODE> lock on the table.  However, the handler will wait for all
<CODE>ALTER TABLE</CODE> locks or <CODE>FLUSH TABLES</CODE> to ensure that the table
structure is up to date.

<LI>

The thread executes the <CODE>INSERT</CODE> statement, but instead of writing
the row to the table, it puts a copy of the final row into a queue that
is managed by the handler thread. Any syntax errors are noticed by the
thread and reported to the client program.

<LI>

The client cannot obtain from the server the number of duplicate records or
the <CODE>AUTO_INCREMENT</CODE> value for the resulting row, because the
<CODE>INSERT</CODE> returns before the insert operation has been completed.  (If
you use the C API, the <CODE>mysql_info()</CODE> function doesn't return anything
meaningful, for the same reason.)

<LI>

The binary log is updated by the handler thread when the row is inserted into
the table.  In case of multiple-row inserts, the binary log is updated when
the first row is inserted.

<LI>

After every <CODE>delayed_insert_limit</CODE> rows are written, the handler checks
whether any <CODE>SELECT</CODE> statements are still pending.  If so, it
allows these to execute before continuing.

<A NAME="IDX1532"></A>
<A NAME="IDX1533"></A>
<LI>

When the handler has no more rows in its queue, the table is unlocked.  If no
new <CODE>INSERT DELAYED</CODE> statements are received within
<CODE>delayed_insert_timeout</CODE> seconds, the handler terminates.

<LI>

If more than <CODE>delayed_queue_size</CODE> rows are pending already in a
specific handler queue, the thread requesting <CODE>INSERT DELAYED</CODE>
waits until there is room in the queue.  This is done to ensure that
the <CODE>mysqld</CODE> server doesn't use all memory for the delayed memory
queue.

<LI>

The handler thread shows up in the MySQL process list with
<CODE>delayed_insert</CODE> in the <CODE>Command</CODE> column.  It will be killed if
you execute a <CODE>FLUSH TABLES</CODE> statement or kill it with <CODE>KILL
thread_id</CODE>. However, before exiting, it will first store all queued rows into
the table. During this time it will not accept any new <CODE>INSERT</CODE>
statements from another thread. If you execute an <CODE>INSERT DELAYED</CODE>
statement after this, a new handler thread will be created.

Note that this means that <CODE>INSERT DELAYED</CODE> statements have higher
priority than normal <CODE>INSERT</CODE> statements if there is an <CODE>INSERT
DELAYED</CODE> handler already running!  Other update statements will have to wait
until the <CODE>INSERT DELAYED</CODE> queue is empty, someone terminates the handler
thread (with <CODE>KILL thread_id</CODE>), or someone executes <CODE>FLUSH TABLES</CODE>.

<LI>

The following status variables provide information about <CODE>INSERT
DELAYED</CODE> statements:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Status Variable</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>Delayed_insert_threads</CODE> </TD><TD> Number of handler threads
</TD></TR>
<TR><TD><CODE>Delayed_writes</CODE> </TD><TD> Number of rows written with <CODE>INSERT DELAYED</CODE>
</TD></TR>
<TR><TD><CODE>Not_flushed_delayed_rows</CODE> </TD><TD> Number of rows waiting to be written
</TD></TR>
</TABLE>

You can view these variables by issuing a <CODE>SHOW STATUS</CODE> statement or
by executing a <CODE>mysqladmin extended-status</CODE> command.
</UL>

<P>
Note that <CODE>INSERT DELAYED</CODE> is slower than a normal <CODE>INSERT</CODE> if the
table is not in use.  There is also the additional overhead for the server
to handle a separate thread for each table for which there are delayed rows.
This means that you should use <CODE>INSERT DELAYED</CODE> only when you are
really sure that you need it!

</P>



<H3><A NAME="LOAD_DATA" HREF="manual_toc.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1534"></A>

</P>

<PRE>
LOAD DATA [LOW_PRIORITY | CONCURRENT] [LOCAL] INFILE 'file_name.txt'
    [REPLACE | IGNORE]
    INTO TABLE tbl_name
    [FIELDS
        [TERMINATED BY '\t']
        [[OPTIONALLY] ENCLOSED BY '']
        [ESCAPED BY '\\' ]
    ]
    [LINES 
        [STARTING BY '']    
        [TERMINATED BY '\n']
    ]
    [IGNORE number LINES]
    [(col_name,...)]
</PRE>

<P>
The <CODE>LOAD DATA INFILE</CODE> statement reads rows from a text file into a
table at a very high speed.
For more information about the efficiency of <CODE>INSERT</CODE> versus
<CODE>LOAD DATA INFILE</CODE> and speeding up <CODE>LOAD DATA INFILE</CODE>,
section <A HREF="manual.html#Insert_speed">7.2.12  Speed of <CODE>INSERT</CODE> Queries</A>.

</P>
<P>
<A NAME="IDX1535"></A>
You can also load data files by using the <CODE>mysqlimport</CODE> utility; it
operates by sending a <CODE>LOAD DATA INFILE</CODE> statement to the server.  The
<CODE>--local</CODE> option causes <CODE>mysqlimport</CODE> to read data files from the
client host.  You can specify the <CODE>--compress</CODE> option to get better
performance over slow networks if the client and server support the
compressed protocol.
See section <A HREF="manual.html#mysqlimport">8.10  The <CODE>mysqlimport</CODE> Data Import Program</A>.

</P>
<P>
If you specify the <CODE>LOW_PRIORITY</CODE> keyword, execution of the
<CODE>LOAD DATA</CODE> statement is delayed until no other clients are reading
from the table.

</P>
<P>
If you specify the <CODE>CONCURRENT</CODE> keyword with a <CODE>MyISAM</CODE> table that
satisfies the condition for concurrent inserts (that is, it contains no free
blocks in the middle),
then other threads can retrieve data from the table while <CODE>LOAD DATA</CODE>
is executing. Using this option affects the performance of <CODE>LOAD DATA</CODE>
a bit, even if no other thread is using the table at the same time.

</P>
<P>
If the <CODE>LOCAL</CODE> keyword is specified, it is
interpreted with respect to the client end of the connection:

</P>

<UL>

<LI>

If <CODE>LOCAL</CODE> is specified, the file is read by the client program on the
client host and sent to the server.

<LI>

If <CODE>LOCAL</CODE> is not specified, the
file must be located on the server host and is read directly by the server.

</UL>

<P>
<CODE>LOCAL</CODE> is available in MySQL 3.22.6 or later.

</P>
<P>
For security reasons, when reading text files located on the server, the
files must either reside in the database directory or be readable by all.
Also, to use <CODE>LOAD DATA INFILE</CODE> on server files, you must have the
<CODE>FILE</CODE> privilege.
See section <A HREF="manual.html#Privileges_provided">5.4.3  Privileges Provided by MySQL</A>.

</P>
<P>
Using <CODE>LOCAL</CODE> is a bit slower than letting the server access the files
directly, because the contents of the file must be sent over the connection
by the client to the server.  On the other hand, you do not need the
<CODE>FILE</CODE> privilege to load local files.

</P>
<P>
As of MySQL 3.23.49 and MySQL 4.0.2 (4.0.13 on Windows), 
<CODE>LOCAL</CODE> works only if your server
and your client both have been enabled to allow it.  For example, if
<CODE>mysqld</CODE> was started with <CODE>--local-infile=0</CODE>, <CODE>LOCAL</CODE> will
not work.
See section <A HREF="manual.html#LOAD_DATA_LOCAL">5.3.4  Security Issues with <CODE>LOAD DATA LOCAL</CODE></A>.

</P>
<P>
If you need <CODE>LOAD DATA</CODE> to read from a pipe, you can use the
following technique:

</P>

<PRE>
mkfifo /mysql/db/x/x
chmod 666 /mysql/db/x/x
cat &#60; /dev/tcp/10.1.1.12/4711 &#62; /mysql/db/x/x
mysql -e "LOAD DATA INFILE 'x' INTO TABLE x" x
</PRE>

<P>
If you are using a version of MySQL older than 3.23.25,
you can use this technique only with <CODE>LOAD DATA LOCAL INFILE</CODE>.

</P>
<P>
If you are using MySQL before Version 3.23.24, you can't read from a
FIFO with <CODE>LOAD DATA INFILE</CODE>.  If you need to read from a FIFO (for
example, the output from <CODE>gunzip</CODE>), use <CODE>LOAD DATA LOCAL INFILE</CODE>
instead.

</P>
<P>
When locating files on the server host, the server uses the following rules:

</P>

<UL>
<LI>

If an absolute pathname is given, the server uses the pathname as is.

<LI>

If a relative pathname with one or more leading components is given,
the server searches for the file relative to the server's data directory.

<LI>

If a filename with no leading components is given, the server looks for
the file in the database directory of the default database.
</UL>

<P>
Note that these rules mean that a file named as <TT>`./myfile.txt'</TT> is read from
the server's data directory, whereas the same file named as <TT>`myfile.txt'</TT> is
read from the database directory of the default database.  For example,
the following <CODE>LOAD DATA</CODE> statement reads the file <TT>`data.txt'</TT>
from the database directory for <CODE>db1</CODE> because <CODE>db1</CODE> is the current
database, even though the statement explicitly loads the file into a
table in the <CODE>db2</CODE> database:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE db2.my_table;
</PRE>

<P>
The <CODE>REPLACE</CODE> and <CODE>IGNORE</CODE> keywords control handling of input
records that duplicate existing records on unique key values.

</P>
<P>
If you specify <CODE>REPLACE</CODE>, input rows replace existing rows (in other
words, rows that have the same value for a primary or unique index as an
existing row). See section <A HREF="manual.html#REPLACE">14.1.6  <CODE>REPLACE</CODE> Syntax</A>.

</P>
<P>
If you specify <CODE>IGNORE</CODE>, input rows that duplicate an existing row
on a unique key value are skipped.  If you don't specify either option,
the behavior depends on whether or not the <CODE>LOCAL</CODE> keyword is specified.
Without <CODE>LOCAL</CODE>, an error occurs when a duplicate key value is
found, and the rest of the text file is ignored.  With <CODE>LOCAL</CODE>,
the default behavior is the same as if <CODE>IGNORE</CODE> is specified;
this is because the server has no way to stop transmission of the file
in the middle of the operation.

</P>
<P>
If you want to ignore foreign key constraints during the load operation, you
can issue a <CODE>SET FOREIGN_KEY_CHECKS=0</CODE> statement before executing
<CODE>LOAD DATA</CODE>.

</P>
<P>
If you use <CODE>LOAD DATA INFILE</CODE> on an empty <CODE>MyISAM</CODE> table, all
non-unique indexes are created in a separate batch (as for
<CODE>REPAIR TABLE</CODE>).  This normally makes <CODE>LOAD DATA INFILE</CODE> much faster
when you have many indexes.  Normally this is very fast, but in some
extreme cases, you can create the indexes even faster by turning them off
with <CODE>ALTER TABLE .. DISABLE KEYS</CODE> before loading the file into the
table and using <CODE>ALTER TABLE .. ENABLE KEYS</CODE> to re-create the indexes
after loading the file.
See section <A HREF="manual.html#Insert_speed">7.2.12  Speed of <CODE>INSERT</CODE> Queries</A>.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> is the complement of <CODE>SELECT ... INTO OUTFILE</CODE>.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.
To write data from a table to a file, use <CODE>SELECT ... INTO OUTFILE</CODE>.
To read the file back into a table, use <CODE>LOAD DATA INFILE</CODE>.
The syntax of the <CODE>FIELDS</CODE> and <CODE>LINES</CODE> clauses is the same for
both statements.  Both clauses are optional, but <CODE>FIELDS</CODE>
must precede <CODE>LINES</CODE> if both are specified.

</P>
<P>
If you specify a <CODE>FIELDS</CODE> clause,
each of its subclauses (<CODE>TERMINATED BY</CODE>, <CODE>[OPTIONALLY] ENCLOSED
BY</CODE>, and <CODE>ESCAPED BY</CODE>) is also optional, except that you must
specify at least one of them.

</P>
<P>
If you don't specify a <CODE>FIELDS</CODE> clause, the defaults are the
same as if you had written this:

</P>

<PRE>
FIELDS TERMINATED BY '\t' ENCLOSED BY '' ESCAPED BY '\\'
</PRE>

<P>
If you don't specify a <CODE>LINES</CODE> clause, the default
is the same as if you had written this:

</P>

<PRE>
LINES TERMINATED BY '\n' STARTING BY ''
</PRE>

<P>
In other words, the defaults cause <CODE>LOAD DATA INFILE</CODE> to act as follows
when reading input:

</P>

<UL>
<LI>

Look for line boundaries at newlines.

<LI>

Do not skip over any line prefix.

<LI>

Break lines into fields at tabs.

<LI>

Do not expect fields to be enclosed within any quoting characters.

<LI>

Interpret occurrences of tab, newline, or <SAMP>`\'</SAMP> preceded by
<SAMP>`\'</SAMP> as literal characters that are part of field values.
</UL>

<P>
Conversely, the defaults cause <CODE>SELECT ... INTO OUTFILE</CODE> to act as
follows when writing output:

</P>

<UL>
<LI>

Write tabs between fields.

<LI>

Do not enclose fields within any quoting characters.

<LI>

Use <SAMP>`\'</SAMP> to escape instances of tab, newline, or <SAMP>`\'</SAMP> that occur
within field values.

<LI>

Write newlines at the ends of lines.
</UL>

<P>
Note that to write <CODE>FIELDS ESCAPED BY '\\'</CODE>, you must specify two
backslashes for the value to be read as a single backslash.

</P>
<P>
<STRONG>Note:</STRONG> If you have generated the text file on a Windows system, you
might have to use <CODE>LINES TERMINATED BY '\r\n'</CODE> to read the file
properly, because Windows programs typically use two characters as a line
terminator. Some programs, such as WordPad, might use <CODE>\r</CODE> as a line
terminator when writing files.  To read such files, use <CODE>LINES
TERMINATED BY '\r</CODE>.

</P>
<P>
If all the lines you want to read in have a common prefix that you want to
ignore, you can use <CODE>LINES STARTING BY 'prefix_string'</CODE> to skip over
the prefix.  If a line doesn't include the prefix, the entire line is
skipped.

</P>
<P>
The <CODE>IGNORE number LINES</CODE> option can be used to ignore lines at
the start of the file.  For example, you can use <CODE>IGNORE 1 LINES</CODE>
to skip over an initial header line containing column names:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE '/tmp/test.txt'
    -&#62; INTO TABLE test IGNORE 1 LINES;
</PRE>

<P>
When you use <CODE>SELECT ... INTO OUTFILE</CODE> in tandem with <CODE>LOAD
DATA INFILE</CODE> to write data from a database into a file and then read
the file back into the database later, the field- and line-handling
options for both statements must match.  Otherwise, <CODE>LOAD DATA
INFILE</CODE> will not interpret the contents of the file properly.  Suppose
that you use <CODE>SELECT ... INTO OUTFILE</CODE> to write a file with
fields delimited by commas:

</P>

<PRE>
mysql&#62; SELECT * INTO OUTFILE 'data.txt'
    -&#62;          FIELDS TERMINATED BY ','
    -&#62;          FROM table2;
</PRE>

<P>
To read the comma-delimited file back in, the correct statement would be:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE table2
    -&#62;           FIELDS TERMINATED BY ',';
</PRE>

<P>
If instead you tried to read in the file with the statement shown here, it
wouldn't work because it instructs <CODE>LOAD DATA INFILE</CODE> to look for
tabs between fields:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE table2
    -&#62;           FIELDS TERMINATED BY '\t';
</PRE>

<P>
The likely result is that each input line would be interpreted as
a single field.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> can be used to read files obtained from
external sources, too. For example, a file in dBASE format will have
fields separated by commas and enclosed within double quotes.  If lines in
the file are terminated by newlines, the statement shown here
illustrates the field- and line-handling options you would use to load
the file:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
    -&#62;           FIELDS TERMINATED BY ',' ENCLOSED BY '"'
    -&#62;           LINES TERMINATED BY '\n';
</PRE>

<P>
Any of the field- or line-handling options can specify an empty string
(<CODE>''</CODE>).  If not empty, the <CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE>
and <CODE>FIELDS ESCAPED BY</CODE> values must be a single character.  The
<CODE>FIELDS TERMINATED BY</CODE>, <CODE>LINES STARTING BY</CODE>, and <CODE>LINES
TERMINATED BY</CODE> values can be more than one character.  For example, to write
lines that are terminated by carriage return/linefeed pairs, or to read a
file containing such lines, specify a <CODE>LINES TERMINATED BY '\r\n'</CODE>
clause.

</P>
<P>
To read a file containing jokes that are separated by lines consisting of
of <CODE>%%</CODE>, you can do this

</P>

<PRE>
mysql&#62; CREATE TABLE jokes
    -&#62;     (a INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    -&#62;     joke TEXT NOT NULL);
mysql&#62; LOAD DATA INFILE '/tmp/jokes.txt' INTO TABLE jokes
    -&#62;     FIELDS TERMINATED BY ''
    -&#62;     LINES TERMINATED BY '\n%%\n' (joke);
</PRE>

<P>
<CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE> controls quoting of fields.  For
output (<CODE>SELECT ... INTO OUTFILE</CODE>), if you omit the word
<CODE>OPTIONALLY</CODE>, all fields are enclosed by the <CODE>ENCLOSED BY</CODE>
character.  An example of such output (using a comma as the field
delimiter) is shown here:

</P>

<PRE>
"1","a string","100.20"
"2","a string containing a , comma","102.20"
"3","a string containing a \" quote","102.20"
"4","a string containing a \", quote and comma","102.20"
</PRE>

<P>
If you specify <CODE>OPTIONALLY</CODE>, the <CODE>ENCLOSED BY</CODE> character is
used only to enclose <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> fields:

</P>

<PRE>
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a \" quote",102.20
4,"a string containing a \", quote and comma",102.20
</PRE>

<P>
Note that occurrences of the <CODE>ENCLOSED BY</CODE> character within a
field value are escaped by prefixing them with the <CODE>ESCAPED BY</CODE>
character.  Also note that if you specify an empty <CODE>ESCAPED BY</CODE>
value, it is possible to generate output that cannot be read properly by
<CODE>LOAD DATA INFILE</CODE>. For example, the preceding output just shown would
appear as follows if the escape character is empty.  Observe that the
second field in the fourth line contains a comma following the quote, which
(erroneously) appears to terminate the field:

</P>

<PRE>
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a " quote",102.20
4,"a string containing a ", quote and comma",102.20
</PRE>

<P>
For input, the <CODE>ENCLOSED BY</CODE> character, if present, is stripped
from the ends of field values.  (This is true whether or not <CODE>OPTIONALLY</CODE>
is specified; <CODE>OPTIONALLY</CODE> has no effect on input interpretation.)
Occurrences of the <CODE>ENCLOSED BY</CODE> character preceded by the
<CODE>ESCAPED BY</CODE> character are interpreted as part of the current
field value.

</P>
<P>
If the field begins with the <CODE>ENCLOSED BY</CODE> character, instances
of that character are recognized as terminating a field value only
if followed by the field or line <CODE>TERMINATED BY</CODE> sequence.
To avoid ambiguity, occurrences of the <CODE>ENCLOSED BY</CODE> character
within a field value can be doubled and will be interpreted as a
single instance of the character.  For example, if <CODE>ENCLOSED
BY '"'</CODE> is specified, quotes are handled as shown here:

</P>

<PRE>
"The ""BIG"" boss"  -&#62; The "BIG" boss
The "BIG" boss      -&#62; The "BIG" boss
The ""BIG"" boss    -&#62; The ""BIG"" boss
</PRE>

<P>
<CODE>FIELDS ESCAPED BY</CODE> controls how to write or read special characters.
If the <CODE>FIELDS ESCAPED BY</CODE> character is not empty, it is used to prefix
the following characters on output:

<UL>
<LI>

The <CODE>FIELDS ESCAPED BY</CODE> character
<LI>

The <CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE> character
<LI>

The first character of the <CODE>FIELDS TERMINATED BY</CODE> and
<CODE>LINES TERMINATED BY</CODE> values
<LI>

ASCII <CODE>0</CODE> (what is actually written following the escape character is
ASCII <CODE>'0'</CODE>, not a zero-valued byte)
</UL>

<P>
If the <CODE>FIELDS ESCAPED BY</CODE> character is empty, no characters are
escaped and <CODE>NULL</CODE> is output as <CODE>NULL</CODE>, not <CODE>\N</CODE>.  It is
probably not a good idea to specify an empty escape character,
particularly if field values in your data contain any of the characters
in the list just given.

</P>
<P>
For input, if the <CODE>FIELDS ESCAPED BY</CODE> character is not empty, occurrences
of that character are stripped and the following character is taken literally
as part of a field value.  The exceptions are an escaped <SAMP>`0'</SAMP> or
<SAMP>`N'</SAMP> (for example, <CODE>\0</CODE> or <CODE>\N</CODE> if the escape character is
<SAMP>`\'</SAMP>).  These sequences are interpreted as ASCII NUL (a zero-valued
byte) and <CODE>NULL</CODE>.  The rules for <CODE>NULL</CODE> handling are described later
in this section.

</P>
<P>
For more information about <SAMP>`\'</SAMP>-escape syntax,
see section <A HREF="manual.html#Literals">10.1  Literal Values</A>.

</P>
<P>
In certain cases, field- and line-handling options interact:

</P>

<UL>
<LI>

If <CODE>LINES TERMINATED BY</CODE> is an empty string and <CODE>FIELDS
TERMINATED BY</CODE> is non-empty, lines are also terminated with
<CODE>FIELDS TERMINATED BY</CODE>.
<LI>

If the <CODE>FIELDS TERMINATED BY</CODE> and <CODE>FIELDS ENCLOSED BY</CODE> values
are both empty (<CODE>''</CODE>), a fixed-row (non-delimited) format is used.
With fixed-row format, no delimiters are used between fields (but you
can still have a line terminator). Instead, column values are written
and read using the ``display'' widths of the columns.  For example, if a
column is declared as <CODE>INT(7)</CODE>, values for the column are written
using seven-character fields.  On input, values for the column are obtained
by reading seven characters.

<CODE>LINES TERMINATED BY</CODE> is still used to separate lines.  If a line
doesn't contain all fields, the rest of the columns are set to their
default values. If you don't have a line terminator, you should set this
to <CODE>''</CODE>.  In this case, the text file must contain all fields for
each row.

Fixed-row format also affects handling of <CODE>NULL</CODE> values, as described
later.
Note that fixed-size format will not work if you are using a multi-byte
character set.
</UL>

<P>
Handling of <CODE>NULL</CODE> values varies according to the <CODE>FIELDS</CODE> and
<CODE>LINES</CODE> options in use:

</P>

<UL>
<LI>

For the default <CODE>FIELDS</CODE> and <CODE>LINES</CODE> values, <CODE>NULL</CODE> is
written as a field value of <CODE>\N</CODE> for output, and a field value of
<CODE>\N</CODE> is read as <CODE>NULL</CODE> for input (assuming that the <CODE>ESCAPED BY</CODE>
character is <SAMP>`\'</SAMP>).

<LI>

If <CODE>FIELDS ENCLOSED BY</CODE> is not empty, a field containing the literal
word <CODE>NULL</CODE> as its value is read as a <CODE>NULL</CODE> value. This differs
from the word <CODE>NULL</CODE> enclosed within <CODE>FIELDS ENCLOSED BY</CODE>
characters, which is read as the string <CODE>'NULL'</CODE>.

<LI>

If <CODE>FIELDS ESCAPED BY</CODE> is empty, <CODE>NULL</CODE> is written as the word
<CODE>NULL</CODE>.

<LI>

With fixed-row format (which happens when <CODE>FIELDS TERMINATED BY</CODE> and
<CODE>FIELDS ENCLOSED BY</CODE> are both empty), <CODE>NULL</CODE> is written as an empty
string.  Note that this causes both <CODE>NULL</CODE> values and empty strings in
the table to be indistinguishable when written to the file because they are
both written as empty strings.  If you need to be able to tell the two apart
when reading the file back in, you should not use fixed-row format.
</UL>

<P>
Some cases are not supported by <CODE>LOAD DATA INFILE</CODE>:

<UL>

<LI>

Fixed-size rows (<CODE>FIELDS TERMINATED BY</CODE> and <CODE>FIELDS ENCLOSED
BY</CODE> both empty) and <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns.

<LI>

If you specify one separator that is the same as or a prefix of another,
<CODE>LOAD DATA INFILE</CODE> won't be able to interpret the input properly.
For example, the following <CODE>FIELDS</CODE> clause would cause problems:


<PRE>
FIELDS TERMINATED BY '"' ENCLOSED BY '"'
</PRE>

<LI>

If <CODE>FIELDS ESCAPED BY</CODE> is empty, a field value that contains an occurrence
of <CODE>FIELDS ENCLOSED BY</CODE> or <CODE>LINES TERMINATED BY</CODE>
followed by the <CODE>FIELDS TERMINATED BY</CODE> value will cause <CODE>LOAD
DATA INFILE</CODE> to stop reading a field or line too early.
This happens because <CODE>LOAD DATA INFILE</CODE> cannot properly determine
where the field or line value ends.
</UL>

<P>
The following example loads all columns of the <CODE>persondata</CODE> table:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata;
</PRE>

<P>
By default, when no column list is provided at the end of the <CODE>LOAD
DATA INFILE</CODE> statement, input lines are expected to contain a field for each
table column.  If you want to load only some of a table's columns, specify a
column list:

</P>

<PRE>
mysql&#62; LOAD DATA INFILE 'persondata.txt'
    -&#62;           INTO TABLE persondata (col1,col2,...);
</PRE>

<P>
You must also specify a column list if the order of the fields in the input
file differs from the order of the columns in the table.  Otherwise,
MySQL cannot tell how to match up input fields with table columns.

</P>
<P>
If an input line has too few fields, the table columns for which no input
field is present are set to their default values.  Default value assignment
is described in section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
An empty field value is interpreted differently than if the field value
is missing:

</P>

<UL>
<LI>

For string types, the column is set to the empty string.

<LI>

For numeric types, the column is set to <CODE>0</CODE>.

<LI>

For date and time types, the column is set to the appropriate ``zero''
value for the type.
See section <A HREF="manual.html#Date_and_time_types">12.3  Date and Time Types</A>.
</UL>

<P>
These are the same values that result if you assign an empty
string explicitly to a string, numeric, or date or time type explicitly
in an <CODE>INSERT</CODE> or <CODE>UPDATE</CODE> statement.

</P>
<P>
<CODE>TIMESTAMP</CODE> columns are set to the current date and time only if there
is a <CODE>NULL</CODE> value for the column (that is, <CODE>\N</CODE>), or (for the
first <CODE>TIMESTAMP</CODE> column only) if the <CODE>TIMESTAMP</CODE> column is
omitted from the field list when a field list is specified.

</P>
<P>
<CODE>LOAD DATA INFILE</CODE> regards all input as strings, so you can't use
numeric values for <CODE>ENUM</CODE> or <CODE>SET</CODE> columns the way you can with
<CODE>INSERT</CODE> statements.  All <CODE>ENUM</CODE> and <CODE>SET</CODE> values must be
specified as strings!

</P>
<P>
If an input row has too many fields, the extra fields are ignored and
the number of warnings is incremented.

</P>
<P>
When the <CODE>LOAD DATA INFILE</CODE>
statement finishes, it returns an information string in the following format:

</P>

<PRE>
Records: 1  Deleted: 0  Skipped: 0  Warnings: 0
</PRE>

<P>
<A NAME="IDX1536"></A>
If you are using the C API, you can get information about the statement by
calling the  <CODE>mysql_info()</CODE> C API function.
See section <A HREF="manual.html#mysql_info">20.2.3.126  <CODE>mysql_info()</CODE></A>.

</P>
<P>
Warnings occur under the same circumstances as when values are inserted
via the <CODE>INSERT</CODE> statement (see section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>), except
that <CODE>LOAD DATA INFILE</CODE> also generates warnings when there are too few
or too many fields in the input row.  The warnings are not stored anywhere;
the number of warnings can be used only as an indication of whether everything went
well.

</P>
<P>
From MySQL 4.1.1 on, you can use <CODE>SHOW WARNINGS</CODE> to get a list of the
first <CODE>max_error_count</CODE> warnings as information about what went wrong.
See section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.

</P>
<P>
Before MySQL 4.1.1, only a warning count is available to indicate that
something went wrong.  If you get warnings and want to know exactly why you
got them, one way to do this is to dump the table into another file using
<CODE>SELECT ... INTO OUTFILE</CODE> and compare the file to your original input
file.

</P>



<H3><A NAME="REPLACE" HREF="manual_toc.html#REPLACE">14.1.6  <CODE>REPLACE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1537"></A>

</P>

<PRE>
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] tbl_name [(col_name,...)]
    VALUES ({expr | DEFAULT},...),(...),...
</PRE>

<P>
Or:

<PRE>
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] tbl_name
    SET col_name={expr | DEFAULT}, ...
</PRE>

<P>
Or:

<PRE>
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] tbl_name [(col_name,...)]
    SELECT ...
</PRE>

<P>
<CODE>REPLACE</CODE> works exactly like <CODE>INSERT</CODE>, except that if an old
record in the table has the same value as a new record for a <CODE>PRIMARY
KEY</CODE> or a <CODE>UNIQUE</CODE> index, the old record is deleted before the new
record is inserted.
See section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>.

</P>
<P>
Note that unless the table has a <CODE>PRIMARY KEY</CODE> or <CODE>UNIQUE</CODE> index,
using a <CODE>REPLACE</CODE> statement makes no sense. It becomes equivalent to
<CODE>INSERT</CODE>, because there is no index to be used to determine whether a new
row duplicates another.

</P>
<P>
Values for all columns are taken from the values specified in the
<CODE>REPLACE</CODE> statement.  Any missing columns are set to their default
values, just as happens for <CODE>INSERT</CODE>.  You can't refer to values from
the old row and use them in the new row.  It appeared that you could do this
in some old MySQL versions, but that was a bug that has been corrected.

</P>
<P>
To be able to use <CODE>REPLACE</CODE>, you must have <CODE>INSERT</CODE> and
<CODE>DELETE</CODE> privileges for the table.

</P>
<P>
The <CODE>REPLACE</CODE> statement returns a count to indicate the number of rows
affected. This is the sum of the rows deleted and inserted. If the count is 1
for a single-row <CODE>REPLACE</CODE>, a row was inserted and no rows were deleted.
If the count is greater than 1, one or more old rows were deleted before the
new row was inserted. It is possible for a single row to replace more than one
old row if the table contains multiple unique indexes and the new row
duplicates values for different old rows in different unique indexes.

</P>
<P>
The affected-rows count makes it easy to determine whether <CODE>REPLACE</CODE>
only added a row or whether it also replaced any rows: Check whether the
count is 1 (added) or greater (replaced).

</P>
<P>
If you are using the C API, the affected-rows count can be obtained using the
<CODE>mysql_affected_rows()</CODE> function.

</P>
<P>
Here follows in more detail the algorithm that is used
(it is also used with <CODE>LOAD DATA ... REPLACE</CODE>):

</P>

<OL>
<LI>

Try to insert the new row into the table
<LI>

While the insertion fails because a duplicate-key error occurs for a
primary or unique key:

<OL>
<LI>

Delete from the table the conflicting row that has the duplicate key value
<LI>

Try again to insert the new row into the table
</OL>

</OL>



<H3><A NAME="SELECT" HREF="manual_toc.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1538"></A>

</P>

<PRE>
SELECT
    [ALL | DISTINCT | DISTINCTROW ]
      [HIGH_PRIORITY]
      [STRAIGHT_JOIN]
      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]
      [SQL_CACHE | SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]
    select_expr,...
    [INTO OUTFILE 'file_name' export_options
      | INTO DUMPFILE 'file_name']
    [FROM table_references
      [WHERE where_definition]
      [GROUP BY {col_name | expr | position}
        [ASC | DESC], ... [WITH ROLLUP]]
      [HAVING where_definition]
      [ORDER BY {col_name | expr | position}
        [ASC | DESC] ,...]
      [LIMIT [offset,] row_count | row_count OFFSET offset]
      [PROCEDURE procedure_name(argument_list)]
      [FOR UPDATE | LOCK IN SHARE MODE]]
</PRE>

<P>
<CODE>SELECT</CODE> is used to retrieve rows selected from one or more tables.
Support for <CODE>UNION</CODE> statements and subqueries is available as of MySQL
4.0 and 4.1, respectively.
See section <A HREF="manual.html#UNION">14.1.7.2  <CODE>UNION</CODE> Syntax</A> and section <A HREF="manual.html#Subqueries">14.1.8  Subquery Syntax</A>.

</P>

<UL>
<LI>

Each <CODE>select_expr</CODE> indicates a column you want to retrieve.

<LI>

<CODE>table_references</CODE> indicates the table or tables from which to retrieve rows.
Its syntax is described in section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>.

<LI>

<CODE>where_definition</CODE> indicates any conditions that selected rows must
satisfy.

</UL>

<P>
<CODE>SELECT</CODE> can also be used to retrieve rows computed without reference to
any table.  
For example:

</P>

<PRE>
mysql&#62; SELECT 1 + 1;
        -&#62; 2
</PRE>

<P>
All clauses used must be given in exactly the order shown in the syntax
description. For example,
a <CODE>HAVING</CODE> clause must come after any <CODE>GROUP BY</CODE> clause and before
any <CODE>ORDER BY</CODE> clause.

</P>

<UL>

<LI>

<A NAME="IDX1539"></A>
<A NAME="IDX1540"></A>
A <CODE>select_expr</CODE> can be given an alias using <CODE>AS alias_name</CODE>.
The alias is used as the expression's column name and can be used in
<CODE>GROUP BY</CODE>,
<CODE>ORDER BY</CODE>, or <CODE>HAVING</CODE> clauses.  For example:


<PRE>
mysql&#62; SELECT CONCAT(last_name,', ',first_name) AS full_name
    -&#62; FROM mytable ORDER BY full_name;
</PRE>

The <CODE>AS</CODE> keyword is optional when aliasing a <CODE>select_expr</CODE>.
The preceding example could have been written like this:


<PRE>
mysql&#62; SELECT CONCAT(last_name,', ',first_name) full_name
    -&#62; FROM mytable ORDER BY full_name;
</PRE>

Because the <CODE>AS</CODE> is optional, a subtle problem can occur
if you forget the comma between two <CODE>SELECT</CODE> expressions: MySQL
interprets the second as an alias name. For example, in the following
statement, <CODE>columnb</CODE> is treated as an alias name:


<PRE>
mysql&#62; SELECT columna columnb FROM mytable;
</PRE>

<LI>

It is not allowable to use a column alias in a <CODE>WHERE</CODE> clause,
because the column value might not yet be determined when the
<CODE>WHERE</CODE> clause is executed.
See section <A HREF="manual.html#Problems_with_alias">A.5.4  Problems with Column Aliases</A>.

<LI>

<A NAME="IDX1541"></A>
<A NAME="IDX1542"></A>
<A NAME="IDX1543"></A>
<A NAME="IDX1544"></A>
<A NAME="IDX1545"></A>
<A NAME="IDX1546"></A>
<A NAME="IDX1547"></A>
<A NAME="IDX1548"></A>
The <CODE>FROM table_references</CODE> clause indicates the tables from which to
retrieve rows. If you name more than one table, you are performing a
join.  For information on join syntax, see section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>.
For each table specified, you can optionally specify an alias.


<PRE>
tbl_name [[AS] alias]
    [[USE INDEX (key_list)]
      | [IGNORE INDEX (key_list)]
      | [FORCE INDEX (key_list)]]
</PRE>

The use of
<CODE>USE INDEX</CODE>,
<CODE>IGNORE INDEX</CODE>,
<CODE>FORCE INDEX</CODE>
to give the optimizer hints about how to choose indexes is described in
section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>.

In MySQL 4.0.14, you can use <CODE>SET max_seeks_for_key=value</CODE> as an
alternative way to force MySQL to prefer key scans instead of table scans.

<LI>

You can refer to a table within the current database as <CODE>tbl_name</CODE>
(within the current database), or as <CODE>db_name.tbl_name</CODE> to explicitly
specify a database.  You can refer to a column as <CODE>col_name</CODE>,
<CODE>tbl_name.col_name</CODE>, or <CODE>db_name.tbl_name.col_name</CODE>.  You need not
specify a <CODE>tbl_name</CODE> or <CODE>db_name.tbl_name</CODE> prefix for a column
reference unless the reference would be ambiguous.  See section <A HREF="manual.html#Legal_names">10.2  Database, Table, Index, Column, and Alias Names</A>
for examples of ambiguity that require the more explicit column reference
forms.

<LI>

From MySQL 4.1.0 on, you are allowed to specify <CODE>DUAL</CODE> as a dummy
table name in situations where no tables are referenced:


<PRE>
mysql&#62; SELECT 1 + 1 FROM DUAL;
        -&#62; 2
</PRE>

<CODE>DUAL</CODE> is purely a compatibility feature. Some other servers require
this syntax.

<LI>

<A NAME="IDX1549"></A>
<A NAME="IDX1550"></A>
A table reference can be aliased using <CODE>tbl_name [AS] alias_name</CODE>:


<PRE>
mysql&#62; SELECT t1.name, t2.salary FROM employee AS t1, info AS t2
    -&#62;     WHERE t1.name = t2.name;
mysql&#62; SELECT t1.name, t2.salary FROM employee t1, info t2
    -&#62;     WHERE t1.name = t2.name;
</PRE>

<LI>

In the <CODE>WHERE</CODE> clause, you can use any of the functions that
MySQL supports, except for aggregate (summary) functions.
See section <A HREF="manual.html#Functions">13  Functions and Operators</A>.

<LI>

<A NAME="IDX1551"></A>
Columns selected for output can be referred to in <CODE>ORDER BY</CODE> and
<CODE>GROUP BY</CODE> clauses using column names, column aliases, or column
positions.  Column positions are integers and begin with 1:


<PRE>
mysql&#62; SELECT college, region, seed FROM tournament
    -&#62;     ORDER BY region, seed;
mysql&#62; SELECT college, region AS r, seed AS s FROM tournament
    -&#62;     ORDER BY r, s;
mysql&#62; SELECT college, region, seed FROM tournament
    -&#62;     ORDER BY 2, 3;
</PRE>

To sort in reverse order, add the <CODE>DESC</CODE> (descending) keyword to the
name of the column in the <CODE>ORDER BY</CODE> clause that you are sorting by.
The default is ascending order; this can be specified explicitly using
the <CODE>ASC</CODE> keyword.

Use of column positions is deprecated because the syntax has been removed from
the SQL standard.

<LI>

<A NAME="IDX1552"></A>
If you use <CODE>GROUP BY</CODE>, output rows are sorted according to the
<CODE>GROUP BY</CODE> columns as if you had an <CODE>ORDER BY</CODE> for the same columns.
MySQL has extended the <CODE>GROUP BY</CODE> clause as of version 3.23.34 so that
you can also specify <CODE>ASC</CODE> and <CODE>DESC</CODE> after columns named in the
clause:


<PRE>
SELECT a, COUNT(b) FROM test_table GROUP BY a DESC
</PRE>

<LI>

MySQL extends the use of <CODE>GROUP BY</CODE> to allow you to
select fields that are not mentioned in the <CODE>GROUP BY</CODE> clause.
If you are not getting the results you expect from your query, please
read the <CODE>GROUP BY</CODE> description.
See section <A HREF="manual.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A>.

<LI>

As of MySQL 4.1.1, <CODE>GROUP BY</CODE> allows a <CODE>WITH ROLLUP</CODE> modifier.
See section <A HREF="manual.html#GROUP-BY-Modifiers">13.9.2  <CODE>GROUP BY</CODE> Modifiers</A>.

<LI>

The <CODE>HAVING</CODE> clause can refer to any column or alias named in a
<CODE>select_expr</CODE>. It is applied nearly last, just before items are
sent to the client, with no optimization.
(<CODE>LIMIT</CODE> is applied after <CODE>HAVING</CODE>.)

<LI>

Don't use <CODE>HAVING</CODE> for items that
should be in the <CODE>WHERE</CODE> clause.  For example, do not write this:


<PRE>
mysql&#62; SELECT col_name FROM tbl_name HAVING col_name &#62; 0;
</PRE>

Write this instead:


<PRE>
mysql&#62; SELECT col_name FROM tbl_name WHERE col_name &#62; 0;
</PRE>

<LI>

The <CODE>HAVING</CODE> clause can refer to aggregate functions, which the
<CODE>WHERE</CODE> clause cannot:


<PRE>
mysql&#62; SELECT user, MAX(salary) FROM users
    -&#62;     GROUP BY user HAVING MAX(salary)&#62;10;
</PRE>

However, that does not work in older MySQL servers (before version 3.22.5).
Instead, you can use a column alias in the select list and refer to the
alias in the <CODE>HAVING</CODE> clause:


<PRE>
mysql&#62; SELECT user, MAX(salary) AS max_salary FROM users
    -&#62;     GROUP BY user HAVING max_salary&#62;10;
</PRE>

<LI>

The <CODE>LIMIT</CODE> clause can be used to constrain the number of rows returned
by the <CODE>SELECT</CODE> statement.  <CODE>LIMIT</CODE> takes one or two numeric
arguments, which must be integer constants.

With two arguments, the first argument specifies the offset of the first row to
return, and the second specifies the maximum number of rows to return.
The offset of the initial row is 0 (not 1):


<PRE>
mysql&#62; SELECT * FROM table LIMIT 5,10;  # Retrieve rows 6-15
</PRE>

For
compatibility with PostgreSQL, MySQL also supports the
<CODE>LIMIT row_count OFFSET offset</CODE> syntax.

To retrieve all rows from a certain offset up to the end of the result set,
you can use some large number for the second parameter. This statement
retrieves all rows from the 96th row to the last:


<PRE>
mysql&#62; SELECT * FROM table LIMIT 95,18446744073709551615;
</PRE>

With one argument, the value specifies the number of rows to return from the
beginning of the result set:


<PRE>
mysql&#62; SELECT * FROM table LIMIT 5;     # Retrieve first 5 rows
</PRE>

In other words, <CODE>LIMIT n</CODE> is equivalent to <CODE>LIMIT 0,n</CODE>.

<LI>

<A NAME="IDX1553"></A>
The <CODE>SELECT ... INTO OUTFILE 'file_name'</CODE> form of <CODE>SELECT</CODE> writes
the selected rows to a file. The file is created on the server host, so you
must have the <CODE>FILE</CODE> privilege to use this form of <CODE>SELECT</CODE>.  The
file cannot already exist, which among other things prevents files such as
<TT>`/etc/passwd'</TT> and database tables from being destroyed.

The <CODE>SELECT ... INTO OUTFILE</CODE> statement is intended primarily to let
you very quickly dump a table on the server machine. If you want to create
the resulting file on some client host other than the server host, you can't use
<CODE>SELECT ... INTO OUTFILE</CODE>. In that case, you should instead use some
command like <CODE>mysql -e "SELECT ..." &#62; file_name</CODE> on the client host to generate the file.

<CODE>SELECT ...  INTO OUTFILE</CODE> is the complement of <CODE>LOAD DATA
INFILE</CODE>; the syntax for the <CODE>export_options</CODE> part of the statement
consists of the same <CODE>FIELDS</CODE> and <CODE>LINES</CODE> clauses that are used
with the <CODE>LOAD DATA INFILE</CODE> statement.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

<CODE>FIELDS ESCAPED BY</CODE> controls how to write special characters.
If the <CODE>FIELDS ESCAPED BY</CODE> character is not empty, it is used to prefix
the following characters on output:

<UL>
<LI>

The <CODE>FIELDS ESCAPED BY</CODE> character
<LI>

The <CODE>FIELDS [OPTIONALLY] ENCLOSED BY</CODE> character
<LI>

The first character of the <CODE>FIELDS TERMINATED BY</CODE> and
<CODE>LINES TERMINATED BY</CODE> values
<LI>

ASCII <CODE>0</CODE> (what is actually written following the escape character is
ASCII <CODE>'0'</CODE>, not a zero-valued byte)
</UL>

If the <CODE>FIELDS ESCAPED BY</CODE> character is empty, no characters are
escaped and <CODE>NULL</CODE> is output as <CODE>NULL</CODE>, not <CODE>\N</CODE>.  It is
probably not a good idea to specify an empty escape character,
particularly if field values in your data contain any of the characters
in the list just given.

The reason for the above is that you <EM>must</EM> escape any <CODE>FIELDS
TERMINATED BY</CODE>, <CODE>ENCLOSED BY</CODE>, <CODE>ESCAPED BY</CODE>, or <CODE>LINES TERMINATED BY</CODE>
characters to reliably be able to read the file back. ASCII NUL is
escaped to make it easier to view with some pagers.

The resulting file doesn't have to conform to SQL syntax, so nothing
else need be escaped.

Here is an example that produces a file in the comma-separated values format
used by many programs:


<PRE>
SELECT a,b,a+b INTO OUTFILE '/tmp/result.text'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM test_table;
</PRE>

<LI>

<A NAME="IDX1554"></A>
If you use <CODE>INTO DUMPFILE</CODE> instead of <CODE>INTO OUTFILE</CODE>, MySQL writes
only one row into the file, without any column or line termination and
without performing any escape processing.  This is useful if you want to
store a <CODE>BLOB</CODE> value in a file.

<LI>

<STRONG>Note:</STRONG> Any file created by <CODE>INTO OUTFILE</CODE> or <CODE>INTO
DUMPFILE</CODE> is writable by all users on the server host.  The reason for
this is that the MySQL server can't create a file that is owned by anyone
other than the user it's running as (you should never run <CODE>mysqld</CODE> as
<CODE>root</CODE>).  The file thus must be world-writable so that you can
manipulate its contents.

<LI>

A <CODE>PROCEDURE</CODE> clause names a procedure that should process the data
in the result set.  For an example, see section <A HREF="manual.html#procedure_analyse">22.3.1  Procedure Analyse</A>.

<LI>

If you use <CODE>FOR UPDATE</CODE> on a storage engine that uses page or row locks,
rows examined by the query are write-locked until the end of the current
transaction.

</UL>

<P>
Following the <CODE>SELECT</CODE> keyword, you can give a number of options
that affect the operation of the statement.

</P>
<P>
The <CODE>ALL</CODE>, <CODE>DISTINCT</CODE>, and <CODE>DISTINCTROW</CODE> options specify
whether duplicate rows should be returned. If none of these options are
given, the default is <CODE>ALL</CODE> (all matching rows are returned).
<CODE>DISTINCT</CODE> and <CODE>DISTINCTROW</CODE> are synonyms and specify that
duplicate rows in the result set should be removed.

</P>
<P>
<CODE>HIGH_PRIORITY</CODE>, <CODE>STRAIGHT_JOIN</CODE>, and options beginning with
<CODE>SQL_</CODE> are MySQL extensions to standard SQL.

</P>

<UL>

<LI>

<CODE>HIGH_PRIORITY</CODE> will give the <CODE>SELECT</CODE> higher priority than
a statement that updates a table.  You should use this only for queries
that are very fast and must be done at once.  A <CODE>SELECT HIGH_PRIORITY</CODE>
query that is issued while the table is locked for reading will run even if
there is already an update statement waiting for the table to be free.

<CODE>HIGH_PRIORITY</CODE> cannot be used with <CODE>SELECT</CODE> statements that
are part of a <CODE>UNION</CODE>.

<LI>

<A NAME="IDX1555"></A>
<CODE>STRAIGHT_JOIN</CODE> forces the optimizer to join the tables in the order in
which they are listed in the <CODE>FROM</CODE> clause. You can use this to speed up
a query if the optimizer joins the tables in non-optimal order.
See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.
<CODE>STRAIGHT_JOIN</CODE> also can be used in the <CODE>table_references</CODE> list.
See section <A HREF="manual.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A>.

<LI>

<CODE>SQL_BIG_RESULT</CODE> can be used with <CODE>GROUP BY</CODE> or <CODE>DISTINCT</CODE>
to tell the optimizer that the result set will have many rows.  In this case,
MySQL will directly use disk-based temporary tables if needed.
MySQL will also, in this case, prefer sorting to using a
temporary table with a key on the <CODE>GROUP BY</CODE> elements.

<LI>

<CODE>SQL_BUFFER_RESULT</CODE> forces the result to be put into a temporary
table. This helps MySQL free the table locks early and helps
in cases where it takes a long time to send the result set to the client.

<LI>

<CODE>SQL_SMALL_RESULT</CODE> can be used
with <CODE>GROUP BY</CODE> or <CODE>DISTINCT</CODE> to tell the optimizer that the
result set will be small.  In this case, MySQL uses fast
temporary tables to store the resulting table instead of using sorting. In
MySQL 3.23 and up, this shouldn't normally be needed.

<LI>

<CODE>SQL_CALC_FOUND_ROWS</CODE> (available in MySQL 4.0.0 and up) tells MySQL
to calculate how many rows there would be in the result set, disregarding
any <CODE>LIMIT</CODE> clause.  The number of rows can then be retrieved with
<CODE>SELECT FOUND_ROWS()</CODE>.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.

Before MySQL 4.1.0, this option does not work with
<CODE>LIMIT 0</CODE>, which is optimized to return instantly (resulting in a
row count of 0).
See section <A HREF="manual.html#LIMIT_optimisation">7.2.10  How MySQL Optimizes <CODE>LIMIT</CODE></A>.

<LI>

<CODE>SQL_CACHE</CODE> tells MySQL to store the query result in the query cache if
you are using a <CODE>query_cache_type</CODE> value of <CODE>2</CODE> or <CODE>DEMAND</CODE>.
For a query that uses <CODE>UNION</CODE> or subqueries, this option takes effect
to be used in any <CODE>SELECT</CODE> of the query.
See section <A HREF="manual.html#Query_Cache">5.10  The MySQL Query Cache</A>.

<LI>

<CODE>SQL_NO_CACHE</CODE> tells MySQL not to store the query result
in the query cache. See section <A HREF="manual.html#Query_Cache">5.10  The MySQL Query Cache</A>.
For a query that uses <CODE>UNION</CODE> or subqueries, this
option takes effect to be used in any <CODE>SELECT</CODE> of the query.

</UL>



<H4><A NAME="JOIN" HREF="manual_toc.html#JOIN">14.1.7.1  <CODE>JOIN</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1556"></A>
<A NAME="IDX1557"></A>
<A NAME="IDX1558"></A>
<A NAME="IDX1559"></A>
<A NAME="IDX1560"></A>
<A NAME="IDX1561"></A>
<A NAME="IDX1562"></A>
<A NAME="IDX1563"></A>
<A NAME="IDX1564"></A>
<A NAME="IDX1565"></A>
<A NAME="IDX1566"></A>
<A NAME="IDX1567"></A>

</P>
<P>
MySQL supports the following <CODE>JOIN</CODE> syntaxes for the
<CODE>table_references</CODE> part of <CODE>SELECT</CODE> statements and multiple-table
<CODE>DELETE</CODE> and <CODE>UPDATE</CODE> statements:

</P>

<PRE>
table_reference, table_reference
table_reference [INNER | CROSS] JOIN table_reference [join_condition]
table_reference STRAIGHT_JOIN table_reference
table_reference LEFT [OUTER] JOIN table_reference [join_condition]
table_reference NATURAL [LEFT [OUTER]] JOIN table_reference
{ OJ table_reference LEFT OUTER JOIN table_reference
    ON conditional_expr }
table_reference RIGHT [OUTER] JOIN table_reference [join_condition]
table_reference NATURAL [RIGHT [OUTER]] JOIN table_reference
</PRE>

<P>
<CODE>table_reference</CODE> is defined as:

</P>
<P>
<A NAME="IDX1568"></A>

<PRE>
tbl_name [[AS] alias]
    [[USE INDEX (key_list)]
      | [IGNORE INDEX (key_list)]
      | [FORCE INDEX (key_list)]]
</PRE>

<P>
<CODE>join_condition</CODE> is defined as:

</P>

<PRE>
ON conditional_expr | USING (column_list)
</PRE>

<P>
You should generally not have any conditions in the <CODE>ON</CODE> part that are
used to restrict which rows you want in the result set, but rather specify
these conditions in the <CODE>WHERE</CODE> clause. There are exceptions to this rule.

</P>
<P>
Note that <CODE>INNER JOIN</CODE> syntax allows a <CODE>join_condition</CODE> only from
MySQL 3.23.17 on.  The same is true for <CODE>JOIN</CODE> and <CODE>CROSS JOIN</CODE> only
as of MySQL 4.0.11.

</P>
<P>
<A NAME="IDX1569"></A>
<A NAME="IDX1570"></A>
The <CODE>{OJ ... LEFT OUTER JOIN ...}</CODE> syntax shown in the preceding list
exists only for compatibility with ODBC.

</P>

<UL>
<LI>

A table reference can be aliased using <CODE>tbl_name AS alias_name</CODE> or
<CODE>tbl_name alias_name</CODE>:


<PRE>
mysql&#62; SELECT t1.name, t2.salary FROM employee AS t1, info AS t2
    -&#62;        WHERE t1.name = t2.name;
mysql&#62; SELECT t1.name, t2.salary FROM employee t1, info t2
    -&#62;        WHERE t1.name = t2.name;
</PRE>

<LI>

The <CODE>ON</CODE> conditional is any conditional expression of the form that can
be used in a <CODE>WHERE</CODE> clause.

<LI>

If there is no matching record for the right table in the <CODE>ON</CODE> or
<CODE>USING</CODE> part in a <CODE>LEFT JOIN</CODE>, a row with all columns set to
<CODE>NULL</CODE> is used for the right table.  You can use this fact to find
records in a table that have no counterpart in another table:


<PRE>
mysql&#62; SELECT table1.* FROM table1
    -&#62;        LEFT JOIN table2 ON table1.id=table2.id
    -&#62;        WHERE table2.id IS NULL;
</PRE>

This example finds all rows in <CODE>table1</CODE> with an <CODE>id</CODE> value that is
not present in <CODE>table2</CODE> (that is, all rows in <CODE>table1</CODE> with no
corresponding row in <CODE>table2</CODE>).  This assumes that <CODE>table2.id</CODE> is
declared <CODE>NOT NULL</CODE>.
See section <A HREF="manual.html#LEFT_JOIN_optimisation">7.2.8  How MySQL Optimizes <CODE>LEFT JOIN</CODE> and <CODE>RIGHT JOIN</CODE></A>.

<LI>

The <CODE>USING</CODE> <CODE>(column_list)</CODE> clause names a list of columns that must
exist in both tables. The following two clauses are semantically identical:


<PRE>
a LEFT JOIN b USING (c1,c2,c3)
a LEFT JOIN b ON a.c1=b.c1 AND a.c2=b.c2 AND a.c3=b.c3
</PRE>

<LI>

The <CODE>NATURAL [LEFT] JOIN</CODE> of two tables is defined to be
semantically equivalent to an <CODE>INNER JOIN</CODE> or a <CODE>LEFT JOIN</CODE>
with a <CODE>USING</CODE> clause that names all columns that exist in both
tables.

<LI>

<A NAME="IDX1571"></A>
<CODE>INNER JOIN</CODE> and <CODE>,</CODE> (comma) are semantically equivalent in
the absence of a join condition: both will produce a Cartesian product
between the specified tables (that is, each and every row in the first table
will be joined onto all rows in the second table).

<LI>

<CODE>RIGHT JOIN</CODE> works analogously to <CODE>LEFT JOIN</CODE>.  To keep code
portable across databases, it's recommended to use <CODE>LEFT JOIN</CODE>
instead of <CODE>RIGHT JOIN</CODE>.

<LI>

<A NAME="IDX1572"></A>
<CODE>STRAIGHT_JOIN</CODE> is identical to <CODE>JOIN</CODE>, except that the left table
is always read before the right table. This can be used for those (few)
cases for which the join optimizer puts the tables in the wrong order.

</UL>

<P>
<A NAME="IDX1573"></A>
<A NAME="IDX1574"></A>
<A NAME="IDX1575"></A>
As of MySQL 3.23.12, you can give hints about which index MySQL
should use when retrieving information from a table.  By specifying
<CODE>USE INDEX (key_list)</CODE>, you can tell MySQL to use only one of the
possible indexes to find rows in the table.  The alternative syntax
<CODE>IGNORE INDEX (key_list)</CODE> can be used to tell MySQL to not use some
particular index.  These hints are useful if <CODE>EXPLAIN</CODE> shows that MySQL
is using the wrong index from the list of possible indexes.

</P>
<P>
<A NAME="IDX1576"></A>
From MySQL 4.0.9 on, you can also use <CODE>FORCE INDEX</CODE>. This acts likes
<CODE>USE INDEX (key_list)</CODE> but with the addition that a table scan
is assumed to be <EM>very</EM> expensive.  In other words, a table scan will
only be used if there is no way to use one of the given indexes to
find rows in the table.

</P>
<P>
<A NAME="IDX1577"></A>
<A NAME="IDX1578"></A>
<A NAME="IDX1579"></A>
<CODE>USE KEY</CODE>, <CODE>IGNORE KEY</CODE>, and <CODE>FORCE KEY</CODE> are synonyms for
<CODE>USE INDEX</CODE>, <CODE>IGNORE INDEX</CODE>, and <CODE>FORCE INDEX</CODE>.

</P>
<P>
<STRONG>Note:</STRONG> <CODE>USE INDEX</CODE>, <CODE>IGNORE INDEX</CODE>, and <CODE>FORCE INDEX</CODE>
only affect which indexes are used when MySQL decides how to find rows in
the table and how to do the join. They do not affect whether an index will
be used when resolving an <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE>.

</P>
<P>
Some join examples:

</P>

<PRE>
mysql&#62; SELECT * FROM table1,table2 WHERE table1.id=table2.id;
mysql&#62; SELECT * FROM table1 LEFT JOIN table2 ON table1.id=table2.id;
mysql&#62; SELECT * FROM table1 LEFT JOIN table2 USING (id);
mysql&#62; SELECT * FROM table1 LEFT JOIN table2 ON table1.id=table2.id
    -&#62;          LEFT JOIN table3 ON table2.id=table3.id;
mysql&#62; SELECT * FROM table1 USE INDEX (key1,key2)
    -&#62;          WHERE key1=1 AND key2=2 AND key3=3;
mysql&#62; SELECT * FROM table1 IGNORE INDEX (key3)
    -&#62;          WHERE key1=1 AND key2=2 AND key3=3;
</PRE>

<P>
See section <A HREF="manual.html#LEFT_JOIN_optimisation">7.2.8  How MySQL Optimizes <CODE>LEFT JOIN</CODE> and <CODE>RIGHT JOIN</CODE></A>.

</P>



<H4><A NAME="UNION" HREF="manual_toc.html#UNION">14.1.7.2  <CODE>UNION</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1580"></A>

</P>

<PRE>
SELECT ...
UNION [ALL | DISTINCT]
SELECT ...
  [UNION [ALL | DISTINCT]
   SELECT ...]
</PRE>

<P>
<CODE>UNION</CODE> is used to combine the result from many <CODE>SELECT</CODE>
statements into one result set.  <CODE>UNION</CODE> is available from MySQL 4.0.0
on.

</P>
<P>
Selected columns listed in corresponding positions of each <CODE>SELECT</CODE>
statement should have the same type. (For example, the first column selected
by the first statement should have the same type as the first column selected
by the other statements.) The column names used in
the first <CODE>SELECT</CODE> statement are used as the column names for the
results returned.

</P>
<P>
The <CODE>SELECT</CODE> statements are normal select statements, but with the following
restrictions:

</P>

<UL>
<LI>

Only the last <CODE>SELECT</CODE> statement can have <CODE>INTO OUTFILE</CODE>.
<LI>

<CODE>HIGH_PRIORITY</CODE> cannot be used with <CODE>SELECT</CODE> statements that
are part of a <CODE>UNION</CODE>. If you specify it for the first <CODE>SELECT</CODE>,
it has no effect. If you specify it for any subsequent <CODE>SELECT</CODE>
statements, a syntax error results.
</UL>

<P>
If you don't use the keyword <CODE>ALL</CODE> for the <CODE>UNION</CODE>, all
returned rows will be unique, as if you had done a <CODE>DISTINCT</CODE> for
the total result set.  If you specify <CODE>ALL</CODE>, you will get all
matching rows from all the used <CODE>SELECT</CODE> statements.

</P>
<P>
The <CODE>DISTINCT</CODE> keyword is an optional word (introduced in MySQL 4.0.17).
It does nothing, but is allowed in the syntax as required by the SQL standard.

</P>
<P>
<STRONG>Note:</STRONG> You cannot mix <CODE>UNION ALL</CODE> and <CODE>UNION
DISTINCT</CODE> in the same query yet.  If you use <CODE>ALL</CODE> for one
<CODE>UNION</CODE> then it is used for all of them.

</P>
<P>
If you want to use an <CODE>ORDER BY</CODE> to sort the entire <CODE>UNION</CODE> result,
you should use parentheses:

</P>

<PRE>
(SELECT a FROM tbl_name WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
UNION
(SELECT a FROM tbl_name WHERE a=11 AND B=2 ORDER BY a LIMIT 10)
ORDER BY a;
</PRE>

<P>
The types and lengths of the columns in the result set of a <CODE>UNION</CODE>
take into account the values retrieved by all the <CODE>SELECT</CODE> statements.
Before MySQL 4.1.1, a limitation of <CODE>UNION</CODE> is that only the values from
the first <CODE>SELECT</CODE> are used to determine result column types and lengths.
This could result in value truncation if, for example, the first
<CODE>SELECT</CODE> retrieves shorter values than the second <CODE>SELECT</CODE>:

</P>

<PRE>
mysql&#62; SELECT REPEAT('a',1) UNION SELECT REPEAT('b',10);
+---------------+
| REPEAT('a',1) |
+---------------+
| a             |
| b             |
+---------------+
</PRE>

<P>
That limitation has been removed as of MySQL 4.1.1:

</P>

<PRE>
mysql&#62; SELECT REPEAT('a',1) UNION SELECT REPEAT('b',10);
+---------------+
| REPEAT('a',1) |
+---------------+
| a             |
| bbbbbbbbbb    |
+---------------+
</PRE>



<H3><A NAME="Subqueries" HREF="manual_toc.html#Subqueries">14.1.8  Subquery Syntax</A></H3>

<P>
<A NAME="IDX1581"></A>
<A NAME="IDX1582"></A>
<A NAME="IDX1583"></A>
<A NAME="IDX1584"></A>
<A NAME="IDX1585"></A>
<A NAME="IDX1586"></A>

</P>
<P>
A subquery is a <CODE>SELECT</CODE> statement inside another statement.

</P>
<P>
Starting with MySQL 4.1, all subquery forms and operations that the SQL
standard requires are supported, as well as a few features that are
MySQL-specific.

</P>
<P>
With earlier MySQL versions, it was necessary to work around or avoid the
use of subqueries, but people starting to write code now will find that
subqueries are a very useful part of the MySQL toolkit.

</P>
<P>
For MySQL versions prior to 4.1, most subqueries can be successfully
rewritten using joins and other methods.
See section <A HREF="manual.html#Rewriting_subqueries">14.1.8.11  Rewriting Subqueries as Joins for Earlier MySQL Versions</A>.

</P>
<P>
Here is an example of a subquery:

</P>

<PRE>
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</PRE>

<P>
In this example, <CODE>SELECT * FROM t1 ...</CODE> is the <EM>outer query</EM>
(or <EM>outer statement</EM>), and <CODE>(SELECT column1 FROM t2)</CODE> is the
<EM>subquery</EM>.
We say that the subquery is <EM>nested</EM> in the outer query, and in fact
it's possible to nest subqueries within other subqueries, to a great depth.
A subquery must always appear within parentheses.

</P>
<P>
The main advantages of subqueries are:

</P>

<UL>
<LI>

They allow queries that are <EM>structured</EM> so that it's possible to
isolate each part of a statement.
<LI>

They provide alternative ways to perform operations that would otherwise
require complex joins and unions.
<LI>

They are, in many people's opinion, readable.
Indeed, it was the innovation of subqueries that gave people the original
idea of calling the early SQL ``Structured Query Language.''
</UL>

<P>
Here is an example statement that shows the major points about subquery
syntax as specified by the SQL standard and supported in MySQL:

</P>

<PRE>
DELETE FROM t1
WHERE s11 &#62; ANY
 (SELECT COUNT(*) /* no hint */ FROM t2
 WHERE NOT EXISTS
  (SELECT * FROM t3
   WHERE ROW(5*t2.s1,77)=
    (SELECT 50,11*s1 FROM t4 UNION SELECT 50,77 FROM
     (SELECT * FROM t5) AS t5)));
</PRE>



<H4><A NAME="Scalar_subqueries" HREF="manual_toc.html#Scalar_subqueries">14.1.8.1  The Subquery as Scalar Operand</A></H4>

<P>
In its simplest form (the <EM>scalar</EM> subquery as opposed to the
<EM>row</EM> or <EM>table</EM> subqueries that are discussed later),
a subquery is a simple operand. Thus, you can use it wherever a column value
or literal is legal, and you can expect it to have those characteristics
that all operands have: a data type, a length, an indication whether it can
be <CODE>NULL</CODE>, and so on.
For example:

</P>

<PRE>
CREATE TABLE t1 (s1 INT, s2 CHAR(5) NOT NULL);
SELECT (SELECT s2 FROM t1);
</PRE>

<P>
The subquery in this <CODE>SELECT</CODE> has a data type of <CODE>CHAR</CODE>,
a length of 5, a character set and collation equal to the defaults in
effect at <CODE>CREATE TABLE</CODE> time, and an indication that the value in
the column can be <CODE>NULL</CODE>. In fact, almost all subqueries can be
<CODE>NULL</CODE>, because if the table is empty, as in the example,
the value of the subquery will be <CODE>NULL</CODE>.
There are few restrictions.

</P>

<UL>
<LI>

A subquery's outer statement can be any one of:
<CODE>SELECT</CODE>, <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>,
<CODE>SET</CODE>, or <CODE>DO</CODE>.
<LI>

A subquery can contain any of the keywords or clauses that an ordinary
<CODE>SELECT</CODE> can contain:
<CODE>DISTINCT</CODE>, <CODE>GROUP BY</CODE>, <CODE>ORDER BY</CODE>, <CODE>LIMIT</CODE>,
joins, hints, <CODE>UNION</CODE> constructs, comments, functions, and so on.
</UL>

<P>
So, when you see examples in the following sections that contain the rather
spartan construct <CODE>(SELECT column1 FROM t1)</CODE>, imagine that your own
code will contain much more diverse and complex constructions.

</P>
<P>
For example, suppose that we make two tables:

</P>

<PRE>
CREATE TABLE t1 (s1 INT);
INSERT INTO t1 VALUES (1);
CREATE TABLE t2 (s1 INT);
INSERT INTO t2 VALUES (2);
</PRE>

<P>
Then perform a <CODE>SELECT</CODE>:

</P>

<PRE>
SELECT (SELECT s1 FROM t2) FROM t1;
</PRE>

<P>
The result will be <CODE>2</CODE> because there is a row in <CODE>t2</CODE> containing a
column <CODE>s1</CODE> that has a value of <CODE>2</CODE>.

</P>
<P>
The subquery can be part of an expression. If it is an operand for a
function, don't forget the parentheses.
For example:

</P>

<PRE>
SELECT UPPER((SELECT s1 FROM t1)) FROM t2;
</PRE>



<H4><A NAME="Comparisons_using_subqueries" HREF="manual_toc.html#Comparisons_using_subqueries">14.1.8.2  Comparisons Using Subqueries</A></H4>

<P>
The most common use of a subquery is in the form:

</P>

<PRE>
non_subquery_operand comparison_operator (subquery)
</PRE>

<P>
Where <CODE>comparison_operator</CODE> is one of:

<PRE>
=  &#62;  &#60;  &#62;=  &#60;=  &#60;&#62;
</PRE>

<P>
For example:

<PRE>
... 'a' = (SELECT column1 FROM t1)
</PRE>

<P>
At one time the only legal place for a subquery was on the right side of a
comparison, and you might still find some old DBMSs that insist on this.

</P>
<P>
Here is an example of a common-form subquery comparison that you cannot do
with a join. It finds all the values in table <CODE>t1</CODE> that are equal to a
maximum value in table <CODE>t2</CODE>:

</P>

<PRE>
SELECT column1 FROM t1
       WHERE column1 = (SELECT MAX(column2) FROM t2);
</PRE>

<P>
Here is another example, which again is impossible with a join because it
involves aggregating for one of the tables. It finds all rows in table
<CODE>t1</CODE> containing a value that occurs twice:

</P>

<PRE>
SELECT * FROM t1
       WHERE 2 = (SELECT COUNT(column1) FROM t1);
</PRE>



<H4><A NAME="ANY_IN_SOME_subqueries" HREF="manual_toc.html#ANY_IN_SOME_subqueries">14.1.8.3  Subqueries with <CODE>ANY</CODE>, <CODE>IN</CODE>, and <CODE>SOME</CODE></A></H4>

<P>
Syntax:

<PRE>
operand comparison_operator ANY (subquery)
operand IN (subquery)
operand comparison_operator SOME (subquery)
</PRE>

<P>
The <CODE>ANY</CODE> keyword, which must follow a comparison operator, means
``return <CODE>TRUE</CODE> if the comparison is <CODE>TRUE</CODE> for <CODE>ANY</CODE> of the
rows that the subquery returns.''
For example:

</P>

<PRE>
SELECT s1 FROM t1 WHERE s1 &#62; ANY (SELECT s1 FROM t2);
</PRE>

<P>
Suppose that there is a row in table <CODE>t1</CODE> containing <CODE>(10)</CODE>.
The expression is <CODE>TRUE</CODE> if table <CODE>t2</CODE> contains <CODE>(21,14,7)</CODE>
because there is a value <CODE>7</CODE> in <CODE>t2</CODE> that is less than <CODE>10</CODE>.
The expression is <CODE>FALSE</CODE> if table <CODE>t2</CODE> contains <CODE>(20,10)</CODE>,
or if table <CODE>t2</CODE> is empty.  The expression is <CODE>UNKNOWN</CODE> if table
<CODE>t2</CODE> contains <CODE>(NULL,NULL,NULL)</CODE>.

</P>
<P>
The word <CODE>IN</CODE> is an alias for <CODE>= ANY</CODE>. Thus these two statements
are the same:

</P>

<PRE>
SELECT s1 FROM t1 WHERE s1 = ANY (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 IN    (SELECT s1 FROM t2);
</PRE>

<P>
The word <CODE>SOME</CODE> is an alias for <CODE>ANY</CODE>. Thus these two statements
are the same:

</P>

<PRE>
SELECT s1 FROM t1 WHERE s1 &#60;&#62; ANY  (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 &#60;&#62; SOME (SELECT s1 FROM t2);
</PRE>

<P>
Use of the word <CODE>SOME</CODE> is rare, but this example shows why it might be
useful. To most people's ears, the English phrase ``a is not equal to any
b'' means ``there is no b which is equal to a,'' but that isn't what is
meant by the SQL syntax. Using <CODE>&#60;&#62; SOME</CODE> instead helps ensure that
everyone understands the true meaning of the query.

</P>



<H4><A NAME="ALL_subqueries" HREF="manual_toc.html#ALL_subqueries">14.1.8.4  Subqueries with <CODE>ALL</CODE></A></H4>

<P>
Syntax:

<PRE>
operand comparison_operator ALL (subquery)
</PRE>

<P>
The word <CODE>ALL</CODE>, which must follow a comparison operator, means
``return <CODE>TRUE</CODE> if the comparison is <CODE>TRUE</CODE> for <CODE>ALL</CODE> of
the rows that the subquery returns.''
For example:

</P>

<PRE>
SELECT s1 FROM t1 WHERE s1 &#62; ALL (SELECT s1 FROM t2);
</PRE>

<P>
Suppose that there is a row in table <CODE>t1</CODE> containing <CODE>(10)</CODE>.
The expression is <CODE>TRUE</CODE> if table <CODE>t2</CODE> contains <CODE>(-5,0,+5)</CODE>
because <CODE>10</CODE> is greater than all three values in <CODE>t2</CODE>.
The expression is <CODE>FALSE</CODE> if table <CODE>t2</CODE> contains
<CODE>(12,6,NULL,-100)</CODE> because there is a single value <CODE>12</CODE> in table <CODE>t2</CODE>
that is greater than <CODE>10</CODE>.
The expression is <CODE>UNKNOWN</CODE> if table <CODE>t2</CODE> contains <CODE>(0,NULL,1)</CODE>.

</P>
<P>
Finally, if table <CODE>t2</CODE> is empty, the result is <CODE>TRUE</CODE>.
You might think the result should be <CODE>UNKNOWN</CODE>, but
sorry, it's <CODE>TRUE</CODE>. So, rather oddly, the following statement
is <CODE>TRUE</CODE> when table <CODE>t2</CODE> is empty:

</P>

<PRE>
SELECT * FROM t1 WHERE 1 &#62; ALL (SELECT s1 FROM t2);
</PRE>

<P>
But this statement is <CODE>UNKNOWN</CODE> when table <CODE>t2</CODE> is empty:

</P>

<PRE>
SELECT * FROM t1 WHERE 1 &#62; (SELECT s1 FROM t2);
</PRE>

<P>
In addition, the following statement is <CODE>UNKNOWN</CODE> when table <CODE>t2</CODE>
is empty:

</P>

<PRE>
SELECT * FROM t1 WHERE 1 &#62; ALL (SELECT MAX(s1) FROM t2);
</PRE>

<P>
In general, <EM>tables with <CODE>NULL</CODE> values</EM> and <EM>empty tables</EM> are
<EM>edge cases</EM>. When writing subquery code, always consider whether
you have taken those two possibilities into account.

</P>



<H4><A NAME="Correlated_subqueries" HREF="manual_toc.html#Correlated_subqueries">14.1.8.5  Correlated Subqueries</A></H4>

<P>
A <EM>correlated subquery</EM> is a subquery that contains a reference to a
column that also appears in the outer query.
For example:

</P>

<PRE>
SELECT * FROM t1 WHERE column1 = ANY
       (SELECT column1 FROM t2 WHERE t2.column2 = t1.column2);
</PRE>

<P>
Notice that the subquery contains a reference to a column
of <CODE>t1</CODE>, even though the subquery's <CODE>FROM</CODE> clause doesn't mention
a table <CODE>t1</CODE>. So, MySQL looks outside the subquery, and finds <CODE>t1</CODE> in the
outer query.

</P>
<P>
Suppose that table <CODE>t1</CODE> contains a row where <CODE>column1 = 5</CODE> and
<CODE>column2 = 6</CODE>; meanwhile, table <CODE>t2</CODE> contains a row where
<CODE>column1 = 5</CODE> and <CODE>column2 = 7</CODE>. The simple expression
<CODE>... WHERE column1 = ANY (SELECT column1 FROM t2)</CODE> would be
<CODE>TRUE</CODE>, but in this example, the <CODE>WHERE</CODE> clause within the
subquery is <CODE>FALSE</CODE> (because 7 &#60;&#62; 5), so the subquery as a whole is
<CODE>FALSE</CODE>.

</P>
<P>
<STRONG>Scoping rule:</STRONG> MySQL evaluates from inside to outside.
For example:

</P>

<PRE>
SELECT column1 FROM t1 AS x
  WHERE x.column1 = (SELECT column1 FROM t2 AS x
    WHERE x.column1 = (SELECT column1 FROM t3
      WHERE x.column2 = t3.column1));
</PRE>

<P>
In this statement, <CODE>x.column2</CODE> must be a column in table <CODE>t2</CODE> because
<CODE>SELECT column1 FROM t2 AS x ...</CODE> renames <CODE>t2</CODE>. It is not a
column in table <CODE>t1</CODE> because <CODE>SELECT column1 FROM t1 ...</CODE> is an
outer query that is <EM>farther out</EM>.

</P>
<P>
For subqueries in <CODE>HAVING</CODE> or <CODE>ORDER BY</CODE> clauses, MySQL also
looks for column names in the outer select list.

</P>
<P>
For certain cases, a correlated subquery is optimized. For example:

</P>

<PRE>
val IN (SELECT key_val FROM tbl_name WHERE correlated_condition)
</PRE>

<P>
Otherwise, they are inefficient and likely to be slow. Rewriting the query
as a join might improve performance.

</P>



<H4><A NAME="EXISTS_and_NOT_EXISTS_subqueries" HREF="manual_toc.html#EXISTS_and_NOT_EXISTS_subqueries">14.1.8.6  <CODE>EXISTS</CODE> and <CODE>NOT EXISTS</CODE></A></H4>

<P>
If a subquery returns any values at all, then <CODE>EXISTS subquery</CODE> is
<CODE>TRUE</CODE>, and <CODE>NOT EXISTS subquery</CODE> is <CODE>FALSE</CODE>.
For example:

</P>

<PRE>
SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);
</PRE>

<P>
Traditionally, an <CODE>EXISTS</CODE> subquery starts with <CODE>SELECT *</CODE>, but it
could begin with <CODE>SELECT 5</CODE> or <CODE>SELECT column1</CODE> or anything at
all. MySQL ignores the <CODE>SELECT</CODE> list in such a subquery, so it
doesn't matter.

</P>
<P>
For the preceding example, if <CODE>t2</CODE> contains any rows, even rows with
nothing but <CODE>NULL</CODE> values, then the <CODE>EXISTS</CODE> condition is
<CODE>TRUE</CODE>. This is actually an unlikely example, since almost always a
<CODE>[NOT] EXISTS</CODE> subquery will contain correlations.
Here are some more realistic examples:

</P>

<UL>
<LI>

What kind of store is present in one or more cities?

<PRE>
SELECT DISTINCT store_type FROM Stores
  WHERE EXISTS (SELECT * FROM Cities_Stores
                WHERE Cities_Stores.store_type = Stores.store_type);
</PRE>

<LI>

What kind of store is present in no cities?

<PRE>
SELECT DISTINCT store_type FROM Stores
  WHERE NOT EXISTS (SELECT * FROM Cities_Stores
                    WHERE Cities_Stores.store_type = Stores.store_type);
</PRE>

<LI>

What kind of store is present in all cities?

<PRE>
SELECT DISTINCT store_type FROM Stores S1
  WHERE NOT EXISTS (
    SELECT * FROM Cities WHERE NOT EXISTS (
      SELECT * FROM Cities_Stores
       WHERE Cities_Stores.city = Cities.city
       AND Cities_Stores.store_type = Stores.store_type));
</PRE>

</UL>

<P>
The last example is a double-nested <CODE>NOT EXISTS</CODE> query. That is, it has a
<CODE>NOT EXISTS</CODE> clause within a <CODE>NOT EXISTS</CODE> clause. Formally, it
answers the question ``does a city exist with a store which is not in
<CODE>Stores</CODE>?'' But it's easier to say that a nested <CODE>NOT EXISTS</CODE> answers
the question ``is x TRUE for all y?''

</P>



<H4><A NAME="Row_subqueries" HREF="manual_toc.html#Row_subqueries">14.1.8.7  Row Subqueries</A></H4>

<P>
The discussion to this point has been of
<EM>column (or scalar) subqueries</EM>: subqueries that return a single
column value. A <EM>row subquery</EM> is a subquery variant that returns a
single row value -- and can thus return more than one column value.
Here are two examples:

</P>

<PRE>
SELECT * FROM t1 WHERE (1,2) = (SELECT column1, column2 FROM t2);
SELECT * FROM t1 WHERE ROW(1,2) = (SELECT column1, column2 FROM t2);
</PRE>

<P>
The queries here are both <CODE>TRUE</CODE> if table <CODE>t2</CODE> has
a row where <CODE>column1 = 1</CODE> and <CODE>column2 = 2</CODE>.

</P>
<P>
The expressions <CODE>(1,2)</CODE> and <CODE>ROW(1,2)</CODE> are sometimes called
<EM>row constructors</EM>. The two are equivalent.
They are legal in other contexts, too. For example, the following two
statements are semantically equivalent (although currently only the second one
can be optimized):

</P>

<PRE>
SELECT * FROM t1 WHERE (column1,column2) = (1,1);
SELECT * FROM t1 WHERE column1 = 1 AND column2 = 1;
</PRE>

<P>
The normal use of row constructors, though, is for comparisons with
subqueries that return two or more columns. For example, the following query answers
the request, ``find all rows in table <CODE>t1</CODE> that also exist in table
<CODE>t2</CODE>'':

</P>

<PRE>
SELECT column1,column2,column3
       FROM t1
       WHERE (column1,column2,column3) IN
             (SELECT column1,column2,column3 FROM t2);
</PRE>



<H4><A NAME="Unnamed_views" HREF="manual_toc.html#Unnamed_views">14.1.8.8  Subqueries in the <CODE>FROM</CODE> clause</A></H4>

<P>
<A NAME="IDX1587"></A>
<A NAME="IDX1588"></A>

</P>
<P>
Subqueries are legal in a <CODE>SELECT</CODE> statement's <CODE>FROM</CODE> clause.
The syntax that you'll actually see is:

</P>

<PRE>
SELECT ... FROM (subquery) AS name ...
</PRE>

<P>
The <CODE>AS name</CODE> clause is mandatory, because every table in a
<CODE>FROM</CODE> clause must have a name. Any columns in the <CODE>subquery</CODE>
select list must have unique names. You can find this syntax described
elsewhere in this manual, where the term used is ``derived tables.''

</P>

<P>
For illustration, assume that you have this table:

<PRE>
CREATE TABLE t1 (s1 INT, s2 CHAR(5), s3 FLOAT);
</PRE>

<P>
Here's how to use a subquery in the <CODE>FROM</CODE> clause, using
the example table:

</P>

<PRE>
INSERT INTO t1 VALUES (1,'1',1.0);
INSERT INTO t1 VALUES (2,'2',2.0);
SELECT sb1,sb2,sb3
       FROM (SELECT s1 AS sb1, s2 AS sb2, s3*2 AS sb3 FROM t1) AS sb
       WHERE sb1 &#62; 1;
</PRE>

<P>
Result: <CODE>2, '2', 4.0</CODE>.

</P>
<P>
Here's another example: Suppose that you want to know the average of a
set of sums for a grouped table. This won't work:

</P>

<PRE>
SELECT AVG(SUM(column1)) FROM t1 GROUP BY column1;
</PRE>

<P>
But this query will provide the desired information:

</P>

<PRE>
SELECT AVG(sum_column1)
       FROM (SELECT SUM(column1) AS sum_column1
             FROM t1 GROUP BY column1) AS t1;
</PRE>

<P>
Notice that the column name used within the subquery
<CODE>(sum_column1)</CODE> is recognized in the outer query.

</P>
<P>
At the moment, subqueries in the <CODE>FROM</CODE> clause cannot be correlated
subqueries.

</P>
<P>
Subquery in the <CODE>FROM</CODE> clause will be executed (that is, derived temporary
tables will be built) even for the <CODE>EXPLAIN</CODE> statement, because upper
level queries need information about all tables during optimization phase.

</P>


<H4><A NAME="Subquery_errors" HREF="manual_toc.html#Subquery_errors">14.1.8.9  Subquery Errors</A></H4>

<P>
There are some new error returns that apply only to subqueries.
This section groups them together because reviewing them will help
remind you of some points.

</P>

<UL>
<LI>

Unsupported subquery syntax:


<PRE>
ERROR 1235 (ER_NOT_SUPPORTED_YET)
SQLSTATE = 42000
Message = "This version of MySQL doesn't yet support
'LIMIT &#38; IN/ALL/ANY/SOME subquery'"
</PRE>

This means that statements of the following form will not work, but only
in some early versions, such as MySQL 4.1.1:


<PRE>
SELECT * FROM t1 WHERE s1 IN (SELECT s2 FROM t2 ORDER BY s1 LIMIT 1)
</PRE>

<LI>

Incorrect number of columns from subquery:


<PRE>
ERROR 1240 (ER_CARDINALITY_COL)
SQLSTATE = 21000
Message = "Operand should contain 1 column(s)"
</PRE>

This error will occur in cases like this:


<PRE>
SELECT (SELECT column1, column2 FROM t2) FROM t1;
</PRE>

It's okay to use a subquery that returns multiple columns, if the purpose
is comparison. See section <A HREF="manual.html#Row_subqueries">14.1.8.7  Row Subqueries</A>.
But in other contexts, the subquery must be a scalar operand.

<LI>

Incorrect number of rows from subquery:


<PRE>
ERROR 1241 (ER_SUBSELECT_NO_1_ROW)
SQLSTATE = 21000
Message = "Subquery returns more than 1 row"
</PRE>

This error will occur for statements such as the following one,
but only when there is more than one row in <CODE>t2</CODE>:


<PRE>
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</PRE>

That means this
error might occur in code that had been working for years, because somebody
happened to make a change that affected the number of rows that the
subquery can return. Remember that if the object is to find any number of
rows, not just one, then the correct statement would look like this:


<PRE>
SELECT * FROM t1 WHERE column1 = ANY (SELECT column1 FROM t2);
</PRE>

<LI>

Incorrectly used table in subquery:


<PRE>
Error 1093 (ER_UPDATE_TABLE_USED)
SQLSTATE = HY000
Message = "You can't specify target table 'x'
for update in FROM clause"
</PRE>

This error will occur in cases like this:


<PRE>
UPDATE t1 SET column2 = (SELECT MAX(column1) FROM t1);
</PRE>

It's okay to use a subquery for assignment within an
<CODE>UPDATE</CODE> statement, since subqueries are legal in <CODE>UPDATE</CODE>
and <CODE>DELETE</CODE> statements as well as in <CODE>SELECT</CODE> statements.
However, you cannot use the same table, in this case table <CODE>t1</CODE>, for
both the subquery's <CODE>FROM</CODE> clause and the update target.

</UL>

<P>
Usually, failure of a subquery causes the entire statement to fail.

</P>



<H4><A NAME="Optimising_subqueries" HREF="manual_toc.html#Optimising_subqueries">14.1.8.10  Optimizing Subqueries</A></H4>

<P>
Development is ongoing, so no optimization tip is reliable for the long
term. Some interesting tricks that you might want to play with are:

</P>

<UL>
<LI>

Use subquery clauses that affect the number or order of the rows in the
subquery. For example:


<PRE>
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT column1 FROM t2 ORDER BY column1);
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT DISTINCT column1 FROM t2);
SELECT * FROM t1 WHERE EXISTS
  (SELECT * FROM t2 LIMIT 1);
</PRE>

<LI>

Replace a join with a subquery. For example, use this query:


<PRE>
SELECT DISTINCT column1 FROM t1 WHERE t1.column1 IN (
  SELECT column1 FROM t2);
</PRE>

Instead of this query:


<PRE>
SELECT DISTINCT t1.column1 FROM t1, t2
  WHERE t1.column1 = t2.column1;
</PRE>

<LI>

Move clauses from outside to inside the subquery. For example, use this
query:


<PRE>
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1 UNION ALL SELECT s1 FROM t2);
</PRE>

Instead of this query:


<PRE>
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1) OR s1 IN (SELECT s1 FROM t2);
</PRE>

For another example, use this query:


<PRE>
SELECT (SELECT column1 + 5 FROM t1) FROM t2;
</PRE>

Instead of this query:


<PRE>
SELECT (SELECT column1 FROM t1) + 5 FROM t2;
</PRE>

<LI>

Use a row subquery instead of a correlated subquery. For example, use this
query:


<PRE>
SELECT * FROM t1
  WHERE (column1,column2) IN (SELECT column1,column2 FROM t2);
</PRE>

Instead of this query:


<PRE>
SELECT * FROM t1
  WHERE EXISTS (SELECT * FROM t2 WHERE t2.column1=t1.column1
  AND t2.column2=t1.column2);
</PRE>

<LI>

Use <CODE>NOT (a = ANY (...))</CODE> rather than <CODE>a &#60;&#62; ALL (...)</CODE>.

<LI>

Use <CODE>x = ANY (table containing (1,2))</CODE> rather than
<CODE>x=1 OR x=2</CODE>.

<LI>

Use <CODE>= ANY</CODE> rather than <CODE>EXISTS</CODE>.
</UL>

<P>
These tricks might cause programs to go faster or slower. Using MySQL
facilities like the <CODE>BENCHMARK()</CODE> function, you can get an idea about
what helps in your own situation. Don't worry too much about transforming
to joins except for compatibility with older versions of MySQL before 4.1
that do not support subqueries.

</P>
<P>
Some optimizations that MySQL itself makes are:

</P>

<UL>
<LI>

MySQL executes non-correlated subqueries only once. Use <CODE>EXPLAIN</CODE>
to make sure that a given subquery really is non-correlated.

<LI>

MySQL rewrites <CODE>IN</CODE>/<CODE>ALL</CODE>/<CODE>ANY</CODE>/<CODE>SOME</CODE> subqueries
in an attempt to take advantage of the possibility that the select-list
columns in the subquery are indexed.

<LI>

MySQL replaces subqueries of the following form
with an index-lookup function, which <CODE>EXPLAIN</CODE> will describe as a
special join type:


<PRE>
... IN (SELECT indexed_column FROM single_table ...)
</PRE>

<LI>

MySQL enhances expressions of the following form
with an expression involving <CODE>MIN()</CODE> or <CODE>MAX()</CODE>, unless <CODE>NULL</CODE>
values or empty sets are involved:


<PRE>
value {ALL|ANY|SOME} {&#62; | &#60; | &#62;= | &#60;=} (non-correlated subquery)
</PRE>

For example, this <CODE>WHERE</CODE> clause:


<PRE>
WHERE 5 &#62; ALL (SELECT x FROM t)
</PRE>

might be treated by the optimizer like this:


<PRE>
WHERE 5 &#62; (SELECT MAX(x) FROM t)
</PRE>

</UL>

<P>
There is a chapter titled ``How MySQL Transforms Subqueries''
in the MySQL Internals Manual. You can obtain this document by downloading the
MySQL source package and looking for a file named <TT>`internals.texi'</TT> in the
<TT>`Docs'</TT> directory.

</P>



<H4><A NAME="Rewriting_subqueries" HREF="manual_toc.html#Rewriting_subqueries">14.1.8.11  Rewriting Subqueries as Joins for Earlier MySQL Versions</A></H4>

<P>
Before MySQL 4.1, only nested queries of the form
<CODE>INSERT ... SELECT ...</CODE> and <CODE>REPLACE ... SELECT ...</CODE>
are supported.
The <CODE>IN()</CODE> construct can be used in other contexts to test membership in
a set of values.

</P>
<P>
It is often possible to rewrite a query without a subquery:

</P>

<PRE>
SELECT * FROM t1 WHERE id IN (SELECT id FROM t2);
</PRE>

<P>
This can be rewritten as:

</P>

<PRE>
SELECT DISTINCT t1.* FROM t1,t2 WHERE t1.id=t2.id;
</PRE>

<P>
The queries:

<PRE>
SELECT * FROM t1 WHERE id NOT IN (SELECT id FROM t2);
SELECT * FROM t1 WHERE NOT EXISTS (SELECT id FROM t2 WHERE t1.id=t2.id);
</PRE>

<P>
Can be rewritten as:

</P>

<PRE>
SELECT table1.* FROM table1 LEFT JOIN table2 ON table1.id=table2.id
                                       WHERE table2.id IS NULL;
</PRE>

<P>
A <CODE>LEFT [OUTER] JOIN</CODE> can be faster than an equivalent subquery
because the server might be able to optimize it better--a fact that is
not specific to MySQL Server alone.
Prior to SQL-92, outer joins did not exist, so subqueries were the only way
to do certain things in those bygone days. Today, MySQL Server and many
other modern database systems offer a whole range of outer join types.

</P>
<P>
For more complicated subqueries, you can often create temporary tables
to hold the subquery.  In some cases, however, this option will not
work. The most frequently encountered of these cases arises with
<CODE>DELETE</CODE> statements, for which standard SQL does not support joins
(except in subqueries).  For this situation, there are three options
available:

</P>

<UL>
<LI>

The first option is to upgrade to MySQL 4.1, which does support
subqueries in <CODE>DELETE</CODE> statements.

<LI>

The second option is to use a procedural programming language (such as
Perl or PHP) to submit a <CODE>SELECT</CODE> query to obtain the primary keys
for the records to be deleted, and then use these values to construct
the <CODE>DELETE</CODE> statement (<CODE>DELETE FROM ... WHERE key_col IN (key1,
key2, ...)</CODE>).

<LI>

The third option is to use interactive SQL to construct a set of
<CODE>DELETE</CODE> statements automatically, using the MySQL
extension <CODE>CONCAT()</CODE> (in lieu of the standard <CODE>||</CODE> operator).
For example:


<PRE>
SELECT
  CONCAT('DELETE FROM tab1 WHERE pkid = ', "'", tab1.pkid, "'", ';')
  FROM tab1, tab2
 WHERE tab1.col1 = tab2.col2;
</PRE>

You can place this query in a script file, use the file as input to one
instance of the <CODE>mysql</CODE> program, and use the program output
as input to a second instance of <CODE>mysql</CODE>:


<PRE>
shell&#62; mysql --skip-column-names mydb &#60; myscript.sql | mysql mydb
</PRE>

</UL>

<P>
MySQL Server 4.0 supports multiple-table <CODE>DELETE</CODE> statements that can be used to
efficiently delete rows based on information from one table or even
from many tables at the same time.
Multiple-table <CODE>UPDATE</CODE> statements are also supported as of MySQL 4.0.

</P>



<H3><A NAME="TRUNCATE" HREF="manual_toc.html#TRUNCATE">14.1.9  <CODE>TRUNCATE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1589"></A>

</P>

<PRE>
TRUNCATE TABLE tbl_name
</PRE>

<P>
<CODE>TRUNCATE TABLE</CODE> empties a table completely.
Logically, this is equivalent to a <CODE>DELETE</CODE> statement that deletes all
rows, but there are practical differences under some circumstances.

</P>
<P>
For <CODE>InnoDB</CODE>, <CODE>TRUNCATE TABLE</CODE> is mapped to
<CODE>DELETE</CODE>, so there is no difference. For other storage engines,
<CODE>TRUNCATE TABLE</CODE> differs from <CODE>DELETE FROM ...</CODE>
in the following ways from MySQL 4.0 and up:

</P>

<UL>
<LI>

Truncate operations drop and re-create the table, which is much faster
than deleting rows one by one.
<LI>

Truncate operations are not transaction-safe; you will get an error if
you have an active transaction or an active table lock.
<LI>

The number of deleted rows is not returned.
<LI>

As long as the table definition file <TT>`tbl_name.frm'</TT> is
valid, the table can be re-created as an empty table with <CODE>TRUNCATE
TABLE</CODE>, even if the data or index files have become corrupted.
<LI>

The table handler does not remember the last used <CODE>AUTO_INCREMENT</CODE>
value, but starts counting from the beginning.  This is true even for
<CODE>MyISAM</CODE>, which normally does not reuse sequence values.
</UL>

<P>
In MySQL 3.23, <CODE>TRUNCATE TABLE</CODE> is mapped to
<CODE>COMMIT; DELETE FROM tbl_name</CODE>, so it behaves like <CODE>DELETE</CODE>.
See section <A HREF="manual.html#DELETE">14.1.1  <CODE>DELETE</CODE> Syntax</A>.

</P>
<P>
<CODE>TRUNCATE TABLE</CODE> is an Oracle SQL extension.
This statement was added in MySQL 3.23.28, although from 3.23.28
to 3.23.32, the keyword <CODE>TABLE</CODE> must be omitted.

</P>



<H3><A NAME="UPDATE" HREF="manual_toc.html#UPDATE">14.1.10  <CODE>UPDATE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1590"></A>

</P>
<P>
Single-table syntax:

<PRE>
UPDATE [LOW_PRIORITY] [IGNORE] tbl_name
    SET col_name1=expr1 [, col_name2=expr2 ...]
    [WHERE where_definition]
    [ORDER BY ...]
    [LIMIT row_count]
</PRE>

<P>
Multiple-table syntax:

</P>

<PRE>
UPDATE [LOW_PRIORITY] [IGNORE] tbl_name [, tbl_name ...]
    SET col_name1=expr1 [, col_name2=expr2 ...]
    [WHERE where_definition]
</PRE>

<P>
The <CODE>UPDATE</CODE> statement updates columns in existing table rows with new values.
The <CODE>SET</CODE> clause indicates which columns to modify and the values
they should be given.  The <CODE>WHERE</CODE> clause, if given, specifies
which rows should be updated.  Otherwise, all rows are updated. If the
<CODE>ORDER BY</CODE> clause is specified, the rows will be updated in the
order that is specified. The <CODE>LIMIT</CODE> clause places a limit on the number
of rows that can be updated.

</P>
<P>
The <CODE>UPDATE</CODE> statement supports the following modifiers:

</P>

<UL>

<LI>

If you specify the <CODE>LOW_PRIORITY</CODE> keyword, execution of the
<CODE>UPDATE</CODE> is delayed until no other clients are reading from the table.

<LI>

If you specify the <CODE>IGNORE</CODE> keyword, the update statement will not
abort even if duplicate-key errors occur during the update.  Rows for which
conflicts occur are not updated.

</UL>

<P>
If you access a column from <CODE>tbl_name</CODE> in an expression,
<CODE>UPDATE</CODE> uses the current value of the column.  For example, the
following statement sets the <CODE>age</CODE> column to one more than its
current value:

</P>

<PRE>
mysql&#62; UPDATE persondata SET age=age+1;
</PRE>

<P>
<CODE>UPDATE</CODE> assignments are evaluated from left to right.  For example, the
following statement doubles the <CODE>age</CODE> column, then increments it:

</P>

<PRE>
mysql&#62; UPDATE persondata SET age=age*2, age=age+1;
</PRE>

<P>
If you set a column to the value it currently has, MySQL notices
this and doesn't update it.

</P>
<P>
If you update a column that has been declared <CODE>NOT NULL</CODE> by
setting to <CODE>NULL</CODE>, the column is set to the default value appropriate
for the column type and the warning count is incremented.  The default
value is <CODE>0</CODE> for numeric types, the empty string (<CODE>''</CODE>)
for string types, and the ``zero'' value for date and time types.

</P>
<P>
<A NAME="IDX1591"></A>
<CODE>UPDATE</CODE> returns the number of rows that were actually changed.
In MySQL 3.22 or later, the C API function <CODE>mysql_info()</CODE>
returns the number of rows that were matched and updated and the number of
warnings that occurred during the <CODE>UPDATE</CODE>.

</P>
<P>
Starting from MySQL 3.23, you can use <CODE>LIMIT row_count</CODE> to
restrict the scope of the <CODE>UPDATE</CODE>. A <CODE>LIMIT</CODE> clause works as
follows:

</P>

<UL>
<LI>

Before MySQL 4.0.13, <CODE>LIMIT</CODE> is a rows-affected restriction.
The statement stops as soon as it has changed <CODE>row_count</CODE> rows that
satisfy the <CODE>WHERE</CODE> clause.

<LI>

From 4.0.13 on, <CODE>LIMIT</CODE> is a rows-matched restriction.  The statement
stops as soon as it has found <CODE>row_count</CODE> rows that satisfy the
<CODE>WHERE</CODE> clause, whether or not they actually were changed.

</UL>

<P>
If an <CODE>UPDATE</CODE> statement includes an <CODE>ORDER BY</CODE> clause, the rows
are updated in the order specified by the clause.
<CODE>ORDER BY</CODE> can be used from MySQL 4.0.0.

</P>
<P>
Starting with MySQL 4.0.4, you can also perform <CODE>UPDATE</CODE>
operations that cover multiple tables:

</P>

<PRE>
UPDATE items,month SET items.price=month.price
WHERE items.id=month.id;
</PRE>

<P>
The example shows an inner join using the comma operator, but
multiple-table <CODE>UPDATE</CODE> statements can use any type of
join allowed in <CODE>SELECT</CODE> statements, such as <CODE>LEFT JOIN</CODE>.

</P>
<P>
Note: You cannot use <CODE>ORDER BY</CODE> or <CODE>LIMIT</CODE> with multiple-table
<CODE>UPDATE</CODE>.

</P>
<P>
Before MySQL 4.0.18, you needed the <CODE>UPDATE</CODE> privilege for all
tables used in a multiple-table <CODE>UPDATE</CODE>, even if they were not
updated.  As of MySQL 4.0.18, you need only the <CODE>SELECT</CODE> privilege for
any columns that are read but not modified.

</P>
<P>
If you use a multiple-table <CODE>UPDATE</CODE> statement involving
<CODE>InnoDB</CODE> tables for which there are foreign key constraints,
the MySQL optimizer might process tables in an order that differs from
that of their parent/child relationship. In this case, the statement will
fail and roll back. Instead, update a single table and rely on the
<CODE>ON UPDATE</CODE> capabilities that <CODE>InnoDB</CODE> provides to cause the
other tables to be modified accordingly.

</P>



<H2><A NAME="Data_Definition" HREF="manual_toc.html#Data_Definition">14.2  Data Definition Statements</A></H2>



<H3><A NAME="ALTER_DATABASE" HREF="manual_toc.html#ALTER_DATABASE">14.2.1  <CODE>ALTER DATABASE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1592"></A>
<A NAME="IDX1593"></A>
<A NAME="IDX1594"></A>

</P>

<PRE>
ALTER DATABASE db_name
    alter_specification [, alter_specification] ...

alter_specification:
    [DEFAULT] CHARACTER SET charset_name
  | [DEFAULT] COLLATE collation_name
</PRE>

<P>
<CODE>ALTER DATABASE</CODE> allows you to change the overall characteristics of a
database.  These characteristics are stored in the <TT>`db.opt'</TT> file in the
database directory.
To use <CODE>ALTER DATABASE</CODE>, you need the <CODE>ALTER</CODE> privilege on the
database.

</P>
<P>
The <CODE>CHARACTER SET</CODE> clause changes the default database character set.
The <CODE>COLLATE</CODE> clause changes the default database collation.
Character set and collation names are discussed in
section <A HREF="manual.html#Charset">11  Character Set Support</A>.

</P>
<P>
<CODE>ALTER DATABASE</CODE> was added in MySQL 4.1.1.

</P>


<H3><A NAME="ALTER_TABLE" HREF="manual_toc.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1595"></A>
<A NAME="IDX1596"></A>
<A NAME="IDX1597"></A>

</P>

<PRE>
ALTER [IGNORE] TABLE tbl_name
    alter_specification [, alter_specification] ...

alter_specification:
    ADD [COLUMN] column_definition [FIRST | AFTER col_name ]
  | ADD [COLUMN] (column_definition,...)
  | ADD INDEX [index_name] [index_type] (index_col_name,...)
  | ADD [CONSTRAINT [symbol]]
        PRIMARY KEY [index_type] (index_col_name,...)
  | ADD [CONSTRAINT [symbol]]
        UNIQUE [index_name] [index_type] (index_col_name,...)
  | ADD [FULLTEXT|SPATIAL] [index_name] (index_col_name,...)
  | ADD [CONSTRAINT [symbol]]
        FOREIGN KEY [index_name] (index_col_name,...)
        [reference_definition]
  | ALTER [COLUMN] col_name {SET DEFAULT literal | DROP DEFAULT}
  | CHANGE [COLUMN] old_col_name column_definition
        [FIRST|AFTER col_name]
  | MODIFY [COLUMN] column_definition [FIRST | AFTER col_name]
  | DROP [COLUMN] col_name
  | DROP PRIMARY KEY
  | DROP INDEX index_name
  | DROP FOREIGN KEY fk_symbol
  | DISABLE KEYS
  | ENABLE KEYS
  | RENAME [TO] new_tbl_name
  | ORDER BY col_name
  | CONVERT TO CHARACTER SET charset_name [COLLATE collation_name]
  | [DEFAULT] CHARACTER SET charset_name [COLLATE collation_name]
  | DISCARD TABLESPACE
  | IMPORT TABLESPACE
  | table_options
</PRE>

<P>
<CODE>ALTER TABLE</CODE> allows you to change the structure of an existing table.
For example, you can add or delete columns, create or destroy indexes, change
the type of existing columns, or rename columns or the table itself.  You can
also change the comment for the table and type of the table.

</P>
<P>
The syntax for many of the allowable alterations is similar to clauses of the
<CODE>CREATE TABLE</CODE> statement.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
If you use <CODE>ALTER TABLE</CODE> to change a column specification but
<CODE>DESCRIBE tbl_name</CODE> indicates that your column was not changed, it is
possible that MySQL ignored your modification for one of the reasons
described in section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.  For example, if you try to change
a <CODE>VARCHAR</CODE> column to <CODE>CHAR</CODE>, MySQL will still use
<CODE>VARCHAR</CODE> if the table contains other variable-length columns.

</P>
<P>
<CODE>ALTER TABLE</CODE> works by making a temporary copy of the original table.
The alteration is performed on the copy, then the original table is deleted
and the new one is renamed.  While <CODE>ALTER TABLE</CODE> is executing, the
original table is readable by other clients. Updates and writes to the
table are stalled until the new table is ready, then are automatically
redirected to the new table without any failed updates.

</P>
<P>
Note that if you use any other option to <CODE>ALTER TABLE</CODE> than
<CODE>RENAME</CODE>, MySQL always creates a temporary table, even if the data
wouldn't strictly need to be copied (such as when you change the name of a
column). We plan to fix this in the future, but because <CODE>ALTER TABLE</CODE>
is not a statement that is normally used frequently, this isn't high on our
TODO list.  For <CODE>MyISAM</CODE> tables, you can speed up the index re-creation
operation (which is the slowest part of the alteration process) by setting
the <CODE>myisam_sort_buffer_size</CODE> system variable to a high value.

</P>

<UL>
<LI>

To use <CODE>ALTER TABLE</CODE>, you need <CODE>ALTER</CODE>, <CODE>INSERT</CODE>,
and <CODE>CREATE</CODE> privileges for the table.

<LI>

<CODE>IGNORE</CODE> is a MySQL extension to standard SQL.
It controls how <CODE>ALTER TABLE</CODE> works if there are duplicates on
unique keys in the new table.
If <CODE>IGNORE</CODE> isn't specified, the copy is aborted and rolled back if
duplicate-key errors occur.
If <CODE>IGNORE</CODE> is specified, then for rows with duplicates on a unique
key, only the first row is used. The others are deleted.

<LI>

You can issue multiple <CODE>ADD</CODE>, <CODE>ALTER</CODE>, <CODE>DROP</CODE>, and
<CODE>CHANGE</CODE> clauses in a single <CODE>ALTER TABLE</CODE> statement. This is a
MySQL extension to standard SQL, which allows only one of each clause
per <CODE>ALTER TABLE</CODE> statement.

<LI>

<CODE>CHANGE col_name</CODE>, <CODE>DROP col_name</CODE>, and <CODE>DROP
INDEX</CODE> are MySQL extensions to standard SQL.

<LI>

<CODE>MODIFY</CODE> is an Oracle extension to <CODE>ALTER TABLE</CODE>.

<LI>

The word <CODE>COLUMN</CODE> is purely optional and can be omitted.

<LI>

If you use <CODE>ALTER TABLE tbl_name RENAME TO new_tbl_name</CODE> without any other
options, MySQL simply renames any files that correspond to the table
<CODE>tbl_name</CODE>.  There is no need to create a temporary table.
(You can also use the <CODE>RENAME TABLE</CODE> statement to rename tables.
See section <A HREF="manual.html#RENAME_TABLE">14.2.9  <CODE>RENAME TABLE</CODE> Syntax</A>.)

<LI>

<CODE>column_definition</CODE> clauses use the same syntax for <CODE>ADD</CODE> and
<CODE>CHANGE</CODE> as for <CODE>CREATE TABLE</CODE>.  Note that this syntax includes
the column name, not just the column type.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<LI>

You can rename a column using a <CODE>CHANGE old_col_name column_definition</CODE>
clause.  To do so, specify the old and new column names and the type that
the column currently has.  For example, to rename an <CODE>INTEGER</CODE> column
from <CODE>a</CODE> to <CODE>b</CODE>, you can do this:


<PRE>
mysql&#62; ALTER TABLE t1 CHANGE a b INTEGER;
</PRE>

If you want to change a column's type but not the name, <CODE>CHANGE</CODE>
syntax still requires an old and new column name, even if they are the same.
For example:


<PRE>
mysql&#62; ALTER TABLE t1 CHANGE b b BIGINT NOT NULL;
</PRE>

However, as of MySQL 3.22.16a, you can also use <CODE>MODIFY</CODE>
to change a column's type without renaming it:


<PRE>
mysql&#62; ALTER TABLE t1 MODIFY b BIGINT NOT NULL;
</PRE>

<LI>

If you use <CODE>CHANGE</CODE> or <CODE>MODIFY</CODE> to shorten a column for which
an index exists on part of the column (for example, if you have an index
on the first 10 characters of a <CODE>VARCHAR</CODE> column), you cannot make
the column shorter than the number of characters that are indexed.

<LI>

When you change a column type using <CODE>CHANGE</CODE> or <CODE>MODIFY</CODE>, MySQL
tries to convert existing column values to the new type as well as possible.

<LI>

In MySQL 3.22 or later, you can use <CODE>FIRST</CODE> or
<CODE>AFTER col_name</CODE> to add a column at a specific position
within a table row. The default is to add the column last.
From MySQL 4.0.1 on, you can also use <CODE>FIRST</CODE> and
<CODE>AFTER</CODE> in <CODE>CHANGE</CODE> or <CODE>MODIFY</CODE> operations.

<A NAME="IDX1598"></A>
<A NAME="IDX1599"></A>
<A NAME="IDX1600"></A>
<A NAME="IDX1601"></A>
<A NAME="IDX1602"></A>
<LI>

<CODE>ALTER COLUMN</CODE> specifies a new default value for a column
or removes the old default value.
If the old default is removed and the column can be <CODE>NULL</CODE>, the new
default is <CODE>NULL</CODE>. If the column cannot be <CODE>NULL</CODE>, MySQL
assigns a default value, as described in
section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<A NAME="IDX1603"></A>
<A NAME="IDX1604"></A>
<A NAME="IDX1605"></A>
<LI>

<CODE>DROP INDEX</CODE> removes an index. This is a MySQL extension to
standard SQL. See section <A HREF="manual.html#DROP_INDEX">14.2.7  <CODE>DROP INDEX</CODE> Syntax</A>.

<LI>

If columns are dropped from a table, the columns are also removed from any
index of which they are a part.  If all columns that make up an index are
dropped, the index is dropped as well.

<LI>

If a table contains only one column, the column cannot be dropped.
If what you intend is to remove the table, use <CODE>DROP TABLE</CODE> instead.

<LI>

<A NAME="IDX1606"></A>
<A NAME="IDX1607"></A>
<A NAME="IDX1608"></A>
<CODE>DROP PRIMARY KEY</CODE> drops the primary index. (Prior to MySQL 4.1.2,
if no primary index exists, <CODE>DROP PRIMARY KEY</CODE> drops the first
<CODE>UNIQUE</CODE> index in the table.
MySQL marks the first <CODE>UNIQUE</CODE> key as the <CODE>PRIMARY KEY</CODE>
if no <CODE>PRIMARY KEY</CODE> was specified explicitly.)

<A NAME="IDX1609"></A>
<A NAME="IDX1610"></A>
If you add a <CODE>UNIQUE INDEX</CODE> or <CODE>PRIMARY KEY</CODE> to a table, it
is stored before any non-unique index so that MySQL can detect
duplicate keys as early as possible.

<A NAME="IDX1611"></A>
<LI>

<CODE>ORDER BY</CODE> allows you to create the new table with the rows in a
specific order.  Note that the table will not remain in this order after
inserts and deletes.  This option is mainly useful when you know that you
are mostly going to query the rows in a certain order; by using this option
after big changes to the table, you might be able to get higher performance.
In some cases, it might make sorting easier for MySQL if the table is in
order by the column that you want to order it by later.

<A NAME="IDX1612"></A>
<A NAME="IDX1613"></A>
<A NAME="IDX1614"></A>
<LI>

If you use <CODE>ALTER TABLE</CODE> on a <CODE>MyISAM</CODE> table, all non-unique
indexes are created in a separate batch (as for <CODE>REPAIR TABLE</CODE>).
This should make <CODE>ALTER TABLE</CODE> much faster when you have many indexes.

As of MySQL 4.0, this feature can be activated explicitly.  <CODE>ALTER
TABLE ... DISABLE KEYS</CODE> tells MySQL to stop updating non-unique indexes for a
<CODE>MyISAM</CODE> table.  <CODE>ALTER TABLE ... ENABLE KEYS</CODE> then should be used
to re-create missing indexes. MySQL does this with a special algorithm that
is much faster than inserting keys one by one, so disabling keys before
performing bulk insert operations should give a considerable speedup.

<LI>

<A NAME="IDX1615"></A>
<A NAME="IDX1616"></A>
The <CODE>FOREIGN KEY</CODE> and <CODE>REFERENCES</CODE> clauses are supported by the
<CODE>InnoDB</CODE> storage engine, which implements
<CODE>ADD [CONSTRAINT [symbol]] FOREIGN KEY (...) REFERENCES ... (...)</CODE>.
See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.
For other storage engines, the clauses are parsed but ignored.
The <CODE>CHECK</CODE> clause is parsed but ignored for all storage engines.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.
The reason for accepting but ignoring syntax clauses is for compatibility,
to make it easier to port code from other SQL servers, and to run applications
that create tables with references.
See section <A HREF="manual.html#Differences_from_ANSI">1.8.5  MySQL Differences Compared to Standard SQL</A>.

<LI>

<A NAME="IDX1617"></A>
<A NAME="IDX1618"></A>
<A NAME="IDX1619"></A>
Starting from MySQL 4.0.13, <CODE>InnoDB</CODE> supports the use of <CODE>ALTER
TABLE</CODE> to drop foreign keys:


<PRE>
ALTER TABLE yourtablename
    DROP FOREIGN KEY fk_symbol
</PRE>

For more information, see
section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.

<LI>

<CODE>ALTER TABLE</CODE> ignores the <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX
DIRECTORY</CODE> table options.

<LI>

<A NAME="IDX1620"></A>
From MySQL 4.1.2 on,
if you want to change all character columns (<CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>,
<CODE>TEXT</CODE>) to a new character set, use a statement like this:


<PRE>
ALTER TABLE tbl_name CONVERT TO CHARACTER SET charset_name;
</PRE>

This is useful, for example, after upgrading from MySQL 4.0.x to 4.1.x.
See section <A HREF="manual.html#Charset-upgrading">11.10  Upgrading Character Sets from MySQL 4.0</A>.

<STRONG>Warning:</STRONG> The preceding operation will convert column values between
the character sets. This is <EM>not</EM> what you want if you have a column in
one character set (like <CODE>latin1</CODE>) but the stored values actually use
some other, incompatible character set (like <CODE>utf8</CODE>). In this case,
you have to do the following for each such column:


<PRE>
ALTER TABLE t1 CHANGE c1 c1 BLOB;
ALTER TABLE t1 CHANGE c1 c1 TEXT CHARACTER SET utf8;
</PRE>

The reason this works is that there is no conversion when you convert
to or from <CODE>BLOB</CODE> columns.

To change only the <EM>default</EM> character set for a table, use this
statement:


<PRE>
ALTER TABLE tbl_name DEFAULT CHARACTER SET charset_name;
</PRE>

The word <CODE>DEFAULT</CODE> is optional.
The default character set is the character set that is used if
you don't specify the character set for a new column you add to a table
(for example, with <CODE>ALTER TABLE ... ADD column</CODE>).

<STRONG>Warning:</STRONG> From MySQL 4.1.2 and up, <CODE>ALTER TABLE ... DEFAULT
CHARACTER SET</CODE> and <CODE>ALTER TABLE ... CHARACTER SET</CODE> are equivalent and
change only the default table character set. In MySQL 4.1 releases before
4.1.2, <CODE>ALTER TABLE ...  DEFAULT CHARACTER SET</CODE> changes the default
character set, but <CODE>ALTER TABLE ...  CHARACTER SET</CODE> (without
<CODE>DEFAULT</CODE>) changes the default character set but also converts all columns
to the new character set.

<LI>

<A NAME="IDX1621"></A>
<A NAME="IDX1622"></A>
For an <CODE>InnoDB</CODE> table that is created with its own tablespace in an
<TT>`.ibd'</TT> file, that file can be discarded and imported. To discard the
<TT>`.ibd'</TT> file, use this statement:


<PRE>
ALTER TABLE tbl_name DISCARD TABLESPACE;
</PRE>

This deletes the current <TT>`.ibd'</TT> file, so be sure that you have a backup
first. Attempting to access the table while the tablespace file is discarded
results in an error.

To import the backup <TT>`.ibd'</TT> file back into the table, copy it into the
database directory, then issue this statement:


<PRE>
ALTER TABLE tbl_name IMPORT TABLESPACE;
</PRE>

See section <A HREF="manual.html#Multiple_tablespaces">16.7.6  Using Per-Table Tablespaces</A>.

<LI>

<A NAME="IDX1623"></A>
With the <CODE>mysql_info()</CODE> C API function, you can find out how many
records were copied, and (when <CODE>IGNORE</CODE> is used) how many records were
deleted due to duplication of unique key values.
See section <A HREF="manual.html#mysql_info">20.2.3.126  <CODE>mysql_info()</CODE></A>.

</UL>

<P>
Here are some examples that show uses of <CODE>ALTER TABLE</CODE>.
Begin with a table <CODE>t1</CODE> that is created as shown here:

</P>

<PRE>
mysql&#62; CREATE TABLE t1 (a INTEGER,b CHAR(10));
</PRE>

<P>
To rename the table from <CODE>t1</CODE> to <CODE>t2</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t1 RENAME t2;
</PRE>

<P>
To change column <CODE>a</CODE> from <CODE>INTEGER</CODE> to <CODE>TINYINT NOT NULL</CODE>
(leaving the name the same), and to change column <CODE>b</CODE> from
<CODE>CHAR(10)</CODE> to <CODE>CHAR(20)</CODE> as well as renaming it from <CODE>b</CODE> to
<CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 MODIFY a TINYINT NOT NULL, CHANGE b c CHAR(20);
</PRE>

<P>
To add a new <CODE>TIMESTAMP</CODE> column named <CODE>d</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD d TIMESTAMP;
</PRE>

<P>
To add indexes on column <CODE>d</CODE> and on column <CODE>a</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD INDEX (d), ADD INDEX (a);
</PRE>

<P>
To remove column <CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 DROP COLUMN c;
</PRE>

<P>
To add a new <CODE>AUTO_INCREMENT</CODE> integer column named <CODE>c</CODE>:

</P>

<PRE>
mysql&#62; ALTER TABLE t2 ADD c INT UNSIGNED NOT NULL AUTO_INCREMENT,
    -&#62;     ADD PRIMARY KEY (c);
</PRE>

<P>
Note that we indexed <CODE>c</CODE> (as a <CODE>PRIMARY KEY</CODE>), because
<CODE>AUTO_INCREMENT</CODE> columns must be indexed, and also that we declare
<CODE>c</CODE> as <CODE>NOT NULL</CODE>, because primary key columns cannot be
<CODE>NULL</CODE>.

</P>
<P>
When you add an <CODE>AUTO_INCREMENT</CODE> column, column values are filled in
with sequence numbers for you automatically.  For <CODE>MyISAM</CODE> tables,
you can set the first
sequence number by executing <CODE>SET INSERT_ID=value</CODE> before
<CODE>ALTER TABLE</CODE> or by using the <CODE>AUTO_INCREMENT=value</CODE> table option.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
With <CODE>MyISAM</CODE> tables, if you don't change the <CODE>AUTO_INCREMENT</CODE>
column, the sequence number will not be affected. If you drop an
<CODE>AUTO_INCREMENT</CODE> column and then add another <CODE>AUTO_INCREMENT</CODE>
column, the numbers are resequenced beginning with 1.

</P>
<P>
See section <A HREF="manual.html#ALTER_TABLE_problems">A.7.1  Problems with <CODE>ALTER TABLE</CODE></A>.

</P>



<H3><A NAME="CREATE_DATABASE" HREF="manual_toc.html#CREATE_DATABASE">14.2.3  <CODE>CREATE DATABASE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1624"></A>

</P>

<PRE>
CREATE DATABASE [IF NOT EXISTS] db_name
    [create_specification [, create_specification] ...]

create_specification:
    [DEFAULT] CHARACTER SET charset_name
  | [DEFAULT] COLLATE collation_name
</PRE>

<P>
<CODE>CREATE DATABASE</CODE> creates a database with the given name.  
To use <CODE>CREATE DATABASE</CODE>, you need the <CODE>CREATE</CODE> privilege on the
database.

</P>
<P>
Rules for
allowable database names are given in section <A HREF="manual.html#Legal_names">10.2  Database, Table, Index, Column, and Alias Names</A>.  An error occurs if
the database already exists and you didn't specify <CODE>IF NOT EXISTS</CODE>.

</P>
<P>
As of MySQL 4.1.1, <CODE>create_specification</CODE> options can be given to
specify database characteristics.  Database characteristics are stored in
the <TT>`db.opt'</TT> file in the database directory.  The <CODE>CHARACTER SET</CODE>
clause specifies the default database character set.  The <CODE>COLLATE</CODE>
clause specifies the default database collation.  Character set and
collation names are discussed in section <A HREF="manual.html#Charset">11  Character Set Support</A>.

</P>
<P>
Databases in MySQL are implemented as directories containing files
that correspond to tables in the database.  Because there are no tables in a
database when it is initially created, the <CODE>CREATE DATABASE</CODE> statement
only creates a directory under the MySQL data directory (and the <TT>`db.opt'</TT>
file, for MySQL 4.1.1 and up).

</P>
<P>
<A NAME="IDX1625"></A>
You can also use the <CODE>mysqladmin</CODE> program to create databases.
See section <A HREF="manual.html#mysqladmin">8.4  <CODE>mysqladmin</CODE>, Administering a MySQL Server</A>.

</P>



<H3><A NAME="CREATE_INDEX" HREF="manual_toc.html#CREATE_INDEX">14.2.4  <CODE>CREATE INDEX</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1626"></A>

</P>
<P>
<A NAME="IDX1627"></A>
<A NAME="IDX1628"></A>
<A NAME="IDX1629"></A>

</P>

<PRE>
CREATE [UNIQUE|FULLTEXT|SPATIAL] INDEX index_name [index_type]
    ON tbl_name (index_col_name,...)

index_col_name:
    col_name [(length)] [ASC | DESC]
</PRE>

<P>
In MySQL 3.22 or later, <CODE>CREATE INDEX</CODE> is mapped to an
<CODE>ALTER TABLE</CODE> statement to create indexes.
See section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.
The <CODE>CREATE INDEX</CODE> statement doesn't do anything prior
to MySQL 3.22.

</P>
<P>
Normally, you create all indexes on a table at the time the table itself
is created with <CODE>CREATE TABLE</CODE>.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.
<CODE>CREATE INDEX</CODE> allows you to add indexes to existing tables.

</P>
<P>
A column list of the form <CODE>(col1,col2,...)</CODE> creates a multiple-column
index.  Index values are formed by concatenating the values of the given
columns.

</P>
<P>
For <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns, indexes can be created that
use only part of a column, using <CODE>col_name(length)</CODE> syntax to index
a prefix consisting of the first <CODE>length</CODE> characters of each column
value. <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns also can be indexed, but a prefix
length <EM>must</EM> be given.

</P>
<P>
The statement shown here creates an index using the first 10 characters
of the <CODE>name</CODE> column:

</P>

<PRE>
CREATE INDEX part_of_name ON customer (name(10));
</PRE>

<P>
Because most names usually differ in the first 10 characters, this index should
not be much slower than an index created from the entire <CODE>name</CODE> column.
Also, using partial columns for indexes can make the index file much smaller,
which could save a lot of disk space and might also speed up <CODE>INSERT</CODE>
operations!

</P>
<P>
Prefixes can be up to 255 bytes long (or 1000 bytes for <CODE>MyISAM</CODE>
and <CODE>InnoDB</CODE> tables as of MySQL 4.1.2).  Note that prefix limits
are measured in bytes, whereas the prefix length in <CODE>CREATE INDEX</CODE>
statements is interpreted as number of characters.  Take this into account
when specifying a prefix length for a column that uses a multi-byte
character set.

</P>
<P>
Note that you can add an index on a column that can have <CODE>NULL</CODE>
values only if you are using MySQL 3.23.2 or newer and are using the
<CODE>MyISAM</CODE>, <CODE>InnoDB</CODE>, or <CODE>BDB</CODE> table type.  You can only add an
index on a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column if you are using
MySQL 3.23.2 or newer and are using the <CODE>MyISAM</CODE> or <CODE>BDB</CODE>
table type, or MySQL 4.0.14 or newer and the <CODE>InnoDB</CODE> table type.

</P>
<P>
An <CODE>index_col_name</CODE> specification can end with <CODE>ASC</CODE> or <CODE>DESC</CODE>.
These keywords are allowed for future extensions for specifying ascending
or descending index value storage.  Currently they are parsed but ignored;
index values are always stored in ascending order.

</P>
<P>
For more information about how MySQL uses indexes, see
section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A>.

</P>
<P>
<CODE>FULLTEXT</CODE> indexes can index only <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, and
<CODE>TEXT</CODE> columns, and only in <CODE>MyISAM</CODE> tables. <CODE>FULLTEXT</CODE> indexes
are available in MySQL 3.23.23 or later.
section <A HREF="manual.html#Fulltext_Search">13.6  Full-Text Search Functions</A>.

</P>
<P>
<CODE>SPATIAL</CODE> indexes can index only spatial columns,
and only in <CODE>MyISAM</CODE> tables. <CODE>SPATIAL</CODE> indexes
are available in MySQL 4.1 or later. Spatial column types are described in
section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.

</P>



<H3><A NAME="CREATE_TABLE" HREF="manual_toc.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1630"></A>

</P>


<PRE>
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name
    [(create_definition,...)]
    [table_options] [select_statement]
</PRE>

<P>
Or:

</P>

<PRE>
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name
    [(] LIKE old_tbl_name [)];

create_definition:
    column_definition
  | [CONSTRAINT [symbol]] PRIMARY KEY [index_type] (index_col_name,...)
  | KEY [index_name] [index_type] (index_col_name,...)
  | INDEX [index_name] [index_type] (index_col_name,...)
  | [CONSTRAINT [symbol]] UNIQUE [INDEX]
        [index_name] [index_type] (index_col_name,...)
  | [FULLTEXT|SPATIAL] [INDEX] [index_name] (index_col_name,...)
  | [CONSTRAINT [symbol]] FOREIGN KEY
        [index_name] (index_col_name,...) [reference_definition]
  | CHECK (expr)

column_definition:
    col_name type [NOT NULL | NULL] [DEFAULT default_value]
        [AUTO_INCREMENT] [[PRIMARY] KEY] [COMMENT 'string']
        [reference_definition]

type:
    TINYINT[(length)] [UNSIGNED] [ZEROFILL]
  | SMALLINT[(length)] [UNSIGNED] [ZEROFILL]
  | MEDIUMINT[(length)] [UNSIGNED] [ZEROFILL]
  | INT[(length)] [UNSIGNED] [ZEROFILL]
  | INTEGER[(length)] [UNSIGNED] [ZEROFILL]
  | BIGINT[(length)] [UNSIGNED] [ZEROFILL]
  | REAL[(length,decimals)] [UNSIGNED] [ZEROFILL]
  | DOUBLE[(length,decimals)] [UNSIGNED] [ZEROFILL]
  | FLOAT[(length,decimals)] [UNSIGNED] [ZEROFILL]
  | DECIMAL(length,decimals) [UNSIGNED] [ZEROFILL]
  | NUMERIC(length,decimals) [UNSIGNED] [ZEROFILL]
  | DATE
  | TIME
  | TIMESTAMP
  | DATETIME
  | CHAR(length) [BINARY | ASCII | UNICODE]
  | VARCHAR(length) [BINARY]
  | TINYBLOB
  | BLOB
  | MEDIUMBLOB
  | LONGBLOB
  | TINYTEXT
  | TEXT
  | MEDIUMTEXT
  | LONGTEXT
  | ENUM(value1,value2,value3,...)
  | SET(value1,value2,value3,...)
  | spatial_type

index_col_name:
    col_name [(length)] [ASC | DESC]

reference_definition:
    REFERENCES tbl_name [(index_col_name,...)]
               [MATCH FULL | MATCH PARTIAL]
               [ON DELETE reference_option]
               [ON UPDATE reference_option]

reference_option:
    RESTRICT | CASCADE | SET NULL | NO ACTION | SET DEFAULT

table_options: table_option [table_option] ...

table_option:
    {ENGINE|TYPE} = {BDB|HEAP|ISAM|InnoDB|MERGE|MRG_MYISAM|MYISAM}
  | AUTO_INCREMENT = value
  | AVG_ROW_LENGTH = value
  | CHECKSUM = {0 | 1}
  | COMMENT = 'string'
  | MAX_ROWS = value
  | MIN_ROWS = value
  | PACK_KEYS = {0 | 1 | DEFAULT}
  | PASSWORD = 'string'
  | DELAY_KEY_WRITE = {0 | 1}
  | ROW_FORMAT = { DEFAULT | DYNAMIC | FIXED | COMPRESSED }
  | RAID_TYPE = { 1 | STRIPED | RAID0 }
        RAID_CHUNKS = value
        RAID_CHUNKSIZE = value
  | UNION = (tbl_name[,tbl_name]...)
  | INSERT_METHOD = { NO | FIRST | LAST }
  | DATA DIRECTORY = 'absolute path to directory'
  | INDEX DIRECTORY = 'absolute path to directory'
  | [DEFAULT] CHARACTER SET charset_name [COLLATE collation_name]

select_statement:
    [IGNORE | REPLACE] [AS] SELECT ...   (Some legal select statement)
</PRE>

<P>
<CODE>CREATE TABLE</CODE> creates a table with the given name.
You must have the <CODE>CREATE</CODE> privilege for the table.

</P>
<P>
Rules for allowable table names are given in section <A HREF="manual.html#Legal_names">10.2  Database, Table, Index, Column, and Alias Names</A>.  
By default, the table is created in the current database.  
An error occurs if the table already exists, if there is no current database,
or if the database does not exist.

</P>
<P>
In MySQL 3.22 or later, the table name can be specified as
<CODE>db_name.tbl_name</CODE> to create the table in a specific database.
This works whether or not there is a current database.
If you use quoted identifiers, quote the database and table names
separately. For example, <CODE>`mydb`.`mytbl`</CODE> is legal, but
<CODE>`mydb.mytbl`</CODE> is not.

</P>
<P>
From MySQL 3.23 on, you can use the <CODE>TEMPORARY</CODE> keyword when
creating a table. A <CODE>TEMPORARY</CODE> table is visible only to the
current connection, and is dropped automatically when the
connection is closed.  This means that two different
connections can use the same temporary table name without conflicting
with each other or with an existing non-<CODE>TEMPORARY</CODE> table of the same
name. (The existing table is hidden until the temporary table is dropped.)
From MySQL 4.0.2 on, you must have the <CODE>CREATE TEMPORARY TABLES</CODE>
privilege to be able to create temporary tables.

</P>
<P>
In MySQL 3.23 or later, you can use the keywords
<CODE>IF NOT EXISTS</CODE> so that an error does not occur if the table already
exists.  Note that there is no verification that the existing table has a
structure identical to that indicated by the <CODE>CREATE TABLE</CODE> statement.

</P>
<P>
MySQL represents each table by an <TT>`.frm'</TT> table format
(definition) file in the database directory. The storage engine for the table
might create other files as well.
In the case of <CODE>MyISAM</CODE> tables, the storage engine creates three files
for a table named <CODE>tbl_name</CODE>:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>File</STRONG> </TD><TD> <STRONG>Purpose</STRONG>
</TD></TR>
<TR><TD><CODE>tbl_name.frm</CODE> </TD><TD> Table format (definition) file
</TD></TR>
<TR><TD><CODE>tbl_name.MYD</CODE> </TD><TD> Data file
</TD></TR>
<TR><TD><CODE>tbl_name.MYI</CODE> </TD><TD> Index file
</TD></TR>
</TABLE>

<P>
The files created by each storage engine to represent tables are described in
section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
For general information on the properties of the various column types, see
section <A HREF="manual.html#Column_types">12  Column Types</A>.
For information about spatial column types, see
section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.

</P>

<UL>
<LI>

If neither <CODE>NULL</CODE> nor <CODE>NOT NULL</CODE> is specified, the column
is treated as though <CODE>NULL</CODE> had been specified.

<LI>

An integer column can have the additional attribute <CODE>AUTO_INCREMENT</CODE>.
When you insert a value of <CODE>NULL</CODE> (recommended) or <CODE>0</CODE> into an
indexed
<CODE>AUTO_INCREMENT</CODE> column, the column is set to the next sequence value.
Typically this is <CODE>value+1</CODE>, where
<CODE>value</CODE> is the largest value for the column currently in the table.
<CODE>AUTO_INCREMENT</CODE> sequences begin with <CODE>1</CODE>.
See section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

As of MySQL 4.1.1, specifying the <CODE>NO_AUTO_VALUE_ON_ZERO</CODE> flag for the
<CODE>--sql-mode</CODE> server option or the <CODE>sql_mode</CODE> system variable allows
you to store <CODE>0</CODE> in <CODE>AUTO_INCREMENT</CODE> columns as <CODE>0</CODE> without
generating a new sequence value.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

<STRONG>Note:</STRONG> There can be only one <CODE>AUTO_INCREMENT</CODE> column per
table, it must be indexed, and it cannot have a <CODE>DEFAULT</CODE> value.
As of MySQL 3.23, an <CODE>AUTO_INCREMENT</CODE> column will work properly
only if it contains only positive values. Inserting a
negative number is regarded as inserting a very large positive number.
This is done to avoid precision problems when numbers ``wrap'' over from
positive to negative and also to ensure that you don't accidentally
get an <CODE>AUTO_INCREMENT</CODE> column that contains <CODE>0</CODE>.

For <CODE>MyISAM</CODE> and <CODE>BDB</CODE> tables, you can specify an
<CODE>AUTO_INCREMENT</CODE> secondary column in a multiple-column key.
See section <A HREF="manual.html#example-AUTO_INCREMENT">3.6.9  Using <CODE>AUTO_INCREMENT</CODE></A>.

<A NAME="IDX1631"></A>
<A NAME="IDX1632"></A>
To make MySQL compatible with some ODBC applications, you can find the
<CODE>AUTO_INCREMENT</CODE> value for the last inserted row with the following query:


<PRE>
SELECT * FROM tbl_name WHERE auto_col IS NULL
</PRE>

<LI>

As of MySQL 4.1, character column definitions can include a <CODE>CHARACTER
SET</CODE> attribute to specify the character set and, optionally, a collation
for the column. For details, see section <A HREF="manual.html#Charset">11  Character Set Support</A>.


<PRE>
CREATE TABLE t (c CHAR(20) CHARACTER SET utf8 COLLATE utf8_bin);
</PRE>

Also as of 4.1, MySQL interprets length specifications in character column
definitions in characters. (Earlier versions interpret them in bytes.)

<LI>

<CODE>NULL</CODE> values are handled differently for <CODE>TIMESTAMP</CODE> columns than
for other column types.  You cannot store a literal <CODE>NULL</CODE> in a
<CODE>TIMESTAMP</CODE> column; setting the column to <CODE>NULL</CODE> sets it to the
current date and time.  Because <CODE>TIMESTAMP</CODE> columns behave this way, the
<CODE>NULL</CODE> and <CODE>NOT NULL</CODE> attributes do not apply in the normal way and
are ignored if you specify them.

On the other hand, to make it easier for MySQL clients to use
<CODE>TIMESTAMP</CODE> columns, the server reports that such columns can be
assigned <CODE>NULL</CODE> values (which is true), even though <CODE>TIMESTAMP</CODE>
never actually will contain a <CODE>NULL</CODE> value.  You can see this when you
use <CODE>DESCRIBE tbl_name</CODE> to get a description of your table.

Note that setting a <CODE>TIMESTAMP</CODE> column to <CODE>0</CODE> is not the same
as setting it to <CODE>NULL</CODE>, because <CODE>0</CODE> is a valid <CODE>TIMESTAMP</CODE>
value.

<LI>

<A NAME="IDX1633"></A>
A <CODE>DEFAULT</CODE> value must be a constant; it cannot be a function or
an expression.  This means, for example, that you cannot
set the default for a date column to be the value of a function such as
<CODE>NOW()</CODE> or <CODE>CURRENT_DATE</CODE>.

If no <CODE>DEFAULT</CODE> value is specified for a column, MySQL
automatically assigns one, as follows.

If the column can take <CODE>NULL</CODE> as a value, the default value is
<CODE>NULL</CODE>.

If the column is declared as <CODE>NOT NULL</CODE>, the default value depends on
the column type:


<UL>
<LI>

For numeric types other than those declared with the <CODE>AUTO_INCREMENT</CODE>
attribute, the default is <CODE>0</CODE>.  For an <CODE>AUTO_INCREMENT</CODE> column, the
default value is the next value in the sequence.

<LI>

For date and time types other than <CODE>TIMESTAMP</CODE>, the default is the
appropriate ``zero'' value for the type.  For the first <CODE>TIMESTAMP</CODE>
column in a table, the default value is the current date and time.
See section <A HREF="manual.html#Date_and_time_types">12.3  Date and Time Types</A>.

<LI>

For string types other than <CODE>ENUM</CODE>, the default value is the empty
string.  For <CODE>ENUM</CODE>, the default is the first enumeration value.
</UL>

<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns cannot be assigned a default value.

<LI>

<A NAME="IDX1634"></A>
A comment for a column can be specified with the <CODE>COMMENT</CODE> option.
The comment is displayed by the
<CODE>SHOW CREATE TABLE</CODE> and <CODE>SHOW FULL COLUMNS</CODE> statements.
This option is operational as of MySQL 4.1.
(It is allowed but ignored in earlier versions.)

<LI>

From MySQL 4.1.0 on, the attribute <CODE>SERIAL</CODE> can be used as an alias
for <CODE>BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE</CODE>. This is a
compatibility feature.

<LI>

<CODE>KEY</CODE> is normally a synonym for <CODE>INDEX</CODE>.  From MySQL 4.1, the key
attribute <CODE>PRIMARY KEY</CODE> can also be specified as just <CODE>KEY</CODE> when
given in a column definition. This was implemented for compatibility with
other database systems.

<LI>

In MySQL, a <CODE>UNIQUE</CODE> index is one in which all values in the index
must be distinct.  An error occurs if you try to add a new row with a key
that matches an existing row.  The exception to this is that if a column
in the index is allowed to contain <CODE>NULL</CODE> values, it can contain
multiple <CODE>NULL</CODE> values.  This exception does not apply to <CODE>BDB</CODE>
tables, for which indexed columns allow only a single <CODE>NULL</CODE>.

<LI>

<A NAME="IDX1635"></A>
A <CODE>PRIMARY KEY</CODE> is a unique <CODE>KEY</CODE> where all key columns must be
defined as <CODE>NOT NULL</CODE>. If they are not explicitly declared as <CODE>NOT
NULL</CODE>, MySQL will declare them so implicitly (and silently).  A table can
have only one <CODE>PRIMARY KEY</CODE>.  If you don't have a <CODE>PRIMARY KEY</CODE>
and an application asks for the <CODE>PRIMARY KEY</CODE> in your tables, MySQL
returns the first <CODE>UNIQUE</CODE> index that has no <CODE>NULL</CODE> columns as
the <CODE>PRIMARY KEY</CODE>.

<LI>

In the created table, a <CODE>PRIMARY KEY</CODE> is placed first, followed
by all <CODE>UNIQUE</CODE> indexes, and then the non-unique indexes.  This helps the
MySQL optimizer to prioritize which index to use and also more quickly
to detect duplicated <CODE>UNIQUE</CODE> keys.

<LI>

A <CODE>PRIMARY KEY</CODE> can be a multiple-column index.  However, you cannot
create a multiple-column index using the <CODE>PRIMARY KEY</CODE> key attribute in a
column specification.  Doing so will mark only that single column as primary.
You must use a separate <CODE>PRIMARY KEY(index_col_name, ...)</CODE> clause.

<LI>

If a <CODE>PRIMARY KEY</CODE> or <CODE>UNIQUE</CODE> index consists of only one column
that has an integer type, you can also refer to the column as <CODE>_rowid</CODE>
in <CODE>SELECT</CODE> statements (new in MySQL 3.23.11).

<LI>

In MySQL, the name of a <CODE>PRIMARY KEY</CODE> is <CODE>PRIMARY</CODE>.  For other
indexes, if you don't assign a name, the index is assigned the same name as
the first indexed column, with an optional suffix (<CODE>_2</CODE>, <CODE>_3</CODE>,
<CODE>...</CODE>) to make it unique.  You can see index names for a table using
<CODE>SHOW INDEX FROM tbl_name</CODE>.
See section <A HREF="manual.html#Show_database_info">14.5.3.7  <CODE>SHOW DATABASES</CODE> Syntax</A>.

<LI>

From MySQL 4.1.0 on, some storage engines allow you to specify an index
type when creating an index.  The syntax for the <CODE>index_type</CODE>
specifier is <CODE>USING type_name</CODE>. The allowable <CODE>type_name</CODE>
values supported by different storage engines are shown in the following
table. Where multiple index types are listed, the first one is the
default when no <CODE>index_type</CODE> specifier is given.

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Storage Engine</STRONG> </TD><TD> <STRONG>Allowable Index Types</STRONG>
</TD></TR>
<TR><TD><CODE>MyISAM</CODE> </TD><TD> <CODE>BTREE</CODE>
</TD></TR>
<TR><TD><CODE>InnoDB</CODE> </TD><TD> <CODE>BTREE</CODE>
</TD></TR>
<TR><TD><CODE>MEMORY/HEAP</CODE> </TD><TD> <CODE>HASH</CODE>, <CODE>BTREE</CODE>
</TD></TR>
</TABLE>

Example:


<PRE>
CREATE TABLE lookup
    (id INT, INDEX USING BTREE (id))
    ENGINE = MEMORY;
</PRE>

<CODE>TYPE type_name</CODE> can be used as a synonym for <CODE>USING type_name</CODE>
to specify an index type.  However, <CODE>USING</CODE> is the preferred form.
Also, the index name name that precedes the index type in the index
specification syntax is not optional with <CODE>TYPE</CODE>. This is because,
unlike <CODE>USING</CODE>, <CODE>TYPE</CODE> is not a reserved word and thus is
interpreted as an index name.

If you specify an index type that is not legal for a storage engine,
but there is another index type available that the engine can use without
affecting query results, the engine will use the available type.

<LI>

<A NAME="IDX1636"></A>
<A NAME="IDX1637"></A>
Only the <CODE>MyISAM</CODE>, <CODE>InnoDB</CODE>, <CODE>BDB</CODE>, and (as of MySQL 4.0.2)
<CODE>MEMORY</CODE> storage engines support indexes on columns that can have
<CODE>NULL</CODE> values. In other cases, you must declare indexed columns
as <CODE>NOT NULL</CODE> or an error results.

<LI>

With <CODE>col_name(length)</CODE> syntax in an index specification, you can create
an index that uses only the first <CODE>length</CODE> characters of a <CODE>CHAR</CODE>
or <CODE>VARCHAR</CODE> column. Indexing only a prefix of column values like this
can make the index file much smaller.
See section <A HREF="manual.html#Indexes">7.4.3  Column Indexes</A>.

<A NAME="IDX1638"></A>
<A NAME="IDX1639"></A>
<A NAME="IDX1640"></A>
<A NAME="IDX1641"></A>
The <CODE>MyISAM</CODE> and (as of MySQL 4.0.14) <CODE>InnoDB</CODE> table types also
support indexing on <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns.  When indexing
a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column, you <EM>must</EM> specify a prefix
length for the index. For example:


<PRE>
CREATE TABLE test (blob_col BLOB, INDEX(blob_col(10)));
</PRE>

Prefixes can be up to 255 bytes long (or 1000 bytes for <CODE>MyISAM</CODE>
and <CODE>InnoDB</CODE> tables as of MySQL 4.1.2).  Note that prefix limits
are measured in bytes, whereas the prefix length in <CODE>CREATE TABLE</CODE>
statements is interpreted as number of characters.  Take this into account
when specifying a prefix length for a column that uses a multi-byte
character set.

<LI>

An <CODE>index_col_name</CODE> specification can end with <CODE>ASC</CODE> or <CODE>DESC</CODE>.
These keywords are allowed for future extensions for specifying ascending
or descending index value storage.  Currently they are parsed but ignored;
index values are always stored in ascending order.

<LI>

When you use <CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE> with a <CODE>TEXT</CODE> or
<CODE>BLOB</CODE> column, the server sorts values using only the initial number of
bytes indicated by the <CODE>max_sort_length</CODE> system variable.
See section <A HREF="manual.html#BLOB">12.4.2  The <CODE>BLOB</CODE> and <CODE>TEXT</CODE> Types</A>.

<LI>

In MySQL 3.23.23 or later, you can create special
<CODE>FULLTEXT</CODE> indexes. They are used for full-text search. Only the
<CODE>MyISAM</CODE> table type supports <CODE>FULLTEXT</CODE> indexes. They can be created
only from <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, and <CODE>TEXT</CODE> columns.
Indexing always happens over the entire column; partial indexing is not
supported and any prefix length is ignored if specified. See section <A HREF="manual.html#Fulltext_Search">13.6  Full-Text Search Functions</A> for details of operation.

<LI>

In MySQL 4.1 or later, you can create special <CODE>SPATIAL</CODE> indexes on
spatial column types. Spatial types are supported only for <CODE>MyISAM</CODE>
tables and indexed columns must be declared as <CODE>NOT NULL</CODE>.  See
section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.

<LI>

In MySQL 3.23.44 or later, <CODE>InnoDB</CODE> tables support checking of
foreign key constraints. See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>. Note that the
<CODE>FOREIGN KEY</CODE> syntax in <CODE>InnoDB</CODE> is more restrictive than
the syntax presented for the <CODE>CREATE TABLE</CODE> statement at the beginning of
this section: The columns of the referenced
table must always be explicitly named.
<CODE>InnoDB</CODE> supports both <CODE>ON DELETE</CODE> and <CODE>ON UPDATE</CODE>
actions on foreign keys as of MySQL 3.23.50 and 4.0.8, respectively.
For the precise syntax, see
section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.

For other storage engines, MySQL Server parses the <CODE>FOREIGN KEY</CODE>
and <CODE>REFERENCES</CODE> syntax in <CODE>CREATE TABLE</CODE> statements,
but without further action being taken.
The <CODE>CHECK</CODE> clause is parsed and ignored for all storage engines.
 See section <A HREF="manual.html#ANSI_diff_Foreign_Keys">1.8.5.5  Foreign Keys</A>.

<LI>

For <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables,
each <CODE>NULL</CODE> column takes one bit extra, rounded up to the nearest byte.
The maximum record length in bytes can be calculated as follows:


<PRE>
row length = 1
             + (sum of column lengths)
             + (number of NULL columns + delete_flag + 7)/8
             + (number of variable-length columns)
</PRE>

<CODE>delete_flag</CODE> is 1 for tables with static record format. Static
tables use a bit in the row record for a flag that indicates whether
the row has been deleted.  <CODE>delete_flag</CODE> is 0 for dynamic tables
because the flag is stored in the dynamic row header.

These calculations do not apply for <CODE>InnoDB</CODE> tables, for which
storage size is no different for <CODE>NULL</CODE> columns than for <CODE>NOT
NULL</CODE> columns.

</UL>

<P>
The <CODE>table_options</CODE> part of the <CODE>CREATE TABLE</CODE> syntax can be used
in MySQL 3.23 and above.

</P>
<P>
The <CODE>ENGINE</CODE> and <CODE>TYPE</CODE> options specify the storage engine for the
table.  <CODE>ENGINE</CODE> was added in MySQL 4.0.18 (for 4.0) and 4.1.2 (for 4.1).
It is the preferred option name as of those versions, and <CODE>TYPE</CODE> has
become deprecated.  <CODE>TYPE</CODE> will be supported throughout the 4.x series,
but likely will be removed in MySQL 5.1.

</P>
<P>
The <CODE>ENGINE</CODE> and <CODE>TYPE</CODE> options take the following values:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Storage Engine</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>BDB</CODE> </TD><TD> Transaction-safe tables with page locking. See section <A HREF="manual.html#BDB">15.4  The <CODE>BDB</CODE> (<CODE>BerkeleyDB</CODE>) Storage Engine</A>.
</TD></TR>
<TR><TD><CODE>BerkeleyDB</CODE> </TD><TD> An alias for <CODE>BDB</CODE>.
</TD></TR>
<TR><TD><CODE>HEAP</CODE> </TD><TD> The data for this table is only stored in memory.  See section <A HREF="manual.html#HEAP">15.3  The <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) Storage Engine</A>.
</TD></TR>
<TR><TD><CODE>ISAM</CODE> </TD><TD> The original MySQL storage engine. See section <A HREF="manual.html#ISAM">15.5  The <CODE>ISAM</CODE> Storage Engine</A>.
</TD></TR>
<TR><TD><CODE>InnoDB</CODE> </TD><TD> Transaction-safe tables with row locking.  See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.
</TD></TR>
<TR><TD><CODE>MEMORY</CODE> </TD><TD> An alias for <CODE>HEAP</CODE>. (Actually, as of MySQL 4.1, <CODE>MEMORY</CODE> is the preferred term.)
</TD></TR>
<TR><TD><CODE>MERGE</CODE> </TD><TD> A collection of <CODE>MyISAM</CODE> tables used as one table. See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.
</TD></TR>
<TR><TD><CODE>MRG_MyISAM</CODE> </TD><TD> An alias for <CODE>MERGE</CODE>.
</TD></TR>
<TR><TD><CODE>MyISAM</CODE> </TD><TD> The binary portable storage engine that is the improved replacement for <CODE>ISAM</CODE>. See section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.
</TD></TR>
</TABLE>

<P>
See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

</P>
<P>
If a storage engine is specified that is not available,
MySQL uses <CODE>MyISAM</CODE> instead.
For example, if a table definition includes the <CODE>ENGINE=BDB</CODE> option but the
MySQL server does not support <CODE>BDB</CODE> tables, the table is created
as a <CODE>MyISAM</CODE> table.  This makes it possible to have a replication
setup where you have transactional tables on the master but tables created
on the slave are non-transactional (to get more speed).  In MySQL 4.1.1, a
warning occurs if the storage engine specification is not honored.

</P>
<P>
The other table options are used to optimize the behavior of the
table. In most cases, you don't have to specify any of them.
The options work for all storage engines unless otherwise indicated:

</P>
<DL COMPACT>

<DT><CODE>AUTO_INCREMENT</CODE>
<DD>
The initial <CODE>AUTO_INCREMENT</CODE> value for the table. This works for
<CODE>MyISAM</CODE> only. To set the first auto-increment value for an <CODE>InnoDB</CODE>
table, insert a dummy row with a value one less than the desired value after
creating the table, and then delete the dummy row.

<DT><CODE>AVG_ROW_LENGTH</CODE>
<DD>
An approximation of the average row length for your table. You need to
set this only for large tables with variable-size records.

When you create a <CODE>MyISAM</CODE> table, MySQL uses the product of the
<CODE>MAX_ROWS</CODE> and <CODE>AVG_ROW_LENGTH</CODE> options to decide how big the
resulting table will be.  If you don't specify either option, the maximum
size for a table will be 4GB (or 2GB if your operating system only supports
2GB tables). The reason for this is just to keep down the pointer sizes to
make the index smaller and faster if you don't really need big files.  If
you want all your tables to be able to grow above the 4GB limit and are
willing to have your smaller tables slightly slower and larger than
necessary, you may increase the default pointer size by setting the
<CODE>myisam_data_pointer_size</CODE> system variable, which was added in MySQL
4.1.2.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

<DT><CODE>CHECKSUM</CODE>
<DD>
Set this to 1 if you want MySQL to maintain a live checksum for all rows
(that is, a checksum that MySQL updates automatically as the table changes).
This makes the table a little slower to update, but also makes it easier to
find corrupted tables.  The <CODE>CHECKSUM TABLE</CODE> statement reports the
checksum.  (<CODE>MyISAM</CODE> only.)

<DT><CODE>COMMENT</CODE>
<DD>
A comment for your table, up to 60 characters long.

<DT><CODE>MAX_ROWS</CODE>
<DD>
The maximum number of rows you plan to store in the table.

<DT><CODE>MIN_ROWS</CODE>
<DD>
The minimum number of rows you plan to store in the table.

<DT><CODE>PACK_KEYS</CODE>
<DD>
Set this option to 1 if you want to have smaller indexes.  This usually
makes updates slower and reads faster.
Setting the option to 0 disables all packing of keys. Setting it to
<CODE>DEFAULT</CODE> (MySQL 4.0) tells the storage engine to only pack long
<CODE>CHAR</CODE>/<CODE>VARCHAR</CODE> columns.
(<CODE>MyISAM</CODE> and <CODE>ISAM</CODE> only.)

If you don't use <CODE>PACK_KEYS</CODE>, the default is to only pack strings,
not numbers.  If you use <CODE>PACK_KEYS=1</CODE>, numbers will be packed as well.

When packing binary number keys, MySQL uses prefix compression:


<UL>
<LI>

Every key needs one extra byte to indicate how many bytes of the previous
key are the same for the next key.

<LI>

The pointer to the row is stored in high-byte-first order directly after
the key, to improve compression.

</UL>

This means that if you have many equal keys on two consecutive rows,
all following ``same'' keys will usually only take two bytes (including the
pointer to the row).  Compare this to the ordinary case where the following
keys will take <CODE>storage_size_for_key + pointer_size</CODE> (where the pointer
size is usually 4). Conversely,
you will get a big benefit from prefix compression only if you have many
numbers that are the same.  If all keys are totally different, you will
use one byte more per key, if the key isn't a key that can have <CODE>NULL</CODE>
values. (In this case, the packed key length will be stored in the same
byte that is used to mark if a key is <CODE>NULL</CODE>.)

<DT><CODE>PASSWORD</CODE>
<DD>
Encrypt the <TT>`.frm'</TT> file with a password.  This option doesn't do anything in the standard MySQL version.

<DT><CODE>DELAY_KEY_WRITE</CODE>
<DD>
Set this to 1 if you want to delay key updates for the table until the table
is closed. (<CODE>MyISAM</CODE> only.)

<DT><CODE>ROW_FORMAT</CODE>
<DD>
Defines how the rows should be stored. Currently this option works only with
<CODE>MyISAM</CODE> tables. The option value can <CODE>FIXED</CODE> or <CODE>DYNAMIC</CODE> for
static or variable-length row format. <CODE>myisampack</CODE> sets the type to
<CODE>COMPRESSED</CODE>.
See section <A HREF="manual.html#MyISAM_table_formats">15.1.3  <CODE>MyISAM</CODE> Table Storage Formats</A>.

<DT><CODE>RAID_TYPE</CODE>
<DD>
<A NAME="IDX1642"></A>
<A NAME="IDX1643"></A>
The <CODE>RAID_TYPE</CODE> option can help you to exceed the 2GB/4GB limit for
the <CODE>MyISAM</CODE> data file (not the index file) on operating systems that
don't support big files. This option is unnecessary and not recommended for
filesystems that support big files.

You can get more speed from the I/O bottleneck by putting <CODE>RAID</CODE>
directories on different physical disks.  For now, the only allowed
<CODE>RAID_TYPE</CODE> is <CODE>STRIPED</CODE>. <CODE>1</CODE> and <CODE>RAID0</CODE> are aliases
for <CODE>STRIPED</CODE>.

If you specify the <CODE>RAID_TYPE</CODE> option for a <CODE>MyISAM</CODE> table,
specify the <CODE>RAID_CHUNKS</CODE> and <CODE>RAID_CHUNKSIZE</CODE> options as well.
The maximum <CODE>RAID_CHUNKS</CODE> value is 255.
<CODE>MyISAM</CODE> will create <CODE>RAID_CHUNKS</CODE> subdirectories named <TT>`00'</TT>,
<TT>`01'</TT>, <TT>`02'</TT>, ... <TT>`09'</TT>, <TT>`0a'</TT>, <TT>`0b'</TT>, ...
in the database directory.  In each of these directories, <CODE>MyISAM</CODE>
will create a file <TT>`tbl_name.MYD'</TT>.  When writing data to the data file,
the <CODE>RAID</CODE> handler maps the first <CODE>RAID_CHUNKSIZE*1024</CODE> bytes to
the first file, the next <CODE>RAID_CHUNKSIZE*1024</CODE> bytes to the next file,
and so on.

<CODE>RAID_TYPE</CODE> works on any operating system, as long as you have built
MySQL with the <CODE>--with-raid</CODE> option to <CODE>configure</CODE>. To determine
whether a server supports <CODE>RAID</CODE> tables, use <CODE>SHOW VARIABLES LIKE
'have_raid'</CODE> to see whether the variable value is <CODE>YES</CODE>.

<DT><CODE>UNION</CODE>
<DD>
<CODE>UNION</CODE> is used when you want to use a collection of identical
tables as one. This works only with <CODE>MERGE</CODE> tables.
See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.

For the moment, you must have <CODE>SELECT</CODE>, <CODE>UPDATE</CODE>, and
<CODE>DELETE</CODE> privileges for the tables you map to a <CODE>MERGE</CODE> table.
Originally, all used tables had to be in the same database
as the <CODE>MERGE</CODE> table itself. This restriction has been lifted as of
MySQL 4.1.1.

<DT><CODE>INSERT_METHOD</CODE>
<DD>
If you want to insert data in a <CODE>MERGE</CODE> table, you have to specify with
<CODE>INSERT_METHOD</CODE> into which table the row should be inserted.
<CODE>INSERT_METHOD</CODE> is an option useful for <CODE>MERGE</CODE> tables only. 
This option was introduced in MySQL 4.0.0.
See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.

<DT><CODE>DATA DIRECTORY</CODE>
<DD>
<DT><CODE>INDEX DIRECTORY</CODE>
<DD>
By using <CODE>DATA DIRECTORY='directory'</CODE> or <CODE>INDEX
DIRECTORY='directory'</CODE> you can specify where the <CODE>MyISAM</CODE> storage engine should
put a table's data file and index file.  Note that the directory should be a full
path to the directory (not a relative path).

These options work only for <CODE>MyISAM</CODE> tables from MySQL 4.0 on, when
you are not using the <CODE>--skip-symlink</CODE> option. Your operating system
must also have a working, thread-safe <CODE>realpath()</CODE> call.
See section <A HREF="manual.html#Symbolic_links_to_tables">7.6.1.2  Using Symbolic Links for Tables on Unix</A>.

</DL>

<P>
<A NAME="IDX1644"></A>
<A NAME="IDX1645"></A>

</P>
<P>
As of MySQL 3.23, you can create one table from another by adding a
<CODE>SELECT</CODE> statement at the end of the <CODE>CREATE TABLE</CODE> statement:

</P>

<PRE>
CREATE TABLE new_tbl SELECT * FROM orig_tbl;
</PRE>

<P>
MySQL will create new column for all elements
in the <CODE>SELECT</CODE>.  For example:

</P>

<PRE>
mysql&#62; CREATE TABLE test (a INT NOT NULL AUTO_INCREMENT,
    -&#62;        PRIMARY KEY (a), KEY(b))
    -&#62;        TYPE=MyISAM SELECT b,c FROM test2;
</PRE>

<P>
This creates a <CODE>MyISAM</CODE> table with three columns, <CODE>a</CODE>, <CODE>b</CODE>,
and <CODE>c</CODE>.  Notice that the columns from the <CODE>SELECT</CODE> statement
are appended to the right side of the table, not overlapped onto it.
Take the following example:

</P>

<PRE>
mysql&#62; SELECT * FROM foo;
+---+
| n |
+---+
| 1 |
+---+

mysql&#62; CREATE TABLE bar (m INT) SELECT n FROM foo;
Query OK, 1 row affected (0.02 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&#62; SELECT * FROM bar;
+------+---+
| m    | n |
+------+---+
| NULL | 1 |
+------+---+
1 row in set (0.00 sec)
</PRE>

<P>
For each row in table <CODE>foo</CODE>, a row is inserted in <CODE>bar</CODE> with
the values from <CODE>foo</CODE> and default values for the new columns.

</P>
<P>
If any errors occur while copying the data to the table, it is
automatically dropped and not created.

</P>
<P>
<CODE>CREATE TABLE ... SELECT</CODE> will not automatically create any indexes
for you.  This is done intentionally to make the statement as flexible as
possible.  If you want to have indexes in the created table, you should
specify these before the <CODE>SELECT</CODE> statement:

</P>

<PRE>
mysql&#62; CREATE TABLE bar (UNIQUE (n)) SELECT n FROM foo;
</PRE>

<P>
Some conversion of column types might occur. For example, the
<CODE>AUTO_INCREMENT</CODE> attribute is not preserved, and <CODE>VARCHAR</CODE>
columns can become <CODE>CHAR</CODE> columns.

</P>
<P>
When creating a table with <CODE>CREATE ... SELECT</CODE>, make sure to alias any
function calls or expressions in the query. If you do not, the <CODE>CREATE</CODE>
statement might fail or result in undesirable column names.

</P>

<PRE>
CREATE TABLE artists_and_works
SELECT artist.name, COUNT(work.artist_id) AS number_of_works
FROM artist LEFT JOIN work ON artist.id = work.artist_id
GROUP BY artist.id;
</PRE>

<P>
As of MySQL 4.1, you can explicitly specify the type for a generated column:

</P>

<PRE>
CREATE TABLE foo (a TINYINT NOT NULL) SELECT b+1 AS a FROM bar;
</PRE>

<P>
In MySQL 4.1, you can also use <CODE>LIKE</CODE> to create a table based on the
definition of another table, including any column attributes and
indexes the original table has:

</P>

<PRE>
CREATE TABLE new_tbl LIKE orig_tbl;
</PRE>

<P>
<CODE>CREATE TABLE ... LIKE</CODE> does not copy any <CODE>DATA DIRECTORY</CODE> or
<CODE>INDEX DIRECTORY</CODE> table options that were specified for the original
table.

</P>
<P>
You can precede the <CODE>SELECT</CODE> by <CODE>IGNORE</CODE> or <CODE>REPLACE</CODE>
to indicate how to handle records that duplicate unique key values.
With <CODE>IGNORE</CODE>, new records that duplicate an existing record on a
unique key value are discarded.  With <CODE>REPLACE</CODE>, new records replace
records that have the same unique key value.  If neither <CODE>IGNORE</CODE>
nor <CODE>REPLACE</CODE> is specified, duplicate unique key values result in
an error.

</P>
<P>
To ensure that the update log/binary log can be used to re-create the
original tables, MySQL will not allow concurrent inserts during
<CODE>CREATE TABLE ... SELECT</CODE>.

</P>



<H4><A NAME="Silent_column_changes" HREF="manual_toc.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A></H4>

<P>
<A NAME="IDX1646"></A>

</P>
<P>
In some cases, MySQL silently changes column specifications from
those given in a <CODE>CREATE TABLE</CODE> or <CODE>ALTER TABLE</CODE> statement:

</P>

<UL>
<LI>

<CODE>VARCHAR</CODE> columns with a length less than four are changed to
<CODE>CHAR</CODE>.

<LI>

If any column in a table has a variable length, the entire row becomes
variable-length as a result.  Therefore, if a table contains any
variable-length columns (<CODE>VARCHAR</CODE>, <CODE>TEXT</CODE>, or <CODE>BLOB</CODE>),
all <CODE>CHAR</CODE> columns longer than three characters are changed to
<CODE>VARCHAR</CODE> columns.  This doesn't affect how you use the columns in
any way; in MySQL, <CODE>VARCHAR</CODE> is just a different way to
store characters.  MySQL performs this conversion because it
saves space and makes table operations faster.  See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<LI>

From MySQL 4.1.0 on, a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column with a
length specification greater than 255 is converted to the smallest <CODE>TEXT</CODE>
type that can hold values of the given length.
For example, <CODE>VARCHAR(500)</CODE> is converted to <CODE>TEXT</CODE>, and
<CODE>VARCHAR(200000)</CODE> is converted to <CODE>MEDIUMTEXT</CODE>.
This is a compatibility feature.

<LI>

<CODE>TIMESTAMP</CODE> display sizes are discarded from MySQL 4.1 on, due
to changes made to the <CODE>TIMESTAMP</CODE> column type in that version.
Before MySQL 4.1, <CODE>TIMESTAMP</CODE> display sizes must be even and in the
range from 2 to 14.  If you specify a display size of 0 or greater than
14, the size is coerced to 14.  Odd-valued sizes in the range from 1 to
13 are coerced to the next higher even number.

<LI>

You cannot store a literal <CODE>NULL</CODE> in a <CODE>TIMESTAMP</CODE> column; setting
it to <CODE>NULL</CODE> sets it to the current date and time.  Because
<CODE>TIMESTAMP</CODE> columns behave this way, the <CODE>NULL</CODE> and <CODE>NOT NULL</CODE>
attributes do not apply in the normal way and are ignored if you specify
them.  <CODE>DESCRIBE tbl_name</CODE> always reports that a <CODE>TIMESTAMP</CODE>
column can be assigned <CODE>NULL</CODE> values.

<LI>

Columns that are part of a <CODE>PRIMARY KEY</CODE> are made <CODE>NOT NULL</CODE> even if
not declared that way.

<LI>

Starting from MySQL 3.23.51, trailing spaces are automatically deleted from
<CODE>ENUM</CODE> and <CODE>SET</CODE> values when the table is created.

<LI>

MySQL maps certain column types used by other SQL database vendors
to MySQL types.  See section <A HREF="manual.html#Other-vendor_column_types">12.7  Using Column Types from Other Database Engines</A>.

<LI>

If you include a <CODE>USING</CODE> clause to specify an index type that is not
legal for a storage engine, but there is another index type available that
the engine can use without affecting query results, the engine will use the
available type.

</UL>

<P>
To see whether MySQL used a column type other
than the one you specified, issue a <CODE>DESCRIBE</CODE> or <CODE>SHOW
CREATE TABLE</CODE> statement after creating or altering your table.

</P>
<P>
<A NAME="IDX1647"></A>
Certain other column type changes can occur if you compress a table
using <CODE>myisampack</CODE>. See section <A HREF="manual.html#Compressed_format">15.1.3.3  Compressed Table Characteristics</A>.

</P>



<H3><A NAME="DROP_DATABASE" HREF="manual_toc.html#DROP_DATABASE">14.2.6  <CODE>DROP DATABASE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1648"></A>
<A NAME="IDX1649"></A>
<A NAME="IDX1650"></A>

</P>

<PRE>
DROP DATABASE [IF EXISTS] db_name
</PRE>

<P>
<CODE>DROP DATABASE</CODE> drops all tables in the database and deletes the
database.  Be <EM>very</EM> careful with this statement!
To use <CODE>DROP DATABASE</CODE>, you need the <CODE>DROP</CODE> privilege on the
database.

</P>
<P>
In MySQL 3.22 or later, you can use the keywords <CODE>IF EXISTS</CODE>
to prevent an error from occurring if the database doesn't exist.

</P>
<P>
If you use <CODE>DROP DATABASE</CODE> on a symbolically linked
database, both the link and the original database are deleted.

</P>
<P>
As of MySQL 4.1.2, <CODE>DROP DATABASE</CODE> returns the number of tables that
were removed.  This corresponds to the number of <TT>`.frm'</TT> files removed.

</P>
<P>
The <CODE>DROP DATABASE</CODE> statement removes from the given database directory
those files and directories that MySQL itself may create during normal
operation:

</P>

<UL>

<LI>

All files with these extensions:

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>.BAK</CODE> </TD><TD> <CODE>.DAT</CODE> </TD><TD> <CODE>.HSH</CODE> </TD><TD> <CODE>.ISD</CODE>
</TD></TR>
<TR><TD><CODE>.ISM</CODE> </TD><TD> <CODE>.ISM</CODE> </TD><TD> <CODE>.MRG</CODE> </TD><TD> <CODE>.MYD</CODE>
</TD></TR>
<TR><TD><CODE>.MYI</CODE> </TD><TD> <CODE>.db</CODE> </TD><TD> <CODE>.frm</CODE> </TD><TD>
</TD></TR>
</TABLE>

<LI>

All subdirectories with names that consist of two hex digits
<CODE>00</CODE>-<CODE>ff</CODE>. These are subdirectories used for <CODE>RAID</CODE> tables.

<LI>

The <TT>`db.opt'</TT> file, if it exists.

</UL>

<P>
If other files or directories remain in the database directory after MySQL
removes those just listed, the database directory cannot be removed. In this
case, you must remove any remaining files or directories manually and issue
the <CODE>DROP DATABASE</CODE> statement again.

</P>
<P>
<A NAME="IDX1651"></A>
You can also drop databases with <CODE>mysqladmin</CODE>.
See section <A HREF="manual.html#mysqladmin">8.4  <CODE>mysqladmin</CODE>, Administering a MySQL Server</A>.

</P>



<H3><A NAME="DROP_INDEX" HREF="manual_toc.html#DROP_INDEX">14.2.7  <CODE>DROP INDEX</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1652"></A>
<A NAME="IDX1653"></A>
<A NAME="IDX1654"></A>

</P>

<PRE>
DROP INDEX index_name ON tbl_name
</PRE>

<P>
<CODE>DROP INDEX</CODE> drops the index named <CODE>index_name</CODE> from the table
<CODE>tbl_name</CODE>.  In MySQL 3.22 or later, <CODE>DROP INDEX</CODE> is mapped to an
<CODE>ALTER TABLE</CODE> statement to drop the index.  See section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.  <CODE>DROP INDEX</CODE> doesn't do anything prior to MySQL
3.22.

</P>



<H3><A NAME="DROP_TABLE" HREF="manual_toc.html#DROP_TABLE">14.2.8  <CODE>DROP TABLE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1655"></A>
<A NAME="IDX1656"></A>
<A NAME="IDX1657"></A>

</P>

<PRE>
DROP [TEMPORARY] TABLE [IF EXISTS]
    tbl_name [, tbl_name] ...
    [RESTRICT | CASCADE]
</PRE>

<P>
<CODE>DROP TABLE</CODE> removes one or more tables. You must have the <CODE>DROP</CODE>
privilege for each table. All table data and the table
definition are <EM>removed</EM>, so <EM>be careful</EM> with this statement!

</P>
<P>
In MySQL 3.22 or later, you can use the keywords <CODE>IF EXISTS</CODE>
to prevent an error from occurring for tables that don't exist.  As of
MySQL 4.1, a <CODE>NOTE</CODE> is generated for each non-existent table when
using <CODE>IF EXISTS</CODE>.
See section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.

</P>
<P>
<CODE>RESTRICT</CODE> and <CODE>CASCADE</CODE> are allowed to make porting easier.
For the moment, they do nothing.

</P>
<P>
<STRONG>Note:</STRONG> <CODE>DROP TABLE</CODE> automatically commits the current
active transaction, unless you are using MySQL 4.1 or higher and the
<CODE>TEMPORARY</CODE> keyword.

</P>
<P>
The <CODE>TEMPORARY</CODE> keyword is ignored in MySQL 4.0.  As of 4.1, it has the
following effect:

</P>

<UL>
<LI>

The statement drops only <CODE>TEMPORARY</CODE> tables.
<LI>

The statement doesn't end a running transaction.
<LI>

No access rights are checked.  (A <CODE>TEMPORARY</CODE> table is visible only
only to the client that created it, so no check is necessary.)
</UL>

<P>
Using <CODE>TEMPORARY</CODE> is a good way to ensure that you don't accidentally
drop a non-<CODE>TEMPORARY</CODE> table.

</P>



<H3><A NAME="RENAME_TABLE" HREF="manual_toc.html#RENAME_TABLE">14.2.9  <CODE>RENAME TABLE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1658"></A>

</P>

<PRE>
RENAME TABLE tbl_name TO new_tbl_name
    [, tbl_name2 TO new_tbl_name2] ...
</PRE>

<P>
This statement renames one or more tables.  It was added in MySQL 3.23.23.

</P>
<P>
The rename operation is done atomically, which means that no other thread
can access any of the tables while the rename is running. For example,
if you have an existing table <CODE>old_table</CODE>, you can create another
table <CODE>new_table</CODE> that has the same structure but is empty, and then
replace the existing table with the empty one as follows:

</P>

<PRE>
CREATE TABLE new_table (...);
RENAME TABLE old_table TO backup_table, new_table TO old_table;
</PRE>

<P>
If the statement renames more than one table, renaming operations are done
from left to right. If you want to swap two table names, you can do so
like this (assuming that no table named <CODE>tmp_table</CODE> currently exists):

</P>

<PRE>
RENAME TABLE old_table TO tmp_table,
             new_table TO old_table,
             tmp_table TO new_table;
</PRE>

<P>
As long as two databases are on the same filesystem you can also rename
a table to move it from one database to another:

</P>

<PRE>
RENAME TABLE current_db.tbl_name TO other_db.tbl_name;
</PRE>

<P>
When you execute <CODE>RENAME</CODE>, you can't have any locked tables or
active transactions.  You must also have the <CODE>ALTER</CODE> and <CODE>DROP</CODE>
privileges on the original table, and the <CODE>CREATE</CODE> and <CODE>INSERT</CODE>
privileges on the new table.

</P>
<P>
If MySQL encounters any errors in a multiple-table rename, it
will do a reverse rename for all renamed tables to get everything back
to the original state.

</P>


<H2><A NAME="Basic_User_Commands" HREF="manual_toc.html#Basic_User_Commands">14.3  MySQL Utility Statements</A></H2>



<H3><A NAME="DESCRIBE" HREF="manual_toc.html#DESCRIBE">14.3.1  <CODE>DESCRIBE</CODE> Syntax (Get Information About Columns)</A></H3>

<P>
<A NAME="IDX1659"></A>
<A NAME="IDX1660"></A>

</P>

<PRE>
{DESCRIBE | DESC} tbl_name [col_name | wild]
</PRE>

<P>
<CODE>DESCRIBE</CODE> provides information about a table's columns.  It is a
shortcut for <CODE>SHOW COLUMNS FROM</CODE>.
See section <A HREF="manual.html#Show_database_info">14.5.3.7  <CODE>SHOW DATABASES</CODE> Syntax</A>.

</P>
<P>
<CODE>col_name</CODE> can be a column name, or a string containing the SQL
<SAMP>`%'</SAMP> and <SAMP>`_'</SAMP> wildcard characters to obtain output only for the
columns with names matching the string. There is no need to enclose the
string in quotes unless it contains spaces or other special characters.

</P>
<P>
If the column types are different from what you expect them to be based on a
<CODE>CREATE TABLE</CODE> statement, note that MySQL sometimes
changes column types.  See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

</P>
<P>
<A NAME="IDX1661"></A>
<A NAME="IDX1662"></A>
The <CODE>DESCRIBE</CODE> statement is provided for Oracle compatibility.

</P>
<P>
The <CODE>SHOW CREATE TABLE</CODE> and <CODE>SHOW TABLE STATUS</CODE> statements also
provide information about tables.
See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

</P>



<H3><A NAME="USE" HREF="manual_toc.html#USE">14.3.2  <CODE>USE</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1663"></A>

</P>

<PRE>
USE db_name
</PRE>

<P>
The <CODE>USE db_name</CODE> statement tells MySQL to use the <CODE>db_name</CODE>
database as the default (current) database for subsequent statements.
The database remains the default until the end of the session or until
another <CODE>USE</CODE> statement is issued:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; SELECT COUNT(*) FROM mytable;   # selects from db1.mytable
mysql&#62; USE db2;
mysql&#62; SELECT COUNT(*) FROM mytable;   # selects from db2.mytable
</PRE>

<P>
Making a particular database current by means of the <CODE>USE</CODE> statement
does not preclude you from accessing tables in other databases.  The following example
accesses the <CODE>author</CODE> table from the <CODE>db1</CODE> database and the
<CODE>editor</CODE> table from the <CODE>db2</CODE> database:

</P>

<PRE>
mysql&#62; USE db1;
mysql&#62; SELECT author_name,editor_name FROM author,db2.editor
    -&#62;        WHERE author.editor_id = db2.editor.editor_id;
</PRE>

<P>
<A NAME="IDX1664"></A>
<A NAME="IDX1665"></A>
The <CODE>USE</CODE> statement is provided for Sybase compatibility.

</P>



<H2><A NAME="Transactional_Commands" HREF="manual_toc.html#Transactional_Commands">14.4  MySQL Transactional and Locking Statements</A></H2>



<H3><A NAME="COMMIT" HREF="manual_toc.html#COMMIT">14.4.1  <CODE>START TRANSACTION</CODE>, <CODE>COMMIT</CODE>, and <CODE>ROLLBACK</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1666"></A>
<A NAME="IDX1667"></A>
<A NAME="IDX1668"></A>
<A NAME="IDX1669"></A>

</P>
<P>
By default, MySQL runs autocommit mode enabled. This means that
as soon as you execute a statement that updates (modifies) a table,
MySQL stores the update on disk.

</P>
<P>
If you are using transaction-safe tables (like <CODE>InnoDB</CODE> or <CODE>BDB</CODE>),
you can disable autocommit mode with the following statement:

</P>

<PRE>
SET AUTOCOMMIT=0;
</PRE>

<P>
After disabling autocommit mode by setting the <CODE>AUTOCOMMIT</CODE> variable to
zero, you must use <CODE>COMMIT</CODE> to store your changes to disk or
<CODE>ROLLBACK</CODE> if you want to ignore the changes you have made since
the beginning of your transaction.

</P>
<P>
If you want to disable autocommit mode for a single series of
statements, you can use the <CODE>START TRANSACTION</CODE> statement:

</P>

<PRE>
START TRANSACTION;
SELECT @A:=SUM(salary) FROM table1 WHERE type=1;
UPDATE table2 SET summary=@A WHERE type=1;
COMMIT;
</PRE>

<P>
With <CODE>START TRANSACTION</CODE>, autocommit remains disabled until you end the
transaction with <CODE>COMMIT</CODE> or <CODE>ROLLBACK</CODE>. The autocommit mode then
reverts to its previous state.

</P>
<P>
<CODE>BEGIN</CODE> and <CODE>BEGIN WORK</CODE> can be used instead of <CODE>START
TRANSACTION</CODE> to initiate a transaction.  <CODE>START TRANSACTION</CODE> was
added in MySQL 4.0.11.  This is standard SQL syntax and is the recommended way
to start an ad-hoc transaction.  <CODE>BEGIN</CODE> and <CODE>BEGIN WORK</CODE> are
available from MySQL 3.23.17 and 3.23.19, respectively.

</P>
<P>
Note that if you are not using transaction-safe tables, any changes are
stored at once, regardless of the status of autocommit mode.

</P>
<P>
If you issue a <CODE>ROLLBACK</CODE> statement after updating a non-transactional
table within a transaction, an <CODE>ER_WARNING_NOT_COMPLETE_ROLLBACK</CODE>
warning occurs.  Changes to transaction-safe tables will be rolled back, but
not changes to non-transaction-safe tables.

</P>
<P>
If you are using <CODE>START TRANSACTION</CODE> or <CODE>SET AUTOCOMMIT=0</CODE>, you
should use the MySQL binary log for backups instead of the
older update log.  Transactions are stored in the binary log
in one chunk, upon <CODE>COMMIT</CODE>. Transactions that are
rolled back are not logged.
(Exception: Modifications to non-transactional tables cannot be rolled
back.  If a transaction that is rolled back includes modifications
to non-transactional tables, the entire transaction is logged with a
<CODE>ROLLBACK</CODE> statement at the end to ensure that the modifications to
those tables are replicated. This is true as of MySQL 4.0.15.)
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>
<P>
You can change the isolation level for transactions with
<CODE>SET TRANSACTION ISOLATION LEVEL</CODE>.
See section <A HREF="manual.html#SET_TRANSACTION">14.4.6  <CODE>SET TRANSACTION</CODE> Syntax</A>.

</P>



<H3><A NAME="Cannot_roll_back" HREF="manual_toc.html#Cannot_roll_back">14.4.2  Statements That Cannot Be Rolled Back</A></H3>

<P>
Some statements cannot be rolled back.  In general, these include data
definition language (DDL) statements, such as those that create or drop
databases, or those that create, drop, or alter tables.

</P>
<P>
You should design your transactions not to include such statements.
If you issue a statement early in a transaction that cannot be rolled back,
and then another statement later fails, the full effect of the transaction
cannot be rolled back by issuing a <CODE>ROLLBACK</CODE> statement.

</P>



<H3><A NAME="Implicit_commit" HREF="manual_toc.html#Implicit_commit">14.4.3  Statements That Cause an Implicit Commit</A></H3>

<P>
The following statements implicitly end a transaction (as if you had done
a <CODE>COMMIT</CODE> before executing the statement):

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>ALTER TABLE</CODE> </TD><TD> <CODE>BEGIN</CODE> </TD><TD> <CODE>CREATE INDEX</CODE>
</TD></TR>
<TR><TD><CODE>DROP DATABASE</CODE> </TD><TD> <CODE>DROP INDEX</CODE> </TD><TD> <CODE>DROP TABLE</CODE>
</TD></TR>
<TR><TD><CODE>LOAD MASTER DATA</CODE> </TD><TD> <CODE>LOCK TABLES</CODE> </TD><TD> <CODE>RENAME TABLE</CODE>
</TD></TR>
<TR><TD><CODE>SET AUTOCOMMIT=1</CODE> </TD><TD> <CODE>START TRANSACTION</CODE> </TD><TD> <CODE>TRUNCATE TABLE</CODE>
</TD></TR>
</TABLE>

<P>
<CODE>UNLOCK TABLES</CODE> also ends a transaction if any tables currently are
locked.  Prior to MySQL 4.0.13, <CODE>CREATE TABLE</CODE> ends a transaction if
the binary update log is enabled.

</P>
<P>
Transactions cannot be nested. This is a consequence of the implicit
<CODE>COMMIT</CODE> performed for any current transaction when you issue a
<CODE>START TRANSACTION</CODE> statement or one of its synonyms.

</P>



<H3><A NAME="Savepoints" HREF="manual_toc.html#Savepoints">14.4.4  <CODE>SAVEPOINT</CODE> and <CODE>ROLLBACK TO SAVEPOINT</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1670"></A>
<A NAME="IDX1671"></A>

</P>

<PRE>
SAVEPOINT identifier
ROLLBACK TO SAVEPOINT identifier
</PRE>

<P>
Starting from MySQL 4.0.14 and 4.1.1, <CODE>InnoDB</CODE> supports the SQL statements
<CODE>SAVEPOINT</CODE> and <CODE>ROLLBACK TO SAVEPOINT</CODE>.

</P>
<P>
The <CODE>SAVEPOINT</CODE> statement sets a named transaction savepoint with a name
of <CODE>identifier</CODE>.  If the current transaction already has a savepoint
with the same name, the old savepoint is deleted and a new one is set.

</P>
<P>
The <CODE>ROLLBACK TO SAVEPOINT</CODE> statement rolls back a transaction to the
named savepoint.  Modifications that the current transaction made to rows
after the savepoint was set are undone in the rollback, but <CODE>InnoDB</CODE>
does <EM>not</EM> release the row locks that were stored in memory after
the savepoint.  (Note that for a new inserted row, the lock information is
carried by the transaction ID stored in the row; the lock is not separately
stored in memory. In this case, the row lock is released in the undo.)
Savepoints that were set at a later time than the named savepoint are
deleted.

</P>
<P>
If the statement returns the following error, it means that
no savepoint with the specified name exists:

</P>

<PRE>
ERROR 1181: Got error 153 during ROLLBACK
</PRE>

<P>
All savepoints of the current transaction are deleted if you execute a
<CODE>COMMIT</CODE>, or a <CODE>ROLLBACK</CODE> that does not name a savepoint.

</P>



<H3><A NAME="LOCK_TABLES" HREF="manual_toc.html#LOCK_TABLES">14.4.5  <CODE>LOCK TABLES</CODE> and <CODE>UNLOCK TABLES</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1672"></A>
<A NAME="IDX1673"></A>

</P>

<PRE>
LOCK TABLES
    tbl_name [AS alias] {READ [LOCAL] | [LOW_PRIORITY] WRITE}
    [, tbl_name [AS alias] {READ [LOCAL] | [LOW_PRIORITY] WRITE}] ...
UNLOCK TABLES
</PRE>

<P>
<CODE>LOCK TABLES</CODE> locks tables for the current thread.  <CODE>UNLOCK
TABLES</CODE> releases any locks held by the current thread.  All tables that
are locked by the current thread are implicitly unlocked when the
thread issues another <CODE>LOCK TABLES</CODE>, or when the connection to the
server is closed.

</P>
<P>
<STRONG>Note:</STRONG> <CODE>LOCK TABLES</CODE> is not transaction-safe and implicitly
commits any active transactions before attempting to lock the tables.

</P>
<P>
As of MySQL 4.0.2, to use <CODE>LOCK TABLES</CODE> you must have the global
<CODE>LOCK TABLES</CODE> privilege and a <CODE>SELECT</CODE> privilege for the
involved tables. In MySQL 3.23, you must have <CODE>SELECT</CODE>,
<CODE>INSERT</CODE>, <CODE>DELETE</CODE>, and <CODE>UPDATE</CODE> privileges for the
tables.

</P>
<P>
The main reasons to use <CODE>LOCK TABLES</CODE> are for emulating transactions
or to get more speed when updating tables.  This is explained in more
detail later.

</P>
<P>
If a thread obtains a <CODE>READ</CODE> lock on a table, that thread (and all other
threads) can only read from the table. If a thread obtains a <CODE>WRITE</CODE>
lock on a table, only the thread holding the lock can read from
or write to the table.  Other threads are blocked.

</P>
<P>
The difference between <CODE>READ LOCAL</CODE> and <CODE>READ</CODE> is that <CODE>READ
LOCAL</CODE> allows non-conflicting <CODE>INSERT</CODE> statements (concurrent inserts)
to execute while the lock is held.  However, this can't be used if you are
going to manipulate the database files outside MySQL while you hold the
lock.

</P>
<P>
When you use <CODE>LOCK TABLES</CODE>, you must lock all tables that you are
going to use in your queries.  If you are using a table multiple times
in a query (with aliases), you must get a lock for each alias. While
the locks obtained with a <CODE>LOCK TABLES</CODE> statement are in effect,
you cannot access any tables that were not locked by the statement.

</P>
<P>
If your queries refer to a table using an alias, then you must lock the
table using that same alias.  It will not work to lock the table without
specifying the alias:

</P>

<PRE>
mysql&#62; LOCK TABLE t READ;
mysql&#62; SELECT * FROM t AS myalias;
ERROR 1100: Table 'myalias' was not locked with LOCK TABLES
</PRE>

<P>
Conversely, if you lock a table using an alias, you must refer to it in
your queries using that alias:

</P>

<PRE>
mysql&#62; LOCK TABLE t AS myalias READ;
mysql&#62; SELECT * FROM t;
ERROR 1100: Table 't' was not locked with LOCK TABLES
mysql&#62; SELECT * FROM t AS myalias;
</PRE>

<P>
<CODE>WRITE</CODE> locks normally have higher priority than <CODE>READ</CODE> locks to
ensure that updates are processed as soon as possible. This means that if one
thread obtains a <CODE>READ</CODE> lock and then another thread requests a
<CODE>WRITE</CODE> lock, subsequent <CODE>READ</CODE> lock requests will wait until the
<CODE>WRITE</CODE> thread has gotten the lock and released it.  You can use
<CODE>LOW_PRIORITY WRITE</CODE> locks to allow other threads to obtain <CODE>READ</CODE>
locks while the thread is waiting for the <CODE>WRITE</CODE> lock. You should
use <CODE>LOW_PRIORITY WRITE</CODE> locks only if you are sure that there will
eventually be a time when no threads will have a <CODE>READ</CODE> lock.

</P>
<P>
<CODE>LOCK TABLES</CODE> works as follows:

</P>

<OL>
<LI>

Sort all tables to be locked in an internally defined order. From the
user standpoint, this order is undefined.
<LI>

If a table is locked with a read and a write lock, put the write lock
before the read lock.
<LI>

Lock one table at a time until the thread gets all locks.
</OL>

<P>
This policy ensures that table locking is deadlock free. There are,
however, other things you need to be aware of with this schema:

</P>
<P>
If you are using a <CODE>LOW_PRIORITY WRITE</CODE> lock for a table, it
means only that MySQL will wait for this particular lock until
there are no threads that want a <CODE>READ</CODE> lock.  When the thread has
gotten the <CODE>WRITE</CODE> lock and is waiting to get the lock for the next
table in the lock table list, all other threads will wait for the
<CODE>WRITE</CODE> lock to be released.  If this becomes a serious problem
with your application, you should consider converting some of your
tables to transaction-safe tables.

</P>
<P>
You can safely use <CODE>KILL</CODE> to terminate a thread that is waiting for a
table lock.
See section <A HREF="manual.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A>.

</P>
<P>
Note that you should <EM>not</EM> lock any tables that you are using with
<CODE>INSERT DELAYED</CODE> because in that case the <CODE>INSERT</CODE> is done by a
separate thread.

</P>
<P>
Normally, you don't have to lock tables, because all single <CODE>UPDATE</CODE> statements
are atomic; no other thread can interfere with any other currently executing
SQL statement. There are a few cases when you would like to lock tables
anyway:

</P>

<UL>
<LI>

If you are going to run many operations on a set of tables, it's much
faster to lock the tables you are going to use.  The downside is
that no thread can update a <CODE>READ</CODE>-locked table (including the one
holding the lock) and no thread can read a <CODE>WRITE</CODE>-locked table other
than the one holding the lock.

The reason some operations are faster under <CODE>LOCK TABLES</CODE> is that
MySQL will not flush the key cache for the locked tables until
<CODE>UNLOCK TABLES</CODE> is called. Normally, the key cache is flushed after
each SQL statement. Locking <CODE>MyISAM</CODE> tables speeds up inserting,
updating, or deleting on them.
<LI>

If you are using a storage engine in MySQL that doesn't support
transactions, you must use <CODE>LOCK TABLES</CODE> if you want to ensure that
no other thread comes between a <CODE>SELECT</CODE> and an <CODE>UPDATE</CODE>. The
example shown here requires <CODE>LOCK TABLES</CODE> to execute safely:


<PRE>
mysql&#62; LOCK TABLES trans READ, customer WRITE;
mysql&#62; SELECT SUM(value) FROM trans WHERE customer_id=some_id;
mysql&#62; UPDATE customer
    -&#62;     SET total_value=sum_from_previous_statement
    -&#62;     WHERE customer_id=some_id;
mysql&#62; UNLOCK TABLES;
</PRE>

Without <CODE>LOCK TABLES</CODE>, it is possible that another thread might
insert a new row in the <CODE>trans</CODE> table between execution of the
<CODE>SELECT</CODE> and <CODE>UPDATE</CODE> statements.
</UL>

<P>
You can avoid using <CODE>LOCK TABLES</CODE> in many cases
by using relative updates (<CODE>UPDATE customer SET
value=value+new_value</CODE>) or the <CODE>LAST_INSERT_ID()</CODE> function,
See section <A HREF="manual.html#ANSI_diff_Transactions">1.8.5.3  Transactions and Atomic Operations</A>.

</P>
<P>
You can also avoid locking tables in some cases by using the user-level
advisory lock functions <CODE>GET_LOCK()</CODE> and <CODE>RELEASE_LOCK()</CODE>.
These locks are saved in a hash table in the server and implemented with
<CODE>pthread_mutex_lock()</CODE> and <CODE>pthread_mutex_unlock()</CODE> for high speed.
See section <A HREF="manual.html#Miscellaneous_functions">13.8.4  Miscellaneous Functions</A>.

</P>
<P>
See section <A HREF="manual.html#Internal_locking">7.3.1  Locking Methods</A>, for more information on locking policy.

</P>
<P>
You can lock all tables in all databases with read locks with the <CODE>FLUSH
TABLES WITH READ LOCK</CODE> statement. See section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>. This
is a very convenient way to get backups if you have a filesystem such as
Veritas that can take snapshots in time.

</P>
<P>
<STRONG>Note:</STRONG> If you use <CODE>ALTER TABLE</CODE> on a locked table, it may become
unlocked. See section <A HREF="manual.html#ALTER_TABLE_problems">A.7.1  Problems with <CODE>ALTER TABLE</CODE></A>.

</P>



<H3><A NAME="SET_TRANSACTION" HREF="manual_toc.html#SET_TRANSACTION">14.4.6  <CODE>SET TRANSACTION</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1674"></A>
<A NAME="IDX1675"></A>

</P>

<PRE>
SET [GLOBAL | SESSION] TRANSACTION ISOLATION LEVEL
{ READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE }
</PRE>

<P>
This statement
sets the transaction isolation level for the next transaction, globally, or
for the current session.

</P>
<P>
The default behavior of <CODE>SET TRANSACTION</CODE> is to set the isolation level
for the next (not yet
started) transaction.  If you use the <CODE>GLOBAL</CODE> keyword, the statement
sets the default transaction level globally for all new connections
created from that point on. Existing connections are unaffected.
You need the <CODE>SUPER</CODE>
privilege to do this.  Using the <CODE>SESSION</CODE> keyword sets the
default transaction level for all future transactions performed on the
current connection.

</P>
<P>
For descriptions of each <CODE>InnoDB</CODE> transaction isolation level, see
section <A HREF="manual.html#InnoDB_transaction_isolation">16.11.2  <CODE>InnoDB</CODE> and <CODE>TRANSACTION ISOLATION LEVEL</CODE></A>.
<CODE>InnoDB</CODE> supports each of these levels
from MySQL 4.0.5 on. The default level is <CODE>REPEATABLE READ</CODE>.

</P>
<P>
You can set the initial default global isolation level for <CODE>mysqld</CODE> with
the <CODE>--transaction-isolation</CODE> option.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>



<H2><A NAME="Database_Administration" HREF="manual_toc.html#Database_Administration">14.5  Database Administration Statements</A></H2>



<H3><A NAME="Account_management_SQL" HREF="manual_toc.html#Account_management_SQL">14.5.1  Account Management Statements</A></H3>



<H4><A NAME="Drop_user" HREF="manual_toc.html#Drop_user">14.5.1.1  <CODE>DROP USER</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1676"></A>

</P>
<P>
<A NAME="IDX1677"></A>
<A NAME="IDX1678"></A>
<A NAME="IDX1679"></A>
<A NAME="IDX1680"></A>
<A NAME="IDX1681"></A>
<A NAME="IDX1682"></A>
<A NAME="IDX1683"></A>
<A NAME="IDX1684"></A>

</P>

<PRE>
DROP USER user
</PRE>

<P>
The <CODE>DROP USER</CODE> statement deletes a MySQL account that
doesn't have any privileges.  It serves to remove the account record from
the <CODE>user</CODE> table. The account is named using the same format as for
<CODE>GRANT</CODE> or <CODE>REVOKE</CODE>; for example, <CODE>'jeffrey'@'localhost'</CODE>.
The user and host parts of the account name correspond to the <CODE>User</CODE> and
<CODE>Host</CODE> column values of the <CODE>user</CODE> table record for the account.

</P>
<P>
To remove a MySQL user account, you should use the following procedure,
performing the steps in the order shown:

</P>

<OL>
<LI>

Use <CODE>SHOW GRANTS</CODE> to determine what privileges the account has.
See section <A HREF="manual.html#SHOW_GRANTS">14.5.3.10  <CODE>SHOW GRANTS</CODE> Syntax</A>.
<LI>

Use <CODE>REVOKE</CODE> to revoke the privileges displayed by <CODE>SHOW GRANTS</CODE>.
This removes records for the account from all the grant tables except the
<CODE>user</CODE> table, and revokes any global privileges listed in the <CODE>user</CODE>
table.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.
<LI>

Delete the account by using <CODE>DROP USER</CODE> to remove the <CODE>user</CODE> table
record.
</OL>

<P>
The <CODE>DROP USER</CODE> statement was added in MySQL 4.1.1.  Before 4.1.1,
you should first revoke the account privileges as just described. Then
delete the <CODE>user</CODE> table record and flush the grant tables like this:

</P>

<PRE>
mysql&#62; DELETE FROM mysql.user
    -&#62; WHERE User='user_name' and Host='host_name';
mysql&#62; FLUSH PRIVILEGES;
</PRE>



<H4><A NAME="GRANT" HREF="manual_toc.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1685"></A>
<A NAME="IDX1686"></A>

</P>
<P>
<A NAME="IDX1687"></A>
<A NAME="IDX1688"></A>
<A NAME="IDX1689"></A>
<A NAME="IDX1690"></A>
<A NAME="IDX1691"></A>

</P>

<PRE>
GRANT priv_type [(column_list)] [, priv_type [(column_list)]] ...
    ON {tbl_name | * | *.* | db_name.*}
    TO user [IDENTIFIED BY [PASSWORD] 'password']
        [, user [IDENTIFIED BY [PASSWORD] 'password']] ...
    [REQUIRE
        NONE |
        [{SSL| X509}]
        [CIPHER cipher [AND]]
        [ISSUER issuer [AND]]
        [SUBJECT subject]]
    [WITH [GRANT OPTION | MAX_QUERIES_PER_HOUR count |
                          MAX_UPDATES_PER_HOUR count |
                          MAX_CONNECTIONS_PER_HOUR count]]
</PRE>


<PRE>
REVOKE priv_type [(column_list)] [, priv_type [(column_list)]] ...
    ON {tbl_name | * | *.* | db_name.*}
    FROM user [, user] ...

REVOKE ALL PRIVILEGES, GRANT OPTION FROM user [, user] ...
</PRE>

<P>
The <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements allow system administrators to
create MySQL user accounts and to grant rights to and revoke them from
accounts.  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> are implemented in MySQL 3.22.11
or later. For earlier MySQL versions, these statements do nothing.

</P>
<P>
MySQL account information is stored in the tables of the <CODE>mysql</CODE>
database. This database and the access control system are discussed
extensively in section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>, which you should consult
for additional details.

</P>
<P>
Privileges can be granted at four levels:

</P>
<DL COMPACT>

<DT><STRONG>Global level</STRONG>
<DD>
Global privileges apply to all databases on a given server. These privileges
are stored in the <CODE>mysql.user</CODE> table.
<CODE>GRANT ALL ON *.*</CODE> and
<CODE>REVOKE ALL ON *.*</CODE> grant and revoke only global privileges.

<DT><STRONG>Database level</STRONG>
<DD>
Database privileges apply to all tables in a given database. These privileges
are stored in the <CODE>mysql.db</CODE> and <CODE>mysql.host</CODE> tables.
<CODE>GRANT ALL ON db_name.*</CODE> and
<CODE>REVOKE ALL ON db_name.*</CODE> grant and revoke only database privileges.

<DT><STRONG>Table level</STRONG>
<DD>
Table privileges apply to all columns in a given table. These privileges are
stored in the <CODE>mysql.tables_priv</CODE> table.
<CODE>GRANT ALL ON db_name.tbl_name</CODE> and
<CODE>REVOKE ALL ON db_name.tbl_name</CODE> grant and revoke only table privileges.

<DT><STRONG>Column level</STRONG>
<DD>
Column privileges apply to single columns in a given table. These privileges are
stored in the <CODE>mysql.columns_priv</CODE> table.
When using <CODE>REVOKE</CODE>, you must specify the same columns that were granted.
</DL>

<P>
To make it easy to revoke all privileges, MySQL 4.1.2 has added the
following syntax, which drops all database-, table-, and column-level
privileges for the named users:

</P>

<PRE>
REVOKE ALL PRIVILEGES, GRANT OPTION FROM user [, user] ...
</PRE>

<P>
Before MySQL 4.1.2, all privileges cannot be dropped at once.
Two statements are necessary:

</P>

<PRE>
REVOKE ALL PRIVILEGES FROM user [, user] ...
REVOKE GRANT OPTION FROM user [, user] ...
</PRE>

<P>
For the <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> statements, <CODE>priv_type</CODE> can be
specified as any of the following:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Privilege</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>ALL [PRIVILEGES]</CODE> </TD><TD> Sets all simple privileges except <CODE>GRANT OPTION</CODE>
</TD></TR>
<TR><TD><CODE>ALTER</CODE> </TD><TD> Allows use of <CODE>ALTER TABLE</CODE>
</TD></TR>
<TR><TD><CODE>CREATE</CODE> </TD><TD> Allows use of <CODE>CREATE TABLE</CODE>
</TD></TR>
<TR><TD><CODE>CREATE TEMPORARY TABLES</CODE> </TD><TD> Allows use of <CODE>CREATE TEMPORARY TABLE</CODE>
</TD></TR>
<TR><TD><CODE>DELETE</CODE> </TD><TD> Allows use of <CODE>DELETE</CODE>
</TD></TR>
<TR><TD><CODE>DROP</CODE> </TD><TD> Allows use of <CODE>DROP TABLE</CODE>
</TD></TR>
<TR><TD><CODE>EXECUTE</CODE> </TD><TD> Allows the user to run stored procedures (MySQL 5.0)
</TD></TR>
<TR><TD><CODE>FILE</CODE> </TD><TD> Allows use of <CODE>SELECT ... INTO OUTFILE</CODE> and <CODE>LOAD DATA INFILE</CODE>
</TD></TR>
<TR><TD><CODE>INDEX</CODE> </TD><TD> Allows use of <CODE>CREATE INDEX</CODE> and <CODE>DROP INDEX</CODE>
</TD></TR>
<TR><TD><CODE>INSERT</CODE> </TD><TD> Allows use of <CODE>INSERT</CODE>
</TD></TR>
<TR><TD><CODE>LOCK TABLES</CODE> </TD><TD> Allows use of <CODE>LOCK TABLES</CODE> on tables for which you have the <CODE>SELECT</CODE> privilege
</TD></TR>
<TR><TD><CODE>PROCESS</CODE> </TD><TD> Allows use of <CODE>SHOW FULL PROCESSLIST</CODE>
</TD></TR>
<TR><TD><CODE>REFERENCES</CODE> </TD><TD> Not yet implemented
</TD></TR>
<TR><TD><CODE>RELOAD</CODE> </TD><TD> Allows use of <CODE>FLUSH</CODE>
</TD></TR>
<TR><TD><CODE>REPLICATION CLIENT</CODE> </TD><TD> Gives the right to the user to ask where the slave or master servers are
</TD></TR>
<TR><TD><CODE>REPLICATION SLAVE</CODE> </TD><TD> Needed for replication slaves (to read binary log events from the master)
</TD></TR>
<TR><TD><CODE>SELECT</CODE> </TD><TD> Allows use of <CODE>SELECT</CODE>
</TD></TR>
<TR><TD><CODE>SHOW DATABASES</CODE> </TD><TD> <CODE>SHOW DATABASES</CODE> shows all databases
</TD></TR>
<TR><TD><CODE>SHUTDOWN</CODE> </TD><TD> Allows use of <CODE>mysqladmin shutdown</CODE>
</TD></TR>
<TR><TD><CODE>SUPER</CODE> </TD><TD> Allows use of <CODE>CHANGE MASTER</CODE>, <CODE>KILL thread</CODE>, <CODE>PURGE MASTER LOGS</CODE>, and <CODE>SET GLOBAL</CODE> statements, the <CODE>mysqladmin debug</CODE> command; allows you to connect (once) even if <CODE>max_connections</CODE> is reached
</TD></TR>
<TR><TD><CODE>UPDATE</CODE> </TD><TD> Allows use of <CODE>UPDATE</CODE>
</TD></TR>
<TR><TD><CODE>USAGE</CODE> </TD><TD> Synonym for ``no privileges''
</TD></TR>
<TR><TD><CODE>GRANT OPTION</CODE> </TD><TD> Allows privileges to be granted
</TD></TR>
</TABLE>

<P>
<CODE>USAGE</CODE> can be used when you want to create a user that has no privileges.

</P>
<P>
The privileges <CODE>CREATE TEMPORARY TABLES</CODE>, <CODE>EXECUTE</CODE>,
<CODE>LOCK TABLES</CODE>, <CODE>REPLICATION ...</CODE>, <CODE>SHOW DATABASES</CODE> and
<CODE>SUPER</CODE> are new for in MySQL 4.0.2.  To use these new privileges
after upgrading to 4.0.2, you must run the
<CODE>mysql_fix_privilege_tables</CODE> script.
See section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</P>
<P>
In older MySQL versions that do not have the <CODE>SUPER</CODE> privilege, the
<CODE>PROCESS</CODE> privilege can be used instead.

</P>
<P>
You can assign global privileges by using <CODE>ON *.*</CODE> syntax or
database privileges by using <CODE>ON db_name.*</CODE> syntax. If you specify
<CODE>ON *</CODE> and you have a current database, the privileges will be granted in
that database.  (<STRONG>Warning:</STRONG> If you specify <CODE>ON *</CODE> and you
<EM>don't</EM> have a current database, the privileges granted will be global!)

</P>
<P>
The <CODE>EXECUTION</CODE>, <CODE>FILE</CODE>, <CODE>PROCESS</CODE>, <CODE>RELOAD</CODE>,
<CODE>REPLICATION CLIENT</CODE>, <CODE>REPLICATION SLAVE</CODE>, <CODE>SHOW DATABASES</CODE>,
<CODE>SHUTDOWN</CODE>, and <CODE>SUPER</CODE> privileges are administrative privileges
that can only be granted globally (using <CODE>ON *.*</CODE> syntax).

</P>
<P>
Other privileges can be granted globally or at more specific levels.

</P>
<P>
The only <CODE>priv_type</CODE> values you can specify for a table are <CODE>SELECT</CODE>,
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, <CODE>CREATE</CODE>, <CODE>DROP</CODE>,
<CODE>GRANT OPTION</CODE>, <CODE>INDEX</CODE>, and <CODE>ALTER</CODE>.

</P>
<P>
The only <CODE>priv_type</CODE> values you can specify for a column (that is, when
you use a <CODE>column_list</CODE> clause) are <CODE>SELECT</CODE>, <CODE>INSERT</CODE>, and
<CODE>UPDATE</CODE>.

</P>
<P>
<CODE>GRANT ALL</CODE> assigns only the privileges that exist at the level you are
granting. For example, if you use <CODE>GRANT ALL ON db_name.*</CODE>, that is a
database-level statement, so none of the global-only privileges such as
<CODE>FILE</CODE> will be granted.

</P>
<P>
MySQL allows you to create database-level privileges even if the database
doesn't exist, to make it easy to prepare for database use.  However, MySQL
currently does not allow you to create table-level privileges if the table
doesn't exist.

</P>
<P>
MySQL does not automatically revoke any privileges even if you drop a table
or drop a database.

</P>
<P>
<STRONG>Note:</STRONG> the <SAMP>`_'</SAMP> and <SAMP>`%'</SAMP> wildcards are allowed when
specifying database names in <CODE>GRANT</CODE> statements that grant privileges at
the global or database levels. This means, for example, that if you
want to use a <SAMP>`_'</SAMP> character as part of a database name,
you should specify it as <SAMP>`\_'</SAMP> in the <CODE>GRANT</CODE> statement, to prevent
the user from being able to access additional databases matching the
wildcard pattern; for example, <CODE>GRANT ... ON `foo\_bar`.* TO ...</CODE>.

</P>
<P>
In order to accommodate granting rights to users from arbitrary hosts,
MySQL supports specifying the <CODE>user</CODE> value in the form
<CODE>user_name@host_name</CODE>.  If you want to specify a <CODE>user_name</CODE> string
containing special characters (such as <SAMP>`-'</SAMP>), or a <CODE>host_name</CODE> string
containing special characters or wildcard characters (such as <SAMP>`%'</SAMP>), you
can quote the username or hostname (for example,
<CODE>'test-user'@'test-hostname'</CODE>). Quote the username and hostname
separately.

</P>
<P>
You can specify wildcards in the hostname.  For example,
<CODE>user_name@'%.loc.gov'</CODE> applies to <CODE>user_name</CODE> for any host in the
<CODE>loc.gov</CODE> domain, and <CODE>user_name@'144.155.166.%'</CODE> applies to
<CODE>user_name</CODE> for any host in the <CODE>144.155.166</CODE> class C subnet.

</P>
<P>
The simple form <CODE>user_name</CODE> is a synonym for <CODE>user_name@'%'</CODE>.

</P>
<P>
MySQL doesn't support wildcards in usernames.  Anonymous users are
defined by inserting entries with <CODE>User=''</CODE> into the
<CODE>mysql.user</CODE> table or creating a user with an empty name with the
<CODE>GRANT</CODE> statement:

</P>

<PRE>
mysql&#62; GRANT ALL ON test.* TO ''@'localhost' ...
</PRE>

<P>
<STRONG>Warning:</STRONG> If you allow anonymous users to connect to the MySQL
server, you should also grant privileges to all local users as
<CODE>user_name@localhost</CODE>. Otherwise, the anonymous-user account for
the local host in the <CODE>mysql.user</CODE> table will be used when users
try to log in to the MySQL server from the local machine!
(This account is created during MySQL installation.)

</P>
<P>
You can determine whether this applies to you by executing the following query:

</P>

<PRE>
mysql&#62; SELECT Host, User FROM mysql.user WHERE User='';
</PRE>

<P>
If you want to delete the local anonymous-user account to avoid the problem
just described, use these statements:

</P>

<PRE>
mysql&#62; DELETE FROM mysql.user WHERE Host='localhost' AND User='';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
For the moment, <CODE>GRANT</CODE> only supports host, table, database, and
column names up to 60 characters long. A username can be up to 16
characters.

</P>
<P>
The privileges for a table or column are formed additively from the
logical OR of the privileges at each of the four privilege
levels.  For example, if the <CODE>mysql.user</CODE> table specifies that a
user has a global <CODE>SELECT</CODE> privilege, the privilege cannot be denied by an
entry at the database, table, or column level.

</P>
<P>
The privileges for a column can be calculated as follows:

</P>

<PRE>
global privileges
OR (database privileges AND host privileges)
OR table privileges
OR column privileges
</PRE>

<P>
In most cases, you grant rights to a user at only one of the privilege
levels, so life isn't normally this complicated. The details of the
privilege-checking procedure are presented in
section <A HREF="manual.html#Privilege_system">5.4  The MySQL Access Privilege System</A>.

</P>
<P>
If you grant privileges for a username/hostname combination that does not exist
in the <CODE>mysql.user</CODE> table, an entry is added and remains there until
deleted with a <CODE>DELETE</CODE> statement.  In other words, <CODE>GRANT</CODE> may
create <CODE>user</CODE> table entries, but <CODE>REVOKE</CODE> will not remove them;
you must do that explicitly using <CODE>DROP USER</CODE> or <CODE>DELETE</CODE>.

</P>
<P>
<A NAME="IDX1692"></A>
In MySQL 3.22.12 or later,
if a new user is created or if you have global grant privileges, the user's
password is set to the password specified by the <CODE>IDENTIFIED BY</CODE>
clause, if one is given.  If the user already had a password, it is replaced
by the new one.

</P>
<P>
<STRONG>Warning:</STRONG> If you create a new user but do not specify an
<CODE>IDENTIFIED BY</CODE> clause, the user has no password.  This is insecure.

</P>
<P>
Passwords can also be set with the <CODE>SET PASSWORD</CODE> statement.
See section <A HREF="manual.html#SET_PASSWORD">14.5.1.3  <CODE>SET PASSWORD</CODE> Syntax</A>.

</P>
<P>
If you don't want to send the password in clear text, you can use
the <CODE>PASSWORD</CODE> keyword followed by a scrambled password from the
<CODE>PASSWORD()</CODE> SQL function or the <CODE>make_scrambled_password()</CODE>
C API function.

</P>
<P>
If you grant privileges for a database, an entry in the <CODE>mysql.db</CODE>
table is created if needed. If all privileges for the database are
removed with <CODE>REVOKE</CODE>, this entry is deleted.

</P>
<P>
If a user has no privileges for a table, the table name is not displayed
when the user requests a list of tables (for example, with a <CODE>SHOW TABLES</CODE>
statement). If a user has no privileges for a database, the database name
is not displayed by <CODE>SHOW DATABASES</CODE> unless the user has the <CODE>SHOW
DATABASES</CODE> privilege.

</P>
<P>
The <CODE>WITH GRANT OPTION</CODE> clause gives the user the ability to give
to other users any privileges the user has at the specified privilege level.
You should be careful to whom you give the <CODE>GRANT OPTION</CODE> privilege,
because two users with different privileges may be able to join privileges!

</P>
<P>
You cannot grant another user a privilege you don't have yourself; the
<CODE>GRANT OPTION</CODE> privilege allows you to give away only those privileges
you possess.

</P>
<P>
Be aware that when you grant a user the <CODE>GRANT OPTION</CODE> privilege at a
particular privilege level, any privileges the user already possesses (or
is given in the future!) at that level are also grantable by that user.
Suppose that you grant a user the <CODE>INSERT</CODE> privilege on a database.  If
you then grant the <CODE>SELECT</CODE> privilege on the database and specify
<CODE>WITH GRANT OPTION</CODE>, the user can give away not only the <CODE>SELECT</CODE>
privilege, but also <CODE>INSERT</CODE>.  If you then grant the <CODE>UPDATE</CODE>
privilege to the user on the database, the user can give away
<CODE>INSERT</CODE>, <CODE>SELECT</CODE>, and <CODE>UPDATE</CODE>.

</P>
<P>
You should not grant <CODE>ALTER</CODE> privileges to a normal user.  If you
do that, the user can try to subvert the privilege system by renaming
tables!

</P>
<P>
The <CODE>MAX_QUERIES_PER_HOUR count</CODE>, <CODE>MAX_UPDATES_PER_HOUR count</CODE>,
and <CODE>MAX_CONNECTIONS_PER_HOUR count</CODE> options are new in MySQL 4.0.2.
They limit the number of queries, updates, and logins a user can perform
during one hour. If <CODE>count</CODE> is 0 (the default), this means there is no
limitation for that user. See section <A HREF="manual.html#User_resources">5.5.4  Limiting Account Resources</A>.  Note: To specify any of
these options for an existing user without affecting existing privileges,
use <CODE>GRANT USAGE ON *.* ... WITH MAX_...</CODE>.

</P>
<P>
<A NAME="IDX1693"></A>
<A NAME="IDX1694"></A>

</P>
<P>
MySQL can check X509 certificate attributes in addition to the usual
authentication that is based on the username and password.  To specify
SSL-related options for a MySQL account, use the <CODE>REQUIRE</CODE> clause of
the <CODE>GRANT</CODE> statement.
(For background on the use of SSL with MySQL, see section <A HREF="manual.html#Secure_connections">5.5.7  Using Secure Connections</A>.)

</P>
<P>
There are different possibilities for limiting connection types for an account:

</P>

<UL>
<LI>

If an account has no SSL or X509 requirements, unencrypted connections are
allowed if the username and password are valid. However, encrypted
connections also can be used at the client's option, if the client has the
proper certificate and key files.

<LI>

<CODE>REQUIRE SSL</CODE> option limits the server to allow only SSL
encrypted connections for the account. Note that this option can be omitted
if there are any ACL records that allow non-SSL connections.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE SSL;
</PRE>

<LI>

<CODE>REQUIRE X509</CODE> means that the client must have a valid certificate
but that the exact certificate, issuer, and subject do not matter.
The only requirement is that it should be possible to verify its
signature with one of the CA certificates.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE X509;
</PRE>

<LI>

<CODE>REQUIRE ISSUER 'issuer'</CODE> places the restriction on connection attempts
that the client must present a valid X509 certificate issued by CA
<CODE>'issuer'</CODE>.  If the client presents a certificate that is valid but has
a different issuer, the server rejects the connection.  Use of X509
certificates always implies encryption, so the <CODE>SSL</CODE> option is
unneccessary.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <CODE>ISSUER</CODE> value should be entered as a single string.

<LI>

<CODE>REQUIRE SUBJECT 'subject'</CODE> places the restriction on connection
attempts that the client must present a valid X509 certificate with subject
<CODE>'subject'</CODE> on it.  If the client presents a certificate that is valid
but has a different subject, the server rejects the connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <CODE>SUBJECT</CODE> value should be entered as a single string.

<LI>

<CODE>REQUIRE CIPHER 'cipher'</CODE> is needed to ensure that strong enough ciphers
and key lengths will be used. SSL itself can be weak if old algorithms
with short encryption keys are used. Using this option, we can ask for
some exact cipher method to allow a connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

</UL>

<P>
The <CODE>SUBJECT</CODE>, <CODE>ISSUER</CODE>, and <CODE>CIPHER</CODE> options can be
combined in the <CODE>REQUIRE</CODE> clause like this:

</P>

<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

<P>
Note that the <CODE>SUBJECT</CODE> and <CODE>ISSUER</CODE> values each should be entered
as a single string.

</P>
<P>
Starting from MySQL 4.0.4, the <CODE>AND</CODE> keyword is optional between
<CODE>REQUIRE</CODE> options.

</P>
<P>
The order of the options does not matter, but no option can be specified
twice.

</P>
<P>
Note that if you are using table or column privileges for even one user, the
server examines table and column privileges for all users and this slows
down MySQL a bit.
Similarly, if you limit the number of queries, updates, or connections for
any users, the server must monitor these values.

</P>
<P>
When <CODE>mysqld</CODE> starts, all privileges are read into memory.
Database, table, and column privileges take effect at once, and
user-level privileges take effect the next time the user connects.
Modifications to the grant tables that you perform using <CODE>GRANT</CODE> or
<CODE>REVOKE</CODE> are noticed by the server immediately.
If you modify the grant tables manually (using <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
and so on), you should execute a <CODE>FLUSH PRIVILEGES</CODE> statement or run
<CODE>mysqladmin flush-privileges</CODE> to tell the server to reload the grant
tables.
See section <A HREF="manual.html#Privilege_changes">5.4.7  When Privilege Changes Take Effect</A>.

</P>
<P>
<A NAME="IDX1695"></A>
The biggest differences between the standard SQL and MySQL versions of
<CODE>GRANT</CODE> are:

</P>

<UL>
<LI>

In MySQL, privileges are given for a username/hostname combination
and not only for a username.

<LI>

Standard SQL doesn't have global or database-level privileges, nor does it 
support all the privilege types that MySQL supports.

<LI>

MySQL doesn't support the standard SQL <CODE>TRIGGER</CODE> or <CODE>UNDER</CODE>
privileges.

<LI>

Standard SQL privileges are structured in a hierarchical manner. If you remove
a user, all privileges the user has been granted are revoked. In
MySQL, the granted privileges are not automatically revoked;
you must revoke them yourself.

<LI>

With standard SQL, when you drop a table, all privileges for the table are
revoked.  With standard SQL, when you revoke a privilege, all privileges
that were granted based on the privilege are also revoked. In MySQL,
privileges can be dropped only with explicit <CODE>REVOKE</CODE> statements or
by manipulating the MySQL grant tables.

<LI>

In MySQL, if you have the <CODE>INSERT</CODE> privilege on only some of the
columns in a table, you can execute <CODE>INSERT</CODE> statements on the
table; the columns for which you don't have the <CODE>INSERT</CODE> privilege
will be set to their default values. Standard SQL requires you to have the
<CODE>INSERT</CODE> privilege on all columns.

</UL>



<H4><A NAME="SET_PASSWORD" HREF="manual_toc.html#SET_PASSWORD">14.5.1.3  <CODE>SET PASSWORD</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1696"></A>

</P>
<P>
<A NAME="IDX1697"></A>
<A NAME="IDX1698"></A>

</P>

<PRE>
SET PASSWORD = PASSWORD('some password')
SET PASSWORD FOR user = PASSWORD('some password')
</PRE>

<P>
The <CODE>SET PASSWORD</CODE> statement assigns a password to an existing
MySQL user account.

</P>
<P>
The first syntax sets the password for the current user. Any client that has
connected to the server using a non-anonymous account can change the password
for that account.

</P>
<P>
The second syntax sets the password for a specific account on the current
server host. Only clients with access to the <CODE>mysql</CODE> database can do
this.  The <CODE>user</CODE> value should be given in <CODE>user_name@host_name</CODE>
format, where <CODE>user_name</CODE> and <CODE>host_name</CODE> are exactly as they are
listed in the <CODE>User</CODE> and <CODE>Host</CODE> columns of the <CODE>mysql.user</CODE>
table entry.  For example, if you had an entry with <CODE>User</CODE> and
<CODE>Host</CODE> fields of <CODE>'bob'</CODE> and <CODE>'%.loc.gov'</CODE>, you would write the
statement like this:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR 'bob'@'%.loc.gov' = PASSWORD('newpass');
</PRE>

<P>
That is equivalent to the following statements:

</P>

<PRE>
mysql&#62; UPDATE mysql.user SET Password=PASSWORD('newpass')
    -&#62; WHERE User='bob' AND Host='%.loc.gov';
mysql&#62; FLUSH PRIVILEGES;
</PRE>



<H3><A NAME="Table_maintenance_SQL" HREF="manual_toc.html#Table_maintenance_SQL">14.5.2  Table Maintenance Statements</A></H3>



<H4><A NAME="ANALYZE_TABLE" HREF="manual_toc.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1699"></A>

</P>

<PRE>
ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
</PRE>

<P>
This statement analyzes and stores the key distribution for a table.
During the analysis, the table is locked with a read lock.  This works on
<CODE>MyISAM</CODE> and <CODE>BDB</CODE> tables. For <CODE>MyISAM</CODE> tables, this
statement is equivalent to using <CODE>myisamchk -a</CODE>.

</P>
<P>
MySQL uses the stored key distribution to decide the order in which
tables should be joined when you perform a join on something other than a
constant.

</P>
<P>
The statement returns a table with the following columns:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Value</STRONG>
</TD></TR>
<TR><TD><CODE>Table</CODE> </TD><TD> The table name
</TD></TR>
<TR><TD><CODE>Op</CODE> </TD><TD> Always <CODE>analyze</CODE>
</TD></TR>
<TR><TD><CODE>Msg_type</CODE> </TD><TD> One of <CODE>status</CODE>, <CODE>error</CODE>, <CODE>info</CODE>, or <CODE>warning</CODE>
</TD></TR>
<TR><TD><CODE>Msg_text</CODE> </TD><TD> The message
</TD></TR>
</TABLE>

<P>
You can check the stored key distribution with the <CODE>SHOW INDEX</CODE> statement.
See section <A HREF="manual.html#Show_database_info">14.5.3.7  <CODE>SHOW DATABASES</CODE> Syntax</A>.

</P>
<P>
If the table hasn't changed since the last <CODE>ANALYZE TABLE</CODE> statement,
the table will not be analyzed again.

</P>
<P>
Before MySQL 4.1.1, <CODE>ANALYZE TABLE</CODE> statements are not written
to the binary log. As of MySQL 4.1.1, they are written to the binary
log unless the optional <CODE>NO_WRITE_TO_BINLOG</CODE> keyword 
(or its alias <CODE>LOCAL</CODE>) is used.

</P>



<H4><A NAME="BACKUP_TABLE" HREF="manual_toc.html#BACKUP_TABLE">14.5.2.2  <CODE>BACKUP TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1700"></A>

</P>
<P>
<A NAME="IDX1701"></A>

</P>

<PRE>
BACKUP TABLE tbl_name [, tbl_name] ... TO '/path/to/backup/directory'
</PRE>

<P>
<STRONG>Note:</STRONG> This statement is deprecated. We are working on a better
replacement for it that will provide online backup capabilities.
In the meantime, the <CODE>mysqlhotcopy</CODE> script can be used instead.

</P>
<P>
<CODE>BACKUP TABLE</CODE> copies to the backup directory the minimum number of
table files needed to restore the table, after flushing any buffered changes
to disk. The statement works only for <CODE>MyISAM</CODE> tables.  It copies the
<TT>`.frm'</TT> (definition)  and <TT>`.MYD'</TT> (data) files. The <TT>`.MYI'</TT>
(index) file can be rebuilt from those two files.
The directory should be specified as a full pathname.

</P>
<P>
Before using this statement, please see section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>.

</P>
<P>
During the backup, a read lock is held for each table, one at time,
as they are being backed up. If you want to back up several tables as
a snapshot (preventing any of them from being changed during the backup
operation), you must first issue a <CODE>LOCK TABLES</CODE> statement to obtain a read
lock for every table in the group.

</P>
<P>
The statement returns a table with the following columns:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Value</STRONG>
</TD></TR>
<TR><TD><CODE>Table</CODE> </TD><TD> The table name
</TD></TR>
<TR><TD><CODE>Op</CODE> </TD><TD> Always <CODE>backup</CODE>
</TD></TR>
<TR><TD><CODE>Msg_type</CODE> </TD><TD> One of <CODE>status</CODE>, <CODE>error</CODE>, <CODE>info</CODE>, or <CODE>warning</CODE>
</TD></TR>
<TR><TD><CODE>Msg_text</CODE> </TD><TD> The message
</TD></TR>
</TABLE>

<P>
<CODE>BACKUP TABLE</CODE> is available in MySQL 3.23.25 and later.

</P>



<H4><A NAME="CHECK_TABLE" HREF="manual_toc.html#CHECK_TABLE">14.5.2.3  <CODE>CHECK TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1702"></A>

</P>

<PRE>
CHECK TABLE tbl_name [, tbl_name] ... [option] ...

option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}
</PRE>

<P>
<CODE>CHECK TABLE</CODE> works only on <CODE>MyISAM</CODE> and <CODE>InnoDB</CODE> tables. On
<CODE>MyISAM</CODE> tables, This is the same thing as running <CODE>myisamchk
--medium-check tbl_name</CODE> on the table.

</P>
<P>
If you don't specify any option, <CODE>MEDIUM</CODE> is used.

</P>
<P>
Checks the table or tables for errors. For <CODE>MyISAM</CODE> tables, the key statistics
are updated. The statement returns a table with the following columns:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Value</STRONG>
</TD></TR>
<TR><TD><CODE>Table</CODE> </TD><TD> The table name
</TD></TR>
<TR><TD><CODE>Op</CODE> </TD><TD> Always <CODE>check</CODE>
</TD></TR>
<TR><TD><CODE>Msg_type</CODE> </TD><TD> One of <CODE>status</CODE>, <CODE>error</CODE>, <CODE>info</CODE>, or <CODE>warning</CODE>
</TD></TR>
<TR><TD><CODE>Msg_text</CODE> </TD><TD> The message
</TD></TR>
</TABLE>

<P>
Note that the statement might produce many rows of information for each
checked table.  The last row will have a <CODE>Msg_type</CODE> value of
<CODE>status</CODE> and the <CODE>Msg_text</CODE> normally should be <CODE>OK</CODE>.  If you
don't get <CODE>OK</CODE>, or <CODE>Table is already up to date</CODE> you should
normally run a repair of the table. See section <A HREF="manual.html#Table_maintenance">5.6.2  Using <CODE>myisamchk</CODE> for Table Maintenance and Crash Recovery</A>. <CODE>Table is
already up to date</CODE> means that the storage engine for the table indicated
that there was no need to check the table.

</P>
<P>
The different check types are as follows:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Type</STRONG> </TD><TD> <STRONG>Meaning</STRONG>
</TD></TR>
<TR><TD><CODE>QUICK</CODE> </TD><TD> Don't scan the rows to check for incorrect links.
</TD></TR>
<TR><TD><CODE>FAST</CODE> </TD><TD> Only check tables that haven't been closed properly.
</TD></TR>
<TR><TD><CODE>CHANGED</CODE> </TD><TD> Only check tables that have been changed since the last check or haven't been closed properly.
</TD></TR>
<TR><TD><CODE>MEDIUM</CODE> </TD><TD> Scan rows to verify that deleted links are okay. This also calculates a key checksum for the rows and verifies this with a calculated checksum for the keys.
</TD></TR>
<TR><TD><CODE>EXTENDED</CODE> </TD><TD> Do a full key lookup for all keys for each row.  This ensures that the table is 100% consistent, but will take a long time!
</TD></TR>
</TABLE>

<P>
If none of the options <CODE>QUICK</CODE>, <CODE>MEDIUM</CODE>, or <CODE>EXTENDED</CODE>
are specified, the default check type for dynamic-format <CODE>MyISAM</CODE>
tables is <CODE>MEDIUM</CODE>.  The default check type also is <CODE>MEDIUM</CODE> for
static-format <CODE>MyISAM</CODE> tables, unless <CODE>CHANGED</CODE> or <CODE>FAST</CODE>
is specified.  In that case, the default is <CODE>QUICK</CODE>. The row scan
is skipped for <CODE>CHANGED</CODE> and <CODE>FAST</CODE> because the rows are very
seldom corrupted.

</P>
<P>
You can combine check options, as in the following example, which does
a quick check on the table to see whether it was
closed properly:

</P>

<PRE>
CHECK TABLE test_table FAST QUICK;
</PRE>

<P>
<STRONG>Note:</STRONG> In some cases, <CODE>CHECK TABLE</CODE> will change the
table!  This happens if the table is marked as ``corrupted'' or ``not
closed properly'' but <CODE>CHECK TABLE</CODE> doesn't find any problems in the
table.  In this case, <CODE>CHECK TABLE</CODE> marks the table as okay.

</P>
<P>
If a table is corrupted, it's most likely that the problem is in
the indexes and not in the data part.  All of the preceding check types
check the indexes thoroughly and should thus find most errors.

</P>
<P>
If you just want to check a table that you assume is okay, you should use
no check options or the <CODE>QUICK</CODE> option. The latter should be used
when you are in a hurry and can take the very small risk that
<CODE>QUICK</CODE> doesn't find an error in the data file. (In most cases,
MySQL should find, under normal usage, any error in the data file.
If this happens, the table is marked as ``corrupted'' and cannot
be used until it's repaired.)

</P>
<P>
<CODE>FAST</CODE> and <CODE>CHANGED</CODE> are mostly intended to be used from a
script (for example, to be executed from <CODE>cron</CODE>) if you want to check your
table from time to time. In most cases, <CODE>FAST</CODE> is to be preferred
over <CODE>CHANGED</CODE>.  (The only case when it isn't preferred is when you suspect
that you have found a bug in the <CODE>MyISAM</CODE> code.)

</P>
<P>
<CODE>EXTENDED</CODE> is to be used only after you have run a normal check but
still get strange errors from a table when MySQL tries to
update a row or find a row by key. (This is very unlikely if a
normal check has succeeded!)

</P>
<P>
Some problems reported by <CODE>CHECK TABLE</CODE> can't be corrected automatically:

</P>

<UL>
<LI>

<CODE>Found row where the auto_increment column has the value 0</CODE>.

This means that you have a row in the table where the
<CODE>AUTO_INCREMENT</CODE> index column contains the value 0.
(It's possible to create a row where the <CODE>AUTO_INCREMENT</CODE> column is 0 by
explicitly setting the column to 0 with an <CODE>UPDATE</CODE> statement.)

This isn't an error in itself, but could cause trouble if you decide to
dump the table and restore it or do an <CODE>ALTER TABLE</CODE> on the
table. In this case, the <CODE>AUTO_INCREMENT</CODE> column will change value
according to the rules of <CODE>AUTO_INCREMENT</CODE> columns, which could cause
problems such as a duplicate-key error.

To get rid of the warning, just execute an <CODE>UPDATE</CODE> statement
to set the column to some other value than 0.
</UL>



<H4><A NAME="CHECKSUM_TABLE" HREF="manual_toc.html#CHECKSUM_TABLE">14.5.2.4  <CODE>CHECKSUM TABLE</CODE> Syntax</A></H4>
<P>
<A NAME="IDX1703"></A>

</P>

<PRE>
CHECKSUM TABLE tbl_name [, tbl_name] ... [ QUICK | EXTENDED ]
</PRE>

<P>
Reports a table checksum.

</P>
<P>
If <CODE>QUICK</CODE> is specified, the live table checksum is reported if it is
available, or <CODE>NULL</CODE> otherwise.  This is very fast.  A live checksum
is enabled by specifying the <CODE>CHECKSUM=1</CODE> table option, currently
supported only for <CODE>MyISAM</CODE> tables.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
In <CODE>EXTENDED</CODE> mode the whole table is read row by row and the checksum
is calculated. This can be very slow for large tables.

</P>
<P>
By default, if neither <CODE>QUICK</CODE> nor <CODE>EXTENDED</CODE> is specified, MySQL
returns a live checksum if the table storage engine supports it and scans
the table otherwise.

</P>
<P>
This statement is implemented in MySQL 4.1.1.

</P>



<H4><A NAME="OPTIMIZE_TABLE" HREF="manual_toc.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1704"></A>

</P>
<P>
<A NAME="IDX1705"></A>
<A NAME="IDX1706"></A>

</P>

<PRE>
OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
</PRE>

<P>
<CODE>OPTIMIZE TABLE</CODE> should be used if you have deleted a large part of a
table or if you have made many changes to a table with variable-length rows
(tables that have <CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, or <CODE>TEXT</CODE> columns).
Deleted records are maintained in a linked list and subsequent <CODE>INSERT</CODE>
operations reuse old record positions. You can use <CODE>OPTIMIZE TABLE</CODE> to
reclaim the unused space and to defragment the data file.

</P>
<P>
In most setups, you need not run <CODE>OPTIMIZE TABLE</CODE> at all.  Even
if you do a lot of updates to variable-length rows, it's not likely that
you need to do this more than once a week or month and only on certain
tables.

</P>
<P>
For the moment, <CODE>OPTIMIZE TABLE</CODE> works only on <CODE>MyISAM</CODE> and
<CODE>BDB</CODE> tables. For <CODE>BDB</CODE> tables, <CODE>OPTIMIZE TABLE</CODE> is
currently mapped to <CODE>ANALYZE TABLE</CODE>.
See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A>.

</P>
<P>
You can get <CODE>OPTIMIZE TABLE</CODE> to work on other table types by starting
<CODE>mysqld</CODE> with the <CODE>--skip-new</CODE> or <CODE>--safe-mode</CODE> option,
but in this case, <CODE>OPTIMIZE TABLE</CODE> is just mapped to <CODE>ALTER TABLE</CODE>.

</P>
<P>
<CODE>OPTIMIZE TABLE</CODE> works as follows:

<OL>
<LI>

If the table has deleted or split rows, repair the table.
<LI>

If the index pages are not sorted, sort them.
<LI>

If the statistics are not up to date (and the repair couldn't be done
by sorting the index), update them.
</OL>

<P>
Note that MySQL locks the table during the time <CODE>OPTIMIZE TABLE</CODE> is
running.

</P>
<P>
Before MySQL 4.1.1, <CODE>OPTIMIZE TABLE</CODE> statements are not written
to the binary log. As of MySQL 4.1.1, they are written to the binary
log unless the optional <CODE>NO_WRITE_TO_BINLOG</CODE> keyword 
(or its alias <CODE>LOCAL</CODE>) is used.

</P>



<H4><A NAME="REPAIR_TABLE" HREF="manual_toc.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1707"></A>

</P>

<PRE>
REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE
    tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM]
</PRE>

<P>
<CODE>REPAIR TABLE</CODE> repairs a possibly corrupted table.
By default,
it has the same effect as <CODE>myisamchk --recover tbl_name</CODE> on a table.
<CODE>REPAIR TABLE</CODE> works only on <CODE>MyISAM</CODE> tables.

</P>
<P>
Normally you should never have to run this statement. However, if disaster
strikes, <CODE>REPAIR TABLE</CODE> is very likely to get back all your data from
a <CODE>MyISAM</CODE> table.  If your tables become corrupted often, you should try
to find the reason for it, to eliminate the need to use <CODE>REPAIR TABLE</CODE>.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.  See section <A HREF="manual.html#MyISAM_table_problems">15.1.4  <CODE>MyISAM</CODE> Table Problems</A>.

</P>
<P>
The statement returns a table with the following columns:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Value</STRONG>
</TD></TR>
<TR><TD><CODE>Table</CODE> </TD><TD> The table name
</TD></TR>
<TR><TD><CODE>Op</CODE> </TD><TD> Always <CODE>repair</CODE>
</TD></TR>
<TR><TD><CODE>Msg_type</CODE> </TD><TD> One of <CODE>status</CODE>, <CODE>error</CODE>, <CODE>info</CODE>, or <CODE>warning</CODE>
</TD></TR>
<TR><TD><CODE>Msg_text</CODE> </TD><TD> The message
</TD></TR>
</TABLE>

<P>
The <CODE>REPAIR TABLE</CODE> statement might produce many rows of information
for each repaired table.  The last row will have a <CODE>Msg_type</CODE> value of
<CODE>status</CODE> and <CODE>Msg_test</CODE> normally should be <CODE>OK</CODE>.  If you
don't get <CODE>OK</CODE>, you should try repairing the table with <CODE>myisamchk
--safe-recover</CODE>, because <CODE>REPAIR TABLE</CODE> does not yet implement all the
options of <CODE>myisamchk</CODE>. We plan to make it more flexible in the future.

</P>
<P>
If <CODE>QUICK</CODE> is given, <CODE>REPAIR TABLE</CODE> tries to repair
only the index tree.  This type of repair is like that done by
<CODE>myisamchk --recover --quick</CODE>.

</P>
<P>
If you use <CODE>EXTENDED</CODE>, MySQL creates the index row by row instead of
creating one index at a time with sorting.  (Before MySQL 4.1, this might
be better than sorting on fixed-length keys if you have long <CODE>CHAR</CODE>
keys that compress very well.)  This type of repair is like that done by
<CODE>myisamchk --safe-recover</CODE>.

</P>
<P>
As of MySQL 4.0.2, there is a <CODE>USE_FRM</CODE> mode for <CODE>REPAIR TABLE</CODE>.
Use it if the <TT>`.MYI'</TT> index file is missing or if its header is
corrupted.  In this mode, MySQL will re-create the <TT>`.MYI'</TT> file using
information from the <TT>`.frm'</TT> file. This kind of repair cannot be done
with <CODE>myisamchk</CODE>.

</P>
<P>
<STRONG>Warning:</STRONG> If the server dies during a <CODE>REPAIR TABLE</CODE> operation,
it's essential after restarting it that you immediately execute another
<CODE>REPAIR TABLE</CODE> statement for the table before performing any other
operations on it. (It's always good to start by making a backup.)  In the
worst case, you might have a new clean index file without information about
the data file, and then the next operation you perform could overwrite the
data file.  This is an unlikely, but possible scenario.

</P>
<P>
Before MySQL 4.1.1, <CODE>REPAIR TABLE</CODE> statements are not written
to the binary log. As of MySQL 4.1.1, they are written to the binary
log unless the optional <CODE>NO_WRITE_TO_BINLOG</CODE> keyword 
(or its alias <CODE>LOCAL</CODE>) is used.

</P>



<H4><A NAME="RESTORE_TABLE" HREF="manual_toc.html#RESTORE_TABLE">14.5.2.7  <CODE>RESTORE TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1708"></A>

</P>


<PRE>
RESTORE TABLE tbl_name [, tbl_name] ... FROM '/path/to/backup/directory'
</PRE>

<P>
Restores the table or tables from a backup that was made with <CODE>BACKUP
TABLE</CODE>. Existing tables will not be overwritten; if you try to restore over
an existing table, you will get an error.  Just as <CODE>BACKUP TABLE</CODE>,
<CODE>RESTORE TABLE</CODE> currently works only for <CODE>MyISAM</CODE> tables.
The directory should be specified as a full pathname.

</P>
<P>
The backup for each table consists of its <TT>`.frm'</TT> format file and
<TT>`.MYD'</TT> data file. The restore operation restores those files, then
uses them to rebuild the <TT>`.MYI'</TT> index file.  Restoring takes longer
than backing up due to the need to rebuild the index. The more indexes the
table has, the longer it will take.

</P>
<P>
The statement returns a table with the following columns:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Column</STRONG> </TD><TD> <STRONG>Value</STRONG>
</TD></TR>
<TR><TD><CODE>Table</CODE> </TD><TD> The table name
</TD></TR>
<TR><TD><CODE>Op</CODE> </TD><TD> Always <CODE>restore</CODE>
</TD></TR>
<TR><TD><CODE>Msg_type</CODE> </TD><TD> One of <CODE>status</CODE>, <CODE>error</CODE>, <CODE>info</CODE>, or <CODE>warning</CODE>
</TD></TR>
<TR><TD><CODE>Msg_text</CODE> </TD><TD> The message
</TD></TR>
</TABLE>



<H3><A NAME="SHOW" HREF="manual_toc.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A></H3>

<P>
<A NAME="IDX1709"></A>
<A NAME="IDX1710"></A>
<A NAME="IDX1711"></A>
<A NAME="IDX1712"></A>
<A NAME="IDX1713"></A>
<A NAME="IDX1714"></A>
<A NAME="IDX1715"></A>
<A NAME="IDX1716"></A>
<A NAME="IDX1717"></A>
<A NAME="IDX1718"></A>
<A NAME="IDX1719"></A>
<A NAME="IDX1720"></A>
<A NAME="IDX1721"></A>
<A NAME="IDX1722"></A>
<A NAME="IDX1723"></A>
<A NAME="IDX1724"></A>
<A NAME="IDX1725"></A>
<A NAME="IDX1726"></A>
<A NAME="IDX1727"></A>
<A NAME="IDX1728"></A>
<A NAME="IDX1729"></A>

</P>

<P>
<CODE>SET</CODE> allows you to set variables and options.

</P>
<P>
<CODE>SHOW</CODE> has many forms that provide information about databases,
tables, columns, or status information about the server.
This section describes those following:

</P>

<PRE>
SHOW [FULL] COLUMNS FROM tbl_name [FROM db_name] [LIKE 'pattern']
SHOW CREATE DATABASE db_name
SHOW CREATE TABLE tbl_name
SHOW DATABASES [LIKE 'pattern']
SHOW [STORAGE] ENGINES
SHOW ERRORS [LIMIT [offset,] row_count]
SHOW GRANTS FOR user
SHOW INDEX FROM tbl_name [FROM db_name]
SHOW INNODB STATUS
SHOW [BDB] LOGS
SHOW PRIVILEGES
SHOW [FULL] PROCESSLIST
SHOW STATUS [LIKE 'pattern']
SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern']
SHOW [OPEN] TABLES [FROM db_name] [LIKE 'pattern']
SHOW [GLOBAL | SESSION] VARIABLES [LIKE 'pattern']
SHOW WARNINGS [LIMIT [offset,] row_count]
</PRE>

<P>
If the syntax for a given <CODE>SHOW</CODE> statement includes a <CODE>LIKE
'pattern'</CODE> part, <CODE>'pattern'</CODE> is a string that can contain the SQL <SAMP>`%'</SAMP>
and <SAMP>`_'</SAMP> wildcard characters.
The pattern is useful for restricting statement output to matching values.

</P>
<P>
Note that there are other forms of these statements described elsewhere:

</P>

<UL>
<LI>

The <CODE>SET PASSWORD</CODE> statement for assigning account passwords is
described in
See section <A HREF="manual.html#SET_PASSWORD">14.5.1.3  <CODE>SET PASSWORD</CODE> Syntax</A>.

<LI>

The <CODE>SHOW</CODE> statement has forms that provide information about
replication master and slave servers:

<A NAME="IDX1730"></A>
<A NAME="IDX1731"></A>
<A NAME="IDX1732"></A>
<A NAME="IDX1733"></A>
<A NAME="IDX1734"></A>


<PRE>
SHOW BINLOG EVENTS
SHOW MASTER LOGS
SHOW MASTER STATUS
SHOW SLAVE HOSTS
SHOW SLAVE STATUS
</PRE>

These forms of <CODE>SHOW</CODE> are described in section <A HREF="manual.html#Replication_SQL">14.6  Replication Statements</A>.

</UL>



<H4><A NAME="SET_OPTION" HREF="manual_toc.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1735"></A>
<A NAME="IDX1736"></A>

</P>


<PRE>
SET variable_assignment [, variable_assignment] ...

variable_assignment:
      user_var_name = expr
    | [GLOBAL | SESSION] system_var_name = expr
    | @@[global. | session.]system_var_name = expr
</PRE>

<P>
<CODE>SET</CODE> sets different types of variables that affect the operation of the
server or your client. It can be used to assign values to user variables or
system variables.

</P>
<P>
In MySQL 4.0.3, we added the <CODE>GLOBAL</CODE> and <CODE>SESSION</CODE> options
and allowed most important system variables to be changed dynamically at
runtime.
The system variables that you can set at runtime are described in
section <A HREF="manual.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A>.

</P>
<P>
In older versions of MySQL, we allowed the use of the <CODE>SET OPTION</CODE> syntax,
but this is now deprecated; just leave out the word <CODE>OPTION</CODE>.

</P>
<P>
The following examples shows the different syntaxes you can use to set
variables.

</P>
<P>
A user variable is written as <CODE>@var_name</CODE> and can be set as follows:

</P>

<PRE>
SET @var_name = expr;
</PRE>

<P>
Further information about user variables is given in section <A HREF="manual.html#Variables">10.3  User Variables</A>.

</P>
<P>
System variables can be referred to in <CODE>SET</CODE> statements as
<CODE>var_name</CODE>. The name optionally can be preceded by <CODE>GLOBAL</CODE> or
<CODE>@@global.</CODE> to indicate explicitly that the variable is a global
variable, or by <CODE>SESSION</CODE>, <CODE>@@session.</CODE>, or <CODE>@@</CODE> to
indicate that it is a session variable.  <CODE>LOCAL</CODE> and <CODE>@@local.</CODE>
are synonyms for <CODE>SESSION</CODE> and <CODE>@@session.</CODE>. If no modifier is
present, <CODE>SET</CODE> sets the session variable.

</P>
<P>
The <CODE>@@var_name</CODE> syntax for system variables is supported to make
MySQL syntax compatible with some other databases.

</P>
<P>
If you set several system variables in the same statement, the last used
<CODE>GLOBAL</CODE> or <CODE>SESSION</CODE> option is used for variables that have no mode
specified.

</P>

<PRE>
SET sort_buffer_size=10000;
SET @@local.sort_buffer_size=10000;
SET GLOBAL sort_buffer_size=1000000, SESSION sort_buffer_size=1000000;
SET @@sort_buffer_size=1000000;
SET @@global.sort_buffer_size=1000000, @@local.sort_buffer_size=1000000;
</PRE>

<P>
If you set a system variable using <CODE>SESSION</CODE> (the default), the value
remains in effect until the current session ends or until you set the
variable to a different value. If you set a system variable using
<CODE>GLOBAL</CODE>, which requires the <CODE>SUPER</CODE> privilege, the value is
remembered and used for new connections until the server restarts. If you
want to make a variable setting permanent, you should put it in an option
file.  See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
To prevent incorrect usage, MySQL produces an error if you use <CODE>SET
GLOBAL</CODE> with a variable that can only be used with <CODE>SET SESSION</CODE> or if
you do not specify <CODE>GLOBAL</CODE> when setting a global variable.

</P>
<P>
If you want to set a <CODE>SESSION</CODE> variable to the <CODE>GLOBAL</CODE> value or a
<CODE>GLOBAL</CODE> value to the compiled-in MySQL default value, you can set it to
<CODE>DEFAULT</CODE>. For example, the following two statements are identical in
setting the session value of <CODE>max_join_size</CODE> to the global value:

</P>

<PRE>
SET max_join_size=DEFAULT;
SET @@session.max_join_size=@@global.max_join_size;
</PRE>

<P>
You can get a list of most system variables with <CODE>SHOW VARIABLES</CODE>.
See section <A HREF="manual.html#SHOW_VARIABLES">14.5.3.19  <CODE>SHOW VARIABLES</CODE> Syntax</A>.
To get a specific variable name or list of names that match a pattern, use a
<CODE>LIKE</CODE> clause:

</P>

<PRE>
SHOW VARIABLES LIKE 'max_join_size';
SHOW GLOBAL VARIABLES LIKE 'max_join_size';
</PRE>

<P>
You can also get the value for a specific value by using the
<CODE>@@[global.|local.]var_name</CODE> syntax with <CODE>SELECT</CODE>:

</P>

<PRE>
SELECT @@max_join_size, @@global.max_join_size;
</PRE>

<P>
When you retrieve a variable with <CODE>SELECT @@var_name</CODE> (that is, you
do not specify <CODE>global.</CODE>, <CODE>session.</CODE>, or <CODE>local.</CODE>), MySQL returns
the <CODE>SESSION</CODE> value if it exists and the <CODE>GLOBAL</CODE> value otherwise.

</P>
<P>
The following list describes variables that have non-standard syntax or that are
not described in the list of system variables that is found in
section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
Although these variables are not displayed by <CODE>SHOW VARIABLES</CODE>, you can
obtain their values with <CODE>SELECT</CODE> (with the exception of <CODE>CHARACTER
SET</CODE>). For example:

</P>

<PRE>
mysql&#62; SELECT @@AUTOCOMMIT;
+--------------+
| @@autocommit |
+--------------+
|            1 |
+--------------+
</PRE>

<DL COMPACT>

<DT><CODE>AUTOCOMMIT = {0 | 1}</CODE>
<DD>
Set the autocommit mode.
If set to <CODE>1</CODE>, all changes to a table take effect immediately.
If set to <CODE>0</CODE>, you have to use <CODE>COMMIT</CODE> to accept a transaction or
<CODE>ROLLBACK</CODE> to cancel it.  Note that when you change <CODE>AUTOCOMMIT</CODE>
mode from <CODE>0</CODE> to <CODE>1</CODE>, MySQL performs an automatic <CODE>COMMIT</CODE>
of any open transaction.  Another way to begin a transaction is to use a
<CODE>START TRANSACTION</CODE> or <CODE>BEGIN</CODE> statement.
See section <A HREF="manual.html#COMMIT">14.4.1  <CODE>START TRANSACTION</CODE>, <CODE>COMMIT</CODE>, and <CODE>ROLLBACK</CODE> Syntax</A>.

<DT><CODE>BIG_TABLES = {0 | 1}</CODE>
<DD>
<A NAME="IDX1737"></A>
If set to <CODE>1</CODE>, all temporary tables are stored on disk rather than in
memory.  This is a little slower, but the error <CODE>The table tbl_name is
full</CODE> will not occur for <CODE>SELECT</CODE> operations that require a large
temporary table.  The default value for a new connection is
<CODE>0</CODE> (use in-memory temporary tables).  As of MySQL 4.0, you
should normally never need to set this variable, because MySQL automatically
converts in-memory tables to disk-based tables as necessary.  This variable
previously was named <CODE>SQL_BIG_TABLES</CODE>.

<DT><CODE>CHARACTER SET {charset_name | DEFAULT}</CODE>
<DD>
This maps all strings from and to the client with the given mapping.
Before MySQL 4.1, the only allowable value for <CODE>charset_name</CODE>
is <CODE>cp1251_koi8</CODE>, but you can add new mappings by editing the
<TT>`sql/convert.cc'</TT> file in the MySQL source distribution.  As of MySQL
4.1.1, <CODE>SET CHARACTER SET</CODE> sets three session system variables:
<CODE>character_set_client</CODE> and <CODE>character_set_results</CODE> are set to
the given character set, and <CODE>character_set_connection</CODE> to the value
of <CODE>character_set_database</CODE>.

The default mapping can be restored by using a value of <CODE>DEFAULT</CODE>.

Note that the syntax for <CODE>SET CHARACTER SET</CODE> differs
from that for setting most other options.

<DT><CODE>FOREIGN_KEY_CHECKS = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE> (the default), foreign key constraints for <CODE>InnoDB</CODE>
tables are checked.  If set to <CODE>0</CODE>, they are ignored.  Disabling foreign
key checking can be useful for reloading <CODE>InnoDB</CODE> tables in an order
different than that required by their parent/child relationships.
This variable was added in MySQL 3.23.52.
See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.

<DT><CODE>IDENTITY = value</CODE>
<DD>
The variable is a synonym for the <CODE>LAST_INSERT_ID</CODE> variable.
It exists for compatibility with other databases.
As of MySQL 3.23.25, you can read its value with <CODE>SELECT @@IDENTITY</CODE>.
As of MySQL 4.0.3, you can also set its value with <CODE>SET IDENTITY</CODE>.

<DT><CODE>INSERT_ID = value</CODE>
<DD>
Set the value to be used by the following <CODE>INSERT</CODE> or <CODE>ALTER TABLE</CODE>
statement when inserting an <CODE>AUTO_INCREMENT</CODE> value.  This is mainly used
with the binary log.

<DT><CODE>LAST_INSERT_ID = value</CODE>
<DD>
Set the value to be returned from <CODE>LAST_INSERT_ID()</CODE>. This is stored in
the binary log when you use <CODE>LAST_INSERT_ID()</CODE> in a statement that updates
a table. Setting this variable does not update theh value returned by the
<CODE>mysql_insert_id()</CODE> C API function.

<DT><CODE>NAMES {'charset_name' | DEFAULT}</CODE>
<DD>
<CODE>SET NAMES</CODE> sets the three session system variables
<CODE>character_set_client</CODE>, <CODE>character_set_connection</CODE>, and
<CODE>character_set_results</CODE> to the given character set.

The default mapping can be restored by using a value of <CODE>DEFAULT</CODE>.

Note that the syntax for <CODE>SET NAMES</CODE> differs
from that for setting most other options.
This statement is available as of MySQL 4.1.0.

<DT><CODE>SQL_AUTO_IS_NULL = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE> (the default), you can find the last inserted row for a table
that contains an <CODE>AUTO_INCREMENT</CODE> column by using the following construct:


<PRE>
WHERE auto_increment_column IS NULL
</PRE>

This behavior is used by some ODBC programs, such as Access.
<CODE>SQL_AUTO_IS_NULL</CODE> was added in MySQL 3.23.52.

<DT><CODE>SQL_BIG_SELECTS = {0 | 1}</CODE>
<DD>
If set to <CODE>0</CODE>, MySQL aborts <CODE>SELECT</CODE> statements
that probably will take a very long time (that is, statements for which
the optimizer estimates that the number of of examined rows will
exceed the value of <CODE>max_join_size</CODE>).
This is useful when an inadvisable <CODE>WHERE</CODE> statement has been
issued.  The default value for a new connection is <CODE>1</CODE>, which allows
all <CODE>SELECT</CODE> statements.

If you set the <CODE>max_join_size</CODE> system variable to a value other than
<CODE>DEFAULT</CODE>, <CODE>SQL_BIG_SELECTS</CODE> will be set to <CODE>0</CODE>.

<DT><CODE>SQL_BUFFER_RESULT = {0 | 1}</CODE>
<DD>
<CODE>SQL_BUFFER_RESULT</CODE> forces results from <CODE>SELECT</CODE> statements
to be put into temporary tables. This helps MySQL free the
table locks early and can be beneficial in cases where it takes a long time to
send results to the client.
This variable was added in MySQL 3.23.13.

<DT><CODE>SQL_LOG_BIN = {0 | 1}</CODE>
<DD>
If set to <CODE>0</CODE>, no logging is done to the binary log for the client.
The client must have the <CODE>SUPER</CODE> privilege to set this option.
This variable was added in MySQL 3.23.16.

<DT><CODE>SQL_LOG_OFF = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE>, no logging is done to the general query log for this
client.  The client must have the <CODE>SUPER</CODE> privilege to set this option.

<DT><CODE>SQL_LOG_UPDATE = {0 | 1}</CODE>
<DD>
If set to <CODE>0</CODE>, no logging is done to the update log for the client.
The client must have the <CODE>SUPER</CODE> privilege to set this option.
This variable was added in MySQL 3.22.5.
Starting from MySQL 5.0.0, it is deprecated and is mapped to
<CODE>SQL_LOG_BIN</CODE> (see section <A HREF="manual.html#News-5.0.0">C.1.2  Changes in release 5.0.0 (22 Dec 2003: Alpha)</A>).

<DT><CODE>SQL_QUOTE_SHOW_CREATE = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE>, <CODE>SHOW CREATE TABLE</CODE> quotes table and column
names. If set to <CODE>0</CODE>, quoting is disabled.  This option is enabled
by default so that replication will work for tables with table and column
names that require quoting.
This variable was added in MySQL 3.23.26.
section <A HREF="manual.html#SHOW_CREATE_TABLE">14.5.3.6  <CODE>SHOW CREATE TABLE</CODE> Syntax</A>.

<DT><CODE>SQL_SAFE_UPDATES = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE>, MySQL aborts <CODE>UPDATE</CODE> or <CODE>DELETE</CODE> statements
that do not use a key in the <CODE>WHERE</CODE> clause or a <CODE>LIMIT</CODE> clause.
This makes it possible to catch <CODE>UPDATE</CODE> or <CODE>DELETE</CODE> statements
where keys are not used properly and that would probably change or delete a
large number of rows.
This variable was added in MySQL 3.22.32.

<DT><CODE>SQL_SELECT_LIMIT = {value | DEFAULT}</CODE>
<DD>
The maximum number of records to return from <CODE>SELECT</CODE> statements.  The
default value for a new connection is ``unlimited.'' If you have changed the
limit, the default value can be restored by using a <CODE>SQL_SELECT_LIMIT</CODE>
value of <CODE>DEFAULT</CODE>.

If a <CODE>SELECT</CODE> has a <CODE>LIMIT</CODE> clause, the <CODE>LIMIT</CODE> takes
precedence over the value of <CODE>SQL_SELECT_LIMIT</CODE>.

<DT><CODE>SQL_WARNINGS = {0 | 1}</CODE>
<DD>
This variable controls whether single-row <CODE>INSERT</CODE> statements produce
an information string if warnings occur.  The default is 0.  Set the value
to 1 to produce an information string.
This variable was added in MySQL 3.22.11.

<DT><CODE>TIMESTAMP = {timestamp_value | DEFAULT}</CODE>
<DD>
Set the time for this client.  This is used to get the original timestamp if
you use the binary log to restore rows.  <CODE>timestamp_value</CODE> should be a
Unix epoch timestamp, not a MySQL timestamp.

<DT><CODE>UNIQUE_CHECKS = {0 | 1}</CODE>
<DD>
If set to <CODE>1</CODE> (the default), uniqueness checks for secondary indexes in
<CODE>InnoDB</CODE> tables are performed.  If set to <CODE>0</CODE>, no uniqueness
checks are done.  This variable was added in MySQL 3.23.52.
See section <A HREF="manual.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A>.

</DL>



<H4><A NAME="SHOW_CHARACTER_SET" HREF="manual_toc.html#SHOW_CHARACTER_SET">14.5.3.2  <CODE>SHOW CHARACTER SET</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1738"></A>

</P>

<PRE>
SHOW CHARACTER SET [LIKE 'pattern']
</PRE>

<P>
The <CODE>SHOW CHARACTER SET</CODE> statement shows all available character sets.
It takes an optional <CODE>LIKE</CODE> clause that indicates which character set
names to match. For example:

</P>

<PRE>
mysql&#62; SHOW CHARACTER SET LIKE 'latin%';
+---------+-----------------------------+-------------------+--------+
| Charset | Description                 | Default collation | Maxlen |
+---------+-----------------------------+-------------------+--------+
| latin1  | ISO 8859-1 West European    | latin1_swedish_ci |      1 |
| latin2  | ISO 8859-2 Central European | latin2_general_ci |      1 |
| latin5  | ISO 8859-9 Turkish          | latin5_turkish_ci |      1 |
| latin7  | ISO 8859-13 Baltic          | latin7_general_ci |      1 |
+---------+-----------------------------+-------------------+--------+
</PRE>

<P>
The <CODE>Maxlen</CODE> column shows the maximum number of bytes used to
store one character.

</P>
<P>
<CODE>SHOW CHARACTER SET</CODE> is available as of MySQL 4.1.0.

</P>



<H4><A NAME="SHOW_COLLATION" HREF="manual_toc.html#SHOW_COLLATION">14.5.3.3  <CODE>SHOW COLLATION</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1739"></A>

</P>

<PRE>
SHOW COLLATION [LIKE 'pattern']
</PRE>

<P>
The output from <CODE>SHOW COLLATION</CODE> includes all available character
sets.
It takes an optional <CODE>LIKE</CODE> clause that indicates which collation
names to match. For example:

</P>

<PRE>
mysql&#62; SHOW COLLATION LIKE 'latin1%';
+-------------------+---------+----+---------+----------+---------+
| Collation         | Charset | Id | Default | Compiled | Sortlen |
+-------------------+---------+----+---------+----------+---------+
| latin1_german1_ci | latin1  |  5 |         |          |       0 |
| latin1_swedish_ci | latin1  |  8 | Yes     | Yes      |       0 |
| latin1_danish_ci  | latin1  | 15 |         |          |       0 |
| latin1_german2_ci | latin1  | 31 |         | Yes      |       2 |
| latin1_bin        | latin1  | 47 |         | Yes      |       0 |
| latin1_general_ci | latin1  | 48 |         |          |       0 |
| latin1_general_cs | latin1  | 49 |         |          |       0 |
| latin1_spanish_ci | latin1  | 94 |         |          |       0 |
+-------------------+---------+----+---------+----------+---------+
</PRE>

<P>
The <CODE>Default</CODE> column indicates whether a collation is the
default for its character set.
<CODE>Compiled</CODE> indicates whether the character set is
compiled into the server.
<CODE>Sortlen</CODE> is related to the amount of memory required to sort strings
expressed in the character set.

</P>
<P>
<CODE>SHOW COLLATION</CODE> is available as of MySQL 4.1.0.

</P>



<H4><A NAME="SHOW_COLUMNS" HREF="manual_toc.html#SHOW_COLUMNS">14.5.3.4  <CODE>SHOW COLUMNS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1740"></A>
<A NAME="IDX1741"></A>

</P>

<PRE>
SHOW [FULL] COLUMNS FROM tbl_name [FROM db_name] [LIKE 'pattern']
</PRE>

<P>
<CODE>SHOW COLUMNS</CODE> lists the columns in a given table.  If the column types
differ from what you expect them to be based on your <CODE>CREATE TABLE</CODE>
statement, note that MySQL sometimes changes column types when you create or
alter a table.  The conditions for which this occurs are described in
section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.

</P>
<P>
The <CODE>FULL</CODE> keyword can be used from MySQL 3.23.32 on. It causes the
output to include the privileges you have for each column.  As of MySQL 4.1,
<CODE>FULL</CODE> also causes any per-column comments to be displayed.

</P>
<P>
You can use <CODE>db_name.tbl_name</CODE> as an alternative to the <CODE>tbl_name
FROM db_name</CODE> syntax.  These two statements are equivalent:

</P>

<PRE>
mysql&#62; SHOW COLUMNS FROM mytable FROM mydb;
mysql&#62; SHOW COLUMNS FROM mydb.mytable;
</PRE>

<P>
<CODE>SHOW FIELDS</CODE> is a synonym for <CODE>SHOW COLUMNS</CODE>.  You can also
list a table's columns with the <CODE>mysqlshow db_name tbl_name</CODE> command.

</P>
<P>
The <CODE>DESCRIBE</CODE> statement provides information similar to
<CODE>SHOW COLUMNS</CODE>.
See section <A HREF="manual.html#DESCRIBE">14.3.1  <CODE>DESCRIBE</CODE> Syntax (Get Information About Columns)</A>.

</P>



<H4><A NAME="SHOW_CREATE_DATABASE" HREF="manual_toc.html#SHOW_CREATE_DATABASE">14.5.3.5  <CODE>SHOW CREATE DATABASE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1742"></A>

</P>

<PRE>
SHOW CREATE DATABASE db_name
</PRE>

<P>
Shows a <CODE>CREATE DATABASE</CODE> statement that will create the given database.
It was added in MySQL 4.1.

</P>

<PRE>
mysql&#62; SHOW CREATE DATABASE test\G
*************************** 1. row ***************************
       Database: test
Create Database: CREATE DATABASE `test`
                 /*!40100 DEFAULT CHARACTER SET latin1 */
</PRE>



<H4><A NAME="SHOW_CREATE_TABLE" HREF="manual_toc.html#SHOW_CREATE_TABLE">14.5.3.6  <CODE>SHOW CREATE TABLE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1743"></A>

</P>

<PRE>
SHOW CREATE TABLE tbl_name
</PRE>

<P>
Shows a <CODE>CREATE TABLE</CODE> statement that will create the given table.
It was added in MySQL 3.23.20.

</P>

<PRE>
mysql&#62; SHOW CREATE TABLE t\G
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE t (
  id INT(11) default NULL auto_increment,
  s char(60) default NULL,
  PRIMARY KEY (id)
) TYPE=MyISAM

</PRE>

<P>
<CODE>SHOW CREATE TABLE</CODE> quotes table and column names according to
the value of the <CODE>SQL_QUOTE_SHOW_CREATE</CODE> option.
section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>



<H4><A NAME="Show_database_info" HREF="manual_toc.html#Show_database_info">14.5.3.7  <CODE>SHOW DATABASES</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1744"></A>
<A NAME="IDX1745"></A>

</P>

<PRE>
SHOW DATABASES [LIKE 'pattern']
</PRE>

<P>
<CODE>SHOW DATABASES</CODE> lists the databases on the MySQL server host.
You can also get this list using the <CODE>mysqlshow</CODE> command.
As of MySQL 4.0.2, you will see only those databases for which you have some
kind of privilege, if you don't have the global <CODE>SHOW DATABASES</CODE>
privilege.

</P>
<P>
If the server was started with the <CODE>--skip-show-database</CODE> option, you
cannot use this statement at all unless you have the <CODE>SHOW DATABASES</CODE>
privilege.

</P>



<H4><A NAME="SHOW_ENGINES" HREF="manual_toc.html#SHOW_ENGINES">14.5.3.8  <CODE>SHOW ENGINES</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1746"></A>
<A NAME="IDX1747"></A>
<A NAME="IDX1748"></A>

</P>

<PRE>
SHOW [STORAGE] ENGINES
</PRE>

<P>
<CODE>SHOW ENGINES</CODE> shows you status information about the storage engines.
This is particularly useful for checking whether a storage engine is
supported, or to see what the default engine is.
This statement is implemented in MySQL 4.1.2.
<CODE>SHOW TABLE TYPES</CODE> is a deprecated synonym.

</P>

<PRE>
mysql&#62; SHOW ENGINES\G
*************************** 1. row ***************************
   Type: MyISAM
Support: DEFAULT
Comment: Default type from 3.23 with great performance
*************************** 2. row ***************************
   Type: HEAP
Support: YES
Comment: Hash based, stored in memory, useful for temporary tables
*************************** 3. row ***************************
   Type: MEMORY
Support: YES
Comment: Alias for HEAP
*************************** 4. row ***************************
   Type: MERGE
Support: YES
Comment: Collection of identical MyISAM tables
*************************** 5. row ***************************
   Type: MRG_MYISAM
Support: YES
Comment: Alias for MERGE
*************************** 6. row ***************************
   Type: ISAM
Support: NO
Comment: Obsolete table type; Is replaced by MyISAM
*************************** 7. row ***************************
   Type: MRG_ISAM
Support: NO
Comment: Obsolete table type; Is replaced by MRG_MYISAM
*************************** 8. row ***************************
   Type: InnoDB
Support: YES
Comment: Supports transactions, row-level locking and foreign keys
*************************** 9. row ***************************
   Type: INNOBASE
Support: YES
Comment: Alias for INNODB
*************************** 10. row ***************************
   Type: BDB
Support: YES
Comment: Supports transactions and page-level locking
*************************** 11. row ***************************
   Type: BERKELEYDB
Support: YES
Comment: Alias for BDB
</PRE>

<P>
A <CODE>Support</CODE> value indicates whether the particular storage engine is
supported, and which is the default engine. For example, if the server
is started with the <CODE>--default-table-type=InnoDB</CODE> option, then
the <CODE>Support</CODE> value for the <CODE>InnoDB</CODE> row will have the value
<CODE>DEFAULT</CODE>.

</P>



<H4><A NAME="SHOW_ERRORS" HREF="manual_toc.html#SHOW_ERRORS">14.5.3.9  <CODE>SHOW ERRORS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1749"></A>

</P>

<PRE>
SHOW ERRORS [LIMIT [offset,] row_count]
SHOW COUNT(*) ERRORS
</PRE>

<P>
This statement is similar to <CODE>SHOW WARNINGS</CODE>, except that instead
of displaying errors, warnings, and notes, it displays only errors.
<CODE>SHOW ERRORS</CODE> is available as of MySQL 4.1.0.

</P>
<P>
The <CODE>LIMIT</CODE> clause has the same syntax as for the <CODE>SELECT</CODE>
statement.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

</P>
<P>
The <CODE>SHOW COUNT(*) ERRORS</CODE> statement displays the number of errors.
You can also retrieve this number from the <CODE>error_count</CODE> variable:

</P>

<PRE>
SHOW COUNT(*) ERRORS;
SELECT @@error_count;
</PRE>

<P>
For more information, see section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.

</P>



<H4><A NAME="SHOW_GRANTS" HREF="manual_toc.html#SHOW_GRANTS">14.5.3.10  <CODE>SHOW GRANTS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1750"></A>
<A NAME="IDX1751"></A>
<A NAME="IDX1752"></A>

</P>

<PRE>
SHOW GRANTS FOR user
</PRE>

<P>
This statement lists the <CODE>GRANT</CODE> statements that must be issued to
duplicate the privileges for a MySQL user account.

</P>

<PRE>
mysql&#62; SHOW GRANTS FOR 'root'@'localhost';
+---------------------------------------------------------------------+
| Grants for root@localhost                                           |
+---------------------------------------------------------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION |
+---------------------------------------------------------------------+
</PRE>

<P>
As of MySQL 4.1.2, to list privileges for the current session, you can use
any of the following statements:

</P>

<PRE>
SHOW GRANTS;
SHOW GRANTS FOR CURRENT_USER;
SHOW GRANTS FOR CURRENT_USER();
</PRE>

<P>
Before MySQL 4.1.2,  you can find out what user the
session was authenticated as by selecting the value
of the <CODE>CURRENT_USER()</CODE> function (new in MySQL 4.0.6).
Then use that value in the <CODE>SHOW GRANTS</CODE> statement.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.

</P>
<P>
<CODE>SHOW GRANTS</CODE> is available as of MySQL 3.23.4.

</P>



<H4><A NAME="SHOW_INDEX" HREF="manual_toc.html#SHOW_INDEX">14.5.3.11  <CODE>SHOW INDEX</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1753"></A>
<A NAME="IDX1754"></A>
<A NAME="IDX1755"></A>

</P>

<PRE>
SHOW INDEX FROM tbl_name [FROM db_name]
</PRE>

<P>
<CODE>SHOW INDEX</CODE> returns table index information in a format that
resembles the <CODE>SQLStatistics</CODE> call in ODBC.

</P>
<P>
<CODE>SHOW INDEX</CODE> returns the following fields:

</P>
<DL COMPACT>

<DT><CODE>Table</CODE>
<DD>
The name of the table.

<DT><CODE>Non_unique</CODE>
<DD>
0 if the index can't contain duplicates, 1 if it can.

<DT><CODE>Key_name</CODE>
<DD>
The name of the index.

<DT><CODE>Seq_in_index</CODE>
<DD>
The column sequence number in the index, starting with 1.

<DT><CODE>Column_name</CODE>
<DD>
The column name.

<DT><CODE>Collation</CODE>
<DD>
How the column is sorted in the index. In MySQL, this can have values
<SAMP>`A'</SAMP> (Ascending) or <CODE>NULL</CODE> (Not sorted).

<DT><CODE>Cardinality</CODE>
<DD>
The number of unique values in the index.  This is updated by running
<CODE>ANALYZE TABLE</CODE> or <CODE>myisamchk -a</CODE>.  <CODE>Cardinality</CODE> is counted
based on statistics stored as integers, so it's not necessarily accurate for
small tables.

<DT><CODE>Sub_part</CODE>
<DD>
The number of indexed characters if the column is only partly indexed.
<CODE>NULL</CODE> if the entire column is indexed.

<DT><CODE>Packed</CODE>
<DD>
Indicates how the key is packed.  <CODE>NULL</CODE> if it is not.

<DT><CODE>Null</CODE>
<DD>
Contains <CODE>YES</CODE> if the column may contain <CODE>NULL</CODE>, <CODE>''</CODE>
if not.

<DT><CODE>Index_type</CODE>
<DD>
The index method used (<CODE>BTREE</CODE>, <CODE>FULLTEXT</CODE>, <CODE>HASH</CODE>,
<CODE>RTREE</CODE>).

<DT><CODE>Comment</CODE>
<DD>
Various remarks.  Before MySQL 4.0.2 when the <CODE>Index_type</CODE> column was
added, <CODE>Comment</CODE> indicates whether an index is <CODE>FULLTEXT</CODE>.

</DL>

<P>
The <CODE>Packed</CODE> and <CODE>Comment</CODE> columns were added in MySQL 3.23.0.
The <CODE>Null</CODE> and <CODE>Index_type</CODE> columns were added in MySQL 4.0.2.

</P>
<P>
You can use <CODE>db_name.tbl_name</CODE> as an alternative to the <CODE>tbl_name
FROM db_name</CODE> syntax.  These two statements are equivalent:

</P>

<PRE>
mysql&#62; SHOW INDEX FROM mytable FROM mydb;
mysql&#62; SHOW INDEX FROM mydb.mytable;
</PRE>

<P>
<CODE>SHOW KEYS</CODE> is a synonym for <CODE>SHOW INDEX</CODE>.  You can also list
a table's indexes with the <CODE>mysqlshow -k db_name tbl_name</CODE> command.

</P>



<H4><A NAME="SHOW_INNODB_STATUS" HREF="manual_toc.html#SHOW_INNODB_STATUS">14.5.3.12  <CODE>SHOW INNODB STATUS</CODE> Syntax</A></H4>


<PRE>
SHOW INNODB STATUS
</PRE>

<P>
This statement shows extensive information about the state of the
<CODE>InnoDB</CODE> storage engine.

</P>



<H4><A NAME="SHOW_LOGS" HREF="manual_toc.html#SHOW_LOGS">14.5.3.13  <CODE>SHOW LOGS</CODE> Syntax</A></H4>


<PRE>
SHOW [BDB] LOGS
</PRE>

<P>
<CODE>SHOW LOGS</CODE> displays status information about existing log files.
It was implemented in MySQL 3.23.29. Currently, it displays only information
about Berkeley DB log files, so an alias for it (available as of MySQL
4.1.1) is <CODE>SHOW BDB LOGS</CODE>.

</P>
<P>
<CODE>SHOW LOGS</CODE> returns the following fields:

</P>
<DL COMPACT>

<DT><CODE>File</CODE>
<DD>
The full path to the log file.

<DT><CODE>Type</CODE>
<DD>
The log file type (<CODE>BDB</CODE> for Berkeley DB log files).

<DT><CODE>Status</CODE>
<DD>
The status of the log file (<CODE>FREE</CODE> if the file can be removed, or
<CODE>IN USE</CODE> if the file is needed by the transaction subsystem)

</DL>



<H4><A NAME="SHOW_PRIVILEGES" HREF="manual_toc.html#SHOW_PRIVILEGES">14.5.3.14  <CODE>SHOW PRIVILEGES</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1756"></A>

</P>

<PRE>
SHOW PRIVILEGES
</PRE>

<P>
<CODE>SHOW PRIVILEGES</CODE> shows the list of system privileges that the underlying 
MySQL server supports.
This statement is implemented as of MySQL 4.1.0.

</P>

<PRE>
mysql&#62; SHOW PRIVILEGES\G
*************************** 1. row ***************************
Privilege: Select
  Context: Tables
  Comment: To retrieve rows from table
*************************** 2. row ***************************
Privilege: Insert
  Context: Tables
  Comment: To insert data into tables
*************************** 3. row ***************************
Privilege: Update
  Context: Tables
  Comment: To update existing rows 
*************************** 4. row ***************************
Privilege: Delete
  Context: Tables
  Comment: To delete existing rows
*************************** 5. row ***************************
Privilege: Index
  Context: Tables
  Comment: To create or drop indexes
*************************** 6. row ***************************
Privilege: Alter
  Context: Tables
  Comment: To alter the table
*************************** 7. row ***************************
Privilege: Create
  Context: Databases,Tables,Indexes
  Comment: To create new databases and tables
*************************** 8. row ***************************
Privilege: Drop
  Context: Databases,Tables
  Comment: To drop databases and tables
*************************** 9. row ***************************
Privilege: Grant
  Context: Databases,Tables
  Comment: To give to other users those privileges you possess
*************************** 10. row ***************************
Privilege: References
  Context: Databases,Tables
  Comment: To have references on tables
*************************** 11. row ***************************
Privilege: Reload
  Context: Server Admin
  Comment: To reload or refresh tables, logs and privileges
*************************** 12. row ***************************
Privilege: Shutdown
  Context: Server Admin
  Comment: To shutdown the server
*************************** 13. row ***************************
Privilege: Process
  Context: Server Admin
  Comment: To view the plain text of currently executing queries
*************************** 14. row ***************************
Privilege: File
  Context: File access on server
  Comment: To read and write files on the server
</PRE>



<H4><A NAME="SHOW_PROCESSLIST" HREF="manual_toc.html#SHOW_PROCESSLIST">14.5.3.15  <CODE>SHOW PROCESSLIST</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1757"></A>
<A NAME="IDX1758"></A>
<A NAME="IDX1759"></A>

</P>
<P>
<A NAME="IDX1760"></A>
<A NAME="IDX1761"></A>

</P>

<PRE>
SHOW [FULL] PROCESSLIST
</PRE>

<P>
<CODE>SHOW PROCESSLIST</CODE> shows you which threads are running.
You can also get this information using the <CODE>mysqladmin processlist</CODE>
statement.  If you have the <CODE>SUPER</CODE> privilege, you can see all
threads.  Otherwise, you can see only your own threads (that is, threads
associated with the MySQL account that you are using).
See section <A HREF="manual.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A>.
If you don't use the <CODE>FULL</CODE> keyword, only the first 100
characters of each query are shown.

</P>
<P>
Starting from MySQL 4.0.12, the statement reports the hostname for TCP/IP
connections in <CODE>host_name:client_port</CODE> format to make it easier to
determine which client is doing what.

</P>
<P>
This statement is very useful if you get the "too many connections" error
message and want to find out what is going on. MySQL reserves one extra
connection to be used by accounts that have the <CODE>SUPER</CODE> privilege, to
ensure that administrators should always be able to connect and check the
system (assuming that you are not giving this privilege to all your users).

</P>
<P>
Some states commonly seen in the output from <CODE>SHOW PROCESSLIST</CODE>:

</P>
<DL COMPACT>

<DT><CODE>Checking table</CODE>
<DD>
The thread is performing (automatic) checking of the table.

<DT><CODE>Closing tables</CODE>
<DD>
Means that the thread is flushing the changed table data to disk and
closing the used tables. This should be a fast operation.  If not, then
you should verify that you don't have a full disk and that the disk is not
in very heavy use.

<DT><CODE>Connect Out</CODE>
<DD>
Slave connecting to master.

<DT><CODE>Copying to tmp table on disk</CODE>
<DD>
The temporary result set was larger than <CODE>tmp_table_size</CODE> and the
thread is now changing the temporary table from in-memory to disk-based
format to save memory.

<DT><CODE>Creating tmp table</CODE>
<DD>
The thread is creating a temporary table to hold a part of the result for
the query.

<DT><CODE>deleting from main table</CODE>
<DD>
The server is executing the first part of a multiple-table delete and
deleting only from the first table.

<DT><CODE>deleting from reference tables</CODE>
<DD>
The server is executing the second part of a multiple-table delete and deleting
the matched rows from the other tables.

<DT><CODE>Flushing tables</CODE>
<DD>
The thread is executing <CODE>FLUSH TABLES</CODE> and is waiting for all
threads to close their tables.

<DT><CODE>Killed</CODE>
<DD>
Someone has sent a kill to the thread and it should abort next time it
checks the kill flag.  The flag is checked in each major loop in MySQL,
but in some cases it might still take a short time for the thread to die.
If the thread is locked by some other thread, the kill takes effect
as soon as the other thread releases its lock.

<DT><CODE>Sending data</CODE>
<DD>
The thread is processing rows for a <CODE>SELECT</CODE> statement and
also is sending data to the client.

<DT><CODE>Sorting for group</CODE>
<DD>
The thread is doing a sort to satisfy a <CODE>GROUP BY</CODE>.

<DT><CODE>Sorting for order</CODE>
<DD>
The thread is doing a sort to satisfy a <CODE>ORDER BY</CODE>.

<DT><CODE>Opening tables</CODE>
<DD>
The thread is trying to open a table. This is should be very fast procedure,
unless something prevents opening. For example, an <CODE>ALTER TABLE</CODE> or a
<CODE>LOCK TABLE</CODE> statement can prevent opening a table until the statement
is finished.

<DT><CODE>Removing duplicates</CODE>
<DD>
The query was using <CODE>SELECT DISTINCT</CODE> in such a way that MySQL
couldn't optimize away the distinct operation at an early stage. Because of
this, MySQL requires an extra stage to remove all duplicated rows before
sending the result to the client.

<DT><CODE>Reopen table</CODE>
<DD>
The thread got a lock for the table, but noticed after getting the lock
that the underlying table structure changed. It has freed the lock,
closed the table, and is now trying to reopen it.

<DT><CODE>Repair by sorting</CODE>
<DD>
The repair code is using sorting to create indexes.

<DT><CODE>Repair with keycache</CODE>
<DD>
The repair code is using creating keys one by one through the key cache.
This is much slower than <CODE>Repair by sorting</CODE>.

<DT><CODE>Searching rows for update</CODE>
<DD>
The thread is doing a first phase to find all matching rows before
updating them.  This has to be done if the <CODE>UPDATE</CODE> is changing
the index that is used to find the involved rows.

<DT><CODE>Sleeping</CODE>
<DD>
The thread is waiting for the client to send a new statement to it.

<DT><CODE>System lock</CODE>
<DD>
The thread is waiting to get an external system lock for the
table. If you are not using multiple <CODE>mysqld</CODE> servers that are accessing
the same tables, you can disable system locks with the
<CODE>--skip-external-locking</CODE> option.

<DT><CODE>Upgrading lock</CODE>
<DD>
The <CODE>INSERT DELAYED</CODE> handler is trying to get a lock for the table
to insert rows.

<DT><CODE>Updating</CODE>
<DD>
The thread is searching for rows to update and updating them.

<DT><CODE>User Lock</CODE>
<DD>
The thread is waiting on a <CODE>GET_LOCK()</CODE>.

<DT><CODE>Waiting for tables</CODE>
<DD>
The thread got a notification that the underlying structure for a table
has changed and it needs to reopen the table to get the new structure.
However, to be able to reopen the table, it must wait until all other
threads have closed the table in question.

This notification happens if another thread has used <CODE>FLUSH TABLES</CODE>
or one of the following statements on the table in question: <CODE>FLUSH
TABLES tbl_name</CODE>, <CODE>ALTER TABLE</CODE>, <CODE>RENAME TABLE</CODE>,
<CODE>REPAIR TABLE</CODE>, <CODE>ANALYZE TABLE</CODE>, or <CODE>OPTIMIZE TABLE</CODE>.

<DT><CODE>waiting for handler insert</CODE>
<DD>
The <CODE>INSERT DELAYED</CODE> handler has processed all pending inserts and is
waiting for new ones.

</DL>

<P>
Most states correspond to very quick operations. If a thread stays in any
of these states for many seconds, there might be a problem around that
needs to be investigated.

</P>
<P>
There are some other states that are not mentioned in the preceding list,
but many of them are useful only for finding bugs in the server.

</P>



<H4><A NAME="SHOW_STATUS" HREF="manual_toc.html#SHOW_STATUS">14.5.3.16  <CODE>SHOW STATUS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1762"></A>
<A NAME="IDX1763"></A>

</P>

<PRE>
SHOW STATUS [LIKE 'pattern']
</PRE>

<P>
<A NAME="IDX1764"></A>
<CODE>SHOW STATUS</CODE> provides server status information.  This information
also can be obtained using the <CODE>mysqladmin extended-status</CODE> command.

</P>
<P>
Partial output is shown here. The list of variables and their values may be
different for your server. The meaning of each variable is given in
See section <A HREF="manual.html#Server_status_variables">5.2.4  Server Status Variables</A>.

</P>

<PRE>
mysql&#62; SHOW STATUS;
+--------------------------+------------+
| Variable_name            | Value      |
+--------------------------+------------+
| Aborted_clients          | 0          |
| Aborted_connects         | 0          |
| Bytes_received           | 155372598  |
| Bytes_sent               | 1176560426 |
| Connections              | 30023      |
| Created_tmp_disk_tables  | 0          |
| Created_tmp_tables       | 8340       |
| Created_tmp_files        | 60         |
...
| Open_tables              | 1          |
| Open_files               | 2          |
| Open_streams             | 0          |
| Opened_tables            | 44600      |
| Questions                | 2026873    |
...
| Table_locks_immediate    | 1920382    |
| Table_locks_waited       | 0          |
| Threads_cached           | 0          |
| Threads_created          | 30022      |
| Threads_connected        | 1          |
| Threads_running          | 1          |
| Uptime                   | 80380      |
+--------------------------+------------+
</PRE>

<P>
With a <CODE>LIKE</CODE> clause, the statement displays only those variables that
match the pattern:

</P>

<PRE>
mysql&#62; SHOW STATUS LIKE 'Key%';
+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| Key_blocks_used    | 14955    |
| Key_read_requests  | 96854827 |
| Key_reads          | 162040   |
| Key_write_requests | 7589728  |
| Key_writes         | 3813196  |
+--------------------+----------+
</PRE>



<H4><A NAME="SHOW_TABLE_STATUS" HREF="manual_toc.html#SHOW_TABLE_STATUS">14.5.3.17  <CODE>SHOW TABLE STATUS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1765"></A>
<A NAME="IDX1766"></A>
<A NAME="IDX1767"></A>

</P>

<PRE>
SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern']
</PRE>

<P>
<CODE>SHOW TABLE STATUS</CODE> (new in MySQL 3.23) works likes <CODE>SHOW
TABLE</CODE>, but provides a lot of information about each table. You can
also get this list using the <CODE>mysqlshow --status db_name</CODE> command.

</P>
<P>
<CODE>SHOW TABLE STATUS</CODE> returns the following fields:

</P>
<DL COMPACT>

<DT><CODE>Name</CODE>
<DD>
The name of the table.

<DT><CODE>Type</CODE>
<DD>
The type of the table. See section <A HREF="manual.html#Table_types">15  MySQL Storage Engines and Table Types</A>.

<DT><CODE>Row_format</CODE>
<DD>
The row storage format (<CODE>Fixed</CODE>, <CODE>Dynamic</CODE>, or <CODE>Compressed</CODE>).

<DT><CODE>Rows</CODE>
<DD>
The number of rows.

<DT><CODE>Avg_row_length</CODE>
<DD>
The average row length.

<DT><CODE>Data_length</CODE>
<DD>
The length of the data file.

<DT><CODE>Max_data_length</CODE>
<DD>
The maximum length of the data file.
For fixed-row formats, this is the maximum number of rows in the table.
For dynamic-row formats, this is the total number of data bytes that
can be stored in the table, given the data pointer size used.

<DT><CODE>Index_length</CODE>
<DD>
The length of the index file.

<DT><CODE>Data_free</CODE>
<DD>
The number of allocated but unused bytes.

<DT><CODE>Auto_increment</CODE>
<DD>
The next <CODE>AUTO_INCREMENT</CODE> value.

<DT><CODE>Create_time</CODE>
<DD>
When the table was created.

<DT><CODE>Update_time</CODE>
<DD>
When the data file was last updated.

<DT><CODE>Check_time</CODE>
<DD>
When the table was last checked.

<DT><CODE>Collation</CODE>
<DD>
The table's character set and collation. (New in 4.1.1)

<DT><CODE>Checksum</CODE>
<DD>
The live checksum value (if any). (New in 4.1.1)

<DT><CODE>Create_options</CODE>
<DD>
Extra options used with <CODE>CREATE TABLE</CODE>.

<DT><CODE>Comment</CODE>
<DD>
The comment used when creating the table (or some information why MySQL
couldn't access the table information).

</DL>

<P>
In the table comment, <CODE>InnoDB</CODE> tables will report the free space of
the tablespace to which the table belongs.  For a table located in the
shared tablespace, this is the free space of the shared tablespace. If
you are using multiple tablespaces and the table has its own tablespace,
the freespace is for just that table.

</P>
<P>
For <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables, the <CODE>Data_length</CODE>,
<CODE>Max_data_length</CODE>, and <CODE>Index_length</CODE> values approximate the
actual amount of allocated memory. The allocation algorithm reserves memory
in large amounts to reduce the number of allocation operations.

</P>



<H4><A NAME="SHOW_TABLES" HREF="manual_toc.html#SHOW_TABLES">14.5.3.18  <CODE>SHOW TABLES</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1768"></A>
<A NAME="IDX1769"></A>

</P>

<PRE>
SHOW [OPEN] TABLES [FROM db_name] [LIKE 'pattern']
</PRE>

<P>
<CODE>SHOW TABLES</CODE> lists the non-<CODE>TEMPORARY</CODE> tables in a given
database.  You can also get this list using the <CODE>mysqlshow db_name</CODE>
command.

</P>
<P>
<STRONG>Note:</STRONG> If you have no privileges for a table, the table
will not show up in the output from <CODE>SHOW TABLES</CODE> or <CODE>mysqlshow
db_name</CODE>.

</P>

<P>
<CODE>SHOW OPEN TABLES</CODE> lists the tables that are currently open in
the table cache. See section <A HREF="manual.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A>.  The <CODE>Comment</CODE> field in the output
tells how many times the table is <CODE>cached</CODE> and <CODE>in_use</CODE>.
<CODE>OPEN</CODE> can be used from MySQL 3.23.33 on.

</P>



<H4><A NAME="SHOW_VARIABLES" HREF="manual_toc.html#SHOW_VARIABLES">14.5.3.19  <CODE>SHOW VARIABLES</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1770"></A>
<A NAME="IDX1771"></A>
<A NAME="IDX1772"></A>
<A NAME="IDX1773"></A>

</P>

<PRE>
SHOW [GLOBAL | SESSION] VARIABLES [LIKE 'pattern']
</PRE>

<P>
<A NAME="IDX1774"></A>
<CODE>SHOW VARIABLES</CODE> shows the values of some MySQL system variables.  This
information also can be obtained using the <CODE>mysqladmin variables</CODE>
command.

</P>
<P>
The <CODE>GLOBAL</CODE> and <CODE>SESSION</CODE> options are new in MySQL 4.0.3.
With <CODE>GLOBAL</CODE>, you will get the values that will be used for new
connections to MySQL. With <CODE>SESSION</CODE>, you will get the values that
are in effect for the current connection. If you use neither option, the
default <CODE>SESSION</CODE>. <CODE>LOCAL</CODE> is a synonym for <CODE>SESSION</CODE>.

</P>
<P>
If the default values are unsuitable, you can set most of these variables
using command-line options when <CODE>mysqld</CODE> starts or at runtime with
the <CODE>SET</CODE> statement.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A> and section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

</P>
<P>
Partial output is shown here. The list of variables and their values may be
different for your server. The meaning of each variable is given in
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
Information about tuning them is provided in section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>

<PRE>
mysql&#62; SHOW VARIABLES;
+---------------------------------+------------------------------+
| Variable_name                   | Value                        |
+---------------------------------+------------------------------|
| back_log                        | 50                           |
| basedir                         | /usr/local/mysql             |
| bdb_cache_size                  | 8388572                      |
| bdb_log_buffer_size             | 32768                        |
| bdb_home                        | /usr/local/mysql             |
...
| max_connections                 | 100                          |
| max_connect_errors              | 10                           |
| max_delayed_threads             | 20                           |
| max_error_count                 | 64                           |
| max_heap_table_size             | 16777216                     |
| max_join_size                   | 4294967295                   |
| max_relay_log_size              | 0                            |
| max_sort_length                 | 1024                         |
...
| timezone                        | EEST                         |
| tmp_table_size                  | 33554432                     |
| tmpdir                          | /tmp/:/mnt/hd2/tmp/          |
| version                         | 4.0.4-beta                   |
| wait_timeout                    | 28800                        |
+---------------------------------+------------------------------+
</PRE>

<P>
With a <CODE>LIKE</CODE> clause, the statement displays only those variables that
match the pattern:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have%';
+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| have_bdb           | YES      |
| have_innodb        | YES      |
| have_isam          | YES      |
| have_raid          | NO       |
| have_symlink       | DISABLED |
| have_openssl       | YES      |
| have_query_cache   | YES      |
+--------------------+----------+
</PRE>



<H4><A NAME="SHOW_WARNINGS" HREF="manual_toc.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1775"></A>

</P>

<PRE>
SHOW WARNINGS [LIMIT [offset,] row_count]
SHOW COUNT(*) WARNINGS
</PRE>

<P>
<CODE>SHOW WARNINGS</CODE> shows the error, warning, and note messages that
resulted from the last statement that generated messages, or nothing if the
last statement that used a table generated no messages.
This statement is implemented as of MySQL 4.1.0.
A related statement, <CODE>SHOW ERRORS</CODE>, shows only the errors.
See section <A HREF="manual.html#SHOW_ERRORS">14.5.3.9  <CODE>SHOW ERRORS</CODE> Syntax</A>.

</P>
<P>
The list of messages is reset for each new statement that uses a table.

</P>
<P>
The <CODE>SHOW COUNT(*) WARNINGS</CODE> statement displays the total number of
errors, warnings, and notes. You can also retrieve this number from the
<CODE>warning_count</CODE> variable:

</P>

<PRE>
SHOW COUNT(*) WARNINGS;
SELECT @@warning_count;
</PRE>

<P>
The value of <CODE>warning_count</CODE> might be greater than the number of
messages displayed by <CODE>SHOW WARNINGS</CODE> if the <CODE>max_error_count</CODE>
system variable is set low enough that not all messages are stored. An
example shown later in this section demonstrates how this can happen.

</P>
<P>
The <CODE>LIMIT</CODE> clause has the same syntax as for the <CODE>SELECT</CODE>
statement.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

</P>
<P>
The MySQL server sends back the total number of errors, warnings, and
notes resulting from the last statement.
If you are using the C API, this value can be obtained by calling
<CODE>mysql_warning_count()</CODE>.
See section <A HREF="manual.html#mysql_warning_count">20.2.3.240  <CODE>mysql_warning_count()</CODE></A>.

</P>
<P>
Note that the framework for warnings was added in MySQL 4.1.0, at which
point many statements did not generate warnings.  In 4.1.1, the situation is
much improved, with warnings generated for statements such as <CODE>LOAD
DATA INFILE</CODE> and DML statements such as <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
<CODE>CREATE TABLE</CODE>, and <CODE>ALTER TABLE</CODE>.

</P>
<P>
The following <CODE>DROP TABLE</CODE> statement results in a note:

</P>

<PRE>
mysql&#62; DROP TABLE IF EXISTS no_such_table;
mysql&#62; SHOW WARNINGS;
+-------+------+-------------------------------+
| Level | Code | Message                       |
+-------+------+-------------------------------+
| Note  | 1051 | Unknown table 'no_such_table' |
+-------+------+-------------------------------+
</PRE>

<P>
Here is a simple example that shows a syntax warning for <CODE>CREATE TABLE</CODE>
and conversion warnings for <CODE>INSERT</CODE>:

</P>

<PRE>
mysql&#62; CREATE TABLE t1 (a TINYINT NOT NULL, b CHAR(4)) TYPE=MyISAM;
Query OK, 0 rows affected, 1 warning (0.00 sec)
mysql&#62; SHOW WARNINGS\G
*************************** 1. row ***************************
  Level: Warning
   Code: 1287
Message: 'TYPE=storage_engine' is deprecated, use
         'ENGINE=storage_engine' instead
1 row in set (0.00 sec)

mysql&#62; INSERT INTO t1 VALUES(10,'mysql'),(NULL,'test'),
    -&#62; (300,'open source');
Query OK, 3 rows affected, 4 warnings (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 4

mysql&#62; SHOW WARNINGS\G
*************************** 1. row ***************************
  Level: Warning
   Code: 1265
Message: Data truncated for column 'b' at row 1
*************************** 2. row ***************************
  Level: Warning
   Code: 1263
Message: Data truncated, NULL supplied to NOT NULL column 'a' at row 2
*************************** 3. row ***************************
  Level: Warning
   Code: 1264
Message: Data truncated, out of range for column 'a' at row 3
*************************** 4. row ***************************
  Level: Warning
   Code: 1265
Message: Data truncated for column 'b' at row 3
4 rows in set (0.00 sec)
</PRE>

<P>
The maximum number of error, warning, and note messages to store is controlled
by the <CODE>max_error_count</CODE> system variable.  By default, its value is 64.
To change the number of messages you want stored, change the value of
<CODE>max_error_count</CODE>.
In the following example, the <CODE>ALTER TABLE</CODE> statement produces three
warning messages, but only one is stored because <CODE>max_error_count</CODE>
has been set to <CODE>1</CODE>:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'max_error_count';
+-----------------+-------+
| Variable_name   | Value |
+-----------------+-------+
| max_error_count | 64    |
+-----------------+-------+
1 row in set (0.00 sec)

mysql&#62; SET max_error_count=1;
Query OK, 0 rows affected (0.00 sec)

mysql&#62; ALTER TABLE t1 MODIFY b CHAR;
Query OK, 3 rows affected, 3 warnings (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 3

mysql&#62; SELECT @@warning_count;
+-----------------+
| @@warning_count |
+-----------------+
|               3 |
+-----------------+
1 row in set (0.01 sec)

mysql&#62; SHOW WARNINGS;
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1263 | Data truncated for column 'b' at row 1 |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)
</PRE>

<P>
To disable warnings, set <CODE>max_error_count</CODE> to <CODE>0</CODE>. In this case,
<CODE>warning_count</CODE> still indicates how many warnings have occurred, but
none of the messages are stored.

</P>



<H3><A NAME="Other_administrative_SQL" HREF="manual_toc.html#Other_administrative_SQL">14.5.4  Other Administrative Statements</A></H3>



<H4><A NAME="CACHE_INDEX" HREF="manual_toc.html#CACHE_INDEX">14.5.4.1  <CODE>CACHE INDEX</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1776"></A>

</P>
<P>
<A NAME="IDX1777"></A>
<A NAME="IDX1778"></A>

</P>


<PRE>
CACHE INDEX
  table_index_list [, table_index_list] ...
  IN key_cache_name

table_index_list:
  tbl_name [[INDEX] (index_name[, index_name] ...)]
</PRE>

<P>
The <CODE>CACHE INDEX</CODE> statement assigns table indexes to a specific key
cache. It is used only for <CODE>MyISAM</CODE> tables.

</P>
<P>
The following statement assigns indexes from the tables <CODE>t1</CODE>,
<CODE>t2</CODE>, and <CODE>t3</CODE> to the key cache named <CODE>hot_cache</CODE>:

</P>

<PRE>
mysql&#62; CACHE INDEX t1, t2, t3 IN hot_cache;
+---------+--------------------+----------+----------+
| Table   | Op                 | Msg_type | Msg_text |
+---------+--------------------+----------+----------+
| test.t1 | assign_to_keycache | status   | OK       |
| test.t2 | assign_to_keycache | status   | OK       |
| test.t3 | assign_to_keycache | status   | OK       |
+---------+--------------------+----------+----------+
</PRE>

<P>
The syntax of <CODE>CACHE INDEX</CODE> allows you to specify that only particular
indexes from a table should be assigned to the cache.  However, the current
implementation assigns all the table's indexes to the cache, so there is no
reason to specify anything other than the table name.

</P>
<P>
The key cache referred to in a <CODE>CACHE INDEX</CODE> statement can be created
by setting its size with a parameter setting statement or in the server
parameter settings. For example:

</P>

<PRE>
mysql&#62; SET GLOBAL keycache1.key_buffer_size=128*1024;
</PRE>

<P>
Key cache parameters can be accessed as members of a structured system
variable.
See section <A HREF="manual.html#Structured_System_Variables">10.4.1  Structured System Variables</A>.

</P>
<P>
A key cache must exist before you can assign indexes to it:

</P>

<PRE>
mysql&#62; CACHE INDEX t1 in non_existent_cache;
ERROR 1283 (HY000): Unknown key cache 'non_existent_cache'
</PRE>

<P>
By default, table indexes are assigned to the main (default) key cache
created at the server startup. When a key cache is destroyed, all
indexes assigned to it become assigned to the default key cache again.

</P>
<P>
Index assignment affects the server globally: If one client
assigns an index to a given cache, this cache is used for all queries
involving the index, no matter what client issues the queries.

</P>
<P>
<CODE>CACHE INDEX</CODE> was added in MySQL 4.1.1.

</P>



<H4><A NAME="FLUSH" HREF="manual_toc.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1779"></A>

</P>
<P>
<A NAME="IDX1780"></A>
<A NAME="IDX1781"></A>
<A NAME="IDX1782"></A>

</P>

<PRE>
FLUSH [LOCAL | NO_WRITE_TO_BINLOG] flush_option [, flush_option] ...
</PRE>

<P>
You should use the <CODE>FLUSH</CODE> statement if you want to clear some of the
internal caches MySQL uses.  To execute <CODE>FLUSH</CODE>, you must have
the <CODE>RELOAD</CODE> privilege.

</P>
<P>
<CODE>flush_option</CODE> can be any of the following:

</P>
<DL COMPACT>

<DT><CODE>HOSTS</CODE>
<DD>
Empties the host cache tables.  You should flush the
host tables if some of your hosts change IP number or if you get the
error message <CODE>Host ... is blocked</CODE>.  When more than
<CODE>max_connect_errors</CODE> errors occur successively for a given host while
connecting to the MySQL server, MySQL assumes that
something is wrong and blocks the host from further connection requests.
Flushing the host tables allows the host to attempt to connect
again. See section <A HREF="manual.html#Blocked_host">A.2.5  <CODE>Host 'host_name' is blocked</CODE></A>. You can start <CODE>mysqld</CODE> with
<CODE>--max_connect_errors=999999999</CODE> to avoid this error message.

<DT><CODE>DES_KEY_FILE</CODE>
<DD>
Reloads the DES keys from the file that was
specified with the <CODE>--des-key-file</CODE> option at server startup time.

<DT><CODE>LOGS</CODE>
<DD>
Closes and reopens all log files.
If you have specified an update log file or a binary log file without
an extension, the extension number of the log file will be incremented
by one relative to the previous file. If you have used an extension in
the file name, MySQL will close and reopen the update log or binary log file.
See section <A HREF="manual.html#Update_log">5.8.3  The Update Log</A>. On Unix, this is the same thing as sending a <CODE>SIGHUP</CODE>
signal to the <CODE>mysqld</CODE> server.

<DT><CODE>PRIVILEGES</CODE>
<DD>
Reloads the privileges from the grant tables in
the <CODE>mysql</CODE> database.

<DT><CODE>QUERY CACHE</CODE>
<DD>
Defragment the query cache to better utilize its
memory.  This statement does not remove any queries from the cache, unlike
<CODE>RESET QUERY CACHE</CODE>.

<DT><CODE>STATUS</CODE>
<DD>
Resets most status variables to zero. This is something you should use only when debugging a query. See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

<DT><CODE>{TABLE | TABLES} [tbl_name [, tbl_name] ...]</CODE>
<DD>
When no tables are named, closes all open tables and forces all tables in use to be closed. This also flushes the query cache.  With one or more table names, flushes only the given tables.
<CODE>FLUSH TABLES</CODE> also removes all query results from the query cache, like
the <CODE>RESET QUERY CACHE</CODE> statement.

<DT><CODE>TABLES WITH READ LOCK</CODE>
<DD>
Closes all open tables and locks all
tables for all databases with a read lock until you execute <CODE>UNLOCK
TABLES</CODE>. This is very convenient way to get backups if you have a filesystem
such as Veritas that can take snapshots in time.

<DT><CODE>USER_RESOURCES</CODE>
<DD>
Resets all user resources to zero. This
enables clients that have reached their hourly connection, query, or update
limits to resume activity.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.

</DL>

<P>
Before MySQL 4.1.1, <CODE>FLUSH</CODE> statements are not written to the binary
log. As of MySQL 4.1.1, they are written to the binary log unless the
optional <CODE>NO_WRITE_TO_BINLOG</CODE> keyword (or its alias <CODE>LOCAL</CODE>) is
used.  Exceptions are that <CODE>FLUSH LOGS</CODE>, <CODE>FLUSH MASTER</CODE>,
<CODE>FLUSH SLAVE</CODE>, and <CODE>FLUSH TABLES WITH READ LOCK</CODE> are not logged in
any case because they would cause problems if replicated to a slave.

</P>
<P>
You can also access some of these statements with the <CODE>mysqladmin</CODE>
utility, using the <CODE>flush-hosts</CODE>, <CODE>flush-logs</CODE>, <CODE>flush-privileges</CODE>,
<CODE>flush-status</CODE>, or <CODE>flush-tables</CODE> commands.

</P>
<P>
Take also a look at the <CODE>RESET</CODE> statement used with replication.
See section <A HREF="manual.html#RESET">14.5.4.5  <CODE>RESET</CODE> Syntax</A>.

</P>



<H4><A NAME="KILL" HREF="manual_toc.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1783"></A>

</P>
<P>
<A NAME="IDX1784"></A>

</P>

<PRE>
KILL [CONNECTION | QUERY] thread_id
</PRE>

<P>
Each connection to <CODE>mysqld</CODE> runs in a separate thread.  You can see
which threads are running with the <CODE>SHOW PROCESSLIST</CODE> statement and kill
a thread with the <CODE>KILL thread_id</CODE> statement.

</P>
<P>
As of MySQL 5.0.0, <CODE>KILL</CODE> allows the optional <CODE>CONNECTION</CODE> or
<CODE>QUERY</CODE> modifiers:

</P>

<UL>

<LI>

<CODE>KILL CONNECTION</CODE> is the same as <CODE>KILL</CODE> with no modifier:
It terminates the connection associated with the given <CODE>thread_id</CODE>.

<LI>

<CODE>KILL QUERY</CODE> terminates the statement that the connection currently
is executing, but leaves the connection intact.

</UL>

<P>
If you have the <CODE>PROCESS</CODE> privilege, you can see all threads.
If you have the <CODE>SUPER</CODE> privilege, you can kill all threads and
statements.  Otherwise, you can see and kill only your own threads and
statements.

</P>
<P>
You can also use the <CODE>mysqladmin processlist</CODE> and <CODE>mysqladmin kill</CODE>
commands to examine and kill threads.

</P>
<P>
<STRONG>Note:</STRONG> You currently cannot use <CODE>KILL</CODE> with the Embedded MySQL
Server library, because the embedded server merely runs inside the threads
of the host application, it does not create connection threads of its own.

</P>
<P>
When you do a <CODE>KILL</CODE>, a thread-specific kill flag is set for
the thread.
In most cases, it might take some time for the thread to die, because the kill
flag is checked only at specific intervals:

</P>

<UL>
<LI>

In <CODE>SELECT</CODE>, <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> loops, the flag is
checked after reading a block of rows. If the kill flag is set, the
statement is aborted.
<LI>

During <CODE>ALTER TABLE</CODE>, the kill flag is checked before each block of
rows are read from the original table. If the kill flag was set, the statement
is aborted and the temporary table is deleted.
<LI>

During <CODE>UPDATE</CODE> or <CODE>DELETE</CODE>, the kill flag
is checked after each block read and after each updated or deleted
row. If the kill flag is set, the statement is aborted.  Note that if you
are not using transactions, the changes will not be rolled back!
<LI>

<CODE>GET_LOCK()</CODE> will abort and return <CODE>NULL</CODE>.
<LI>

An <CODE>INSERT DELAYED</CODE> thread will quickly flush all rows it has in
memory and terminate.
<LI>

If the thread is in the table lock handler (state: <CODE>Locked</CODE>),
the table lock will be quickly aborted.
<LI>

If the thread is waiting for free disk space in a write call, the
write is aborted with a "disk full" error message.
</UL>



<H4><A NAME="LOAD_INDEX" HREF="manual_toc.html#LOAD_INDEX">14.5.4.4  <CODE>LOAD INDEX INTO CACHE</CODE> Syntax</A></H4>


<PRE>
LOAD INDEX INTO CACHE
  table_index_list [, table_index_list] ...

table_index_list:
  tbl_name
    [[INDEX] (index_name[, index_name] ...)]
    [IGNORE LEAVES]
</PRE>

<P>
The <CODE>LOAD INDEX INTO CACHE</CODE> statement preloads a table index into the
key cache to which it has been assigned by an explicit <CODE>CACHE INDEX</CODE>
statement, or into the default key cache otherwise.  <CODE>LOAD INDEX INTO
CACHE</CODE> is used only for <CODE>MyISAM</CODE> tables.

</P>
<P>
The <CODE>IGNORE LEAVES</CODE> modifier causes only blocks for the non-leaf
nodes of the index to be preloaded.

</P>
<P>
The following statement preloads nodes (index blocks) of indexes of the
tables <CODE>t1</CODE> and <CODE>t2</CODE>:

</P>

<PRE>
mysql&#62; LOAD INDEX INTO CACHE t1, t2 IGNORE LEAVES;
+---------+--------------+----------+----------+
| Table   | Op           | Msg_type | Msg_text |
+---------+--------------+----------+----------+
| test.t1 | preload_keys | status   | OK       |
| test.t2 | preload_keys | status   | OK       |
+---------+--------------+----------+----------+
</PRE>

<P>
This statement preloads all index blocks from <CODE>t1</CODE>. It preloads only
blocks for the non-leaf nodes from <CODE>t2</CODE>.

</P>
<P>
The syntax of <CODE>LOAD INDEX INTO CACHE</CODE> allows you to specify that only
particular indexes from a table should be preloaded.  However, the current
implementation preloads all the table's indexes into the cache, so there is
no reason to specify anything other than the table name.

</P>
<P>
<CODE>LOAD INDEX INTO CACHE</CODE> was added in MySQL 4.1.1.

</P>



<H4><A NAME="RESET" HREF="manual_toc.html#RESET">14.5.4.5  <CODE>RESET</CODE> Syntax</A></H4>


<PRE>
RESET reset_option [, reset_option] ...
</PRE>

<P>
The <CODE>RESET</CODE> statement is used to clear the state of various server
operations. It also acts as a stronger
version of the <CODE>FLUSH</CODE> statement.  See section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>.

</P>
<P>
To execute <CODE>RESET</CODE>, you must have the <CODE>RELOAD</CODE> privilege.

</P>
<P>
<CODE>reset_option</CODE> can be any of the following:

</P>
<DL COMPACT>

<DT><CODE>MASTER</CODE>
<DD>
Deletes all binary logs listed in the index file, resets the binary log
index file to be empty, and creates a new binary log file. Previously named
<CODE>FLUSH MASTER</CODE>.
See section <A HREF="manual.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A>.

<DT><CODE>QUERY CACHE</CODE>
<DD>
Removes all query results from the query cache.

<DT><CODE>SLAVE</CODE>
<DD>
Makes the slave forget its replication position in the master
binary logs.  Previously named <CODE>FLUSH SLAVE</CODE>.
See section <A HREF="manual.html#Replication_Slave_SQL">14.6.2  SQL Statements for Controlling Slave Servers</A>.

</DL>



<H2><A NAME="Replication_SQL" HREF="manual_toc.html#Replication_SQL">14.6  Replication Statements</A></H2>

<P>
This section describes replication-related SQL statements.
One group of statements is used for controlling master servers.
The other is used for controlling slave servers.

</P>



<H3><A NAME="Replication_Master_SQL" HREF="manual_toc.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A></H3>

<P>
<A NAME="IDX1785"></A>
<A NAME="IDX1786"></A>
<A NAME="IDX1787"></A>

</P>
<P>
Replication can be controlled through the SQL interface. This section
discusses statements for managing master replication servers.
section <A HREF="manual.html#Replication_Slave_SQL">14.6.2  SQL Statements for Controlling Slave Servers</A> discusses statements for managing slave servers.

</P>



<H4><A NAME="PURGE_MASTER_LOGS" HREF="manual_toc.html#PURGE_MASTER_LOGS">14.6.1.1  <CODE>PURGE MASTER LOGS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1788"></A>

</P>

<PRE>
PURGE {MASTER | BINARY} LOGS TO 'log_name'
PURGE {MASTER | BINARY} LOGS BEFORE 'date'
</PRE>

<P>
Deletes all the binary logs listed in the log
index that are strictly prior to the specified log or date.
The logs also are removed from the list recorded in the log index file,
so that the given log becomes the first. 

</P>
<P>
Example:

</P>

<PRE>
PURGE MASTER LOGS TO 'mysql-bin.010';
PURGE MASTER LOGS BEFORE '2003-04-02 22:46:26';
</PRE>

<P>
The <CODE>BEFORE</CODE> variant is available as of MySQL 4.1. Its date argument
can be in <CODE>'YYYY-MM-DD hh:mm:ss'</CODE> format.
<CODE>MASTER</CODE> and <CODE>BINARY</CODE> are synonyms, but <CODE>BINARY</CODE> can be used
only as of MySQL 4.1.1.

</P>
<P>
If you have an active slave that currently is reading one of the logs you
are trying to delete, this statement does nothing and fails with an error.
However, if a slave is dormant and you happen to purge one of
the logs it wants to read, the slave will be unable to replicate once it
comes up.  The statement is safe to run while slaves are replicating. You
do not need to stop them.

</P>
<P>
To purge logs, follow this procedure:

</P>

<OL>
<LI>

On each slave server, use <CODE>SHOW SLAVE STATUS</CODE> to check which log it is
reading.
<LI>

Obtain a listing of the logs on the master server with <CODE>SHOW MASTER LOGS</CODE>.
<LI>

Determine the earliest log among all the slaves. This is the target log.
If all the slaves are up to date, this will be the last log on the list.
<LI>

Make a backup of all the logs you are about to delete.  (The step is optional,
but a good idea.)
<LI>

Purge all logs up to but not including the target log.
</OL>



<H4><A NAME="RESET_MASTER" HREF="manual_toc.html#RESET_MASTER">14.6.1.2  <CODE>RESET MASTER</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1789"></A>

</P>

<PRE>
RESET MASTER
</PRE>

<P>
Deletes all binary logs listed in the index file,
resets the binary log index file to be empty, and creates a new binary log
file.

</P>
<P>
This statement was named <CODE>FLUSH MASTER</CODE> before MySQL 3.23.26.

</P>



<H4><A NAME="SET_SQL_LOG_BIN" HREF="manual_toc.html#SET_SQL_LOG_BIN">14.6.1.3  <CODE>SET SQL_LOG_BIN</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1790"></A>

</P>

<PRE>
SET SQL_LOG_BIN = {0|1}
</PRE>

<P>
Disables or enables binary logging for the current connection 
(<CODE>SQL_LOG_BIN</CODE> is a session variable)
if the client connects using an account that has the <CODE>SUPER</CODE> privilege.
The statement is refused with an error if the client does not have that
privilege. (Before MySQL 4.1.2 the statement was simply ignored in that case.)

</P>



<H4><A NAME="SHOW_BINLOG_EVENTS" HREF="manual_toc.html#SHOW_BINLOG_EVENTS">14.6.1.4  <CODE>SHOW BINLOG EVENTS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1791"></A>

</P>

<PRE>
SHOW BINLOG EVENTS
   [IN 'log_name'] [FROM pos] [LIMIT [offset,] row_count]
</PRE>

<P>
Shows the events in the binary log. 
If you do not specify <CODE>'log_name'</CODE>, the first binary log will be displayed.

</P>
<P>
The <CODE>LIMIT</CODE> clause has the same syntax as for the <CODE>SELECT</CODE>
statement.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

</P>
<P>
This statement is available as of MySQL 4.0.

</P>



<H4><A NAME="SHOW_MASTER_LOGS" HREF="manual_toc.html#SHOW_MASTER_LOGS">14.6.1.5  <CODE>SHOW MASTER LOGS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1792"></A>

</P>

<PRE>
SHOW MASTER LOGS
</PRE>

<P>
Lists the binary log files on the master. This statement is used as part of
the procedure described in section <A HREF="manual.html#PURGE_MASTER_LOGS">14.6.1.1  <CODE>PURGE MASTER LOGS</CODE> Syntax</A> for determining which logs
can be purged.

</P>



<H4><A NAME="SHOW_MASTER_STATUS" HREF="manual_toc.html#SHOW_MASTER_STATUS">14.6.1.6  <CODE>SHOW MASTER STATUS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1793"></A>

</P>

<PRE>
SHOW MASTER STATUS
</PRE>

<P>
Provides status information on the binary log files of the master.

</P>



<H4><A NAME="SHOW_SLAVE_HOSTS" HREF="manual_toc.html#SHOW_SLAVE_HOSTS">14.6.1.7  <CODE>SHOW SLAVE HOSTS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1794"></A>

</P>

<PRE>
SHOW SLAVE HOSTS
</PRE>

<P>
Displays a list of slaves currently registered with the master. 
Any slave not started with the <CODE>--report-host=slave_name</CODE> 
option will not be visible in that list.

</P>



<H3><A NAME="Replication_Slave_SQL" HREF="manual_toc.html#Replication_Slave_SQL">14.6.2  SQL Statements for Controlling Slave Servers</A></H3>

<P>
<A NAME="IDX1795"></A>
<A NAME="IDX1796"></A>
<A NAME="IDX1797"></A>

</P>
<P>
Replication can be controlled through the SQL interface. This section
discusses statements for managing slave replication servers.
section <A HREF="manual.html#Replication_Master_SQL">14.6.1  SQL Statements for Controlling Master Servers</A> discusses statements for managing master servers.

</P>



<H4><A NAME="CHANGE_MASTER_TO" HREF="manual_toc.html#CHANGE_MASTER_TO">14.6.2.1  <CODE>CHANGE MASTER TO</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1798"></A>

</P>


<PRE>
CHANGE MASTER TO master_def [, master_def] ...

master_def:
      MASTER_HOST = 'host_name'
    | MASTER_USER = 'user_name'
    | MASTER_PASSWORD = 'password'
    | MASTER_PORT = port_num
    | MASTER_CONNECT_RETRY = count
    | MASTER_LOG_FILE = 'master_log_name'
    | MASTER_LOG_POS = master_log_pos
    | RELAY_LOG_FILE = 'relay_log_name'
    | RELAY_LOG_POS = relay_log_pos
    | MASTER_SSL = {0|1}
    | MASTER_SSL_CA = 'ca_file_name'
    | MASTER_SSL_CAPATH = 'ca_directory_name'
    | MASTER_SSL_CERT = 'cert_file_name'
    | MASTER_SSL_KEY = 'key_file_name'
    | MASTER_SSL_CIPHER = 'cipher_list'
</PRE>

<P>
Changes the parameters that the slave server uses for connecting to and
communicating with the master server.

</P>
<P>
<CODE>MASTER_USER</CODE>, <CODE>MASTER_PASSWORD</CODE>, <CODE>MASTER_SSL</CODE>,
<CODE>MASTER_SSL_CA</CODE>, <CODE>MASTER_SSL_CAPATH</CODE>, <CODE>MASTER_SSL_CERT</CODE>,
<CODE>MASTER_SSL_KEY</CODE>, and <CODE>MASTER_SSL_CIPHER</CODE> provide information for
the slave about how to connect to its master.

</P>
<P>
The relay log options (<CODE>RELAY_LOG_FILE</CODE> and <CODE>RELAY_LOG_POS</CODE>) are
available beginning with MySQL 4.0.

</P>
<P>
The SSL options
(<CODE>MASTER_SSL</CODE>,
<CODE>MASTER_SSL_CA</CODE>,
<CODE>MASTER_SSL_CAPATH</CODE>,
<CODE>MASTER_SSL_CERT</CODE>,
<CODE>MASTER_SSL_KEY</CODE>,
and
<CODE>MASTER_SSL_CIPHER</CODE>)
are available beginning with MySQL 4.1.1.
You can change these options even on slaves that are compiled without SSL
support. They are saved to the <TT>`master.info'</TT> file, but is ignored
until you use a server that has SSL support enabled.

</P>
<P>
If you don't specify a given parameter, it keeps its old
value, except as indicated in the following discussion. For example, if the password to connect to your MySQL master has
changed, you just need to issue these statements
to tell the slave about the new password:

</P>

<PRE>
mysql&#62; STOP SLAVE; -- if replication was running
mysql&#62; CHANGE MASTER TO MASTER_PASSWORD='new3cret';
mysql&#62; START SLAVE; -- if you want to restart replication
</PRE>

<P>
There is no need to specify the parameters that do
not change (host, port, user, and so forth).

</P>
<P>
<CODE>MASTER_HOST</CODE> and <CODE>MASTER_PORT</CODE> are the hostname (or IP address) of
the master host and its TCP/IP port. Note that if <CODE>MASTER_HOST</CODE> is
equal to <CODE>localhost</CODE>, then, like in other parts of MySQL, the port
may be ignored (if Unix socket files can be used, for example).

</P>
<P>
If you specify <CODE>MASTER_HOST</CODE> or <CODE>MASTER_PORT</CODE>,
the slave assumes that the master server is different than
before (even if you specify a host or port value that is
the same as the current value.) In this case, the old values for the master
binary log name and position are considered no longer applicable, so if you
do not specify <CODE>MASTER_LOG_FILE</CODE> and <CODE>MASTER_LOG_POS</CODE> in the
statement, <CODE>MASTER_LOG_FILE=''</CODE> and <CODE>MASTER_LOG_POS=4</CODE> are
silently appended to it. 

</P>
<P>
<CODE>MASTER_LOG_FILE</CODE> and <CODE>MASTER_LOG_POS</CODE> are the coordinates
at which the slave I/O thread should begin reading from the master the
next time the thread starts.
If you specify either of them, you can't specify <CODE>RELAY_LOG_FILE</CODE> or
<CODE>RELAY_LOG_POS</CODE>.
If neither of <CODE>MASTER_LOG_FILE</CODE> or <CODE>MASTER_LOG_POS</CODE> are
specified, the last coordinates of the <EM>slave SQL thread</EM>
before <CODE>CHANGE MASTER</CODE> was issued are used. This ensures that
replication has no discontinuity, even if the slave SQL thread was late
compared to the slave I/O thread, when you just want to change, say, the
password to use. This safe behavior was introduced starting from MySQL
4.0.17 and 4.1.1. (Before these versions, the coordinates used were 
the last coordinates of the slave I/O thread before <CODE>CHANGE MASTER</CODE>
was issued. This caused the SQL thread to possibly lose some events
from the master, thus breaking replication.)

</P>
<P>
<CODE>CHANGE MASTER</CODE> <EM>deletes all relay log files</EM> and starts
a new one, unless you specify <CODE>RELAY_LOG_FILE</CODE> or
<CODE>RELAY_LOG_POS</CODE>. In that case, relay logs will be kept;
as of MySQL 4.1.1 the <CODE>relay_log_purge</CODE> global variable
will silently be set to 0.

</P>
<P>
<CODE>CHANGE MASTER TO</CODE> updates the contents of the <TT>`master.info'</TT> and
<TT>`relay-log.info'</TT> files.

</P>
<P>
<CODE>CHANGE MASTER</CODE> is useful for setting up a slave when you have
the snapshot of the master and have recorded the log and the offset
corresponding to it.  After loading the snapshot into the slave, you
can run <CODE>CHANGE MASTER TO MASTER_LOG_FILE='log_name_on_master',
MASTER_LOG_POS=log_offset_on_master</CODE> on the slave.

</P>
<P>
Examples:

</P>

<PRE>
mysql&#62; CHANGE MASTER TO
    -&#62;     MASTER_HOST='master2.mycompany.com',
    -&#62;     MASTER_USER='replication',
    -&#62;     MASTER_PASSWORD='bigs3cret',
    -&#62;     MASTER_PORT=3306,
    -&#62;     MASTER_LOG_FILE='master2-bin.001',
    -&#62;     MASTER_LOG_POS=4,
    -&#62;     MASTER_CONNECT_RETRY=10;

mysql&#62; CHANGE MASTER TO
    -&#62;     RELAY_LOG_FILE='slave-relay-bin.006',
    -&#62;     RELAY_LOG_POS=4025;
</PRE>

<P>
The first example changes the master and master's binary log
coordinates. This is used when you want to set up the slave to replicate
the master.

</P>
<P>
The second example shows an operation that is less frequently used. It
is done when the slave has relay logs that you want it to execute again
for some reason.  To do this, the master need not be reachable. You just
have to use <CODE>CHANGE MASTER TO</CODE> and start the SQL thread (<CODE>START
SLAVE SQL_THREAD</CODE>).

</P>
<P>
You can even use the second operation in a non-replication setup with a
standalone, slave-of-nobody server, to recover after a crash.  Suppose that your
server has crashed and you have restored a backup.  You want to replay
the server's own binary logs (not relay logs, but regular binary logs),
supposedly named <TT>`myhost-bin.*'</TT>. First, make a backup copy of these
binary logs in some safe place, in case you don't exactly follow the
procedure below and accidentally have the server purge the binary logs.
If using MySQL 4.1.1 or newer, use <CODE>SET GLOBAL relay_log_purge=0</CODE> for
additional safety.  Then start the server without the <CODE>--log-bin</CODE>
option. Before MySQL 4.0.19, start it with a new (different from before) server
id; in newer versions there is no need, just use the
<CODE>--replicate-same-server-id</CODE> option. Start it with
<CODE>--relay-log=myhost-bin</CODE> (to make the server believe that these
regular binary logs are relay logs) and with <CODE>--skip-slave-start</CODE>. After
the server starts, issue these statements:

</P>

<PRE>
mysql&#62; CHANGE MASTER TO
    -&#62;     RELAY_LOG_FILE='myhost-bin.153',
    -&#62;     RELAY_LOG_POS=410,
    -&#62;     MASTER_HOST='some_dummy_string';
mysql&#62; START SLAVE SQL_THREAD;
</PRE>

<P>
The server will read and execute its own binary logs, thus achieving
crash recovery.  Once the recovery is finished, run <CODE>STOP SLAVE</CODE>,
shut down the server, delete <TT>`master.info'</TT> and <TT>`relay-log.info'</TT>,
and restart the server with its original options.

</P>
<P>
For the moment, specifying <CODE>MASTER_HOST</CODE> (even with a dummy value) is
required to make the server think it is a slave. In the future, we plan to add
options to get rid of these small constraints.

</P>



<H4><A NAME="LOAD_DATA_FROM_MASTER" HREF="manual_toc.html#LOAD_DATA_FROM_MASTER">14.6.2.2  <CODE>LOAD DATA FROM MASTER</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1799"></A>

</P>

<PRE>
LOAD DATA FROM MASTER
</PRE>

<P>
Takes a snapshot of the master and copies it to the slave.  It updates the
values of <CODE>MASTER_LOG_FILE</CODE> and <CODE>MASTER_LOG_POS</CODE> so that the slave
will start replicating from the correct position. Any table and database
exclusion rules specified with the <CODE>--replicate-*-do-*</CODE> and
<CODE>--replicate-*-ignore-*</CODE> options are honored.
<CODE>--replicate-rewrite-db</CODE> is NOT taken into account (because one user
could, with this option, set up a non-unique mapping like this:
<CODE>--replicate-rewrite-db=db1-&#62;db3</CODE> and
<CODE>--replicate-rewrite-db=db2-&#62;db3</CODE>, which would confuse the slave when
it loads the master's tables).

</P>
<P>
Use of this statement is subject to the following conditions:

</P>

<UL>

<LI>

It works only with <CODE>MyISAM</CODE> tables.

<LI>

It acquires a global read lock on the master while taking the snapshot,
which prevents updates on the master during the load operation.

</UL>

<P>
In the future, it is planned to make this statement work with
<CODE>InnoDB</CODE> tables and to remove the need for a global read lock by using
the non-blocking online backup feature.

</P>
<P>
If you are loading big tables, you might have to increase the values
of <CODE>net_read_timeout</CODE> and <CODE>net_write_timeout</CODE>
on both your master and slave servers.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</P>
<P>
Note that <CODE>LOAD DATA FROM MASTER</CODE> does <EM>not</EM> copy any
tables from the <CODE>mysql</CODE> database.  This makes it easy to have
different users and privileges on the master and the slave.

</P>
<P>
The <CODE>LOAD DATA FROM MASTER</CODE> statement
requires that the replication account that is used to connect to the master
has the <CODE>RELOAD</CODE> and <CODE>SUPER</CODE> privileges on the master and the
<CODE>SELECT</CODE> privilege for all master tables you want to load. All
master tables for which the user does not have the <CODE>SELECT</CODE> privilege are
ignored by <CODE>LOAD DATA FROM MASTER</CODE>. This is because the
master will hide them from the user: <CODE>LOAD DATA FROM MASTER</CODE> calls
<CODE>SHOW DATABASES</CODE> to know the master databases to load, but
<CODE>SHOW DATABASES</CODE> returns only databases for which the user has
some privilege.
See section <A HREF="manual.html#Show_database_info">14.5.3.7  <CODE>SHOW DATABASES</CODE> Syntax</A>.
On the slave's side, the user that issues <CODE>LOAD DATA FROM MASTER</CODE> should
have grants to drop and create the databases and tables that are copied.

</P>



<H4><A NAME="LOAD_TABLE_FROM_MASTER" HREF="manual_toc.html#LOAD_TABLE_FROM_MASTER">14.6.2.3  <CODE>LOAD TABLE tbl_name FROM MASTER</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1800"></A>

</P>

<PRE>
LOAD TABLE tbl_name FROM MASTER
</PRE>

<P>
Transfers a copy of the table from master to the slave. This statement is
implemented mainly for debugging of <CODE>LOAD DATA FROM MASTER</CODE>.
It requires that the account used for connecting to the master server has the
<CODE>RELOAD</CODE> and <CODE>SUPER</CODE> privileges on the master and the
<CODE>SELECT</CODE> privilege on the master table to load.
On the slave side, the user that issues <CODE>LOAD TABLE FROM MASTER</CODE> should
have privileges to drop and create the table.

</P>
<P>
The conditions for <CODE>LOAD DATA FROM MASTER</CODE> apply here, too. For
example, <CODE>LOAD TABLE FROM MASTER</CODE> works only for <CODE>MyISAM</CODE> tables.
The timeout notes for <CODE>LOAD DATA FROM MASTER</CODE> apply as well.

</P>



<H4><A NAME="MASTER_POS_WAIT" HREF="manual_toc.html#MASTER_POS_WAIT">14.6.2.4  <CODE>MASTER_POS_WAIT()</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1801"></A>

</P>

<PRE>
SELECT MASTER_POS_WAIT('master_log_file', master_log_pos)
</PRE>

<P>
This is a function, not a statement. It is used to ensure that the slave
has read and executed events up to a given position in the master's binary log.
See section <A HREF="manual.html#Miscellaneous_functions">13.8.4  Miscellaneous Functions</A> for a full description.

</P>



<H4><A NAME="RESET_SLAVE" HREF="manual_toc.html#RESET_SLAVE">14.6.2.5  <CODE>RESET SLAVE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1802"></A>

</P>

<PRE>
RESET SLAVE
</PRE>

<P>
Makes the slave forget its replication position in the master's binary logs.
This statement is meant to be used for a clean start: It deletes the
<TT>`master.info'</TT> and <TT>`relay-log.info'</TT> files, all the relay logs,
and starts a new relay log.

</P>
<P>
<STRONG>Note:</STRONG> All relay logs are deleted, even if they have not been
totally executed by the slave SQL thread.  (This is a condition likely to
exist on a replication slave if you have issued a <CODE>STOP SLAVE</CODE>
statement or if the slave is highly loaded.)

</P>
<P>
Connection information stored in the <TT>`master.info'</TT> file is immediately
reset using any values specified in the corresponding startup options.
This information includes values such as master host, master port, master
user, and master password.  If the slave SQL thread was in the middle of
replicating temporary tables when it was stopped, and <CODE>RESET SLAVE</CODE>
is issued, these replicated temporary tables are deleted on the slave.

</P>
<P>
This statement was named <CODE>FLUSH SLAVE</CODE> before MySQL 3.23.26.

</P>



<H4><A NAME="SET_GLOBAL_SQL_SLAVE_SKIP_COUNTER" HREF="manual_toc.html#SET_GLOBAL_SQL_SLAVE_SKIP_COUNTER">14.6.2.6  <CODE>SET GLOBAL SQL_SLAVE_SKIP_COUNTER</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1803"></A>

</P>

<PRE>
SET GLOBAL SQL_SLAVE_SKIP_COUNTER = n
</PRE>

<P>
Skip the next <CODE>n</CODE> events from the master. This is
useful for recovering from replication stops caused by a statement.

</P>
<P>
This statement is valid only when the slave thread is not running.
Otherwise, it produces an error.

</P>
<P>
Before MySQL 4.0, omit the <CODE>GLOBAL</CODE> keyword from the statement.

</P>



<H4><A NAME="SHOW_SLAVE_STATUS" HREF="manual_toc.html#SHOW_SLAVE_STATUS">14.6.2.7  <CODE>SHOW SLAVE STATUS</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1804"></A>

</P>

<PRE>
SHOW SLAVE STATUS
</PRE>

<P>
Provides status information on
essential parameters of the slave threads. If you issue this statement using
the
<CODE>mysql</CODE> client, you can use a <CODE>\G</CODE> statement terminator rather than
semicolon to get a more readable vertical layout:

</P>

<PRE>
mysql&#62; SHOW SLAVE STATUS\G
*************************** 1. row ***************************
       Slave_IO_State: Waiting for master to send event
          Master_Host: localhost
          Master_User: root
          Master_Port: 3306
        Connect_Retry: 3
      Master_Log_File: gbichot-bin.005
  Read_Master_Log_Pos: 79
       Relay_Log_File: gbichot-relay-bin.005
        Relay_Log_Pos: 548
Relay_Master_Log_File: gbichot-bin.005
     Slave_IO_Running: Yes
    Slave_SQL_Running: Yes
      Replicate_Do_DB:
  Replicate_Ignore_DB:
           Last_Errno: 0
           Last_Error:
         Skip_Counter: 0
  Exec_Master_Log_Pos: 79
      Relay_Log_Space: 552
      Until_Condition: None
       Until_Log_File:
        Until_Log_Pos: 0
   Master_SSL_Allowed: No
   Master_SSL_CA_File:
   Master_SSL_CA_Path:
      Master_SSL_Cert:
    Master_SSL_Cipher:
       Master_SSL_Key:
Seconds_Behind_Master: 8
</PRE>

<P>
Depending on your version of MySQL, you may not see all the fields just
shown. In particular, several fields are present only as of MySQL 4.1.1.

</P>
<P>
<CODE>SHOW SLAVE STATUS</CODE> returns the following fields:

</P>
<DL COMPACT>

<DT><CODE>Slave_IO_State</CODE>
<DD>
A copy of the <CODE>State</CODE> field of
the output of <CODE>SHOW PROCESSLIST</CODE> for the slave I/O thread. This
tells you if the thread is trying to connect to the master, waiting
for events from the master, reconnecting to the master, and so on. Possible
states are listed in section <A HREF="manual.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>. Looking at
this field is necessary because, for example, the thread can be running
but unsuccessfully trying to connect to the master; only this field
will make you aware of the connection problem.
On the opposite, the state of the SQL thread is not copied, because
things are simpler for this thread: If it is running, there is no
problem; if it is not, you will find the error in the
<CODE>Last_Error</CODE> field (described below). 

This field is present beginning with MySQL 4.1.1.

<DT><CODE>Master_Host</CODE>
<DD>
The current master host.

<DT><CODE>Master_User</CODE>
<DD>
The current user used to connect to the master.

<DT><CODE>Master_Port</CODE>
<DD>
The current master port.

<DT><CODE>Connect_Retry</CODE>
<DD>
The current value of the <CODE>--master-connect-retry</CODE> option.

<DT><CODE>Master_Log_File</CODE>
<DD>
The name of the master binary log file from which the I/O thread is
currently reading.

<DT><CODE>Read_Master_Log_Pos</CODE>
<DD>
The position up to which the I/O thread has read in the current master binary log.

<DT><CODE>Relay_Log_File</CODE>
<DD>
The name of the relay log file from which the SQL thread is currently
reading and executing.

<DT><CODE>Relay_Log_Pos</CODE>
<DD>
The position up to which the SQL thread has read and executed in the current relay log.

<DT><CODE>Relay_Master_Log_File</CODE>
<DD>
The name of the master binary log file that contains the
last event executed by the SQL thread.

<DT><CODE>Slave_IO_Running</CODE>
<DD>
Whether or not the I/O thread is started.

<DT><CODE>Slave_SQL_Running</CODE>
<DD>
Whether or not the SQL thread is started.

<DT><CODE>Replicate_Do_DB, Replicate_Ignore_DB</CODE>
<DD>
The lists of databases that were specified with the
<CODE>--replicate-do-db</CODE> and <CODE>--replicate-ignore-db</CODE> options, if any.

These fields are present beginning with MySQL 4.1.1.

<DT><CODE>Replicate_Do_Table, Replicate_Ignore_Table, Replicate_Wild_Do_Table, Replicate_Wild_Ignore_Table</CODE>
<DD>
The lists of tables that were specified with the
<CODE>--replicate-do-table</CODE>,
<CODE>--replicate-ignore-table</CODE>,
<CODE>--replicate-wild-do-table</CODE>,
and
<CODE>--replicate-wild-ignore_table</CODE>
options, if any.

These fields are present beginning with MySQL 4.1.1.

<DT><CODE>Last_Errno, Last_Error</CODE>
<DD>
The error number and error message returned by the most recently executed query.
An error number of 0 and message of the empty string mean ``no error.''
If the <CODE>Last_Error</CODE> value is not empty, it will also appear as a
message in the slave's error log.

For example:


<PRE>
Last_Errno: 1051
Last_Error: error 'Unknown table 'z'' on query 'drop table z'
</PRE>

The message indicates that
the table <CODE>z</CODE> existed on the master and was dropped there, but it
did not exist on the slave, so <CODE>DROP TABLE</CODE> failed on the slave.
(This might occur, for example, if you forget to copy the table to the
slave when setting up replication.)

<DT><CODE>Skip_Counter</CODE>
<DD>
The last used value for <CODE>SQL_SLAVE_SKIP_COUNTER</CODE>.

<DT><CODE>Exec_Master_Log_Pos</CODE>
<DD>
The position of the last event executed by the SQL thread
from the master's binary log (<CODE>Relay_Master_Log_File</CODE>).
(<CODE>Relay_Master_Log_File</CODE>, <CODE>Exec_Master_Log_Pos</CODE>) in the
master's binary log corresponds to
(<CODE>Relay_Log_File</CODE>, <CODE>Relay_Log_Pos</CODE>)
in the relay log.

<DT><CODE>Relay_Log_Space</CODE>
<DD>
The total combined size of all existing relay logs.

<DT><CODE>Until_Condition, Until_Log_File, Until_Log_Pos</CODE>
<DD>
The values specified in the <CODE>UNTIL</CODE> clause of the <CODE>START SLAVE</CODE>
statement.

<CODE>Until_Condition</CODE> has these values:


<UL>
<LI>

<CODE>None</CODE> if no <CODE>UNTIL</CODE> clause was specified
<LI>

<CODE>Master</CODE> if the slave is reading until a given position in the master's
binary logs
<LI>

<CODE>Relay</CODE> if the slave is reading until a given position in its relay logs
</UL>

<CODE>Until_Log_File</CODE> and <CODE>Until_Log_Pos</CODE> indicate the log filename and
position values that define the point at which the SQL thread will stop
executing.

These fields are present beginning with MySQL 4.1.1.

<DT><CODE>Master_SSL_Allowed, Master_SSL_CA_File, Master_SSL_CA_Path, Master_SSL_Cert, Master_SSL_Cipher, Master_SSL_Key</CODE>
<DD>
These fields show the
the SSL parameters used by the slave to connect to the master, if any.

<CODE>Master_SSL_Allowed</CODE> has these values:


<UL>
<LI>

<CODE>Yes</CODE> if an SSL connection to the master is allowed
<LI>

<CODE>No</CODE> if an SSL connection to the master is not allowed
<LI>

<CODE>Ignored</CODE> if an SSL connection is allowed but the slave server does not
have SSL support enabled
</UL>

The values of the other SSL-related fields correspond to the values of the
<CODE>--master-ca</CODE>,
<CODE>--master-capath</CODE>,
<CODE>--master-cert</CODE>,
<CODE>--master-cipher</CODE>,
and
<CODE>--master-key</CODE>
options.

These fields are present beginning with MySQL 4.1.1.

<DT><CODE>Seconds_Behind_Master</CODE>
<DD>
The number of seconds that have elapsed since the timestamp of the last
master's event executed by the slave SQL thread. This will be <CODE>NULL</CODE>
when no event has been executed yet, or after <CODE>CHANGE MASTER</CODE> and
<CODE>RESET SLAVE</CODE>. This field can be used to know how ``late'' your slave
is. It will work even though your master and slave don't have identical
clocks.

This field is present beginning with MySQL 4.1.1.

</DL>



<H4><A NAME="START_SLAVE" HREF="manual_toc.html#START_SLAVE">14.6.2.8  <CODE>START SLAVE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1805"></A>

</P>

<PRE>
START SLAVE [thread_type [, thread_type] ... ]
START SLAVE [SQL_THREAD] UNTIL
    MASTER_LOG_FILE = 'log_name', MASTER_LOG_POS = log_pos
START SLAVE [SQL_THREAD] UNTIL
    RELAY_LOG_FILE = 'log_name', RELAY_LOG_POS = log_pos

thread_type: IO_THREAD | SQL_THREAD
</PRE>

<P>
<CODE>START SLAVE</CODE> with no options starts both of the slave threads.
The I/O thread reads queries from the master server and stores them in the
relay log.  The SQL thread reads the relay log and executes the
queries.
<CODE>START SLAVE</CODE> requires the <CODE>SUPER</CODE> privilege.

</P>
<P>
If <CODE>START SLAVE</CODE> succeeds in starting the slave threads, it
returns without any error. However, even in that case, it might be that the slave
threads start and then later stop (for example, because they don't manage to
connect to the master or read its binary logs, or some other
problem). <CODE>START SLAVE</CODE> will not warn you about this. You must
check your slave's error log for error messages generated by
the slave threads, or check that they are running fine with <CODE>SHOW
SLAVE STATUS</CODE>.

</P>

<P>
As of MySQL 4.0.2, you can add <CODE>IO_THREAD</CODE> and <CODE>SQL_THREAD</CODE>
options to the statement to name which of the threads to start.

</P>
<P>
As of MySQL 4.1.1, an <CODE>UNTIL</CODE> clause may be added to specify that
the slave should start and run until the SQL thread reaches a given point in
the master binary logs or in the slave relay logs. When the SQL thread reaches
that point, it stops.  If the <CODE>SQL_THREAD</CODE> option is specified in the
statement, it starts only the SQL thread.  Otherwise, it starts both slave
threads.  If the SQL thread is already running, the <CODE>UNTIL</CODE> clause is
ignored and a warning is issued.

</P>
<P>
With an <CODE>UNTIL</CODE> clause, you must specify both a log filename and
position. Do not mix master and relay log options.

</P>
<P>
Any <CODE>UNTIL</CODE> condition is reset by a subsequent <CODE>STOP SLAVE</CODE>
statement, a <CODE>START SLAVE</CODE> statement that includes no <CODE>UNTIL</CODE>
clause, or a server restart.

</P>
<P>
The <CODE>UNTIL</CODE> clause can be useful for debugging replication, or to
cause replication to proceed until just before the point where you want
to avoid having the slave replicate a statement. For example, if an unwise
<CODE>DROP TABLE</CODE> statement was executed on the master, you can use
<CODE>UNTIL</CODE> to tell the slave to execute up to that point but no farther.
To find what the event is, use <CODE>mysqlbinlog</CODE> with the master logs or
slave relay logs, or by using a <CODE>SHOW BINLOG EVENTS</CODE> statement.

</P>
<P>
If you are using <CODE>UNTIL</CODE> to have the slave process replicated queries in
sections, it is recommended that you start the slave with the
<CODE>--skip-slave-start</CODE> option to prevent the SQL thread from running
when the slave server starts.  It is probably best to use this option in an
option file rather than on the command line, so that an unexpected server
restart does not cause it to be forgotten.

</P>
<P>
The <CODE>SHOW SLAVE STATUS</CODE> statement includes output fields that display
the current values of the <CODE>UNTIL</CODE> condition.

</P>
<P>
This statement is called <CODE>SLAVE START</CODE> before MySQL 4.0.5.
For the moment, <CODE>SLAVE START</CODE> is still accepted for backward
compatibility, but is deprecated.

</P>



<H4><A NAME="STOP_SLAVE" HREF="manual_toc.html#STOP_SLAVE">14.6.2.9  <CODE>STOP SLAVE</CODE> Syntax</A></H4>

<P>
<A NAME="IDX1806"></A>

</P>

<PRE>
STOP SLAVE [thread_type [, thread_type] ... ]

thread_type: IO_THREAD | SQL_THREAD
</PRE>

<P>
Stops the slave threads.
<CODE>STOP SLAVE</CODE> requires the <CODE>SUPER</CODE> privilege.

</P>
<P>
Like <CODE>START SLAVE</CODE>, as of MySQL 4.0.2, this statement
may be used with the <CODE>IO_THREAD</CODE> and <CODE>SQL_THREAD</CODE> options to name
the thread or threads to stop.

</P>

<P>
This statement is called <CODE>SLAVE STOP</CODE> before MySQL 4.0.5.
For the moment, <CODE>SLAVE STOP</CODE> is still accepted for backward
compatibility, but is deprecated.

</P>



<H1><A NAME="Table_types" HREF="manual_toc.html#Table_types">15  MySQL Storage Engines and Table Types</A></H1>

<P>
<A NAME="IDX1807"></A>
<A NAME="IDX1808"></A>
<A NAME="IDX1809"></A>
<A NAME="IDX1810"></A>
<A NAME="IDX1811"></A>
<A NAME="IDX1812"></A>
<A NAME="IDX1813"></A>
<A NAME="IDX1814"></A>
<A NAME="IDX1815"></A>
<A NAME="IDX1816"></A>
<A NAME="IDX1817"></A>
<A NAME="IDX1818"></A>
<A NAME="IDX1819"></A>
<A NAME="IDX1820"></A>
<A NAME="IDX1821"></A>
<A NAME="IDX1822"></A>
<A NAME="IDX1823"></A>
<A NAME="IDX1824"></A>
<A NAME="IDX1825"></A>
<A NAME="IDX1826"></A>
<A NAME="IDX1827"></A>

</P>
<P>
MySQL supports several storage engines that act as handlers for different
table types. MySQL storage engines include both those that handle
transaction-safe tables and those that handle non-transaction-safe tables:

</P>

<UL>
<LI>

The original storage engine was <CODE>ISAM</CODE>, which managed non-transactional
tables. This engine has been replaced by <CODE>MyISAM</CODE> and should no longer
be used. It is deprecated in MySQL 4.1, and will be removed in MySQL 5.0.

<LI>

In MySQL 3.23.0, the <CODE>MyISAM</CODE> and <CODE>HEAP</CODE> storage engines were
introduced.  <CODE>MyISAM</CODE> is an improved replacement for <CODE>ISAM</CODE>.
The <CODE>HEAP</CODE> storage engine provides in-memory tables.
The <CODE>MERGE</CODE> storage engine was
added in MySQL 3.23.25.  It allows a collection of identical <CODE>MyISAM</CODE>
tables to be handled as a single table.  All three of these storage engines
handle non-transactional tables, and all are included in MySQL by default.
Note that the
<CODE>HEAP</CODE> storage engine now
is known as the <CODE>MEMORY</CODE> engine.

<LI>

The <CODE>InnoDB</CODE> and <CODE>BDB</CODE>
storage engines that handle transaction-safe tables were introduced in later
versions of MySQL 3.23.
Both are available in source distributions as of MySQL 3.23.34a.
<CODE>BDB</CODE> is included in MySQL-Max binary distributions on those operating
systems that support it.  <CODE>InnoDB</CODE> also is included in MySQL-Max binary
distributions for MySQL 3.23.  Beginning with MySQL 4.0, <CODE>InnoDB</CODE>
is included by default in all MySQL binary distributions.  In source
distributions, you can enable or disable either engine by configuring MySQL
as you like.

</UL>

<P>
This chapter describes each of the MySQL storage engines except for
<CODE>InnoDB</CODE>, which is covered in section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.

</P>
<P>
When you create a new table, you can tell MySQL what type of table to create
by adding an <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> table option to the <CODE>CREATE
TABLE</CODE> statement:

</P>

<PRE>
CREATE TABLE t (i INT) ENGINE = INNODB;
CREATE TABLE t (i INT) TYPE = MEMORY;
</PRE>

<P>
<CODE>ENGINE</CODE> is the preferred term, but cannot be used before MySQL 4.0.18.
<CODE>TYPE</CODE> is available beginning with MySQL 3.23.0, the first
version of MySQL for which multiple storage engines were available.

</P>
<P>
If you omit the <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> option,
the default table type is usually <CODE>MyISAM</CODE>.
This can be changed by setting the <CODE>table_type</CODE> system variable.

</P>
<P>
To convert a table from one type to another, use an <CODE>ALTER TABLE</CODE>
statement that indicates the new type:

</P>

<PRE>
ALTER TABLE t ENGINE = MYISAM;
ALTER TABLE t TYPE = BDB;
</PRE>

<P>
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A> and
section <A HREF="manual.html#ALTER_TABLE">14.2.2  <CODE>ALTER TABLE</CODE> Syntax</A>.

</P>

<P>
If you try to use a storage engine that is not compiled in or that is
compiled in but deactivated, MySQL instead creates a table of type
<CODE>MyISAM</CODE>.  This behavior is convenient when you want to copy tables
between MySQL servers that support different storage engines. (For example, in
a replication setup, perhaps your
master server supports transactional storage engines for increased safety,
but the slave servers use only non-transactional storage engines for greater
speed.)

</P>
<P>
This automatic automatic substitution of the <CODE>MyISAM</CODE> table type when an
unavailable type is specified can be confusing for new MySQL
users.  In MySQL 4.1 and up, a warning is generated when a table type is
automatically changed.

</P>
<P>
MySQL always creates an <TT>`.frm'</TT> file to hold the table and column
definitions. The table's index and data may be stored in one or more other
files, depending on the table type.
The server creates the <TT>`.frm'</TT> file above the storage engine level.
Individual storage engines create any additional files required for the tables
that they manage.

</P>
<P>
A database may contain tables of different types.

</P>
<P>
Transaction-safe tables (TSTs) have several advantages over
non-transaction-safe tables (NTSTs):

</P>

<UL>
<LI>

Safer. Even if MySQL crashes or you get hardware problems, you
can get your data back, either by automatic recovery or from a backup
plus the transaction log.
<LI>

You can combine many statements and accept them all at the same time with
the <CODE>COMMIT</CODE> statement (if autocommit is disabled).
<LI>

You can execute <CODE>ROLLBACK</CODE> to ignore your changes (if
autocommit is disabled).
<LI>

If an update fails, all your changes will be restored. (With
non-transaction-safe tables, all
changes that have taken place are permanent.)
<LI>

Transaction-safe storage engines
can provide better concurrency for tables that get many updates concurrently
with reads.
</UL>

<P>
Note that to use the <CODE>InnoDB</CODE> storage engine in MySQL 3.23, you
must configure at least the <CODE>innodb_data_file_path</CODE> startup option.
In 4.0 and up, <CODE>InnoDB</CODE> uses default configuration values if you specify
none.
See section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.

</P>
<P>
Non-transaction-safe tables have several advantages of their own, all
of which occur because there is no transaction overhead:

</P>

<UL>
<LI>

Much faster
<LI>

Lower disk space requirements
<LI>

Less memory required to perform updates
</UL>

<P>
You can combine transaction-safe and non-transaction-safe tables in the same statements to get the best
of both worlds. However, within a transaction with autocommit disabled,
changes to non-transaction-safe tables still are committed immediately and
cannot be rolled back.

</P>



<H2><A NAME="MyISAM" HREF="manual_toc.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A></H2>

<P>
<A NAME="IDX1828"></A>
<A NAME="IDX1829"></A>
<A NAME="IDX1830"></A>

</P>
<P>
<CODE>MyISAM</CODE> is the default storage engine as of MySQL 3.23. It is
based on the <CODE>ISAM</CODE> code but has many useful extensions.

</P>
<P>
Each <CODE>MyISAM</CODE> table is stored on disk in three files.  The files have
names that begin with the table name and have an extension to indicate the
file type.  An <TT>`.frm'</TT> file stores the table definition.  The data file
has an <TT>`.MYD'</TT> (MYData) extension.  The index file has an <TT>`.MYI'</TT>
(MYIndex) extension,

</P>
<P>
To specify explicitly that you want a <CODE>MyISAM</CODE> table, indicate that with
an <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> table option:

</P>

<PRE>
CREATE TABLE t (i INT) ENGINE = MYISAM;
CREATE TABLE t (i INT) TYPE = MYISAM;
</PRE>

<P>
Normally, the <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> option is unnecessary;
<CODE>MyISAM</CODE> is the default storage engine unless the default has been
changed.

</P>
<P>
You can check or repair <CODE>MyISAM</CODE> tables with the <CODE>myisamchk</CODE>
utility. See section <A HREF="manual.html#Crash_recovery">5.6.2.7  Using <CODE>myisamchk</CODE> for Crash Recovery</A>. You can compress <CODE>MyISAM</CODE> tables with
<CODE>myisampack</CODE> to take up much less space.
See section <A HREF="manual.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A>.

</P>
<P>
The following characteristics of the <CODE>MyISAM</CODE> storage engine are
improvements over the older <CODE>ISAM</CODE> engine:

</P>

<UL>

<LI>

All data values are stored with the low byte first. This makes the data
machine and operating system independent. The only requirement for binary
portability is that the machine uses two's-complement signed integers
(as every machine for the last 20 years has) and IEEE floating-point
format (also totally dominant among mainstream machines). The only area of
machines that may not support binary compatibility are embedded systems,
which sometimes have peculiar processors.

There is no big speed penalty for storing data low byte first; the bytes
in a table row normally are unaligned and it doesn't take that much more
power to read an unaligned byte in order than in reverse order.  Also, the
code in the server that fetches column values is not time critical compared
to other code.

<LI>

Large files (up to 63-bit file length) are supported on
filesystems and operating systems that support large files.

<LI>

Dynamic-sized rows are much less fragmented when mixing deletes
with updates and inserts.  This is done by automatically combining adjacent
deleted blocks and by extending blocks if the next block is deleted.

<LI>

The maximum number of indexes per table is 64 (32 before MySQL 4.1.2).  This
can be changed by recompiling.  The maximum number of columns per index is 16.

<LI>

The maximum key length is 1000 bytes (500 before MySQL 4.1.2).
This can be changed by recompiling.  For the case of a key longer than
250 bytes, a larger key block size than the default of 1024 bytes is used.

<LI>

<CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns can be indexed.

<LI>

<CODE>NULL</CODE> values are allowed in indexed columns.  This takes 0-1
bytes per key.

<LI>

All numeric key values are stored with the high byte first to allow better index
compression.

<LI>

Index files are usually much smaller with <CODE>MyISAM</CODE> than with
<CODE>ISAM</CODE>. This means that <CODE>MyISAM</CODE> normally will use less
system resources than <CODE>ISAM</CODE>, but will need more CPU time when inserting
data into a compressed index.

<LI>

When records are inserted in sorted order (as when you are using an
<CODE>AUTO_INCREMENT</CODE> column), the index tree is split so that the high
node only contains one key. This improves space utilization in the index
tree.

<LI>

Internal handling of one <CODE>AUTO_INCREMENT</CODE> column per table.
<CODE>MyISAM</CODE> automatically updates this column for <CODE>INSERT/UPDATE</CODE>.  This
makes <CODE>AUTO_INCREMENT</CODE> columns faster (at least 10%).
Values at the top of the sequence are not reused after being deleted as they
are with <CODE>ISAM</CODE>.  (When an <CODE>AUTO_INCREMENT</CODE> column is
defined as the last column of a multiple-column index, reuse of deleted
values does occur.)  The <CODE>AUTO_INCREMENT</CODE> value can be reset with
<CODE>ALTER TABLE</CODE> or <CODE>myisamchk</CODE>.

<LI>

If a table doesn't have free blocks in the middle of the data file, you can
<CODE>INSERT</CODE> new rows into it at the same time that other threads are
reading from the table. (These are known as concurrent inserts.) A free block can
occur as a result of deleting rows or an update of a dynamic length row with
more data than its current contents.  When all free blocks are used up
(filled in), future inserts become concurrent again.

<LI>

You can put the data file and index file on different directories
to get more speed with the <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX DIRECTORY</CODE>
table options to
<CODE>CREATE TABLE</CODE>. See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

<LI>

As of MySQL 4.1, each character column can have a different character set.

<LI>

There is a flag in the <CODE>MyISAM</CODE> index file that indicates whether the
table was closed correctly.  If <CODE>mysqld</CODE> is started with the
<CODE>--myisam-recover</CODE> option, <CODE>MyISAM</CODE> tables are automatically
checked (and optionally repaired) when opened if the table wasn't closed
properly.

<LI>

<CODE>myisamchk</CODE> marks tables as checked if you run it with the
<CODE>--update-state</CODE> option. <CODE>myisamchk --fast</CODE> checks only those
tables that don't have this mark.

<LI>

<CODE>myisamchk --analyze</CODE> stores statistics for key parts, not only for
whole keys as in <CODE>ISAM</CODE>.

<LI>

<CODE>myisampack</CODE> can pack <CODE>BLOB</CODE> and <CODE>VARCHAR</CODE> columns;
<CODE>pack_isam</CODE> cannot.

</UL>

<P>
<CODE>MyISAM</CODE> also supports the following features, which MySQL
will be able to use in the near future:

</P>

<UL>

<LI>

Support for a true <CODE>VARCHAR</CODE> type; a <CODE>VARCHAR</CODE> column starts
with a length stored in two bytes.

<LI>

Tables with <CODE>VARCHAR</CODE> may have fixed or dynamic record length.

<LI>

<CODE>VARCHAR</CODE> and <CODE>CHAR</CODE> columns may be up to 64KB.

<LI>

A hashed computed index can be used for <CODE>UNIQUE</CODE>. This will allow
you to have <CODE>UNIQUE</CODE> on any combination of columns in a table. (You
can't search on a <CODE>UNIQUE</CODE> computed index, however.)

</UL>



<H3><A NAME="MyISAM_start" HREF="manual_toc.html#MyISAM_start">15.1.1  <CODE>MyISAM</CODE> Startup Options</A></H3>

<P>
The following options to <CODE>mysqld</CODE> can be used to change the behavior of
<CODE>MyISAM</CODE> tables:

</P>
<DL COMPACT>

<DT><CODE>--myisam-recover=mode</CODE>
<DD>
Set the mode for automatic recovery of crashed <CODE>MyISAM</CODE> tables.

<DT><CODE>--delay-key-write=ALL</CODE>
<DD>
Don't flush key buffers between writes for any <CODE>MyISAM</CODE> table.

<STRONG>Note:</STRONG> If you do this, you should not use <CODE>MyISAM</CODE> tables from
another program (such as from another MySQL server or with <CODE>myisamchk</CODE>) when
the table is in use. Doing so will lead to index corruption.

Using <CODE>--external-lock</CODE> will not help for tables that use
<CODE>--delay-key-write</CODE>.

</DL>

<P>
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
The following system variables affect the behavior of
<CODE>MyISAM</CODE> tables:

</P>
<DL COMPACT>

<DT><CODE>bulk_insert_buffer_size</CODE>
<DD>
The size of the tree cache used in bulk insert
optimization. <STRONG>Note:</STRONG> This is a limit <EM>per thread</EM>!

<DT><CODE>myisam_max_extra_sort_file_size</CODE>
<DD>
Used to help MySQL to decide when to use the slow but safe key cache index
creation method. <STRONG>Note:</STRONG> This parameter is given in megabytes
before MySQL 4.0.3, and in bytes as of 4.0.3.

<DT><CODE>myisam_max_sort_file_size</CODE>
<DD>
Don't use the fast sort index method to create an index if the temporary
file would become larger than this.  <STRONG>Note:</STRONG> This parameter is
given in megabytes before MySQL 4.0.3, and in bytes as of 4.0.3.

<DT><CODE>myisam_sort_buffer_size</CODE>
<DD>
Set the size of the buffer used when recovering tables.

</DL>

<P>
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</P>
<P>
Automatic recovery is activated if you start <CODE>mysqld</CODE> with the
<CODE>--myisam-recover</CODE> option. In this case, when the server opens a
<CODE>MyISAM</CODE> table, it checks whether the table
is marked as crashed or whether the open count variable for the
table is not 0 and you are running the server with
<CODE>--skip-external-locking</CODE>.  If either of these conditions is true, the
following happens:

</P>

<UL>

<LI>

The table is checked for errors.

<LI>

If the server finds an error, it tries to do a fast table repair (with
sorting and without re-creating the data file).

<LI>

If the repair fails because of an error in the data file (for example, a
duplicate-key error), the server tries again, this time re-creating the
data file.

<LI>

If the repair still fails, the server tries once more with the old repair option
method (write row by row without sorting). This method should be able to repair
any type of error and has low disk space requirements.

</UL>

<P>
If the recovery wouldn't be able to recover all rows from a previous
completed statement and you didn't specify <CODE>FORCE</CODE> in the value of the
<CODE>--myisam-recover</CODE> option, automatic repair aborts with an error
message in the error log:

</P>

<PRE>
Error: Couldn't repair table: test.g00pages
</PRE>

<P>
If you specify <CODE>FORCE</CODE>, a warning like this is written instead:

</P>

<PRE>
Warning: Found 344 of 354 rows when repairing ./test/g00pages
</PRE>

<P>
Note that if the automatic recovery value includes <CODE>BACKUP</CODE>, the
recovery process creates files with names of the form
<TT>`tbl_name-datetime.BAK'</TT>.  You should have a <CODE>cron</CODE> script that
automatically moves these files from the database directories to backup
media.

</P>



<H3><A NAME="Key_space" HREF="manual_toc.html#Key_space">15.1.2  Space Needed for Keys</A></H3>

<P>
<A NAME="IDX1831"></A>

</P>
<P>
<CODE>MyISAM</CODE> tables use B-tree indexes. You can roughly calculate
the size for the index file as <CODE>(key_length+4)/0.67</CODE>, summed over
all keys.  This is for the worst case when all keys are inserted in
sorted order and the table doesn't have any compressed keys.

</P>
<P>
String indexes are space compressed. If the first index part is a
string, it will also be prefix compressed.  Space compression makes the
index file smaller than the worst-case figure if the string column has a lot
of trailing space or is a <CODE>VARCHAR</CODE> column that is not always used
to the full length. Prefix compression is used on keys that start
with a string.  Prefix compression helps if there are many strings
with an identical prefix.

</P>
<P>
In <CODE>MyISAM</CODE> tables, you can also prefix compress numbers by specifying
<CODE>PACK_KEYS=1</CODE> when you create the table.  This helps when you have
many integer keys that have an identical prefix when the numbers are stored
high-byte first.

</P>



<H3><A NAME="MyISAM_table_formats" HREF="manual_toc.html#MyISAM_table_formats">15.1.3  <CODE>MyISAM</CODE> Table Storage Formats</A></H3>

<P>
<CODE>MyISAM</CODE> supports three different storage formats. Two of them (fixed
and dynamic format) are chosen automatically depending on the type of
columns you are using. The third, compressed format, can be created only
with the <CODE>myisampack</CODE> utility.

</P>
<P>
When you <CODE>CREATE</CODE> or <CODE>ALTER</CODE> a table that has no <CODE>BLOB</CODE>
or <CODE>TEXT</CODE> columns, you can force the table format to <CODE>FIXED</CODE> or
<CODE>DYNAMIC</CODE> with the <CODE>ROW_FORMAT</CODE> table option. This causes
<CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> columns to become <CODE>CHAR</CODE> for
<CODE>FIXED</CODE> format or <CODE>VARCHAR</CODE> for <CODE>DYNAMIC</CODE> format.

</P>
<P>
In the future, you will be able to compress or decompress tables by specifying
<CODE>ROW_FORMAT={COMPRESSED | DEFAULT}</CODE> to <CODE>ALTER TABLE</CODE>.
See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</P>



<H4><A NAME="Static_format" HREF="manual_toc.html#Static_format">15.1.3.1  Static (Fixed-Length) Table Characteristics</A></H4>

<P>
Static format is the default for <CODE>MyISAM</CODE> tables.  It is used when the
table contains no variable-length columns (<CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, or
<CODE>TEXT</CODE>). Each row is stored using a fixed number of bytes.

</P>
<P>
Of the three <CODE>MyISAM</CODE> storage formats, static format is the simplest
and most secure (least subject to corruption). It is also the fastest of the
on-disk formats. The speed comes from the easy way that rows in the data file
can be found on disk: When looking up a row based on a row number in the
index, multiply the row number by the row length.  Also, when scanning a
table, it is very easy to read a constant number of records with each disk
read operation.

</P>
<P>
The security is evidenced if your computer crashes while the MySQL server is
writing to a fixed-format <CODE>MyISAM</CODE> file. In this case, <CODE>myisamchk</CODE>
can easily determine where each row starts and ends, so it can usually
reclaim all records except the partially written one. Note that <CODE>MyISAM</CODE>
table
indexes can always be reconstructed based on the data rows.

</P>
<P>
General characteristics of static format tables:

</P>

<UL>

<LI>

All <CODE>CHAR</CODE>, <CODE>NUMERIC</CODE>, and <CODE>DECIMAL</CODE> columns are space-padded
to the column width.

<LI>

Very quick.

<LI>

Easy to cache.

<LI>

Easy to reconstruct after a crash, because records are located in fixed
positions.

<LI>

Reorganization is unnecessary unless you delete a huge number of records
and want to return free disk space to the operating system. To do this,
use <CODE>OPTIMIZE TABLE</CODE> or <CODE>myisamchk -r</CODE>.

<LI>

Usually require more disk space than for dynamic-format tables.

</UL>



<H4><A NAME="Dynamic_format" HREF="manual_toc.html#Dynamic_format">15.1.3.2  Dynamic Table Characteristics</A></H4>

<P>
<A NAME="IDX1832"></A>
<A NAME="IDX1833"></A>

</P>
<P>
Dynamic storage format is used if a <CODE>MyISAM</CODE> table contains any
variable-length columns (<CODE>VARCHAR</CODE>, <CODE>BLOB</CODE>, or <CODE>TEXT</CODE>), or if
the table was created with the <CODE>ROW_FORMAT=DYNAMIC</CODE> option.

</P>
<P>
This format is a little more complex because each row has a header that
indicates
how long it is. One record can also end up at more than one location when it
is made longer as a result of an update.

</P>
<P>
<A NAME="IDX1834"></A>
You can use <CODE>OPTIMIZE TABLE</CODE> or <CODE>myisamchk</CODE> to defragment a
table. If you have fixed-length columns that you access or change frequently
in a table that also contains some variable-length columns, it might be
a good idea to move the variable-length columns to other tables just to
avoid fragmentation.

</P>
<P>
General characteristics of dynamic-format tables:

</P>

<UL>

<LI>

All string columns are dynamic except those with a length less than four.

<LI>

Each record is preceded by a bitmap that indicates which columns contain the
empty string (for string columns) or zero (for numeric columns). Note that
this does not include columns that contain <CODE>NULL</CODE> values. If a string
column has a length of zero after trailing space removal, or a numeric
column has a value of zero, it is marked in the bitmap and not saved to
disk.  Non-empty strings are saved as a length byte plus the string
contents.

<LI>

Much less disk space usually is required than for fixed-length tables.

<LI>

Each record uses only as much space as is required. However, if a record
becomes larger, it is split into as many pieces as are required, resulting
in record fragmentation.  For example, if you update a row with information
that extends the row length, the row will be fragmented.  In this case,
you may have to run <CODE>OPTIMIZE TABLE</CODE> or <CODE>myisamchk -r</CODE> from time to time to get better
performance.  Use <CODE>myisamchk -ei</CODE> to obtain table statistics.

<LI>

More difficult than static-format tables to reconstruct after a crash,
because a record may be fragmented into many pieces and a link (fragment)
may be missing.

<LI>

The expected row length for dynamic-sized records is calculated using the
following expression:


<PRE>
3
+ (number of columns + 7) / 8
+ (number of char columns)
+ (packed size of numeric columns)
+ (length of strings)
+ (number of NULL columns + 7) / 8
</PRE>

There is a penalty of 6 bytes for each link. A dynamic record is linked
whenever an update causes an enlargement of the record. Each new link will be
at least 20 bytes, so the next enlargement will probably go in the same link.
If not, there will be another link. You may check how many links there are
with <CODE>myisamchk -ed</CODE>. All links may be removed with <CODE>myisamchk -r</CODE>.

</UL>



<H4><A NAME="Compressed_format" HREF="manual_toc.html#Compressed_format">15.1.3.3  Compressed Table Characteristics</A></H4>

<P>
<A NAME="IDX1835"></A>
<A NAME="IDX1836"></A>
<A NAME="IDX1837"></A>
<A NAME="IDX1838"></A>

</P>
<P>
Compressed storage format is a read-only format that is generated with the
<CODE>myisampack</CODE> tool.

</P>
<P>
All MySQL distributions as of version 3.23.19 include <CODE>myisampack</CODE> by
default. (This is when MySQL was placed under the GPL.) For earlier
versions, <CODE>myisampack</CODE> was included only with licenses or support
agreements, but the server still can read tables that were compressed
with <CODE>myisampack</CODE>.  Compressed tables can be uncompressed with
<CODE>myisamchk</CODE>.  (For the <CODE>ISAM</CODE> storage engine, compressed tables
can be created with <CODE>pack_isam</CODE> and uncompressed with <CODE>isamchk</CODE>.)

</P>
<P>
Compressed tables have the following characteristics:

</P>

<UL>

<LI>

Compressed tables take very little disk space. This minimizes disk usage, which
is very nice when using slow disks (such as CD-ROMs).

<LI>

Each record is compressed separately, so there is very little access overhead.  The
header for a record is fixed (1-3 bytes) depending on the biggest record in the
table.  Each column is compressed differently.  There is usually a different
Huffman tree for each column.  Some of the compression types are:


<UL>

<LI>

Suffix space compression.

<LI>

Prefix space compression.

<LI>

Numbers with a value of zero are stored using one bit.

<LI>

If values in an integer column have a small range, the column is stored
using the smallest possible type. For example, a <CODE>BIGINT</CODE> column
(eight bytes) can be stored as a <CODE>TINYINT</CODE> column (one byte) if all
its values are in the range from <CODE>-128</CODE> to <CODE>127</CODE>.

<LI>

If a column has only a small set of possible values, the column type is
converted to <CODE>ENUM</CODE>.

<LI>

A column may use a combination of the preceding compressions.

</UL>

<LI>

Can handle fixed-length or dynamic-length records.

</UL>



<H3><A NAME="MyISAM_table_problems" HREF="manual_toc.html#MyISAM_table_problems">15.1.4  <CODE>MyISAM</CODE> Table Problems</A></H3>

<P>
The file format that MySQL uses to store data has been extensively
tested, but there are always circumstances that may cause database tables
to become corrupted.

</P>



<H4><A NAME="Corrupted_MyISAM_tables" HREF="manual_toc.html#Corrupted_MyISAM_tables">15.1.4.1  Corrupted <CODE>MyISAM</CODE> Tables</A></H4>

<P>
Even though the <CODE>MyISAM</CODE> table format is very reliable (all changes to
a table made by an SQL statement are written before the statement returns),
you can still get corrupted tables if some of the following things happen:

</P>

<UL>

<LI>

The <CODE>mysqld</CODE> process is killed in the middle of a write.

<LI>

Unexpected computer shutdown occurs (for example, the computer is turned off).

<LI>

Hardware errors.

<LI>

You are using an external program (such as <CODE>myisamchk</CODE>) on a table that
is being modified by the server at the same time.

<LI>

A software bug in the MySQL or <CODE>MyISAM</CODE> code.

</UL>

<P>
Typical symptoms for a corrupt table are:

</P>

<UL>

<LI>

You get the following error while selecting data from the table:


<PRE>
Incorrect key file for table: '...'. Try to repair it
</PRE>

<LI>

Queries don't find rows in the table or return incomplete data.

</UL>

<P>
You can check whether a <CODE>MyISAM</CODE> table is okay with the <CODE>CHECK
TABLE</CODE> statement.  You can repair a corrupted <CODE>MyISAM</CODE> table with
<CODE>REPAIR TABLE</CODE>.  When <CODE>mysqld</CODE> is not running, you can also
check or repair a table with the <CODE>myisamchk</CODE> command.
See section <A HREF="manual.html#CHECK_TABLE">14.5.2.3  <CODE>CHECK TABLE</CODE> Syntax</A>,
section <A HREF="manual.html#REPAIR_TABLE">14.5.2.6  <CODE>REPAIR TABLE</CODE> Syntax</A>, and section <A HREF="manual.html#myisamchk_syntax">5.6.2.1  <CODE>myisamchk</CODE> Invocation Syntax</A>.

</P>
<P>
If your tables become corrupted frequently, you should try to determine why
this is happening.  The most important thing to know is whether the table
became corrupted as a result of a server crash. You can verify this easily
by looking for a recent <CODE>restarted mysqld</CODE> message in the error log.
If there is such a message, it is likely that that table corruption is a
result of the server dying.  Otherwise, corruption may have occurred during
normal operation, which is a bug. You should try to create a reproducible
test case that demonstrates the problem.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A> and section <A HREF="manual.html#Reproduceable_test_case">D.1.6  Making a Test Case If You Experience Table Corruption</A>.

</P>



<H4><A NAME="MyISAM_table_close" HREF="manual_toc.html#MyISAM_table_close">15.1.4.2  Problems from Tables Not Being Closed Properly</A></H4>

<P>
Each <CODE>MyISAM</CODE> index (<TT>`.MYI'</TT>) file has a counter in the header
that can be used to check whether a table has been closed properly.
If you get the following warning from <CODE>CHECK TABLE</CODE> or <CODE>myisamchk</CODE>,
it means that this counter has gone out of sync:

</P>

<PRE>
clients are using or haven't closed the table properly
</PRE>

<P>
This warning doesn't necessarily mean that the table is corrupted, but
you should at least check the table to verify that it's okay.

</P>
<P>
The counter works as follows:

</P>

<UL>

<LI>

The first time a table is updated in MySQL, a counter in the
header of the index files is incremented.

<LI>

The counter is not changed during further updates.

<LI>

When the last instance of a table is closed (because of a <CODE>FLUSH
TABLES</CODE> operation or because there isn't room in the table cache), the
counter is decremented if the table has been updated at any point.

<LI>

When you repair the table or check the table and it is found to be okay,
the counter is reset to zero.

<LI>

To avoid problems with interaction with other processes that might
check the table, the counter is not decremented on close if it was zero.

</UL>

<P>
In other words, the counter can go out of sync only under these conditions:

</P>

<UL>

<LI>

The <CODE>MyISAM</CODE> tables are copied without a preceding <CODE>LOCK TABLES</CODE> and
<CODE>FLUSH TABLES</CODE>.

<LI>

MySQL has crashed between an update and the final close.
(Note that the table may still be okay, because MySQL always issues writes
for everything between each statement.)

<LI>

A table was modified by <CODE>myisamchk --recover</CODE> or <CODE>myisamchk
--update-state</CODE> at the same time that it was in use by <CODE>mysqld</CODE>.

<LI>

Many <CODE>mysqld</CODE> servers are using the table and one server performed a
<CODE>REPAIR TABLE</CODE> or <CODE>CHECK TABLE</CODE> on the table while it was in use by
another server.  In this setup, it is safe to use <CODE>CHECK TABLE</CODE>,
although you might get the warning from other servers. However, <CODE>REPAIR
TABLE</CODE> should be avoided because when one server replaces the data file
with a new one, this is not signaled to the other servers.

In general, it is a bad idea to share a data directory among multiple servers.
See section <A HREF="manual.html#Multiple_servers">5.9  Running Multiple MySQL Servers on the Same Machine</A> for additional discussion.

</UL>



<H2><A NAME="MERGE" HREF="manual_toc.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A></H2>

<P>
<A NAME="IDX1839"></A>
<A NAME="IDX1840"></A>
<A NAME="IDX1841"></A>

</P>
<P>
<A NAME="IDX1842"></A>
<A NAME="IDX1843"></A>
<A NAME="IDX1844"></A>

</P>

<P>
The <CODE>MERGE</CODE> storage engine was introduced in MySQL 3.23.25. It
is also known as the <CODE>MRG_MyISAM</CODE> engine. The code is now reasonably
stable.

</P>
<P>
A <CODE>MERGE</CODE> table is a collection of identical <CODE>MyISAM</CODE> tables that
can be used as one.  ``Identical'' means that all tables have
identical column and index information.  You can't merge tables in which the
columns are packed differently, don't have exactly the same columns, or
have the indexes in different order.  However, any or all of the tables can be
compressed with <CODE>myisampack</CODE>.
See section <A HREF="manual.html#myisampack">8.2  <CODE>myisampack</CODE>, the MySQL Compressed Read-only Table Generator</A>.

</P>

<P>
When you create a <CODE>MERGE</CODE> table, MySQL creates two files on disk.
The files have names that begin with the table name and have an extension
to indicate the file type.  An <TT>`.frm'</TT> file stores the table definition,
and an <TT>`.MRG'</TT> file contains the names of the tables that should be
used as one.  (Originally, all used tables had to be in the same database
as the <CODE>MERGE</CODE> table itself. This restriction has been lifted as of
MySQL 4.1.1.)

</P>
<P>
You can use <CODE>SELECT</CODE>, <CODE>DELETE</CODE>, <CODE>UPDATE</CODE>, and (as of MySQL
4.0) <CODE>INSERT</CODE> on the collection of tables.  For the moment, you must
have <CODE>SELECT</CODE>, <CODE>UPDATE</CODE>, and <CODE>DELETE</CODE> privileges on the
tables that you map to a <CODE>MERGE</CODE> table.

</P>
<P>
If you <CODE>DROP</CODE> the <CODE>MERGE</CODE> table, you are dropping only the
<CODE>MERGE</CODE> specification. The underlying tables are not affected.

</P>
<P>
When you create a <CODE>MERGE</CODE> table, you must specify a
<CODE>UNION=(list-of-tables)</CODE> clause that indicates which tables you want to
use as one. You can optionally specify an <CODE>INSERT_METHOD</CODE> option if you
want inserts for the <CODE>MERGE</CODE> table to happen in the first or last table
of the <CODE>UNION</CODE> list. If you don't specify any <CODE>INSERT_METHOD</CODE>
option or specify it with a value of <CODE>NO</CODE>, attempts to insert records
into the <CODE>MERGE</CODE> table result in an error.

</P>
<P>
The following example shows how to create a <CODE>MERGE</CODE> table:

</P>

<PRE>
mysql&#62; CREATE TABLE t1 (
    -&#62;    a INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    -&#62;    message CHAR(20));
mysql&#62; CREATE TABLE t2 (
    -&#62;    a INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    -&#62;    message CHAR(20));
mysql&#62; INSERT INTO t1 (message) VALUES ('Testing'),('table'),('t1');
mysql&#62; INSERT INTO t2 (message) VALUES ('Testing'),('table'),('t2');
mysql&#62; CREATE TABLE total (
    -&#62;    a INT NOT NULL AUTO_INCREMENT,
    -&#62;    message CHAR(20), INDEX(a))
    -&#62;    TYPE=MERGE UNION=(t1,t2) INSERT_METHOD=LAST;
</PRE>

<P>
Note that the <CODE>a</CODE> column is indexed in the <CODE>MERGE</CODE> table, but is
not declared as a <CODE>PRIMARY KEY</CODE> as it is in the underlying
<CODE>MyISAM</CODE> tables. This is necessary because a <CODE>MERGE</CODE> table cannot
enforce uniqueness over the set of underlying tables.

</P>
<P>
After creating the <CODE>MERGE</CODE> table, you can do things like this:

</P>

<PRE>
mysql&#62; SELECT * FROM total;
+---+---------+
| a | message |
+---+---------+
| 1 | Testing |
| 2 | table   |
| 3 | t1      |
| 1 | Testing |
| 2 | table   |
| 3 | t2      |
+---+---------+
</PRE>

<P>
Note that you can also manipulate the <TT>`.MRG'</TT> file directly from
outside of the MySQL server:

</P>

<PRE>
shell&#62; cd /mysql-data-directory/current-database
shell&#62; ls -1 t1 t2 &#62; total.MRG
shell&#62; mysqladmin flush-tables
</PRE>

<P>
To remap a <CODE>MERGE</CODE> table to a different collection of <CODE>MyISAM</CODE>
tables, you can do one of the following:

</P>

<UL>

<LI>

<CODE>DROP</CODE> the table and re-create it.

<LI>

Use <CODE>ALTER TABLE tbl_name UNION=(...)</CODE> to change the list of underlying
tables.

<LI>

Change the <TT>`.MRG'</TT> file and issue a <CODE>FLUSH TABLE</CODE> statement for the
<CODE>MERGE</CODE> table and all underlying tables to force the storage engine to
read the new definition file.

</UL>

<P>
<CODE>MERGE</CODE> tables can help you solve the following problems:

</P>

<UL>

<LI>

Easily manage a set of log tables. For example, you can put data from
different months into separate tables, compress some of them with
<CODE>myisampack</CODE>, and then create a <CODE>MERGE</CODE> table to use them as one.

<LI>

Obtain more speed. You can split a big read-only table based on some
criteria, and then put individual tables on different disks.
A <CODE>MERGE</CODE> table on this could be much faster than using
the big table. (You can also use a RAID table to get the same
kind of benefits.)

<LI>

Do more efficient searches. If you know exactly what you are looking
for, you can search in just one of the split tables for some queries
and use a <CODE>MERGE</CODE> table for others.  You can even have many
different <CODE>MERGE</CODE> tables that use overlapping sets of tables.

<LI>

Do more efficient repairs. It's easier to repair the individual tables that
are mapped to a <CODE>MERGE</CODE> table than to repair a single really big table.

<LI>

Instantly map many tables as one. A <CODE>MERGE</CODE> table need not maintain
an index of its own because it uses the indexes of the individual tables.
As a result, <CODE>MERGE</CODE> table collections are <EM>very</EM> fast to create
or remap.  (Note that you must still specify the index definitions when
you create a <CODE>MERGE</CODE> table, even though no indexes are created.)

<LI>

If you have a set of tables that you join as a big table on demand or
batch, you should instead create a <CODE>MERGE</CODE> table on them on demand.
This is much faster and will save a lot of disk space.

<LI>

Exceed the file size limit for the operating system. Each <CODE>MyISAM</CODE> table
is bound by this limit, but a collection of <CODE>MyISAM</CODE> tables is not.

<LI>

You can create an alias or synonym for a <CODE>MyISAM</CODE> table by defining a
<CODE>MERGE</CODE> table that maps to that single table.  There should be no
really notable performance impact of doing this (only a couple of indirect
calls and <CODE>memcpy()</CODE> calls for each read).

</UL>

<P>
The disadvantages of <CODE>MERGE</CODE> tables are:

</P>

<UL>

<LI>

You can use only identical <CODE>MyISAM</CODE> tables for a <CODE>MERGE</CODE> table.

<LI>

<CODE>MERGE</CODE> tables use more file descriptors. If 10 clients are using a
<CODE>MERGE</CODE> table that maps to 10 tables, the server uses
(10*10) + 10 file descriptors.  (10 data file descriptors for each of the 10
clients, and 10 index file descriptors shared among the clients.)

<LI>

Key reads are slower. When you read a key, the <CODE>MERGE</CODE>
storage engine needs to issue a read on all underlying tables to check
which one most closely matches the given key.  If you then do a ``read-next,''
the <CODE>MERGE</CODE> storage engine needs to search the read buffers
to find the next key. Only when one key buffer is used up, the storage engine
will need to read the next key block. This makes <CODE>MERGE</CODE> keys much slower
on <CODE>eq_ref</CODE> searches, but not much slower on <CODE>ref</CODE> searches.
See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A> for more information about <CODE>eq_ref</CODE>
and <CODE>ref</CODE>.

</UL>



<H3><A NAME="MERGE_table_problems" HREF="manual_toc.html#MERGE_table_problems">15.2.1  <CODE>MERGE</CODE> Table Problems</A></H3>

<P>
The following are the known problems with <CODE>MERGE</CODE> tables:

</P>

<UL>

<LI>

If you use <CODE>ALTER TABLE</CODE> to change a <CODE>MERGE</CODE> table to another
table type, the mapping to the underlying tables is lost. Instead, the rows
from the underlying <CODE>MyISAM</CODE> tables are copied into the altered table,
which then is assigned the new type.

<LI>

Before MySQL 4.1.1, all underlying tables and the <CODE>MERGE</CODE> table itself
had to be in the same database.

<LI>

<CODE>REPLACE</CODE> doesn't work.

<LI>

You can't use
<CODE>DROP TABLE</CODE>,
<CODE>ALTER TABLE</CODE>,
<CODE>DELETE FROM</CODE> without a <CODE>WHERE</CODE> clause,
<CODE>REPAIR TABLE</CODE>,
<CODE>TRUNCATE TABLE</CODE>,
<CODE>OPTIMIZE TABLE</CODE>, or
<CODE>ANALYZE TABLE</CODE>
on any of the tables that are
mapped into a <CODE>MERGE</CODE> table that is ``open.''  If you do this, the
<CODE>MERGE</CODE> table may still refer to the original table and you will
get unexpected results. The easiest way to work around this deficiency
is to issue  <CODE>FLUSH TABLES</CODE> statement to ensure that no <CODE>MERGE</CODE>
tables remain ``open.''

<LI>

A <CODE>MERGE</CODE> table cannot maintain <CODE>UNIQUE</CODE> constraints over the
whole table.  When you perform an <CODE>INSERT</CODE>, the data goes into the
first or last <CODE>MyISAM</CODE> table (depending on the value of the
<CODE>INSERT_METHOD</CODE> option). MySQL ensures that unique key values remain
unique within that <CODE>MyISAM</CODE> table, but not across all the tables in the
collection.

<LI>

Before MySQL 3.23.49, <CODE>DELETE FROM merge_table</CODE> used without a
<CODE>WHERE</CODE> clause only clears the mapping for the table. That is, it
incorrectly empties the <TT>`.MRG'</TT> file rather than deleting records from
the mapped tables.

<LI>

Using <CODE>RENAME TABLE</CODE> on an active <CODE>MERGE</CODE> table may corrupt the
table.  This will be fixed in MySQL 4.1.x.

<LI>

When you create a <CODE>MERGE</CODE> table, there is no check whether the
underlying tables exist and have identical structure.  When the <CODE>MERGE</CODE>
table is used, MySQL does a quick check that the record length for all
mapped tables is equal, but this is not foolproof.  If you create a
<CODE>MERGE</CODE> table from dissimilar <CODE>MyISAM</CODE> tables, you are very likely
to run into strange problems.

<LI>

Index order in the <CODE>MERGE</CODE> table and its underlying tables should be
the same.  If you use <CODE>ALTER TABLE</CODE> to add a <CODE>UNIQUE</CODE> index
to a table used in a <CODE>MERGE</CODE> table, and then use <CODE>ALTER TABLE</CODE> to
add a non-unique index on the <CODE>MERGE</CODE> table, the index order will be
different for the tables if there was an old non-unique index in the
underlying table. (This is because <CODE>ALTER TABLE</CODE> puts <CODE>UNIQUE</CODE>
indexes before non-unique indexes to be able to detect duplicate keys as early
as possible.)  Consequently, queries may return unexpected results.

<LI>

<CODE>DROP TABLE</CODE> on a table that is in use by a <CODE>MERGE</CODE> table does
not work on Windows because the <CODE>MERGE</CODE> storage engine does the table
mapping hidden from the upper layer of MySQL.  Because Windows doesn't allow
you to delete files that are open, you first must flush all <CODE>MERGE</CODE>
tables (with <CODE>FLUSH TABLES</CODE>) or drop the <CODE>MERGE</CODE> table before
dropping the table.  We will fix this at the same time we introduce
views.

</UL>



<H2><A NAME="HEAP" HREF="manual_toc.html#HEAP">15.3  The <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) Storage Engine</A></H2>

<P>
<A NAME="IDX1845"></A>
<A NAME="IDX1846"></A>
<A NAME="IDX1847"></A>
<A NAME="IDX1848"></A>
<A NAME="IDX1849"></A>
<A NAME="IDX1850"></A>

</P>
<P>
The <CODE>MEMORY</CODE> storage engine creates tables with contents that are stored
in memory. Before MySQL 4.1, <CODE>MEMORY</CODE> tables are called <CODE>HEAP</CODE>
tables. As of 4.1, <CODE>HEAP</CODE> is a synonym for <CODE>MEMORY</CODE>, and
<CODE>MEMORY</CODE> is the preferred term.

</P>
<P>
Each <CODE>MEMORY</CODE> table is associated with one disk file.  The filename
begins with the table name and has an extension of <TT>`.frm'</TT> to indicate
that it stores the table definition.

</P>
<P>
To specify explicitly that you want a <CODE>MEMORY</CODE> table, indicate that with
an <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> table option:

</P>

<PRE>
CREATE TABLE t (i INT) ENGINE = MEMORY;
CREATE TABLE t (i INT) TYPE = HEAP;
</PRE>

<P>
<CODE>MEMORY</CODE> tables are stored in memory and use hash indexes.  This makes
them very fast, and very useful for creating temporary tables!  However,
when the server shuts down, all data stored in <CODE>MEMORY</CODE> tables is lost.
The tables continue to exist because their definitions are stored in the
<TT>`.frm'</TT> files on disk, but their contents will be empty when the server
restarts.

</P>
<P>
Here is an example that shows how you might create, use, and remove a
<CODE>MEMORY</CODE> table:

</P>

<PRE>
mysql&#62; CREATE TABLE test TYPE=MEMORY
    -&#62;     SELECT ip,SUM(downloads) AS down
    -&#62;     FROM log_table GROUP BY ip;
mysql&#62; SELECT COUNT(ip),AVG(down) FROM test;
mysql&#62; DROP TABLE test;
</PRE>

<P>
<CODE>MEMORY</CODE> tables have the following characteristics:

</P>

<UL>

<LI>

Space for <CODE>MEMORY</CODE> tables is allocated in small blocks. The tables use
100% dynamic hashing (on inserting). No overflow areas and no extra key
space are needed.  There is no extra space needed for free lists.  Deleted
rows are put in a linked list and are reused when you insert new data into
the table.  <CODE>MEMORY</CODE> tables also don't have problems with deletes plus
inserts, which is common with hashed tables.

<LI>

<CODE>MEMORY</CODE> tables allow up to 32 indexes per table, 16 columns per index,
and a maximum key length of 500 bytes.

<LI>

Before MySQL 4.1, the <CODE>MEMORY</CODE> storage engine implements only hash
indexes.  From MySQL 4.1 on,
hash indexes are still the default, but
you can specify explicitly that a <CODE>MEMORY</CODE>
table index should be <CODE>HASH</CODE> or <CODE>BTREE</CODE> by adding a <CODE>USING</CODE>
clause:


<PRE>
CREATE TABLE lookup
    (id INT, INDEX USING HASH (id))
    ENGINE = MEMORY;
CREATE TABLE lookup
    (id INT, INDEX USING BTREE (id))
    ENGINE = MEMORY;
</PRE>

General characteristics of B-tree and hash indexes are described in
section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A>.

<LI>

You can have non-unique keys in a <CODE>MEMORY</CODE> table.
(This is an uncommon feature for implementations of hash indexes.)

<LI>

If you have a hash index on a <CODE>MEMORY</CODE> table that has a high degree of
key duplication (many index entries containing the same value), updates to
the table that affect key values and all deletes will be significantly
slower.  The degree of slowdown is proportional to the degree of duplication
(or, inversely proportional to the index cardinality).  You can use a
<CODE>BTREE</CODE> index to avoid this problem.

<LI>

<CODE>MEMORY</CODE> tables use a fixed record length format.

<LI>

<CODE>MEMORY</CODE> doesn't support <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns.

<LI>

<CODE>MEMORY</CODE> doesn't support <CODE>AUTO_INCREMENT</CODE> columns.

<LI>

Prior to MySQL 4.0.2, <CODE>MEMORY</CODE> doesn't support indexes on columns that
can contain <CODE>NULL</CODE> values.

<LI>

<CODE>MEMORY</CODE> tables are shared between all clients (just like any other
non-<CODE>TEMPORARY</CODE>
table).

<LI>

The <CODE>MEMORY</CODE> table property that table contents are stored in memory
is one that is shared with internal tables that the server creates on
the fly while processing queries.  However, internal tables also have the
property that the server converts them to on-disk tables automatically if
they become too large.  The size limit is determined by the value of the
<CODE>tmp_table_size</CODE> system variable.

<CODE>MEMORY</CODE> tables are not converted to disk tables.  To ensure that you
don't accidentally do anything foolish, you can set the
<CODE>max_heap_table_size</CODE> system variable to impose a maximum size on
<CODE>MEMORY</CODE> tables.  For individual tables, you can also specify a
<CODE>MAX_ROWS</CODE> table option in the <CODE>CREATE TABLE</CODE> statement.

<LI>

The server needs enough extra memory to maintain all <CODE>MEMORY</CODE> tables
that are in use at the same time.

<LI>

To free memory used by a <CODE>MEMORY</CODE> table if you no longer require its
contents, you should execute <CODE>DELETE</CODE> or
<CODE>TRUNCATE TABLE</CODE>, or else remove the table with <CODE>DROP TABLE</CODE>.

<LI>

If you want to populate a <CODE>MEMORY</CODE> table when the MySQL server starts,
you can use the <CODE>--init-file</CODE> option.  For example, you can put
statements such as <CODE>INSERT INTO ... SELECT</CODE> or <CODE>LOAD DATA INFILE</CODE>
into the file to load the table from some persistent data source.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

<LI>

If you are using replication, the master server's <CODE>MEMORY</CODE> tables
become empty when it is shut down and restarted.  However, a slave is not
aware that these tables have become empty, so it will return out-of-date
content if you select data from them.  Beginning with MySQL 4.0.18, when a
<CODE>MEMORY</CODE> table is used on the master for the first time since the master's
startup, a <CODE>DELETE FROM</CODE> statement is written to the master's binary
log automatically, thus synchronizing the slave to the master again.  Note
that even with this strategy, the slave still has out-of-date data in the
table during the interval between the master's restart and its first use of
the table.  But if you use the <CODE>--init-file</CODE> option to populate the
<CODE>MEMORY</CODE> table on the master at startup, it ensures that the failing
time interval is zero.

<LI>

The memory needed for one row in a <CODE>MEMORY</CODE> table is calculated using the
following expression:


<PRE>
SUM_OVER_ALL_KEYS(max_length_of_key + sizeof(char*) * 2)
+ ALIGN(length_of_row+1, sizeof(char*))
</PRE>

<CODE>ALIGN()</CODE> represents a round-up factor to cause the row length to be an
exact multiple of the <CODE>char</CODE> pointer size.
<CODE>sizeof(char*)</CODE> is 4 on 32-bit machines and 8 on 64-bit machines.

</UL>



<H2><A NAME="BDB" HREF="manual_toc.html#BDB">15.4  The <CODE>BDB</CODE> (<CODE>BerkeleyDB</CODE>) Storage Engine</A></H2>

<P>
<A NAME="IDX1851"></A>
<A NAME="IDX1852"></A>
<A NAME="IDX1853"></A>
<A NAME="IDX1854"></A>
<A NAME="IDX1855"></A>
<A NAME="IDX1856"></A>

</P>

<P>
Sleepycat Software has provided MySQL with the Berkeley DB transactional
storage engine. This storage engine typically is called <CODE>BDB</CODE> for short.
Support for the <CODE>BDB</CODE> storage engine is included in the MySQL source
distribution starting from version 3.23.34a and is activated in MySQL-Max
binary distributions.

</P>
<P>
<CODE>BDB</CODE> tables may have a greater chance of surviving crashes and are also
capable of <CODE>COMMIT</CODE> and <CODE>ROLLBACK</CODE> operations on transactions.
The MySQL source distribution comes with a <CODE>BDB</CODE> distribution that has a
couple of small patches to make it work more smoothly with MySQL.
You can't use a non-patched <CODE>BDB</CODE> version with MySQL.

</P>
<P>
We at MySQL AB are working in close cooperation with Sleepycat to keep the
quality of the MySQL/BDB interface high.  (Even though Berkeley DB is in
itself very tested and reliable, the MySQL interface is still considered
gamma quality.  We are improving and optimizing it.)

</P>
<P>
When it comes to support for any problems involving <CODE>BDB</CODE> tables, we
are committed to helping our users locate the problem and create a
reproducible test case.  Any such test case will be forwarded to Sleepycat,
which in turn will help us find and fix the problem.  As this is a two-stage
operation, any problems with <CODE>BDB</CODE> tables may take a little longer for
us to fix than for other storage engines.  However, we anticipate no
significant difficulties with this procedure because the Berkeley DB code
itself is used in many applications other than MySQL.
See section <A HREF="manual.html#Support">1.4.1  Support Offered by MySQL AB</A>.

</P>
<P>
For general information about Berkeley DB, please visit the Sleepycat Web site,
<a HREF="http://www.sleepycat.com/">http://www.sleepycat.com/</a>.

</P>



<H3><A NAME="BDB_portability" HREF="manual_toc.html#BDB_portability">15.4.1  Operating Systems Supported by <CODE>BDB</CODE></A></H3>

<P>
Currently, we know that the <CODE>BDB</CODE> storage engine works with the following
operating systems:

</P>

<UL>
<LI>

Linux 2.x Intel
<LI>

Sun Solaris (SPARC and x86)
<LI>

FreeBSD 4.x/5.x (x86, sparc64)
<LI>

IBM AIX 4.3.x
<LI>

SCO OpenServer
<LI>

SCO UnixWare 7.1.x
</UL>

<P>
<CODE>BDB</CODE> does not work with the following operating systems:

</P>

<UL>
<LI>

Linux 2.x Alpha
<LI>

Linux 2.x AMD64
<LI>

Linux 2.x IA-64
<LI>

Linux 2.x s390
<LI>

Mac OS X
</UL>

<P>
Note: The preceding lists are not complete. We will update them as we
receive more information.

</P>
<P>
If you build MySQL from source with support for <CODE>BDB</CODE> tables, but the
following error occurs when you start <CODE>mysqld</CODE>, it means <CODE>BDB</CODE>
is not supported for your architecture:

</P>

<PRE>
bdb: architecture lacks fast mutexes: applications cannot be threaded
Can't init databases
</PRE>

<P>
In this case, you must rebuild MySQL without <CODE>BDB</CODE> table support or
start the server with the <CODE>--skip-bdb</CODE> option.

</P>



<H3><A NAME="BDB_install" HREF="manual_toc.html#BDB_install">15.4.2  Installing <CODE>BDB</CODE></A></H3>

<P>
If you have downloaded a binary version of MySQL that includes support for
Berkeley DB, simply follow the usual binary distribution installation
instructions. (MySQL-Max distributions include <CODE>BDB</CODE> support.)

</P>
<P>
If you build MySQL from source, you can enable <CODE>BDB</CODE> support by running
<CODE>configure</CODE> with the <CODE>--with-berkeley-db</CODE> option in addition
to any other options that you normally use.  Download a distribution for
MySQL 3.23.34 or newer, change location into its top-level directory,
and run this command:

</P>

<PRE>
shell&#62; ./configure --with-berkeley-db [other-options]
</PRE>

<P>
For more information, see
section <A HREF="manual.html#Installing_binary">2.2.5  Installing MySQL on Other Unix-Like Systems</A>,
section <A HREF="manual.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A>, and
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.

</P>



<H3><A NAME="BDB_start" HREF="manual_toc.html#BDB_start">15.4.3  <CODE>BDB</CODE> Startup Options</A></H3>

<P>
The following options to <CODE>mysqld</CODE> can be used to change the behavior of
the <CODE>BDB</CODE> storage engine:

</P>
<DL COMPACT>

<DT><CODE>--bdb-home=path</CODE>
<DD>
The base directory for <CODE>BDB</CODE> tables.  This should be the same directory
you
use for <CODE>--datadir</CODE>.

<DT><CODE>--bdb-lock-detect=method</CODE>
<DD>
The <CODE>BDB</CODE> lock detection method. The option value should be 
<CODE>DEFAULT</CODE>, <CODE>OLDEST</CODE>, <CODE>RANDOM</CODE>, or <CODE>YOUNGEST</CODE>.

<DT><CODE>--bdb-logdir=path</CODE>
<DD>
The <CODE>BDB</CODE> log file directory.

<DT><CODE>--bdb-no-recover</CODE>
<DD>
Don't start Berkeley DB in recover mode.

<DT><CODE>--bdb-no-sync</CODE>
<DD>
Don't synchronously flush the <CODE>BDB</CODE> logs.

<DT><CODE>--bdb-shared-data</CODE>
<DD>
Start Berkeley DB in multi-process mode.  (Don't use <CODE>DB_PRIVATE</CODE> when
initializing Berkeley DB.)

<DT><CODE>--bdb-tmpdir=path</CODE>
<DD>
The <CODE>BDB</CODE> temporary file directory.

<DT><CODE>--skip-bdb</CODE>
<DD>
Disable the <CODE>BDB</CODE> storage engine.

</DL>

<P>
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
The following system variable affects the behavior of
<CODE>BDB</CODE> tables:

</P>
<DL COMPACT>

<DT><CODE>bdb_max_lock</CODE>
<DD>
The maximum number of locks you can have active on a <CODE>BDB</CODE> table.

</DL>

<P>
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</P>
<P>
If you use the <CODE>--skip-bdb</CODE> option, MySQL will not initialize the Berkeley DB
library and this will save a lot of memory.  However, if you use this
option, you cannot use <CODE>BDB</CODE> tables.  If you try to create a <CODE>BDB</CODE>
table, MySQL will create a <CODE>MyISAM</CODE> table instead.

</P>
<P>
Normally, you should start <CODE>mysqld</CODE> without the <CODE>--bdb-no-recover</CODE>
option if you intend to use <CODE>BDB</CODE> tables.  However, this may give you
problems when you try to start <CODE>mysqld</CODE> if the <CODE>BDB</CODE> log files are
corrupted.
See section <A HREF="manual.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A>.

</P>
<P>
With the <CODE>bdb_max_lock</CODE> variable, you can specify the maximum number of
locks that can be active on a <CODE>BDB</CODE> table.  The default is
10,000. You should increase this if errors such as the following occur
when you perform long transactions or when <CODE>mysqld</CODE> has to examine
many rows to execute a query:

</P>

<PRE>
bdb: Lock table is out of available locks
Got error 12 from ...
</PRE>

<P>
You may also want to change the <CODE>binlog_cache_size</CODE> and
<CODE>max_binlog_cache_size</CODE> variables if you are using large
multiple-statement transactions.
See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.

</P>



<H3><A NAME="BDB_characteristics" HREF="manual_toc.html#BDB_characteristics">15.4.4  Characteristics of <CODE>BDB</CODE> Tables</A></H3>

<P>
Each <CODE>BDB</CODE> table is stored on disk in two files.  The files have
names that begin with the table name and have an extension to indicate the
file type.  An <TT>`.frm'</TT> file stores the table definition, and a <TT>`.db'</TT>
file contains the table data and indexes.

</P>
<P>
To specify explicitly that you want a <CODE>BDB</CODE> table, indicate that with
an <CODE>ENGINE</CODE> or <CODE>TYPE</CODE> table option:

</P>

<PRE>
CREATE TABLE t (i INT) ENGINE = BDB;
CREATE TABLE t (i INT) TYPE = BDB;
</PRE>

<P>
<CODE>BerkeleyDB</CODE> is a synonym for <CODE>BDB</CODE> in the <CODE>ENGINE</CODE> or
<CODE>TYPE</CODE> option.

</P>
<P>
The <CODE>BDB</CODE> storage engine provides transactional tables. The way you use
these tables depends on the autocommit mode:

</P>

<UL>

<LI>

If you are running with autocommit enabled (which is the default),
changes to <CODE>BDB</CODE> tables are committed immediately and cannot be rolled
back.

<LI>

If you are running with autocommit disabled, changes do not become
permanent until you execute a <CODE>COMMIT</CODE> statement.  Instead of
committing, you can execute <CODE>ROLLBACK</CODE> to forget the changes.

You can start a transaction with
the <CODE>BEGIN WORK</CODE> statement to suspend autocommit, or with
<CODE>SET AUTOCOMMIT=0</CODE> to disable autocommit explicitly.

</UL>

<P>
See section <A HREF="manual.html#COMMIT">14.4.1  <CODE>START TRANSACTION</CODE>, <CODE>COMMIT</CODE>, and <CODE>ROLLBACK</CODE> Syntax</A>.

</P>
<P>
The <CODE>BDB</CODE> storage engine has the following characteristics:

</P>

<UL>

<LI>

<CODE>BDB</CODE> tables can have up to 31 indexes per table, 16 columns per index,
and a maximum key size of 1024 bytes (500 bytes before MySQL 4.0).

<LI>

MySQL requires a <CODE>PRIMARY KEY</CODE> in each <CODE>BDB</CODE> table so that each row
can be uniquely identified.  If you don't create one explicitly,
MySQL creates and maintains a hidden <CODE>PRIMARY KEY</CODE> for
you.  The hidden key has a length of five bytes and is incremented for each
insert attempt.

<LI>

The <CODE>PRIMARY KEY</CODE> will be faster than any other index, because the
<CODE>PRIMARY KEY</CODE> is stored together with the row data.  The other indexes
are stored as the key data + the <CODE>PRIMARY KEY</CODE>, so it's important to
keep the <CODE>PRIMARY KEY</CODE> as short as possible to save disk space and get
better speed.

This behavior is similar to that of <CODE>InnoDB</CODE>, where shorter primary
keys save space not only in the primary index but in secondary indexes as
well.

<LI>

If all columns you access in a <CODE>BDB</CODE> table are part of the same index or
part of the primary key, MySQL can execute the query
without having to access the actual row.  In a <CODE>MyISAM</CODE> table, this can
be done only if the columns are part of the same index.

<LI>

Sequential scanning is slower than for <CODE>MyISAM</CODE> tables because the data
in <CODE>BDB</CODE> tables is stored in B-trees and not in a separate data file.

<LI>

Key values are not prefix- or suffix-compressed like key values in
<CODE>MyISAM</CODE> tables. In other words, key information takes a little more
space in <CODE>BDB</CODE> tables compared to <CODE>MyISAM</CODE> tables.

<LI>

There are often holes in the <CODE>BDB</CODE> table to allow you to insert
new rows in the middle of the index tree.  This makes <CODE>BDB</CODE> tables
somewhat larger than <CODE>MyISAM</CODE> tables.

<LI>

<CODE>SELECT COUNT(*) FROM tbl_name</CODE> is slow for <CODE>BDB</CODE> tables, because
no row count is maintained in the table.

<LI>

The optimizer needs to know the approximate number of rows in the table.
MySQL solves this by counting inserts and maintaining this in a separate
segment in each <CODE>BDB</CODE> table.  If you don't issue a lot of <CODE>DELETE</CODE>
or <CODE>ROLLBACK</CODE> statements, this number should be accurate enough for
the MySQL optimizer. However, MySQL stores the number only on close, so
it may be incorrect if the server terminates unexpectedly. It should not
be fatal even if this number is not 100% correct.  You can update the row
count by using <CODE>ANALYZE TABLE</CODE> or <CODE>OPTIMIZE TABLE</CODE>.
See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A> and
section <A HREF="manual.html#OPTIMIZE_TABLE">14.5.2.5  <CODE>OPTIMIZE TABLE</CODE> Syntax</A>.

<LI>

Internal locking in <CODE>BDB</CODE> tables is done at the page level.

<LI>

<CODE>LOCK TABLES</CODE> works on <CODE>BDB</CODE> tables as with other tables.  If you
don't use <CODE>LOCK TABLE</CODE>, MySQL issues an internal multiple-write lock on
the table (a lock that doesn't block other writers) to ensure that the
table will be properly locked if another thread issues a table lock.

<LI>

To be able to roll back transactions, the <CODE>BDB</CODE> storage engine
maintains log files.  For maximum performance, you can use the
<CODE>--bdb-logdir</CODE> option to place the <CODE>BDB</CODE> logs on a different disk
than the one where your databases are located.

<LI>

MySQL performs a checkpoint each time a new <CODE>BDB</CODE> log file is started,
and removes any <CODE>BDB</CODE> log files that are not needed for current
transactions.  You can also use <CODE>FLUSH LOGS</CODE> at any time to checkpoint
the Berkeley DB tables.

For disaster recovery, you should use table backups plus MySQL's binary log.
See section <A HREF="manual.html#Backup">5.6.1  Database Backups</A>.

<STRONG>Warning:</STRONG> If you delete old log files that are still in use,
<CODE>BDB</CODE> will not be able to do recovery at all and you may lose data if
something goes wrong.

<LI>

Applications must always be prepared to handle cases where
any change of a <CODE>BDB</CODE> table may cause an automatic rollback and any
read may fail with a deadlock error.

<LI>

If you get full disk with a <CODE>BDB</CODE> table, you will get an error
(probably error 28) and the transaction should roll back.  This contrasts
with <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> tables, for which <CODE>mysqld</CODE> will wait
for enough free disk before continuing.

</UL>



<H3><A NAME="BDB_TODO" HREF="manual_toc.html#BDB_TODO">15.4.5  Things We Need to Fix for <CODE>BDB</CODE></A></H3>


<UL>

<LI>

It's very slow to open many <CODE>BDB</CODE> tables at the same time. If you are
going to use <CODE>BDB</CODE> tables, you should not have a very large table cache
(for example, with a size larger than 256) and you should use the
<CODE>--no-auto-rehash</CODE> option when you use the <CODE>mysql</CODE> client.  We
plan to partly fix this in 4.0.

<LI>

<CODE>SHOW TABLE STATUS</CODE> doesn't yet provide very much information for
<CODE>BDB</CODE>
tables.

<LI>

Optimize performance.

<LI>

Change to not use page locks at all for table scanning operations.
</UL>



<H3><A NAME="BDB_restrictions" HREF="manual_toc.html#BDB_restrictions">15.4.6  Restrictions on <CODE>BDB</CODE> Tables</A></H3>

<P>
The following list indicates restrictions that you must observe when using
<CODE>BDB</CODE> tables:

</P>

<UL>
<LI>

Each
<CODE>BDB</CODE> table stores in the <TT>`.db'</TT> file the path to the file as it
was created.  This was done to be able to detect locks in a multi-user
environment that supports symlinks.  However, the consequence is that
<CODE>BDB</CODE> table files cannot be moved from one database directory to
another.

<LI>

When making backups of <CODE>BDB</CODE> tables, you must either use
<CODE>mysqldump</CODE> or else make a backup that includes the files for each
<CODE>BDB</CODE> table (the <TT>`.frm'</TT> and <TT>`.db'</TT> files) as well as the
<CODE>BDB</CODE> log files.  The <CODE>BDB</CODE> storage engine stores unfinished
transactions in its log files and requires them to be present when
<CODE>mysqld</CODE> starts.  The <CODE>BDB</CODE> logs are the files in the data
directory with names of the form <TT>`log.XXXXXXXXXX'</TT> (ten digits).

<LI>

If a column that allows <CODE>NULL</CODE> values has a unique index, only a single
<CODE>NULL</CODE> value is allowed. This differs from other storage engines.

</UL>



<H3><A NAME="BDB_errors" HREF="manual_toc.html#BDB_errors">15.4.7  Errors That May Occur When Using <CODE>BDB</CODE> Tables</A></H3>


<UL>
<LI>

If the following error occurs when you start <CODE>mysqld</CODE>, it means that
the new <CODE>BDB</CODE> version doesn't support the old log file format:


<PRE>
bdb:  Ignoring log file: .../log.XXXXXXXXXX:
unsupported log version #
</PRE>

In this case, you must delete all <CODE>BDB</CODE> logs from your data directory
(the files with names that have the format <TT>`log.XXXXXXXXXX'</TT>) and
restart <CODE>mysqld</CODE>.  We also recommend that you then use <CODE>mysqldump
--opt</CODE> to dump your <CODE>BDB</CODE> tables, drop the tables, and restore them
from the dump file.

<LI>

If autocommit mode is disabled and you drop a <CODE>BDB</CODE> table that
is referenced in another transaction, you may get error messages of the
following form in your MySQL error log:


<PRE>
001119 23:43:56  bdb:  Missing log fileid entry
001119 23:43:56  bdb:  txn_abort: Log undo failed for LSN:
                       1 3644744: Invalid
</PRE>

This is not fatal, but until the problem is fixed, we recommend that you
not drop <CODE>BDB</CODE> tables except while autocommit mode is enabled.  (The
fix is not trivial.)

</UL>



<H2><A NAME="ISAM" HREF="manual_toc.html#ISAM">15.5  The <CODE>ISAM</CODE> Storage Engine</A></H2>

<P>
<A NAME="IDX1857"></A>
<A NAME="IDX1858"></A>
<A NAME="IDX1859"></A>

</P>
<P>
The original storage engine in MySQL was the <CODE>ISAM</CODE> engine. It was the
only storage engine available until MySQL 3.23, when the improved
<CODE>MyISAM</CODE> engine was introduced as the default. <CODE>ISAM</CODE> now is
deprecated.  As of MySQL 4.1, it's included in the source but not enabled in
binary distributions.  It will disappear in MySQL 5.0.
Embedded MySQL server versions do not support <CODE>ISAM</CODE> tables by default.

</P>
<P>
Due to the deprecated status of <CODE>ISAM</CODE>, and because <CODE>MyISAM</CODE> is
an improvement over <CODE>ISAM</CODE>, you are advised to convert any remaining
<CODE>ISAM</CODE> tables to <CODE>MySAM</CODE> as soon as possible.  To convert an
<CODE>ISAM</CODE> table to a <CODE>MyISAM</CODE> table, use an <CODE>ALTER TABLE</CODE>
statement:

</P>

<PRE>
mysql&#62; ALTER TABLE tbl_name TYPE = MYISAM;
</PRE>

<P>
For more information about <CODE>MyISAM</CODE>, see
section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.

</P>
<P>
Each <CODE>ISAM</CODE> table is stored on disk in three files.  The files have
names that begin with the table name and have an extension to indicate the
file type.  An <TT>`.frm'</TT> file stores the table definition.  The data file
has an <TT>`.ISD'</TT> extension.  The index file has an <TT>`.ISM'</TT>
extension.

</P>
<P>
<CODE>ISAM</CODE> uses B-tree indexes.

</P>
<P>
You can check or repair <CODE>ISAM</CODE> tables with the <CODE>isamchk</CODE> utility.
See section <A HREF="manual.html#Crash_recovery">5.6.2.7  Using <CODE>myisamchk</CODE> for Crash Recovery</A>.

</P>
<P>
<CODE>ISAM</CODE> has the following properties:

</P>

<UL>
<LI>Compressed and fixed-length keys

<LI>Fixed and dynamic record length

<LI>16 indexes per table, with 16 key parts per key

<LI>Maximum key length 256 bytes (default)

<LI>Data values are stored in machine format; this is fast, but machine/OS dependent

</UL>

<P>
Many of the properties of <CODE>MyISAM</CODE> tables are also true for <CODE>ISAM</CODE>
tables. However, there are also many differences. The following list
describes some of the ways that <CODE>ISAM</CODE> is distinct from <CODE>MyISAM</CODE>:

</P>

<UL>

<LI>

Not binary portable across OS/platforms.

<LI>

Can't handle tables larger than 4GB.

<LI>

Only supports prefix compression on strings.

<LI>

Smaller (more restrictive) key limits.

<LI>

Dynamic tables become more fragmented.

<LI>

Doesn't support <CODE>MERGE</CODE> tables.

<LI>

Tables are checked and repaired with <CODE>isamchk</CODE> rather than with
<CODE>myisamchk</CODE>.

<LI>

Tables are compressed with <CODE>pack_isam</CODE> rather than with <CODE>myisampack</CODE>.

<LI>

Cannot be used with the <CODE>BACKUP TABLE</CODE> or  <CODE>RESTORE TABLE</CODE>
backup-related statements.

<LI>

Cannot be used with the <CODE>CHECK TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, <CODE>OPTIMIZE
TABLE</CODE>, or <CODE>ANALYZE TABLE</CODE> table-maintenance statements.

<LI>

No support for full-text searching or spatial data types.

<LI>

No support for multiple character sets per table.

<LI>

Indexes cannot be assigned to specific key caches.

</UL>



<H1><A NAME="InnoDB" HREF="manual_toc.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A></H1>

<P>
<A NAME="IDX1860"></A>
<A NAME="IDX1861"></A>
<A NAME="IDX1862"></A>

</P>



<H2><A NAME="InnoDB_overview" HREF="manual_toc.html#InnoDB_overview">16.1  <CODE>InnoDB</CODE> Overview</A></H2>

<P>
<A NAME="IDX1863"></A>
<A NAME="IDX1864"></A>
<A NAME="IDX1865"></A>
<A NAME="IDX1866"></A>

</P>
<P>
<CODE>InnoDB</CODE> provides MySQL with a transaction-safe (<CODE>ACID</CODE> compliant)
storage engine with commit, rollback, and crash recovery capabilities.
<CODE>InnoDB</CODE> does locking on the row level and also provides an Oracle-style
consistent
non-locking read in <CODE>SELECT</CODE> statements. These features increase
multi-user concurrency and performance. There is no need for
lock escalation in <CODE>InnoDB</CODE>
because row-level locks in <CODE>InnoDB</CODE> fit in very little space.
<CODE>InnoDB</CODE> also supports <CODE>FOREIGN KEY</CODE> constraints.
In SQL queries you can freely mix <CODE>InnoDB</CODE> type tables with other
table types of MySQL, even within the same query.

</P>
<P>
<CODE>InnoDB</CODE> has been designed for maximum performance when processing
large data volumes. Its CPU efficiency is probably not
matched by any other disk-based relational database engine.

</P>
<P>
Fully integrated with MySQL Server, the <CODE>InnoDB</CODE> storage engine maintains
its own buffer pool for caching data and indexes in main memory.
<CODE>InnoDB</CODE> stores its tables and indexes in a tablespace, which
may consist of several files (or raw disk partitions).
This is different from, for example,
<CODE>MyISAM</CODE> tables where each table is stored using separate files.
<CODE>InnoDB</CODE> tables can be of any size even on operating
systems where file size is limited to 2GB.

</P>
<P>
<CODE>InnoDB</CODE> is included in binary distributions by default as of MySQL 4.0.
For information about <CODE>InnoDB</CODE> support in MySQL 3.23, see
section <A HREF="manual.html#InnoDB_in_MySQL_3.23">16.3  <CODE>InnoDB</CODE> in MySQL 3.23</A>.

</P>
<P>
<CODE>InnoDB</CODE> is used in production at numerous
large database sites requiring high performance.
The famous Internet news site Slashdot.org runs on <CODE>InnoDB</CODE>.
Mytrix, Inc. stores over 1TB of data in <CODE>InnoDB</CODE>,
and another site handles an average
load of 800 inserts/updates per second in <CODE>InnoDB</CODE>.

</P>
<P>
<CODE>InnoDB</CODE> is published under the same GNU <CODE>GPL</CODE> License Version 2
(of June 1991) as MySQL. If you distribute MySQL/InnoDB, and your application
does not satisfy the provisions of the GPL license, you must purchase a
commercial
<STRONG>MySQL Pro</STRONG> license from <a HREF="https://order.mysql.com/?sub=pg&#38;pg_no=1">https://order.mysql.com/?sub=pg&#38;pg_no=1</a>.

</P>



<H2><A NAME="InnoDB_contact_information" HREF="manual_toc.html#InnoDB_contact_information">16.2  <CODE>InnoDB</CODE> Contact Information</A></H2>

<P>
Contact information for Innobase Oy, producer of the <CODE>InnoDB</CODE> engine:

</P>

<PRE>
Web site: <a HREF="http://www.innodb.com/">http://www.innodb.com/</a>
Email: <a HREF="mailto:sales@innodb.com">sales@innodb.com</a>
Phone: +358-9-6969 3250 (office)
       +358-40-5617367 (mobile)

Innobase Oy Inc.
World Trade Center Helsinki
Aleksanterinkatu 17
P.O.Box 800
00101 Helsinki
Finland
</PRE>



<H2><A NAME="InnoDB_in_MySQL_3.23" HREF="manual_toc.html#InnoDB_in_MySQL_3.23">16.3  <CODE>InnoDB</CODE> in MySQL 3.23</A></H2>

<P>
Beginning with MySQL 4.0, <CODE>InnoDB</CODE> is enabled by default, so
the following information applies only to MySQL 3.23.

</P>
<P>
<CODE>InnoDB</CODE> tables are included in the MySQL source distribution
starting from 3.23.34a and are activated in the MySQL-Max
binaries of the 3.23 series.
For Windows, the MySQL-Max binaries are included in the
standard distribution.

</P>
<P>
If you have downloaded a binary version of MySQL that includes support for
<CODE>InnoDB</CODE>, simply follow the instructions of the MySQL manual for
installing a binary version of MySQL. If you already have MySQL 3.23
installed, the simplest way to install MySQL-Max is to replace the
executable <CODE>mysqld</CODE> server with the corresponding executable from the
MySQL-Max distribution.  MySQL and MySQL-Max differ only in the server
executable.
See section <A HREF="manual.html#Installing_binary">2.2.5  Installing MySQL on Other Unix-Like Systems</A> and
section <A HREF="manual.html#mysqld-max">5.1.2  The <CODE>mysqld-max</CODE> Extended MySQL Server</A>.

</P>
<P>
To compile the MySQL source code with <CODE>InnoDB</CODE> support,
download MySQL 3.23.34a or newer from
<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>
and configure MySQL with the
<CODE>--with-innodb</CODE> option. 
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.

</P>
<P>
To use <CODE>InnoDB</CODE> tables with MySQL 3.23, you must specify configuration
parameters in the <CODE>[mysqld]</CODE> section of the <TT>`my.cnf'</TT> option file.
On Windows, you can use <TT>`my.ini'</TT> instead. If you do not configure
<CODE>InnoDB</CODE> in the option file, <CODE>InnoDB</CODE> will not start. (From MySQL
4.0 on, <CODE>InnoDB</CODE> uses default parameters if you do not specify any.
However, it is still recommended that to get best performance, you should use
parameters appropriate for your system, as discussed in
section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.)

</P>
<P>
In MySQL 3.23, you must specify at the minimum an <CODE>innodb_data_file_path</CODE>
value to configure the <CODE>InnoDB</CODE> data files. For example, to configure
<CODE>InnoDB</CODE> to use a single 10MB auto-extending data file, place the
following setting in the <CODE>[mysqld]</CODE> section of your option file:

</P>

<PRE>
[mysqld]
innodb_data_file_path=ibdata1:10M:autoextend
</PRE>

<P>
<CODE>InnoDB</CODE> will create the <TT>`ibdata1'</TT> file in the MySQL data directory
by default. To specify the location explicitly, specify an
<CODE>innodb_data_home_dir</CODE> setting.
See section <A HREF="manual.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A>.

</P>



<H2><A NAME="InnoDB_configuration" HREF="manual_toc.html#InnoDB_configuration">16.4  <CODE>InnoDB</CODE> Configuration</A></H2>

<P>
To enable <CODE>InnoDB</CODE> tables in MySQL 3.23, see
section <A HREF="manual.html#InnoDB_in_MySQL_3.23">16.3  <CODE>InnoDB</CODE> in MySQL 3.23</A>.

</P>
<P>
From MySQL 4.0 on, the <CODE>InnoDB</CODE> storage engine is enabled
by default. If you don't want to use <CODE>InnoDB</CODE> tables, you can
add the <CODE>skip-innodb</CODE> option to your MySQL option file.

</P>
<P>
Two important disk-based resources managed by the <CODE>InnoDB</CODE> storage
engine are its tablespace data files and its log files.

</P>
<P>
If you specify no <CODE>InnoDB</CODE> configuration options, MySQL 4.0 and
above creates an auto-extending 10MB data file named <TT>`ibdata1'</TT> and
two 5MB log files named <TT>`ib_logfile0'</TT> and <TT>`ib_logfile1'</TT> in the MySQL data directory.
(In MySQL 4.0.0 and 4.0.1, the data file is 64MB and not auto-extending.)
In MySQL 3.23, <CODE>InnoDB</CODE> will not start if you provide no configuration
options.

</P>
<P>
<STRONG>Note:</STRONG> To get good performance, you should explicitly provide
<CODE>InnoDB</CODE> parameters as discussed in the following examples. Naturally,
you should edit the settings to suit your hardware and requirements.

</P>
<P>
To set up the <CODE>InnoDB</CODE> tablespace files, use the
<CODE>innodb_data_file_path</CODE> option in the <CODE>[mysqld]</CODE> section of the
<TT>`my.cnf'</TT> option file.  On Windows, you can use <TT>`my.ini'</TT> instead.
The value of <CODE>innodb_data_file_path</CODE> should be a list of one or more
data file specifications.  If you name more than one data file, separate them
by semicolon (<SAMP>`;'</SAMP>) characters:

</P>

<PRE>
innodb_data_file_path=datafile_spec1[;datafile_spec2]...
</PRE>

<P>
For example, a setting that explicitly creates a tablespace having the
same characteristics as the MySQL 4.0 default is as follows:

</P>

<PRE>
[mysqld]
innodb_data_file_path=ibdata1:10M:autoextend
</PRE>

<P>
This setting configures a single 10MB data file named <TT>`ibdata1'</TT> that is
auto-extending.  No location for the file is given, so the default is the
MySQL data directory.

</P>
<P>
Sizes are specified using <CODE>M</CODE> or <CODE>G</CODE> suffix letters to indicate
units of MB or GB.

</P>
<P>
A tablespace containing a fixed-size 50MB data file named <TT>`ibdata1'</TT> and
a 50MB auto-extending file named <CODE>ibdata2</CODE> in the data directory can be
configured like this:

</P>

<PRE>
[mysqld]
innodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend
</PRE>

<P>
The full syntax for a data file specification includes the filename, its size,
and several optional attributes:

</P>

<PRE>
file_name:file_size[:autoextend[:max:max_file_size]]
</PRE>

<P>
The <CODE>autoextend</CODE> attribute and those following can be used only for the
last data file in the <CODE>innodb_data_file_path</CODE> line.  <CODE>autoextend</CODE>
is available starting from MySQL 3.23.50 and 4.0.2.

</P>
<P>
If you specify the <CODE>autoextend</CODE> option for the last data file,
<CODE>InnoDB</CODE> extends the data file if it runs out of free space in the
tablespace. The increment is 8MB at a time.

</P>
<P>
If the disk becomes full, you might want to add another data file on
another disk. Instructions for reconfiguring an existing tablespace are
given in section <A HREF="manual.html#Adding_and_removing">16.8  Adding and Removing <CODE>InnoDB</CODE> Data and Log Files</A>.

</P>
<P>
<CODE>InnoDB</CODE> is not aware of the maximum file size, so
be cautious on filesystems where the maximum file size is 2GB.
To specify a maximum size for an auto-extending data file, use the <CODE>max</CODE>
attribute. The following configuration allows <TT>`ibdata1'</TT> to grow up to a
limit of 500MB:

</P>

<PRE>
[mysqld]
innodb_data_file_path=ibdata1:10M:autoextend:max:500M
</PRE>

<P>
<CODE>InnoDB</CODE> creates tablespace files in the MySQL data directory by default.
To specify a location explicitly, use the <CODE>innodb_data_home_dir</CODE> option.
For example, to use two files named <TT>`ibdata1'</TT> and <TT>`ibdata2'</TT> but
create them in the <TT>`/ibdata'</TT> directory, configure <CODE>InnoDB</CODE> like this:

</P>

<PRE>
[mysqld]
innodb_data_home_dir = /ibdata
innodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend
</PRE>

<P>
<STRONG>Note:</STRONG> <CODE>InnoDB</CODE> does not create directories, so make sure that
the <TT>`/ibdata'</TT> directory exists before you start the server.  This is
also true of any log file directories that you configure.  Use the Unix or
DOS <CODE>mkdir</CODE> command to create any necessary directories.

</P>
<P>
<CODE>InnoDB</CODE> forms the directory path for each data file by textually
concatenating the value of <CODE>innodb_data_home_dir</CODE> to the data file name,
adding a slash or backslash between if needed.  If the
<CODE>innodb_data_home_dir</CODE> option is not mentioned in <TT>`my.cnf'</TT> at all,
the default value is the ``dot'' directory <TT>`./'</TT>, which means the MySQL
data directory.

</P>
<P>
If you specify <CODE>innodb_data_home_dir</CODE> as an empty string, you can
specify absolute paths for the data files listed in the
<CODE>innodb_data_file_path</CODE> value. The following example is equivalent to
the preceding one:

</P>

<PRE>
[mysqld]
innodb_data_home_dir =
innodb_data_file_path=/ibdata/ibdata1:50M;/ibdata/ibdata2:50M:autoextend
</PRE>

<P>
<STRONG>A simple <TT>`my.cnf'</TT> example.</STRONG>
Suppose that you have a computer
with 128MB RAM and one hard disk. The following example shows
possible configuration parameters in <TT>`my.cnf'</TT> or
<TT>`my.ini'</TT> for <CODE>InnoDB</CODE>. The example assumes the use of
MySQL-Max 3.23.50 or later or MySQL 4.0.2 or later because it makes use of the
<CODE>autoextend</CODE> attribute.

</P>
<P>
This example suits most users, both on Unix and Windows,
who do not want to distribute <CODE>InnoDB</CODE> data files and
log files on several disks. It creates an
auto-extending data file <TT>`ibdata1'</TT> and two <CODE>InnoDB</CODE> log files
<TT>`ib_logfile0'</TT> and <TT>`ib_logfile1'</TT> in the
MySQL data directory.  Also, the small archived <CODE>InnoDB</CODE> log file
<TT>`ib_arch_log_0000000000'</TT> that <CODE>InnoDB</CODE> creates automatically ends
up in the data directory.

</P>

<PRE>
[mysqld]
# You can write your other MySQL server options here
# ...
# Data files must be able to hold your data and indexes.
# Make sure that you have enough free disk space.
innodb_data_file_path = ibdata1:10M:autoextend
#
# Set buffer pool size to 50-80% of your computer's memory
set-variable = innodb_buffer_pool_size=70M
set-variable = innodb_additional_mem_pool_size=10M
#
# Set the log file size to about 25% of the buffer pool size
set-variable = innodb_log_file_size=20M
set-variable = innodb_log_buffer_size=8M
#
innodb_flush_log_at_trx_commit=1
</PRE>

<P>
Make sure that the MySQL server has the proper access rights to create files
in the data directory. More generally, the server must have access rights in
any directory where it needs to create data files or log files.

</P>
<P>
Note that data files must be less than 2GB in some filesystems.
The combined size of the log files must be less than 4GB. The combined
size of data files must be at least 10MB.

</P>
<P>
When you create an <CODE>InnoDB</CODE> tablespace for the first time, it is
best that you start the MySQL server from the command prompt.
<CODE>InnoDB</CODE> will then print the information about the database
creation to the screen, so you can see what is happening.
For example, on Windows, if <CODE>mysqld-max</CODE> is located in
<TT>`C:\mysql\bin'</TT>, you can start it like this:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld-max --console
</PRE>

<P>
If you do not send server output to the screen, check the server's error log
to see what <CODE>InnoDB</CODE> prints during the startup process.

</P>
<P>
See section <A HREF="manual.html#InnoDB_init">16.6  Creating the <CODE>InnoDB</CODE> Tablespace</A> for an example of what the
information displayed by <CODE>InnoDB</CODE> should look like.

</P>
<P>
<STRONG>Where to specify options on Windows?</STRONG>
The rules for option files on Windows are as follows:

</P>

<UL>

<LI>

Only one of <TT>`my.cnf'</TT> or <TT>`my.ini'</TT> should be created.

<LI>

The <TT>`my.cnf'</TT> file should be placed in the root
directory of the <TT>`C:'</TT> drive.

<LI>

The <TT>`my.ini'</TT> file should be placed in the <CODE>WINDIR</CODE> directory; for
example, <TT>`C:\WINDOWS'</TT> or <TT>`C:\WINNT'</TT>. You can use the <CODE>SET</CODE>
command at the command prompt in a console window to print the value of
<CODE>WINDIR</CODE>:


<PRE>
C:\&#62; SET WINDIR
windir=C:\WINNT
</PRE>

<LI>

If your PC uses a boot loader where the <TT>`C:'</TT> drive
is not the boot drive, your only option is to use the <TT>`my.ini'</TT> file.

</UL>

<P>
<STRONG>Where to specify options on Unix?</STRONG>
On Unix, <CODE>mysqld</CODE> reads options from the following files, if they exist,
in the following order: 

</P>


<UL>

<LI><TT>`/etc/my.cnf'</TT>

Global options.  

<LI><TT>`COMPILATION_DATADIR/my.cnf'</TT>

Server-specific options.  

<LI><TT>`defaults-extra-file'</TT>

The file specified with the <CODE>--defaults-extra-file</CODE> option.

<LI><TT>`~/.my.cnf'</TT>

User-specific options.

</UL>

<P>
<CODE>COMPILATION_DATADIR</CODE> is the MySQL data directory that was
specified as a <CODE>configure</CODE> option when <CODE>mysqld</CODE>
was compiled
(typically <TT>`/usr/local/mysql/data'</TT> for a binary installation or <TT>`/usr/local/var'</TT> for a source installation).

</P>
<P>
If you want to make sure that <CODE>mysqld</CODE> reads options only from a
specific file, you can use the <CODE>--defaults-option</CODE> as the first option
on the command line when starting the server:

</P>

<PRE>
mysqld --defaults-file=your_path_to_my_cnf
</PRE>

<P>
<STRONG>An advanced <TT>`my.cnf'</TT> example.</STRONG>
Suppose that you have a Linux computer
with 2GB RAM and three 60GB hard disks
(at directory paths <TT>`/'</TT>, <TT>`/dr2'</TT> and
<TT>`/dr3'</TT>). The following example shows possible
configuration parameters in <TT>`my.cnf'</TT> for <CODE>InnoDB</CODE>. 

</P>

<PRE>
[mysqld]
# You can write your other MySQL server options here
# ...
innodb_data_home_dir =
#
# Data files must be able to hold your data and indexes
innodb_data_file_path = /ibdata/ibdata1:2000M;/dr2/ibdata/ibdata2:2000M:autoextend
#
# Set buffer pool size to 50-80% of your computer's memory,
# but make sure on Linux x86 total memory usage is &#60; 2GB
set-variable = innodb_buffer_pool_size=1G
set-variable = innodb_additional_mem_pool_size=20M
innodb_log_group_home_dir = /dr3/iblogs
#
# innodb_log_arch_dir must be the same as innodb_log_group_home_dir
# (starting from 4.0.6, you can omit it)
innodb_log_arch_dir = /dr3/iblogs
set-variable = innodb_log_files_in_group=2
#
# Set the log file size to about 25% of the buffer pool size
set-variable = innodb_log_file_size=250M
set-variable = innodb_log_buffer_size=8M
#
innodb_flush_log_at_trx_commit=1
set-variable = innodb_lock_wait_timeout=50
#
# Uncomment the next lines if you want to use them
#innodb_flush_method=fdatasync
#set-variable = innodb_thread_concurrency=5
</PRE>

<P>
Note that the example places the two data files on different disks.
<CODE>InnoDB</CODE> will fill the tablespace beginning with the first data file.
In some cases, it will
improve the performance of the database if all data is not placed
on the same physical disk. Putting log files on a different disk from
data is very often beneficial for performance.
You can also use raw disk partitions (raw devices)
as <CODE>InnoDB</CODE> data files, which may speed up I/O. See section <A HREF="manual.html#InnoDB_Raw_Devices">16.15.2  Using Raw Devices for the Tablespace</A>.

</P>
<P>
<STRONG>Warning:</STRONG> On GNU/Linux x86, you must be careful not to set memory
usage too high.  <CODE>glibc</CODE> will allow the process heap to grow over
thread stacks, which will crash your server. It is a risk if the value of
the following expression is close to or exceeds 2GB:

</P>

<PRE>
innodb_buffer_pool_size
+ key_buffer_size
+ max_connections*(sort_buffer_size+read_buffer_size+binlog_cache_size)
+ max_connections*2MB
</PRE>

<P>
Each thread will use a stack (often 2MB, but only 256KB in MySQL AB binaries)
and in the worst case also uses <CODE>sort_buffer_size + read_buffer_size</CODE>
additional memory.

</P>
<P>
Starting from MySQL 4.1, you can use up to 64GB of physical memory in 32-bit
Windows.  See the description for <CODE>innodb_buffer_pool_awe_mem_mb</CODE> in
section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.

</P>
<P>
<STRONG>How to tune other <CODE>mysqld</CODE> server parameters?</STRONG>
The following values are typical and suit most users:

</P>

<PRE>
[mysqld]
skip-external-locking
set-variable = max_connections=200
set-variable = read_buffer_size=1M
set-variable = sort_buffer_size=1M
#
# Set key_buffer to 5 - 50% of your RAM depending on how much
# you use MyISAM tables, but keep key_buffer_size + InnoDB
# buffer pool size &#60; 80% of your RAM
set-variable = key_buffer_size=...
</PRE>



<H2><A NAME="InnoDB_start" HREF="manual_toc.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A></H2>

<P>
This section describes the <CODE>InnoDB</CODE>-related server options.  In MySQL
4.0 and up, all of them can be specified in <CODE>--opt_name=value</CODE> form on
the command line or in option files.  Before MySQL 4.0, numeric options
should be specified using <CODE>--set-variable=opt_name=value</CODE> or <CODE>-O
opt_name=value</CODE> syntax.

</P>

<DL COMPACT>

<DT><CODE>innodb_additional_mem_pool_size</CODE>
<DD>
The size of a memory pool <CODE>InnoDB</CODE> uses to store data dictionary
information and other internal data structures.  The more tables you have in
your application, the more memory you will need to allocate here. If
<CODE>InnoDB</CODE> runs out of memory in this pool, it will start to allocate
memory from the operating system, and write warning messages to the MySQL
error log. The default value is 1MB.

<DT><CODE>innodb_buffer_pool_awe_mem_mb</CODE>
<DD>
The size of the buffer pool (in MB), if it is placed in the AWE memory of
32-bit Windows. Available from 4.1.0 and relevant only in 32-bit Windows. If
your 32-bit Windows operating system supports more than 4GB memory, so-called ``Address
Windowing Extensions,'' you can allocate the <CODE>InnoDB</CODE> buffer pool into the
AWE physical memory using this parameter. The maximum possible value for this
is 64000. If this parameter is specified, <CODE>innodb_buffer_pool_size</CODE>
is the window in the 32-bit address space of <CODE>mysqld</CODE> where <CODE>InnoDB</CODE>
maps that AWE memory. A good value for <CODE>innodb_buffer_pool_size</CODE>
is 500MB.

<DT><CODE>innodb_buffer_pool_size</CODE>
<DD>
The size of the memory buffer <CODE>InnoDB</CODE> uses to cache data and indexes
of its tables.  The larger you set this value, the less disk I/O is needed
to access data in tables. On a dedicated database server, you may set this
to up to 80% of the machine physical memory size. However, do not set it
too large because competition for the physical memory might cause paging
in the operating system.

<DT><CODE>innodb_data_file_path</CODE>
<DD>
The paths to individual data files and their sizes. The full directory path
to each data file is acquired by concatenating <CODE>innodb_data_home_dir</CODE>
to each path specified here. The file sizes are specified in megabytes
or gigabytes (1024MB) by appending <CODE>M</CODE> or <CODE>G</CODE> to the size
value.  The sum of the sizes of the files must be at least 10MB. On some
operating systems, files must be less than 2GB. If you do not specify
<CODE>innodb_data_file_path</CODE>, the default behavior starting from 4.0 is to
create a single 10MB auto-extending data file named <TT>`ibdata1'</TT>. Starting
from 3.23.44, you can set the file size bigger than 4GB on those operating
systems that support big files. You can also use raw disk partitions as
data files. See section <A HREF="manual.html#InnoDB_Raw_Devices">16.15.2  Using Raw Devices for the Tablespace</A>.

<DT><CODE>innodb_data_home_dir</CODE>
<DD>
The common part of the directory path for all <CODE>InnoDB</CODE> data files. If
you do not set this value, the default is the MySQL data directory. You can
specify this also as an empty string, in which case you can use absolute
file paths in <CODE>innodb_data_file_path</CODE>.

<DT><CODE>innodb_fast_shutdown</CODE>
<DD>
By default, <CODE>InnoDB</CODE> does a full purge and an insert buffer merge
before a shutdown. These operations can take minutes, or even hours in extreme
cases.  If you set this parameter to 1, <CODE>InnoDB</CODE>
skips these operations at shutdown. This option is available starting from
MySQL 3.23.44 and 4.0.1. Its default value is 1 starting from 3.23.50.

<DT><CODE>innodb_file_io_threads</CODE>
<DD>
The number of file I/O threads in <CODE>InnoDB</CODE>. Normally this should be
left at the default value of 4, but disk I/O on Windows may benefit from
a larger number. On Unix, increasing the number has no effect; <CODE>InnoDB</CODE>
always uses the default value.
This option is available as of MySQL 3.23.37.

<DT><CODE>innodb_file_per_table</CODE>
<DD>
This option causes <CODE>InnoDB</CODE> to create each new table
using its own <TT>`.ibd'</TT> file for storing data and indexes, rather than in
the shared tablespace. See section <A HREF="manual.html#Multiple_tablespaces">16.7.6  Using Per-Table Tablespaces</A>.
This option is available as of MySQL 4.1.1.

<DT><CODE>innodb_flush_log_at_trx_commit</CODE>
<DD>
Normally you set this to 1, meaning that at a transaction commit, the log
is flushed to disk, and the modifications made by the transaction become
permanent and survive a database crash. If you are willing to compromise
this safety, and you are running small transactions, you may set this to
0 or 2 to reduce disk I/O to the logs. A value of 0 means that the log is
only written to the log file and the log file flushed to disk approximately
once per second. A value of 2 means the log is written to the log file at
each commit, but the log file is only flushed to disk approximately once
per second.  The default value is 1 (prior to MySQL 4.0.13, the default 0).

<DT><CODE>innodb_flush_method</CODE>
<DD>
This option is relevant only on Unix systems. If set to <CODE>fdatasync</CODE>,
<CODE>InnoDB</CODE> uses <CODE>fsync()</CODE> to flush both the data and log
files. If set to <CODE>O_DSYNC</CODE>, <CODE>InnoDB</CODE> uses <CODE>O_SYNC</CODE>
to open and flush the log files, but uses <CODE>fsync()</CODE> to flush the
data files. If <CODE>O_DIRECT</CODE> is specified (available on some GNU/Linux
versions  starting from MySQL 4.0.14), <CODE>InnoDB</CODE> uses <CODE>O_DIRECT</CODE>
to open the data files, and uses <CODE>fsync()</CODE> to flush both the data
and log files. Note that <CODE>InnoDB</CODE> does not use <CODE>fdatasync</CODE> or
<CODE>O_DSYNC</CODE> by default because there have been problems with them on
many Unix flavors.  This option is available as of MySQL 3.23.40.

<DT><CODE>innodb_force_recovery</CODE>
<DD>
Warning: This option should be defined only in an emergency situation when
you want to dump your tables from a corrupt database! Possible values are
from 1 to 6. The meanings of these values are described in section <A HREF="manual.html#Forcing_recovery">16.9.1  Forcing Recovery</A>. As a safety measure, <CODE>InnoDB</CODE> prevents a user from modifying
data when this option is greater than 0. This option is available starting
from MySQL 3.23.44.

<DT><CODE>innodb_lock_wait_timeout</CODE>
<DD>
The timeout in seconds an <CODE>InnoDB</CODE> transaction may wait for a lock
before being rolled back.  <CODE>InnoDB</CODE> automatically detects transaction
deadlocks in its own lock table and rolls back the transaction. If you
use the <CODE>LOCK TABLES</CODE> statement, or other transaction-safe storage
engines than <CODE>InnoDB</CODE> in the same transaction, a deadlock may arise
that <CODE>InnoDB</CODE> cannot notice. In cases like this, the timeout is useful
to resolve the situation. The default is 50 seconds.

<DT><CODE>innodb_log_arch_dir</CODE>
<DD>
The directory where fully written log files would be archived if we used log
archiving.  The value of this parameter should currently be set the same as
<CODE>innodb_log_group_home_dir</CODE>. Starting from MySQL 4.0.6, you may omit
this option.

<DT><CODE>innodb_log_archive</CODE>
<DD>
This value should currently be set to 0.  Because recovery from a backup
is done by MySQL using its own log files, there is currently no need to
archive <CODE>InnoDB</CODE> log files. The default for this option is 0.

<DT><CODE>innodb_log_buffer_size</CODE>
<DD>
The size of the buffer that <CODE>InnoDB</CODE> uses to write to the log files
on disk.  Sensible values range from 1MB to 8MB.  The default is 1MB. A large
log buffer allows large transactions to run without a need to write the log
to disk before the transactions commit. Thus, if you have big transactions,
making the log buffer larger will save disk I/O.

<DT><CODE>innodb_log_file_size</CODE>
<DD>
The size of each log file in a log group. The combined size of
log files must be less than 4GB on 32-bit computers. The default is 5MB.
Sensible values range from 1MB to 1/<CODE>N</CODE>-th of the size of the buffer pool,
below, where <CODE>N</CODE> is the number of log files in the group. The larger
the value, the less checkpoint flush activity is needed in the buffer
pool, saving disk I/O. But larger log files also mean that recovery will
be slower in case of a crash.

<DT><CODE>innodb_log_files_in_group</CODE>
<DD>
The number of log files in the log group. <CODE>InnoDB</CODE> writes to the
files in a circular fashion. The default is 2 (recommended).

<DT><CODE>innodb_log_group_home_dir</CODE>
<DD>
The directory path to the <CODE>InnoDB</CODE> log files.  It must have the same
value as <CODE>innodb_log_arch_dir</CODE>.  If you do not specify any <CODE>InnoDB</CODE>
log parameters, the default is to create two 5MB files names <TT>`ib_logfile0'</TT>
and <TT>`ib_logfile1'</TT> in the MySQL data directory.

<DT><CODE>innodb_max_dirty_pages_pct</CODE>
<DD>
This is an integer in the range from 0 to 100. The default is 90. The main
thread in <CODE>InnoDB</CODE> tries to flush pages from the buffer pool so that
at most this many percent of pages may not yet flushed been flushed at
any particular time. Available starting from 4.0.13 and 4.1.1. If you have the
<CODE>SUPER</CODE> privilege, this percentage can be changed while the server is
running:


<PRE>
SET GLOBAL innodb_max_dirty_pages_pct = value;
</PRE>

<DT><CODE>innodb_mirrored_log_groups</CODE>
<DD>
The number of identical copies of log groups we keep for the
database. Currently this should be set to 1.

<DT><CODE>innodb_open_files</CODE>
<DD>
This option is relevant only if you use multiple tablespaces in
<CODE>InnoDB</CODE>. It specifies the maximum number of <TT>`.ibd'</TT> files that
<CODE>InnoDB</CODE> can keep open at one time. The minimum value is 10. The
default is 300.  This option is available as of MySQL 4.1.1.

The file descriptors used for <TT>`.ibd'</TT> files are for <CODE>InnoDB</CODE> only.
They are independent of those specified by the <CODE>--open-files-limit</CODE>
server option, and do not affect the operation of the table cache.

<DT><CODE>innodb_thread_concurrency</CODE>
<DD>
<CODE>InnoDB</CODE> tries to keep the number of operating system threads
concurrently inside <CODE>InnoDB</CODE> less than or equal to the limit given
by this parameter. The default value is 8. If you have low performance
and <CODE>SHOW INNODB STATUS</CODE> reveals many threads waiting for semaphores,
you may have thread thrashing and should try setting this parameter lower
or higher.  If you have a computer with many processors and disks, you
can try setting the value higher to better utilize the resources of you
computer. A recommended value is the sum of the number of processors and
disks your system has.  A value of 500 or greater disables the concurrency
checking.  This option is available starting from MySQL 3.23.44 and 4.0.1.

</DL>



<H2><A NAME="InnoDB_init" HREF="manual_toc.html#InnoDB_init">16.6  Creating the <CODE>InnoDB</CODE> Tablespace</A></H2>

<P>
Suppose that you have installed MySQL and have edited your option file so
that it contains the necessary <CODE>InnoDB</CODE> configuration parameters.
Before starting MySQL, you should verify that the directories you have
specified for <CODE>InnoDB</CODE> data files and log files exist and that the
MySQL server has access rights to those directories. <CODE>InnoDB</CODE> cannot
create directories, only files. Check also that you have enough disk space
for the data and log files.

</P>
<P>
It is best to run the MySQL server <CODE>mysqld</CODE> from the command prompt
when you create an <CODE>InnoDB</CODE> database, not from the <CODE>mysqld_safe</CODE>
wrapper or as a Windows service. When you run from a command prompt you
see what <CODE>mysqld</CODE> prints and what is happening. On Unix, just invoke
<CODE>mysqld</CODE>. On Windows, use the <CODE>--console</CODE> option.

</P>
<P>
When you start the MySQL server after initially configuring <CODE>InnoDB</CODE> in
your option file, <CODE>InnoDB</CODE> creates your
data files and log files. <CODE>InnoDB</CODE> will print something like the following:

</P>

<PRE>
InnoDB: The first specified datafile /home/heikki/data/ibdata1
did not exist:
InnoDB: a new database to be created!
InnoDB: Setting file /home/heikki/data/ibdata1 size to 134217728
InnoDB: Database physically writes the file full: wait...
InnoDB: datafile /home/heikki/data/ibdata2 did not exist:
new to be created
InnoDB: Setting file /home/heikki/data/ibdata2 size to 262144000
InnoDB: Database physically writes the file full: wait...
InnoDB: Log file /home/heikki/data/logs/ib_logfile0 did not exist:
new to be created
InnoDB: Setting log file /home/heikki/data/logs/ib_logfile0 size
to 5242880
InnoDB: Log file /home/heikki/data/logs/ib_logfile1 did not exist:
new to be created
InnoDB: Setting log file /home/heikki/data/logs/ib_logfile1 size
to 5242880
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: Creating foreign key constraint system tables
InnoDB: Foreign key constraint system tables created
InnoDB: Started
mysqld: ready for connections
</PRE>

<P>
A new <CODE>InnoDB</CODE> database has now been created. You can connect to the MySQL
server with the usual MySQL client programs like <CODE>mysql</CODE>.
When you shut down the MySQL server with <CODE>mysqladmin shutdown</CODE>,
the output will be like the following:

</P>

<PRE>
010321 18:33:34  mysqld: Normal shutdown
010321 18:33:34  mysqld: Shutdown Complete
InnoDB: Starting shutdown...
InnoDB: Shutdown completed
</PRE>

<P>
You can now look at the data file and log directories and you
will see the files created. The log directory will also contain
a small file named <TT>`ib_arch_log_0000000000'</TT>. That file
resulted from the database creation, after which <CODE>InnoDB</CODE> switched off
log archiving.
When MySQL is started again, the data files and log files will already have
been created, so the output will be much briefer:

</P>

<PRE>
InnoDB: Started
mysqld: ready for connections
</PRE>



<H3><A NAME="Error_creating_InnoDB" HREF="manual_toc.html#Error_creating_InnoDB">16.6.1  Dealing with <CODE>InnoDB</CODE> Initialization Problems</A></H3>

<P>
If <CODE>InnoDB</CODE> prints an operating system error in a file operation,
usually the problem is one of the following:

</P>

<UL>
<LI>You did not create the <CODE>InnoDB</CODE> data file or log directories.

<LI><CODE>mysqld</CODE> does not have access rights to create files in those

directories.
<LI><CODE>mysqld</CODE> does not read the proper <TT>`my.cnf'</TT> or <TT>`my.ini'</TT>

option file, and consequently does not see the options you specified.
<LI>The disk is full or a disk quota is exceeded.

<LI>You have created a subdirectory whose name is equal to a data file

you specified.
<LI>There is a syntax error in <CODE>innodb_data_home_dir</CODE>

or <CODE>innodb_data_file_path</CODE>.
</UL>

<P>
If something goes wrong when <CODE>InnoDB</CODE> attempts to initialize
its tablespace or its log files, you should delete all files created
by <CODE>InnoDB</CODE>. This means all data files, all log files, and the small
archived log file. In case you already created some <CODE>InnoDB</CODE> tables,
delete the corresponding <TT>`.frm'</TT> files for these tables (and any
<TT>`.ibd'</TT> files if you are using multiple tablespaces) from the
MySQL database directories as well. Then you can try the <CODE>InnoDB</CODE>
database creation again.  It is best to start the MySQL server from a
command prompt so that you see what is happening.

</P>



<H2><A NAME="Using_InnoDB_tables" HREF="manual_toc.html#Using_InnoDB_tables">16.7  Creating <CODE>InnoDB</CODE> Tables</A></H2>

<P>
Suppose that you have started the MySQL client with the command <CODE>mysql test</CODE>.
To create an <CODE>InnoDB</CODE> table, you must specify and <CODE>ENGINE = InnoDB</CODE>
or <CODE>TYPE = InnoDB</CODE> option in the table creation SQL statement:

</P>

<PRE>
CREATE TABLE customers (a INT, b CHAR (20), INDEX (a)) ENGINE=InnoDB;
CREATE TABLE customers (a INT, b CHAR (20), INDEX (a)) TYPE=InnoDB;
</PRE>

<P>
The SQL statement creates a table and an index on column <CODE>a</CODE> in the
<CODE>InnoDB</CODE> tablespace that consists of the data files you specified in
<TT>`my.cnf'</TT>. In addition, MySQL creates a file <TT>`customers.frm'</TT>
in the <TT>`test'</TT> directory under the MySQL database directory.
Internally, <CODE>InnoDB</CODE> adds to its own data dictionary an entry for
table <CODE>'test/customers'</CODE>. This means you can create a table of the same
name <CODE>customers</CODE> in some other database, and the table names will
not collide inside <CODE>InnoDB</CODE>.

</P>
<P>
You can query the amount of free space in the <CODE>InnoDB</CODE> tablespace
by issuing a <CODE>SHOW TABLE STATUS</CODE> statement for any <CODE>InnoDB</CODE> table.
The amount of free
space in the tablespace appears in the <CODE>Comment</CODE> section in the
output of <CODE>SHOW TABLE STATUS</CODE>. An example:

</P>

<PRE>
SHOW TABLE STATUS FROM test LIKE 'customers'
</PRE>

<P>
Note that the statistics <CODE>SHOW</CODE> gives about <CODE>InnoDB</CODE> tables
are only approximate. They are used in SQL optimization.  Table and index
reserved sizes in bytes are accurate, though.

</P>



<H3><A NAME="InnoDB_transactions_with_different_APIs" HREF="manual_toc.html#InnoDB_transactions_with_different_APIs">16.7.1  How to Use Transactions in <CODE>InnoDB</CODE> with Different APIs</A></H3>

<P>
By default, each client that connects to the MySQL server begins with autocommit
mode enabled, which automatically commits every SQL statement you run.
To use multiple-statement transactions, you can switch autocommit off
with the SQL statement <CODE>SET AUTOCOMMIT = 0</CODE> and use <CODE>COMMIT</CODE>
and <CODE>ROLLBACK</CODE> to commit or roll back your transaction.
If you want to leave autocommit on, you can enclose your transactions
between <CODE>START TRANSACTION</CODE> and <CODE>COMMIT</CODE> or <CODE>ROLLBACK</CODE>.
Before MySQL 4.0.11, you have to use the keyword <CODE>BEGIN</CODE>
instead of <CODE>START TRANSACTION</CODE>. The following example shows two
transactions. The first is committed and the second is rolled back.

</P>

<PRE>
shell&#62; mysql test
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5 to server version: 3.23.50-log
Type 'help;' or '\h' for help. Type '\c' to clear the buffer.
mysql&#62; CREATE TABLE CUSTOMER (A INT, B CHAR (20), INDEX (A))
    -&#62; TYPE=InnoDB;
Query OK, 0 rows affected (0.00 sec)
mysql&#62; BEGIN;
Query OK, 0 rows affected (0.00 sec)
mysql&#62; INSERT INTO CUSTOMER VALUES (10, 'Heikki');
Query OK, 1 row affected (0.00 sec)
mysql&#62; COMMIT;
Query OK, 0 rows affected (0.00 sec)
mysql&#62; SET AUTOCOMMIT=0;
Query OK, 0 rows affected (0.00 sec)
mysql&#62; INSERT INTO CUSTOMER VALUES (15, 'John');
Query OK, 1 row affected (0.00 sec)
mysql&#62; ROLLBACK;
Query OK, 0 rows affected (0.00 sec)
mysql&#62; SELECT * FROM CUSTOMER;
+------+--------+
| A    | B      |
+------+--------+
|   10 | Heikki |
+------+--------+
1 row in set (0.00 sec)
mysql&#62;
</PRE>

<P>
In APIs like PHP, Perl DBI/DBD, JDBC, ODBC, or the standard C call
interface of MySQL, you can send transaction control statements such as
<CODE>COMMIT</CODE> to the MySQL server as strings just like any other
SQL statements such as <CODE>SELECT</CODE> or <CODE>INSERT</CODE>.
Some APIs also offer separate special transaction commit and rollback functions
or methods.

</P>



<H3><A NAME="Converting_tables_to_InnoDB" HREF="manual_toc.html#Converting_tables_to_InnoDB">16.7.2  Converting <CODE>MyISAM</CODE> Tables to <CODE>InnoDB</CODE></A></H3>

<P>
Important: You should not convert MySQL system tables in the <CODE>mysql</CODE>
database (such as <CODE>user</CODE> or <CODE>host</CODE>) to the <CODE>InnoDB</CODE> type. The
system tables must always be of the <CODE>MyISAM</CODE> type.

</P>
<P>
If you want all your (non-system) tables to be created as <CODE>InnoDB</CODE>
tables, you can, starting from the MySQL 3.23.43, add the line
<CODE>default-table-type=innodb</CODE> to the <CODE>[mysqld]</CODE> section of
your <TT>`my.cnf'</TT> or <TT>`my.ini'</TT> file.

</P>
<P>
<CODE>InnoDB</CODE> does not have a special optimization for separate index
creation the way the <CODE>MyISAM</CODE> storage engine does.  Therefore, it does
not pay to export and import the table and create indexes afterward.
The fastest way to alter a table to <CODE>InnoDB</CODE> is to do the inserts
directly to an <CODE>InnoDB</CODE> table. That is, use <CODE>ALTER TABLE
... TYPE=INNODB</CODE>, or create an empty <CODE>InnoDB</CODE> table with identical
definitions and insert the rows with <CODE>INSERT INTO ... SELECT *
FROM ...</CODE>.

</P>
<P>
If you have <CODE>UNIQUE</CODE> constraints on secondary keys, starting from
MySQL 3.23.52, you can speed up a table import by turning off the uniqueness
checks temporarily during the import session: <CODE>SET UNIQUE_CHECKS=0;</CODE>
For big tables this saves a lot of disk I/O because <CODE>InnoDB</CODE> can then
use its insert buffer to write secondary index records in a batch.

</P>
<P>
To get better control over the insertion process, it might be good to insert
big tables in pieces:

</P>

<PRE>
INSERT INTO newtable SELECT * FROM oldtable
   WHERE yourkey &#62; something AND yourkey &#60;= somethingelse;
</PRE>

<P>
After all data has been inserted, you can rename the tables.

</P>
<P>
During the conversion of big tables, you should increase the size of the
<CODE>InnoDB</CODE> buffer pool to reduce disk I/O. Do not use more than 80% of the
physical memory, though. You can also increase the sizes of the <CODE>InnoDB</CODE>
log files and the log files.

</P>
<P>
Make sure that you do not fill up the tablespace: <CODE>InnoDB</CODE> tables require
a lot more disk space than <CODE>MyISAM</CODE> tables. If an <CODE>ALTER TABLE</CODE>
runs out of space, it will start a rollback, and that can take hours if
it is disk-bound.  For inserts, <CODE>InnoDB</CODE> uses the insert buffer to
merge secondary index records to indexes in batches. That saves a lot of
disk I/O. In rollback, no such mechanism is used, and the rollback can take
30 times longer than the insertion.

</P>
<P>
In the case of a runaway rollback, if you do not have valuable data in your
database, it may be advisable to kill the database process rather than wait
for millions of disk I/O operations to complete.
For the complete procedure, see section <A HREF="manual.html#Forcing_recovery">16.9.1  Forcing Recovery</A>.

</P>



<H3><A NAME="InnoDB_auto-increment_column" HREF="manual_toc.html#InnoDB_auto-increment_column">16.7.3  How an <CODE>AUTO_INCREMENT</CODE> Column Works in <CODE>InnoDB</CODE></A></H3>

<P>
If you specify an <CODE>AUTO_INCREMENT</CODE> column for a table, the <CODE>InnoDB</CODE>
table handle in the data dictionary will contain a special counter called
the auto-increment counter that is used in assigning new values for the
column. The auto-increment counter is stored only in main memory, not
on disk.

</P>
<P>
<CODE>InnoDB</CODE> uses the following algorithm to initialize the auto-increment
counter for a table <CODE>T</CODE> that contains an <CODE>AUTO_INCREMENT</CODE> column
named <CODE>ai_col</CODE>: After a server startup, when a user first does an insert
to a table <CODE>T</CODE>, <CODE>InnoDB</CODE> executes the equivalent of this statement:

</P>

<PRE>
SELECT MAX(ai_col) FROM T FOR UPDATE;
</PRE>

<P>
The value retrieved by the statement is incremented by one and assigned to
the column and the auto-increment counter of the table. If the table is
empty, the value <CODE>1</CODE> is assigned. If the auto-increment counter is not
initialized and the user invokes a <CODE>SHOW TABLE STATUS</CODE> statement that
displays output for the table <CODE>T</CODE>, the counter is initialized (but not
incremented) and stored for use by later inserts.
Note that in this initialization
we do a normal exclusive-locking read on the table and the lock lasts to the end
of the transaction.

</P>
<P>
<CODE>InnoDB</CODE> follows the same procedure for initializing the auto-increment
counter for a freshly created table.

</P>
<P>
Note that if the user specifies <CODE>NULL</CODE> or <CODE>0</CODE> for the
<CODE>AUTO_INCREMENT</CODE> column in an <CODE>INSERT</CODE>, <CODE>InnoDB</CODE> treats the
row as if the value had not been specified and generates a new value for it.

</P>
<P>
After the auto-increment counter has been initialized, if a user inserts
a row that explicitly specifies the column value, and the value is
bigger than the current counter value, the counter is set to the specified
column value. If the user does not explicitly specify a value, <CODE>InnoDB</CODE>
increments the counter by one and assigns the new value to the column.

</P>
<P>
When accessing the auto-increment counter, <CODE>InnoDB</CODE> uses a special table
level <CODE>AUTO-INC</CODE> lock that it keeps to the end of the current SQL
statement, not to the end of the transaction.
The special lock release strategy was introduced to improve concurrency
for inserts into a table containing an <CODE>AUTO_INCREMENT</CODE> column. Two
transactions cannot have the <CODE>AUTO-INC</CODE> lock on the same table
simultaneously.

</P>
<P>
Note that you may see gaps in the sequence of values assigned to the
<CODE>AUTO_INCREMENT</CODE> column if you roll back transactions that have gotten
numbers from the counter.

</P>
<P>
The behavior of the auto-increment mechanism is not defined if a user
assigns a negative value to the column or if the value becomes bigger
than the maximum integer that can be stored in the specified integer type.

</P>



<H3><A NAME="InnoDB_foreign_key_constraints" HREF="manual_toc.html#InnoDB_foreign_key_constraints">16.7.4  <CODE>FOREIGN KEY</CODE> Constraints</A></H3>

<P>
Starting from MySQL 3.23.44, <CODE>InnoDB</CODE> features foreign key constraints.

</P>
<P>
The syntax of a foreign key constraint definition in <CODE>InnoDB</CODE> looks like
this:

</P>

<PRE>
[CONSTRAINT symbol] FOREIGN KEY [id] (index_col_name, ...)
    REFERENCES tbl_name (index_col_name, ...)
    [ON DELETE {CASCADE | SET NULL | NO ACTION | RESTRICT}]
    [ON UPDATE {CASCADE | SET NULL | NO ACTION | RESTRICT}]
</PRE>

<P>
Both tables must be <CODE>InnoDB</CODE> type.  In the referencing table, there must
be an index where the foreign key columns are listed as the <EM>first</EM>
columns in the same order. In the referenced table, there must be an index
where the referenced columns are listed as the <EM>first</EM> columns in
the same order. Index prefixes on foreign key columns are not supported.

</P>
<P>
<CODE>InnoDB</CODE> does not automatically create indexes on foreign keys or
referenced keys: You must create them explicitly. The indexes are needed
so that foreign key checks can be fast and not require a table scan.

</P>
<P>
Corresponding columns in the foreign key and the referenced key must
have similar internal data types inside <CODE>InnoDB</CODE> so that they can be
compared without a type conversion.
The <STRONG>size and the signedness of integer types has to be the same</STRONG>.
The length of string types need not be the same.
If you specify a <CODE>SET NULL</CODE> action, make sure that you
have <STRONG>not declared the columns in the child table</STRONG> as
<CODE>NOT NULL</CODE>.

</P>
<P>
If MySQL reports an error number 1005 from a <CODE>CREATE TABLE</CODE> statement,
and the error message string refers to errno 150, this means that the table
creation failed because a foreign key constraint was not correctly formed.
Similarly, if an <CODE>ALTER TABLE</CODE> fails and it refers to errno 150,
that means a foreign key definition would be incorrectly formed for the
altered table.  Starting from MySQL 4.0.13, you can use <CODE>SHOW INNODB
STATUS</CODE> to display a detailed explanation of the latest <CODE>InnoDB</CODE>
foreign key error in the server.

</P>
<P>
Starting from MySQL 3.23.50, <CODE>InnoDB</CODE> does not check foreign key
constraints on those foreign key or referenced key values
that contain a <CODE>NULL</CODE> column.

</P>
<P>
<STRONG>A deviation from SQL standards:</STRONG> If in the parent table
there are several rows that have the same referenced key value,
then <CODE>InnoDB</CODE> acts in foreign key checks as if the other parent
rows with the same key value do not exist. For example,
if you have defined a <CODE>RESTRICT</CODE> type constraint, and there
is a child row with several parent rows, <CODE>InnoDB</CODE> does not allow
the deletion of any of those parent rows. 

</P>
<P>
Starting from MySQL 3.23.50, you can also associate the
<CODE>ON DELETE CASCADE</CODE> or <CODE>ON DELETE SET NULL</CODE> clause with
the foreign key constraint. Corresponding <CODE>ON UPDATE</CODE> options
are available starting from 4.0.8. If <CODE>ON DELETE CASCADE</CODE> is
specified, and a row in the parent table is deleted, <CODE>InnoDB</CODE>
automatically deletes also all those rows in the child table
whose foreign key values are equal to the referenced key value in
the parent row. If <CODE>ON DELETE SET NULL</CODE> is specified, the
child rows are automatically updated so that the columns in the
foreign key are set to the SQL <CODE>NULL</CODE> value.

</P>
<P>
<CODE>InnoDB</CODE> performs cascading operations through a depth-first algorithm,
based on records in the indexes corresponding to the foreign key
constraints.

</P>
<P>
<STRONG>A deviation from SQL standards:</STRONG> If
<CODE>ON UPDATE CASCADE</CODE> or <CODE>ON UPDATE SET NULL</CODE> recurses to
update the <EM>same table</EM> it has already updated during the cascade,
it acts like <CODE>RESTRICT</CODE>. This means that you cannot use
self-referential <CODE>ON UPDATE CASCADE</CODE> or
<CODE>ON UPDATE SET NULL</CODE> operations.
This is to prevent infinite loops resulting from cascaded updates.
A self-referential <CODE>ON DELETE SET NULL</CODE>, on the other hand,
is possible from 4.0.13.
A self-referential <CODE>ON DELETE CASCADE</CODE> has been possible since <CODE>ON
DELETE</CODE> was implemented.

</P>
<P>
A simple example that relates <CODE>parent</CODE> and <CODE>child</CODE> tables through a
single-column foreign key:

</P>

<PRE>
CREATE TABLE parent(id INT NOT NULL,
                    PRIMARY KEY (id)
) TYPE=INNODB;
CREATE TABLE child(id INT, parent_id INT,
                   INDEX par_ind (parent_id),
                   FOREIGN KEY (parent_id) REFERENCES parent(id)
                     ON DELETE CASCADE
) TYPE=INNODB;
</PRE>

<P>
A more complex example in which a <CODE>product_order</CODE> table has foreign keys
for two other tables. One foreign key references a two-column index in the
<CODE>product</CODE> table. The other references a single-column index in the
<CODE>customer</CODE> table:

</P>

<PRE>
CREATE TABLE product (category INT NOT NULL, id INT NOT NULL,
                      price DECIMAL,
                      PRIMARY KEY(category, id)) TYPE=INNODB;
CREATE TABLE customer (id INT NOT NULL,
                      PRIMARY KEY (id)) TYPE=INNODB;
CREATE TABLE product_order (no INT NOT NULL AUTO_INCREMENT,
                      product_category INT NOT NULL,
                      product_id INT NOT NULL,
                      customer_id INT NOT NULL,
                      PRIMARY KEY(no),
                      INDEX (product_category, product_id),
                      FOREIGN KEY (product_category, product_id)
                        REFERENCES product(category, id)
                        ON UPDATE CASCADE ON DELETE RESTRICT,
                      INDEX (customer_id),
                      FOREIGN KEY (customer_id)
                        REFERENCES customer(id)) TYPE=INNODB;
</PRE>

<P>
Starting from MySQL 3.23.50, <CODE>InnoDB</CODE> allows you to add a new
foreign key constraint to a table by using <CODE>ALTER TABLE</CODE>:

</P>

<PRE>
ALTER TABLE yourtablename
    ADD [CONSTRAINT symbol] FOREIGN KEY [id] (index_col_name, ...)
    REFERENCES tbl_name (index_col_name, ...)
    [ON DELETE {CASCADE | SET NULL | NO ACTION | RESTRICT}]
    [ON UPDATE {CASCADE | SET NULL | NO ACTION | RESTRICT}]
</PRE>

<P>
<STRONG>Remember to create the required indexes first</STRONG>.
You can also add a self-referential foreign key constraint to a
table using <CODE>ALTER TABLE</CODE>.

</P>
<P>
<A NAME="IDX1867"></A>
<A NAME="IDX1868"></A>
<A NAME="IDX1869"></A>
Starting from MySQL 4.0.13, <CODE>InnoDB</CODE> supports the use of <CODE>ALTER
TABLE</CODE> to drop foreign keys:

</P>

<PRE>
ALTER TABLE yourtablename
    DROP FOREIGN KEY fk_symbol
</PRE>

<P>
If the <CODE>FOREIGN KEY</CODE> clause included a <CODE>CONSTRAINT</CODE> name when you
created the foreign key, you can refer to that name to drop the foreign key.
(A constraint name can be given as of MySQL 4.0.18.)  Otherwise, the
<CODE>fk_symbol</CODE> value is internally generated by <CODE>InnoDB</CODE> when the
foreign key is created. To find out the symbol when you want to drop a foreign
key, use the <CODE>SHOW CREATE TABLE</CODE> statement.
An example:

</P>

<PRE>
mysql&#62; SHOW CREATE TABLE ibtest11c\G
*************************** 1. row ***************************
       Table: ibtest11c
Create Table: CREATE TABLE `ibtest11c` (
  `A` int(11) NOT NULL auto_increment,
  `D` int(11) NOT NULL default '0',
  `B` varchar(200) NOT NULL default '',
  `C` varchar(175) default NULL,
  PRIMARY KEY  (`A`,`D`,`B`),
  KEY `B` (`B`,`C`),
  KEY `C` (`C`),
  CONSTRAINT `0_38775` FOREIGN KEY (`A`, `D`)
REFERENCES `ibtest11a` (`A`, `D`)
ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `0_38776` FOREIGN KEY (`B`, `C`)
REFERENCES `ibtest11a` (`B`, `C`)
ON DELETE CASCADE ON UPDATE CASCADE
) TYPE=InnoDB CHARSET=latin1
1 row in set (0.01 sec)

mysql&#62; ALTER TABLE ibtest11c DROP FOREIGN KEY 0_38775;
</PRE>

<P>
Starting from MySQL 3.23.50, the <CODE>InnoDB</CODE> parser allows you to use
backticks around table and column names in a
<CODE>FOREIGN KEY ... REFERENCES ...</CODE> clause.
Starting from MySQL 4.0.5, the <CODE>InnoDB</CODE> parser also takes into account
the <CODE>lower_case_table_names</CODE> system variable setting.

</P>
<P>
Before MySQL 3.23.50, <CODE>ALTER TABLE</CODE> or <CODE>CREATE INDEX</CODE>
should not be used in connection with tables that have foreign
key constraints or that are referenced in foreign key constraints:
Any <CODE>ALTER TABLE</CODE> removes all foreign key
constraints defined for the table. You should not use
<CODE>ALTER TABLE</CODE> with the referenced table, either. Instead,
use <CODE>DROP TABLE</CODE> and <CODE>CREATE TABLE</CODE> to modify the
schema. When MySQL does an <CODE>ALTER TABLE</CODE> it may internally
use <CODE>RENAME TABLE</CODE>, and that will confuse the
foreign key constraints that refer to the table.
In MySQL, a <CODE>CREATE INDEX</CODE> statement is processed as an
<CODE>ALTER TABLE</CODE>, so the same considerations apply.

</P>
<P>
Starting from MySQL 3.23.50, <CODE>InnoDB</CODE> returns the foreign key
definitions of a table as part of the output of the <CODE>SHOW CREATE TABLE</CODE>
statement:

</P>

<PRE>
SHOW CREATE TABLE tbl_name;
</PRE>

<P>
From this version, <CODE>mysqldump</CODE> also produces correct definitions
of tables to the dump file, and does not forget about the foreign keys.

</P>
<P>
You can display the foreign key constraints for a table like this:

<PRE>
SHOW TABLE STATUS FROM db_name LIKE 'tbl_name'
</PRE>

<P>
The foreign key constraints are listed in the <CODE>Comment</CODE> column of
the output.

</P>
<P>
When performing foreign key checks, <CODE>InnoDB</CODE> sets shared row
level locks on child or parent records it has to look at.
<CODE>InnoDB</CODE> checks foreign key constraints immediately; the check
is not deferred to transaction commit.

</P>
<P>
To make it easier to reload dump files for tables that have foreign key
relationships, <CODE>mysqldump</CODE> automatically includes a statement in the
dump output to set <CODE>FOREIGN_KEY_CHECKS</CODE> to 0 as of MySQL 4.1.1. This
avoids problems with tables having to be reloaded in a particular order
when the dump is reloaded.  For earlier versions, you can disable the
variable manually within <CODE>mysql</CODE> when loading the dump file like this:

</P>

<PRE>
mysql&#62; SET FOREIGN_KEY_CHECKS = 0;
mysql&#62; SOURCE dump_file_name;
mysql&#62; SET FOREIGN_KEY_CHECKS = 1;
</PRE>

<P>
This allows you to import the tables in any order if the dump file contains
tables that are not correctly ordered for foreign keys. It also speeds
up the import operation.  <CODE>FOREIGN_KEY_CHECKS</CODE> is available starting
from MySQL 3.23.52 and 4.0.3.

</P>
<P>
Setting <CODE>FOREIGN_KEY_CHECKS</CODE> to 0 can also be useful for ignoring
foreign key constraints during <CODE>LOAD DATA</CODE> operations.

</P>
<P>
<CODE>InnoDB</CODE> allows you to drop any table, even though that
would break the foreign key constraints that reference
the table. When you drop a table, the constraints that
were defined in its create statement are also dropped.

</P>
<P>
If you re-create a table that was dropped, it must have
a definition that conforms to the foreign key constraints
referencing it. It must have the right column names and types,
and it must have indexes on the referenced keys, as stated earlier.
If these are not satisfied, MySQL returns error number 1005
and refers to errno 150 in the error message string.

</P>



<H3><A NAME="InnoDB_and_MySQL_Replication" HREF="manual_toc.html#InnoDB_and_MySQL_Replication">16.7.5  <CODE>InnoDB</CODE> and MySQL Replication</A></H3>

<P>
MySQL replication works for <CODE>InnoDB</CODE> tables as it does
for <CODE>MyISAM</CODE> tables. It is also possible to use replication in
a way where the table type on the slave is not the same as the original
table type on the master.  For example, you can replicate modifications to
an <CODE>InnoDB</CODE> table on the master to a <CODE>MyISAM</CODE> table on the slave.

</P>
<P>
To set up a new slave for a master, you have to make a copy of the
<CODE>InnoDB</CODE> tablespace and the log files, as well as the <TT>`.frm'</TT> files
of the <CODE>InnoDB</CODE> tables, and move the copies to the slave.
For the proper procedure to do this, see section <A HREF="manual.html#Moving">16.10  Moving an <CODE>InnoDB</CODE> Database to Another Machine</A>.

</P>
<P>
If you can shut down the master or an existing slave, you can take a
cold backup of the <CODE>InnoDB</CODE> tablespace and log files and use that to
set up a slave.
To make a new slave without taking down any server you can also use
the non-free (commercial) <a HREF="http://www.innodb.com/order.html"><CODE>InnoDB Hot Backup</CODE> tool</a>.

</P>
<P>
There are minor limitations in <CODE>InnoDB</CODE> replication:

</P>

<UL>
<LI>

<CODE>LOAD TABLE FROM MASTER</CODE> does not work for <CODE>InnoDB</CODE> type
tables. There are workarounds: 1) dump the table on the master and import the
dump file into the slave, or 2) use <CODE>ALTER TABLE tbl_name TYPE=MyISAM</CODE>
on the master before setting up replication with <CODE>LOAD TABLE tbl_name
FROM MASTER</CODE>, and then use <CODE>ALTER TABLE</CODE> to alter the master table
back to the <CODE>InnoDB</CODE> type afterward.
<LI>

Before MySQL 4.0.6, <CODE>SLAVE STOP</CODE> did not
respect the boundary of a multiple-statement transaction.
An incomplete transaction would be rolled back, and the next
<CODE>SLAVE START</CODE> would only execute the remaining part of the half
transaction. That would cause replication to fail.
<LI>

Before MySQL 4.0.6, a slave crash in the middle of a
multiple-statement transaction would cause the same problem as
<CODE>SLAVE STOP</CODE>.
<LI>

Before MySQL 4.0.11, replication of the
<CODE>SET FOREIGN_KEY_CHECKS=0</CODE> statement does not work properly.
</UL>

<P>
Most of these limitations can be eliminated by using more recent server
versions for which the limitations do not apply.

</P>
<P>
Transactions that fail on the master do not affect replication at all.
MySQL replication is based on the binary log where MySQL writes SQL
statements that modify data. A slave reads the binary log of the master and
executes the same SQL statements. However, statements that occur within a
transaction are not written to the binary log until the transaction commits,
at which point all statements in the transaction are written at once.
If a statement fails, for example, because of a foreign key violation,
or if a transaction is rolled back, no SQL statements are written to the
binary log, and the transaction is not executed on the slave at all.

</P>



<H3><A NAME="Multiple_tablespaces" HREF="manual_toc.html#Multiple_tablespaces">16.7.6  Using Per-Table Tablespaces</A></H3>

<P>
Starting from MySQL 4.1.1, you can store each <CODE>InnoDB</CODE> table and its
indexes into its own file. This feature is called ``multiple tablespaces''
because in effect each table has its own tablespace.

</P>
<P>
<STRONG>Important note:</STRONG> If you upgrade to MySQL 4.1.1 or higher, it is
difficult to downgrade back to 4.0 or 4.1.0! That is because earlier
versions of <CODE>InnoDB</CODE> are not aware of multiple tablespaces.

</P>
<P>
If you need to downgrade to 4.0, you have to take table dumps and
re-create the whole <CODE>InnoDB</CODE> tablespace. If you have not created new
<CODE>InnoDB</CODE> tables under MySQL 4.1.1 or later, and need to downgrade
quickly, you can also do a direct downgrade to the MySQL
4.0.18 or later in the 4.0 series.
Before doing the direct downgrade to 4.0.x, you have to end all client
connections to the <CODE>mysqld</CODE> server that is to be downgraded, and let it
run the purge and insert buffer merge operations to completion, so that
<CODE>SHOW INNODB STATUS</CODE> shows the main thread in the state
<CODE>waiting for server activity</CODE>. Then you can shut down
<CODE>mysqld</CODE> and start 4.0.18 or later in the 4.0 series.
A direct downgrade is not recommended, however, because it has not
been extensively tested.

</P>
<P>
You can enable multiple tablespaces by adding a line to the
<CODE>[mysqld]</CODE> section of <TT>`my.cnf'</TT>:

</P>

<PRE>
[mysqld]
innodb_file_per_table
</PRE>

<P>
After restarting the server, <CODE>InnoDB</CODE> will store each newly created
table into its own file <TT>`tbl_name.ibd'</TT> in the database directory
where the table belongs.  This is similar to what the <CODE>MyISAM</CODE>
storage engine does, but <CODE>MyISAM</CODE> divides the table into a data
file <TT>`tbl_name.MYD'</TT> and the index file <TT>`tbl_name.MYI'</TT>.
For <CODE>InnoDB</CODE>, the data and the indexes are stored together in the
<TT>`.ibd'</TT> file.  The <TT>`tbl_name.frm'</TT> file is still created as usual.

</P>
<P>
If you remove the <CODE>innodb_file_per_table</CODE> line from <TT>`my.cnf'</TT> and
restart the server, <CODE>InnoDB</CODE> creates tables inside the shared tablespace
files again.

</P>
<P>
<CODE>innodb_file_per_table</CODE> affects only table creation. If you start the
server with this option, new tables are created using <TT>`.ibd'</TT> files, but you can still access tables that exist in the shared
tablespace. If you remove the option, new tables are created in the shared
tablespace, but you can still access any tables that
were created using multiple tablespaces.

</P>
<P>
<CODE>InnoDB</CODE> always needs the shared tablespace. The <TT>`.ibd'</TT>
files are not sufficient for <CODE>InnoDB</CODE> to operate. The shared tablespace
consists of the familiar <TT>`ibdata'</TT> files where <CODE>InnoDB</CODE> puts its
internal data dictionary and undo logs.

</P>
<P>
<STRONG>You cannot freely move <TT>`.ibd'</TT> files around</STRONG> between database
directories the way you can with
<CODE>MyISAM</CODE> table files. This is because the table definition is stored
in the <CODE>InnoDB</CODE> shared tablespace, and also because <CODE>InnoDB</CODE>
must preserve the consistency of transaction IDs and log sequence numbers.

</P>
<P>
Within a given MySQL installation, you can move an <TT>`.ibd'</TT> file and the
associated table from one database to another with the familiar <CODE>RENAME
TABLE</CODE> statement:

</P>

<PRE>
RENAME TABLE old_db_name.tbl_name TO new_db_name.tbl_name;
</PRE>

<P>
<A NAME="IDX1870"></A>
<A NAME="IDX1871"></A>
If you have a ``clean'' backup of an <TT>`.ibd'</TT> file,
you can restore it to the MySQL installation from which it originated as
follows:

</P>

<OL>
<LI>

Issue this <CODE>ALTER TABLE</CODE> statement:


<PRE>
ALTER TABLE tbl_name DISCARD TABLESPACE;
</PRE>

Caution: This deletes the current <TT>`.ibd'</TT> file.

<LI>

Put the backup <TT>`.ibd'</TT> file back in the proper database directory.

<LI>

Issue this <CODE>ALTER TABLE</CODE> statement:


<PRE>
ALTER TABLE tbl_name IMPORT TABLESPACE;
</PRE>

</OL>

<P>
In this context, a ``clean'' <TT>`.ibd'</TT> file backup means:

</P>

<UL>
<LI>

There are no uncommitted modifications by transactions in the <TT>`.ibd'</TT>
file. 
<LI>

There are no unmerged insert buffer entries in the <TT>`.ibd'</TT> file.
<LI>

Purge has removed all delete-marked index records from the <TT>`.ibd'</TT> file. 
<LI>

<CODE>mysqld</CODE> has flushed all modified pages of the <TT>`.ibd'</TT> file from
the buffer pool to the file. 
</UL>

<P>
You can make such a clean backup <TT>`.ibd'</TT> file with the following method:

</P>

<OL>
<LI>

Stop all activity from the <CODE>mysqld</CODE> server and commit all transactions.
<LI>

Wait until <CODE>SHOW INNODB STATUS</CODE> shows that there are no active
transactions in the database, and the main thread status of <CODE>InnoDB</CODE> is
<CODE>Waiting for server activity</CODE>. Then you can make a copy of the
<TT>`.ibd'</TT> file. 
</OL>

<P>
Another method for making a clean copy of an <TT>`.ibd'</TT> file is to
use the commercial <CODE>InnoDB Hot Backup</CODE> tool:

</P>

<OL>
<LI>

Use <CODE>InnoDB Hot Backup</CODE> to back up the <CODE>InnoDB</CODE> installation.
<LI>

Start a second <CODE>mysqld</CODE> server on the backup and let it clean up
the <TT>`.ibd'</TT> files in the backup. 
</OL>

<P>
It is in the TODO to also allow moving clean <TT>`.ibd'</TT> files to
another MySQL installation. This requires resetting of
transaction IDs and log sequence numbers in the <TT>`.ibd'</TT> file.

</P>



<H2><A NAME="Adding_and_removing" HREF="manual_toc.html#Adding_and_removing">16.8  Adding and Removing <CODE>InnoDB</CODE> Data and Log Files</A></H2>

<P>
This section describes what you can do when your <CODE>InnoDB</CODE> tablespace runs
out of room or when you want to change the size of the log files.

</P>
<P>
From MySQL 3.23.50 and 4.0.2, the easiest way to increase the size of the
<CODE>InnoDB</CODE> tablespace is to configure it from the beginning to be
auto-extending.  Specify the <CODE>autoextend</CODE> attribute for the last
data file in the tablespace definition. Then <CODE>InnoDB</CODE> will increase the
size of that file automatically in 8MB increments when it runs out of space.

</P>
<P>
Alternatively, you can increase the size of your tablespace by adding another
data file. To do this, you have to shut down the MySQL server,
edit the <TT>`my.cnf'</TT> file to add a new data file to the end of
<CODE>innodb_data_file_path</CODE>, and start the server again.

</P>
<P>
If your last data file already was defined with the keyword <CODE>autoextend</CODE>,
the procedure to edit <TT>`my.cnf'</TT> must take into account the size to
which the last data file has grown. You have to
look at the size of the data file, round the size downward to the
closest multiple of 1024 * 1024 bytes (= 1MB), and specify the rounded
size explicitly in <CODE>innodb_data_file_path</CODE>. Then you can add
another data file.  Remember that only the last data file in the
<CODE>innodb_data_file_path</CODE> can be specified as auto-extending.

</P>
<P>
As an example, assume that the tablespace has just one auto-extending data file
<TT>`ibdata1'</TT>:

</P>

<PRE>
innodb_data_home_dir =
innodb_data_file_path = /ibdata/ibdata1:10M:autoextend
</PRE>

<P>
Suppose that that this data file, over time, has grown to 988MB. Below is the
configuration line after adding another auto-extending data file.

</P>

<PRE>
innodb_data_home_dir =
innodb_data_file_path = /ibdata/ibdata1:988M;/disk2/ibdata2:50M:autoextend
</PRE>

<P>
When you add a new file to the tablespace, make sure that it does not
exist so that <CODE>InnoDB</CODE> creates it and initializes it when you restart
the server.

</P>
<P>
Currently, you cannot remove a data file from the tablespace. To decrease the
size of your tablespace, use this procedure:

</P>

<OL>
<LI>

Use <CODE>mysqldump</CODE> to dump all your <CODE>InnoDB</CODE> tables.
<LI>

Stop the server.
<LI>

Remove all the existing tablespace files.
<LI>

Configure a new tablespace.
<LI>

Restart the server.
<LI>

Import the dump files.
</OL>

<P>
If you want to change the number or the size of your <CODE>InnoDB</CODE> log
files, you have to stop the MySQL server and make sure that it shuts down
without errors.  Then copy the old log files into a safe place just in case
something went wrong in the shutdown and you will need them to recover the
tablespace. Delete the old log files from the log file directory, edit
<TT>`my.cnf'</TT> to change the log file configuration, and start the MySQL
server again. <CODE>mysqld</CODE> will see that the no log files exist at startup
and tell you that it is creating new ones.

</P>



<H2><A NAME="Backing_up" HREF="manual_toc.html#Backing_up">16.9  Backing Up and Recovering an <CODE>InnoDB</CODE> Database</A></H2>

<P>
The key to safe database management is taking regular backups.

</P>
<P>
<CODE>InnoDB Hot Backup</CODE> is an online backup tool you can use to backup
your <CODE>InnoDB</CODE> database while it is running. <CODE>InnoDB Hot Backup</CODE> does not
require you to shut down your database and it does not set any locks or
disturb your normal database processing. <CODE>InnoDB Hot Backup</CODE>
is a non-free (commercial) additional tool whose annual license fee is
390 euros per computer where the MySQL server is run.
See the <a HREF="http://www.innodb.com/order.html"><CODE>InnoDB Hot Backup</CODE> home page</a>
for detailed information and screenshots.

</P>
<P>
If you are able to shut down your MySQL server, you can make
a ``binary'' backup that consists of all files used by <CODE>InnoDB</CODE> to manage
its tables. Use the following procedure:

</P>

<OL>
<LI>

Shut down your MySQL server and make sure that it shuts down without errors.
<LI>

Copy all your data files into a safe place.
<LI>

Copy all your <CODE>InnoDB</CODE> log files to a safe place.
<LI>

Copy your <TT>`my.cnf'</TT> configuration file or files to a safe place.
<LI>

Copy all the <TT>`.frm'</TT> files for your <CODE>InnoDB</CODE> tables to a safe place.
</OL>

<P>
Replication works with <CODE>InnoDB</CODE> type tables, so you can use MySQL
replication capabilities to keep a copy of your database at database sites
requiring high availability.

</P>
<P>
In addition to taking binary backups as just described,
you should also regularly take dumps of your tables with
<CODE>mysqldump</CODE>. The reason for this is that a binary file
might be corrupted without you noticing it. Dumped tables are stored
into text files that are human-readable, so spotting table corruption
becomes easier. Also, since the format is simpler, the chance for
serious data corruption is smaller.
<CODE>mysqldump</CODE> also has a <CODE>--single-transaction</CODE> option that
you can use to take a consistent snapshot without locking out other
clients.

</P>
<P>
To be able to recover your <CODE>InnoDB</CODE> database to the present from the
binary backup described above, you have to run your MySQL server
with binary logging turned on. Then you can apply the binary log to the
backup database to achieve point-in-time recovery:

</P>

<PRE>
mysqlbinlog yourhostname-bin.123 | mysql
</PRE>

<P>
To recover from a crash of your MySQL server process, the only thing
you have to do is to restart it. <CODE>InnoDB</CODE> will automatically check the
logs and perform a roll-forward of the database to the present.
<CODE>InnoDB</CODE> will automatically roll back uncommitted transactions that were
present at the time of the crash. During recovery, <CODE>mysqld</CODE> will
display output something like this:

</P>

<PRE>
InnoDB: Database was not shut down normally.
InnoDB: Starting recovery from log files...
InnoDB: Starting log scan based on checkpoint at
InnoDB: log sequence number 0 13674004
InnoDB: Doing recovery: scanned up to log sequence number 0 13739520
InnoDB: Doing recovery: scanned up to log sequence number 0 13805056
InnoDB: Doing recovery: scanned up to log sequence number 0 13870592
InnoDB: Doing recovery: scanned up to log sequence number 0 13936128
...
InnoDB: Doing recovery: scanned up to log sequence number 0 20555264
InnoDB: Doing recovery: scanned up to log sequence number 0 20620800
InnoDB: Doing recovery: scanned up to log sequence number 0 20664692
InnoDB: 1 uncommitted transaction(s) which must be rolled back
InnoDB: Starting rollback of uncommitted transactions
InnoDB: Rolling back trx no 16745
InnoDB: Rolling back of trx no 16745 completed
InnoDB: Rollback of uncommitted transactions completed
InnoDB: Starting an apply batch of log records to the database...
InnoDB: Apply batch completed
InnoDB: Started
mysqld: ready for connections
</PRE>

<P>
If your database gets corrupted or your disk fails, you have
to do the recovery from a backup. In the case of corruption, you should
first find a backup that is not corrupted. After restoring the base
backup, do the recovery from the binary log files.

</P>
<P>
In some cases of database corruption it is enough just to dump, drop,
and re-create one or a few corrupt tables. You can use the
<CODE>CHECK TABLE</CODE> SQL statement to check whether a table is corrupt, although
<CODE>CHECK TABLE</CODE> naturally cannot detect every possible kind of corruption.
You can use <CODE>innodb_tablespace_monitor</CODE> to check the integrity of
the file space management inside the tablespace files.

</P>
<P>
In some cases, apparent database page corruption is actually due to the
operating system corrupting its own file cache, and the data
on disk may be okay. It is best first to try restarting your computer.
It may eliminate errors that appeared to be database page corruption.

</P>



<H3><A NAME="Forcing_recovery" HREF="manual_toc.html#Forcing_recovery">16.9.1  Forcing Recovery</A></H3>

<P>
If there is database page corruption, you may want to dump
your tables from the database with <CODE>SELECT INTO OUTFILE</CODE>,
and usually most of the data
is intact and correct. But the corruption may cause
<CODE>SELECT * FROM tbl_name</CODE> or <CODE>InnoDB</CODE>
background operations to crash or assert, or even the <CODE>InnoDB</CODE>
roll-forward recovery to crash. Starting from MySQL
3.23.44, there is an <CODE>InnoDB</CODE> variable that you can use to
force the <CODE>InnoDB</CODE> storage engine to start up, and you can also
prevent background operations from running, so that
you will be able to dump your tables. For example, you can add the following
line to the <CODE>[mysqld]</CODE> section of your option file before restarting the
server:

</P>

<PRE>
[mysqld]
innodb_force_recovery = 4
</PRE>

<P>
Before MySQL 4.0, use this syntax instead:

</P>

<PRE>
[mysqld]
set-variable = innodb_force_recovery=4
</PRE>

<P>
The allowable non-zero values for <CODE>innodb_force_recovery</CODE> follow.
A larger number includes all precautions of lower numbers. If you are
able to dump your tables with an option value of at most 4, then you are
relatively safe that only some data on corrupt individual pages
is lost. A value of 6 is more dramatic, because database pages are left
in an obsolete state, which in turn may introduce more corruption
into B-trees and other database structures.

</P>


<UL>

<LI><CODE>1</CODE> (<CODE>SRV_FORCE_IGNORE_CORRUPT</CODE>)

Let the server run even if it detects a corrupt page; try to make
<CODE>SELECT * FROM tbl_name</CODE> jump over corrupt index records and pages,
which helps in dumping tables.

<LI><CODE>2</CODE> (<CODE>SRV_FORCE_NO_BACKGROUND</CODE>)

Prevent the main thread from running. If a crash would occur
in the purge operation, this prevents it.

<LI><CODE>3</CODE> (<CODE>SRV_FORCE_NO_TRX_UNDO</CODE>)

Do not run transaction rollbacks after recovery.

<LI><CODE>4</CODE> (<CODE>SRV_FORCE_NO_IBUF_MERGE</CODE>)

Prevent also insert buffer merge operations. If they would cause a
crash, better not do them; do not calculate table statistics.

<LI><CODE>5</CODE> (<CODE>SRV_FORCE_NO_UNDO_LOG_SCAN</CODE>)

Do not look at undo logs when starting the database: <CODE>InnoDB</CODE> will
treat even incomplete transactions as committed.

<LI><CODE>6</CODE> (<CODE>SRV_FORCE_NO_LOG_REDO</CODE>)

Do not do the log roll-forward in connection with recovery.

</UL>

<P>
The database must not otherwise be used with these options!  As a safety
measure, <CODE>InnoDB</CODE> prevents users from doing <CODE>INSERT</CODE>,
<CODE>UPDATE</CODE>, or <CODE>DELETE</CODE> when <CODE>innodb_force_recovery</CODE> is set to
a value greater than 0.

</P>
<P>
Starting from MySQL 3.23.53 and 4.0.4, you are allowed to <CODE>DROP</CODE> or
<CODE>CREATE</CODE> a table even if forced recovery is used. If you know that a
certain table is causing a crash in rollback, you can drop it.  You can use
this also to stop a runaway rollback caused by a failing mass import or
<CODE>ALTER TABLE</CODE>.  You can kill the <CODE>mysqld</CODE> process and set
<CODE>innodb_force_recovery</CODE> to <CODE>3</CODE> to bring your database up without
the rollback.  Then <CODE>DROP</CODE> the table that is causing the runaway
rollback.

</P>



<H3><A NAME="InnoDB_checkpoints" HREF="manual_toc.html#InnoDB_checkpoints">16.9.2  Checkpoints</A></H3>

<P>
<CODE>InnoDB</CODE> implements a checkpoint mechanism called a ``fuzzy
checkpoint.'' <CODE>InnoDB</CODE> will flush modified database pages from the buffer
pool in small batches. There is no need to flush the buffer pool
in one single batch, which would in practice stop processing
of user SQL statements for a while.

</P>
<P>
In crash recovery, <CODE>InnoDB</CODE> looks for a checkpoint label written
to the log files. It knows that all modifications to the database
before the label are already present in the disk image of the database.
Then <CODE>InnoDB</CODE> scans the log files forward from the place of the
checkpoint,
applying the logged modifications to the database.

</P>
<P>
<CODE>InnoDB</CODE> writes to the log files in a circular fashion.
All committed modifications that make the database pages in the buffer
pool different from the images on disk must be available in the log files
in case <CODE>InnoDB</CODE> has to do a recovery. This means that when <CODE>InnoDB</CODE> starts
to reuse a log file in the circular fashion, it has to make sure that the
database page images on disk already contain the modifications
logged in the log file <CODE>InnoDB</CODE> is going to reuse. In other words,
<CODE>InnoDB</CODE>
has to make a checkpoint and often this involves flushing of
modified database pages to disk.

</P>
<P>
The preceding description explains why making your log files very big may save
disk I/O in checkpointing. It can make sense to set
the total size of the log files as big as the buffer pool or even bigger.
The drawback of big log files is that crash recovery can take longer
because there will be more logged information to apply to the database.

</P>



<H2><A NAME="Moving" HREF="manual_toc.html#Moving">16.10  Moving an <CODE>InnoDB</CODE> Database to Another Machine</A></H2>

<P>
On Windows, <CODE>InnoDB</CODE> internally always stores database and
table names in lowercase. To move databases in a binary format 
from Unix to Windows or from Windows to Unix, you should have all table
and database names in lowercase. A convenient way to accomplish this
on Unix is to add the following line to the <CODE>[mysqld]</CODE> section of
your <TT>`my.cnf'</TT> before you start creating your databases and tables:

</P>

<PRE>
[mysqld]
set-variable = lower_case_table_names=1
</PRE>

<P>
On Windows, <CODE>lower_case_table_names</CODE> is set to <CODE>1</CODE> by default.

</P>
<P>
Like <CODE>MyISAM</CODE> data files, <CODE>InnoDB</CODE> data and log files are
binary-compatible on all platforms if the floating-point number format on
the machines is the same.  You can move an <CODE>InnoDB</CODE> database simply by
copying all the relevant files, which were listed in section <A HREF="manual.html#Backing_up">16.9  Backing Up and Recovering an <CODE>InnoDB</CODE> Database</A>.  If
the floating-point formats on the machines are different but you have not
used <CODE>FLOAT</CODE> or <CODE>DOUBLE</CODE> data types in your tables, then the
procedure is the same: Just copy the relevant files. If the formats are
different and your tables contain floating-point data, you have to use
<CODE>mysqldump</CODE> to dump your tables on one machine and then import the dump
files on the other machine.

</P>
<P>
A performance tip is to switch off autocommit mode when you import
data into your database, assuming that your tablespace has enough space for
the big rollback segment the big import transaction will generate.
Do the commit only after importing a whole table or a segment of
a table.

</P>



<H2><A NAME="InnoDB_transaction_model" HREF="manual_toc.html#InnoDB_transaction_model">16.11  <CODE>InnoDB</CODE> Transaction Model and Locking</A></H2>

<P>
In the <CODE>InnoDB</CODE> transaction model, the goal has been to combine the
best properties of a multi-versioning database with traditional two-phase
locking.  <CODE>InnoDB</CODE> does locking on the row level and runs queries as
non-locking consistent reads by default, in the style of Oracle.  The lock
table in <CODE>InnoDB</CODE> is stored so space-efficiently that lock escalation
is not needed: Typically several users are allowed to lock every row in the
database, or any random subset of the rows, without <CODE>InnoDB</CODE> running
out of memory.

</P>



<H3><A NAME="InnoDB_and_AUTOCOMMIT" HREF="manual_toc.html#InnoDB_and_AUTOCOMMIT">16.11.1  <CODE>InnoDB</CODE> and <CODE>AUTOCOMMIT</CODE></A></H3>

<P>
In <CODE>InnoDB</CODE>, all user activity occurs inside a transaction. If the
autocommit mode is enabled, each SQL statement forms a
single transaction on its own. MySQL always starts a new connection
with autocommit enabled.

</P>
<P>
If the autocommit mode is switched off with <CODE>SET AUTOCOMMIT = 0</CODE>,
then we can think that a user always has a transaction open. An
SQL <CODE>COMMIT</CODE> or <CODE>ROLLBACK</CODE> statement ends the
current transaction and a new one starts. Both statements will release
all <CODE>InnoDB</CODE> locks that were set during the current transaction.
A <CODE>COMMIT</CODE> means that the changes made in the current transaction
are made permanent and become visible to other users.
A <CODE>ROLLBACK</CODE> statement, on the other hand, cancels all
modifications made by the current transaction.

</P>
<P>
If the connection has autocommit enabled, the user can still
perform a multiple-statement transaction by starting it with an
explicit <CODE>START TRANSACTION</CODE> or <CODE>BEGIN</CODE> statement and ending it with
<CODE>COMMIT</CODE> or <CODE>ROLLBACK</CODE>.

</P>



<H3><A NAME="InnoDB_transaction_isolation" HREF="manual_toc.html#InnoDB_transaction_isolation">16.11.2  <CODE>InnoDB</CODE> and <CODE>TRANSACTION ISOLATION LEVEL</CODE></A></H3>

<P>
In terms of the SQL:1992 transaction isolation levels,
the <CODE>InnoDB</CODE> default is <CODE>REPEATABLE READ</CODE>.
Starting from MySQL 4.0.5, <CODE>InnoDB</CODE> offers all four different
transaction isolation levels described by the SQL standard.
You can set the default isolation level for all connections by using the
<CODE>--transaction-isolation</CODE> option on the command line or in option files.
For example, you can set the option
in the <CODE>[mysqld]</CODE> section of <TT>`my.cnf'</TT> like this:

</P>

<PRE>
[mysqld]
transaction-isolation = {READ-UNCOMMITTED | READ-COMMITTED
                         | REPEATABLE-READ | SERIALIZABLE}
</PRE>

<P>
A user can change the isolation level of a single session or
all new incoming connections with the <CODE>SET TRANSACTION</CODE>
statement. Its syntax is as follows:

</P>

<PRE>
SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL
                       {READ UNCOMMITTED | READ COMMITTED
                        | REPEATABLE READ | SERIALIZABLE}
</PRE>

<P>
Note that there are hyphens in the level names for the
<CODE>--transaction-isolation</CODE> option, but not for the <CODE>SET
TRANSACTION</CODE> statement.

</P>
<P>
The default behavior is to set the isolation level for the next (not
started) transaction. If you use the <CODE>GLOBAL</CODE> keyword, the statement
sets the default transaction level globally for all new connections
created from that point on (but not existing connections).
You need the <CODE>SUPER</CODE> privilege to do this.  Using the <CODE>SESSION</CODE>
keyword sets the default transaction level for all future transactions
performed on the current connection.

</P>
<P>
Any client is free to change the session isolation level (even in the
middle of a transaction), or the isolation level for the next
transaction.

</P>
<P>
Before MySQL 3.23.50, <CODE>SET TRANSACTION</CODE> had no effect
on <CODE>InnoDB</CODE> tables. Before 4.0.5, only <CODE>REPEATABLE READ</CODE>
and <CODE>SERIALIZABLE</CODE> were available.

</P>
<P>
You can query the global and session transaction isolation levels with these
statements:

</P>

<PRE>
SELECT @@global.tx_isolation;
SELECT @@tx_isolation;
</PRE>

<P>
In row-level locking, <CODE>InnoDB</CODE> uses so-called ``next-key locking.''
That means that besides index records, <CODE>InnoDB</CODE> can also lock
the ``gap'' before an index record to block insertions by other users
immediately before the index record. A next-key lock refers to
a lock that locks an index record and the gap before it.
A gap lock refers to a lock that only locks a gap before some
index record.

</P>
<P>
A detailed description of each isolation level in <CODE>InnoDB</CODE>:

</P>


<UL>

<LI><CODE>READ UNCOMMITTED</CODE>

<CODE>SELECT</CODE> statements are performed in a non-locking fashion, but a
possible earlier version of a record might be used. Thus, using this
isolation level, such reads are not ``consistent.'' This is also called
``dirty read.''  Other than that, this isolation level works like <CODE>READ
COMMITTED</CODE>.

<LI><CODE>READ COMMITTED</CODE>

A somewhat Oracle-like isolation level.  All <CODE>SELECT ... FOR UPDATE</CODE>
and <CODE>SELECT ... LOCK IN SHARE MODE</CODE> statements lock only the index
records, not the gaps before them, and thus allow free inserting of new
records next to locked records.  <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> statements
that use a unique index with a unique search condition lock only the index
record found, not the gap before it.  In range-type <CODE>UPDATE</CODE>
and <CODE>DELETE</CODE> statements, <CODE>InnoDB</CODE> must set next-key or gap locks
and block insertions by other users to the gaps covered by the range. This
is necessary because ``phantom rows'' must be blocked for MySQL replication
and recovery to work.

Consistent reads behave as in Oracle: Each consistent read,
even within the same transaction, sets and reads its own fresh
snapshot.
See section <A HREF="manual.html#InnoDB_consistent_read">16.11.3  Consistent Non-Locking Read</A>.

<LI><CODE>REPEATABLE READ</CODE>

This is the default isolation level of <CODE>InnoDB</CODE>.
<CODE>SELECT ... FOR UPDATE</CODE>, <CODE>SELECT ... LOCK IN SHARE MODE</CODE>,
<CODE>UPDATE</CODE>, and <CODE>DELETE</CODE> statements that use a unique index with a
unique search condition lock only the index record found, not the gap
before it.
With other search conditions, these operations employ next-key locking,
locking the index range scanned with next-key or gap locks, and block
new insertions by other users.

In consistent reads, there is an important difference from the
previous isolation level: In this level, all consistent reads within
the same transaction read the same snapshot established by the first
read. This convention means that if you issue several plain
<CODE>SELECT</CODE> statements within the same transaction, these
<CODE>SELECT</CODE> statements are consistent also with respect to each
other.
See section <A HREF="manual.html#InnoDB_consistent_read">16.11.3  Consistent Non-Locking Read</A>.

<LI><CODE>SERIALIZABLE</CODE>

This level is like <CODE>REPEATABLE READ</CODE>, but all plain
<CODE>SELECT</CODE> statements are implicitly converted to
<CODE>SELECT ... LOCK IN SHARE MODE</CODE>.

</UL>



<H3><A NAME="InnoDB_consistent_read" HREF="manual_toc.html#InnoDB_consistent_read">16.11.3  Consistent Non-Locking Read</A></H3>

<P>
A consistent read means that <CODE>InnoDB</CODE> uses its multi-versioning to
present to a query a snapshot of the database at a point in time.
The query will see the changes made by exactly those transactions
that committed before that point of time, and no changes made by
later or uncommitted transactions. The exception to this rule
is that the query will see the changes made by the transaction
itself that issues the query. 

</P>
<P>
If you are running with the default <CODE>REPEATABLE READ</CODE> isolation level,
then all consistent reads within the same transaction read the snapshot
established by the first such read in that transaction. You can get a
fresher snapshot for your queries by committing the current transaction
and after that issuing new queries. 

</P>
<P>
Consistent read is the default mode in which <CODE>InnoDB</CODE> processes
<CODE>SELECT</CODE> statements in <CODE>READ COMMITTED</CODE> and
<CODE>REPEATABLE READ</CODE> isolation levels. A consistent read
does not set any locks on the tables it accesses, and
therefore other users are free to modify those tables at
the same time a consistent read is being performed on the table. 

</P>



<H3><A NAME="InnoDB_locking_reads" HREF="manual_toc.html#InnoDB_locking_reads">16.11.4  Locking Reads <CODE>SELECT ... FOR UPDATE</CODE> and <CODE>SELECT ... LOCK IN SHARE MODE</CODE></A></H3>

<P>
In some circumstances, a consistent read is not convenient.
For example, you might want to add a new row into your table <CODE>child</CODE>,
and make sure that the child already has a parent in table
<CODE>parent</CODE>.  The following example shows how to implement referential
integrity in your application code.

</P>
<P>
Suppose that you use a consistent read to read the table <CODE>parent</CODE>
and indeed see the parent of the child in the table. Can you now safely
add the child row to table <CODE>child</CODE>? No, because it may
happen that meanwhile some other user deletes the parent row
from the table <CODE>parent</CODE>, without you being aware of it.

</P>
<P>
The solution is to perform the <CODE>SELECT</CODE> in a locking
mode using <CODE>LOCK IN SHARE MODE</CODE>:
  

<PRE>
SELECT * FROM parent WHERE NAME = 'Jones' LOCK IN SHARE MODE;
</PRE>

<P>
Performing a read in share mode means that we read the latest
available data, and set a shared mode lock on the rows we read.
A shared mode lock prevents others from updating or deleting
the row we have read.  Also,
if the latest data belongs to a yet uncommitted transaction of another
client connection, we will wait until that transaction commits.
After we see that the preceding query returns
the parent <CODE>'Jones'</CODE>, we can safely add the child record
to the <CODE>child</CODE> table and commit our transaction.

</P>
<P>
Let us look at another example: We have an integer counter field in
a table <CODE>child_codes</CODE> that we use to assign
a unique identifier to each child added to table <CODE>child</CODE>.
Obviously, using a consistent read or a shared mode read
to read the present value of the counter is not a good idea, since
two users of the database may then see the same value for the
counter, and a duplicate-key error will occur if two users attempt to add
children with the same identifier to the table.

</P>
<P>
Here, <CODE>LOCK IN SHARE MODE</CODE> is not a good solution because if two
users read the counter at the same time, at least one of them
will end up in deadlock when attempting to update the counter.

</P>
<P>
In this case, there are two good ways to implement the reading and
incrementing of the counter:
(1) update the counter first by incrementing it by 1 and only after
that read it, or
(2) read the counter first with a lock mode <CODE>FOR UPDATE</CODE>, and
increment after that. The latter approach can be implemented as follows:

</P>

<PRE>
SELECT counter_field FROM child_codes FOR UPDATE;
UPDATE child_codes SET counter_field = counter_field + 1;
</PRE>

<P>
A <CODE>SELECT ... FOR UPDATE</CODE> reads the latest
available data, setting exclusive locks on each row it reads.
Thus it sets the same locks a searched SQL <CODE>UPDATE</CODE> would set
on the rows.

</P>
<P>
Please note that the above is merely an example of how <CODE>SELECT ... FOR
UPDATE</CODE> works. In MySQL, the specific task of generating a unique identifier
actually can be accomplished using only a single access to the table:

</P>

<PRE>
UPDATE child_codes
       SET counter_field = LAST_INSERT_ID(counter_field + 1);
SELECT LAST_INSERT_ID();
</PRE>

<P>
The <CODE>SELECT</CODE> statement merely retrieves the identifier information
(specific to the current connection). It does not access any table.

</P>



<H3><A NAME="InnoDB_Next-key_locking" HREF="manual_toc.html#InnoDB_Next-key_locking">16.11.5  Next-Key Locking: Avoiding the Phantom Problem</A></H3>

<P>
In row-level locking, <CODE>InnoDB</CODE> uses an algorithm called ``next-key locking.''
<CODE>InnoDB</CODE> does the row-level locking in such a way that when it searches
or scans an index of a table, it sets shared or exclusive locks
on the index records it encounters. Thus the row-level locks are
actually index record locks.

</P>
<P>
The locks <CODE>InnoDB</CODE> sets on index records also affect the ``gap'' before
that index record. If a user has a shared or exclusive lock on record
<CODE>R</CODE> in an index, another user cannot insert a new index record
immediately before <CODE>R</CODE> in the index order.  This locking of gaps is
done to prevent the so-called ``phantom problem.'' Suppose that you want to read and
lock all children from the <CODE>child</CODE> table with an identifier value
larger than 100, with the intent of updating some column in the selected
rows later:

</P>

<PRE>
SELECT * FROM child WHERE id &#62; 100 FOR UPDATE;
</PRE>

<P>
Suppose that there is an index on the <CODE>id</CODE> column. The query will scan that
index starting from the first record where <CODE>id</CODE> is bigger than 100.
Now, if the locks set on the index records would not lock out inserts made
in the gaps, a new row might meanwhile be inserted to the table. If you now
execute the same <CODE>SELECT</CODE> within the same transaction, you would see a
new row in the result set returned by the query.  This is contrary the
isolation principle of transactions: A transaction should be able to run so
that the data it has read does not change during the transaction. If we
regard a set of rows as a data item, the new ``phantom'' child would violate
this isolation principle.

</P>
<P>
When <CODE>InnoDB</CODE> scans an index, it can also lock the gap
after the last record in the index. Just that happens in the previous
example: The locks set by <CODE>InnoDB</CODE> prevent any insert to
the table where <CODE>id</CODE> would be bigger than 100.

</P>
<P>
You can use next-key locking to implement a uniqueness
check in your application: If you read your data in share mode
and do not see a duplicate for a row you are going to insert,
then you can safely insert your row and know that the next-key
lock set on the successor of your row during the read will prevent
anyone meanwhile inserting a duplicate for your row. Thus the next-key
locking allows you to ``lock'' the non-existence of something in your
table.

</P>



<H3><A NAME="InnoDB_Consistent_read_example" HREF="manual_toc.html#InnoDB_Consistent_read_example">16.11.6  An Example of How the Consistent Read Works in <CODE>InnoDB</CODE></A></H3>

<P>
Suppose that you are running in the default <CODE>REPEATABLE READ</CODE> isolation level.
When you issue a consistent read, that is, an ordinary <CODE>SELECT</CODE>
statement, <CODE>InnoDB</CODE> will give your transaction a timepoint according
to which your query sees the database. If another transaction deletes
a row and commits after your timepoint was assigned, you will
not see the row as having been deleted. Inserts and updates are treated
similarly.

</P>
<P>
You can advance your timepoint by committing your transaction
and then doing another <CODE>SELECT</CODE>.

</P>
<P>
This is called ``multi-versioned concurrency control.''

</P>

<PRE>
               User A                 User B

           SET AUTOCOMMIT=0;      SET AUTOCOMMIT=0;
time
|          SELECT * FROM t;
|          empty set
|                                 INSERT INTO t VALUES (1, 2);
|
v          SELECT * FROM t;
           empty set
                                  COMMIT;

           SELECT * FROM t;
           empty set

           COMMIT;

           SELECT * FROM t;
           ---------------------
           |    1    |    2    |
           ---------------------
           1 row in set
</PRE>

<P>
In this example,
user A sees the row inserted by B only when B has committed the
insert and A has committed as well, so that the timepoint
is advanced past the commit of B.

</P>
<P>
If you want to see the ``freshest'' state of the database, you should
use either the <CODE>READ COMMITTED</CODE> isolation level or a locking read:

</P>

<PRE>
SELECT * FROM t LOCK IN SHARE MODE;
</PRE>



<H3><A NAME="InnoDB_Locks_set" HREF="manual_toc.html#InnoDB_Locks_set">16.11.7  Locks Set by Different SQL Statements in <CODE>InnoDB</CODE></A></H3>

<P>
A locking read, an <CODE>UPDATE</CODE>, or a <CODE>DELETE</CODE>
generally set record locks on every index record that is scanned in
the processing of the SQL query. It does not matter if there are
<CODE>WHERE</CODE> conditions in the query that would exclude the row
from the result set of the query. <CODE>InnoDB</CODE> does not remember the exact
<CODE>WHERE</CODE> condition, but only knows which index ranges were
scanned. The record locks are normally next-key locks that also block
inserts to the ``gap'' immediately before the record.

</P>
<P>
If the locks to be set are exclusive,
then <CODE>InnoDB</CODE> always retrieves also the clustered index record and sets
a lock on it.

</P>
<P>
If you do not have indexes suitable for your query and
MySQL has to scan the whole table to process the query,
every row of the table will become locked, which in turn blocks all
inserts by other users to the table. It is important to create good indexes
so that your queries do not unnecessarily need to scan many rows.

</P>

<UL>

<LI>

<CODE>SELECT ... FROM</CODE> is a consistent read, reading a snapshot of the
database and setting no locks unless the transaction isolation level is set
to <CODE>SERIALIZABLE</CODE>. For <CODE>SERIALIZABLE</CODE> level, this sets shared
next-key locks on the index records it encounters.

<LI>

<CODE>SELECT ... FROM ... LOCK IN SHARE MODE</CODE>
sets shared next-key locks on all index records the read encounters.

<LI>

<CODE>SELECT ... FROM ... FOR UPDATE</CODE>
sets exclusive next-key locks on all index records the read
encounters.

<LI>

<CODE>INSERT INTO ... VALUES (...)</CODE>
sets an exclusive lock on the inserted row. Note that this lock is not
a next-key lock and does not prevent other users from inserting to the
gap before the inserted row. If a duplicate-key error occurs, a shared
lock on the duplicate index record is set.

<LI>

While initializing a previously specified <CODE>AUTO_INCREMENT</CODE> column
on a table, <CODE>InnoDB</CODE> sets an exclusive lock on the end of the index
associated with the <CODE>AUTO_INCREMENT</CODE> column.
In accessing the auto-increment counter, <CODE>InnoDB</CODE> uses a specific table
lock mode <CODE>AUTO-INC</CODE> where the lock lasts only to the end of the
current SQL statement, instead of to the end of the whole transaction.
See section <A HREF="manual.html#InnoDB_and_AUTOCOMMIT">16.11.1  <CODE>InnoDB</CODE> and <CODE>AUTOCOMMIT</CODE></A>.

Before MySQL 3.23.50, <CODE>SHOW TABLE STATUS</CODE> applied to a table
with an <CODE>AUTO_INCREMENT</CODE> column sets an exclusive row-level lock
to the high end of the <CODE>AUTO_INCREMENT</CODE> index. This means
also that <CODE>SHOW TABLE STATUS</CODE> could cause a deadlock of transactions,
something that may surprise users. Starting from MySQL 3.23.50,
<CODE>InnoDB</CODE> fetches the value of a previously initialized
<CODE>AUTO_INCREMENT</CODE> column without setting any locks.

<LI>

<CODE>INSERT INTO T SELECT ... FROM S WHERE ...</CODE>
sets an exclusive (non-next-key) lock on each row inserted into
<CODE>T</CODE>. It does the search on <CODE>S</CODE> as a consistent read, but
sets shared next-key locks on <CODE>S</CODE> if MySQL binary logging is turned
on. <CODE>InnoDB</CODE> has to set locks in the latter case: In
roll-forward recovery from a backup, every SQL statement has to be
executed in exactly the same way it was done originally.

<LI>

<CODE>CREATE TABLE ... SELECT ...</CODE>
performs the <CODE>SELECT</CODE> as a consistent read or with shared locks,
as in the previous item.

<LI>

<CODE>REPLACE</CODE>
is done like an insert if there is no collision on a unique key.
Otherwise, an exclusive next-key lock is placed on the row that has
to be updated.

<LI>

<CODE>UPDATE ... WHERE ...</CODE>
sets an exclusive next-key lock on every record the search encounters.

<LI>

<CODE>DELETE FROM ... WHERE ...</CODE>
sets an exclusive next-key lock on every record the search encounters.

<LI>

If a <CODE>FOREIGN KEY</CODE> constraint is defined on a table, any insert,
update, or delete that requires checking of the constraint condition
sets shared record-level locks on the records it looks at to check the
constraint.  <CODE>InnoDB</CODE> also sets these locks
in the case where the constraint fails.

<LI>

<CODE>LOCK TABLES</CODE> sets table locks, but it is the higher MySQL layer above
the <CODE>InnoDB</CODE> layer that sets these locks. The automatic deadlock
detection of <CODE>InnoDB</CODE> cannot detect deadlocks where such table locks
are involved.
See section <A HREF="manual.html#InnoDB_Deadlock_detection">16.11.9  Deadlock Detection and Rollback</A>.

Also, since the higher MySQL layer does not know about row-level locks, it
is possible to get a table lock on a table where another user
currently has row-level locks. But that does not put transaction
integrity in danger.
See section <A HREF="manual.html#InnoDB_restrictions">16.17  Restrictions on <CODE>InnoDB</CODE> Tables</A>.
</UL>



<H3><A NAME="InnoDB_implicit_command_or_rollback" HREF="manual_toc.html#InnoDB_implicit_command_or_rollback">16.11.8  When Does MySQL Implicitly Commit or Roll Back a Transaction?</A></H3>

<P>
MySQL begins each client connection with autocommit mode enabled by default.
When autocommit enabled, MySQL does a commit after each SQL statement if
that statement did not return an error.

</P>
<P>
If you have the autocommit mode off and close a connection
without calling an explicit commit of your transaction,
then MySQL will roll back your transaction.

</P>
<P>
If an error is returned by an SQL statement, the commit/rollback
behavior depends on the error.
See section <A HREF="manual.html#InnoDB_Error_handling">16.16  Error Handling</A>.

</P>
<P>
The following SQL statements cause an implicit commit of the
current transaction in MySQL:

</P>

<UL>
<LI>

<CODE>ALTER TABLE</CODE>, <CODE>BEGIN</CODE>, <CODE>CREATE INDEX</CODE>, <CODE>DROP DATABASE</CODE>,
<CODE>DROP INDEX</CODE>, <CODE>DROP TABLE</CODE>, <CODE>LOAD MASTER DATA</CODE>, <CODE>LOCK
TABLES</CODE>, <CODE>RENAME TABLE</CODE>, <CODE>SET AUTOCOMMIT=1</CODE>, <CODE>START
TRANSACTION</CODE>, <CODE>TRUNCATE</CODE>, <CODE>UNLOCK TABLES</CODE>.
<LI>

<CODE>CREATE TABLE</CODE> (this commits only if before MySQL 4.0.13 and MySQL
binary logging is used).
<LI>

The <CODE>CREATE TABLE</CODE> statement in <CODE>InnoDB</CODE> is processed as a single
transaction. It means that a <CODE>ROLLBACK</CODE> from the user does not
undo <CODE>CREATE TABLE</CODE> statements the user made during that
transaction.
</UL>



<H3><A NAME="InnoDB_Deadlock_detection" HREF="manual_toc.html#InnoDB_Deadlock_detection">16.11.9  Deadlock Detection and Rollback</A></H3>

<P>
<CODE>InnoDB</CODE> automatically detects a deadlock of transactions and rolls back a
transaction or transactions to prevent the deadlock. Starting from
MySQL 4.0.5, <CODE>InnoDB</CODE> tries to pick small transactions to roll
back. The size of a transaction is determined by the number of rows
it has inserted, updated, or deleted. Prior to 4.0.5, <CODE>InnoDB</CODE>
always rolled back the transaction whose lock request was the last
one to build a deadlock, that is, a cycle in the ``waits-for'' graph
of transactions. 

</P>
<P>
<CODE>InnoDB</CODE> cannot detect deadlocks where a table lock set by a MySQL
<CODE>LOCK TABLES</CODE> statement is involved, or if a lock set
by another storage engine than <CODE>InnoDB</CODE> is involved. You have to resolve
these situations by setting the value of the  <CODE>innodb_lock_wait_timeout</CODE>
system variable.

</P>
<P>
When <CODE>InnoDB</CODE> performs a complete rollback of a transaction, all the
locks of the transaction are released. However, if just a single SQL
statement is rolled back as a result of an error, some of the locks
set by the SQL statement may be preserved. This is because <CODE>InnoDB</CODE>
stores row locks in a format such it cannot know afterward which lock was
set by which SQL statement.

</P>



<H3><A NAME="Innodb_deadlocks" HREF="manual_toc.html#Innodb_deadlocks">16.11.10  How to Cope with Deadlocks</A></H3>

<P>
Deadlocks are a classic problem in transactional databases, but they
are not dangerous unless they are so frequent that you cannot run
certain transactions at all. Normally, you must write your
applications so that they are always prepared to re-issue a
transaction if it gets rolled back because of a deadlock. 

</P>
<P>
<CODE>InnoDB</CODE> uses automatic row-level locking. You can get deadlocks
even in the case of transactions that just insert or delete a
single row. That is because these operations are not really ``atomic'';
they automatically set locks on the (possibly several) index
records of the row inserted or deleted.

</P>
<P>
You can cope with deadlocks and reduce the likelihood of their occurrence
with the following techniques: 

</P>

<UL>
<LI>

Use <CODE>SHOW INNODB STATUS</CODE> to determine the cause of the latest deadlock.
That can help you to tune your application to avoid deadlocks.  This
strategy can be used as of MySQL 3.23.52 and 4.0.3, depending on your MySQL
series.
<LI>

Always be prepared to re-issue a transaction if it fails due to
deadlock. Deadlocks are not dangerous. Just try again. 
<LI>

Commit your transactions often. Small transactions are less prone to collide. 
<LI>

If you are using locking reads (<CODE>SELECT ... FOR UPDATE</CODE>
or <CODE>... LOCK IN SHARE MODE</CODE>), try using a lower isolation
level such as <CODE>READ COMMITTED</CODE>. 
<LI>

Access your tables and rows in a fixed order. Then transactions
form nice queues and do not deadlock. 
<LI>

Add well-chosen indexes to your tables. Then your queries need to
scan fewer index records and consequently set fewer locks.
Use <CODE>EXPLAIN SELECT</CODE> to determine which indexes the MySQL
server regards as the most appropriate for your queries.
<LI>

Use less locking. If you can afford to allow a <CODE>SELECT</CODE> to return data
from an old snapshot, do not add the clause <CODE>FOR UPDATE</CODE>
or <CODE>LOCK IN SHARE MODE</CODE> to it. Using <CODE>READ COMMITTED</CODE>
isolation level is good here, because each consistent read
within the same transaction reads from its own fresh snapshot. 
<LI>

If nothing helps, serialize your transactions with table-level locks.
For example, if you need to write table <CODE>t1</CODE> and read table <CODE>t2</CODE>,
you can do this:


<PRE>
LOCK TABLES t1 WRITE, t2 READ, ...;
[do something with tables t1 and t2 here];
UNLOCK TABLES;
</PRE>

Table-level locks make your transactions queue nicely,
and deadlocks are avoided. Note that <CODE>LOCK TABLES</CODE>
implicitly starts a transaction, just like the statement <CODE>BEGIN</CODE>,
and <CODE>UNLOCK TABLES</CODE> implicitly ends the transaction in a <CODE>COMMIT</CODE>. 
<LI>

Another way to serialize transactions is to create
an auxiliary ``semaphore'' table that contains just a
single row. Have each transaction update that row before
accessing other tables. In that way, all transactions
happen in a serial fashion. Note that the <CODE>InnoDB</CODE> instant
deadlock detection algorithm also works in this case,
because the serializing lock is a row-level lock.
With MySQL table-level locks, the timeout method must be used to
resolve deadlocks.
</UL>



<H2><A NAME="InnoDB_tuning" HREF="manual_toc.html#InnoDB_tuning">16.12  <CODE>InnoDB</CODE> Performance Tuning Tips</A></H2>


<UL>
<LI>

If the Unix <TT>`top'</TT> tool or the Windows Task Manager shows
that the CPU usage percentage with your workload is less than 70%,
your workload is probably
disk-bound. Maybe you are making too many transaction commits, or the
buffer pool is too small.
Making the buffer pool bigger can help, but do not set
it bigger than 80% of physical memory.

<LI>

Wrap several modifications into one transaction. <CODE>InnoDB</CODE> must
flush the log to disk at each transaction commit if that transaction
made modifications to the database. Since the rotation speed of a disk
is typically
at most 167 revolutions/second, that constrains the number of commits
to the same 167/second if the disk does not fool the operating system.

<LI>

If you can afford the loss of some latest committed transactions, you can
set the <TT>`my.cnf'</TT> parameter <CODE>innodb_flush_log_at_trx_commit</CODE>
to 0. <CODE>InnoDB</CODE> tries to flush the log once per second anyway,
although the flush is not guaranteed.

<LI>

Make your log files big, even as big as the buffer pool. When <CODE>InnoDB</CODE>
has written the log files full, it has to write the modified contents
of the buffer pool to disk in a checkpoint. Small log files will cause many
unnecessary disk writes. The drawback of big log files is that recovery
time will be longer.

<LI>

Make the log buffer quite big as well (say, 8MB).

<LI>

Use the <CODE>VARCHAR</CODE> column type instead of <CODE>CHAR</CODE> if you are
storing variable-length strings or if the column may contain many
<CODE>NULL</CODE> values. A <CODE>CHAR(N)</CODE> column always takes <CODE>N</CODE> bytes to
store data, even if the string is shorter, or its value is
<CODE>NULL</CODE>. Smaller tables fit better in the buffer pool and reduce
disk I/O.

<LI>

(Relevant from 3.23.39 up.)
In some versions of GNU/Linux and Unix, flushing files to disk with the
Unix <CODE>fsync()</CODE> and other similar methods is surprisingly slow.
The default method <CODE>InnoDB</CODE> uses is the <CODE>fsync()</CODE> function.
If you are not satisfied with the database write performance, you might
try setting <CODE>innodb_flush_method</CODE> in <TT>`my.cnf'</TT> to
<CODE>O_DSYNC</CODE>, although <CODE>O_DSYNC</CODE> seems to be slower on most
systems.

<LI>

When importing data into <CODE>InnoDB</CODE>, make sure that MySQL does not have
autocommit mode enabled because that would require a log flush to disk for
every insert.
To disable autocommit during your import operation, surround it with <CODE>SET
AUTOCOMMIT</CODE> and <CODE>COMMIT</CODE> statements:


<PRE>
SET AUTOCOMMIT=0;
/* SQL import statements ... */
COMMIT;
</PRE>

If you use the <CODE>mysqldump</CODE> option <CODE>--opt</CODE>, you will get dump
files that are fast to import into an <CODE>InnoDB</CODE> table, even without
wrapping them with the <CODE>SET AUTOCOMMIT</CODE> and <CODE>COMMIT</CODE> statements.

<LI>

Beware of big rollbacks of mass inserts: <CODE>InnoDB</CODE> uses the insert
buffer to save disk I/O in inserts, but no such mechanism is used in a
corresponding rollback.  A disk-bound rollback can take 30 times the time
of the corresponding insert. Killing the database process will not help
because the rollback will start again at the server startup. The only
way to get rid of a runaway rollback is to increase the buffer pool so that
the rollback becomes CPU-bound and runs fast, or to use a special procedure.
See section <A HREF="manual.html#Forcing_recovery">16.9.1  Forcing Recovery</A>.

<LI>

Beware also of other big disk-bound operations.
Use <CODE>DROP TABLE</CODE> or <CODE>TRUNCATE TABLE</CODE> (from MySQL 4.0 up) to empty a
table, not <CODE>DELETE FROM tbl_name</CODE>.

<LI>

Use the multiple-row <CODE>INSERT</CODE> syntax to reduce
communication overhead between the client and the server if you need
to insert many rows:


<PRE>
INSERT INTO yourtable VALUES (1,2), (5,5), ...;
</PRE>

This tip is valid for inserts into any table type, not just <CODE>InnoDB</CODE>.

<LI>

If you have <CODE>UNIQUE</CODE> constraints on
secondary keys, starting from MySQL 3.23.52 and 4.0.3, you
can speed up table imports by temporarily turning off the uniqueness
checks during the import session:


<PRE>
SET UNIQUE_CHECKS=0;
</PRE>

For big tables, this saves a lot of disk I/O because <CODE>InnoDB</CODE> can
use its insert buffer to write secondary index records in a batch.

<LI>

If you have <CODE>FOREIGN KEY</CODE> constraints in your tables, starting
from MySQL 3.23.52 and 4.0.3, you can speed up table imports by turning the
foreign key checks off for a while in the import session:


<PRE>
SET FOREIGN_KEY_CHECKS=0;
</PRE>

For big tables, this can save a lot of disk I/O.

<LI>

If you often have recurring queries to tables that are not
updated frequently, use the query cache available as of MySQL 4.0:


<PRE>
[mysqld]
query_cache_type = ON
query_cache_size = 10M
</PRE>

In MySQL 4.0, the query cache works only with autocommit enabled. This
restriction is removed in MySQL 4.1.1 and up.
</UL>



<H3><A NAME="InnoDB_Monitor" HREF="manual_toc.html#InnoDB_Monitor">16.12.1  <CODE>SHOW INNODB STATUS</CODE> and the <CODE>InnoDB</CODE> Monitors</A></H3>

<P>
Starting from MySQL 3.23.42, <CODE>InnoDB</CODE> includes <CODE>InnoDB</CODE> Monitors
that print information about the <CODE>InnoDB</CODE> internal state.  Starting from
MySQL 3.23.52 and 4.0.3, you can use the SQL statement <CODE>SHOW INNODB
STATUS</CODE> to fetch the output of the standard <CODE>InnoDB</CODE> Monitor to your
SQL client.  The information is useful in performance tuning. If you are
using the <CODE>mysql</CODE> interactive SQL client, the output is more readable
if you replace the usual semicolon statement terminator by <CODE>\G</CODE>:

</P>

<PRE>
mysql&#62; SHOW INNODB STATUS\G
</PRE>

<P>
Another way to use <CODE>InnoDB</CODE> Monitors is to let them continuously write
data to the standard output of the server <CODE>mysqld</CODE>.  In this case,
no output is sent to clients.  When switched on, <CODE>InnoDB</CODE> Monitors
print data about every 15 seconds. Server output usually is directed
to the <TT>`.err'</TT> log in the MySQL data directory.  This data is useful in
performance tuning.  On Windows, you must start the server from a command
prompt in a console window with the <CODE>--console</CODE> option if you want
to direct the output to the window rather than to the error log.

</P>
<P>
Monitor output includes information of the following types:

</P>

<UL>
<LI>Table and record locks held by each active transaction

<LI>Lock waits of a transactions

<LI>Semaphore waits of threads

<LI>Pending file I/O requests

<LI>Buffer pool statistics

<LI>Purge and insert buffer merge activity of the main <CODE>InnoDB</CODE> thread

</UL>

<P>
To cause the standard <CODE>InnoDB</CODE> Monitor to write to the standard
output of <CODE>mysqld</CODE>, use the following SQL statement:

</P>

<PRE>
CREATE TABLE innodb_monitor(a INT) TYPE=InnoDB;
</PRE>

<P>
The monitor can be stopped by issuing the following statement:

</P>

<PRE>
DROP TABLE innodb_monitor;
</PRE>

<P>
The <CODE>CREATE TABLE</CODE> syntax is just a way to pass a command
to the <CODE>InnoDB</CODE> engine through the MySQL SQL parser: The only things
that matter are the table name <CODE>innodb_monitor</CODE> and that it be an
<CODE>InnoDB</CODE> table. The structure of the
table is not relevant at all for the <CODE>InnoDB</CODE> Monitor. If you shut down
the database when the monitor is running, and you want to start
the monitor again, you have to drop the
table before you can issue a new <CODE>CREATE TABLE</CODE>
statement to start the monitor.
This syntax may change in a future release.

</P>
<P>
In a similar way, you can start <CODE>innodb_lock_monitor</CODE>, which is
otherwise the same as <CODE>innodb_monitor</CODE> but also prints a
lot of lock information. A separate <CODE>innodb_tablespace_monitor</CODE>
prints a list of created file segments existing in the tablespace
and also validates the tablespace allocation data structures.
Starting from 3.23.44, there is <CODE>innodb_table_monitor</CODE> with which
you can print the contents of the <CODE>InnoDB</CODE> internal data dictionary.

</P>
<P>
A sample of <CODE>InnoDB</CODE> Monitor output:

</P>

<PRE>
mysql&#62; SHOW INNODB STATUS\G
*************************** 1. row ***************************
Status:
=====================================
030709 13:00:59 INNODB MONITOR OUTPUT
=====================================
Per second averages calculated from the last 18 seconds
----------
SEMAPHORES
----------
OS WAIT ARRAY INFO: reservation count 413452, signal count 378357
--Thread 32782 has waited at btr0sea.c line 1477 for 0.00 seconds the semaphore:
X-lock on RW-latch at 41a28668 created in file btr0sea.c line 135
a writer (thread id 32782) has reserved it in mode wait exclusive
number of readers 1, waiters flag 1
Last time read locked in file btr0sea.c line 731
Last time write locked in file btr0sea.c line 1347
Mutex spin waits 0, rounds 0, OS waits 0
RW-shared spins 108462, OS waits 37964; RW-excl spins 681824, OS waits 375485
------------------------
LATEST FOREIGN KEY ERROR
------------------------
030709 13:00:59 Transaction:
TRANSACTION 0 290328284, ACTIVE 0 sec, process no 3195, OS thread id 34831 inser
ting
15 lock struct(s), heap size 2496, undo log entries 9
MySQL thread id 25, query id 4668733 localhost heikki update
insert into ibtest11a (D, B, C) values (5, 'khDk' ,'khDk')
Foreign key constraint fails for table test/ibtest11a:
,
  CONSTRAINT `0_219242` FOREIGN KEY (`A`, `D`) REFERENCES `ibtest11b` (`A`, `D`)
 ON DELETE CASCADE ON UPDATE CASCADE
Trying to add in child table, in index PRIMARY tuple:
 0: len 4; hex 80000101; asc ....;; 1: len 4; hex 80000005; asc ....;; 2: len 4;
 hex 6b68446b; asc khDk;; 3: len 6; hex 0000114e0edc; asc ...N..;; 4: len 7; hex
 00000000c3e0a7; asc .......;; 5: len 4; hex 6b68446b; asc khDk;;
But in parent table test/ibtest11b, in index PRIMARY,
the closest match we can find is record:
RECORD: info bits 0 0: len 4; hex 8000015b; asc ...[;; 1: len 4; hex 80000005; a
sc ....;; 2: len 3; hex 6b6864; asc khd;; 3: len 6; hex 0000111ef3eb; asc ......
;; 4: len 7; hex 800001001e0084; asc .......;; 5: len 3; hex 6b6864; asc khd;;
------------------------
LATEST DETECTED DEADLOCK
------------------------
030709 12:59:58
*** (1) TRANSACTION:
TRANSACTION 0 290252780, ACTIVE 1 sec, process no 3185, OS thread id 30733 inser
ting
LOCK WAIT 3 lock struct(s), heap size 320, undo log entries 146
MySQL thread id 21, query id 4553379 localhost heikki update
INSERT INTO alex1 VALUES(86, 86, 794,'aA35818','bb','c79166','d4766t','e187358f'
,'g84586','h794',date_format('2001-04-03 12:54:22','%Y-%m-%d %H:%i'),7
*** (1) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 0 page no 48310 n bits 568 table test/alex1 index symbole
trx id 0 290252780 lock mode S waiting
Record lock, heap no 324 RECORD: info bits 0 0: len 7; hex 61613335383138; asc a
a35818;; 1:
*** (2) TRANSACTION:
TRANSACTION 0 290251546, ACTIVE 2 sec, process no 3190, OS thread id 32782 inser
ting
130 lock struct(s), heap size 11584, undo log entries 437
MySQL thread id 23, query id 4554396 localhost heikki update
REPLACE INTO alex1 VALUES(NULL, 32, NULL,'aa3572','','c3572','d6012t','', NULL,'
h396', NULL, NULL, 7.31,7.31,7.31,200)
*** (2) HOLDS THE LOCK(S):
RECORD LOCKS space id 0 page no 48310 n bits 568 table test/alex1 index symbole
trx id 0 290251546 lock_mode X locks rec but not gap
Record lock, heap no 324 RECORD: info bits 0 0: len 7; hex 61613335383138; asc a
a35818;; 1:
*** (2) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 0 page no 48310 n bits 568 table test/alex1 index symbole
trx id 0 290251546 lock_mode X locks gap before rec insert intention waiting
Record lock, heap no 82 RECORD: info bits 0 0: len 7; hex 61613335373230; asc aa
35720;; 1:
*** WE ROLL BACK TRANSACTION (1)
------------
TRANSACTIONS
------------
Trx id counter 0 290328385
Purge done for trx's n:o &#60; 0 290315608 undo n:o &#60; 0 17
Total number of lock structs in row lock hash table 70
LIST OF TRANSACTIONS FOR EACH SESSION:
---TRANSACTION 0 0, not started, process no 3491, OS thread id 42002
MySQL thread id 32, query id 4668737 localhost heikki
show innodb status
---TRANSACTION 0 290328384, ACTIVE 0 sec, process no 3205, OS thread id 38929 in
serting
1 lock struct(s), heap size 320
MySQL thread id 29, query id 4668736 localhost heikki update
insert into speedc values (1519229,1, 'hgjhjgghggjgjgjgjgjggjgjgjgjgjgggjgjgjlhh
gghggggghhjhghgggggghjhghghghghghhhhghghghjhhjghjghjkghjghjghjghjfhjfh
---TRANSACTION 0 290328383, ACTIVE 0 sec, process no 3180, OS thread id 28684 co
mmitting
1 lock struct(s), heap size 320, undo log entries 1
MySQL thread id 19, query id 4668734 localhost heikki update
insert into speedcm values (1603393,1, 'hgjhjgghggjgjgjgjgjggjgjgjgjgjgggjgjgjlh
hgghggggghhjhghgggggghjhghghghghghhhhghghghjhhjghjghjkghjghjghjghjfhjf
---TRANSACTION 0 290328327, ACTIVE 0 sec, process no 3200, OS thread id 36880 st
arting index read
LOCK WAIT 2 lock struct(s), heap size 320
MySQL thread id 27, query id 4668644 localhost heikki Searching rows for update
update ibtest11a set B = 'kHdkkkk' where A = 89572
------- TRX HAS BEEN WAITING 0 SEC FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 0 page no 65556 n bits 232 table test/ibtest11a index PRIM
ARY trx id 0 290328327 lock_mode X waiting
Record lock, heap no 1 RECORD: info bits 0 0: len 9; hex 73757072656d756d00; asc
 supremum.;;
------------------
---TRANSACTION 0 290328284, ACTIVE 0 sec, process no 3195, OS thread id 34831 ro
llback of SQL statement
ROLLING BACK 14 lock struct(s), heap size 2496, undo log entries 9
MySQL thread id 25, query id 4668733 localhost heikki update
insert into ibtest11a (D, B, C) values (5, 'khDk' ,'khDk')
---TRANSACTION 0 290327208, ACTIVE 1 sec, process no 3190, OS thread id 32782
58 lock struct(s), heap size 5504, undo log entries 159
MySQL thread id 23, query id 4668732 localhost heikki update
REPLACE INTO alex1 VALUES(86, 46, 538,'aa95666','bb','c95666','d9486t','e200498f
','g86814','h538',date_format('2001-04-03 12:54:22','%Y-%m-%d %H:%i'),
---TRANSACTION 0 290323325, ACTIVE 3 sec, process no 3185, OS thread id 30733 in
serting
4 lock struct(s), heap size 1024, undo log entries 165
MySQL thread id 21, query id 4668735 localhost heikki update
INSERT INTO alex1 VALUES(NULL, 49, NULL,'aa42837','','c56319','d1719t','', NULL,
'h321', NULL, NULL, 7.31,7.31,7.31,200)
--------
FILE I/O
--------
I/O thread 0 state: waiting for i/o request (insert buffer thread)
I/O thread 1 state: waiting for i/o request (log thread)
I/O thread 2 state: waiting for i/o request (read thread)
I/O thread 3 state: waiting for i/o request (write thread)
Pending normal aio reads: 0, aio writes: 0,
 ibuf aio reads: 0, log i/o's: 0, sync i/o's: 0
Pending flushes (fsync) log: 0; buffer pool: 0
151671 OS file reads, 94747 OS file writes, 8750 OS fsyncs
25.44 reads/s, 18494 avg bytes/read, 17.55 writes/s, 2.33 fsyncs/s
-------------------------------------
INSERT BUFFER AND ADAPTIVE HASH INDEX
-------------------------------------
Ibuf for space 0: size 1, free list len 19, seg size 21,
85004 inserts, 85004 merged recs, 26669 merges
Hash table size 207619, used cells 14461, node heap has 16 buffer(s)
1877.67 hash searches/s, 5121.10 non-hash searches/s
---
LOG
---
Log sequence number 18 1212842764
Log flushed up to   18 1212665295
Last checkpoint at  18 1135877290
0 pending log writes, 0 pending chkp writes
4341 log i/o's done, 1.22 log i/o's/second
----------------------
BUFFER POOL AND MEMORY
----------------------
Total memory allocated 84966343; in additional pool allocated 1402624
Buffer pool size   3200
Free buffers       110
Database pages     3074
Modified db pages  2674
Pending reads 0
Pending writes: LRU 0, flush list 0, single page 0
Pages read 171380, created 51968, written 194688
28.72 reads/s, 20.72 creates/s, 47.55 writes/s
Buffer pool hit rate 999 / 1000
--------------
ROW OPERATIONS
--------------
0 queries inside InnoDB, 0 queries in queue
Main thread process no. 3004, id 7176, state: purging
Number of rows inserted 3738558, updated 127415, deleted 33707, read 755779
1586.13 inserts/s, 50.89 updates/s, 28.44 deletes/s, 107.88 reads/s
----------------------------
END OF INNODB MONITOR OUTPUT
============================
1 row in set (0.05 sec)
</PRE>

<P>
Some notes on the output:

</P>

<UL>
<LI>

If the <CODE>TRANSACTIONS</CODE> section reports lock waits, your
application may have lock contention. The output can also help to
trace the reasons for transaction deadlocks.

<LI>

The <CODE>SEMAPHORES</CODE> section reports threads waiting for a semaphore and
statistics on how many times threads have needed a spin or a wait on a
mutex or a rw-lock semaphore. A large number of threads waiting for
semaphores may be a result of disk I/O, or contention problems inside
<CODE>InnoDB</CODE>. Contention can be due to heavy parallelism of queries, or
problems in operating system thread scheduling. Setting
<CODE>innodb_thread_concurrency</CODE> smaller than the default value of <CODE>8</CODE> can
help in such situations.

<LI>

The <CODE>BUFFER POOL AND MEMORY</CODE> section gives you statistics on pages
read and written. You can calculate from these numbers how many data
file I/O operations your queries currently are doing.

<LI>

The <CODE>ROW OPERATIONS</CODE> section shows what the main thread is doing.

</UL>



<H2><A NAME="Implementation" HREF="manual_toc.html#Implementation">16.13  Implementation of Multi-Versioning</A></H2>

<P>
Because <CODE>InnoDB</CODE> is a multi-versioned database, it must keep information
about old versions of rows in the tablespace. This information is stored
in a data structure called a rollback segment after an analogous
data structure in Oracle.

</P>
<P>
Internally, <CODE>InnoDB</CODE> adds two fields to each row stored in the database.
A 6-byte field indicates the transaction identifier for the last
transaction that inserted or updated the row. Also, a deletion
is treated internally as an update where a special bit in the row
is set to mark it as deleted. Each row also contains a 7-byte
field called the roll pointer. The roll pointer points to an
undo log record written to the rollback segment. If the row was
updated, the undo log record contains the information necessary
to rebuild the content of the row before it was updated.

</P>
<P>
<CODE>InnoDB</CODE> uses the information in the rollback segment to perform the
undo operations needed in a transaction rollback. It also uses the
information to build earlier versions of a row for a consistent
read.

</P>
<P>
Undo logs in the rollback segment are divided into insert and update
undo logs. Insert undo logs are needed only in transaction rollback
and can be discarded as soon as the transaction commits. Update undo logs
are used also in consistent reads, and they can be discarded only after
there is no transaction present for which <CODE>InnoDB</CODE> has assigned
a snapshot that in a consistent read could need the information
in the update undo log to build an earlier version of a database
row.

</P>
<P>
You must remember to commit your transactions regularly, including those
transactions that only issue consistent reads.  Otherwise, <CODE>InnoDB</CODE>
cannot discard data from the update undo logs, and the rollback segment
may grow too big, filling up your tablespace.

</P>
<P>
The physical size of an undo log record in the rollback segment
is typically smaller than the corresponding inserted or updated
row. You can use this information to calculate the space need
for your rollback segment.

</P>
<P>
In the <CODE>InnoDB</CODE> multi-versioning scheme, a row is not physically removed from
the database immediately when you delete it with an SQL statement.
Only when <CODE>InnoDB</CODE> can discard the update undo log record written for
the deletion can it also physically remove the corresponding row and
its index records from the database. This removal operation is
called a purge, and it is quite fast, usually taking the same order of
time as the SQL statement that did the deletion.

</P>



<H2><A NAME="Table_and_index" HREF="manual_toc.html#Table_and_index">16.14  Table and Index Structures</A></H2>

<P>
MySQL stores its data dictionary information for tables in <TT>`.frm'</TT>
files in database directories. This is true for all MySQL storage engines.
But every <CODE>InnoDB</CODE> table
also has its own entry in <CODE>InnoDB</CODE> internal data dictionaries
inside the tablespace. When MySQL drops a table or a database,
it has to delete both an <TT>`.frm'</TT> file or files, and
the corresponding entries inside the <CODE>InnoDB</CODE> data dictionary.
This is the reason why you cannot move <CODE>InnoDB</CODE> tables between
databases simply by moving the <TT>`.frm'</TT> files. It is also the reason why
<CODE>DROP DATABASE</CODE> did not work for <CODE>InnoDB</CODE> type tables
before MySQL 3.23.44.

</P>
<P>
Every <CODE>InnoDB</CODE> table has a special index called the clustered index
where the data of the rows is stored. If you define a
<CODE>PRIMARY KEY</CODE> on your table, the index of the primary key
will be the clustered index.

</P>
<P>
If you do not define a <CODE>PRIMARY KEY</CODE> for
your table, MySQL picks the first <CODE>UNIQUE</CODE> index that has only
<CODE>NOT NULL</CODE> columns as the primary key and
<CODE>InnoDB</CODE> uses it as the clustered index.
If there is no such index in the table,
<CODE>InnoDB</CODE> internally generates a clustered index
where the rows are ordered by the row ID that <CODE>InnoDB</CODE> assigns
to the rows in such a table. The row ID is a 6-byte field that
increases monotonically as new rows are inserted. Thus the rows
ordered by the row ID will be physically in the insertion order.

</P>
<P>
Accessing a row through the clustered index is fast because the row data
will be on the same page where the index search leads.  If a table is large,
the clustered index architecture often saves a disk I/O when compared to
the traditional solution.  (In many databases, the data is traditionally
stored on a different page from the index record.)

</P>
<P>
In <CODE>InnoDB</CODE>, the records in non-clustered indexes (also called secondary
indexes) contain the primary key value for the row. <CODE>InnoDB</CODE> uses
this primary key value to search for the row from the clustered index. Note
that if the primary key is long, the secondary indexes use more space.

</P>
<P>
<CODE>InnoDB</CODE> compares <CODE>CHAR</CODE> and <CODE>VARCHAR</CODE> strings
of different lengths such that the remaining length in the shorter
string is treated as if padded with spaces.

</P>



<H3><A NAME="InnoDB_physical_structure" HREF="manual_toc.html#InnoDB_physical_structure">16.14.1  Physical Structure of an Index</A></H3>

<P>
All indexes in <CODE>InnoDB</CODE> are B-trees where the index records are
stored in the leaf pages of the tree. The default size of an index
page is 16KB. When new records are inserted, <CODE>InnoDB</CODE> tries to
leave 1/16 of the page free for future insertions and updates
of the index records.

</P>
<P>
If index records are inserted in a sequential order (ascending or descending),
the resulting index pages will be about 15/16 full.
If records are inserted in a random order, the pages will be from
1/2 to 15/16 full. If the fillfactor of an index page drops below 1/2,
<CODE>InnoDB</CODE> tries to contract the index tree to free the page.

</P>



<H3><A NAME="InnoDB_Insert_buffering" HREF="manual_toc.html#InnoDB_Insert_buffering">16.14.2  Insert Buffering</A></H3>

<P>
It is a common situation in a database application that the
primary key is a unique identifier and new rows are inserted in the
ascending order of the primary key. Thus the insertions to the
clustered index do not require random reads from a disk.

</P>
<P>
On the other hand, secondary indexes are usually non-unique, and insertions
into secondary indexes happen in a relatively random order.  This would
cause a lot of random disk I/O operations without a special mechanism used
in <CODE>InnoDB</CODE>.

</P>
<P>
If an index record should be inserted to a non-unique secondary index,
<CODE>InnoDB</CODE> checks whether the secondary index page is already in the buffer
pool. If that is the case, <CODE>InnoDB</CODE> does the insertion directly to
the index page. If the index page is not found in the buffer
pool, <CODE>InnoDB</CODE> inserts the record to a special insert buffer structure.
The insert buffer is kept so small that it fits entirely in the buffer
pool, and insertions can be done very fast.

</P>
<P>
Periodically, the insert buffer is merged into the secondary index trees in
the database. Often it is possible to merge several insertions to the same
page of the index tree, saving disk I/O operations.  It has been measured
that the insert buffer can speed up insertions into a table up to 15 times.

</P>



<H3><A NAME="InnoDB_Adaptive_hash" HREF="manual_toc.html#InnoDB_Adaptive_hash">16.14.3  Adaptive Hash Indexes</A></H3>

<P>
If a table fits almost entirely in main memory, the fastest way
to perform queries on it is to use hash indexes. <CODE>InnoDB</CODE> has an
automatic mechanism that monitors index searches made to the indexes
defined for a table. If <CODE>InnoDB</CODE> notices that queries could
benefit from building a hash index, it does so automatically.

</P>
<P>
Note that the hash index is always built based on an existing
B-tree index on the table. <CODE>InnoDB</CODE> can build a hash index on a prefix
of any length of the key defined for the B-tree, depending on the
pattern of searches that <CODE>InnoDB</CODE> observes for the B-tree index.
A hash index can be partial: It is not required that the whole
B-tree index is cached in the buffer pool. <CODE>InnoDB</CODE> will build
hash indexes on demand for those pages of the index that are
often accessed.

</P>
<P>
In a sense, <CODE>InnoDB</CODE> adapts itself through the adaptive hash index mechanism
to ample main memory, coming closer to the architecture of main memory
databases.

</P>



<H3><A NAME="InnoDB_Physical_record" HREF="manual_toc.html#InnoDB_Physical_record">16.14.4  Physical Record Structure</A></H3>

<P>
Records in <CODE>InnoDB</CODE> tables have the following characteristics:

</P>

<UL>
<LI>

Each index record in <CODE>InnoDB</CODE> contains a header of six bytes. The header
is used to link consecutive records together, and also in row-level
locking.
<LI>

Records in the clustered index contain fields for all user-defined
columns. In addition, there is a six-byte field for the transaction ID
and a seven-byte field for the roll pointer.
<LI>

If no primary key was defined for a table, each clustered
index record also contains a six-byte row ID field.
<LI>

Each secondary index record contains also all the fields defined
for the clustered index key.
<LI>

A record contains also a pointer to each field of the record.
If the total length of the fields in a record is less than 128 bytes,
the pointer is one byte; otherwise, two bytes.
<LI>

Internally, <CODE>InnoDB</CODE> stores fixed-length character columns such as
<CODE>CHAR(10)</CODE> in a fixed-length format.
<CODE>InnoDB</CODE> truncates trailing spaces
from <CODE>VARCHAR</CODE> columns.
Note that MySQL may internally convert <CODE>CHAR</CODE> columns to
<CODE>VARCHAR</CODE>. See section <A HREF="manual.html#Silent_column_changes">14.2.5.1  Silent Column Specification Changes</A>.
<LI>

An SQL <CODE>NULL</CODE> value reserves zero bytes if stored in a variable length
column. In a fixed-length column, it reserves the fixed length of the column.
The motivation behind reserving the fixed space for <CODE>NULL</CODE> values
is that then an update of the column from <CODE>NULL</CODE> to a
non-<CODE>NULL</CODE> value can be done in place and does not cause
fragmentation of the index page.
</UL>



<H2><A NAME="File_space_management" HREF="manual_toc.html#File_space_management">16.15  File Space Management and Disk I/O</A></H2>



<H3><A NAME="InnoDB_Disk_I_O" HREF="manual_toc.html#InnoDB_Disk_I_O">16.15.1  Disk I/O</A></H3>

<P>
<CODE>InnoDB</CODE> uses simulated asynchronous disk I/O: <CODE>InnoDB</CODE> creates a number of
threads to take care of I/O operations, such as read-ahead.

</P>
<P>
There are two read-ahead heuristics in <CODE>InnoDB</CODE>:

</P>

<UL>
<LI>

In sequential read-ahead, if <CODE>InnoDB</CODE> notices that the access pattern to a
segment in the tablespace is sequential, it posts in
advance a batch of reads of database pages to the I/O system.
<LI>

In random read-ahead, if <CODE>InnoDB</CODE> notices that some area in a tablespace
seems to be in the process of being fully read into the buffer pool, it
posts the remaining reads to the I/O system.
</UL>

<P>
Starting from MySQL 3.23.40b, <CODE>InnoDB</CODE> uses a novel file flush technique
called doublewrite.
It adds safety to crash recovery after an operating system crash
or a power outage, and improves performance on most Unix flavors
by reducing the need for <CODE>fsync()</CODE> operations.

</P>
<P>
Doublewrite means that before writing pages to a data file, <CODE>InnoDB</CODE>
first writes them to a contiguous tablespace area called the
doublewrite buffer. Only after the write and the flush to the doublewrite
buffer has completed does <CODE>InnoDB</CODE> write the pages to their proper
positions in the data file. If the operating system crashes in the
middle of a page write, <CODE>InnoDB</CODE> later will find a good
copy of the page from the doublewrite buffer during recovery.

</P>



<H3><A NAME="InnoDB_Raw_Devices" HREF="manual_toc.html#InnoDB_Raw_Devices">16.15.2  Using Raw Devices for the Tablespace</A></H3>

<P>
Starting from MySQL 3.23.41, you can use raw disk partitions as tablespace
data files.
By using a raw disk, you can perform non-buffered I/O on Windows and on
some Unix systems without filesystem overhead, which might improve performance.

</P>
<P>
When you create a new data file, you must put the keyword <CODE>newraw</CODE>
immediately after the data file size in <CODE>innodb_data_file_path</CODE>.
The partition must be at least as large as the size that you specify.
Note that 1MB in <CODE>InnoDB</CODE> is 1024 * 1024 bytes, whereas 1MB usually
means 1,000,000 bytes in disk specifications.

</P>

<PRE>
[mysqld]
innodb_data_home_dir=
innodb_data_file_path=/dev/hdd1:3Gnewraw;/dev/hdd2:2Gnewraw
</PRE>

<P>
The next time you start the server, <CODE>InnoDB</CODE> notices the <CODE>newraw</CODE>
keyword and initializes the new partition. However, do not create or change
any <CODE>InnoDB</CODE> tables yet. Otherwise, when you next restart the server,
<CODE>InnoDB</CODE> will reinitialize the partition and your changes will be lost.
(Starting from 3.23.44, as a safety measure <CODE>InnoDB</CODE> prevents users from
modifying data when any partition with <CODE>newraw</CODE> is specified.)

</P>
<P>
After <CODE>InnoDB</CODE> has initialized the new partition, stop the server, change
<CODE>newraw</CODE> in the data file specification to <CODE>raw</CODE>:

</P>

<PRE>
[mysqld]
innodb_data_home_dir=
innodb_data_file_path=/dev/hdd1:5Graw;/dev/hdd2:2Graw
</PRE>

<P>
Then restart the server and <CODE>InnoDB</CODE> will allow changes to be made.

</P>
<P>
On Windows, starting from 4.1.1, you can allocate a disk partition
as a data file like this:

</P>

<PRE>
[mysqld]
innodb_data_home_dir=
innodb_data_file_path=//./D::10Gnewraw
</PRE>

<P>
The
<TT>`//./'</TT>
corresponds to the Windows syntax of
<TT>`\\.\'</TT>
for accessing physical drives.

</P>
<P>
When you use raw disk partitions, be sure that they have permissions that
allow read and write access by the account used for running the MySQL
server.

</P>



<H3><A NAME="InnoDB_File_space" HREF="manual_toc.html#InnoDB_File_space">16.15.3  File Space Management</A></H3>

<P>
The data files you define in the configuration file form the tablespace of
<CODE>InnoDB</CODE>. The files are simply concatenated to form the tablespace.
There is no striping in use.  Currently you cannot define where in the
tablespace your tables will be allocated. However, in a newly created
tablespace, <CODE>InnoDB</CODE> allocates space starting from the first
data file.

</P>
<P>
The tablespace consists of database pages with a default size of 16KB.
The pages are grouped into extents of 64 consecutive pages. The ``files''
inside a tablespace are called segments in <CODE>InnoDB</CODE>.
The name of the ``rollback segment'' is somewhat confusing because it
actually contains many segments in the tablespace.

</P>
<P>
Two segments are allocated for each index in <CODE>InnoDB</CODE>.  One is for
non-leaf nodes of the B-tree, the other is for the leaf nodes. The idea
here is to achieve better sequentiality for the leaf nodes, which contain
the data.

</P>
<P>
When a segment grows inside the tablespace, <CODE>InnoDB</CODE> allocates the
first 32 pages to it individually. After that <CODE>InnoDB</CODE> starts
to allocate whole extents to the segment.
<CODE>InnoDB</CODE> can add to a large segment up to 4 extents at a time to ensure
good sequentiality of data.

</P>
<P>
Some pages in the tablespace contain bitmaps of other pages, and
therefore a few extents in an <CODE>InnoDB</CODE> tablespace cannot be
allocated to segments as a whole, but only as individual pages.

</P>
<P>
When you ask for available free space in the tablespace by issuing
a <CODE>SHOW TABLE STATUS</CODE>, <CODE>InnoDB</CODE>
reports the extents that are definitely free in the tablespace.
<CODE>InnoDB</CODE> always reserves some extents for clean-up and other internal
purposes; these reserved extents are not included in the free space.

</P>
<P>
When you delete data from a table, <CODE>InnoDB</CODE> will contract the corresponding
B-tree indexes. It depends on the pattern of deletes whether that frees
individual pages or extents to the tablespace, so that the freed
space becomes available for other users. Dropping a table or deleting
all rows from it is guaranteed to release the space to other users,
but remember that deleted rows will be physically removed only in an
(automatic) purge operation after they are no longer needed in
transaction rollback or consistent read.

</P>



<H3><A NAME="InnoDB_File_Defragmenting" HREF="manual_toc.html#InnoDB_File_Defragmenting">16.15.4  Defragmenting a Table</A></H3>

<P>
If there are random insertions into or deletions from
the indexes of a table, the indexes
may become fragmented. Fragmentation means that the physical ordering
of the index pages on the disk is not close to the index ordering
of the records on the pages, or that there are many unused pages in the
64-page blocks that were allocated to the index.

</P>
<P>
It can speed up index scans if you periodically perform a ``null''
<CODE>ALTER TABLE</CODE> operation:

</P>

<PRE>
ALTER TABLE tbl_name TYPE=InnoDB
</PRE>

<P>
That causes MySQL to rebuild the table. Another way to perform a
defragmention operation is to use <CODE>mysqldump</CODE> to dump the table to a text
file, drop the table, and reload it from the dump file.

</P>
<P>
If the insertions to an index are always ascending and records are deleted
only from the end, the <CODE>InnoDB</CODE> file space management algorithm
guarantees that fragmentation in the index will not occur.

</P>


<H2><A NAME="InnoDB_Error_handling" HREF="manual_toc.html#InnoDB_Error_handling">16.16  Error Handling</A></H2>

<P>
Error handling in <CODE>InnoDB</CODE> is not always the same as specified in the
SQL standard. According to the standard, any error during an SQL statement
should cause the rollback of that statement. <CODE>InnoDB</CODE> sometimes rolls
back only part of the statement, or the whole transaction.  The following
items describe how <CODE>InnoDB</CODE> performs error handling:

</P>

<UL>
<LI>

If you run out of file space in the tablespace,
you will get the MySQL <CODE>Table is full</CODE> error
and <CODE>InnoDB</CODE> rolls back the SQL statement.
<LI>

A transaction deadlock or a timeout in a lock wait causes <CODE>InnoDB</CODE>
to roll back the whole transaction.
<LI>

A duplicate-key error rolls back only the insert of that particular row,
even in a statement like <CODE>INSERT INTO ... SELECT</CODE>.
This will probably change so that the SQL statement will be rolled
back if you have not specified the <CODE>IGNORE</CODE> option in your
statement.
<LI>

A ``row too long'' error rolls back the SQL statement.
<LI>

Other errors are mostly detected by the MySQL layer of code (above the
<CODE>InnoDB</CODE> storage engine level), and
they roll back the corresponding SQL statement.
</UL>



<H3><A NAME="InnoDB_error_codes" HREF="manual_toc.html#InnoDB_error_codes">16.16.1  <CODE>InnoDB</CODE> Error Codes</A></H3>

<P>
The following is a non-exhaustive list of common
<CODE>InnoDB</CODE>-specific errors that you may encounter, with information
about why they occur and how to resolve the problem.

</P>
<DL COMPACT>

<DT><CODE>1005 (<CODE>ER_CANT_CREATE_TABLE</CODE>)</CODE>
<DD>
Cannot create table. If the error message string refers to
<CODE>errno</CODE> 150, table creation failed because a foreign key
constraint was not correctly formed.

<DT><CODE>1016 (<CODE>ER_CANT_OPEN_FILE</CODE>)</CODE>
<DD>
Cannot find the <CODE>InnoDB</CODE> table from the <CODE>InnoDB</CODE> data files though
the <TT>`.frm'</TT> file for the table exists.
See section <A HREF="manual.html#InnoDB_troubleshooting_datadict">16.18.1  Troubleshooting <CODE>InnoDB</CODE> Data Dictionary Operations</A>.

<DT><CODE>1114 (<CODE>ER_RECORD_FILE_FULL</CODE>)</CODE>
<DD>
<CODE>InnoDB</CODE> has run out of free space in the tablespace.
You should reconfigure the tablespace to add a new data file.

<DT><CODE>1205 (<CODE>ER_LOCK_WAIT_TIMEOUT</CODE>)</CODE>
<DD>
Lock wait timeout expired. Transaction was rolled back.

<DT><CODE>1213 (<CODE>ER_LOCK_DEADLOCK</CODE>)</CODE>
<DD>
Transaction deadlock. You should rerun the transaction.

<DT><CODE>1216 (<CODE>ER_NO_REFERENCED_ROW</CODE>)</CODE>
<DD>
You are trying to add a row but there is no parent row, and a
foreign key constraint fails. You should add the parent row first.

<DT><CODE>1217 (<CODE>ER_ROW_IS_REFERENCED</CODE>)</CODE>
<DD>
You are trying to delete a parent row that has children, and a
foreign key constraint fails. You should delete the children first.
</DL>



<H3><A NAME="Operating_System_error_codes" HREF="manual_toc.html#Operating_System_error_codes">16.16.2  Operating System Error Codes</A></H3>

<P>
In Unix, to print the meaning of an operating system error number,
use the <CODE>perror</CODE> program that comes with the MySQL distribution.

</P>
<P>
The following table provides a list of some common Linux system error codes.
For a more complete list, see
<a HREF="http://www.iglu.org.il/lxr/source/include/asm-i386/errno.h">Linux source code</a>.

</P>
<DL COMPACT>

<DT><CODE>1 (<CODE>EPERM</CODE>)</CODE>
<DD>
Operation not permitted
<DT><CODE>2 (<CODE>ENOENT</CODE>)</CODE>
<DD>
No such file or directory
<DT><CODE>3 (<CODE>ESRCH</CODE>)</CODE>
<DD>
No such process
<DT><CODE>4 (<CODE>EINTR</CODE>)</CODE>
<DD>
Interrupted system call
<DT><CODE>5 (<CODE>EIO</CODE>)</CODE>
<DD>
I/O error
<DT><CODE>6 (<CODE>ENXIO</CODE>)</CODE>
<DD>
No such device or address
<DT><CODE>7 (<CODE>E2BIG</CODE>)</CODE>
<DD>
Arg list too long
<DT><CODE>8 (<CODE>ENOEXEC</CODE>)</CODE>
<DD>
Exec format error
<DT><CODE>9 (<CODE>EBADF</CODE>)</CODE>
<DD>
Bad file number
<DT><CODE>10 (<CODE>ECHILD</CODE>)</CODE>
<DD>
No child processes
<DT><CODE>11 (<CODE>EAGAIN</CODE>)</CODE>
<DD>
Try again
<DT><CODE>12 (<CODE>ENOMEM</CODE>)</CODE>
<DD>
Out of memory
<DT><CODE>13 (<CODE>EACCES</CODE>)</CODE>
<DD>
Permission denied
<DT><CODE>14 (<CODE>EFAULT</CODE>)</CODE>
<DD>
Bad address
<DT><CODE>15 (<CODE>ENOTBLK</CODE>)</CODE>
<DD>
Block device required
<DT><CODE>16 (<CODE>EBUSY</CODE>)</CODE>
<DD>
Device or resource busy
<DT><CODE>17 (<CODE>EEXIST</CODE>)</CODE>
<DD>
File exists
<DT><CODE>18 (<CODE>EXDEV</CODE>)</CODE>
<DD>
Cross-device link
<DT><CODE>19 (<CODE>ENODEV</CODE>)</CODE>
<DD>
No such device
<DT><CODE>20 (<CODE>ENOTDIR</CODE>)</CODE>
<DD>
Not a directory
<DT><CODE>21 (<CODE>EISDIR</CODE>)</CODE>
<DD>
Is a directory
<DT><CODE>22 (<CODE>EINVAL</CODE>)</CODE>
<DD>
Invalid argument
<DT><CODE>23 (<CODE>ENFILE</CODE>)</CODE>
<DD>
File table overflow
<DT><CODE>24 (<CODE>EMFILE</CODE>)</CODE>
<DD>
Too many open files
<DT><CODE>25 (<CODE>ENOTTY</CODE>)</CODE>
<DD>
Inappropriate ioctl for device
<DT><CODE>26 (<CODE>ETXTBSY</CODE>)</CODE>
<DD>
Text file busy
<DT><CODE>27 (<CODE>EFBIG</CODE>)</CODE>
<DD>
File too large
<DT><CODE>28 (<CODE>ENOSPC</CODE>)</CODE>
<DD>
No space left on device
<DT><CODE>29 (<CODE>ESPIPE</CODE>)</CODE>
<DD>
Illegal seek
<DT><CODE>30 (<CODE>EROFS</CODE>)</CODE>
<DD>
Read-only file system
<DT><CODE>31 (<CODE>EMLINK</CODE>)</CODE>
<DD>
Too many links
</DL>

<P>
The following table provides a list of some common Windows system error codes.
For a complete list see the
<a HREF="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/debug/base/system_error_codes.asp">Microsoft website</a>.

</P>
<DL COMPACT>

<DT><CODE>1 (<CODE>ERROR_INVALID_FUNCTION</CODE>)</CODE>
<DD>
Incorrect function.
<DT><CODE>2 (<CODE>ERROR_FILE_NOT_FOUND</CODE>)</CODE>
<DD>
The system cannot find the file specified.
<DT><CODE>3 (<CODE>ERROR_PATH_NOT_FOUND</CODE>)</CODE>
<DD>
The system cannot find the path specified.
<DT><CODE>4 (<CODE>ERROR_TOO_MANY_OPEN_FILES</CODE>)</CODE>
<DD>
The system cannot open the file.
<DT><CODE>5 (<CODE>ERROR_ACCESS_DENIED</CODE>)</CODE>
<DD>
Access is denied.
<DT><CODE>6 (<CODE>ERROR_INVALID_HANDLE</CODE>)</CODE>
<DD>
The handle is invalid.
<DT><CODE>7 (<CODE>ERROR_ARENA_TRASHED</CODE>)</CODE>
<DD>
The storage control blocks were destroyed.
<DT><CODE>8 (<CODE>ERROR_NOT_ENOUGH_MEMORY</CODE>)</CODE>
<DD>
Not enough storage is available to process this command.
<DT><CODE>9 (<CODE>ERROR_INVALID_BLOCK</CODE>)</CODE>
<DD>
The storage control block address is invalid.
<DT><CODE>10 (<CODE>ERROR_BAD_ENVIRONMENT</CODE>)</CODE>
<DD>
The environment is incorrect.
<DT><CODE>11 (<CODE>ERROR_BAD_FORMAT</CODE>)</CODE>
<DD>
An attempt was made to load a program with an incorrect format.
<DT><CODE>12 (<CODE>ERROR_INVALID_ACCESS</CODE>)</CODE>
<DD>
The access code is invalid.
<DT><CODE>13 (<CODE>ERROR_INVALID_DATA</CODE>)</CODE>
<DD>
The data is invalid.
<DT><CODE>14 (<CODE>ERROR_OUTOFMEMORY</CODE>)</CODE>
<DD>
Not enough storage is available to complete this operation.
<DT><CODE>15 (<CODE>ERROR_INVALID_DRIVE</CODE>)</CODE>
<DD>
The system cannot find the drive specified.
<DT><CODE>16 (<CODE>ERROR_CURRENT_DIRECTORY</CODE>)</CODE>
<DD>
The directory cannot be removed.
<DT><CODE>17 (<CODE>ERROR_NOT_SAME_DEVICE</CODE>)</CODE>
<DD>
The system cannot move the file to a different disk drive.
<DT><CODE>18 (<CODE>ERROR_NO_MORE_FILES</CODE>)</CODE>
<DD>
There are no more files.
<DT><CODE>19 (<CODE>ERROR_WRITE_PROTECT</CODE>)</CODE>
<DD>
The media is write protected.
<DT><CODE>20 (<CODE>ERROR_BAD_UNIT</CODE>)</CODE>
<DD>
The system cannot find the device specified.
<DT><CODE>21 (<CODE>ERROR_NOT_READY</CODE>)</CODE>
<DD>
The device is not ready.
<DT><CODE>22 (<CODE>ERROR_BAD_COMMAND</CODE>)</CODE>
<DD>
The device does not recognize the command.
<DT><CODE>23 (<CODE>ERROR_CRC</CODE>)</CODE>
<DD>
Data error (cyclic redundancy check).
<DT><CODE>24 (<CODE>ERROR_BAD_LENGTH</CODE>)</CODE>
<DD>
The program issued a command but the command length is incorrect.
<DT><CODE>25 (<CODE>ERROR_SEEK</CODE>)</CODE>
<DD>
The drive cannot locate a specific area or track on the disk.
<DT><CODE>26 (<CODE>ERROR_NOT_DOS_DISK</CODE>)</CODE>
<DD>
The specified disk or diskette cannot be accessed.
<DT><CODE>27 (<CODE>ERROR_SECTOR_NOT_FOUND</CODE>)</CODE>
<DD>
The drive cannot find the sector requested.
<DT><CODE>28 (<CODE>ERROR_OUT_OF_PAPER</CODE>)</CODE>
<DD>
The printer is out of paper.
<DT><CODE>29 (<CODE>ERROR_WRITE_FAULT</CODE>)</CODE>
<DD>
The system cannot write to the specified device.
<DT><CODE>30 (<CODE>ERROR_READ_FAULT</CODE>)</CODE>
<DD>
The system cannot read from the specified device.
<DT><CODE>31 (<CODE>ERROR_GEN_FAILURE</CODE>)</CODE>
<DD>
A device attached to the system is not functioning.
<DT><CODE>32 (<CODE>ERROR_SHARING_VIOLATION</CODE>)</CODE>
<DD>
The process cannot access the file because it is being used by another process.
<DT><CODE>33 (<CODE>ERROR_LOCK_VIOLATION</CODE>)</CODE>
<DD>
The process cannot access the file because another process has locked a portion of the file.
<DT><CODE>34 (<CODE>ERROR_WRONG_DISK</CODE>)</CODE>
<DD>
The wrong diskette is in the drive. Insert %2 (Volume Serial Number: %3) into drive %1.
<DT><CODE>36 (<CODE>ERROR_SHARING_BUFFER_EXCEEDED</CODE>)</CODE>
<DD>
Too many files opened for sharing.
<DT><CODE>38 (<CODE>ERROR_HANDLE_EOF</CODE>)</CODE>
<DD>
Reached the end of the file.
<DT><CODE>39 (<CODE>ERROR_HANDLE_DISK_FULL</CODE>)</CODE>
<DD>
The disk is full.
<DT><CODE>112 (<CODE>ERROR_DISK_FULL</CODE>)</CODE>
<DD>
The disk is full.
<DT><CODE>123 (<CODE>ERROR_INVALID_NAME</CODE>)</CODE>
<DD>
The filename, directory name, or volume label syntax is incorrect.
<DT><CODE>1450 (<CODE>ERROR_NO_SYSTEM_RESOURCES</CODE>)</CODE>
<DD>
Insufficient system resources exist to complete the requested service.
</DL>



<H2><A NAME="InnoDB_restrictions" HREF="manual_toc.html#InnoDB_restrictions">16.17  Restrictions on <CODE>InnoDB</CODE> Tables</A></H2>


<UL>

<LI>

A table cannot contain more than 1000 columns.

<LI>

The maximum key length is 1024 bytes.

<LI>

The maximum row length, except for <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns,
is slightly less than half of a database page, that is, the maximum row
length is about 8000 bytes. <CODE>LONGBLOB</CODE> and <CODE>LONGTEXT</CODE> columns
must be less than 4GB, and the total row length, including also <CODE>BLOB</CODE>
and <CODE>TEXT</CODE> columns, must be less than 4GB.  <CODE>InnoDB</CODE> stores
the first 512 bytes of a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> column in the row,
and the rest into separate pages.

<LI>

On some operating systems, data files must be less than 2GB.

<LI>

The combined size of the <CODE>InnoDB</CODE> log files must be less than 4GB.

<LI>

The minimum tablespace size is 10MB.
The maximum tablespace size is four billion database pages (64TB).
This is also the maximum size for a table.

<LI>

<CODE>InnoDB</CODE> tables do not support <CODE>FULLTEXT</CODE> indexes.

<LI>

On Windows, <CODE>InnoDB</CODE> always stores database and table names
internally in lowercase. To move databases in binary format
from Unix to Windows or from Windows to Unix, you should have all database
and table names in lowercase.

<LI>

<STRONG>Warning:</STRONG> Do <EM>not</EM> convert MySQL system tables in the
<CODE>mysql</CODE> database from
<CODE>MyISAM</CODE> to <CODE>InnoDB</CODE> tables!  This is an unsupported operation.
If you do this, MySQL
will not restart until you restore the old system tables from a backup
or re-generate them with the <CODE>mysql_install_db</CODE> script.

<LI>

<CODE>InnoDB</CODE> does not keep an internal count of rows in a table. (This
would actually be somewhat complicated because of multi-versioning.)
To process a <CODE>SELECT COUNT(*) FROM T</CODE> statement, <CODE>InnoDB</CODE> must
scan an index of the table, which will take some time if the table
is not entirely in the buffer pool. To get a fast count, you have to
use a counter table you create yourself and let your application
update it according to the inserts and deletes it does. If your table
does not change often, using the MySQL query cache is a good
solution.
<CODE>SHOW TABLE STATUS</CODE> also can be used if an approximate row count is
sufficient.
See section <A HREF="manual.html#InnoDB_tuning">16.12  <CODE>InnoDB</CODE> Performance Tuning Tips</A>.

<LI>

For an <CODE>AUTO_INCREMENT</CODE> column, you must always define an index for
the table, and that index must contain just the <CODE>AUTO_INCREMENT</CODE>
column. In <CODE>MyISAM</CODE> tables, the <CODE>AUTO_INCREMENT</CODE> column may
be part of a multi-column index.

<LI>

<CODE>InnoDB</CODE> does not support the <CODE>AUTO_INCREMENT</CODE> table option for
setting the initial sequence value in a
<CODE>CREATE TABLE</CODE> or <CODE>ALTER TABLE</CODE> statement.
To set the value with <CODE>InnoDB</CODE>, insert a dummy row with a value
one less and delete that dummy row, or insert the first row with an
explicit value specified.

<LI>

When you restart the MySQL server, <CODE>InnoDB</CODE> may reuse an old
value for an <CODE>AUTO_INCREMENT</CODE> column (that is, a value that was
assigned to an old transaction that was rolled back).

<LI>

When an <CODE>AUTO_INCREMENT</CODE> column runs out of values, <CODE>InnoDB</CODE>
wraps a <CODE>BIGINT</CODE> to <CODE>-9223372036854775808</CODE> and <CODE>BIGINT
UNSIGNED</CODE> to <CODE>1</CODE>. However, <CODE>BIGINT</CODE> values have 64 bits, so do
note that if you were to insert one million rows per second, it would still
take about a million years before <CODE>BIGINT</CODE> reached its upper bound.
With all other integer type columns, a duplicate-key error will result.
This is similar to how <CODE>MyISAM</CODE> works, as it is mostly general MySQL
behavior and not about any storage engine in particular.

<LI>

<CODE>DELETE FROM tbl_name</CODE> does not regenerate the table but
instead deletes all rows, one by one.

<LI>

<CODE>TRUNCATE tbl_name</CODE> is mapped to <CODE>DELETE FROM tbl_name</CODE>
for <CODE>InnoDB</CODE> and doesn't reset the <CODE>AUTO_INCREMENT</CODE> counter.

<LI>

<CODE>SHOW TABLE STATUS</CODE> does not give accurate statistics
on <CODE>InnoDB</CODE> tables, except for the physical size reserved by the table.
The row count is only a rough estimate used in SQL optimization.

<LI>

If you try to create a unique index on a prefix of a column you will get an
error:


<PRE>
CREATE TABLE T (A CHAR(20), B INT, UNIQUE (A(5))) TYPE = InnoDB;
</PRE>

If you create a non-unique index on a prefix of a column, <CODE>InnoDB</CODE> will
create an index over the whole column.

These restrictions are removed starting from 4.0.14 and 4.1.1.

<LI>

<CODE>INSERT DELAYED</CODE> is not supported for <CODE>InnoDB</CODE> tables.

<LI>

The MySQL <CODE>LOCK TABLES</CODE> operation does not know about <CODE>InnoDB</CODE>
row-level locks set by already completed SQL statements. This means that
you can get a table lock on a table even if there still exist transactions
by other users who have row level locks on the same table. Thus
your operations on the table may have to wait if they collide with
these locks of other users. Also a deadlock is possible. However,
this does not endanger transaction integrity, because the row level
locks set by <CODE>InnoDB</CODE> will always take care of the integrity.
Also, a table lock prevents other transactions from acquiring more
row level locks (in a conflicting lock mode) on the table.

<LI>

Before MySQL 3.23.52,
replication always ran with autocommit enabled. Therefore
consistent reads in the slave would also see partially processed
transactions, and thus the read would not be really consistent in the
slave. This restriction was removed in MySQL 3.23.52.

<LI>

The <CODE>LOAD TABLE FROM MASTER</CODE> statement for setting up replication
slave servers does not yet work for <CODE>InnoDB</CODE> tables. A workaround
is to alter the table to <CODE>MyISAM</CODE> on the master, do then the load,
and after that alter the master table back to <CODE>InnoDB</CODE>.

<LI>

The default database page size in <CODE>InnoDB</CODE> is 16KB. By recompiling the
code, you can set it to values ranging from 8KB to 64KB.
You have to update the values of <CODE>UNIV_PAGE_SIZE</CODE> and
<CODE>UNIV_PAGE_SIZE_SHIFT</CODE> in the <TT>`univ.i'</TT> source file.

</UL>



<H2><A NAME="InnoDB_troubleshooting" HREF="manual_toc.html#InnoDB_troubleshooting">16.18  <CODE>InnoDB</CODE> Troubleshooting</A></H2>


<UL>
<LI>

A general rule is that when an operation fails or you suspect a bug,
you should look at the MySQL server error log, which
typically has a name something like <TT>`<VAR>hostname</VAR>.err'</TT>, or on
Windows <TT>`mysql.err'</TT>.

<LI>

When doing troubleshooting, it is usually best to run the MySQL server
from the command prompt, not through the
<CODE>mysqld_safe</CODE> wrapper or as a Windows service.
You will then see what <CODE>mysqld</CODE> prints to the command prompt
window, and you have a better grasp of what is going on.
On Windows, you must start the server with the <TT>`--console'</TT>
option to direct the output to the console window.

<LI>

Use the <CODE>InnoDB</CODE> Monitors to obtain information about a problem.
If the problem is performance-related, or your server appears to be
hung, you should use <CODE>innodb_monitor</CODE> to print information
about the internal state of <CODE>InnoDB</CODE>. If the problem is with locks, use
<CODE>innodb_lock_monitor</CODE>. If the problem is in creation of tables or
other data dictionary operations, use <CODE>innodb_table_monitor</CODE> to
print the contents of the <CODE>InnoDB</CODE> internal data dictionary.

<LI>

If you suspect a table is corrupt, run <CODE>CHECK TABLE</CODE> on that
table.
</UL>



<H3><A NAME="InnoDB_troubleshooting_datadict" HREF="manual_toc.html#InnoDB_troubleshooting_datadict">16.18.1  Troubleshooting <CODE>InnoDB</CODE> Data Dictionary Operations</A></H3>

<P>
A specific issue with tables is that the MySQL server keeps data
dictionary information in <TT>`.frm'</TT> files it stores in the database
directories, while <CODE>InnoDB</CODE> also stores the information into its own
data dictionary inside the tablespace files.
If you move <TT>`.frm'</TT> files around, or use <CODE>DROP DATABASE</CODE> in
MySQL versions before 3.23.44, or the server crashes in the middle of a
data dictionary operation, the <TT>`.frm'</TT> files may end up
out of sync with the <CODE>InnoDB</CODE> internal data dictionary.

</P>
<P>
A symptom of an out-of-sync data dictionary is that a <CODE>CREATE TABLE</CODE>
statement fails. If this occurs, you should look in the server's error
log. If the log says that the table already exists inside the <CODE>InnoDB</CODE>
internal data dictionary, you have an orphaned table inside the <CODE>InnoDB</CODE>
tablespace files that has no corresponding <TT>`.frm'</TT> file. The error message
looks like this:

</P>

<PRE>
InnoDB: Error: table test/parent already exists in InnoDB internal
InnoDB: data dictionary. Have you deleted the .frm file
InnoDB: and not used DROP TABLE? Have you used DROP DATABASE
InnoDB: for InnoDB tables in MySQL version &#60;= 3.23.43?
InnoDB: See the Restrictions section of the InnoDB manual.
InnoDB: You can drop the orphaned table inside InnoDB by
InnoDB: creating an InnoDB table with the same name in another
InnoDB: database and moving the .frm file to the current database.
InnoDB: Then MySQL thinks the table exists, and DROP TABLE will
InnoDB: succeed.
</PRE>

<P>
You can drop the orphaned table by following the instructions given in
the error message.

</P>
<P>
Another symptom of an out-of-sync data dictionary is that MySQL prints
an error that it cannot open an <TT>`.InnoDB'</TT> file:

</P>

<PRE>
ERROR 1016: Can't open file: 'child2.InnoDB'. (errno: 1)
</PRE>

<P>
In the error log you will find a message like this:

</P>

<PRE>
InnoDB: Cannot find table test/child2 from the internal data dictionary
InnoDB: of InnoDB though the .frm file for the table exists. Maybe you
InnoDB: have deleted and recreated InnoDB data files but have forgotten
InnoDB: to delete the corresponding .frm files of InnoDB tables?
</PRE>

<P>
This means that there is an orphaned <TT>`.frm'</TT> file without a
corresponding table inside <CODE>InnoDB</CODE>. You can drop the orphaned
<TT>`.frm'</TT> file by deleting it manually.

</P>
<P>
If MySQL crashes in the middle of an <CODE>ALTER TABLE</CODE> operation, you
may end up with an orphaned temporary table inside the <CODE>InnoDB</CODE>
tablespace. With <CODE>innodb_table_monitor</CODE> you see a table whose
name is <TT>`#sql...'</TT>, but since MySQL does not allow accessing any
table with such a name, you cannot dump or drop it. The solution is to
use a special mechanism available starting from MySQL 3.23.48.

</P>
<P>
When you have an orphaned table <TT>`#sql_id'</TT> inside the tablespace,
you can cause <CODE>InnoDB</CODE> to rename it to
<TT>`rsql_id_recover_innodb_tmp_table'</TT> with the following statement:

</P>

<PRE>
CREATE TABLE `rsql_id_recover_innodb_tmp_table`(...) TYPE=InnoDB;
</PRE>

<P>
The backticks around the table name are needed because a temporary
table name contains the character <SAMP>`-'</SAMP>.

</P>
<P>
The table definition must be similar to that of the temporary table. If
you do not know the definition of the temporary table, you can use an
arbitrary definition in the preceding <CODE>CREATE TABLE</CODE> statement, and
after that replace the file <TT>`rsql_id.frm'</TT> by the file <TT>`#sql_id.frm'</TT>
of the temporary table.  Note that to copy or rename a file in the shell,
you need to put the file name in double quotes if the file name contains
<SAMP>`#'</SAMP>. Then you can dump and drop the renamed table.

</P>



<H1><A NAME="MaxDB" HREF="manual_toc.html#MaxDB">17  Introduction to MaxDB</A></H1>

<P>
MaxDB is an enterprise-level database. MaxDB is the new name of a database management system formerly called SAP DB.

</P>



<H2><A NAME="MaxDB_History" HREF="manual_toc.html#MaxDB_History">17.1  History of MaxDB</A></H2>

<P>
The  history of SAP DB goes back to the early 1980s when it was
developed as a commercial product (Adabas). The database has changed
names several times since then. When SAP AG, a company based in Walldorf, Germany,
took over the development of that database system,
it was called SAP DB.

</P>
<P>
SAP developed that database system to serve as a storage system
for all heavy-duty SAP applications, namely R/3. SAP DB was meant
to provide an alternative to third-party database systems such as
Oracle, Microsoft SQL Server, and DB2 by IBM. In October 2000, SAP
AG released SAP DB under the GNU GPL license (see section <A HREF="manual.html#GPL_license">G  GNU General Public License</A>), 
thus making it open source software. In October 2003, more than 2,000 
customers of SAP AG were using SAP DB as their main database system, 
and more than another 2,000 customers were using it as a separate 
database system besides their main database, as part of the 
APO/LiveCache solution.

</P>
<P>
In May 2003, a technology partnership was formed between MySQL AB
and SAP AG. That partnership entitles MySQL AB to further develop SAP
DB, rename it, and sell commercial licenses of the renamed SAP DB
to customers who do not want to be bound to the restrictions imposed
on them when using that database system under the GNU GPL (see section <A HREF="manual.html#GPL_license">G  GNU General Public License</A>). In August 2003, SAP DB was renamed MaxDB by MySQL AB.

</P>


<H2><A NAME="MaxDB_Licensing" HREF="manual_toc.html#MaxDB_Licensing">17.2  Licensing and Support</A></H2>

<P>
MaxDB can be used under the same licenses available for the other
products distributed by MySQL AB (section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>). Thus,
MaxDB will be available under the GNU General Public License
(section <A HREF="manual.html#GPL_license">G  GNU General Public License</A>), and a commercial license (section <A HREF="manual.html#Licensing_and_Support">1.4  MySQL Support and Licensing</A>).

</P>
<P>
MySQL will offer MaxDB support to non-SAP customers.

</P>
<P>
The first rebranded version was MaxDB 7.5.00, which was
released in November 2003.

</P>



<H2><A NAME="MaxDB_Links" HREF="manual_toc.html#MaxDB_Links">17.3  MaxDB-Related Links</A></H2>

<P>
The main page for information about MaxDB is
<a HREF="http://www.mysql.com/maxdb">http://www.mysql.com/maxdb</a>. Information formerly
available at <a HREF="http://www.sapdb.org">http://www.sapdb.org</a> has been moved there.

</P>


<H2><A NAME="MaxDB_Basics" HREF="manual_toc.html#MaxDB_Basics">17.4  Basic Concepts of MaxDB</A></H2>

<P>
MaxDB operates as a client/server product. It was developed to meet
the demands of installations processing a high volume of online
transactions. Both online backup and expansion of the database are
supported. Microsoft Clustered Server is supported directly for
multiple server implementations; other failover solutions must be
scripted manually. Database management tools are provided in both
Windows and browser-based implementations.

</P>


<H2><A NAME="MaxDB-MySQL_Differences" HREF="manual_toc.html#MaxDB-MySQL_Differences">17.5  Feature Differences Between MaxDB and MySQL</A></H2>

<P>
The following list provides a short summary of the main differences
between MaxDB and MySQL; it is not complete.

</P>

<UL>
<LI>

MaxDB runs as a client/server system. MySQL can run as a client/server system
or as an embedded system.
<LI>

MaxDB might not run on all platforms supported by MySQL. For example,
MaxDB does not run on IBM's OS/2.
<LI>

MaxDB uses a proprietary network protocol for client/server
communication. MySQL uses either TCP/IP (with or without SSL
encryption), sockets (under Unix-like systems), or named pipes
(under Windows NT-family systems).
<LI>

MaxDB supports stored procedures. For MySQL, stored procedures are
implemented in version 5.0. MaxDB also supports programming of
triggers through an SQL extension, which is scheduled for MySQL
5.1. MaxDB contains a debugger for stored procedure languages,
can cascade nested triggers, and supports multiple triggers per
action and row.
<LI>

MaxDB is distributed with user interfaces that are text-based,
graphical, or Web-based. MySQL is distributed with text-based user
interfaces only; graphical user interface (MySQL Control Center, MySQL
Administrator)
are shipped separately from the main distributions. Web-based user
interfaces for MySQL are offered by third parties.
<LI>

MaxDB supports a number of programming interfaces that also are supported
by MySQL. However, MaxDB does not support RDO, ADO, or .NET, all of which are
supported by MySQL. MaxDB
supports embedded SQL only with C/C++.
<LI>

MaxDB includes administrative features that MySQL does not have:
job scheduling by time, event, and alert, and sending
messages to a database administrator on alert thresholds.
</UL>



<H2><A NAME="MaxDB-MySQL_Interoperability" HREF="manual_toc.html#MaxDB-MySQL_Interoperability">17.6  Interoperability Features Between MaxDB and MySQL</A></H2>

<P>
The following features will be included in MaxDB versions to be
released shortly after the first 7.5.00 version. These features
will allow interoperation between MaxDB and MySQL.

</P>

<UL>
<LI>

There will be a MySQL proxy enabling connections to MaxDB using
the MySQL protocol. This makes it possible to use MySQL client
programs for MaxDB, such as the <CODE>mysql</CODE> command-line user interface,
the <CODE>mysqldump</CODE> dump utility, or the <CODE>mysqlimport</CODE> import
program. Using <CODE>mysqldump</CODE>, you can easily dump data from one
database system and export (or even pipe) those data to the other
database system.
<LI>

Replication between MySQL and MaxDB will be supported in both
directions. That is, either MySQL or MaxDB can be used as the master
replication server. The long-range plan is to converge and extend the
replication syntax so that both database systems understand the same syntax.
See section <A HREF="manual.html#Replication_Intro">6.1  Introduction to Replication</A>.
</UL>



<H2><A NAME="MaxDB_Reserved_Words" HREF="manual_toc.html#MaxDB_Reserved_Words">17.7  Reserved Words in MaxDB</A></H2>

<P>
Like MySQL, MaxDB has a number of reserved words that have special meanings.
Normally, they cannot be used
as names of identifiers, such as database or table names. The following
table lists reserved words in MaxDB, indicates the context in which
those words are used, and indicates whether or not they have
counterparts in MySQL. If such a counterpart exists, the meaning
in MySQL might be identical or differing in some aspects. The main
purpose is to list in which respects MaxDB differs from MySQL;
therefore, this list is not complete.

</P>
<P>
For the list of reserved words in MySQL, see section <A HREF="manual.html#Reserved_words">10.6  Treatment of Reserved Words in MySQL</A>.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Reserved in MaxDB</STRONG>
 </TD><TD> <STRONG>Context of usage in MaxDB</STRONG>
 </TD><TD> <STRONG>MySQL counterpart</STRONG>
</TD></TR>
<TR><TD><CODE>@</CODE>
 </TD><TD> Can prefix identifier, like ``@table''
 </TD><TD> Not allowed
</TD></TR>
<TR><TD><CODE>ADDDATE()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>ADDDATE()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>ADDTIME()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>ADDTIME()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>ALPHA</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>ARRAY</CODE>
 </TD><TD> Data type
 </TD><TD> Not implemented
</TD></TR>
<TR><TD><CODE>ASCII()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>ASCII()</CODE>, but implemented with a different meaning
</TD></TR>
<TR><TD><CODE>AUTOCOMMIT</CODE>
 </TD><TD> Transactions; <CODE>ON</CODE> by default
 </TD><TD> Transactions; <CODE>OFF</CODE> by default
</TD></TR>
<TR><TD><CODE>BOOLEAN</CODE>
 </TD><TD> Column types; <CODE>BOOLEAN</CODE> accepts as values only <CODE>TRUE</CODE>, <CODE>FALSE</CODE>, and <CODE>NULL</CODE>
 </TD><TD> <CODE>BOOLEAN</CODE> was added in MySQL 4.1.0; it is a synonym for <CODE>BOOL</CODE> which is mapped to <CODE>TINYINT(1)</CODE>. It accepts integer values in the same range as <CODE>TINYINT</CODE> as well as <CODE>NULL</CODE>. <CODE>TRUE</CODE> and <CODE>FALSE</CODE> can be used as aliases for <CODE>1</CODE> and <CODE>0</CODE>.
</TD></TR>
<TR><TD><CODE>CHECK</CODE>
 </TD><TD> <CODE>CHECK TABLE</CODE>
 </TD><TD> <CODE>CHECK TABLE</CODE>; similar, but not identical usage
</TD></TR>
<TR><TD><CODE>COLUMN</CODE>
 </TD><TD> Column types
 </TD><TD> <CODE>COLUMN</CODE>; noise word
</TD></TR>
<TR><TD><CODE>CHAR()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>CHAR()</CODE>; identical syntax; similar, not identical usage
</TD></TR>
<TR><TD><CODE>COMMIT</CODE>
 </TD><TD> Implicit commits of transactions happen when data definition statements are issued
 </TD><TD> Implicit commits of transactions happen when data definition statements are issued, and also with a number of other statements
</TD></TR>
<TR><TD><CODE>COSH()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>COT()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>COT()</CODE>; identical syntax and implementation
</TD></TR>
<TR><TD><CODE>CREATE</CODE>
 </TD><TD> SQL, data definition language
 </TD><TD> <CODE>CREATE</CODE>
</TD></TR>
<TR><TD><CODE>DATABASE</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>DATABASE()</CODE>; <CODE>DATABASE</CODE> is used in a different context; for example, <CODE>CREATE DATABASE</CODE>
</TD></TR>
<TR><TD><CODE>DATE()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>CURRENT_DATE</CODE>
</TD></TR>
<TR><TD><CODE>DATEDIFF()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>DATEDIFF()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>DAY()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>DAYOFWEEK()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>DAYOFWEEK()</CODE>; by default, <CODE>1</CODE> represents Monday in MaxDB and Sunday in MySQL
</TD></TR>
<TR><TD><CODE>DISTINCT</CODE>
 </TD><TD> SQL functions <CODE>AVG</CODE>, <CODE>MAX</CODE>, <CODE>MIN</CODE>, <CODE>SUM</CODE>
 </TD><TD> <CODE>DISTINCT</CODE>; but used in a different context: <CODE>SELECT DISTINCT</CODE>
</TD></TR>
<TR><TD><CODE>DROP</CODE>
 </TD><TD> <CODE>DROP INDEX</CODE>, for example
 </TD><TD> <CODE>DROP INDEX</CODE>; similar, but not identical usage
</TD></TR>
<TR><TD><CODE>EBCDIC()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>EXPAND()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>EXPLAIN</CODE>
 </TD><TD> Optimization
 </TD><TD> <CODE>EXPLAIN</CODE>; similar, but not identical usage
</TD></TR>
<TR><TD><CODE>FIXED()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>FLOAT()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>HEX()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>HEX()</CODE>; similar, but not identical usage
</TD></TR>
<TR><TD><CODE>INDEX()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>INSTR()</CODE> or <CODE>LOCATE()</CODE>; similar, but not identical syntaxes and meanings
</TD></TR>
<TR><TD><CODE>INDEX</CODE>
 </TD><TD> <CODE>USE INDEX</CODE>, <CODE>IGNORE INDEX</CODE> and similar hints are used right after <CODE>SELECT</CODE>; for example, <CODE>SELECT ... USE INDEX</CODE>
 </TD><TD> <CODE>USE INDEX</CODE>, <CODE>IGNORE INDEX</CODE> and similar hints are used in the <CODE>FROM</CODE> clause of a <CODE>SELECT</CODE> query; for example, in <CODE>SELECT ... FROM ... USE INDEX</CODE>
</TD></TR>
<TR><TD><CODE>INITCAP()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>LENGTH()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>LENGTH()</CODE>; identical syntax, but slightly different implementation
</TD></TR>
<TR><TD><CODE>LFILL()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>LIKE</CODE>
 </TD><TD> Comparisons
 </TD><TD> <CODE>LIKE</CODE>; but the extended <CODE>LIKE</CODE> MaxDB provides rather resembles the MySQL <CODE>REGEX</CODE>
</TD></TR>
<TR><TD><CODE>LIKE</CODE> wildcards
 </TD><TD> MaxDB supports ``%'', ``_'', ``Control-underline'', ``Control-up arrow'', ``*'', and ``?'' as wildcards in <CODE>LIKE</CODE> comparisons
 </TD><TD> MySQL supports ``%'', and ``_'' as wildcards in <CODE>LIKE</CODE> comparisons
</TD></TR>
<TR><TD><CODE>LPAD()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>LPAD()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>LTRIM()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>LTRIM()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>MAKEDATE()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>MAKEDATE()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>MAKETIME()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>MAKETIME()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>MAPCHAR()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>MICROSECOND()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>MICROSECOND()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>NOROUND()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>NULL</CODE>
 </TD><TD> Column types; comparisons
 </TD><TD> <CODE>NULL</CODE>; MaxDB supports special <CODE>NULL</CODE> values that are returned by arithmetic operations that lead to an overflow or a division by zero; MySQL does not support such special values
</TD></TR>
<TR><TD><CODE>PI</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>PI()</CODE>; identical syntax and implementation, but parentheses are mandatory in MySQL
</TD></TR>
<TR><TD><CODE>REF</CODE>
 </TD><TD> Data type
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>RFILL()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>ROWNO</CODE>
 </TD><TD> Predicate in <CODE>WHERE</CODE> clause
 </TD><TD> Similar to <CODE>LIMIT</CODE> clause
</TD></TR>
<TR><TD><CODE>RPAD()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>RPAD()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>RTRIM()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>RTRIM()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>SEQUENCE</CODE>
 </TD><TD> <CODE>CREATE SEQUENCE</CODE>, <CODE>DROP SEQUENCE</CODE>
 </TD><TD> <CODE>AUTO_INCREMENT</CODE>; similar concept, but different implementation
</TD></TR>
<TR><TD><CODE>SINH()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>SOUNDS()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>SOUNDEX()</CODE>; slightly different syntax
</TD></TR>
<TR><TD><CODE>STATISTICS</CODE>
 </TD><TD> <CODE>UPDATE STATISTICS</CODE>
 </TD><TD> <CODE>ANALYZE TABLE</CODE>; similar concept, but different implementation
</TD></TR>
<TR><TD><CODE>SUBSTR()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>SUBSTRING()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>SUBTIME()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>SUBTIME()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>SYNONYM</CODE>
 </TD><TD> Data definition language: <CODE>CREATE [PUBLIC] SYNONYM</CODE>, <CODE>RENAME SYNONYM</CODE>, <CODE>DROP SYNONYM</CODE>
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>TANH()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>TIME()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>CURRENT_TIME</CODE>
</TD></TR>
<TR><TD><CODE>TIMEDIFF()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>TIMEDIFF()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>TIMESTAMP()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>TIMESTAMP()</CODE>; new in MySQL 4.1.1
</TD></TR>
<TR><TD><CODE>TIMESTAMP()</CODE> as argument to <CODE>DAYOFMONTH()</CODE> and <CODE>DAYOFYEAR()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>TIMEZONE()</CODE>
 </TD><TD> SQL function
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>TRANSACTION()</CODE>
 </TD><TD> Returns the ID of the current transaction
 </TD><TD> Nothing comparable
</TD></TR>
<TR><TD><CODE>TRANSLATE()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>REPLACE()</CODE>; identical syntax and implementation
</TD></TR>
<TR><TD><CODE>TRIM()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>TRIM()</CODE>; slightly different implementation
</TD></TR>
<TR><TD><CODE>TRUNC()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>TRUNCATE()</CODE>; slightly different syntax and implementation
</TD></TR>
<TR><TD><CODE>USE</CODE>
 </TD><TD> <CODE>mysql</CODE> command-line user interface command
 </TD><TD> <CODE>USE</CODE>
</TD></TR>
<TR><TD><CODE>USER</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>USER()</CODE>; identical syntax, but slightly different implementation, and parentheses are mandatory in MySQL
</TD></TR>
<TR><TD><CODE>UTC_DIFF()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>UTC_DATE()</CODE>; provides a means to calculate the same result as <CODE>UTC_DIFF()</CODE>
</TD></TR>
<TR><TD><CODE>VALUE()</CODE>
 </TD><TD> SQL function, alias for <CODE>COALESCE()</CODE>
 </TD><TD> <CODE>COALESCE()</CODE>; identical syntax and implementation
</TD></TR>
<TR><TD><CODE>VARIANCE()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>VARIANCE()</CODE>; new in MySQL 4.1.0
</TD></TR>
<TR><TD><CODE>WEEKOFYEAR()</CODE>
 </TD><TD> SQL function
 </TD><TD> <CODE>WEEKOFYEAR()</CODE>; new in MySQL 4.1.1
</TD></TR>
</TABLE>



<H1><A NAME="Spatial_extensions_in_MySQL" HREF="manual_toc.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A></H1>
<P>
<A NAME="IDX1872"></A>

</P>

<P>
MySQL 4.1 introduces spatial extensions to allow the
generation, storage, and analysis of geographic features.
Currently, these features are available for <CODE>MyISAM</CODE> tables only.

</P>
<P>
This chapter covers the following topics:

</P>

<UL>

<LI>

The basis of these spatial extensions in the OpenGIS geometry model

<LI>

Data formats for representing spatial data

<LI>

How to use spatial data in MySQL

<LI>

Use of indexing for spatial data

<LI>

MySQL differences from the OpenGIS specification

</UL>



<H2><A NAME="GIS_introduction" HREF="manual_toc.html#GIS_introduction">18.1  Introduction</A></H2>

<P>
<A NAME="IDX1873"></A>

</P>
<P>
<A NAME="IDX1874"></A>
<A NAME="IDX1875"></A>

</P>
<P>
MySQL implements spatial extensions following the specification of
the <CODE>Open GIS Consortium</CODE> (OGC). This is an international consortium
of more than 250 companies, agencies, and universities participating
in the development of publicly available conceptual solutions that can be
useful with all kinds of applications that manage spatial data.
The OGC maintains a Web site at <a HREF="http://www.opengis.org/">http://www.opengis.org/</a>.

</P>
<P>
In 1997, the Open GIS Consortium published the
<CITE>OpenGIS (R) Simple Features Specifications For SQL</CITE>, a document that
proposes several conceptual ways for extending an SQL RDBMS to support spatial
data. This specification is available from the Open GIS Web site at
http://www.opengis.org/docs/99-049.pdf.
It contains additional information relevant to this chapter.

</P>
<P>
MySQL implements a subset of the <STRONG>SQL with Geometry Types</STRONG>
environment proposed by OGC.
This term refers to an SQL environment that has been extended with a
set of geometry types. A geometry-valued SQL column is implemented as
a column that has a geometry type. The specifications describe a set of SQL
geometry types, as well as functions on those types to create and
analyze geometry values.

</P>
<P>
<A NAME="IDX1876"></A>

</P>
<P>
A <STRONG>geographic feature</STRONG> is anything in the world that has a location.
A feature can be:

</P>

<UL>
<LI>

An entity. For example, a mountain, a pond, a city.
<LI>

A space. For example, a postcode area, the tropics.
<LI>

A definable location. For example, a crossroad,
as a particular place where two streets intersect.
</UL>

<P>
<A NAME="IDX1877"></A>

</P>
<P>
You can also find documents that use the term <STRONG>geospatial feature</STRONG> to
refer to geographic features.

</P>
<P>
<A NAME="IDX1878"></A>

</P>
<P>
<STRONG>Geometry</STRONG> is another word that denotes a geographic feature.
Originally the word <STRONG>geometry</STRONG> meant measurement of the earth.
Another meaning comes from cartography, referring to the geometric
features that cartographers use to map the world.

</P>
<P>
This chapter uses all of these terms synonymously:
<STRONG>geographic feature</STRONG>, <STRONG>geospatial feature</STRONG>,
<STRONG>feature</STRONG>, or <STRONG>geometry</STRONG>.
The term most commonly used here is <STRONG>geometry</STRONG>.

</P>
<P>
Let's define a <STRONG>geometry</STRONG> as <EM>a point or an aggregate of
points representing anything in the world that has a location</EM>.

</P>



<H2><A NAME="OpenGIS_geometry_model" HREF="manual_toc.html#OpenGIS_geometry_model">18.2  The OpenGIS Geometry Model</A></H2>

<P>
The set of geometry types proposed by OGC's <STRONG>SQL with Geometry Types</STRONG>
environment is based on the <STRONG>OpenGIS Geometry Model</STRONG>. In this model,
each geometric object has the following general properties:

</P>

<UL>
<LI>

It is associated with a Spatial Reference System, which describes the
coordinate space in which the object is defined.
<LI>

It belongs to some geometry class.
</UL>



<H3><A NAME="GIS_geometry_class_hierarchy" HREF="manual_toc.html#GIS_geometry_class_hierarchy">18.2.1  The Geometry Class Hierarchy</A></H3>

<P>
The geometry classes define a hierarchy as follows:

</P>

<UL>
<LI><CODE>Geometry</CODE> (non-instantiable)


<UL>
<LI><CODE>Point</CODE> (instantiable)

<LI><CODE>Curve</CODE> (non-instantiable)


<UL>
<LI><CODE>LineString</CODE> (instantiable)


<UL>
<LI><CODE>Line</CODE>

<LI><CODE>LinearRing</CODE>

</UL>

</UL>

<LI><CODE>Surface</CODE> (non-instantiable)


<UL>
<LI><CODE>Polygon</CODE> (instantiable)

</UL>

<LI><CODE>GeometryCollection</CODE> (instantiable)


<UL>
<LI><CODE>MultiPoint</CODE> (instantiable)

<LI><CODE>MultiCurve</CODE> (non-instantiable)


<UL>
<LI><CODE>MultiLineString</CODE> (instantiable)

</UL>

<LI><CODE>MultiSurface</CODE> (non-instantiable)


<UL>
<LI><CODE>MultiPolygon</CODE> (instantiable)

</UL>

</UL>

</UL>

</UL>

<P>
It is not possible to create objects in non-instantiable classes.
It is possible to create objects in instantiable classes.
All classes have properties, and instantiable classes may also
have assertions (rules that define valid class instances).

</P>
<P>
<CODE>Geometry</CODE> is the base class. It's an abstract class.
The instantiable subclasses of <CODE>Geometry</CODE> are restricted to zero-, one-,
and two-dimensional geometric objects that exist in
two-dimensional coordinate space. All instantiable geometry classes are
defined so that valid instances of a geometry class are topologically closed
(that is, all defined geometries include their boundary).

</P>
<P>
The base <CODE>Geometry</CODE> class has subclasses for <CODE>Point</CODE>,
<CODE>Curve</CODE>, <CODE>Surface</CODE>, and <CODE>GeometryCollection</CODE>:

</P>

<UL>

<LI>

<CODE>Point</CODE> represents zero-dimensional objects.

<LI>

<CODE>Curve</CODE> represents one-dimensional objects, and has subclass
<CODE>LineString</CODE>, with sub-subclasses <CODE>Line</CODE> and <CODE>LinearRing</CODE>.

<LI>

<CODE>Surface</CODE> is designed for two-dimensional objects and
has subclass <CODE>Polygon</CODE>.

<LI>

<CODE>GeometryCollection</CODE>
has specialized zero-, one-, and two-dimensional collection classes named
<CODE>MultiPoint</CODE>, <CODE>MultiLineString</CODE>, and <CODE>MultiPolygon</CODE>
for modeling geometries corresponding to collections of
<CODE>Points</CODE>, <CODE>LineStrings</CODE>, and <CODE>Polygons</CODE>, respectively.
<CODE>MultiCurve</CODE> and <CODE>MultiSurface</CODE> are introduced as abstract superclasses
that generalize the collection interfaces to handle <CODE>Curves</CODE> and <CODE>Surfaces</CODE>.

</UL>

<P>
<CODE>Geometry</CODE>, <CODE>Curve</CODE>, <CODE>Surface</CODE>, <CODE>MultiCurve</CODE>,
and <CODE>MultiSurface</CODE> are defined as non-instantiable classes.
They define a common set of methods for their subclasses and
are included for extensibility.

</P>
<P>
<CODE>Point</CODE>, <CODE>LineString</CODE>, <CODE>Polygon</CODE>, <CODE>GeometryCollection</CODE>,
<CODE>MultiPoint</CODE>, <CODE>MultiLineString</CODE>, and
<CODE>MultiPolygon</CODE> are instantiable classes.

</P>


<H3><A NAME="GIS_class_geometry" HREF="manual_toc.html#GIS_class_geometry">18.2.2  Class <CODE>Geometry</CODE></A></H3>

<P>
<CODE>Geometry</CODE> is the root class of the hierarchy.  It is a
non-instantiable class but has a number of properties that are common to
all geometry values created from any of the <CODE>Geometry</CODE> subclasses.
These properties are described in the following list.  (Particular
subclasses have their own specific properties, described later.)

</P>


<H4>18.2.2.1  Geometry Properties</H4>

<P>
A geometry value has the following properties:

</P>

<UL>

<LI>

Its <STRONG>type</STRONG>.
Each geometry belongs to one of the instantiable classes in the hierarchy.

<LI>

Its <STRONG>SRID</STRONG>, or Spatial Reference Identifier. This value identifies
the geometry's associated Spatial Reference System that describes the
coordinate space in which the geometry object is defined.

<LI>

Its <STRONG>coordinates</STRONG> in its Spatial Reference System,
represented as double-precision (eight-byte) numbers. All non-empty geometries
include at least one pair of (X,Y) coordinates. Empty geometries contain
no coordinates.

Coordinates are related to the SRID.
For example, in different coordinate systems, the distance between two objects
may differ even when objects have the same coordinates, because the distance
on the <STRONG>planar</STRONG> coordinate system and the distance on the <STRONG>geocentric</STRONG>
system (coordinates on the Earth's surface) are different things.

<LI>

Its <STRONG>interior</STRONG>, <STRONG>boundary</STRONG>, and <STRONG>exterior</STRONG>.
Every geometry occupies some position in space. The exterior of
a geometry is all space not occupied by the geometry. The interior
is the space occupied by the geometry. The boundary is the
interface between the geometry's interior and exterior.

<LI>

Its <STRONG>MBR</STRONG> (Minimum Bounding Rectangle), or Envelope.
This is the bounding geometry, formed by the minimum and maximum (X,Y)
coordinates:


<PRE>
((MINX MINY, MAXX MINY, MAXX MAXY, MINX MAXY, MINX MINY))
</PRE>

<LI>

The quality of being <STRONG>simple</STRONG> or <STRONG>non-simple</STRONG>.
Geometry values of types (<CODE>LineString</CODE>, <CODE>MultiPoint</CODE>,
<CODE>MultiLineString</CODE>)
are either simple or non-simple. Each type determines its own assertions
for being simple or non-simple.

<LI>

The quality of being <STRONG>closed</STRONG> or <STRONG>not closed</STRONG>.
Geometry values of types (<CODE>LineString</CODE>, <CODE>MultiString</CODE>) are
either closed
or not closed. Each type determines its own assertions for being closed
or not closed.

<LI>

The quality of being <STRONG>empty</STRONG> or <STRONG>not empty</STRONG>
A geometry is empty if it does not have any points.
Exterior, interior, and boundary of an empty geometry
are not defined (that is, they are represented by a <CODE>NULL</CODE> value).
An empty geometry is defined to be always simple and has an area of 0.

<LI>

Its <STRONG>dimension</STRONG>. A geometry can have a dimension of -1, 0, 1,
or 2:


<UL>

<LI>-1 for an empty geometry.

<LI>0 for a geometry with no length and no area.

<LI>1 for a geometry with non-zero length and zero area.

<LI>2 for a geometry with non-zero area.

</UL>

<CODE>Point</CODE> objects have a dimension of zero.  <CODE>LineString</CODE>
objects have a dimension of 1. <CODE>Polygon</CODE> objects have a
dimension of 2.  The dimensions of <CODE>MultiPoint</CODE>,
<CODE>MultiLineString</CODE>, and <CODE>MultiPolygon</CODE> objects are the
same as the dimensions of the elements they consist of.

</UL>



<H3><A NAME="GIS_class_point" HREF="manual_toc.html#GIS_class_point">18.2.3  Class <CODE>Point</CODE></A></H3>

<P>
A <CODE>Point</CODE> is a geometry that represents a single
location in coordinate space.

</P>

<H4>18.2.3.1  <CODE>Point</CODE> Examples</H4>


<UL>

<LI>

Imagine a large-scale map of the world with many cities.
A <CODE>Point</CODE> object could represent each city.

<LI>

On a city map, a <CODE>Point</CODE> object could represent a bus stop.
</UL>


<H4>18.2.3.2  <CODE>Point</CODE> Properties</H4>


<UL>

<LI>

X-coordinate value.

<LI>

Y-coordinate value.

<LI>

<CODE>Point</CODE> is defined as a zero-dimensional geometry.

<LI>

The boundary of a <CODE>Point</CODE> is the empty set.
</UL>



<H3><A NAME="GIS_class_curve" HREF="manual_toc.html#GIS_class_curve">18.2.4  Class <CODE>Curve</CODE></A></H3>

<P>
A <CODE>Curve</CODE> is a one-dimensional geometry, usually represented by a sequence
of points. Particular subclasses of <CODE>Curve</CODE> define the type of
interpolation between points. <CODE>Curve</CODE> is a non-instantiable class.

</P>

<H4>18.2.4.1  <CODE>Curve</CODE> Properties</H4>


<UL>

<LI>

A <CODE>Curve</CODE> has the coordinates of its points.

<LI>

A <CODE>Curve</CODE> is defined as a one-dimensional geometry.

<LI>

A <CODE>Curve</CODE> is simple if it does not pass through the same point twice.

<LI>

A <CODE>Curve</CODE> is closed if its start point is equal to its end point.

<LI>

The boundary of a closed <CODE>Curve</CODE> is empty.

<LI>

The boundary of a non-closed <CODE>Curve</CODE> consists of its two end points.

<LI>

A <CODE>Curve</CODE> that is simple and closed is a <CODE>LinearRing</CODE>.

</UL>



<H3><A NAME="GIS_class_linestring" HREF="manual_toc.html#GIS_class_linestring">18.2.5  Class <CODE>LineString</CODE></A></H3>

<P>
A <CODE>LineString</CODE> is a <CODE>Curve</CODE> with linear interpolation between points.

</P>

<H4>18.2.5.1  <CODE>LineString</CODE> Examples</H4>


<UL>

<LI>

On a world map, <CODE>LineString</CODE> objects could represent rivers.

<LI>

In a city map, <CODE>LineString</CODE> objects could represent streets.

</UL>


<H4>18.2.5.2  <CODE>LineString</CODE> Properties</H4>


<UL>

<LI>

A <CODE>LineString</CODE> has coordinates of segments, defined by each consecutive pair of points.

<LI>

A <CODE>LineString</CODE> is a <CODE>Line</CODE> if it consists of exactly two points.

<LI>

A <CODE>LineString</CODE> is a <CODE>LinearRing</CODE> if it is both closed and simple.

</UL>



<H3><A NAME="GIS_class_surface" HREF="manual_toc.html#GIS_class_surface">18.2.6  Class <CODE>Surface</CODE></A></H3>

<P>
A <CODE>Surface</CODE> is a two-dimensional geometry. It is a non-instantiable
class. Its only instantiable subclass is <CODE>Polygon</CODE>.

</P>


<H4>18.2.6.1  <CODE>Surface</CODE> Properties</H4>


<UL>

<LI>

A <CODE>Surface</CODE> is defined as a two-dimensional geometry.

<LI>

The OpenGIS specification defines a simple <CODE>Surface</CODE> as a geometry that
consists of a single ``patch'' that is associated with a single exterior
boundary and zero or more interior boundaries.

<LI>

The boundary of a simple <CODE>Surface</CODE> is the set of closed curves
corresponding to its exterior and interior boundaries.

</UL>



<H3><A NAME="GIS_class_polygon" HREF="manual_toc.html#GIS_class_polygon">18.2.7  Class <CODE>Polygon</CODE></A></H3>

<P>
A <CODE>Polygon</CODE> is a planar <CODE>Surface</CODE> representing a multisided
geometry. It is defined by a single exterior boundary and zero or more
interior boundaries, where
each interior boundary defines a hole in the <CODE>Polygon</CODE>.

</P>

<H4>18.2.7.1  <CODE>Polygon</CODE> Examples</H4>


<UL>

<LI>

On a region map, <CODE>Polygon</CODE> objects could represent forests, districts, an
so on.

</UL>


<H4>18.2.7.2  <CODE>Polygon</CODE> Assertions</H4>


<UL>

<LI>

The boundary of a <CODE>Polygon</CODE> consists of a set of <CODE>LinearRing</CODE> objects
(that is, <CODE>LineString</CODE> objects that are both simple and closed) that make up its
exterior and interior boundaries.

<LI>

A <CODE>Polygon</CODE> has no rings that cross. The rings in the boundary of a
<CODE>Polygon</CODE> may intersect at a <CODE>Point</CODE>, but only as a tangent.

<LI>

A <CODE>Polygon</CODE> has no lines, spikes, or punctures.

<LI>

A <CODE>Polygon</CODE> has an interior that is a connected point set.

<LI>

A <CODE>Polygon</CODE> may have holes.
The exterior of a <CODE>Polygon</CODE> with holes is not connected.
Each hole defines a connected component of the exterior.

</UL>

<P>
The preceding assertions make a <CODE>Polygon</CODE> a simple geometry.

</P>



<H3><A NAME="GIS_class_geometrycollection" HREF="manual_toc.html#GIS_class_geometrycollection">18.2.8  Class <CODE>GeometryCollection</CODE></A></H3>

<P>
A <CODE>GeometryCollection</CODE> is a geometry that is a collection of one or more
geometries of any class.

</P>
<P>
All the elements in a <CODE>GeometryCollection</CODE> must be in
the same Spatial Reference System (that is, in the same coordinate system).
There are no other constraints on the elements of a <CODE>GeometryCollection</CODE>,
although the
subclasses of <CODE>GeometryCollection</CODE> described in the following sections
may restrict membership. Restrictions may be based on:

</P>

<UL>

<LI>

Element type (for example, a <CODE>MultiPoint</CODE> may contain only <CODE>Point</CODE>
elements)

<LI>

Dimension

<LI>

Constraints on the degree of spatial overlap between elements

</UL>



<H3><A NAME="GIS_class_multipoint" HREF="manual_toc.html#GIS_class_multipoint">18.2.9  Class <CODE>MultiPoint</CODE></A></H3>

<P>
A <CODE>MultiPoint</CODE> is a geometry collection composed of
<CODE>Point</CODE> elements. The points are not connected or ordered
in any way.

</P>

<H4>18.2.9.1  <CODE>MultiPoint</CODE> Examples</H4>


<UL>

<LI>

On a world map, a <CODE>MultiPoint</CODE> could represent a chain of small islands.

<LI>

On a city map, a <CODE>MultiPoint</CODE> could represent the outlets for a ticket
office.

</UL>


<H4>18.2.9.2  <CODE>MultiPoint</CODE> Properties</H4>


<UL>

<LI>

A <CODE>MultiPoint</CODE> is a zero-dimensional geometry.

<LI>

A <CODE>MultiPoint</CODE> is simple if no two of its <CODE>Point</CODE> values are
equal (have identical coordinate values).

<LI>

The boundary of a <CODE>MultiPoint</CODE> is the empty set.

</UL>



<H3><A NAME="GIS_class_multicurve" HREF="manual_toc.html#GIS_class_multicurve">18.2.10  Class <CODE>MultiCurve</CODE></A></H3>

<P>
A <CODE>MultiCurve</CODE> is a geometry collection composed of
<CODE>Curve</CODE> elements. <CODE>MultiCurve</CODE> is a non-instantiable class.

</P>

<H4>18.2.10.1  <CODE>MultiCurve</CODE> Properties</H4>


<UL>

<LI>

A <CODE>MultiCurve</CODE> is a one-dimensional geometry.

<LI>

A <CODE>MultiCurve</CODE> is simple if and only if all of its elements are simple;
the only intersections between any two elements occur at points that are
on the boundaries of both elements.

<LI>

A <CODE>MultiCurve</CODE> boundary is obtained by applying the ``mod 2 union
rule'' (also known as the ``odd-even rule''):
A point is in the boundary of a <CODE>MultiCurve</CODE> if it is in the
boundaries of an odd number of <CODE>MultiCurve</CODE> elements.

<LI>

A <CODE>MultiCurve</CODE> is closed if all of its elements are closed.

<LI>

The boundary of a closed <CODE>MultiCurve</CODE> is always empty.

</UL>



<H3><A NAME="GIS_class_multilinestring" HREF="manual_toc.html#GIS_class_multilinestring">18.2.11  Class <CODE>MultiLineString</CODE></A></H3>

<P>
A <CODE>MultiLineString</CODE> is a <CODE>MultiCurve</CODE> geometry collection composed
of <CODE>LineString</CODE> elements.

</P>

<H4>18.2.11.1  <CODE>MultiLineString</CODE> Examples</H4>


<UL>

<LI>

On a region map, a <CODE>MultiLineString</CODE> could represent a river system or
a highway system.

</UL>



<H3><A NAME="GIS_class_multisurface" HREF="manual_toc.html#GIS_class_multisurface">18.2.12  Class <CODE>MultiSurface</CODE></A></H3>

<P>
A <CODE>MultiSurface</CODE> is a geometry collection composed of surface elements.
<CODE>MultiSurface</CODE> is a non-instantiable class. Its only instantiable
subclass is <CODE>MultiPolygon</CODE>.

</P>

<H4>18.2.12.1  <CODE>MultiSurface</CODE> Assertions</H4>


<UL>

<LI>

Two <CODE>MultiSurface</CODE> surfaces have no interiors that intersect.

<LI>

Two <CODE>MultiSurface</CODE> elements have boundaries that
intersect at most at a finite number of points.

</UL>



<H3><A NAME="GIS_class_multipolygon" HREF="manual_toc.html#GIS_class_multipolygon">18.2.13  Class <CODE>MultiPolygon</CODE></A></H3>

<P>
A <CODE>MultiPolygon</CODE> is a <CODE>MultiSurface</CODE> object composed of
<CODE>Polygon</CODE> elements.

</P>

<H4>18.2.13.1  <CODE>MultiPolygon</CODE> Examples</H4>


<UL>

<LI>

On a region map, a <CODE>MultiPolygon</CODE> could represent a system of lakes.

</UL>


<H4>18.2.13.2  <CODE>MultiPolygon</CODE> Assertions</H4>


<UL>

<LI>

A <CODE>MultiPolygon</CODE> has no two <CODE>Polygon</CODE> elements with interiors
that intersect.

<LI>

A <CODE>MultiPolygon</CODE> has no two <CODE>Polygon</CODE> elements that cross
(crossing is also forbidden by the previous assertion), or that
touch at an infinite number of points.

<LI>

A <CODE>MultiPolygon</CODE> may not have cut lines, spikes or punctures. A
<CODE>MultiPolygon</CODE> is a regular, closed point set.

<LI>

A <CODE>MultiPolygon</CODE> that has more than one <CODE>Polygon</CODE> has an
interior that is not connected. The number of connected components of the interior
of a <CODE>MultiPolygon</CODE> is equal to the number of <CODE>Polygon</CODE> values in
the <CODE>MultiPolygon</CODE>.

</UL>


<H4>18.2.13.3  <CODE>MultiPolygon</CODE> Properties</H4>


<UL>

<LI>

A <CODE>MultiPolygon</CODE> is a two-dimensional geometry.

<LI>

A <CODE>MultiPolygon</CODE> boundary is a set of closed curves
(<CODE>LineString</CODE> values) corresponding to the boundaries of its
<CODE>Polygon</CODE> elements.

<LI>

Each <CODE>Curve</CODE> in the boundary of the <CODE>MultiPolygon</CODE> is in the
boundary of exactly one <CODE>Polygon</CODE> element.

<LI>

Every <CODE>Curve</CODE> in the boundary of an <CODE>Polygon</CODE> element is
in the boundary of the <CODE>MultiPolygon</CODE>.

</UL>



<H2><A NAME="Supported_spatial_data_formats" HREF="manual_toc.html#Supported_spatial_data_formats">18.3  Supported Spatial Data Formats</A></H2>

<P>
This section describes the standard spatial data formats that are used
to represent geometry objects in queries.
They are:

</P>

<UL>

<LI>Well-Known Text (WKT) format

<LI>Well-Known Binary (WKB) format

</UL>

<P>
Internally, MySQL stores geometry values in a format that is not identical
to either WKT or WKB format.

</P>



<H3><A NAME="GIS_WKT_format" HREF="manual_toc.html#GIS_WKT_format">18.3.1  Well-Known Text (WKT) Format</A></H3>

<P>
<A NAME="IDX1879"></A>
<A NAME="IDX1880"></A>

</P>
<P>
The Well-Known Text (WKT) representation of Geometry is designed to
exchange geometry data in ASCII form.

</P>

<P>
Examples of WKT representations of geometry objects are:

</P>

<UL>

<LI>

A <CODE>Point</CODE>:


<PRE>
POINT(15 20)
</PRE>

Note that point coordinates are specified with no separating comma.

<LI>

A <CODE>LineString</CODE> with four points:


<PRE>
LINESTRING(0 0, 10 10, 20 25, 50 60)
</PRE>

Note that point coordinate pairs are separated by commas.

<LI>

A <CODE>Polygon</CODE> with one exterior ring and one interior ring:


<PRE>
POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))
</PRE>

<LI>

A <CODE>MultiPoint</CODE> with three <CODE>Point</CODE> values:


<PRE>
MULTIPOINT(0 0, 20 20, 60 60)
</PRE>

<LI>

A <CODE>MultiLineString</CODE> with two <CODE>LineString</CODE> values:


<PRE>
MULTILINESTRING((10 10, 20 20), (15 15, 30 15))
</PRE>

<LI>

A <CODE>MultiPolygon</CODE> with two <CODE>Polygon</CODE> values:


<PRE>
MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0)),((5 5,7 5,7 7,5 7, 5 5)))
</PRE>

<LI>

A <CODE>GeometryCollection</CODE> consisting of two <CODE>Point</CODE> values and one
<CODE>LineString</CODE>:


<PRE>
GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))
</PRE>

</UL>

<P>
A Backus-Naur grammar that specifies the formal production rules for writing
WKT values can be found in the OGC specification document referenced near the
beginning of this chapter.

</P>


<H3><A NAME="GIS_WKB_format" HREF="manual_toc.html#GIS_WKB_format">18.3.2  Well-Known Binary (WKB) Format</A></H3>

<P>
<A NAME="IDX1881"></A>
<A NAME="IDX1882"></A>

</P>
<P>
The Well-Known Binary (WKB) representation for geometric values is defined by
the OpenGIS specifications.
It is also defined in the ISO ``SQL/MM Part 3: Spatial'' standard.

</P>
<P>
WKB is used to exchange geometry data as binary streams represented by
<CODE>BLOB</CODE> values containing geometric WKB information.

</P>
<P>
WKB uses one-byte unsigned integers, four-byte unsigned integers, and eight-byte
double-precision numbers (IEEE 754 format). A byte is eight bits.

</P>
<P>
For example, a WKB value that corresponds to <CODE>POINT(1 1)</CODE> consists of
this sequence of 21 bytes (each represented here by two hex digits):

</P>

<PRE>
0101000000000000000000F03F000000000000F03F
</PRE>

<P>
The sequence may be broken down into these components:

</P>

<PRE>
Byte order : 01
WKB type   : 01000000
X          : 000000000000F03F
Y          : 000000000000F03F
</PRE>

<P>
Component representation is as follows:

</P>

<UL>

<LI>

The byte order may be either 0 or 1 to indicate little-endian or big-endian
storage. The little-endian and big-endian byte orders are also known as
Network Data Representation (NDR) and External Data Representation (XDR),
respectively.

<LI>

The WKB type is a code that indicates the geometry type. Values from 1 through
7 indicate
<CODE>Point</CODE>,
<CODE>LineString</CODE>,
<CODE>Polygon</CODE>,
<CODE>MultiPoint</CODE>,
<CODE>MultiLineString</CODE>,
<CODE>MultiPolygon</CODE>,
and
<CODE>GeometryCollection</CODE>.

<LI>

A <CODE>Point</CODE> value has X and Y coordinates, each represented as a
double-precision value.

</UL>

<P>
WKB values for more complex geometry values are represented by more complex
data structures, as detailed in the OpenGIS specification.

</P>


<H2><A NAME="Creating_a_spatially_enabled_MySQL_database" HREF="manual_toc.html#Creating_a_spatially_enabled_MySQL_database">18.4  Creating a Spatially Enabled MySQL Database</A></H2>

<P>
This section describes the data types you can use for representing
spatial data in MySQL, and the functions available for creating and retrieving
spatial values.

</P>



<H3><A NAME="MySQL_spatial_datatypes" HREF="manual_toc.html#MySQL_spatial_datatypes">18.4.1  MySQL Spatial Data Types</A></H3>

<P>
<A NAME="IDX1883"></A>
<A NAME="IDX1884"></A>
<A NAME="IDX1885"></A>
<A NAME="IDX1886"></A>
<A NAME="IDX1887"></A>
<A NAME="IDX1888"></A>
<A NAME="IDX1889"></A>
<A NAME="IDX1890"></A>

</P>
<P>
MySQL has data types that correspond to OpenGIS classes.
Some of these types hold single geometry values:

</P>

<UL>
<LI><CODE>GEOMETRY</CODE>

<LI><CODE>POINT</CODE>

<LI><CODE>LINESTRING</CODE>

<LI><CODE>POLYGON</CODE>

</UL>

<P>
<CODE>GEOMETRY</CODE> can store geometry values of any type.
The other single-value types,
<CODE>POINT</CODE> and <CODE>LINESTRING</CODE> and <CODE>POLYGON</CODE>,
restrict their values to a particular geometry type.

</P>
<P>
The other data types hold collections of values:

</P>

<UL>
<LI><CODE>MULTIPOINT</CODE>

<LI><CODE>MULTILINESTRING</CODE>

<LI><CODE>MULTIPOLYGON</CODE>

<LI><CODE>GEOMETRYCOLLECTION</CODE>

</UL>

<P>
<CODE>GEOMETRYCOLLECTION</CODE> can store a collection of objects
of any type. The other collection types,
<CODE>MULTIPOINT</CODE> and <CODE>MULTILINESTRING</CODE> and <CODE>MULTIPOLYGON</CODE> and <CODE>GEOMETRYCOLLECTION</CODE>,
restrict collection members to those having a particular geometry type.

</P>



<H3><A NAME="Creating_spatial_values" HREF="manual_toc.html#Creating_spatial_values">18.4.2  Creating Spatial Values</A></H3>

<P>
This section describes how to create spatial values using Well-Known Text
and Well-Known Binary functions that are defined in the OpenGIS standard,
and using MySQL-specific functions.

</P>



<H4><A NAME="GIS_WKT_Functions" HREF="manual_toc.html#GIS_WKT_Functions">18.4.2.1  Creating Geometry Values Using WKT Functions</A></H4>

<P>
MySQL provides a number of functions that take as input parameters a
Well-Known Text representation and, optionally, a spatial reference
system identifier (SRID). They return the corresponding geometry.

</P>
<P>
<CODE>GeomFromText()</CODE> accepts a WKT of any geometry type as its first
argument.  An implementation also provides type-specific construction
functions for construction of geometry values of each geometry type.

</P>

<DL COMPACT>

<DT><CODE>GeomCollFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>GeometryCollectionFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1891"></A>
<A NAME="IDX1892"></A>
Constructs a <CODE>GEOMETRYCOLLECTION</CODE> value using its WKT representation and SRID.

<DT><CODE>GeomFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>GeometryFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1893"></A>
<A NAME="IDX1894"></A>
Constructs a geometry value of any type using its WKT representation and SRID.

<DT><CODE>LineFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>LineStringFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1895"></A>
<A NAME="IDX1896"></A>
Constructs a <CODE>LINESTRING</CODE> value using its WKT representation and SRID.

<DT><CODE>MLineFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>MultiLineStringFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1897"></A>
<A NAME="IDX1898"></A>
Constructs a <CODE>MULTILINESTRING</CODE> value using its WKT representation and SRID.

<DT><CODE>MPointFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>MultiPointFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1899"></A>
<A NAME="IDX1900"></A>
Constructs a <CODE>MULTIPOINT</CODE> value using its WKT representation and SRID.

<DT><CODE>MPolyFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>MultiPolygonFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1901"></A>
<A NAME="IDX1902"></A>
Constructs a <CODE>MULTIPOLYGON</CODE> value using its WKT representation and SRID.

<DT><CODE>PointFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1903"></A>
Constructs a <CODE>POINT</CODE> value using its WKT representation and SRID.

<DT><CODE>PolyFromText(wkt[,srid])</CODE>
<DD>
<DT><CODE>PolygonFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1904"></A>
<A NAME="IDX1905"></A>
Constructs a <CODE>POLYGON</CODE> value using its WKT representation and SRID.

</DL>

<P>
The OpenGIS specification also describes optional functions for constructing
<CODE>Polygon</CODE> or <CODE>MultiPolygon</CODE> values based on the WKT representation
of a collection of rings or closed <CODE>LineString</CODE> values. These values
may intersect.  MySQL does not implement these functions:

</P>
<DL COMPACT>

<DT><CODE>BdMPolyFromText(wkt,srid)</CODE>
<DD>
<A NAME="IDX1906"></A>
Constructs a <CODE>MultiPolygon</CODE> value from a
<CODE>MultiLineString</CODE> value in WKT format containing
an arbitrary collection of closed <CODE>LineString</CODE> values.

<DT><CODE>BdPolyFromText(wkt,srid)</CODE>
<DD>
<A NAME="IDX1907"></A>
Constructs a <CODE>Polygon</CODE> value from a
<CODE>MultiLineString</CODE> value in WKT format containing
an arbitrary collection of closed <CODE>LineString</CODE> values.

</DL>



<H4><A NAME="GIS_WKB_Functions" HREF="manual_toc.html#GIS_WKB_Functions">18.4.2.2  Creating Geometry Values Using WKB Functions</A></H4>

<P>
MySQL provides a number of functions that take as input parameters a
<CODE>BLOB</CODE> containing a Well-Known Binary representation
and, optionally, a spatial reference
system identifier (SRID). They return the corresponding geometry.

</P>
<P>
<CODE>GeomFromWKT()</CODE> accepts a WKB of any geometry type as its first
argument.  An implementation also provides type-specific construction
functions for construction of geometry values of each geometry type.

</P>

<DL COMPACT>

<DT><CODE>GeomCollFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>GeometryCollectionFromWKB(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1908"></A>
<A NAME="IDX1909"></A>
Constructs a <CODE>GEOMETRYCOLLECTION</CODE> value using its WKB representation and SRID.

<DT><CODE>GeomFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>GeometryFromWKB(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1910"></A>
<A NAME="IDX1911"></A>
Constructs a geometry value of any type using its WKB representation and SRID.

<DT><CODE>LineFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>LineStringFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1912"></A>
<A NAME="IDX1913"></A>
Constructs a <CODE>LINESTRING</CODE> value using its WKB representation and SRID.

<DT><CODE>MLineFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>MultiLineStringFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1914"></A>
<A NAME="IDX1915"></A>
Constructs a <CODE>MULTILINESTRING</CODE> value using its WKB representation and SRID.

<DT><CODE>MPointFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>MultiPointFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1916"></A>
<A NAME="IDX1917"></A>
Constructs a <CODE>MULTIPOINT</CODE> value using its WKB representation and SRID.

<DT><CODE>MPolyFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>MultiPolygonFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1918"></A>
<A NAME="IDX1919"></A>
Constructs a <CODE>MULTIPOLYGON</CODE> value using its WKB representation and SRID.

<DT><CODE>PointFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1920"></A>
Constructs a <CODE>POINT</CODE> value using its WKB representation and SRID.

<DT><CODE>PolyFromWKB(wkb[,srid])</CODE>
<DD>
<DT><CODE>PolygonFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1921"></A>
<A NAME="IDX1922"></A>
Constructs a <CODE>POLYGON</CODE> value using its WKB representation and SRID.

</DL>

<P>
The OpenGIS specification also describes optional functions for constructing
<CODE>Polygon</CODE> or <CODE>MultiPolygon</CODE> values based on the WKB representation
of a collection of rings or closed <CODE>LineString</CODE> values. These values
may intersect.  MySQL does not implement these functions:

</P>
<DL COMPACT>

<DT><CODE>BdMPolyFromWKB(wkb,srid)</CODE>
<DD>
<A NAME="IDX1923"></A>
Constructs a <CODE>MultiPolygon</CODE> value from a
<CODE>MultiLineString</CODE> value in WKB format containing
an arbitrary collection of closed <CODE>LineString</CODE> values.

<DT><CODE>BdPolyFromWKB(wkb,srid)</CODE>
<DD>
<A NAME="IDX1924"></A>
Constructs a <CODE>Polygon</CODE> value from a
<CODE>MultiLineString</CODE> value in WKB format containing
an arbitrary collection of closed <CODE>LineString</CODE> values.

</DL>



<H4><A NAME="GIS_MySQL-Specific_Functions" HREF="manual_toc.html#GIS_MySQL-Specific_Functions">18.4.2.3  Creating Geometry Values Using MySQL-Specific Functions</A></H4>

<P>
<STRONG>Note:</STRONG> MySQL does not implement the functions listed in this
section.

</P>
<P>
MySQL provides a set of useful functions for creating geometry WKB
representations. The functions described in this section are MySQL
extensions to the OpenGIS specifications. The results of these
functions are <CODE>BLOB</CODE> values containing WKB representations of geometry
values with no SRID.
The results of these functions can be substituted as the first argument
for any function in the <CODE>GeomFromWKB()</CODE> function family.

</P>
<DL COMPACT>

<DT><CODE>GeometryCollection(g1,g2,...)</CODE>
<DD>
<A NAME="IDX1925"></A>
Constructs a WKB <CODE>GeometryCollection</CODE>. If any argument is not a
well-formed WKB representation of a geometry, the return value is
<CODE>NULL</CODE>.

<DT><CODE>LineString(pt1,pt2,...)</CODE>
<DD>
<A NAME="IDX1926"></A>
Constructs a WKB <CODE>LineString</CODE> value from a number of WKB <CODE>Point</CODE>
arguments.  If any argument is not a WKB <CODE>Point</CODE>, the return value
is <CODE>NULL</CODE>.  If the number of <CODE>Point</CODE> arguments is less than two,
the return value is <CODE>NULL</CODE>.

<DT><CODE>MultiLineString(ls1,ls2,...)</CODE>
<DD>
<A NAME="IDX1927"></A>
Constructs a WKB <CODE>MultiLineString</CODE> value using using WKB <CODE>LineString</CODE>
arguments.  If any argument is not a <CODE>LineString</CODE>, the return
value is <CODE>NULL</CODE>.

<DT><CODE>MultiPoint(pt1,pt2,...)</CODE>
<DD>
<A NAME="IDX1928"></A>
Constructs a WKB <CODE>MultiPoint</CODE> value using WKB <CODE>Point</CODE> arguments.
If any argument is not a <CODE>WKBPoint</CODE>, the return value is <CODE>NULL</CODE>.

<DT><CODE>MultiPolygon(poly1,poly2,...)</CODE>
<DD>
<A NAME="IDX1929"></A>
Constructs a WKB <CODE>MultiPolygon</CODE> value from a set of WKB <CODE>Polygon</CODE>
arguments.
If any argument is not a WKB <CODE>Polygon</CODE>, the rerurn value is <CODE>NULL</CODE>.

<DT><CODE>Point(x,y)</CODE>
<DD>
<A NAME="IDX1930"></A>
Constructs a WKB <CODE>Point</CODE> using its coordinates.

<DT><CODE>Polygon(ls1,ls2,...)</CODE>
<DD>
<A NAME="IDX1931"></A>
Constructs a WKB <CODE>Polygon</CODE> value from a number of WKB <CODE>LineString</CODE>
arguments. If any argument does not represent the WKB of a <CODE>LinearRing</CODE>
(that is, not a closed and simple <CODE>LineString</CODE>) the return value
is <CODE>NULL</CODE>.

</DL>



<H3><A NAME="Creating_spatial_columns" HREF="manual_toc.html#Creating_spatial_columns">18.4.3  Creating Spatial Columns</A></H3>

<P>
MySQL provides a standard way of creating spatial columns for
geometry types, for example, with <CODE>CREATE TABLE</CODE> or <CODE>ALTER TABLE</CODE>.
Currently, spatial columns are supported only for <CODE>MyISAM</CODE> tables.

</P>

<UL>

<LI>

Use the <CODE>CREATE TABLE</CODE> statement to create a table with a spatial column:


<PRE>
mysql&#62; CREATE TABLE geom (g GEOMETRY);
Query OK, 0 rows affected (0.02 sec)
</PRE>

<LI>

Use the <CODE>ALTER TABLE</CODE> statement to add or drop a spatial column to or
from an existing table:


<PRE>
mysql&#62; ALTER TABLE geom ADD pt POINT;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql&#62; ALTER TABLE geom DROP pt;
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
</PRE>

</UL>



<H3><A NAME="Populating_spatial_columns" HREF="manual_toc.html#Populating_spatial_columns">18.4.4  Populating Spatial Columns</A></H3>

<P>
After you have created spatial columns, you can populate them
with spatial data.

</P>
<P>
Values should be stored in internal geometry format, but you can convert them
to that format from either Well-Known Text (WKT) or Well-Known Binary (WKB)
format. The following examples demonstrate how to insert geometry values into
a table by converting WKT values into internal geometry format.

</P>
<P>
You can perform the conversion directly in the <CODE>INSERT</CODE> statement:

</P>

<PRE>
INSERT INTO geom VALUES (GeomFromText('POINT(1 1)'));

SET @g = 'POINT(1 1)';
INSERT INTO geom VALUES (GeomFromText(@g));
</PRE>

<P>
Or you can perform the conversion prior to the <CODE>INSERT</CODE>:

</P>

<PRE>
SET @g = GeomFromText('POINT(1 1)');
INSERT INTO geom VALUES (@g);
</PRE>

<P>
The following examples insert more complex geometries into the table:

</P>

<PRE>
SET @g = 'LINESTRING(0 0,1 1,2 2)';
INSERT INTO geom VALUES (GeomFromText(@g));

SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
INSERT INTO geom VALUES (GeomFromText(@g));

SET @g =
'GEOMETRYCOLLECTION(POINT(1 1),LINESTRING(0 0,1 1,2 2,3 3,4 4))';
INSERT INTO geom VALUES (GeomFromText(@g));
</PRE>

<P>
The preceding examples all use <CODE>GeomFromText()</CODE> to create geometry
values.  You can also use type-specific functions:

</P>

<PRE>
SET @g = 'POINT(1 1)';
INSERT INTO geom VALUES (PointFromText(@g));

SET @g = 'LINESTRING(0 0,1 1,2 2)';
INSERT INTO geom VALUES (LineStringFromText(@g));

SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
INSERT INTO geom VALUES (PolygonFromText(@g));

SET @g =
'GEOMETRYCOLLECTION(POINT(1 1),LINESTRING(0 0,1 1,2 2,3 3,4 4))';
INSERT INTO geom VALUES (GeomCollFromText(@g));
</PRE>

<P>
Note that if a client application program wants to use WKB representations
of geometry values, it is responsible for sending correctly formed WKB in
queries to the server. However, there are several ways of satisfying this
requirement. For example:

</P>

<UL>

<LI>Inserting a <CODE>POINT(1 1)</CODE> value with hex literal syntax:


<PRE>
mysql&#62; INSERT INTO geom VALUES
    -&#62; (GeomFromWKB(0x0101000000000000000000F03F000000000000F03F));
</PRE>

<LI>An ODBC application can send a WKB representation, binding it to a

placeholder using an argument of <CODE>BLOB</CODE> type:

<PRE>
INSERT INTO geom VALUES (GeomFromWKB(?))
</PRE>

Other programming interfaces may support a similar placeholder mechanism.

<LI>In a C program, you can escape a binary value using

<CODE>mysql_real_escape_string()</CODE> and include the result in a query string
that is sent to the server.
See section <A HREF="manual.html#mysql_real_escape_string">20.2.3.184  <CODE>mysql_real_escape_string()</CODE></A>.

</UL>



<H3><A NAME="Fetching_spatial_data" HREF="manual_toc.html#Fetching_spatial_data">18.4.5  Fetching Spatial Data</A></H3>

<P>
Geometry values stored in a table can be fetched in internal
format. You can also convert them into WKT or WKB format.

</P>



<H4><A NAME="Fetching_spatial_data_in_internal_format" HREF="manual_toc.html#Fetching_spatial_data_in_internal_format">18.4.5.1  Fetching Spatial Data in Internal Format</A></H4>

<P>
Fetching geometry values using internal format can be useful in
table-to-table transfers:

</P>

<PRE>
CREATE TABLE geom2 (g GEOMETRY) SELECT g FROM geom;
</PRE>



<H4><A NAME="Fetching_spatial_data_in_WKT_format" HREF="manual_toc.html#Fetching_spatial_data_in_WKT_format">18.4.5.2  Fetching Spatial Data in WKT Format</A></H4>

<P>
The <CODE>AsText()</CODE> function converts a geometry from internal format into a WKT string.

</P>


<PRE>
mysql&#62; SELECT AsText(g) FROM geom;
+-------------------------+
| AsText(p1)              |
+-------------------------+
| POINT(1 1)              |
| LINESTRING(0 0,1 1,2 2) |
+-------------------------+
</PRE>



<H4><A NAME="Fetching_spatial_data_in_WKB_format" HREF="manual_toc.html#Fetching_spatial_data_in_WKB_format">18.4.5.3  Fetching Spatial Data in WKB Format</A></H4>

<P>
The <CODE>AsBinary()</CODE> function converts a geometry from internal format into a <CODE>BLOB</CODE> containing
the WKB value.

</P>

<PRE>
SELECT AsBinary(g) FROM geom;
</PRE>



<H2><A NAME="Analysing_spatial_information" HREF="manual_toc.html#Analysing_spatial_information">18.5  Analyzing Spatial Information</A></H2>

<P>
After populating spatial columns with values, you are ready to
query and analyze them.  MySQL provides a set of functions to
perform various operations on spatial data. These functions can be
grouped into four major categories according to the type of operation
they perform:

</P>

<UL>

<LI>

Functions that convert geometries between various formats

<LI>

Functions that provide access to qualitative or quantitative properties of a geometry

<LI>

Functions that describe relations between two geometries

<LI>

Functions that create new geometries from existing ones

</UL>

<P>
Spatial analysis functions can be used in many contexts, such as:

</P>

<UL>

<LI>

Any interactive SQL program, such as <CODE>mysql</CODE> or <CODE>MySQLCC</CODE>

<LI>

Application programs written in any language that supports a MySQL client API

</UL>



<H3><A NAME="Functions_to_convert_geometries_between_formats" HREF="manual_toc.html#Functions_to_convert_geometries_between_formats">18.5.1  Geometry Format Conversion Functions</A></H3>

<P>
MySQL supports the following functions for converting geometry values between
internal format and either WKT or WKB format:

</P>
<DL COMPACT>

<DT><CODE>AsBinary(g)</CODE>
<DD>
<A NAME="IDX1932"></A>
Converts a value in internal geometry format to its WKB representation
and returns the binary result.

<DT><CODE>AsText(g)</CODE>
<DD>
<A NAME="IDX1933"></A>
Converts a value in internal geometry format to its WKT representation
and returns the string result.


<PRE>
mysql&#62; SET @g = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT AsText(GeomFromText(@g));
+--------------------------+
| AsText(GeomFromText(@G)) |
+--------------------------+
| LINESTRING(1 1,2 2,3 3)  |
+--------------------------+
</PRE>

<DT><CODE>GeomFromText(wkt[,srid])</CODE>
<DD>
<A NAME="IDX1934"></A>
Converts a string value from its WKT representation into internal geometry
format and returns the result.
A number of type-specific functions are also supported, such as
<CODE>PointFromText()</CODE> and <CODE>LineFromText()</CODE>; see
section <A HREF="manual.html#GIS_WKT_Functions">18.4.2.1  Creating Geometry Values Using WKT Functions</A>.

<DT><CODE>GeomFromWKB(wkb[,srid])</CODE>
<DD>
<A NAME="IDX1935"></A>
Converts a binary value from its WKB representation into internal geometry
format and returns the result.
A number of type-specific functions are also supported, such as
<CODE>PointFromWKB()</CODE> and <CODE>LineFromWKB()</CODE>; see
section <A HREF="manual.html#GIS_WKB_Functions">18.4.2.2  Creating Geometry Values Using WKB Functions</A>.

</DL>



<H3><A NAME="Geometry_property_functions" HREF="manual_toc.html#Geometry_property_functions">18.5.2  <CODE>Geometry</CODE> Functions</A></H3>

<P>
Each function that belongs to this group takes a geometry value as its
argument and returns some quantitative or qualitative property of the
geometry. Some functions restrict their argument type. Such functions
return <CODE>NULL</CODE> if the argument is of an incorrect geometry
type.  For example, <CODE>Area()</CODE> returns <CODE>NULL</CODE> if the object
type is neither <CODE>Polygon</CODE> nor <CODE>MultiPolygon</CODE>.

</P>



<H4><A NAME="General_geometry_property_functions" HREF="manual_toc.html#General_geometry_property_functions">18.5.2.1  General Geometry Functions</A></H4>

<P>
The functions listed in this section do not restrict their argument and
accept a geometry value of any type.

</P>
<DL COMPACT>

<DT><CODE>Dimension(g)</CODE>
<DD>
<A NAME="IDX1936"></A>
Returns the inherent dimension of the geometry value <CODE>g</CODE>. The result
can be -1, 0, 1, or 2. (The meaning of these values is given in
section <A HREF="manual.html#GIS_class_geometry">18.2.2  Class <CODE>Geometry</CODE></A>.)


<PRE>
mysql&#62; SELECT Dimension(GeomFromText('LineString(1 1,2 2)'));
+------------------------------------------------+
| Dimension(GeomFromText('LineString(1 1,2 2)')) |
+------------------------------------------------+
|                                              1 |
+------------------------------------------------+
</PRE>

<DT><CODE>Envelope(g)</CODE>
<DD>
<A NAME="IDX1937"></A>
Returns the Minimum Bounding Rectangle (MBR) for the geometry value <CODE>g</CODE>.
The result is returned as a <CODE>Polygon</CODE> value.


<PRE>
mysql&#62; SELECT AsText(Envelope(GeomFromText('LineString(1 1,2 2)')));
+-------------------------------------------------------+
| AsText(Envelope(GeomFromText('LineString(1 1,2 2)'))) |
+-------------------------------------------------------+
| POLYGON((1 1,2 1,2 2,1 2,1 1))                        |
+-------------------------------------------------------+
</PRE>

The polygon is defined by the corner points of the bounding box:


<PRE>
POLYGON((MINX MINY, MAXX MINY, MAXX MAXY, MINX MAXY, MINX MINY))
</PRE>

<DT><CODE>GeometryType(g)</CODE>
<DD>
<A NAME="IDX1938"></A>
Returns as a string the name of the geometry type of which
the geometry instance <CODE>g</CODE> is a member.
The name will correspond to one of the instantiable <CODE>Geometry</CODE> subclasses.


<PRE>
mysql&#62; SELECT GeometryType(GeomFromText('POINT(1 1)'));
+------------------------------------------+
| GeometryType(GeomFromText('POINT(1 1)')) |
+------------------------------------------+
| POINT                                    |
+------------------------------------------+
</PRE>

<DT><CODE>SRID(g)</CODE>
<DD>
<A NAME="IDX1939"></A>
Returns an integer indicating the Spatial Reference System ID for the geometry
value <CODE>g</CODE>.


<PRE>
mysql&#62; SELECT SRID(GeomFromText('LineString(1 1,2 2)',101));
+-----------------------------------------------+
| SRID(GeomFromText('LineString(1 1,2 2)',101)) |
+-----------------------------------------------+
|                                           101 |
+-----------------------------------------------+
</PRE>

</DL>

<P>
The OpenGIS specification also defines the following functions, which MySQL
does not implement:

</P>
<DL COMPACT>

<DT><CODE>Boundary(g)</CODE>
<DD>
<A NAME="IDX1940"></A>
Returns a geometry that is the closure of the combinatorial boundary of the
geometry value <CODE>g</CODE>.

<DT><CODE>IsEmpty(g)</CODE>
<DD>
<A NAME="IDX1941"></A>
Returns 1 if the geometry value <CODE>g</CODE> is the empty geometry, 0 if it is not
empty, and -1 if the argument is <CODE>NULL</CODE>.
If the geometry is empty, it represents the empty point set.

<DT><CODE>IsSimple(g)</CODE>
<DD>
<A NAME="IDX1942"></A>

Currently, this function is a placeholder and should not be used.
If implemented, its behavior will be as described in the next paragraph.

Returns 1 if the geometry value <CODE>g</CODE> has no anomalous geometric points,
such as self-intersection or self-tangency. <CODE>IsSimple()</CODE> returns 0 if the
argument is not simple, and -1 if it is <CODE>NULL</CODE>.

The description of each instantiable geometric class given earlier in
the chapter includes the specific conditions that cause an instance of
that class to be classified as not simple.

</DL>



<H4><A NAME="Point_property_functions" HREF="manual_toc.html#Point_property_functions">18.5.2.2  <CODE>Point</CODE> Functions</A></H4>

<P>
A <CODE>Point</CODE> consists of X and Y coordinates, which may be obtained
using the following functions:

</P>
<DL COMPACT>

<DT><CODE>X(p)</CODE>
<DD>
<A NAME="IDX1943"></A>
Returns the X-coordinate value for the point <CODE>p</CODE> as a double-precision
number.

<PRE>
mysql&#62; SELECT X(GeomFromText('Point(56.7 53.34)'));
+--------------------------------------+
| X(GeomFromText('Point(56.7 53.34)')) |
+--------------------------------------+
|                                 56.7 |
+--------------------------------------+
</PRE>

<DT><CODE>Y(p)</CODE>
<DD>
<A NAME="IDX1944"></A>
Returns the Y-coordinate value for the point <CODE>p</CODE> as a double-precision
number.

<PRE>
mysql&#62; SELECT Y(GeomFromText('Point(56.7 53.34)'));
+--------------------------------------+
| Y(GeomFromText('Point(56.7 53.34)')) |
+--------------------------------------+
|                                53.34 |
+--------------------------------------+
</PRE>

</DL>



<H4><A NAME="Linestring_property_functions" HREF="manual_toc.html#Linestring_property_functions">18.5.2.3  <CODE>LineString</CODE> Functions</A></H4>

<P>
A <CODE>LineString</CODE> consists of <CODE>Point</CODE> values. You can extract
particular points of a <CODE>LineString</CODE>, count the number of points that it
contains, or obtain its length.

</P>

<DL COMPACT>

<DT><CODE>EndPoint(ls)</CODE>
<DD>
<A NAME="IDX1945"></A>
Returns the <CODE>Point</CODE> that is the end point of the <CODE>LineString</CODE> value
<CODE>ls</CODE>.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT AsText(EndPoint(GeomFromText(@ls)));
+-------------------------------------+
| AsText(EndPoint(GeomFromText(@ls))) |
+-------------------------------------+
| POINT(3 3)                          |
+-------------------------------------+
</PRE>

<DT><CODE>GLength(ls)</CODE>
<DD>
<A NAME="IDX1946"></A>
Returns as a double-precision number the length of the <CODE>LineString</CODE>
value <CODE>ls</CODE> in its associated spatial reference.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT GLength(GeomFromText(@ls));
+----------------------------+
| GLength(GeomFromText(@ls)) |
+----------------------------+
|            2.8284271247462 |
+----------------------------+
</PRE>

<DT><CODE>IsClosed(ls)</CODE>
<DD>
<A NAME="IDX1947"></A>
Returns 1 if the <CODE>LineString</CODE> value <CODE>ls</CODE> is closed
(that is, its <CODE>StartPoint()</CODE> and <CODE>EndPoint()</CODE> values are the same).
Returns 0 if <CODE>ls</CODE> is not closed, and -1 if it is <CODE>NULL</CODE>.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT IsClosed(GeomFromText(@ls));
+-----------------------------+
| IsClosed(GeomFromText(@ls)) |
+-----------------------------+
|                           0 |
+-----------------------------+
</PRE>

<DT><CODE>NumPoints(ls)</CODE>
<DD>
<A NAME="IDX1948"></A>
Returns the number of points in the <CODE>LineString</CODE> value <CODE>ls</CODE>.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT NumPoints(GeomFromText(@ls));
+------------------------------+
| NumPoints(GeomFromText(@ls)) |
+------------------------------+
|                            3 |
+------------------------------+
</PRE>

<DT><CODE>PointN(ls,n)</CODE>
<DD>
<A NAME="IDX1949"></A>
Returns the <CODE>n</CODE>-th point in the <CODE>Linestring</CODE> value <CODE>ls</CODE>.
Point numbers begin at 1.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT AsText(PointN(GeomFromText(@ls),2));
+-------------------------------------+
| AsText(PointN(GeomFromText(@ls),2)) |
+-------------------------------------+
| POINT(2 2)                          |
+-------------------------------------+
</PRE>

<DT><CODE>StartPoint(ls)</CODE>
<DD>
<A NAME="IDX1950"></A>
Returns the <CODE>Point</CODE> that is the start point of the <CODE>LineString</CODE> value
<CODE>ls</CODE>.


<PRE>
mysql&#62; SET @ls = 'LineString(1 1,2 2,3 3)';
mysql&#62; SELECT AsText(StartPoint(GeomFromText(@ls)));
+---------------------------------------+
| AsText(StartPoint(GeomFromText(@ls))) |
+---------------------------------------+
| POINT(1 1)                            |
+---------------------------------------+
</PRE>

</DL>

<P>
The OpenGIS specification also defines the following function, which MySQL
does not implement:

</P>
<DL COMPACT>

<DT><CODE>IsRing(ls)</CODE>
<DD>
<A NAME="IDX1951"></A>
Returns 1 if the <CODE>LineString</CODE> value <CODE>ls</CODE> is closed
(that is, its <CODE>StartPoint()</CODE> and <CODE>EndPoint()</CODE> values are the same)
and is simple (does not pass through the same point more than once).
Returns 0 if <CODE>ls</CODE> is not a ring, and -1 if it is <CODE>NULL</CODE>.

</DL>



<H4><A NAME="Multilinestring_property_functions" HREF="manual_toc.html#Multilinestring_property_functions">18.5.2.4  <CODE>MultiLineString</CODE> Functions</A></H4>

<DL COMPACT>

<DT><CODE>GLength(mls)</CODE>
<DD>
<A NAME="IDX1952"></A>
Returns as a double-precision number
the length of the <CODE>MultiLineString</CODE> value <CODE>mls</CODE>. The length of
<CODE>mls</CODE> is equal to the sum of the lengths of its elements.


<PRE>
mysql&#62; SET @mls = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';
mysql&#62; SELECT GLength(GeomFromText(@mls));
+-----------------------------+
| GLength(GeomFromText(@mls)) |
+-----------------------------+
|             4.2426406871193 |
+-----------------------------+
</PRE>

<DT><CODE>IsClosed(mls)</CODE>
<DD>
<A NAME="IDX1953"></A>
Returns 1 if the <CODE>MultiLineString</CODE> value <CODE>mls</CODE> is closed
(that is, the <CODE>StartPoint()</CODE> and <CODE>EndPoint()</CODE> values are the same
for each <CODE>LineString</CODE> in <CODE>mls</CODE>).
Returns 0 if <CODE>mls</CODE> is not closed, and -1 if it is <CODE>NULL</CODE>.


<PRE>
mysql&#62; SET @mls = 'MultiLineString((1 1,2 2,3 3),(4 4,5 5))';
mysql&#62; SELECT IsClosed(GeomFromText(@mls));
+------------------------------+
| IsClosed(GeomFromText(@mls)) |
+------------------------------+
|                            0 |
+------------------------------+
</PRE>

</DL>



<H4><A NAME="Polygon_property_functions" HREF="manual_toc.html#Polygon_property_functions">18.5.2.5  <CODE>Polygon</CODE> Functions</A></H4>

<DL COMPACT>

<DT><CODE>Area(poly)</CODE>
<DD>
<A NAME="IDX1954"></A>
Returns as a double-precision number the area of the <CODE>Polygon</CODE> value
<CODE>poly</CODE>, as measured in its spatial reference system.


<PRE>
mysql&#62; SET @poly = 'Polygon((0 0,0 3,3 0,0 0),(1 1,1 2,2 1,1 1))';
mysql&#62; SELECT Area(GeomFromText(@poly));
+---------------------------+
| Area(GeomFromText(@poly)) |
+---------------------------+
|                         4 |
+---------------------------+
</PRE>

<DT><CODE>ExteriorRing(poly)</CODE>
<DD>
<A NAME="IDX1955"></A>
Returns the exterior ring of the <CODE>Polygon</CODE> value <CODE>poly</CODE>
as a <CODE>LineString</CODE>.

<PRE>
mysql&#62; SET @poly =
    -&#62; 'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';
mysql&#62; SELECT AsText(ExteriorRing(GeomFromText(@poly)));
+-------------------------------------------+
| AsText(ExteriorRing(GeomFromText(@poly))) |
+-------------------------------------------+
| LINESTRING(0 0,0 3,3 3,3 0,0 0)           |
+-------------------------------------------+
</PRE>

<DT><CODE>InteriorRingN(poly,n)</CODE>
<DD>
<A NAME="IDX1956"></A>
Returns the <CODE>n</CODE>-th interior ring for the <CODE>Polygon</CODE> value
<CODE>poly</CODE> as a <CODE>LineString</CODE>.
Ring numbers begin at 1.

<PRE>
mysql&#62; SET @poly =
    -&#62; 'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';
mysql&#62; SELECT AsText(InteriorRingN(GeomFromText(@poly),1));
+----------------------------------------------+
| AsText(InteriorRingN(GeomFromText(@poly),1)) |
+----------------------------------------------+
| LINESTRING(1 1,1 2,2 2,2 1,1 1)              |
+----------------------------------------------+
</PRE>

<DT><CODE>NumInteriorRings(poly)</CODE>
<DD>
<A NAME="IDX1957"></A>
Returns the number of interior rings in the <CODE>Polygon</CODE> value <CODE>poly</CODE>.

<PRE>
mysql&#62; SET @poly =
    -&#62; 'Polygon((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1))';
mysql&#62; SELECT NumInteriorRings(GeomFromText(@poly));
+---------------------------------------+
| NumInteriorRings(GeomFromText(@poly)) |
+---------------------------------------+
|                                     1 |
+---------------------------------------+
</PRE>

</DL>



<H4><A NAME="Multipolygon_property_functions" HREF="manual_toc.html#Multipolygon_property_functions">18.5.2.6  <CODE>MultiPolygon</CODE> Functions</A></H4>

<DL COMPACT>

<DT><CODE>Area(mpoly)</CODE>
<DD>
<A NAME="IDX1958"></A>

Returns as a double-precision number the area of the <CODE>MultiPolygon</CODE>
value <CODE>mpoly</CODE>, as measured in its spatial reference system.


<PRE>
mysql&#62; SET @mpoly =
    -&#62; 'MultiPolygon(((0 0,0 3,3 3,3 0,0 0),(1 1,1 2,2 2,2 1,1 1)))';
mysql&#62; SELECT Area(GeomFromText(@mpoly));
+----------------------------+
| Area(GeomFromText(@mpoly)) |
+----------------------------+
|                          8 |
+----------------------------+
</PRE>

</DL>

<P>
The OpenGIS specification also defines the following functions, which MySQL
does not implement:

</P>
<DL COMPACT>

<DT><CODE>Centroid(mpoly)</CODE>
<DD>
<A NAME="IDX1959"></A>
Returns the mathematical centroid for the <CODE>MultiPolygon</CODE> value
<CODE>mpoly</CODE> as a <CODE>Point</CODE>.  The result is not guaranteed to be on
the <CODE>MultiPolygon</CODE>.

<DT><CODE>PointOnSurface(mpoly)</CODE>
<DD>
<A NAME="IDX1960"></A>
Returns a <CODE>Point</CODE> value that is guaranteed to be on the
<CODE>MultiPolygon</CODE> value <CODE>mpoly</CODE>.

</DL>



<H4><A NAME="Geometrycollection_property_functions" HREF="manual_toc.html#Geometrycollection_property_functions">18.5.2.7  <CODE>GeometryCollection</CODE> Functions</A></H4>

<DL COMPACT>

<DT><CODE>GeometryN(gc,n)</CODE>
<DD>
<A NAME="IDX1961"></A>
Returns the <CODE>n</CODE>-th geometry in the <CODE>GeometryCollection</CODE> value
<CODE>gc</CODE>.  Geometry numbers begin at 1.


<PRE>
mysql&#62; SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';
mysql&#62; SELECT AsText(GeometryN(GeomFromText(@gc),1));
+----------------------------------------+
| AsText(GeometryN(GeomFromText(@gc),1)) |
+----------------------------------------+
| POINT(1 1)                             |
+----------------------------------------+
</PRE>

<DT><CODE>NumGeometries(gc)</CODE>
<DD>
<A NAME="IDX1962"></A>
Returns the number of geometries in the <CODE>GeometryCollection</CODE> value
<CODE>gc</CODE>.


<PRE>
mysql&#62; SET @gc = 'GeometryCollection(Point(1 1),LineString(2 2, 3 3))';
mysql&#62; SELECT NumGeometries(GeomFromText(@gc));
+----------------------------------+
| NumGeometries(GeomFromText(@gc)) |
+----------------------------------+
|                                2 |
+----------------------------------+
</PRE>

</DL>



<H3><A NAME="Functions_that_create_new_geometries_from_existing_ones" HREF="manual_toc.html#Functions_that_create_new_geometries_from_existing_ones">18.5.3  Functions That Create New Geometries from Existing Ones</A></H3>



<H4><A NAME="Functions_that_produce_new_geometries" HREF="manual_toc.html#Functions_that_produce_new_geometries">18.5.3.1  Geometry Functions That Produce New Geometries</A></H4>

<P>
In the section section <A HREF="manual.html#Geometry_property_functions">18.5.2  <CODE>Geometry</CODE> Functions</A>,
we've already discussed some functions that can construct new geometries
from the existing ones:

</P>

<UL>
<LI><CODE>Envelope(g)</CODE>

<LI><CODE>StartPoint(ls)</CODE>

<LI><CODE>EndPoint(ls)</CODE>

<LI><CODE>PointN(ls,n)</CODE>

<LI><CODE>ExteriorRing(poly)</CODE>

<LI><CODE>InteriorRingN(poly,n)</CODE>

<LI><CODE>GeometryN(gc,n)</CODE>

</UL>



<H4><A NAME="Spatial_operators" HREF="manual_toc.html#Spatial_operators">18.5.3.2  Spatial Operators</A></H4>

<P>
OpenGIS proposes a number of other functions that can produce
geometries. They are designed to implement spatial operators.

</P>
<P>
These functions are not implemented in MySQL.
They may appear in future releases.

</P>
<DL COMPACT>

<DT><CODE>Buffer(g,d)</CODE>
<DD>
<A NAME="IDX1963"></A>
Returns a geometry that represents all points whose distance from the geometry
value <CODE>g</CODE> is less than or equal to a distance of <CODE>d</CODE>.

<DT><CODE>ConvexHull(g)</CODE>
<DD>
<A NAME="IDX1964"></A>
Returns a geometry that represents the convex hull of the geometry value
<CODE>g</CODE>.

<DT><CODE>Difference(g1,g2)</CODE>
<DD>
<A NAME="IDX1965"></A>
Returns a geometry that represents the point set difference of the geometry
value <CODE>g1</CODE> with <CODE>g2</CODE>.

<DT><CODE>Intersection(g1,g2)</CODE>
<DD>
<A NAME="IDX1966"></A>
Returns a geometry that represents the point set intersection of the geometry
values <CODE>g1</CODE> with <CODE>g2</CODE>.

<DT><CODE>SymDifference(g1,g2)</CODE>
<DD>
<A NAME="IDX1967"></A>
Returns a geometry that represents the point set symmetric difference of the
geometry value <CODE>g1</CODE> with <CODE>g2</CODE>.

<DT><CODE>Union(g1,g2)</CODE>
<DD>
<A NAME="IDX1968"></A>
Returns a geometry that represents the point set union of the geometry values
<CODE>g1</CODE> and <CODE>g2</CODE>.

</DL>



<H3><A NAME="Functions_for_testing_spatial_relations_between_geometric_objects" HREF="manual_toc.html#Functions_for_testing_spatial_relations_between_geometric_objects">18.5.4  Functions for Testing Spatial Relations Between Geometric Objects</A></H3>

<P>
The functions described in these sections take two geometries as input
parameters and return a qualitative or quantitative relation between them.

</P>


<H3><A NAME="Relations_on_geometry_MBR" HREF="manual_toc.html#Relations_on_geometry_MBR">18.5.5  Relations on Geometry Minimal Bounding Rectangles (MBRs)</A></H3>

<P>
<A NAME="IDX1969"></A>
<A NAME="IDX1970"></A>

</P>

<P>
MySQL provides some functions that can test relations
between minimal bounding rectangles of two geometries <CODE>g1</CODE> and <CODE>g2</CODE>.
They include:

</P>
<DL COMPACT>

<DT><CODE>MBRContains(g1,g2)</CODE>
<DD>
<A NAME="IDX1971"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangle of
<CODE>g1</CODE> contains the Minimum Bounding Rectangle of <CODE>g2</CODE>.


<PRE>
mysql&#62; SET @g1 = GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');
mysql&#62; SET @g2 = GeomFromText('Point(1 1)');
mysql&#62; SELECT MBRContains(@g1,@g2), MBRContains(@g2,@g1);
----------------------+----------------------+
| MBRContains(@g1,@g2) | MBRContains(@g2,@g1) |
+----------------------+----------------------+
|                    1 |                    0 |
+----------------------+----------------------+
</PRE>

<DT><CODE>MBRDisjoint(g1,g2)</CODE>
<DD>
<A NAME="IDX1972"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangles of
the two geometries <CODE>g1</CODE> and <CODE>g2</CODE> are disjoint (do not intersect).

<DT><CODE>MBREqual(g1,g2)</CODE>
<DD>
<A NAME="IDX1973"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangles of
the two geometries <CODE>g1</CODE> and <CODE>g2</CODE> are the same.

<DT><CODE>MBRIntersects(g1,g2)</CODE>
<DD>
<A NAME="IDX1974"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangles of
the two geometries <CODE>g1</CODE> and <CODE>g2</CODE> intersect.

<DT><CODE>MBROverlaps(g1,g2)</CODE>
<DD>
<A NAME="IDX1975"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangles of
the two geometries <CODE>g1</CODE> and <CODE>g2</CODE> overlap.

<DT><CODE>MBRTouches(g1,g2)</CODE>
<DD>
<A NAME="IDX1976"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangles of
the two geometries <CODE>g1</CODE> and <CODE>g2</CODE> touch.

<DT><CODE>MBRWithin(g1,g2)</CODE>
<DD>
<A NAME="IDX1977"></A>
Returns 1 or 0 to indicate whether or not the Minimum Bounding Rectangle
of <CODE>g1</CODE> is within the Minimum Bounding Rectangle of <CODE>g2</CODE>.


<PRE>
mysql&#62; SET @g1 = GeomFromText('Polygon((0 0,0 3,3 3,3 0,0 0))');
mysql&#62; SET @g2 = GeomFromText('Polygon((0 0,0 5,5 5,5 0,0 0))');
mysql&#62; SELECT MBRWithin(@g1,@g2), MBRWithin(@g2,@g1);
+--------------------+--------------------+
| MBRWithin(@g1,@g2) | MBRWithin(@g2,@g1) |
+--------------------+--------------------+
|                  1 |                  0 |
+--------------------+--------------------+
</PRE>

</DL>



<H3><A NAME="Functions_that_test_spatial_relationships_between_geometries" HREF="manual_toc.html#Functions_that_test_spatial_relationships_between_geometries">18.5.6  Functions That Test Spatial Relationships Between Geometries</A></H3>

<P>
The OpenGIS specification defines the following functions. Currently,
MySQL does not implement them according to the specification. Those that
are implemented return the same result as the corresponding
MBR-based functions.  This includes functions in the following list
other than <CODE>Distance()</CODE> and <CODE>Related()</CODE>.

</P>

<P>
These functions may be implemented in future releases with full
support for spatial analysis, not just MBR-based support.

</P>
<P>
The functions operate on two geometry values <CODE>g1</CODE> and <CODE>g2</CODE>.

</P>
<DL COMPACT>

<DT><CODE>Contains(g1,g2)</CODE>
<DD>
<A NAME="IDX1978"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> completely contains
<CODE>g2</CODE>.

<DT><CODE>Crosses(g1,g2)</CODE>
<DD>
<A NAME="IDX1979"></A>
Returns 1 if <CODE>g1</CODE> spatially crosses <CODE>g2</CODE>.
Returns <CODE>NULL</CODE> if <CODE>g1</CODE> is a <CODE>Polygon</CODE> or a <CODE>MultiPolygon</CODE>,
or if <CODE>g2</CODE> is a <CODE>Point</CODE> or a <CODE>MultiPoint</CODE>.
Otherwise, returns 0.

The term <EM>spatially crosses</EM> denotes a spatial relation between two given
geometries that has the following properties:


<UL>

<LI>

The two geometries intersect

<LI>

Their intersection results in a geometry that has
a dimension that is one less than the maximum dimension of the two given
geometries

<LI>

Their intersection is not equal to either of the two given geometries

</UL>

<DT><CODE>Disjoint(g1,g2)</CODE>
<DD>
<A NAME="IDX1980"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> is spatially disjoint
from (does not intersect) <CODE>g2</CODE>.

<DT><CODE>Distance(g1,g2)</CODE>
<DD>
<A NAME="IDX1981"></A>
Returns as a double-precision number
the shortest distance between any two points in the two geometries.

<DT><CODE>Equals(g1,g2)</CODE>
<DD>
<A NAME="IDX1982"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> is spatially equal to
<CODE>g2</CODE>.

<DT><CODE>Intersects(g1,g2)</CODE>
<DD>
<A NAME="IDX1983"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> spatially intersects
<CODE>g2</CODE>.

<DT><CODE>Overlaps(g1,g2)</CODE>
<DD>
<A NAME="IDX1984"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> spatially overlaps
<CODE>g2</CODE>.
The term <EM>spatially overlaps</EM> is used if two
geometries intersect and their intersection results in a geometry of the
same dimension but not equal to either of the given geometries.

<DT><CODE>Related(g1,g2,pattern_matrix)</CODE>
<DD>
<A NAME="IDX1985"></A>
Returns 1 or 0 to indicate whether or not the spatial relationship specified
by <CODE>pattern_matrix</CODE> exists between <CODE>g1</CODE> and <CODE>g2</CODE>.
Returns -1 if the arguments are <CODE>NULL</CODE>.
The pattern matrix is a string. Its specification will be noted here if this
function is implemented.

<DT><CODE>Touches(g1,g2)</CODE>
<DD>
<A NAME="IDX1986"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> spatially touches
<CODE>g2</CODE>. Two geometries <EM>spatially touch</EM> if the interiors of
the geometries do not intersect, but the boundary of one of the geometries
intersects either the boundary or the interior of the other.

<DT><CODE>Within(g1,g2)</CODE>
<DD>
<A NAME="IDX1987"></A>
Returns 1 or 0 to indicate whether or not <CODE>g1</CODE> is spatially within
<CODE>g2</CODE>.

</DL>



<H2><A NAME="Optimising_spatial_analysis" HREF="manual_toc.html#Optimising_spatial_analysis">18.6  Optimizing Spatial Analysis</A></H2>

<P>
Search operations in non-spatial databases can be optimized
using indexes. This is true for spatial databases as well.
With the help of a great variety of multi-dimensional indexing methods that
have already been designed, it is possible to optimize
spatial searches. The most typical of these are:

</P>

<UL>

<LI>Point queries that search for all objects that contain a given point

<LI>Region queries that search for all objects that overlap a given region

</UL>

<P>
MySQL uses <STRONG>R-Trees with quadratic splitting</STRONG> to index
spatial columns. A spatial index is built using the MBR of a geometry.
For most geometries, the MBR is a minimum rectangle that
surrounds the geometries. For a horizontal or a vertical
linestring, the MBR is a rectangle degenerated into the linestring.
For a point, the MBR is a rectangle degenerated into the point.

</P>



<H3><A NAME="Creating_spatial_indexes" HREF="manual_toc.html#Creating_spatial_indexes">18.6.1  Creating Spatial Indexes</A></H3>

<P>
MySQL can create spatial indexes using syntax similar to that for creating
regular indexes, but extended with the <CODE>SPATIAL</CODE> keyword.
Spatial columns that are indexed currently must be declared <CODE>NOT NULL</CODE>.
The following examples demonstrate how to create spatial indexes.

</P>

<UL>

<LI>With <CODE>CREATE TABLE</CODE>:


<PRE>
mysql&#62; CREATE TABLE geom (g GEOMETRY NOT NULL, SPATIAL INDEX(g));
</PRE>

<LI>With <CODE>ALTER TABLE</CODE>:


<PRE>
mysql&#62; ALTER TABLE geom ADD SPATIAL INDEX(g);
</PRE>

<LI>With <CODE>CREATE INDEX</CODE>:


<PRE>
mysql&#62; CREATE SPATIAL INDEX sp_index ON geom (g);
</PRE>

</UL>

<P>
To drop spatial indexes, use <CODE>ALTER TABLE</CODE> or <CODE>DROP INDEX</CODE>:

</P>

<UL>

<LI>With <CODE>ALTER TABLE</CODE>:


<PRE>
mysql&#62; ALTER TABLE geom DROP INDEX g;
</PRE>

<LI>With <CODE>DROP INDEX</CODE>:


<PRE>
mysql&#62; DROP INDEX sp_index ON geom;
</PRE>

</UL>

<P>
Example: Suppose that a table <CODE>geom</CODE> contains more than 32,000 geometries,
which are stored in the column <CODE>g</CODE> of type <CODE>GEOMETRY</CODE>.
The table also has an <CODE>AUTO_INCREMENT</CODE> column <CODE>fid</CODE> for storing
object ID values.

</P>

<PRE>
mysql&#62; DESCRIBE geom;
+-------+----------+------+-----+---------+----------------+
| Field | Type     | Null | Key | Default | Extra          |
+-------+----------+------+-----+---------+----------------+
| fid   | int(11)  |      | PRI | NULL    | auto_increment |
| g     | geometry |      |     |         |                |
+-------+----------+------+-----+---------+----------------+
2 rows in set (0.00 sec)

mysql&#62; SELECT COUNT(*) FROM geom;
+----------+
| count(*) |
+----------+
|    32376 |
+----------+
1 row in set (0.00 sec)
</PRE>

<P>
To add a spatial index on the column <CODE>g</CODE>, use this statement:

<PRE>
mysql&#62; ALTER TABLE geom ADD SPATIAL INDEX(g);
Query OK, 32376 rows affected (4.05 sec)
Records: 32376  Duplicates: 0  Warnings: 0
</PRE>



<H3><A NAME="Using_a_spatial_index" HREF="manual_toc.html#Using_a_spatial_index">18.6.2  Using a Spatial Index</A></H3>

<P>
The optimizer investigates whether available spatial indexes can
be involved in the search for queries that use a function such as
<CODE>MBRContains()</CODE> or <CODE>MBRWithin()</CODE> in the <CODE>WHERE</CODE> clause.
For example, let's say we want to find all objects that are in the
given rectangle:

</P>

<PRE>
mysql&#62; SELECT fid,AsText(g) FROM geom WHERE
mysql&#62; MBRContains(GeomFromText('Polygon((30000 15000,31000 15000,31000 16000,30000 16000,30000 15000))'),g);
+-----+-----------------------------------------------------------------------------+
| fid | AsText(g)                                                                   |
+-----+-----------------------------------------------------------------------------+
|  21 | LINESTRING(30350.4 15828.8,30350.6 15845,30333.8 15845,30333.8 15828.8)     |
|  22 | LINESTRING(30350.6 15871.4,30350.6 15887.8,30334 15887.8,30334 15871.4)     |
|  23 | LINESTRING(30350.6 15914.2,30350.6 15930.4,30334 15930.4,30334 15914.2)     |
|  24 | LINESTRING(30290.2 15823,30290.2 15839.4,30273.4 15839.4,30273.4 15823)     |
|  25 | LINESTRING(30291.4 15866.2,30291.6 15882.4,30274.8 15882.4,30274.8 15866.2) |
|  26 | LINESTRING(30291.6 15918.2,30291.6 15934.4,30275 15934.4,30275 15918.2)     |
| 249 | LINESTRING(30337.8 15938.6,30337.8 15946.8,30320.4 15946.8,30320.4 15938.4) |
|   1 | LINESTRING(30250.4 15129.2,30248.8 15138.4,30238.2 15136.4,30240 15127.2)   |
|   2 | LINESTRING(30220.2 15122.8,30217.2 15137.8,30207.6 15136,30210.4 15121)     |
|   3 | LINESTRING(30179 15114.4,30176.6 15129.4,30167 15128,30169 15113)           |
|   4 | LINESTRING(30155.2 15121.4,30140.4 15118.6,30142 15109,30157 15111.6)       |
|   5 | LINESTRING(30192.4 15085,30177.6 15082.2,30179.2 15072.4,30194.2 15075.2)   |
|   6 | LINESTRING(30244 15087,30229 15086.2,30229.4 15076.4,30244.6 15077)         |
|   7 | LINESTRING(30200.6 15059.4,30185.6 15058.6,30186 15048.8,30201.2 15049.4)   |
|  10 | LINESTRING(30179.6 15017.8,30181 15002.8,30190.8 15003.6,30189.6 15019)     |
|  11 | LINESTRING(30154.2 15000.4,30168.6 15004.8,30166 15014.2,30151.2 15009.8)   |
|  13 | LINESTRING(30105 15065.8,30108.4 15050.8,30118 15053,30114.6 15067.8)       |
| 154 | LINESTRING(30276.2 15143.8,30261.4 15141,30263 15131.4,30278 15134)         |
| 155 | LINESTRING(30269.8 15084,30269.4 15093.4,30258.6 15093,30259 15083.4)       |
| 157 | LINESTRING(30128.2 15011,30113.2 15010.2,30113.6 15000.4,30128.8 15001)     |
+-----+-----------------------------------------------------------------------------+
20 rows in set (0.00 sec)
</PRE>

<P>
Now let's use <CODE>EXPLAIN</CODE> to check the way this query is executed:

<PRE>
mysql&#62; EXPLAIN SELECT fid,AsText(g) FROM geom WHERE
mysql&#62; MBRContains(GeomFromText('Polygon((30000 15000,31000 15000,31000 16000,30000 16000,30000 15000))'),g);
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | geom  | range | g             | g    |      32 | NULL |   50 | Using where |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)
</PRE>

<P>
Now let's check what would happen without a spatial index:

<PRE>
mysql&#62; EXPLAIN SELECT fid,AsText(g) FROM g IGNORE INDEX (g) WHERE
mysql&#62; MBRContains(GeomFromText('Polygon((30000 15000,31000 15000,31000 16000,30000 16000,30000 15000))'),g);
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows  | Extra       |
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+
|  1 | SIMPLE      | geom  | ALL  | NULL          | NULL |    NULL | NULL | 32376 | Using where |
+----+-------------+-------+------+---------------+------+---------+------+-------+-------------+
1 row in set (0.00 sec)
</PRE>

<P>
Let's execute the <CODE>SELECT</CODE> statement, ignoring the spatial key we have:

</P>

<PRE>
mysql&#62; SELECT fid,AsText(g) FROM geom IGNORE INDEX (g) WHERE
mysql&#62; MBRContains(GeomFromText('Polygon((30000 15000,31000 15000,31000 16000,30000 16000,30000 15000))'),g);
+-----+-----------------------------------------------------------------------------+
| fid | AsText(g)                                                                   |
+-----+-----------------------------------------------------------------------------+
|   1 | LINESTRING(30250.4 15129.2,30248.8 15138.4,30238.2 15136.4,30240 15127.2)   |
|   2 | LINESTRING(30220.2 15122.8,30217.2 15137.8,30207.6 15136,30210.4 15121)     |
|   3 | LINESTRING(30179 15114.4,30176.6 15129.4,30167 15128,30169 15113)           |
|   4 | LINESTRING(30155.2 15121.4,30140.4 15118.6,30142 15109,30157 15111.6)       |
|   5 | LINESTRING(30192.4 15085,30177.6 15082.2,30179.2 15072.4,30194.2 15075.2)   |
|   6 | LINESTRING(30244 15087,30229 15086.2,30229.4 15076.4,30244.6 15077)         |
|   7 | LINESTRING(30200.6 15059.4,30185.6 15058.6,30186 15048.8,30201.2 15049.4)   |
|  10 | LINESTRING(30179.6 15017.8,30181 15002.8,30190.8 15003.6,30189.6 15019)     |
|  11 | LINESTRING(30154.2 15000.4,30168.6 15004.8,30166 15014.2,30151.2 15009.8)   |
|  13 | LINESTRING(30105 15065.8,30108.4 15050.8,30118 15053,30114.6 15067.8)       |
|  21 | LINESTRING(30350.4 15828.8,30350.6 15845,30333.8 15845,30333.8 15828.8)     |
|  22 | LINESTRING(30350.6 15871.4,30350.6 15887.8,30334 15887.8,30334 15871.4)     |
|  23 | LINESTRING(30350.6 15914.2,30350.6 15930.4,30334 15930.4,30334 15914.2)     |
|  24 | LINESTRING(30290.2 15823,30290.2 15839.4,30273.4 15839.4,30273.4 15823)     |
|  25 | LINESTRING(30291.4 15866.2,30291.6 15882.4,30274.8 15882.4,30274.8 15866.2) |
|  26 | LINESTRING(30291.6 15918.2,30291.6 15934.4,30275 15934.4,30275 15918.2)     |
| 154 | LINESTRING(30276.2 15143.8,30261.4 15141,30263 15131.4,30278 15134)         |
| 155 | LINESTRING(30269.8 15084,30269.4 15093.4,30258.6 15093,30259 15083.4)       |
| 157 | LINESTRING(30128.2 15011,30113.2 15010.2,30113.6 15000.4,30128.8 15001)     |
| 249 | LINESTRING(30337.8 15938.6,30337.8 15946.8,30320.4 15946.8,30320.4 15938.4) |
+-----+-----------------------------------------------------------------------------+
20 rows in set (0.46 sec)
</PRE>

<P>
When the index is not used, the execution time for this query rises from
0.00 seconds to 0.46 seconds.

</P>
<P>
In future releases, spatial indexes may also be used for optimizing
other functions.
See section <A HREF="manual.html#Functions_for_testing_spatial_relations_between_geometric_objects">18.5.4  Functions for Testing Spatial Relations Between Geometric Objects</A>.

</P>



<H2><A NAME="MySQL_GIS_conformance_and_compatibility" HREF="manual_toc.html#MySQL_GIS_conformance_and_compatibility">18.7  MySQL Conformance and Compatibility</A></H2>



<H3><A NAME="GIS_features_that_are_not_yet_implemented" HREF="manual_toc.html#GIS_features_that_are_not_yet_implemented">18.7.1  GIS Features That Are Not Yet Implemented</A></H3>

<DL COMPACT>

<DT>Additional Metadata Views
<DD>
OpenGIS specifications propose several additional metadata views.
For example, a system view named <CODE>GEOMETRY_COLUMNS</CODE> contains a
description of geometry columns, one row for each geometry column
in the database.

<DT>The OpenGIS function <CODE>Length()</CODE> on <CODE>LineString</CODE> and <CODE>MultiLineString</CODE> currently should be called in MySQL as <CODE>GLength()</CODE>
<DD>
The problem is that there is an existing SQL function
<CODE>Length()</CODE> which calculates the length of string values,
and sometimes it is not possible to distinguish whether the function is
called in a textual or spatial context. We need either to solve this
somehow, or decide on another function name.
</DL>



<H1><A NAME="Stored_Procedures" HREF="manual_toc.html#Stored_Procedures">19  Stored Procedures and Functions</A></H1>

<P>
<A NAME="IDX1988"></A>
<A NAME="IDX1989"></A>

</P>
<P>
Stored procedures and functions are a new feature in MySQL version 5.0.
A stored procedure is a set of SQL statements that can be stored in the server.
Once this has been done, clients don't need to keep reissuing the individual
statements but can refer to the stored procedure instead.

</P>
<P>
Stored procedures can provide improved performance because less information
needs to be sent between the server and the client. The tradeoff is that
this does increase the load on the database server system because more of
the work is done on the server side and less is done on the client
(application) side. And, often, there are multiple client machines (such as
Web servers) but only one or a few database servers.

</P>
<P>
Stored procedures also allow you to have libraries of functions in the
database server. However, modern application languages
already allow such design internally with, for example, classes. Using
these client application language features is beneficial for the programmer
even outside the scope of database use.

</P>
<P>
Some situations where stored procedures can be particularly useful:

<UL>
<LI>

When multiple client applications are written in different languages or work
on different platforms, but need to perform the same database operations.
<LI>

When security is paramount. Banks, for example, use stored procedures for
all common operations. This provides a consistent and secure environment,
and procedures can ensure that each operation is properly logged.
In such a setup, applications and users would not get any access to the
database tables directly, but can only execute specific stored procedures.
</UL>

<P>
MySQL follows the SQL:2003 syntax for stored procedures, which is also used
by IBM's DB2.

</P>
<P>
The MySQL implementation of stored procedures is still in progress. All
syntax described in this chapter is supported and any limitations and
extensions are documented where appropriate.

</P>
<P>
Stored procedures require the <CODE>proc</CODE> table in the <CODE>mysql</CODE> database.
This table is created during the MySQL 5.0 installation procedure.
If you are upgrading to MySQL 5.0 from an earlier version, be sure to update
your grant tables to make sure that the <CODE>proc</CODE> table exists.
See section <A HREF="manual.html#Upgrading-grant-tables">2.5.8  Upgrading the Grant Tables</A>.

</P>



<H2><A NAME="Stored_Procedure_Syntax" HREF="manual_toc.html#Stored_Procedure_Syntax">19.1  Stored Procedure Syntax</A></H2>

<P>
Stored procedures and functions are routines that are created with
<CODE>CREATE PROCEDURE</CODE> and <CODE>CREATE FUNCTION</CODE> statements.
A procedure is invoked using a <CODE>CALL</CODE> statement, and can only
pass back values using output variables.  Functions may return a
scalar value and can be called from inside a statement just like any other
function (that is, by invoking the function's name).
Stored routines may call other stored routines. A routine is either a
procedure or a function.

</P>
<P>
At present, MySQL only preserves context for the default database. That is,
if you say <CODE>USE db_name</CODE> within a procedure, the original default
database is restored upon routine exit.
A routine inherits the default database from the caller, so generally routines
should either issue a <CODE>USE db_name</CODE> statement, or specify all tables
with an explicit database reference; for example, <CODE>db_name.tbl_name</CODE>.

</P>
<P>
MySQL supports the very useful extension that allows the use of regular
<CODE>SELECT</CODE> statements (that is, without using cursors or local variables)
inside a stored procedure. The result set of such a query is simply sent
directly to the client.
Multiple <CODE>SELECT</CODE> statements generate multiple result sets, so the client
must use a MySQL client library that supports multiple result sets. This means
the client must use a client library from a version of MySQL at least as
recent as 4.1.

</P>
<P>
This following section describes the syntax used to create, alter, drop, and
query stored procedures and functions.

</P>



<H3><A NAME="Maintaining_Stored_Procedures" HREF="manual_toc.html#Maintaining_Stored_Procedures">19.1.1  Maintaining Stored Procedures</A></H3>



<H4><A NAME="CREATE_PROCEDURE" HREF="manual_toc.html#CREATE_PROCEDURE">19.1.1.1  <CODE>CREATE PROCEDURE</CODE> and <CODE>CREATE FUNCTION</CODE></A></H4>

<P>
<A NAME="IDX1990"></A>
<A NAME="IDX1991"></A>

</P>

<PRE>
CREATE PROCEDURE sp_name ([parameter[,...]])
    [characteristic ...] routine_body

CREATE FUNCTION sp_name ([parameter[,...]])
    [RETURNS type]
    [characteristic ...] routine_body

parameter:
    [ IN | OUT | INOUT ] param_name type

type:
    Any valid MySQL data type

characteristic:
    LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | SQL SECURITY {DEFINER | INVOKER}
  | COMMENT string

routine_body:
    Valid SQL procedure statement(s)
</PRE>

<P>
The <CODE>RETURNS</CODE> clause may be specified only for a <CODE>FUNCTION</CODE>.
It is used to indicate the return type of the function, and the function
body must contain a <CODE>RETURN value</CODE> statement.

</P>
<P>
The parameter list enclosed within parentheses must always be present.
If there are no parameters, an empty parameter list of <CODE>()</CODE> should
be used.  Each parameter is an <CODE>IN</CODE> parameter by default. To specify
otherwise for a parameter, use the keyword <CODE>OUT</CODE> or <CODE>INOUT</CODE> before
the parameter name. Specifying <CODE>IN</CODE>, <CODE>OUT</CODE>, or <CODE>INOUT</CODE> is only
valid for a <CODE>PROCEDURE</CODE>.

</P>
<P>
The <CODE>CREATE FUNCTION</CODE> statement is used in
earlier versions of MySQL to support UDFs (User Defined Functions).
See section <A HREF="manual.html#Adding_functions">22.2  Adding New Functions to MySQL</A>.
UDFs continue to be supported, even with the existence of stored functions.
A UDF can be regarded as an external stored function.  However, do
note that stored functions share their namespace with UDFs.

</P>
<P>
A framework for external stored procedures will be introduced in the near
future. This will allow you to write stored procedures in languages other
than SQL.
Most likely, one of the first languages to be supported will be PHP because the
core PHP engine is small, thread-safe, and can easily be embedded. Because the
framework will be public, it is expected that many other languages will also
be supported.

</P>
<P>
A function is considered ``deterministic'' if it always returns the same
result for the same input parameters, and ``not deterministic'' otherwise.
Currently, the <CODE>DETERMINISTIC</CODE> characteristic is accepted, but not yet
used by the optimizer.

</P>
<P>
The <CODE>SQL SECURITY</CODE> characteristic can be used to specify whether the
routine should be executed using the permissions of the user who creates
the routine or the user who invokes it.
The default value is <CODE>DEFINER</CODE>.
This feature is new in SQL:2003.

</P>
<P>
MySQL does not yet use the <CODE>GRANT EXECUTE</CODE> privilege.

</P>
<P>
MySQL stores the <CODE>sql_mode</CODE> system variable setting that is in effect
at the time a routine is created, and will always execute the routine with
this setting in force.

</P>
<P>
The <CODE>COMMENT</CODE> clause is a MySQL extension, and may be used to describe
the stored procedure. This information is displayed by the
<CODE>SHOW CREATE PROCEDURE</CODE> and <CODE>SHOW CREATE FUNCTION</CODE> statements.

</P>
<P>
MySQL allows routines to contain DDL statements (such as <CODE>CREATE</CODE> and
 <CODE>DROP</CODE>) and SQL transaction statements (such as <CODE>COMMIT</CODE>). This is
not required by the standard and is therefore implementation-specific.

</P>
<P>
<STRONG>Note:</STRONG>
Currently, stored functions created with <CODE>CREATE FUNCTION</CODE> may not contain references to tables.
Please note that this includes some <CODE>SET</CODE> statements, but excludes some
<CODE>SELECT</CODE> statements.
This limitation will be lifted as soon as possible.

</P>
<P>
The following is an example of a simple stored procedure that uses
an <CODE>OUT</CODE> parameter.
The example uses the <CODE>mysql</CODE> client <CODE>delimiter</CODE> command to change
the statement delimiter from <CODE>;</CODE> to <CODE>//</CODE> while the procedure is
being defined.
This allows the <CODE>;</CODE> delimiter used in the procedure body to be passed
through to the server rather than being interpreted by <CODE>mysql</CODE> itself.

</P>

<PRE>
mysql&#62; delimiter //

mysql&#62; CREATE PROCEDURE simpleproc (OUT param1 INT)
    -&#62; BEGIN
    -&#62;   SELECT COUNT(*) INTO param1 FROM t;
    -&#62; END
    -&#62; //
Query OK, 0 rows affected (0.00 sec)

mysql&#62; delimiter ;

mysql&#62; CALL simpleproc(@a);
Query OK, 0 rows affected (0.00 sec)

mysql&#62; SELECT @a;
+------+
| @a   |
+------+
| 3    |
+------+
1 row in set (0.00 sec)
</PRE>

<P>
The following is an example of a function that takes a parameter,
performs an operation using an SQL function, and returns the result:

</P>

<PRE>
mysql&#62; delimiter //

mysql&#62; CREATE FUNCTION hello (s CHAR(20)) RETURNS CHAR(50)
    -&#62; RETURN CONCAT('Hello, ',s,'!');
    -&#62; //
Query OK, 0 rows affected (0.00 sec)

mysql&#62; delimiter ;

mysql&#62; SELECT hello('world');
+----------------+
| hello('world') |
+----------------+
| Hello, world!  |
+----------------+
1 row in set (0.00 sec)
</PRE>



<H4><A NAME="ALTER_PROCEDURE" HREF="manual_toc.html#ALTER_PROCEDURE">19.1.1.2  <CODE>ALTER PROCEDURE</CODE> and <CODE>ALTER FUNCTION</CODE></A></H4>

<P>
<A NAME="IDX1992"></A>
<A NAME="IDX1993"></A>

</P>

<PRE>
ALTER {PROCEDURE | FUNCTION} sp_name [characteristic ...]

characteristic:
    NAME new_name
  | SQL SECURITY {DEFINER | INVOKER}
  | COMMENT string
</PRE>

<P>
This statement can be used to rename a stored procedure or function, and to
change its characteristics. More than one change may be specified in an
<CODE>ALTER PROCEDURE</CODE> or <CODE>ALTER FUNCTION</CODE> statement.

</P>



<H4><A NAME="DROP_PROCEDURE" HREF="manual_toc.html#DROP_PROCEDURE">19.1.1.3  <CODE>DROP PROCEDURE</CODE> and <CODE>DROP FUNCTION</CODE></A></H4>

<P>
<A NAME="IDX1994"></A>
<A NAME="IDX1995"></A>

</P>

<PRE>
DROP {PROCEDURE | FUNCTION} [IF EXISTS] sp_name
</PRE>

<P>
This statement is used to drop a stored procedure or function. That is, the
specified routine is removed from the server.

</P>
<P>
The <CODE>IF EXISTS</CODE> clause is a MySQL extension.
It prevents an error from occurring if the procedure or function does not
exist. A warning is produced that can be viewed with <CODE>SHOW WARNINGS</CODE>.

</P>



<H4><A NAME="SHOW_CREATE_PROCEDURE" HREF="manual_toc.html#SHOW_CREATE_PROCEDURE">19.1.1.4  <CODE>SHOW CREATE PROCEDURE</CODE> and <CODE>SHOW CREATE FUNCTION</CODE></A></H4>

<P>
<A NAME="IDX1996"></A>
<A NAME="IDX1997"></A>

</P>

<PRE>
SHOW CREATE {PROCEDURE | FUNCTION} sp_name
</PRE>

<P>
This statement is a MySQL extension. Similar to <CODE>SHOW CREATE TABLE</CODE>, it
returns the exact string that can be used to re-create the named routine.

</P>



<H3><A NAME="SHOW_PROCEDURE_STATUS" HREF="manual_toc.html#SHOW_PROCEDURE_STATUS">19.1.2  <CODE>SHOW PROCEDURE STATUS</CODE> and <CODE>SHOW FUNCTION STATUS</CODE></A></H3>

<P>
<A NAME="IDX1998"></A>
<A NAME="IDX1999"></A>

</P>

<PRE>
SHOW {PROCEDURE | FUNCTION} STATUS [LIKE 'pattern']
</PRE>

<P>
This statement is a MySQL extension. It returns characteristics of routines,
such as the name, type, creator, and creation and modification dates. If no
pattern is specified, the information for all stored procedures or all stored
functions is listed, depending on which statement you use.

</P>



<H3><A NAME="CALL" HREF="manual_toc.html#CALL">19.1.3  <CODE>CALL</CODE></A></H3>

<P>
<A NAME="IDX2000"></A>

</P>

<PRE>
CALL sp_name([parameter[,...]])
</PRE>

<P>
The <CODE>CALL</CODE> statement is used to invoke a routine that was defined
previously with <CODE>CREATE PROCEDURE</CODE>.

</P>



<H3><A NAME="BEGIN_END" HREF="manual_toc.html#BEGIN_END">19.1.4  <CODE>BEGIN ... END</CODE> Compound Statement</A></H3>

<P>
<A NAME="IDX2001"></A>
<A NAME="IDX2002"></A>

</P>

<PRE>
[begin_label:] BEGIN
    statement(s)
END [end_label]
</PRE>

<P>
Stored routines may contain multiple statements, using a
<CODE>BEGIN ... END</CODE> compound statement.

</P>
<P>
<CODE>begin_label</CODE> and <CODE>end_label</CODE> must be the same, if both are
specified.

</P>
<P>
Please note that the optional <CODE>[NOT] ATOMIC</CODE> clause is not yet
supported. This means that no transactional savepoint is set at the start of
the instruction block and the <CODE>BEGIN</CODE> clause used in this context has
no effect on the current transaction.

</P>
<P>
Using multiple statements requires that a client is able to send query
strings containing the <CODE>;</CODE> statement delimiter. This is handled in the
<CODE>mysql</CODE> command-line client with the <CODE>delimiter</CODE> command. Changing
the <CODE>;</CODE> end-of-query delimiter (for example, to <CODE>//</CODE>) allows
<CODE>;</CODE> to be used in a routine body.

</P>



<H3><A NAME="DECLARE" HREF="manual_toc.html#DECLARE">19.1.5  <CODE>DECLARE</CODE> Statement</A></H3>

<P>
<A NAME="IDX2003"></A>

</P>
<P>
The <CODE>DECLARE</CODE> statement is used to define various items local to a
routine:
local variables (see section <A HREF="manual.html#Variables_in_Stored_Procedures">19.1.6  Variables in Stored Procedures</A>),
conditions and handlers (see section <A HREF="manual.html#Conditions_and_Handlers">19.1.7  Conditions and Handlers</A>) and
cursors (see section <A HREF="manual.html#Cursors">19.1.8  Cursors</A>).
<CODE>SIGNAL</CODE> and <CODE>RESIGNAL</CODE> statements are not currently supported.

</P>
<P>
<CODE>DECLARE</CODE> may be used only inside a <CODE>BEGIN ... END</CODE> compound
statement and must be at its start, before any other statements.

</P>



<H3><A NAME="Variables_in_Stored_Procedures" HREF="manual_toc.html#Variables_in_Stored_Procedures">19.1.6  Variables in Stored Procedures</A></H3>

<P>
You may declare and use variables within a routine.

</P>



<H4><A NAME="DECLARE_Local_Variables" HREF="manual_toc.html#DECLARE_Local_Variables">19.1.6.1  <CODE>DECLARE</CODE> Local Variables</A></H4>


<PRE>
DECLARE var_name[,...] type [DEFAULT value]
</PRE>

<P>
This statement is used to declare local variables. The scope of a variable is
within the <CODE>BEGIN ... END</CODE> block.

</P>



<H4><A NAME="SET_Statement" HREF="manual_toc.html#SET_Statement">19.1.6.2  Variable <CODE>SET</CODE> Statement</A></H4>

<P>
<A NAME="IDX2004"></A>

</P>

<PRE>
SET var_name = expression [,...]
</PRE>

<P>
The <CODE>SET</CODE> statement in stored procedures is an extended version of
the general <CODE>SET</CODE> statement. Referenced variables may be ones declared
inside a routine, or global server variables.

</P>
<P>
The <CODE>SET</CODE> statement in stored procedures is implemented as part of the
pre-existing <CODE>SET</CODE> syntax. This allows an extended syntax of
<CODE>SET a=x, b=y, ...</CODE> where different variable types (locally declared
variables, server variables, and global and session server variables) can be
mixed. This also allows combinations of local variables and some options
that make sense only for global/system variables; in that case, the options
are accepted but ignored.

</P>



<H4><A NAME="SELECT_INTO_Statement" HREF="manual_toc.html#SELECT_INTO_Statement">19.1.6.3  <CODE>SELECT ... INTO</CODE> Statement</A></H4>

<P>
<A NAME="IDX2005"></A>

</P>

<PRE>
SELECT col_name[,...] INTO var_name[,...] table_expression
</PRE>

<P>
This <CODE>SELECT</CODE> syntax stores selected columns directly into variables.
Therefore, only a single row may be retrieved. This statement is also
extremely useful when used in combination with cursors.

</P>

<PRE>
SELECT id,data INTO x,y FROM test.t1 LIMIT 1;
</PRE>



<H3><A NAME="Conditions_and_Handlers" HREF="manual_toc.html#Conditions_and_Handlers">19.1.7  Conditions and Handlers</A></H3>

<P>
Certain conditions may require specific handling. These conditions can relate
to errors, as well as general flow control inside a routine.

</P>



<H4><A NAME="DECLARE_Conditions" HREF="manual_toc.html#DECLARE_Conditions">19.1.7.1  <CODE>DECLARE</CODE> Conditions</A></H4>

<P>
<A NAME="IDX2006"></A>

</P>

<PRE>
DECLARE condition_name CONDITION FOR condition_value

condition_value:
    SQLSTATE [VALUE] sqlstate_value
  | mysql_error_code
</PRE>

<P>
This statement specifies conditions that will need
specific handling. It associates a name with a specified error
condition. The name can subsequently be used in a
<CODE>DECLARE HANDLER</CODE> statement. See section <A HREF="manual.html#DECLARE_Handlers">19.1.7.2  <CODE>DECLARE</CODE> Handlers</A>.

</P>
<P>
In addition to SQLSTATE values, MySQL error codes are also supported.

</P>



<H4><A NAME="DECLARE_Handlers" HREF="manual_toc.html#DECLARE_Handlers">19.1.7.2  <CODE>DECLARE</CODE> Handlers</A></H4>

<P>
<A NAME="IDX2007"></A>

</P>

<PRE>
DECLARE handler_type HANDLER FOR condition_value[,...] sp_statement

handler_type:
    CONTINUE
  | EXIT
  | UNDO

condition_value:
    SQLSTATE [VALUE] sqlstate_value
  | condition_name
  | SQLWARNING
  | NOT FOUND
  | SQLEXCEPTION
  | mysql_error_code
</PRE>

<P>
This statement specifies handlers that each may deal with
one or more conditions. If one of these conditions occurs, the specified
statement is executed.

</P>
<P>
For a <CODE>CONTINUE</CODE> handler, execution of the current routine continues
after execution of the handler statement.
For an <CODE>EXIT</CODE> handler, execution of the current <CODE>BEGIN...END</CODE>
compound statement is terminated.
The <CODE>UNDO</CODE> <CODE>handler_type</CODE> statement is not yet supported.

</P>

<UL>
<LI>

<CODE>SQLWARNING</CODE> is shorthand for all SQLSTATE codes that begin with <CODE>01</CODE>.
<LI>

<CODE>NOT FOUND</CODE> is shorthand for all SQLSTATE codes that begin with <CODE>02</CODE>.
<LI>

<CODE>SQLEXCEPTION</CODE> is shorthand for all SQLSTATE codes not caught by
<CODE>SQLWARNING</CODE> or <CODE>NOT FOUND</CODE>.
</UL>

<P>
In addition to SQLSTATE values, MySQL error codes are also supported.

</P>

<P>
For example:

</P>

<PRE>
mysql&#62; CREATE TABLE test.t (s1 int,primary key (s1));
Query OK, 0 rows affected (0.00 sec)

mysql&#62; delimiter //

mysql&#62; CREATE PROCEDURE handlerdemo ()
    -&#62; BEGIN
    -&#62;   DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @x2 = 1;
    -&#62;   SET @x = 1;
    -&#62;   INSERT INTO test.t VALUES (1);
    -&#62;   SET @x = 2;
    -&#62;   INSERT INTO test.t VALUES (1);
    -&#62;   SET @x = 3;
    -&#62; END;
    -&#62; //
Query OK, 0 rows affected (0.00 sec)

mysql&#62; CALL handlerdemo()//
Query OK, 0 rows affected (0.00 sec)

mysql&#62; SELECT @x//
    +------+
    | @x   |
    +------+
    | 3    |
    +------+
    1 row in set (0.00 sec)
</PRE>

<P>
Notice that <CODE>@x</CODE> is <CODE>3</CODE>, which shows that MySQL executed to the end of
the procedure. If the line
<CODE>DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @x2 = 1;</CODE>
had not been present, MySQL would have taken the default (<CODE>EXIT</CODE>) path
after the second <CODE>INSERT</CODE> failed due to the <CODE>PRIMARY KEY</CODE>
constraint, and <CODE>SELECT @x</CODE> would have returned <CODE>2</CODE>.

</P>



<H3><A NAME="Cursors" HREF="manual_toc.html#Cursors">19.1.8  Cursors</A></H3>

<P>
<A NAME="IDX2008"></A>

</P>
<P>
Simple cursors are supported inside stored procedures and functions.
The syntax is as in embedded SQL.
Cursors are currently asensitive, read-only, and non-scrolling.
Asensitive means that the server may or may not make a copy of its result
table.

</P>
<P>
For example:

</P>

<PRE>
CREATE PROCEDURE curdemo()
BEGIN
  DECLARE done INT DEFAULT 0;
  DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;
  DECLARE cur1 CURSOR FOR SELECT id,data FROM test.t1;
  DECLARE cur2 CURSOR FOR SELECT i FROM test.t2;
  DECLARE a CHAR(16);
  DECLARE b,c INT;

  OPEN cur1;
  OPEN cur2;

  REPEAT
    FETCH cur1 INTO a, b;
    FETCH cur2 INTO c;
    IF NOT done THEN
       IF b &#60; c THEN
          INSERT INTO test.t3 VALUES (a,b);
       ELSE
          INSERT INTO test.t3 VALUES (a,c);
       END IF;
    END IF;
  UNTIL done END REPEAT;

  CLOSE cur1;
  CLOSE cur2;
END
</PRE>



<H4><A NAME="DECLARE_Cursors" HREF="manual_toc.html#DECLARE_Cursors">19.1.8.1  Declaring Cursors</A></H4>


<PRE>
DECLARE cursor_name CURSOR FOR sql_statement
</PRE>

<P>
Multiple cursors may be defined in a routine, but each must have a unique
name.

</P>



<H4><A NAME="OPEN" HREF="manual_toc.html#OPEN">19.1.8.2  Cursor <CODE>OPEN</CODE> Statement</A></H4>

<P>
<A NAME="IDX2009"></A>

</P>

<PRE>
OPEN cursor_name
</PRE>

<P>
This statement opens a previously declared cursor.

</P>



<H4><A NAME="FETCH" HREF="manual_toc.html#FETCH">19.1.8.3  Cursor <CODE>FETCH</CODE> Statement</A></H4>

<P>
<A NAME="IDX2010"></A>

</P>

<PRE>
FETCH cursor_name
</PRE>

<P>
This statement fetches the next row (if a row exists) using the specified
open cursor, and advances the cursor pointer.

</P>



<H4><A NAME="CLOSE" HREF="manual_toc.html#CLOSE">19.1.8.4  Cursor <CODE>CLOSE</CODE> Statement</A></H4>

<P>
<A NAME="IDX2011"></A>

</P>

<PRE>
CLOSE cursor_name
</PRE>

<P>
This statement closes a previously opened cursor.

</P>



<H3><A NAME="Flow_Control_Constructs" HREF="manual_toc.html#Flow_Control_Constructs">19.1.9  Flow Control Constructs</A></H3>

<P>
The <CODE>IF</CODE>, <CODE>CASE</CODE>, <CODE>LOOP</CODE>, <CODE>WHILE</CODE>, <CODE>ITERATE</CODE>, and
<CODE>LEAVE</CODE> constructs are fully implemented.

</P>
<P>
These constructs may each contain either a single statement, or a block of
statements using the <CODE>BEGIN ... END</CODE> compound statement. Constructs
may be nested.

</P>
<P>
<CODE>FOR</CODE> loops are not currently supported.

</P>



<H4><A NAME="IF_Statement" HREF="manual_toc.html#IF_Statement">19.1.9.1  <CODE>IF</CODE> Statement</A></H4>

<P>
<A NAME="IDX2012"></A>

</P>

<PRE>
IF search_condition THEN statement(s)
    [ELSEIF search_condition THEN statement(s)]
    ...
    [ELSE statement(s)]
END IF
</PRE>

<P>
<CODE>IF</CODE> implements a basic conditional construct. If the
<CODE>search_condition</CODE> evaluates to true, the corresponding SQL statement is
executed. If no <CODE>search_condition</CODE> matches, the statement in the
<CODE>ELSE</CODE> clause is executed.

</P>
<P>
Please note that there is also an <CODE>IF()</CODE> function.
See section <A HREF="manual.html#Control_flow_functions">13.2  Control Flow Functions</A>.

</P>



<H4><A NAME="CASE_Statement" HREF="manual_toc.html#CASE_Statement">19.1.9.2  <CODE>CASE</CODE> Statement</A></H4>

<P>
<A NAME="IDX2013"></A>

</P>

<PRE>
CASE case_value
    WHEN when_value THEN statement
    [WHEN when_value THEN statement ...]
    [ELSE statement]
END CASE
</PRE>

<P>
Or:

</P>

<PRE>
CASE
    WHEN search_condition THEN statement
    [WHEN search_condition THEN statement ...]
    [ELSE statement]
END CASE
</PRE>

<P>
<CODE>CASE</CODE> implements a complex conditional construct. If a
<CODE>search_condition</CODE> evaluates to true, the corresponding SQL statement is executed. If no search condition matches, the statement in the <CODE>ELSE</CODE> clause is executed.

</P>
<P>
<STRONG>Note:</STRONG> The syntax of a <CODE>CASE</CODE> statement inside a stored
procedure differs slightly from that of the SQL <CODE>CASE</CODE> expression. The
<CODE>CASE</CODE> statement cannot have an <CODE>ELSE NULL</CODE> clause, and the
construct is terminated with <CODE>END CASE</CODE> instead of <CODE>END</CODE>.
See section <A HREF="manual.html#Control_flow_functions">13.2  Control Flow Functions</A>.

</P>



<H4><A NAME="LOOP_Statement" HREF="manual_toc.html#LOOP_Statement">19.1.9.3  <CODE>LOOP</CODE> Statement</A></H4>

<P>
<A NAME="IDX2014"></A>

</P>

<PRE>
[begin_label:] LOOP
    statement(s)
END LOOP [end_label]
</PRE>

<P>
<CODE>LOOP</CODE> implements a simple loop construct, enabling repeated execution
of a particular statement or group of statements. The statements within the
loop are repeated until the loop is exited; usually this is accomplished
with a <CODE>LEAVE</CODE> statement.

</P>
<P>
<CODE>begin_label</CODE> and <CODE>end_label</CODE> must be the same, if both are
specified.

</P>



<H4><A NAME="LEAVE_Statement" HREF="manual_toc.html#LEAVE_Statement">19.1.9.4  <CODE>LEAVE</CODE> Statement</A></H4>

<P>
<A NAME="IDX2015"></A>

</P>

<PRE>
LEAVE label
</PRE>

<P>
This statement is used to exit any flow control construct.

</P>



<H4><A NAME="ITERATE_Statement" HREF="manual_toc.html#ITERATE_Statement">19.1.9.5  <CODE>ITERATE</CODE> Statement</A></H4>

<P>
<A NAME="IDX2016"></A>

</P>

<PRE>
ITERATE label
</PRE>

<P>
<CODE>ITERATE</CODE> can only appear within <CODE>LOOP</CODE>, <CODE>REPEAT</CODE>, and
<CODE>WHILE</CODE> statements. <CODE>ITERATE</CODE> means ``do the loop iteration again.''

</P>
<P>
For example:

</P>

<PRE>
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 &#60; 10 THEN ITERATE label1; END IF;
    LEAVE label1;
  END LOOP label1;
  SET @x = p1;
END
</PRE>



<H4><A NAME="REPEAT_Statement" HREF="manual_toc.html#REPEAT_Statement">19.1.9.6  <CODE>REPEAT</CODE> Statement</A></H4>

<P>
<A NAME="IDX2017"></A>
<A NAME="IDX2018"></A>

</P>

<PRE>
[begin_label:] REPEAT
    statement(s)
UNTIL search_condition
END REPEAT [end_label]
</PRE>

<P>
The statements within a <CODE>REPEAT</CODE> statement are repeated until the
<CODE>search_condition</CODE> is true.

</P>
<P>
<CODE>begin_label</CODE> and <CODE>end_label</CODE> must be the same, if both are
specified.

</P>
<P>
For example:

</P>

<PRE>
mysql&#62; delimiter //

mysql&#62; CREATE PROCEDURE dorepeat(p1 INT)
    -&#62; BEGIN
    -&#62;   SET @x = 0;
    -&#62;   REPEAT SET @x = @x + 1; UNTIL @x &#62; p1 END REPEAT;
    -&#62; END
    -&#62; //
Query OK, 0 rows affected (0.00 sec)

mysql&#62; CALL dorepeat(1000)//
Query OK, 0 rows affected (0.00 sec)

mysql&#62; SELECT @x//
+------+
| @x   |
+------+
| 1001 |
+------+
1 row in set (0.00 sec)
</PRE>



<H4><A NAME="WHILE_Statement" HREF="manual_toc.html#WHILE_Statement">19.1.9.7  <CODE>WHILE</CODE> Statement</A></H4>

<P>
<A NAME="IDX2019"></A>

</P>

<PRE>
[begin_label:] WHILE search_condition DO
    statement(s)
END WHILE [end_label]
</PRE>

<P>
The statements within a <CODE>WHILE</CODE> statement are repeated as long as the
<CODE>search_condition</CODE> is true.

</P>
<P>
<CODE>begin_label</CODE> and <CODE>end_label</CODE> must be the same, if both are
specified.

</P>
<P>
For example:

</P>

<PRE>
CREATE PROCEDURE dowhile()
BEGIN
  DECLARE v1 INT DEFAULT 5;

  WHILE v1 &#62; 0 DO
    ...
    SET v1 = v1 - 1;
  END WHILE;
END
</PRE>



<H1><A NAME="Clients" HREF="manual_toc.html#Clients">20  MySQL APIs</A></H1>

<P>
<A NAME="IDX2020"></A>
<A NAME="IDX2021"></A>
<A NAME="IDX2022"></A>
<A NAME="IDX2023"></A>
<A NAME="IDX2024"></A>

</P>

<P>
This chapter describes the APIs available for MySQL, where to get
them, and how to use them.  The C API is the most extensively covered, as it
was developed by the MySQL team, and is the basis for most of the
other APIs.

</P>



<H2><A NAME="Programming_utilities" HREF="manual_toc.html#Programming_utilities">20.1  MySQL Program Development Utilities</A></H2>

<P>
This section describes some utilities that you may find useful when
developing MySQL programs.

</P>
<DL COMPACT>

<DT><CODE>msql2mysql</CODE>
<DD>
<A NAME="IDX2025"></A>
A shell script that converts <CODE>mSQL</CODE> programs to MySQL. It doesn't
handle every case, but it gives a good start when converting.

<DT><CODE>mysql_config</CODE>
<DD>
<A NAME="IDX2026"></A>
A shell script that produces the option values needed when compiling MySQL
programs.

</DL>



<H3><A NAME="msql2mysql" HREF="manual_toc.html#msql2mysql">20.1.1  <CODE>msql2mysql</CODE>, Convert mSQL Programs for Use with MySQL</A></H3>

<P>
Initially, the MySQL C API was developed to be very similar to that for the
mSQL database system. Because of this, mSQL programs often can be converted
relatively easily for use with MySQL by changing the names of the C API
functions.

</P>
<P>
The <CODE>msql2mysql</CODE> utility performs the conversion of mSQL C API function
calls to their MySQL equivalents.
<CODE>msql2mysql</CODE> converts the input file in place, so make a copy of the
original before converting it.  For example, use <CODE>msql2mysql</CODE> like
this:

</P>


<PRE>
shell&#62; cp client-prog.c client-prog.c.orig
shell&#62; msql2mysql client-prog.c
client-prog.c converted
</PRE>

<P>
Then examine <TT>`client-prog.c'</TT> and make any post-conversion revisions
that may be necessary.

</P>
<P>
<CODE>msql2mysql</CODE> uses the <CODE>replace</CODE> utility to make the function name
substitutions.
See section <A HREF="manual.html#replace_utility">8.13  The <CODE>replace</CODE> String-replacement Utility</A>.

</P>


<H3><A NAME="mysql_config" HREF="manual_toc.html#mysql_config">20.1.2  <CODE>mysql_config</CODE>, Get compile options for compiling clients</A></H3>

<P>
<CODE>mysql_config</CODE> provides you with useful information for compiling
your MySQL client and connecting it to MySQL.

</P>
<P>
<CODE>mysql_config</CODE> supports the following options:

</P>
<DL COMPACT>

<DT><CODE>--cflags</CODE>
<DD>
Compiler flags to find include files and critical compiler flags and
defines used when compiling the <CODE>libmysqlclient</CODE> library.

<DT><CODE>--include</CODE>
<DD>
Compiler options to find MySQL include files. (Note that normally you would use
<CODE>--cflags</CODE> instead of this option.)

<DT><CODE>--libmysqld-libs, --embedded</CODE>
<DD>
Libraries and options required to link with the MySQL embedded server.

<DT><CODE>--libs</CODE>
<DD>
Libraries and options required to link with the MySQL client library.

<DT><CODE>--libs_r</CODE>
<DD>
Libraries and options required to link with the thread-safe MySQL client library.

<DT><CODE>--port</CODE>
<DD>
The default TCP/IP port number, defined when configuring MySQL.

<DT><CODE>--socket</CODE>
<DD>
The default Unix socket file, defined when configuring MySQL.

<DT><CODE>--version</CODE>
<DD>
Version number and version for the MySQL distribution.

</DL>

<P>
If you invoke <CODE>mysql_config</CODE> with no options, it displays a list of all
options that it supports, and their values:

</P>

<PRE>
shell&#62; mysql_config
Usage: /usr/local/mysql/bin/mysql_config [options]
Options:
  --cflags         [-I/usr/local/mysql/include/mysql -mcpu=pentiumpro]
  --include        [-I/usr/local/mysql/include/mysql]
  --libs           [-L/usr/local/mysql/lib/mysql -lmysqlclient -lz
                    -lcrypt -lnsl -lm -L/usr/lib -lssl -lcrypto]
  --libs_r         [-L/usr/local/mysql/lib/mysql -lmysqlclient_r
                    -lpthread -lz -lcrypt -lnsl -lm -lpthread]
  --socket         [/tmp/mysql.sock]
  --port           [3306]
  --version        [4.0.16]
  --libmysqld-libs [-L/usr/local/mysql/lib/mysql -lmysqld -lpthread -lz
                    -lcrypt -lnsl -lm -lpthread -lrt]
</PRE>

<P>
You can use <CODE>mysql_config</CODE> within a command line to include the value
that it displays for a particular option. For example, to compile a MySQL
client program, use <CODE>mysql_config</CODE> as follows:

</P>

<PRE>
CFG=/usr/local/mysql/bin/mysql_config
sh -c "gcc -o progname `$CFG --cflags` progname.c `$CFG --libs`"
</PRE>

<P>
When you use <CODE>mysql_config</CODE> this way, be sure to invoke it within
backtick (<SAMP>``'</SAMP>) characters.  That tells the shell to execute it and
subsitute its output into the surrounding command.

</P>



<H2><A NAME="C" HREF="manual_toc.html#C">20.2  MySQL C API</A></H2>

<P>
<A NAME="IDX2027"></A>
<A NAME="IDX2028"></A>

</P>

<P>
The C API code is distributed with MySQL. It is included in the
<CODE>mysqlclient</CODE> library and allows C programs to access a database.

</P>
<P>
Many of the clients in the MySQL source distribution are
written in C.  If you are looking for examples that demonstrate how to
use the C API, take a look at these clients. You can find these in the
<CODE>clients</CODE> directory in the MySQL source distribution.

</P>
<P>
Most of the other client APIs (all except Connector/J) use the <CODE>mysqlclient</CODE>
library to communicate with the MySQL server. This means that, for
example, you can take advantage of many of the same environment variables
that are used by other client programs, because they are referenced from the
library.  See section <A HREF="manual.html#Client-Side_Scripts">8  MySQL Client and Utility Programs</A>, for a list of these variables.

</P>
<P>
The client has a maximum communication buffer size. The size of the buffer
that is allocated initially (16KB) is automatically increased up to the
maximum size (the maximum is 16M). Because buffer sizes are increased
only as demand warrants, simply increasing the default maximum limit does not
in itself cause more resources to be used. This size check is mostly a check
for erroneous queries and communication packets.

</P>
<P>
The communication buffer must be large enough to contain a single SQL
statement (for client-to-server traffic) and one row of returned data (for
server-to-client traffic).  Each thread's communication buffer is dynamically
enlarged to handle any query or row up to the maximum limit.  For example, if
you have <CODE>BLOB</CODE> values that contain up to 16MB of data, you must have a
communication buffer limit of at least 16MB (in both server and client).  The
client's default maximum is 16MB, but the default maximum in the server is
1MB.  You can increase this by changing the value of the
<CODE>max_allowed_packet</CODE> parameter when the server is started.  See section <A HREF="manual.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
The MySQL server shrinks each communication buffer to
<CODE>net_buffer_length</CODE> bytes after each query.  For clients, the size of
the buffer associated with a connection is not decreased until the connection
is closed, at which time client memory is reclaimed.

</P>
<P>
For programming with threads, see section <A HREF="manual.html#Threaded_clients">20.2.14  How to Make a Threaded Client</A>.
For creating a standalone application which includes the
"server" and "client" in the same program (and does not
communicate with an external MySQL server), see section <A HREF="manual.html#libmysqld">20.2.15  libmysqld, the Embedded MySQL Server Library</A>.

</P>



<H3><A NAME="C_API_datatypes" HREF="manual_toc.html#C_API_datatypes">20.2.1  C API Data types</A></H3>

<DL COMPACT>

<DT><CODE>MYSQL</CODE>
<DD>
<A NAME="IDX2029"></A>
 
This structure represents a handle to one database connection. It is
used for almost all MySQL functions.

<A NAME="IDX2030"></A>
<DT><CODE>MYSQL_RES</CODE>
<DD>
This structure represents the result of a query that returns rows
(<CODE>SELECT</CODE>, <CODE>SHOW</CODE>, <CODE>DESCRIBE</CODE>, <CODE>EXPLAIN</CODE>).  The
information returned from a query is called the <EM>result set</EM> in the
remainder of this section.

<A NAME="IDX2031"></A>
<DT><CODE>MYSQL_ROW</CODE>
<DD>
This is a type-safe representation of one row of data. It is currently
implemented as an array of counted byte strings.  (You cannot treat these as
null-terminated strings if field values may contain binary data, because such
values may contain null bytes internally.)  Rows are obtained by calling
<CODE>mysql_fetch_row()</CODE>.

<A NAME="IDX2032"></A>
<DT><CODE>MYSQL_FIELD</CODE>
<DD>
This structure contains information about a field, such as the field's
name, type, and size. Its members are described in more detail here.
You may obtain the <CODE>MYSQL_FIELD</CODE> structures for each field by
calling <CODE>mysql_fetch_field()</CODE> repeatedly.  Field values are not part of
this structure; they are contained in a <CODE>MYSQL_ROW</CODE> structure.

<A NAME="IDX2033"></A>
<DT><CODE>MYSQL_FIELD_OFFSET</CODE>
<DD>
This is a type-safe representation of an offset into a MySQL field
list.  (Used by <CODE>mysql_field_seek()</CODE>.)  Offsets are field numbers
within a row, beginning at zero.

<A NAME="IDX2034"></A>
<A NAME="IDX2035"></A>
<DT><CODE>my_ulonglong</CODE>
<DD>
The type used for the number of rows and for <CODE>mysql_affected_rows()</CODE>,
<CODE>mysql_num_rows()</CODE>, and <CODE>mysql_insert_id()</CODE>. This type provides a
range of <CODE>0</CODE> to <CODE>1.84e19</CODE>.

On some systems, attempting to print a value of type <CODE>my_ulonglong</CODE>
will not work.  To print such a value, convert it to <CODE>unsigned long</CODE>
and use a <CODE>%lu</CODE> print format.  Example:

<PRE>
printf ("Number of rows: %lu\n", (unsigned long) mysql_num_rows(result));
</PRE>

</DL>

<P>
The <CODE>MYSQL_FIELD</CODE> structure contains the members listed here:

</P>
<DL COMPACT>

<DT><CODE>char * name</CODE>
<DD>
The name of the field, as a null-terminated string.

<DT><CODE>char * table</CODE>
<DD>
The name of the table containing this field, if it isn't a calculated field.
For calculated fields, the <CODE>table</CODE> value is an empty string.

<DT><CODE>char * def</CODE>
<DD>
The default value of this field, as a null-terminated string.  This is set
only if you use <CODE>mysql_list_fields()</CODE>.

<DT><CODE>enum enum_field_types type</CODE>
<DD>
The type of the field.
The <CODE>type</CODE> value may be one of the following:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Type Value</STRONG> </TD><TD> <STRONG>Type Description</STRONG>
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_TINY</CODE> </TD><TD> <CODE>TINYINT</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_SHORT</CODE> </TD><TD> <CODE>SMALLINT</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_LONG</CODE> </TD><TD> <CODE>INTEGER</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_INT24</CODE> </TD><TD> <CODE>MEDIUMINT</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_LONGLONG</CODE> </TD><TD> <CODE>BIGINT</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_DECIMAL</CODE> </TD><TD> <CODE>DECIMAL</CODE> or <CODE>NUMERIC</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_FLOAT</CODE> </TD><TD> <CODE>FLOAT</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_DOUBLE</CODE> </TD><TD> <CODE>DOUBLE</CODE> or <CODE>REAL</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_TIMESTAMP</CODE> </TD><TD> <CODE>TIMESTAMP</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_DATE</CODE> </TD><TD> <CODE>DATE</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_TIME</CODE> </TD><TD> <CODE>TIME</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_DATETIME</CODE> </TD><TD> <CODE>DATETIME</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_YEAR</CODE> </TD><TD> <CODE>YEAR</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_STRING</CODE> </TD><TD> <CODE>CHAR</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_VAR_STRING</CODE> </TD><TD> <CODE>VARCHAR</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_BLOB</CODE> </TD><TD> <CODE>BLOB</CODE> or <CODE>TEXT</CODE> field (use <CODE>max_length</CODE> to determine the maximum length)
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_SET</CODE> </TD><TD> <CODE>SET</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_ENUM</CODE> </TD><TD> <CODE>ENUM</CODE> field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_NULL</CODE> </TD><TD> <CODE>NULL</CODE>-type field
</TD></TR>
<TR><TD><CODE>FIELD_TYPE_CHAR</CODE> </TD><TD> Deprecated; use <CODE>FIELD_TYPE_TINY</CODE> instead
</TD></TR>
</TABLE>

You can use the <CODE>IS_NUM()</CODE> macro to test whether a field has a
numeric type.  Pass the <CODE>type</CODE> value to <CODE>IS_NUM()</CODE> and it
will evaluate to TRUE if the field is numeric:


<PRE>
if (IS_NUM(field-&#62;type))
    printf("Field is numeric\n");
</PRE>

<DT><CODE>unsigned int length</CODE>
<DD>
The width of the field, as specified in the table definition.

<DT><CODE>unsigned int max_length</CODE>
<DD>
The maximum width of the field for the result set (the length of the longest
field value for the rows actually in the result set). If you use
<CODE>mysql_store_result()</CODE> or <CODE>mysql_list_fields()</CODE>, this contains the
maximum length for the field.  If you use <CODE>mysql_use_result()</CODE>, the
value of this variable is zero.

<DT><CODE>unsigned int flags</CODE>
<DD>
Different bit-flags for the field.  The <CODE>flags</CODE> value may have zero
or more of the following bits set:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Flag Value</STRONG> </TD><TD> <STRONG>Flag Description</STRONG>
</TD></TR>
<TR><TD><CODE>NOT_NULL_FLAG</CODE> </TD><TD> Field can't be <CODE>NULL</CODE>
</TD></TR>
<TR><TD><CODE>PRI_KEY_FLAG</CODE> </TD><TD> Field is part of a primary key
</TD></TR>
<TR><TD><CODE>UNIQUE_KEY_FLAG</CODE> </TD><TD> Field is part of a unique key
</TD></TR>
<TR><TD><CODE>MULTIPLE_KEY_FLAG</CODE> </TD><TD> Field is part of a non-unique key
</TD></TR>
<TR><TD><CODE>UNSIGNED_FLAG</CODE> </TD><TD> Field has the <CODE>UNSIGNED</CODE> attribute
</TD></TR>
<TR><TD><CODE>ZEROFILL_FLAG</CODE> </TD><TD> Field has the <CODE>ZEROFILL</CODE> attribute
</TD></TR>
<TR><TD><CODE>BINARY_FLAG</CODE> </TD><TD> Field has the <CODE>BINARY</CODE> attribute
</TD></TR>
<TR><TD><CODE>AUTO_INCREMENT_FLAG</CODE> </TD><TD> Field has the <CODE>AUTO_INCREMENT</CODE>
attribute
</TD></TR>
<TR><TD><CODE>ENUM_FLAG</CODE> </TD><TD> Field is an <CODE>ENUM</CODE> (deprecated)
</TD></TR>
<TR><TD><CODE>SET_FLAG</CODE> </TD><TD> Field is a <CODE>SET</CODE> (deprecated)
</TD></TR>
<TR><TD><CODE>BLOB_FLAG</CODE> </TD><TD> Field is a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> (deprecated)
</TD></TR>
<TR><TD><CODE>TIMESTAMP_FLAG</CODE> </TD><TD> Field is a <CODE>TIMESTAMP</CODE> (deprecated)
</TD></TR>
</TABLE>

Use of the <CODE>BLOB_FLAG</CODE>, <CODE>ENUM_FLAG</CODE>, <CODE>SET_FLAG</CODE>, and
<CODE>TIMESTAMP_FLAG</CODE> flags is deprecated because they indicate the type of
a field rather than an attribute of its type.  It is preferable to test
<CODE>field-&#62;type</CODE> against <CODE>FIELD_TYPE_BLOB</CODE>, <CODE>FIELD_TYPE_ENUM</CODE>,
<CODE>FIELD_TYPE_SET</CODE>, or <CODE>FIELD_TYPE_TIMESTAMP</CODE> instead.

The following example illustrates a typical use of the <CODE>flags</CODE> value:


<PRE>
if (field-&#62;flags &#38; NOT_NULL_FLAG)
    printf("Field can't be null\n");
</PRE>

You may use the following convenience macros to determine the boolean
status of the <CODE>flags</CODE> value:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Flag Status</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>IS_NOT_NULL(flags)</CODE> </TD><TD> True if this field is defined as <CODE>NOT NULL</CODE>
</TD></TR>
<TR><TD><CODE>IS_PRI_KEY(flags)</CODE> </TD><TD> True if this field is a primary key
</TD></TR>
<TR><TD><CODE>IS_BLOB(flags)</CODE> </TD><TD> True if this field is a <CODE>BLOB</CODE> or <CODE>TEXT</CODE> (deprecated; test <CODE>field-&#62;type</CODE> instead)
</TD></TR>
</TABLE>

<DT><CODE>unsigned int decimals</CODE>
<DD>
The number of decimals for numeric fields.
</DL>



<H3><A NAME="C_API_function_overview" HREF="manual_toc.html#C_API_function_overview">20.2.2  C API Function Overview</A></H3>

<P>
<A NAME="IDX2036"></A>
<A NAME="IDX2037"></A>

</P>
<P>
The functions available in the C API are summarized here and described in
greater detail in a later section.
See section <A HREF="manual.html#C_API_functions">20.2.3  C API Function Descriptions</A>.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Function</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><STRONG>mysql_affected_rows()</STRONG> </TD><TD>
Returns the number of rows changed/deleted/inserted by the last <CODE>UPDATE</CODE>,
<CODE>DELETE</CODE>, or <CODE>INSERT</CODE> query.

</TD></TR>
<TR><TD><STRONG>mysql_change_user()</STRONG> </TD><TD>
Changes user and database on an open connection.

</TD></TR>
<TR><TD><STRONG>mysql_charset_name()</STRONG> </TD><TD>
Returns the name of the default character set for the connection.

</TD></TR>
<TR><TD><STRONG>mysql_close()</STRONG> </TD><TD>
Closes a server connection.

</TD></TR>
<TR><TD><STRONG>mysql_connect()</STRONG> </TD><TD>
Connects to a MySQL server. This function is deprecated; use
<CODE>mysql_real_connect()</CODE> instead.

</TD></TR>
<TR><TD><STRONG>mysql_create_db()</STRONG> </TD><TD>
Creates a database. This function is deprecated; use the SQL command
<CODE>CREATE DATABASE</CODE> instead.

</TD></TR>
<TR><TD><STRONG>mysql_data_seek()</STRONG> </TD><TD>
Seeks to an arbitrary row number in a query result set.

</TD></TR>
<TR><TD><STRONG>mysql_debug()</STRONG> </TD><TD>
Does a <CODE>DBUG_PUSH</CODE> with the given string.

</TD></TR>
<TR><TD><STRONG>mysql_drop_db()</STRONG> </TD><TD>
Drops a database. This function is deprecated; use the SQL command
<CODE>DROP DATABASE</CODE> instead.

</TD></TR>
<TR><TD><STRONG>mysql_dump_debug_info()</STRONG> </TD><TD>
Makes the server write debug information to the log.

</TD></TR>
<TR><TD><STRONG>mysql_eof()</STRONG> </TD><TD>
Determines whether the last row of a result set has been read.
This function is deprecated; <CODE>mysql_errno()</CODE> or <CODE>mysql_error()</CODE>
may be used instead.

</TD></TR>
<TR><TD><STRONG>mysql_errno()</STRONG> </TD><TD>
Returns the error number for the most recently invoked MySQL function.

</TD></TR>
<TR><TD><STRONG>mysql_error()</STRONG> </TD><TD>
Returns the error message for the most recently invoked MySQL function.

</TD></TR>
<TR><TD><STRONG>mysql_escape_string()</STRONG> </TD><TD>
Escapes special characters in a string for use in an SQL statement.

</TD></TR>
<TR><TD><STRONG>mysql_fetch_field()</STRONG> </TD><TD>
Returns the type of the next table field.

</TD></TR>
<TR><TD><STRONG>mysql_fetch_field_direct()</STRONG> </TD><TD>
Returns the type of a table field, given a field number.

</TD></TR>
<TR><TD><STRONG>mysql_fetch_fields()</STRONG> </TD><TD>
Returns an array of all field structures.

</TD></TR>
<TR><TD><STRONG>mysql_fetch_lengths()</STRONG> </TD><TD>
Returns the lengths of all columns in the current row.

</TD></TR>
<TR><TD><STRONG>mysql_fetch_row()</STRONG> </TD><TD>
Fetches the next row from the result set.

</TD></TR>
<TR><TD><STRONG>mysql_field_seek()</STRONG> </TD><TD>
Puts the column cursor on a specified column.

</TD></TR>
<TR><TD><STRONG>mysql_field_count()</STRONG> </TD><TD>
Returns the number of result columns for the most recent query.

</TD></TR>
<TR><TD><STRONG>mysql_field_tell()</STRONG> </TD><TD>
Returns the position of the field cursor used for the last
<CODE>mysql_fetch_field()</CODE>.

</TD></TR>
<TR><TD><STRONG>mysql_free_result()</STRONG> </TD><TD>
Frees memory used by a result set.

</TD></TR>
<TR><TD><STRONG>mysql_get_client_info()</STRONG> </TD><TD>
Returns client version information as a string.

</TD></TR>
<TR><TD><STRONG>mysql_get_client_version()</STRONG> </TD><TD>
Returns client version information as an integer.

</TD></TR>
<TR><TD><STRONG>mysql_get_host_info()</STRONG> </TD><TD>
Returns a string describing the connection.

</TD></TR>
<TR><TD><STRONG>mysql_get_server_version()</STRONG> </TD><TD>
Returns version number of server as an integer (new in 4.1).

</TD></TR>
<TR><TD><STRONG>mysql_get_proto_info()</STRONG> </TD><TD>
Returns the protocol version used by the connection.

</TD></TR>
<TR><TD><STRONG>mysql_get_server_info()</STRONG> </TD><TD>
Returns the server version number.

</TD></TR>
<TR><TD><STRONG>mysql_info()</STRONG> </TD><TD>
Returns information about the most recently executed query.

</TD></TR>
<TR><TD><STRONG>mysql_init()</STRONG> </TD><TD>
Gets or initializes a <CODE>MYSQL</CODE> structure.

</TD></TR>
<TR><TD><STRONG>mysql_insert_id()</STRONG> </TD><TD>
Returns the ID generated for an <CODE>AUTO_INCREMENT</CODE> column by the previous
query.

</TD></TR>
<TR><TD><STRONG>mysql_kill()</STRONG> </TD><TD>
Kills a given thread.

</TD></TR>
<TR><TD><STRONG>mysql_list_dbs()</STRONG> </TD><TD>
Returns database names matching a simple regular expression.

</TD></TR>
<TR><TD><STRONG>mysql_list_fields()</STRONG> </TD><TD>
Returns field names matching a simple regular expression.

</TD></TR>
<TR><TD><STRONG>mysql_list_processes()</STRONG> </TD><TD>
Returns a list of the current server threads.

</TD></TR>
<TR><TD><STRONG>mysql_list_tables()</STRONG> </TD><TD>
Returns table names matching a simple regular expression.

</TD></TR>
<TR><TD><STRONG>mysql_num_fields()</STRONG> </TD><TD>
Returns the number of columns in a result set.

</TD></TR>
<TR><TD><STRONG>mysql_num_rows()</STRONG> </TD><TD>
Returns the number of rows in a result set.

</TD></TR>
<TR><TD><STRONG>mysql_options()</STRONG> </TD><TD>
Sets connect options for <CODE>mysql_connect()</CODE>.

</TD></TR>
<TR><TD><STRONG>mysql_ping()</STRONG> </TD><TD>
Checks whether the connection to the server is working, reconnecting
as necessary.

</TD></TR>
<TR><TD><STRONG>mysql_query()</STRONG> </TD><TD>
Executes an SQL query specified as a null-terminated string.

</TD></TR>
<TR><TD><STRONG>mysql_real_connect()</STRONG> </TD><TD>
Connects to a MySQL server.

</TD></TR>
<TR><TD><STRONG>mysql_real_escape_string()</STRONG> </TD><TD>
Escapes special characters in a string for use in an SQL statement, taking
into account the current charset of the connection.

</TD></TR>
<TR><TD><STRONG>mysql_real_query()</STRONG> </TD><TD>
Executes an SQL query specified as a counted string.

</TD></TR>
<TR><TD><STRONG>mysql_reload()</STRONG> </TD><TD>
Tells the server to reload the grant tables.

</TD></TR>
<TR><TD><STRONG>mysql_row_seek()</STRONG> </TD><TD>
Seeks to a row offset in a result set, using value returned from
<CODE>mysql_row_tell()</CODE>.

</TD></TR>
<TR><TD><STRONG>mysql_row_tell()</STRONG> </TD><TD>
Returns the row cursor position.

</TD></TR>
<TR><TD><STRONG>mysql_select_db()</STRONG> </TD><TD>
Selects a database.

</TD></TR>
<TR><TD><STRONG>mysql_set_server_option()</STRONG> </TD><TD>
Sets an option for the connection (like <CODE>multi-statements</CODE>).

</TD></TR>
<TR><TD><STRONG>mysql_sqlstate()</STRONG> </TD><TD>
Returns the SQLSTATE error code for the last error.

</TD></TR>
<TR><TD><STRONG>mysql_shutdown()</STRONG> </TD><TD>
Shuts down the database server.

</TD></TR>
<TR><TD><STRONG>mysql_stat()</STRONG> </TD><TD>
Returns the server status as a string.

</TD></TR>
<TR><TD><STRONG>mysql_store_result()</STRONG> </TD><TD>
Retrieves a complete result set to the client.

</TD></TR>
<TR><TD><STRONG>mysql_thread_id()</STRONG> </TD><TD>
Returns the current thread ID.

</TD></TR>
<TR><TD><STRONG>mysql_thread_safe()</STRONG> </TD><TD>
Returns 1 if the clients are compiled as thread-safe.

</TD></TR>
<TR><TD><STRONG>mysql_use_result()</STRONG> </TD><TD>
Initiates a row-by-row result set retrieval.

</TD></TR>
<TR><TD><STRONG>mysql_warning_count()</STRONG> </TD><TD>
Returns the warning count for the previous SQL statement.

</TD></TR>
<TR><TD><STRONG>mysql_commit()</STRONG> </TD><TD>
Commits the transaction (new in 4.1).

</TD></TR>
<TR><TD><STRONG>mysql_rollback()</STRONG> </TD><TD>
Rolls back the transaction (new in 4.1).

</TD></TR>
<TR><TD><STRONG>mysql_autocommit()</STRONG> </TD><TD>
Toggles autocommit mode on/off (new in 4.1).

</TD></TR>
<TR><TD><STRONG>mysql_more_results()</STRONG> </TD><TD>
Checks whether any more results exist (new in 4.1).

</TD></TR>
<TR><TD><STRONG>mysql_next_result()</STRONG> </TD><TD>
Returns/Initiates the next result in multi-query executions (new in 4.1).
</TD></TR>
</TABLE>

<P>
To connect to the server, call <CODE>mysql_init()</CODE> to initialize a
connection handler, then call <CODE>mysql_real_connect()</CODE> with that
handler (along with other information such as the hostname, username,
and password).  Upon connection, <CODE>mysql_real_connect()</CODE> sets the
<CODE>reconnect</CODE> flag (part of the MYSQL structure) to a value of
<CODE>1</CODE>. This flag indicates, in the event that a query cannot be
performed because of a lost connection, to try reconnecting to the
server before giving up.  When you are done with the connection, call
<CODE>mysql_close()</CODE> to terminate it.

</P>
<P>
While a connection is active, the client may send SQL queries to the server
using <CODE>mysql_query()</CODE> or <CODE>mysql_real_query()</CODE>.  The difference
between the two is that <CODE>mysql_query()</CODE> expects the query to be
specified as a null-terminated string whereas <CODE>mysql_real_query()</CODE>
expects a counted string.  If the string contains binary data (which may
include null bytes), you must use <CODE>mysql_real_query()</CODE>.

</P>
<P>
For each non-<CODE>SELECT</CODE> query (for example, <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>,
<CODE>DELETE</CODE>), you can find out how many rows were changed (affected)
by calling <CODE>mysql_affected_rows()</CODE>.

</P>
<P>
For <CODE>SELECT</CODE> queries, you retrieve the selected rows as a result set.
(Note that some statements are <CODE>SELECT</CODE>-like in that they return rows.
These include <CODE>SHOW</CODE>, <CODE>DESCRIBE</CODE>, and <CODE>EXPLAIN</CODE>.  They should
be treated the same way as <CODE>SELECT</CODE> statements.)

</P>
<P>
There are two ways for a client to process result sets.  One way is to
retrieve the entire result set all at once by calling
<CODE>mysql_store_result()</CODE>.  This function acquires from the server all the
rows returned by the query and stores them in the client.  The second way is
for the client to initiate a row-by-row result set retrieval by calling
<CODE>mysql_use_result()</CODE>.  This function initializes the retrieval, but does
not actually get any rows from the server.

</P>
<P>
In both cases, you access rows by calling <CODE>mysql_fetch_row()</CODE>.  With
<CODE>mysql_store_result()</CODE>, <CODE>mysql_fetch_row()</CODE> accesses rows that have
already been fetched from the server.  With <CODE>mysql_use_result()</CODE>,
<CODE>mysql_fetch_row()</CODE> actually retrieves the row from the server.
Information about the size of the data in each row is available by
calling <CODE>mysql_fetch_lengths()</CODE>.

</P>
<P>
After you are done with a result set, call <CODE>mysql_free_result()</CODE>
to free the memory used for it.

</P>
<P>
The two retrieval mechanisms are complementary.  Client programs should
choose the approach that is most appropriate for their requirements.
In practice, clients tend to use <CODE>mysql_store_result()</CODE> more
commonly.

</P>
<P>
An advantage of <CODE>mysql_store_result()</CODE> is that because the rows have all
been fetched to the client, you not only can access rows sequentially, you
can move back and forth in the result set using <CODE>mysql_data_seek()</CODE> or
<CODE>mysql_row_seek()</CODE> to change the current row position within the result
set.  You can also find out how many rows there are by calling
<CODE>mysql_num_rows()</CODE>.  On the other hand, the memory requirements for
<CODE>mysql_store_result()</CODE> may be very high for large result sets and you
are more likely to encounter out-of-memory conditions.

</P>
<P>
An advantage of <CODE>mysql_use_result()</CODE> is that the client requires less
memory for the result set because it maintains only one row at a time (and
because there is less allocation overhead, <CODE>mysql_use_result()</CODE> can be
faster).  Disadvantages are that you must process each row quickly to avoid
tying up the server, you don't have random access to rows within the result
set (you can only access rows sequentially), and you don't know how many rows
are in the result set until you have retrieved them all.  Furthermore, you
<STRONG>must</STRONG> retrieve all the rows even if you determine in mid-retrieval that
you've found the information you were looking for.

</P>
<P>
The API makes it possible for clients to respond appropriately to
queries (retrieving rows only as necessary) without knowing whether or
not the query is a <CODE>SELECT</CODE>.  You can do this by calling
<CODE>mysql_store_result()</CODE> after each <CODE>mysql_query()</CODE> (or
<CODE>mysql_real_query()</CODE>).  If the result set call succeeds, the query
was a <CODE>SELECT</CODE> and you can read the rows.  If the result set call
fails, call <CODE>mysql_field_count()</CODE> to determine whether a
result was actually to be expected.  If <CODE>mysql_field_count()</CODE>
returns zero, the query returned no data (indicating that it was an
<CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, etc.), and was not
expected to return rows.  If <CODE>mysql_field_count()</CODE> is non-zero, the
query should have returned rows, but didn't.  This indicates that the
query was a <CODE>SELECT</CODE> that failed.  See the description for
<CODE>mysql_field_count()</CODE> for an example of how this can be done.

</P>
<P>
Both <CODE>mysql_store_result()</CODE> and <CODE>mysql_use_result()</CODE> allow you to
obtain information about the fields that make up the result set (the number
of fields, their names and types, etc.).  You can access field information
sequentially within the row by calling <CODE>mysql_fetch_field()</CODE> repeatedly,
or by field number within the row by calling
<CODE>mysql_fetch_field_direct()</CODE>.  The current field cursor position may be
changed by calling <CODE>mysql_field_seek()</CODE>.  Setting the field cursor
affects subsequent calls to <CODE>mysql_fetch_field()</CODE>.  You can also get
information for fields all at once by calling <CODE>mysql_fetch_fields()</CODE>.

</P>
<P>
For detecting and reporting errors, MySQL provides access to error
information by means of the <CODE>mysql_errno()</CODE> and <CODE>mysql_error()</CODE>
functions.  These return the error code or error message for the most
recently invoked function that can succeed or fail, allowing you to determine
when an error occurred and what it was.

</P>



<H3><A NAME="C_API_functions" HREF="manual_toc.html#C_API_functions">20.2.3  C API Function Descriptions</A></H3>

<P>
In the descriptions here, a parameter or return value of <CODE>NULL</CODE> means
<CODE>NULL</CODE> in the sense of the C programming language, not a
MySQL <CODE>NULL</CODE> value.

</P>
<P>
Functions that return a value generally return a pointer or an integer.
Unless specified otherwise, functions returning a pointer return a
non-<CODE>NULL</CODE> value to indicate success or a <CODE>NULL</CODE> value to indicate
an error, and functions returning an integer return zero to indicate success
or non-zero to indicate an error.  Note that ``non-zero'' means just that.
Unless the function description says otherwise, do not test against a value
other than zero:

</P>

<PRE>
if (result)                   /* correct */
    ... error ...

if (result &#60; 0)               /* incorrect */
    ... error ...

if (result == -1)             /* incorrect */
    ... error ...
</PRE>

<P>
When a function returns an error, the <STRONG>Errors</STRONG> subsection of the
function description lists the possible types of errors.  You can
find out which of these occurred by calling <CODE>mysql_errno()</CODE>.
A string representation of the error may be obtained by calling
<CODE>mysql_error()</CODE>.

</P>



<H4><A NAME="mysql_affected_rows" HREF="manual_toc.html#mysql_affected_rows">20.2.3.1  <CODE>mysql_affected_rows()</CODE></A></H4>

<P>
<A NAME="IDX2038"></A>

</P>
<P>
<CODE>my_ulonglong mysql_affected_rows(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.2  Description</H4>

<P>
Returns the number of rows changed by the last <CODE>UPDATE</CODE>, deleted by
the last <CODE>DELETE</CODE> or inserted by the last <CODE>INSERT</CODE>
statement. May be called immediately after <CODE>mysql_query()</CODE> for
<CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, or <CODE>INSERT</CODE> statements.  For
<CODE>SELECT</CODE> statements, <CODE>mysql_affected_rows()</CODE> works like
<CODE>mysql_num_rows()</CODE>.

</P>

<H4>20.2.3.3  Return Values</H4>

<P>
An integer greater than zero indicates the number of rows affected or
retrieved.  Zero indicates that no records were updated for an
<CODE>UPDATE</CODE> statement, no rows matched the <CODE>WHERE</CODE> clause in the
query or that no query has yet been executed.  -1 indicates that the
query returned an error or that, for a <CODE>SELECT</CODE> query,
<CODE>mysql_affected_rows()</CODE> was called prior to calling
<CODE>mysql_store_result()</CODE>. Because <CODE>mysql_affected_rows()</CODE>
returns an unsigned value, you can check for -1 by comparing the
return value to <CODE>(my_ulonglong)-1</CODE> (or to <CODE>(my_ulonglong)~0</CODE>,
which is equivalent).

</P>

<H4>20.2.3.4  Errors</H4>

<P>
None.

</P>

<H4>20.2.3.5  Example</H4>


<PRE>
mysql_query(&#38;mysql,"UPDATE products SET cost=cost*1.25 WHERE group=10");
printf("%ld products updated",(long) mysql_affected_rows(&#38;mysql));
</PRE>

<P>
If one specifies the flag <CODE>CLIENT_FOUND_ROWS</CODE> when connecting to
<CODE>mysqld</CODE>, <CODE>mysql_affected_rows()</CODE> will return the number of
rows matched by the <CODE>WHERE</CODE> statement for <CODE>UPDATE</CODE> statements.

</P>
<P>
Note that when one uses a <CODE>REPLACE</CODE> command,
<CODE>mysql_affected_rows()</CODE> will return 2 if the new row replaced and
old row.  This is because in this case one row was inserted after the
duplicate was deleted.

</P>



<H4><A NAME="mysql_change_user" HREF="manual_toc.html#mysql_change_user">20.2.3.6  <CODE>mysql_change_user()</CODE></A></H4>

<P>
<A NAME="IDX2039"></A>

</P>
<P>
<CODE>my_bool mysql_change_user(MYSQL *mysql, const char *user, const
char *password, const char *db)</CODE>

</P>

<H4>20.2.3.7  Description</H4>

<P>
Changes the user and causes the database specified by <CODE>db</CODE> to
become the default (current) database on the connection specified by
<CODE>mysql</CODE>.  In subsequent queries, this database is the default for
table references that do not include an explicit database specifier.

</P>
<P>
This function was introduced in MySQL 3.23.3.

</P>
<P>
<CODE>mysql_change_user()</CODE> fails if the connected user cannot be
authenticated or doesn't have permission to use the database.  In
this case the user and database are not changed

</P>
<P>
The <CODE>db</CODE> parameter may be set to <CODE>NULL</CODE> if you don't want to have a
default database.

</P>
<P>
Starting from MySQL 4.0.6 this command will always <CODE>ROLLBACK</CODE> any
active transactions, close all temporary tables, unlock all locked
tables and reset the state as if one had done a new connect.
This will happen even if the user didn't change.

</P>

<H4>20.2.3.8  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.9  Errors</H4>

<P>
The same that you can get from <CODE>mysql_real_connect()</CODE>.

</P>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
<DT><CODE>ER_UNKNOWN_COM_ERROR</CODE>
<DD>
The MySQL server doesn't implement this command (probably an old server).
<DT><CODE>ER_ACCESS_DENIED_ERROR</CODE>
<DD>
The user or password was wrong.
<DT><CODE>ER_BAD_DB_ERROR</CODE>
<DD>
The database didn't exist.
<DT><CODE>ER_DBACCESS_DENIED_ERROR</CODE>
<DD>
The user did not have access rights to the database.
<DT><CODE>ER_WRONG_DB_NAME</CODE>
<DD>
The database name was too long.
</DL>


<H4>20.2.3.10  Example</H4>


<PRE>
if (mysql_change_user(&#38;mysql, "user", "password", "new_database"))
{
   fprintf(stderr, "Failed to change user.  Error: %s\n",
           mysql_error(&#38;mysql));
}
</PRE>



<H4><A NAME="mysql_character_set_name" HREF="manual_toc.html#mysql_character_set_name">20.2.3.11  <CODE>mysql_character_set_name()</CODE></A></H4>

<P>
<A NAME="IDX2040"></A>

</P>
<P>
<CODE>const char *mysql_character_set_name(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.12  Description</H4>

<P>
Returns the default character set for the current connection.

</P>

<H4>20.2.3.13  Return Values</H4>

<P>
The default character set

</P>

<H4>20.2.3.14  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_close" HREF="manual_toc.html#mysql_close">20.2.3.15  <CODE>mysql_close()</CODE></A></H4>

<P>
<A NAME="IDX2041"></A>

</P>
<P>
<CODE>void mysql_close(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.16  Description</H4>
<P>
Closes a previously opened connection.  <CODE>mysql_close()</CODE> also deallocates
the connection handle pointed to by <CODE>mysql</CODE> if the handle was allocated
automatically by <CODE>mysql_init()</CODE> or <CODE>mysql_connect()</CODE>.

</P>

<H4>20.2.3.17  Return Values</H4>

<P>
None.

</P>

<H4>20.2.3.18  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_connect" HREF="manual_toc.html#mysql_connect">20.2.3.19  <CODE>mysql_connect()</CODE></A></H4>

<P>
<A NAME="IDX2042"></A>

</P>
<P>
<CODE>MYSQL *mysql_connect(MYSQL *mysql, const char *host, const char *user, const char *passwd)</CODE>

</P>

<H4>20.2.3.20  Description</H4>

<P>
This function is deprecated.  It is preferable to use
<CODE>mysql_real_connect()</CODE> instead.

</P>
<P>
<CODE>mysql_connect()</CODE> attempts to establish a connection to a MySQL
database engine running on <CODE>host</CODE>.  <CODE>mysql_connect()</CODE> must complete
successfully before you can execute any of the other API functions, with the
exception of <CODE>mysql_get_client_info()</CODE>.

</P>
<P>
The meanings of the parameters are the same as for the corresponding
parameters for <CODE>mysql_real_connect()</CODE> with the difference that the
connection parameter may be <CODE>NULL</CODE>. In this case the C API
allocates memory for the connection structure automatically and frees it
when you call <CODE>mysql_close()</CODE>. The disadvantage of this approach is
that you can't retrieve an error message if the connection fails.  (To
get error information from <CODE>mysql_errno()</CODE> or <CODE>mysql_error()</CODE>,
you must provide a valid <CODE>MYSQL</CODE> pointer.)

</P>

<H4>20.2.3.21  Return Values</H4>

<P>
Same as for <CODE>mysql_real_connect()</CODE>.

</P>

<H4>20.2.3.22  Errors</H4>

<P>
Same as for <CODE>mysql_real_connect()</CODE>.

</P>



<H4><A NAME="mysql_create_db" HREF="manual_toc.html#mysql_create_db">20.2.3.23  <CODE>mysql_create_db()</CODE></A></H4>

<P>
<A NAME="IDX2043"></A>

</P>
<P>
<CODE>int mysql_create_db(MYSQL *mysql, const char *db)</CODE>

</P>

<H4>20.2.3.24  Description</H4>
<P>
Creates the database named by the <CODE>db</CODE> parameter.

</P>
<P>
This function is deprecated.  It is preferable to use <CODE>mysql_query()</CODE>
to issue an SQL <CODE>CREATE DATABASE</CODE> statement instead.

</P>

<H4>20.2.3.25  Return Values</H4>

<P>
Zero if the database was created successfully. Non-zero if an error
occurred.

</P>

<H4>20.2.3.26  Errors</H4>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.

<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.

<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.

<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.3.27  Example</H4>


<PRE>
if(mysql_create_db(&#38;mysql, "my_database"))
{
   fprintf(stderr, "Failed to create new database.  Error: %s\n",
           mysql_error(&#38;mysql));
}
</PRE>



<H4><A NAME="mysql_data_seek" HREF="manual_toc.html#mysql_data_seek">20.2.3.28  <CODE>mysql_data_seek()</CODE></A></H4>

<P>
<A NAME="IDX2044"></A>

</P>
<P>
<CODE>void mysql_data_seek(MYSQL_RES *result, my_ulonglong offset)</CODE>

</P>

<H4>20.2.3.29  Description</H4>
<P>
Seeks to an arbitrary row in a query result set.  The <CODE>offset</CODE>
value is a row number and should be in the range from <CODE>0</CODE> to
<CODE>mysql_num_rows(stmt)-1</CODE>.

</P>
<P>
This function requires that the result set structure contains the
entire result of the query, so <CODE>mysql_data_seek()</CODE> may be
used only in conjunction with <CODE>mysql_store_result()</CODE>, not with
<CODE>mysql_use_result()</CODE>.

</P>

<H4>20.2.3.30  Return Values</H4>

<P>
None.

</P>

<H4>20.2.3.31  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_debug" HREF="manual_toc.html#mysql_debug">20.2.3.32  <CODE>mysql_debug()</CODE></A></H4>

<P>
<A NAME="IDX2045"></A>

</P>
<P>
<CODE>void mysql_debug(const char *debug)</CODE>

</P>

<H4>20.2.3.33  Description</H4>
<P>
Does a <CODE>DBUG_PUSH</CODE> with the given string. <CODE>mysql_debug()</CODE> uses the
Fred Fish debug library. To use this function, you must compile the client
library to support debugging.
See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>. See section <A HREF="manual.html#Debugging_client">D.2  Debugging a MySQL Client</A>.

</P>

<H4>20.2.3.34  Return Values</H4>

<P>
None.

</P>

<H4>20.2.3.35  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.36  Example</H4>

<P>
The call shown here causes the client library to generate a trace file in
<TT>`/tmp/client.trace'</TT> on the client machine:

</P>

<PRE>
mysql_debug("d:t:O,/tmp/client.trace");
</PRE>



<H4><A NAME="mysql_drop_db" HREF="manual_toc.html#mysql_drop_db">20.2.3.37  <CODE>mysql_drop_db()</CODE></A></H4>

<P>
<A NAME="IDX2046"></A>

</P>
<P>
<CODE>int mysql_drop_db(MYSQL *mysql, const char *db)</CODE>

</P>

<H4>20.2.3.38  Description</H4>
<P>
Drops the database named by the <CODE>db</CODE> parameter.

</P>
<P>
This function is deprecated.  It is preferable to use <CODE>mysql_query()</CODE>
to issue an SQL <CODE>DROP DATABASE</CODE> statement instead.

</P>

<H4>20.2.3.39  Return Values</H4>

<P>
Zero if the database was dropped successfully. Non-zero if an error
occurred.

</P>

<H4>20.2.3.40  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.3.41  Example</H4>


<PRE>
if(mysql_drop_db(&#38;mysql, "my_database"))
  fprintf(stderr, "Failed to drop the database: Error: %s\n",
          mysql_error(&#38;mysql));
</PRE>



<H4><A NAME="mysql_dump_debug_info" HREF="manual_toc.html#mysql_dump_debug_info">20.2.3.42  <CODE>mysql_dump_debug_info()</CODE></A></H4>

<P>
<A NAME="IDX2047"></A>

</P>
<P>
<CODE>int mysql_dump_debug_info(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.43  Description</H4>

<P>
Instructs the server to write some debug information to the log. For
this to work, the connected user must have the <CODE>SUPER</CODE> privilege.

</P>

<H4>20.2.3.44  Return Values</H4>

<P>
Zero if the command was successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.45  Errors</H4>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_eof" HREF="manual_toc.html#mysql_eof">20.2.3.46  <CODE>mysql_eof()</CODE></A></H4>

<P>
<A NAME="IDX2048"></A>

</P>
<P>
<CODE>my_bool mysql_eof(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.47  Description</H4>

<P>
This function is deprecated.  <CODE>mysql_errno()</CODE> or <CODE>mysql_error()</CODE>
may be used instead.

</P>
<P>
<CODE>mysql_eof()</CODE> determines whether the last row of a result
set has been read.

</P>
<P>
If you acquire a result set from a successful call to
<CODE>mysql_store_result()</CODE>, the client receives the entire set in one
operation.  In this case, a <CODE>NULL</CODE> return from
<CODE>mysql_fetch_row()</CODE> always means the end of the result set has been
reached and it is unnecessary to call <CODE>mysql_eof()</CODE>.  When used
with <CODE>mysql_store_result()</CODE>, <CODE>mysql_eof()</CODE> will always return
true.

</P>
<P>
On the other hand, if you use <CODE>mysql_use_result()</CODE> to initiate a result
set retrieval, the rows of the set are obtained from the server one by one as
you call <CODE>mysql_fetch_row()</CODE> repeatedly.  Because an error may occur on
the connection during this process, a <CODE>NULL</CODE> return value from
<CODE>mysql_fetch_row()</CODE> does not necessarily mean the end of the result set
was reached normally.  In this case, you can use <CODE>mysql_eof()</CODE> to
determine what happened.  <CODE>mysql_eof()</CODE> returns a non-zero value if the
end of the result set was reached and zero if an error occurred.

</P>
<P>
Historically, <CODE>mysql_eof()</CODE> predates the standard MySQL error
functions <CODE>mysql_errno()</CODE> and <CODE>mysql_error()</CODE>.  Because those error
functions provide the same information, their use is preferred over
<CODE>mysql_eof()</CODE>, which is now deprecated.  (In fact, they provide more
information, because <CODE>mysql_eof()</CODE> returns only a boolean value whereas
the error functions indicate a reason for the error when one occurs.)

</P>

<H4>20.2.3.48  Return Values</H4>

<P>
Zero if no error occurred. Non-zero if the end of the result set has been
reached.

</P>

<H4>20.2.3.49  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.50  Example</H4>

<P>
The following example shows how you might use <CODE>mysql_eof()</CODE>:

</P>

<PRE>
mysql_query(&#38;mysql,"SELECT * FROM some_table");
result = mysql_use_result(&#38;mysql);
while((row = mysql_fetch_row(result)))
{
    // do something with data
}
if(!mysql_eof(result))  // mysql_fetch_row() failed due to an error
{
    fprintf(stderr, "Error: %s\n", mysql_error(&#38;mysql));
}
</PRE>

<P>
However, you can achieve the same effect with the standard MySQL
error functions:

</P>

<PRE>
mysql_query(&#38;mysql,"SELECT * FROM some_table");
result = mysql_use_result(&#38;mysql);
while((row = mysql_fetch_row(result)))
{
    // do something with data
}
if(mysql_errno(&#38;mysql))  // mysql_fetch_row() failed due to an error
{
    fprintf(stderr, "Error: %s\n", mysql_error(&#38;mysql));
}
</PRE>



<H4><A NAME="mysql_errno" HREF="manual_toc.html#mysql_errno">20.2.3.51  <CODE>mysql_errno()</CODE></A></H4>

<P>
<A NAME="IDX2049"></A>

</P>
<P>
<CODE>unsigned int mysql_errno(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.52  Description</H4>

<P>
For the connection specified by <CODE>mysql</CODE>, <CODE>mysql_errno()</CODE> returns
the error code for the most recently invoked API function that can succeed
or fail.  A return value of zero means that no error occurred. Client error
message numbers are listed in the MySQL <TT>`errmsg.h'</TT> header file.
Server error message numbers are listed in <TT>`mysqld_error.h'</TT>. In the
MySQL source distribution you can find a complete list of
error messages and error numbers in the file <TT>`Docs/mysqld_error.txt'</TT>.
The server error codes also are listed at section <A HREF="manual.html#Error-returns">21.1  Error Returns</A>.

</P>
<P>
Note that some functions like <CODE>mysql_fetch_row()</CODE> don't set
<CODE>mysql_errno()</CODE> if they succeed.

</P>
<P>
A rule of thumb is that all functions that have to ask the server for
information will reset <CODE>mysql_errno()</CODE> if they succeed.

</P>

<H4>20.2.3.53  Return Values</H4>

<P>
An error code value for the last mysql_xxx call, if it failed.
zero means no error occurred.

</P>

<H4>20.2.3.54  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_error" HREF="manual_toc.html#mysql_error">20.2.3.55  <CODE>mysql_error()</CODE></A></H4>

<P>
<A NAME="IDX2050"></A>

</P>
<P>
<CODE>const char *mysql_error(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.56  Description</H4>

<P>
For the connection specified by <CODE>mysql</CODE>, <CODE>mysql_error()</CODE>
returns a null-terminated string containing the error message for the
most recently invoked API function that failed. If a function didn't
fail, the return value of <CODE>mysql_error()</CODE> may be the previous error
or an empty string to indicate no error.

</P>
<P>
A rule of thumb is that all functions that have to ask the server for
information will reset <CODE>mysql_error()</CODE> if they succeed.

</P>
<P>
For functions that resets <CODE>mysql_errno</CODE>, the following two tests
are equivalent:

</P>

<PRE>
if(mysql_errno(&#38;mysql))
{
    // an error occurred
}

if(mysql_error(&#38;mysql)[0] != '\0')
{
    // an error occurred
}
</PRE>

<P>
The language of the client error messages may be changed by
recompiling the MySQL client library. Currently you can choose
error messages in several different languages.
See section <A HREF="manual.html#Languages">5.7.2  Setting the Error Message Language</A>.

</P>

<H4>20.2.3.57  Return Values</H4>

<P>
A null-terminated character string that describes the error.  An empty string
if no error occurred.

</P>

<H4>20.2.3.58  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_escape_string" HREF="manual_toc.html#mysql_escape_string">20.2.3.59  <CODE>mysql_escape_string()</CODE></A></H4>

<P>
<A NAME="IDX2051"></A>

</P>
<P>
You should use <CODE>mysql_real_escape_string()</CODE> instead!

</P>
<P>
This function is identical to <CODE>mysql_real_escape_string()</CODE> except
that <CODE>mysql_real_escape_string()</CODE> takes a connection handler as
its first argument and escapes the string according to the current
character set.  <CODE>mysql_escape_string()</CODE> does not take a connection
argument and does not respect the current charset setting.

</P>



<H4><A NAME="mysql_fetch_field" HREF="manual_toc.html#mysql_fetch_field">20.2.3.60  <CODE>mysql_fetch_field()</CODE></A></H4>

<P>
<A NAME="IDX2052"></A>

</P>
<P>
<CODE>MYSQL_FIELD *mysql_fetch_field(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.61  Description</H4>

<P>
Returns the definition of one column of a result set as a <CODE>MYSQL_FIELD</CODE>
structure. Call this function repeatedly to retrieve information about all
columns in the result set.  <CODE>mysql_fetch_field()</CODE> returns <CODE>NULL</CODE>
when no more fields are left.

</P>
<P>
<CODE>mysql_fetch_field()</CODE> is reset to return information about the first
field each time you execute a new <CODE>SELECT</CODE> query.  The field returned by
<CODE>mysql_fetch_field()</CODE> is also affected by calls to
<CODE>mysql_field_seek()</CODE>.

</P>
<P>
If you've called <CODE>mysql_query()</CODE> to perform a <CODE>SELECT</CODE> on a table
but have not called <CODE>mysql_store_result()</CODE>, MySQL returns the
default blob length (8KB) if you call <CODE>mysql_fetch_field()</CODE> to ask
for the length of a <CODE>BLOB</CODE> field.  (The 8KB size is chosen because
MySQL doesn't know the maximum length for the <CODE>BLOB</CODE>. This
should be made configurable sometime.) Once you've retrieved the result set,
<CODE>field-&#62;max_length</CODE> contains the length of the largest value for this
column in the specific query.

</P>

<H4>20.2.3.62  Return Values</H4>

<P>
The <CODE>MYSQL_FIELD</CODE> structure for the current column. <CODE>NULL</CODE>
if no columns are left.

</P>

<H4>20.2.3.63  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.64  Example</H4>


<PRE>
MYSQL_FIELD *field;

while((field = mysql_fetch_field(result)))
{
    printf("field name %s\n", field-&#62;name);
}
</PRE>



<H4><A NAME="mysql_fetch_fields" HREF="manual_toc.html#mysql_fetch_fields">20.2.3.65  <CODE>mysql_fetch_fields()</CODE></A></H4>

<P>
<A NAME="IDX2053"></A>

</P>
<P>
<CODE>MYSQL_FIELD *mysql_fetch_fields(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.66  Description</H4>

<P>
Returns an array of all <CODE>MYSQL_FIELD</CODE> structures for a result set.
Each structure provides the field definition for one column of the result
set.

</P>

<H4>20.2.3.67  Return Values</H4>

<P>
An array of <CODE>MYSQL_FIELD</CODE> structures for all columns of a result set.

</P>

<H4>20.2.3.68  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.69  Example</H4>


<PRE>
unsigned int num_fields;
unsigned int i;
MYSQL_FIELD *fields;

num_fields = mysql_num_fields(result);
fields = mysql_fetch_fields(result);
for(i = 0; i &#60; num_fields; i++)
{
   printf("Field %u is %s\n", i, fields[i].name);
}
</PRE>



<H4><A NAME="mysql_fetch_field_direct" HREF="manual_toc.html#mysql_fetch_field_direct">20.2.3.70  <CODE>mysql_fetch_field_direct()</CODE></A></H4>

<P>
<A NAME="IDX2054"></A>

</P>
<P>
<CODE>MYSQL_FIELD *mysql_fetch_field_direct(MYSQL_RES *result, unsigned int fieldnr)</CODE>

</P>

<H4>20.2.3.71  Description</H4>

<P>
Given a field number <CODE>fieldnr</CODE> for a column within a result set, returns
that column's field definition as a <CODE>MYSQL_FIELD</CODE> structure. You may use
this function to retrieve the definition for an arbitrary column.  The value
of <CODE>fieldnr</CODE> should be in the range from 0 to
<CODE>mysql_num_fields(result)-1</CODE>.

</P>

<H4>20.2.3.72  Return Values</H4>

<P>
The <CODE>MYSQL_FIELD</CODE> structure for the specified column.

</P>

<H4>20.2.3.73  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.74  Example</H4>


<PRE>
unsigned int num_fields;
unsigned int i;
MYSQL_FIELD *field;

num_fields = mysql_num_fields(result);
for(i = 0; i &#60; num_fields; i++)
{
    field = mysql_fetch_field_direct(result, i);
    printf("Field %u is %s\n", i, field-&#62;name);
}
</PRE>



<H4><A NAME="mysql_fetch_lengths" HREF="manual_toc.html#mysql_fetch_lengths">20.2.3.75  <CODE>mysql_fetch_lengths()</CODE></A></H4>

<P>
<A NAME="IDX2055"></A>

</P>
<P>
<CODE>unsigned long *mysql_fetch_lengths(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.76  Description</H4>

<P>
Returns the lengths of the columns of the current row within a result set.
If you plan to copy field values, this length information is also useful for
optimization, because you can avoid calling <CODE>strlen()</CODE>.  In addition, if
the result set contains binary data, you <STRONG>must</STRONG> use this function to
determine the size of the data, because <CODE>strlen()</CODE> returns incorrect
results for any field containing null characters.

</P>
<P>
The length for empty columns and for columns containing <CODE>NULL</CODE> values is
zero.  To see how to distinguish these two cases, see the description for
<CODE>mysql_fetch_row()</CODE>.

</P>

<H4>20.2.3.77  Return Values</H4>

<P>
An array of unsigned long integers representing the size of each column (not
including any terminating null characters).
<CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.78  Errors</H4>
<P>
<CODE>mysql_fetch_lengths()</CODE> is valid only for the current row of the result
set.  It returns <CODE>NULL</CODE> if you call it before calling
<CODE>mysql_fetch_row()</CODE> or after retrieving all rows in the result.

</P>

<H4>20.2.3.79  Example</H4>


<PRE>
MYSQL_ROW row;
unsigned long *lengths;
unsigned int num_fields;
unsigned int i;

row = mysql_fetch_row(result);
if (row)
{
    num_fields = mysql_num_fields(result);
    lengths = mysql_fetch_lengths(result);
    for(i = 0; i &#60; num_fields; i++)
    {
         printf("Column %u is %lu bytes in length.\n", i, lengths[i]);
    }
}
</PRE>



<H4><A NAME="mysql_fetch_row" HREF="manual_toc.html#mysql_fetch_row">20.2.3.80  <CODE>mysql_fetch_row()</CODE></A></H4>

<P>
<A NAME="IDX2056"></A>

</P>
<P>
<CODE>MYSQL_ROW mysql_fetch_row(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.81  Description</H4>

<P>
Retrieves the next row of a result set. When used after
<CODE>mysql_store_result()</CODE>, <CODE>mysql_fetch_row()</CODE> returns <CODE>NULL</CODE>
when there are no more rows to retrieve.  When used after
<CODE>mysql_use_result()</CODE>, <CODE>mysql_fetch_row()</CODE> returns <CODE>NULL</CODE> when
there are no more rows to retrieve or if an error occurred.

</P>
<P>
The number of values in the row is given by <CODE>mysql_num_fields(result)</CODE>.
If <CODE>row</CODE> holds the return value from a call to <CODE>mysql_fetch_row()</CODE>,
pointers to the values are accessed as <CODE>row[0]</CODE> to
<CODE>row[mysql_num_fields(result)-1]</CODE>.  <CODE>NULL</CODE> values in the row are
indicated by <CODE>NULL</CODE> pointers.

</P>
<P>
The lengths of the field values in the row may be obtained by calling
<CODE>mysql_fetch_lengths()</CODE>.  Empty fields and fields containing
<CODE>NULL</CODE> both have length 0; you can distinguish these by checking
the pointer for the field value.  If the pointer is <CODE>NULL</CODE>, the field
is <CODE>NULL</CODE>; otherwise, the field is empty.

</P>

<H4>20.2.3.82  Return Values</H4>

<P>
A <CODE>MYSQL_ROW</CODE> structure for the next row.  <CODE>NULL</CODE> if
there are no more rows to retrieve or if an error occurred.

</P>

<H4>20.2.3.83  Errors</H4>

<P>
Note that error is not reset between calls to <CODE>mysql_fetch_row()</CODE>

</P>
<DL COMPACT>

<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.3.84  Example</H4>


<PRE>
MYSQL_ROW row;
unsigned int num_fields;
unsigned int i;

num_fields = mysql_num_fields(result);
while ((row = mysql_fetch_row(result)))
{
   unsigned long *lengths;
   lengths = mysql_fetch_lengths(result);
   for(i = 0; i &#60; num_fields; i++)
   {
       printf("[%.*s] ", (int) lengths[i], row[i] ? row[i] : "NULL");
   }
   printf("\n");
}
</PRE>



<H4><A NAME="mysql_field_count" HREF="manual_toc.html#mysql_field_count">20.2.3.85  <CODE>mysql_field_count()</CODE></A></H4>

<P>
<A NAME="IDX2057"></A>

</P>
<P>
<CODE>unsigned int mysql_field_count(MYSQL *mysql)</CODE>

</P>
<P>
If you are using a version of MySQL earlier than Version 3.22.24, you
should use <CODE>unsigned int mysql_num_fields(MYSQL *mysql)</CODE> instead.

</P>

<H4>20.2.3.86  Description</H4>

<P>
Returns the number of columns for the most recent query on the connection.

</P>
<P>
The normal use of this function is when <CODE>mysql_store_result()</CODE>
returned <CODE>NULL</CODE> (and thus you have no result set pointer).
In this case, you can call <CODE>mysql_field_count()</CODE> to
determine whether <CODE>mysql_store_result()</CODE> should have produced a
non-empty result.  This allows the client program to take proper action
without knowing whether the query was a <CODE>SELECT</CODE> (or
<CODE>SELECT</CODE>-like) statement.  The example shown here illustrates how this
may be done.

</P>
<P>
See section <A HREF="manual.html#NULL_mysql_store_result">20.2.12.1  Why <CODE>mysql_store_result()</CODE> Sometimes Returns <CODE>NULL</CODE> After <CODE>mysql_query()</CODE> Returns Success</A>.

</P>

<H4>20.2.3.87  Return Values</H4>

<P>
An unsigned integer representing the number of fields in a result set.

</P>

<H4>20.2.3.88  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.89  Example</H4>


<PRE>
MYSQL_RES *result;
unsigned int num_fields;
unsigned int num_rows;

if (mysql_query(&#38;mysql,query_string))
{
    // error
}
else // query succeeded, process any data returned by it
{
    result = mysql_store_result(&#38;mysql);
    if (result)  // there are rows
    {
        num_fields = mysql_num_fields(result);
        // retrieve rows, then call mysql_free_result(result)
    }
    else  // mysql_store_result() returned nothing; should it have?
    {
        if(mysql_field_count(&#38;mysql) == 0)
        {
            // query does not return data
            // (it was not a SELECT)
            num_rows = mysql_affected_rows(&#38;mysql);
        }
        else // mysql_store_result() should have returned data
        {
            fprintf(stderr, "Error: %s\n", mysql_error(&#38;mysql));
        }
    }
}
</PRE>

<P>
An alternative is to replace the <CODE>mysql_field_count(&#38;mysql)</CODE> call with
<CODE>mysql_errno(&#38;mysql)</CODE>.  In this case, you are checking directly for an
error from <CODE>mysql_store_result()</CODE> rather than inferring from the value
of <CODE>mysql_field_count()</CODE> whether the statement was a
<CODE>SELECT</CODE>.

</P>



<H4><A NAME="mysql_field_seek" HREF="manual_toc.html#mysql_field_seek">20.2.3.90  <CODE>mysql_field_seek()</CODE></A></H4>

<P>
<A NAME="IDX2058"></A>

</P>
<P>
<CODE>MYSQL_FIELD_OFFSET mysql_field_seek(MYSQL_RES *result, MYSQL_FIELD_OFFSET offset)</CODE>

</P>

<H4>20.2.3.91  Description</H4>

<P>
Sets the field cursor to the given offset.   The next call to
<CODE>mysql_fetch_field()</CODE> will retrieve the field definition of the column
associated with that offset.

</P>
<P>
To seek to the beginning of a row, pass an <CODE>offset</CODE> value of zero.

</P>

<H4>20.2.3.92  Return Values</H4>

<P>
The previous value of the field cursor.

</P>

<H4>20.2.3.93  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_field_tell" HREF="manual_toc.html#mysql_field_tell">20.2.3.94  <CODE>mysql_field_tell()</CODE></A></H4>

<P>
<A NAME="IDX2059"></A>

</P>
<P>
<CODE>MYSQL_FIELD_OFFSET mysql_field_tell(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.95  Description</H4>

<P>
Returns the position of the field cursor used for the last
<CODE>mysql_fetch_field()</CODE>. This value can be used as an argument to
<CODE>mysql_field_seek()</CODE>.

</P>

<H4>20.2.3.96  Return Values</H4>

<P>
The current offset of the field cursor.

</P>

<H4>20.2.3.97  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_free_result" HREF="manual_toc.html#mysql_free_result">20.2.3.98  <CODE>mysql_free_result()</CODE></A></H4>

<P>
<A NAME="IDX2060"></A>

</P>
<P>
<CODE>void mysql_free_result(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.99  Description</H4>

<P>
Frees the memory allocated for a result set by <CODE>mysql_store_result()</CODE>,
<CODE>mysql_use_result()</CODE>, <CODE>mysql_list_dbs()</CODE>, etc.  When you are done
with a result set, you must free the memory it uses by calling
<CODE>mysql_free_result()</CODE>.

</P>
<P>
Do not attempt to access a result set after freeing it.

</P>

<H4>20.2.3.100  Return Values</H4>

<P>
None.

</P>

<H4>20.2.3.101  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_get_client_info" HREF="manual_toc.html#mysql_get_client_info">20.2.3.102  <CODE>mysql_get_client_info()</CODE></A></H4>

<P>
<A NAME="IDX2061"></A>

</P>
<P>
<CODE>char *mysql_get_client_info(void)</CODE>

</P>

<H4>20.2.3.103  Description</H4>

<P>
Returns a string that represents the client library version.

</P>

<H4>20.2.3.104  Return Values</H4>

<P>
A character string that represents the MySQL client library version.

</P>

<H4>20.2.3.105  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_get_client_version" HREF="manual_toc.html#mysql_get_client_version">20.2.3.106  <CODE>mysql_get_client_version()</CODE></A></H4>

<P>
<A NAME="IDX2062"></A>

</P>
<P>
<CODE>unsigned long mysql_get_client_version(void)</CODE>

</P>

<H4>20.2.3.107  Description</H4>

<P>
Returns an integer that represents the client library version.
The value has the format <CODE>XYYZZ</CODE> where <CODE>X</CODE> is the major
version, <CODE>YY</CODE> is the release level, and <CODE>ZZ</CODE> is the version
number within the release level. For example, a value of <CODE>40102</CODE>
represents a client library version of <CODE>4.1.2</CODE>.

</P>

<H4>20.2.3.108  Return Values</H4>

<P>
An integer that represents the MySQL client library version.

</P>

<H4>20.2.3.109  Errors</H4>
<P>
None.

</P>


<H4><A NAME="mysql_get_host_info" HREF="manual_toc.html#mysql_get_host_info">20.2.3.110  <CODE>mysql_get_host_info()</CODE></A></H4>

<P>
<A NAME="IDX2063"></A>

</P>
<P>
<CODE>char *mysql_get_host_info(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.111  Description</H4>

<P>
Returns a string describing the type of connection in use, including the
server hostname.

</P>

<H4>20.2.3.112  Return Values</H4>

<P>
A character string representing the server hostname and the connection type.

</P>

<H4>20.2.3.113  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_get_proto_info" HREF="manual_toc.html#mysql_get_proto_info">20.2.3.114  <CODE>mysql_get_proto_info()</CODE></A></H4>

<P>
<A NAME="IDX2064"></A>

</P>
<P>
<CODE>unsigned int mysql_get_proto_info(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.115  Description</H4>

<P>
Returns the protocol version used by current connection.

</P>

<H4>20.2.3.116  Return Values</H4>

<P>
An unsigned integer representing the protocol version used by the current
connection.

</P>

<H4>20.2.3.117  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_get_server_info" HREF="manual_toc.html#mysql_get_server_info">20.2.3.118  <CODE>mysql_get_server_info()</CODE></A></H4>

<P>
<A NAME="IDX2065"></A>

</P>
<P>
<CODE>char *mysql_get_server_info(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.119  Description</H4>

<P>
Returns a string that represents the server version number.

</P>

<H4>20.2.3.120  Return Values</H4>

<P>
A character string that represents the server version number.

</P>

<H4>20.2.3.121  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_get_server_version" HREF="manual_toc.html#mysql_get_server_version">20.2.3.122  <CODE>mysql_get_server_version()</CODE></A></H4>

<P>
<A NAME="IDX2066"></A>

</P>
<P>
<CODE>unsigned long mysql_get_server_version(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.123  Description</H4>

<P>
Returns the version number of the server as an integer (new in 4.1).

</P>

<H4>20.2.3.124  Return Values</H4>

<P>
A number that represents the MySQL server version in this format:

</P>

<PRE>
major_version*10000 + minor_version *100 + sub_version
</PRE>

<P>
For example, 4.1.2 is returned as 40102.

</P>
<P>
This function is useful in client programs for quickly determining
whether some version-specific server capability exists.

</P>

<H4>20.2.3.125  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_info" HREF="manual_toc.html#mysql_info">20.2.3.126  <CODE>mysql_info()</CODE></A></H4>

<P>
<A NAME="IDX2067"></A>

</P>
<P>
<CODE>char *mysql_info(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.127  Description</H4>

<P>
Retrieves a string providing information about the most recently executed
query, but only for the statements listed here.  For other statements,
<CODE>mysql_info()</CODE> returns <CODE>NULL</CODE>.  The format of the string varies
depending on the type of query, as described here.  The numbers are
illustrative only; the string will contain values appropriate for the query.

</P>
<DL COMPACT>

<DT><CODE>INSERT INTO ... SELECT ...</CODE>
<DD>
String format: <CODE>Records: 100 Duplicates: 0 Warnings: 0</CODE>
<DT><CODE>INSERT INTO ... VALUES (...),(...),(...)...</CODE>
<DD>
String format: <CODE>Records: 3  Duplicates: 0  Warnings: 0</CODE>
<DT><CODE>LOAD DATA INFILE ...</CODE>
<DD>
String format: <CODE>Records: 1 Deleted: 0 Skipped: 0 Warnings: 0</CODE>
<DT><CODE>ALTER TABLE</CODE>
<DD>
String format: <CODE>Records: 3 Duplicates: 0 Warnings: 0</CODE>
<DT><CODE>UPDATE</CODE>
<DD>
String format: <CODE>Rows matched: 40 Changed: 40 Warnings: 0</CODE>
</DL>

<P>
Note that <CODE>mysql_info()</CODE> returns a non-<CODE>NULL</CODE> value for
<CODE>INSERT ... VALUES</CODE> only for the multiple-row form
of the statement (that is, only if multiple value lists are
specified).

</P>

<H4>20.2.3.128  Return Values</H4>

<P>
A character string representing additional information about the most
recently executed query.  <CODE>NULL</CODE> if no information is available for the
query.

</P>

<H4>20.2.3.129  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_init" HREF="manual_toc.html#mysql_init">20.2.3.130  <CODE>mysql_init()</CODE></A></H4>

<P>
<A NAME="IDX2068"></A>

</P>
<P>
<CODE>MYSQL *mysql_init(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.131  Description</H4>

<P>
Allocates or initializes a <CODE>MYSQL</CODE> object suitable for
<CODE>mysql_real_connect()</CODE>.  If <CODE>mysql</CODE> is a <CODE>NULL</CODE> pointer, the
function allocates, initializes, and returns a new object.  Otherwise, the
object is initialized and the address of the object is returned.  If
<CODE>mysql_init()</CODE> allocates a new object, it will be freed when
<CODE>mysql_close()</CODE> is called to close the connection.

</P>

<H4>20.2.3.132  Return Values</H4>

<P>
An initialized <CODE>MYSQL*</CODE> handle.  <CODE>NULL</CODE> if there was
insufficient memory to allocate a new object.

</P>

<H4>20.2.3.133  Errors</H4>
<P>
In case of insufficient memory, <CODE>NULL</CODE> is returned.

</P>



<H4><A NAME="mysql_insert_id" HREF="manual_toc.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A></H4>

<P>
<A NAME="IDX2069"></A>

</P>
<P>
<CODE>my_ulonglong mysql_insert_id(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.135  Description</H4>

<P>
Returns the value generated for an <CODE>AUTO_INCREMENT</CODE> column by the
previous <CODE>INSERT</CODE> or <CODE>UPDATE</CODE> statement.  Use this function after
you have performed an <CODE>INSERT</CODE> statement into a table that contains an
<CODE>AUTO_INCREMENT</CODE> field.

</P>
<P>
More precisely, <CODE>mysql_insert_id()</CODE> is updated under these conditions:

</P>

<UL>
<LI>

<CODE>INSERT</CODE> statements that store a value into an <CODE>AUTO_INCREMENT</CODE>
column. This is true whether the value is automatically generated by
storing the special values <CODE>NULL</CODE> or <CODE>0</CODE> into the column, or is
an explicit non-special value.

<LI>

In the case of a multiple-row <CODE>INSERT</CODE> statement, <CODE>mysql_insert_id()</CODE>
returns the <STRONG>first</STRONG> automatically generated <CODE>AUTO_INCREMENT</CODE>
value; if no such value is generated, it returns the last <STRONG>last</STRONG>
explicit value inserted into the <CODE>AUTO_INCREMENT</CODE> column.

<LI>

<CODE>INSERT</CODE> statements that generate an <CODE>AUTO_INCREMENT</CODE> value by
inserting <CODE>LAST_INSERT_ID(expr)</CODE> into any column.

<LI>

<CODE>INSERT</CODE> statements that generate an <CODE>AUTO_INCREMENT</CODE> value by
updating any column to <CODE>LAST_INSERT_ID(expr)</CODE>.

<LI>

The value of <CODE>mysql_insert_id()</CODE> is not affected by statements such as
<CODE>SELECT</CODE> that return a result set.

<LI>

If the previous statement returned an error,
the value of <CODE>mysql_insert_id()</CODE> is undefined.
</UL>

<P>
Note that <CODE>mysql_insert_id()</CODE> returns <CODE>0</CODE> if the previous statement
does not use an <CODE>AUTO_INCREMENT</CODE> value.  If you need to save
the value for later, be sure to call <CODE>mysql_insert_id()</CODE> immediately
after the statement that generates the value.

</P>
<P>
The value of <CODE>mysql_insert_id()</CODE> is affected only by statements issued
within the current client connection. It is not affected by statements issued
by other clients.

</P>
<P>
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.

</P>
<P>
Also note that the value of the SQL <CODE>LAST_INSERT_ID()</CODE> function always
contains the most recently generated <CODE>AUTO_INCREMENT</CODE> value, and is
not reset between statements because the value of that function is maintained
in the server.  Another difference is that <CODE>LAST_INSERT_ID()</CODE> is not
updated if you set an <CODE>AUTO_INCREMENT</CODE> column to a specific non-special
value.

</P>
<P>
The reason for the difference between <CODE>LAST_INSERT_ID()</CODE> and
<CODE>mysql_insert_id()</CODE> is that <CODE>LAST_INSERT_ID()</CODE> is made easy to
use in scripts while <CODE>mysql_insert_id()</CODE> tries to provide a little
more exact information of what happens to the <CODE>AUTO_INCREMENT</CODE> column.

</P>

<H4>20.2.3.136  Return Values</H4>

<P>
Described in the preceding discussion.

</P>

<H4>20.2.3.137  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_kill" HREF="manual_toc.html#mysql_kill">20.2.3.138  <CODE>mysql_kill()</CODE></A></H4>

<P>
<A NAME="IDX2070"></A>

</P>
<P>
<CODE>int mysql_kill(MYSQL *mysql, unsigned long pid)</CODE>

</P>

<H4>20.2.3.139  Description</H4>

<P>
Asks the server to kill the thread specified by <CODE>pid</CODE>.

</P>

<H4>20.2.3.140  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.141  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_list_dbs" HREF="manual_toc.html#mysql_list_dbs">20.2.3.142  <CODE>mysql_list_dbs()</CODE></A></H4>

<P>
<A NAME="IDX2071"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_list_dbs(MYSQL *mysql, const char *wild)</CODE>

</P>

<H4>20.2.3.143  Description</H4>

<P>
Returns a result set consisting of database names on the server that match
the simple regular expression specified by the <CODE>wild</CODE> parameter.
<CODE>wild</CODE> may contain the wildcard characters <SAMP>`%'</SAMP> or <SAMP>`_'</SAMP>, or may
be a <CODE>NULL</CODE> pointer to match all databases.  Calling
<CODE>mysql_list_dbs()</CODE> is similar to executing the query <CODE>SHOW
databases [LIKE wild]</CODE>.

</P>
<P>
You must free the result set with <CODE>mysql_free_result()</CODE>.

</P>

<H4>20.2.3.144  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result set for success.  <CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.145  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_list_fields" HREF="manual_toc.html#mysql_list_fields">20.2.3.146  <CODE>mysql_list_fields()</CODE></A></H4>

<P>
<A NAME="IDX2072"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_list_fields(MYSQL *mysql, const char *table, const char *wild)</CODE>

</P>

<H4>20.2.3.147  Description</H4>

<P>
Returns a result set consisting of field names in the given table that match
the simple regular expression specified by the <CODE>wild</CODE> parameter.
<CODE>wild</CODE> may contain the wildcard characters <SAMP>`%'</SAMP> or <SAMP>`_'</SAMP>, or may
be a <CODE>NULL</CODE> pointer to match all fields.  Calling
<CODE>mysql_list_fields()</CODE> is similar to executing the query <CODE>SHOW
COLUMNS FROM tbl_name [LIKE wild]</CODE>.

</P>
<P>
Note that it's recommended that you use <CODE>SHOW COLUMNS FROM tbl_name</CODE>
instead of <CODE>mysql_list_fields()</CODE>.

</P>
<P>
You must free the result set with <CODE>mysql_free_result()</CODE>.

</P>

<H4>20.2.3.148  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result set for success.  <CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.149  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_list_processes" HREF="manual_toc.html#mysql_list_processes">20.2.3.150  <CODE>mysql_list_processes()</CODE></A></H4>

<P>
<A NAME="IDX2073"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_list_processes(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.151  Description</H4>

<P>
Returns a result set describing the current server threads.  This is the same
kind of information as that reported by <CODE>mysqladmin processlist</CODE> or
a <CODE>SHOW PROCESSLIST</CODE> query.

</P>
<P>
You must free the result set with <CODE>mysql_free_result()</CODE>.

</P>

<H4>20.2.3.152  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result set for success.  <CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.153  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_list_tables" HREF="manual_toc.html#mysql_list_tables">20.2.3.154  <CODE>mysql_list_tables()</CODE></A></H4>

<P>
<A NAME="IDX2074"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_list_tables(MYSQL *mysql, const char *wild)</CODE>

</P>

<H4>20.2.3.155  Description</H4>

<P>
Returns a result set consisting of table names in the current database that
match the simple regular expression specified by the <CODE>wild</CODE> parameter.
<CODE>wild</CODE> may contain the wildcard characters <SAMP>`%'</SAMP> or <SAMP>`_'</SAMP>, or may
be a <CODE>NULL</CODE> pointer to match all tables.  Calling
<CODE>mysql_list_tables()</CODE> is similar to executing the query <CODE>SHOW
tables [LIKE wild]</CODE>.

</P>
<P>
You must free the result set with <CODE>mysql_free_result()</CODE>.

</P>

<H4>20.2.3.156  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result set for success.  <CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.157  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_num_fields" HREF="manual_toc.html#mysql_num_fields">20.2.3.158  <CODE>mysql_num_fields()</CODE></A></H4>

<P>
<A NAME="IDX2075"></A>
<A NAME="IDX2076"></A>

</P>
<P>
<CODE>unsigned int mysql_num_fields(MYSQL_RES *result)</CODE>

</P>
<P>
Or:

</P>
<P>
<CODE>unsigned int mysql_num_fields(MYSQL *mysql)</CODE>

</P>
<P>
The second form doesn't work on MySQL 3.22.24 or newer.  To pass a
<CODE>MYSQL*</CODE> argument, you must use
<CODE>unsigned int mysql_field_count(MYSQL *mysql)</CODE> instead.

</P>

<H4>20.2.3.159  Description</H4>

<P>
Returns the number of columns in a result set.

</P>
<P>
Note that you can get the number of columns either from a pointer to a result
set or to a connection handle.  You would use the connection handle if
<CODE>mysql_store_result()</CODE> or <CODE>mysql_use_result()</CODE> returned
<CODE>NULL</CODE> (and thus you have no result set pointer).  In this case, you can
call <CODE>mysql_field_count()</CODE> to determine whether
<CODE>mysql_store_result()</CODE> should have produced a non-empty result.  This
allows the client program to take proper action without knowing whether or
not the query was a <CODE>SELECT</CODE> (or <CODE>SELECT</CODE>-like) statement.  The
example shown here illustrates how this may be done.

</P>
<P>
See section <A HREF="manual.html#NULL_mysql_store_result">20.2.12.1  Why <CODE>mysql_store_result()</CODE> Sometimes Returns <CODE>NULL</CODE> After <CODE>mysql_query()</CODE> Returns Success</A>.

</P>

<H4>20.2.3.160  Return Values</H4>

<P>
An unsigned integer representing the number of fields in a result set.

</P>

<H4>20.2.3.161  Errors</H4>
<P>
None.

</P>

<H4>20.2.3.162  Example</H4>


<PRE>
MYSQL_RES *result;
unsigned int num_fields;
unsigned int num_rows;

if (mysql_query(&#38;mysql,query_string))
{
    // error
}
else // query succeeded, process any data returned by it
{
    result = mysql_store_result(&#38;mysql);
    if (result)  // there are rows
    {
        num_fields = mysql_num_fields(result);
        // retrieve rows, then call mysql_free_result(result)
    }
    else  // mysql_store_result() returned nothing; should it have?
    {
        if (mysql_errno(&#38;mysql))
        {
           fprintf(stderr, "Error: %s\n", mysql_error(&#38;mysql));
        }
        else if (mysql_field_count(&#38;mysql) == 0)
        {
            // query does not return data
            // (it was not a SELECT)
            num_rows = mysql_affected_rows(&#38;mysql);
        }
    }
}
</PRE>

<P>
An alternative (if you know that your query should have returned a result set)
is to replace the <CODE>mysql_errno(&#38;mysql)</CODE> call with a check whether
<CODE>mysql_field_count(&#38;mysql)</CODE> is = 0.  This will happen only if something
went wrong.

</P>



<H4><A NAME="mysql_num_rows" HREF="manual_toc.html#mysql_num_rows">20.2.3.163  <CODE>mysql_num_rows()</CODE></A></H4>

<P>
<A NAME="IDX2077"></A>

</P>
<P>
<CODE>my_ulonglong mysql_num_rows(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.164  Description</H4>

<P>
Returns the number of rows in the result set.

</P>
<P>
The use of <CODE>mysql_num_rows()</CODE> depends on whether you use
<CODE>mysql_store_result()</CODE> or <CODE>mysql_use_result()</CODE> to return the result
set.  If you use <CODE>mysql_store_result()</CODE>, <CODE>mysql_num_rows()</CODE> may be
called immediately.  If you use <CODE>mysql_use_result()</CODE>,
<CODE>mysql_num_rows()</CODE> will not return the correct value until all the rows
in the result set have been retrieved.

</P>

<H4>20.2.3.165  Return Values</H4>

<P>
The number of rows in the result set.

</P>

<H4>20.2.3.166  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_options" HREF="manual_toc.html#mysql_options">20.2.3.167  <CODE>mysql_options()</CODE></A></H4>

<P>
<A NAME="IDX2078"></A>

</P>
<P>
<CODE>int mysql_options(MYSQL *mysql, enum mysql_option option, const char *arg)</CODE>

</P>

<H4>20.2.3.168  Description</H4>

<P>
Can be used to set extra connect options and affect behavior for a connection.
This function may be called multiple times to set several options.

</P>
<P>
<CODE>mysql_options()</CODE> should be called after <CODE>mysql_init()</CODE> and before
<CODE>mysql_connect()</CODE> or <CODE>mysql_real_connect()</CODE>.

</P>
<P>
The <CODE>option</CODE> argument is the option that you want to set; the <CODE>arg</CODE>
argument is the value for the option. If the option is an integer, then
<CODE>arg</CODE> should point to the value of the integer.

</P>
<P>
Possible options values:

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Argument Type</STRONG> </TD><TD> <STRONG>Function</STRONG>
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_CONNECT_TIMEOUT</CODE> </TD><TD> <CODE>unsigned int *</CODE> </TD><TD> Connect timeout in seconds.
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_READ_TIMEOUT</CODE> </TD><TD> <CODE>unsigned int *</CODE> </TD><TD> Timeout for reads from server (works currently only on Windows on TCP/IP connections)
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_WRITE_TIMEOUT</CODE> </TD><TD> <CODE>unsigned int *</CODE> </TD><TD> Timeout for writes to server (works currently only on Windows on TCP/IP connections)
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_COMPRESS</CODE> </TD><TD> Not used </TD><TD> Use the compressed client/server protocol.
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_LOCAL_INFILE</CODE> </TD><TD> optional pointer to uint </TD><TD> If no pointer is given or if pointer points to an <CODE>unsigned int != 0</CODE> the command <CODE>LOAD LOCAL INFILE</CODE> is enabled.
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_NAMED_PIPE</CODE> </TD><TD> Not used </TD><TD> Use named pipes to connect to a MySQL server on NT.
</TD></TR>
<TR><TD><CODE>MYSQL_INIT_COMMAND</CODE> </TD><TD> <CODE>char *</CODE> </TD><TD> Command to execute when connecting to the MySQL server. Will automatically be re-executed when reconnecting.
</TD></TR>
<TR><TD><CODE>MYSQL_READ_DEFAULT_FILE</CODE> </TD><TD> <CODE>char *</CODE> </TD><TD> Read options from the named option file instead of from <TT>`my.cnf'</TT>.
</TD></TR>
<TR><TD><CODE>MYSQL_READ_DEFAULT_GROUP</CODE> </TD><TD> <CODE>char *</CODE> </TD><TD> Read options from the named group from <TT>`my.cnf'</TT> or the file specified with <CODE>MYSQL_READ_DEFAULT_FILE</CODE>.
</TD></TR>
<TR><TD><CODE>MYSQL_OPT_PROTOCOL</CODE> </TD><TD> <CODE>unsigned int *</CODE> </TD><TD> Type of protocol to use. Should be one of the enum values of <CODE>mysql_protocol_type</CODE> defined in <TT>`mysql.h'</TT>.
</TD></TR>
<TR><TD><CODE>MYSQL_SHARED_MEMORY_BASE_NAME</CODE> </TD><TD> <CODE>char*</CODE> </TD><TD> Named of of shared memory object for communication to server. Should be same as the option <CODE>-shared-memory-base-name</CODE> used for the mysqld server you want's to connect to.
</TD></TR>
</TABLE>

<P>
Note that the group <CODE>client</CODE> is always read if you use
<CODE>MYSQL_READ_DEFAULT_FILE</CODE> or <CODE>MYSQL_READ_DEFAULT_GROUP</CODE>.

</P>
<P>
The specified group in the option file may contain the following options:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>connect-timeout</CODE> </TD><TD> Connect timeout in seconds. On Linux this timeout is also used for waiting for the first answer from the server.
</TD></TR>
<TR><TD><CODE>compress</CODE> </TD><TD> Use the compressed client/server protocol.
</TD></TR>
<TR><TD><CODE>database</CODE> </TD><TD> Connect to this database if no database was specified in the connect command.
</TD></TR>
<TR><TD><CODE>debug</CODE> </TD><TD> Debug options.
</TD></TR>
<TR><TD><CODE>disable-local-infile</CODE> </TD><TD> Disable use of <CODE>LOAD DATA LOCAL</CODE>.
</TD></TR>
<TR><TD><CODE>host</CODE> </TD><TD> Default hostname.
</TD></TR>
<TR><TD><CODE>init-command</CODE> </TD><TD> Command to execute when connecting to MySQL server. Will automatically be re-executed when reconnecting.
</TD></TR>
<TR><TD><CODE>interactive-timeout</CODE> </TD><TD> Same as specifying <CODE>CLIENT_INTERACTIVE</CODE> to <CODE>mysql_real_connect()</CODE>. See section <A HREF="manual.html#mysql_real_connect">20.2.3.179  <CODE>mysql_real_connect()</CODE></A>.
</TD></TR>
<TR><TD><CODE>local-infile[=(0|1)]</CODE> </TD><TD> If no argument or argument != 0 then enable use of <CODE>LOAD DATA LOCAL</CODE>.
</TD></TR>
<TR><TD><CODE>max_allowed_packet</CODE> </TD><TD> Max size of packet client can read from server.
</TD></TR>
<TR><TD><CODE>password</CODE> </TD><TD> Default password.
</TD></TR>
<TR><TD><CODE>pipe</CODE> </TD><TD> Use named pipes to connect to a MySQL server on NT.
</TD></TR>
<TR><TD><CODE>protocol={TCP | SOCKET | PIPE | MEMORY}</CODE> </TD><TD> The protocol to use when connecting to server (New in 4.1)
</TD></TR>
<TR><TD><CODE>port</CODE> </TD><TD> Default port number.
</TD></TR>
<TR><TD><CODE>return-found-rows</CODE> </TD><TD> Tell <CODE>mysql_info()</CODE> to return found rows instead of updated rows when using <CODE>UPDATE</CODE>.
</TD></TR>
<TR><TD><CODE>shared-memory-base-name=name</CODE> </TD><TD> Shared memory name to use to connect to server (default is "MySQL"). New in MySQL 4.1.
</TD></TR>
<TR><TD><CODE>socket</CODE> </TD><TD> Default socket file.
</TD></TR>
<TR><TD><CODE>user</CODE> </TD><TD> Default user.
</TD></TR>
</TABLE>

<P>
Note that <CODE>timeout</CODE> has been replaced by <CODE>connect-timeout</CODE>, but
<CODE>timeout</CODE> will still work for a while.

</P>
<P>
For more information about option files, see section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>

<H4>20.2.3.169  Return Values</H4>

<P>
Zero for success.  Non-zero if you used an unknown option.

</P>

<H4>20.2.3.170  Example</H4>


<PRE>
MYSQL mysql;

mysql_init(&#38;mysql);
mysql_options(&#38;mysql,MYSQL_OPT_COMPRESS,0);
mysql_options(&#38;mysql,MYSQL_READ_DEFAULT_GROUP,"odbc");
if (!mysql_real_connect(&#38;mysql,"host","user","passwd","database",0,NULL,0))
{
    fprintf(stderr, "Failed to connect to database: Error: %s\n",
          mysql_error(&#38;mysql));
}
</PRE>

<P>
This code requests the client to use the compressed client/server protocol and
read the additional options from the <CODE>odbc</CODE> section in the <TT>`my.cnf'</TT>
file.

</P>



<H4><A NAME="mysql_ping" HREF="manual_toc.html#mysql_ping">20.2.3.171  <CODE>mysql_ping()</CODE></A></H4>

<P>
<A NAME="IDX2079"></A>

</P>
<P>
<CODE>int mysql_ping(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.172  Description</H4>

<P>
Checks whether the connection to the server is working. If it has gone
down, an automatic reconnection is attempted.

</P>
<P>
This function can be used by clients that remain idle for a long while,
to check whether the server has closed the connection and reconnect
if necessary.

</P>

<H4>20.2.3.173  Return Values</H4>

<P>
Zero if the server is alive. Non-zero if an error occurred.

</P>

<H4>20.2.3.174  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_query" HREF="manual_toc.html#mysql_query">20.2.3.175  <CODE>mysql_query()</CODE></A></H4>

<P>
<A NAME="IDX2080"></A>

</P>
<P>
<CODE>int mysql_query(MYSQL *mysql, const char *query)</CODE>

</P>

<H4>20.2.3.176  Description</H4>
<P>
Executes the SQL query pointed to by the null-terminated string <CODE>query</CODE>.
The query must consist of a single SQL statement.  You should not add
a terminating semicolon (<SAMP>`;'</SAMP>) or <CODE>\g</CODE> to the statement.

</P>
<P>
<CODE>mysql_query()</CODE> cannot be used for queries that contain binary data; you
should use <CODE>mysql_real_query()</CODE> instead.  (Binary data may contain the
<SAMP>`\0'</SAMP> character, which <CODE>mysql_query()</CODE> interprets as the end of the
query string.)

</P>
<P>
If you want to know whether the query should return a result set, you can
use <CODE>mysql_field_count()</CODE> to check for this.
See section <A HREF="manual.html#mysql_field_count">20.2.3.85  <CODE>mysql_field_count()</CODE></A>.

</P>

<H4>20.2.3.177  Return Values</H4>

<P>
Zero if the query was successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.178  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_real_connect" HREF="manual_toc.html#mysql_real_connect">20.2.3.179  <CODE>mysql_real_connect()</CODE></A></H4>

<P>
<A NAME="IDX2081"></A>

</P>
<P>
<CODE>MYSQL *mysql_real_connect(MYSQL *mysql, const char *host,
                 const char *user, const char *passwd, const char *db,
                 unsigned int port, const char *unix_socket,
                 unsigned long client_flag)</CODE>

</P>

<H4>20.2.3.180  Description</H4>

<P>
<CODE>mysql_real_connect()</CODE> attempts to establish a connection to a
MySQL database engine running on <CODE>host</CODE>.
<CODE>mysql_real_connect()</CODE> must complete successfully before you can execute
any of the other API functions, with the exception of
<CODE>mysql_get_client_info()</CODE>.

</P>
<P>
The parameters are specified as follows:

</P>

<UL>
<LI>

The first parameter should be the address of an existing <CODE>MYSQL</CODE>
structure.  Before calling <CODE>mysql_real_connect()</CODE> you must call
<CODE>mysql_init()</CODE> to initialize the <CODE>MYSQL</CODE> structure. You can
change a lot of connect options with the <CODE>mysql_options()</CODE>
call.  See section <A HREF="manual.html#mysql_options">20.2.3.167  <CODE>mysql_options()</CODE></A>.

<LI>

The value of <CODE>host</CODE> may be either a hostname or an IP address.  If
<CODE>host</CODE> is <CODE>NULL</CODE> or the string <CODE>"localhost"</CODE>, a connection to
the local host is assumed. If the OS supports sockets (Unix) or named pipes
(Windows), they are used instead of TCP/IP to connect to the server.

<LI>

The <CODE>user</CODE> parameter contains the user's MySQL login ID.  If
<CODE>user</CODE> is <CODE>NULL</CODE> or the empty string <CODE>""</CODE>, the current
user is assumed.  Under Unix, this is the current login name.  Under
Windows ODBC, the current username must be specified explicitly.
See section <A HREF="manual.html#ODBC_administrator">20.3.2  How to Fill in the Various Fields in the ODBC Administrator Program</A>.

<LI>

The <CODE>passwd</CODE> parameter contains the password for <CODE>user</CODE>.  If
<CODE>passwd</CODE> is <CODE>NULL</CODE>, only entries in the <CODE>user</CODE> table for the
user that have a blank (empty) password field will be checked for a match. This
allows the database administrator to set up the MySQL privilege
system in such a way that users get different privileges depending on whether
or not they have specified a password.

Note: Do not attempt to encrypt the password before calling
<CODE>mysql_real_connect()</CODE>; password encryption is handled automatically by
the client API.

<LI>

<CODE>db</CODE> is the database name.
If <CODE>db</CODE> is not <CODE>NULL</CODE>, the connection will set the default
database to this value.

<LI>

If <CODE>port</CODE> is not 0, the value will be used as the port number
for the TCP/IP connection.  Note that the <CODE>host</CODE> parameter
determines the type of the connection.

<LI>

If <CODE>unix_socket</CODE> is not <CODE>NULL</CODE>, the string specifies the
socket or named pipe that should be used.  Note that the <CODE>host</CODE>
parameter determines the type of the connection.

<LI>

The value of <CODE>client_flag</CODE> is usually 0, but can be set to a combination
of the following flags in very special circumstances:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Flag Name</STRONG> </TD><TD> <STRONG>Flag Nescription</STRONG>
</TD></TR>
<TR><TD><CODE>CLIENT_COMPRESS</CODE> </TD><TD> Use compression protocol.
</TD></TR>
<TR><TD><CODE>CLIENT_FOUND_ROWS</CODE> </TD><TD> Return the number of found (matched) rows, not the number of affected rows.
</TD></TR>
<TR><TD><CODE>CLIENT_IGNORE_SPACE</CODE> </TD><TD> Allow spaces after function names. Makes all functions names reserved words.
</TD></TR>
<TR><TD><CODE>CLIENT_INTERACTIVE</CODE> </TD><TD> Allow <CODE>interactive_timeout</CODE> seconds (instead of <CODE>wait_timeout</CODE> seconds) of inactivity before closing the connection. The client's session <CODE>wait_timeout</CODE> variable will be set to the value of the session <CODE>interactive_timeout</CODE> variable.
</TD></TR>
<TR><TD><CODE>CLIENT_LOCAL_FILES</CODE> </TD><TD> Enable <CODE>LOAD DATA LOCAL</CODE> handling.
</TD></TR>
<TR><TD><CODE>CLIENT_MULTI_STATEMENTS</CODE> </TD><TD> Tell the server that the client may send multiple-row-queries (separated by <SAMP>`;'</SAMP>). If this flag is not set, multiple-row-queries are disabled. New in 4.1.
</TD></TR>
<TR><TD><CODE>CLIENT_MULTI_RESULTS</CODE> </TD><TD> Tell the server that the client can handle multiple-result sets from multi-queries or stored procedures.  This is automatically set if <CODE>CLIENT_MULTI_STATEMENTS</CODE> is set. New in 4.1.
</TD></TR>
<TR><TD><CODE>CLIENT_NO_SCHEMA</CODE> </TD><TD> Don't allow the <CODE>db_name.tbl_name.col_name</CODE> syntax.  This is for ODBC. It causes the parser to generate an error if you use that syntax, which is useful for trapping bugs in some ODBC programs.
</TD></TR>
<TR><TD><CODE>CLIENT_ODBC</CODE> </TD><TD> The client is an ODBC client. This changes <CODE>mysqld</CODE> to be more ODBC-friendly.
</TD></TR>
<TR><TD><CODE>CLIENT_SSL</CODE> </TD><TD> Use SSL (encrypted protocol). This option should not be set by application programs; it is set internally in the client library.
</TD></TR>
</TABLE>
</UL>


<H4>20.2.3.181  Return Values</H4>

<P>
A <CODE>MYSQL*</CODE> connection handle if the connection was successful,
<CODE>NULL</CODE> if the connection was unsuccessful.  For a successful connection,
the return value is the same as the value of the first parameter.

</P>

<H4>20.2.3.182  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_CONN_HOST_ERROR</CODE>
<DD>
Failed to connect to the MySQL server.

<DT><CODE>CR_CONNECTION_ERROR</CODE>
<DD>
Failed to connect to the local MySQL server.

<DT><CODE>CR_IPSOCK_ERROR</CODE>
<DD>
Failed to create an IP socket.

<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.

<DT><CODE>CR_SOCKET_CREATE_ERROR</CODE>
<DD>
Failed to create a Unix socket.

<DT><CODE>CR_UNKNOWN_HOST</CODE>
<DD>
Failed to find the IP address for the hostname.

<DT><CODE>CR_VERSION_ERROR</CODE>
<DD>
A protocol mismatch resulted from attempting to connect to a server with a
client library that uses a different protocol version.  This can happen if you
use a very old client library to connect to a new server that wasn't started
with the <CODE>--old-protocol</CODE> option.

<DT><CODE>CR_NAMEDPIPEOPEN_ERROR</CODE>
<DD>
Failed to create a named pipe on Windows.

<DT><CODE>CR_NAMEDPIPEWAIT_ERROR</CODE>
<DD>
Failed to wait for a named pipe on Windows.

<DT><CODE>CR_NAMEDPIPESETSTATE_ERROR</CODE>
<DD>
Failed to get a pipe handler on Windows.

<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
If <CODE>connect_timeout</CODE> &#62; 0 and it took longer than <CODE>connect_timeout</CODE>
seconds to connect to the server or if the server died while executing the
<CODE>init-command</CODE>.

</DL>


<H4>20.2.3.183  Example</H4>


<PRE>
MYSQL mysql;

mysql_init(&#38;mysql);
mysql_options(&#38;mysql,MYSQL_READ_DEFAULT_GROUP,"your_prog_name");
if (!mysql_real_connect(&#38;mysql,"host","user","passwd","database",0,NULL,0))
{
    fprintf(stderr, "Failed to connect to database: Error: %s\n",
          mysql_error(&#38;mysql));
}
</PRE>

<P>
By using <CODE>mysql_options()</CODE> the MySQL library will read the
<CODE>[client]</CODE> and <CODE>[your_prog_name]</CODE> sections in the <TT>`my.cnf'</TT>
file which will ensure that your program will work, even if someone has
set up MySQL in some non-standard way.

</P>
<P>
Note that upon connection, <CODE>mysql_real_connect()</CODE> sets the <CODE>reconnect</CODE>
flag (part of the <CODE>MYSQL</CODE> structure) to a value of <CODE>1</CODE>. This
flag indicates, in the event that a query cannot be performed because
of a lost connection, to try reconnecting to the server before giving up.

</P>



<H4><A NAME="mysql_real_escape_string" HREF="manual_toc.html#mysql_real_escape_string">20.2.3.184  <CODE>mysql_real_escape_string()</CODE></A></H4>

<P>
<A NAME="IDX2082"></A>

</P>
<P>
<CODE>unsigned long mysql_real_escape_string(MYSQL *mysql, char *to, const char *from, unsigned long length)</CODE>

</P>

<H4>20.2.3.185  Description</H4>

<P>
This function is used to create a legal SQL string that you can use in a
SQL statement. See section <A HREF="manual.html#String_syntax">10.1.1  Strings</A>.

</P>
<P>
The string in <CODE>from</CODE> is encoded to an escaped SQL string, taking
into account the current character set of the connection. The result is placed
in <CODE>to</CODE> and a terminating null byte is appended.  Characters
encoded are <CODE>NUL</CODE> (ASCII 0), <SAMP>`\n'</SAMP>, <SAMP>`\r'</SAMP>, <SAMP>`\'</SAMP>,
<SAMP>`''</SAMP>, <SAMP>`"'</SAMP>, and Control-Z (see section <A HREF="manual.html#Literals">10.1  Literal Values</A>).
(Strictly speaking, MySQL requires only that backslash and the quote
character used to quote the string in the query be escaped.  This function
quotes the other characters to make them easier to read in log files.)

</P>
<P>
The string pointed to by <CODE>from</CODE> must be <CODE>length</CODE> bytes long.  You
must allocate the <CODE>to</CODE> buffer to be at least <CODE>length*2+1</CODE> bytes
long.  (In the worst case, each character may need to be encoded as using two
bytes, and you need room for the terminating null byte.)  When
<CODE>mysql_real_escape_string()</CODE> returns, the contents of <CODE>to</CODE> will be a
null-terminated string.  The return value is the length of the encoded
string, not including the terminating null character.

</P>

<H4>20.2.3.186  Example</H4>


<PRE>
char query[1000],*end;

end = strmov(query,"INSERT INTO test_table values(");
*end++ = '\'';
end += mysql_real_escape_string(&#38;mysql, end,"What's this",11);
*end++ = '\'';
*end++ = ',';
*end++ = '\'';
end += mysql_real_escape_string(&#38;mysql, end,"binary data: \0\r\n",16);
*end++ = '\'';
*end++ = ')';

if (mysql_real_query(&#38;mysql,query,(unsigned int) (end - query)))
{
   fprintf(stderr, "Failed to insert row, Error: %s\n",
           mysql_error(&#38;mysql));
}
</PRE>

<P>
The <CODE>strmov()</CODE> function used in the example is included in the
<CODE>mysqlclient</CODE> library and works like <CODE>strcpy()</CODE> but returns a
pointer to the terminating null of the first parameter.

</P>

<H4>20.2.3.187  Return Values</H4>

<P>
The length of the value placed into <CODE>to</CODE>, not including the
terminating null character.

</P>

<H4>20.2.3.188  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_real_query" HREF="manual_toc.html#mysql_real_query">20.2.3.189  <CODE>mysql_real_query()</CODE></A></H4>

<P>
<A NAME="IDX2083"></A>

</P>
<P>
<CODE>int mysql_real_query(MYSQL *mysql, const char *query, unsigned long length)</CODE>

</P>

<H4>20.2.3.190  Description</H4>

<P>
Executes the SQL query pointed to by <CODE>query</CODE>, which should be a string
<CODE>length</CODE> bytes long.  The query must consist of a single SQL statement.
You should not add a terminating semicolon (<SAMP>`;'</SAMP>) or <CODE>\g</CODE> to the
statement.

</P>
<P>
You <STRONG>must</STRONG> use <CODE>mysql_real_query()</CODE> rather than
<CODE>mysql_query()</CODE> for queries that contain binary data, because binary data
may contain the <SAMP>`\0'</SAMP> character.  In addition, <CODE>mysql_real_query()</CODE>
is faster than <CODE>mysql_query()</CODE> because it does not call <CODE>strlen()</CODE> on
the query string.

</P>
<P>
If you want to know whether the query should return a result set, you can
use <CODE>mysql_field_count()</CODE> to check for this.
See section <A HREF="manual.html#mysql_field_count">20.2.3.85  <CODE>mysql_field_count()</CODE></A>.

</P>

<H4>20.2.3.191  Return Values</H4>

<P>
Zero if the query was successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.192  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_reload" HREF="manual_toc.html#mysql_reload">20.2.3.193  <CODE>mysql_reload()</CODE></A></H4>

<P>
<A NAME="IDX2084"></A>

</P>
<P>
<CODE>int mysql_reload(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.194  Description</H4>

<P>
Asks the MySQL server to reload the grant tables. The
connected user must have the <CODE>RELOAD</CODE> privilege.

</P>
<P>
This function is deprecated.  It is preferable to use <CODE>mysql_query()</CODE>
to issue an SQL <CODE>FLUSH PRIVILEGES</CODE> statement instead.

</P>

<H4>20.2.3.195  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.196  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_row_seek" HREF="manual_toc.html#mysql_row_seek">20.2.3.197  <CODE>mysql_row_seek()</CODE></A></H4>

<P>
<A NAME="IDX2085"></A>

</P>
<P>
<CODE>MYSQL_ROW_OFFSET mysql_row_seek(MYSQL_RES *result, MYSQL_ROW_OFFSET offset)</CODE>

</P>

<H4>20.2.3.198  Description</H4>
<P>
Sets the row cursor to an arbitrary row in a query result set.
The <CODE>offset</CODE> value is a row offset that should be a value returned
from <CODE>mysql_row_tell()</CODE> or from <CODE>mysql_row_seek()</CODE>.
This value is not a row number; if you want to seek to a row within a
result set by number, use <CODE>mysql_data_seek()</CODE> instead.

</P>
<P>
This function requires that the result set structure contains the
entire result of the query, so <CODE>mysql_row_seek()</CODE> may be used
only in conjunction with <CODE>mysql_store_result()</CODE>, not with
<CODE>mysql_use_result()</CODE>.

</P>

<H4>20.2.3.199  Return Values</H4>

<P>
The previous value of the row cursor.  This value may be passed to a
subsequent call to <CODE>mysql_row_seek()</CODE>.

</P>

<H4>20.2.3.200  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_row_tell" HREF="manual_toc.html#mysql_row_tell">20.2.3.201  <CODE>mysql_row_tell()</CODE></A></H4>

<P>
<A NAME="IDX2086"></A>

</P>
<P>
<CODE>MYSQL_ROW_OFFSET mysql_row_tell(MYSQL_RES *result)</CODE>

</P>

<H4>20.2.3.202  Description</H4>

<P>
Returns the current position of the row cursor for the last
<CODE>mysql_fetch_row()</CODE>. This value can be used as an argument to
<CODE>mysql_row_seek()</CODE>.

</P>
<P>
You should use <CODE>mysql_row_tell()</CODE> only after <CODE>mysql_store_result()</CODE>,
not after <CODE>mysql_use_result()</CODE>.

</P>

<H4>20.2.3.203  Return Values</H4>

<P>
The current offset of the row cursor.

</P>

<H4>20.2.3.204  Errors</H4>
<P>
None.

</P>


<H4><A NAME="mysql_select_db" HREF="manual_toc.html#mysql_select_db">20.2.3.205  <CODE>mysql_select_db()</CODE></A></H4>

<P>
<A NAME="IDX2087"></A>

</P>
<P>
<CODE>int mysql_select_db(MYSQL *mysql, const char *db)</CODE>

</P>

<H4>20.2.3.206  Description</H4>

<P>
Causes the database specified by <CODE>db</CODE> to become the default (current)
database on the connection specified by <CODE>mysql</CODE>.  In subsequent queries,
this database is the default for table references that do not include an
explicit database specifier.

</P>
<P>
<CODE>mysql_select_db()</CODE> fails unless the connected user can be authenticated
as having permission to use the database.

</P>

<H4>20.2.3.207  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.208  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_set_server_option" HREF="manual_toc.html#mysql_set_server_option">20.2.3.209  <CODE>mysql_set_server_option()</CODE></A></H4>

<P>
<A NAME="IDX2088"></A>

</P>
<P>
<CODE>int mysql_set_server_option(MYSQL *mysql, enum enum_mysql_set_option option)</CODE>

</P>

<H4>20.2.3.210  Description</H4>

<P>
Enables or disables an option for the connection. <CODE>option</CODE> can have one
of the following values:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD>MYSQL_OPTION_MULTI_STATEMENTS_ON </TD><TD> Enable multi statement support.
</TD></TR>
<TR><TD>MYSQL_OPTION_MULTI_STATEMENTS_OFF </TD><TD> Disable multi statement support.
</TD></TR>
</TABLE>


<H4>20.2.3.211  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.212  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>ER_UNKNOWN_COM_ERROR</CODE>
<DD>
The server didn't support <CODE>mysql_set_server_option()</CODE> (which is the
case that the server is older than 4.1.1) or the server didn't support
the option one tried to set.
</DL>



<H4><A NAME="mysql_shutdown" HREF="manual_toc.html#mysql_shutdown">20.2.3.213  <CODE>mysql_shutdown()</CODE></A></H4>

<P>
<A NAME="IDX2089"></A>

</P>
<P>
<CODE>int mysql_shutdown(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.214  Description</H4>

<P>
Asks the database server to shut down. The connected user must have
<CODE>SHUTDOWN</CODE> privileges.

</P>

<H4>20.2.3.215  Return Values</H4>

<P>
Zero for success.  Non-zero if an error occurred.

</P>

<H4>20.2.3.216  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_sqlstate" HREF="manual_toc.html#mysql_sqlstate">20.2.3.217  <CODE>mysql_sqlstate()</CODE></A></H4>

<P>
<A NAME="IDX2090"></A>

</P>
<P>
<CODE>const char *mysql_sqlstate(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.218  Description</H4>

<P>
Returns a null-terminated string containing the SQLSTATE error code for the
last error.  The error code consists of five characters.
<CODE>'00000'</CODE> means ``no error.''
The values are specified by ANSI SQL and ODBC.
For a list of possible values, see section <A HREF="manual.html#Error-returns">21.1  Error Returns</A>.

</P>
<P>
Note that not all MySQL errors are yet mapped to SQLSTATE's.
The value <CODE>'HY000'</CODE> (general error) is used
for unmapped errors.

</P>
<P>
This function was added to MySQL 4.1.1.

</P>

<H4>20.2.3.219  Return Values</H4>

<P>
A null-terminated character string containing the SQLSTATE error code.

</P>

<H4>20.2.3.220  See Also</H4>

<P>
See section <A HREF="manual.html#mysql_errno">20.2.3.51  <CODE>mysql_errno()</CODE></A>.
See section <A HREF="manual.html#mysql_error">20.2.3.55  <CODE>mysql_error()</CODE></A>.
See section <A HREF="manual.html#mysql_stmt_sqlstate">20.2.7.95  <CODE>mysql_stmt_sqlstate()</CODE></A>.

</P>



<H4><A NAME="mysql_ssl_set" HREF="manual_toc.html#mysql_ssl_set">20.2.3.221  <CODE>mysql_ssl_set()</CODE></A></H4>

<P>
<A NAME="IDX2091"></A>

</P>
<P>
<CODE>int mysql_ssl_set(MYSQL *mysql, const char *key,
                 const char *cert, const char *ca,
                 const char *capath, const char *cipher)</CODE>

</P>

<H4>20.2.3.222  Description</H4>

<P>
<CODE>mysql_ssl_set()</CODE> is used for establishing secure connections using
SSL. It must be called before <CODE>mysql_real_connect()</CODE>.

</P>
<P>
<CODE>mysql_ssl_set()</CODE> does nothing unless OpenSSL support is enabled in
the client library.

</P>
<P>
<CODE>mysql</CODE> is the connection handler returned from <CODE>mysql_init()</CODE>.
The other parameters are specified as follows:

</P>

<UL>
<LI>

<CODE>key</CODE> is the pathname to the key file.

<LI>

<CODE>cert</CODE> is the pathname to the certificate file.

<LI>

<CODE>ca</CODE> is the pathname to the certificate authority file.

<LI>

<CODE>capath</CODE> is the pathname to a directory that contains trusted 
SSL CA certificates in pem format.

<LI>

<CODE>cipher</CODE> is a list of allowable ciphers to use for SSL encryption.

</UL>

<P>
Any unused SSL parameters may be given as <CODE>NULL</CODE>.

</P>

<H4>20.2.3.223  Return Values</H4>

<P>
This function always returns <CODE>0</CODE>. If SSL setup is incorrect,
<CODE>mysql_real_connect()</CODE> will return an error when you attempt to connect.

</P>


<H4><A NAME="mysql_stat" HREF="manual_toc.html#mysql_stat">20.2.3.224  <CODE>mysql_stat()</CODE></A></H4>

<P>
<A NAME="IDX2092"></A>

</P>
<P>
<CODE>char *mysql_stat(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.225  Description</H4>

<P>
Returns a character string containing information similar to that provided by
the <CODE>mysqladmin status</CODE> command.  This includes uptime in seconds and
the number of running threads, questions, reloads, and open tables.

</P>

<H4>20.2.3.226  Return Values</H4>

<P>
A character string describing the server status. <CODE>NULL</CODE> if an
error occurred.

</P>

<H4>20.2.3.227  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_store_result" HREF="manual_toc.html#mysql_store_result">20.2.3.228  <CODE>mysql_store_result()</CODE></A></H4>

<P>
<A NAME="IDX2093"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_store_result(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.229  Description</H4>

<P>
You must call <CODE>mysql_store_result()</CODE> or <CODE>mysql_use_result()</CODE>
for every query that successfully retrieves data (<CODE>SELECT</CODE>,
<CODE>SHOW</CODE>, <CODE>DESCRIBE</CODE>, <CODE>EXPLAIN</CODE>).

</P>
<P>
You don't have to call <CODE>mysql_store_result()</CODE> or
<CODE>mysql_use_result()</CODE> for other queries, but it will not do any
harm or cause any notable performance if you call <CODE>mysql_store_result()</CODE>
in all cases.  You can detect if the query didn't have a result set by
checking if <CODE>mysql_store_result()</CODE> returns 0 (more about this later on).

</P>
<P>
If you want to know whether the query should return a result set, you can
use <CODE>mysql_field_count()</CODE> to check for this.
See section <A HREF="manual.html#mysql_field_count">20.2.3.85  <CODE>mysql_field_count()</CODE></A>.

</P>
<P>
<CODE>mysql_store_result()</CODE> reads the entire result of a query to the client,
allocates a <CODE>MYSQL_RES</CODE> structure, and places the result into this
structure.

</P>
<P>
<CODE>mysql_store_result()</CODE> returns a null pointer if the query didn't return
a result set (if the query was, for example, an <CODE>INSERT</CODE> statement).

</P>
<P>
<CODE>mysql_store_result()</CODE> also returns a null pointer if reading of the
result set failed. You can check whether an error occurred by checking if
<CODE>mysql_error()</CODE> returns a non-empty string, if
<CODE>mysql_errno()</CODE> returns non-zero, or if <CODE>mysql_field_count()</CODE>
returns zero.

</P>
<P>
An empty result set is returned if there are no rows returned.  (An empty
result set differs from a null pointer as a return value.)

</P>
<P>
Once you have called <CODE>mysql_store_result()</CODE> and got a result back
that isn't a null pointer, you may call <CODE>mysql_num_rows()</CODE> to find
out how many rows are in the result set.

</P>
<P>
You can call <CODE>mysql_fetch_row()</CODE> to fetch rows from the result set,
or <CODE>mysql_row_seek()</CODE> and <CODE>mysql_row_tell()</CODE> to obtain or
set the current row position within the result set.

</P>
<P>
You must call <CODE>mysql_free_result()</CODE> once you are done with the result
set.

</P>
<P>
See section <A HREF="manual.html#NULL_mysql_store_result">20.2.12.1  Why <CODE>mysql_store_result()</CODE> Sometimes Returns <CODE>NULL</CODE> After <CODE>mysql_query()</CODE> Returns Success</A>.

</P>

<H4>20.2.3.230  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result structure with the results. <CODE>NULL</CODE> if
an error occurred.

</P>

<H4>20.2.3.231  Errors</H4>

<P>
<CODE>mysql_store_result()</CODE> resets <CODE>mysql_error</CODE> and
<CODE>mysql_errno</CODE> if it succeeds.

</P>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_thread_id" HREF="manual_toc.html#mysql_thread_id">20.2.3.232  <CODE>mysql_thread_id()</CODE></A></H4>

<P>
<A NAME="IDX2094"></A>

</P>
<P>
<CODE>unsigned long mysql_thread_id(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.233  Description</H4>

<P>
Returns the thread ID of the current connection.  This value can be used as
an argument to <CODE>mysql_kill()</CODE> to kill the thread.

</P>
<P>
If the connection is lost and you reconnect with <CODE>mysql_ping()</CODE>, the
thread ID will change.  This means you should not get the thread ID and store
it for later. You should get it when you need it.

</P>

<H4>20.2.3.234  Return Values</H4>

<P>
The thread ID of the current connection.

</P>

<H4>20.2.3.235  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_use_result" HREF="manual_toc.html#mysql_use_result">20.2.3.236  <CODE>mysql_use_result()</CODE></A></H4>

<P>
<A NAME="IDX2095"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_use_result(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.237  Description</H4>

<P>
You must call <CODE>mysql_store_result()</CODE> or <CODE>mysql_use_result()</CODE> for
every query that successfully retrieves data (<CODE>SELECT</CODE>, <CODE>SHOW</CODE>,
<CODE>DESCRIBE</CODE>, <CODE>EXPLAIN</CODE>).

</P>
<P>
<CODE>mysql_use_result()</CODE> initiates a result set retrieval but does not
actually read the result set into the client like <CODE>mysql_store_result()</CODE>
does.  Instead, each row must be retrieved individually by making calls to
<CODE>mysql_fetch_row()</CODE>.  This reads the result of a query directly from the
server without storing it in a temporary table or local buffer, which is
somewhat faster and uses much less memory than <CODE>mysql_store_result()</CODE>.
The client will allocate memory only for the current row and a communication
buffer that may grow up to <CODE>max_allowed_packet</CODE> bytes.

</P>
<P>
On the other hand, you shouldn't use <CODE>mysql_use_result()</CODE> if you are
doing a lot of processing for each row on the client side, or if the output
is sent to a screen on which the user may type a <CODE>^S</CODE> (stop scroll).
This will tie up the server and prevent other threads from updating any
tables from which the data is being fetched.

</P>
<P>
When using <CODE>mysql_use_result()</CODE>, you must execute
<CODE>mysql_fetch_row()</CODE> until a <CODE>NULL</CODE> value is returned, otherwise, the
unfetched rows will be returned as part of the result set for your next
query. The C API will give the error <CODE>Commands out of sync; you can't
run this command now</CODE> if you forget to do this!

</P>
<P>
You may not use <CODE>mysql_data_seek()</CODE>, <CODE>mysql_row_seek()</CODE>,
<CODE>mysql_row_tell()</CODE>, <CODE>mysql_num_rows()</CODE>, or
<CODE>mysql_affected_rows()</CODE> with a result returned from
<CODE>mysql_use_result()</CODE>, nor may you issue other queries until the
<CODE>mysql_use_result()</CODE> has finished.  (However, after you have fetched all
the rows, <CODE>mysql_num_rows()</CODE> will accurately return the number of rows
fetched.)

</P>
<P>
You must call <CODE>mysql_free_result()</CODE> once you are done with the result
set.

</P>

<H4>20.2.3.238  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result structure. <CODE>NULL</CODE> if an error occurred.

</P>

<H4>20.2.3.239  Errors</H4>

<P>
<CODE>mysql_use_result()</CODE> resets <CODE>mysql_error</CODE> and
<CODE>mysql_errno</CODE> if it succeeds.

</P>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_warning_count" HREF="manual_toc.html#mysql_warning_count">20.2.3.240  <CODE>mysql_warning_count()</CODE></A></H4>

<P>
<A NAME="IDX2096"></A>

</P>
<P>
<CODE>unsigned int mysql_warning_count(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.241  Description</H4>

<P>
Returns the number of warnings generated during execution of the previous
SQL statement.
Available from MySQL 4.1.

</P>

<H4>20.2.3.242  Return Values</H4>

<P>
The warning count.

</P>

<H4>20.2.3.243  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_commit" HREF="manual_toc.html#mysql_commit">20.2.3.244  <CODE>mysql_commit()</CODE></A></H4>

<P>
<A NAME="IDX2097"></A>

</P>
<P>
<CODE>my_bool mysql_commit(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.245  Description</H4>

<P>
Commits the current transaction.
Available from MySQL 4.1.

</P>

<H4>20.2.3.246  Return Values</H4>

<P>
Zero if successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.247  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_rollback" HREF="manual_toc.html#mysql_rollback">20.2.3.248  <CODE>mysql_rollback()</CODE></A></H4>

<P>
<A NAME="IDX2098"></A>

</P>
<P>
<CODE>my_bool mysql_rollback(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.249  Description</H4>

<P>
Rolls back the current transaction.
Available from MySQL 4.1.

</P>

<H4>20.2.3.250  Return Values</H4>

<P>
Zero if successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.251  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_autocommit" HREF="manual_toc.html#mysql_autocommit">20.2.3.252  <CODE>mysql_autocommit()</CODE></A></H4>

<P>
<A NAME="IDX2099"></A>

</P>
<P>
<CODE>my_bool mysql_autocommit(MYSQL *mysql, my_bool mode)</CODE>

</P>

<H4>20.2.3.253  Description</H4>

<P>
Sets autocommit mode on if <CODE>mode</CODE> is 1, off if <CODE>mode</CODE> is 0.
Available from MySQL 4.1.

</P>

<H4>20.2.3.254  Return Values</H4>

<P>
Zero if successful. Non-zero if an error occurred.

</P>

<H4>20.2.3.255  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_more_results" HREF="manual_toc.html#mysql_more_results">20.2.3.256  <CODE>mysql_more_results()</CODE></A></H4>

<P>
<A NAME="IDX2100"></A>

</P>
<P>
<CODE>my_bool mysql_more_results(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.257  Description</H4>

<P>
Returns true if more results exist from the currently executed query,
and the application must call <CODE>mysql_next_result()</CODE> to fetch the
results.
Available from MySQL 4.1.

</P>

<H4>20.2.3.258  Return Values</H4>

<P>
<CODE>TRUE</CODE> (1) if more results exist. <CODE>FALSE</CODE> (0) if no more results
exist.

</P>
<P>
Note that in most cases one instead call <CODE>mysql_next_result()</CODE> to
test whether more results exist and initiate the next result set if it existed.

</P>
<P>
See section <A HREF="manual.html#C_API_multiple_queries">20.2.8  C API Handling of Multiple Query Execution</A>.
See section <A HREF="manual.html#mysql_next_result">20.2.3.260  <CODE>mysql_next_result()</CODE></A>.

</P>

<H4>20.2.3.259  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_next_result" HREF="manual_toc.html#mysql_next_result">20.2.3.260  <CODE>mysql_next_result()</CODE></A></H4>

<P>
<A NAME="IDX2101"></A>

</P>
<P>
<CODE>int mysql_next_result(MYSQL *mysql)</CODE>

</P>

<H4>20.2.3.261  Description</H4>

<P>
If more query results exist, <CODE>mysql_next_result()</CODE> reads the
next query results and returns the status back to application.
Available from MySQL 4.1.

</P>
<P>
Note that you must call <CODE>mysql_free_result()</CODE> for the preceding
query if it returned a result set.

</P>
<P>
After calling <CODE>mysql_next_result()</CODE> the state of the connection
is as if you had called <CODE>mysql_real_query()</CODE> for the next query.
This means that you can now call <CODE>mysql_store_result()</CODE>,
<CODE>mysql_warning_count()</CODE>, <CODE>mysql_affected_rows()</CODE> ... on the
connection.

</P>
<P>
If <CODE>mysql_next_result()</CODE> returns an error, no other statements will
be executed and there is no more results to fetch.

</P>

<P>
See section <A HREF="manual.html#C_API_multiple_queries">20.2.8  C API Handling of Multiple Query Execution</A>.

</P>

<H4>20.2.3.262  Return Values</H4>

<P>
0 if successful and there was more results
-1   if no more results
&#62; 0  if an error occurred.

</P>

<H4>20.2.3.263  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order. For example if you didn't call
<CODE>mysql_use_result()</CODE> for a previous result set.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H3><A NAME="C_API_Prepared_statements" HREF="manual_toc.html#C_API_Prepared_statements">20.2.4  C API Prepared Statements</A></H3>

<P>
As of MySQL 4.1, the client/server protocol provides for the use of
prepared statements. This capability uses the
<CODE>MYSQL_STMT</CODE> statement handler data structure.
Prepared execution is an efficient way to execute a statement more than
once. The statement is first parsed to prepare it for execution. Then
it is executed one or more times at a later time, using the statement
handle returned by the prepare function.

</P>
<P>
Prepared execution is faster than direct execution for statements
executed more than once, primarly because the query is parsed only
once. In the case of direct execution, the query is parsed every
time it is executed. Prepared execution also can provide a reduction of network
traffic because for each execution of the prepared statement,
it is necessary only to send the data for the parameters.

</P>
<P>
Another advantage of prepared statements is that it uses a binary protocol
that makes data transfer between client and server more efficient.
Prepared statements also can support input and output binding for
multiple query execution.

</P>



<H3><A NAME="C_API_Prepared_statement_datatypes" HREF="manual_toc.html#C_API_Prepared_statement_datatypes">20.2.5  C API Prepared Statement Data types</A></H3>

<P>
<STRONG>Note:</STRONG> The API for prepared statements is still subject to revision.
This information is provided for early adopters, but please be aware that
the API may change.
Some incompatible changes were made in MySQL 4.1.2.
See section <A HREF="manual.html#C_API_Prepared_statement_functions">20.2.7  C API Prepared Statement Function Descriptions</A> for details.

</P>
<P>
Prepared statements mainly use the <CODE>MYSQL_STMT</CODE> and
<CODE>MYSQL_BIND</CODE> data structures. A third structure, <CODE>MYSQL_TIME</CODE>,
is used to transfer temporal data.

</P>
<DL COMPACT>

<DT><CODE>MYSQL_STMT</CODE>
<DD>
<A NAME="IDX2102"></A>
 
This structure represents a prepared statement.
A statement is created by calling <CODE>mysql_stmt_init()</CODE>,
which returns a statement handle, that is, a pointer to a
<CODE>MYSQL_STMT</CODE>.
The handle is used for all subsequent statement-related functions. 

The <CODE>MYSQL_STMT</CODE> structure has no members that are for application
use.

Multiple statement handles can be associated with a single connection.
The limit on the number of handles depends on the available system resources.

<A NAME="IDX2103"></A>
<DT><CODE>MYSQL_BIND</CODE>
<DD>
This structure is used both for query input (data values sent to the server)
and output (result values returned from the server). For input, it is used with
<CODE>mysql_stmt_bind_param()</CODE> to bind parameter data values to
buffers for use by <CODE>mysql_stmt_execute()</CODE>. For output, it is
used with <CODE>mysql_stmt_bind_result()</CODE> to bind result set
buffers for use in fetching rows with <CODE>mysql_stmt_fetch()</CODE>.

The <CODE>MYSQL_BIND</CODE> structure contains the following members for
use by application programs.
Each is used both for input and for output, although sometimes for different
purposes depending on the direction of data transfer.

<DL COMPACT>

<DT><CODE>enum enum_field_types buffer_type</CODE>
<DD>
The type of the buffer. The allowable <CODE>buffer_type</CODE> values are listed
later in this section. For input, <CODE>buffer_type</CODE> indicates what type of
value you are binding to a query parameter. For output, it indicates what type
of value you expect to receive in a result buffer.

<DT><CODE>void *buffer</CODE>
<DD>
For input, this is a pointer to the buffer in which a query parameter's data
value is stored. For output, it is
a pointer to the buffer in which to return a result set column value.
For numeric column types, <CODE>buffer</CODE> should point to a variable of the proper
C type.
(If you are associating the variable with a column that has the
<CODE>UNSIGNED</CODE> attribute, the variable should be an <CODE>unsigned</CODE> C type.)
For date and time column types, <CODE>buffer</CODE> should point to a
<CODE>MYSQL_TIME</CODE> structure.  For character and binary string column types,
<CODE>buffer</CODE> should point to a character buffer.

<DT><CODE>unsigned long buffer_length</CODE>
<DD>
The actual size of <CODE>*buffer</CODE> in bytes. This indicates the maximum amount
of data that can be stored in the buffer. For character and binary C data,
the <CODE>buffer_length</CODE> value specifies the length of <CODE>*buffer</CODE>
when used with <CODE>mysql_stmt_bind_param()</CODE>,
or the maximum number of data bytes that can be fetched into the buffer
when used with <CODE>mysql_stmt_bind_result()</CODE>.

<DT><CODE>unsigned long *length</CODE>
<DD>
A pointer to an <CODE>unsigned long</CODE> variable that indicates the actual number
of bytes of data stored in <CODE>*buffer</CODE>.
<CODE>length</CODE> is used for character or binary C data.
For input parameter data binding, <CODE>length</CODE>
points to an <CODE>unsigned long</CODE> variable that indicates the
length of the parameter value stored in <CODE>*buffer</CODE>; this is used by
<CODE>mysql_stmt_execute()</CODE>.
If <CODE>length</CODE> is a null pointer, the protocol assumes
that all character and binary data are null-terminated.
For output value binding, <CODE>mysql_stmt_fetch()</CODE> places
the length of the column value that is returned
into the variable that <CODE>length</CODE> points to.

<CODE>length</CODE>
is ignored for numeric and temporal data types because the length
of the data value is determined by the <CODE>buffer_type</CODE> value.

<DT><CODE>my_bool *is_null</CODE>
<DD>
This member points to a <CODE>my_bool</CODE> variable that is true if a value is
<CODE>NULL</CODE>, false if it is not <CODE>NULL</CODE>. For input, set <CODE>*is_null</CODE>
to true to
indicate that you are passing a <CODE>NULL</CODE> value as a query parameter. For
output, this value will be set to true after you fetch a row if the result
value returned from the query is <CODE>NULL</CODE>.
</DL>

<A NAME="IDX2104"></A>
<DT><CODE>MYSQL_TIME</CODE>
<DD>
This structure is used to send and receive <CODE>DATE</CODE>, <CODE>TIME</CODE>,
<CODE>DATETIME</CODE>, and <CODE>TIMESTAMP</CODE> data directly to and from the server.
This is done by setting the <CODE>buffer_type</CODE> member of a <CODE>MYSQL_BIND</CODE>
structure to one of the temporal types, and setting the <CODE>buffer</CODE> member
to point to a <CODE>MYSQL_TIME</CODE> structure.

The <CODE>MYSQL_TIME</CODE> structure contains the following members:

<DL COMPACT>

<DT><CODE>unsigned int year</CODE>
<DD>
The year.

<DT><CODE>unsigned int month</CODE>
<DD>
The month of the year.

<DT><CODE>unsigned int day</CODE>
<DD>
The day of the month.

<DT><CODE>unsigned int hour</CODE>
<DD>
The hour of the day.

<DT><CODE>unsigned int minute</CODE>
<DD>
The minute of the hour.

<DT><CODE>unsigned int second</CODE>
<DD>
The second of the minute.

<DT><CODE>my_bool neg</CODE>
<DD>
A boolean flag to indicate whether the time is negative.

<DT><CODE>unsigned long second_part</CODE>
<DD>
The fractional part of the second.
This member currently is unused.

</DL>

Only those parts of a <CODE>MYSQL_TIME</CODE> structure that apply to a given
type of temporal value are used:
The <CODE>year</CODE>, <CODE>month</CODE>, and <CODE>day</CODE> elements are used for
<CODE>DATE</CODE>, <CODE>DATETIME</CODE>, and <CODE>TIMESTAMP</CODE> values.
The <CODE>hour</CODE>, <CODE>minute</CODE>, and <CODE>second</CODE> elements are used for
<CODE>TIME</CODE>, <CODE>DATETIME</CODE>, and <CODE>TIMESTAMP</CODE> values.
See section <A HREF="manual.html#C_API_date_handling">20.2.9  C API Handling of Date and Time Values</A>.

</DL>

<P>
The following table shows the allowable values that may be specified in the
<CODE>buffer_type</CODE> member of <CODE>MYSQL_BIND</CODE> structures.
The table also shows those SQL types that correspond most closely to each
<CODE>buffer_type</CODE> value, and, for numeric and temporal types, the
corresponding C type.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>buffer_type</CODE> <STRONG>Value</STRONG> </TD><TD> <STRONG>SQL Type</STRONG> </TD><TD> <STRONG>C Type</STRONG>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TINY</CODE> </TD><TD> <CODE>TINYINT</CODE> </TD><TD> <CODE>char</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_SHORT</CODE> </TD><TD> <CODE>SMALLINT</CODE> </TD><TD> <CODE>short int</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONG</CODE> </TD><TD> <CODE>INT</CODE> </TD><TD> <CODE>long int</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONGLONG</CODE> </TD><TD> <CODE>BIGINT</CODE> </TD><TD> <CODE>long long int</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_FLOAT</CODE> </TD><TD> <CODE>FLOAT</CODE> </TD><TD> <CODE>float</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DOUBLE</CODE> </TD><TD> <CODE>DOUBLE</CODE> </TD><TD> <CODE>double</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TIME</CODE> </TD><TD> <CODE>TIME</CODE> </TD><TD> <CODE>MYSQL_TIME</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DATE</CODE> </TD><TD> <CODE>DATE</CODE> </TD><TD> <CODE>MYSQL_TIME</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DATETIME</CODE> </TD><TD> <CODE>DATETIME</CODE> </TD><TD> <CODE>MYSQL_TIME</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TIMESTAMP</CODE> </TD><TD> <CODE>TIMESTAMP</CODE> </TD><TD> <CODE>MYSQL_TIME</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_STRING</CODE> </TD><TD> <CODE>CHAR</CODE> </TD><TD>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_VAR_STRING</CODE> </TD><TD> <CODE>VARCHAR</CODE> </TD><TD>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TINY_BLOB</CODE> </TD><TD> <CODE>TINYBLOB/TINYTEXT</CODE> </TD><TD>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_BLOB</CODE> </TD><TD> <CODE>BLOB/TEXT</CODE> </TD><TD>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_MEDIUM_BLOB</CODE> </TD><TD> <CODE>MEDIUMBLOB/MEDIUMTEXT</CODE> </TD><TD>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONG_BLOB</CODE> </TD><TD> <CODE>LONGBLOB/LONGTEXT</CODE> </TD><TD>
</TD></TR>
</TABLE>

<P>
Implicit type conversion may be performed in both directions.

</P>



<H3><A NAME="C_API_Prepared_statement_function_overview" HREF="manual_toc.html#C_API_Prepared_statement_function_overview">20.2.6  C API Prepared Statement Function Overview</A></H3>

<P>
<A NAME="IDX2105"></A>
<A NAME="IDX2106"></A>

</P>
<P>
<STRONG>Note:</STRONG> The API for prepared statements is still subject to revision.
This information is provided for early adopters, but please be aware that
the API may change.
Some incompatible changes were made in MySQL 4.1.2.
See section <A HREF="manual.html#C_API_Prepared_statement_functions">20.2.7  C API Prepared Statement Function Descriptions</A> for details.

</P>

<P>
The functions available for prepared statement processing are summarized here and
described in greater detail in a later section.
See section <A HREF="manual.html#C_API_Prepared_statement_functions">20.2.7  C API Prepared Statement Function Descriptions</A>.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Function</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><STRONG>mysql_stmt_init()</STRONG> </TD><TD>
Allocates memory for <CODE>MYSQL_STMT</CODE> structure and initializes it.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_bind_param()</STRONG> </TD><TD>
Associates application data buffers with the parameter markers in a prepared
SQL statement.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_bind_result()</STRONG> </TD><TD>
Associates application data buffers with columns in the result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_execute()</STRONG> </TD><TD>
Executes the prepared statement.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_fetch()</STRONG> </TD><TD>
Fetches the next row of data from the result set and returns data for all bound columns.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_fetch_column()</STRONG> </TD><TD>
Fetch data for one column of the current row of the result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_result_metadata()</STRONG> </TD><TD>
Returns prepared statement metadata in the form of a result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_param_count()</STRONG> </TD><TD>
Returns the number of parameters in a prepared SQL statement.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_param_metadata()</STRONG> </TD><TD>
Return parameter metadata in the form of a result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_prepare()</STRONG> </TD><TD>
Prepares an SQL string for execution.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_send_long_data()</STRONG> </TD><TD>
Sends long data in chunks to server.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_affected_rows()</STRONG> </TD><TD>
Returns the number of rows changes, deleted, or inserted by the last
<CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, or <CODE>INSERT</CODE> query.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_close()</STRONG> </TD><TD>
Frees memory used by prepared statement.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_data_seek()</STRONG> </TD><TD>
Seeks to an arbitrary row number in a statement result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_errno()</STRONG> </TD><TD>
Returns the error number for the last statement execution.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_error()</STRONG> </TD><TD>
Returns the error message for the last statement execution.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_free_result()</STRONG> </TD><TD>
Free the resources allocated to the statement handle.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_num_rows()</STRONG> </TD><TD>
Returns total rows from the statement buffered result set.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_reset()</STRONG> </TD><TD>
Reset the statement buffers in the server.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_row_seek()</STRONG> </TD><TD>
Seeks to a row offset in a statement result set, using value returned from
<CODE>mysql_stmt_row_tell()</CODE>.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_row_tell()</STRONG> </TD><TD>
Returns the statement row cursor position.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_sqlstate()</STRONG> </TD><TD>
Returns the SQLSTATE error code for the last statement execution.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_store_result()</STRONG> </TD><TD>
Retrieves the complete result set to the client.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_attr_set()</STRONG> </TD><TD>
Sets an attribute for a prepared statement.

</TD></TR>
<TR><TD><STRONG>mysql_stmt_attr_get()</STRONG> </TD><TD>
Get value of an attribute for a prepared statement.

</TD></TR>
</TABLE>

<P>
Call <CODE>mysql_stmt_init()</CODE> to create a statement
handle, then <CODE>mysql_stmt_prepare</CODE> to prepare it, 
<CODE>mysql_stmt_bind_param()</CODE> to supply the parameter
data, and <CODE>mysql_stmt_execute()</CODE> to execute the query. You can
repeat the <CODE>mysql_stmt_execute()</CODE> by changing parameter values in the
respective buffers supplied through <CODE>mysql_stmt_bind_param()</CODE>.

</P>
<P>
If the query is a <CODE>SELECT</CODE> statement or any other query that produces
a result set, <CODE>mysql_stmt_prepare()</CODE> will also return the result
set metadata information in the form of a <CODE>MYSQL_RES</CODE> result set 
through <CODE>mysql_stmt_result_metadata()</CODE>.

</P>
<P>
You can supply the result buffers using <CODE>mysql_stmt_bind_result()</CODE>, so
that the <CODE>mysql_stmt_fetch()</CODE> will automatically return data to these
buffers. This is row-by-row fetching.

</P>
<P>
You can also send the text or binary data in chunks to server using
<CODE>mysql_stmt_send_long_data()</CODE>.  See section <A HREF="manual.html#mysql_stmt_send_long_data">20.2.7.48  <CODE>mysql_stmt_send_long_data()</CODE></A>.

</P>
<P>
When statement execution has been completed, the statement handle must be
closed using <CODE>mysql_stmt_close()</CODE> so that all resources associated
with it can be freed.

</P>
<P>
If you obtained a <CODE>SELECT</CODE> statement's result set metadata by calling
<CODE>mysql_stmt_result_metadata()</CODE>, you should also free it using
<CODE>mysql_stmt_free_result()</CODE>.

</P>

<H4>20.2.6.1  Execution Steps</H4>

<P>
To prepare and execute a statement, an application follows these steps:

</P>

<OL>
<LI>

Create a prepared statement handle with <CODE>msyql_stmt_init()</CODE>.
Call <CODE>mysql_stmt_prepare()</CODE> and pass it a string containing the SQL
statement to prepare the statement on the server.
<LI>

If the query produces a result set, call <CODE>mysql_stmt_result_metadata()</CODE>
to obtain the result set metadata.  This metadata is itself in the form of
result set, albeit a separate one from the one that contains the rows returned
by the query. The metadata result set indicates how many columns are in the
result and contains information about each column.
<LI>

Set the values of any parameters using <CODE>mysql_stmt_bind_param()</CODE>. All
parameters must be set. Otherwise, query execution will return an error or
produce unexpected results.
<LI>

Call <CODE>mysql_stmt_execute()</CODE> to execute the statement.
<LI>

If the query produces a result set,
bind the data buffers to use for retrieving the row values by calling
<CODE>mysql_stmt_bind_result()</CODE>.
<LI>

Fetch the data into the buffers row by row by calling
<CODE>mysql_stmt_fetch()</CODE> repeatedly until no more rows are found.
<LI>

Repeat steps 3 through 6 as necessary, by changing the parameter values and
re-executing the statement.

</OL>

<P>
When <CODE>mysql_stmt_prepare()</CODE> is called, the MySQL client/server protocol
performs these actions:

</P>

<UL>
<LI>

The server parses the query and sends the okay status back to the client by
assigning a statement ID. It also sends total number of parameters,
a column count, and its meta information if it is a result set oriented
query. All syntax and semantics of the query are checked by the server
during this call.
<LI>

The client uses this statement ID for the further operations, so that the server
can identify the statement from among its pool of statements.
</UL>

<P>
When <CODE>mysql_stmt_execute()</CODE> is called, the MySQL
client/server protocol performs these actions:

</P>

<UL>
<LI>

The client uses the statement handle and sends the parameter data to the
server.
<LI>

The server identifies the statement using the ID provided by the client,
replaces the parameter markers with the newly supplied data, and executes
the query. If the query produces a result set, the server sends the data back to
the client. Otherwise, it sends an okay status and total number of rows
changed, deleted, or inserted.
</UL>

<P>
When <CODE>mysql_stmt_fetch()</CODE> is called, the MySQL client/server protocol
performs these actions:

</P>

<UL>
<LI>

The client reads the data from the packet row by row and places it into the
application data buffers by doing the necessary conversions. If the
application buffer type is same as that of the field type returned from the
server, the conversions are straightforward.
</UL>

<P>
You can get the statement error code, error message, and SQLSTATE value using
<CODE>mysql_stmt_errno()</CODE>, <CODE>mysql_stmt_error()</CODE>, and
<CODE>mysql_stmt_sqlstate()</CODE>, respectively.

</P>



<H3><A NAME="C_API_Prepared_statement_functions" HREF="manual_toc.html#C_API_Prepared_statement_functions">20.2.7  C API Prepared Statement Function Descriptions</A></H3>

<P>
To prepare and execute queries, use the functions in the following sections.

</P>
<P>
<STRONG>Note:</STRONG> The API for prepared statements is still subject to revision.
This information is provided for early adopters, but please be aware that
the API may change.

</P>
<P>
In MySQL 4.1.2, the names of several prepared statement functions were
changed:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Old Name</STRONG> </TD><TD> <STRONG>New Name</STRONG>
</TD></TR>
<TR><TD><CODE>mysql_bind_param()</CODE> </TD><TD> <CODE>mysql_stmt_bind_param()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_bind_result()</CODE> </TD><TD> <CODE>mysql_stmt_bind_result()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_prepare()</CODE> </TD><TD> <CODE>mysql_stmt_prepare()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_execute()</CODE> </TD><TD> <CODE>mysql_stmt_execute()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_fetch()</CODE> </TD><TD> <CODE>mysql_stmt_fetch()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_fetch_column()</CODE> </TD><TD> <CODE>mysql_stmt_fetch_column()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_param_count()</CODE> </TD><TD> <CODE>mysql_stmt_param_count()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_param_result()</CODE> </TD><TD> <CODE>mysql_stmt_param_metadata()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_get_metadata()</CODE> </TD><TD> <CODE>mysql_stmt_result_metadata()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_send_long_data()</CODE> </TD><TD> <CODE>mysql_stmt_send_long_data()</CODE>
</TD></TR>
</TABLE>

<P>
Now all functions that operate with a <CODE>MYSQL_STMT</CODE> structure begin with
the prefix <CODE>mysql_stmt_</CODE>.

</P>
<P>
Also in 4.1.2, the signature of the <CODE>mysql_stmt_prepare()</CODE> function was
changed to <CODE>int mysql_stmt_prepare(MYSQL_STMT *stmt, const char *query,
unsigned long length)</CODE>.  To create a <CODE>MYSQL_STMT</CODE> handle, you should
use the <CODE>mysql_stmt_init()</CODE> function.

</P>



<H4><A NAME="mysql_stmt_init" HREF="manual_toc.html#mysql_stmt_init">20.2.7.1  <CODE>mysql_stmt_init()</CODE></A></H4>

<P>
<A NAME="IDX2107"></A>

</P>
<P>
<CODE>MYSQL_STMT *mysql_stmt_init(MYSQL *mysql)</CODE>

</P>

<H4>20.2.7.2  Description</H4>

<P>
Create a MYSQL_STMT handle.

</P>

<H4>20.2.7.3  Return values</H4>

<P>
A pointer to a <CODE>MYSQL_STMT</CODE> structure in case of success.
<CODE>NULL</CODE> if out of memory.

</P>

<H4>20.2.7.4  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
</DL>



<H4><A NAME="mysql_stmt_bind_param" HREF="manual_toc.html#mysql_stmt_bind_param">20.2.7.5  <CODE>mysql_stmt_bind_param()</CODE></A></H4>

<P>
<A NAME="IDX2108"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_bind_param(MYSQL_STMT *stmt, MYSQL_BIND *bind)</CODE>

</P>

<H4>20.2.7.6  Description</H4>

<P>
<CODE>mysql_stmt_bind_param()</CODE> is used to bind data for the parameter markers
in the SQL statement that was passed to <CODE>mysql_stmt_prepare()</CODE>. It uses
<CODE>MYSQL_BIND</CODE> structures to supply the data. <CODE>bind</CODE> is the address
of an array of <CODE>MYSQL_BIND</CODE> structures.
The client library expects the array to contain an element for each
<SAMP>`?'</SAMP> parameter marker that is present in the query.

</P>
<P>
Suppose that you prepare the following statement:

</P>

<PRE>
INSERT INTO mytbl VALUES(?,?,?)
</PRE>

<P>
When you bind the parameters, the array of <CODE>MYSQL_BIND</CODE> structures must
contain three elements, and can be declared like this:

</P>

<PRE>
MYSQL_BIND bind[3];
</PRE>

<P>
The members of each <CODE>MYSQL_BIND</CODE> element that should be set are described
in section <A HREF="manual.html#C_API_Prepared_statement_datatypes">20.2.5  C API Prepared Statement Data types</A>.

</P>

<H4>20.2.7.7  Return Values</H4>

<P>
Zero if the bind was successful. Non-zero if an error occurred.

</P>

<H4>20.2.7.8  Errors</H4>
<DL COMPACT>

<DT><CODE>CR_INVALID_BUFFER_USE</CODE>
<DD>
Indicates if the bind is to supply the long data in chunks and if the
buffer type is non string or binary.
<DT><CODE>CR_UNSUPPORTED_PARAM_TYPE</CODE>
<DD>
The conversion is not supported. Possibly the <CODE>buffer_type</CODE> value is
illegal or is not one of the supported types.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.7.9  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_bind_param()</CODE>, refer to the Example from
section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_bind_result" HREF="manual_toc.html#mysql_stmt_bind_result">20.2.7.10  <CODE>mysql_stmt_bind_result()</CODE></A></H4>

<P>
<A NAME="IDX2109"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_bind_result(MYSQL_STMT *stmt, MYSQL_BIND *bind)</CODE>

</P>

<H4>20.2.7.11  Description</H4>

<P>
<CODE>mysql_stmt_bind_result()</CODE> is used to associate (bind) columns in the
result set to data buffers and length buffers. When
<CODE>mysql_stmt_fetch()</CODE> is
called to fetch data, the MySQL client/server protocol places the data for the
bound columns into the specified buffers.

</P>
<P>
Note that all columns must be bound to buffers prior to calling
<CODE>mysql_stmt_fetch()</CODE>.
<CODE>bind</CODE> is the address of an array of <CODE>MYSQL_BIND</CODE> structures.
The client library expects the array to contain
an element for each column of the result set.
Otherwise, <CODE>mysql_stmt_fetch()</CODE> simply ignores
the data fetch. Also, the buffers should be large enough to hold the
data values, because the protocol doesn't return data values in chunks.

</P>
<P>
A column can be bound or rebound at any time, even after a result set has been
partially retrieved.  The new binding takes effect the next time
<CODE>mysql_stmt_fetch()</CODE> is called. Suppose that an application binds
the columns in a result set and calls <CODE>mysql_stmt_fetch()</CODE>.
The client/server
protocol returns data in the bound buffers. Then suppose the application
binds the columns to a different set of buffers. The protocol does
not place data into the newly bound
buffers until the next call to <CODE>mysql_stmt_fetch()</CODE> occurs.

</P>
<P>
To bind a column, an application calls <CODE>mysql_stmt_bind_result()</CODE> and
passes the type, address, and the address of the length buffer.
The members of each <CODE>MYSQL_BIND</CODE> element that should be set are described
in section <A HREF="manual.html#C_API_Prepared_statement_datatypes">20.2.5  C API Prepared Statement Data types</A>.

</P>

<H4>20.2.7.12  Return Values</H4>

<P>
Zero if the bind was successful. Non-zero if an error occurred.

</P>

<H4>20.2.7.13  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_UNSUPPORTED_PARAM_TYPE</CODE>
<DD>
The conversion is not supported. Possibly the <CODE>buffer_type</CODE> value is
illegal or is not one of the supported types.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.7.14  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_bind_result()</CODE>, refer to the Example from
section <A HREF="manual.html#mysql_stmt_fetch">20.2.7.20  <CODE>mysql_stmt_fetch()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_execute" HREF="manual_toc.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A></H4>

<P>
<A NAME="IDX2110"></A>

</P>
<P>
<CODE>int mysql_stmt_execute(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.16  Description</H4>

<P>
<CODE>mysql_stmt_execute()</CODE> executes the prepared query associated with the
statement handle. The currently bound parameter marker values are sent
to server during this call, and the server replaces the markers with this newly
supplied data.

</P>

<P>
If the statement is an <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, or <CODE>INSERT</CODE>,
the total number of
changed, deleted, or inserted rows can be found by calling
<CODE>mysql_stmt_affected_rows()</CODE>. If this is a result set query such as
<CODE>SELECT</CODE>, you
must call <CODE>mysql_stmt_fetch()</CODE> to fetch the data prior to calling any
other functions that result in query processing. For more information on
how to fetch the results, refer to
section <A HREF="manual.html#mysql_stmt_fetch">20.2.7.20  <CODE>mysql_stmt_fetch()</CODE></A>.
 


<P><STRONG>20.2.7.17  Return Values</STRONG></P>

</P>
<P>
Zero if execution was successful. Non-zero if an error occurred.
The error code and message can be obtained by calling <CODE>mysql_stmt_errno()</CODE>
and <CODE>mysql_stmt_error()</CODE>.

</P>

<H4>20.2.7.18  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order. 
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory. 
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away. 
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query. 
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred. 
</DL>


<H4>20.2.7.19  Example</H4>

<P>
The following example demonstrates how to create and populate a table using
<CODE>mysql_stmt_prepare()</CODE>,
<CODE>mysql_stmt_param_count()</CODE>, <CODE>mysql_stmt_bind_param()</CODE>,
<CODE>mysql_stmt_execute()</CODE>,
and <CODE>mysql_stmt_affected_rows()</CODE>. The <CODE>mysql</CODE> variable is assumed
to be a valid connection handle.

</P>

<PRE>
#define STRING_SIZE 50

#define DROP_SAMPLE_TABLE "DROP TABLE IF EXISTS test_table"
#define CREATE_SAMPLE_TABLE "CREATE TABLE test_table(col1 INT,\
                                                 col2 VARCHAR(40),\
                                                 col3 SMALLINT,\
                                                 col4 TIMESTAMP)"
#define INSERT_SAMPLE "INSERT INTO test_table(col1,col2,col3) VALUES(?,?,?)"

MYSQL_STMT    *stmt;
MYSQL_BIND    bind[3];
my_ulonglong  affected_rows;
int           param_count;
short         small_data;
int           int_data;
char          str_data[STRING_SIZE];
unsigned long str_length;
my_bool       is_null;

if (mysql_query(mysql, DROP_SAMPLE_TABLE))
{
  fprintf(stderr, " DROP TABLE failed\n");
  fprintf(stderr, " %s\n", mysql_error(mysql));
  exit(0);
}

if (mysql_query(mysql, CREATE_SAMPLE_TABLE))
{
  fprintf(stderr, " CREATE TABLE failed\n");
  fprintf(stderr, " %s\n", mysql_error(mysql));
  exit(0);
}

/* Prepare an INSERT query with 3 parameters */
/* (the TIMESTAMP column is not named; it will */
/* be set to the current date and time) */
stmt = mysql_stmt_init(mysql);
if (!stmt)
{
  fprintf(stderr, " mysql_stmt_init(), out of memory\n");
  exit(0);
}
if (mysql_stmt_prepare(mysql, INSERT_SAMPLE, strlen(INSERT_SAMPLE)))
{
  fprintf(stderr, " mysql_stmt_prepare(), INSERT failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
fprintf(stdout, " prepare, INSERT successful\n");

/* Get the parameter count from the statement */
param_count= mysql_stmt_param_count(stmt);
fprintf(stdout, " total parameters in INSERT: %d\n", param_count);

if (param_count != 3) /* validate parameter count */
{
  fprintf(stderr, " invalid parameter count returned by MySQL\n");
  exit(0);
}

/* Bind the data for all 3 parameters */

/* INTEGER PARAM */
/* This is a number type, so there is no need to specify buffer_length */
bind[0].buffer_type= MYSQL_TYPE_LONG;
bind[0].buffer= (char *)&#38;int_data;
bind[0].is_null= 0;
bind[0].length= 0;

/* STRING PARAM */
bind[1].buffer_type= MYSQL_TYPE_VAR_STRING;
bind[1].buffer= (char *)str_data;
bind[1].buffer_length= STRING_SIZE;
bind[1].is_null= 0;
bind[1].length= &#38;str_length;
 
/* SMALLINT PARAM */
bind[2].buffer_type= MYSQL_TYPE_SHORT;
bind[2].buffer= (char *)&#38;small_data;       
bind[2].is_null= &#38;is_null;
bind[2].length= 0;

/* Bind the buffers */
if (mysql_stmt_bind_param(stmt, bind))
{
  fprintf(stderr, " mysql_stmt_bind_param() failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}

/* Specify the data values for the first row */
int_data= 10;             /* integer */
strncpy(str_data, "MySQL", STRING_SIZE); /* string  */
str_length= strlen(str_data);

/* INSERT SMALLINT data as NULL */
is_null= 1;

/* Execute the INSERT statement - 1*/
if (mysql_stmt_execute(stmt))
{
  fprintf(stderr, " mysql_stmt_execute(), 1 failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
  
/* Get the total number of affected rows */   
affected_rows= mysql_stmt_affected_rows(stmt);
fprintf(stdout, " total affected rows(insert 1): %ld\n", affected_rows);

if (affected_rows != 1) /* validate affected rows */
{
  fprintf(stderr, " invalid affected rows by MySQL\n");
  exit(0);
}

/* Specify data values for second row, then re-execute the statement */
int_data= 1000;             
strncpy(str_data, "The most popular open source database", STRING_SIZE); 
str_length= strlen(str_data);
small_data= 1000;         /* smallint */
is_null= 0;               /* reset */

/* Execute the INSERT statement - 2*/
if (mysql_stmt_execute(stmt))
{
  fprintf(stderr, " mysql_stmt_execute, 2 failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
  
/* Get the total rows affected */   
affected_rows= mysql_stmt_affected_rows(stmt);
fprintf(stdout, " total affected rows(insert 2): %ld\n", affected_rows);

if (affected_rows != 1) /* validate affected rows */
{
  fprintf(stderr, " invalid affected rows by MySQL\n");
  exit(0);
}

/* Close the statement */
if (mysql_stmt_close(stmt))
{
  fprintf(stderr, " failed while closing the statement\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
</PRE>

<P>
<STRONG>Note:</STRONG> For complete examples on the use of prepared
statement functions, refer to the file <TT>`tests/client_test.c'</TT>.
This file can be obtained from a MySQL source distribution or from the
BitKeeper source repository.

</P>


<H4><A NAME="mysql_stmt_fetch" HREF="manual_toc.html#mysql_stmt_fetch">20.2.7.20  <CODE>mysql_stmt_fetch()</CODE></A></H4>

<P>
<A NAME="IDX2111"></A>

</P>
<P>
<CODE>int mysql_stmt_fetch(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.21  Description</H4>

<P>
<CODE>mysql_stmt_fetch()</CODE> returns the next row in the result set. It can
be called only while the result set exists, that is, after a call to
<CODE>mysql_stmt_execute()</CODE> that creates a result set or after
<CODE>mysql_stmt_store_result()</CODE>, which is called after
<CODE>mysql_stmt_execute()</CODE> to buffer the entire result set.

</P>
<P>
<CODE>mysql_stmt_fetch()</CODE> returns row data using the buffers bound by
<CODE>mysql_stmt_bind_result()</CODE>. It returns
the data in those buffers for all the columns in the current row
set and the lengths are returned to the <CODE>length</CODE> pointer.

</P>
<P>
Note that all columns must be bound by the application before calling
<CODE>mysql_stmt_fetch()</CODE>.

</P>
<P>
If a fetched data value is a <CODE>NULL</CODE> value, the <CODE>*is_null</CODE>
value of the corresponding <CODE>MYSQL_BIND</CODE> structure contains TRUE
(1). Otherwise, the data and its length are returned in the <CODE>*buffer</CODE>
and <CODE>*length</CODE> elements based on the buffer type specified by the
application. Each numeric and temporal type has a fixed length,
as listed in the following table.
The length of the string types depends on the length of the actual data value,
as indicated by <CODE>data_length</CODE>.

</P>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Type</STRONG> </TD><TD> <STRONG>Length</STRONG>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TINY</CODE> </TD><TD> 1
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_SHORT</CODE> </TD><TD> 2
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONG</CODE> </TD><TD> 4
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONGLONG</CODE> </TD><TD> 8
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_FLOAT</CODE> </TD><TD> 4
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DOUBLE</CODE> </TD><TD> 8
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TIME</CODE> </TD><TD> <CODE>sizeof(MYSQL_TIME)</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DATE</CODE> </TD><TD> <CODE>sizeof(MYSQL_TIME)</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_DATETIME</CODE> </TD><TD> <CODE>sizeof(MYSQL_TIME)</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TIMESTAMP</CODE> </TD><TD> <CODE>sizeof(MYSQL_TIME)</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_STRING</CODE> </TD><TD> <CODE>data length</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_VAR_STRING</CODE> </TD><TD> <CODE>data_length</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_TINY_BLOB</CODE> </TD><TD> <CODE>data_length</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_BLOB</CODE> </TD><TD> <CODE>data_length</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_MEDIUM_BLOB</CODE> </TD><TD> <CODE>data_length</CODE>
</TD></TR>
<TR><TD><CODE>MYSQL_TYPE_LONG_BLOB</CODE> </TD><TD> <CODE>data_length</CODE>
</TD></TR>
</TABLE>


<H4>20.2.7.22  Return Values</H4>

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Return Value</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>0 </TD><TD> Successful, the data has been
fetched to application data buffers.
</TD></TR>
<TR><TD>1 </TD><TD> Error occurred. Error code and
message can be obtained by calling <CODE>mysql_stmt_errno()</CODE> and
<CODE>mysql_stmt_error()</CODE>.
</TD></TR>
<TR><TD><CODE>MYSQL_NO_DATA</CODE> </TD><TD> No more rows/data exists
</TD></TR>
</TABLE>


<H4>20.2.7.23  Errors</H4>
<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order. 
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory. 
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away. 
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query. 
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred. 
<DT><CODE>CR_UNSUPPORTED_PARAM_TYPE</CODE>
<DD>
The buffer type is
<CODE>MYSQL_TYPE_DATE</CODE>,
<CODE>MYSQL_TYPE_TIME</CODE>,
<CODE>MYSQL_TYPE_DATETIME</CODE>,
or
<CODE>MYSQL_TYPE_TIMESTAMP</CODE>,
but the data type is not <CODE>DATE</CODE>, <CODE>TIME</CODE>, <CODE>DATETIME</CODE>, or
<CODE>TIMESTAMP</CODE>.
<DT><CODE></CODE>
<DD>
All other unsupported conversion errors are returned from
<CODE>mysql_stmt_bind_result()</CODE>.
</DL>


<H4>20.2.7.24  Example</H4>

<P>
The following example demonstrates how to fetch data from a table using
 <CODE>mysql_stmt_result_metadata()</CODE>,
<CODE>mysql_stmt_bind_result()</CODE>, and <CODE>mysql_stmt_fetch()</CODE>.
(This example expects to retrieve the two rows inserted by the example shown
in section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.)
The <CODE>mysql</CODE> variable is assumed to be a valid connection handle.

</P>

<PRE>
#define STRING_SIZE 50

#define SELECT_SAMPLE "SELECT col1, col2, col3, col4 FROM test_table"

MYSQL_STMT    *stmt;
MYSQL_BIND    bind[4];
MYSQL_RES     *prepare_meta_result;
MYSQL_TIME    ts;
unsigned long length[4];
int           param_count, column_count, row_count;
short         small_data;
int           int_data;
char          str_data[STRING_SIZE];
my_bool       is_null[4];

/* Prepare a SELECT query to fetch data from test_table */
stmt = mysql_stmt_init(mysql);
if (!stmt)
{
  fprintf(stderr, " mysql_stmt_init(), out of memory\n");
  exit(0);
}
if (mysql_stmt_prepare(stmt, SELECT_SAMPLE, strlen(SELECT_SAMPLE)))
{
  fprintf(stderr, " mysql_stmt_prepare(), SELECT failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
fprintf(stdout, " prepare, SELECT successful\n");

/* Get the parameter count from the statement */
param_count= mysql_stmt_param_count(stmt);
fprintf(stdout, " total parameters in SELECT: %d\n", param_count);

if (param_count != 0) /* validate parameter count */
{
  fprintf(stderr, " invalid parameter count returned by MySQL\n");
  exit(0);
}

/* Fetch result set meta information */
prepare_meta_result = mysql_stmt_result_metadata(stmt);
if (!prepare_meta_result)
{
  fprintf(stderr,
         " mysql_stmt_result_metadata(), returned no meta information\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}

/* Get total columns in the query */
column_count= mysql_num_fields(prepare_meta_result);
fprintf(stdout, " total columns in SELECT statement: %d\n", column_count);

if (column_count != 4) /* validate column count */
{
  fprintf(stderr, " invalid column count returned by MySQL\n");
  exit(0);
}

/* Execute the SELECT query */
if (mysql_stmt_execute(stmt))
{
  fprintf(stderr, " mysql_stmt_execute(), failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}

/* Bind the result buffers for all 4 columns before fetching them */

/* INTEGER COLUMN */
bind[0].buffer_type= MYSQL_TYPE_LONG;
bind[0].buffer= (char *)&#38;int_data;
bind[0].is_null= &#38;is_null[0];
bind[0].length= &#38;length[0];

/* STRING COLUMN */
bind[1].buffer_type= MYSQL_TYPE_VAR_STRING;
bind[1].buffer= (char *)str_data;
bind[1].buffer_length= STRING_SIZE;
bind[1].is_null= &#38;is_null[1];
bind[1].length= &#38;length[1];
 
/* SMALLINT COLUMN */
bind[2].buffer_type= MYSQL_TYPE_SHORT;
bind[2].buffer= (char *)&#38;small_data;       
bind[2].is_null= &#38;is_null[2];
bind[2].length= &#38;length[2];
 
/* TIMESTAMP COLUMN */
bind[3].buffer_type= MYSQL_TYPE_TIMESTAMP;
bind[3].buffer= (char *)&#38;ts;       
bind[3].is_null= &#38;is_null[3];
bind[3].length= &#38;length[3];

/* Bind the result buffers */
if (mysql_stmt_bind_result(stmt, bind))
{
  fprintf(stderr, " mysql_stmt_bind_result() failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}

/* Now buffer all results to client */
if (mysql_stmt_store_result(stmt))
{
  fprintf(stderr, " mysql_stmt_store_result() failed\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}

/* Fetch all rows */
row_count= 0;
fprintf(stdout, "Fetching results ...\n");
while (!mysql_stmt_fetch(stmt))
{
  row_count++;
  fprintf(stdout, "  row %d\n", row_count);

  /* column 1 */
  fprintf(stdout, "   column1 (integer)  : ");
  if (is_null[0])
    fprintf(stdout, " NULL\n");
  else
    fprintf(stdout, " %d(%ld)\n", int_data, length[0]);

  /* column 2 */
  fprintf(stdout, "   column2 (string)   : ");
  if (is_null[1])
    fprintf(stdout, " NULL\n");
  else
    fprintf(stdout, " %s(%ld)\n", str_data, length[1]);

  /* column 3 */
  fprintf(stdout, "   column3 (smallint) : ");
  if (is_null[2])
    fprintf(stdout, " NULL\n");
  else
    fprintf(stdout, " %d(%ld)\n", small_data, length[2]);

  /* column 4 */
  fprintf(stdout, "   column4 (timestamp): ");
  if (is_null[3])
    fprintf(stdout, " NULL\n");
  else
    fprintf(stdout, " %04d-%02d-%02d %02d:%02d:%02d (%ld)\n",
                                               ts.year, ts.month, ts.day,
                                               ts.hour, ts.minute, ts.second,
                                               length[3]);
  fprintf(stdout, "\n");
}

/* Validate rows fetched */
fprintf(stdout, " total rows fetched: %d\n", row_count);
if (row_count != 2)
{
  fprintf(stderr, " MySQL failed to return all rows\n");
  exit(0);
} 

/* Free the prepared result metadata */
mysql_free_result(prepare_meta_result);

/* Close the statement */
if (mysql_stmt_close(stmt))
{
  fprintf(stderr, " failed while closing the statement\n");
  fprintf(stderr, " %s\n", mysql_stmt_error(stmt));
  exit(0);
}
</PRE>



<H4><A NAME="mysql_stmt_fetch_column" HREF="manual_toc.html#mysql_stmt_fetch_column">20.2.7.25  <CODE>mysql_stmt_fetch_column()</CODE></A></H4>

<P>
<A NAME="IDX2112"></A>

</P>
<P>
<CODE>int mysql_stmt_fetch_column(MYSQL_STMT *stmt, MYSQL_BIND *bind, unsigned int column, unsigned long offset)</CODE>

</P>


<H4>20.2.7.26  Description</H4>


<H4>20.2.7.27  Return Values</H4>


<H4>20.2.7.28  Errors</H4>



<H4><A NAME="mysql_stmt_result_metadata" HREF="manual_toc.html#mysql_stmt_result_metadata">20.2.7.29  <CODE>mysql_stmt_result_metadata()</CODE></A></H4>

<P>
<A NAME="IDX2113"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_stmt_result_metadata(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.30  Description</H4>

<P>
If a statement passed to <CODE>mysql_stmt_prepare()</CODE> is one that produces a result
set,
<CODE>mysql_stmt_rseult_metadata()</CODE> returns the result set
metadata in the form of a pointer to a
<CODE>MYSQL_RES</CODE> structure that can be used to process the
meta information such as total number of fields and individual field
information. This result set pointer can be passed as an argument to
any of the field-based API functions that process result set metadata, such
as:

</P>

<UL>
<LI><CODE>mysql_num_fields()</CODE>

<LI><CODE>mysql_fetch_field()</CODE>

<LI><CODE>mysql_fetch_field_direct()</CODE>

<LI><CODE>mysql_fetch_fields()</CODE>

<LI><CODE>mysql_field_count()</CODE>

<LI><CODE>mysql_field_seek()</CODE>

<LI><CODE>mysql_field_tell()</CODE>

<LI><CODE>mysql_free_result()</CODE>

</UL>

<P>
The result set structure should be freed when you are done with it, which
you can do by passing it to <CODE>mysql_free_result()</CODE>. This is similar
to the way you free a result set obtained from a call to
<CODE>mysql_store_result()</CODE>.

</P>
<P>
The result set returned by <CODE>mysql_stmt_result_metadata()</CODE> contains only
metadata. It does not contain any row results. The rows are obtained by using
the statement handle with <CODE>mysql_stmt_fetch()</CODE>.

</P>


<H4>20.2.7.31  Return Values</H4>

<P>
A <CODE>MYSQL_RES</CODE> result structure. <CODE>NULL</CODE> if no meta information exists
for the prepared query.

</P>


<H4>20.2.7.32  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.7.33  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_result_metadata()</CODE>, refer to the
Example from section <A HREF="manual.html#mysql_stmt_fetch">20.2.7.20  <CODE>mysql_stmt_fetch()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_param_count" HREF="manual_toc.html#mysql_stmt_param_count">20.2.7.34  <CODE>mysql_stmt_param_count()</CODE></A></H4>

<P>
<A NAME="IDX2114"></A>

</P>
<P>
<CODE>unsigned long mysql_stmt_param_count(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.35  Description</H4>

<P>
Returns the number of parameter markers present in the prepared statement.

</P>

<H4>20.2.7.36  Return Values</H4>

<P>
An unsigned long integer representing the number of parameters in a
statement.

</P>

<H4>20.2.7.37  Errors</H4>

<P>
None.

</P>

<H4>20.2.7.38  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_param_count()</CODE>, refer to the Example from
section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_param_metadata" HREF="manual_toc.html#mysql_stmt_param_metadata">20.2.7.39  <CODE>mysql_stmt_param_metadata()</CODE></A></H4>

<P>
<A NAME="IDX2115"></A>

</P>
<P>
<CODE>MYSQL_RES *mysql_stmt_param_metadata(MYSQL_STMT *stmt)</CODE>

</P>
<P>
To be added.

</P>

<H4>20.2.7.40  Description</H4>


<H4>20.2.7.41  Return Values</H4>


<H4>20.2.7.42  Errors</H4>



<H4><A NAME="mysql_stmt_prepare" HREF="manual_toc.html#mysql_stmt_prepare">20.2.7.43  <CODE>mysql_stmt_prepare()</CODE></A></H4>

<P>
<A NAME="IDX2116"></A>

</P>
<P>
<CODE>int mysql_stmt_prepare(MYSQL_STMT *stmt, const char *query, unsigned
long length)</CODE>

</P>

<H4>20.2.7.44  Description</H4>

<P>
Prepares the SQL query pointed to by the null-terminated string
<CODE>query</CODE>, and returns a statement handle to be used for further operations
on the statement. The query must consist of a single SQL statement. You should
not add a terminating semicolon (<SAMP>`;'</SAMP>) or <CODE>\g</CODE> to the statement.

</P>
<P>
The application can include one or more parameter markers in the SQL
statement by embedding question mark (<SAMP>`?'</SAMP>) characters into the SQL
string at the appropriate positions.

</P>
<P>
The markers are legal only in certain places in SQL statements. For
example, they are allowed in the <CODE>VALUES()</CODE> list of an <CODE>INSERT</CODE>
statement (to specify column values for a row), or in a comparison with a
column in a <CODE>WHERE</CODE> clause to specify a comparison value.
However, they are not allowed for identifiers (such as table or column
names), in the select list that names the columns to
be returned by a <CODE>SELECT</CODE> statement), or to specify both
operands of a binary operator such as the <CODE>=</CODE> equal sign.
The latter restriction is necessary because it
would be impossible to determine the parameter type. In general,
parameters are legal only in Data Manipulation Languange (DML)
statements, and not in Data Defination Language (DDL) statements.

</P>
<P>
The parameter markers must be bound to application variables using
<CODE>mysql_stmt_bind_param()</CODE> before executing the statement.

</P>


<H4>20.2.7.45  Return Values</H4>


<H4>20.2.7.46  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>

<P>
If the prepare is not successful (that is, <CODE>mysql_stmt_prepare()</CODE> returns
<CODE>NULL</CODE>), the error message can be obtained by calling
<CODE>mysql_error()</CODE>. 

</P>


<H4>20.2.7.47  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_prepare()</CODE>, refer to the Example from
section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_send_long_data" HREF="manual_toc.html#mysql_stmt_send_long_data">20.2.7.48  <CODE>mysql_stmt_send_long_data()</CODE></A></H4>

<P>
<A NAME="IDX2117"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_send_long_data(MYSQL_STMT *stmt, unsigned int
parameter_number, const char *data, unsigned long length)</CODE>

</P>

<H4>20.2.7.49  Description</H4>

<P>
Allows an application to send parameter data to the server in pieces
(or ``chunks'').
This function can be called multiple times to send the parts of a
character or binary data value for a column, which must be one of the
<CODE>TEXT</CODE> or <CODE>BLOB</CODE> data types.

</P>
<P>
<CODE>parameter_number</CODE> indicates which parameter to associate the data with.
Parameters are numbered beginning with 0.
<CODE>data</CODE> is a pointer to a buffer containing data to be sent, and
<CODE>length</CODE> indicates the number of bytes in the buffer.

</P>
<P>
<STRONG>Note</STRONG>: The next <CODE>mysql_stmt_execute()</CODE> call will ignore the
bind buffer for all parameters that have been used with
<CODE>mysql_stmt_send_long_data()</CODE> since last
<CODE>mysql_stmt_execute()</CODE> or <CODE>mysql_stmt_reset()</CODE>.

</P>
<P>
If you want to reset/forget the sent data, you can do it with
<CODE>mysql_stmt_reset()</CODE>. See section <A HREF="manual.html#mysql_stmt_reset">20.2.7.83  <CODE>mysql_stmt_reset()</CODE></A>.

</P>

<H4>20.2.7.50  Return Values</H4>

<P>
Zero if the data is sent successfully to server. Non-zero if an error
occurred.

</P>

<H4>20.2.7.51  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.7.52  Example</H4>
<P>
The following example demonstrates how to send the data for a
<CODE>TEXT</CODE> column in chunks.  It inserts the data value
<CODE>'MySQL - The most popular open source database'</CODE>
into the <CODE>text_column</CODE> column.
The <CODE>mysql</CODE> variable is assumed to be a valid connection handle.

</P>


<PRE>
#define INSERT_QUERY "INSERT INTO test_long_data(text_column) VALUES(?)"
  
MYSQL_BIND bind[1];
long       length;

smtt = mysql_stmt_init(mysql);
if (!stmt)
{
  fprintf(stderr, " mysql_stmt_init(), out of memory\n");
  exit(0);
}
if (mysql_stmt_prepare(stmt, INSERT_QUERY, strlen(INSERT_QUERY)))
{
  fprintf(stderr, "\n mysql_stmt_prepare(), INSERT failed");
  fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
  exit(0);
}
 memset(bind, 0, sizeof(bind));
 bind[0].buffer_type= MYSQL_TYPE_STRING;
 bind[0].length= &#38;length;
 bind[0].is_null= 0;

/* Bind the buffers */
if (mysql_stmt_bind_param(stmt, bind))
{
  fprintf(stderr, "\n param bind failed");
  fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
  exit(0);
}

 /* Supply data in chunks to server */
 if (!mysql_stmt_send_long_data(stmt,0,"MySQL",5))
{
  fprintf(stderr, "\n send_long_data failed");
  fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
  exit(0);
}

 /* Supply the next piece of data */
 if (mysql_stmt_send_long_data(stmt,0," - The most popular open source database",40))
{
  fprintf(stderr, "\n send_long_data failed");
  fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
  exit(0);
}

 /* Now, execute the query */
 if (mysql_stmt_execute(stmt))
{
  fprintf(stderr, "\n mysql_stmt_execute failed");
  fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
  exit(0);
}
</PRE>



<H4><A NAME="mysql_stmt_affected_rows" HREF="manual_toc.html#mysql_stmt_affected_rows">20.2.7.53  <CODE>mysql_stmt_affected_rows()</CODE></A></H4>

<P>
<A NAME="IDX2118"></A>

</P>
<P>
<CODE>my_ulonglong mysql_stmt_affected_rows(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.54  Description</H4>

<P>
Returns the total number of rows changed, deleted, or inserted by the last
executed statement. May be called immediatlely after <CODE>mysql_stmt_execute()</CODE>
for <CODE>UPDATE</CODE>, <CODE>DELETE</CODE>, or <CODE>INSERT</CODE> statements. For
<CODE>SELECT</CODE> statements, <CODE>mysql_stmt_affected_rows()</CODE> works like
<CODE>mysql_num_rows()</CODE>.

</P>


<H4>20.2.7.55  Return Values</H4>

<P>
An integer greater than zero indicates the number of rows affected
or retrieved. Zero indicates that no records were updated for an
<CODE>UPDATE</CODE> statement, no rows matched the <CODE>WHERE</CODE> clause in
the query, or that no query has yet been executed. -1 indicates that
the query returned an error or that, for a <CODE>SELECT</CODE> query,
<CODE>mysql_stmt_affected_rows()</CODE> was called prior to calling
<CODE>mysql_stmt_store_result()</CODE>.
Because <CODE>mysql_stmt_affected_rows()</CODE>
returns an unsigned value, you can check for -1 by comparing the
return value to <CODE>(my_ulonglong)-1</CODE> (or to <CODE>(my_ulonglong)~0</CODE>,
which is equivalent).

</P>

<H4>20.2.7.56  Errors</H4>

<P>
None.

</P>

<H4>20.2.7.57  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_affected_rows()</CODE>, refer to the Example
from section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_close" HREF="manual_toc.html#mysql_stmt_close">20.2.7.58  <CODE>mysql_stmt_close()</CODE></A></H4>

<P>
<A NAME="IDX2119"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_close(MYSQL_STMT *)</CODE>

</P>

<H4>20.2.7.59  Description</H4>

<P>
Closes the prepared statement. <CODE>mysql_stmt_close()</CODE> also
deallocates the statement handle pointed to by <CODE>stmt</CODE>. 

</P>
<P>
If the current statement has pending or unread results, this function
cancels them so that the next query can be executed.

</P>

<H4>20.2.7.60  Return Values</H4>

<P>
Zero if the statement was freed successfully. Non-zero if an error occurred.

</P>

<H4>20.2.7.61  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>


<H4>20.2.7.62  Example</H4>

<P>
For the usage of <CODE>mysql_stmt_close()</CODE>, refer to the Example from
section <A HREF="manual.html#mysql_stmt_execute">20.2.7.15  <CODE>mysql_stmt_execute()</CODE></A>.

</P>



<H4><A NAME="mysql_stmt_data_seek" HREF="manual_toc.html#mysql_stmt_data_seek">20.2.7.63  <CODE>mysql_stmt_data_seek()</CODE></A></H4>

<P>
<A NAME="IDX2120"></A>

</P>
<P>
<CODE>void mysql_stmt_data_seek(MYSQL_STMT *stmt, my_ulonglong offset)</CODE>

</P>

<H4>20.2.7.64  Description</H4>
<P>
Seeks to an arbitrary row in a statement result set.  The <CODE>offset</CODE>
value is a row number and should be in the range from <CODE>0</CODE> to
<CODE>mysql_stmt_num_rows(stmt)-1</CODE>.

</P>

<P>
This function requires that the statement result set structure
contains the entire result of the last executed query, so
<CODE>mysql_stmt_data_seek()</CODE> may be used only in conjunction with
<CODE>mysql_stmt_store_result()</CODE>.

</P>


<H4>20.2.7.65  Return Values</H4>

<P>
None.

</P>

<H4>20.2.7.66  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_stmt_errno" HREF="manual_toc.html#mysql_stmt_errno">20.2.7.67  <CODE>mysql_stmt_errno()</CODE></A></H4>

<P>
<A NAME="IDX2121"></A>

</P>
<P>
<CODE>unsigned int mysql_stmt_errno(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.68  Description</H4>

<P>
For the statement specified by <CODE>stmt</CODE>, <CODE>mysql_stmt_errno()</CODE>
returns the error code for the most recently invoked statement API
function that can succeed or fail. A return value of zero means that no
error occurred.  Client error
message numbers are listed in the MySQL <TT>`errmsg.h'</TT> header file.
Server error message numbers are listed in <TT>`mysqld_error.h'</TT>. In the
MySQL source distribution you can find a complete list of
error messages and error numbers in the file <TT>`Docs/mysqld_error.txt'</TT>.
The server error codes also are listed at section <A HREF="manual.html#Error-returns">21.1  Error Returns</A>.

</P>

<H4>20.2.7.69  Return Values</H4>

<P>
An error code value. Zero if no error occurred.

</P>

<H4>20.2.7.70  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_stmt_error" HREF="manual_toc.html#mysql_stmt_error">20.2.7.71  <CODE>mysql_stmt_error()</CODE></A></H4>

<P>
<A NAME="IDX2122"></A>

</P>
<P>
<CODE>const char *mysql_stmt_error(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.72  Description</H4>

<P>
For the statement specified by <CODE>stmt</CODE>, <CODE>mysql_stmt_error()</CODE>
returns a null-terminated string containing the error message for the most recently invoked statement API
function that can succeed or fail. An empty string (<CODE>""</CODE>) is returned
if no error occurred. This means the following two tests are equivalent:

</P>

<PRE>

if (mysql_stmt_errno(stmt))
{
  // an error occurred
}

if (mysql_stmt_error(stmt)[0])
{
  // an error occurred
}
</PRE>

<P>
The language of the client error messages may be changed by recompiling
the MySQL client library. Currently you can choose error messages in
several different languages.

</P>

<H4>20.2.7.73  Return Values</H4>

<P>
A character string that describes the error. An empty string if no error
occurred.

</P>

<H4>20.2.7.74  Errors</H4>

<P>
None.

</P>



<H4><A NAME="mysql_stmt_free_result" HREF="manual_toc.html#mysql_stmt_free_result">20.2.7.75  <CODE>mysql_stmt_free_result()</CODE></A></H4>

<P>
<A NAME="IDX2123"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_free_result(MYSQL_STMT *stmt)</CODE>

</P>
<P>
To be added.

</P>

<H4>20.2.7.76  Description</H4>


<H4>20.2.7.77  Return Values</H4>


<H4>20.2.7.78  Errors</H4>



<H4><A NAME="mysql_stmt_num_rows" HREF="manual_toc.html#mysql_stmt_num_rows">20.2.7.79  <CODE>mysql_stmt_num_rows()</CODE></A></H4>

<P>
<A NAME="IDX2124"></A>

</P>
<P>
<CODE>my_ulonglong mysql_stmt_num_rows(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.80  Description</H4>

<P>
Returns the number of rows in the result set.

</P>
<P>
The use of <CODE>mysql_stmt_num_rows()</CODE> depends on whether or not you used
<CODE>mysql_stmt_store_result()</CODE> to buffer the entire result set in the
statement handle.

</P>
<P>
If you use <CODE>mysql_stmt_store_result()</CODE>, <CODE>mysql_stmt_num_rows()</CODE> may be
called immediately.

</P>


<H4>20.2.7.81  Return Values</H4>

<P>
The number of rows in the result set.

</P>

<H4>20.2.7.82  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_stmt_reset" HREF="manual_toc.html#mysql_stmt_reset">20.2.7.83  <CODE>mysql_stmt_reset()</CODE></A></H4>

<P>
<A NAME="IDX2125"></A>

</P>
<P>
<CODE>my_bool mysql_stmt_reset(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.84  Description</H4>

<P>
Reset prepared statement on client and server to state after prepare.
For now this is mainly used to reset data sent with
<CODE>mysql_stmt_send_long_data()</CODE>.

</P>
<P>
To re-prepare the statement with another query, use
<CODE>mysql_stmt_prepare()</CODE>.

</P>

<H4>20.2.7.85  Return Values</H4>

<P>
Zero if the statement was reset successfully.  Non-zero if an error occurred.

</P>

<H4>20.2.7.86  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order.
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away.
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred.
</DL>



<H4><A NAME="mysql_stmt_row_seek" HREF="manual_toc.html#mysql_stmt_row_seek">20.2.7.87  <CODE>mysql_stmt_row_seek()</CODE></A></H4>

<P>
<A NAME="IDX2126"></A>

</P>
<P>
<CODE>MYSQL_ROW_OFFSET mysql_stmt_row_seek(MYSQL_STMT *stmt, MYSQL_ROW_OFFSET offset)</CODE>

</P>

<H4>20.2.7.88  Description</H4>
<P>
Sets the row cursor to an arbitrary row in a statement result set.
The <CODE>offset</CODE> value is a row offset that should be a value returned
from <CODE>mysql_stmt_row_tell()</CODE> or from <CODE>mysql_stmt_row_seek()</CODE>.
This value is not a row number; if you want to seek to a row within a
result set by number, use <CODE>mysql_stmt_data_seek()</CODE> instead.

</P>

<P>
This function requires that the result set structure contains the entire
result of the query, so <CODE>mysql_stmt_row_seek()</CODE> may be used only
in conjunction with <CODE>mysql_stmt_store_result()</CODE>.

</P>

<H4>20.2.7.89  Return Values</H4>

<P>
The previous value of the row cursor.  This value may be passed to a
subsequent call to <CODE>mysql_stmt_row_seek()</CODE>.

</P>

<H4>20.2.7.90  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_stmt_row_tell" HREF="manual_toc.html#mysql_stmt_row_tell">20.2.7.91  <CODE>mysql_stmt_row_tell()</CODE></A></H4>

<P>
<A NAME="IDX2127"></A>

</P>
<P>
<CODE>MYSQL_ROW_OFFSET mysql_stmt_row_tell(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.92  Description</H4>

<P>
Returns the current position of the row cursor for the last
<CODE>mysql_stmt_fetch()</CODE>. This value can be used as an argument to
<CODE>mysql_stmt_row_seek()</CODE>.

</P>
<P>
You should use <CODE>mysql_stmt_row_tell()</CODE> only after <CODE>mysql_stmt_store_result()</CODE>.

</P>

<H4>20.2.7.93  Return Values</H4>

<P>
The current offset of the row cursor.

</P>

<H4>20.2.7.94  Errors</H4>
<P>
None.

</P>



<H4><A NAME="mysql_stmt_sqlstate" HREF="manual_toc.html#mysql_stmt_sqlstate">20.2.7.95  <CODE>mysql_stmt_sqlstate()</CODE></A></H4>

<P>
<A NAME="IDX2128"></A>

</P>
<P>
<CODE>const char *mysql_stmt_sqlstate(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.96  Description</H4>

<P>
For the statement specified by <CODE>stmt</CODE>, <CODE>mysql_stmt_sqlstate()</CODE>
returns a null-terminated string containing the SQLSTATE error code for the
most recently invoked prepared statement API function that can succeed or fail.
The error code consists of five characters.
<CODE>"00000"</CODE> means ``no error.''
The values are specified by ANSI SQL and ODBC.
For a list of possible values, see section <A HREF="manual.html#Error-returns">21.1  Error Returns</A>.

</P>
<P>
Note that not all MySQL errors are yet mapped to SQLSTATE's.
The value <CODE>"HY000"</CODE> (general error) is used
for unmapped errors.

</P>
<P>
This function was added to MySQL 4.1.1.

</P>

<H4>20.2.7.97  Return Values</H4>

<P>
A null-terminated character string containing the SQLSTATE error code.

</P>



<H4><A NAME="mysql_stmt_store_result" HREF="manual_toc.html#mysql_stmt_store_result">20.2.7.98  <CODE>mysql_stmt_store_result()</CODE></A></H4>

<P>
<A NAME="IDX2129"></A>

</P>
<P>
<CODE>int mysql_stmt_store_result(MYSQL_STMT *stmt)</CODE>

</P>

<H4>20.2.7.99  Description</H4>

<P>
You must call <CODE>mysql_stmt_store_result()</CODE> for every query that
successfully produces a result set
(<CODE>SELECT</CODE>, <CODE>SHOW</CODE>, <CODE>DESCRIBE</CODE>, <CODE>EXPLAIN</CODE>), and only
if you want to buffer the complete result set by the client, so that the
subsequent <CODE>mysql_stmt_fetch()</CODE> call returns buffered data.

</P>
<P>
It is unnecessary to call <CODE>mysql_stmt_store_result()</CODE> for other
queries, but if you do, it will not harm or cause any notable performance.
You can detect whether the query produced a result set by checking
if <CODE>mysql_stmt_result_metadata()</CODE> returns <CODE>NULL</CODE>.
For more information, refer to section <A HREF="manual.html#mysql_stmt_result_metadata">20.2.7.29  <CODE>mysql_stmt_result_metadata()</CODE></A>.

</P>
<P>
<STRONG>NOTE:</STRONG>
MySQL doesn't by default calculate <CODE>MYSQL_FIELD-&#62;max_length</CODE> for
all columns in <CODE>mysql_stmt_store_result()</CODE> because calculating this
would slow down <CODE>mysql_stmt_store_result()</CODE> considerably and most
applications doesn't need <CODE>max_length</CODE>.  If you want
<CODE>max_length</CODE> to be updated, you can call
<CODE>mysql_stmt_attr_set(MYSQL_STMT, STMT_ATTR_UPDATE_MAX_LENGTH, &#38;flag)</CODE>
to enable this. See section <A HREF="manual.html#mysql_stmt_attr_set">20.2.7.102  <CODE>mysql_stmt_attr_set()</CODE></A>.

</P>

<H4>20.2.7.100  Return Values</H4>

<P>
Zero if the results are buffered successfully.  Non-zero if an error occurred.

</P>

<H4>20.2.7.101  Errors</H4>

<DL COMPACT>

<DT><CODE>CR_COMMANDS_OUT_OF_SYNC</CODE>
<DD>
Commands were executed in an improper order. 
<DT><CODE>CR_OUT_OF_MEMORY</CODE>
<DD>
Out of memory. 
<DT><CODE>CR_SERVER_GONE_ERROR</CODE>
<DD>
The MySQL server has gone away. 
<DT><CODE>CR_SERVER_LOST</CODE>
<DD>
The connection to the server was lost during the query. 
<DT><CODE>CR_UNKNOWN_ERROR</CODE>
<DD>
An unknown error occurred. 
</DL>



<H4><A NAME="mysql_stmt_attr_set" HREF="manual_toc.html#mysql_stmt_attr_set">20.2.7.102  <CODE>mysql_stmt_attr_set()</CODE></A></H4>

<P>
<A NAME="IDX2130"></A>

</P>
<P>
<CODE>int mysql_stmt_attr_set(MYSQL_STMT *stmt, enum enum_stmt_attr_type option, const void *arg)</CODE>

</P>

<H4>20.2.7.103  Description</H4>

<P>
Can be used to set affect behavior for a statement.
This function may be called multiple times to set several options.

</P>
<P>
The <CODE>option</CODE> argument is the option that you want to set; the <CODE>arg</CODE>
argument is the value for the option. If the option is an integer, then
<CODE>arg</CODE> should point to the value of the integer.

</P>
<P>
Possible options values:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Option</STRONG> </TD><TD> <STRONG>Argument Type</STRONG> </TD><TD> <STRONG>Function</STRONG>
</TD></TR>
<TR><TD><CODE>STMT_ATTR_UPDATE_MAX_LENGTH</CODE> </TD><TD> <CODE>my_bool *</CODE> </TD><TD> If set to 1: Update metadata <CODE>MYSQL_FIELD-&#62;max_length</CODE> in <CODE>mysql_stmt_store_result()</CODE>.
</TD></TR>
</TABLE>


<H4>20.2.7.104  Return Values</H4>

<P>
<CODE>0</CODE> if ok.  <CODE>1</CODE> if <CODE>attr_type</CODE> is unknown.

</P>

<H4>20.2.7.105  Errors</H4>

<P>
none

</P>



<H4><A NAME="mysql_stmt_attr_get" HREF="manual_toc.html#mysql_stmt_attr_get">20.2.7.106  <CODE>mysql_stmt_attr_get()</CODE></A></H4>

<P>
<A NAME="IDX2131"></A>

</P>
<P>
<CODE>int mysql_stmt_attr_get(MYSQL_STMT *stmt, enum enum_stmt_attr_type option, void *arg)</CODE>

</P>

<H4>20.2.7.107  Description</H4>

<P>
Can be used to get the current value for a statement attribute.

</P>
<P>
The <CODE>option</CODE> argument is the option that you want to get; the
<CODE>arg</CODE> should point to a variable that should contain the option
value. If the option is an integer, then <CODE>arg</CODE> should point to the
value of the integer.

</P>
<P>
See mysql_stmt_attr_set for a list of options and option
types. See section <A HREF="manual.html#mysql_stmt_attr_set">20.2.7.102  <CODE>mysql_stmt_attr_set()</CODE></A>.

</P>

<H4>20.2.7.108  Return Values</H4>

<P>
<CODE>0</CODE> if ok.  <CODE>1</CODE> if <CODE>attr_type</CODE> is unknown.

</P>

<H4>20.2.7.109  Errors</H4>

<P>
none

</P>


<H3><A NAME="C_API_multiple_queries" HREF="manual_toc.html#C_API_multiple_queries">20.2.8  C API Handling of Multiple Query Execution</A></H3>

<P>
From version 4.1, MySQL supports the execution of multiple statements
specified in a single query string. To use this capability with a given
connection, you must specify the <CODE>CLIENT_MULTI_STATEMENTS</CODE> option in
the flags parameter of <CODE>mysql_real_connect()</CODE>
when opening the connection.  You can also set this for a connection
by calling <CODE>mysql_set_server_option(MYSQL_OPTION_MULTI_STATEMENTS_ON)</CODE>

</P>
<P>
By default, <CODE>mysql_query()</CODE> and <CODE>mysql_real_query()</CODE> return
only the first query status and the subsequent queries status can
be processed using <CODE>mysql_more_results()</CODE> and
<CODE>mysql_next_result()</CODE>.

</P>

<PRE>

/* Connect to server with option CLIENT_MULTI_STATEMENTS */
mysql_real_connect(..., CLIENT_MULTI_STATEMENTS);

/* Now execute multiple queries */
mysql_query(mysql,"DROP TABLE IF EXISTS test_table;\
                   CREATE TABLE test_table(id INT);\
                   INSERT INTO test_table VALUES(10);\
                   UPDATE test_table SET id=20 WHERE id=10;\
                   SELECT * FROM test_table;\
                   DROP TABLE test_table";
do
{
  /* Process all results */
  ...
  printf("total affected rows: %lld", mysql_affected_rows(mysql));
  ...
  if (!(result= mysql_store_result(mysql)))
  {
     printf(stderr, "Got fatal error processing query\n");
     exit(1);
  }
  process_result_set(result);	/* client function */
  mysql_free_result(result);
} while (!mysql_next_result(mysql));

</PRE>



<H3><A NAME="C_API_date_handling" HREF="manual_toc.html#C_API_date_handling">20.2.9  C API Handling of Date and Time Values</A></H3>

<P>
The new binary protocol available in MySQL 4.1 and above allows you to
send and receive date and time values (<CODE>DATE</CODE>, <CODE>TIME</CODE>,
<CODE>DATETIME</CODE>, and <CODE>TIMESTAMP</CODE>), using
the <CODE>MYSQL_TIME</CODE> structure. The members of this structure are described
in section <A HREF="manual.html#C_API_Prepared_statement_datatypes">20.2.5  C API Prepared Statement Data types</A>.

</P>
<P>
To send temporal data values, you create a prepared statement with
<CODE>mysql_stmt_prepare()</CODE>. Then, before calling
<CODE>mysql_stmt_execute()</CODE> to execute the statement, use the following
procedure to set up each temporal parameter:

</P>

<OL>

<LI>

In the <CODE>MYSQL_BIND</CODE> structure associated with the data value, set the
<CODE>buffer_type</CODE> member to the type that indicates what kind of temporal
value you're sending. For
<CODE>DATE</CODE>,
<CODE>TIME</CODE>,
<CODE>DATETIME</CODE>,
or
<CODE>TIMESTAMP</CODE>
values, set <CODE>buffer_type</CODE> to
<CODE>MYSQL_TYPE_DATE</CODE>,
<CODE>MYSQL_TYPE_TIME</CODE>,
<CODE>MYSQL_TYPE_DATETIME</CODE>,
or
<CODE>MYSQL_TYPE_TIMESTAMP</CODE>,
respectively.

<LI>

Set the <CODE>buffer</CODE> member of the <CODE>MYSQL_BIND</CODE> structure to the address
of the <CODE>MYSQL_TIME</CODE> structure in which you will pass the temporal value.

<LI>

Fill in the members of the <CODE>MYSQL_TIME</CODE> structure that are appropriate
for the type of temporal value you're passing.
</OL>

<P>
Use <CODE>mysql_stmt_bind_param()</CODE> to bind the parameter data to the statement.
Then you can call <CODE>mysql_stmt_execute()</CODE>.

</P>
<P>
To retrieve temporal values, the procedure is similar, except that you set
the <CODE>buffer_type</CODE> member to the type of value you expect to receive, and
the <CODE>buffer</CODE> member to the address of a <CODE>MYSQL_TIME</CODE> structure into
which the returned value should be placed.
Use <CODE>mysql_bind_results()</CODE> to bind the buffers to the statement after
calling <CODE>mysql_stmt_execute()</CODE> and before fetching the results.

</P>
<P>
Here is a simple example that inserts <CODE>DATE</CODE>, <CODE>TIME</CODE>, and
<CODE>TIMESTAMP</CODE> data.
The <CODE>mysql</CODE> variable is assumed to be a valid connection handle.

</P>

<PRE>

  MYSQL_TIME  ts;
  MYSQL_BIND  bind[3];
  MYSQL_STMT  *stmt;
  
  strmov(query, "INSERT INTO test_table(date_field, time_field,
                                        timestamp_field) VALUES(?,?,?");

  stmt = mysql_stmt_init(mysql);
  if (!stmt)
  {
    fprintf(stderr, " mysql_stmt_init(), out of memory\n");
    exit(0);
  }
  if (mysql_stmt_prepare(mysql, query, strlen(query)))
  {
    fprintf(stderr, "\n mysql_stmt_prepare(), INSERT failed");
    fprintf(stderr, "\n %s", mysql_stmt_error(stmt));
    exit(0);
  }

  /* setup input buffers for all 3 parameters */
  bind[0].buffer_type= MYSQL_TYPE_DATE;
  bind[0].buffer= (char *)&#38;ts;  
  bind[0].is_null= 0;
  bind[0].length= 0;
  ..
  bind[1]= bind[2]= bind[0];
  ..

  mysql_stmt_bind_param(stmt, bind);

  /* supply the data to be sent in the ts structure */
  ts.year= 2002;
  ts.month= 02;
  ts.day= 03;

  ts.hour= 10;
  ts.minute= 45;
  ts.second= 20;

  mysql_stmt_execute(stmt);
  .. 

</PRE>



<H3><A NAME="C_Thread_functions" HREF="manual_toc.html#C_Thread_functions">20.2.10  C API Threaded Function Descriptions</A></H3>

<P>
You need to use the following functions when you want to create a
threaded client. See section <A HREF="manual.html#Threaded_clients">20.2.14  How to Make a Threaded Client</A>.

</P>



<H4><A NAME="my_init" HREF="manual_toc.html#my_init">20.2.10.1  <CODE>my_init()</CODE></A></H4>

<P>
<A NAME="IDX2132"></A>

</P>
<P>
<CODE>void my_init(void)</CODE>

</P>

<H4>20.2.10.2  Description</H4>

<P>
This function needs to be called once in the program before calling any
MySQL function.  This initializes some global variables that MySQL
needs.  If you are using a thread-safe client library, this will also
call <CODE>mysql_thread_init()</CODE> for this thread.

</P>
<P>
This is automatically called by <CODE>mysql_init()</CODE>,
<CODE>mysql_server_init()</CODE> and <CODE>mysql_connect()</CODE>.

</P>

<H4>20.2.10.3  Return Values</H4>

<P>
None.

</P>


<H4><A NAME="mysql_thread_init" HREF="manual_toc.html#mysql_thread_init">20.2.10.4  <CODE>mysql_thread_init()</CODE></A></H4>

<P>
<A NAME="IDX2133"></A>

</P>
<P>
<CODE>my_bool mysql_thread_init(void)</CODE>

</P>

<H4>20.2.10.5  Description</H4>

<P>
This function needs to be called for each created thread to initialize
thread-specific variables.

</P>
<P>
This is automatically called by <CODE>my_init()</CODE> and <CODE>mysql_connect()</CODE>.

</P>

<H4>20.2.10.6  Return Values</H4>

<P>
Zero if successful. Non-zero if an error occurred.

</P>


<H4><A NAME="mysql_thread_end" HREF="manual_toc.html#mysql_thread_end">20.2.10.7  <CODE>mysql_thread_end()</CODE></A></H4>

<P>
<A NAME="IDX2134"></A>

</P>
<P>
<CODE>void mysql_thread_end(void)</CODE>

</P>

<H4>20.2.10.8  Description</H4>

<P>
This function needs to be called before calling <CODE>pthread_exit()</CODE> to
free memory allocated by <CODE>mysql_thread_init()</CODE>.

</P>
<P>
Note that this function <STRONG>is not invoked automatically</STRONG> by the client
library.  It must be called explicitly to avoid a memory leak.

</P>

<H4>20.2.10.9  Return Values</H4>

<P>
None.

</P>


<H4><A NAME="mysql_thread_safe" HREF="manual_toc.html#mysql_thread_safe">20.2.10.10  <CODE>mysql_thread_safe()</CODE></A></H4>

<P>
<A NAME="IDX2135"></A>

</P>
<P>
<CODE>unsigned int mysql_thread_safe(void)</CODE>

</P>

<H4>20.2.10.11  Description</H4>

<P>
This function indicates whether the client is compiled as thread-safe.

</P>

<H4>20.2.10.12  Return Values</H4>

<P>
1 is the client is thread-safe, 0 otherwise.

</P>


<H3><A NAME="C_Embedded_Server_func" HREF="manual_toc.html#C_Embedded_Server_func">20.2.11  C API Embedded Server Function Descriptions</A></H3>

<P>
You must use the following functions if you want to allow your
application to be linked against the embedded MySQL server library.
See section <A HREF="manual.html#libmysqld">20.2.15  libmysqld, the Embedded MySQL Server Library</A>.

</P>
<P>
If the program is linked with <CODE>-lmysqlclient</CODE> instead of
<CODE>-lmysqld</CODE>, these functions do nothing.  This makes it
possible to choose between using the embedded MySQL server and
a standalone server without modifying any code.

</P>



<H4><A NAME="mysql_server_init" HREF="manual_toc.html#mysql_server_init">20.2.11.1  <CODE>mysql_server_init()</CODE></A></H4>

<P>
<A NAME="IDX2136"></A>

</P>
<P>
<CODE>int mysql_server_init(int argc, char **argv, char **groups)</CODE>

</P>

<H4>20.2.11.2  Description</H4>

<P>
This function <STRONG>must</STRONG> be called once in the program using the
embedded server before calling any other MySQL function.  It starts
the server and initializes any subsystems (<CODE>mysys</CODE>, <CODE>InnoDB</CODE>, etc.) 
that the server uses.  If this function is not called, the program will
crash.  If you are using the DBUG package that comes with MySQL, you
should call this after you have called <CODE>MY_INIT()</CODE>.

</P>
<P>
The <CODE>argc</CODE> and <CODE>argv</CODE> arguments are analogous to the arguments
to <CODE>main()</CODE>.  The first element of <CODE>argv</CODE> is ignored (it
typically contains the program name).  For convenience, <CODE>argc</CODE> may
be <CODE>0</CODE> (zero) if there are no command-line arguments for the
server.  <CODE>mysql_server_init()</CODE> makes a copy of the arguments so
it's safe to destroy <CODE>argv</CODE> or <CODE>groups</CODE> after the call.

</P>
<P>
The <CODE>NULL</CODE>-terminated list of strings in <CODE>groups</CODE>
selects which groups in the option files will be active.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.  For convenience, <CODE>groups</CODE> may be
<CODE>NULL</CODE>, in which case the <CODE>[server]</CODE> and <CODE>[emedded]</CODE> groups
will be active.

</P>

<H4>20.2.11.3  Example</H4>


<PRE>
#include &#60;mysql.h&#62;
#include &#60;stdlib.h&#62;

static char *server_args[] = {
  "this_program",       /* this string is not used */
  "--datadir=.",
  "--key_buffer_size=32M"
};
static char *server_groups[] = {
  "embedded",
  "server",
  "this_program_SERVER",
  (char *)NULL
};

int main(void) {
  if (mysql_server_init(sizeof(server_args) / sizeof(char *),
                        server_args, server_groups))
    exit(1);

  /* Use any MySQL API functions here */

  mysql_server_end();

  return EXIT_SUCCESS;
}
</PRE>


<H4>20.2.11.4  Return Values</H4>

<P>
0 if okay, 1 if an error occurred.

</P>


<H4><A NAME="mysql_server_end" HREF="manual_toc.html#mysql_server_end">20.2.11.5  <CODE>mysql_server_end()</CODE></A></H4>

<P>
<A NAME="IDX2137"></A>

</P>
<P>
<CODE>void mysql_server_end(void)</CODE>

</P>

<H4>20.2.11.6  Description</H4>

<P>
This function <STRONG>must</STRONG> be called once in the program after
all other MySQL functions.  It shuts down the embedded server.

</P>

<H4>20.2.11.7  Return Values</H4>

<P>
None.

</P>


<H3><A NAME="C_API_problems" HREF="manual_toc.html#C_API_problems">20.2.12  Common questions and problems when using the C API</A></H3>

<P>
<A NAME="IDX2138"></A>
<A NAME="IDX2139"></A>

</P>



<H4><A NAME="NULL_mysql_store_result" HREF="manual_toc.html#NULL_mysql_store_result">20.2.12.1  Why <CODE>mysql_store_result()</CODE> Sometimes Returns <CODE>NULL</CODE> After <CODE>mysql_query()</CODE> Returns Success</A></H4>

<P>
It is possible for <CODE>mysql_store_result()</CODE> to return <CODE>NULL</CODE>
following a successful call to <CODE>mysql_query()</CODE>.  When this happens, it
means one of the following conditions occurred:

</P>

<UL>
<LI>

There was a <CODE>malloc()</CODE> failure (for example, if the result set was too
large).

<LI>

The data couldn't be read (an error occurred on the connection).

<LI>

The query returned no data (for example, it was an <CODE>INSERT</CODE>,
<CODE>UPDATE</CODE>, or <CODE>DELETE</CODE>).
</UL>

<P>
You can always check whether the statement should have produced a
non-empty result by calling <CODE>mysql_field_count()</CODE>.  If
<CODE>mysql_field_count()</CODE> returns zero, the result is empty and the last
query was a statement that does not return values (for example, an
<CODE>INSERT</CODE> or a <CODE>DELETE</CODE>).  If <CODE>mysql_field_count()</CODE> returns a
non-zero value, the statement should have produced a non-empty result.
See the description of the <CODE>mysql_field_count()</CODE> function for an
example.

</P>
<P>
You can test for an error by calling <CODE>mysql_error()</CODE> or
<CODE>mysql_errno()</CODE>.

</P>


<H4><A NAME="Query_results" HREF="manual_toc.html#Query_results">20.2.12.2  What Results You Can Get from a Query</A></H4>

<P>
In addition to the result set returned by a query, you can also get the
following information:

</P>

<UL>
<LI>

<CODE>mysql_affected_rows()</CODE> returns the number of rows affected by the last
query when doing an <CODE>INSERT</CODE>, <CODE>UPDATE</CODE>, or <CODE>DELETE</CODE>. 

In MySQL 3.23, there is an exception when <CODE>DELETE</CODE> is used without
a <CODE>WHERE</CODE> clause. In this case, the table is re-created as an empty
table and <CODE>mysql_affected_rows()</CODE> returns zero for the number of
records affected.  In MySQL 4.0, <CODE>DELETE</CODE> always returns the correct
number of rows deleted. For a fast recreate, use <CODE>TRUNCATE TABLE</CODE>.

<LI>

<CODE>mysql_num_rows()</CODE> returns the number of rows in a result set.  With
<CODE>mysql_store_result()</CODE>, <CODE>mysql_num_rows()</CODE> may be called as soon as
<CODE>mysql_store_result()</CODE> returns.  With <CODE>mysql_use_result()</CODE>,
<CODE>mysql_num_rows()</CODE> may be called only after you have fetched all the
rows with <CODE>mysql_fetch_row()</CODE>.

<LI>

<CODE>mysql_insert_id()</CODE> returns the ID generated by the last
query that inserted a row into a table with an <CODE>AUTO_INCREMENT</CODE> index.
See section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

<LI>

Some queries (<CODE>LOAD DATA INFILE ...</CODE>, <CODE>INSERT INTO
... SELECT ...</CODE>, <CODE>UPDATE</CODE>) return additional information.  The result is
returned by <CODE>mysql_info()</CODE>.  See the description for <CODE>mysql_info()</CODE>
for the format of the string that it returns.  <CODE>mysql_info()</CODE> returns a
<CODE>NULL</CODE> pointer if there is no additional information.
</UL>



<H4><A NAME="Getting_unique_ID" HREF="manual_toc.html#Getting_unique_ID">20.2.12.3  How to Get the Unique ID for the Last Inserted Row</A></H4>

<P>
<A NAME="IDX2140"></A>
<A NAME="IDX2141"></A>
<A NAME="IDX2142"></A>
<A NAME="IDX2143"></A>

</P>
<P>
If you insert a record into a table that contains an <CODE>AUTO_INCREMENT</CODE>
column, you can obtain the value stored into that column by calling the
<CODE>mysql_insert_id()</CODE> function.

</P>
<P>
You can check whether a value was stored into an <CODE>AUTO_INCREMENT</CODE> column
by executing the following code. This also checks whether the query was an
<CODE>INSERT</CODE> with an <CODE>AUTO_INCREMENT</CODE> index:

</P>

<PRE>
if (mysql_error(&#38;mysql)[0] == 0 &#38;&
    mysql_num_fields(result) == 0 &#38;&
    mysql_insert_id(&#38;mysql) != 0)
{
    used_id = mysql_insert_id(&#38;mysql);
}
</PRE>

<P>
For more information, see section <A HREF="manual.html#mysql_insert_id">20.2.3.134  <CODE>mysql_insert_id()</CODE></A>.

</P>
<P>
When a new <CODE>AUTO_INCREMENT</CODE> value has been generated,
you can also obtain it by executing a <CODE>SELECT LAST_INSERT_ID()</CODE>
statement <CODE>mysql_query()</CODE> and retrieving the value from the result set
returned by the statement.

</P>
<P>
For <CODE>LAST_INSERT_ID()</CODE>,
the most recently generated ID is maintained in the server on a
per-connection basis.  It will not be changed by another client. It will not
even be changed if you update another <CODE>AUTO_INCREMENT</CODE> column with a
non-magic value (that is, a value that is not <CODE>NULL</CODE> and not <CODE>0</CODE>).

</P>
<P>
If you want to use the ID that was generated for one table and insert
it into a second table, you can use SQL statements like this:

</P>

<PRE>
INSERT INTO foo (auto,text)
    VALUES(NULL,'text');              # generate ID by inserting NULL
INSERT INTO foo2 (id,text)
    VALUES(LAST_INSERT_ID(),'text');  # use ID in second table
</PRE>

<P>
Note that <CODE>mysql_insert_id()</CODE> returns the value stored into an
<CODE>AUTO_INCREMENT</CODE> column, whether that value is automatically generated
by storing <CODE>NULL</CODE> or <CODE>0</CODE> or is an explicit value.
<CODE>LAST_INSERT_ID()</CODE> returns automatically generated <CODE>AUTO_INCREMENT</CODE>
values. If you store an explicit value other than <CODE>NULL</CODE> or <CODE>0</CODE>,
it does not affect the value returned by <CODE>LAST_INSERT_ID()</CODE>.

</P>



<H4><A NAME="C_API_linking_problems" HREF="manual_toc.html#C_API_linking_problems">20.2.12.4  Problems Linking with the C API</A></H4>

<P>
<A NAME="IDX2144"></A>
<A NAME="IDX2145"></A>

</P>
<P>
When linking with the C API, the following errors may occur on some systems:

</P>

<PRE>
gcc -g -o client test.o -L/usr/local/lib/mysql -lmysqlclient -lsocket -lnsl

Undefined        first referenced
 symbol          in file
floor            /usr/local/lib/mysql/libmysqlclient.a(password.o)
ld: fatal: Symbol referencing errors. No output written to client
</PRE>

<P>
If this happens on your system, you must include the math library by
adding <CODE>-lm</CODE> to the end of the compile/link line.

</P>



<H3><A NAME="Building_clients" HREF="manual_toc.html#Building_clients">20.2.13  Building Client Programs</A></H3>

<P>
<A NAME="IDX2146"></A>
<A NAME="IDX2147"></A>
<A NAME="IDX2148"></A>
<A NAME="IDX2149"></A>

</P>
<P>
If you compile MySQL clients that you've written yourself or that
you obtain from a third-party, they must be linked using the
<CODE>-lmysqlclient -lz</CODE> option on the link command.  You may also need to
specify a <CODE>-L</CODE> option to tell the linker where to find the library.  For
example, if the library is installed in <TT>`/usr/local/mysql/lib'</TT>, use
<CODE>-L/usr/local/mysql/lib -lmysqlclient -lz</CODE> on the link command.

</P>
<P>
For clients that use MySQL header files, you may need to specify a
<CODE>-I</CODE> option when you compile them (for example,
<CODE>-I/usr/local/mysql/include</CODE>), so the compiler can find the header
files.

</P>
<P>
To make it simpler to compile MySQL programs on Unix, we have provided the
<CODE>mysql_config</CODE> script for you. See section <A HREF="manual.html#mysql_config">20.1.2  <CODE>mysql_config</CODE>, Get compile options for compiling clients</A>.

</P>
<P>
You can use it to compile a MySQL client as follows:

</P>

<PRE>
CFG=/usr/local/mysql/bin/mysql_config
sh -c "gcc -o progname `$CFG --cflags` progname.c `$CFG --libs`"
</PRE>

<P>
The <CODE>sh -c</CODE> is needed to get the shell not to treat the output from
<CODE>mysql_config</CODE> as one word.

</P>


<H3><A NAME="Threaded_clients" HREF="manual_toc.html#Threaded_clients">20.2.14  How to Make a Threaded Client</A></H3>

<P>
<A NAME="IDX2150"></A>
<A NAME="IDX2151"></A>

</P>
<P>
The client library is almost thread-safe. The biggest problem is
that the subroutines in <TT>`net.c'</TT> that read from sockets are not
interrupt safe.  This was done with the thought that you might want to
have your own alarm that can break a long read to a server.  If you
install interrupt handlers for the <CODE>SIGPIPE</CODE> interrupt,
the socket handling should be thread-safe.

</P>
<P>
New in 4.0.16: To not abort the program when a connection terminates,
MySQL blocks <CODE>SIGPIPE</CODE> on the first call to
<CODE>mysql_server_init</CODE>(), <CODE>mysql_init()</CODE> or
<CODE>mysql_connect()</CODE>.  If you want to have your own <CODE>SIGPIPE</CODE>
handler, you should first call <CODE>mysql_server_init()</CODE> and then
install your handler. In older versions of MySQL <CODE>SIGPIPE</CODE> was blocked,
but only in the thread safe client library, for every call to
<CODE>mysql_init()</CODE>.

</P>
<P>
In the older binaries we distribute on our Web site
(<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>), the client libraries are not normally
compiled with the thread-safe option (the Windows binaries are by
default compiled to be thread-safe). Newer binary distributions should
have both a normal and a thread-safe client library.

</P>
<P>
To get a threaded client where you can interrupt the client from other
threads and set timeouts when talking with the MySQL server, you should
use the <CODE>-lmysys</CODE>, <CODE>-lmystrings</CODE>, and <CODE>-ldbug</CODE> libraries and
the <CODE>net_serv.o</CODE> code that the server uses.

</P>
<P>
If you don't need interrupts or timeouts, you can just compile a
thread-safe client library <CODE>(mysqlclient_r)</CODE> and use this.  See section <A HREF="manual.html#C">20.2  MySQL C API</A>.  In this case, you don't have to worry about the
<CODE>net_serv.o</CODE> object file or the other MySQL libraries.

</P>
<P>
When using a threaded client and you want to use timeouts and
interrupts, you can make great use of the routines in the
<TT>`thr_alarm.c'</TT> file.  If you are using routines from the
<CODE>mysys</CODE> library, the only thing you must remember is to call
<CODE>my_init()</CODE> first! See section <A HREF="manual.html#C_Thread_functions">20.2.10  C API Threaded Function Descriptions</A>.

</P>
<P>
All functions except <CODE>mysql_real_connect()</CODE> are by default
thread-safe.  The following notes describe how to compile a thread-safe
client library and use it in a thread-safe manner.  (The notes below for
<CODE>mysql_real_connect()</CODE> actually apply to <CODE>mysql_connect()</CODE> as
well, but because <CODE>mysql_connect()</CODE> is deprecated, you should be
using <CODE>mysql_real_connect()</CODE> anyway.)

</P>
<P>
To make <CODE>mysql_real_connect()</CODE> thread-safe, you must recompile the
client library with this command:

</P>

<PRE>
shell&#62; ./configure --enable-thread-safe-client
</PRE>

<P>
This will create a thread-safe client library <CODE>libmysqlclient_r</CODE>.
(Assuming that your OS has a thread-safe <CODE>gethostbyname_r()</CODE> function.)
This library is thread-safe per connection.  You can let two threads
share the same connection with the following caveats:

</P>

<UL>
<LI>

Two threads can't send a query to the MySQL server at the same time on
the same connection.  In particular, you have to ensure that between a
<CODE>mysql_query()</CODE> and <CODE>mysql_store_result()</CODE> no other thread is using
the same connection.
<LI>

Many threads can access different result sets that are retrieved with
<CODE>mysql_store_result()</CODE>.
<LI>

If you use <CODE>mysql_use_result</CODE>, you have to ensure that no other thread
is using the same connection until the result set is closed.
However, it really is best for threaded clients that share the same
connection to use <CODE>mysql_store_result()</CODE>.
<LI>

If you want to use multiple threads on the same connection, you must
have a mutex lock around your <CODE>mysql_query()</CODE> and
<CODE>mysql_store_result()</CODE> call combination.  Once
<CODE>mysql_store_result()</CODE> is ready, the lock can be released and other
threads may query the same connection.
<LI>

If you program with POSIX threads, you can use
<CODE>pthread_mutex_lock()</CODE> and <CODE>pthread_mutex_unlock()</CODE> to
establish and release a mutex lock.
</UL>

<P>
You need to know the following if you have a thread that is calling
MySQL functions which did not create the connection to the
MySQL database:

</P>
<P>
When you call <CODE>mysql_init()</CODE> or <CODE>mysql_connect()</CODE>, MySQL will
create a thread-specific variable for the thread that is used by the
debug library (among other things).

</P>
<P>
If you call a MySQL function, before the thread has
called <CODE>mysql_init()</CODE> or <CODE>mysql_connect()</CODE>, the thread will
not have the necessary thread-specific variables in place and you are
likely to end up with a core dump sooner or later.

</P>
<P>
The get things to work smoothly you have to do the following:

</P>

<OL>
<LI>

Call <CODE>my_init()</CODE> at the start of your program if it calls
any other MySQL function before calling <CODE>mysql_real_connect()</CODE>.
<LI>

Call <CODE>mysql_thread_init()</CODE> in the thread handler before calling
any MySQL function.
<LI>

In the thread, call <CODE>mysql_thread_end()</CODE> before calling
<CODE>pthread_exit()</CODE>.  This will free the memory used by MySQL
thread-specific variables.
</OL>

<P>
You may get some errors because of undefined symbols when linking your
client with <CODE>libmysqlclient_r</CODE>. In most cases this is because you haven't
included the thread libraries on the link/compile line.

</P>


<H3><A NAME="libmysqld" HREF="manual_toc.html#libmysqld">20.2.15  libmysqld, the Embedded MySQL Server Library</A></H3>

<P>
<A NAME="IDX2152"></A>
<A NAME="IDX2153"></A>

</P>



<H4><A NAME="libmysqld_overview" HREF="manual_toc.html#libmysqld_overview">20.2.15.1  Overview of the Embedded MySQL Server Library</A></H4>

<P>
The embedded MySQL server library makes it possible to run a
full-featured MySQL server inside a client application.  The
main benefits are increased speed and more simple management for
embedded applications.

</P>
<P>
The embedded server library is based on the client/server version of MySQL,
which is written in C/C++. Consequently, the embedded server also
is written in C/C++. There is no embedded server available in other
languages.

</P>
<P>
The API is identical for the embedded MySQL version and the
client/server version.  To change an old threaded application to use the
embedded library, you normally only have to add calls to the following
functions:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Function</STRONG> </TD><TD> <STRONG>When to Call</STRONG>
</TD></TR>
<TR><TD><CODE>mysql_server_init()</CODE> </TD><TD> Should be called before any other MySQL function is called, preferably early in the <CODE>main()</CODE> function.
</TD></TR>
<TR><TD><CODE>mysql_server_end()</CODE> </TD><TD> Should be called before your program exits.
</TD></TR>
<TR><TD><CODE>mysql_thread_init()</CODE> </TD><TD> Should be called in each thread you create that will access MySQL.
</TD></TR>
<TR><TD><CODE>mysql_thread_end()</CODE> </TD><TD> Should be called before calling <CODE>pthread_exit()</CODE>
</TD></TR>
</TABLE>

<P>
Then you must link your code with <TT>`libmysqld.a'</TT> instead of <TT>`libmysqlclient.a'</TT>.

</P>
<P>
The <CODE>mysql_server_xxx</CODE> functions are also included in
<TT>`libmysqlclient.a'</TT> to allow you to change between the embedded and the
client/server version by just linking your application with the right
library. See section <A HREF="manual.html#mysql_server_init">20.2.11.1  <CODE>mysql_server_init()</CODE></A>.

</P>



<H4><A NAME="libmysqld_compiling" HREF="manual_toc.html#libmysqld_compiling">20.2.15.2  Compiling Programs with <CODE>libmysqld</CODE></A></H4>

<P>
To get a <CODE>libmysqld</CODE> library you should configure MySQL with the
<CODE>--with-embedded-server</CODE> option.

</P>
<P>
When you link your program with <CODE>libmysqld</CODE>, you must also include
the system-specific <CODE>pthread</CODE> libraries and some libraries that
the MySQL server uses.  You can get the full list of libraries by executing
<CODE>mysql_config --libmysqld-libs</CODE>.

</P>
<P>
The correct flags for compiling and linking a threaded program
must be used, even if you do not directly call any thread
functions in your code.

</P>


<H4><A NAME="libmysqld_restrictions" HREF="manual_toc.html#libmysqld_restrictions">20.2.15.3  Restrictions when using the Embedded MySQL Server</A></H4>

<P>
The embedded server has the following limitations:

</P>

<UL>
<LI>

No support for <CODE>ISAM</CODE> tables. (This is mainly done to make the library smaller)
<LI>

No user-defined functions (UDFs).
<LI>

No stack trace on core dump.
<LI>

No internal RAID support. (This is not normally needed as most OS has
nowadays support for big files).
<LI>

You cannot set this up as a master or a slave (no replication).
<LI>

You can't connect to an embedded server from an outside process with
sockets or TCP/IP.
</UL>

<P>
Some of these limitations can be changed by editing the <TT>`mysql_embed.h'</TT>
include file and recompiling MySQL.

</P>


<H4><A NAME="libmysqld_options" HREF="manual_toc.html#libmysqld_options">20.2.15.4  Using Option Files with the Embedded Server</A></H4>

<P>
<A NAME="IDX2154"></A>

</P>
<P>
The following is the recommended way to use option files to make it easy
to switch between a client/server application and one where MySQL is
embedded. See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>

<UL>
<LI>

Put common options in the <CODE>[server]</CODE> section. These will be read by
both MySQL versions.
<LI>

Put client/server-specific options in the <CODE>[mysqld]</CODE> section.
<LI>

Put embedded MySQL-specific options in the <CODE>[embedded]</CODE> section.
<LI>

Put application-specific options in a <CODE>[ApplicationName_SERVER]</CODE>
section.
</UL>



<H4><A NAME="libmysqld_TODO" HREF="manual_toc.html#libmysqld_TODO">20.2.15.5  Things left to do in Embedded Server (TODO)</A></H4>

<P>
<A NAME="IDX2155"></A>

</P>

<UL>
<LI>

We are going to provide options to leave out some parts of MySQL to make
the library smaller.
<LI>

There is still a lot of speed optimization to do.
<LI>

Errors are written to <CODE>stderr</CODE>.  We will add an option to specify a
filename for these.
<LI>

We have to change <CODE>InnoDB</CODE> to not be so verbose when using in the embedded
version.
</UL>



<H4><A NAME="libmysqld_example" HREF="manual_toc.html#libmysqld_example">20.2.15.6  A Simple Embedded Server Example</A></H4>

<P>
This example program and makefile should work without any
changes on a Linux or FreeBSD system.  For other operating
systems, minor changes will be needed.  This example is
designed to give enough details to understand the problem,
without the clutter that is a necessary part of a real
application.

</P>
<P>
To try out the example, create an <TT>`test_libmysqld'</TT> directory
at the same level as the mysql-4.0 source directory.  Save
the <TT>`test_libmysqld.c'</TT> source and the <TT>`GNUmakefile'</TT> in the
directory, and run GNU <TT>`make'</TT> from inside the <TT>`test_libmysqld'</TT>
directory.

</P>
<P>
<TT>`test_libmysqld.c'</TT>

<PRE>
/*
 * A simple example client, using the embedded MySQL server library
 */

#include &#60;mysql.h&#62;
#include &#60;stdarg.h&#62;
#include &#60;stdio.h&#62;
#include &#60;stdlib.h&#62;

MYSQL *db_connect(const char *dbname);
void db_disconnect(MYSQL *db);
void db_do_query(MYSQL *db, const char *query);

const char *server_groups[] = {
  "test_libmysqld_SERVER", "embedded", "server", NULL
};

int
main(int argc, char **argv)
{
  MYSQL *one, *two;

  /* mysql_server_init() must be called before any other mysql
   * functions.
   *
   * You can use mysql_server_init(0, NULL, NULL), and it will
   * initialize the server using groups = {
   *   "server", "embedded", NULL
   *  }.
   *
   * In your $HOME/.my.cnf file, you probably want to put:

[test_libmysqld_SERVER]
language = /path/to/source/of/mysql/sql/share/english

   * You could, of course, modify argc and argv before passing
   * them to this function.  Or you could create new ones in any
   * way you like.  But all of the arguments in argv (except for
   * argv[0], which is the program name) should be valid options
   * for the MySQL server.
   *
   * If you link this client against the normal mysqlclient
   * library, this function is just a stub that does nothing.
   */
  mysql_server_init(argc, argv, (char **)server_groups);

  one = db_connect("test");
  two = db_connect(NULL);

  db_do_query(one, "SHOW TABLE STATUS");
  db_do_query(two, "SHOW DATABASES");

  mysql_close(two);
  mysql_close(one);

  /* This must be called after all other mysql functions */
  mysql_server_end();

  exit(EXIT_SUCCESS);
}

static void
die(MYSQL *db, char *fmt, ...)
{
  va_list ap;
  va_start(ap, fmt);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  (void)putc('\n', stderr);
  if (db)
    db_disconnect(db);
  exit(EXIT_FAILURE);
}

MYSQL *
db_connect(const char *dbname)
{
  MYSQL *db = mysql_init(NULL);
  if (!db)
    die(db, "mysql_init failed: no memory");
  /*
   * Notice that the client and server use separate group names.
   * This is critical, because the server will not accept the
   * client's options, and vice versa.
   */
  mysql_options(db, MYSQL_READ_DEFAULT_GROUP, "test_libmysqld_CLIENT");
  if (!mysql_real_connect(db, NULL, NULL, NULL, dbname, 0, NULL, 0))
    die(db, "mysql_real_connect failed: %s", mysql_error(db));

  return db;
}

void
db_disconnect(MYSQL *db)
{
  mysql_close(db);
}

void
db_do_query(MYSQL *db, const char *query)
{
  if (mysql_query(db, query) != 0)
    goto err;

  if (mysql_field_count(db) &#62; 0)
  {
    MYSQL_RES   *res;
    MYSQL_ROW    row, end_row;
    int num_fields;

    if (!(res = mysql_store_result(db)))
      goto err;
    num_fields = mysql_num_fields(res);
    while ((row = mysql_fetch_row(res)))
    {
      (void)fputs("&#62;&#62; ", stdout);
      for (end_row = row + num_fields; row &#60; end_row; ++row)
        (void)printf("%s\t", row ? (char*)*row : "NULL");
      (void)fputc('\n', stdout);
    }
    (void)fputc('\n', stdout);
    mysql_free_result(res);
  }
  else
    (void)printf("Affected rows: %lld\n", mysql_affected_rows(db));

  return;

err:
  die(db, "db_do_query failed: %s [%s]", mysql_error(db), query);
}
</PRE>

<P>
<TT>`GNUmakefile'</TT>

<PRE>
# This assumes the MySQL software is installed in /usr/local/mysql
inc      := /usr/local/mysql/include/mysql
lib      := /usr/local/mysql/lib

# If you have not installed the MySQL software yet, try this instead
#inc      := $(HOME)/mysql-4.0/include
#lib      := $(HOME)/mysql-4.0/libmysqld

CC       := gcc
CPPFLAGS := -I$(inc) -D_THREAD_SAFE -D_REENTRANT
CFLAGS   := -g -W -Wall
LDFLAGS  := -static
# You can change -lmysqld to -lmysqlclient to use the
# client/server library
LDLIBS    = -L$(lib) -lmysqld -lz -lm -lcrypt

ifneq (,$(shell grep FreeBSD /COPYRIGHT 2&#62;/dev/null))
# FreeBSD
LDFLAGS += -pthread
else
# Assume Linux
LDLIBS += -lpthread
endif

# This works for simple one-file test programs
sources := $(wildcard *.c)
objects := $(patsubst %c,%o,$(sources))
targets := $(basename $(sources))

all: $(targets)

clean:
        rm -f $(targets) $(objects) *.core
</PRE>



<H4><A NAME="libmysqld_licensing" HREF="manual_toc.html#libmysqld_licensing">20.2.15.7  Licensing the Embedded Server</A></H4>

<P>
The MySQL source code is covered by the GNU <CODE>GPL</CODE> license
(see section <A HREF="manual.html#GPL_license">G  GNU General Public License</A>).  One result of this is that any program
which includes, by linking with <CODE>libmysqld</CODE>, the MySQL
source code must be released as free software (under a license
compatible with the <CODE>GPL</CODE>).

</P>
<P>
We encourage everyone to promote free software by releasing
code under the <CODE>GPL</CODE> or a compatible license.  For those who
are not able to do this, another option is to purchase a
commercial license for the MySQL code from MySQL AB.
For details, please see section <A HREF="manual.html#MySQL_licenses">1.4.3  MySQL Licenses</A>.

</P>



<H2><A NAME="ODBC" HREF="manual_toc.html#ODBC">20.3  MySQL ODBC Support</A></H2>

<P>
<A NAME="IDX2156"></A>
<A NAME="IDX2157"></A>
<A NAME="IDX2158"></A>
<A NAME="IDX2159"></A>

</P>

<P>
MySQL provides support for ODBC by means of the <CODE>MyODBC</CODE>
program.  This chapter will teach you how to install <CODE>MyODBC</CODE>,
and how to use it.  Here, you will also find a list of common programs that
are known to work with <CODE>MyODBC</CODE>.

</P>



<H3><A NAME="Installing_MyODBC" HREF="manual_toc.html#Installing_MyODBC">20.3.1  How to Install MyODBC</A></H3>

<P>
<CODE>MyODBC</CODE> 2.50 is a 32-bit ODBC 2.50 specification level 0 (with
level 1 and level 2 features) driver for connecting an ODBC-aware
application to MySQL.  <CODE>MyODBC</CODE> works on Windows 9x, Me, NT, 2000, and XP,
and on most Unix platforms.
<CODE>MyODBC</CODE> 3.51 is an enhanced version with ODBC 3.5x specification
level 1 (complete core API + level 2 features).

</P>
<P>
<CODE>MyODBC</CODE> is <CODE>Open Source</CODE>, and you can find the newest
version at <a HREF="http://dev.mysql.com/downloads/api-myodbc.html">http://dev.mysql.com/downloads/api-myodbc.html</a>.
Please note that the 2.50.x versions are <CODE>LGPL</CODE> licensed,
whereas the 3.51.x versions are <CODE>GPL</CODE> licensed.

</P>
<P>
If you have problem with <CODE>MyODBC</CODE> and your program also works
with OLEDB, you should try the OLEDB driver.

</P>
<P>
Normally you only need to install <CODE>MyODBC</CODE> on Windows machines.
You only need <CODE>MyODBC</CODE> for Unix if you have a program like
ColdFusion that is running on the Unix machine and uses ODBC to connect
to the databases.

</P>
<P>
If you want to install <CODE>MyODBC</CODE> on a Unix box, you will also need
an ODBC manager.  <CODE>MyODBC</CODE> is known to work with
most of the Unix ODBC managers.

</P>
<P>
To install <CODE>MyODBC</CODE> on Windows, you should download the
appropriate <CODE>MyODBC</CODE> <TT>`.zip'</TT> file,
unpack it with <CODE>WinZip</CODE> or some similar program,
and execute the <TT>`SETUP.EXE'</TT> file.

</P>
<P>
On Windows, NT, and XP you may get the following error when trying to install
<CODE>MyODBC</CODE>:

</P>

<PRE>
An error occurred while copying C:\WINDOWS\SYSTEM\MFC30.DLL. Restart
Windows and try installing again (before running any applications which
use ODBC)
</PRE>

<P>
The problem in this case is that some other program is using ODBC and
because of how Windows is designed, you may not in this case be able to
install a new ODBC drivers with Microsoft's ODBC setup program. In most
cases you can continue by just pressing <CODE>Ignore</CODE> to copy the rest
of the MyODBC files and the final installation should still work.  If
this doesn't work, the solution is to restart your computer in ``safe
mode`` (Choose this by pressing F8 just before your machine starts
Windows while restarting), install <CODE>MyODBC</CODE>, and restart to normal
mode.

</P>

<UL>
<LI>

To make a connection to a Unix box from a Windows box, with an ODBC
application (one that doesn't support MySQL natively), you must
first install <CODE>MyODBC</CODE> on the Windows machine.
<LI>

The user and Windows machine must have the access privileges to the
MySQL server on the Unix machine.  This is set up with the
<CODE>GRANT</CODE> command. See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.
<LI>

You must create an ODBC DSN entry as follows:


<UL>
<LI>

Open the Control Panel on the Windows machine.
<LI>

Double-click the ODBC Data Sources 32-bit icon.
<LI>

Click the tab User DSN.
<LI>

Click the button Add.
<LI>

Select MySQL in the screen Create New Data Source and click
the Finish button.
<LI>

The MySQL Driver default configuration screen is shown.
See section <A HREF="manual.html#ODBC_administrator">20.3.2  How to Fill in the Various Fields in the ODBC Administrator Program</A>.
</UL>

<LI>

Now start your application and select the ODBC driver with the DSN you
specified in the ODBC administrator.
</UL>

<P>
Notice that there are other configuration options on the screen of
MySQL (trace, don't prompt on connect, etc) that you can try if
you run into problems.

</P>



<H3><A NAME="ODBC_administrator" HREF="manual_toc.html#ODBC_administrator">20.3.2  How to Fill in the Various Fields in the ODBC Administrator Program</A></H3>

<P>
<A NAME="IDX2160"></A>

</P>
<P>
There are three possibilities for specifying the server name on
Windows:

</P>

<UL>
<LI>

Use the IP address of the server.
<LI>

Add a file <TT>`\windows\lmhosts'</TT> with the following information:


<PRE>
ip hostname
</PRE>

For example:


<PRE>
194.216.84.21 my_hostname
</PRE>

<LI>

Configure the PC to use DNS.
</UL>

<P>
An example of how to fill in the <CODE>ODBC setup</CODE>:

<PRE>
Windows DSN name:   test
Description:        This is my test database
MySQL Database:     test
Server:             194.216.84.21
User:               monty
Password:           my_password
Port:
</PRE>

<P>
The value for the <CODE>Windows DSN name</CODE> field is any name that is unique
in your Windows ODBC setup.

</P>
<P>
You don't have to specify values for the <CODE>Server</CODE>, <CODE>User</CODE>,
<CODE>Password</CODE>, or <CODE>Port</CODE> fields in the ODBC setup screen.
However, if you do, the values will be used as the defaults later when
you attempt to make a connection.  You have the option of changing the
values at that time.

</P>
<P>
If the port number is not given, the default port (3306)
is used.

</P>
<P>
If you specify the option <CODE>Read options from C:\my.cnf</CODE>, the groups
<CODE>client</CODE> and <CODE>odbc</CODE> will be read from the <TT>`C:\my.cnf'</TT> file.
You can use all options that are usable by <CODE>mysql_options()</CODE>.
See section <A HREF="manual.html#mysql_options">20.2.3.167  <CODE>mysql_options()</CODE></A>.

</P>



<H3><A NAME="MyODBC_connect_parameters" HREF="manual_toc.html#MyODBC_connect_parameters">20.3.3  Connect parameters for MyODBC</A></H3>

<P>
One can specify the following parameters for <CODE>MyODBC</CODE> on
the <CODE>[Servername]</CODE> section of an <TT>`ODBC.INI'</TT> file or
through  the <CODE>InConnectionString</CODE> argument in the
<CODE>SQLDriverConnect()</CODE> call.

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Parameter</STRONG> </TD><TD> <STRONG>Default Value</STRONG> </TD><TD> <STRONG>Comment</STRONG>
</TD></TR>
<TR><TD>user </TD><TD> ODBC (on Windows) </TD><TD> The username used to connect to MySQL.
</TD></TR>
<TR><TD>server </TD><TD> localhost </TD><TD> The hostname of the MySQL server.
</TD></TR>
<TR><TD>database </TD><TD> </TD><TD> The default database.
</TD></TR>
<TR><TD>option </TD><TD> 0 </TD><TD> A integer by which you can specify how <CODE>MyODBC</CODE> should work. See below.
</TD></TR>
<TR><TD>port </TD><TD> 3306 </TD><TD> The TCP/IP port to use if <CODE>server</CODE> is not <CODE>localhost</CODE>.
</TD></TR>
<TR><TD>stmt </TD><TD> </TD><TD> A statement that will be executed when connecting to MySQL
</TD></TR>
<TR><TD>password </TD><TD> </TD><TD> The password for the <CODE>server</CODE> <CODE>user</CODE> combination.
</TD></TR>
<TR><TD>socket </TD><TD> </TD><TD> The socket or Windows pipe to connect to.
</TD></TR>
</TABLE>

<P>
The option argument is used to tell <CODE>MyODBC</CODE> that the client isn't 100%
ODBC compliant. On Windows, one normally sets the option flag by
toggling the different options on the connection screen but one can also
set this in the option argument. The following options are listed in the
same order as they appear in the <CODE>MyODBC</CODE> connect screen:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Bit</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD>1 </TD><TD> The client can't handle that <CODE>MyODBC</CODE> returns the real width of a column.
</TD></TR>
<TR><TD>2 </TD><TD> The client can't handle that MySQL returns the true value of affected rows.  If this flag is set then MySQL returns 'found rows' instead.  You must have MySQL 3.21.14 or newer to get this to work.
</TD></TR>
<TR><TD>4 </TD><TD> Make a debug log in c:\myodbc.log.  This is the same as putting <CODE>MYSQL_DEBUG=d:t:O,c::\myodbc.log</CODE> in <TT>`AUTOEXEC.BAT'</TT>
</TD></TR>
<TR><TD>8 </TD><TD> Don't set any packet limit for results and parameters.
</TD></TR>
<TR><TD>16 </TD><TD> Don't prompt for questions even if driver would like to prompt
</TD></TR>
<TR><TD>32 </TD><TD> Simulate a ODBC 1.0 driver in some context.
</TD></TR>
<TR><TD>64 </TD><TD> Ignore use of database name in 'database.table.column'.
</TD></TR>
<TR><TD>128 </TD><TD> Force use of ODBC manager cursors (experimental).
</TD></TR>
<TR><TD>256 </TD><TD> Disable the use of extended fetch (experimental).
</TD></TR>
<TR><TD>512 </TD><TD> Pad CHAR fields to full column length.
</TD></TR>
<TR><TD>1024 </TD><TD> SQLDescribeCol() will return fully qualified column names
</TD></TR>
<TR><TD>2048 </TD><TD> Use the compressed client/server protocol
</TD></TR>
<TR><TD>4096 </TD><TD> Tell server to ignore space after function name and before <CODE>'('</CODE> (needed by PowerBuilder).  This will make all function names keywords!
</TD></TR>
<TR><TD>8192 </TD><TD> Connect with named pipes to a <CODE>mysqld</CODE> server running on NT.
</TD></TR>
<TR><TD>16384 </TD><TD> Change LONGLONG columns to INT columns (some applications can't handle LONGLONG).
</TD></TR>
<TR><TD>32768 </TD><TD> Return 'user' as Table_qualifier and Table_owner from SQLTables (experimental)
</TD></TR>
<TR><TD>65536 </TD><TD> Read parameters from the <CODE>client</CODE> and <CODE>odbc</CODE> groups from <TT>`my.cnf'</TT>
</TD></TR>
<TR><TD>131072 </TD><TD> Add some extra safety checks (should not bee needed but...)
</TD></TR>
</TABLE>

<P>
If you want to have many options, you should add together their values.  For
example setting option to 12 (4+8) gives you debugging without package
limits!

</P>
<P>
The default <TT>`MYODBC.DLL'</TT> is compiled for optimal performance.  If
you want to debug <CODE>MyODBC</CODE> (for example to enable tracing),
you should instead use <TT>`MYODBCD.DLL'</TT>.  To install this file, copy
<TT>`MYODBCD.DLL'</TT> over the installed <TT>`MYODBC.DLL'</TT> file.

</P>



<H3><A NAME="ODBC_Problems" HREF="manual_toc.html#ODBC_Problems">20.3.4  How to Report Problems with MyODBC</A></H3>

<P>
<CODE>MyODBC</CODE> has been tested with Access, Admndemo.exe, C++-Builder,
Borland Builder 4, Centura Team Developer (formerly Gupta SQL/Windows),
ColdFusion (on Solaris and NT with svc pack 5), Crystal Reports,
DataJunction, Delphi, ERwin, Excel, iHTML, FileMaker Pro, FoxPro, Notes
4.5/4.6, SBSS, Perl DBD-ODBC, Paradox, Powerbuilder, Powerdesigner 32
bit, VC++, and Visual Basic.

</P>
<P>
If you know of any other applications that work with <CODE>MyODBC</CODE>, please
send mail to the <CODE>myodbc</CODE> mailing list about this!
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>
<P>
With some programs you may get an error like:
<CODE>Another user has modifies the record that you have modified</CODE>. In most
cases this can be solved by doing one of the following things:

</P>

<UL>
<LI>

Add a primary key for the table if there isn't one already.
<LI>

Add a timestamp column if there isn't one already.
<LI>

Only use double float fields. Some programs may fail when they compare
single floats.
</UL>

<P>
If these strategies don't help, you should generate a <CODE>MyODBC</CODE> trace
file and try to figure out why things go wrong.

</P>



<H3><A NAME="MyODBC_clients" HREF="manual_toc.html#MyODBC_clients">20.3.5  Programs Known to Work with MyODBC</A></H3>

<P>
Most programs should work with <CODE>MyODBC</CODE>, but for each of those
listed here, we have tested it ourselves or received confirmation from
some user that it works:

</P>
<DL COMPACT>

<DT><STRONG>Program</STRONG>
<DD>
<STRONG>Comment</STRONG>
<A NAME="IDX2161"></A>

<DT>Access
<DD>
To make Access work:

<UL>
<LI>

If you are using Access 2000, you should get and install the newest
(version 2.6 or above) Microsoft MDAC (<CODE>Microsoft Data Access
Components</CODE>) from <a HREF="http://www.microsoft.com/data/">http://www.microsoft.com/data/</a>.  This will fix
the following bug in Access: when you export data to MySQL, the
table and column names aren't specified.  Another way to around this bug
is to upgrade to MyODBC 2.50.33 and MySQL
3.23.x, which together provide a workaround for this bug!

You should also get and apply the Microsoft Jet 4.0 Service Pack 5 (SP5)
which can be found here
<a HREF="http://support.microsoft.com/support/kb/articles/Q 239/1/14.ASP">http://support.microsoft.com/support/kb/articles/Q 239/1/14.ASP</a>.
This will fix some cases where columns are marked as <CODE>#deleted#</CODE>
in Access.

Note that if you are using MySQL 3.22, you must to apply the
MDAC patch and use MyODBC 2.50.32 or 2.50.34 and above to work around
this problem.
<LI>

For all Access versions, you should enable the MyODBC option flag
<CODE>Return matching rows</CODE>. For Access 2.0, you should additionally enable
<CODE>Simulate ODBC 1.0</CODE>.
<LI>

You should have a timestamp in all tables you want to be able to update.
For maximum portability <CODE>TIMESTAMP(14)</CODE> or simple <CODE>TIMESTAMP</CODE>
is recommended instead of other <CODE>TIMESTAMP(X)</CODE> variations.
<LI>

You should have a primary key in the table. If not, new or updated rows
may show up as <CODE>#DELETED#</CODE>.
<LI>

Only use <CODE>DOUBLE</CODE> float fields. Access fails when comparing with
single floats.  The symptom usually is that new or updated rows may show
up as <CODE>#DELETED#</CODE> or that you can't find or update rows.
<LI>

If you are linking a table through MyODBC, which has <CODE>BIGINT</CODE> as
one of the column, then the results will be displayed as <CODE>#DELETED</CODE>. The
work around solution is:

<UL>
<LI>

Have one more dummy column with <CODE>TIMESTAMP</CODE> as the data type, preferably
<CODE>TIMESTAMP(14)</CODE>.
<LI>

Check the <CODE>'Change BIGINT columns to INT'</CODE> in connection options dialog in
ODBC DSN Administrator
<LI>

Delete the table link from access and re-create it.
</UL>

It still displays the previous records as <CODE>#DELETED#</CODE>, but newly
added/updated records will be displayed properly.
<LI>

If you still get the error <CODE>Another user has changed your data</CODE> after
adding a <CODE>TIMESTAMP</CODE> column, the following trick may help you:

Don't use <CODE>table</CODE> data sheet view. Create instead a form with the
fields you want, and use that <CODE>form</CODE> data sheet view.  You should
set the <CODE>DefaultValue</CODE> property for the <CODE>TIMESTAMP</CODE> column to
<CODE>NOW()</CODE>.  It may be a good idea to hide the <CODE>TIMESTAMP</CODE> column
from view so your users are not confused.
<LI>

In some cases, Access may generate illegal SQL queries that
MySQL can't understand. You can fix this by selecting
<CODE>"Query|SQLSpecific|Pass-Through"</CODE> from the Access menu.
<LI>

Access on NT will report <CODE>BLOB</CODE> columns as <CODE>OLE OBJECTS</CODE>. If
you want to have <CODE>MEMO</CODE> columns instead, you should change the
column to <CODE>TEXT</CODE> with <CODE>ALTER TABLE</CODE>.
<LI>

Access can't always handle <CODE>DATE</CODE> columns properly. If you have a problem
with these, change the columns to <CODE>DATETIME</CODE>.
<LI>

If you have in Access a column defined as <CODE>BYTE</CODE>, Access will try
to export this as <CODE>TINYINT</CODE> instead of <CODE>TINYINT UNSIGNED</CODE>.
This will give you problems if you have values &#62; 127 in the column!
</UL>

<A NAME="IDX2162"></A>
<DT>ADO
<DD>
When you are coding with the ADO API and <CODE>MyODBC</CODE> you need to put
attention in some default properties that aren't supported by the
MySQL server.  For example, using the <CODE>CursorLocation
Property</CODE> as <CODE>adUseServer</CODE> will return for the <CODE>RecordCount
Property</CODE> a result of -1. To have the right value, you need to set this
property to <CODE>adUseClient</CODE>, like is showing in the VB code here:


<PRE>
Dim myconn As New ADODB.Connection
Dim myrs As New Recordset
Dim mySQL As String
Dim myrows As Long

myconn.Open "DSN=MyODBCsample"
mySQL = "SELECT * from user"
myrs.Source = mySQL
Set myrs.ActiveConnection = myconn
myrs.CursorLocation = adUseClient
myrs.Open
myrows = myrs.RecordCount

myrs.Close
myconn.Close
</PRE>

Another workaround is to use a <CODE>SELECT COUNT(*)</CODE> statement
for a similar query to get the correct row count.

<DT>Active server pages (ASP)
<DD>
You should use the option flag <CODE>Return matching rows</CODE>.

<DT>BDE applications
<DD>
To get these to work, you should set the option flags
<CODE>Don't optimize column widths</CODE> and <CODE>Return matching rows</CODE>.

<A NAME="IDX2163"></A>
<DT>Borland Builder 4
<DD>
When you start a query you can use the property <CODE>Active</CODE> or use the
method <CODE>Open</CODE>.  Note that <CODE>Active</CODE> will start by automatically
issuing a <CODE>SELECT * FROM ...</CODE> query that may not be a good thing if
your tables are big!
<DT>ColdFusion (On Unix)
<DD>
The following information is taken from the ColdFusion documentation:

Use the following information to configure ColdFusion Server for Linux
to use the unixODBC driver with <CODE>MyODBC</CODE> for MySQL data
sources.  Allaire has verified that <CODE>MyODBC</CODE> 2.50.26
works with MySQL 3.22.27 and ColdFusion for Linux. (Any
newer version should also work.) You can download <CODE>MyODBC</CODE> at
<a HREF="http://dev.mysql.com/downloads/api-myodbc.html">http://dev.mysql.com/downloads/api-myodbc.html</a>

<A NAME="IDX2164"></A>
ColdFusion Version 4.5.1 allows you to us the ColdFusion Administrator
to add the MySQL data source. However, the driver is not
included with ColdFusion Version 4.5.1. Before the MySQL driver
will appear in the ODBC datasources drop-down list, you must build and
copy the <CODE>MyODBC</CODE> driver to
<TT>`/opt/coldfusion/lib/libmyodbc.so'</TT>.

The Contrib directory contains the program <TT>`mydsn-xxx.zip'</TT> which allows
you to build and remove the DSN registry file for the MyODBC driver
on Coldfusion applications.

<A NAME="IDX2165"></A>
<DT>DataJunction
<DD>
You have to change it to output <CODE>VARCHAR</CODE> rather than <CODE>ENUM</CODE>, as
it exports the latter in a manner that causes MySQL grief.
<A NAME="IDX2166"></A>
<DT>Excel
<DD>
Works. A few tips:

<UL>
<LI>

If you have problems with dates, try to select them as strings using the
<CODE>CONCAT()</CODE> function. For example:

<PRE>
select CONCAT(rise_time), CONCAT(set_time)
    from sunrise_sunset;
</PRE>

Values retrieved as strings this way should be correctly recognized
as time values by Excel97.

The purpose of <CODE>CONCAT()</CODE> in this example is to fool ODBC into thinking
the column is of ``string type.'' Without the <CODE>CONCAT()</CODE>, ODBC knows the
column is of time type, and Excel does not understand that.

Note that this is a bug in Excel, because it automatically converts a
string to a time. This would be great if the source was a text file, but
is plain stupid when the source is an ODBC connection that reports
exact types for each column.
</UL>

<A NAME="IDX2167"></A>
<DT>Word
<DD>
To retrieve data from MySQL to Word/Excel documents, you need to
use the <CODE>MyODBC</CODE> driver and the Add-in Microsoft Query help.

For example, create a db with a table containing 2 columns of text:


<UL>
<LI>

Insert rows using the <CODE>mysql</CODE> client command-line tool.
<LI>

Create a DSN file using the ODBC manager, for example, <TT>`my'</TT> for the db above.
<LI>

Open the Word application.
<LI>

Create a blank new documentation.
<LI>

Using the tool bar called Database, press the button insert database.
<LI>

Press the button Get Data.
<LI>

At the right hand of the screen Get Data, press the button Ms Query.
<LI>

In the Ms Query create a New Data Source using the DSN file my.
<LI>

Select the new query.
<LI>

Select the columns that you want.
<LI>

Make a filter if you want.
<LI>

Make a Sort if you want.
<LI>

Select Return Data to Microsoft Word.
<LI>

Click Finish.
<LI>

Click Insert data and select the records.
<LI>

Click OK and you see the rows in your Word document.
</UL>

<A NAME="IDX2168"></A>
<DT>odbcadmin
<DD>
Test program for ODBC.
<A NAME="IDX2169"></A>
<DT>Delphi
<DD>
You must use BDE Version 3.2 or newer.  Set the <CODE>Don't optimize column width</CODE>
option field when connecting to MySQL.

Also, here is some potentially useful Delphi code that sets up both an
ODBC entry and a BDE entry for <CODE>MyODBC</CODE> (the BDE entry requires a BDE
Alias Editor that is free at a Delphi Super Page near
you. (Thanks to Bryan Brunton <a HREF="mailto:bryan@flesherfab.com">bryan@flesherfab.com</a> for this):


<PRE>
fReg:= TRegistry.Create;
  fReg.OpenKey('\Software\ODBC\ODBC.INI\DocumentsFab', True);
  fReg.WriteString('Database', 'Documents');
  fReg.WriteString('Description', ' ');
  fReg.WriteString('Driver', 'C:\WINNT\System32\myodbc.dll');
  fReg.WriteString('Flag', '1');
  fReg.WriteString('Password', '');
  fReg.WriteString('Port', ' ');
  fReg.WriteString('Server', 'xmark');
  fReg.WriteString('User', 'winuser');
  fReg.OpenKey('\Software\ODBC\ODBC.INI\ODBC Data Sources', True);
  fReg.WriteString('DocumentsFab', 'MySQL');
  fReg.CloseKey;
  fReg.Free;

  Memo1.Lines.Add('DATABASE NAME=');
  Memo1.Lines.Add('USER NAME=');
  Memo1.Lines.Add('ODBC DSN=DocumentsFab');
  Memo1.Lines.Add('OPEN MODE=READ/WRITE');
  Memo1.Lines.Add('BATCH COUNT=200');
  Memo1.Lines.Add('LANGDRIVER=');
  Memo1.Lines.Add('MAX ROWS=-1');
  Memo1.Lines.Add('SCHEMA CACHE DIR=');
  Memo1.Lines.Add('SCHEMA CACHE SIZE=8');
  Memo1.Lines.Add('SCHEMA CACHE TIME=-1');
  Memo1.Lines.Add('SQLPASSTHRU MODE=SHARED AUTOCOMMIT');
  Memo1.Lines.Add('SQLQRYMODE=');
  Memo1.Lines.Add('ENABLE SCHEMA CACHE=FALSE');
  Memo1.Lines.Add('ENABLE BCD=FALSE');
  Memo1.Lines.Add('ROWSET SIZE=20');
  Memo1.Lines.Add('BLOBS TO CACHE=64');
  Memo1.Lines.Add('BLOB SIZE=32');

  AliasEditor.Add('DocumentsFab','MySQL',Memo1.Lines);
</PRE>

<A NAME="IDX2170"></A>
<DT>C++ Builder
<DD>
Tested with BDE Version 3.0. The only known problem is that when the table
schema changes, query fields are not updated. BDE, however, does not seem
to recognize primary keys, only the index PRIMARY, though this has not
been a problem.

<DT>Vision
<DD>
You should use the option flag <CODE>Return matching rows</CODE>.

<A NAME="IDX2171"></A>
<DT>Visual Basic
<DD>
To be able to update a table, you must define a primary key for the table.

Visual Basic with ADO can't handle big integers. This means that some queries
like <CODE>SHOW PROCESSLIST</CODE> will not work properly.  The fix is to set
the option <CODE>OPTION=16384</CODE> in the ODBC connect string or to set
the <CODE>Change BIGINT columns to INT</CODE> option in the MyODBC connect screen.
You may also want to set the <CODE>Return matching rows</CODE> option.

<DT>VisualInterDev
<DD>
If you get the error <CODE>[Microsoft][ODBC Driver Manager] Driver does
not support this parameter</CODE> the reason may be that you have a
<CODE>BIGINT</CODE> in your result.  Try setting the <CODE>Change BIGINT
columns to INT</CODE> option in the MyODBC connect screen.

<DT>Visual Objects
<DD>
You should use the option flag <CODE>Don't optimize column widths</CODE>.
</DL>



<H3><A NAME="ODBC_and_last_insert_id" HREF="manual_toc.html#ODBC_and_last_insert_id">20.3.6  How to Get the Value of an <CODE>AUTO_INCREMENT</CODE> Column in ODBC</A></H3>

<P>
<A NAME="IDX2172"></A>

</P>
<P>
A common problem is how to get the value of an automatically generated ID
from an <CODE>INSERT</CODE>. With ODBC, you can do something like this (assuming
that <CODE>auto</CODE> is an <CODE>AUTO_INCREMENT</CODE> field):

</P>

<PRE>
INSERT INTO foo (auto,text) VALUES(NULL,'text');
SELECT LAST_INSERT_ID();
</PRE>

<P>
Or, if you are just going to insert the ID into another table, you can do this:

</P>

<PRE>
INSERT INTO foo (auto,text) VALUES(NULL,'text');
INSERT INTO foo2 (id,text) VALUES(LAST_INSERT_ID(),'text');
</PRE>

<P>
See section <A HREF="manual.html#Getting_unique_ID">20.2.12.3  How to Get the Unique ID for the Last Inserted Row</A>.

</P>
<P>
For the benefit of some ODBC applications (at least Delphi and Access),
the following query can be used to find a newly inserted row:

<PRE>
SELECT * FROM tbl_name WHERE auto IS NULL;
</PRE>



<H3><A NAME="MyODBC_bug_report" HREF="manual_toc.html#MyODBC_bug_report">20.3.7  Reporting Problems with MyODBC</A></H3>

<P>
<A NAME="IDX2173"></A>
<A NAME="IDX2174"></A>
<A NAME="IDX2175"></A>

</P>
<P>
If you encounter difficulties with MyODBC, you should start by
making a log file from the ODBC manager (the log you get when requesting
logs from ODBCADMIN) and a MyODBC log.

</P>
<P>
To get a MyODBC log, you need to do the following:

</P>

<OL>
<LI>

Ensure that you are using <TT>`myodbcd.dll'</TT> and not <TT>`myodbc.dll'</TT>.
The easiest way to do this is to get <TT>`myodbcd.dll'</TT> from the MyODBC
distribution and copy it over the <TT>`myodbc.dll'</TT>, which is probably
in your <TT>`C:\windows\system32'</TT> or <TT>`C:\winnt\system32'</TT> directory.

Note that you probably want to restore the old <TT>`myodbc.dll'</TT> file when you
have finished testing, as it is a lot faster than <TT>`myodbcd.dll'</TT>.
<LI>

Select the ``Trace MyODBC'' option in the <CODE>MyODBC</CODE> connect/configure
screen.  The log will be written to the file <TT>`C:\myodbc.log'</TT>.

If the trace option is not remembered the next time you visit this screen,
it means that you are not using the <CODE>myodbcd.dll</CODE>
driver. Reread the previous step to verify that you have installed
<TT>`myodbcd.dll'</TT>.
<LI>

Start your application and try to get it to fail.
</OL>

<P>
Check the MyODBC trace file, to find out what could be wrong.
You should be able to determine what statements were issued by searching for
the string <CODE>&#62;mysql_real_query</CODE> in the <TT>`myodbc.log'</TT> file.

</P>
<P>
You should also try issuing the statements from the <CODE>mysql</CODE> client
program or from <CODE>admndemo</CODE>. This will help you determine whether the
error is in MyODBC or MySQL.

</P>
<P>
If you find out something is wrong, please only send the relevant rows
(maximum 40 rows) to the <CODE>myodbc</CODE> mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
Please never send the whole MyODBC or ODBC log file!

</P>
<P>
If you are unable to find out what's wrong, the last option is to
make an archive in <CODE>tar</CODE> or ZIP format that contains a MyODBC trace file,
the ODBC log file, and a <TT>`README'</TT> file that explains the problem.  You can send this
to <a HREF="ftp://support.mysql.com/pub/mysql/secret/">ftp://support.mysql.com/pub/mysql/secret/</a>.  Only we at
MySQL AB will have access to the files you upload, and we will
be very discreet with the data!

</P>
<P>
If you can create a program that also demonstrates the problem, please include
it in the archive as well.

</P>
<P>
If the program works with some other SQL server, you should include an ODBC log
file where you do exactly the same thing in the other SQL server.

</P>
<P>
Remember that the more information you can supply to us, the more
likely it is that we can fix the problem!

</P>



<H2><A NAME="Java" HREF="manual_toc.html#Java">20.4  MySQL Java Connectivity (JDBC)</A></H2>

<P>
<A NAME="IDX2176"></A>
<A NAME="IDX2177"></A>
<A NAME="IDX2178"></A>

</P>
<P>
There are 2 supported JDBC drivers for MySQL:

</P>

<UL>
<LI>

<CODE>MySQL Connector/J</CODE> from MySQL AB, implemented in 100% native Java.
This product was formerly known as the <CODE>mm.mysql</CODE> driver.
You can download <CODE>MySQL Connector/J</CODE> from
<a HREF="http://www.mysql.com/products/connector-j/">http://www.mysql.com/products/connector-j/</a>.
<LI>

The Resin JDBC driver, which can be found at
<a HREF="http://www.caucho.com/projects/jdbc-mysql/index.xtp">http://www.caucho.com/projects/jdbc-mysql/index.xtp</a>.
</UL>

<P>
For more information, consult any general JDBC documentation, plus each
driver's own documentation for MySQL-specific features.

</P>
<P>
Documentation for <CODE>MySQL Connector/J</CODE> is available online at the
MySQL AB Web site at <a HREF="http://dev.mysql.com/doc/">http://dev.mysql.com/doc/</a>.

</P>



<H2><A NAME="PHP" HREF="manual_toc.html#PHP">20.5  MySQL PHP API</A></H2>

<P>
<A NAME="IDX2179"></A>

</P>
<P>
PHP is a server-side, HTML-embedded scripting language that may be used to
create dynamic Web pages.  It contains support for accessing several
databases, including MySQL.  PHP may be run as a separate program
or compiled as a module for use with the Apache Web server.

</P>
<P>
The distribution and documentation are available at the PHP Web site
(<a HREF="http://www.php.net/">http://www.php.net/</a>).

</P>



<H3><A NAME="PHP_problems" HREF="manual_toc.html#PHP_problems">20.5.1  Common Problems with MySQL and PHP</A></H3>


<UL>
<LI>Error: "Maximum Execution Time Exceeded"

This is a PHP limit; go into the <TT>`php.ini'</TT> file and set the maximum
execution time up from 30 seconds to something higher, as needed.
It is also not a bad idea to double the RAM allowed per script to 16MB instead of
8MB.
<LI>Error: "Fatal error: Call to unsupported or undefined function mysql_connect() in .."

This means that your PHP version isn't compiled with MySQL support.
You can either compile a dynamic MySQL module and load it into PHP or
recompile PHP with built-in MySQL support.  This is described in
detail in the PHP manual.
<LI>Error: "undefined reference to `uncompress'"

This means that the client library is compiled with support for a compressed
client/server protocol. The fix is to add <CODE>-lz</CODE> last when linking
with <CODE>-lmysqlclient</CODE>.
</UL>



<H2><A NAME="Perl" HREF="manual_toc.html#Perl">20.6  MySQL Perl API</A></H2>

<P>
<A NAME="IDX2180"></A>
<A NAME="IDX2181"></A>
<A NAME="IDX2182"></A>
<A NAME="IDX2183"></A>

</P>

<P>
The Perl <CODE>DBI</CODE> module provides a generic interface for database access.
You can write a DBI script that works with many different database engines
without change. To use DBI, you must install the <CODE>DBI</CODE> module, as well
as a DataBase Driver (DBD) module for each type of server you want to access.
For MySQL, this driver is the <CODE>DBD::mysql</CODE> module.

</P>
<P>
Perl DBI is now the recommended Perl interface. It replaces an older
interface called <CODE>mysqlperl</CODE>, which should be considered obsolete.

</P>
<P>
Installation instructions for Perl DBI support are given in
section <A HREF="manual.html#Perl_support">2.7  Perl Installation Notes</A>.

</P>
<P>
DBI information is available at the command line, online, or in printed form:

</P>

<UL>
<LI>

Once you have the <CODE>DBI</CODE> and <CODE>DBD::mysql</CODE> modules installed, you can
get information about them at the command line with the <CODE>perldoc</CODE> command:


<PRE>
shell&#62; perldoc DBI
shell&#62; perldoc DBI::FAQ
shell&#62; perldoc DBD::mysql
</PRE>

You can also use <CODE>pod2man</CODE>, <CODE>pod2html</CODE>, and so forth to translate
this information into other formats.

<LI>

For online information about Perl DBI, visit the DBI Web site,
<a HREF="http://dbi.perl.org/">http://dbi.perl.org/</a>.

<LI>

For printed information, the official DBI book is <CITE>Programming the Perl
DBI</CITE> (Alligator Descartes and Tim Bunce, O'Reilly &#38; Associates, 2000).
Information about the book is available at the DBI Web site,
<a HREF="http://dbi.perl.org/">http://dbi.perl.org/</a>.

For information that focuses specifically on using DBI with MySQL, see
<CITE>MySQL and Perl for the Web</CITE> (Paul DuBois, New Riders, 2001). This
book's Web site is <a HREF="http://www.kitebird.com/mysql-perl/">http://www.kitebird.com/mysql-perl/</a>.

</UL>



<H2><A NAME="Cplusplus" HREF="manual_toc.html#Cplusplus">20.7  MySQL C++ API</A></H2>

<P>
<A NAME="IDX2184"></A>
<A NAME="IDX2185"></A>

</P>
<P>
<CODE>MySQL++</CODE> is the MySQL API for C++. More
information can be found at <a HREF="http://www.mysql.com/products/mysql++/">http://www.mysql.com/products/mysql++/</a>.

</P>



<H3><A NAME="Borland_C++" HREF="manual_toc.html#Borland_C++">20.7.1  Borland C++</A></H3>

<P>
<A NAME="IDX2186"></A>

</P>
<P>
You can compile the MySQL Windows source with Borland C++ 5.02.
(The Windows source includes only projects for Microsoft VC++, for
Borland C++ you have to do the project files yourself.)

</P>
<P>
One known problem with Borland C++ is that it uses a different structure
alignment than VC++.  This means that you will run into problems if you
try to use the default <CODE>libmysql.dll</CODE> libraries (that was compiled
with VC++) with Borland C++. You can do one of the following to avoid
this problem.

</P>

<UL>
<LI>

You can use the static MySQL libraries for Borland C++ that you
can find on <a HREF="http://dev.mysql.com/downloads/os-win32.html">http://dev.mysql.com/downloads/os-win32.html</a>.
<LI>

Only call <CODE>mysql_init()</CODE> with <CODE>NULL</CODE> as an argument, not a
pre-allocated <CODE>MYSQL</CODE> structure.
</UL>



<H2><A NAME="Python" HREF="manual_toc.html#Python">20.8  MySQL Python API</A></H2>

<P>
<A NAME="IDX2187"></A>

</P>
<P>
<CODE>MySQLdb</CODE> provides MySQL support for Python, compliant with the
Python DB API version 2.0. It can be found at
<a HREF="http://sourceforge.net/projects/mysql-python/">http://sourceforge.net/projects/mysql-python/</a>.

</P>



<H2><A NAME="Tcl" HREF="manual_toc.html#Tcl">20.9  MySQL Tcl API</A></H2>

<P>
<A NAME="IDX2188"></A>

</P>
<P>
<CODE>MySQLtcl</CODE> is a simple API for accessing a MySQL database server from the Tcl
programming language. It can be found at <a HREF="http://www.xdobry.de/mysqltcl/">http://www.xdobry.de/mysqltcl/</a>.

</P>


<H2><A NAME="Eiffel" HREF="manual_toc.html#Eiffel">20.10  MySQL Eiffel Wrapper</A></H2>

<P>
<A NAME="IDX2189"></A>
<A NAME="IDX2190"></A>

</P>
<P>
Eiffel MySQL is an interface to the MySQL database server using the Eiffel
programming language, written by Michael Ravits. It can be found at
<a HREF="http://efsa.sourceforge.net/archive/ravits/mysql.htm">http://efsa.sourceforge.net/archive/ravits/mysql.htm</a>.

</P>



<H1><A NAME="Error-handling" HREF="manual_toc.html#Error-handling">21  Error Handling in MySQL</A></H1>

<P>
This chapter lists the errors that MySQL can return.

</P>



<H2><A NAME="Error-returns" HREF="manual_toc.html#Error-returns">21.1  Error Returns</A></H2>

<P>
Following are error codes that may appear
when you call MySQL from any host language.

</P>
<P>
The <CODE>Name</CODE> and <CODE>Error Code</CODE> columns correspond to
definitions in the <TT>`include/mysqld_error.h'</TT> MySQL source file.

</P>
<P>
The <CODE>SQLSTATE</CODE> column corresponds to definitions
in the <TT>`include/sql_state.h'</TT> MySQL source file.

</P>
<P>
The <CODE>SQLSTATE</CODE> error code is displayed only if
you use MySQL version 4.1 and up. <CODE>SQLSTATE</CODE> codes
were added for compatibility with X/Open, ANSI, and ODBC
behavior.

</P>
<P>
A suggested text for each error code can be found
in the <TT>`share/english/errmsg.txt'</TT> error-message file.

</P>
<P>
Because updates are frequent, it is possible that
these files will contain additional error codes.

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Name</STRONG> </TD><TD> <STRONG>Error Code</STRONG> </TD><TD> <STRONG>SQLSTATE</STRONG>

</TD></TR>
<TR><TD><CODE>ER_HASHCHK</CODE> </TD><TD> <CODE>1000</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NISAMCHK</CODE> </TD><TD> <CODE>1001</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO</CODE> </TD><TD> <CODE>1002</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_YES</CODE> </TD><TD> <CODE>1003</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_CREATE_FILE</CODE> </TD><TD> <CODE>1004</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_CREATE_TABLE</CODE> </TD><TD> <CODE>1005</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_CREATE_DB</CODE> </TD><TD> <CODE>1006</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DB_CREATE_EXISTS</CODE> </TD><TD> <CODE>1007</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DB_DROP_EXISTS</CODE> </TD><TD> <CODE>1008</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DB_DROP_DELETE</CODE> </TD><TD> <CODE>1009</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DB_DROP_RMDIR</CODE> </TD><TD> <CODE>1010</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_DELETE_FILE</CODE> </TD><TD> <CODE>1011</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_FIND_SYSTEM_REC</CODE> </TD><TD> <CODE>1012</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_GET_STAT</CODE> </TD><TD> <CODE>1013</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_GET_WD</CODE> </TD><TD> <CODE>1014</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_LOCK</CODE> </TD><TD> <CODE>1015</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_OPEN_FILE</CODE> </TD><TD> <CODE>1016</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FILE_NOT_FOUND</CODE> </TD><TD> <CODE>1017</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_READ_DIR</CODE> </TD><TD> <CODE>1018</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_SET_WD</CODE> </TD><TD> <CODE>1019</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CHECKREAD</CODE> </TD><TD> <CODE>1020</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DISK_FULL</CODE> </TD><TD> <CODE>1021</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_KEY</CODE> </TD><TD> <CODE>1022</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_ON_CLOSE</CODE> </TD><TD> <CODE>1023</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_ON_READ</CODE> </TD><TD> <CODE>1024</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_ON_RENAME</CODE> </TD><TD> <CODE>1025</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_ON_WRITE</CODE> </TD><TD> <CODE>1026</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FILE_USED</CODE> </TD><TD> <CODE>1027</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FILSORT_ABORT</CODE> </TD><TD> <CODE>1028</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FORM_NOT_FOUND</CODE> </TD><TD> <CODE>1029</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_GET_ERRNO</CODE> </TD><TD> <CODE>1030</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ILLEGAL_HA</CODE> </TD><TD> <CODE>1031</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_KEY_NOT_FOUND</CODE> </TD><TD> <CODE>1032</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NOT_FORM_FILE</CODE> </TD><TD> <CODE>1033</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NOT_KEYFILE</CODE> </TD><TD> <CODE>1034</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_OLD_KEYFILE</CODE> </TD><TD> <CODE>1035</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_OPEN_AS_READONLY</CODE> </TD><TD> <CODE>1036</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_OUTOFMEMORY</CODE> </TD><TD> <CODE>1037</CODE> </TD><TD> <CODE>HY001</CODE>
</TD></TR>
<TR><TD><CODE>ER_OUT_OF_SORTMEMORY</CODE> </TD><TD> <CODE>1038</CODE> </TD><TD> <CODE>HY001</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNEXPECTED_EOF</CODE> </TD><TD> <CODE>1039</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CON_COUNT_ERROR</CODE> </TD><TD> <CODE>1040</CODE> </TD><TD> <CODE>08004</CODE>
</TD></TR>
<TR><TD><CODE>ER_OUT_OF_RESOURCES</CODE> </TD><TD> <CODE>1041</CODE> </TD><TD> <CODE>08004</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_HOST_ERROR</CODE> </TD><TD> <CODE>1042</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_HANDSHAKE_ERROR</CODE> </TD><TD> <CODE>1043</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_DBACCESS_DENIED_ERROR</CODE> </TD><TD> <CODE>1044</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ACCESS_DENIED_ERROR</CODE> </TD><TD> <CODE>1045</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_DB_ERROR</CODE> </TD><TD> <CODE>1046</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_COM_ERROR</CODE> </TD><TD> <CODE>1047</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_NULL_ERROR</CODE> </TD><TD> <CODE>1048</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_DB_ERROR</CODE> </TD><TD> <CODE>1049</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_EXISTS_ERROR</CODE> </TD><TD> <CODE>1050</CODE> </TD><TD> <CODE>42S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_TABLE_ERROR</CODE> </TD><TD> <CODE>1051</CODE> </TD><TD> <CODE>42S02</CODE>
</TD></TR>
<TR><TD><CODE>ER_NON_UNIQ_ERROR</CODE> </TD><TD> <CODE>1052</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SERVER_SHUTDOWN</CODE> </TD><TD> <CODE>1053</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_FIELD_ERROR</CODE> </TD><TD> <CODE>1054</CODE> </TD><TD> <CODE>42S22</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_FIELD_WITH_GROUP</CODE> </TD><TD> <CODE>1055</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_GROUP_FIELD</CODE> </TD><TD> <CODE>1056</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_SUM_SELECT</CODE> </TD><TD> <CODE>1057</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_VALUE_COUNT</CODE> </TD><TD> <CODE>1058</CODE> </TD><TD> <CODE>21S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_LONG_IDENT</CODE> </TD><TD> <CODE>1059</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_FIELDNAME</CODE> </TD><TD> <CODE>1060</CODE> </TD><TD> <CODE>42S21</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_KEYNAME</CODE> </TD><TD> <CODE>1061</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_ENTRY</CODE> </TD><TD> <CODE>1062</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_FIELD_SPEC</CODE> </TD><TD> <CODE>1063</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_PARSE_ERROR</CODE> </TD><TD> <CODE>1064</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_EMPTY_QUERY</CODE> </TD><TD> <CODE>1065</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NONUNIQ_TABLE</CODE> </TD><TD> <CODE>1066</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_INVALID_DEFAULT</CODE> </TD><TD> <CODE>1067</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MULTIPLE_PRI_KEY</CODE> </TD><TD> <CODE>1068</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_KEYS</CODE> </TD><TD> <CODE>1069</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_KEY_PARTS</CODE> </TD><TD> <CODE>1070</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_LONG_KEY</CODE> </TD><TD> <CODE>1071</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_KEY_COLUMN_DOES_NOT_EXITS</CODE> </TD><TD> <CODE>1072</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BLOB_USED_AS_KEY</CODE> </TD><TD> <CODE>1073</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_BIG_FIELDLENGTH</CODE> </TD><TD> <CODE>1074</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_AUTO_KEY</CODE> </TD><TD> <CODE>1075</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_READY</CODE> </TD><TD> <CODE>1076</CODE> </TD><TD> <CODE>00000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NORMAL_SHUTDOWN</CODE> </TD><TD> <CODE>1077</CODE> </TD><TD> <CODE>00000</CODE>
</TD></TR>
<TR><TD><CODE>ER_GOT_SIGNAL</CODE> </TD><TD> <CODE>1078</CODE> </TD><TD> <CODE>00000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SHUTDOWN_COMPLETE</CODE> </TD><TD> <CODE>1079</CODE> </TD><TD> <CODE>00000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FORCING_CLOSE</CODE> </TD><TD> <CODE>1080</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_IPSOCK_ERROR</CODE> </TD><TD> <CODE>1081</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_SUCH_INDEX</CODE> </TD><TD> <CODE>1082</CODE> </TD><TD> <CODE>42S12</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_FIELD_TERMINATORS</CODE> </TD><TD> <CODE>1083</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BLOBS_AND_NO_TERMINATED</CODE> </TD><TD> <CODE>1084</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TEXTFILE_NOT_READABLE</CODE> </TD><TD> <CODE>1085</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FILE_EXISTS_ERROR</CODE> </TD><TD> <CODE>1086</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOAD_INFO</CODE> </TD><TD> <CODE>1087</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ALTER_INFO</CODE> </TD><TD> <CODE>1088</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_SUB_KEY</CODE> </TD><TD> <CODE>1089</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_REMOVE_ALL_FIELDS</CODE> </TD><TD> <CODE>1090</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_DROP_FIELD_OR_KEY</CODE> </TD><TD> <CODE>1091</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_INSERT_INFO</CODE> </TD><TD> <CODE>1092</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UPDATE_TABLE_USED</CODE> </TD><TD> <CODE>1093</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_SUCH_THREAD</CODE> </TD><TD> <CODE>1094</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_KILL_DENIED_ERROR</CODE> </TD><TD> <CODE>1095</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_TABLES_USED</CODE> </TD><TD> <CODE>1096</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_BIG_SET</CODE> </TD><TD> <CODE>1097</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_UNIQUE_LOGFILE</CODE> </TD><TD> <CODE>1098</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_NOT_LOCKED_FOR_WRITE</CODE> </TD><TD> <CODE>1099</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_NOT_LOCKED</CODE> </TD><TD> <CODE>1100</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BLOB_CANT_HAVE_DEFAULT</CODE> </TD><TD> <CODE>1101</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_DB_NAME</CODE> </TD><TD> <CODE>1102</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_TABLE_NAME</CODE> </TD><TD> <CODE>1103</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_BIG_SELECT</CODE> </TD><TD> <CODE>1104</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_ERROR</CODE> </TD><TD> <CODE>1105</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_PROCEDURE</CODE> </TD><TD> <CODE>1106</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_PARAMCOUNT_TO_PROCEDURE</CODE> </TD><TD> <CODE>1107</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_PARAMETERS_TO_PROCEDURE</CODE> </TD><TD> <CODE>1108</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_TABLE</CODE> </TD><TD> <CODE>1109</CODE> </TD><TD> <CODE>42S02</CODE>
</TD></TR>
<TR><TD><CODE>ER_FIELD_SPECIFIED_TWICE</CODE> </TD><TD> <CODE>1110</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_INVALID_GROUP_FUNC_USE</CODE> </TD><TD> <CODE>1111</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNSUPPORTED_EXTENSION</CODE> </TD><TD> <CODE>1112</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_MUST_HAVE_COLUMNS</CODE> </TD><TD> <CODE>1113</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_RECORD_FILE_FULL</CODE> </TD><TD> <CODE>1114</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_CHARACTER_SET</CODE> </TD><TD> <CODE>1115</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_TABLES</CODE> </TD><TD> <CODE>1116</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_FIELDS</CODE> </TD><TD> <CODE>1117</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_BIG_ROWSIZE</CODE> </TD><TD> <CODE>1118</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_STACK_OVERRUN</CODE> </TD><TD> <CODE>1119</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_OUTER_JOIN</CODE> </TD><TD> <CODE>1120</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NULL_COLUMN_IN_INDEX</CODE> </TD><TD> <CODE>1121</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_FIND_UDF</CODE> </TD><TD> <CODE>1122</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_INITIALIZE_UDF</CODE> </TD><TD> <CODE>1123</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UDF_NO_PATHS</CODE> </TD><TD> <CODE>1124</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UDF_EXISTS</CODE> </TD><TD> <CODE>1125</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_OPEN_LIBRARY</CODE> </TD><TD> <CODE>1126</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_FIND_DL_ENTRY</CODE> </TD><TD> <CODE>1127</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FUNCTION_NOT_DEFINED</CODE> </TD><TD> <CODE>1128</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_HOST_IS_BLOCKED</CODE> </TD><TD> <CODE>1129</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_HOST_NOT_PRIVILEGED</CODE> </TD><TD> <CODE>1130</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_PASSWORD_ANONYMOUS_USER</CODE> </TD><TD> <CODE>1131</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_PASSWORD_NOT_ALLOWED</CODE> </TD><TD> <CODE>1132</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_PASSWORD_NO_MATCH</CODE> </TD><TD> <CODE>1133</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UPDATE_INFO</CODE> </TD><TD> <CODE>1134</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_CREATE_THREAD</CODE> </TD><TD> <CODE>1135</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_VALUE_COUNT_ON_ROW</CODE> </TD><TD> <CODE>1136</CODE> </TD><TD> <CODE>21S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_REOPEN_TABLE</CODE> </TD><TD> <CODE>1137</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_INVALID_USE_OF_NULL</CODE> </TD><TD> <CODE>1138</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_REGEXP_ERROR</CODE> </TD><TD> <CODE>1139</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MIX_OF_GROUP_FUNC_AND_FIELDS</CODE> </TD><TD> <CODE>1140</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NONEXISTING_GRANT</CODE> </TD><TD> <CODE>1141</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLEACCESS_DENIED_ERROR</CODE> </TD><TD> <CODE>1142</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_COLUMNACCESS_DENIED_ERROR</CODE>@tab <CODE>1143</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ILLEGAL_GRANT_FOR_TABLE</CODE> </TD><TD> <CODE>1144</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_GRANT_WRONG_HOST_OR_USER</CODE> </TD><TD> <CODE>1145</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_SUCH_TABLE</CODE> </TD><TD> <CODE>1146</CODE> </TD><TD> <CODE>42S02</CODE>
</TD></TR>
<TR><TD><CODE>ER_NONEXISTING_TABLE_GRANT</CODE> </TD><TD> <CODE>1147</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NOT_ALLOWED_COMMAND</CODE> </TD><TD> <CODE>1148</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SYNTAX_ERROR</CODE> </TD><TD> <CODE>1149</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DELAYED_CANT_CHANGE_LOCK</CODE> </TD><TD> <CODE>1150</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_DELAYED_THREADS</CODE> </TD><TD> <CODE>1151</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ABORTING_CONNECTION</CODE> </TD><TD> <CODE>1152</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_PACKET_TOO_LARGE</CODE> </TD><TD> <CODE>1153</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_READ_ERROR_FROM_PIPE</CODE> </TD><TD> <CODE>1154</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_FCNTL_ERROR</CODE> </TD><TD> <CODE>1155</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_PACKETS_OUT_OF_ORDER</CODE> </TD><TD> <CODE>1156</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_UNCOMPRESS_ERROR</CODE> </TD><TD> <CODE>1157</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_READ_ERROR</CODE> </TD><TD> <CODE>1158</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_READ_INTERRUPTED</CODE> </TD><TD> <CODE>1159</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_ERROR_ON_WRITE</CODE> </TD><TD> <CODE>1160</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_NET_WRITE_INTERRUPTED</CODE> </TD><TD> <CODE>1161</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_LONG_STRING</CODE> </TD><TD> <CODE>1162</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_CANT_HANDLE_BLOB</CODE> </TD><TD> <CODE>1163</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_CANT_HANDLE_AUTO_INCREMENT</CODE> </TD><TD> <CODE>1164</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DELAYED_INSERT_TABLE_LOCKED</CODE> </TD><TD> <CODE>1165</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_COLUMN_NAME</CODE> </TD><TD> <CODE>1166</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_KEY_COLUMN</CODE> </TD><TD> <CODE>1167</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_MRG_TABLE</CODE> </TD><TD> <CODE>1168</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_UNIQUE</CODE> </TD><TD> <CODE>1169</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BLOB_KEY_WITHOUT_LENGTH</CODE> </TD><TD> <CODE>1170</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_PRIMARY_CANT_HAVE_NULL</CODE> </TD><TD> <CODE>1171</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_ROWS</CODE> </TD><TD> <CODE>1172</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_REQUIRES_PRIMARY_KEY</CODE> </TD><TD> <CODE>1173</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_RAID_COMPILED</CODE> </TD><TD> <CODE>1174</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UPDATE_WITHOUT_KEY_IN_SAFE_MODE</CODE> </TD><TD> <CODE>1175</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_KEY_DOES_NOT_EXITS</CODE> </TD><TD> <CODE>1176</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CHECK_NO_SUCH_TABLE</CODE> </TD><TD> <CODE>1177</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CHECK_NOT_IMPLEMENTED</CODE> </TD><TD> <CODE>1178</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_DO_THIS_DURING_AN_TRANSACTION</CODE> </TD><TD> <CODE>1179</CODE> </TD><TD> <CODE>25000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_DURING_COMMIT</CODE> </TD><TD> <CODE>1180</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_DURING_ROLLBACK</CODE> </TD><TD> <CODE>1181</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_DURING_FLUSH_LOGS</CODE> </TD><TD> <CODE>1182</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_DURING_CHECKPOINT</CODE> </TD><TD> <CODE>1183</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NEW_ABORTING_CONNECTION</CODE> </TD><TD> <CODE>1184</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUMP_NOT_IMPLEMENTED</CODE> </TD><TD> <CODE>1185</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_FLUSH_MASTER_BINLOG_CLOSED</CODE> </TD><TD> <CODE>1186</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_INDEX_REBUILD</CODE> </TD><TD> <CODE>1187</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MASTER</CODE> </TD><TD> <CODE>1188</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MASTER_NET_READ</CODE> </TD><TD> <CODE>1189</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_MASTER_NET_WRITE</CODE> </TD><TD> <CODE>1190</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_FT_MATCHING_KEY_NOT_FOUND</CODE> </TD><TD> <CODE>1191</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOCK_OR_ACTIVE_TRANSACTION</CODE> </TD><TD> <CODE>1192</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_SYSTEM_VARIABLE</CODE> </TD><TD> <CODE>1193</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CRASHED_ON_USAGE</CODE> </TD><TD> <CODE>1194</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CRASHED_ON_REPAIR</CODE> </TD><TD> <CODE>1195</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARNING_NOT_COMPLETE_ROLLBACK</CODE> </TD><TD> <CODE>1196</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TRANS_CACHE_FULL</CODE> </TD><TD> <CODE>1197</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_MUST_STOP</CODE> </TD><TD> <CODE>1198</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_NOT_RUNNING</CODE> </TD><TD> <CODE>1199</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_SLAVE</CODE> </TD><TD> <CODE>1200</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MASTER_INFO</CODE> </TD><TD> <CODE>1201</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_THREAD</CODE> </TD><TD> <CODE>1202</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_MANY_USER_CONNECTIONS</CODE> </TD><TD> <CODE>1203</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SET_CONSTANTS_ONLY</CODE> </TD><TD> <CODE>1204</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOCK_WAIT_TIMEOUT</CODE> </TD><TD> <CODE>1205</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOCK_TABLE_FULL</CODE> </TD><TD> <CODE>1206</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_READ_ONLY_TRANSACTION</CODE> </TD><TD> <CODE>1207</CODE> </TD><TD> <CODE>25000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DROP_DB_WITH_READ_LOCK</CODE> </TD><TD> <CODE>1208</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CREATE_DB_WITH_READ_LOCK</CODE> </TD><TD> <CODE>1209</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_ARGUMENTS</CODE> </TD><TD> <CODE>1210</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_PERMISSION_TO_CREATE_USER</CODE> </TD><TD> <CODE>1211</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNION_TABLES_IN_DIFFERENT_DIR</CODE> </TD><TD> <CODE>1212</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOCK_DEADLOCK</CODE> </TD><TD> <CODE>1213</CODE> </TD><TD> <CODE>40001</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLE_CANT_HANDLE_FULLTEXT</CODE> </TD><TD> <CODE>1214</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANNOT_ADD_FOREIGN</CODE> </TD><TD> <CODE>1215</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_REFERENCED_ROW</CODE> </TD><TD> <CODE>1216</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ROW_IS_REFERENCED</CODE> </TD><TD> <CODE>1217</CODE> </TD><TD> <CODE>23000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CONNECT_TO_MASTER</CODE> </TD><TD> <CODE>1218</CODE> </TD><TD> <CODE>08S01</CODE>
</TD></TR>
<TR><TD><CODE>ER_QUERY_ON_MASTER</CODE> </TD><TD> <CODE>1219</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ERROR_WHEN_EXECUTING_COMMAND</CODE> </TD><TD> <CODE>1220</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_USAGE</CODE> </TD><TD> <CODE>1221</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_NUMBER_OF_COLUMNS_IN_SELECT</CODE> </TD><TD> <CODE>1222</CODE> </TD><TD> <CODE>21000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_UPDATE_WITH_READLOCK</CODE> </TD><TD> <CODE>1223</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MIXING_NOT_ALLOWED</CODE> </TD><TD> <CODE>1224</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DUP_ARGUMENT</CODE> </TD><TD> <CODE>1225</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_USER_LIMIT_REACHED</CODE> </TD><TD> <CODE>1226</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SPECIFIC_ACCESS_DENIED_ERROR</CODE> </TD><TD> <CODE>1227</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_LOCAL_VARIABLE</CODE> </TD><TD> <CODE>1228</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_GLOBAL_VARIABLE</CODE> </TD><TD> <CODE>1229</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NO_DEFAULT</CODE> </TD><TD> <CODE>1230</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_VALUE_FOR_VAR</CODE> </TD><TD> <CODE>1231</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_TYPE_FOR_VAR</CODE> </TD><TD> <CODE>1232</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_VAR_CANT_BE_READ</CODE> </TD><TD> <CODE>1233</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_USE_OPTION_HERE</CODE> </TD><TD> <CODE>1234</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NOT_SUPPORTED_YET</CODE> </TD><TD> <CODE>1235</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MASTER_FATAL_ERROR_READING_BINLOG</CODE> </TD><TD> <CODE>1236</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_IGNORED_TABLE</CODE> </TD><TD> <CODE>1237</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WRONG_FK_DEF</CODE> </TD><TD> <CODE>1238</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_KEY_REF_DO_NOT_MATCH_TABLE_REF</CODE> </TD><TD> <CODE>1239</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CARDINALITY_COL</CODE> </TD><TD> <CODE>1240</CODE> </TD><TD> <CODE>21000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SUBSELECT_NO_1_ROW</CODE> </TD><TD> <CODE>1241</CODE> </TD><TD> <CODE>21000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_STMT_HANDLER</CODE> </TD><TD> <CODE>1242</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CORRUPT_HELP_DB</CODE> </TD><TD> <CODE>1243</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CYCLIC_REFERENCE</CODE> </TD><TD> <CODE>1244</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_AUTO_CONVERT</CODE> </TD><TD> <CODE>1245</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ILLEGAL_REFERENCE</CODE> </TD><TD> <CODE>1246</CODE> </TD><TD> <CODE>42S22</CODE>
</TD></TR>
<TR><TD><CODE>ER_DERIVED_MUST_HAVE_ALIAS</CODE> </TD><TD> <CODE>1247</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SELECT_REDUCED</CODE> </TD><TD> <CODE>1248</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TABLENAME_NOT_ALLOWED_HERE</CODE> </TD><TD> <CODE>1249</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_NOT_SUPPORTED_AUTH_MODE</CODE> </TD><TD> <CODE>1250</CODE> </TD><TD> <CODE>08004</CODE>
</TD></TR>
<TR><TD><CODE>ER_SPATIAL_CANT_HAVE_NULL</CODE> </TD><TD> <CODE>1251</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_COLLATION_CHARSET_MISMATCH</CODE> </TD><TD> <CODE>1252</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_WAS_RUNNING</CODE> </TD><TD> <CODE>1253</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_WAS_NOT_RUNNING</CODE> </TD><TD> <CODE>1254</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_TOO_BIG_FOR_UNCOMPRESS</CODE> </TD><TD> <CODE>1255</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ZLIB_Z_MEM_ERROR</CODE> </TD><TD> <CODE>1256</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ZLIB_Z_BUF_ERROR</CODE> </TD><TD> <CODE>1257</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_ZLIB_Z_DATA_ERROR</CODE> </TD><TD> <CODE>1258</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CUT_VALUE_GROUP_CONCAT</CODE> </TD><TD> <CODE>1259</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_TOO_FEW_RECORDS</CODE> </TD><TD> <CODE>1260</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_TOO_MANY_RECORDS</CODE> </TD><TD> <CODE>1261</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_NULL_TO_NOTNULL</CODE> </TD><TD> <CODE>1262</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_DATA_OUT_OF_RANGE</CODE> </TD><TD> <CODE>1263</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_DATA_TRUNCATED</CODE> </TD><TD> <CODE>1264</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_USING_OTHER_HANDLER</CODE> </TD><TD> <CODE>1265</CODE> </TD><TD> <CODE>01000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_AGGREGATE_COLLATIONS</CODE> </TD><TD> <CODE>1266</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_DROP_USER</CODE> </TD><TD> <CODE>1267</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_REVOKE_GRANTS</CODE> </TD><TD> <CODE>1268</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_AGGREGATE_3COLLATIONS</CODE> </TD><TD> <CODE>1269</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_CANT_AGGREGATE_NCOLLATIONS</CODE> </TD><TD> <CODE>1270</CODE> </TD><TD> <CODE>42000</CODE>
</TD></TR>
<TR><TD><CODE>ER_VARIABLE_IS_NOT_STRUCT</CODE> </TD><TD> <CODE>1271</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNKNOWN_COLLATION</CODE> </TD><TD> <CODE>1272</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SLAVE_IGNORED_SSL_PARAMS</CODE> </TD><TD> <CODE>1273</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_SERVER_IS_IN_SECURE_AUTH_MODE</CODE> </TD><TD> <CODE>1274</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_WARN_FIELD_RESOLVED</CODE> </TD><TD> <CODE>1275</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_BAD_SLAVE_UNTIL_COND</CODE> </TD><TD> <CODE>1276</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_MISSING_SKIP_SLAVE</CODE> </TD><TD> <CODE>1277</CODE> </TD><TD> <CODE>HY000</CODE>
</TD></TR>
<TR><TD><CODE>ER_UNTIL_COND_IGNORED</CODE> </TD><TD> <CODE>1278</CODE> </TD><TD> <CODE>HY000</CODE>

</TD></TR>
</TABLE>



<H2><A NAME="Error-messages" HREF="manual_toc.html#Error-messages">21.2  Error Messages</A></H2>

<P>
Following are error messages that may appear
when you call MySQL from any host language.

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Error Code</STRONG> </TD><TD> <STRONG>Error Message</STRONG>

</TD></TR>
<TR><TD><CODE>1000</CODE> </TD><TD> hashchk
</TD></TR>
<TR><TD><CODE>1001</CODE> </TD><TD> isamchk
</TD></TR>
<TR><TD><CODE>1002</CODE> </TD><TD> NO
</TD></TR>
<TR><TD><CODE>1003</CODE> </TD><TD> YES
</TD></TR>
<TR><TD><CODE>1004</CODE> </TD><TD> Can't create file '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1005</CODE> </TD><TD> Can't create table '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1006</CODE> </TD><TD> Can't create database '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1007</CODE> </TD><TD> Can't create database '%s'; database exists
</TD></TR>
<TR><TD><CODE>1008</CODE> </TD><TD> Can't drop database '%s'; database doesn't exist
</TD></TR>
<TR><TD><CODE>1009</CODE> </TD><TD> Error dropping database (can't delete '%s', errno: %d)
</TD></TR>
<TR><TD><CODE>1010</CODE> </TD><TD> Error dropping database (can't rmdir '%s', errno: %d)
</TD></TR>
<TR><TD><CODE>1011</CODE> </TD><TD> Error on delete of '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1012</CODE> </TD><TD> Can't read record in system table
</TD></TR>
<TR><TD><CODE>1013</CODE> </TD><TD> Can't get status of '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1014</CODE> </TD><TD> Can't get working directory (errno: %d)
</TD></TR>
<TR><TD><CODE>1015</CODE> </TD><TD> Can't lock file (errno: %d)
</TD></TR>
<TR><TD><CODE>1016</CODE> </TD><TD> Can't open file: '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1017</CODE> </TD><TD> Can't find file: '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1018</CODE> </TD><TD> Can't read dir of '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1019</CODE> </TD><TD> Can't change dir to '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1020</CODE> </TD><TD> Record has changed since last read in table '%s'
</TD></TR>
<TR><TD><CODE>1021</CODE> </TD><TD> Disk full (%s). Waiting for someone to free some space...
</TD></TR>
<TR><TD><CODE>1022</CODE> </TD><TD> Can't write, duplicate key in table '%s'
</TD></TR>
<TR><TD><CODE>1023</CODE> </TD><TD> Error on close of '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1024</CODE> </TD><TD> Error reading file '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1025</CODE> </TD><TD> Error on rename of '%s' to '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1026</CODE> </TD><TD> Error writing file '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1027</CODE> </TD><TD> '%s' is locked against change
</TD></TR>
<TR><TD><CODE>1028</CODE> </TD><TD> Sort aborted
</TD></TR>
<TR><TD><CODE>1029</CODE> </TD><TD> View '%s' doesn't exist for '%s'
</TD></TR>
<TR><TD><CODE>1030</CODE> </TD><TD> Got error %d from storage engine
</TD></TR>
<TR><TD><CODE>1031</CODE> </TD><TD> Table storage engine for '%s' doesn't have this option
</TD></TR>
<TR><TD><CODE>1032</CODE> </TD><TD> Can't find record in '%s'
</TD></TR>
<TR><TD><CODE>1033</CODE> </TD><TD> Incorrect information in file: '%s'
</TD></TR>
<TR><TD><CODE>1034</CODE> </TD><TD> Incorrect key file for table: '%s'; try to repair it
</TD></TR>
<TR><TD><CODE>1035</CODE> </TD><TD> Old key file for table '%s'; repair it!
</TD></TR>
<TR><TD><CODE>1036</CODE> </TD><TD> Table '%s' is read only
</TD></TR>
<TR><TD><CODE>1037</CODE> </TD><TD> Out of memory. Restart daemon and try again (needed %d bytes)
</TD></TR>
<TR><TD><CODE>1038</CODE> </TD><TD> Out of sort memory. Increase daemon sort buffer size
</TD></TR>
<TR><TD><CODE>1039</CODE> </TD><TD> Unexpected eof found when reading file '%s' (errno: %d)
</TD></TR>
<TR><TD><CODE>1040</CODE> </TD><TD> Too many connections
</TD></TR>
<TR><TD><CODE>1041</CODE> </TD><TD> Out of memory;  Check if mysqld or some other process uses all available memory. If not you may have to use 'ulimit' to allow mysqld to use more memory or you can add more swap space
</TD></TR>
<TR><TD><CODE>1042</CODE> </TD><TD> Can't get hostname for your address
</TD></TR>
<TR><TD><CODE>1043</CODE> </TD><TD> Bad handshake
</TD></TR>
<TR><TD><CODE>1044</CODE> </TD><TD> Access denied for user: '%s'@'%s' to database '%s'
</TD></TR>
<TR><TD><CODE>1045</CODE> </TD><TD> Access denied for user: '%s'@'%s' (Using password: %s)
</TD></TR>
<TR><TD><CODE>1046</CODE> </TD><TD> No Database Selected
</TD></TR>
<TR><TD><CODE>1047</CODE> </TD><TD> Unknown command
</TD></TR>
<TR><TD><CODE>1048</CODE> </TD><TD> Column '%s' cannot be null
</TD></TR>
<TR><TD><CODE>1049</CODE> </TD><TD> Unknown database '%s'
</TD></TR>
<TR><TD><CODE>1050</CODE> </TD><TD> Table '%s' already exists
</TD></TR>
<TR><TD><CODE>1051</CODE> </TD><TD> Unknown table '%s'
</TD></TR>
<TR><TD><CODE>1052</CODE> </TD><TD> Column: '%s' in %s is ambiguous
</TD></TR>
<TR><TD><CODE>1053</CODE> </TD><TD> Server shutdown in progress
</TD></TR>
<TR><TD><CODE>1054</CODE> </TD><TD> Unknown column '%s' in '%s'
</TD></TR>
<TR><TD><CODE>1055</CODE> </TD><TD> '%s' isn't in GROUP BY
</TD></TR>
<TR><TD><CODE>1056</CODE> </TD><TD> Can't group on '%s'
</TD></TR>
<TR><TD><CODE>1057</CODE> </TD><TD> Statement has sum functions and columns in same statement
</TD></TR>
<TR><TD><CODE>1058</CODE> </TD><TD> Column count doesn't match value count
</TD></TR>
<TR><TD><CODE>1059</CODE> </TD><TD> Identifier name '%s' is too long
</TD></TR>
<TR><TD><CODE>1060</CODE> </TD><TD> Duplicate column name '%s'
</TD></TR>
<TR><TD><CODE>1061</CODE> </TD><TD> Duplicate key name '%s'
</TD></TR>
<TR><TD><CODE>1062</CODE> </TD><TD> Duplicate entry '%s' for key %d
</TD></TR>
<TR><TD><CODE>1063</CODE> </TD><TD> Incorrect column specifier for column '%s'
</TD></TR>
<TR><TD><CODE>1064</CODE> </TD><TD> %s near '%s' at line %d
</TD></TR>
<TR><TD><CODE>1065</CODE> </TD><TD> Query was empty
</TD></TR>
<TR><TD><CODE>1066</CODE> </TD><TD> Not unique table/alias: '%s'
</TD></TR>
<TR><TD><CODE>1067</CODE> </TD><TD> Invalid default value for '%s'
</TD></TR>
<TR><TD><CODE>1068</CODE> </TD><TD> Multiple primary key defined
</TD></TR>
<TR><TD><CODE>1069</CODE> </TD><TD> Too many keys specified. Max %d keys allowed
</TD></TR>
<TR><TD><CODE>1070</CODE> </TD><TD> Too many key parts specified. Max %d parts allowed
</TD></TR>
<TR><TD><CODE>1071</CODE> </TD><TD> Specified key was too long. Max key length is %d
</TD></TR>
<TR><TD><CODE>1072</CODE> </TD><TD> Key column '%s' doesn't exist in table
</TD></TR>
<TR><TD><CODE>1073</CODE> </TD><TD> BLOB column '%s' can't be used in key specification with the used table type
</TD></TR>
<TR><TD><CODE>1074</CODE> </TD><TD> Too big column length for column '%s' (max = %d). Use BLOB instead
</TD></TR>
<TR><TD><CODE>1075</CODE> </TD><TD> Incorrect table definition; There can only be one auto column and it must be defined as a key
</TD></TR>
<TR><TD><CODE>1076</CODE> </TD><TD> %s: ready for connections. Version: '%s'  socket: '%s'  port: %d
</TD></TR>
<TR><TD><CODE>1077</CODE> </TD><TD> %s: Normal shutdown
</TD></TR>
<TR><TD><CODE>1078</CODE> </TD><TD> %s: Got signal %d. Aborting!
</TD></TR>
<TR><TD><CODE>1079</CODE> </TD><TD> %s: Shutdown Complete
</TD></TR>
<TR><TD><CODE>1080</CODE> </TD><TD> %s: Forcing close of thread %ld  user: '%s'
</TD></TR>
<TR><TD><CODE>1081</CODE> </TD><TD> Can't create IP socket
</TD></TR>
<TR><TD><CODE>1082</CODE> </TD><TD> Table '%s' has no index like the one used in CREATE INDEX. Recreate the table
</TD></TR>
<TR><TD><CODE>1083</CODE> </TD><TD> Field separator argument is not what is expected. Check the manual
</TD></TR>
<TR><TD><CODE>1084</CODE> </TD><TD> You can't use fixed rowlength with BLOBs. Please use 'fields terminated by'
</TD></TR>
<TR><TD><CODE>1085</CODE> </TD><TD> The file '%s' must be in the database directory or be readable by all
</TD></TR>
<TR><TD><CODE>1086</CODE> </TD><TD> File '%s' already exists
</TD></TR>
<TR><TD><CODE>1087</CODE> </TD><TD> Records: %ld  Deleted: %ld  Skipped: %ld  Warnings: %ld
</TD></TR>
<TR><TD><CODE>1088</CODE> </TD><TD> Records: %ld  Duplicates: %ld
</TD></TR>
<TR><TD><CODE>1089</CODE> </TD><TD> Incorrect sub part key. The used key part isn't a string, the used length is longer than the key part or the storage engine doesn't support unique sub keys
</TD></TR>
<TR><TD><CODE>1090</CODE> </TD><TD> You can't delete all columns with ALTER TABLE. Use DROP TABLE instead
</TD></TR>
<TR><TD><CODE>1091</CODE> </TD><TD> Can't DROP '%s'. Check that column/key exists
</TD></TR>
<TR><TD><CODE>1092</CODE> </TD><TD> Records: %ld  Duplicates: %ld  Warnings: %ld
</TD></TR>
<TR><TD><CODE>1093</CODE> </TD><TD> You can't specify target table '%s' for update in FROM clause
</TD></TR>
<TR><TD><CODE>1094</CODE> </TD><TD> Unknown thread id: %lu
</TD></TR>
<TR><TD><CODE>1095</CODE> </TD><TD> You are not owner of thread %lu
</TD></TR>
<TR><TD><CODE>1096</CODE> </TD><TD> No tables used
</TD></TR>
<TR><TD><CODE>1097</CODE> </TD><TD> Too many strings for column %s and SET
</TD></TR>
<TR><TD><CODE>1098</CODE> </TD><TD> Can't generate a unique log-filename %s.(1-999)
</TD></TR>
<TR><TD><CODE>1099</CODE> </TD><TD> Table '%s' was locked with a READ lock and can't be updated
</TD></TR>
<TR><TD><CODE>1100</CODE> </TD><TD> Table '%s' was not locked with LOCK TABLES
</TD></TR>
<TR><TD><CODE>1101</CODE> </TD><TD> BLOB/TEXT column '%s' can't have a default value
</TD></TR>
<TR><TD><CODE>1102</CODE> </TD><TD> Incorrect database name '%s'
</TD></TR>
<TR><TD><CODE>1103</CODE> </TD><TD> Incorrect table name '%s'
</TD></TR>
<TR><TD><CODE>1104</CODE> </TD><TD> The SELECT would examine more rows than MAX_JOIN_SIZE. Check your WHERE and use SET SQL_BIG_SELECTS=1 or SET SQL_MAX_JOIN_SIZE=# if the SELECT is ok
</TD></TR>
<TR><TD><CODE>1105</CODE> </TD><TD> Unknown error
</TD></TR>
<TR><TD><CODE>1106</CODE> </TD><TD> Unknown procedure '%s'
</TD></TR>
<TR><TD><CODE>1107</CODE> </TD><TD> Incorrect parameter count to procedure '%s'
</TD></TR>
<TR><TD><CODE>1108</CODE> </TD><TD> Incorrect parameters to procedure '%s'
</TD></TR>
<TR><TD><CODE>1109</CODE> </TD><TD> Unknown table '%s' in %s
</TD></TR>
<TR><TD><CODE>1110</CODE> </TD><TD> Column '%s' specified twice
</TD></TR>
<TR><TD><CODE>1111</CODE> </TD><TD> Invalid use of group function
</TD></TR>
<TR><TD><CODE>1112</CODE> </TD><TD> Table '%s' uses an extension that doesn't exist in this MySQL version
</TD></TR>
<TR><TD><CODE>1113</CODE> </TD><TD> A table must have at least 1 column
</TD></TR>
<TR><TD><CODE>1114</CODE> </TD><TD> The table '%s' is full
</TD></TR>
<TR><TD><CODE>1115</CODE> </TD><TD> Unknown character set: '%s'
</TD></TR>
<TR><TD><CODE>1116</CODE> </TD><TD> Too many tables. MySQL can only use %d tables in a join
</TD></TR>
<TR><TD><CODE>1117</CODE> </TD><TD> Too many columns
</TD></TR>
<TR><TD><CODE>1118</CODE> </TD><TD> Too big row size. The maximum row size for the used table type, not counting BLOBs, is %ld. You have to change some fields to TEXT or BLOBs
</TD></TR>
<TR><TD><CODE>1119</CODE> </TD><TD> Thread stack overrun:  Used: %ld of a %ld stack.  Use 'mysqld -O thread_stack=#' to specify a bigger stack if needed
</TD></TR>
<TR><TD><CODE>1120</CODE> </TD><TD> Cross dependency found in OUTER JOIN.  Examine your ON conditions
</TD></TR>
<TR><TD><CODE>1121</CODE> </TD><TD> Column '%s' is used with UNIQUE or INDEX but is not defined as NOT NULL
</TD></TR>
<TR><TD><CODE>1122</CODE> </TD><TD> Can't load function '%s'
</TD></TR>
<TR><TD><CODE>1123</CODE> </TD><TD> Can't initialize function '%s'; %s
</TD></TR>
<TR><TD><CODE>1124</CODE> </TD><TD> No paths allowed for shared library
</TD></TR>
<TR><TD><CODE>1125</CODE> </TD><TD> Function '%s' already exist
</TD></TR>
<TR><TD><CODE>1126</CODE> </TD><TD> Can't open shared library '%s' (errno: %d %s)
</TD></TR>
<TR><TD><CODE>1127</CODE> </TD><TD> Can't find function '%s' in library'
</TD></TR>
<TR><TD><CODE>1128</CODE> </TD><TD> Function '%s' is not defined
</TD></TR>
<TR><TD><CODE>1129</CODE> </TD><TD> Host '%s' is blocked because of many connection errors.  Unblock with 'mysqladmin flush-hosts'
</TD></TR>
<TR><TD><CODE>1130</CODE> </TD><TD> Host '%s' is not allowed to connect to this MySQL server
</TD></TR>
<TR><TD><CODE>1131</CODE> </TD><TD> You are using MySQL as an anonymous users and anonymous users are not allowed to change passwords
</TD></TR>
<TR><TD><CODE>1132</CODE> </TD><TD> You must have privileges to update tables in the <CODE>mysql</CODE> database to be able to change passwords for others
</TD></TR>
<TR><TD><CODE>1133</CODE> </TD><TD> Can't find any matching row in the user table
</TD></TR>
<TR><TD><CODE>1134</CODE> </TD><TD> Rows matched: %ld  Changed: %ld  Warnings: %ld
</TD></TR>
<TR><TD><CODE>1135</CODE> </TD><TD> Can't create a new thread (errno %d). If you are not out of available memory, you can consult the manual for a possible OS-dependent bug
</TD></TR>
<TR><TD><CODE>1136</CODE> </TD><TD> Column count doesn't match value count at row %ld
</TD></TR>
<TR><TD><CODE>1137</CODE> </TD><TD> Can't reopen table: '%s'
</TD></TR>
<TR><TD><CODE>1138</CODE> </TD><TD> Invalid use of NULL value
</TD></TR>
<TR><TD><CODE>1139</CODE> </TD><TD> Got error '%s' from regexp
</TD></TR>
<TR><TD><CODE>1140</CODE> </TD><TD> Mixing of GROUP columns (MIN(),MAX(),COUNT()...) with no GROUP columns is illegal if there is no GROUP BY clause
</TD></TR>
<TR><TD><CODE>1141</CODE> </TD><TD> There is no such grant defined for user '%s' on host '%s'
</TD></TR>
<TR><TD><CODE>1142</CODE> </TD><TD> %s command denied to user: '%s'@'%s' for table '%s'
</TD></TR>
<TR><TD><CODE>1143</CODE> </TD><TD> %s command denied to user: '%s'@'%s' for column '%s' in table '%s'
</TD></TR>
<TR><TD><CODE>1144</CODE> </TD><TD> Illegal GRANT/REVOKE command. Please consult the manual which privileges can be used
</TD></TR>
<TR><TD><CODE>1145</CODE> </TD><TD> The host or user argument to GRANT is too long
</TD></TR>
<TR><TD><CODE>1146</CODE> </TD><TD> Table '%s.%s' doesn't exist
</TD></TR>
<TR><TD><CODE>1147</CODE> </TD><TD> There is no such grant defined for user '%s' on host '%s' on table '%s'
</TD></TR>
<TR><TD><CODE>1148</CODE> </TD><TD> The used command is not allowed with this MySQL version
</TD></TR>
<TR><TD><CODE>1149</CODE> </TD><TD> You have an error in your SQL syntax.  Check the manual that corresponds to your MySQL server version for the right syntax to use
</TD></TR>
<TR><TD><CODE>1150</CODE> </TD><TD> Delayed insert thread couldn't get requested lock for table %s
</TD></TR>
<TR><TD><CODE>1151</CODE> </TD><TD> Too many delayed threads in use
</TD></TR>
<TR><TD><CODE>1152</CODE> </TD><TD> Aborted connection %ld to db: '%s' user: '%s' (%s)
</TD></TR>
<TR><TD><CODE>1153</CODE> </TD><TD> Got a packet bigger than 'max_allowed_packet'
</TD></TR>
<TR><TD><CODE>1154</CODE> </TD><TD> Got a read error from the connection pipe
</TD></TR>
<TR><TD><CODE>1155</CODE> </TD><TD> Got an error from fcntl()
</TD></TR>
<TR><TD><CODE>1156</CODE> </TD><TD> Got packets out of order
</TD></TR>
<TR><TD><CODE>1157</CODE> </TD><TD> Couldn't uncompress communication packet
</TD></TR>
<TR><TD><CODE>1158</CODE> </TD><TD> Got an error reading communication packets
</TD></TR>
<TR><TD><CODE>1159</CODE> </TD><TD> Got timeout reading communication packets
</TD></TR>
<TR><TD><CODE>1160</CODE> </TD><TD> Got an error writing communication packets
</TD></TR>
<TR><TD><CODE>1161</CODE> </TD><TD> Got timeout writing communication packets
</TD></TR>
<TR><TD><CODE>1162</CODE> </TD><TD> Result string is longer than max_allowed_packet
</TD></TR>
<TR><TD><CODE>1163</CODE> </TD><TD> The used table type doesn't support BLOB/TEXT columns
</TD></TR>
<TR><TD><CODE>1164</CODE> </TD><TD> The used table type doesn't support AUTO_INCREMENT columns
</TD></TR>
<TR><TD><CODE>1165</CODE> </TD><TD> INSERT DELAYED can't be used with table '%s' because it is locked with LOCK TABLES
</TD></TR>
<TR><TD><CODE>1166</CODE> </TD><TD> Incorrect column name '%s'
</TD></TR>
<TR><TD><CODE>1167</CODE> </TD><TD> The used storage engine can't index column '%s'
</TD></TR>
<TR><TD><CODE>1168</CODE> </TD><TD> All tables in the MERGE table are not identically defined
</TD></TR>
<TR><TD><CODE>1169</CODE> </TD><TD> Can't write, because of unique constraint, to table '%s'
</TD></TR>
<TR><TD><CODE>1170</CODE> </TD><TD> BLOB/TEXT column '%s' used in key specification without a key length
</TD></TR>
<TR><TD><CODE>1171</CODE> </TD><TD> All parts of a PRIMARY KEY must be NOT NULL;  If you need NULL in a key, use UNIQUE instead
</TD></TR>
<TR><TD><CODE>1172</CODE> </TD><TD> Result consisted of more than one row
</TD></TR>
<TR><TD><CODE>1173</CODE> </TD><TD> This table type requires a primary key
</TD></TR>
<TR><TD><CODE>1174</CODE> </TD><TD> This version of MySQL is not compiled with RAID support
</TD></TR>
<TR><TD><CODE>1175</CODE> </TD><TD> You are using safe update mode and you tried to update a table without a WHERE that uses a KEY column
</TD></TR>
<TR><TD><CODE>1176</CODE> </TD><TD> Key '%s' doesn't exist in table '%s'
</TD></TR>
<TR><TD><CODE>1177</CODE> </TD><TD> Can't open table
</TD></TR>
<TR><TD><CODE>1178</CODE> </TD><TD> The storage engine for the table doesn't support %s
</TD></TR>
<TR><TD><CODE>1179</CODE> </TD><TD> You are not allowed to execute this command in a transaction
</TD></TR>
<TR><TD><CODE>1180</CODE> </TD><TD> Got error %d during COMMIT
</TD></TR>
<TR><TD><CODE>1181</CODE> </TD><TD> Got error %d during ROLLBACK
</TD></TR>
<TR><TD><CODE>1182</CODE> </TD><TD> Got error %d during FLUSH_LOGS
</TD></TR>
<TR><TD><CODE>1183</CODE> </TD><TD> Got error %d during CHECKPOINT
</TD></TR>
<TR><TD><CODE>1184</CODE> </TD><TD> Aborted connection %ld to db: '%s' user: '%s' host: `%s' (%s)
</TD></TR>
<TR><TD><CODE>1185</CODE> </TD><TD> The storage engine for the table does not support binary table dump
</TD></TR>
<TR><TD><CODE>1186</CODE> </TD><TD> Binlog closed, cannot RESET MASTER
</TD></TR>
<TR><TD><CODE>1187</CODE> </TD><TD> Failed rebuilding the index of  dumped table '%s'
</TD></TR>
<TR><TD><CODE>1188</CODE> </TD><TD> Error from master: '%s'
</TD></TR>
<TR><TD><CODE>1189</CODE> </TD><TD> Net error reading from master
</TD></TR>
<TR><TD><CODE>1190</CODE> </TD><TD> Net error writing to master
</TD></TR>
<TR><TD><CODE>1191</CODE> </TD><TD> Can't find FULLTEXT index matching the column list
</TD></TR>
<TR><TD><CODE>1192</CODE> </TD><TD> Can't execute the given command because you have active locked tables or an active transaction
</TD></TR>
<TR><TD><CODE>1193</CODE> </TD><TD> Unknown system variable '%s'
</TD></TR>
<TR><TD><CODE>1194</CODE> </TD><TD> Table '%s' is marked as crashed and should be repaired
</TD></TR>
<TR><TD><CODE>1195</CODE> </TD><TD> Table '%s' is marked as crashed and last (automatic?) repair failed
</TD></TR>
<TR><TD><CODE>1196</CODE> </TD><TD> Some non-transactional changed tables couldn't be rolled back
</TD></TR>
<TR><TD><CODE>1197</CODE> </TD><TD> Multi-statement transaction required more than 'max_binlog_cache_size' bytes of storage. Increase this mysqld variable and try again
</TD></TR>
<TR><TD><CODE>1198</CODE> </TD><TD> This operation cannot be performed with a running slave, run STOP SLAVE first
</TD></TR>
<TR><TD><CODE>1199</CODE> </TD><TD> This operation requires a running slave, configure slave and do START SLAVE
</TD></TR>
<TR><TD><CODE>1200</CODE> </TD><TD> The server is not configured as slave, fix in config file or with CHANGE MASTER TO
</TD></TR>
<TR><TD><CODE>1201</CODE> </TD><TD> Could not initialize master info structure, more error messages can be found in the MySQL error log
</TD></TR>
<TR><TD><CODE>1202</CODE> </TD><TD> Could not create slave thread, check system resources
</TD></TR>
<TR><TD><CODE>1203</CODE> </TD><TD> User %s has already more than 'max_user_connections' active connections
</TD></TR>
<TR><TD><CODE>1204</CODE> </TD><TD> You may only use constant expressions with SET
</TD></TR>
<TR><TD><CODE>1205</CODE> </TD><TD> Lock wait timeout exceeded; Try restarting transaction
</TD></TR>
<TR><TD><CODE>1206</CODE> </TD><TD> The total number of locks exceeds the lock table size
</TD></TR>
<TR><TD><CODE>1207</CODE> </TD><TD> Update locks cannot be acquired during a READ UNCOMMITTED transaction
</TD></TR>
<TR><TD><CODE>1208</CODE> </TD><TD> DROP DATABASE not allowed while thread is holding global read lock
</TD></TR>
<TR><TD><CODE>1209</CODE> </TD><TD> CREATE DATABASE not allowed while thread is holding global read lock
</TD></TR>
<TR><TD><CODE>1210</CODE> </TD><TD> Wrong arguments to %s
</TD></TR>
<TR><TD><CODE>1211</CODE> </TD><TD> '%s'@'%s' is not allowed to create new users
</TD></TR>
<TR><TD><CODE>1212</CODE> </TD><TD> Incorrect table definition; all MERGE tables must be in the same database
</TD></TR>
<TR><TD><CODE>1213</CODE> </TD><TD> Deadlock found when trying to get lock; Try restarting transaction
</TD></TR>
<TR><TD><CODE>1214</CODE> </TD><TD> The used table type doesn't support FULLTEXT indexes
</TD></TR>
<TR><TD><CODE>1215</CODE> </TD><TD> Cannot add foreign key constraint
</TD></TR>
<TR><TD><CODE>1216</CODE> </TD><TD> Cannot add or update a child row: a foreign key constraint fails
</TD></TR>
<TR><TD><CODE>1217</CODE> </TD><TD> Cannot delete or update a parent row: a foreign key constraint fails
</TD></TR>
<TR><TD><CODE>1218</CODE> </TD><TD> Error connecting to master: %s
</TD></TR>
<TR><TD><CODE>1219</CODE> </TD><TD> Error running query on master: %s
</TD></TR>
<TR><TD><CODE>1220</CODE> </TD><TD> Error when executing command %s: %s
</TD></TR>
<TR><TD><CODE>1221</CODE> </TD><TD> Wrong usage of %s and %s
</TD></TR>
<TR><TD><CODE>1222</CODE> </TD><TD> The used SELECT statements have a different number of columns
</TD></TR>
<TR><TD><CODE>1223</CODE> </TD><TD> Can't execute the query because you have a conflicting read lock
</TD></TR>
<TR><TD><CODE>1224</CODE> </TD><TD> Mixing of transactional and non-transactional tables is disabled
</TD></TR>
<TR><TD><CODE>1225</CODE> </TD><TD> Option '%s' used twice in statement
</TD></TR>
<TR><TD><CODE>1226</CODE> </TD><TD> User '%s' has exceeded the '%s' resource (current value: %ld)
</TD></TR>
<TR><TD><CODE>1227</CODE> </TD><TD> Access denied. You need the %s privilege for this operation
</TD></TR>
<TR><TD><CODE>1228</CODE> </TD><TD> Variable '%s' is a LOCAL variable and can't be used with SET GLOBAL
</TD></TR>
<TR><TD><CODE>1229</CODE> </TD><TD> Variable '%s' is a GLOBAL variable and should be set with SET GLOBAL
</TD></TR>
<TR><TD><CODE>1230</CODE> </TD><TD> Variable '%s' doesn't have a default value
</TD></TR>
<TR><TD><CODE>1231</CODE> </TD><TD> Variable '%s' can't be set to the value of '%s'
</TD></TR>
<TR><TD><CODE>1232</CODE> </TD><TD> Wrong argument type to variable '%s'
</TD></TR>
<TR><TD><CODE>1233</CODE> </TD><TD> Variable '%s' can only be set, not read
</TD></TR>
<TR><TD><CODE>1234</CODE> </TD><TD> Wrong usage/placement of '%s'
</TD></TR>
<TR><TD><CODE>1235</CODE> </TD><TD> This version of MySQL doesn't yet support '%s'
</TD></TR>
<TR><TD><CODE>1236</CODE> </TD><TD> Got fatal error %d: '%s' from master when reading data from binary log
</TD></TR>
<TR><TD><CODE>1237</CODE> </TD><TD> Slave SQL thread ignored the query because of replicate-*-table rules
</TD></TR>
<TR><TD><CODE>1238</CODE> </TD><TD> Wrong foreign key definition for '%s': %s
</TD></TR>
<TR><TD><CODE>1239</CODE> </TD><TD> Key reference and table reference doesn't match
</TD></TR>
<TR><TD><CODE>1240</CODE> </TD><TD> Operand should contain %d column(s)
</TD></TR>
<TR><TD><CODE>1241</CODE> </TD><TD> Subquery returns more than 1 row
</TD></TR>
<TR><TD><CODE>1242</CODE> </TD><TD> Unknown prepared statement handler (%ld) given to %s
</TD></TR>
<TR><TD><CODE>1243</CODE> </TD><TD> Help database is corrupt or does not exist
</TD></TR>
<TR><TD><CODE>1244</CODE> </TD><TD> Cyclic reference on subqueries
</TD></TR>
<TR><TD><CODE>1245</CODE> </TD><TD> Converting column '%s' from %s to %s
</TD></TR>
<TR><TD><CODE>1246</CODE> </TD><TD> Reference '%s' not supported (%s)
</TD></TR>
<TR><TD><CODE>1247</CODE> </TD><TD> Every derived table must have it's own alias
</TD></TR>
<TR><TD><CODE>1248</CODE> </TD><TD> Select %u was reduced during optimisation
</TD></TR>
<TR><TD><CODE>1249</CODE> </TD><TD> Table '%s' from one of SELECT's can not be used  in %s
</TD></TR>
<TR><TD><CODE>1250</CODE> </TD><TD> Client does not support authentication protocol requested by server; consider upgrading MySQL client
</TD></TR>
<TR><TD><CODE>1251</CODE> </TD><TD> All parts of a SPATIAL KEY must be NOT NULL
</TD></TR>
<TR><TD><CODE>1252</CODE> </TD><TD> COLLATION '%s' is not valid for CHARACTER SET '%s'
</TD></TR>
<TR><TD><CODE>1253</CODE> </TD><TD> Slave is already running
</TD></TR>
<TR><TD><CODE>1254</CODE> </TD><TD> Slave has already been stopped
</TD></TR>
<TR><TD><CODE>1255</CODE> </TD><TD> Too big size of uncompressed data. The maximum size is %d. (probably, length of uncompressed data was corrupted)
</TD></TR>
<TR><TD><CODE>1256</CODE> </TD><TD> ZLIB: Not enough memory available for zlib
</TD></TR>
<TR><TD><CODE>1257</CODE> </TD><TD> ZLIB: Not enough room in the output buffer for zlib (probably, length of uncompressed data was corrupted)
</TD></TR>
<TR><TD><CODE>1258</CODE> </TD><TD> ZLIB: Input data was corrupted for zlib
</TD></TR>
<TR><TD><CODE>1259</CODE> </TD><TD> %d line(s) was(were) cut by group_concat()
</TD></TR>
<TR><TD><CODE>1260</CODE> </TD><TD> Row %ld doesn't contain data for all columns
</TD></TR>
<TR><TD><CODE>1261</CODE> </TD><TD> Row %ld was truncated; It contained more data than there where input columns
</TD></TR>
<TR><TD><CODE>1262</CODE> </TD><TD> Data truncated, NULL supplied to NOT NULL column '%s' at row %ld
</TD></TR>
<TR><TD><CODE>1263</CODE> </TD><TD> Data truncated, out of range for column '%s' at row %ld
</TD></TR>
<TR><TD><CODE>1264</CODE> </TD><TD> Data truncated for column '%s' at row %ld
</TD></TR>
<TR><TD><CODE>1265</CODE> </TD><TD> Using storage engine %s for table '%s'
</TD></TR>
<TR><TD><CODE>1266</CODE> </TD><TD> Illegal mix of collations (%s,%s) and (%s,%s) for operation '%s'
</TD></TR>
<TR><TD><CODE>1267</CODE> </TD><TD> Can't drop one or more of the requested users
</TD></TR>
<TR><TD><CODE>1268</CODE> </TD><TD> Can't revoke all privileges, grant for one or more of the requested users
</TD></TR>
<TR><TD><CODE>1269</CODE> </TD><TD> Illegal mix of collations (%s,%s), (%s,%s), (%s,%s) for operation '%s'
</TD></TR>
<TR><TD><CODE>1270</CODE> </TD><TD> Illegal mix of collations for operation '%s'
</TD></TR>
<TR><TD><CODE>1271</CODE> </TD><TD> Variable '%s' is not a variable component (Can't be used as XXXX.variable_name)
</TD></TR>
<TR><TD><CODE>1272</CODE> </TD><TD> Unknown collation: '%s'
</TD></TR>
<TR><TD><CODE>1273</CODE> </TD><TD> SSL parameters in CHANGE MASTER are ignored because this MySQL slave was compiled without SSL support. They can be used later when MySQL slave with SSL will be started.
</TD></TR>
<TR><TD><CODE>1274</CODE> </TD><TD> Server is running in --secure-auth mode, but '%s@%s' has a password in the old format; please change the password to the new format
</TD></TR>
<TR><TD><CODE>1275</CODE> </TD><TD> Field or reference '%s%s%s%s%s' of SELECT #%d was resolved in SELECT #%d
</TD></TR>
<TR><TD><CODE>1276</CODE> </TD><TD> Wrong parameter or combination of parameters for START SLAVE UNTIL
</TD></TR>
<TR><TD><CODE>1277</CODE> </TD><TD> It is recommended to use --skip-slave-start when doing step-by-step replication with START SLAVE UNTIL. Otherwise you will get problems if you get an unexpected slave's mysqld restart
</TD></TR>
<TR><TD><CODE>1278</CODE> </TD><TD> SQL thread is not to be started so UNTIL options are ignored
</TD></TR>
<TR><TD><CODE>1279</CODE> </TD><TD> Incorrect index name '%s'
</TD></TR>
<TR><TD><CODE>1280</CODE> </TD><TD> Incorrect catalog name '%s'
</TD></TR>
<TR><TD><CODE>1281</CODE> </TD><TD> Query cache failed to set size %lu, new query cache size is %lu
</TD></TR>
<TR><TD><CODE>1282</CODE> </TD><TD> Column '%s' cannot be part of FULLTEXT index
</TD></TR>
<TR><TD><CODE>1283</CODE> </TD><TD> Unknown key cache '%s'
</TD></TR>
<TR><TD><CODE>1284</CODE> </TD><TD> MySQL is started in --skip-name-resolve mode. You need to restart it without this switch for this grant to work
</TD></TR>
<TR><TD><CODE>1285</CODE> </TD><TD> Unknown table engine '%s'
</TD></TR>
<TR><TD><CODE>1286</CODE> </TD><TD> '%s' is deprecated. Use '%s' instead.
</TD></TR>
<TR><TD><CODE>1287</CODE> </TD><TD> The target table %s of the %s is not updatable.
</TD></TR>
<TR><TD><CODE>1288</CODE> </TD><TD> The '%s' feature was disabled. You need MySQL built with '%s' define to have it working
</TD></TR>
<TR><TD><CODE>1289</CODE> </TD><TD> MySQL is started in --skip-grant-tables mode. You can't use this command
</TD></TR>
<TR><TD><CODE>1290</CODE> </TD><TD> Can't create a %s from within another stored routine
</TD></TR>
<TR><TD><CODE>1291</CODE> </TD><TD> %s %s already exists
</TD></TR>
<TR><TD><CODE>1292</CODE> </TD><TD> %s %s does not exist
</TD></TR>
<TR><TD><CODE>1293</CODE> </TD><TD> Failed to DROP %s %s
</TD></TR>
<TR><TD><CODE>1294</CODE> </TD><TD> Failed to CREATE %s %s
</TD></TR>
<TR><TD><CODE>1295</CODE> </TD><TD> %s with no matching label: %s
</TD></TR>
<TR><TD><CODE>1296</CODE> </TD><TD> Redefining label %s
</TD></TR>
<TR><TD><CODE>1297</CODE> </TD><TD> End-label %s without match
</TD></TR>
<TR><TD><CODE>1298</CODE> </TD><TD> Referring to uninitialized variable %s
</TD></TR>
<TR><TD><CODE>1299</CODE> </TD><TD> SELECT in a stored procedure must have INTO
</TD></TR>
<TR><TD><CODE>1300</CODE> </TD><TD> RETURN is only allowed in a FUNCTION
</TD></TR>
<TR><TD><CODE>1301</CODE> </TD><TD> Statements like SELECT, INSERT, UPDATE (and others) are not allowed in a FUNCTION
</TD></TR>
<TR><TD><CODE>1302</CODE> </TD><TD> The update log is deprecated and replaced by the binary log. SET SQL_LOG_UPDATE has been ignored.
</TD></TR>
<TR><TD><CODE>1303</CODE> </TD><TD> The update log is deprecated and replaced by the binary log. SET SQL_LOG_UPDATE has been translated to SET SQL_LOG_BIN.
</TD></TR>
<TR><TD><CODE>1304</CODE> </TD><TD> Query execution was interrupted
</TD></TR>
<TR><TD><CODE>1305</CODE> </TD><TD> Wrong number of arguments for %s %s, expected %u, got %u
</TD></TR>
<TR><TD><CODE>1306</CODE> </TD><TD> Undefined CONDITION: %s
</TD></TR>
<TR><TD><CODE>1307</CODE> </TD><TD> No RETURN found in FUNCTION %s
</TD></TR>
<TR><TD><CODE>1308</CODE> </TD><TD> FUNCTION %s ended without RETURN
</TD></TR>
<TR><TD><CODE>1309</CODE> </TD><TD> Cursor statement must be a SELECT
</TD></TR>
<TR><TD><CODE>1310</CODE> </TD><TD> Cursor SELECT must not have INTO
</TD></TR>
<TR><TD><CODE>1311</CODE> </TD><TD> Undefined CURSOR: %s
</TD></TR>
<TR><TD><CODE>1312</CODE> </TD><TD> Cursor is already open
</TD></TR>
<TR><TD><CODE>1313</CODE> </TD><TD> Cursor is not open
</TD></TR>
<TR><TD><CODE>1314</CODE> </TD><TD> Undeclared variable: %s
</TD></TR>
<TR><TD><CODE>1315</CODE> </TD><TD> Wrong number of FETCH variables
</TD></TR>
<TR><TD><CODE>1316</CODE> </TD><TD> No data to FETCH
</TD></TR>
<TR><TD><CODE>1317</CODE> </TD><TD> Duplicate parameter: %s
</TD></TR>
<TR><TD><CODE>1318</CODE> </TD><TD> Duplicate variable: %s
</TD></TR>
<TR><TD><CODE>1319</CODE> </TD><TD> Duplicate condition: %s
</TD></TR>
<TR><TD><CODE>1320</CODE> </TD><TD> Duplicate cursor: %s
</TD></TR>
<TR><TD><CODE>1321</CODE> </TD><TD> Failed to ALTER %s %s
</TD></TR>
<TR><TD><CODE>1322</CODE> </TD><TD> Subselect value not supported

</TD></TR>
</TABLE>



<H1><A NAME="Extending_MySQL" HREF="manual_toc.html#Extending_MySQL">22  Extending MySQL</A></H1>



<H2><A NAME="MySQL_internals" HREF="manual_toc.html#MySQL_internals">22.1  MySQL Internals</A></H2>

<P>
<A NAME="IDX2191"></A>
<A NAME="IDX2192"></A>

</P>
<P>
This chapter describes a lot of things that you need to know when
working on the MySQL code. If you plan to contribute to MySQL
development, want to have access to the bleeding-edge in-between
versions code, or just want to keep track of development, follow the
instructions in section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.
If you are interested in MySQL internals, you should also subscribe
to our <CODE>internals</CODE> mailing list. This list is relatively low
traffic. For details on how to subscribe, please see
section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
All developers at MySQL AB are on the <CODE>internals</CODE> list and we
help other people who are working on the MySQL code. Feel free to
use this list both to ask questions about the code and to send
patches that you would like to contribute to the MySQL project!

</P>



<H3><A NAME="MySQL_threads" HREF="manual_toc.html#MySQL_threads">22.1.1  MySQL Threads</A></H3>

<P>
The MySQL server creates the following threads:

</P>

<UL>

<LI>

The TCP/IP connection thread handles all connection requests and
creates a new dedicated thread to handle the authentication and
SQL query processing for each connection.

<LI>

On Windows NT there is a named pipe handler thread that does the same work as
the TCP/IP connection thread on named pipe connect requests.

<LI>

The signal thread handles all signals.  This thread also normally handles
alarms and calls <CODE>process_alarm()</CODE> to force timeouts on connections
that have been idle too long.

<LI>

If <CODE>mysqld</CODE> is compiled with <CODE>-DUSE_ALARM_THREAD</CODE>, a dedicated
thread that handles alarms is created.  This is only used on some systems where
there are problems with <CODE>sigwait()</CODE> or if you want to use the
<CODE>thr_alarm()</CODE> code in your application without a dedicated signal
handling thread.

<LI>

If one uses the <CODE>--flush_time=#</CODE> option, a dedicated thread is created
to flush all tables at the given interval.

<LI>

Every connection has its own thread.

<LI>

Every different table on which one uses <CODE>INSERT DELAYED</CODE> gets its
own thread.

<LI>

If you use <CODE>--master-host</CODE>, a slave replication thread will be
started to read and apply updates from the master.
</UL>

<P>
<CODE>mysqladmin processlist</CODE> only shows the connection, <CODE>INSERT DELAYED</CODE>,
and replication threads.

</P>



<H3><A NAME="MySQL_test_suite" HREF="manual_toc.html#MySQL_test_suite">22.1.2  MySQL Test Suite</A></H3>

<P>
<A NAME="IDX2193"></A>
<A NAME="IDX2194"></A>

</P>
<P>
Until recently, our main full-coverage test suite was based on proprietary
customer data and for that reason has not been publicly available. The only
publicly available part of our testing process consisted of the <CODE>crash-me</CODE>
test, a Perl DBI/DBD benchmark found in the <CODE>sql-bench</CODE> directory, and
miscellaneous tests located in <CODE>tests</CODE> directory. The lack of a
standardized publicly available test suite has made it difficult for our users,
as well developers, to do regression tests on the MySQL code. To address
this problem, we have created a new test system that is included in
Unix source distributions and binary distributions starting with Version
3.23.29.  The tests can be run under Unix, or on Windows in the Cygwin
environment if the server has been compiled under Cygwin. They cannot be
run in a native Windows environment currently.

</P>
<P>
The current set of test cases doesn't test everything in MySQL, but it
should catch most obvious bugs in the SQL processing code, OS/library
issues, and is quite thorough in testing replication.  Our eventual goal
is to have the tests cover 100% of the code.  We welcome contributions
to our test suite.  You may especially want to contribute tests that
examine the functionality critical to your system, because this will ensure
that all future MySQL releases will work well with your
applications.

</P>



<H4><A NAME="running_mysqltest" HREF="manual_toc.html#running_mysqltest">22.1.2.1  Running the MySQL Test Suite</A></H4>

<P>
The test system consist of a test language interpreter
(<CODE>mysqltest</CODE>), a shell script to run all
tests(<CODE>mysql-test-run</CODE>), the actual test cases written in a special
test language, and their expected results.  To run the test suite on
your system after a build, type <CODE>make test</CODE> or
<CODE>mysql-test/mysql-test-run</CODE> from the source root.  If you have
installed a binary distribution, <CODE>cd</CODE> to the install root
(eg. <CODE>/usr/local/mysql</CODE>), and do <CODE>scripts/mysql-test-run</CODE>.
All tests should succeed.  If not, you should try to find out why and
report the problem if this is a bug in MySQL.
See section <A HREF="manual.html#Reporting_mysqltest_bugs">22.1.2.3  Reporting Bugs in the MySQL Test Suite</A>.

</P>
<P>
If you have a copy of <CODE>mysqld</CODE> running on the machine where you want to
run the test suite you do not have to stop it, as long as it is not using
ports <CODE>9306</CODE> and <CODE>9307</CODE>.  If one of those ports is taken, you should
edit <CODE>mysql-test-run</CODE> and change the values of the master and/or slave
port to one that is available.

</P>
<P>
You can run one individual test case with
<CODE>mysql-test/mysql-test-run test_name</CODE>.

</P>
<P>
If one test fails, you should test running <CODE>mysql-test-run</CODE> with
the <CODE>--force</CODE> option to check whether any other tests fail.

</P>



<H4><A NAME="extending_mysqltest" HREF="manual_toc.html#extending_mysqltest">22.1.2.2  Extending the MySQL Test Suite</A></H4>

<P>
You can use the <CODE>mysqltest</CODE> language to write your own test cases.
Unfortunately, we have not yet written full documentation for it.
You can, however, look at our current test cases and use
them as an example.  The following points should help you get started:

</P>

<UL>
<LI>

The tests are located in <CODE>mysql-test/t/*.test</CODE>

<LI>

A test case consists of <CODE>;</CODE> terminated statements and is similar to the
input of <CODE>mysql</CODE> command-line client.  A statement by default is a query
to be sent to MySQL server, unless it is recognized as internal
command (eg. <CODE>sleep</CODE>).

<LI>

All queries that produce results--for example, <CODE>SELECT</CODE>, <CODE>SHOW</CODE>,
<CODE>EXPLAIN</CODE>, etc., must be preceded with <CODE>@/path/to/result/file</CODE>.  The
file must contain the expected results.  An easy way to generate the result
file is to run <CODE>mysqltest -r &#60; t/test-case-name.test</CODE> from
<CODE>mysql-test</CODE> directory, and then edit the generated result files, if
needed, to adjust them to the expected output.  In that case, be very careful
about not adding or deleting any invisible characters - make sure to only
change the text and/or delete lines.  If you have to insert a line, make sure
that the fields are separated by a hard tab, and that there is a hard tab at the end.
You may want to use <CODE>od -c</CODE> to make sure that your text editor has not messed
anything up during edit.  We hope that you will never have to edit the output
of <CODE>mysqltest -r</CODE> as you only have to do it when you find a bug.

<LI>

To be consistent with our setup, you should put your result files in
<CODE>mysql-test/r</CODE> directory and name them <CODE>test_name.result</CODE>.  If the
test produces more than one result, you should use <CODE>test_name.a.result</CODE>,
<CODE>test_name.b.result</CODE>, etc.

<LI>

If a statement returns an error, you should on the line before the statement
specify with the <CODE>--error error-number</CODE>.  The error number can be
a list of possible error numbers separated by <CODE>','</CODE>.

<LI>

If you are writing a replication test case, you should on the first line of
the test file, put <CODE>source include/master-slave.inc;</CODE>.  To switch between
master and slave, use <CODE>connection master;</CODE> and <CODE>connection slave;</CODE>.
If you need to do something on an alternate connection, you can do
<CODE>connection master1;</CODE> for the master, and <CODE>connection slave1;</CODE> for
the slave.

<LI>

If you need to do something in a loop, you can use something like this:

<PRE>
let $1=1000;
while ($1)
{
 # do your queries here
 dec $1;
}
</PRE>

<LI>

To sleep between queries, use the <CODE>sleep</CODE> command. It supports fractions
of a second, so you can use <CODE>sleep 1.3;</CODE>, for example, to sleep 1.3
seconds.

<LI>

To run the slave with additional options for your test case, put them
in the command-line format in <CODE>mysql-test/t/test_name-slave.opt</CODE>. For
the master, put them in <CODE>mysql-test/t/test_name-master.opt</CODE>.

<LI>

If you have a question about the test suite, or have a test case to contribute,
send an email message to the MySQL <CODE>internals</CODE> mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
As this list does not accept
attachments, you should ftp all the relevant files to:
<a HREF="ftp://support.mysql.com/pub/mysql/Incoming/">ftp://support.mysql.com/pub/mysql/Incoming/</a>

</UL>



<H4><A NAME="Reporting_mysqltest_bugs" HREF="manual_toc.html#Reporting_mysqltest_bugs">22.1.2.3  Reporting Bugs in the MySQL Test Suite</A></H4>

<P>
If your MySQL version doesn't pass the test suite you should
do the following:

</P>

<UL>
<LI>

Don't send a bug report before you have found out as much as possible of
what when wrong!  When you do it, please use the <CODE>mysqlbug</CODE> script
so that we can get information about your system and MySQL
version. See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.
<LI>

Make sure to include the output of <CODE>mysql-test-run</CODE>, as well as
contents of all <CODE>.reject</CODE> files in <CODE>mysql-test/r</CODE> directory.
<LI>

If a test in the test suite fails, check whether the test fails also when run
by its own:


<PRE>
cd mysql-test
mysql-test-run --local test-name
</PRE>

If this fails, then you should configure MySQL with
<CODE>--with-debug</CODE> and run <CODE>mysql-test-run</CODE> with the
<CODE>--debug</CODE> option. If this also fails send the trace file
<TT>`var/tmp/master.trace'</TT> to ftp://support.mysql.com/pub/mysql/secret
so that we can examine it. Please remember to also include a full
description of your system, the version of the mysqld binary and how you
compiled it.

<LI>

Try also to run <CODE>mysql-test-run</CODE> with the <CODE>--force</CODE> option to
see whether there is any other test that fails.

<LI>

If you have compiled MySQL yourself, check our manual for how
to compile MySQL on your platform or, preferable, use one of
the binaries we have compiled for you at
<a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.  All our standard binaries should
pass the test suite !

<LI>

If you get an error, like <CODE>Result length mismatch</CODE> or <CODE>Result
content mismatch</CODE> it means that the output of the test didn't match
exactly the expected output. This could be a bug in MySQL or
that your mysqld version produces slight different results under some
circumstances.

Failed test results are put in a file with the same base name as the
result file with the <CODE>.reject</CODE> extension.  If your test case is
failing, you should do a diff on the two files.  If you cannot see how
they are different, examine both with <CODE>od -c</CODE> and also check their
lengths.

<LI>

If a test fails totally, you should check the logs file in the
<CODE>mysql-test/var/log</CODE> directory for hints of what went wrong.

<LI>

If you have compiled MySQL with debugging you can try to debug this
by running <CODE>mysql-test-run</CODE> with the <CODE>--gdb</CODE> and/or <CODE>--debug</CODE>
options.
See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

If you have not compiled MySQL for debugging you should probably
do that.  Just specify the <CODE>--with-debug</CODE> options to <CODE>configure</CODE>!
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.
</UL>



<H2><A NAME="Adding_functions" HREF="manual_toc.html#Adding_functions">22.2  Adding New Functions to MySQL</A></H2>

<P>
<A NAME="IDX2195"></A>
<A NAME="IDX2196"></A>
<A NAME="IDX2197"></A>
<A NAME="IDX2198"></A>
<A NAME="IDX2199"></A>

</P>
<P>
There are two ways to add new functions to MySQL:

</P>

<UL>
<LI>You can add the function through the user-defined function (UDF)

interface.  User-defined functions are added and removed dynamically using
the <CODE>CREATE FUNCTION</CODE> and <CODE>DROP FUNCTION</CODE> statements.
See section <A HREF="manual.html#CREATE_FUNCTION">22.2.1  <CODE>CREATE FUNCTION/DROP FUNCTION</CODE> Syntax</A>.

<LI>You can add the function as a native (built in) MySQL function.

Native functions are compiled into the <CODE>mysqld</CODE> server and become
available on a permanent basis.
</UL>

<P>
Each method has advantages and disadvantages:

</P>

<UL>
<LI>

If you write a user-defined function, you must install the object file
in addition to the server itself.  If you compile your function into the
server, you don't need to do that.
<LI>

You can add UDFs to a binary MySQL distribution.  Native functions
require you to modify a source distribution.
<LI>

If you upgrade your MySQL distribution, you can continue to use your
previously installed UDFs.  For native functions, you must repeat your
modifications each time you upgrade.
</UL>

<P>
Whichever method you use to add new functions, they may be used just like
native functions such as <CODE>ABS()</CODE> or <CODE>SOUNDEX()</CODE>.

</P>



<H3><A NAME="CREATE_FUNCTION" HREF="manual_toc.html#CREATE_FUNCTION">22.2.1  <CODE>CREATE FUNCTION/DROP FUNCTION</CODE> Syntax</A></H3>

<P>
<A NAME="IDX2200"></A>
<A NAME="IDX2201"></A>
<A NAME="IDX2202"></A>
<A NAME="IDX2203"></A>
<A NAME="IDX2204"></A>
<A NAME="IDX2205"></A>
<A NAME="IDX2206"></A>

</P>

<PRE>
CREATE [AGGREGATE] FUNCTION function_name RETURNS {STRING|REAL|INTEGER}
       SONAME shared_library_name

DROP FUNCTION function_name
</PRE>

<P>
A user-defined function (UDF) is a way to extend MySQL with a new
function that works like native (built in) MySQL function such as
<CODE>ABS()</CODE> and <CODE>CONCAT()</CODE>.

</P>
<P>
<CODE>AGGREGATE</CODE> is a new option for MySQL 3.23.  An
<CODE>AGGREGATE</CODE> function works exactly like a native MySQL
<CODE>GROUP</CODE> function like <CODE>SUM</CODE> or <CODE>COUNT()</CODE>.

</P>
<P>
<CODE>CREATE FUNCTION</CODE> saves the function's name, type, and shared library
name in the <CODE>mysql.func</CODE> system table.  You must have the
<CODE>INSERT</CODE> and <CODE>DELETE</CODE> privileges for the <CODE>mysql</CODE> database
to create and drop functions.

</P>
<P>
All active functions are reloaded each time the server starts, unless
you start <CODE>mysqld</CODE> with the <CODE>--skip-grant-tables</CODE> option.  In
this case, UDF initialization is skipped and UDFs are unavailable.
(An active function is one that has been loaded with <CODE>CREATE FUNCTION</CODE>
and not removed with <CODE>DROP FUNCTION</CODE>.)

</P>
<P>
For instructions on writing user-defined functions, see section <A HREF="manual.html#Adding_functions">22.2  Adding New Functions to MySQL</A>.  For the UDF mechanism to work, functions must be written in C or
C++, your operating system must support dynamic loading and you must have
compiled <CODE>mysqld</CODE> dynamically (not statically).

</P>
<P>
Note that to make <CODE>AGGREGATE</CODE> work, you must have a
<CODE>mysql.func</CODE> table that contains the column <CODE>type</CODE>.  If you do not
have this table, you should run the script
<CODE>mysql_fix_privilege_tables</CODE> to create it.

</P>



<H3><A NAME="Adding_UDF" HREF="manual_toc.html#Adding_UDF">22.2.2  Adding a New User-defined Function</A></H3>

<P>
<A NAME="IDX2207"></A>
<A NAME="IDX2208"></A>
<A NAME="IDX2209"></A>

</P>

<P>
For the UDF mechanism to work, functions must be written in C or C++ and your
operating system must support dynamic loading.  The MySQL source
distribution includes a file <TT>`sql/udf_example.cc'</TT> that defines 5 new
functions.  Consult this file to see how UDF calling conventions work.

</P>
<P>
For <CODE>mysqld</CODE> to be able to use UDF functions, you should configure MySQL
with <CODE>--with-mysqld-ldflags=-rdynamic</CODE> The reason is that to on
many platforms (including Linux) you can load a dynamic library (with
<CODE>dlopen()</CODE>) from a static linked program, which you would get if
you are using <CODE>--with-mysqld-ldflags=-all-static</CODE> If you want to
use an UDF that needs to access symbols from <CODE>mysqld</CODE> (like the
<CODE>metaphone</CODE> example in <TT>`sql/udf_example.cc'</TT> that uses
<CODE>default_charset_info</CODE>), you must link the program with
<CODE>-rdynamic</CODE> (see <CODE>man dlopen</CODE>).

</P>
<P>
If you are using a precompiled version of the server, use MySQL-Max,
which supports dynamic loading.

</P>
<P>
For each function that you want to use in SQL statements, you should define
corresponding C (or C++) functions.  In the following discussion, the name
``xxx'' is used for an example function name.  To distinguish between SQL and
C/C++ usage, <CODE>XXX()</CODE> (uppercase) indicates an SQL function call, and
<CODE>xxx()</CODE> (lowercase) indicates a C/C++ function call.

</P>
<P>
The C/C++ functions that you write to implement the interface for
<CODE>XXX()</CODE> are:

</P>
<DL COMPACT>

<DT><CODE>xxx()</CODE> (required)
<DD>
The main function.  This is where the function result is computed.
The correspondence between the SQL type and return type of your C/C++
function is shown here:

<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>SQL Type</STRONG> </TD><TD> <STRONG>C/C++ Type</STRONG>
</TD></TR>
<TR><TD><CODE>STRING</CODE> </TD><TD> <CODE>char *</CODE>
</TD></TR>
<TR><TD><CODE>INTEGER</CODE> </TD><TD> <CODE>long long</CODE>
</TD></TR>
<TR><TD><CODE>REAL</CODE> </TD><TD> <CODE>double</CODE>
</TD></TR>
</TABLE>

<DT><CODE>xxx_init()</CODE> (optional)
<DD>
The initialization function for <CODE>xxx()</CODE>.  It can be used to:


<UL>
<LI>

Check the number of arguments to <CODE>XXX()</CODE>.
<LI>

Check that the arguments are of a required type or, alternatively,
tell MySQL to coerce arguments to the types you want when
the main function is called.
<LI>

Allocate any memory required by the main function.
<LI>

Specify the maximum length of the result.
<LI>

Specify (for <CODE>REAL</CODE> functions) the maximum number of decimals.
<LI>

Specify whether the result can be <CODE>NULL</CODE>.
</UL>

<DT><CODE>xxx_deinit()</CODE> (optional)
<DD>
The deinitialization function for <CODE>xxx()</CODE>.  It should deallocate any
memory allocated by the initialization function.
</DL>

<P>
When an SQL statement invokes <CODE>XXX()</CODE>, MySQL calls the
initialization function <CODE>xxx_init()</CODE> to let it perform any required
setup, such as argument checking or memory allocation.  If <CODE>xxx_init()</CODE>
returns an error, the SQL statement is aborted with an error message and the
main and deinitialization functions are not called.  Otherwise, the main
function <CODE>xxx()</CODE> is called once for each row.  After all rows have been
processed, the deinitialization function <CODE>xxx_deinit()</CODE> is called so it
can perform any required cleanup.

</P>
<P>
For aggregate functions (like <CODE>SUM()</CODE>), you must also provide the
following functions:

</P>
<DL COMPACT>

<DT><CODE>xxx_reset()</CODE> (required)
<DD>
Reset sum and insert the argument as the initial value for a new group.
<DT><CODE>xxx_add()</CODE> (required)
<DD>
Add the argument to the old sum.
</DL>

<P>
When using aggregate UDFs, MySQL works the following way:

</P>

<OL>
<LI>

Call <CODE>xxx_init()</CODE> to let the aggregate function allocate the memory it
will need to store results.
<LI>

Sort the table according to the <CODE>GROUP BY</CODE> expression.
<LI>

For the first row in a new group, call the <CODE>xxx_reset()</CODE> function.
<LI>

For each new row that belongs in the same group, call the
<CODE>xxx_add()</CODE> function.
<LI>

When the group changes or after the last row has been processed,
call <CODE>xxx()</CODE> to get the result for the aggregate.
<LI>

Repeat 3-5 until all rows has been processed
<LI>

Call <CODE>xxx_deinit()</CODE> to let the UDF free any memory it has allocated.
</OL>

<P>
All functions must be thread-safe (not just the main function,
but the initialization and deinitialization functions as well). This means
that you are not allowed to allocate any global or static variables that
change!  If you need memory, you should allocate it in <CODE>xxx_init()</CODE>
and free it in <CODE>xxx_deinit()</CODE>.

</P>



<H4><A NAME="UDF_calling" HREF="manual_toc.html#UDF_calling">22.2.2.1  UDF Calling Sequences for simple functions</A></H4>

<P>
<A NAME="IDX2210"></A>

</P>
<P>
The main function should be declared as shown here.  Note that the return
type and parameters differ, depending on whether you will declare the SQL
function <CODE>XXX()</CODE> to return <CODE>STRING</CODE>, <CODE>INTEGER</CODE>, or <CODE>REAL</CODE>
in the <CODE>CREATE FUNCTION</CODE> statement:

</P>
<P>
For <CODE>STRING</CODE> functions:

</P>

<PRE>
char *xxx(UDF_INIT *initid, UDF_ARGS *args,
          char *result, unsigned long *length,
          char *is_null, char *error);
</PRE>

<P>
For <CODE>INTEGER</CODE> functions:

</P>

<PRE>
long long xxx(UDF_INIT *initid, UDF_ARGS *args,
              char *is_null, char *error);
</PRE>

<P>
For <CODE>REAL</CODE> functions:

</P>

<PRE>
double xxx(UDF_INIT *initid, UDF_ARGS *args,
              char *is_null, char *error);
</PRE>

<P>
The initialization and deinitialization functions are declared like this:

</P>

<PRE>
my_bool xxx_init(UDF_INIT *initid, UDF_ARGS *args, char *message);

void xxx_deinit(UDF_INIT *initid);
</PRE>

<P>
The <CODE>initid</CODE> parameter is passed to all three functions.  It points to a
<CODE>UDF_INIT</CODE> structure that is used to communicate information between
functions.  The <CODE>UDF_INIT</CODE> structure members follow.  The
initialization function should fill in any members that it wishes to change.
(To use the default for a member, leave it unchanged.):

</P>
<DL COMPACT>

<DT><CODE>my_bool maybe_null</CODE>
<DD>
<CODE>xxx_init()</CODE> should set <CODE>maybe_null</CODE> to <CODE>1</CODE> if <CODE>xxx()</CODE>
can return <CODE>NULL</CODE>.  The default value is <CODE>1</CODE> if any of the
arguments are declared <CODE>maybe_null</CODE>.

<DT><CODE>unsigned int decimals</CODE>
<DD>
The number of decimals.  The default value is the maximum number of decimals in
the arguments passed to the main function.  (For example, if the function is
passed <CODE>1.34</CODE>, <CODE>1.345</CODE>, and <CODE>1.3</CODE>, the default would be 3,
because <CODE>1.345</CODE> has 3 decimals.

<DT><CODE>unsigned int max_length</CODE>
<DD>
The maximum length of the string result.  The default value differs depending
on the result type of the function.  For string functions, the default is the
length of the longest argument.  For integer functions, the default is 21
digits.  For real functions, the default is 13 plus the number of decimals
indicated by <CODE>initid-&#62;decimals</CODE>.  (For numeric functions, the length
includes any sign or decimal point characters.)

If you want to return a blob, you can set this to 65KB or 16MB; this
memory is not allocated but used to decide which column type to use if
there is a need to temporary store the data.

<DT><CODE>char *ptr</CODE>
<DD>
A pointer that the function can use for its own purposes.  For example,
functions can use <CODE>initid-&#62;ptr</CODE> to communicate allocated memory
between functions.  In <CODE>xxx_init()</CODE>, allocate the memory and assign it
to this pointer:


<PRE>
initid-&#62;ptr = allocated_memory;
</PRE>

In <CODE>xxx()</CODE> and <CODE>xxx_deinit()</CODE>, refer to <CODE>initid-&#62;ptr</CODE> to use
or deallocate the memory.
</DL>



<H4><A NAME="UDF_aggr._calling" HREF="manual_toc.html#UDF_aggr._calling">22.2.2.2  UDF Calling Sequences for aggregate functions</A></H4>

<P>
<A NAME="IDX2211"></A>

</P>
<P>
Here follows a description of the different functions you need to define
when you want to create an aggregate UDF function.

</P>
<P>
Note that the following function is NOT needed or used by MySQL 4.1.1.
You can keep still have define this function if you want to have your
code work with both MySQL 4.0 and MySQL 4.1.1

</P>

<PRE>
char *xxx_reset(UDF_INIT *initid, UDF_ARGS *args,
                char *is_null, char *error);
</PRE>

<P>
This function is called when MySQL finds the first row in a new group.
In the function you should reset any internal summary variables and then set
the given argument as the first argument in the group.

</P>
<P>
In many cases this is implemented internally by reseting all variables
(for example by calling <CODE>xxx_clear()</CODE> and then calling
<CODE>xxx_add()</CODE>.

</P>
<P>
The following function is only required by MySQL 4.1.1 and above:

</P>

<PRE>
char *xxx_clear(UDF_INIT *initid, char *is_null, char *error);
</PRE>

<P>
This function is called when MySQL needs to reset the summary results.
This will be called at the beginning for each new group but can also be
called to reset the values for a query where there was no matching rows.
<CODE>is_null</CODE> will be set to point to <CODE>CHAR(0)</CODE> before calling
<CODE>xxx_clear()</CODE>.

</P>
<P>
You can use the <CODE>error</CODE> pointer to store a byte if something went
wrong .

</P>

<PRE>
char *xxx_add(UDF_INIT *initid, UDF_ARGS *args,
              char *is_null, char *error);
</PRE>

<P>
This function is called for all rows that belongs to the same group,
except for the first row. In this you should add the value in UDF_ARGS
to your internal summary variable.

</P>
<P>
The <CODE>xxx()</CODE> function should be declared identical as when you
define a simple UDF function. See section <A HREF="manual.html#UDF_calling">22.2.2.1  UDF Calling Sequences for simple functions</A>.

</P>
<P>
This function is called when all rows in the group has been processed.
You should normally never access the <CODE>args</CODE> variable here but
return your value based on your internal summary variables.

</P>
<P>
All argument processing in <CODE>xxx_reset()</CODE> and <CODE>xxx_add()</CODE>
should be done identically as for normal UDFs. See section <A HREF="manual.html#UDF_arguments">22.2.2.3  Argument Processing</A>.

</P>
<P>
The return value handling in <CODE>xxx()</CODE> should be done identically as
for a normal UDF. See section <A HREF="manual.html#UDF_return_values">22.2.2.4  Return Values and Error Handling</A>.

</P>
<P>
The pointer argument to <CODE>is_null</CODE> and <CODE>error</CODE> is the same for
all calls to <CODE>xxx_reset()</CODE>, <CODE>xxx_clear()</CODE>, <CODE>xxx_add()</CODE> and
<CODE>xxx()</CODE>.
You can use this to remember that you got an error or if the <CODE>xxx()</CODE>
function should return <CODE>NULL</CODE>. Note that you should not store a string
into <CODE>*error</CODE>!  This is just a 1 byte flag!

</P>
<P>
<CODE>is_null</CODE> is reset for each group (before calling <CODE>xxx_clear()</CODE>).
<CODE>error</CODE> is never reset.

</P>
<P>
If <CODE>is_null</CODE> or <CODE>error</CODE> are set after <CODE>xxx()</CODE>, then MySQL
will return <CODE>NULL</CODE> as the result for the group function.

</P>


<H4><A NAME="UDF_arguments" HREF="manual_toc.html#UDF_arguments">22.2.2.3  Argument Processing</A></H4>

<P>
<A NAME="IDX2212"></A>
<A NAME="IDX2213"></A>

</P>
<P>
The <CODE>args</CODE> parameter points to a <CODE>UDF_ARGS</CODE> structure that has the
members listed here:

</P>
<DL COMPACT>

<DT><CODE>unsigned int arg_count</CODE>
<DD>
The number of arguments.  Check this value in the initialization function
if you want your function to be called with a particular number of arguments.
For example:


<PRE>
if (args-&#62;arg_count != 2)
{
    strcpy(message,"XXX() requires two arguments");
    return 1;
}
</PRE>

<DT><CODE>enum Item_result *arg_type</CODE>
<DD>
The types for each argument.  The possible type values are
<CODE>STRING_RESULT</CODE>, <CODE>INT_RESULT</CODE>, and <CODE>REAL_RESULT</CODE>.

To make sure that arguments are of a given type and return an
error if they are not, check the <CODE>arg_type</CODE> array in the initialization
function.  For example:


<PRE>
if (args-&#62;arg_type[0] != STRING_RESULT ||
    args-&#62;arg_type[1] != INT_RESULT)
{
    strcpy(message,"XXX() requires a string and an integer");
    return 1;
}
</PRE>

As an alternative to requiring your function's arguments to be of particular
types, you can use the initialization function to set the <CODE>arg_type</CODE>
elements to the types you want.  This causes MySQL to coerce
arguments to those types for each call to <CODE>xxx()</CODE>.  For example, to
specify coercion of the first two arguments to string and integer, do this in
<CODE>xxx_init()</CODE>:


<PRE>
args-&#62;arg_type[0] = STRING_RESULT;
args-&#62;arg_type[1] = INT_RESULT;
</PRE>

<DT><CODE>char **args</CODE>
<DD>
<CODE>args-&#62;args</CODE> communicates information to the initialization function
about the general nature of the arguments your function was called with.  For a
constant argument <CODE>i</CODE>, <CODE>args-&#62;args[i]</CODE> points to the argument
value.  (See below for instructions on how to access the value properly.)
For a non-constant argument, <CODE>args-&#62;args[i]</CODE> is <CODE>0</CODE>.
A constant argument is an expression that uses only constants, such as
<CODE>3</CODE> or <CODE>4*7-2</CODE> or <CODE>SIN(3.14)</CODE>.  A non-constant argument is an
expression that refers to values that may change from row to row, such as
column names or functions that are called with non-constant arguments.

For each invocation of the main function, <CODE>args-&#62;args</CODE> contains the
actual arguments that are passed for the row currently being processed.

Functions can refer to an argument <CODE>i</CODE> as follows:


<UL>
<LI>

An argument of type <CODE>STRING_RESULT</CODE> is given as a string pointer plus a
length, to allow handling of binary data or data of arbitrary length.  The
string contents are available as <CODE>args-&#62;args[i]</CODE> and the string length
is <CODE>args-&#62;lengths[i]</CODE>.  You should not assume that strings are
null-terminated.

<LI>

For an argument of type <CODE>INT_RESULT</CODE>, you must cast
<CODE>args-&#62;args[i]</CODE> to a <CODE>long long</CODE> value:


<PRE>
long long int_val;
int_val = *((long long*) args-&#62;args[i]);
</PRE>

<LI>

For an argument of type <CODE>REAL_RESULT</CODE>, you must cast
<CODE>args-&#62;args[i]</CODE> to a <CODE>double</CODE> value:


<PRE>
double    real_val;
real_val = *((double*) args-&#62;args[i]);
</PRE>

</UL>

<DT><CODE>unsigned long *lengths</CODE>
<DD>
For the initialization function, the <CODE>lengths</CODE> array indicates the
maximum string length for each argument. You should not change these.
For each invocation of the main function, <CODE>lengths</CODE> contains the
actual lengths of any string arguments that are passed for the row
currently being processed.  For arguments of types <CODE>INT_RESULT</CODE> or
<CODE>REAL_RESULT</CODE>, <CODE>lengths</CODE> still contains the maximum length of
the argument (as for the initialization function).
</DL>



<H4><A NAME="UDF_return_values" HREF="manual_toc.html#UDF_return_values">22.2.2.4  Return Values and Error Handling</A></H4>

<P>
<A NAME="IDX2214"></A>
<A NAME="IDX2215"></A>
<A NAME="IDX2216"></A>
<A NAME="IDX2217"></A>

</P>
<P>
The initialization function should return <CODE>0</CODE> if no error occurred and
<CODE>1</CODE> otherwise.  If an error occurs, <CODE>xxx_init()</CODE> should store a
null-terminated error message in the <CODE>message</CODE> parameter.  The message
will be returned to the client.  The message buffer is
<CODE>MYSQL_ERRMSG_SIZE</CODE> characters long, but you should try to keep the
message to less than 80 characters so that it fits the width of a standard
terminal screen.

</P>
<P>
The return value of the main function <CODE>xxx()</CODE> is the function value, for
<CODE>long long</CODE> and <CODE>double</CODE> functions.  A string functions should
return a pointer to the result and store the length of the string in the
<CODE>length</CODE> arguments.

</P>
<P>
Set these to the contents and length of the return value.  For example:

</P>

<PRE>
memcpy(result, "result string", 13);
*length = 13;
</PRE>

<P>
The <CODE>result</CODE> buffer that is passed to the calc function is 255 byte
big. If your result fits in this, you don't have to worry about memory
allocation for results.

</P>
<P>
If your string function needs to return a string longer than 255 bytes,
you must allocate the space for it with <CODE>malloc()</CODE> in your
<CODE>xxx_init()</CODE> function or your <CODE>xxx()</CODE> function and free it in
your <CODE>xxx_deinit()</CODE> function.  You can store the allocated memory
in the <CODE>ptr</CODE> slot in the <CODE>UDF_INIT</CODE> structure for reuse by
future <CODE>xxx()</CODE> calls.  See section <A HREF="manual.html#UDF_calling">22.2.2.1  UDF Calling Sequences for simple functions</A>.

</P>
<P>
To indicate a return value of <CODE>NULL</CODE> in the main function, set
<CODE>is_null</CODE> to <CODE>1</CODE>:

</P>

<PRE>
*is_null = 1;
</PRE>

<P>
To indicate an error return in the main function, set the <CODE>error</CODE>
parameter to <CODE>1</CODE>:

</P>

<PRE>
*error = 1;
</PRE>

<P>
If <CODE>xxx()</CODE> sets <CODE>*error</CODE> to <CODE>1</CODE> for any row, the function
value is <CODE>NULL</CODE> for the current row and for any subsequent rows
processed by the statement in which <CODE>XXX()</CODE> was invoked.  (<CODE>xxx()</CODE>
will not even be called for subsequent rows.) <STRONG>Note:</STRONG> In
MySQL versions prior to 3.22.10, you should set both <CODE>*error</CODE>
and <CODE>*is_null</CODE>:

</P>

<PRE>
*error = 1;
*is_null = 1;
</PRE>



<H4><A NAME="UDF_compiling" HREF="manual_toc.html#UDF_compiling">22.2.2.5  Compiling and Installing User-defined Functions</A></H4>

<P>
<A NAME="IDX2218"></A>
<A NAME="IDX2219"></A>
<A NAME="IDX2220"></A>

</P>
<P>
Files implementing UDFs must be compiled and installed on the host where the
server runs.  This process is described below for the example UDF file
<TT>`udf_example.cc'</TT> that is included in the MySQL source
distribution.  This file contains the following functions:

</P>

<UL>
<LI>

<CODE>metaphon()</CODE> returns a metaphon string of the string argument.
This is something like a soundex string, but it's more tuned for English.
<LI>

<CODE>myfunc_double()</CODE> returns the sum of the ASCII values of the
characters in its arguments, divided by the sum of the length of its arguments.
<LI>

<CODE>myfunc_int()</CODE> returns the sum of the length of its arguments.
<LI>

<CODE>sequence([const int])</CODE> returns an sequence starting from the given
number or 1 if no number has been given.
<LI>

<CODE>lookup()</CODE> returns the IP number for a hostname.
<LI>

<CODE>reverse_lookup()</CODE> returns the hostname for an IP number.
The function may be called with a string <CODE>'xxx.xxx.xxx.xxx'</CODE> or
four numbers.
</UL>

<P>
A dynamically loadable file should be compiled as a sharable object file,
using a command something like this:

</P>

<PRE>
shell&#62; gcc -shared -o udf_example.so myfunc.cc
</PRE>

<P>
You can easily find out the correct compiler options for your system by
running this command in the <TT>`sql'</TT> directory of your MySQL
source tree:

</P>

<PRE>
shell&#62; make udf_example.o
</PRE>

<P>
You should run a compile command similar to the one that <CODE>make</CODE> displays,
except that you should remove the <CODE>-c</CODE> option near the end of the line
and add <CODE>-o udf_example.so</CODE> to the end of the line.  (On some systems,
you may need to leave  the <CODE>-c</CODE> on the command.)

</P>
<P>
Once you compile a shared object containing UDFs, you must install it and
tell MySQL about it. Compiling a shared object from <TT>`udf_example.cc'</TT>
produces a file named something like <TT>`udf_example.so'</TT> (the exact name
may vary from platform to platform). Copy this file to some directory
searched by the dynamic linker <CODE>ld</CODE>, such as <TT>`/usr/lib'</TT> or add the
directory in which you placed the shared object to the linker configuration
file (for example, <TT>`/etc/ld.so.conf'</TT>).

</P>
<P>
On many systems, you can also set the <CODE>LD_LIBRARY</CODE> or
<CODE>LD_LIBRARY_PATH</CODE> environment variable to point at the directory where
you have your UDF function files. The <CODE>dlopen</CODE> manual page tells you
which variable you should use on your system. You should set this in
<CODE>mysql.server</CODE> or <CODE>mysqld_safe</CODE> startup scripts and restart
<CODE>mysqld</CODE>.

</P>
<P>
After the library is installed, notify <CODE>mysqld</CODE> about the new
functions with these commands:

</P>

<PRE>
mysql&#62; CREATE FUNCTION metaphon RETURNS STRING SONAME 'udf_example.so';
mysql&#62; CREATE FUNCTION myfunc_double RETURNS REAL SONAME 'udf_example.so';
mysql&#62; CREATE FUNCTION myfunc_int RETURNS INTEGER SONAME 'udf_example.so';
mysql&#62; CREATE FUNCTION lookup RETURNS STRING SONAME 'udf_example.so';
mysql&#62; CREATE FUNCTION reverse_lookup
    -&#62;        RETURNS STRING SONAME 'udf_example.so';
mysql&#62; CREATE AGGREGATE FUNCTION avgcost
    -&#62;        RETURNS REAL SONAME 'udf_example.so';
</PRE>

<P>
Functions can be deleted using <CODE>DROP FUNCTION</CODE>:

</P>

<PRE>
mysql&#62; DROP FUNCTION metaphon;
mysql&#62; DROP FUNCTION myfunc_double;
mysql&#62; DROP FUNCTION myfunc_int;
mysql&#62; DROP FUNCTION lookup;
mysql&#62; DROP FUNCTION reverse_lookup;
mysql&#62; DROP FUNCTION avgcost;
</PRE>

<P>
The <CODE>CREATE FUNCTION</CODE> and <CODE>DROP FUNCTION</CODE> statements update the
system table <CODE>func</CODE> in the <CODE>mysql</CODE> database.  The function's name,
type and shared library name are saved in the table.  You must have the
<CODE>INSERT</CODE> and <CODE>DELETE</CODE> privileges for the <CODE>mysql</CODE> database
to create and drop functions.

</P>
<P>
You should not use <CODE>CREATE FUNCTION</CODE> to add a function that has already
been created.  If you need to reinstall a function, you should remove it with
<CODE>DROP FUNCTION</CODE> and then reinstall it with <CODE>CREATE FUNCTION</CODE>.  You
would need to do this, for example, if you recompile a new version of your
function, so that <CODE>mysqld</CODE> gets the new version.  Otherwise, the server
will continue to use the old version.

</P>
<P>
Active functions are reloaded each time the server starts, unless you start
<CODE>mysqld</CODE> with the <CODE>--skip-grant-tables</CODE> option.  In this case, UDF
initialization is skipped and UDFs are unavailable.  (An active function is
one that has been loaded with <CODE>CREATE FUNCTION</CODE> and not removed with
<CODE>DROP FUNCTION</CODE>.)

</P>



<H3><A NAME="Adding_native_function" HREF="manual_toc.html#Adding_native_function">22.2.3  Adding a New Native Function</A></H3>

<P>
<A NAME="IDX2221"></A>
<A NAME="IDX2222"></A>
<A NAME="IDX2223"></A>

</P>
<P>
The procedure for adding a new native function is described here.  Note
that you cannot add native functions to a binary distribution because
the procedure involves modifying MySQL source code.  You must
compile MySQL yourself from a source distribution.  Also note
that if you migrate to another version of MySQL (for example,
when a new version is released), you will need to repeat the procedure
with the new version.

</P>
<P>
To add a new native MySQL function, follow these steps:

</P>

<OL>
<LI>

Add one line to <TT>`lex.h'</TT> that defines the function name in the
<CODE>sql_functions[]</CODE> array.
<LI>

If the function prototype is simple (just takes zero, one, two or three
arguments), you should in lex.h specify SYM(FUNC_ARG#) (where # is the
number of arguments) as the second argument in the
<CODE>sql_functions[]</CODE> array and add a function that creates a function
object in <TT>`item_create.cc'</TT>.  Take a look at <CODE>"ABS"</CODE> and
<CODE>create_funcs_abs()</CODE> for an example of this.

If the function prototype is complicated (for example takes a variable number
of arguments), you should add two lines to <TT>`sql_yacc.yy'</TT>. One
indicates the preprocessor symbol that <CODE>yacc</CODE> should define (this
should be added at the beginning of the file). Then define the function
parameters and add an ``item'' with these parameters to the
<CODE>simple_expr</CODE> parsing rule.  For an example, check all occurrences
of <CODE>ATAN</CODE> in <TT>`sql_yacc.yy'</TT> to see how this is done.
<LI>

In <TT>`item_func.h'</TT>, declare a class inheriting from <CODE>Item_num_func</CODE> or
<CODE>Item_str_func</CODE>, depending on whether your function returns a number or a
string.
<LI>

In <TT>`item_func.cc'</TT>, add one of the following declarations, depending
on whether you are defining a numeric or string function:

<PRE>
double   Item_func_newname::val()
longlong Item_func_newname::val_int()
String  *Item_func_newname::Str(String *str)
</PRE>

If you inherit your object from any of the standard items (like
<CODE>Item_num_func</CODE>), you probably only have to define one of these
functions and let the parent object take care of the other functions.
For example, the <CODE>Item_str_func</CODE> class defines a <CODE>val()</CODE> function
that executes <CODE>atof()</CODE> on the value returned by <CODE>::str()</CODE>.

<LI>

You should probably also define the following object function:

<PRE>
void Item_func_newname::fix_length_and_dec()
</PRE>

This function should at least calculate <CODE>max_length</CODE> based on the
given arguments. <CODE>max_length</CODE> is the maximum number of characters
the function may return.  This function should also set <CODE>maybe_null
= 0</CODE> if the main function can't return a <CODE>NULL</CODE> value.  The
function can check whether any of the function arguments can return
<CODE>NULL</CODE> by checking the arguments' <CODE>maybe_null</CODE> variable. You
can take a look at <CODE>Item_func_mod::fix_length_and_dec</CODE> for a
typical example of how to do this.
</OL>

<P>
All functions must be thread-safe (in other words, don't use any global or
static variables in the functions without protecting them with mutexes).

</P>
<P>
If you want to return <CODE>NULL</CODE>, from <CODE>::val()</CODE>, <CODE>::val_int()</CODE>
or <CODE>::str()</CODE> you should set <CODE>null_value</CODE> to 1 and return 0.

</P>
<P>
For <CODE>::str()</CODE> object functions, there are some additional
considerations to be aware of:

</P>

<UL>
<LI>

The <CODE>String *str</CODE> argument provides a string buffer that may be
used to hold the result. (For more information about the <CODE>String</CODE> type,
take a look at the <TT>`sql_string.h'</TT> file.)
<LI>

The <CODE>::str()</CODE> function should return the string that holds the result or
<CODE>(char*) 0</CODE> if the result is <CODE>NULL</CODE>.
<LI>

All current string functions try to avoid allocating any memory unless
absolutely necessary!
</UL>



<H2><A NAME="Adding_procedures" HREF="manual_toc.html#Adding_procedures">22.3  Adding New Procedures to MySQL</A></H2>

<P>
<A NAME="IDX2224"></A>
<A NAME="IDX2225"></A>
<A NAME="IDX2226"></A>

</P>
<P>
In MySQL, you can define a procedure in C++ that can access and
modify the data in a query before it is sent to the client.  The modification
can be done on a row-by-row or <CODE>GROUP BY</CODE> level.

</P>
<P>
We have created an example procedure in MySQL 3.23 to
show you what can be done.

</P>
<P>
Additionally we recommend you to take a look at <CODE>mylua</CODE>.
With this you can use the LUA language to load a procedure at
runtime into <CODE>mysqld</CODE>.

</P>



<H3><A NAME="procedure_analyse" HREF="manual_toc.html#procedure_analyse">22.3.1  Procedure Analyse</A></H3>

<P>
<CODE>analyse([max elements,[max memory]])</CODE>

</P>
<P>
This procedure is defined in the <TT>`sql/sql_analyse.cc'</TT>.  This
examines the result from your query and returns an analysis of the
results:

</P>

<UL>
<LI>

<CODE>max elements</CODE> (default 256) is the maximum number of distinct values
<CODE>analyse</CODE> will notice per column.  This is used by <CODE>analyse</CODE> to
check whether
the optimal column type should be of type <CODE>ENUM</CODE>.
<LI>

<CODE>max memory</CODE> (default 8192) is the maximum memory <CODE>analyse</CODE> should
allocate per column while trying to find all distinct values.
</UL>


<PRE>
SELECT ... FROM ... WHERE ... PROCEDURE ANALYSE([max elements,[max memory]])
</PRE>



<H3><A NAME="Writing_a_procedure" HREF="manual_toc.html#Writing_a_procedure">22.3.2  Writing a Procedure</A></H3>

<P>
For the moment, the only documentation for this is the source.

</P>
<P>
You can find all information about procedures by examining the following files:

</P>

<UL>
<LI><TT>`sql/sql_analyse.cc'</TT>

<LI><TT>`sql/procedure.h'</TT>

<LI><TT>`sql/procedure.cc'</TT>

<LI><TT>`sql/sql_select.cc'</TT>

</UL>



<H1><A NAME="Problems" HREF="manual_toc.html#Problems">A  Problems and Common Errors</A></H1>

<P>
<A NAME="IDX2227"></A>
<A NAME="IDX2228"></A>

</P>

<P>
This appendix lists some common problems and error messages that you may
encounter.  It describes how to determine the causes of the
problems and what to do to solve them.

</P>



<H2><A NAME="What_is_crashing" HREF="manual_toc.html#What_is_crashing">A.1  How to Determine What Is Causing a Problem</A></H2>

<P>
When you run into a problem, the first thing you should do is to find out
which program or piece of equipment is causing it:

</P>

<UL>
<LI>

If you have one of the following symptoms, then it is probably a hardware
problems (such as memory, motherboard, CPU, or hard disk) or kernel problem:

<UL>
<LI>

The keyboard doesn't work.  This can normally be checked by pressing
the Caps Lock key. If the Caps Lock light doesn't change, you have to replace
your keyboard.  (Before doing this, you should try to restart
your computer and check all cables to the keyboard.)
<LI>

The mouse pointer doesn't move.
<LI>

The machine doesn't answer to a remote machine's pings.
<LI>

Other programs that are not related to MySQL don't behave correctly.
<LI>

Your system restarted unexpectedly. (A faulty user-level program should
never be able to take down your system.)
</UL>

In this case, you should start by checking all your cables and run some
diagnostic tool to check your hardware!
You should also check whether there are any patches, updates, or service
packs for your operating system that could likely solve your problem.
Check also that all your libraries (such as <CODE>glibc</CODE>) are up to date.

It's always good to use a machine with ECC memory to discover
memory problems early.
<LI>

If your keyboard is locked up, you may be able to recover by
logging in to your machine from another machine and executing
<CODE>kbd_mode -a</CODE>.

<LI>

Please examine your system log file (<TT>`/var/log/messages'</TT> or similar) for
reasons for your problem.  If you think the problem is in MySQL,
you should also examine MySQL's log files. See section <A HREF="manual.html#Log_Files">5.8  The MySQL Log Files</A>.

<LI>

If you don't think you have hardware problems, you should try to find
out which program is causing problems.
Try using <CODE>top</CODE>, <CODE>ps</CODE>, Task Manager, or some similar program,
to check which program is taking all CPU or is locking the machine.

<LI>

Use <CODE>top</CODE>, <CODE>df</CODE>, or a similar program to check whether you are out
of memory, disk space, file descriptors, or some other critical resource.

<LI>

If the problem is some runaway process, you can always try to kill it. If it
doesn't want to die, there is probably a bug in the operating system.
</UL>

<P>
If after you have examined all other possibilities and you have
concluded that the MySQL server or a MySQL client
is causing the problem, it's time to create a bug report for our
mailing list or our support team.  In the bug report, try to give a
very detailed description of how the system is behaving and what you think is
happening. You should also state why you think that MySQL
is causing the problem.  Take into consideration all the situations in
this chapter. State any problems exactly how they appear when you
examine your system. Use the ``copy and paste'' method for any output
and error messages from programs and log files.

</P>
<P>
Try to describe in detail which program is not working and all
symptoms you see.  We have in the past received many bug reports that
state only ``the system doesn't work.''  This doesn't provide us with any
information about what could be the problem.

</P>
<P>
If a program fails, it's always useful to know the following information:

</P>

<UL>
<LI>

Has the program in question made a segmentation fault (did it dump core)?
<LI>

Is the program taking up all available CPU time? Check with <CODE>top</CODE>. Let
the program run for a while, it may simply be evaluating something
computationally intensive.
<LI>

If the <CODE>mysqld</CODE> server is causing problems, can you get any response
from it with <CODE>mysqladmin -u root ping</CODE> or <CODE>mysqladmin -u root
processlist</CODE>?
<LI>

What does a client program say when you try to connect to the MySQL server?
(Try with <CODE>mysql</CODE>, for example.) Does the client jam?  Do you get any
output from the program?
</UL>

<P>
When sending a bug report, you should follow the outline
described in section <A HREF="manual.html#Asking_questions">1.7.1.2  Asking Questions or Reporting Bugs</A>.

</P>



<H2><A NAME="Common_errors" HREF="manual_toc.html#Common_errors">A.2  Common Errors When Using MySQL Programs</A></H2>

<P>
<A NAME="IDX2229"></A>

</P>

<P>
This section lists some errors that users frequently encounter when running
MySQL programs. Although the problems show up when you try to run client
programs, the solutions to many of the problems involves changing the
configuration of the MySQL server.

</P>



<H3><A NAME="Error_Access_denied" HREF="manual_toc.html#Error_Access_denied">A.2.1  <CODE>Access denied</CODE></A></H3>

<P>
<A NAME="IDX2230"></A>
<A NAME="IDX2231"></A>
<A NAME="IDX2232"></A>

</P>
<P>
An <CODE>Access denied</CODE> error can have many causes.  Often the problem is
related to the MySQL accounts that the server allows client programs to
use when connecting.
See section <A HREF="manual.html#Access_denied">5.4.8  Causes of <CODE>Access denied</CODE> Errors</A>.
See section <A HREF="manual.html#Privileges">5.4.2  How the Privilege System Works</A>.

</P>



<H3><A NAME="Can_not_connect_to_server" HREF="manual_toc.html#Can_not_connect_to_server">A.2.2  <CODE>Can't connect to [local] MySQL server</CODE></A></H3>

<P>
A MySQL client on Unix can connect to the <CODE>mysqld</CODE> server in two
different ways: By using a Unix socket file to connect through a file in the
filesystem (default <TT>`/tmp/mysql.sock'</TT>), or by using TCP/IP, which
connects through a port number.  A Unix socket file connection is faster
than TCP/IP, but can be used only when connecting to a server on the same
computer.  A Unix socket file is used if you don't specify a hostname or if
you specify the special hostname <CODE>localhost</CODE>.

</P>
<P>
If the MySQL server is running on Windows 9x or Me, you can connect
only via TCP/IP. If the server is running on Windows NT, 2000, or XP
and is started with the <CODE>--enable-named-pipe</CODE> option, you can also
connect with named pipes if you run the client on the host where the
server is running. The name of the named pipe is <CODE>MySQL</CODE> by default.
If you don't give a hostname when connecting to <CODE>mysqld</CODE>, a MySQL
client first will try to connect to the named pipe. If that doesn't work,
it will connect to the TCP/IP port.  You can force the use of named pipes
on Windows by using <CODE>.</CODE> as the hostname.

</P>
<P>
The error (2002) <CODE>Can't connect to ...</CODE> normally means that there is no
MySQL server running on the system or that you are using an incorrect Unix
socket filename or TCP/IP port number when trying to connect to the
server.

</P>
<P>
Start by checking whether there is a process named <CODE>mysqld</CODE> running on
your server host.  (Use <CODE>ps</CODE> on Unix or the Task Manager on Windows.) If
there is no such process, you should start the server.
See section <A HREF="manual.html#Starting_server">2.4.2.3  Starting and Troubleshooting the MySQL Server</A>.

</P>
<P>
If a <CODE>mysqld</CODE> process is running, you can check it by
trying the following commands. The port number or Unix socket filename
might be different in your setup. <CODE>host_ip</CODE> represents the IP number of
the machine where the server is running.

</P>

<PRE>
shell&#62; mysqladmin version
shell&#62; mysqladmin variables
shell&#62; mysqladmin -h `hostname` version variables
shell&#62; mysqladmin -h `hostname` --port=3306 version
shell&#62; mysqladmin -h host_ip version
shell&#62; mysqladmin --protocol=socket --socket=/tmp/mysql.sock version
</PRE>

<P>
Note the use of backticks rather than forward quotes with the <CODE>hostname</CODE>
command; these cause the output of <CODE>hostname</CODE> (that is, the current
hostname) to be substituted into the <CODE>mysqladmin</CODE> command.
If you have no <CODE>hostname</CODE> command or are running on Windows, you can
manually type the hostname of your machine (without backticks) following the
<CODE>-h</CODE> option.
You can also try <CODE>-h 127.0.0.1</CODE> to connect with TCP/IP to the local host.

</P>
<P>
Here are some reasons the <CODE>Can't connect to local MySQL server</CODE>
error might occur:

</P>

<UL>
<LI>

<CODE>mysqld</CODE> is not running.
<LI>

You are running on a system that uses MIT-pthreads.
If you are running on a system that doesn't have native threads,
<CODE>mysqld</CODE> uses the MIT-pthreads package.  See section <A HREF="manual.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A>.  However,
not all MIT-pthreads versions support Unix socket files. On a system
without socket file support, you must always specify the hostname explicitly
when connecting to the server. Try using this command to check the
connection to the server:


<PRE>
shell&#62; mysqladmin -h `hostname` version
</PRE>

<LI>

Someone has removed the Unix socket file that <CODE>mysqld</CODE> uses
(<TT>`/tmp/mysql.sock'</TT> by default).  For example, you might have a <CODE>cron</CODE> job that
removes old files from the <TT>`/tmp'</TT> directory.  You can always run
<CODE>mysqladmin version</CODE> to check whether the Unix socket file that
<CODE>mysqladmin</CODE> is trying to use really exists.  The fix in this case is
to change the <CODE>cron</CODE> job to not remove <TT>`mysql.sock'</TT> or to place
the socket file somewhere else.
See section <A HREF="manual.html#Problems_with_mysql.sock">A.4.5  How to Protect or Change the MySQL Socket File <TT>`/tmp/mysql.sock'</TT></A>.
<LI>

You have started the <CODE>mysqld</CODE> server with
the <CODE>--socket=/path/to/socket</CODE> option, but forgotten to tell client
programs the new name of the socket file.  If you change the socket
pathname for the server, you must also notify the MySQL clients.
You can do this by providing the same <CODE>--socket</CODE> option when you run
client programs.
See section <A HREF="manual.html#Problems_with_mysql.sock">A.4.5  How to Protect or Change the MySQL Socket File <TT>`/tmp/mysql.sock'</TT></A>.
<LI>

You are using Linux and one server thread has died (dumped core).  In this case,
you must kill the other <CODE>mysqld</CODE> threads (for example, with <CODE>kill</CODE>
or with the <CODE>mysql_zap</CODE> script) before you can restart the MySQL
server.  See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.
<LI>

The server or client program might not have the proper access privileges for
the directory that holds the Unix socket file or the socket file itself. In
this case, you must either change the access privileges for the directory or
socket file so that the server and clients can access them, or restart
<CODE>mysqld</CODE> with a <CODE>--socket</CODE> option that specifies a socket filename
in a directory where the server can create it and where client programs can
access it.
</UL>

<P>
If you get the error message <CODE>Can't connect to MySQL server on
some_host</CODE>, you can try the following things to find out what the
problem is:

</P>

<UL>

<LI>

Check whether the server is running on that host by executing <CODE>telnet
some_host 3306</CODE> and pressing the Enter key a couple of times.  (3306 is the
default MySQL port number. Change the value if your server is listening to a
different port.) If there is a MySQL server running and listening to the
port, you should get a response that includes the server's version number.
If you get an error such as <CODE>telnet: Unable to connect to remote host:
Connection refused</CODE>, then there is no server running on the given port.

<LI>

If the server is running on the local host, try using <CODE>mysqladmin -h
localhost variables</CODE> to connect using the Unix socket file. Verify the
TCP/IP port number that the server is configured to listen to (it is the
value of the <CODE>port</CODE> variable.)

<LI>

Make sure that your <CODE>mysqld</CODE> server was not started with the
<CODE>--skip-networking</CODE> option. If it was, you will not be able to connect
to it using TCP/IP.

</UL>



<H3><A NAME="Old_client" HREF="manual_toc.html#Old_client">A.2.3  <CODE>Client does not support authentication protocol</CODE></A></H3>

<P>
MySQL 4.1 and up uses an authentication protocol based on a password hashing
algorithm that is incompatible with that used by older clients.
If you upgrade the server to 4.1, attempts to connect to it with an
older client may fail with the following message:

</P>

<PRE>
shell&#62; mysql
Client does not support authentication protocol requested
by server; consider upgrading MySQL client
</PRE>

<P>
To solve this problem, you should use one of the following approaches:

</P>

<UL>
<LI>

Upgrade all client programs to use a 4.1.1 or newer client library.
<LI>

Uhen connecting to the server with a pre-4.1 client program, use an account
that still has a pre-4.1-style password.
<LI>

Reset the password to pre-4.1 style for each user that needs to use a
pre-4.1 client program. This can be done using the <CODE>SET PASSWORD</CODE>
statement and the <CODE>OLD_PASSWORD()</CODE> function:


<PRE>
mysql&#62; SET PASSWORD FOR
    -&#62; 'some_user'@'some_host' = OLD_PASSWORD('newpwd');
</PRE>

Alternatively, use <CODE>UPDATE</CODE> and <CODE>FLUSH PRIVILEGES</CODE>:


<PRE>
mysql&#62; UPDATE mysql.user SET Password = OLD_PASSWORD('newpwd')
    -&#62; WHERE Host = 'some_host' AND User = 'some_user';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

Substitute the password you want to use for ``<CODE>newpwd</CODE>'' in the preceding
examples.  MySQL cannot tell you what the original password was, so you'll
need to pick a new one.

<LI>

Tell the server to use the older password hashing algorithm:

<OL>
<LI>

Start <CODE>mysqld</CODE> with the <CODE>--old-passwords</CODE> option.
<LI>

Assign an old-format password to each account that has had its password
updated to the longer 4.1 format. You can identify these accounts with the
following query:


<PRE>
mysql&#62; SELECT Host, User, Password FROM mysql.user
    -&#62; WHERE LENGTH(Password) &#62; 16;
</PRE>

For each account record displayed by the query, use the <CODE>Host</CODE> and <CODE>User</CODE> values and assign
a password using the <CODE>OLD_PASSWORD()</CODE> function and either <CODE>SET PASSWORD</CODE> or <CODE>UPDATE</CODE>, as described
earlier.
</OL>

</UL>

<P>
For additional background on password hashing and authentication, see
section <A HREF="manual.html#Password_hashing">5.4.9  Password Hashing in MySQL 4.1</A>.

</P>



<H3><A NAME="Password_too_long" HREF="manual_toc.html#Password_too_long">A.2.4  Password Fails When Entered Interactively</A></H3>

<P>
MySQL client programs prompt for a password when invoked with a
<CODE>--password</CODE> or <CODE>-p</CODE> option that has no following password value:

</P>

<PRE>
shell&#62; mysql -u user_name -p
Enter password:
</PRE>

<P>
On some systems, you may find that your password works when specified in an
option file or on the command line, but not when you enter it interactively
at the <CODE>Enter password:</CODE> prompt. This occurs when the library provided
by the system to read passwords limits password values to a small number of
characters (typically eight).  That is a problem with the system library, not
with MySQL. To work around it, change your MySQL password to
a value that is eight or fewer characters long, or put your password in an
option file.

</P>



<H3><A NAME="Blocked_host" HREF="manual_toc.html#Blocked_host">A.2.5  <CODE>Host 'host_name' is blocked</CODE></A></H3>

<P>
If you get the following error, it means that <CODE>mysqld</CODE> has received many
connect requests from the host <CODE>'host_name'</CODE> that have been
interrupted in the middle:

</P>

<PRE>
Host 'host_name' is blocked because of many connection errors.
Unblock with 'mysqladmin flush-hosts'
</PRE>

<P>
The number of interrupted connect requests allowed is determined by the
value of the <CODE>max_connect_errors</CODE> system variable.  After
<CODE>max_connect_errors</CODE> failed requests, <CODE>mysqld</CODE> assumes that
something is wrong (for example, that someone is trying to break in), and
blocks the host from further connections until you execute a
<CODE>mysqladmin flush-hosts</CODE> command or issue a <CODE>FLUSH HOSTS</CODE>
statement.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</P>
<P>
By default, <CODE>mysqld</CODE> blocks a host after 10 connection errors.
You can adjust the value by starting the server like this:

</P>

<PRE>
shell&#62; mysqld_safe --max_connect_errors=10000 &#38;
</PRE>

<P>
If you get this error message for a given host, you should first
verify that there isn't anything wrong with TCP/IP connections from that
host.  If you are having network problems, it will do you no good to
increase the value of the <CODE>max_connect_errors</CODE> variable.

</P>



<H3><A NAME="Too_many_connections" HREF="manual_toc.html#Too_many_connections">A.2.6  <CODE>Too many connections</CODE></A></H3>

<P>
If you get a <CODE>Too many connections</CODE> error when you try to connect to the
<CODE>mysqld</CODE> server, this means that that all available connections already
are used by other clients.

</P>
<P>
The number of connections allowed is controlled by the <CODE>max_connections</CODE>
system variable. Its default value is 100.  If you need to support more
connections, you should restart <CODE>mysqld</CODE> with a larger value for this
variable.

</P>
<P>
<CODE>mysqld</CODE> actually allows <CODE>max_connections+1</CODE> clients to
connect.  The extra connection is reserved for use by accounts that have the
<CODE>SUPER</CODE> privilege.  By granting the <CODE>SUPER</CODE> privilege to
administrators and not to normal users (who should not need it), an
administrator can connect to the server and use <CODE>SHOW PROCESSLIST</CODE> to
diagnose problems even if the maximum number of unprivileged clients
already are connected.
See section <A HREF="manual.html#SHOW_PROCESSLIST">14.5.3.15  <CODE>SHOW PROCESSLIST</CODE> Syntax</A>.

</P>
<P>
The maximum number of connections MySQL can support depends on the quality of
the thread library on a given platform. Linux or Solaris should be
able to support 500-1000 simultaneous connections, depending on how much
RAM you have and what your clients are doing.

</P>



<H3><A NAME="Out_of_memory" HREF="manual_toc.html#Out_of_memory">A.2.7  <CODE>Out of memory</CODE></A></H3>

<P>
If you issue a query using the <CODE>mysql</CODE> client program and receive an
error like the following one, it means that <CODE>mysql</CODE> does not
have enough memory to store the entire query result:

</P>

<PRE>
mysql: Out of memory at line 42, 'malloc.c'
mysql: needed 8136 byte (8k), memory in use: 12481367 bytes (12189k)
ERROR 2008: MySQL client ran out of memory
</PRE>

<P>
To remedy the problem, first check whether your query is correct. Is it
reasonable that it should return so many rows? If not, correct the query and
try again. Otherwise, you can invoke <CODE>mysql</CODE> with the <CODE>--quick</CODE>
option. This causes it to use the <CODE>mysql_use_result()</CODE> to retrieve the
result set, which places less of a load on the client (but more on the
server).

</P>



<H3><A NAME="Gone_away" HREF="manual_toc.html#Gone_away">A.2.8  <CODE>MySQL server has gone away</CODE></A></H3>

<P>
This section also covers the related <CODE>Lost connection to server
during query</CODE> error.

</P>
<P>
The most common reason for the <CODE>MySQL server has gone away</CODE> error
is that the server timed out and closed the connection.  In this case,
you normally get one of the following error codes (which one you get is
operating system-dependent):

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Error Code</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>CR_SERVER_GONE_ERROR</CODE> </TD><TD> The client couldn't send a question to the
server.
</TD></TR>
<TR><TD><CODE>CR_SERVER_LOST</CODE> </TD><TD> The client didn't get an error when writing
to the server, but it didn't get a full answer (or any answer) to the question.
</TD></TR>
</TABLE>

<P>
By default, the
server closes the connection after eight hours if nothing has happened. You
can change the time limit by setting the <CODE>wait_timeout</CODE> variable when
you start <CODE>mysqld</CODE>.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</P>
<P>
If you have a script, you just have to issue the query again for the client
to do an automatic reconnection.

</P>

<P>
You will also get an error if someone has killed the running thread with a
<CODE>KILL</CODE> statement or a <CODE>mysqladmin kill</CODE> command.

</P>
<P>
Another common reason the <CODE>MySQL server has gone away</CODE> error occurs
within an application program is that you tried to run a query after
closing the connection to the server.  This indicates a logic error in the
application that should be corrected.

</P>
<P>
You can check whether the MySQL server died and restarted by executing
<CODE>mysqladmin version</CODE> and examining the server's uptime.  If the
client connection was broken because <CODE>mysqld</CODE> crashed and restarted,
you should concentrate on finding the reason for the crash.  Start by
checking whether issuing the query again kills the server again.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
You can also get these errors if you send a query to the server that is
incorrect or too large. If <CODE>mysqld</CODE> receives a packet that is too large
or out of order, it assumes that something has gone wrong with the client and
closes the connection.  If you need big queries (for example, if you are
working with big <CODE>BLOB</CODE> columns), you can increase the query limit by
setting the server's <CODE>max_allowed_packet</CODE> variable, which has a default
value of 1MB.  You may also need to increase the maximum packet size on the
client end.  More information on setting the packet size is given in
section <A HREF="manual.html#Packet_too_large">A.2.9  <CODE>Packet too large</CODE></A>.

</P>
<P>
You will also get a lost connection if you are sending a packet 16MB or larger
if your client is older than 4.0.8 and your server is 4.0.8 and above, or
the other way around.

</P>
<P>
If you want to create a bug report regarding this problem, be sure that
you include the following information:

</P>

<UL>
<LI>

Indicate whether or not the MySQL server died. You can find information
about this in the server error log.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.
<LI>

If a specific query kills <CODE>mysqld</CODE> and the tables involved were
checked with <CODE>CHECK TABLE</CODE> before you ran the query, can you provide a
reproducible test case?
See section <A HREF="manual.html#Reproduceable_test_case">D.1.6  Making a Test Case If You Experience Table Corruption</A>.
<LI>

What is the value of the <CODE>wait_timeout</CODE> system variable in the MySQL
server?  (<CODE>mysqladmin variables</CODE> gives you the value of this variable.)
<LI>

Have you tried to run <CODE>mysqld</CODE> with the <CODE>--log</CODE> option to
determine whether the problem query appears in the log?
</UL>

<P>
See section <A HREF="manual.html#Asking_questions">1.7.1.2  Asking Questions or Reporting Bugs</A>.

</P>



<H3><A NAME="Packet_too_large" HREF="manual_toc.html#Packet_too_large">A.2.9  <CODE>Packet too large</CODE></A></H3>

<P>
A communication packet is a single SQL statement sent to the MySQL server
or a single row that is sent to the client.

</P>
<P>
In MySQL 3.23, the largest possible packet is 16MB, due to limits in the
client/server protocol. In MySQL 4.0.1 and up, the limit is 1GB.

</P>

<P>
When a MySQL client or the <CODE>mysqld</CODE> server receives a packet bigger
than <CODE>max_allowed_packet</CODE> bytes, it issues a <CODE>Packet too
large</CODE> error and closes the connection.  With some clients, you may also
get a <CODE>Lost connection to MySQL server during query</CODE> error if the
communication packet is too large.

</P>
<P>
Both the client and the server have their own
<CODE>max_allowed_packet</CODE> variable, so if you want to handle big packets,
you must increase this variable both in the client and in the server.

</P>
<P>
If you are using the <CODE>mysql</CODE> client program, its default
<CODE>max_allowed_packet</CODE> variable is 16MB. That is also the maximum value
before MySQL 4.0. To set a larger value from 4.0 on, start <CODE>mysql</CODE> like
this:

</P>

<PRE>
mysql&#62; mysql --max_allowed_packet=32M
</PRE>

<P>
That sets the packet size to 32MB.

</P>
<P>
The server's default <CODE>max_allowed_packet</CODE> value is 1MB. You can increase
this if the server needs to handle big queries (for example, if you are
working with big <CODE>BLOB</CODE> columns).  For example, to set the variable to
16MB, start the server like this:

</P>

<PRE>
mysql&#62; mysqld --max_allowed_packet=16M
</PRE>

<P>
Before MySQL 4.0, use this syntax instead:

</P>

<PRE>
mysql&#62; mysqld --set-variable=max_allowed_packet=16M
</PRE>

<P>
You can also use an option file to set <CODE>max_allowed_packet</CODE>.  For
example, to set the size for the server to 16MB, add the following lines in
an option file:

</P>

<PRE>
[mysqld]
max_allowed_packet=16M
</PRE>

<P>
Before MySQL 4.0, use this syntax instead:

</P>

<PRE>
[mysqld]
set-variable = max_allowed_packet=16M
</PRE>

<P>
It's safe to increase the value of this variable because the extra memory is
allocated only when needed.  For example, <CODE>mysqld</CODE> allocates more
memory only when you issue a long query or when <CODE>mysqld</CODE> must return a
large result row.  The small default value of the variable is a
precaution to catch incorrect packets between the client and server and also
to ensure that you don't run out of memory by using large packets
accidentally.

</P>
<P>
You can also get strange problems with large packets if you are using large
<CODE>BLOB</CODE> values but have not given <CODE>mysqld</CODE> access to enough memory
to handle the query.  If you suspect this is the case, try adding
<CODE>ulimit -d 256000</CODE> to the beginning of the <CODE>mysqld_safe</CODE> script
and restarting <CODE>mysqld</CODE>.

</P>



<H3><A NAME="Communication_errors" HREF="manual_toc.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A></H3>

<P>
<A NAME="IDX2233"></A>
<A NAME="IDX2234"></A>
<A NAME="IDX2235"></A>

</P>
<P>
The server error log can be a useful source of information about connection
problems.
See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.
Starting with MySQL 3.23.40, if you start the server with the
<CODE>--warnings</CODE> option (or <CODE>--log-warnings</CODE> from MySQL 4.0.3 on), you
might find messages like this in your error log:

</P>

<PRE>
010301 14:38:23  Aborted connection 854 to db: 'users' user: 'josh'
</PRE>

<P>
If <CODE>Aborted connections</CODE> messages appear in the error log, the cause
can be any of the following:

</P>

<UL>
<LI>

The client program did not call <CODE>mysql_close()</CODE> before exiting.
<LI>

The client had been sleeping more than <CODE>wait_timeout</CODE> or
<CODE>interactive_timeout</CODE> seconds without issuing any requests to the server.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

The client program ended abruptly in the middle of a data transfer.
</UL>

<P>
When any of these things happen, the server increments the
<CODE>Aborted_clients</CODE> status variable.

</P>
<P>
The server increments the <CODE>Aborted_connects</CODE> status variable when the
following things happen:

</P>

<UL>
<LI>

A client doesn't have privileges to connect to a database.
<LI>

A client uses an incorrect password.
<LI>

A connection packet doesn't contain the right information.
<LI>

It takes more than <CODE>connect_timeout</CODE> seconds to get
a connect packet.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
</UL>

<P>
If these kinds of things happen, it might indicate that someone is
trying to break into your server!

</P>
<P>
Other reasons for problems with aborted clients or aborted connections:

</P>

<UL>
<LI>

Use of Ethernet protocol with Linux, both half and full duplex.
Many Linux Ethernet drivers have this bug. You should test for this
bug by transferring a huge file via FTP between the client and server machines.
If a transfer goes in burst-pause-burst-pause mode, you are
experiencing a Linux duplex syndrome.
The only solution is switching the duplex mode for both your network card
and hub/switch to either full duplex or to half duplex and testing the
results to determine the best setting.
<LI>

Some problem with the thread library that causes interrupts on reads.
<LI>

Badly configured TCP/IP.
<LI>

Faulty Ethernets, hubs, switches, cables, and so forth. This can be diagnosed
properly only by replacing hardware.
<LI>

The <CODE>max_allowed_packet</CODE> variable value is too small or queries require
more memory than you have allocated for <CODE>mysqld</CODE>.
See section <A HREF="manual.html#Packet_too_large">A.2.9  <CODE>Packet too large</CODE></A>.
</UL>



<H3><A NAME="Full_table" HREF="manual_toc.html#Full_table">A.2.11  <CODE>The table is full</CODE></A></H3>

<P>
<A NAME="IDX2236"></A>

</P>
<P>
There are several ways a full-table error can occur:

</P>

<UL>
<LI>

You are using a MySQL server older than 3.23 and an in-memory
temporary table becomes larger than <CODE>tmp_table_size</CODE> bytes.
To avoid this problem, you can use the <CODE>-O tmp_table_size=#</CODE> option
to make <CODE>mysqld</CODE> increase the temporary table size or use the SQL
option <CODE>SQL_BIG_TABLES</CODE> before you issue the problematic query.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.

You can also start <CODE>mysqld</CODE> with the <CODE>--big-tables</CODE> option.
This is exactly the same as using <CODE>SQL_BIG_TABLES</CODE> for all queries.

As of MySQL 3.23, this problem should not occur. If an in-memory temporary
table becomes larger than <CODE>tmp_table_size</CODE>, the server automatically
converts it to a disk-based <CODE>MyISAM</CODE> table.
<LI>

You are using <CODE>InnoDB</CODE> tables and run out of room in the
<CODE>InnoDB</CODE> tablespace. In this case, the solution is to extend the
<CODE>InnoDB</CODE> tablespace.
See section <A HREF="manual.html#Adding_and_removing">16.8  Adding and Removing <CODE>InnoDB</CODE> Data and Log Files</A>.
<LI>

You are using <CODE>ISAM</CODE> or <CODE>MyISAM</CODE> tables on an operating system
that supports files only up to 2GB in size and you have hit this limit for the
data file or index file.
<LI>

You are using a <CODE>MyISAM</CODE> table and the space required for the table
exceeds what is allowed by the internal pointer size.  (If you don't specify
the <CODE>MAX_ROWS</CODE> table option when you create a table, MySQL
uses the <CODE>myisam_data_pointer_size</CODE> system variable. Its default value of
4 bytes is enough to allow only 4GB of data.)
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

You can check the maximum data/index sizes by using this statement:

<PRE>
SHOW TABLE STATUS FROM database LIKE 'tbl_name';
</PRE>

You also can use <CODE>myisamchk -dv /path/to/table-index-file</CODE>.

If the pointer size is too small, you can fix the problem by using <CODE>ALTER
TABLE</CODE>:


<PRE>
ALTER TABLE tbl_name MAX_ROWS=1000000000 AVG_ROW_LENGTH=nnn;
</PRE>

You have to specify <CODE>AVG_ROW_LENGTH</CODE> only for tables with <CODE>BLOB</CODE>
or <CODE>TEXT</CODE> columns; in this case, MySQL can't optimize the space
required based only on the number of rows.

</UL>



<H3><A NAME="Cannot_create" HREF="manual_toc.html#Cannot_create">A.2.12  <CODE>Can't create/write to file</CODE></A></H3>

<P>
<A NAME="IDX2237"></A>

</P>
<P>
If you get an error of the following type for some queries, it means
that MySQL cannot create a temporary file for the result set in the
temporary directory:

</P>

<PRE>
Can't create/write to file '\\sqla3fe_0.ism'.
</PRE>

<P>
The preceding error is a
typical message for Windows; the Unix message is similar.
The fix is to start <CODE>mysqld</CODE> with the <CODE>--tmpdir</CODE> option or to
add the option to the <CODE>[mysqld]</CODE> section of your option file.
For example, to specify a directory of <TT>`C:\temp'</TT>, use these lines:

</P>

<PRE>
[mysqld]
tmpdir=C:/temp
</PRE>

<P>
The <TT>`C:\temp'</TT> directory must already exist. See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
Check also the error code that you get with <CODE>perror</CODE>. One reason
the server cannot write to a table is that the filesystem is full:

</P>

<PRE>
shell&#62; perror 28
Error code  28:  No space left on device
</PRE>



<H3><A NAME="Commands_out_of_sync" HREF="manual_toc.html#Commands_out_of_sync">A.2.13  <CODE>Commands out of sync</CODE></A></H3>

<P>
<A NAME="IDX2238"></A>

</P>
<P>
If you get <CODE>Commands out of sync; you can't run this command now</CODE>
in your client code, you are calling client functions in the wrong order.

</P>
<P>
This can happen, for example, if you are using <CODE>mysql_use_result()</CODE> and
try to execute a new query before you have called <CODE>mysql_free_result()</CODE>.
It can also happen if you try to execute two queries that return data without
calling <CODE>mysql_use_result()</CODE> or <CODE>mysql_store_result()</CODE> in between.

</P>



<H3><A NAME="Ignoring_user" HREF="manual_toc.html#Ignoring_user">A.2.14  <CODE>Ignoring user</CODE></A></H3>

<P>
If you get the following error, it means that when <CODE>mysqld</CODE> was started
or when it reloaded the grant tables, it found an account in the <CODE>user</CODE>
table that had an invalid password.

</P>
<P>
<CODE>Found wrong password for user: 'some_user'@'some_host'; ignoring user</CODE>

</P>
<P>
As a result, the account is simply ignored by the permission system.

</P>
<P>
The following list indicates possible causes of and fixes for this problem:

</P>

<UL>
<LI>

You may be running a new version of <CODE>mysqld</CODE> with an old <CODE>user</CODE>
table.  You can check this by executing <CODE>mysqlshow mysql user</CODE> to see
whether the <CODE>Password</CODE> column is shorter than 16 characters. If so, you
can correct this condition by running the <CODE>scripts/add_long_password</CODE>
script.

<LI>

The account has an old password (eight characters long) and you didn't start
<CODE>mysqld</CODE> with the <CODE>--old-protocol</CODE> option.
Update the account in the <CODE>user</CODE> table to have a new password or
restart <CODE>mysqld</CODE> with the <CODE>--old-protocol</CODE> option.

<LI>

<A NAME="IDX2239"></A>
You have specified a password in the <CODE>user</CODE> table without using the
<CODE>PASSWORD()</CODE> function.  Use <CODE>mysql</CODE> to update the account in the
<CODE>user</CODE> table with a new password, making sure to use the <CODE>PASSWORD()</CODE>
function:


<PRE>
mysql&#62; UPDATE user SET Password=PASSWORD('newpwd')
    -&#62; WHERE User='some_user' AND Host='some_host';
</PRE>

</UL>



<H3><A NAME="Cannot_find_table" HREF="manual_toc.html#Cannot_find_table">A.2.15  <CODE>Table 'tbl_name' doesn't exist</CODE></A></H3>

<P>
If you get either of the following errors, it usually means that no table
exists in the current database with the given name:

</P>

<PRE>
Table 'tbl_name' doesn't exist
Can't find file: 'tbl_name' (errno: 2)
</PRE>

<P>
In some cases, it may be that the table does exist but that you are
referring to it incorrectly:

</P>

<UL>
<LI>

Because MySQL uses directories and files to store databases and
tables, database and table names are case sensitive if they are located on
a filesystem that has case-sensitive filenames.

<LI>

Even for filesystems that are not case sensitive, such as on Windows, all
references to a given table within a query must use the same lettercase.

</UL>

<P>
You can check which tables you have in the current database with
<CODE>SHOW TABLES</CODE>. See section <A HREF="manual.html#SHOW">14.5.3  <CODE>SET</CODE> and <CODE>SHOW</CODE> Syntax</A>.

</P>



<H3><A NAME="Cannot_initialize_character_set" HREF="manual_toc.html#Cannot_initialize_character_set">A.2.16  <CODE>Can't initialize character set</CODE></A></H3>

<P>
<A NAME="IDX2240"></A>

</P>
<P>
You might see an error like this if you have character set problems:

</P>

<PRE>
MySQL Connection Failed: Can't initialize character set charset_name
</PRE>

<P>
This error can have any of the following causes:

</P>

<UL>
<LI>

The character set is a multi-byte character set and you have no support
for the character set in the client.
In this case, you need to recompile the client by running <CODE>configure</CODE>
with the <CODE>--with-charset=charset_name</CODE> or
<CODE>--with-extra-charsets=charset_name</CODE>
option.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

All standard MySQL binaries are compiled with
<CODE>--with-extra-character-sets=complex</CODE>, which enables support for
all multi-byte character sets. See section <A HREF="manual.html#Character_sets">5.7.1  The Character Set Used for Data and Sorting</A>.

<LI>

The character set is a simple character set that is not compiled into
<CODE>mysqld</CODE>, and the character set definition files are not in the place
where the client expects to find them.

In this case, you need to use one of the following methods to solve the problem:


<UL>
<LI>

Recompile the client with support for the character set.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.
<LI>

Specify to the client the directory where the character set definition files
are located. For many clients, you can do this with the
<CODE>--character-sets-dir</CODE> option.
<LI>

Copy the character definition files to the path where the client expects them
to be.
</UL>

</UL>



<H3><A NAME="Not_enough_file_handles" HREF="manual_toc.html#Not_enough_file_handles">A.2.17  File Not Found</A></H3>

<P>
If you get <CODE>ERROR '...' not found (errno: 23)</CODE>, <CODE>Can't open file:
... (errno: 24)</CODE>, or any other error with <CODE>errno 23</CODE> or <CODE>errno 24</CODE>
from MySQL, it means that you haven't allocated enough file descriptors for
the MySQL server.  You can use the <CODE>perror</CODE> utility to get a
description of what the error number means:

</P>

<PRE>
shell&#62; perror 23
File table overflow
shell&#62; perror 24
Too many open files
shell&#62; perror 11
Resource temporarily unavailable
</PRE>

<P>
The problem here is that <CODE>mysqld</CODE> is trying to keep open too many
files simultaneously.  You can either tell <CODE>mysqld</CODE> not to open so
many files at once or increase the number of file descriptors
available to <CODE>mysqld</CODE>.

</P>
<P>
To tell <CODE>mysqld</CODE> to keep open fewer files at a time, you can make the
table cache smaller by reducing the value of the <CODE>table_cache</CODE> system
variable (the default value is 64). Reducing the value of
<CODE>max_connections</CODE> also will reduce the number of open files (the
default value is 100).

</P>
<P>
<A NAME="IDX2241"></A>
To change the number of file descriptors available to <CODE>mysqld</CODE>, you can
use the <CODE>--open-files-limit</CODE> option to <CODE>mysqld_safe</CODE> or (as of
MySQL 3.23.30) set the <CODE>open_files_limit</CODE> system variable.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
The easiest way to set these values is to add an option to your option file.
See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.  If you have an old version of <CODE>mysqld</CODE> that
doesn't support setting the open files limit, you can edit the
<CODE>mysqld_safe</CODE> script.  There is a commented-out line <CODE>ulimit -n
256</CODE> in the script.  You can remove the <SAMP>`#'</SAMP> character to uncomment
this line, and change the number <CODE>256</CODE> to set the number of file
descriptors available to <CODE>mysqld</CODE>.

</P>
<P>
<CODE>--open-files-limit</CODE> and <CODE>ulimit</CODE> can increase the number of file
descriptors, but only up to the limit imposed by the operating system. There
is also a ``hard'' limit that can be overridden only if you start
<CODE>mysqld_safe</CODE> or <CODE>mysqld</CODE> as <CODE>root</CODE> (just remember that you
also need to start the server with the <CODE>--user</CODE> option in this case so
that it does not continue to run as <CODE>root</CODE> after it starts up).
If you need to increase the operating system limit on the number of file
descriptors available to each process, consult the documentation for your
system.

</P>
<P>
<STRONG>Note:</STRONG> If you run the <CODE>tcsh</CODE> shell, <CODE>ulimit</CODE> will not work!
<CODE>tcsh</CODE> will also report incorrect values when you ask for the current
limits.  In this case, you should start <CODE>mysqld_safe</CODE> using <CODE>sh</CODE>.

</P>



<H2><A NAME="Installation_Issues" HREF="manual_toc.html#Installation_Issues">A.3  Installation-Related Issues</A></H2>



<H3><A NAME="Link_errors" HREF="manual_toc.html#Link_errors">A.3.1  Problems Linking to the MySQL Client Library</A></H3>

<P>
<A NAME="IDX2242"></A>
<A NAME="IDX2243"></A>
<A NAME="IDX2244"></A>

</P>
<P>
When you are linking an application program to use the MySQL client library,
you might get undefined reference errors for symbols that start with <CODE>mysql_</CODE>,
such as those shown here:

</P>

<PRE>
/tmp/ccFKsdPa.o: In function `main':
/tmp/ccFKsdPa.o(.text+0xb): undefined reference to `mysql_init'
/tmp/ccFKsdPa.o(.text+0x31): undefined reference to `mysql_real_connect'
/tmp/ccFKsdPa.o(.text+0x57): undefined reference to `mysql_real_connect'
/tmp/ccFKsdPa.o(.text+0x69): undefined reference to `mysql_error'
/tmp/ccFKsdPa.o(.text+0x9a): undefined reference to `mysql_close'
</PRE>

<P>
You should be able to solve this problem by adding <CODE>-Ldir_path
-lmysqlclient</CODE> at the end of your link command, where <CODE>dir_path</CODE>
represents the pathname of the directory where the client library is
located. To determine the correct directory, try this command:

</P>

<PRE>
shell&#62; mysql_config --libs
</PRE>

<P>
The output from <CODE>mysql_config</CODE> might indicate other libraries that
should be specified on the link command as well.

</P>
<P>
If you get <CODE>undefined reference</CODE> errors for the <CODE>uncompress</CODE>
or <CODE>compress</CODE> function, add <CODE>-lz</CODE> to the end of your
link command and try again.

</P>
<P>
If you get <CODE>undefined reference</CODE> errors for a function that should
exist on your system, such as <CODE>connect</CODE>, check the manual page for the
function in question to determine which libraries you should add to the link
command.

</P>
<P>
You might get <CODE>undefined reference</CODE> errors such as the following for
functions that don't exist on your system:

</P>

<PRE>
mf_format.o(.text+0x201): undefined reference to `__lxstat'
</PRE>

<P>
This usually means that your MySQL client library was compiled on a system
that is not 100% compatible with yours.  In this case, you should download
the latest MySQL source distribution and compile MySQL yourself.
See section <A HREF="manual.html#Installing_source">2.3  MySQL Installation Using a Source Distribution</A>.

</P>
<P>
You might get undefined reference errors at runtime when you try to execute a
MySQL program. If these errors specify symbols that start with <CODE>mysql_</CODE>
or indicate that the <CODE>mysqlclient</CODE> library can't be found, it means
that your system can't find the shared <TT>`libmysqlclient.so'</TT> library.
The fix for this is to tell your system to search for shared libraries
where the library is located. Use whichever of the following methods is
appropriate for your system:

</P>

<UL>
<LI>

Add the path to the directory where <TT>`libmysqlclient.so'</TT> is located to the
<CODE>LD_LIBRARY_PATH</CODE> environment variable.
<LI>

Add the path to the directory where <TT>`libmysqlclient.so'</TT> is located to the
<CODE>LD_LIBRARY</CODE> environment variable.
<LI>

Copy <TT>`libmysqlclient.so'</TT> to some directory that is searched by your system,
such as <TT>`/lib'</TT>, and update the shared library information by executing
<CODE>ldconfig</CODE>.
</UL>

<P>
Another way to solve this problem is by linking your program statically with
the <CODE>-static</CODE> option, or by removing the dynamic MySQL libraries
before linking your code. Before trying the second method, you should be
sure that no other programs are using the dynamic libraries.

</P>



<H3><A NAME="Changing_MySQL_user" HREF="manual_toc.html#Changing_MySQL_user">A.3.2  How to Run MySQL as a Normal User</A></H3>

<P>
<A NAME="IDX2245"></A>
<A NAME="IDX2246"></A>

</P>
<P>
On Windows, you can run the server as a Windows service using normal user
accounts beginning with MySQL 4.0.17 and 4.1.2.  (Older MySQL versions
required you to have administrator rights.  This was a bug introduced in
MySQL 3.23.54.)

</P>
<P>
On Unix, the MySQL server <CODE>mysqld</CODE> can be started and run by any user.
However, you should avoid running the server as the Unix <CODE>root</CODE> user
for security reasons.  In order to change <CODE>mysqld</CODE> to run as a normal
unprivileged Unix user <CODE>user_name</CODE>, you must do the following:

</P>

<OL>
<LI>

Stop the server if it's running (use <CODE>mysqladmin shutdown</CODE>).

<LI>

Change the database directories and files so that <CODE>user_name</CODE> has
privileges to read and write files in them (you might need to do this as
the Unix <CODE>root</CODE> user):


<PRE>
shell&#62; chown -R user_name /path/to/mysql/datadir
</PRE>

If you do not do this, the server will not be able to access databases or tables when it
runs as <CODE>user_name</CODE>.

If directories or files within the MySQL data directory are symbolic links,
you'll also need to follow those links and change the directories and files
they point to.  <CODE>chown -R</CODE> might not follow symbolic links for you.

<LI>

Start the server as user <CODE>user_name</CODE>. If you are using MySQL 3.22 or
later, another alternative is to start <CODE>mysqld</CODE> as the Unix <CODE>root</CODE>
user and use the <CODE>--user=user_name</CODE> option.  <CODE>mysqld</CODE> will start up,
then switch
to run as the Unix user <CODE>user_name</CODE> before accepting any connections.

<LI>

To start the server as the given user automatically at system
startup time, specify the username by adding a <CODE>user</CODE> option to
the <CODE>[mysqld]</CODE> group of the <TT>`/etc/my.cnf'</TT> option file or the
<TT>`my.cnf'</TT> option file in the server's data directory. For example:


<PRE>
[mysqld]
user=user_name
</PRE>

</OL>

<P>
If your Unix machine itself isn't secured, you should assign passwords
to the MySQL <CODE>root</CODE> accounts in the grant tables.  Otherwise, any
user with a login account on that machine can run <CODE>mysql</CODE> with a
<CODE>--user=root</CODE> option and perform any operation.  (It is a good idea to
assign passwords to MySQL accounts in any case, but especially so when
other login accounts exist on the server host.)
See section <A HREF="manual.html#Post-installation">2.4  Post-Installation Setup and Testing</A>.

</P>



<H3><A NAME="File_permissions" HREF="manual_toc.html#File_permissions">A.3.3  Problems with File Permissions</A></H3>

<P>
<A NAME="IDX2247"></A>
<A NAME="IDX2248"></A>
<A NAME="IDX2249"></A>

</P>
<P>
<A NAME="IDX2250"></A>
<A NAME="IDX2251"></A>
If you have problems with file permissions, the <CODE>UMASK</CODE> environment
variable might be set incorrectly when <CODE>mysqld</CODE> starts.  For example,
MySQL might issue the following error message when you create a table:

</P>

<PRE>
ERROR: Can't find file: 'path/with/filename.frm' (Errcode: 13)
</PRE>

<P>
The default umask value is <CODE>0660</CODE>. You can change this behavior by
starting <CODE>mysqld_safe</CODE> as follows:

</P>

<PRE>
shell&#62; UMASK=384  # = 600 in octal
shell&#62; export UMASK
shell&#62; mysqld_safe &#38;
</PRE>

<P>
<A NAME="IDX2252"></A>
<A NAME="IDX2253"></A>

</P>
<P>
By default, MySQL creates database and <CODE>RAID</CODE> directories
with an access permission value of <CODE>0700</CODE>.  You can modify this
behavior by setting the <CODE>UMASK_DIR</CODE> variable. If you set its value, new
directories are created with the combined <CODE>UMASK</CODE> and <CODE>UMASK_DIR</CODE>
values. For example, if you want to give group access to all new
directories, you can do this:

</P>

<PRE>
shell&#62; UMASK_DIR=504  # = 770 in octal
shell&#62; export UMASK_DIR
shell&#62; mysqld_safe &#38;
</PRE>

<P>
In MySQL 3.23.25 and above, MySQL assumes that the
value for <CODE>UMASK</CODE> and <CODE>UMASK_DIR</CODE> is in octal if it starts
with a zero.

</P>
<P>
See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</P>



<H2><A NAME="Administration_Issues" HREF="manual_toc.html#Administration_Issues">A.4  Administration-Related Issues</A></H2>



<H3><A NAME="Resetting_permissions" HREF="manual_toc.html#Resetting_permissions">A.4.1  How to Reset the Root Password</A></H3>

<P>
<A NAME="IDX2254"></A>
<A NAME="IDX2255"></A>
<A NAME="IDX2256"></A>
<A NAME="IDX2257"></A>

</P>
<P>
If you have never set a <CODE>root</CODE> password for MySQL, the server will
not require a password at all for connecting as <CODE>root</CODE>. However, it is
recommended to set a password for each account. See section <A HREF="manual.html#Security_guidelines">5.3.1  General Security Guidelines</A>.

</P>
<P>
If you set a <CODE>root</CODE> password previously, but have forgotten what it
was, you can set a new password. The following procedure is for Windows
systems. The procedure for Unix systems is given later in this section.

</P>
<P>
The procedure under Windows:

</P>

<OL>
<LI>

Log on to your system as Administrator.
<LI>

Stop the MySQL server if it is running. For a server that is running as a
Windows service, go to the Services manager:

<PRE>
Start Menu -&#62; Control Panel -&#62; Administrative Tools -&#62; Services
</PRE>

Then find the MySQL service in the list, and stop it.

If your server is not running as a service, you may need to use the Task
Manager to force it to stop.
<LI>

Open a console window to get to the DOS command prompt:

<PRE>
Start Menu -&#62; Run -&#62; cmd
</PRE>

<LI>

We are assuming that you installed MySQL to <TT>`C:\mysql'</TT>. If you installed
MySQL to another location, adjust the following commands accordingly.

At the DOS command prompt, execute this command:

<PRE>
C:\&#62; C:\mysql\bin\mysqld-nt --skip-grant-tables
</PRE>

This starts the server in a special mode that does not check the grant
tables to control access.
<LI>

Keeping the first console window open, open a second console window and
execute the following commands (type each on a single line):

<PRE>
C:\&#62; C:\mysql\bin\mysqladmin -u root
         flush-privileges password "newpwd"
C:\&#62; C:\mysql\bin\mysqladmin -u root -p shutdown
</PRE>

Replace ``<CODE>newpwd</CODE>'' with the actual <CODE>root</CODE> password that you want
to use.
The second command will prompt you to enter the new password for access.
Enter the password that you assigned in the first command.
<LI>

Stop the MySQL server, then restart it in normal mode again.
If you run the server as a service, start it from the Windows Services
window.  If you start the server manually, use whatever command you
normally use.
<LI>

You should now be able to connect using the new password.
</OL>

<P>
In a Unix environment, the procedure for resetting the <CODE>root</CODE> password
is as follows:

</P>

<OL>
<LI>

Log on to your system as either the Unix <CODE>root</CODE> user or as the
same user that the <CODE>mysqld</CODE> server runs as.
<LI>

Locate the <TT>`.pid'</TT> file that contains the server's process ID.
The exact location and name of this file depend on your distribution,
hostname, and configuration. Common locations are: <TT>`/var/lib/mysql/'</TT>,
<TT>`/var/run/mysqld/'</TT>, and <TT>`/usr/local/mysql/data/'</TT>. Generally, the
filename has the extension of <TT>`.pid'</TT> and begins with either
<TT>`mysqld'</TT> or your system's hostname.

Now you can stop the MySQL server by sending a normal <CODE>kill</CODE>
(not <CODE>kill -9</CODE>) to the <CODE>mysqld</CODE> process, using the name of the
<TT>`.pid'</TT> file in the following command:

<PRE>
shell&#62; kill `cat /mysql-data-directory/host_name.pid`
</PRE>

Note the use of backticks rather than forward quotes with the <CODE>cat</CODE>
command; these cause the output of <CODE>cat</CODE>
to be substituted into the <CODE>kill</CODE> command.
<LI>

Restart the MySQL server with the special <CODE>--skip-grant-tables</CODE> option:

<PRE>
shell&#62; mysqld_safe --skip-grant-tables &#38;
</PRE>

<LI>

Set a new password for the <CODE>root@localhost</CODE> MySQL account:

<PRE>
shell&#62; mysqladmin -u root flush-privileges password "newpwd"
</PRE>

Replace ``<CODE>newpwd</CODE>'' with the actual <CODE>root</CODE> password that you want
to use.
<LI>

You should now be able to connect using the new password.
</OL>

<P>
Alternatively, on any platform, you can set the new password using the <CODE>mysql</CODE> client:

<OL>
<LI>

Stop <CODE>mysqld</CODE> and restart it with the <CODE>--skip-grant-tables</CODE>
option as described earlier.
<LI>

Connect to the <CODE>mysqld</CODE> server with this command:

<PRE>
shell&#62; mysql -u root
</PRE>

<LI>

Issue the following statements in the <CODE>mysql</CODE> client:

<PRE>
mysql&#62; UPDATE mysql.user SET Password=PASSWORD('newpwd')
    -&#62;                   WHERE User='root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

Replace ``<CODE>newpwd</CODE>'' with the actual <CODE>root</CODE> password that you want
to use.
<LI>

You should now be able to connect using the new password.
</OL>



<H3><A NAME="Crashing" HREF="manual_toc.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A></H3>

<P>
<A NAME="IDX2258"></A>

</P>
<P>
Each MySQL version is tested on many platforms before it is
released.  This doesn't mean that there are no bugs in
MySQL, but if there are bugs, they should be very few and can be
hard to find.  If you have a problem, it will always help if you try to
find out exactly what crashes your system, because you will have a much better
chance of getting the problem fixed quickly.

</P>
<P>
First, you should try to find out whether the problem is that the <CODE>mysqld</CODE> server dies or whether your problem has to do with your
client.  You can check how long your <CODE>mysqld</CODE> server has been up by
executing <CODE>mysqladmin version</CODE>.  If <CODE>mysqld</CODE> has died and
restarted, you may find the reason by looking in the server's error log.
See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.

</P>
<P>
On some systems, you can find in the error log a stack trace of where
<CODE>mysqld</CODE> died that you can resolve with the <CODE>resolve_stack_dump</CODE>
program.  See section <A HREF="manual.html#Using_stack_trace">D.1.4  Using a Stack Trace</A>. Note that the variable values written in
the error log may not always be 100% correct.

</P>
<P>
Many server crashes are caused by corrupted data files or index files.  MySQL
will update the files on disk with the <CODE>write()</CODE> system call after every
SQL statement and before the client is notified about the result. (This is
not true if you are running with <CODE>--delay-key-write</CODE>, in which case
data files are written but not index files.) This means that data file
contents are safe even
if <CODE>mysqld</CODE> crashes, because the operating system will ensure that the
unflushed data is written to disk.  You can force MySQL to flush everything
to disk after every SQL statement by starting <CODE>mysqld</CODE> with the
<CODE>--flush</CODE> option.

</P>
<P>
The preceding means that normally you should not get corrupted tables unless
one of the following happens:

</P>

<UL>
<LI>

The MySQL server or the server host was killed in the middle of an update.
<LI>

You have found a bug in <CODE>mysqld</CODE> that caused it to die in the
middle of an update.
<LI>

Some external program is manipulating data files or index files at the same
time as <CODE>mysqld</CODE> without locking the table properly.
<LI>

You are running many <CODE>mysqld</CODE> servers using the same data directory on
a system that doesn't support good filesystem locks (normally handled by the
<CODE>lockd</CODE> lock manager), or you are running multiple servers with the
<CODE>--skip-external-locking</CODE> option.
<LI>

You have a crashed data file or index file that contains very corrupt data that
confused <CODE>mysqld</CODE>.
<LI>

You have found a bug in the data storage code. This isn't likely, but it's
at least possible.  In this case, you can try to change the table type to
another storage engine by using <CODE>ALTER TABLE</CODE> on a repaired copy of the
table.
</UL>

<P>
Because it is very difficult to know why something is crashing, first try to
check whether things that work for others crash for you.  Please try
the following things:

</P>

<UL>
<LI>

Stop the <CODE>mysqld</CODE> server with <CODE>mysqladmin shutdown</CODE>, run
<CODE>myisamchk --silent --force */*.MYI</CODE> from the data directory to check
all <CODE>MyISAM</CODE> tables, and restart <CODE>mysqld</CODE>.  This will ensure that
you are running from a clean state.
See section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>.

<LI>

Start <CODE>mysqld</CODE> with the <CODE>--log</CODE> option and try to determine
from the information written to the log whether some specific query kills
the server. About 95% of all bugs are related to a particular query.
Normally, this will be one of the last queries in the log file just before
the server restarts.
See section <A HREF="manual.html#Query_log">5.8.2  The General Query Log</A>.
If you can repeatedly kill MySQL with a specific query, even
when you have checked all tables just before issuing it, then you
have been able to locate the bug and should submit a bug report for it.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

<LI>

Try to make a test case that we can use to repeat the problem.
See section <A HREF="manual.html#Reproduceable_test_case">D.1.6  Making a Test Case If You Experience Table Corruption</A>.

<LI>

Try running the tests in the <TT>`mysql-test'</TT> directory and the MySQL
benchmarks.  See section <A HREF="manual.html#MySQL_test_suite">22.1.2  MySQL Test Suite</A>.  They should test MySQL
rather well.  You can also add code to the benchmarks that simulates
your application.  The benchmarks can be found in the <TT>`sql-bench'</TT>
directory in a source distribution or, for a binary distribution, in
the <TT>`sql-bench'</TT> directory under your MySQL installation
directory.

<LI>

Try the <CODE>fork_big.pl</CODE> script.  (It is located in the <TT>`tests'</TT>
directory of source distributions.)

<LI>

If you configure MySQL for debugging, it will be much easier to
gather information about possible errors if something goes wrong.
Configuring MySQL for debugging causes a safe memory allocator to be
included that can find some errors. It also provides a lot of output
about what is happening.  Reconfigure MySQL with the <CODE>--with-debug</CODE>
or <CODE>--with-debug=full</CODE> option to <CODE>configure</CODE> and then recompile.
See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>.

<LI>

Make sure that you have applied the latest patches for your operating system.

<LI>

Use the <CODE>--skip-external-locking</CODE> option to <CODE>mysqld</CODE>.  On some
systems, the <CODE>lockd</CODE> lock manager does not work properly; the
<CODE>--skip-external-locking</CODE> option tells <CODE>mysqld</CODE> not to use external
locking.  (This means that you cannot run two <CODE>mysqld</CODE> servers on the same
data directory and that you must be careful if you use <CODE>myisamchk</CODE>.
Nevertheless, it may be instructive to try the option as a test.)

<LI>

Have you tried <CODE>mysqladmin -u root processlist</CODE> when <CODE>mysqld</CODE>
appears to be running but not responding?  Sometimes <CODE>mysqld</CODE> is not
comatose even though you might think so.  The problem may be that all
connections are in use, or there may be some internal lock problem.
<CODE>mysqladmin -u root processlist</CODE> usually will be able to make a
connection even in these cases, and can provide useful information about the
current number of connections and their status.

<LI>

Run the command <CODE>mysqladmin -i 5 status</CODE> or <CODE>mysqladmin -i 5
-r status</CODE> in a separate window to produce statistics while you run
your other queries.

<LI>

Try the following:

<OL>
<LI>

Start <CODE>mysqld</CODE> from <CODE>gdb</CODE> (or another debugger).
See section <A HREF="manual.html#Using_gdb_on_mysqld">D.1.3  Debugging <CODE>mysqld</CODE> under <CODE>gdb</CODE></A>.

<LI>

Run your test scripts.

<LI>

Print the backtrace and the local variables at the three lowest levels. In
<CODE>gdb</CODE>, you can do this with the following commands when <CODE>mysqld</CODE>
has crashed inside <CODE>gdb</CODE>:


<PRE>
backtrace
info local
up
info local
up
info local
</PRE>

With <CODE>gdb</CODE>, you can also examine which threads exist with <CODE>info
threads</CODE> and switch to a specific thread with <CODE>thread #</CODE>, where
<CODE>#</CODE> is the thread ID.
</OL>

<LI>

Try to simulate your application with a Perl script to force
MySQL to crash or misbehave.

<LI>

Send a normal bug report. See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>. Be even more detailed
than usual.  Because MySQL works for many people, it may be that the
crash results from something that exists only on your computer (for example,
an error that is related to your particular system libraries).
<LI>

If you have a problem with tables containing dynamic-length rows and you are
using only <CODE>VARCHAR</CODE> columns (not <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns), you
can try to change all <CODE>VARCHAR</CODE> to <CODE>CHAR</CODE> with <CODE>ALTER
TABLE</CODE>.  This will force MySQL to use fixed-size rows.
Fixed-size rows take a little extra space, but are much more tolerant to
corruption.

The current dynamic row code has been in use at MySQL AB for several years
with very few problems, but dynamic-length rows are by nature more prone to
errors, so it may be a good idea to try this strategy to see whether it helps.

</UL>



<H3><A NAME="Full_disk" HREF="manual_toc.html#Full_disk">A.4.3  How MySQL Handles a Full Disk</A></H3>

<P>
<A NAME="IDX2259"></A>
<A NAME="IDX2260"></A>

</P>
<P>
When a disk-full condition occurs, MySQL does the following:

</P>

<UL>
<LI>

It checks once every minute to see whether there is enough space to
write the current row. If there is enough space, it continues as if nothing had
happened.
<LI>

Every six minutes it writes an entry to the log file, warning about the
disk-full condition.
</UL>

<P>
To alleviate the problem, you can take the following actions:

</P>

<UL>
<LI>

To continue, you only have to free enough disk space to insert all records.
<LI>

To abort the thread, you must use <CODE>mysqladmin kill</CODE>.
The thread will be aborted the next time it checks the disk (in one minute).
<LI>

Other threads might be waiting for the table that caused the disk-full
condition.  If you have several ``locked'' threads, killing the one thread
that is waiting on the disk-full condition will allow the other threads to
continue.
</UL>

<P>
Exceptions to the preceding behavior are when you use <CODE>REPAIR TABLE</CODE> or
<CODE>OPTIMIZE TABLE</CODE> or when the indexes are created in a batch after
<CODE>LOAD DATA INFILE</CODE> or after an <CODE>ALTER TABLE</CODE> statement.
All of these statements may create large temporary files that, if left to
themselves, would cause big problems for the rest of the system.  If the disk
becomes full while MySQL is doing any of these operations,
it will remove the big temporary files and mark the table as crashed.
The exception is that for <CODE>ALTER TABLE</CODE>, the old table will be left
unchanged.

</P>



<H3><A NAME="Temporary_files" HREF="manual_toc.html#Temporary_files">A.4.4  Where MySQL Stores Temporary Files</A></H3>

<P>
MySQL uses the value of the <CODE>TMPDIR</CODE> environment variable as the
pathname of the directory in which to store temporary files.  If you don't
have <CODE>TMPDIR</CODE> set, MySQL uses the system default, which is normally
<TT>`/tmp'</TT>, <TT>`/var/tmp'</TT>, or <TT>`/usr/tmp'</TT>.  If the filesystem
containing your temporary file directory is too small, you can use the
<CODE>--tmpdir</CODE> option to <CODE>mysqld</CODE> to specify a directory in a
filesystem where you have enough space.

</P>
<P>
Starting from MySQL 4.1, the <CODE>--tmpdir</CODE> option can be set to a list
of several paths that are used in round-robin fashion. Paths should be
separated by colon characters (<SAMP>`:'</SAMP>) on Unix and semicolon characters
(<SAMP>`;'</SAMP>) on Windows, NetWare, and OS/2.  <STRONG>Note:</STRONG> To spread the load
between several physical disks, these paths should be located on different
<EM>physical</EM> disks, not different partitions of the same disk.

</P>
<P>
If the MySQL server is acting as a replication slave, you should not set
<CODE>--tmpdir</CODE> to point to a directory on a memory-based filesystem or to a
directory that is cleared when the server host restarts.  A replication
slave needs some of its temporary files to survive a machine restart so that
it can replicate temporary tables or <CODE>LOAD DATA INFILE</CODE> operations. If
files in the temporary file directory are lost when the server restarts,
replication will fail.

</P>
<P>
MySQL creates all temporary files as hidden files. This ensures
that the temporary files will be removed if <CODE>mysqld</CODE> is terminated.  The
disadvantage of using hidden files is that you will not see a big temporary
file that fills up the filesystem in which the temporary file directory is
located.

</P>
<P>
When sorting (<CODE>ORDER BY</CODE> or <CODE>GROUP BY</CODE>), MySQL normally
uses one or two temporary files. The maximum disk space required is determined
by the following expression:

</P>

<PRE>
(length of what is sorted + sizeof(row pointer))
* number of matched rows
* 2
</PRE>

<P>
The row pointer size is usually four bytes, but may grow in the future for
really big tables.

</P>
<P>
For some <CODE>SELECT</CODE> queries, MySQL also creates temporary SQL
tables. These are not hidden and have names of the form <TT>`SQL_*'</TT>.

</P>
<P>
<CODE>ALTER TABLE</CODE> creates a temporary table in the same directory as
the original table.

</P>


<H3><A NAME="Problems_with_mysql.sock" HREF="manual_toc.html#Problems_with_mysql.sock">A.4.5  How to Protect or Change the MySQL Socket File <TT>`/tmp/mysql.sock'</TT></A></H3>

<P>
<A NAME="IDX2261"></A>
<A NAME="IDX2262"></A>

</P>
<P>
The default location for the Unix socket file that the server uses for
communication with local clients is <TT>`/tmp/mysql.sock'</TT>.  This might
cause problems, because on some versions of Unix, anyone can delete files
in the <TT>`/tmp'</TT> directory.

</P>
<P>
On most versions of Unix, you can protect your <TT>`/tmp'</TT> directory so that
files can be deleted only by their owners or the superuser (<CODE>root</CODE>).
To do this, set the <CODE>sticky</CODE> bit on the <TT>`/tmp'</TT> directory by
logging in as <CODE>root</CODE> and using the following command:

</P>

<PRE>
shell&#62; chmod +t /tmp
</PRE>

<P>
You can check whether the <CODE>sticky</CODE> bit is set by executing <CODE>ls -ld
/tmp</CODE>.  If the last permission character is <CODE>t</CODE>, the bit is set.

</P>
<P>
<A NAME="IDX2263"></A>

</P>
<P>
Another approach is to change the place where the server creates the Unix
socket file. If you do this, you should also let client programs know the
new location of the file.  You can specify the file location in several
ways:

</P>

<UL>
<LI>

Specify the path in a global or local option file.
For example, put the following lines in <CODE>/etc/my.cnf</CODE>:


<PRE>
[mysqld]
socket=/path/to/socket

[client]
socket=/path/to/socket
</PRE>

See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

<LI>

Specify a <CODE>--socket</CODE> option on the command line
to <CODE>mysqld_safe</CODE> and when you run client programs.

<LI>

Set the <CODE>MYSQL_UNIX_PORT</CODE> environment variable to the path of the Unix
socket file.

<LI>

Recompile MySQL from source to use a different default Unix socket
file location.  Define the path to the file with the
<CODE>--with-unix-socket-path</CODE>  option when you run <CODE>configure</CODE>.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

</UL>

<P>
You can test whether the new socket location works by attempting to connect to
the server with this command:

</P>

<PRE>
shell&#62; mysqladmin --socket=/path/to/socket version
</PRE>



<H3><A NAME="Timezone_problems" HREF="manual_toc.html#Timezone_problems">A.4.6  Time Zone Problems</A></H3>

<P>
<A NAME="IDX2264"></A>
<A NAME="IDX2265"></A>

</P>
<P>
<A NAME="IDX2266"></A>
<A NAME="IDX2267"></A>

</P>
<P>
If you have a problem with <CODE>SELECT NOW()</CODE> returning values in GMT and
not your local time, you have to tell the server your current time zone.
The same applies if <CODE>UNIX_TIMESTAMP()</CODE> returns the wrong value.
This should be done for the environment in which the server runs; for
example, in <CODE>mysqld_safe</CODE> or <CODE>mysql.server</CODE>.
See section <A HREF="manual.html#Environment_variables">E  Environment Variables</A>.

</P>
<P>
You can set the time zone for the server with the
<CODE>--timezone=timezone_name</CODE> option to <CODE>mysqld_safe</CODE>.  You can
also set it by setting the <CODE>TZ</CODE> environment variable before you
start <CODE>mysqld</CODE>.

</P>
<P>
The allowable values for <CODE>--timezone</CODE> or <CODE>TZ</CODE> are
system-dependent. Consult your operating system documentation to see
what values are acceptable.

</P>


<H2><A NAME="Query_Issues" HREF="manual_toc.html#Query_Issues">A.5  Query-Related Issues</A></H2>



<H3><A NAME="Case_sensitivity" HREF="manual_toc.html#Case_sensitivity">A.5.1  Case Sensitivity in Searches</A></H3>

<P>
<A NAME="IDX2268"></A>
<A NAME="IDX2269"></A>
<A NAME="IDX2270"></A>
<A NAME="IDX2271"></A>

</P>
<P>
By default, MySQL searches are not case sensitive (although there are
some character sets that are never case insensitive, such as <CODE>czech</CODE>).
This means that if you search with <CODE>col_name LIKE 'a%'</CODE>, you will get all
column values that start with <CODE>A</CODE> or <CODE>a</CODE>. If you want to make this
search case sensitive, make sure that one of the operands is a binary string.
You can do this with the <CODE>BINARY</CODE> operator. Write the condition as either
<CODE>BINARY col_name LIKE 'a%'</CODE> or <CODE>col_name LIKE BINARY 'a%'</CODE>.

</P>
<P>
If you want a column always to be treated in case-sensitive fashion,
declare it as <CODE>BINARY</CODE>. See section <A HREF="manual.html#CREATE_TABLE">14.2.5  <CODE>CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
Simple comparison operations (<CODE>&#62;=, &#62;, =, &#60;, &#60;=</CODE>, sorting and grouping)
are based on each character's ``sort value.'' Characters with the same
sort value (such as <SAMP>`E'</SAMP>, <SAMP>`e'</SAMP>, and <SAMP>`'e'</SAMP>) are treated as the
same character.

</P>
<P>
If you are using Chinese data in the so-called <CODE>big5</CODE> encoding, you
want to make all character columns <CODE>BINARY</CODE>. This works because the
sorting order of <CODE>big5</CODE> encoding characters is based on the order of
ASCII codes. As of MySQL 4.1, you can explicitly declare that a column should
use the <CODE>big5</CODE> character set:

</P>

<PRE>
CREATE TABLE t (name CHAR(40) CHARACTER SET big5);
</PRE>



<H3><A NAME="Using_DATE" HREF="manual_toc.html#Using_DATE">A.5.2  Problems Using <CODE>DATE</CODE> Columns</A></H3>

<P>
<A NAME="IDX2272"></A>

</P>
<P>
<A NAME="IDX2273"></A>
<A NAME="IDX2274"></A>

</P>
<P>
The format of a <CODE>DATE</CODE> value is <CODE>'YYYY-MM-DD'</CODE>. According to
standard SQL, no other format is allowed. You should use this format in
<CODE>UPDATE</CODE> expressions and in the <CODE>WHERE</CODE> clause of <CODE>SELECT</CODE>
statements.  For example:

</P>

<PRE>
mysql&#62; SELECT * FROM tbl_name WHERE date &#62;= '2003-05-05';
</PRE>

<P>
As a convenience, MySQL automatically converts a date to a number if
the date is used in a numeric context (and vice versa). It is also smart
enough to allow a ``relaxed'' string form when updating and in a <CODE>WHERE</CODE>
clause that compares a date to a <CODE>TIMESTAMP</CODE>, <CODE>DATE</CODE>, or a
<CODE>DATETIME</CODE> column.  (``Relaxed form'' means that any punctuation character
may be used as the separator between parts. For example, <CODE>'2004-08-15'</CODE>
and <CODE>'2004#08#15'</CODE> are equivalent.) MySQL can also convert a
string containing no separators (such as <CODE>'20040815'</CODE>), provided it
makes sense as a date.

</P>
<P>
The special date <CODE>'0000-00-00'</CODE> can be stored and retrieved as
<CODE>'0000-00-00'.</CODE> When using a <CODE>'0000-00-00'</CODE> date through
Connector/ODBC, it is automatically converted to <CODE>NULL</CODE> in
Connector/ODBC 2.50.12 and above, because ODBC can't handle this kind of
date.

</P>
<P>
Because MySQL performs the conversions described above, the following
statements work:

</P>

<PRE>
mysql&#62; INSERT INTO tbl_name (idate) VALUES (19970505);
mysql&#62; INSERT INTO tbl_name (idate) VALUES ('19970505');
mysql&#62; INSERT INTO tbl_name (idate) VALUES ('97-05-05');
mysql&#62; INSERT INTO tbl_name (idate) VALUES ('1997.05.05');
mysql&#62; INSERT INTO tbl_name (idate) VALUES ('1997 05 05');
mysql&#62; INSERT INTO tbl_name (idate) VALUES ('0000-00-00');

mysql&#62; SELECT idate FROM tbl_name WHERE idate &#62;= '1997-05-05';
mysql&#62; SELECT idate FROM tbl_name WHERE idate &#62;= 19970505;
mysql&#62; SELECT MOD(idate,100) FROM tbl_name WHERE idate &#62;= 19970505;
mysql&#62; SELECT idate FROM tbl_name WHERE idate &#62;= '19970505';
</PRE>

<P>
However, the following will not work:

</P>

<PRE>
mysql&#62; SELECT idate FROM tbl_name WHERE STRCMP(idate,'20030505')=0;
</PRE>

<P>
<CODE>STRCMP()</CODE> is a string function, so it converts <CODE>idate</CODE> to a
string in <CODE>'YYYY-MM-DD'</CODE> format and performs a string comparison.
It does not convert <CODE>'20030505'</CODE> to the date <CODE>'2003-05-05'</CODE>
and perform a date comparison.

</P>

<P>
The MySQL server packs dates for storage, so it can't store a given date
if the date would not fit onto the result buffer.  MySQL does very
limited checking of whether the date is correct.  If you store an incorrect
date, such as <CODE>'2004-2-31'</CODE>, MySQL stores it as given.  The rules
for accepting a date are:

</P>

<UL>
<LI>

If MySQL can store and retrieve a given date as given, the date is accepted
for <CODE>DATE</CODE> and <CODE>DATETIME</CODE> columns even if it is not strictly legal.
<LI>

Day values from 0 to 31 are accepted for any date.  This makes it
very convenient for Web applications where you ask year, month, and day
in three different fields.
<LI>

The day or month value may be zero.  This is convenient if you want
to store a birthdate in a <CODE>DATE</CODE> column and you know only part
of the date.
</UL>

<P>
If the date cannot be converted to any reasonable value, a <CODE>0</CODE> is
stored in the <CODE>DATE</CODE> column, which will be retrieved as
<CODE>'0000-00-00'</CODE>.  This is both a speed and a convenience issue. We believe
that the database server's responsibility is to retrieve the same date you
stored (even if the data was not logically correct in all cases).  We think
it is up to the application and not the server to check the dates.

</P>



<H3><A NAME="Problems_with_NULL" HREF="manual_toc.html#Problems_with_NULL">A.5.3  Problems with <CODE>NULL</CODE> Values</A></H3>

<P>
<A NAME="IDX2275"></A>

</P>
<P>
<A NAME="IDX2276"></A>

</P>
<P>
The concept of the <CODE>NULL</CODE> value is a common source of confusion for
newcomers to SQL, who often think that <CODE>NULL</CODE> is the same thing as an
empty string <CODE>''</CODE>.  This is not the case. For example, the following
statements are completely different:

</P>

<PRE>
mysql&#62; INSERT INTO my_table (phone) VALUES (NULL);
mysql&#62; INSERT INTO my_table (phone) VALUES ('');
</PRE>

<P>
Both statements insert a value into the <CODE>phone</CODE> column, but the first
inserts a <CODE>NULL</CODE> value and the second inserts an empty string.  The
meaning of the first can be regarded as ``phone number is not known'' and the
meaning of the second can be regarded as ``the person is known to have no
phone, and thus no phone number.''

</P>
<P>
To help with <CODE>NULL</CODE> handling, you can use the <CODE>IS NULL</CODE> and
<CODE>IS NOT NULL</CODE> operators and the <CODE>IFNULL()</CODE> function.

</P>
<P>
In SQL, the <CODE>NULL</CODE> value is never true in comparison to any
other value, even <CODE>NULL</CODE>.  An expression that contains <CODE>NULL</CODE>
always produces a <CODE>NULL</CODE> value unless otherwise indicated in
the documentation for the operators and functions involved in the
expression. All columns in the following example return <CODE>NULL</CODE>:

</P>

<PRE>
mysql&#62; SELECT NULL, 1+NULL, CONCAT('Invisible',NULL);
</PRE>

<P>
If you want to search for column values that are <CODE>NULL</CODE>, you
cannot use an <CODE>expr = NULL</CODE> test. The following statement returns no
rows, because <CODE>expr = NULL</CODE> is never true for any expression:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE phone = NULL;
</PRE>

<P>
To look for <CODE>NULL</CODE> values, you must use the <CODE>IS NULL</CODE> test.
The following statements show how to find the <CODE>NULL</CODE> phone number and the
empty phone number:

</P>

<PRE>
mysql&#62; SELECT * FROM my_table WHERE phone IS NULL;
mysql&#62; SELECT * FROM my_table WHERE phone = '';
</PRE>

<P>
You can add an index on a column that can have <CODE>NULL</CODE>
values if you are using MySQL 3.23.2 or newer and are using the
<CODE>MyISAM</CODE>, <CODE>InnoDB</CODE>, or <CODE>BDB</CODE> storage engine.
(As of MySQL 4.0.2, the <CODE>MEMORY</CODE> storage engine also supports <CODE>NULL</CODE>
values in indexes.)  Otherwise, you must declare an indexed column <CODE>NOT
NULL</CODE> and you cannot insert <CODE>NULL</CODE> into the column.

</P>
<P>
<A NAME="IDX2277"></A>
When reading data with <CODE>LOAD DATA INFILE</CODE>, empty or missing columns
are updated with <CODE>''</CODE>. If you want a <CODE>NULL</CODE> value in a column,
you should use <CODE>\N</CODE> in the data file. The literal word <CODE>'NULL'</CODE>
may also be used under some circumstances.
See section <A HREF="manual.html#LOAD_DATA">14.1.5  <CODE>LOAD DATA INFILE</CODE> Syntax</A>.

</P>
<P>
When using <CODE>DISTINCT</CODE>, <CODE>GROUP BY</CODE>, or <CODE>ORDER BY</CODE>, all
<CODE>NULL</CODE> values are regarded as equal.

</P>
<P>
When using <CODE>ORDER BY</CODE>, <CODE>NULL</CODE> values are presented first, or
last if you specify <CODE>DESC</CODE> to sort in descending order. Exception:
In MySQL 4.0.2 through 4.0.10, <CODE>NULL</CODE> values sort first
regardless of sort order.

</P>
<P>
Aggregate (summary) functions such as <CODE>COUNT()</CODE>, <CODE>MIN()</CODE>, and
<CODE>SUM()</CODE> ignore <CODE>NULL</CODE> values. The exception to this is
<CODE>COUNT(*)</CODE>, which counts rows and not individual column values.
For example, the following statement produces two counts.
The first is a count of the number of rows in the table, and the second
is a count of the number of non-<CODE>NULL</CODE> values in the <CODE>age</CODE>
column:

</P>

<PRE>
mysql&#62; SELECT COUNT(*), COUNT(age) FROM person;
</PRE>

<P>
<A NAME="IDX2278"></A>
<A NAME="IDX2279"></A>
<A NAME="IDX2280"></A>
<A NAME="IDX2281"></A>

</P>
<P>
For some column types, MySQL handles <CODE>NULL</CODE> values specially.  If you
insert <CODE>NULL</CODE> into a <CODE>TIMESTAMP</CODE> column, the
current date and time is inserted.  If you insert <CODE>NULL</CODE> into an
integer column that has the <CODE>AUTO_INCREMENT</CODE> attribute, the next
number in the sequence is inserted.

</P>



<H3><A NAME="Problems_with_alias" HREF="manual_toc.html#Problems_with_alias">A.5.4  Problems with Column Aliases</A></H3>

<P>
<A NAME="IDX2282"></A>

</P>
<P>
You can use an alias to refer to a column in <CODE>GROUP BY</CODE>,
<CODE>ORDER BY</CODE>, or <CODE>HAVING</CODE> clauses.  Aliases can also be used
to give columns better names:

</P>

<PRE>
SELECT SQRT(a*b) AS rt FROM tbl_name GROUP BY rt HAVING rt &#62; 0;
SELECT id, COUNT(*) AS cnt FROM tbl_name GROUP BY id HAVING cnt &#62; 0;
SELECT id AS 'Customer identity' FROM tbl_name;
</PRE>

<P>
Standard SQL doesn't allow you to refer to a column alias in a
<CODE>WHERE</CODE> clause.  This is because when the <CODE>WHERE</CODE> code is
executed, the column value may not yet be determined. For example, the
following query is illegal:

</P>

<PRE>
SELECT id, COUNT(*) AS cnt FROM tbl_name WHERE cnt &#62; 0 GROUP BY id;
</PRE>

<P>
The <CODE>WHERE</CODE> statement is executed to determine which rows should
be included in the <CODE>GROUP BY</CODE> part, whereas <CODE>HAVING</CODE> is used to
decide which rows from the result set should be used.

</P>



<H3><A NAME="Non-transactional_tables" HREF="manual_toc.html#Non-transactional_tables">A.5.5  Rollback Failure for Non-Transactional Tables</A></H3>

<P>
<A NAME="IDX2283"></A>

</P>
<P>
If you receive the following message when trying to perform a
<CODE>ROLLBACK</CODE>, it means that one or more of the tables you used in the
transaction do not support transactions:

</P>

<PRE>
Warning: Some non-transactional changed tables couldn't be rolled back
</PRE>

<P>
These non-transactional tables will not be affected by the <CODE>ROLLBACK</CODE>
statement.

</P>
<P>
If you were not deliberately mixing transactional and non-transactional
tables within the transaction, the most likely cause for this message is
that a table you thought was transactional actually is not. This can happen
if you try to create a table using a transactional storage engine that is
not supported by your <CODE>mysqld</CODE> server (or that was disabled with a
startup option).  If <CODE>mysqld</CODE> doesn't support a storage engine, it will
instead create the table as a <CODE>MyISAM</CODE> table, which is
non-transactional.

</P>
<P>
You can check the table type for a table by using either of these statements:

</P>

<PRE>
SHOW TABLE STATUS LIKE 'tbl_name';
SHOW CREATE TABLE tbl_name;
</PRE>

<P>
See section <A HREF="manual.html#SHOW_TABLE_STATUS">14.5.3.17  <CODE>SHOW TABLE STATUS</CODE> Syntax</A> and
section <A HREF="manual.html#SHOW_CREATE_TABLE">14.5.3.6  <CODE>SHOW CREATE TABLE</CODE> Syntax</A>.

</P>
<P>
You can check which storage engines your <CODE>mysqld</CODE> server supports by
using this statement:

</P>

<PRE>
SHOW ENGINES;
</PRE>

<P>
Before MySQL 4.1.2, <CODE>SHOW ENGINES</CODE> is unavailable. Use the following
statement instead and check the value of the variable that is associated
with the storage engine in which you are interested:

</P>

<PRE>
SHOW VARIABLES LIKE 'have_%';
</PRE>

<P>
For example, to determine whether the <CODE>InnoDB</CODE> storage engine is
available, check the value of the <CODE>have_innodb</CODE> variable.

</P>
<P>
See section <A HREF="manual.html#SHOW_ENGINES">14.5.3.8  <CODE>SHOW ENGINES</CODE> Syntax</A> and
section <A HREF="manual.html#SHOW_VARIABLES">14.5.3.19  <CODE>SHOW VARIABLES</CODE> Syntax</A>.

</P>



<H3><A NAME="Deleting_from_related_tables" HREF="manual_toc.html#Deleting_from_related_tables">A.5.6  Deleting Rows from Related Tables</A></H3>

<P>
<A NAME="IDX2284"></A>
<A NAME="IDX2285"></A>
<A NAME="IDX2286"></A>

</P>
<P>
MySQL does not support subqueries prior to Version 4.1, or the use of more
than one table in the <CODE>DELETE</CODE> statement prior to Version 4.0. If your
version of MySQL does not support subqueries or multiple-table <CODE>DELETE</CODE>
statements, you can use the following approach to delete rows from two
related tables:

</P>

<OL>
<LI>

<CODE>SELECT</CODE> the rows based on some <CODE>WHERE</CODE> condition in the main table.
<LI>

<CODE>DELETE</CODE> the rows in the main table based on the same condition.
<LI>

<CODE>DELETE FROM related_table WHERE related_column IN (selected_rows)</CODE>.
</OL>

<P>
If the total length of the <CODE>DELETE</CODE> statement for <CODE>related_table</CODE> is
more than 1MB (the default value of the <CODE>max_allowed_packet</CODE> system
variable), you should split it into smaller parts and execute multiple
<CODE>DELETE</CODE> statements.  You will probably get the fastest <CODE>DELETE</CODE>
by specifying only 100 to 1,000 <CODE>related_column</CODE> values per statement if the
<CODE>related_column</CODE> is indexed.  If the <CODE>related_column</CODE> isn't
indexed, the speed is independent of the number of arguments in the
<CODE>IN</CODE> clause.

</P>



<H3><A NAME="No_matching_rows" HREF="manual_toc.html#No_matching_rows">A.5.7  Solving Problems with No Matching Rows</A></H3>

<P>
<A NAME="IDX2287"></A>
<A NAME="IDX2288"></A>

</P>
<P>
If you have a complicated query that uses many tables but that doesn't
return any rows, you should use the following procedure to find out what
is wrong:

</P>

<OL>
<LI>

Test the query with <CODE>EXPLAIN</CODE> to check whether you can find something
that is obviously wrong.
See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

<LI>

Select only those columns that are used in the <CODE>WHERE</CODE> clause.

<LI>

Remove one table at a time from the query until it returns some rows.
If the tables are large, it's a good idea to use <CODE>LIMIT 10</CODE> with the query.

<LI>

Issue a <CODE>SELECT</CODE> for the column that should have matched a row against
the table that was last removed from the query.

<LI>

If you are comparing <CODE>FLOAT</CODE> or <CODE>DOUBLE</CODE> columns with numbers that
have decimals, you can't use equality (<CODE>=</CODE>) comparisons. This problem
is common in most computer languages because not all floating-point values
can be stored with exact precision.  In some cases, changing the
<CODE>FLOAT</CODE> to a <CODE>DOUBLE</CODE> will fix this.
See section <A HREF="manual.html#Problems_with_float">A.5.8  Problems with Floating-Point Comparisons</A>.

<LI>

If you still can't figure out what's wrong, create a minimal test that can
be run with <CODE>mysql test &#60; query.sql</CODE> that shows your problems.  You can
create a test file by dumping the tables with <CODE>mysqldump --quick
db_name tbl_name_1 ... tbl_name_n &#62; query.sql</CODE>. Open the file in an editor,
remove some insert lines (if there are more than needed to demonstrate
the problem), and add your <CODE>SELECT</CODE> statement at the end of the file.

Verify that the test file demonstrates the problem by executing these
commands:


<PRE>
shell&#62; mysqladmin create test2
shell&#62; mysql test2 &#60; query.sql
</PRE>

Post the test file using <CODE>mysqlbug</CODE> to the general MySQL mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
</OL>



<H3><A NAME="Problems_with_float" HREF="manual_toc.html#Problems_with_float">A.5.8  Problems with Floating-Point Comparisons</A></H3>

<P>
Floating-point numbers sometimes cause confusion because they
are not stored as exact values inside computer architecture. What you
can see on the screen usually is not the exact value of the number.
The column types <CODE>FLOAT</CODE>, <CODE>DOUBLE</CODE>, and <CODE>DECIMAL</CODE> are such.
<CODE>DECIMAL</CODE> columns store values with exact precision because they are
represented as strings, but calculations on <CODE>DECIMAL</CODE> values may be done
using floating-point operations.

</P>
<P>
The following example demonstrate the problem. It shows that even for the
<CODE>DECIMAL</CODE> column type, calculations that are done using floating-point
operations are subject to floating-point error.

</P>

<PRE>
mysql&#62; CREATE TABLE t1 (i INT, d1 DECIMAL(9,2), d2 DECIMAL(9,2));
mysql&#62; INSERT INTO t1 VALUES (1, 101.40, 21.40), (1, -80.00, 0.00),
    -&#62; (2, 0.00, 0.00), (2, -13.20, 0.00), (2, 59.60, 46.40),
    -&#62; (2, 30.40, 30.40), (3, 37.00, 7.40), (3, -29.60, 0.00),
    -&#62; (4, 60.00, 15.40), (4, -10.60, 0.00), (4, -34.00, 0.00),
    -&#62; (5, 33.00, 0.00), (5, -25.80, 0.00), (5, 0.00, 7.20),
    -&#62; (6, 0.00, 0.00), (6, -51.40, 0.00);

mysql&#62; SELECT i, SUM(d1) AS a, SUM(d2) AS b
    -&#62; FROM t1 GROUP BY i HAVING a &#60;&#62; b;
+------+--------+-------+
| i    | a      | b     |
+------+--------+-------+
|    1 |  21.40 | 21.40 |
|    2 |  76.80 | 76.80 |
|    3 |   7.40 |  7.40 |
|    4 |  15.40 | 15.40 |
|    5 |   7.20 |  7.20 |
|    6 | -51.40 |  0.00 |
+------+--------+-------+
</PRE>

<P>
The result is correct. Although the first five records look like they
shouldn't pass the comparison test (the values of <CODE>a</CODE> and <CODE>b</CODE> do
not appear to be different), they may do so because the difference between
the numbers shows up around the tenth decimal or so, depending on computer
architecture.

</P>
<P>
The problem cannot be solved by using <CODE>ROUND()</CODE> or similar functions,
because the result is still a floating-point number:

</P>

<PRE>
mysql&#62; SELECT i, ROUND(SUM(d1), 2) AS a, ROUND(SUM(d2), 2) AS b
    -&#62; FROM t1 GROUP BY i HAVING a &#60;&#62; b;
+------+--------+-------+
| i    | a      | b     |
+------+--------+-------+
|    1 |  21.40 | 21.40 |
|    2 |  76.80 | 76.80 |
|    3 |   7.40 |  7.40 |
|    4 |  15.40 | 15.40 |
|    5 |   7.20 |  7.20 |
|    6 | -51.40 |  0.00 |
+------+--------+-------+
</PRE>

<P>
This is what the numbers in column <CODE>a</CODE> look like when displayed with more
decimal places:

</P>

<PRE>
mysql&#62; SELECT i, ROUND(SUM(d1), 2)*1.0000000000000000 AS a,
    -&#62; ROUND(SUM(d2), 2) AS b FROM t1 GROUP BY i HAVING a &#60;&#62; b;
+------+----------------------+-------+
| i    | a                    | b     |
+------+----------------------+-------+
|    1 |  21.3999999999999986 | 21.40 |
|    2 |  76.7999999999999972 | 76.80 |
|    3 |   7.4000000000000004 |  7.40 |
|    4 |  15.4000000000000004 | 15.40 |
|    5 |   7.2000000000000002 |  7.20 |
|    6 | -51.3999999999999986 |  0.00 |
+------+----------------------+-------+
</PRE>

<P>
Depending on your computer architecture, you may or may not see similar
results.  Different CPUs may evaluate floating-point numbers differently.
For example, on some machines you may get the ``correct'' results by
multiplying both arguments by 1, as the following example shows.

</P>
<P>
<STRONG>Warning:</STRONG> Never use this method in your applications. It is not
an example of a trustworthy method!

</P>

<PRE>
mysql&#62; SELECT i, ROUND(SUM(d1), 2)*1 AS a, ROUND(SUM(d2), 2)*1 AS b
    -&#62; FROM t1 GROUP BY i HAVING a &#60;&#62; b;
+------+--------+------+
| i    | a      | b    |
+------+--------+------+
|    6 | -51.40 | 0.00 |
+------+--------+------+
</PRE>

<P>
The reason that the preceding example seems to work is that on the particular
machine where the test was done, CPU floating-point arithmetic happens to
round the numbers to the same value. However, there is no rule that any CPU
should do so, so this method cannot be trusted.

</P>
<P>
The correct way to do floating-point number comparison is to first
decide on an acceptable tolerance for differences between the numbers and
then do the comparison against the tolerance value. For example, if we
agree that floating-point numbers should be regarded the same if they are
same within a precision of one in ten thousand (0.0001), the comparison
should be written to find differences larger than the tolerance value:

</P>

<PRE>
mysql&#62; SELECT i, SUM(d1) AS a, SUM(d2) AS b FROM t1
    -&#62; GROUP BY i HAVING ABS(a - b) &#62; 0.0001;
+------+--------+------+
| i    | a      | b    |
+------+--------+------+
|    6 | -51.40 | 0.00 |
+------+--------+------+
1 row in set (0.00 sec)
</PRE>

<P>
Conversely, to get rows where the numbers are the same, the test should
find differences within the tolerance value:

</P>

<PRE>
mysql&#62; SELECT i, SUM(d1) AS a, SUM(d2) AS b FROM t1
    -&#62; GROUP BY i HAVING ABS(a - b) &#60;= 0.0001;
+------+-------+-------+
| i    | a     | b     |
+------+-------+-------+
|    1 | 21.40 | 21.40 |
|    2 | 76.80 | 76.80 |
|    3 |  7.40 |  7.40 |
|    4 | 15.40 | 15.40 |
|    5 |  7.20 |  7.20 |
+------+-------+-------+
</PRE>



<H2><A NAME="Optimiser_Issues" HREF="manual_toc.html#Optimiser_Issues">A.6  Optimizer-Related Issues</A></H2>

<P>
MySQL uses a cost-based optimizer to determine the best way to resolve a
query.  In many cases, MySQL can calculate the best possible query plan,
but sometimes MySQL doesn't have enough information about the data
at hand and has to make ``educated'' guesses about the data.

</P>
<P>
For the cases when MySQL does not do the "right" thing, tools that you
have available to help MySQL are:

</P>

<UL>

<LI>

Use the <CODE>EXPLAIN</CODE> statement to get information about how MySQL will
process a query. To use it, just add the keyword <CODE>EXPLAIN</CODE> to the
front of your <CODE>SELECT</CODE> statement:


<PRE>
mysql&#62; EXPLAIN SELECT * FROM t1, t2 WHERE t1.i = t2.i;
</PRE>

<CODE>EXPLAIN</CODE> is discussed in more detail in section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

<LI>

Use <CODE>ANALYZE TABLE tbl_name</CODE> to update the key distributions for the
scanned table.  See section <A HREF="manual.html#ANALYZE_TABLE">14.5.2.1  <CODE>ANALYZE TABLE</CODE> Syntax</A>.

<LI>

Use <CODE>FORCE INDEX</CODE> for the scanned table to tell MySQL that table
scans are very expensive compared to using the given index.
See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.


<PRE>
SELECT * FROM t1, t2 FORCE INDEX (index_for_column)
WHERE t1.col_name=t2.col_name;
</PRE>

<CODE>USE INDEX</CODE> and <CODE>IGNORE INDEX</CODE> may also be useful.

<LI>

Global and table level <CODE>STRAIGHT JOIN</CODE>. See section <A HREF="manual.html#SELECT">14.1.7  <CODE>SELECT</CODE> Syntax</A>.

<LI>

You can tune global or thread-specific system variables.  For example,
Start <CODE>mysqld</CODE> with the <CODE>--max-seeks-for-key=1000</CODE> option or use
<CODE>SET max_seeks_for_key=1000</CODE> to tell the optimizer to assume that no
key scan will cause more than 1,000 key seeks.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.

</UL>



<H2><A NAME="Table_Definition_Issues" HREF="manual_toc.html#Table_Definition_Issues">A.7  Table Definition-Related Issues</A></H2>



<H3><A NAME="ALTER_TABLE_problems" HREF="manual_toc.html#ALTER_TABLE_problems">A.7.1  Problems with <CODE>ALTER TABLE</CODE></A></H3>

<P>
<A NAME="IDX2289"></A>
<A NAME="IDX2290"></A>
<A NAME="IDX2291"></A>

</P>
<P>
<CODE>ALTER TABLE</CODE> changes a table to the current character set.
If you get a duplicate-key error during <CODE>ALTER TABLE</CODE>, the cause
is either that the new character sets maps two keys to the same value
or that the table is corrupted. In the latter case, you should run
<CODE>REPAIR TABLE</CODE> on the table.

</P>
<P>
If <CODE>ALTER TABLE</CODE> dies with the following error, the problem may be that
MySQL crashed during an earlier <CODE>ALTER TABLE</CODE> operation and there is an
old table named <TT>`A-xxx'</TT> or <TT>`B-xxx'</TT> lying around:

</P>

<PRE>
Error on rename of './database/name.frm'
to './database/B-xxx.frm' (Errcode: 17)
</PRE>

<P>
In this case, go to the MySQL data directory and delete all files that have
names starting with <CODE>A-</CODE> or <CODE>B-</CODE>.  (You may want to move them
elsewhere instead of deleting them.)

</P>
<P>
<CODE>ALTER TABLE</CODE> works in the following way:

</P>

<UL>
<LI>

Create a new table named <TT>`A-xxx'</TT> with the requested structural changes.
<LI>

Copy all rows from the original table to <TT>`A-xxx'</TT>.
<LI>

Rename the original table to <TT>`B-xxx'</TT>.
<LI>

Rename <TT>`A-xxx'</TT> to your original table name.
<LI>

Delete <TT>`B-xxx'</TT>.
</UL>

<P>
If something goes wrong with the renaming operation, MySQL tries to
undo the changes.  If something goes seriously wrong (although this shouldn't
happen), MySQL may leave the old table as <TT>`B-xxx'</TT>. A
simple rename of the table files at the system level should get your data back.

</P>
<P>
If you use <CODE>ALTER TABLE</CODE> on a transactional table or if you are using
Windows or OS/2, <CODE>ALTER TABLE</CODE> will <CODE>UNLOCK</CODE> the table if you had
done a <CODE>LOCK TABLE</CODE> on it. This is because <CODE>InnoDB</CODE> and these
operating systems cannot drop a table that is in use.

</P>



<H3><A NAME="Change_column_order" HREF="manual_toc.html#Change_column_order">A.7.2  How to Change the Order of Columns in a Table</A></H3>

<P>
<A NAME="IDX2292"></A>
<A NAME="IDX2293"></A>
<A NAME="IDX2294"></A>
<A NAME="IDX2295"></A>

</P>
<P>
First, consider whether you really need to change the column order in a
table.  The whole point of SQL is to abstract the application from the data
storage format.  You should always specify the order in which you wish to
retrieve your data.  The first of the following statements returns columns
in the order <CODE>col_name1</CODE>, <CODE>col_name2</CODE>, <CODE>col_name3</CODE>, whereas
the second returns them in the order <CODE>col_name1</CODE>, <CODE>col_name3</CODE>,
<CODE>col_name2</CODE>:

</P>

<PRE>
mysql&#62; SELECT col_name1, col_name2, col_name3 FROM tbl_name;
mysql&#62; SELECT col_name1, col_name3, col_name2 FROM tbl_name;
</PRE>

<P>
If you decide to change the order of table columns anyway, you can do so as
follows:

</P>

<OL>
<LI>

Create a new table with the columns in the new order.
<LI>

Execute this statement:


<PRE>
mysql&#62; INSERT INTO new_table
    -&#62; SELECT columns-in-new-order FROM old_table;
</PRE>

<LI>

Drop or rename <CODE>old_table</CODE>.
<LI>

Rename the new table to the original name:


<PRE>
mysql&#62; ALTER TABLE new_table RENAME old_table;
</PRE>

</OL>

<P>
<CODE>SELECT *</CODE> is quite suitable for testing queries. However, in an
application, you should <EM>never</EM> rely on using <CODE>SELECT *</CODE> and
retrieving the columns based on their position. The order and position
in which columns are returned will not remain the same if you add, move,
or delete columns. A simple change to your table structure will cause
your application to fail.

</P>



<H3><A NAME="Temporary_table_problems" HREF="manual_toc.html#Temporary_table_problems">A.7.3  <CODE>TEMPORARY TABLE</CODE> Problems</A></H3>

<P>
<A NAME="IDX2296"></A>

</P>
<P>
The following list indicates limitations on the use of <CODE>TEMPORARY</CODE>
tables:

</P>

<UL>
<LI>

A <CODE>TEMPORARY</CODE> table can only be of type <CODE>HEAP</CODE>, <CODE>ISAM</CODE>,
<CODE>MyISAM</CODE>, <CODE>MERGE</CODE>, or <CODE>InnoDB</CODE>.

<LI>

You cannot refer to a <CODE>TEMPORARY</CODE> table more than once in the same query.
For example, the following does not work:


<PRE>
mysql&#62; SELECT * FROM temp_table, temp_table AS t2;
ERROR 1137: Can't reopen table: 'temp_table'
</PRE>

<LI>

The <CODE>SHOW TABLES</CODE> statement does not list <CODE>TEMPORARY</CODE> tables.

<LI>

You cannot use <CODE>RENAME</CODE> to rename a <CODE>TEMPORARY</CODE> table.  However,
you can use <CODE>ALTER TABLE</CODE> instead:


<PRE>
mysql&#62; ALTER TABLE orig_name RENAME new_name;
</PRE>

</UL>



<H1><A NAME="Credits" HREF="manual_toc.html#Credits">B  Credits</A></H1>

<P>
<A NAME="IDX2297"></A>

</P>
<P>
This appendix lists the developers, contributors, and supporters that have
helped to make MySQL what it is today.

</P>



<H2><A NAME="Developers" HREF="manual_toc.html#Developers">B.1  Developers at MySQL AB</A></H2>

<P>
These are the developers that are or have been employed by <CODE>MySQL AB</CODE>
to work on the <CODE>MySQL</CODE> database software, roughly in the order they
started to work with us. Following each developer is a small list of the
tasks that the developer is responsible for, or the accomplishments they
have made. All developers are involved in support.

</P>

<DL COMPACT>

<DT>Michael (Monty) Widenius
<DD>

<UL>
<LI>

Lead developer and main author of the MySQL server (<CODE>mysqld</CODE>).
<LI>

New functions for the string library.
<LI>

Most of the <CODE>mysys</CODE> library.
<LI>

The <CODE>ISAM</CODE> and <CODE>MyISAM</CODE> libraries (B-tree index file
handlers with index compression and different record formats).
<LI>

The <CODE>HEAP</CODE> library. A memory table system with our superior full dynamic
hashing. In use since 1981 and published around 1984.
<LI>

The <CODE>replace</CODE> program (take a look at it, it's <STRONG>COOL</STRONG>!).
<LI>

Connector/ODBC (<CODE>MyODBC</CODE>), the ODBC driver for Windows.
<LI>

Fixing bugs in MIT-pthreads to get it to work for MySQL Server. And
also Unireg, a curses-based application tool with many utilities.
<LI>

Porting of <CODE>mSQL</CODE> tools like <CODE>msqlperl</CODE>, <CODE>DBD</CODE>/<CODE>DBI</CODE>, and
<CODE>DB2mysql</CODE>.
<LI>

Most of <CODE>crash-me</CODE> and the foundation for the MySQL benchmarks.
</UL>

<DT>David Axmark
<DD>

<UL>
<LI>

Initial main writer of the <STRONG>Reference Manual</STRONG>,
including enhancements to <CODE>texi2html</CODE>.
<LI>

Automatic Web site updating from the manual.
<LI>

Initial Autoconf, Automake, and Libtool support.
<LI>

Licensing.
<LI>

Parts of all the text files.  (Nowadays only the <TT>`README'</TT> is
left. The rest ended up in the manual.)
<LI>

Lots of testing of new features.
<LI>

Our in-house Free Software legal expert.
<LI>

Mailing list maintainer (who never has the time to do it right...).
<LI>

Our original portability code (more than 10 years old now). Nowadays
only some parts of <CODE>mysys</CODE> are left.
<LI>

Someone for Monty to call in the middle of the night when he just got
that new feature to work.
<LI>

Chief "Open Sourcerer" (MySQL community relations).
</UL>

<DT>Jani Tolonen
<DD>

<UL>
<LI>

<CODE>mysqlimport</CODE>
<LI>

A lot of extensions to the command-line clients.
<LI>

<CODE>PROCEDURE ANALYSE()</CODE>
</UL>

<DT>Sinisa Milivojevic
<DD>

<UL>
<LI>

Compression (with <CODE>zlib</CODE>) in the client/server protocol.
<LI>

Perfect hashing for the lexical analyzer phase.
<LI>

Multi-row <CODE>INSERT</CODE>
<LI>

<CODE>mysqldump</CODE> -e option
<LI>

<CODE>LOAD DATA LOCAL INFILE</CODE>
<LI>

<CODE>SQL_CALC_FOUND_ROWS</CODE> <CODE>SELECT</CODE> option
<LI>

<CODE>--max-user-connections=...</CODE> option
<LI>

<CODE>net_read</CODE> and <CODE>net_write_timeout</CODE>
<LI>

<CODE>GRANT</CODE>/<CODE>REVOKE</CODE> and <CODE>SHOW GRANTS FOR</CODE>
<LI>

New client/server protocol for 4.0
<LI>

<CODE>UNION</CODE> in 4.0
<LI>

Multiple-table <CODE>DELETE</CODE>/<CODE>UPDATE</CODE>
<LI>

Derived tables in 4.1
<LI>

User resources management
<LI>

Initial developer of the <CODE>MySQL++</CODE> C++ API and the <CODE>MySQLGUI</CODE> client.
</UL>

<DT>Tonu Samuel (past developer)
<DD>

<UL>
<LI>

VIO interface (the foundation for the encrypted client/server protocol).
<LI>

MySQL Filesystem (a way to use MySQL databases as files
and directories).
<LI>

The <CODE>CASE</CODE> expression.
<LI>

The <CODE>MD5()</CODE> and <CODE>COALESCE()</CODE> functions.
<LI>

<CODE>RAID</CODE> support for <CODE>MyISAM</CODE> tables.
</UL>

<DT>Sasha Pachev
<DD>

<UL>
<LI>

Initial implementation of replication (up to version 4.0).
<LI>

<CODE>SHOW CREATE TABLE</CODE>.
<LI>

<CODE>mysql-bench</CODE>
</UL>

<DT>Matt Wagner
<DD>

<UL>
<LI>

MySQL test suite.
<LI>

Webmaster (until 2002).
<LI>

Coordinator of development.
</UL>

<DT>Miguel Solorzano
<DD>

<UL>
<LI>

Win32 development and release builds.
<LI>

Windows NT server code.
<LI>

WinMySQLAdmin
</UL>

<DT>Timothy Smith (past developer)
<DD>

<UL>
<LI>

Dynamic character sets support.
<LI>

configure, RPMs and other parts of the build system.
<LI>

Initial developer of <CODE>libmysqld</CODE>, the embedded server.
</UL>

<DT>Sergei Golubchik
<DD>

<UL>
<LI>

Full-text search.
<LI>

Added keys to the <CODE>MERGE</CODE> library.
</UL>

<DT>Jeremy Cole
<DD>

<UL>
<LI>

Proofreading and editing this fine manual.
<LI>

<CODE>ALTER TABLE ... ORDER BY ...</CODE>.
<LI>

<CODE>UPDATE ... ORDER BY ...</CODE>.
<LI>

<CODE>DELETE ... ORDER BY ...</CODE>.
</UL>

<DT>Indrek Siitan
<DD>

<UL>
<LI>

Designing/programming of our Web interface.
<LI>

Author of our newsletter management system.
</UL>

<DT>Jorge del Conde
<DD>

<UL>
<LI>

<CODE>MySQLCC</CODE> (<CODE>MySQL Control Center</CODE>)
<LI>

Win32 development
<LI>

Initial implementation of the Web site portals.
</UL>

<DT>Venu Anuganti
<DD>

<UL>
<LI>

Connector/ODBC (MyODBC) 3.51
<LI>

New client/server protocol for 4.1 (for prepared statements).
</UL>

<DT>Arjen Lentz
<DD>

<UL>
<LI>

Maintainer of the MySQL Reference Manual.
<LI>

Preparing the O'Reilly printed edition of the manual.
</UL>

<DT>Alexander (Bar) Barkov, Alexey (Holyfoot) Botchkov, and Ramil Kalimullin
<DD>

<UL>
<LI>

Spatial data (GIS) and R-Trees implementation for 4.1
<LI>

Unicode and character sets for 4.1; documentation for same
</UL>

<DT>Oleksandr (Sanja) Byelkin
<DD>

<UL>
<LI>

Query cache in 4.0
<LI>

Implementation of subqueries (4.1).
</UL>

<DT>Aleksey (Walrus) Kishkin and Alexey (Ranger) Stroganov
<DD>

<UL>
<LI>

Benchmarks design and analysis.
<LI>

Maintenance of the MySQL test suite.
</UL>

<DT>Zak Greant
<DD>

<UL>
<LI>

Open Source advocate, MySQL community relations.
</UL>

<DT>Carsten Pedersen
<DD>

<UL>
<LI>

The MySQL Certification program.
</UL>

<DT>Lenz Grimmer
<DD>

<UL>
<LI>

Production (build and release) engineering.
</UL>

<DT>Peter Zaitsev
<DD>

<UL>
<LI>

<CODE>SHA1()</CODE>, <CODE>AES_ENCRYPT()</CODE> and <CODE>AES_DECRYPT()</CODE> functions.
<LI>

Debugging, cleaning up various features.
</UL>

<DT>Alexander (Salle) Keremidarski
<DD>

<UL>
<LI>

Support.
<LI>

Debugging.
</UL>

<DT>Per-Erik Martin
<DD>

<UL>
<LI>

Lead developer for stored procedures (5.0) and triggers.
</UL>

<DT>Jim Winstead
<DD>

<UL>
<LI>

Lead Web developer.
</UL>

<DT>Mark Matthews
<DD>

<UL>
<LI>

Connector/J driver (Java).
</UL>

<DT>Peter Gulutzan
<DD>

<UL>
<LI>

SQL standards compliance.
<LI>

Documentation of existing MySQL code/algorithms.
<LI>

Character set documentation.
</UL>

<DT>Guilhem Bichot
<DD>

<UL>
<LI>

Replication, from <CODE>MySQL</CODE> version 4.0.
<LI>

Fixed handling of exponents for <CODE>DECIMAL</CODE>.
<LI>

Author of <CODE>mysql_tableinfo</CODE>.
</UL>

<DT>Antony T. Curtis
<DD>

<UL>
<LI>

Porting of the MySQL Database software to OS/2.
</UL>

</DL>



<H2><A NAME="Contributors" HREF="manual_toc.html#Contributors">B.2  Contributors to MySQL</A></H2>

<P>
<A NAME="IDX2298"></A>

</P>
<P>
While <CODE>MySQL AB</CODE> owns all copyrights in the <CODE>MySQL server</CODE>
and the <CODE>MySQL manual</CODE>, we wish to recognize those who have made
contributions of one kind or another to the <CODE>MySQL distribution</CODE>.
Contributors are listed here, in somewhat random order:

</P>
<DL COMPACT>

<DT>Gianmassimo Vigazzola <a HREF="mailto:qwerg@mbox.vol.it">qwerg@mbox.vol.it</a> or <a HREF="mailto:qwerg@tin.it">qwerg@tin.it</a>
<DD>
The initial port to Win32/NT.
<DT>Per Eric Olsson
<DD>
For more or less constructive criticism and real testing of the dynamic
record format.
<DT>Irena Pancirov <a HREF="mailto:irena@mail.yacc.it">irena@mail.yacc.it</a>
<DD>
Win32 port with Borland compiler.  <CODE>mysqlshutdown.exe</CODE> and
<CODE>mysqlwatch.exe</CODE>
<DT>David J. Hughes
<DD>
For the effort to make a shareware SQL database. At TcX, the predecessor
of MySQL AB, we started with <CODE>mSQL</CODE>, but found that it couldn't
satisfy our purposes so instead we wrote an SQL interface to our
application builder Unireg.  <CODE>mysqladmin</CODE> and <CODE>mysql</CODE> client are
programs that were largely influenced by their <CODE>mSQL</CODE> counterparts.
We have put a lot of effort into making the MySQL syntax a superset of
<CODE>mSQL</CODE>. Many of the API's ideas are borrowed from <CODE>mSQL</CODE> to
make it easy to port free <CODE>mSQL</CODE> programs to the MySQL API.
The MySQL software doesn't contain any code from <CODE>mSQL</CODE>.
Two files in the distribution (<TT>`client/insert_test.c'</TT> and
<TT>`client/select_test.c'</TT>) are based on the corresponding (non-copyrighted)
files in the <CODE>mSQL</CODE> distribution, but are modified as examples showing
the changes necessary to convert code from <CODE>mSQL</CODE> to MySQL Server.
(<CODE>mSQL</CODE> is copyrighted David J. Hughes.)
<DT>Patrick Lynch
<DD>
For helping us acquire <a HREF="http://www.mysql.com/">http://www.mysql.com/</a>.
<DT>Fred Lindberg
<DD>
For setting up qmail to handle the MySQL mailing list and for the
incredible help we got in managing the MySQL mailing lists.
<DT>Igor Romanenko <a HREF="mailto:igor@frog.kiev.ua">igor@frog.kiev.ua</a>
<DD>
<CODE>mysqldump</CODE> (previously <CODE>msqldump</CODE>, but ported and enhanced by
Monty).
<DT>Yuri Dario
<DD>
For keeping up and extending the MySQL OS/2 port.
<DT>Tim Bunce
<DD>
Author of <CODE>mysqlhotcopy</CODE>.
<DT>Zarko Mocnik <a HREF="mailto:zarko.mocnik@dem.si">zarko.mocnik@dem.si</a>
<DD>
Sorting for Slovenian language.
<DT>"TAMITO" <a HREF="mailto:tommy@valley.ne.jp">tommy@valley.ne.jp</a>
<DD>
The <CODE>_MB</CODE> character set macros and the ujis and sjis character sets.
<DT>Joshua Chamas <a HREF="mailto:joshua@chamas.com">joshua@chamas.com</a>
<DD>
Base for concurrent insert, extended date syntax, debugging on NT, and
answering on the MySQL mailing list.
<DT>Yves Carlier <a HREF="mailto:Yves.Carlier@rug.ac.be">Yves.Carlier@rug.ac.be</a>
<DD>
<CODE>mysqlaccess</CODE>, a program to show the access rights for a user.
<DT>Rhys Jones <a HREF="mailto:rhys@wales.com">rhys@wales.com</a> (And GWE Technologies Limited)
<DD>
For one of the early JDBC drivers.
<DT>Dr Xiaokun Kelvin ZHU <a HREF="mailto:X.Zhu@brad.ac.uk">X.Zhu@brad.ac.uk</a>
<DD>
Further development of one of the early JDBC drivers and other MySQL-related
Java tools.
<DT>James Cooper <a HREF="mailto:pixel@organic.com">pixel@organic.com</a>
<DD>
For setting up a searchable mailing list archive at his site.
<DT>Rick Mehalick <a HREF="mailto:Rick_Mehalick@i-o.com">Rick_Mehalick@i-o.com</a>
<DD>
For <CODE>xmysql</CODE>, a graphical X client for MySQL Server.
<DT>Doug Sisk <a HREF="mailto:sisk@wix.com">sisk@wix.com</a>
<DD>
For providing RPM packages of MySQL for Red Hat Linux.
<DT>Diemand Alexander V. <a HREF="mailto:axeld@vial.ethz.ch">axeld@vial.ethz.ch</a>
<DD>
For providing RPM packages of MySQL for Red Hat Linux-Alpha.
<DT>Antoni Pamies Olive <a HREF="mailto:toni@readysoft.es">toni@readysoft.es</a>
<DD>
For providing RPM versions of a lot of MySQL clients for Intel
and SPARC.
<DT>Jay Bloodworth <a HREF="mailto:jay@pathways.sde.state.sc.us">jay@pathways.sde.state.sc.us</a>
<DD>
For providing RPM versions for MySQL 3.21.
<DT>David Sacerdote <a HREF="mailto:davids@secnet.com">davids@secnet.com</a>
<DD>
Ideas for secure checking of DNS hostnames.
<DT>Wei-Jou Chen <a HREF="mailto:jou@nematic.ieo.nctu.edu.tw">jou@nematic.ieo.nctu.edu.tw</a>
<DD>
Some support for Chinese(BIG5) characters.
<DT>Wei He <a HREF="mailto:hewei@mail.ied.ac.cn">hewei@mail.ied.ac.cn</a>
<DD>
A lot of functionality for the Chinese(GBK) character set.
<DT>Jan Pazdziora <a HREF="mailto:adelton@fi.muni.cz">adelton@fi.muni.cz</a>
<DD>
Czech sorting order.
<DT>Zeev Suraski <a HREF="mailto:bourbon@netvision.net.il">bourbon@netvision.net.il</a>
<DD>
<CODE>FROM_UNIXTIME()</CODE> time formatting, <CODE>ENCRYPT()</CODE> functions, and
<CODE>bison</CODE> advisor.
Active mailing list member.
<DT>Luuk de Boer <a HREF="mailto:luuk@wxs.nl">luuk@wxs.nl</a>
<DD>
Ported (and extended) the benchmark suite to <CODE>DBI</CODE>/<CODE>DBD</CODE>. Have
been of great help with <CODE>crash-me</CODE> and running benchmarks. Some new
date functions. The <CODE>mysql_setpermissions</CODE> script.
<DT>Alexis Mikhailov <a HREF="mailto:root@medinf.chuvashia.su">root@medinf.chuvashia.su</a>
<DD>
User-defined functions (UDFs); <CODE>CREATE FUNCTION</CODE> and
<CODE>DROP FUNCTION</CODE>.
<DT>Andreas F. Bobak <a HREF="mailto:bobak@relog.ch">bobak@relog.ch</a>
<DD>
The <CODE>AGGREGATE</CODE> extension to UDF functions.
<DT>Ross Wakelin <a HREF="mailto:R.Wakelin@march.co.uk">R.Wakelin@march.co.uk</a>
<DD>
Help to set up InstallShield for MySQL-Win32.
<DT>Jethro Wright III <a HREF="mailto:jetman@li.net">jetman@li.net</a>
<DD>
The <TT>`libmysql.dll'</TT> library.
<DT>James Pereria <a HREF="mailto:jpereira@iafrica.com">jpereira@iafrica.com</a>
<DD>
Mysqlmanager, a Win32 GUI tool for administering MySQL Servers.
<DT>Curt Sampson <a HREF="mailto:cjs@portal.ca">cjs@portal.ca</a>
<DD>
Porting of MIT-pthreads to NetBSD/Alpha and NetBSD 1.3/i386.
<DT>Martin Ramsch <a HREF="mailto:m.ramsch@computer.org">m.ramsch@computer.org</a>
<DD>
Examples in the MySQL Tutorial.
<DT>Steve Harvey
<DD>
For making <CODE>mysqlaccess</CODE> more secure.
<DT>Konark IA-64 Centre of Persistent Systems Private Limited
<DD>
<a HREF="http://www.pspl.co.in/konark/">http://www.pspl.co.in/konark/</a>.  Help with the Win64 port of the
MySQL server.
<DT>Albert Chin-A-Young.
<DD>
Configure updates for Tru64, large file support and better TCP wrappers
support.
<DT>John Birrell
<DD>
Emulation of <CODE>pthread_mutex()</CODE> for OS/2.
<DT>Benjamin Pflugmann
<DD>
Extended <CODE>MERGE</CODE> tables to handle <CODE>INSERTS</CODE>. Active member
on the MySQL mailing lists.
<DT>Jocelyn Fournier
<DD>
Excellent spotting and reporting innumerable bugs
(especially in the MySQL 4.1 subquery code).
<DT>Marc Liyanage
<DD>
Maintaining the Mac OS X packages and providing invaluable feedback
on how to create Mac OS X PKGs.
<DT>Robert Rutherford
<DD>
Providing invaluable information and feedback about the QNX port.
</DL>

<P>
Other contributors, bugfinders, and testers: James H. Thompson, Maurizio
Menghini, Wojciech Tryc, Luca Berra, Zarko Mocnik, Wim Bonis, Elmar
Haneke, <a HREF="mailto:jehamby@lightside">jehamby@lightside</a>, <a HREF="mailto:psmith@BayNetworks.com">psmith@BayNetworks.com</a>,
<a HREF="mailto:duane@connect.com.au">duane@connect.com.au</a>, Ted Deppner <a HREF="mailto:ted@psyber.com">ted@psyber.com</a>,
Mike Simons, Jaakko Hyvatti.

</P>
<P>
And lots of bug report/patches from the folks on the mailing list.

</P>
<P>
A big tribute goes to those that help us answer questions on the
MySQL mailing lists:

</P>
<DL COMPACT>

<DT>Daniel Koch <a HREF="mailto:dkoch@amcity.com">dkoch@amcity.com</a>
<DD>
Irix setup.
<DT>Luuk de Boer <a HREF="mailto:luuk@wxs.nl">luuk@wxs.nl</a>
<DD>
Benchmark questions.
<DT>Tim Sailer <a HREF="mailto:tps@users.buoy.com">tps@users.buoy.com</a>
<DD>
<CODE>DBD::mysql</CODE> questions.
<DT>Boyd Lynn Gerber <a HREF="mailto:gerberb@zenez.com">gerberb@zenez.com</a>
<DD>
SCO-related questions.
<DT>Richard Mehalick <a HREF="mailto:RM186061@shellus.com">RM186061@shellus.com</a>
<DD>
<CODE>xmysql</CODE>-related questions and basic installation questions.
<DT>Zeev Suraski <a HREF="mailto:bourbon@netvision.net.il">bourbon@netvision.net.il</a>
<DD>
Apache module configuration questions (log &#38; auth), PHP-related
questions, SQL syntax-related questions and other general questions.
<DT>Francesc Guasch <a HREF="mailto:frankie@citel.upc.es">frankie@citel.upc.es</a>
<DD>
General questions.
<DT>Jonathan J Smith <a HREF="mailto:jsmith@wtp.net">jsmith@wtp.net</a>
<DD>
Questions pertaining to OS-specifics with Linux, SQL syntax, and other
things that might need some work.
<DT>David Sklar <a HREF="mailto:sklar@student.net">sklar@student.net</a>
<DD>
Using MySQL from PHP and Perl.
<DT>Alistair MacDonald <a HREF="mailto:A.MacDonald@uel.ac.uk">A.MacDonald@uel.ac.uk</a>
<DD>
Not yet specified, but is flexible and can handle Linux and maybe HP-UX.
Will try to get user to use <CODE>mysqlbug</CODE>.
<DT>John Lyon <a HREF="mailto:jlyon@imag.net">jlyon@imag.net</a>
<DD>
Questions about installing MySQL on Linux systems, using either
<TT>`.rpm'</TT> files or compiling from source.
<DT>Lorvid Ltd. <a HREF="mailto:lorvid@WOLFENET.com">lorvid@WOLFENET.com</a>
<DD>
Simple billing/license/support/copyright issues.
<DT>Patrick Sherrill <a HREF="mailto:patrick@coconet.com">patrick@coconet.com</a>
<DD>
ODBC and VisualC++ interface questions.
<DT>Randy Harmon <a HREF="mailto:rjharmon@uptimecomputers.com">rjharmon@uptimecomputers.com</a>
<DD>
<CODE>DBD</CODE>, Linux, some SQL syntax questions.
</DL>



<H2><A NAME="Documenters_Translators" HREF="manual_toc.html#Documenters_Translators">B.3  Documenters and translators</A></H2>

<P>
<A NAME="IDX2299"></A>
<A NAME="IDX2300"></A>

</P>
<P>
The following people has helped us with writing the MySQL documentation and
translating the documentation or error messages in MySQL.

</P>
<DL COMPACT>

<DT>Paul DuBois
<DD>
Ongoing help with making this manual correct and understandable.
That includes rewriting Monty's and David's attempts at English into
English as other people know it.
<DT>Kim Aldale
<DD>
Helped to rewrite Monty's and David's early attempts at English into English.
<DT>Michael J. Miller Jr. <a HREF="mailto:mke@terrapin.turbolift.com">mke@terrapin.turbolift.com</a>
<DD>
For the first MySQL manual. And a lot of spelling/language
fixes for the FAQ (that turned into the MySQL manual a long
time ago).
<DT>Yan Cailin
<DD>
First translator of the MySQL Reference Manual into simplified
Chinese in early 2000 on which the Big5 and HK coded
(<a HREF="http://mysql.hitstar.com/">http://mysql.hitstar.com/</a>) versions were
based. <a HREF="http://linuxdb.yeah.net"> Personal home page at
linuxdb.yeah.net</a>.
<DT>Jay Flaherty <a HREF="mailto:fty@mediapulse.com">fty@mediapulse.com</a>
<DD>
Big parts of the Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> section in the manual.
<DT>Paul Southworth <a HREF="mailto:pauls@etext.org">pauls@etext.org</a>, Ray Loyzaga <a HREF="mailto:yar@cs.su.oz.au">yar@cs.su.oz.au</a>
<DD>
Proof-reading of the Reference Manual.
<DT>Therrien Gilbert <a HREF="mailto:gilbert@ican.net">gilbert@ican.net</a>, Jean-Marc Pouyot <a HREF="mailto:jmp@scalaire.fr">jmp@scalaire.fr</a>
<DD>
French error messages.
<DT>Petr Snajdr, <a HREF="mailto:snajdr@pvt.net">snajdr@pvt.net</a>
<DD>
Czech error messages.
<DT>Jaroslaw Lewandowski <a HREF="mailto:jotel@itnet.com.pl">jotel@itnet.com.pl</a>
<DD>
Polish error messages.
<DT>Miguel Angel Fernandez Roiz
<DD>
Spanish error messages.
<DT>Roy-Magne Mo <a HREF="mailto:rmo@www.hivolda.no">rmo@www.hivolda.no</a>
<DD>
Norwegian error messages and testing of MySQL 3.21.xx.
<DT>Timur I. Bakeyev <a HREF="mailto:root@timur.tatarstan.ru">root@timur.tatarstan.ru</a>
<DD>
Russian error messages.
<DT><a HREF="mailto:brenno@dewinter.com">brenno@dewinter.com</a> &#38; Filippo Grassilli <a HREF="mailto:phil@hyppo.com">phil@hyppo.com</a>
<DD>
Italian error messages.
<DT>Dirk Munzinger <a HREF="mailto:dirk@trinity.saar.de">dirk@trinity.saar.de</a>
<DD>
German error messages.
<DT>Billik Stefan <a HREF="mailto:billik@sun.uniag.sk">billik@sun.uniag.sk</a>
<DD>
Slovak error messages.
<DT>Stefan Saroiu <a HREF="mailto:tzoompy@cs.washington.edu">tzoompy@cs.washington.edu</a>
<DD>
Romanian error messages.
<DT>Peter Feher
<DD>
Hungarian error messages.
<DT>Roberto M. Serqueira
<DD>
Portuguese error messages.
<DT>Carsten H. Pedersen
<DD>
Danish error messages.
<DT>Arjen G. Lentz
<DD>
Dutch error messages, completing earlier partial translation
(also work on consistency and spelling).
</DL>



<H2><A NAME="Used_Libraries" HREF="manual_toc.html#Used_Libraries">B.4  Libraries used by and included with MySQL</A></H2>

<P>
<A NAME="IDX2301"></A>

</P>
<P>
The following is a list of the creators of the libraries we have
included with the MySQL server source to make it easy to compile and
install MySQL. We are very thankfully to all individuals that have
created these and it has made our life much easier.

</P>
<DL COMPACT>

<DT>Fred Fish
<DD>
For his excellent C debugging and trace library. Monty has made a number
of smaller improvements to the library (speed and additional options).
<DT>Richard A. O'Keefe
<DD>
For his public domain string library.
<DT>Henry Spencer
<DD>
For his regex library, used in <CODE>WHERE column REGEXP regexp</CODE>.
<DT>Chris Provenzano
<DD>
Portable user level pthreads. From the copyright: This product includes
software developed by Chris Provenzano, the University of California,
Berkeley, and contributors.  We are currently using version 1_60_beta6
patched by Monty (see <TT>`mit-pthreads/Changes-mysql'</TT>).
<DT>Jean-loup Gailly and Mark Adler
<DD>
For the zlib library (used on MySQL on Windows).
<DT>Bjorn Benson
<DD>
For his safe_malloc (memory checker) package which is used in when you
configure MySQL with <CODE>--debug</CODE>.
<DT>Free Software Foundation
<DD>
The <CODE>readline</CODE> library (used by the <CODE>mysql</CODE> command line client).
<DT>The NetBSD foundation
<DD>
The <CODE>libedit</CODE> package (optionally used by the <CODE>mysql</CODE> command line
client).
</DL>



<H2><A NAME="Packages" HREF="manual_toc.html#Packages">B.5  Packages that support MySQL</A></H2>

<P>
<A NAME="IDX2302"></A>
<A NAME="IDX2303"></A>

</P>
<P>
The following is a list of creators/maintainers of some of the most
important API/packages/applications that a lot of people use with MySQL.

</P>
<P>
We can't list every possible package here because the list would then be
way to hard to maintain. For other packages, please refer to the
software portal at <a HREF="http://solutions.mysql.com/software/">http://solutions.mysql.com/software/</a>.

</P>
<DL COMPACT>

<DT>Tim Bunce, Alligator Descartes
<DD>
For the <CODE>DBD</CODE> (Perl) interface.
<DT>Andreas Koenig <a HREF="mailto:a.koenig@mind.de">a.koenig@mind.de</a>
<DD>
For the Perl interface for MySQL Server.
<DT>Jochen Wiedmann <a HREF="mailto:wiedmann@neckar-alb.de">wiedmann@neckar-alb.de</a>
<DD>
For maintaining the Perl <CODE>DBD::mysql</CODE> module.
<DT>Eugene Chan <a HREF="mailto:eugene@acenet.com.sg">eugene@acenet.com.sg</a>
<DD>
For porting PHP for MySQL Server.
<DT>Georg Richter
<DD>
MySQL 4.1 testing and bug hunting.
New PHP 5.0 <CODE>mysqli</CODE> extension (API) for use with MySQL 4.1 and up.
<DT>Giovanni Maruzzelli <a HREF="mailto:maruzz@matrice.it">maruzz@matrice.it</a>
<DD>
For porting iODBC (Unix ODBC).
<DT>Xavier Leroy <a HREF="mailto:Xavier.Leroy@inria.fr">Xavier.Leroy@inria.fr</a>
<DD>
The author of LinuxThreads (used by the MySQL Server on Linux).
</DL>



<H2><A NAME="Tools_used_to_create_MySQL" HREF="manual_toc.html#Tools_used_to_create_MySQL">B.6  Tools that were used to create MySQL</A></H2>

<P>
<A NAME="IDX2304"></A>

</P>
<P>
The following is a list of some of the tools we have used to create MySQL.
We use this to express our thanks to those that has created them as without
these we could not have made MySQL what is is today.

</P>
<DL COMPACT>

<DT>Free Software Foundation
<DD>
From whom we got an excellent compiler (<CODE>gcc</CODE>), an excellent
debugger (<CODE>gdb</CODE> and the <CODE>libc</CODE> library (from which we have
borrowed <TT>`strto.c'</TT> to get some code working in Linux).
<DT>Free Software Foundation &#38; The XEmacs development team
<DD>
For a really great editor/environment used by almost everybody at
MySQL AB.
<DT>Julian Seward
<DD>
Author of <CODE>valgrind</CODE>, an excellent memory checker tool that has helped
us find a lot of otherwise hard to find bugs in MySQL.
<DT>Dorothea L@"utkehaus and Andreas Zeller
<DD>
For <CODE>DDD</CODE> (The Data Display Debugger) which is an excellent
graphical frontend to <CODE>gdb</CODE>).
</DL>



<H2><A NAME="Supporters" HREF="manual_toc.html#Supporters">B.7  Supporters of MySQL</A></H2>

<P>
<A NAME="IDX2305"></A>

</P>
<P>
While <CODE>MySQL AB</CODE> owns all copyrights in the <CODE>MySQL server</CODE>
and the <CODE>MySQL manual</CODE>, we wish to recognize the following companies,
which helped us finance the development of the <CODE>MySQL server</CODE>,
such as by paying us for developing a new feature or giving us hardware
for development of the <CODE>MySQL server</CODE>.

</P>
<DL COMPACT>

<DT>VA Linux / Andover.net
<DD>
Funded replication.
<DT>NuSphere
<DD>
Editing of the MySQL manual.
<DT>Stork Design studio
<DD>
The MySQL Web site in use between 1998-2000.
<DT>Intel
<DD>
Contributed to development on Windows and Linux platforms.
<DT>Compaq
<DD>
Contributed to Development on Linux/Alpha.
<DT>SWSoft
<DD>
Development on the embedded <CODE>mysqld</CODE> version.
<DT>FutureQuest
<DD>
<CODE>--skip-show-database</CODE>
</DL>



<H1><A NAME="News" HREF="manual_toc.html#News">C  MySQL Change History</A></H1>

<P>
<A NAME="IDX2306"></A>
<A NAME="IDX2307"></A>
<A NAME="IDX2308"></A>

</P>
<P>
This appendix lists the changes from version to version in the MySQL
source code.

</P>
<P>
We are now working actively on MySQL 4.1 and 5.0, and will provide
only critical bugfixes for MySQL 4.0 and MySQL 3.23.  We update this section
as we add new features, so that everybody can follow the development.

</P>
<P>
Our TODO section contains what further plans we have for 4.1 &#38; 5.0.
See section <A HREF="manual.html#TODO">1.6  MySQL and the Future (the TODO)</A>.

</P>
<P>
Note that we tend to update the manual at the same time we make changes to
MySQL.  If you find a version listed here that you can't
find on the MySQL download page (<a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>),
this means that the version has not yet been released!

</P>
<P>
The date mentioned with a release version is the date of the last BitKeeper
ChangeSet that this particular release has been based on, not the date when
the packages have been made available. The binaries are usually made
available a few days after the date of the tagged ChangeSet - building and
testing all packages takes some time.

</P>



<H2><A NAME="News-5.0.x" HREF="manual_toc.html#News-5.0.x">C.1  Changes in release 5.0.x (Development)</A></H2>

<P>
<A NAME="IDX2309"></A>

</P>
<P>
The following changelog shows what has already been done in the 5.0 tree:

</P>

<UL>
<LI>

Basic support for stored procedures (SQL:2003 style).
See section <A HREF="manual.html#Stored_Procedures">19  Stored Procedures and Functions</A>.
<LI>

Added <CODE>SELECT INTO list_of_vars</CODE>, which can be of mixed,
that is, global and local type.
See section <A HREF="manual.html#SELECT_INTO_Statement">19.1.6.3  <CODE>SELECT ... INTO</CODE> Statement</A>.
<LI>

Removed the update log. It is fully replaced by the binary log.
If the MySQL server is started with <CODE>--log-update</CODE>, it will be
translated to <CODE>--log-bin</CODE> (or ignored if the server is explicitly
started with <CODE>--log-bin</CODE>), and a warning message will be written to
the error log. Setting <CODE>SQL_LOG_UPDATE</CODE> will silently set
<CODE>SQL_LOG_BIN</CODE> instead (or do nothing if the server is explicitly
started with <CODE>--log-bin</CODE>).
<LI>

User variable names are now case insensitive: If you do <CODE>SET
@a=10;</CODE> then <CODE>SELECT @A;</CODE> will now return <CODE>10</CODE>.
Case sensitivity of a variable's value depends on the collation of the value.
</UL>

<P>
For a full list of changes, please refer to the changelog sections for
each individual 5.0.x release.

</P>



<H3><A NAME="News-5.0.1" HREF="manual_toc.html#News-5.0.1">C.1.1  Changes in release 5.0.1 (not released yet)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

For replication of <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables: Made the master
automatically write a <CODE>DELETE FROM</CODE> statement to its binary log when a
<CODE>MEMORY</CODE> table is opened for the first time since master's startup.
This is for the case where the slave has replicated a non-empty
<CODE>MEMORY</CODE> table, then the master is shut down and restarted: the table
is now empty on master; the <CODE>DELETE FROM</CODE> empties it on slave too. Note
that even with this fix, between the master's restart and the first use of
the table on master, the slave still has out-of-date data in the table. But
if you use the <CODE>--init-file</CODE> option to populate the <CODE>MEMORY</CODE> table
on the master at startup, it ensures that the failing time interval is zero.
(Bug #2477)
<LI>

When a session having open temporary tables terminates, the statement
automatically written to the binary log is now <CODE>DROP TEMPORARY TABLE IF
EXISTS</CODE> instead of <CODE>DROP TEMPORARY TABLE</CODE>, for more robustness.
<LI>

The MySQL server now returns an error if <CODE>SET SQL_LOG_BIN</CODE> is issued by a
user without the <CODE>SUPER</CODE> privilege (in previous versions it just silently
ignored the statement in this case).
<LI>

Changed that when the MySQL server has binary logging disabled (that is, no
<CODE>log-bin</CODE> option was used) then no transaction binlog cache is allocated
for connections (this should save <CODE>binlog_cache_size</CODE> bytes of memory (32
kilobytes by default) for every connection).
<LI>

Added option <CODE>--replicate-same-server-id</CODE>.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Strange results with index (x, y) ... WHERE x=val_1 AND y&#62;=val_2 ORDER BY pk; (Bug #3155)
<LI>

Subquery and order by (Bug #3118)
<LI>

<CODE>ALTER DATABASE</CODE> caused the client to hang if the database did not
exist. (Bug #2333)
<LI>

<CODE>SLAVE START</CODE> (which is a deprecated syntax, <CODE>START SLAVE</CODE> should be
used instead) could crash the slave. (Bug #2516)
<LI>

Multiple-table <CODE>DELETE</CODE> statements were never replicated by the slave if
there were any <CODE>replicate-*-table</CODE> options. (Bug #2527)
<LI>

The MySQL server did not report any error if the query (submitted through
<CODE>mysql_real_query()</CODE> or <CODE>mysql_prepare()</CODE>) was terminated by garbage
characters (which can happen if you pass a wrong <CODE>length</CODE> parameter to
<CODE>mysql_real_query()</CODE> or <CODE>mysql_prepare()</CODE>); the result was that the
garbage characters were written into the binary log. (Bug #2703)
<LI>

Replication:
If a client connects to a slave server and issues an administrative
statement for a table (for example, <CODE>OPTIMIZE TABLE</CODE> or <CODE>REPAIR
TABLE</CODE>), this could sometimes stop the slave SQL thread. This does not lead
to any corruption, but you must use <CODE>START SLAVE</CODE> to get replication
going again. (Bug #1858)
<LI>

Made clearer the error message which one gets when an update is refused because
of the <CODE>read-only</CODE> option. (Bug #2757)
<LI>

Fixed that <CODE>replicate-wild-*-table</CODE> rules apply to <CODE>ALTER DATABASE</CODE>
when the table pattern is '%', like it is already the case for <CODE>CREATE
DATABASE</CODE> and <CODE>DROP DATABASE</CODE>. (Bug #3000)
<LI>

Fixed that when a <CODE>Rotate</CODE> event is found by the slave SQL thread in the
middle of a transaction, the value of <CODE>Relay_Log_Pos</CODE> in <CODE>SHOW SLAVE
STATUS</CODE> remains correct. (Bug #3017)
<LI>

Corrected the master's binary log position that <CODE>InnoDB</CODE> reports when it is doing a
crash recovery on a slave server. (Bug #3015)
<LI>

Changed the column <CODE>Seconds_Behind_Master</CODE> in <CODE>SHOW SLAVE STATUS</CODE> to
never show a value of -1. (Bug #2826)
<LI>

Changed that when a <CODE>DROP TEMPORARY TABLE</CODE> statement is automatically
written to the binlog when a session ends, the statement is recorded with an
error code of value zero (this ensures that killing a <CODE>SELECT</CODE> on the
master does not result in a superfluous error on the slave). (Bug #3063)
<LI>

Changed that when a thread handling <CODE>INSERT DELAYED</CODE> (also known as a
<CODE>delayed_insert</CODE> thread) is killed, its statements are recorded with an
error code of value zero (killing such a thread does not endanger
replication, so we thus avoid a superfluous error on the slave). (Bug #3081)
<LI>

Fixed deadlock when two <CODE>START SLAVE</CODE> commands were run at the same
time. (Bug #2921)
<LI>

Fixed that a statement never triggers a superfluous error on the slave, if it
must be excluded given the <CODE>replicate-*</CODE> options. The bug was that if the
statement had been killed on the master, the slave would stop. (Bug #2983)
<LI>

The <CODE>--local-load</CODE> option of <CODE>mysqlbinlog</CODE> now requires an argument.
<LI>

Fixed a segmentation fault when running <CODE>LOAD DATA FROM MASTER</CODE> after
<CODE>RESET SLAVE</CODE>. (Bug #2922)
<LI>

<CODE>mysqlbinlog --read-from-remote-server</CODE> read all binary logs following the
one that was requested.  It now stops at the end of the requested file, the
same was it does when reading a local binary log. (Bug #3204)
<LI>

Fixed <CODE>mysqlbinlog --read-from-remote-server</CODE> to print the exact
positions of events in the "at #" lines. (Bug #3214)
<LI>

Fixed a rare error condition that caused the slave SQL thread spuriously
to print the message <CODE>Binlog has bad magic number</CODE> and stop when it
was not necessary to do so.  (Bug #3401)
<LI>

Fixed <CODE>mysqlbinlog</CODE> not to forget to print a <CODE>USE</CODE> statement
under rare circumstances where the binary log contained a <CODE>LOAD DATA
INFILE</CODE> statement. (Bug #3415)
<LI>

Fixed a memory corruption when replicating a <CODE>LOAD DATA INFILE</CODE> when the
master had version 3.23. (Bug #3422)
<LI>

Multiple-table <CODE>DELETE</CODE> statements were always replicated by the slave if
there were some <CODE>replicate-*-ignore-table</CODE> options and no
<CODE>replicate-*-do-table</CODE> options. (Bug #3461)
<LI>

Fixed a crash of the MySQL slave server when it was built with
<CODE>--with-debug</CODE> and replicating itself. (BUG #3568)
<LI>

Fixed that in some replication error messages, a very long query caused the rest
of the message to be invisible (truncated), by putting the query last in the
message. (Bug #3357)
</UL>



<H3><A NAME="News-5.0.0" HREF="manual_toc.html#News-5.0.0">C.1.2  Changes in release 5.0.0 (22 Dec 2003: Alpha)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

The <CODE>KILL</CODE> statement now takes <CODE>CONNECTION</CODE> and <CODE>QUERY</CODE>
variants. The first is the same as <CODE>KILL</CODE> with no modifier (it
kills a given connection thread).  The second kills only the statement
currently being executed by the connection.
<LI>

Added <CODE>TIMESTAMPADD()</CODE> and <CODE>TIMESTAMPDIFF()</CODE> functions.
<LI>

Added <CODE>WEEK</CODE> and <CODE>QUARTER</CODE> values as <CODE>INTERVAL</CODE> arguments
for <CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE> functions.
<LI>

New binary log format that enables replication of those session variables:
<CODE>sql_mode</CODE>, <CODE>SQL_AUTO_IS_NULL</CODE>, <CODE>FOREIGN_KEY_CHECKS</CODE>
(that one was already replicated since 4.0.14 but here it's done more
efficiently: takes less space in the binary logs), <CODE>UNIQUE_CHECKS</CODE>.
Other variables (like character sets, <CODE>SQL_SELECT_LIMIT</CODE>...) will be
replicated in next 5.0.x releases.
<LI>

Implemented <CODE>Index Merge</CODE> optimization for <CODE>OR</CODE> clauses.
See section <A HREF="manual.html#OR_optimizations">7.2.5  How MySQL Optimizes <CODE>OR</CODE> Clauses</A>.
<LI>

Basic support for stored procedures (SQL:2003 style).
See section <A HREF="manual.html#Stored_Procedures">19  Stored Procedures and Functions</A>.
<LI>

Added <CODE>SELECT INTO list_of_vars</CODE>, which can be of mixed,
that is, global and local type.
See section <A HREF="manual.html#SELECT_INTO_Statement">19.1.6.3  <CODE>SELECT ... INTO</CODE> Statement</A>.
<LI>

Easier replication upgrade (5.0.0 masters can read older binary logs,
5.0.0 slaves can read older relay logs; see
section <A HREF="manual.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A> for more details). The format of the binary log and
relay log is changed compared to the one of MySQL 4.1 and older.
<LI>

<STRONG>Important note:</STRONG>
If you upgrade to InnoDB-4.1.1 or higher, you cannot downgrade to a version
lower than 4.1.1 any more! That is because earlier versions of <CODE>InnoDB</CODE> are
not aware of multiple tablespaces.
</UL>

<P>
Bugs fixed:

<UL>
</UL>



<H2><A NAME="News-4.1.x" HREF="manual_toc.html#News-4.1.x">C.2  Changes in release 4.1.x (Alpha)</A></H2>

<P>
<A NAME="IDX2310"></A>

</P>
<P>
Version 4.1 of the MySQL server includes many enhancements and new features.
Binaries for this version are available for download at
<a HREF="http://dev.mysql.com/downloads/mysql-4.1.html">http://dev.mysql.com/downloads/mysql-4.1.html</a>.

</P>

<UL>
<LI>

Subqueries and derived tables (unnamed views).
See section <A HREF="manual.html#Subqueries">14.1.8  Subquery Syntax</A>.
<LI>

<CODE>INSERT ... ON DUPLICATE KEY UPDATE ...</CODE> syntax.  This allows you to
<CODE>UPDATE</CODE> an existing row if the insert would cause a duplicate value
in a <CODE>PRIMARY</CODE> or <CODE>UNIQUE</CODE> key. (<CODE>REPLACE</CODE> allows you to
overwrite an existing row, which is something entirely different.)
See section <A HREF="manual.html#INSERT">14.1.4  <CODE>INSERT</CODE> Syntax</A>.
<LI>

A newly designed <CODE>GROUP_CONCAT()</CODE> aggregate function.
See section <A HREF="manual.html#Group_by_functions_and_modifiers">13.9  Functions and Modifiers for Use with <CODE>GROUP BY</CODE> Clauses</A>.
<LI>

Extensive Unicode (UTF8) support.
<LI>

Character sets can be defined per column, table, and database.
<LI>

New key cache for <CODE>MyISAM</CODE> tables with many tunable parameters.  You can
have multiple key caches, preload index into caches for batches...
<LI>

<CODE>BTREE</CODE> index on <CODE>HEAP</CODE> tables.
<LI>

Support for OpenGIS spatial types (geographical data).
See section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.
<LI>

<CODE>SHOW WARNINGS</CODE> shows warnings for the last command.
See section <A HREF="manual.html#SHOW_WARNINGS">14.5.3.20  <CODE>SHOW WARNINGS</CODE> Syntax</A>.
<LI>

Faster binary protocol with prepared statements and parameter binding.
See section <A HREF="manual.html#C_API_Prepared_statements">20.2.4  C API Prepared Statements</A>.
<LI>

You can now issue multiple statements with a single C API call and
then read the results in one go.
See section <A HREF="manual.html#C_API_multiple_queries">20.2.8  C API Handling of Multiple Query Execution</A>.
<LI>

Create Table: <CODE>CREATE [TEMPORARY] TABLE [IF NOT EXISTS] table2 LIKE
table1</CODE>.
<LI>

Server based <CODE>HELP</CODE> command that can be used in the <CODE>mysql</CODE>
command line client (and other clients) to get help for SQL statements.
</UL>

<P>
For a full list of changes, please refer to the changelog sections for
each individual 4.1.x release.

</P>



<H3><A NAME="News-4.1.2" HREF="manual_toc.html#News-4.1.2">C.2.1  Changes in release 4.1.2 (not released yet)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>mysql</CODE> command-line client now supports multiple <CODE>-e</CODE> options.
(Bug #591)
<LI>

New <CODE>myisam_data_pointer_size</CODE> system variable.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

The <CODE>--log-warnings</CODE> server option now is enabled by default.
Disable with <CODE>--skip-log-warnings</CODE>.
<LI>

The <CODE>--defaults-file=file_name</CODE> option now requires that the filename
must exist (safety fix). (Bug #3413)
<LI>

<TT>`mysqld_multi'</TT> now creates the log in datadir (from <CODE>[mysqld]</CODE>
section in <TT>`my.cnf'</TT> or compiled in), not in <TT>`/tmp'</TT> -
vulnerability id CAN-2004-0388. Thanks to Christian Hammers from
Debian Security Team for reporting this!
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
String comparison now works according to the SQL standard.  Because we have
that <CODE>'a' = 'a '</CODE> then from it must follow that <CODE>'a' &#62; 'a\t'</CODE>.
(The latter was not the case before 4.1.2.) To implement it, we had to
change how storage engines compare strings internally.  As a side effect, if
you have a table where a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column in some row
has a value with the last character less than <CODE>ASCII(32)</CODE>, you will have
to repair this table. <CODE>CHECK TABLES</CODE> will tell you if this problem
exists. (Bug #3152)
<LI>

Added support for <CODE>DEFAULT CURRENT_TIMESTAMP</CODE> and for <CODE>ON UPDATE
CURRENT_TIMESTAMP</CODE> specifications for <CODE>TIMESTAMP</CODE> columns. Now you can
explicitly say that a <CODE>TIMESTAMP</CODE> column should be set automatically
to the current timestamp for <CODE>INSERT</CODE> and/or <CODE>UPDATE</CODE> statements, or
even prevent the column from updating automatically. Only one column with such
an auto-set 
feature per table is supported. <CODE>TIMESTAMP</CODE> columns created with earlier 
versions of MySQL behave as before. Behavior of <CODE>TIMESTAMP</CODE> columns that 
were created without explicit specification of default/on as earlier
depends on its position in table: If it is the first <CODE>TIMESTAMP</CODE> column, it will
be treated as having been specified as <CODE>TIMESTAMP DEFAULT
CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</CODE>.
In other cases, it would be treated as a <CODE>TIMESTAMP DEFAULT 0</CODE> column.
<CODE>NOW</CODE> is supported as an alias for <CODE>CURRENT_TIMESTAMP</CODE>.
<STRONG>Warning: Incompatible change!</STRONG> Unlike in previous versions, explicit
specification of default values for <CODE>TIMESTAMP</CODE> column is never ignored
and turns off the auto-set feature (unless you have <CODE>CURRENT_TIMESTAMP</CODE> as
the default).
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
Renamed prepared statements C API functions:
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Old Name</STRONG> </TD><TD> <STRONG>New Name</STRONG>
</TD></TR>
<TR><TD><CODE>mysql_bind_param()</CODE> </TD><TD> <CODE>mysql_stmt_bind_param()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_bind_result()</CODE> </TD><TD> <CODE>mysql_stmt_bind_result()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_prepare()</CODE> </TD><TD> <CODE>mysql_stmt_prepare()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_execute()</CODE> </TD><TD> <CODE>mysql_stmt_execute()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_fetch()</CODE> </TD><TD> <CODE>mysql_stmt_fetch()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_fetch_column()</CODE> </TD><TD> <CODE>mysql_stmt_fetch_column()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_param_count()</CODE> </TD><TD> <CODE>mysql_stmt_param_count()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_param_result()</CODE> </TD><TD> <CODE>mysql_stmt_param_metadata()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_get_metadata()</CODE> </TD><TD> <CODE>mysql_stmt_result_metadata()</CODE>
</TD></TR>
<TR><TD><CODE>mysql_send_long_data()</CODE> </TD><TD> <CODE>mysql_stmt_send_long_data()</CODE>
</TD></TR>
</TABLE>

Now all functions that operate with a <CODE>MYSQL_STMT</CODE> structure begin with
the prefix <CODE>mysql_stmt_</CODE>.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
The signature of the <CODE>mysql_stmt_prepare()</CODE> function was changed to
<CODE>int mysql_stmt_prepare(MYSQL_STMT *stmt, const char *query,
unsigned long length)</CODE>.
To create a <CODE>MYSQL_STMT</CODE> handle, you 
should use the <CODE>mysql_stmt_init()</CODE> function.
<LI>

<CODE>SHOW GRANTS</CODE> with no <CODE>FOR</CODE> clause or with <CODE>FOR
CURRENT_USER()</CODE> shows the privileges for the current session.
<LI>

The improved character set support introduced in MySQL 4.1.0 for the
<CODE>MyISAM</CODE> and <CODE>HEAP</CODE> storage engines is now available for
<CODE>InnoDB</CODE> as well.
<LI>

A name of ``Primary'' no longer can be specified as an index name.
(That name is reserved for the <CODE>PRIMARY KEY</CODE> if the table has one.)
(Bug #856)
<LI>

MySQL now issues a warning when a <CODE>SET</CODE> or <CODE>ENUM</CODE> column with
duplicate values in the list is created. (Bug #1427)
<LI>

Now <CODE>SQL_SELECT_LIMIT</CODE> variable has no influence on subqueries.
(Bug #2600)
<LI>

<CODE>UNHEX()</CODE> function implemented.
See section <A HREF="manual.html#String_functions">13.3  String Functions</A>.
<LI>

History in command line client does not store multiple copies of identical queries that are run consecutively.
<LI>

Multi-line queries in the command line client now are stored as a single line. 
<LI>

<CODE>UUID()</CODE> function implemented. Note that it does not work with replication
yet.
See section <A HREF="manual.html#Miscellaneous_functions">13.8.4  Miscellaneous Functions</A>.
<LI>

Prepared statements with all types of subqueries fixed.
<LI>

MySQL now supports up to 64 keys per table.
<LI>

<CODE>MyISAM</CODE> tables now support keys up to 1000 bytes long.
<LI>

<CODE>MyISAM</CODE> and <CODE>InnoDB</CODE> tables now support index prefix lengths up
to 1000 bytes long.
<LI>

If you try to create a key with a key part that is too long, and it is safe
to auto-truncate it to a smaller length, MySQL now does so.  A warning is
generated, rather than an error.
<LI>

The <CODE>ft_boolean_syntax</CODE> variable now can be changed while the server is
running.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

<CODE>REVOKE ALL PRIVILEGES, GRANT FROM user_list</CODE>
is changed to a more consistent
<CODE>REVOKE ALL PRIVILEGES, GRANT OPTION FROM user_list</CODE>. (Bug #2642)
<LI>

Internal string-to-number conversion now supports only SQL:2003 compatible
syntax for numbers. In particular, <CODE>'0x10'+0</CODE> will not work anymore.
(Actually, it worked only on some systems before, such as Linux. It
did not work on others, such as FreeBSD or Solaris. Making these queries
OS-independent was the goal of this change). Use <CODE>CONV()</CODE> to convert
hexadecimal numbers to decimal. E.g. <CODE>CONV(MID('0x10',3),16,10)+0</CODE>.
<LI>

<CODE>mysqlhotcopy</CODE> now works on NetWare.
<LI>

<CODE>ALTER TABLE DROP PRIMARY KEY</CODE> no longer drops the first <CODE>UNIQUE</CODE>
index if there is no primary index. (Bug #2361)
<LI>

Added <CODE>latin1_spanish_ci</CODE> (Modern Spanish) collation for the <CODE>latin1</CODE>
character set.
<LI>

Added the <CODE>ENGINE</CODE> table option as a synonym for the <CODE>TYPE</CODE> option
for <CODE>CREATE TABLE</CODE> and <CODE>ALTER TABLE</CODE>.
<LI>

Added the <CODE>--default-storage-engine</CODE> server option as a synonym for
<CODE>--default-table-type</CODE>.
<LI>

Added the <CODE>storage_engine</CODE> system variable as a synonym for
<CODE>table_type</CODE>.
<LI>

Added <CODE>init_connect</CODE> and <CODE>init_slave</CODE> server variables.
The values should be SQL statements to be executed when each client
connects or each time a slave's SQL thread starts, respectively.
<LI>

C API enhancement:
<CODE>SERVER_QUERY_NO_INDEX_USED</CODE> and
<CODE>SERVER_QUERY_NO_GOOD_INDEX_USED</CODE> flags are now set
in the <CODE>server_status</CODE> field of the <CODE>MYSQL</CODE> structure.
It is these flags that make the query to be logged as slow 
if <CODE>mysqld</CODE> was started with <CODE>--log-slow-queries
--log-queries-not-using-indexes</CODE>.
<LI>

For replication of <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables: Made the master
automatically write a <CODE>DELETE FROM</CODE> statement to its binary log when a
<CODE>MEMORY</CODE> table is opened for the first time since master's startup.
This is for the case where the slave has replicated a non-empty
<CODE>MEMORY</CODE> table, then the master is shut down and restarted: the table
is now empty on master; the <CODE>DELETE FROM</CODE> empties it on slave too. Note
that even with this fix, between the master's restart and the first use of
the table on master, the slave still has out-of-date data in the table. But
if you use the <CODE>init-file</CODE> option to populate the <CODE>MEMORY</CODE> table
on the master at startup, it ensures that the failing time interval is zero.
(Bug #2477)
<LI>

When a session having open temporary tables terminates, the statement
automatically written to the binary log is now <CODE>DROP TEMPORARY TABLE IF
EXISTS</CODE> instead of <CODE>DROP TEMPORARY TABLE</CODE>, for more robustness.
<LI>

The MySQL server now returns an error if <CODE>SET SQL_LOG_BIN</CODE> or <CODE>SET
SQL_LOG_UPDATE</CODE> is issued by a user without the <CODE>SUPER</CODE> privilege (in
previous versions it just silently ignored the statement in this case).
<LI>

Changed that when the MySQL server has binary logging disabled (that is, no
<CODE>log-bin</CODE> option was used) then no transaction binlog cache is allocated
for connections (this should save <CODE>binlog_cache_size</CODE> bytes of memory (32
kilobytes by default) for every connection).
<LI>

Added <CODE>Binlog_cache_use</CODE> and <CODE>Binlog_cache_disk_use</CODE> status
variables that count the number of transactions that used transaction binary
log and that had to flush this temporary binary log to disk instead of using
only buffer in memory. They can be used for tuning the
<CODE>binlog_cache_size</CODE> system variable.
<LI>

Added option <CODE>--replicate-same-server-id</CODE>.
<LI>

The Mac OS X Startup Item has been moved from the directory
<TT>`/Library/StartupItems/MySQL'</TT> to <TT>`/Library/StartupItems/MySQLCOM'</TT>
to avoid a file name collision with the MySQL Startup Item installed with
Mac OS X Server. See section <A HREF="manual.html#Mac_OS_X">2.6.2  Mac OS X Notes</A>.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

<CODE>UNION</CODE>s did not consult <CODE>SQL_SELECT_LIMIT</CODE> value when
set. This is now fixed properly, which means that this limit is applied
to the top level query, unless <CODE>LIMIT</CODE> for entire <CODE>UNION</CODE> is
used. 
<LI>

Fixed a bug in multi table <CODE>UPDATE</CODE>s which resulted in error when
one of the tables was not updated but was used in the nested query,
contained therein.
<LI>

Fixed <CODE>mysql_stmt_send_long_data()</CODE> behavior on second execution of 
prepared statement and in case when long data had zero length. (Bug #1664)
<LI>

Fixed crash on second execution of prepared statement with <CODE>UNION</CODE>.
(Bug #3577)
<LI>

Fixed incorrect results of aggregate functions in subquery with empty result
set. (Bug #3505)
<LI>

One can now call <CODE>mysql_stmt_attr_set(..., STMT_ATTR_UPDATE_MAX_LENGTH)</CODE>
to tell the client library to update <CODE>MYSQL_FIELD-&#62;max_length</CODE> when
doing <CODE>mysql_stmt_store_result()</CODE>. (Bug #1647).
<LI>

Added support for unsigned integer types to prepared statement API
(Bug #3035).
<LI>

Fixed crash in prepared statements when subquery in the <CODE>FROM</CODE>
clause with parameter used. (Bug #3020)
<LI>

Fixed unknown error when negative value bind to unsigned. (Bug #3223)
<LI>

Fixed aggregate function in prepared statements. (Bug #3360)
<LI>

Incorrect error message when wrong table used in <CODE>multi-delete</CODE>
statement in prepared statements. (Bug #3411)
<LI>

Requiring <CODE>UPDATE</CODE> privilege for tables which will not be updated in
<CODE>multi-update</CODE> query in prepared statements.
<LI>

Fixed prepared statement support for <CODE>INSERT</CODE>, <CODE>REPLACE</CODE>,
<CODE>CREATE</CODE>, <CODE>DELETE</CODE>, <CODE>SELECT</CODE>, <CODE>DO</CODE>, <CODE>SET</CODE> and
<CODE>SHOW</CODE>. All other commands are prohibited via prepared statement
interface. (Bug ##3398, Bug #3406, Bug #2811)
<LI>

Fixed a lot of bugs in <CODE>GROUP_CONCAT()</CODE>. (Bug #2695, Bug #3381, Bug #3319)
<LI>

Added optimization that allows for prepared statements using a large number of 
tables or tables with a large number of columns to be re-executed significantly 
faster. (Bug #2050)
<LI>

Fixed bug that caused execution of prepared statements to fail then table
that this statement were using left table cache. This bug showed up as if
this prepared statement used random garbage as column names or as server
crashes. (Bug #3307)
<LI>

Fixed a problem resulting from setting the <CODE>character_set_results</CODE>
variable to <CODE>NULL</CODE>.
(Bug #3296)
<LI>

Fixed query cache statistics.
<LI>

Fixed bug in <CODE>ANALYZE TABLE</CODE> on a <CODE>BDB</CODE> table inside a transaction
that hangs server thread. (Bug #2342)
<LI>

Fixed a symlink vulnerability in <TT>`mysqlbug'</TT> script. (Bug #3284)
<LI>

Fixed a bug in parallel repair
(<CODE>myisamchk -p</CODE>, <CODE>myisam_repair_threads</CODE>);
sometimes the repair process failed to repair a table. (Bug #1334)
<LI>

A query that uses both <CODE>UNION [DISTINCT]</CODE> and <CODE>UNION ALL</CODE>
now works correctly. (Bug #1428)
<LI>

Table default character set affects <CODE>LONGBLOB</CODE> columns. (Bug #2821)
<LI>

<CODE>CONCAT_WS()</CODE> makes the server die in case of illegal mix of collations. (Bug #3087)
<LI>

UTF8 charset breaks joins with mixed column/string constant. (Bug #2959)
<LI>

Fixed <CODE>DROP DATABASE</CODE> to report number of tables deleted.
<LI>

Fixed memory leak in the client library when statement handle was freed 
on closed connection (call to <CODE>mysql_stmt_close</CODE> after
<CODE>mysql_close</CODE>). (Bug #3073)
<LI>

Fixed server segfaults when processing malformed prepared statements
commands. (Bug #2795, Bug #2274)
<LI>

Fixed using subqueries with <CODE>OR</CODE> and <CODE>AND</CODE> functions. (Bug #2838)
<LI>

Fixed comparison of tables/database names with 
<CODE>--lower_case_table_names</CODE> option. (Bug #2880)
<LI>

Removed try to check <CODE>NULL</CODE> if index built on column where <CODE>NULL</CODE>
is impossible in <CODE>IN</CODE> subquery optimization. (Bug #2393)
<LI>

Fixed incorrect parsing of subqueries in the <CODE>FROM</CODE> clause. (Bug #2421)
<LI>

Fixed processing of <CODE>RAND()</CODE> in subqueries with static tables. (bug #2645)
<LI>

Fixed bug with quoting of table names in <CODE>mysqldump</CODE> for 
various values of <CODE>sql_mode</CODE> of server. (Bug #2591)
<LI>

Fixed bug with storing values that are out of range for <CODE>DOUBLE</CODE> and
<CODE>FLOAT</CODE> columns.
(Bug #2082)
<LI>

Fixed bug with compiling <CODE>--with-pstack</CODE> with binutils 2.13.90. (Bug #1661)
<LI>

Fixed a bug in the <CODE>GRANT</CODE> system. When a password was assigned to an
account at the global level and then privileges were granted at the database
level (without specifying any password), the existing password was replaced
temporarily in memory until the next <CODE>FLUSH PRIVILEGES</CODE> operation or
the server was restarted. (Bug #2953)
<LI>

Fixed a bug in full-text search on multi-byte character set (such as UTF8)
that appeared when a search word was shorter than a matching word from
the index (for example, searching for ``Uppsala'' when table data contain
``Upps@ringaccent{a}la''). (Bug #3011)
<LI>

Fixed a bug that made <CODE>Max_used_connections</CODE> to be less than
the actual maximum number of connections in use simultaneously.
<LI>

Fixed calculation of <CODE>Index_length</CODE> in <CODE>HEAP</CODE> table status for
<CODE>BTREE</CODE> indexes. (Bug #2719)
<LI>

Fixed <CODE>mysql_stmt_affected_rows()</CODE> call to always return number of rows 
affected by given statement. (Bug #2247)
<LI>

Fixed crash in <CODE>MATCH ... AGAINST()</CODE> on a phrase search operator with
a missing closing double quote. (Bug #2708)
<LI>

Fixed output of <CODE>mysqldump --tab</CODE>. (Bug #2705)
<LI>

Fix for a bug in <CODE>UNION</CODE> operations that prevented proper handling of
<CODE>NULL</CODE> columns. This happened only if a column in the first
<CODE>SELECT</CODE> node was <CODE>NOT NULL</CODE>. (Bug #2508)
<LI>

Fix for a bug in <CODE>UNION</CODE> operations with <CODE>InnoDB</CODE> storage engine,
when some columns from one table where used in one <CODE>SELECT</CODE> statement and
some were used in another <CODE>SELECT</CODE> statement. (Bug #2552)
<LI>

Fixed a few years old bug in the range optimizer that
caused a segmentation fault on some very rare queries. (Bug #2698)
<LI>

Fixed bug with <CODE>SHOW CREATE TABLE ...</CODE> which didn't properly double 
quotes. (Bug #2593)
<LI>

Queries with subqueries in <CODE>FROM</CODE> clause locks all tables at once for now.
This also fixed bugs in <CODE>EXPLAIN</CODE> of subqueries
in <CODE>FROM</CODE> output. (Bug #2120)
<LI>

Fixed bug with <CODE>mysqldump</CODE> not quoting ``tricky'' names correctly.
(Bug #2592)
<LI>

Fix for a bug that prevented table / column privileges from
being loaded on startup. (Bug #2546)
<LI>

Fixed bug in replication with <CODE>CREATE TABLE ... LIKE ...</CODE> that resulted
in a statement not being written to the binary log. (Bug #2557)
<LI>

Fixed memory leak in <CODE>INSERT ... ON DUPLICATE KEY UPDATE ...</CODE>. 
(Bug #2438)
<LI>

Fixed bug in the parser, making the syntax <CODE>CONVERT(expr,type)</CODE>
legal again.
<LI>

Fixed parsing of short-form IP addresses in <CODE>INET_ATON()</CODE>. (Bug #2310)
<LI>

Fixed a bug in <CODE>CREATE ... SELECT</CODE> that sometimes caused a
string column with a multi-byte character set (such as <CODE>utf8</CODE>) to have
insufficient length to hold the data.
<LI>

Fixed a rare table corruption on adding data (<CODE>INSERT</CODE>, <CODE>REPLACE</CODE>,
<CODE>UPDATE</CODE>, etc. but not <CODE>DELETE</CODE>) to a <CODE>FULLTEXT</CODE> index.
(Bug #2417)
<LI>

Compile the <CODE>MySQL-client</CODE> RPM package against <CODE>libreadline</CODE> instead
of <CODE>libedit</CODE>. (Bug #2289)
<LI>

Fix for a crashing bug that was caused by not setting
<CODE>vio_timeout()</CODE> virtual function for all protocols. This bug occurred on
Windows. (Bug #2025)
<LI>

Fix for a bug that caused <CODE>mysql</CODE> client program to erroneously
cache the value of the current database. (Bug #2025)
<LI>

Fix for a bug that caused client/server communication to be
broken when <CODE>mysql_set_server_option()</CODE> or
<CODE>mysql_get_server_option()</CODE> were invoked.
(Bug #2207)
<LI>

Fix for a bug that caused wong results when <CODE>CAST()</CODE> was
applied on <CODE>NULL</CODE> to signed or unsigned integer column.
(Bug #2219)
<LI>

Fix for a crashing bug that occurred in the <CODE>mysql</CODE> client program when
database name was longer then expected.
(Bug #2221)
<LI>

Fixed a bug in <CODE>CHECK TABLE</CODE> that sometimes
resulted in a spurious error <CODE>Found key at page ... that points to record
outside datafile</CODE> for a table with a <CODE>FULLTEXT</CODE> index. (Bug #2190)
<LI>

Fixed bug in <CODE>GRANT</CODE> with table-level privilege handling. (Bug #2178)
<LI>

Fixed bug in <CODE>ORDER BY</CODE> on a small column. (Bug #2147)
<LI>

Fixed a bug with the <CODE>INTERVAL()</CODE> function when 8 or more 
comparison arguments are provided. (Bug #1561)
<LI>

Packaging:
Fixed a bug in the Mac OS PKG <CODE>postinstall</CODE> script
(<CODE>mysql_install_db</CODE> was called with an obsolete argument).
<LI>

Packaging:
Added missing file <TT>`mysql_create_system_tables'</TT> to the server RPM
package. This bug was fixed for the 4.1.1 RPMs by updating the MySQL-server
RPM from <CODE>MySQL-server-4.1.1-0</CODE> to <CODE>MySQL-server-4.1.1-1</CODE>. The
other RPMs were not affected by this change.
<LI>

Fixed a bug in <TT>`myisamchk'</TT> and <CODE>CHECK TABLE</CODE> that sometimes
resulted in a spurious error <CODE>Found key at page ... that points to record
outside datafile</CODE> for a table with a <CODE>FULLTEXT</CODE> index. (Bug #1977)
<LI>

Fixed a hang in full-text indexing of strings in multi-byte (all besides
<CODE>utf8</CODE>) charsets. (Bug #2065)
<LI>

Fixed a crash in full-text indexing of UTF8 data. (Bug #2033)
<LI>

Replication:
a rare race condition in the slave SQL thread that could lead to an
incorrect complaint that the relay log is corrupted. (Bug #2011)
<LI>

Replication:
If a client connects to a slave server and issues an administrative
statement for a table (for example, <CODE>OPTIMIZE TABLE</CODE> or <CODE>REPAIR
TABLE</CODE>), this could sometimes stop the slave SQL thread. This does not lead
to any corruption, but you must use <CODE>START SLAVE</CODE> to get replication
going again. (Bug #1858)
<LI>

Replication:
in the slave SQL thread, a multiple-table <CODE>UPDATE</CODE> could produce an
incorrect complaint that some record was not found in one table, if the
<CODE>UPDATE</CODE> was preceded by a <CODE>INSERT ... SELECT</CODE>. (Bug #1701)
<LI>

Replication: sometimes the master gets a non-fatal error during the execution
of a statement but finally the statements succeeds (for example, a write to a
<CODE>MyISAM</CODE> table first receives "no space left on device" but is able to finally
complete, see section <A HREF="manual.html#Full_disk">A.4.3  How MySQL Handles a Full Disk</A>); the bug was that the master forgot to reset the
error code to 0 after success, so the error code got into its binary log, thus
making the slave giving false alarms like "did not get the same error as on
master". (Bug #2083)
<LI>

Removed a misleading "check permissions on master.info" from a replication
error message, because the cause of the problem could be different from
permissions. (Bug #2121)
<LI>

Fixed a crash when the replication slave was unable to create the first relay
log. (Bug #2145)
<LI>

<CODE>ALTER DATABASE</CODE> caused the client to hang if the database did not
exist. (Bug #2333)
<LI>

Multiple-table <CODE>DELETE</CODE> statements were never replicated by the slave if
there were any <CODE>replicate-*-table</CODE> options. (Bug #2527)
<LI>

Fixed bug in <CODE>ALTER TABLE RENAME</CODE>, when rename to the table with
the same name in another database silently dropped destination table if
it existed. (Bug #2628)
<LI>

The MySQL server did not report any error if the query (submitted through
<CODE>mysql_real_query()</CODE> or <CODE>mysql_prepare()</CODE>) was terminated by garbage
characters (which can happen if you pass a wrong <CODE>length</CODE> parameter to
<CODE>mysql_real_query()</CODE> or <CODE>mysql_prepare()</CODE>); the result was that the
garbage characters were written into the binary log. (Bug #2703)
<LI>

Fixed bug in client library which caused <CODE>mysql_fetch</CODE> and 
<CODE>mysql_stmt_store_result()</CODE> to hang if they were called without
prior call of <CODE>mysql_execute()</CODE>. Now they give an error instead. 
(Bug #2248)
<LI>

Made clearer the error message which one gets when an update is refused because
of the <CODE>read-only</CODE> option. (Bug #2757)
<LI>

Fixed that <CODE>replicate-wild-*-table</CODE> rules apply to <CODE>ALTER DATABASE</CODE>
when the table pattern is '%', like it is already the case for <CODE>CREATE
DATABASE</CODE> and <CODE>DROP DATABASE</CODE>. (Bug #3000)
<LI>

Fixed that when a <CODE>Rotate</CODE> event is found by the slave SQL thread in the
middle of a transaction, the value of <CODE>Relay_Log_Pos</CODE> in <CODE>SHOW SLAVE
STATUS</CODE> remains correct. (Bug #3017)
<LI>

Corrected the master's binary log position that <CODE>InnoDB</CODE> reports when it is doing a
crash recovery on a slave server. (Bug #3015)
<LI>

Changed the column <CODE>Seconds_Behind_Master</CODE> in <CODE>SHOW SLAVE STATUS</CODE> to
never show a value of -1. (Bug #2826)
<LI>

Changed that when a <CODE>DROP TEMPORARY TABLE</CODE> statement is automatically
written to the binary log when a session ends, the statement is recorded with an
error code of value zero (this ensures that killing a <CODE>SELECT</CODE> on the
master does not result in a superfluous error on the slave). (Bug #3063)
<LI>

Changed that when a thread handling <CODE>INSERT DELAYED</CODE> (also known as a
<CODE>delayed_insert</CODE> thread) is killed, its statements are recorded with an
error code of value zero (killing such a thread does not endanger
replication, so we thus avoid a superfluous error on the slave). (Bug #3081)
<LI>

Fixed deadlock when two <CODE>START SLAVE</CODE> commands were run at the same
time. (Bug #2921)
<LI>

Fixed that a statement never triggers a superfluous error on the slave, if it
must be excluded given the <CODE>replicate-*</CODE> options. The bug was that if the
statement had been killed on the master, the slave would stop. (Bug #2983)
<LI>

The <CODE>--local-load</CODE> option of <CODE>mysqlbinlog</CODE> now requires an argument.
<LI>

Fixed a segmentation fault when running <CODE>LOAD DATA FROM MASTER</CODE> after
<CODE>RESET SLAVE</CODE>. (Bug #2922)
<LI>

<CODE>mysqlbinlog --read-from-remote-server</CODE> read all binary logs following the
one that was requested.  It now stops at the end of the requested file, the
same was it does when reading a local binary log. (Bug #3204)
<LI>

Fixed <CODE>mysqlbinlog --read-from-remote-server</CODE> to print the exact
positions of events in the "at #" lines. (Bug #3214)
<LI>

Fixed a rare error condition that caused the slave SQL thread spuriously
to print the message <CODE>Binlog has bad magic number</CODE> and stop when it
was not necessary to do so.  (Bug #3401)
<LI>

Fixed the <CODE>Exec_master_log_pos</CODE> column and its disk image in the
<TT>`relay-log.info'</TT> file to be correct if the master had version 3.23. (The
value was too big by six bytes.) This bug does not exist in MySQL 5.0.
(Bug #3400)
<LI>

Fixed <CODE>mysqlbinlog</CODE> not to forget to print a <CODE>USE</CODE> statement
under rare circumstances where the binary log contained a <CODE>LOAD DATA
INFILE</CODE> statement. (Bug #3415)
<LI>

Fixed a memory corruption when replicating a <CODE>LOAD DATA INFILE</CODE> when the
master had version 3.23. Some smaller problems remain in this setup,
See section <A HREF="manual.html#Replication_Features">6.7  Replication Features and Known Problems</A>. (Bug #3422)
<LI>

Multiple-table <CODE>DELETE</CODE> statements were always replicated by the slave if
there were some <CODE>replicate-*-ignore-table</CODE> options and no
<CODE>replicate-*-do-table</CODE> options. (Bug #3461)
<LI>

Fixed a crash of the MySQL slave server when it was built with
<CODE>--with-debug</CODE> and replicating itself. (BUG #3568)
<LI>

Fixed that in some replication error messages, a very long query caused the rest
of the message to be invisible (truncated), by putting the query last in the
message. (Bug #3357)
</UL>



<H3><A NAME="News-4.1.1" HREF="manual_toc.html#News-4.1.1">C.2.2  Changes in release 4.1.1 (01 Dec 2003)</A></H3>

<P>
This release includes all fixes in MySQL 4.0.16 and most of the fixes
in MySQL 4.0.17.

</P>
<P>
Functionality added or changed:

<UL>
<LI>

New <CODE>CHECKSUM TABLE</CODE> statement for reporting table checksum values.
<LI>

Added <CODE>character_set_client</CODE>, <CODE>character_set_connection</CODE>,
<CODE>character_set_database</CODE>, <CODE>character_set_results</CODE>,
<CODE>character_set_server</CODE>, <CODE>character_set_system</CODE>,
<CODE>collation_connection</CODE>, <CODE>collation_database</CODE>, and
<CODE>collation_server</CODE> system variables to provide information about
character sets and collations.
<LI>

It is now possible to create multiple key caches, assign table indexes to
particular caches, and to preload indexes into caches.
See section <A HREF="manual.html#CACHE_INDEX">14.5.4.1  <CODE>CACHE INDEX</CODE> Syntax</A>.
See section <A HREF="manual.html#LOAD_INDEX">14.5.4.4  <CODE>LOAD INDEX INTO CACHE</CODE> Syntax</A>.
Structured system
variables are introduced as a means of grouping related key cache parameters.
See section <A HREF="manual.html#Structured_System_Variables">10.4.1  Structured System Variables</A>.
<LI>

New <CODE>COERCIBILITY()</CODE> function to return the collation coercibility of a
string.
<LI>

The <CODE>--quote-names</CODE> option for <CODE>mysqldump</CODE> now is enabled
by default.
<LI>

<CODE>mysqldump</CODE> now includes a statement in the dump output to set
<CODE>FOREIGN_KEY_CHECKS</CODE> to 0 to avoid problems with tables having to be
reloaded in a particular order when the dump is reloaded. The existing
<CODE>FOREIGN_KEY_CHECKS</CODE> value is saved and restored.
<LI>

<STRONG>Important note:</STRONG> If you upgrade to <CODE>InnoDB</CODE>-4.1.1 or higher,
you cannot downgrade to a version lower than 4.1.1
any more! That is because earlier versions of <CODE>InnoDB</CODE> are not aware of
multiple tablespaces.
<LI>

One can revoke all privileges from a user with
<CODE>REVOKE ALL PRIVILEGES, GRANT FROM user_list</CODE>.
<LI>

Added <CODE>IGNORE</CODE> option for <CODE>DELETE</CODE> statement.
<LI>

The MySQL source distribution now also includes the MySQL Internals
Manual <TT>`internals.texi'</TT>.
<LI>

Added <CODE>mysql_set_server_option()</CODE> C API client function to allow multiple
statement handling in the server to be enabled or disabled.
<LI>

The <CODE>mysql_next_result()</CODE> C API function now returns <CODE>-1</CODE> if there
are no more result sets.
<LI>

Renamed <CODE>CLIENT_MULTI_QUERIES</CODE> connect option flag to
<CODE>CLIENT_MULTI_STATEMENTS</CODE>. To allow for a transition period, the old
option will continue to be recognized for a while.
<LI>

Require <CODE>DEFAULT</CODE> before table and database default character set.
This enables us to use <CODE>ALTER TABLE tbl_name ... CHARACTER SET=...</CODE>
to change the character set for all <CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, and
<CODE>TEXT</CODE> columns in a table.
<LI>

Added <CODE>MATCH ... AGAINST( ... WITH QUERY EXPANSION)</CODE> and the
<CODE>ft_query_expansion_limit</CODE> server variable.
<LI>

Removed unused <CODE>ft_max_word_len_for_sort</CODE> system variable.
<LI>

Removed unused <CODE>ft_max_word_len_for_sort</CODE> variable from <CODE>myisamchk</CODE>.
<LI>

Full-text search now supports multi-byte character sets and the Unicode
<CODE>utf8</CODE> character set. (The Unicode <CODE>ucs2</CODE> character set is not
yet supported.)
<LI>

Phrase search in <CODE>MATCH ... AGAINST ( ... IN BOOLEAN MODE)</CODE> no longer
matches partial words.
<LI>

Added aggregate function <CODE>BIT_XOR()</CODE> for bitwise XOR operations.
<LI>

Replication over SSL now works.
<LI>

The <CODE>START SLAVE</CODE> statement now supports an <CODE>UNTIL</CODE> clause for
specifying that the slave SQL thread should be started but run only until it
reaches a given position in the master's binary logs or in the slave's relay logs.
<LI>

Produce warnings even for single-row <CODE>INSERT</CODE> statements, not just for
multiple-row <CODE>INSERT</CODE> statements. Previously, it was necessary to set
<CODE>SQL_WARNINGS=1</CODE> to generate warnings for single-row statements.
<LI>

Added <CODE>delimiter</CODE> (<CODE>\d</CODE>) command to the <CODE>mysql</CODE> command-line
client for changing the statement delimiter (terminator).
The default delimiter is semicolon.
<LI>

<CODE>CHAR</CODE>, <CODE>VARCHAR</CODE>, and <CODE>TEXT</CODE> columns now have lengths measured
in characters rather than in bytes.
The character size depends on the column's character set.
This means, for example, that a <CODE>CHAR(n)</CODE> column
for a multi-byte character set will take more storage than before.
Similarly, index values on such columns are measured in characters, not bytes.
<LI>

<CODE>LIMIT</CODE> no longer accepts negative arguments
(they used to be treated as very big positive numbers before).
<LI>

The <CODE>DATABASE()</CODE> function now returns <CODE>NULL</CODE> rather than the empty
string if there is no database selected.
<LI>

Added <CODE>--sql-mode=NO_AUTO_VALUE_ON_ZERO</CODE> option to suppress the usual
behavior of generating the next sequence number when zero is stored in
an <CODE>AUTO_INCREMENT</CODE> column. With this mode enabled, zero is stored as
zero; only storing <CODE>NULL</CODE> generates a sequence number.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
Client authentication now is based on 41-byte passwords in the
<CODE>user</CODE> table, not 45-byte passwords as in 4.1.0.
Any 45-byte passwords created for 4.1.0 must be reset after running the
<CODE>mysql_fix_privilege_tables</CODE> script.
<LI>

Added <CODE>secure_auth</CODE> global server system variable and <CODE>--secure-auth</CODE>
server option that disallow authentication for accounts that have old
(pre-4.1.1) passwords.
<LI>

Added <CODE>--secure-auth</CODE> option to <CODE>mysql</CODE> command-line client. If this
option is set, the client refuses to send passwords in old (pre-4.1.1) format.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
Renamed the C API <CODE>mysql_prepare_result()</CODE> function to
<CODE>mysql_get_metadata()</CODE> as the old name was confusing.
<LI>

Added <CODE>DROP USER 'user_name'@'host_name'</CODE> statement to drop an account
that has no privileges.
<LI>

The interface to aggregated UDF functions has changed a bit. You must now
declare a <CODE>xxx_clear()</CODE> function for each aggregate function <CODE>XXX()</CODE>.
<LI>

Added new <CODE>ADDTIME()</CODE>, <CODE>DATE()</CODE>, <CODE>DATEDIFF()</CODE>, <CODE>LAST_DAY()</CODE>,
<CODE>MAKEDATE()</CODE>, <CODE>MAKETIME()</CODE>, <CODE>MICROSECOND()</CODE>, <CODE>SUBTIME()</CODE>,
<CODE>TIME()</CODE>, <CODE>TIMEDIFF()</CODE>, <CODE>TIMESTAMP()</CODE>, <CODE>UTC_DATE()</CODE>,
<CODE>UTC_TIME()</CODE>, <CODE>UTC_TIMESTAMP()</CODE>, and <CODE>WEEKOFYEAR()</CODE>
functions.
<LI>

Added new syntax for <CODE>ADDDATE()</CODE> and <CODE>SUBDATE()</CODE>.
The second argument now may be a number representing the number of days to
be added to or subtracted from the first date argument.
<LI>

Added new <CODE>type</CODE> values <CODE>DAY_MICROSECOND</CODE>,
<CODE>HOUR_MICROSECOND</CODE>, <CODE>MINUTE_MICROSECOND</CODE>,
<CODE>SECOND_MICROSECOND</CODE>, and <CODE>MICROSECOND</CODE>
for <CODE>DATE_ADD()</CODE>, <CODE>DATE_SUB()</CODE>, and <CODE>EXTRACT()</CODE>.
<LI>

Added new <CODE>%f</CODE> microseconds format specifier for <CODE>DATE_FORMAT()</CODE> and
<CODE>TIME_FORMAT()</CODE>.
<LI>

All queries in which at least one <CODE>SELECT</CODE> does not use indexes properly
now are written to the slow query log when long log format is used.  
<LI>

It is now possible to create a <CODE>MERGE</CODE> table from <CODE>MyISAM</CODE> tables in
different databases. Formerly, all the <CODE>MyISAM</CODE> tables had to be in the
same database, and the <CODE>MERGE</CODE> table had to be created in that database
as well.
<LI>

Added new <CODE>COMPRESS()</CODE>, <CODE>UNCOMPRESS()</CODE>, and
<CODE>UNCOMPRESSED_LENGTH()</CODE> functions.
<LI>

When using <CODE>SET sql_mode='mode'</CODE> for a complex mode (like <CODE>ANSI</CODE>), we
now update the <CODE>sql_mode</CODE> variable to include all the individual options
implied by the complex mode.
<LI>

Added the OLAP (On-Line Analytical Processing) function <CODE>ROLLUP</CODE>, which
provides summary rows for each <CODE>GROUP BY</CODE> level.
<LI>

Added <CODE>SQLSTATE</CODE> codes for all server errors.
<LI>

Added <CODE>mysql_sqlstate()</CODE> and <CODE>mysql_stmt_sqlstate()</CODE> C API client
functions that return the <CODE>SQLSTATE</CODE> error code for the last error.
<LI>

<CODE>TIME</CODE> columns with hour values greater than 24 were returned incorrectly
to the client.
<LI>

<CODE>ANALYZE TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, and <CODE>FLUSH</CODE> statements
are now stored in the binary log and thus replicated to slaves.
This logging does not occur if the optional <CODE>NO_WRITE_TO_BINLOG</CODE> keyword 
(or its alias <CODE>LOCAL</CODE>) is given.  Exceptions are that
<CODE>FLUSH LOGS</CODE>, <CODE>FLUSH MASTER</CODE>, <CODE>FLUSH SLAVE</CODE>, and
<CODE>FLUSH TABLES WITH READ LOCK</CODE> are not logged in any case.
For a syntax example, see section <A HREF="manual.html#FLUSH">14.5.4.2  <CODE>FLUSH</CODE> Syntax</A>.
<LI>

New global system variable <CODE>relay_log_purge</CODE> to enable or disable automatic
relay log purging.
<LI>

<CODE>LOAD DATA</CODE> now produces warnings that can be fetched with
<CODE>SHOW WARNINGS</CODE>.
<LI>

Added support for syntax <CODE>CREATE TABLE table2 (LIKE table1)</CODE>
that creates an empty table <CODE>table2</CODE> with a definition that is
exactly the same as <CODE>table1</CODE>, including any indexes.
<LI>

<CODE>CREATE TABLE tbl_name (...) TYPE=storage_engine</CODE> now generates a
warning if the named storage engine is not available. The table is still
created as a <CODE>MyISAM</CODE> table, as before.
<LI>

Most subqueries are now much faster than before.
<LI>

Added <CODE>PURGE BINARY LOGS</CODE> as an alias for <CODE>PURGE MASTER LOGS</CODE>.
<LI>

Disabled the <CODE>PURGE LOGS</CODE> statement that was added in version 4.1.0.
The statement now should be issued as <CODE>PURGE MASTER LOGS</CODE> or
<CODE>PURGE BINARY LOGS</CODE>.
<LI>

Added <CODE>SHOW BDB LOGS</CODE> as an alias for <CODE>SHOW LOGS</CODE>.
<LI>

Added <CODE>SHOW MASTER LOGS</CODE> (which had been deleted in version
4.1.0) as an alias for <CODE>SHOW BINARY LOGS</CODE>.
<LI>

Added <CODE>Slave_IO_State</CODE> and <CODE>Seconds_Behind_Master</CODE> columns
to the output of <CODE>SHOW SLAVE STATUS</CODE>.
<CODE>Slave_IO_State</CODE> indicates the state of the slave I/O thread, and
<CODE>Seconds_Behind_Master</CODE> indicates the number of seconds by
which the slave is late compared to the master.
<LI>

The <CODE>--lower-case-table-names=1</CODE> server option now also makes aliases case
insensitive. (Bug #534)
<LI>

Changed that the relay log is flushed to disk by the slave I/O thread every
time it reads a relay log event. This reduces the risk of losing some part of
the relay log in case of brutal crash.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed <CODE>mysql</CODE> parser not to erroneously interpret <SAMP>`;'</SAMP> character
within <CODE>/* ... */</CODE> comment as statement terminator.
<LI>

Fixed merging types and length of result set columns for <CODE>UNION</CODE>
operations. The types and lengths now are determined taking into
account values for all <CODE>SELECT</CODE> statements in the <CODE>UNION</CODE>,
not just the first <CODE>SELECT</CODE>.
<LI>

Fixed a bug in privilege handling that caused connections from
certain IP addresses to be assigned incorrect database-level privileges.
A connection could be assigned the database privileges of the
previous successful authentication from one of those IP addresses,
even if the IP address username and database name were different. (Bug #1636)
<LI>

Error-handling functions were not called properly when an error resulted
from <CODE>[CREATE | REPLACE| INSERT] ... SELECT</CODE> statements.
<LI>

<CODE>HASH</CODE>, <CODE>BTREE</CODE>, <CODE>RTREE</CODE>, <CODE>ERRORS</CODE>, and
<CODE>WARNINGS</CODE> no longer are reserved words. (Bug #724)
<LI>

Fix for bug in <CODE>ROLLUP</CODE> when all tables were <CODE>const</CODE> tables.
(Bug #714)
<LI>

Fixed a bug in <CODE>UNION</CODE> that prohibited <CODE>NULL</CODE> values from being
inserted into result set columns where the first <CODE>SELECT</CODE> of the
<CODE>UNION</CODE> retrieved <CODE>NOT NULL</CODE> columns. The type and max_length
of the result column is now defined based on all <CODE>UNION</CODE> parts.
<LI>

Fixed name resolution of columns of reduced subqueries in unions. (Bug #745)
<LI>

Fixed memory overrun in subqueries in select list with <CODE>WHERE</CODE> clause
bigger than outer query <CODE>WHERE</CODE> clause. (Bug #726)
<LI>

Fixed a bug that caused <CODE>MyISAM</CODE> tables with <CODE>FULLTEXT</CODE> indexes
created in 4.0.x to be unreadable in 4.1.x.
<LI>

Fixed a data loss bug in <CODE>REPAIR TABLE ... USE_FRM</CODE> when used
with tables
that contained <CODE>TIMESTAMP</CODE> columns and were created in 4.0.x.
<LI>

Fixed reduced subquery processing in <CODE>ORDER BY</CODE>/<CODE>GROUP BY</CODE>
clauses. (Bug #442)
<LI>

Fixed name resolution of outer columns of subquery in
<CODE>INSERT</CODE>/<CODE>REPLACE</CODE> statements. (Bug #446)
<LI>

Fixed bug in marking columns of reduced subqueries. (Bug #679)
<LI>

Fixed a bug that made <CODE>CREATE FULLTEXT INDEX</CODE> syntax illegal.
<LI>

Fixed a crash when a <CODE>SELECT</CODE> that required a temporary table
(marked by <CODE>Using temporary</CODE> in <CODE>EXPLAIN</CODE> output)
was used as a derived table in <CODE>EXPLAIN</CODE> command. (Bug #251)
<LI>

Fixed a rare table corruption bug in <CODE>DELETE</CODE>
from a big table with
a <STRONG>new</STRONG> (created by MySQL-4.1) full-text index.
<LI>

<CODE>LAST_INSERT_ID()</CODE> now returns 0 if the last <CODE>INSERT</CODE> statement
didn't insert any rows.
<LI>

Fixed missing last character in function output. (Bug #447)
<LI>

Fixed a rare replication bug when a transaction spanned two or more
relay logs, and the slave was stopped while executing the part
of the transaction that was in the second or later relay log. Then
replication would resume at the beginning of the second or later
relay log, which was incorrect. (It should resume at <CODE>BEGIN</CODE>, in the
first relay log.) (Bug #53)
<LI>

<CODE>CONNECTION_ID()</CODE> now is properly replicated. (Bug #177)
<LI>

The new <CODE>PASSWORD()</CODE> function in 4.1 is now properly replicated.
(Bug #344)
<LI>

Fixed a bug with double freed memory.
<LI>

Fixed a crashing bug in <CODE>UNION</CODE> operations that involved temporary tables.
<LI>

Fixed a crashing bug in <CODE>DERIVED TABLES</CODE> when <CODE>EXPLAIN</CODE> is
used on a <CODE>DERIVED TABLES</CODE> with a join.
<LI>

Fixed a crashing bug in <CODE>DELETE</CODE> with <CODE>ORDER BY</CODE> and
<CODE>LIMIT</CODE> caused by an uninitialized array of reference pointers.
<LI>

Fixed a bug in the <CODE>USER()</CODE> function caused by an error in the size of
the allocated string.
<LI>

Fixed a crashing bug when attempting to create a table containing a spatial
(GIS) column with a storage engine that does not support spatial types. 
<LI>

Fixed a crashing bug in <CODE>UNION</CODE> caused by the empty select list and
a non-existent column being used in some of the individual <CODE>SELECT</CODE>
statements.
<LI>

Fixed a replication bug with a 3.23 master and a 4.0 slave: The
slave lost the replicated temporary tables if <CODE>FLUSH LOGS</CODE> was
issued on the master. (Bug #254)
<LI>

Fixed a security bug: A server compiled without SSL support still allowed
connections by users who had the <CODE>REQUIRE SSL</CODE> option specified for
their accounts.
<LI>

When an undefined user variable was used in a updating query on the
master (such as <CODE>INSERT INTO t VALUES(@a)</CODE>, where <CODE>@a</CODE> had never
been set by this connection before), the slave could replicate the
query incorrectly if a previous transaction on the master used a user
variable of the same name. (Bug #1331)
<LI>

Fixed bug with prepared statements: Using the <CODE>?</CODE> prepared statement
parameter as the argument to certain functions or statement clauses caused
a server crash when <CODE>mysql_prepare()</CODE> was invoked. (Bug #1500)
<LI>

Fixed bug with prepared statements: after call to mysql_prepare
placeholders became allowed in all consequent statements, even if they are 
not prepared (Bug #1946)
<LI>

<CODE>SLAVE START</CODE> (which is a deprecated syntax, <CODE>START SLAVE</CODE> should be
used instead) could crash the slave. (Bug #2516)
<LI>

Fixed bug in <CODE>ALTER TABLE RENAME</CODE>, when rename to the table with
the same name in another database silently dropped destination table if
it existed. (Bug #2628)
</UL>



<H3><A NAME="News-4.1.0" HREF="manual_toc.html#News-4.1.0">C.2.3  Changes in release 4.1.0 (03 Apr 2003: Alpha)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Added <CODE>--compatible</CODE> option to <CODE>mysqldump</CODE> for producing output that
is compatible with other database systems or with older MySQL servers.
<LI>

The <CODE>--opt</CODE> option for <CODE>mysqldump</CODE> now is enabled by default,
as are all the options implied by <CODE>--opt</CODE>.
<LI>

New <CODE>CHARSET()</CODE> and <CODE>COLLATION()</CODE> functions to return the character
set and collation of a string.
<LI>

Allow index type to be specified explicitly for some storage engines via
<CODE>USING type_name</CODE> syntax in index definition.
<LI>

New function <CODE>IS_USED_LOCK()</CODE> for determining the connection identifier
of the client that holds a given advisory lock.
<LI>

New more secure client authentication based on 45-byte passwords in the
<CODE>user</CODE> table.
<LI>

New <CODE>CRC32()</CODE> function to compute cyclic redundancy check value.
<LI>

On Windows, we are now using shared memory to communicate between server
and client when they are running on the same machine and you are
connecting to <CODE>localhost</CODE>.
<LI>

<CODE>REPAIR TABLE</CODE> of <CODE>MyISAM</CODE> tables now uses less temporary disk space when
sorting char columns.
<LI>

<CODE>DATE</CODE>/<CODE>DATETIME</CODE> checking is now a bit stricter to support the 
ability to automatically distinguish between date, datetime, and time
with microseconds. For example, dates of type <CODE>YYYYMMDD HHMMDD</CODE> are no 
longer supported; you must either have separators between each
<CODE>DATE</CODE>/<CODE>TIME</CODE> part or not at all.
<LI>

Server side help for all MySQL functions. One can now type <CODE>help
week</CODE> in the <CODE>mysql</CODE> client and get help for the <CODE>week()</CODE>
function.
<LI>

Added new <CODE>mysql_get_server_version()</CODE> C API client function.
<LI>

Fixed bug in <CODE>libmysqlclient</CODE> that fetched column defaults.
<LI>

Fixed bug in <TT>`mysql'</TT> command-line client in interpreting quotes
within comments.  (Bug #539)
<LI>

Added <CODE>record_in_range()</CODE> method to <CODE>MERGE</CODE> tables to be
able to choose the right index when there are many to choose from.
<LI>

Replication now works with <CODE>RAND()</CODE> and user variables <CODE>@var</CODE>.
<LI>

Allow one to change mode for <CODE>ANSI_QUOTES</CODE> on the fly.
<LI>

<CODE>EXPLAIN SELECT</CODE> now can be killed. See section <A HREF="manual.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A>.
<LI>

<CODE>REPAIR TABLE</CODE> now can be killed. See section <A HREF="manual.html#KILL">14.5.4.3  <CODE>KILL</CODE> Syntax</A>.
<LI>

Allow empty index lists to be specified for <CODE>USE INDEX</CODE>,
<CODE>IGNORE INDEX</CODE>, and <CODE>FORCE INDEX</CODE>.
<LI>

<CODE>DROP TEMPORARY TABLE</CODE> now drops only temporary tables and doesn't
end transactions.
<LI>

Added support for <CODE>UNION</CODE> in derived tables.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
<CODE>TIMESTAMP</CODE> is now returned as a string of type
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE> and different timestamp lengths are not supported.

This change was necessary for SQL standards compliance. In a future
version, a further change will be made (backward compatible with this
change), allowing the timestamp length to indicate the desired number
of digits of fractions of a second.
<LI>

New faster client/server protocol that supports prepared statements,
bound parameters, and bound result columns, binary transfer of data,
warnings.
<LI>

Added database and real table name (in case of alias) to the
<CODE>MYSQL_FIELD</CODE> structure.
<LI>

Multi-line queries: You can now issue several queries at once and
then read the results in one go.
<LI>

In <CODE>CREATE TABLE foo (a INT not null primary key)</CODE> the
<CODE>PRIMARY</CODE> word is now optional.
<LI>

In <CODE>CREATE TABLE</CODE> the attribute <CODE>SERIAL</CODE> is now an alias for
<CODE>BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE</CODE>.
<LI>

<CODE>SELECT ... FROM DUAL</CODE> is an alias for <CODE>SELECT ...</CODE>.
(To be compatible with some other databases).
<LI>

If one creates a too long <CODE>CHAR</CODE>/<CODE>VARCHAR</CODE> it's now
automatically changed to <CODE>TEXT</CODE> or <CODE>BLOB</CODE>; One will get a
warning in this case.
<LI>

One can specify the different <CODE>BLOB</CODE>/<CODE>TEXT</CODE> types with the
syntax <CODE>BLOB(length)</CODE> and <CODE>TEXT(length)</CODE>.  MySQL will
automatically change it to one of the internal <CODE>BLOB</CODE>/<CODE>TEXT</CODE>
types.
<LI>

<CODE>CHAR BYTE</CODE> is an alias for <CODE>CHAR BINARY</CODE>.
<LI>

<CODE>VARCHARACTER</CODE> is an alias for <CODE>VARCHAR</CODE>.
<LI>

New operators <CODE>integer MOD integer</CODE> and <CODE>integer DIV integer</CODE>.
<LI>

<CODE>SERIAL DEFAULT VALUE</CODE> added as an alias for <CODE>AUTO_INCREMENT</CODE>.
<LI>

<CODE>TRUE</CODE> and <CODE>FALSE</CODE> added as alias for 1 and 0, respectively.
<LI>

Aliases are now forced in derived tables, as per standard SQL.
<LI>

Fixed <CODE>SELECT .. LIMIT 0</CODE> to return proper row count for
<CODE>SQL_CALC_FOUND_ROWS</CODE>.
<LI>

One can specify many temporary directories to be used in a round-robin
fashion with:  <CODE>--tmpdir=dirname1:dirname2:dirname3</CODE>.
<LI>

Subqueries: <CODE>SELECT * from t1 where t1.a=(SELECT t2.b FROM t2)</CODE>.
<LI>

Derived tables:

<PRE>
SELECT a.col1, b.col2
       FROM (SELECT MAX(col1) AS col1 FROM root_table) a,
       other_table b
       WHERE a.col1=b.col1;
</PRE>

<LI>

Character sets to be defined per column, table and database.
<LI>

Unicode (UTF8) support.
<LI>

New <CODE>CONVERT(... USING ...)</CODE> syntax for converting string values between
character sets.
<LI>

<CODE>BTREE</CODE> index on <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables.
<LI>

Faster embedded server (new internal communication protocol).
<LI>

One can add a comment per column in <CODE>CREATE TABLE</CODE>.
<LI>

<CODE>SHOW FULL COLUMNS FROM tbl_name</CODE> shows column comments.
<LI>

<CODE>ALTER DATABASE</CODE>.
<LI>

Support for GIS (Geometrical data).
See section <A HREF="manual.html#Spatial_extensions_in_MySQL">18  Spatial Extensions in MySQL</A>.
<LI>

<CODE>SHOW [COUNT(*)] WARNINGS</CODE> shows warnings from the last command.
<LI>

One can specify a column type for a column in <CODE>CREATE TABLE
... SELECT</CODE> by defining the column in the <CODE>CREATE</CODE> part.


<PRE>
CREATE TABLE foo (a TINYINT NOT NULL) SELECT b+1 AS a FROM bar;
</PRE>

<LI>

<CODE>expr SOUNDS LIKE expr</CODE> same as <CODE>SOUNDEX(expr)=SOUNDEX(expr)</CODE>.
<LI>

Added new <CODE>VARIANCE(expr)</CODE> function returns the variance of <CODE>expr</CODE>
<LI>

One can create a table from the existing table using <CODE>CREATE 
[TEMPORARY] TABLE [IF NOT EXISTS] table (LIKE table)</CODE>. The table can 
be either normal or temporary.
<LI>

New options <CODE>--reconnect</CODE> and <CODE>--skip-reconnect</CODE> for the
<CODE>mysql</CODE> client, to reconnect automatically or not if the
connection is lost.
<LI>

<CODE>START SLAVE</CODE> (<CODE>STOP SLAVE</CODE>) no longer returns an error
if the slave is already started (stopped); it returns a
warning instead.
<LI>

<CODE>SLAVE START</CODE> and <CODE>SLAVE STOP</CODE> are no longer accepted by the query
parser; use <CODE>START SLAVE</CODE> and <CODE>STOP SLAVE</CODE> instead.
</UL>



<H2><A NAME="News-4.0.x" HREF="manual_toc.html#News-4.0.x">C.3  Changes in release 4.0.x (Production)</A></H2>

<P>
<A NAME="IDX2311"></A>

</P>
<P>
Version 4.0 of the MySQL server includes many enhancements and new features:

</P>

<UL>
<LI>

The <CODE>InnoDB</CODE> storage engine is now included in the standard binaries,
adding transactions, row-level locking, and foreign keys.
See section <A HREF="manual.html#InnoDB">16  The <CODE>InnoDB</CODE> Storage Engine</A>.
<LI>

A query cache, offering vastly increased performance for many applications.
By caching complete result sets, later identical queries can return
instantly.
See section <A HREF="manual.html#Query_Cache">5.10  The MySQL Query Cache</A>.
<LI>

Improved full-text indexing with boolean mode, truncation, and phrase searching.
See section <A HREF="manual.html#Fulltext_Search">13.6  Full-Text Search Functions</A>.
<LI>

Enhanced <CODE>MERGE</CODE> tables, now supporting <CODE>INSERT</CODE> statements and
<CODE>AUTO_INCREMENT</CODE>.
See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.
<LI>

<CODE>UNION</CODE> syntax in <CODE>SELECT</CODE>.
See section <A HREF="manual.html#UNION">14.1.7.2  <CODE>UNION</CODE> Syntax</A>.
<LI>

Multiple-table <CODE>DELETE</CODE> statements.
See section <A HREF="manual.html#DELETE">14.1.1  <CODE>DELETE</CODE> Syntax</A>.
<LI>

<CODE>libmysqld</CODE>, the embedded server library.
See section <A HREF="manual.html#libmysqld">20.2.15  libmysqld, the Embedded MySQL Server Library</A>.
<LI>

Additional <CODE>GRANT</CODE> privilege options for even tighter control and
security.
See section <A HREF="manual.html#GRANT">14.5.1.2  <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> Syntax</A>.
<LI>

Management of user resources in the <CODE>GRANT</CODE> system, particularly
useful for ISPs and other hosting providers.
See section <A HREF="manual.html#User_resources">5.5.4  Limiting Account Resources</A>.
<LI>

Dynamic server variables, allowing configuration changes to be made
without having to stop and restart the server.
See section <A HREF="manual.html#SET_OPTION">14.5.3.1  <CODE>SET</CODE> Syntax</A>.
<LI>

Improved replication code and features.
See section <A HREF="manual.html#Replication">6  Replication in MySQL</A>.
<LI>

Numerous new functions and options.
<LI>

Changes to existing code for enhanced performance and reliability.
</UL>

<P>
For a full list of changes, please refer to the changelog sections for
each individual 4.0.x release.

</P>



<H3><A NAME="News-4.0.20" HREF="manual_toc.html#News-4.0.20">C.3.1  Changes in release 4.0.20 (not released yet)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Phrase search in <CODE>MATCH ... AGAINST ( ... IN BOOLEAN MODE)</CODE> no longer
matches partial words.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed a bug in division <CODE>/</CODE> reporting incorrect metadata
(number of digits after the decimal point). It can be seen, e.g.
in <CODE>CREATE TABLE t1 SELECT "0.01"/"3"</CODE>. (Bug #3612)
<LI>

Fixed a problem with non-working <CODE>DROP DATABASE</CODE> on some configurations
(in particular, Linux 2.6.5 with ext3 are known to expose this bug).
(Bug #3594)
<LI>

Fixed that in some replication error messages, a very long query caused the rest
of the message to be invisible (truncated), by putting the query last in the
message. (Bug #3357)
</UL>



<H3><A NAME="News-4.0.19" HREF="manual_toc.html#News-4.0.19">C.3.2  Changes in release 4.0.19 (04 May 2004)</A></H3>

<P>
<STRONG>Note:</STRONG> The MySQL 4.0.19 binaries were uploaded to the download
mirrors on May, 10th. However, a potential crashing bug was found just
before the 4.0.19 release was publicly announced and published from the
4.0 download pages at <a HREF="http://dev.mysql.com/">http://dev.mysql.com/</a>.

</P>
<P>
See Bug #3596 for details (it was reported against MySQL-4.1, but was
confirmed to affect 4.0.19 as well).

</P>
<P>
A fix for this bug was pushed into the MySQL source tree shortly after it
could be reproduced and will be included in the upcoming MySQL 4.0.20,
to be released shortly. We recommend users to stick to MySQL 4.0.18 for
the time being, until MySQL 4.0.20 has been released (this specific bug
was introduced after MySQL 4.0.18 was released, so older versions were not
affected by it). We apologize for the inconvenience!

</P>
<P>
Functionality added or changed:

<UL>
<LI>

If length of a timestamp field is defined as 19, the timestamp will be
displayed as <CODE>"YYYY-MM-DD HH:MM:SS</CODE>. This is done to make it easier
to use tables created in MySQL 4.1 to be used in MySQL 4.0.
<LI>

If you use <CODE>RAID_CHUNKS</CODE> with a value &#62; 255 it will be set to 255.
This was made to ensure that all raid directories are always 2 hex bytes.
(Bug #3182)
<LI>

Changed that the optimizer will now consider the index specified in 
<CODE>FORCE INDEX</CODE> clause as a candidate to resolve <CODE>ORDER BY</CODE>
as well.
<LI>

Non-standard behavior of <CODE>UNION</CODE> statements has changed to the standard
ones. So far, a table name in the <CODE>ORDER BY</CODE> clause was
tolerated. From now on a proper error message is issued (Bug #3064).
<LI>

Added <CODE>max_insert_delayed_threads</CODE> system variable as a synonym for
<CODE>max_delayed_threads</CODE>.
<LI>

Added <CODE>query_cache_wlock_invalidate</CODE> system variable. It allow
emulation of <CODE>MyISAM</CODE> table write-locking behavior, even for queries
in the query cache. (Bug #2693)
<LI>

The keyword <CODE>MASTER_SERVER_ID</CODE> is not reserved anymore.
<LI>

The following is mainly relevant for Mac OS X users who use a
case-insensitive filesystem.  This is not relevant for Windows users as
<CODE>InnoDB</CODE> in this case always stores file names in lower case:

One can now force <CODE>lower_case_table_names</CODE> to 0 from the command
line or a configuration file. This is useful with case-insensitive filesystems
when you have previously not used
<CODE>lower_case_table_names=1</CODE> or <CODE>lower_case_table_names=2</CODE> and
your have already created <CODE>InnoDB</CODE> tables.  With
<CODE>lower_case_table_names=0</CODE>, <CODE>InnoDB</CODE> tables were stored in mixed case
while setting lower_case_table_names &#60;&#62; 0 will now force it to lower
case (to make the table names case insensitive).

Because it's possible to crash <CODE>MyISAM</CODE> tables by referring to them with
different case on a case-insensitive filesystem, we recommend that you
use <CODE>lower_case_table_names</CODE> or <CODE>lower_case_table_names=2</CODE> on
such filesystems.

The easiest way to convert to use <CODE>lower_case_table_names=2</CODE> is to
dump all your <CODE>InnoDB</CODE> tables with <CODE>mysqldump</CODE>, drop them and then
restore them.
<LI>

Non-standard behavior of <CODE>UNION</CODE> statements has changed to the standard
ones. So far, a table name in the <CODE>ORDER BY</CODE> clause was
tolerated. From now on a proper error message is issued (Bug #3064).
<LI>

Added <CODE>max_insert_delayed_threads</CODE> system variable as a synonym for
<CODE>max_delayed_threads</CODE>.
<LI>

Added <CODE>query_cache_wlock_invalidate</CODE> system variable. It allow
emulation of <CODE>MyISAM</CODE> table write-locking behavior, even for queries
in the query cache. (Bug #2693)
<LI>

Changed that the relay log is flushed to disk by the slave I/O thread every
time it reads a relay log event. This reduces the risk of losing some part of
the relay log in case of brutal crash.
<LI>

When a session having open temporary tables terminates, the statement
automatically written to the binary log is now <CODE>DROP TEMPORARY TABLE IF
EXISTS</CODE> instead of <CODE>DROP TEMPORARY TABLE</CODE>, for more robustness.
<LI>

Added option <CODE>--replicate-same-server-id</CODE>.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Added missing full-text variable <CODE>ft_stopword_file</CODE> to <CODE>myisamchk</CODE>.
<LI>

Don't allow stray <CODE>','</CODE> at the end of field specifications. (Bug #3481)
<LI>

<CODE>INTERVAL</CODE> now can handle big values for seconds, minutes and hours.
(Bug #3498)
<LI>

Blank hostname did not work as documented for table and column privileges.
Now it's works the same way as <CODE>'%'</CODE>. (Bug #3473)
<LI>

Fixed a harmless buffer overflow in <TT>`replace'</TT> utility. (Bug# 3541)
<LI>

Fixed <CODE>SOUNDEX()</CODE> to ignore non-alphabetic characters also
in the beginning of the string. (Bug #3556)
<LI>

Fixed a bug in <CODE>MATCH ... AGAINST()</CODE> searches when another thread was
doing concurrent inserts into the <CODE>MyISAM</CODE> table in question.  The first
--- full-text search -- query could return incorrect results in this case
(e.g. ``phantom'' rows or not all matching rows, even an empty result set).
The easiest way to check whether you are affected is to start <TT>`mysqld'</TT>
with <CODE>--skip-concurrent-insert</CODE> switch and see if it helps.
<LI>

Fixed bug when doing <CODE>DROP DATABASE</CODE> on a directory containing non-
MySQL files. Now a proper error message is returned. 
<LI>

Fixed bug in <CODE>ANALYZE TABLE</CODE> on a <CODE>BDB</CODE> table inside a transaction
that hangs server thread. (Bug #2342)
<LI>

Fixed a symlink vulnerability in <TT>`mysqlbug'</TT> script. (Bug #3284)
<LI>

Fixed core dump bug in <CODE>SELECT DISTINCT</CODE> where all selected parts
where constants and there were hidden columns in the created temporary table.
(Bug #3203)
<LI>

Fixed core dump bug in <CODE>COUNT(DISTINCT)</CODE> when there was a lot of
values and one had a big value for <CODE>max_heap_table_size</CODE>.
<LI>

Fixed problem with multi-table-update and BDB tables. (Bug: #3098)
<LI>

Fixed memory leak when dropping database with <CODE>RAID</CODE> tables. (Bug #2882)
<LI>

Fixed core dump crash in replication during relay-log switch when the
relay log went over <CODE>max_relay_log_size</CODE> and the slave thread did a
<CODE>flush_io_cache()</CODE> at the same time.
<LI>

Fixed hangup bug when issuing multiple <CODE>SLAVE START</CODE> from different
threads at the same time. (Bug #2921)
<LI>

Fixed bug when using <CODE>DROP DATABASE</CODE> with <CODE>lower_case_table_names=2</CODE>.
<LI>

Fixed wrong result in <CODE>UNION</CODE> when using <CODE>lower_case_table_names=2</CODE>.
(Bug #2858)
<LI>

One can now kill threads that is 'stuck' in the join optimizer (can
happen when there is MANY tables in the join in which case the optimizer
can take really long time). (Bug #2825)
<LI>

Rollback <CODE>DELETE</CODE> and <CODE>UPDATE</CODE> statements if thread is killed.
(Bug #2422)
<LI>

Ensure that all rows in an <CODE>INSERT DELAYED</CODE> statement is written at
once if binary logging is enabled. (Bug #2491).
<LI>

Fixed bug in query cache statistic, more accurate formula linked statistic
variables mentioned in the manual.
<LI>

Fixed a bug in parallel repair
(<CODE>myisamchk -p</CODE>, <CODE>myisam_repair_threads</CODE>) -
sometimes repair process failed to repair a table. (Bug #1334)
<LI>

Fixed bugs with names of tables, databases and columns that end to space 
(Bug #2985)
<LI>

Fixed a bug in multiple-table <CODE>UPDATE</CODE> statements involving at least one constant 
table. Bug was exhibited in allowing non matching row to be updated.
(Bug #2996).
<LI>

Fixed all bugs in scripts for creating/upgrading system database (Bug #2874)
Added tests which guarantee against such bugs in the future.
<LI>

Fixed bug in <TT>`mysql'</TT> command-line client in interpreting quotes
within comments. (Bug #539)
<LI>

<CODE>--set-character-set</CODE> and <CODE>--character-sets-dir</CODE> options in
<TT>`myisamchk'</TT> now work.
<LI>

Fixed a bug in <CODE>mysqlbinlog</CODE> that caused one pointer to be free'd twice
in some cases.
<LI>

Fixed a bug in boolean full-text search, that sometimes could lead to false
matches in queries with several levels of subexpressions using <CODE>+</CODE>
operator (for example,
<CODE>MATCH ... AGAINST('+(+(word1 word2)) +word3*' IN BOOLEAN MODE)</CODE>.
<LI>

Fixed Windows-specific portability bugs in <TT>`myisam_ftdump'</TT>.
<LI>

Fixed a bug in multiple-table <CODE>DELETE</CODE> that was caused by foreign key
constraints. If the order of the tables established by MySQL optimizer
did not match parent-child order, no rows were deleted and no error
message was provided. (Bug #2799)
<LI>

Fixed a few years old bug in the range optimizer that
caused a segmentation fault on some very rare queries. (Bug #2698)
<LI>

Replication:
If a client connects to a slave server and issues an administrative
statement for a table (for example, <CODE>OPTIMIZE TABLE</CODE> or <CODE>REPAIR
TABLE</CODE>), this could sometimes stop the slave SQL thread. This does not lead
to any corruption, but you must use <CODE>START SLAVE</CODE> to get replication
going again. (Bug #1858)
The bug was accidentally not fixed in 4.0.17 as it was unfortunately
earlier said.
<LI>

Fixed that when a <CODE>Rotate</CODE> event is found by the slave SQL thread in the
middle of a transaction, the value of <CODE>Relay_Log_Pos</CODE> in <CODE>SHOW SLAVE
STATUS</CODE> remains correct. (Bug #3017)
<LI>

Corrected the master's binary log position that <CODE>InnoDB</CODE> reports when it is doing a
crash recovery on a slave server. (Bug #3015)
<LI>

Changed that when a <CODE>DROP TEMPORARY TABLE</CODE> statement is automatically
written to the binary log when a session ends, the statement is recorded with an
error code of value zero (this ensures that killing a <CODE>SELECT</CODE> on the
master does not result in a superfluous error on the slave). (Bug #3063)
<LI>

Changed that when a thread handling <CODE>INSERT DELAYED</CODE> (also known as a
<CODE>delayed_insert</CODE> thread) is killed, its statements are recorded with an
error code of value zero (killing such a thread does not endanger
replication, so we thus avoid a superfluous error on the slave). (Bug #3081)
<LI>

Fixed deadlock when two <CODE>START SLAVE</CODE> commands were run at the same
time. (Bug #2921)
<LI>

Fixed that a statement never triggers a superfluous error on the slave, if it
must be excluded given the <CODE>replicate-*</CODE> options. The bug was that if the
statement had been killed on the master, the slave would stop. (Bug #2983)
<LI>

The <CODE>--local-load</CODE> option of <CODE>mysqlbinlog</CODE> now requires an argument.
<LI>

Fixed a segmentation fault when running <CODE>LOAD DATA FROM MASTER</CODE> after
<CODE>RESET SLAVE</CODE>. (Bug #2922)
<LI>

Fixed a rare error condition that caused the slave SQL thread spuriously
to print the message <CODE>Binlog has bad magic number</CODE> and stop when it
was not necessary to do so.  (Bug #3401)
<LI>

Fixed the column <CODE>Exec_master_log_pos</CODE> (and its disk image in the
<CODE>relay-log.info</CODE> file) to be correct if the master had version 3.23 (it
was too big by 6 bytes). This bug does not exist in the 5.0 version.
(Bug #3400)
<LI>

Fixed that <CODE>mysqlbinlog</CODE> does not forget to print a <CODE>USE</CODE> command
under rare circumstances where the binary log contained a <CODE>LOAD DATA
INFILE</CODE> command. (Bug #3415)
<LI>

Fixed a memory corruption when replicating a <CODE>LOAD DATA INFILE</CODE> when the
master had version 3.23. Some smaller problems remain in this setup,
See section <A HREF="manual.html#Replication_Features">6.7  Replication Features and Known Problems</A>. (Bug #3422)
<LI>

Multiple-table <CODE>DELETE</CODE> statements were always replicated by the slave if
there were some <CODE>replicate-*-ignore-table</CODE> options and no
<CODE>replicate-*-do-table</CODE> options. (Bug #3461)
<LI>

Fixed a crash of the MySQL slave server when it was built with
<CODE>--with-debug</CODE> and replicating itself. (BUG #3568)
</UL>



<H3><A NAME="News-4.0.18" HREF="manual_toc.html#News-4.0.18">C.3.3  Changes in release 4.0.18 (12 Feb 2004)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Fixed processing of <CODE>LOAD DATA</CODE> by <CODE>mysqlbinlog</CODE> in remote mode.
(Bug #1378)
<LI>

New utility program <TT>`myisam_ftdump'</TT> was added to binary
distributions.
<LI>

<CODE>ENGINE</CODE> is now a synonym for the <CODE>TYPE</CODE> option for
<CODE>CREATE TABLE</CODE> and <CODE>ALTER TABLE</CODE>.
<LI>

<CODE>lower_case_table_names</CODE> system variable now can take a value of
<CODE>2</CODE>, to store table names in mixed case on case-insensitive filesystems.
It's forced to 2 if the database directory is located on a case-insensitive
filesystem.
<LI>

For replication of <CODE>MEMORY</CODE> (<CODE>HEAP</CODE>) tables: Made the master
automatically write a <CODE>DELETE FROM</CODE> statement to its binary log when a
<CODE>MEMORY</CODE> table is opened for the first time since master's startup.
This is for the case where the slave has replicated a non-empty
<CODE>MEMORY</CODE> table, then the master is shut down and restarted: the table
is now empty on master; the <CODE>DELETE FROM</CODE> empties it on slave too. Note
that even with this fix, between the master's restart and the first use of
the table on master, the slave still has out-of-date data in the table. But
if you use the <CODE>init-file</CODE> option to populate the <CODE>MEMORY</CODE> table
on the master at startup, it ensures that the failing time interval is zero.
(Bug #2477)
<LI>

Optimizer is now better tuned for the case where the first used key part
(of many) is a constant.  (Bug #1679)
<LI>

Removed old non-working <CODE>--old-rpl-compat</CODE> server option, which was a
holdover from the very first 4.0.x versions. (Bug #2428)
</UL>

<P>
Bugs fixed:

<UL>
<LI>

<CODE>mysqlhotcopy</CODE> now works on NetWare.
<LI>

<CODE>DROP DATABASE</CODE> could not drop databases with RAID tables that had
more than nine <CODE>RAID_CHUNKS</CODE>. (Bug #2627)
<LI>

Fixed bug in range optimizer when using overlapping ranges. (Bug #2448)
<LI>

Limit <CODE>wait_timeout</CODE> to 2147483 on Windows (OS limit). (Bug #2400)
<LI>

Fixed bug when <CODE>--init-file</CODE> crashes MySQL if it contains a large
<CODE>SELECT</CODE>. (Bug #2526)
<LI>

<CODE>SHOW KEYS</CODE> now shows <CODE>NULL</CODE> in the <CODE>Sub_part</CODE> column for
<CODE>FULLTEXT</CODE> indexes.
<LI>

The signal thread's stack size was increased to enable <CODE>mysqld</CODE>
to run on Debian/IA-64 with a TLS-enabled <CODE>glibc</CODE>. (Bug #2599)
<LI>

Now only the <CODE>SELECT</CODE> privilege is needed for tables that are only read in
multiple-table <CODE>UPDATE</CODE> statements. (Bug #2377)
<LI>

Give proper error message if one uses <CODE>LOCK TABLES ... ; INSERT
... SELECT</CODE> and one used the same table in the <CODE>INSERT</CODE> and <CODE>SELECT</CODE>
part. (Bug #2296)
<LI>

<CODE>SELECT INTO ... DUMPFILE</CODE> now deletes the generated file on error.
<LI>

Fixed foreign key reference handling to allow references to column names that
contain spaces. (Bug #1725)
<LI>

Fixed problem with index reads on character columns with <CODE>BDB</CODE> tables. The
symptom was that data could be returned in the wrong lettercase. (Bug #2509)
<LI>

Fixed a spurious table corruption problem that could sometimes appear on
tables with indexed <CODE>TEXT</CODE> columns if these columns happened to contain
values having trailing spaces.  This bug was introduced in 4.0.17.
<LI>

Fixed a problem where some queries could hang if a condition like
<CODE>indexed_TEXT_column = expr</CODE>
was present and the column contained values having trailing spaces.
This bug was introduced in 4.0.17.
<LI>

Fixed a bug that could cause incorrect results from a query
that involved range conditions on indexed <CODE>TEXT</CODE> columns
that happened to contain values having trailing spaces. This bug was
introduced in 4.0.17. (Bug #2295)
<LI>

Fixed incorrect path names in some of the manual pages.
(Bug #2270)
<LI>

Fixed spurious ``table corrupted'' errors in parallel repair operations.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

Fixed a crashing bug in parallel repair operations.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

Fixed bug in updating <CODE>MyISAM</CODE> tables for <CODE>BLOB</CODE> values longer
than 16MB. (Bug #2159)
<LI>

Fixed bug in <CODE>mysqld_safe</CODE> when running multiple instances of
MySQL. (Bug #2114)
<LI>

Fixed a bug in using <CODE>HANDLER</CODE> statement with tables not
from a current database. (Bug #2304)
<LI>

Fixed a crashing bug that occurred due to the fact that multiple-table
<CODE>UPDATE</CODE> statements did not check that there was only one table
to be updated. (Bug #2103)
<LI>

Fixed a crashing bug that occurred due to <CODE>BLOB</CODE> column
type index size being calculated incorrectly in <CODE>MIN()</CODE> and <CODE>MAX()</CODE>
optimizations.
(Bug #2189)
<LI>

Fixed a bug with incorrect syntax for <CODE>LOCK TABLES</CODE> in
<CODE>mysqldump</CODE>. (Bug #2242)
<LI>

Fixed a bug in <CODE>mysqld_safe</CODE> that caused <CODE>mysqld</CODE> to generate a
warning about duplicate <CODE>user=xxx</CODE> options if this option was specified in
the <CODE>[mysqld]</CODE> or <CODE>[server]</CODE> sections of <TT>`my.cnf'</TT>.
(Bug #2163)
<LI>

<CODE>INSERT DELAYED ... SELECT ...</CODE> could cause table corruption because
tables were not locked properly.  This is now fixed by ignoring <CODE>DELAYED</CODE>
in this context. (Bug #1983)
<LI>

Replication: Sometimes the master gets a non-fatal error during the
execution of a statement that does not immediately succeed.  (For example,
a write to a <CODE>MyISAM</CODE> table may first receive ``no space left
on device,'' but later complete when disk space becomes available.
See section <A HREF="manual.html#Full_disk">A.4.3  How MySQL Handles a Full Disk</A>.)  The bug was that the master forgot to reset the error
code to 0 after success, so the error code got into its binary log, thus
causing the slave to issue false alarms such as ``did not get the same
error as on master.'' (Bug #2083)
<LI>

Removed a misleading ``check permissions on master.info'' from a replication
error message, because the cause of the problem could be something other than
permissions. (Bug #2121)
<LI>

Fixed a crash when the replication slave was unable to create the first relay
log. (Bug #2145)
<LI>

Replication of <CODE>LOAD DATA INFILE</CODE> for an empty file from a 3.23 master to a
4.0 slave caused the slave to print an error. (Bug #2452)
<LI>

When automatically forcing <CODE>lower_case_table_names</CODE> to 1 if the file
system was case insensitive, <CODE>mysqld</CODE> could crash. This bug existed only
in MySQL 4.0.17. (Bug #2481)
<LI>

Restored ability to specify default values for <CODE>TIMESTAMP</CODE> columns
that was erroneously disabled in previous release. (Bug #2539) Fixed
<CODE>SHOW CREATE TABLE</CODE> to reflect these values. (Bug #1885) Note
that because of the auto-update feature for the first <CODE>TIMESTAMP</CODE>
column in a table, it makes no sense to specify a default value for
the column. Any such default will be silently ignored (unless another
<CODE>TIMESTAMP</CODE> column is added before this one).  Also fixed the meaning
of the <CODE>DEFAULT</CODE> keyword when it is used to specify the value to be
inserted into a <CODE>TIMESTAMP</CODE> column other than the first. (Bug #2464)
<LI>

Fixed bug for out-of-range arguments on QNX platform that caused
<CODE>UNIX_TIMESTAMP()</CODE> to produce incorrect results or that caused
non-zero values to be inserted into <CODE>TIMESTAMP</CODE> columns.  (Bug #2523)
Also, current time zone now is taken into account when checking if datetime
values satisfy both range boundaries for <CODE>TIMESTAMP</CODE> columns. The
range allowed for a <CODE>TIMESTAMP</CODE> column is time zone-dependent and
equivalent to a range of <CODE>1970-01-01 00:00:01</CODE> UTC to <CODE>2037-12-31
23:59:59</CODE> UTC.
<LI>

Multiple-table <CODE>DELETE</CODE> statements were never replicated by the slave if
there were any <CODE>replicate-*-table</CODE> options. (Bug #2527)
<LI>

Changes to session counterparts of variables <CODE>query_prealloc_size</CODE>,
<CODE>query_alloc_block_size</CODE>, <CODE>trans_prealloc_size</CODE>,
<CODE>trans_alloc_block_size</CODE> now 
have an effect. (Bug #1948)
<LI>

Fixed bug in <CODE>ALTER TABLE RENAME</CODE>, when rename to the table with
the same name in another database silently dropped destination table if
it existed. (Bug #2628)
</UL>



<H3><A NAME="News-4.0.17" HREF="manual_toc.html#News-4.0.17">C.3.4  Changes in release 4.0.17 (14 Dec 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>mysqldump</CODE> no longer dumps data for <CODE>MERGE</CODE> tables. (Bug #1846)
<LI>

<CODE>lower_case_table_names</CODE> is now forced to 1 if the database directory
is located on a case-insensitive filesystem. (Bug #1812)
<LI>

Symlink creation is now disabled on systems where <CODE>realpath()</CODE> doesn't
work. (Before one could use <CODE>CREATE TABLE .. DATA DIRECTORY=..</CODE> even if
<CODE>HAVE_BROKEN_REALPATH</CODE> was defined. This is now disabled to avoid
problems when running <CODE>ALTER TABLE</CODE>).
<LI>

Inserting a negative <CODE>AUTO_INCREMENT</CODE> value in a <CODE>MyISAM</CODE> table 
no longer updates the <CODE>AUTO_INCREMENT</CODE> counter to a big unsigned value.
(Bug #1366)
<LI>

Added four new modes to <CODE>WEEK(..., mode)</CODE> function.
See section <A HREF="manual.html#Date_and_time_functions">13.5  Date and Time Functions</A>.
(Bug #1178)
<LI>

Allow <CODE>UNION DISTINCT</CODE> syntax.
<LI>

<CODE>mysql_server_init()</CODE> now returns 1 if it can't initialize the
environment. (Previously <CODE>mysql_server_init()</CODE> called <CODE>exit(1)</CODE>
if it could not create a key with <CODE>pthread_key_create()</CODE>. (Bug #2062)
<LI>

Allow spaces in Windows service names.
<LI>

Changed the default Windows service name for <CODE>mysqld</CODE> from <CODE>MySql</CODE>
to <CODE>MySQL</CODE>.
This should not affect usage, because service names are not case sensitive.
<LI>

When you install <CODE>mysqld</CODE> as a service on Windows systems, <CODE>mysqld</CODE>
will read startup options in option files from the option group with the same
name as the service name.
(Except when the service name is <CODE>MySQL</CODE>).
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Sending <CODE>SIGHUP</CODE> to <CODE>mysqld</CODE> crashed the server if it was running with
<CODE>--log-bin</CODE>. (Bug #2045)
<LI>

One can now configure MySQL as a Windows service as a normal
user. (Bug #1802). Thanks to Richard Hansen for fixing this.
<LI>

Database names are now compared in lowercase in <CODE>ON</CODE> clauses
when <CODE>lower_case_table_names</CODE> is set. (Bug #1736)
<LI>

<CODE>IGNORE ... LINES</CODE> option to <CODE>LOAD DATA INFILE</CODE> didn't work
when used with fixed length rows. (Bug #1704)
<LI>

Fixed problem with <CODE>UNIX_TIMESTAMP()</CODE> for timestamps close to 0.
(Bug #1998)
<LI>

Fixed problem with character values greater than 128 in the <CODE>QUOTE()</CODE>
function. (Bug #1868)
<LI>

Fixed searching of <CODE>TEXT</CODE> with endspace. (Bug #1651)
<LI>

Fixed caching bug in multiple-table updates where same table was used twice.
(Bug #1711)
<LI>

Fixed directory permissions for the MySQL-server RPM documentation directory.
(Bug #1672)
<LI>

Fixed server crash when updating an <CODE>ENUM</CODE> column that is set to the
empty string (for example, with <CODE>REPLACE()</CODE>).  (Bug #2023)
<LI>

<CODE>mysql</CODE> client program now correctly prints connection identifier
returned by <CODE>mysql_thread_id()</CODE> as unsigned integer rather than as signed
integer.  (Bug #1951)
<LI>

<CODE>FOUND_ROWS()</CODE> could return incorrect number of rows after a query
with an impossible <CODE>WHERE</CODE> condition. (Bug #1468)
<LI>

<CODE>SHOW DATABASES</CODE> no longer shows <CODE>.sym</CODE> files (on Windows) that
do not point to a valid directory. (Bug #1385)
<LI>

Fixed a possible memory leak on Mac OS X when using the shared
<CODE>libmysql.so</CODE> library. (from <CODE>pthread_key_create()</CODE>). (Bug #2061)
<LI>

Fixed bug in <CODE>UNION</CODE> statement with alias <CODE>*</CODE>. (Bug #1249)
<LI>

Fixed a bug in <CODE>DELETE ... ORDER BY ... LIMIT</CODE> where the rows where not
deleted in the proper order. (Bug #1024, Bug #1697).
<LI>

Fixed serious problem with multi-threaded programs on Windows that used the
embedded MySQL libraries. (Locks of tables were not handled correctly between
different threads).
<LI>

Code cleanup: Fixed a few code defects (potential memory leaks, null pointer
dereferences, uninitialized variables). Thanks to Reasoning Inc. for
informing us about these findings.
<LI>

Fixed a buffer overflow error that occurred with prepended <SAMP>`0'</SAMP> characters
in some columns of type <CODE>DECIMAL</CODE>. (Bug #2128)
<LI>

Filesort was never shown in <CODE>EXPLAIN</CODE> if query contained an
<CODE>ORDER BY NULL</CODE> clause. (Bug #1335)
<LI>

Fixed invalidation of whole query cache on <CODE>DROP DATABASE</CODE>. (Bug #1898)
<LI>

Fixed bug in range optimizer that caused wrong results for some unlikely
<CODE>AND</CODE>/<CODE>OR</CODE> queries. (Bug #1828)
<LI>

Fixed a crash in <CODE>ORDER BY</CODE> when ordering by expression and identifier.
(Bug #1945)
<LI>

Fixed a crash in an open <CODE>HANDLER</CODE> when an <CODE>ALTER TABLE</CODE> was
executed in a different connection. (Bug #1826)
<LI>

Fixed a bug in <CODE>trunc*</CODE> operator of full-text search which
sometimes caused MySQL not to find all matched rows.
<LI>

Fixed bug in prepending <SAMP>`0'</SAMP> characters to <CODE>DECIMAL</CODE> column values.
<LI>

Fixed optimizer bug, introduced in 4.0.16, when <CODE>REF</CODE> access plan was
preferred to more efficient <CODE>RANGE</CODE> on another column.
<LI>

Fixed problem when installing a MySQL server as a Windows service using a
command of the form <CODE>mysqld --install mysql --defaults-file=path-to-file</CODE>.
(Bug #1643)
<LI>

Fixed an incorrect result from a query that uses only <CODE>const</CODE> tables
(such as one-row tables) and non-constant expression
(such as <CODE>RAND()</CODE>). (Bug #1271)
<LI>

Fixed bug when the optimizer did not take <CODE>SQL_CALC_FOUND_ROWS</CODE> into
account if <CODE>LIMIT</CODE> clause was present. (Bug #1274)
<LI>

<CODE>mysqlbinlog</CODE> now asks for a password at the console when the <CODE>-p</CODE>
or <CODE>--password</CODE> option is used with no argument. This is consistent with
the way that other clients such <CODE>mysqladmin</CODE> and <CODE>mysqldump</CODE>
already behave. <STRONG>Note:</STRONG> A consequence of this change is that it is no
longer possible to invoke <CODE>mysqlbinlog</CODE> as <CODE>mysqlbinlog -p
pass_val</CODE> (with a space between the <CODE>-p</CODE> option and the following
password value).
(Bug #1595)
<LI>

Fixed bug accidentally introduced in 4.0.16 where the slave SQL thread
deleted its replicated temporary tables when <CODE>STOP SLAVE</CODE> was
issued.
<LI>

In a ``chain'' replication setup <CODE>A-&#62;B-&#62;C</CODE>, if 2 sessions on A
updated temporary tables of the same name at the same time, the binary log
of <CODE>B</CODE> became incorrect, resulting in <CODE>C</CODE> becoming confused.
(Bug #1686)
<LI>

In a ``chain'' replication setup <CODE>A-&#62;B-&#62;C</CODE>, if <CODE>STOP SLAVE</CODE>
was issued on <CODE>B</CODE> while it was replicating a temporary table from
<CODE>A</CODE>, then when <CODE>START SLAVE</CODE> was issued on <CODE>B</CODE>, the binary log
of <CODE>B</CODE> became incorrect, resulting in <CODE>C</CODE> becoming confused.
(Bug #1240)
<LI>

When <CODE>MASTER_LOG_FILE</CODE> and <CODE>MASTER_LOG_POS</CODE> were not
specified, <CODE>CHANGE MASTER</CODE> used the coordinates of the slave I/O
thread to set up replication, which broke replication if the slave SQL
thread lagged behind the slave I/O thread. This caused the slave
SQL thread to lose some events. The new behavior is to use the
coordinates of the slave SQL thread instead.
See section <A HREF="manual.html#CHANGE_MASTER_TO">14.6.2.1  <CODE>CHANGE MASTER TO</CODE> Syntax</A>.
(Bug #1870)
<LI>

Now if integer is stored or converted to <CODE>TIMESTAMP</CODE> or
<CODE>DATETIME</CODE> value checks of year, month, day, hour, minute
and second ranges are performed and numbers representing illegal
timestamps are converted to 0 value. This behavior is consistent 
with manual and with behavior of string to 
<CODE>TIMESTAMP</CODE>/<CODE>DATETIME</CODE> conversion. (Bug #1448)
<LI>

Fixed bug when <CODE>BIT_AND()</CODE> and <CODE>BIT_OR()</CODE> group functions 
returned incorrect value if <CODE>SELECT</CODE> used a temporary table and
no rows were found. (Bug #1790).
<LI>

<CODE>BIT_AND()</CODE> is now unsigned in all contexts. This means that it will
now return 18446744073709551615 (= 0xffffffffffffffff) instead of -1 if
there were no rows in the result.
<LI>

Fixed bug with <CODE>BIT_AND()</CODE> still returning signed value for an
empty set in some cases. (Bug #1972)
<LI>

Fixed bug with <CODE>^</CODE> (XOR) and <CODE>&#62;&#62;</CODE> (bit shift) still returning
signed value in some cases. (Bug #1993)
<LI>

Replication:
a rare race condition in the slave SQL thread, which could lead to a
wrong complain that the relay log is corrupted. (Bug #2011)
<LI>

Replication:
in the slave SQL thread, a multiple-table <CODE>UPDATE</CODE> could produce a
wrong complain that some record was not found in one table, if the
<CODE>UPDATE</CODE> was preceded by a <CODE>INSERT ... SELECT</CODE>. (Bug #1701)
<LI>

Fixed deficiency in MySQL code which is responsible for scanning 
directories. This deficiency caused <CODE>SHOW TABLE STATUS</CODE> to be 
very slow when a database contained a large number of tables, even if a single 
particular table were specified. (Bug #1952)
</UL>



<H3><A NAME="News-4.0.16" HREF="manual_toc.html#News-4.0.16">C.3.5  Changes in release 4.0.16 (17 Oct 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Option values in option files now may be quoted. This is useful for values that
contain whitespace or comment characters.
<LI>

Write memory allocation information to error log when doing
<CODE>mysqladmin debug</CODE>.  This works only on systems that support the
<CODE>mallinfo()</CODE> call (like newer Linux systems).
<LI>

Added the following new server variables to allow more precise memory
allocation: <CODE>range_alloc_block_size</CODE>, <CODE>query_alloc_block_size</CODE>,
<CODE>query_prealloc_size</CODE>, <CODE>transaction_alloc_block_size</CODE>, and
<CODE>transaction_prealloc_size</CODE>.
<LI>

<CODE>mysqlbinlog</CODE> now reads option files. To make this work, you must now
specify <CODE>--read-from-remote-server</CODE> when reading binary logs from
a MySQL server. (Note that using a remote server is deprecated and may
disappear in future <CODE>mysqlbinlog</CODE> versions).
<LI>

Block <CODE>SIGPIPE</CODE> signals also for non-threaded programs. The blocking is moved
from <CODE>mysql_init()</CODE> to <CODE>mysql_server_init()</CODE>, which is
automatically called on the first call to <CODE>mysql_init()</CODE>.
<LI>

Added <CODE>--libs_r</CODE> and <CODE>--include</CODE> options to <CODE>mysql_config</CODE>.
<LI>

New <CODE>`&#62;</CODE> prompt for <CODE>mysql</CODE>. This prompt is similar to the
<CODE>'&#62;</CODE> and <CODE>"&#62;</CODE> prompts, but indicates that an identifier
quoted with backticks was begun on an earlier line and the closing backtick
has not yet been seen.
<LI>

Updated <CODE>mysql_install_db</CODE> to be able to use the local machine's IP
address instead of the hostname when building the initial grant tables if
<CODE>skip-name-resolve</CODE> has been specified. This
option can be helpful on FreeBSD to avoid thread-safety problems with the
FreeBSD resolver libraries. (Thanks to Jeremy Zawodny for the patch.)
<LI>

A documentation change: Added a note that when backing up a slave, it is
necessary also to back up the <TT>`master.info'</TT> and <TT>`relay-log.info'</TT>
files, as well as any <TT>`SQL_LOAD-*'</TT> files located in the directory
specified by the <CODE>--slave-load-tmpdir</CODE> option.  All these files are
needed when the slave resumes replication after you restore the slave's data.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed a spurious error <CODE>ERROR 14: Can't change size of file (Errcode: 2)</CODE>
on Windows in <CODE>DELETE FROM tbl_name</CODE> without a <CODE>WHERE</CODE> clause or
<CODE>TRUNCATE TABLE tbl_name</CODE>, when <CODE>tbl_name</CODE> is a <CODE>MyISAM</CODE>
table. (Bug #1397)
<LI>

Fixed a bug that resulted in <CODE>thr_alarm queue is full</CODE> warnings after
increasing the <CODE>max_connections</CODE> variable with <CODE>SET GLOBAL</CODE>.
(Bug #1435)
<LI>

Made <CODE>LOCK TABLES</CODE> to work when <CODE>Lock_tables_priv</CODE> is granted on the
database level and <CODE>Select_priv</CODE> is granted on the table level.
<LI>

Fixed crash of <CODE>FLUSH QUERY CACHE</CODE> on queries that use same table
several times (Bug #988).
<LI>

Fixed core dump bug when setting an enum system variable (such as
<CODE>SQL_WARNINGS</CODE>) to <CODE>NULL</CODE>.
<LI>

Extended the default timeout value for Windows clients from 30 seconds
to 1 year.  (The timeout that was added in MySQL 4.0.15 was way too
short).  This fixes a bug that caused <CODE>ERROR 2013: Lost connection
to MySQL server during query</CODE> for queries that lasted longer than 30 seconds,
if the client didn't specify a limit with <CODE>mysql_options()</CODE>. Users of
4.0.15 on Windows should upgrade to avoid this problem.
<LI>

More ``out of memory'' checking in range optimizer.
<LI>

Fixed and documented a problem when setting and using a user variable within the
same <CODE>SELECT</CODE> statement. (Bug #1194).
<LI>

Fixed bug in overrun check for <CODE>BLOB</CODE> values with compressed tables.
This was a bug introduced in 4.0.14.  It caused MySQL to regard some
correct tables containing <CODE>BLOB</CODE> values as corrupted.
(Bug #770, Bug #1304, and maybe Bug #1295)
<LI>

<CODE>SHOW GRANTS</CODE> showed <CODE>USAGE</CODE> instead of the real column-level
privileges when no table-level privileges were given.
<LI>

When copying a database from the master, <CODE>LOAD DATA FROM
MASTER</CODE> dropped the corresponding database on the slave, thus erroneously
dropping tables that had no counterpart on the master and tables that
may have been excluded from replication using <CODE>replicate-*-table</CODE>
rules. Now <CODE>LOAD DATA FROM MASTER</CODE> no longer drops the database.
Instead, it drops only the tables that have a counterpart on the master
and that match the <CODE>replicate-*-table</CODE>
rules. <CODE>replicate-*-db</CODE> rules can still be used to include or exclude a
database as a whole from <CODE>LOAD DATA FROM MASTER</CODE>. A database will
also be included or excluded as a whole if there are some rules like
<CODE>replicate-wild-do-table=db1.%</CODE> or
<CODE>replicate-wild-ignore-table=db1.%</CODE>, as is already the case for
<CODE>CREATE DATABASE</CODE> and <CODE>DROP DATABASE</CODE> in replication. (Bug
#1248)
<LI>

Fixed a bug where
<CODE>mysqlbinlog</CODE> crashed with a segmentation fault when used with the
<CODE>-h</CODE> or <CODE>--host</CODE> option. (Bug #1258)
<LI>

Fixed a bug where <CODE>mysqlbinlog</CODE> crashed with a segmentation fault
when used on a binary log containing only final events for <CODE>LOAD
DATA</CODE>. (Bug #1340)
<LI>

<CODE>mysqlbinlog</CODE> will not reuse temporary file names from previous runs.
Previously <CODE>mysqlbinlog</CODE> failed if was used several times on the same
binary log file that contained a <CODE>LOAD DATA</CODE> command.
<LI>

Fixed compilation problem when compiling with OpenSSL 0.9.7 with
disabled old DES support (If <CODE>OPENSSL_DISABLE_OLD_DES_SUPPORT</CODE> 
option was enabled).
<LI>

Fixed a bug when two (or more) MySQL servers were running on the same machine,
and they were both slaves, and at least one of them was replicating some
<CODE>LOAD DATA INFILE</CODE> command from its master.
The bug was that one slave MySQL server sometimes
deleted the <TT>`SQL_LOAD-*'</TT> files (used for replication of
<CODE>LOAD DATA INFILE</CODE> and located in the <CODE>slave-load-tmpdir</CODE> directory,
which defaults to <CODE>tmpdir</CODE>) belonging to the other slave MySQL server of
this machine, if these slaves had the same <CODE>slave-load-tmpdir</CODE> directory.
When that happened, the other slave could not replicate
<CODE>LOAD DATA INFILE</CODE> and complained about not being able to open some
<CODE>SQL_LOAD-*</CODE> file. (Bug #1357)
<LI>

If <CODE>LOAD DATA INFILE</CODE> failed for a small file, the master forgot to
write a marker (a <CODE>Delete_file</CODE> event) in its binary log, so the slave
could not delete 2 files (<TT>`SQL_LOAD-*.info'</TT> and
<TT>`SQL_LOAD-*.data'</TT> from its <CODE>tmpdir</CODE>. (Bug #1391)
<LI>

On Windows, the slave forgot to delete a <CODE>SQL_LOAD-*.info</CODE>
file from <CODE>tmpdir</CODE> after successfully replicating a <CODE>LOAD DATA
INFILE</CODE> command. (Bug #1392)
<LI>

When a connection terminates, MySQL writes <CODE>DROP TEMPORARY TABLE</CODE>
statements to the binary log for all temporary tables which the
connection had not explicitly dropped. MySQL forgot to use backticks to quote
the database and table names in the statement. (Bug #1345)
<LI>

On some 64-bit machines (some HP-UX and Solaris machines), a slave
installed with the 64-bit MySQL binary could not connect to its master
(it connected to itself instead). (Bug #1256, Bug #1381)
<LI>

Code was introduced in MySQL 4.0.15 for the slave to detect that the master
had died while writing a transaction to its binary log. This code reported an
error in a legal situation: When the slave I/O thread was stopped while
copying a transaction to the relay log, the slave SQL thread would later
pretend that it found an unfinished transaction. (Bug #1475)
</UL>



<H3><A NAME="News-4.0.15" HREF="manual_toc.html#News-4.0.15">C.3.6  Changes in release 4.0.15 (03 Sep 2003)</A></H3>

<P>
<STRONG>IMPORTANT</STRONG>:

</P>
<P>
If you are using this release on Windows, you should upgrade at least your
clients (any program that uses <CODE>libmysql.lib</CODE>) to 4.0.16 or above.  This
is because the 4.0.15 release had a bug in the Windows client library that
causes Windows clients using the library to die with a <CODE>Lost connection
to MySQL server during query</CODE> error for queries that take more than 30
seconds.  This problem is specific to Windows; clients on other platforms are
unaffected.

</P>
<P>
Functionality added or changed:

<UL>
<LI>

<CODE>mysqldump</CODE> now correctly quotes all identifiers when communicating
with the server. This assures that during the dump process, <CODE>mysqldump</CODE>
will never send queries to the server that result in a syntax error.
This problem is <STRONG>not</STRONG> related to the
<CODE>mysqldump</CODE> program's output, which was not changed. (Bug #1148)
<LI>

Change result set metadata information so that <CODE>MIN()</CODE> and <CODE>MAX()</CODE>
report that they can return <CODE>NULL</CODE> (this is true because an
empty set will return <CODE>NULL</CODE>). (Bug #324)
<LI>

Produce an error message on Windows if a second <CODE>mysqld</CODE> server is
started on the same TCP/IP port as an already running <CODE>mysqld</CODE> server.
<LI>

The <CODE>mysqld</CODE> server variables <CODE>wait_timeout</CODE>,
<CODE>net_read_timeout</CODE>, and <CODE>net_write_timeout</CODE> now work on Windows.
One can now also set timeouts for read and writes in Windows clients with
<CODE>mysql_options()</CODE>.
<LI>

Added option <CODE>--sql-mode=NO_DIR_IN_CREATE</CODE> to make it possible for
slaves to ignore <CODE>INDEX DIRECTORY</CODE> and
<CODE>DATA DIRECTORY</CODE> options given to <CODE>CREATE TABLE</CODE>.
When this is mode is on, <CODE>SHOW CREATE TABLE</CODE> will not show the
given directories.
<LI>

<CODE>SHOW CREATE TABLE</CODE> now shows the <CODE>INDEX DIRECTORY</CODE> and
<CODE>DATA DIRECTORY</CODE> options, if they were specified when the table was
created.
<LI>

The <CODE>open_files_limit</CODE> server variable now shows the real open files limit.
<LI>

<CODE>MATCH ... AGAINST()</CODE> in natural language mode
now treats words that are present
in more than 2,000,000 rows as stopwords.
<LI>

The Mac OS X installation disk images now include an additional
<TT>`MySQLStartupItem.pkg'</TT> package that enables the automatic
startup of MySQL on system startup.
See section <A HREF="manual.html#Mac_OS_X_installation">2.2.3  Installing MySQL on Mac OS X</A>.
<LI>

Most of the documentation included in the binary tarball distributions
(<CODE>.tar.gz</CODE>) has been moved into a subdirectory <CODE>docs</CODE>.
See section <A HREF="manual.html#Installation_layouts">2.1.5  Installation Layouts</A>.
<LI>

The manual is now included as an additional <CODE>info</CODE> file in the binary
distributions. (Bug #1019)
<LI>

The binary distributions now include the embedded server library 
(<CODE>libmysqld.a</CODE>) by default. Due to a linking problem with non-gcc
compilers, it was not included in all packages of the initial 4.0.15
release. The affected packages were rebuilt and released as 4.0.15a.
See section <A HREF="manual.html#Nutshell_Embedded_MySQL">1.5.1.2  The Embedded MySQL Server</A>.
<LI>

MySQL can now use range optimization for <CODE>BETWEEN</CODE> with
non-constant limits. (Bug #991)
<LI>

Replication error messages now include the default database, so that
users can check which database the failing query was run for.
<LI>

A documentation change: Added a paragraph about how the
<CODE>binlog-do-db</CODE> and <CODE>binlog-ignore-db</CODE> options are tested
against the database on the master (see section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>), and a
paragraph about how <CODE>replicate-do-db</CODE>, <CODE>replicate-do-table</CODE>
and analogous options are tested against the database and tables on the
slave (see section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>).
<LI>

Now the slave does not replicate <CODE>SET PASSWORD</CODE>
if it is configured to exclude the <CODE>mysql</CODE> database from
replication (using for example
<CODE>replicate-wild-ignore-table=mysql.%</CODE>). This was already the
case for <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> since version 4.0.13 (although
there was Bug #980 in 4.0.13 &#38; 4.0.14, which has been fixed in
4.0.15).
<LI>

Rewrote the information shown in the <CODE>State</CODE> column of <CODE>SHOW
PROCESSLIST</CODE> for replication threads and for <CODE>MASTER_POS_WAIT()</CODE>
and added the most common states for these threads to the
documentation, see section <A HREF="manual.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>.
<LI>

Added a test in replication to detect the case where the master died
in the middle of writing a transaction to the binary log; such unfinished
transactions now trigger an error message on the slave.
<LI>

A <CODE>GRANT</CODE> command that creates an anonymous user
(that is, an account with an empty username) no longer requires
<CODE>FLUSH PRIVILEGES</CODE> for the account to be recognized by the server.
(Bug #473)
<LI>

<CODE>CHANGE MASTER</CODE> now flushes <TT>`relay-log.info'</TT>. Previously
this was deferred to the next run of <CODE>START SLAVE</CODE>, so if
<CODE>mysqld</CODE> was shutdown on the slave after <CODE>CHANGE MASTER</CODE>
without having run <CODE>START SLAVE</CODE>, the relay log's name and
position were lost. At restart they were reloaded from
<TT>`relay-log.info'</TT>, thus reverting to their old (incorrect) values from
before <CODE>CHANGE MASTER</CODE> and leading to error messages 
(as the old relay log did not exist any more) and the slave threads
refusing to start. (Bug #858)
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed buffer overflow in password handling which could potentially be
exploited by MySQL users with <CODE>ALTER</CODE> privilege on the
<CODE>mysql.user</CODE> table to execute random code or to gain shell access with
the UID of the <CODE>mysqld</CODE> process (thanks to Jedi/Sector One for spotting and
reporting this bug).
<LI>

Fixed server crash on <CODE>FORCE INDEX</CODE> in a query that contained
"Range checked for each record" in the <CODE>EXPLAIN</CODE> output. (Bug #1172)
<LI>

Fixed table/column grant handling: The proper sort order (from most specific
to less specific, see section <A HREF="manual.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A>) was not honored. (Bug #928)
<LI>

Fixed rare bug in <CODE>MYISAM</CODE> introduced in 4.0.3 where the index file header
was not updated directly after an <CODE>UPDATE</CODE> of split dynamic rows.
The symptom was that the table had a corrupted delete-link if <CODE>mysqld</CODE>
was shut down or the table was checked directly after the update.
<LI>

Fixed <CODE>Can't unlock file</CODE> error when running
<CODE>myisamchk --sort-index</CODE> on Windows. (Bug #1119)
<LI>

Fixed possible deadlock when changing <CODE>key_buffer_size</CODE> while
the key cache was actively used. (Bug #1088)
<LI>

Fixed overflow bug in <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> when a row is updated
in a table with a large number of columns and at least one <CODE>BLOB/TEXT</CODE>
column.
<LI>

Fixed incorrect result when doing <CODE>UNION</CODE> and <CODE>LIMIT #,#</CODE> when
braces were not used around the <CODE>SELECT</CODE> parts.
<LI>

Fixed incorrect result when doing <CODE>UNION</CODE> and <CODE>ORDER BY .. LIMIT #</CODE>
when one didn't use braces around the <CODE>SELECT</CODE> parts.
<LI>

Fixed problem with <CODE>SELECT SQL_CALC_FOUND_ROWS ... UNION ALL ... LIMIT #</CODE>
where <CODE>FOUND_ROWS()</CODE> returned incorrect number of rows.
<LI>

Fixed unlikely stack bug when having a BIG expression of
type <CODE>1+1-1+1-1...</CODE> in certain combinations. (Bug #871)
<LI>

Fixed the bug that sometimes prevented a table with a <CODE>FULLTEXT</CODE> index
from being marked as "analyzed".
<LI>

Fixed MySQL so that the column length (in C API) for the second column in
<CODE>SHOW CREATE TABLE</CODE> is always larger than the data length.
The only known application that was affected by the old behavior was
Borland dbExpress, which truncated the output from the command.
(Bug #1064)
<LI>

Fixed crash in comparisons of strings using the <CODE>tis620</CODE> character
set. (Bug #1116)
<LI>

Fixed <CODE>ISAM</CODE> bug in <CODE>MAX()</CODE> optimization.
<LI>

<CODE>myisamchk --sort-records=N</CODE> no longer marks table as crashed if
sorting failed because of an inappropriate key. (Bug #892)
<LI>

Fixed a minor bug in <CODE>MyISAM</CODE> compressed table handling that sometimes
made it impossible to repair compressed table in "Repair by sort" mode.
"Repair with keycache" (<CODE>myisamchk --safe-recover</CODE>) worked, though.
(Bug #1015)
<LI>

Fixed bug in propagating the version number to the manual included in
the distribution files. (Bug #1020)
<LI>

Fixed key sorting problem (a <CODE>PRIMARY</CODE> key declared for a column
that is not explicitly marked <CODE>NOT NULL</CODE> was sorted after a
<CODE>UNIQUE</CODE> key for a <CODE>NOT NULL</CODE> column).
<LI>

Fixed the result of <CODE>INTERVAL</CODE> when applied to a <CODE>DATE</CODE> value.
(Bug #792)
<LI>

Fixed compiling of the embedded server library in the RPM spec file.
(Bug #959)
<LI>

Added some missing files to the RPM spec file and fixed some RPM building
errors that occurred on Red Hat Linux 9. (Bug #998)
<LI>

Fixed incorrect <CODE>XOR</CODE> evaluation in <CODE>WHERE</CODE> clause. (Bug #992)
<LI>

Fixed bug with processing in query cache merged tables constructed
from more then 255 tables. (Bug #930) 
<LI>

Fixed incorrect results from outer join query (e.g. <CODE>LEFT JOIN</CODE>)
when <CODE>ON</CODE> condition is always false, and range search in used.  
(Bug #926)
<LI>

Fixed a bug causing incorrect results from <CODE>MATCH ... AGAINST()</CODE> in some
joins. (Bug #942)
<LI>

<CODE>MERGE</CODE> tables do not ignore "Using index" (from <CODE>EXPLAIN</CODE> output)
anymore.
<LI>

Fixed a bug that prevented an empty table from being marked as "analyzed".
(Bug #937)
<LI>

Fixed <CODE>myisamchk --sort-records</CODE> crash when used on compressed table.
<LI>

Fixed slow (as compared to 3.23)
<CODE>ALTER TABLE</CODE> and related commands such as <CODE>CREATE INDEX</CODE>.
(Bug #712)
<LI>

Fixed segmentation fault resulting from <CODE>LOAD DATA FROM MASTER</CODE> when
the master was running without the <CODE>--log-bin</CODE> option. (Bug #934)
<LI>

Fixed a security bug: A server compiled without SSL support still allowed
connections by users who had the <CODE>REQUIRE SSL</CODE> option specified for
their accounts.
<LI>

Fixed a random bug: Sometimes the slave would replicate <CODE>GRANT</CODE>
or <CODE>REVOKE</CODE> queries even if it was configured to exclude the
<CODE>mysql</CODE> database from replication (for example, using
<CODE>replicate-wild-ignore-table=mysql.%</CODE>). (Bug #980)
<LI>

The <CODE>Last_Errno</CODE> and <CODE>Last_Error</CODE> fields in the output of
<CODE>SHOW SLAVE STATUS</CODE> are now cleared by <CODE>CHANGE MASTER</CODE> and
when the slave SQL thread starts. (Bug #986)
<LI>

A documentation mistake: It said that <CODE>RESET SLAVE</CODE> does not change
connection information  (master host, port, user, and
password), whereas it does. The statement resets these to the startup options
(<CODE>master-host</CODE> etc) if there were some. (Bug #985)
<LI>

<CODE>SHOW SLAVE STATUS</CODE> now shows correct information (master host,
port, user, and password) after <CODE>RESET SLAVE</CODE>
(that is, it shows the new values, which are copied from the startup
options if there were some). (Bug #985)
<LI>

Disabled propagation of the original master's log position for events because
this caused unexpected values for <CODE>Exec_Master_Log_Pos</CODE> and problems
with <CODE>MASTER_POS_WAIT()</CODE> in A-&#62;B-&#62;C replication setup. (Bug #1086)
<LI>

Fixed a segfault in <CODE>mysqlbinlog</CODE> when
<CODE>--position=x</CODE> was used with <CODE>x</CODE> being between a
<CODE>Create_file</CODE> event and its fellow <CODE>Append_block</CODE>,
<CODE>Exec_load</CODE> or <CODE>Delete_file</CODE> events. (Bug #1091)
<LI>

<CODE>mysqlbinlog</CODE> printed superfluous warnings when using
<CODE>--database</CODE>, which caused syntax errors when piped to
<CODE>mysql</CODE>. (Bug #1092)
<LI>

Made <CODE>mysqlbinlog --database</CODE> filter <CODE>LOAD DATA INFILE</CODE> too
(previously, it filtered all queries except <CODE>LOAD DATA
INFILE</CODE>). (Bug #1093)
<LI>

<CODE>mysqlbinlog</CODE> in some cases forgot to put a leading <CODE>'#'</CODE> in
front of the original <CODE>LOAD DATA INFILE</CODE> (this command is
displayed only for information, not to be run; it is later reworked to
<CODE>LOAD DATA LOCAL</CODE> with a different filename, for execution by
<CODE>mysql</CODE>). (Bug #1096)
<LI>

<CODE>binlog-do-db</CODE> and <CODE>binlog-ignore-db</CODE> incorrectly filtered
<CODE>LOAD DATA INFILE</CODE> (it was half-written to the binary log). This
resulted in a corrupted binary log, which could cause the slave to
stop with an error. (Bug #1100)
<LI>

When, in a transaction, a transactional table (such as an <CODE>InnoDB</CODE> table)
was updated, and later in the same transaction a
non-transactional table (such as a <CODE>MyISAM</CODE> table) was
updated using the updated content of the transactional table
(with <CODE>INSERT ... SELECT</CODE> for example), the queries were written
to the binary log in an incorrect order. (Bug #873)
<LI>

When, in a transaction, <CODE>INSERT ... SELECT</CODE> updated a
non-transactional table, and <CODE>ROLLBACK</CODE> was issued, no error was
returned to the client. Now the client is warned that some changes
could not be rolled back, as this was already the case for normal
<CODE>INSERT</CODE>. (Bug #1113)
<LI>

Fixed a potential bug: When <CODE>STOP SLAVE</CODE> was run while the slave
SQL thread was in the middle of a transaction, and then <CODE>CHANGE
MASTER</CODE> was used to point the slave to some non-transactional
statement, the slave SQL thread could get confused (because it would
still think, from the past, that it was in a transaction).
</UL>



<H3><A NAME="News-4.0.14" HREF="manual_toc.html#News-4.0.14">C.3.7  Changes in release 4.0.14 (18 Jul 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Added <CODE>default_week_format</CODE> system variable. The value is used as the
default mode for the <CODE>WEEK()</CODE> function.
<LI>

<CODE>mysqld</CODE> now reads an additional option file group having a name
corresponding to the server's release series:
<CODE>[mysqld-4.0]</CODE> for 4.0.x servers, <CODE>[mysqld-4.1]</CODE> for 4.1.x servers,
and so forth. This allows options to be specified on a series-specific basis.
<LI>

The <CODE>CONCAT_WS()</CODE> function no longer skips empty strings. (Bug #586).
<LI>

<CODE>InnoDB</CODE> now supports indexing a prefix of a column. This means, in
particular, that <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns can be indexed in
<CODE>InnoDB</CODE> tables, which was not possible before.
<LI>

A documentation change: Function <CODE>INTERVAL(NULL, ...)</CODE> returns <CODE>-1</CODE>.
<LI>

Enabled <CODE>INSERT</CODE> from <CODE>SELECT</CODE> when the table into which the records
are inserted is also a table listed in the <CODE>SELECT</CODE>.
<LI>

Allow <CODE>CREATE TABLE</CODE> and <CODE>INSERT</CODE> from any <CODE>UNION</CODE>.
<LI>

The <CODE>SQL_CALC_FOUND_ROWS</CODE> option now always returns the total number 
of rows for any <CODE>UNION</CODE>.
<LI>

Removed <CODE>--table</CODE> option from <CODE>mysqlbinlog</CODE> 
to avoid repeating <CODE>mysqldump</CODE> functionality.
<LI>

Comment lines in option files can now start from the middle of a line, too
(like <CODE>basedir=c:\mysql # installation directory</CODE>).
<LI>

Changed optimizer slightly to prefer index lookups over full table scans
in some boundary cases.
<LI>

Added thread-specific <CODE>max_seeks_for_key</CODE> variable that can
be used to force the optimizer to use keys instead of table scans
even if the cardinality of the index is low.
<LI>

Added optimization that converts <CODE>LEFT JOIN</CODE> to normal join in
some cases.
<LI>

A documentation change: added a paragraph about failover in
replication (how to use a surviving slave as the new master, how to
resume to the original setup). See section <A HREF="manual.html#Replication_FAQ">6.9  Replication FAQ</A>.
<LI>

A documentation change: added warning notes about safe use of the
<CODE>CHANGE MASTER</CODE> command. See section <A HREF="manual.html#CHANGE_MASTER_TO">14.6.2.1  <CODE>CHANGE MASTER TO</CODE> Syntax</A>.
<LI>

MySQL now issues a warning (not an error, as in 4.0.13)
when it opens a table that was created with MySQL 4.1.
<LI>

Added <CODE>--nice</CODE> option to <CODE>mysqld_safe</CODE> to allow setting the
niceness of the <CODE>mysqld</CODE> process. (Thanks to Christian Hammers for
providing the initial patch.) (Bug #627)
<LI>

Added <CODE>--read-only</CODE> option to cause <CODE>mysqld</CODE> to allow no updates
except from slave threads or from users with the <CODE>SUPER</CODE> privilege.
(Original patch from Markus Benning).
<LI>

<CODE>SHOW BINLOG EVENTS FROM x</CODE> where <CODE>x</CODE> is less than 4 now
silently converts <CODE>x</CODE> to 4 instead of printing an error. The same change
was done for <CODE>CHANGE MASTER TO MASTER_LOG_POS=x</CODE> and 
<CODE>CHANGE MASTER TO RELAY_LOG_POS=x</CODE>.
<LI>

<CODE>mysqld</CODE> now only adds an interrupt handler for the <CODE>SIGINT</CODE> signal
if you start it with the new <CODE>--gdb</CODE> option.  This is because some
MySQL users encountered strange problems when they accidentally sent <CODE>SIGINT</CODE> to
<CODE>mysqld</CODE> threads.
<LI>

<CODE>RESET SLAVE</CODE> now clears the <CODE>Last_Errno</CODE> and
<CODE>Last_Error</CODE> fields in the output of <CODE>SHOW SLAVE STATUS</CODE>.
<LI>

Added <CODE>max_relay_log_size</CODE> variable; the relay log will be rotated
automatically when its size exceeds <CODE>max_relay_log_size</CODE>. But if
<CODE>max_relay_log_size</CODE> is 0 (the default), <CODE>max_binlog_size</CODE>
will be used (as in older versions). <CODE>max_binlog_size</CODE> still
applies to binary logs in any case.
<LI>

<CODE>FLUSH LOGS</CODE> now rotates relay logs in addition to the other types of
logs it already rotated.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Comparison/sorting for <CODE>latin1_de</CODE> character set was rewritten.
The old algorithm could not handle cases like <CODE>"s@"a" &#62; "@ss{</CODE>a"}.
See section <A HREF="manual.html#German_character_set">5.7.1.1  Using the German Character Set</A>. In rare cases it resulted in table
corruption.
<LI>

Fixed a problem with the password prompt on Windows. (Bug #683)
<LI>

<CODE>ALTER TABLE ... UNION=(...)</CODE> for <CODE>MERGE</CODE> table is now allowed
even if some underlying <CODE>MyISAM</CODE> tables are read-only. (Bug #702)
<LI>

Fixed a problem with <CODE>CREATE TABLE t1 SELECT x'41'</CODE>. (Bug #801)
<LI>

Removed some incorrect lock warnings from the error log.
<LI>

Fixed memory overrun when doing <CODE>REPAIR TABLE</CODE> on a table with a
multiple-part auto_increment key where one part was a packed <CODE>CHAR</CODE>.
<LI>

Fixed a probable race condition in the replication code that could
potentially lead to <CODE>INSERT</CODE> statements not being replicated in the
event of a <CODE>FLUSH LOGS</CODE> command or when the binary log exceeds
<CODE>max_binlog_size</CODE>. (Bug #791)
<LI>

Fixed a crashing bug in <CODE>INTERVAL</CODE> and <CODE>GROUP BY</CODE> or 
<CODE>DISTINCT</CODE>. (Bug #807)
<LI>

Fixed bug in <CODE>mysqlhotcopy</CODE> so it actually aborts for unsuccessful
table copying operations.  Fixed another bug so that it succeeds
when there are thousands of tables to copy. (Bug #812)
<LI>

Fixed problem with <CODE>mysqlhotcopy</CODE> failing to read options from option
files. (Bug #808)
<LI>

Fixed bugs in optimizer that sometimes prevented MySQL from using
<CODE>FULLTEXT</CODE> indexes even though it was possible (for example, in
<CODE>SELECT * FROM t1 WHERE MATCH a,b AGAINST("index") &#62; 0</CODE>).
<LI>

Fixed a bug with ``table is full'' in <CODE>UNION</CODE> operations.
<LI>

Fixed a security problem that enabled users with no privileges to obtain
information on the list of existing databases by using <CODE>SHOW TABLES</CODE> and
similar commands.
<LI>

Fixed a stack problem on UnixWare/OpenUnix.
<LI>

Fixed a configuration problem on UnixWare/OpenUNIX and OpenServer.
<LI>

Fixed a stack overflow problem in password verification.
<LI>

Fixed a problem with <CODE>max_user_connections</CODE>.
<LI>

<CODE>HANDLER</CODE> without an index now works properly when a table has deleted 
rows. (Bug #787)
<LI>

Fixed a bug with <CODE>LOAD DATA</CODE> in <CODE>mysqlbinlog</CODE>. (Bug #670)
<LI>

Fixed that <CODE>SET CHARACTER SET DEFAULT</CODE> works. (Bug #462)
<LI>

Fixed <CODE>MERGE</CODE> table behavior in <CODE>ORDER BY ... DESC</CODE> queries.
(Bug #515)
<LI>

Fixed server crash on <CODE>PURGE MASTER LOGS</CODE> or <CODE>SHOW MASTER LOGS</CODE>
when the binary log is off. (Bug #733)
<LI>

Fixed password-checking problem on Windows. (Bug #464)
<LI>

Fixed the bug in comparison of a <CODE>DATETIME</CODE> column and an integer
constant.  (Bug #504)
<LI>

Fixed remote mode of <CODE>mysqlbinlog</CODE>. (Bug #672)
<LI>

Fixed <CODE>ERROR 1105: Unknown error</CODE> that occurred for some <CODE>SELECT</CODE>
queries, where a column that was declared as <CODE>NOT NULL</CODE> was compared
with an expression that took <CODE>NULL</CODE> value.
<LI>

Changed timeout in <CODE>mysql_real_connect()</CODE> to use <CODE>poll()</CODE> instead of
<CODE>select()</CODE> to work around problem with many open files in the client.
<LI>

Fixed incorrect results from <CODE>MATCH ... AGAINST</CODE> used with a
<CODE>LEFT JOIN</CODE> query.
<LI>

Fixed a bug that limited the maximum value for <CODE>mysqld</CODE> variables
to 4294967295 when they are specified on the command line.
<LI>

Fixed a bug that sometimes caused spurious ``Access denied'' errors
in <CODE>HANDLER ... READ</CODE> statements, when a table is referenced
via an alias.
<LI>

Fixed portability problem with <CODE>safe_malloc</CODE>, which caused MySQL to
give "Freeing wrong aligned pointer" errors on SCO 3.2.
<LI>

<CODE>ALTER TABLE ... ENABLE/DISABLE KEYS</CODE> could cause a core dump when
done after an <CODE>INSERT DELAYED</CODE> statement on the same table.
<LI>

Fixed problem with conversion of localtime to GMT where some times resulted in
different (but correct) timestamps. Now MySQL should use the smallest
possible timestamp value in this case.  (Bug #316)
<LI>

Very small query cache sizes could crash <CODE>mysqld</CODE>. (Bug #549)
<LI>

Fixed a bug (accidentally introduced by us but present only in version 4.0.13)
that made <CODE>INSERT ... SELECT</CODE> into an <CODE>AUTO_INCREMENT</CODE> column
not replicate well. This bug is in the master, not in the slave.
(Bug #490)
<LI>

Fixed a bug: When an <CODE>INSERT ... SELECT</CODE> statement inserted rows into a
non-transactional table, but failed at some point (for example, due to
a ``Duplicate key'' error), the query was not written to the binary log.
Now it is written to the binary log, with its error code, as all other
queries are. About the <CODE>slave-skip-errors</CODE> option for how to
handle partially completed queries in the slave, see section <A HREF="manual.html#Replication_Options">6.8  Replication Startup Options</A>. (Bug #491)
<LI>

<CODE>SET FOREIGN_KEY_CHECKS=0</CODE> was not replicated properly.
The fix probably will not be backported to 3.23.
<LI>

On a slave, <CODE>LOAD DATA INFILE</CODE> which had no <CODE>IGNORE</CODE> or
<CODE>REPLACE</CODE> clause on the master, was replicated with <CODE>IGNORE</CODE>.
While this is not a problem if the master and slave data are identical
(a <CODE>LOAD</CODE> that produces no duplicate conflicts on the master will
produce none on the slave anyway), which is true in normal operation, it
is better for debugging not to silently add the <CODE>IGNORE</CODE>. That way,
you can get an error message on the slave and discover that for some
reason, the data on master and slave are different and investigate why.
(Bug #571)
<LI>

On a slave, <CODE>LOAD DATA INFILE</CODE> printed an incomplete ``Duplicate entry
'%-.64s' for key %d''' message (the key name and value were not mentioned)
in case of duplicate conflict (which does not happen in normal operation).
(Bug #573)
<LI>

When using a slave compiled with <CODE>--debug</CODE>, <CODE>CHANGE MASTER
TO RELAY_LOG_POS</CODE> could cause a debug assertion failure. (Bug #576)
<LI>

When doing a <CODE>LOCK TABLES WRITE</CODE> on an <CODE>InnoDB</CODE> table, commit could
not happen, if the query was not written to the binary log (for example, if
<CODE>--log-bin</CODE> was not used, or <CODE>binlog-ignore-db</CODE> was
used). (Bug #578)
<LI>

If a 3.23 master had open
temporary tables that had been replicated to a 4.0 slave, and
the binary log got rotated, these temporary tables were immediately 
dropped by the slave (which caused problems if the master used them
subsequently). This bug had been fixed in 4.0.13, but in a manner
which caused an unlikely inconvenience: If the 3.23 master died
brutally (power failure), without having enough time to automatically
write <CODE>DROP TABLE</CODE> statements to its binary log, then the 4.0.13
slave would not notice the temporary tables have to be dropped, until the
slave <CODE>mysqld</CODE> server is restarted. This minor inconvenience is
fixed in 3.23.57 and 4.0.14 (meaning the master must be upgraded to
3.23.57 and the slave to 4.0.14 to remove the inconvenience). (Bug #254)
<LI>

If <CODE>MASTER_POS_WAIT()</CODE> was waiting, and the slave was idle, and
the slave SQL thread terminated, <CODE>MASTER_POS_WAIT()</CODE> would wait
forever. Now when the slave SQL thread terminates,
<CODE>MASTER_POS_WAIT()</CODE> immediately returns <CODE>NULL</CODE> (``slave
stopped''). (Bug #651)
<LI>

After <CODE>RESET SLAVE; START SLAVE;</CODE>, the <CODE>Relay_Log_Space</CODE> value
displayed by <CODE>SHOW SLAVE STATUS</CODE> was too big by four bytes. (Bug #763)
<LI>

If a query was ignored on the slave (because of
<CODE>replicate-ignore-table</CODE> and other similar rules), the slave
still checked if the query got the same error code (0, no error) as on
the master. So if the master had an error on the query (for example,
``Duplicate entry'' in a multiple-row insert), then the slave stopped
and warned that the error codes didn't match. (Bug #797)
</UL>



<H3><A NAME="News-4.0.13" HREF="manual_toc.html#News-4.0.13">C.3.8  Changes in release 4.0.13 (16 May 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>PRIMARY KEY</CODE> now implies <CODE>NOT NULL</CODE>. (Bug #390)
<LI>

The Windows binary packages are now compiled with
<CODE>--enable-local-infile</CODE> to match the Unix build configuration.
<LI>

Removed timing of tests from <CODE>mysql-test-run</CODE>. <CODE>time</CODE> does not
accept all required parameters on many platforms (for example, QNX) and timing
the tests is not really required (it's not a benchmark anyway).
<LI>

<CODE>SHOW MASTER STATUS</CODE> and <CODE>SHOW SLAVE STATUS</CODE> required the
<CODE>SUPER</CODE> privilege; now they accept <CODE>REPLICATION CLIENT</CODE> as well.
(Bug #343)
<LI>

Added multi-threaded <CODE>MyISAM</CODE> repair optimization and
<CODE>myisam_repair_threads</CODE> variable to enable it.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

Added <CODE>innodb_max_dirty_pages_pct</CODE> variable which controls amount of
dirty pages allowed in <CODE>InnoDB</CODE> buffer pool.
<LI>

<CODE>CURRENT_USER()</CODE> and <CODE>Access denied</CODE> error messages now report the
hostname exactly as it was specified in the <CODE>GRANT</CODE> command.
<LI>

Removed benchmark results from the source and binary distributions. They
are still available in the BK source tree, though.
<LI>

<CODE>InnoDB</CODE> tables now support <CODE>ANALYZE TABLE</CODE>.
<LI>

MySQL now issues an error when it opens a table that was created with
MySQL 4.1.
<LI>

Option <CODE>--new</CODE> now changes binary items (<CODE>0xFFDF</CODE>) to be
treated as binary strings instead of numbers by default. This fixes some
problems with character sets where it's convenient to input the string
as a binary item.  After this change you have to convert the binary
string to <CODE>INTEGER</CODE> with a <CODE>CAST</CODE> if you want to compare two
binary items with each other and know which one is bigger than the other.
<CODE>SELECT CAST(0xfeff AS UNSIGNED) &#60; CAST(0xff AS UNSIGNED)</CODE>.
This will be the default behavior in MySQL 4.1. (Bug #152)
<LI>

Enabled <CODE>delayed_insert_timeout</CODE> on Linux (most modern <CODE>glibc</CODE>
libraries have a fixed <CODE>pthread_cond_timedwait()</CODE>). (Bug #211)
<LI>

Don't create more insert delayed threads than given by
<CODE>max_delayed_threads</CODE>. (Bug #211)
<LI>

Changed <CODE>UPDATE ... LIMIT</CODE> to apply the limit to rows that were matched,
whether or not they actually were changed. Previously the limit was applied
as a restriction on the number of rows changed.
<LI>

Tuned optimizer to favor clustered index over table scan.
<LI>

<CODE>BIT_AND()</CODE> and <CODE>BIT_OR()</CODE> now return an unsigned 64-bit value.
<LI>

Added warnings to error log of why a secure connection failed (when
running with <CODE>--log-warnings</CODE>).
<LI>

Deprecated options <CODE>--skip-symlink</CODE> and <CODE>--use-symbolic-links</CODE> and
replaced these with <CODE>--symbolic-links</CODE>.
<LI>

The default option for <CODE>innodb_flush_log_at_trx_commit</CODE> was changed
from 0 to 1 to make <CODE>InnoDB</CODE> tables ACID by default.
See section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.
<LI>

Added a feature to <CODE>SHOW KEYS</CODE> to display keys that are disabled by 
<CODE>ALTER TABLE DISABLE KEYS</CODE> command.
<LI>

When using a non-existing table type with <CODE>CREATE TABLE</CODE>, first
try if the default table type exists before falling back to <CODE>MyISAM</CODE>.
<LI>

Added <CODE>MEMORY</CODE> as an alias for <CODE>HEAP</CODE>.
<LI>

Renamed function <CODE>rnd</CODE> to <CODE>my_rnd</CODE> as the name was too generic
and is an exported symbol in <CODE>libmysqlclient</CODE> (thanks to Dennis Haney
for the initial patch).
<LI>

Portability fix: renamed <TT>`include/dbug.h'</TT> to
<TT>`include/my_dbug.h'</TT>.
<LI>

<CODE>mysqldump</CODE> no longer silently deletes the binary logs when invoked with
the <CODE>--master-data</CODE> or <CODE>--first-slave</CODE> option;
while this behavior was convenient for some
users, others may suffer from it. Now you must explicitly ask for binary
logs to be deleted by using the new <CODE>--delete-master-logs</CODE> option.
<LI>

If the slave is configured (using for example
<CODE>replicate-wild-ignore-table=mysql.%</CODE>)
to exclude <CODE>mysql.user</CODE>, <CODE>mysql.host</CODE>, <CODE>mysql.db</CODE>,
<CODE>mysql.tables_priv</CODE> and <CODE>mysql.columns_priv</CODE> from
replication, then <CODE>GRANT</CODE> and <CODE>REVOKE</CODE> will not be replicated.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Logged <CODE>Access denied</CODE> error message had incorrect <CODE>Using password</CODE>
value. (Bug #398)
<LI>

Fixed bug with <CODE>NATURAL LEFT JOIN</CODE>, <CODE>NATURAL RIGHT JOIN</CODE> and
<CODE>RIGHT JOIN</CODE> when using many joined tables.  The problem was that
the <CODE>JOIN</CODE> method was not always associated with the tables
surrounding the <CODE>JOIN</CODE> method.  If you have a query that uses many
<CODE>RIGHT JOIN</CODE> or <CODE>NATURAL ... JOINS</CODE> you should verify that they
work as you expected after upgrading MySQL to this version. (Bug #291)
<LI>

Fixed <CODE>mysql</CODE> parser not to erroneously interpret <SAMP>`''</SAMP> or <SAMP>`"'</SAMP>
characters within <CODE>/* ... */</CODE> comment as beginning a quoted string.
<LI>

<CODE>mysql</CODE> command line client no longer looks for <CODE>\*</CODE> commands
inside backtick-quoted strings.
<LI>

Fixed <CODE>Unknown error</CODE> when using <CODE>UPDATE ... LIMIT</CODE>. (Bug #373)
<LI>

Fixed problem with ANSI mode and <CODE>GROUP BY</CODE> with constants. (Bug #387)
<LI>

Fixed bug with <CODE>UNION</CODE> and <CODE>OUTER JOIN</CODE>. (Bug #386)
<LI>

Fixed bug if one used a multiple-table <CODE>UPDATE</CODE> and the query required a
temporary table bigger than <CODE>tmp_table_size</CODE>. (Bug #286)
<LI>

Run <CODE>mysql_install_db</CODE> with the <CODE>-IN-RPM</CODE> option for the Mac OS X
installation to not fail on systems with improperly configured hostname
configurations.
<LI>

<CODE>LOAD DATA INFILE</CODE> will now read <CODE>000000</CODE> as a zero date instead as
<CODE>"2000-00-00"</CODE>.
<LI>

Fixed bug that caused <CODE>DELETE FROM table WHERE const_expression</CODE>
always to delete the whole table (even if expression result was false).
(Bug #355)
<LI>

Fixed core dump bug when using <CODE>FORMAT('nan',#)</CODE>. (Bug #284)
<LI>

Fixed name resolution bug with <CODE>HAVING ... COUNT(DISTINCT ...)</CODE>.
<LI>

Fixed incorrect result from truncation operator (<CODE>*</CODE>) in
<CODE>MATCH ... AGAINST()</CODE> in some complex joins.
<LI>

Fixed a crash in <CODE>REPAIR ... USE_FRM</CODE> command, when used on read-only,
nonexisting table or a table with a crashed index file.
<LI>

Fixed a crashing bug in <CODE>mysql</CODE> monitor program.  It occurred if
program was started with <CODE>--no-defaults</CODE>, with a prompt that contained
the hostname and a connection to a non-existent database was requested.
<LI>

Fixed problem when comparing a key for a multi-byte character set. (Bug #152)
<LI>

Fixed bug in <CODE>LEFT</CODE>, <CODE>RIGHT</CODE> and <CODE>MID</CODE> when used with
multi-byte character sets and some <CODE>GROUP BY</CODE> queries. (Bug #314)
<LI>

Fix problem with <CODE>ORDER BY</CODE> being discarded for some
<CODE>DISTINCT</CODE> queries. (Bug #275)
<LI>

Fixed that <CODE>SET SQL_BIG_SELECTS=1</CODE> works as documented (This corrects
a new bug introduced in 4.0)
<LI>

Fixed some serious bugs in <CODE>UPDATE ... ORDER BY</CODE>. (Bug #241)
<LI>

Fixed unlikely problem in optimizing <CODE>WHERE</CODE> clause with constant
expression like in <CODE>WHERE 1 AND (a=1 AND b=1)</CODE>.
<LI>

Fixed that <CODE>SET SQL_BIG_SELECTS=1</CODE> works again.
<LI>

Introduced proper backtick quoting for db.table in <CODE>SHOW GRANTS</CODE>.
<LI>

<CODE>FULLTEXT</CODE> index stopped working after <CODE>ALTER TABLE</CODE>
that converts <CODE>TEXT</CODE> column to <CODE>CHAR</CODE>. (Bug #283)
<LI>

Fixed a security problem with <CODE>SELECT</CODE> and wildcarded select list,
when user only had partial column <CODE>SELECT</CODE> privileges on the table.
<LI>

Mark a <CODE>MyISAM</CODE> table as "analyzed" only when all the keys are indeed
analyzed.
<LI>

Only ignore world-writable <TT>`my.cnf'</TT> files that are regular files
(and not, for example, named pipes or character devices).
<LI>

Fixed few smaller issues with <CODE>SET PASSWORD</CODE>.
<LI>

Fixed error message which contained deprecated text.
<LI>

Fixed a bug with two <CODE>NATURAL JOIN</CODE>s in the query.
<LI>

<CODE>SUM()</CODE> didn't return <CODE>NULL</CODE> when there was no rows in result
or when all values was <CODE>NULL</CODE>.
<LI>

On Unix symbolic links handling was not enabled by default and there was
no way to turn this on.
<LI>

Added missing dashes to parameter <CODE>--open-files-limit</CODE> in
<CODE>mysqld_safe</CODE>. (Bug #264)
<LI>

Fixed incorrect hostname for TCP/IP connections displayed in
<CODE>SHOW PROCESSLIST</CODE>.
<LI>

Fixed a bug with <CODE>NAN</CODE> in <CODE>FORMAT(...)</CODE> function ...
<LI>

Fixed a bug with improperly cached database privileges.
<LI>

Fixed a bug in <CODE>ALTER TABLE ENABLE / DISABLE KEYS</CODE> which failed to
force a refresh of table data in the cache.
<LI>

Fixed bugs in replication of <CODE>LOAD DATA INFILE</CODE> for custom parameters 
(<CODE>ENCLOSED</CODE>,  <CODE>TERMINATED</CODE> and so on) and temporary tables.
(Bug #183, Bug #222)
<LI>

Fixed a replication bug when the master is 3.23 and the slave 4.0: the
slave lost the replicated temporary tables if <CODE>FLUSH LOGS</CODE> was
issued on the master. (Bug #254)
<LI>

Fixed a bug when doing <CODE>LOAD DATA INFILE IGNORE</CODE>: When reading
the binary log, <CODE>mysqlbinlog</CODE> and the replication code read <CODE>REPLACE</CODE>
instead of <CODE>IGNORE</CODE>. This could make the slave's table
become different from the master's table. (Bug #218)
<LI>

Fixed a deadlock when <CODE>relay_log_space_limit</CODE> was set to a too
small value. (Bug #79)
<LI>

Fixed a bug in HAVING clause when an alias is used from the
<STRONG>select list</STRONG>. 
<LI>

Fixed overflow bug in <CODE>MyISAM</CODE> when a row is inserted into a table with a 
large number of columns and at least one <CODE>BLOB/TEXT</CODE> column. Bug was caused
by incorrect calculation of the needed buffer to pack data.
<LI>

Fixed a bug when <CODE>SELECT</CODE> <STRONG>@nonexistent_variable</STRONG> caused the
error in client - server protocol due to net_printf() being sent to
the client twice.
<LI>

Fixed a bug in setting <CODE>SQL_BIG_SELECTS</CODE> option.
<LI>

Fixed a bug in <CODE>SHOW PROCESSLIST</CODE> which only displayed a localhost
in the <CODE>"Host"</CODE> column. This was caused by a glitch that used only
current thread information instead of information from the linked list of threads.
<LI>

Removed unnecessary Mac OS X helper files from server RPM. (Bug #144)
<LI>

Allow optimization of multiple-table update for <CODE>InnoDB</CODE> tables as well.
<LI>

Fixed a bug in multiple-table updates that caused some rows to be
updated several times.
<LI>

Fixed a bug in <CODE>mysqldump</CODE> when it was called with
<CODE>--master-data</CODE>: the <CODE>CHANGE MASTER TO</CODE> commands appended to
the SQL dump had incorrect coordinates. (Bug #159)
<LI>

Fixed a bug when an updating query using <CODE>USER()</CODE> was replicated
on the slave; this caused segfault on the slave. (Bug #178).
<CODE>USER()</CODE> is still badly replicated on the slave (it is
replicated to <CODE>""</CODE>).
</UL>



<H3><A NAME="News-4.0.12" HREF="manual_toc.html#News-4.0.12">C.3.9  Changes in release 4.0.12 (15 Mar 2003: Production)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>mysqld</CODE> no longer reads options from world-writable config files.
<LI>

Integer values between 9223372036854775807 and 9999999999999999999 are now
regarded as unsigned longlongs, not as floats. This makes these values work
similar to values between 10000000000000000000 and 18446744073709551615.
<LI>

<CODE>SHOW PROCESSLIST</CODE> will now include the client TCP port after the
hostname to make it easier to know from which client the request
originated.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed <CODE>mysqld</CODE> crash on extremely small values of
<CODE>sort_buffer</CODE> variable.
<LI>

<CODE>INSERT INTO u SELECT ... FROM t</CODE> was written too late to the
binary log if t was very frequently updated during the execution of 
this query. This could cause a problem with <CODE>mysqlbinlog</CODE> or
replication. The master must be upgraded, not the slave. (Bug #136)
<LI>

Fixed checking of random part of <CODE>WHERE</CODE> clause. (Bug #142)
<LI>

Fixed a bug with multiple-table updates with <CODE>InnoDB</CODE>
tables. This bug occurred as, in many cases, <CODE>InnoDB</CODE> tables cannot
be updated ``on the fly,'' but offsets to the records have to be stored in
a temporary table. 
<LI>

Added missing file <CODE>mysql_secure_installation</CODE> to the <CODE>server</CODE>
RPM subpackage. (Bug #141)
<LI>

Fixed MySQL (and <CODE>myisamchk</CODE>) crash on artificially
corrupted <CODE>.MYI</CODE> files.
<LI>

Don't allow <CODE>BACKUP TABLE</CODE> to overwrite existing files.
<LI>

Fixed a bug with multiple-table <CODE>UPDATE</CODE> statements when user had all privileges
on the database where tables are located and there were any entries in
<CODE>tables_priv</CODE> table, that is, <CODE>grant_option</CODE> was true.
<LI>

Fixed a bug that allowed a user with table or column grants on some table,
<CODE>TRUNCATE</CODE> any table in the same database.
<LI>

Fixed deadlock when doing <CODE>LOCK TABLE</CODE> followed by <CODE>DROP
TABLE</CODE> in the same thread.  In this case one could still kill the thread
with <CODE>KILL</CODE>.
<LI>

<CODE>LOAD DATA LOCAL INFILE</CODE> was not properly written to the binary
log (hence not properly replicated). (Bug #82)
<LI>

<CODE>RAND()</CODE> entries were not read correctly by <CODE>mysqlbinlog</CODE> from
the binary log which caused problems when restoring a table that was
inserted with <CODE>RAND()</CODE>. <CODE>INSERT INTO t1 VALUES(RAND())</CODE>. In
replication this worked ok.
<LI>

<CODE>SET SQL_LOG_BIN=0</CODE> was ignored for <CODE>INSERT DELAYED</CODE>
queries. (Bug #104)
<LI>

<CODE>SHOW SLAVE STATUS</CODE> reported too old positions
(columns <CODE>Relay_Master_Log_File</CODE> and <CODE>Exec_Master_Log_Pos</CODE>)
for the last executed statement from the master, if this statement
was the <CODE>COMMIT</CODE> of a transaction. The master must be upgraded for that,
not the slave. (Bug #52)
<LI>

<CODE>LOAD DATA INFILE</CODE> was not replicated by the slave if
<CODE>replicate_*_table</CODE> was set on the slave. (Bug #86)
<LI>

After <CODE>RESET SLAVE</CODE>, the coordinates displayed by <CODE>SHOW
SLAVE STATUS</CODE> looked un-reset (although they were, but only
internally). (Bug #70)
<LI>

Fixed query cache invalidation on <CODE>LOAD DATA</CODE>.
<LI>

Fixed memory leak on <CODE>ANALYZE</CODE> procedure with error.
<LI>

Fixed a bug in handling <CODE>CHAR(0)</CODE> columns that could cause incorrect
results from the query.
<LI>

Fixed rare bug with incorrect initialization of <CODE>AUTO_INCREMENT</CODE> column,
as a secondary column in a multi-column key (see section <A HREF="manual.html#example-AUTO_INCREMENT">3.6.9  Using <CODE>AUTO_INCREMENT</CODE></A>), when
data was inserted with <CODE>INSERT ... SELECT</CODE> or <CODE>LOAD DATA</CODE> into
an empty table.
<LI>

On Windows, <CODE>STOP SLAVE</CODE> didn't stop the slave until the slave
got one new command from the master (this bug has been fixed for MySQL 4.0.11
by releasing updated 4.0.11a Windows packages, which include this individual
fix on top of the 4.0.11 sources). (Bug #69)
<LI>

Fixed a crash when no database was selected and <CODE>LOAD DATA</CODE> command
was issued with full table name specified, including database prefix.
<LI>

Fixed a crash when shutting down replication on some platforms
(for example, Mac OS X).
<LI>

Fixed a portability bug with <CODE>pthread_attr_getstacksize</CODE> on
HP-UX 10.20 (Patch was also included in 4.0.11a sources).
<LI>

Fixed the <CODE>bigint</CODE> test to not fail on some platforms (for example, HP-UX and
Tru64) due to different return values of the <CODE>atof()</CODE> function.
<LI>

Fixed the <CODE>rpl_rotate_logs</CODE> test to not fail on certain platforms (e.g.
Mac OS X) due to a too long file name (changed <CODE>slave-master-info.opt</CODE>
to <CODE>.slave-mi</CODE>).
</UL>



<H3><A NAME="News-4.0.11" HREF="manual_toc.html#News-4.0.11">C.3.10  Changes in release 4.0.11 (20 Feb 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>NULL</CODE> is now sorted <STRONG>LAST</STRONG> if you use <CODE>ORDER BY ... DESC</CODE>
(as it was before MySQL 4.0.2).  This change was required to comply
with the SQL standard.  (The original change was made because we thought
that standard SQL required <CODE>NULL</CODE> to be always sorted at the same position,
but this was incorrect).
<LI>

Added <CODE>START TRANSACTION</CODE> (standard SQL syntax) as alias for <CODE>BEGIN</CODE>.
This is recommended to use instead of <CODE>BEGIN</CODE> to start a transaction.
<LI>

Added <CODE>OLD_PASSWORD()</CODE> as a synonym for <CODE>PASSWORD()</CODE>.
<LI>

Allow keyword <CODE>ALL</CODE> in group functions.
<LI>

Added support for some new <CODE>INNER JOIN</CODE> and <CODE>JOIN</CODE> syntaxes.
For example, <CODE>SELECT * FROM t1 INNER JOIN t2</CODE> didn't work before.
<LI>

Novell NetWare 6.0 porting effort completed, Novell patches merged into
the main source tree.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed problem with multiple-table delete and <CODE>InnoDB</CODE> tables.
<LI>

Fixed a problem with <CODE>BLOB NOT NULL</CODE> columns used with <CODE>IS NULL</CODE>.
<LI>

Re-added missing pre- and post(un)install scripts to the Linux RPM packages
(they were missing after the renaming of the server subpackage).
<LI>

Fixed that table locks are not released with multiple-table updates and 
deletes with <CODE>InnoDB</CODE> storage engine.
<LI>

Fixed bug in updating <CODE>BLOB</CODE> columns with long strings.
<LI>

Fixed integer-wraparound when giving big integer (&#62;= 10 digits) to
function that requires an unsigned argument, like <CODE>CREATE TABLE (...) 
AUTO_INCREMENT=#</CODE>.
<LI>

<CODE>MIN(key_column)</CODE> could in some cases return <CODE>NULL</CODE> on a column
with <CODE>NULL</CODE> and other values.
<LI>

<CODE>MIN(key_column)</CODE> and <CODE>MAX(key_column)</CODE> could in some cases
return incorrect values when used in <CODE>OUTER JOIN</CODE>.
<LI>

<CODE>MIN(key_column)</CODE> and <CODE>MAX(key_column)</CODE> could return incorrect
values if one of the tables was empty.
<LI>

Fixed rare crash in compressed <CODE>MyISAM</CODE> tables with blobs.
<LI>

Fixed bug in using aggregate functions as argument for <CODE>INTERVAL</CODE>,
<CODE>CASE</CODE>, <CODE>FIELD</CODE>, <CODE>CONCAT_WS</CODE>, <CODE>ELT</CODE> and
<CODE>MAKE_SET</CODE> functions.
<LI>

When running with <CODE>--lower-case-table-names</CODE> (default on Windows)
and you had tables or databases with mixed case on disk, then
executing <CODE>SHOW TABLE STATUS</CODE> followed with <CODE>DROP DATABASE</CODE>
or <CODE>DROP TABLE</CODE> could fail with <CODE>Errcode 13</CODE>.
</UL>



<H3><A NAME="News-4.0.10" HREF="manual_toc.html#News-4.0.10">C.3.11  Changes in release 4.0.10 (29 Jan 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Added option <CODE>--log-error[=file_name]</CODE> to <CODE>mysqld_safe</CODE> and
<CODE>mysqld</CODE>. This option will force all error messages to be put in a
log file if the option <CODE>--console</CODE> is not given. On Windows
<CODE>--log-error</CODE> is enabled as default, with a default name of
<CODE>host_name.err</CODE> if the name is not specified.
<LI>

Changed some things from <CODE>Warning:</CODE> to <CODE>Note:</CODE> in the log files.
<LI>

The <CODE>mysqld</CODE> server should now compile on NetWare.
<LI>

Added optimization that if one does <CODE>GROUP BY ... ORDER BY NULL</CODE>
then result is not sorted.
<LI>

New <CODE>--ft-stopword-file</CODE> command-line option for <CODE>mysqld</CODE> to
replace/disable the built-in stopword list that is used in full-text searches.
See section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>.
<LI>

Changed default stack size from 64KB to 192KB; This fixes a core dump
problem on Red Hat 8.0 and other systems with a <CODE>glibc</CODE> that requires a
stack size larger than 128K
for <CODE>gethostbyaddr()</CODE> to resolve a hostname. You can fix
this for earlier MySQL versions by starting <CODE>mysqld</CODE> with
<CODE>--thread-stack=192K</CODE>.
<LI>

Added <CODE>mysql_waitpid</CODE> to the binary distribution and the
<CODE>MySQL-client</CODE> RPM subpackage (required for <CODE>mysql-test-run</CODE>).
<LI>

Renamed the main <CODE>MySQL</CODE> RPM package to <CODE>MySQL-server</CODE>. When
updating from an older version, <CODE>MySQL-server.rpm</CODE> will simply replace
<CODE>MySQL.rpm</CODE>.
<LI>

If a slave is configured with <CODE>replicate_wild_do_table=db.%</CODE> or
<CODE>replicate_wild_ignore_table=db.%</CODE>, these rules will be applied to
<CODE>CREATE/DROP DATABASE</CODE>, too.
<LI>

Added timeout value for <CODE>MASTER_POS_WAIT()</CODE>.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed initialization of the random seed for newly created threads to
give a better <CODE>rand()</CODE> distribution from the first call.
<LI>

Fixed a bug that caused <CODE>mysqld</CODE> to hang when a
table was opened with the <CODE>HANDLER</CODE> command and then
dropped without being closed.
<LI>

Fixed bug in logging to binary log (which affects replication) a query
that inserts a <CODE>NULL</CODE> in an <CODE>AUTO_INCREMENT</CODE> column and also
uses <CODE>LAST_INSERT_ID()</CODE>.
<LI>

Fixed an unlikely bug that could cause a memory overrun when using
<CODE>ORDER BY constant_expression</CODE>.
<LI>

Fixed a table corruption in <CODE>myisamchk</CODE> parallel repair mode.
<LI>

Fixed bug in query cache invalidation on simple table renaming.
<LI>

Fixed bug in <CODE>mysqladmin --relative</CODE>.
<LI>

On some 64-bit systems, <CODE>show status</CODE> reported a strange number for
<CODE>Open_files</CODE> and <CODE>Open_streams</CODE>.
<LI>

Fixed incorrect number of columns in <CODE>EXPLAIN</CODE> on empty table.
<LI>

Fixed bug in <CODE>LEFT JOIN</CODE> that caused zero rows to be returned in
the case the <CODE>WHERE</CODE> condition was evaluated as <CODE>FALSE</CODE> after
reading <CODE>const</CODE> tables. (Unlikely condition).
<LI>

<CODE>FLUSH PRIVILEGES</CODE> didn't correctly flush table/column privileges
when <CODE>mysql.tables_priv</CODE> is empty.
<LI>

Fixed bug in replication when using <CODE>LOAD DATA INFILE</CODE> one a file
that updated an <CODE>AUTO_INCREMENT</CODE> column with <CODE>NULL</CODE> or <CODE>0</CODE>. This
bug only affected MySQL 4.0 masters (not slaves or MySQL 3.23 masters).
<STRONG>Note:</STRONG> If you have a slave that has replicated a file with
generated <CODE>AUTO_INCREMENT</CODE> columns then the slave data is corrupted and you
should reinitialize the affected tables from the master.
<LI>

Fixed possible memory overrun when sending a <CODE>BLOB</CODE> value larger than 16M
to the client.
<LI>

Fixed incorrect error message when setting a <CODE>NOT NULL</CODE> column to an
expression that returned <CODE>NULL</CODE>.
<LI>

Fixed core dump bug in <CODE>str LIKE "%other_str%"</CODE> where <CODE>str</CODE> or
<CODE>other_str</CODE> contained characters &#62;= 128.
<LI>

Fixed bug: When executing on master <CODE>LOAD DATA</CODE> and <CODE>InnoDB</CODE> failed
with <CODE>table full</CODE> error the binary log was corrupted.
</UL>



<H3><A NAME="News-4.0.9" HREF="manual_toc.html#News-4.0.9">C.3.12  Changes in release 4.0.9 (09 Jan 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>OPTIMIZE TABLE</CODE> will for <CODE>MyISAM</CODE> tables treat all <CODE>NULL</CODE>
values as different when calculating cardinality.  This helps in
optimizing joins between tables where one of the tables has a lot of
<CODE>NULL</CODE> values in a indexed column:

<PRE>
SELECT * from t1,t2 where t1.a=t2.key_with_a_lot_of_null;
</PRE>

<LI>

Added join operator <CODE>FORCE INDEX (key_list)</CODE>. This acts likes
<CODE>USE INDEX (key_list)</CODE> but with the addition that a table scan is
assumed to be VERY expensive.  One bad thing with this is that it makes
<CODE>FORCE</CODE> a reserved word.
<LI>

Reset internal row buffer in <CODE>MyISAM</CODE> after each query. This will reduce
memory in the case you have a lot of big blobs in a table.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

A security patch in 4.0.8 causes the <CODE>mysqld</CODE> server to die if the remote
hostname can't be resolved. This is now fixed.
<LI>

Fixed crash when replication big <CODE>LOAD DATA INFILE</CODE> statement that
caused log rotation.
</UL>



<H3><A NAME="News-4.0.8" HREF="manual_toc.html#News-4.0.8">C.3.13  Changes in release 4.0.8 (07 Jan 2003)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

Default <CODE>max_packet_length</CODE> for libmysqld.c is now 1024*1024*1024.
<LI>

You can now specify <CODE>max_allowed_packet</CODE> in a file read by
<CODE>mysql_options(MYSQL_READ_DEFAULT_FILE)</CODE>.
for clients.
<LI>

When sending a too big packet to the server with the not compressed
protocol, the client now gets an error message instead of a lost
connection.
<LI>

We now send big queries/result rows in bigger hunks, which should give a
small speed improvement.
<LI>

Fixed some bugs with the compressed protocol for rows &#62; 16MB.
<LI>

<CODE>InnoDB</CODE> tables now also support <CODE>ON UPDATE CASCADE</CODE> in
<CODE>FOREIGN KEY</CODE> constraints. See the <CODE>InnoDB</CODE> section in the manual
for the <CODE>InnoDB</CODE> changelog.
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> with <CODE>BDB</CODE> tables.
<LI>

Fixed core dump bug in <CODE>QUOTE()</CODE> function.
<LI>

Fixed a bug in handling communication packets bigger than
16MB. Unfortunately this required a protocol change; If you upgrade the
server to 4.0.8 and above and have clients that uses packets &#62;=
255*255*255 bytes (=16581375) you must also upgrade your clients to at
least 4.0.8.  If you don't upgrade, the clients will hang when sending a
big packet.
<LI>

Fixed bug when sending blobs longer than 16MB to client.
<LI>

Fixed bug in <CODE>GROUP BY</CODE> when used on BLOB column with <CODE>NULL</CODE> values.
<LI>

Fixed a bug in handling <CODE>NULL</CODE> values in <CODE>CASE</CODE> ... WHEN ...
</UL>



<H3><A NAME="News-4.0.7" HREF="manual_toc.html#News-4.0.7">C.3.14  Changes in release 4.0.7 (20 Dec 2002)</A></H3>

<P>
Functionality added or changed:

<UL>
<LI>

<CODE>mysqlbug</CODE> now also reports the compiler version used for building
the binaries (if the compiler supports the option <CODE>--version</CODE>).
</UL>

<P>
Bugs fixed:

<UL>
<LI>

Fixed compilation problems on OpenUnix and HPUX 10.20.
<LI>

Fixed some optimization problems when compiling MySQL with <CODE>-DBIG_TABLES</CODE>
on a 32-bit system.
<LI>

<CODE>mysql_drop_db()</CODE> didn't check permissions properly so anyone could
drop another users database.  <CODE>DROP DATABASE</CODE> is checked properly.
</UL>



<H3><A NAME="News-4.0.6" HREF="manual_toc.html#News-4.0.6">C.3.15  Changes in release 4.0.6 (14 Dec 2002: Gamma)</A></H3>

<P>
Functionality added or changed:

</P>

<UL>
<LI>

Added syntax support for <CODE>CHARACTER SET xxx</CODE> and <CODE>CHARSET=xxx</CODE>
table options (to be able to read table dumps from 4.1).
<LI>

Fixed replication bug that caused the slave to loose its position in
some cases when the replication log was rotated.
<LI>

Fixed that a slave will restart from the start of a transaction if
it's killed in the middle of one.
<LI>

Moved the manual pages from <TT>`man'</TT> to <TT>`man/man1'</TT> in the
binary distributions.
<LI>

The default type returned by <CODE>IFNULL(A,B)</CODE> is now set to be the
more 'general' of the types of <CODE>A</CODE> and <CODE>B</CODE>. (The order is
<CODE>STRING</CODE>, <CODE>REAL</CODE> or <CODE>INTEGER</CODE>).
<LI>

Moved the <CODE>mysql.server</CODE> startup script in the RPM packages from
<TT>`/etc/rc.d/init.d/mysql'</TT> to <TT>`/etc/init.d/mysql'</TT>
(which almost all current Linux distributions support for LSB compliance).
<LI>

Added <CODE>Qcache_lowmem_prunes</CODE> status variable (number of queries that were
deleted from cache because of low memory).
<LI>

Fixed <CODE>mysqlcheck</CODE> so it can deal with table names containing dashes.
<LI>

Bulk insert optimization
(see section <A HREF="manual.html#Server_system_variables">5.2.3  Server System Variables</A>)
is no longer used when inserting small (less than 100) number of rows.
<LI>

Optimization added for queries like
<CODE>SELECT ... FROM merge_table WHERE indexed_column=constant_expr</CODE>.
<LI>

Added functions <CODE>LOCALTIME</CODE> and <CODE>LOCALTIMESTAMP</CODE> as synonyms for
<CODE>NOW()</CODE>.
<LI>

<CODE>CEIL</CODE> is now an alias for <CODE>CEILING</CODE>.
<LI>

The <CODE>CURRENT_USER()</CODE> function can be used to get a <CODE>user@host</CODE>
value as it was matched in the <CODE>GRANT</CODE> system.
See section <A HREF="manual.html#Information_functions">13.8.3  Information Functions</A>.
<LI>

Fixed <CODE>CHECK</CODE> constraints to be compatible with standard SQL. This made
<CODE>CHECK</CODE> a reserved word. (Checking of <CODE>CHECK</CODE> constraints is
still not implemented).
<LI>

Added <CODE>CAST(... as CHAR)</CODE>.
<LI>

Added PostgreSQL compatible <CODE>LIMIT</CODE> syntax:
<CODE>SELECT ... LIMIT row_count OFFSET offset</CODE>
<LI>

<CODE>mysql_change_user()</CODE> will now reset the connection to the state
of a fresh connect (Ie, <CODE>ROLLBACK</CODE> any active transaction, close
all temporary tables, reset all user variables etc..)
<LI>

<CODE>CHANGE MASTER</CODE> and <CODE>RESET SLAVE</CODE> now require that slave
threads be both already stopped; these commands will return an error
if at least one of these two threads is running.
</UL>

<P>
Bugs fixed:

</P>

<UL>
<LI>

Fixed number of found rows returned in <CODE>multi table updates</CODE>
<LI>

Make <CODE>--lower-case-table-names</CODE> default on Mac OS X as the default
filesystem (HFS+) is case insensitive.
See section <A HREF="manual.html#Name_case_sensitivity">10.2.2  Identifier Case Sensitivity</A>.
<LI>

Transactions in <CODE>AUTOCOMMIT=0</CODE> mode didn't rotate binary log.
<LI>

A fix for the bug in a <CODE>SELECT</CODE> with joined tables with
<CODE>ORDER BY</CODE> and <CODE>LIMIT</CODE> clause when filesort had to be used.
In that case <CODE>LIMIT</CODE> was applied to filesort of one of the tables,
although it could not be.
This fix also solved problems with <CODE>LEFT JOIN</CODE>.
<LI>

<CODE>mysql_server_init()</CODE> now makes a copy of all arguments. This fixes
a problem when using the embedded server in C# program.
<LI>

Fixed buffer overrun in <CODE>libmysqlclient</CODE> library
that allowed a malicious MySQL server to crash the client
application.
<LI>

Fixed security-related bug in <CODE>mysql_change_user()</CODE> handling.
All users are strongly recommended to upgrade to version 4.0.6.
<LI>

Fixed bug that prevented <CODE>--chroot</CODE> command-line option of
<CODE>mysqld</CODE> from working.
<LI>

Fixed bug in phrase operator <CODE>"..."</CODE> in boolean full-text search.
<LI>

Fixed bug that caused <CODE>OPTIMIZE TABLE</CODE> to corrupt the table
under some rare circumstances.
<LI>

Part rewrite of multiple-table-update to optimize it, make it safer and
more bug-free.
<LI>

<CODE>LOCK TABLES</CODE> now works together with multiple-table-update and
multiple-table-delete.
<LI>

<CODE>--replicate-do=xxx</CODE> didn't work for <CODE>UPDATE</CODE> commands.
(Bug introduced in 4.0.0)
<LI>

Fixed shutdown problem on Mac OS X.
<LI>Major <CODE>InnoDB</CODE> bugs in <CODE>REPLACE, AUTO_INCREMENT,

INSERT INTO ... SELECT ...</CODE> were fixed. See the <CODE>InnoDB</CODE> changelog
in the <CODE>InnoDB</CODE> section of the manual.
<LI>

<CODE>RESET SLAVE</CODE> caused a crash if the slave threads were running.
</UL>



<H3><A NAME="News-4.0.5" HREF="manual_toc.html#News-4.0.5">C.3.16  Changes in release 4.0.5 (13 Nov 2002)</A></H3>

<P>
Functionality added or changed:

</P>

<UL>
<LI>

Port number was added to hostname (if it is known) in <CODE>SHOW PROCESSLIST</CODE>
command
<LI>

Changed handling of last argument in <CODE>WEEK()</CODE> so that you can get
week number according to the ISO 8601 specification.
(Old code should still work).
<LI>

Fixed that <CODE>INSERT DELAYED</CODE> threads don't hang on <CODE>Waiting for
INSERT</CODE> when one sends a <CODE>SIGHUP</CODE> to <CODE>mysqld</CODE>.
<LI>

Change that <CODE>AND</CODE> works according to standard SQL when it comes to
<CODE>NULL</CODE> handling. In practice, this affects only queries where you
do something like <CODE>WHERE ... NOT (NULL AND 0)</CODE>.
<LI>

<CODE>mysqld</CODE> will now resolve <CODE>basedir</CODE> to its full path (with
<CODE>realpath()</CODE>). This enables one to use relative symlinks to the
MySQL installation directory.  This will however cause <CODE>show
variables</CODE> to report different directories on systems where there is
a symbolic link in the path.
<LI>

Fixed that MySQL will not use index scan on index disabled with
<CODE>IGNORE INDEX</CODE> or <CODE>USE INDEX</CODE>.
to be ignored.
<LI>

Added <CODE>--use-frm</CODE> option to <CODE>mysqlcheck</CODE>. When used with
<CODE>REPAIR TABLE</CODE>, it gets the table structure from the <CODE>.frm</CODE> file, so the
table can be repaired even if the <CODE>.MYI</CODE> header is corrupted.
<LI>

Fixed bug in <CODE>MAX()</CODE> optimization when used with <CODE>JOIN</CODE> and
<CODE>ON</CODE> expressions.
<LI>

Added support for reading of MySQL 4.1 table definition files.
<LI>

<CODE>BETWEEN</CODE> behavior changed (see section <A HREF="manual.html#Comparison_Operators">13.1.2  Comparison Operators</A>).
Now <CODE>datetime_col BETWEEN timestamp AND timestamp</CODE> should work
as expected.
<LI>

One can create <CODE>TEMPORARY</CODE> <CODE>MERGE</CODE> tables now.
<LI>

<CODE>DELETE FROM myisam_table</CODE> now shrinks not only the <TT>`.MYD'</TT> file but
also the <TT>`.MYI'</TT> file.
<LI>

When one uses the <CODE>--open-files-limit=#</CODE> option to <CODE>mysqld_safe</CODE>
it's now passed on to <CODE>mysqld</CODE>.
<LI>

Changed output from <CODE>EXPLAIN</CODE> from <CODE>'where used'</CODE> to
<CODE>'Using where'</CODE> to make it more in line with other output.
<LI>

Removed variable <CODE>safe_show_database</CODE> as it was no longer used.
<LI>

Updated source tree to be built using <CODE>automake 1.5</CODE> and 
<CODE>libtool 1.4</CODE>.
<LI>

Fixed an inadvertently changed option (<CODE>--ignore-space</CODE>) back to the
original <CODE>--ignore-spaces</CODE> in <CODE>mysqlclient</CODE>. (Both syntaxes will
work).
<LI>

Don't require <CODE>UPDATE</CODE> privilege when using <CODE>REPLACE</CODE>.
<LI>

Added support for <CODE>DROP TEMPORARY TABLE ...</CODE>, to be used to make
replication safer.
<LI>

When transactions are enabled, all commands that update temporary tables
inside a <CODE>BEGIN/COMMIT</CODE> are now stored in the binary log on
<CODE>COMMIT</CODE> and not stored if one does <CODE>ROLLBACK</CODE>.  This fixes
some problems with non-transactional temporary tables used inside
transactions.
<LI>

Allow braces in joins in all positions. Formerly, things like
<CODE>SELECT * FROM (t2 LEFT JOIN t3 USING (a)), t1</CODE> worked, but
not <CODE>SELECT * FROM t1, (t2 LEFT JOIN t3 USING (a))</CODE>. Note that
braces are simply removed, they do not change the way the join is
executed.
<LI>

<CODE>InnoDB</CODE> now supports also isolation levels
<CODE>READ UNCOMMITTED</CODE> and <CODE>READ COMMITTED</CODE>.
For a detailed <CODE>InnoDB</CODE> changelog, see section <A HREF="manual.html#InnoDB_change_history">C.9  <CODE>InnoDB</CODE> Change History</A>
in this manual. 
</UL>

<P>
Bugs fixed:

</P>

<UL>
<LI>

Fixed bug in <CODE>MAX()</CODE> optimization when used with <CODE>JOIN</CODE> and
<CODE>ON</CODE> expressions.
<LI>

Fixed that <CODE>INSERT DELAY</CODE> threads don't hang on <CODE>Waiting for
INSERT</CODE> when one sends a <CODE>SIGHUP</CODE> to <CODE>mysqld</CODE>.
<LI>

Fixed that MySQL will not use an index scan on an index that has been
disabled with <CODE>IGNORE INDEX</CODE> or <CODE>USE INDEX</CODE>.
<LI>

Corrected test for <CODE>root</CODE> user in <CODE>mysqld_safe</CODE>.
<LI>

Fixed error message issued when storage engine cannot do <CODE>CHECK TABLE</CODE>
or <CODE>REPAIR TABLE</CODE>.
<LI>

Fixed rare core dump problem in complicated <CODE>GROUP BY</CODE> queries that
didn't return any result.
<LI>

Fixed <CODE>mysqlshow</CODE> to work properly with wildcarded database names and
with database names that contain underscores.
<LI>

Portability fixes to get MySQL to compile cleanly with Sun Forte 5.0.
<LI>

Fixed <CODE>MyISAM</CODE> crash when using dynamic-row tables with huge numbers of
packed columns.
<LI>

Fixed query cache behavior with <CODE>BDB</CODE> transactions.
<LI>

Fixed possible floating point exception in <CODE>MATCH</CODE>
relevance calculations.
<LI>

Fixed bug in full-text search <CODE>IN BOOLEAN MODE</CODE> that made <CODE>MATCH</CODE>
to return incorrect relevance value in some complex joins.
<LI>

Fixed a bug that limited <CODE>MyISAM</CODE> key length to a value
slightly less that 500. It is exactly 500 now.
<LI>

Fixed that <CODE>GROUP BY</CODE> on columns that may have a <CODE>NULL</CODE> value
doesn't always use disk based temporary tables.
<LI>

The filename argument for the <CODE>--des-key-file</CODE> argument to <CODE>mysqld</CODE>
is interpreted relative to the data directory if given as a relative pathname.
<LI>

Removed a condition that temp table with index on column that can be
<CODE>NULL</CODE> has to be <CODE>MyISAM</CODE>. This was okay for 3.23, but not
needed in 4.*. This resulted in slowdown in many queries since 4.0.2.
<LI>

Small code improvement in multiple-table updates.
<LI>

Fixed a newly introduced bug that caused <CODE>ORDER BY ... LIMIT row_count</CODE>
to not return all rows.
<LI>

Fixed a bug in multiple-table deletes when outer join is used on an empty
table, which gets first to be deleted.
<LI>

Fixed a bug in multiple-table updates when a single table is updated.
<LI>

Fixed bug that caused <CODE>REPAIR TABLE</CODE> and <CODE>myisamchk</CODE>
to corrupt <CODE>FULLTEXT</CODE> indexes.
<LI>

Fixed bug with caching the <CODE>mysql</CODE> grant table database. Now queries
in this database are not cached in the query cache.
<LI>

Small fix in <CODE>mysqld_safe</CODE> for some shells.
<LI>

Give error if a <CODE>MyISAM</CODE> <CODE>MERGE</CODE> table has more than 2 ^ 32 rows and
MySQL was not compiled with <CODE>-DBIG_TABLES</CODE>.
<LI>

Fixed some <CODE>ORDER BY ... DESC</CODE> problems with <CODE>InnoDB</CODE> tables.
</UL>



<H3><A NAME="News-4.0.4" HREF="manual_toc.html#News-4.0.4">C.3.17  Changes in release 4.0.4 (29 Sep 2002)</A></H3>


<UL>
<LI>

Fixed bug where <CODE>GRANT</CODE>/<CODE>REVOKE</CODE> failed if hostname was given in
non-matching case.
<LI>

Don't give warning in <CODE>LOAD DATA INFILE</CODE> when setting a
<CODE>timestamp</CODE> to a string value of <CODE>'0'</CODE>.
<LI>

Fixed bug in <CODE>myisamchk -R</CODE> mode.
<LI>

Fixed bug that caused <CODE>mysqld</CODE> to crash on <CODE>REVOKE</CODE>.
<LI>

Fixed bug in <CODE>ORDER BY</CODE> when there is a constant in the <CODE>SELECT</CODE>
statement.
<LI>

One didn't get an error message if <CODE>mysqld</CODE> couldn't open the
privilege tables.
<LI>

<CODE>SET PASSWORD FOR ...</CODE> closed the connection in case of errors (bug
from 4.0.3).
<LI>

Increased maximum possible <CODE>max_allowed_packet</CODE> in <CODE>mysqld</CODE> to 1GB.
<LI>

Fixed bug when doing a multiple-row <CODE>INSERT</CODE> on a table with an
<CODE>AUTO_INCREMENT</CODE> key which was not in the first part of the key.
<LI>

Changed <CODE>LOAD DATA INFILE</CODE> to not re-create index if the table had
rows from before.
<LI>

Fixed overrun bug when calling <CODE>AES_DECRYPT()</CODE> with incorrect arguments.
<LI>

<CODE>--skip-ssl</CODE> can now be used to disable SSL in the MySQL clients,
even if one is using other SSL options in an option file or previously
on the command line.
<LI>

Fixed bug in <CODE>MATCH ... AGAINST( ... IN BOOLEAN MODE)</CODE>
used with <CODE>ORDER BY</CODE>.
<LI>

Added <CODE>LOCK TABLES</CODE> and <CODE>CREATE TEMPORARY TABLES</CODE> privilege on
the database level.  You must run the <CODE>mysql_fix_privilege_tables</CODE>
script on old installations to activate these.
<LI>

In <CODE>SHOW TABLE ... STATUS</CODE>, compressed tables sometimes showed up as
<CODE>dynamic</CODE>.
<LI>

<CODE>SELECT @@[global|session].var_name</CODE> didn't report
<CODE>global | session</CODE> in the result column name.
<LI>

Fixed problem in replication that <CODE>FLUSH LOGS</CODE> in a circular
replication setup created an infinite number of binary log files.
Now a <CODE>rotate-binary-log</CODE> command in the binary log will not cause slaves
to rotate logs.
<LI>

Removed <CODE>STOP EVENT</CODE> from binary log when doing <CODE>FLUSH LOGS</CODE>.
<LI>

Disable the use of <CODE>SHOW NEW MASTER FOR SLAVE</CODE> as this needs to be
completely reworked in a future release.
<LI>

Fixed a bug with constant expression (for example, column of a one-row table,
or column
from a table, referenced by a <CODE>UNIQUE</CODE> key) appeared in <CODE>ORDER BY</CODE>
part of <CODE>SELECT DISTINCT</CODE>.
<LI>

<CODE>--log-binary=a.b.c</CODE> now properly strips off <CODE>.b.c</CODE>.
<LI>

<CODE>FLUSH LOGS</CODE> removed numerical extension for all future update logs.
<LI>

<CODE>GRANT ... REQUIRE</CODE> didn't store the SSL information in the
<CODE>mysql.user</CODE> table if SSL was not enabled in the server.
<LI>

<CODE>GRANT ... REQUIRE NONE</CODE> can now be used to remove SSL information.
<LI>

<CODE>AND</CODE> is now optional between <CODE>REQUIRE</CODE> options.
<LI>

<CODE>REQUIRE</CODE> option was not properly saved, which could cause strange
output in <CODE>SHOW GRANTS</CODE>.
<LI>

Fixed that <CODE>mysqld --help</CODE> reports correct values for <CODE>--datadir</CODE>
and <CODE>--bind-address</CODE>.
<LI>

Fixed that one can drop UDFs that didn't exist when <CODE>mysqld</CODE> was started.
<LI>

Fixed core dump problem with <CODE>SHOW VARIABLES</CODE> on some 64-bit systems
(like Solaris SPARC).
<LI>

Fixed a bug in <CODE>my_getopt()</CODE>; <CODE>--set-variable</CODE> syntax didn't work for
those options that didn't have a valid variable in the <CODE>my_option</CODE> struct.
This affected at least the <CODE>default-table-type</CODE> option.
<LI>

Fixed a bug from 4.0.2 that caused <CODE>REPAIR TABLE</CODE> and
<CODE>myisamchk --recover</CODE> to fail on tables with duplicates in a unique
key.
<LI>

Fixed a bug from 4.0.3 in calculating the default data type for some
functions. This affected queries of type <CODE>CREATE TABLE tbl_name
SELECT expression(),...</CODE>
<LI>

Fixed bug in queries of type
<CODE>SELECT * FROM table-list GROUP BY ...</CODE> and
<CODE>SELECT DISTINCT * FROM ...</CODE>.
<LI>

Fixed bug with the <CODE>--slow-log</CODE> when logging an administrator command
(like <CODE>FLUSH TABLES</CODE>).
<LI>

Fixed a bug that <CODE>OPTIMIZE TABLE</CODE> of locked and modified table,
reported table corruption.
<LI>

Fixed a bug in <CODE>my_getopt()</CODE> in handling of special prefixes
(<CODE>--skip-</CODE>, <CODE>--enable-</CODE>). <CODE>--skip-external-locking</CODE> didn't
work and the bug may have affected other similar options.
<LI>

Fixed bug in checking for output file name of the <CODE>tee</CODE> option.
<LI>

Added some more optimization to use index for
<CODE>SELECT ... FROM many_tables .. ORDER BY key limit #</CODE>
<LI>

Fixed problem in <CODE>SHOW OPEN TABLES</CODE> when a user didn't have access
permissions to one of the opened tables.
</UL>



<H3><A NAME="News-4.0.3" HREF="manual_toc.html#News-4.0.3">C.3.18  Changes in release 4.0.3 (26 Aug 2002: Beta)</A></H3>


<UL>
<LI>

Fixed problem with types of user variables. (Bug #551)
<LI>

Fixed problem with <CODE>configure ... --localstatedir=...</CODE>.
<LI>

Cleaned up <CODE>mysql.server</CODE> script.
<LI>

Fixed a bug in <CODE>mysqladmin shutdown</CODE> when pid file was modified
while <CODE>mysqladmin</CODE> was still waiting for the previous one to
disappear. This could happen during a very quick restart and caused
<CODE>mysqladmin</CODE> to hang until <CODE>shutdown_timeout</CODE> seconds had
passed.
<LI>

Don't increment warnings when setting <CODE>AUTO_INCREMENT</CODE> columns to
<CODE>NULL</CODE> in <CODE>LOAD DATA INFILE</CODE>.
<LI>

Fixed all boolean type variables/options to work with the old syntax,
for example, all of these work: <CODE>--lower-case-table-names</CODE>,
<CODE>--lower-case-table-names=1</CODE>,
<CODE>-O lower-case-table-names=1</CODE>,
<CODE>--set-variable=lower-case-table-names=1</CODE>
<LI>

Fixed shutdown problem (SIGTERM signal handling) on Solaris. (Bug from 4.0.2).
<LI>

<CODE>SHOW MASTER STATUS</CODE> now returns an empty set if binary log is not
enabled.
<LI>

<CODE>SHOW SLAVE STATUS</CODE> now returns an empty set if slave is not initialized.
<LI>

Don't update <CODE>MyISAM</CODE> index file on update if not strictly necessary.
<LI>

Fixed bug in <CODE>SELECT DISTINCT ... FROM many_tables ORDER BY
not-used-column</CODE>.
<LI>

Fixed a bug with <CODE>BIGINT</CODE> values and quoted strings.
<LI>

Added <CODE>QUOTE()</CODE> function that performs SQL quoting to produce values
that can be used as data values in queries.
<LI>

Changed variable <CODE>DELAY_KEY_WRITE</CODE> to an enumeration to allow it to be
set for all tables without taking down the server.
<LI>

Changed behavior of <CODE>IF(condition,column,NULL)</CODE> so that it returns
the value of the column type.
<LI>

Made <CODE>safe_mysqld</CODE> a symlink to <CODE>mysqld_safe</CODE> in binary distribution.
<LI>

Fixed security bug when having an empty database name in the <CODE>user.db</CODE>
table.
<LI>

Fixed some problems with <CODE>CREATE TABLE ... SELECT function()</CODE>.
<LI>

<CODE>mysqld</CODE> now has the option <CODE>--temp-pool</CODE> enabled by default as this
gives better performance with some operating systems.
<LI>

Fixed problem with too many allocated alarms on slave when connecting to
master many times (normally not a very critical error).
<LI>

Fixed hang in <CODE>CHANGE MASTER TO</CODE> if the slave thread died very quickly.
<LI>

Big cleanup in replication code (less logging, better error messages, etc..)
<LI>

If the <CODE>--code-file</CODE> option is specified, the server calls
<CODE>setrlimit()</CODE> to set the maximum allowed core file size to unlimited,
so core files can be generated.
<LI>

Fixed bug in query cache after temporary table creation.
<LI>

Added <CODE>--count=N</CODE> (<CODE>-c</CODE>) option to <CODE>mysqladmin</CODE>, to make the
program do only <CODE>N</CODE> iterations. To be used with <CODE>--sleep</CODE> (<CODE>-i</CODE>).
Useful in scripts.
<LI>

Fixed bug in multiple-table <CODE>UPDATE</CODE>: when updating a table,
<CODE>do_select()</CODE> became confused about reading records from a cache.
<LI>

Fixed bug in multiple-table <CODE>UPDATE</CODE> when several columns were referenced
from a single table
<LI>

Fixed bug in truncating nonexisting table.
<LI>

Fixed bug in <CODE>REVOKE</CODE> that caused user resources to be randomly set.
<LI>

Fixed bug in <CODE>GRANT</CODE> for the new <CODE>CREATE TEMPORARY TABLE</CODE> privilege.
<LI>

Fixed bug in multiple-table <CODE>DELETE</CODE> when tables are re-ordered in the
table initialization method and ref_lengths are of different sizes.
<LI>

Fixed two bugs in <CODE>SELECT DISTINCT</CODE> with large tables.
<LI>

Fixed bug in query cache initialization with very small query cache size.
<LI>

Allow <CODE>DEFAULT</CODE> with <CODE>INSERT</CODE> statement.
<LI>

The startup parameters <CODE>myisam_max_sort_file_size</CODE> and
<CODE>myisam_max_extra_sort_file_size</CODE> are now given in bytes, not megabytes.
<LI>

External system locking of <CODE>MyISAM</CODE>/<CODE>ISAM</CODE> files is now turned
off by default.  One can turn this on with <CODE>--external-locking</CODE>.
(For most users this is never needed).
<LI>

Fixed core dump bug with <CODE>INSERT ... SET db_name.tbl_name.col_name=''</CODE>.
<LI>

Fixed client hangup bug when using some SQL commands with incorrect syntax.
<LI>

Fixed a timing bug in <CODE>DROP DATABASE</CODE>
<LI>

New <CODE>SET [GLOBAL | SESSION]</CODE> syntax to change thread-specific and global
server variables at runtime.
<LI>

Added variable <CODE>slave_compressed_protocol</CODE>.
<LI>

Renamed variable <CODE>query_cache_startup_type</CODE> to <CODE>query_cache_type</CODE>,
<CODE>myisam_bulk_insert_tree_size</CODE> to <CODE>bulk_insert_buffer_size</CODE>,
<CODE>record_buffer</CODE> to <CODE>read_buffer_size</CODE> and
<CODE>record_rnd_buffer</CODE> to <CODE>read_rnd_buffer_size</CODE>.
<LI>

Renamed some SQL variables, but old names will still work until 5.0.
See section <A HREF="manual.html#Upgrading-from-3.23">2.5.3  Upgrading from Version 3.23 to 4.0</A>.
<LI>

Renamed <CODE>--skip-locking</CODE> to <CODE>--skip-external-locking</CODE>.
<LI>

Removed unused variable <CODE>query_buffer_size</CODE>.
<LI>

Fixed a bug that made the pager option in the <CODE>mysql</CODE> client
non-functional.
<LI>

Added full <CODE>AUTO_INCREMENT</CODE> support to <CODE>MERGE</CODE> tables.
<LI>

Extended <CODE>LOG()</CODE> function to accept an optional arbitrary base
parameter.
See section <A HREF="manual.html#Mathematical_functions">13.4.2  Mathematical Functions</A>.
<LI>

Added <CODE>LOG2()</CODE> function (useful for finding out how many bits
a number would require for storage).
<LI>

Added <CODE>LN()</CODE> natural logarithm function for compatibility with
other databases. It is synonymous with <CODE>LOG(X)</CODE>.
</UL>



<H3><A NAME="News-4.0.2" HREF="manual_toc.html#News-4.0.2">C.3.19  Changes in release 4.0.2 (01 Jul 2002)</A></H3>


<UL>
<LI>

Cleaned up <CODE>NULL</CODE> handling for default values in <CODE>DESCRIBE
tbl_name</CODE>.
<LI>

Fixed <CODE>truncate()</CODE> to round up negative values to the nearest integer.
<LI>

Changed <CODE>--chroot=path</CODE> option to execute <CODE>chroot()</CODE> immediately
after all options have been parsed.
<LI>

Don't allow database names that contain <SAMP>`\'</SAMP>.
<LI>

<CODE>lower_case_table_names</CODE> now also applies to database names.
<LI>

Added <CODE>XOR</CODE> operator (logical and bitwise <CODE>XOR</CODE>) with <CODE>^</CODE>
as a synonym for bitwise <CODE>XOR</CODE>.
<LI>

Added function <CODE>IS_FREE_LOCK("lock_name")</CODE>.
Based on code contributed by Hartmut Holzgraefe <a HREF="mailto:hartmut@six.de">hartmut@six.de</a>.
<LI>

Removed <CODE>mysql_ssl_clear()</CODE> from C API, as it was not needed.
<LI>

<CODE>DECIMAL</CODE> and <CODE>NUMERIC</CODE> types can now read exponential numbers.
<LI>

Added <CODE>SHA1()</CODE> function to calculate 160 bit hash value as described
in RFC 3174 (Secure Hash Algorithm). This function can be considered a
cryptographically more secure equivalent of <CODE>MD5()</CODE>.
See section <A HREF="manual.html#Encryption_functions">13.8.2  Encryption Functions</A>.
<LI>

Added <CODE>AES_ENCRYPT()</CODE> and <CODE>AES_DECRYPT()</CODE> functions to perform
encryption according to AES standard (Rijndael).
See section <A HREF="manual.html#Encryption_functions">13.8.2  Encryption Functions</A>.
<LI>

Added <CODE>--single-transaction</CODE> option to <CODE>mysqldump</CODE>, allowing a
consistent dump of <CODE>InnoDB</CODE> tables.
See section <A HREF="manual.html#mysqldump">8.8  The <CODE>mysqldump</CODE> Database Backup Program</A>.
<LI>

Fixed bug in <CODE>innodb_log_group_home_dir</CODE> in <CODE>SHOW VARIABLES</CODE>.
<LI>

Fixed a bug in optimizer with merge tables when non-unique values are 
used in summing up (causing crashes).
<LI>

Fixed a bug in optimizer when a range specified makes index grouping
impossible (causing crashes).
<LI>

Fixed a rare bug when <CODE>FULLTEXT</CODE> index is present and no tables are used.
<LI>

Added privileges <CODE>CREATE TEMPORARY TABLES</CODE>, <CODE>EXECUTE</CODE>,
<CODE>LOCK TABLES</CODE>, <CODE>REPLICATION CLIENT</CODE>, <CODE>REPLICATION SLAVE</CODE>,
<CODE>SHOW DATABASES</CODE> and <CODE>SUPER</CODE>. To use these, you must have
run the <CODE>mysql_fix_privilege_tables</CODE> script after upgrading.
<LI>

Fixed query cache align data bug.
<LI>

Fixed mutex bug in replication when reading from master fails.
<LI>

Added missing mutex in <CODE>TRUNCATE TABLE</CODE>;  This fixes some core
dump/hangup problems when using <CODE>TRUNCATE TABLE</CODE>.
<LI>

Fixed bug in multiple-table <CODE>DELETE</CODE> when optimizer uses only indexes.
<LI>

Fixed that <CODE>ALTER TABLE tbl_name RENAME new_tbl_name</CODE> is as fast
as <CODE>RENAME TABLE</CODE>.
<LI>

Fixed bug in <CODE>GROUP BY</CODE> with two or more columns, where at least one
column can contain <CODE>NULL</CODE> values.
<LI>

Use <CODE>Turbo Boyer-Moore</CODE> algorithm to speed up <CODE>LIKE "%keyword%"</CODE>
searches.
<LI>

Fixed bug in <CODE>DROP DATABASE</CODE> with symlink.
<LI>

Fixed crash in <CODE>REPAIR ... USE_FRM</CODE>.
<LI>

Fixed bug in <CODE>EXPLAIN</CODE> with <CODE>LIMIT offset != 0</CODE>.
<LI>

Fixed bug in phrase operator <CODE>"..."</CODE> in boolean full-text search.
<LI>

Fixed bug that caused duplicated rows when using truncation operator
<CODE>*</CODE> in boolean full-text search.
<LI>

Fixed bug in truncation operator of boolean full-text search (incorrect results
when there are only <CODE>+word*</CODE>s in the query).
<LI>

Fixed bug in boolean full-text search that caused a crash when an identical
<CODE>MATCH</CODE> expression that did not use an index appeared twice.
<LI>

Query cache is now automatically disabled in <CODE>mysqldump</CODE>.
<LI>

Fixed problem on Windows 98 that made sending of results very slow.
<LI>

Boolean full-text search weighting scheme changed to something more reasonable.
<LI>

Fixed bug in boolean full-text search that caused MySQL to ignore queries of
<CODE>ft_min_word_len</CODE> characters.
<LI>

Boolean full-text search now supports ``phrase searches.''
<LI>

New configure option <CODE>--without-query-cache</CODE>. 
<LI>

Memory allocation strategy for ``root memory'' changed. Block size now grows 
with number of allocated blocks.
<LI>

<CODE>INET_NTOA()</CODE> now returns <CODE>NULL</CODE> if you give it an argument that
is too large (greater than the value corresponding to <CODE>255.255.255.255</CODE>).
<LI>

Fix <CODE>SQL_CALC_FOUND_ROWS</CODE> to work with <CODE>UNION</CODE>. It will work only
if the first <CODE>SELECT</CODE> has this option and if there is global <CODE>LIMIT</CODE>
for the entire statement. For the moment, this requires using parentheses for
individual <CODE>SELECT</CODE> queries within the statement.
<LI>

Fixed bug in <CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>LIMIT</CODE>.
<LI>

Don't give an error for <CODE>CREATE TABLE ...(... VARCHAR(0))</CODE>.
<LI>

Fixed <CODE>SIGINT</CODE> and <CODE>SIGQUIT</CODE> problems in <TT>`mysql.cc'</TT> on Linux
with some <CODE>glibc</CODE> versions.
<LI>

Fixed bug in <TT>`convert.cc'</TT>, which is caused by having an incorrect
<CODE>net_store_length()</CODE> linked in the <CODE>CONVERT::store()</CODE> method.
<LI>

<CODE>DOUBLE</CODE> and <CODE>FLOAT</CODE> columns now honor the <CODE>UNSIGNED</CODE> flag
on storage.
<LI>

<CODE>InnoDB</CODE> now retains foreign key constraints through <CODE>ALTER TABLE</CODE>
and <CODE>CREATE/DROP INDEX</CODE>.
<LI>

<CODE>InnoDB</CODE> now allows foreign key constraints to be added through the
<CODE>ALTER TABLE</CODE> syntax.
<LI>

<CODE>InnoDB</CODE> tables can now be set to automatically grow in size (autoextend).
<LI>

Added <CODE>--ignore-lines=n</CODE> option to <CODE>mysqlimport</CODE>.  This has the
same effect as the <CODE>IGNORE n LINES</CODE> clause for <CODE>LOAD DATA</CODE>.
<LI>

Fixed bug in <CODE>UNION</CODE> with last offset being transposed to total result
set.
<LI>

<CODE>REPAIR ... USE_FRM</CODE> added.
<LI>

Fixed that <CODE>DEFAULT_SELECT_LIMIT</CODE> is always imposed on <CODE>UNION</CODE>
result set.
<LI>

Fixed that some <CODE>SELECT</CODE> options can appear only in the first
<CODE>SELECT</CODE>.
<LI>

Fixed bug with <CODE>LIMIT</CODE> with <CODE>UNION</CODE>, where last select is in
the braces.
<LI>

Fixed that full-text works fine with <CODE>UNION</CODE> operations.
<LI>

Fixed bug with indexless boolean full-text search.
<LI>

Fixed bug that sometimes appeared when full-text search was used
with <CODE>const</CODE> tables.
<LI>

Fixed incorrect error value when doing a <CODE>SELECT</CODE> with an empty
<CODE>HEAP</CODE> table.
<LI>

Use <CODE>ORDER BY column DESC</CODE> now sorts <CODE>NULL</CODE> values first.
(In other words, <CODE>NULL</CODE> values sort first in all cases, whether or
not <CODE>DESC</CODE> is specified.)  This is changed back in 4.0.10.
<LI>

Fixed bug in <CODE>WHERE key_name='constant' ORDER BY key_name DESC</CODE>.
<LI>

Fixed bug in <CODE>SELECT DISTINCT ... ORDER BY DESC</CODE> optimization.
<LI>

Fixed bug in <CODE>... HAVING 'GROUP_FUNCTION'(xxx) IS [NOT] NULL</CODE>.
<LI>

Fixed bug in truncation operator for boolean full-text search.
<LI>

Allow value of <CODE>--user=#</CODE> option for <CODE>mysqld</CODE> to be specified
as a numeric user ID.
<LI>

Fixed a bug where <CODE>SQL_CALC_ROWS</CODE> returned an incorrect value when used
with one table and <CODE>ORDER BY</CODE> and with <CODE>InnoDB</CODE> tables.
<LI>

Fixed that <CODE>SELECT 0 LIMIT 0</CODE> doesn't hang thread.
<LI>

Fixed some problems with <CODE>USE/IGNORE INDEX</CODE> when using
many keys with the same start column.
<LI>

Don't use table scan with <CODE>BerkeleyDB</CODE> and <CODE>InnoDB</CODE> tables when
we can use an index that covers the whole row.
<LI>

Optimized <CODE>InnoDB</CODE> sort-buffer handling to take less memory.
<LI>

Fixed bug in multiple-table <CODE>DELETE</CODE> and <CODE>InnoDB</CODE> tables.
<LI>

Fixed problem with <CODE>TRUNCATE</CODE> and <CODE>InnoDB</CODE> tables that produced the
error <CODE>Can't execute the given command because you have active locked
tables or an active transaction</CODE>.
<LI>

Added <CODE>NO_UNSIGNED_SUBTRACTION</CODE> to the set of flags that may be
specified with the <CODE>--sql-mode</CODE> option for <CODE>mysqld</CODE>.  It disables
unsigned arithmetic rules when it comes to subtraction. (This will make
MySQL 4.0 behave more like 3.23 with <CODE>UNSIGNED</CODE> columns).
<LI>

The result returned for all bit functions (<CODE>|</CODE>, <CODE>&#60;&#60;</CODE>, ...) is now of
type <CODE>unsigned integer</CODE>.
<LI>

Added detection of <CODE>nan</CODE> values in <CODE>MyISAM</CODE> to make it possible to
repair tables with <CODE>nan</CODE> in float or double columns.
<LI>

Fixed new bug in <CODE>myisamchk</CODE> where it didn't correctly update number of
``parts'' in the <CODE>MyISAM</CODE> index file.
<LI>

Changed to use <CODE>autoconf</CODE> 2.52 (from <CODE>autoconf</CODE> 2.13).
<LI>

Fixed optimization problem where the MySQL Server was in ``preparing'' state
for a long time when selecting from an empty table which had contained
a lot of rows.
<LI>

Fixed bug in complicated join with <CODE>const</CODE> tables. This fix also
improves performance a bit when referring to another table from a
<CODE>const</CODE> table.
<LI>

First pre-version of multiple-table <CODE>UPDATE</CODE> statement.
<LI>

Fixed bug in multiple-table <CODE>DELETE</CODE>.
<LI>

Fixed bug in <CODE>SELECT CONCAT(argument_list) ... GROUP BY 1</CODE>.
<LI>

<CODE>INSERT ... SELECT</CODE> did a full rollback in case of an error. Fixed
so that we only roll back the last statement in the current transaction.
<LI>

Fixed bug with empty expression for boolean full-text search.
<LI>

Fixed core dump bug in updating full-text key from/to <CODE>NULL</CODE>.
<LI>

ODBC compatibility: Added <CODE>BIT_LENGTH()</CODE> function.
<LI>

Fixed core dump bug in <CODE>GROUP BY BINARY column</CODE>.
<LI>

Added support for <CODE>NULL</CODE> keys in <CODE>HEAP</CODE> tables.
<LI>

Use index for <CODE>ORDER BY</CODE> in queries of type:
<CODE>SELECT * FROM t WHERE key_part1=1 ORDER BY key_part1 DESC, key_part2 DESC</CODE>
<LI>

Fixed bug in <CODE>FLUSH QUERY CACHE</CODE>.
<LI>

Added <CODE>CAST()</CODE> and <CODE>CONVERT()</CODE> functions. The <CODE>CAST</CODE> and
<CODE>CONVERT</CODE> functions are nearly identical and mainly useful when you
want to create a column with a specific type in a <CODE>CREATE ... SELECT</CODE>
statement.  For more information, read section <A HREF="manual.html#Cast_Functions">13.7  Cast Functions</A>.
<LI>

<CODE>CREATE ... SELECT</CODE> on <CODE>DATE</CODE> and <CODE>TIME</CODE> functions now
create columns of the expected type.
<LI>

Changed order in which keys are created in tables.
<LI>

Added new columns <CODE>Null</CODE> and <CODE>Index_type</CODE> to <CODE>SHOW INDEX</CODE>
output.
<LI>

Added <CODE>--no-beep</CODE> and <CODE>--prompt</CODE> options to <CODE>mysql</CODE> command-line client.
<LI>

New feature: management of user resources.

<PRE>
GRANT ... WITH MAX_QUERIES_PER_HOUR N1
               MAX_UPDATES_PER_HOUR N2
               MAX_CONNECTIONS_PER_HOUR N3;
</PRE>

See section <A HREF="manual.html#User_resources">5.5.4  Limiting Account Resources</A>.

<LI>

Added <CODE>mysql_secure_installation</CODE> to the <TT>`scripts/'</TT> directory.
</UL>



<H3><A NAME="News-4.0.1" HREF="manual_toc.html#News-4.0.1">C.3.20  Changes in release 4.0.1 (23 Dec 2001)</A></H3>


<UL>
<LI>

Added <CODE>system</CODE> command to <CODE>mysql</CODE>.
<LI>

Fixed bug when <CODE>HANDLER</CODE> was used with some unsupported table type.
<LI>

<CODE>mysqldump</CODE> now puts <CODE>ALTER TABLE tbl_name DISABLE KEYS</CODE> and
<CODE>ALTER TABLE tbl_name ENABLE KEYS</CODE> in the sql dump.
<LI>

Added <CODE>mysql_fix_extensions</CODE> script.
<LI>

Fixed stack overrun problem with <CODE>LOAD DATA FROM MASTER</CODE> on OSF/1.
<LI>

Fixed shutdown problem on HP-UX.
<LI>

Added <CODE>DES_ENCRYPT()</CODE> and <CODE>DES_DECRYPT()</CODE> functions.
<LI>

Added <CODE>FLUSH DES_KEY_FILE</CODE> statement.
<LI>

Added <CODE>--des-key-file</CODE> option to <CODE>mysqld</CODE>.
<LI>

<CODE>HEX(string)</CODE> now returns the characters in <CODE>string</CODE> converted to
hexadecimal.
<LI>

Fixed problem with <CODE>GRANT</CODE> when using <CODE>lower_case_table_names=1</CODE>.
<LI>

Changed <CODE>SELECT ... IN SHARE MODE</CODE> to
<CODE>SELECT ... LOCK IN SHARE MODE</CODE> (as in MySQL 3.23).
<LI>

A new query cache to cache results from identical <CODE>SELECT</CODE> queries.
<LI>

Fixed core dump bug on 64-bit machines when it got an incorrect communication
packet.
<LI>

<CODE>MATCH ... AGAINST(... IN BOOLEAN MODE)</CODE> can now work
without <CODE>FULLTEXT</CODE> index.
<LI>

Fixed slave to replicate from 3.23 master.
<LI>

Miscellaneous replication fixes/cleanup.
<LI>

Got shutdown to work on Mac OS X.
<LI>

Added <CODE>myisam/ft_dump</CODE> utility for low-level inspection
of <CODE>FULLTEXT</CODE> indexes.
<LI>

Fixed bug in <CODE>DELETE ... WHERE ... MATCH ...</CODE>.
<LI>

Added support for <CODE>MATCH ... AGAINST(... IN BOOLEAN MODE)</CODE>.
<STRONG>Note: You must rebuild your tables with
<CODE>ALTER TABLE tbl_name TYPE=MyISAM</CODE> to be
able to use boolean full-text search</STRONG>.
<LI>

<CODE>LOCATE()</CODE> and <CODE>INSTR()</CODE> are now case sensitive if either
argument is a binary string.
<LI>

Changed <CODE>RAND()</CODE> initialization so that <CODE>RAND(N)</CODE> and
<CODE>RAND(N+1)</CODE> are more distinct.
<LI>

Fixed core dump bug in <CODE>UPDATE ... ORDER BY</CODE>.
<LI>

In 3.23, <CODE>INSERT INTO ... SELECT</CODE> always had <CODE>IGNORE</CODE> enabled.
Now MySQL will stop (and possibly roll back) by default in case of an error
unless you specify <CODE>IGNORE</CODE>.
<LI>

Ignore <CODE>DATA DIRECTORY</CODE> and <CODE>INDEX DIRECTORY</CODE> directives on Windows.
<LI>

Added boolean full-text search code. It should be considered early alpha.
<LI>

Extended <CODE>MODIFY</CODE> and <CODE>CHANGE</CODE> in <CODE>ALTER TABLE</CODE> to accept
the <CODE>FIRST</CODE> and <CODE>AFTER</CODE> keywords.
<LI>

Indexes are now used with <CODE>ORDER BY</CODE> on a whole <CODE>InnoDB</CODE> table.
</UL>



<H3><A NAME="News-4.0.0" HREF="manual_toc.html#News-4.0.0">C.3.21  Changes in release 4.0.0 (Oct 2001: Alpha)</A></H3>


<UL>
<LI>

Added <CODE>--xml</CODE> option to <CODE>mysql</CODE> for producing XML output.
<LI>

Added full-text variables <CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>, and
<CODE>ft_max_word_len_for_sort</CODE> system variables.
<LI>

Added full-text variables <CODE>ft_min_word_len</CODE>, <CODE>ft_max_word_len</CODE>, and
<CODE>ft_max_word_len_for_sort</CODE> variables to <CODE>myisamchk</CODE>.
<LI>

Added documentation for <CODE>libmysqld</CODE>, the embedded MySQL server
library.  Also added example programs (a <CODE>mysql</CODE> client and
<CODE>mysqltest</CODE> test program) which use <CODE>libmysqld</CODE>.
<LI>

Removed all Gemini hooks from MySQL server.
<LI>

Removed <CODE>my_thread_init()</CODE> and <CODE>my_thread_end()</CODE>
from <TT>`mysql_com.h'</TT>, and added <CODE>mysql_thread_init()</CODE> and
<CODE>mysql_thread_end()</CODE> to <TT>`mysql.h'</TT>.
<LI>

Support for communication packets &#62; 16MB.  In 4.0.1 we will extend
<CODE>MyISAM</CODE> to be able to handle these.
<LI>

Secure connections (with SSL).
<LI>

Unsigned <CODE>BIGINT</CODE> constants now work. <CODE>MIN()</CODE> and <CODE>MAX()</CODE>
now handle signed and unsigned <CODE>BIGINT</CODE> numbers correctly.
<LI>

New character set <CODE>latin1_de</CODE> which provides correct German sorting.
<LI>

<CODE>STRCMP()</CODE> now uses the current character set when doing comparisons,
which means that the default comparison behavior now is case insensitive.
<LI>

<CODE>TRUNCATE TABLE</CODE> and <CODE>DELETE FROM tbl_name</CODE> are now separate
functions. One bonus is that <CODE>DELETE FROM tbl_name</CODE> now returns
the number of deleted rows, rather than zero.
<LI>

<CODE>DROP DATABASE</CODE> now executes a <CODE>DROP TABLE</CODE> on all tables in
the database, which fixes a problem with <CODE>InnoDB</CODE> tables.
<LI>

Added support for <CODE>UNION</CODE>.
<LI>

Added support for multiple-table <CODE>DELETE</CODE> operations.
<LI>

A new <CODE>HANDLER</CODE> interface to <CODE>MyISAM</CODE> tables.
<LI>

Added support for <CODE>INSERT</CODE> on <CODE>MERGE</CODE> tables. Patch from
Benjamin Pflugmann.
<LI>

Changed <CODE>WEEK(date,0)</CODE> to match the calendar in the USA.
<LI>

<CODE>COUNT(DISTINCT)</CODE> is about 30% faster.
<LI>

Speed up all internal list handling.
<LI>

Speed up <CODE>IS NULL</CODE>, <CODE>ISNULL()</CODE> and some other internal primitives.
<LI>

Full-text index creation now is much faster.
<LI>

Tree-like cache to speed up bulk inserts and
<CODE>myisam_bulk_insert_tree_size</CODE> variable.
<LI>

Searching on packed (<CODE>CHAR</CODE>/<CODE>VARCHAR</CODE>) keys is now much faster.
<LI>

Optimized queries of type:
<CODE>SELECT DISTINCT * from tbl_name ORDER by key_part1 LIMIT row_count</CODE>.
<LI>

<CODE>SHOW CREATE TABLE</CODE> now shows all table attributes.
<LI>

<CODE>ORDER BY ... DESC</CODE> can now use keys.
<LI>

<CODE>LOAD DATA FROM MASTER</CODE> ``automatically'' sets up a slave.
<LI>

Renamed <CODE>safe_mysqld</CODE> to <CODE>mysqld_safe</CODE> to make this name more
in line with other MySQL scripts/commands.
<LI>

Added support for symbolic links to <CODE>MyISAM</CODE> tables. Symlink handling is
now enabled by default for Windows.
<LI>

Added <CODE>SQL_CALC_FOUND_ROWS</CODE> and <CODE>FOUND_ROWS()</CODE>. This makes it
possible to know how many rows a query would have returned
without a <CODE>LIMIT</CODE> clause.
<LI>

Changed output format of <CODE>SHOW OPEN TABLES</CODE>.
<LI>

Allow <CODE>SELECT expression LIMIT ...</CODE>.
<LI>

Added <CODE>ORDER BY</CODE> syntax to <CODE>UPDATE</CODE> and <CODE>DELETE</CODE>.
<LI>

<CODE>SHOW INDEXES</CODE> is now a synonym for <CODE>SHOW INDEX</CODE>.
<LI>

Added <CODE>ALTER TABLE tbl_name DISABLE KEYS</CODE> and
<CODE>ALTER TABLE tbl_name ENABLE KEYS</CODE> commands.
<LI>

Allow use of <CODE>IN</CODE> as a synonym for <CODE>FROM</CODE> in <CODE>SHOW</CODE> commands.
<LI>

Implemented ``repair by sort'' for <CODE>FULLTEXT</CODE> indexes.
<CODE>REPAIR TABLE</CODE>, <CODE>ALTER TABLE</CODE>, and <CODE>OPTIMIZE TABLE</CODE>
for tables with <CODE>FULLTEXT</CODE> indexes are now up to 100 times faster.
<LI>

Allow standard SQL syntax <CODE>X'hexadecimal-number'</CODE>.
<LI>

Cleaned up global lock handling for <CODE>FLUSH TABLES WITH READ LOCK</CODE>.
<LI>

Fixed problem with <CODE>DATETIME = constant</CODE> in <CODE>WHERE</CODE> optimization.
<LI>

Added <CODE>--master-data</CODE> and <CODE>--no-autocommit</CODE> options to
<CODE>mysqldump</CODE>. (Thanks to Brian Aker for this.)
<LI>

Added script <CODE>mysql_explain_log.sh</CODE> to distribution.
(Thanks to mobile.de).
</UL>



<H2><A NAME="News-3.23.x" HREF="manual_toc.html#News-3.23.x">C.4  Changes in release 3.23.x (Recent; still supported)</A></H2>

<P>
<A NAME="IDX2312"></A>

</P>
<P>
Please note that since release 4.0 is now production level, only critical
fixes are done in the 3.23 release series. You are recommended to upgrade
when possible, to take advantage of all speed and feature improvements in
4.0. See section <A HREF="manual.html#Upgrading-from-3.23">2.5.3  Upgrading from Version 3.23 to 4.0</A>.

</P>
<P>
The 3.23 release has several major features that are not
present in previous versions.  We have added three new
table types:

</P>
<DL COMPACT>

<DT><CODE>MyISAM</CODE>
<DD>
A new <CODE>ISAM</CODE> library which is tuned for SQL and supports large files.
<DT><CODE>InnoDB</CODE>
<DD>
A transaction-safe storage engine that supports row level locking, and many
Oracle-like features.
<DT><CODE>BerkeleyDB</CODE> or <CODE>BDB</CODE>
<DD>
Uses the Berkeley DB library from Sleepycat Software to implement
transaction-safe tables.
</DL>

<P>
Note that only <CODE>MyISAM</CODE> is available in the standard binary distribution.

</P>
<P>
The 3.23 release also includes support for database replication between
a master and many slaves, full-text indexing, and much more.

</P>
<P>
All new features are being developed in the 4.x version.  Only
bugfixes and minor enhancements to existing features will be
added to 3.23.

</P>
<P>
The replication code and BerkeleyDB code is still not as tested and as
the rest of the code, so we will probably need to do a couple of future
releases of 3.23 with small fixes for this part of the code. As long as
you don't use these features, you should be quite safe with
MySQL 3.23!

</P>
<P>
Note that the preceding remarks don't mean that replication or Berkeley DB don't
work.  We have done a lot of testing of all code, including replication
and <CODE>BDB</CODE> without finding any problems.  It only means that not as many
users use this code as the rest of the code and because of this we are
not yet 100% confident in this code.

</P>



<H3><A NAME="News-3.23.59" HREF="manual_toc.html#News-3.23.59">C.4.1  Changes in release 3.23.59 (not released yet)</A></H3>


<UL>
<LI>

Fixed a symlink vulnerability in <TT>`mysqlbug'</TT> script -
vulnerability id CAN-2004-0381. (Bug #3284)
<LI>

Fixed bug in privilege checking of <CODE>ALTER TABLE RENAME</CODE>. (Bug #3270)
<LI>

Fixed bugs in <CODE>ACOS()</CODE>, <CODE>ASIN()</CODE> (Bug #2338) 
and in <CODE>FLOOR()</CODE> (Bug #3051).
The cause of the problem is an overly strong optimization done by <CODE>gcc</CODE>
in this case.
<LI>

Fixed bug in <CODE>INSERT ... SELECT</CODE> statements where, if a <CODE>NOT NULL</CODE>
column is assigned a value of <CODE>NULL</CODE>, the following columns in the row
might be assigned a value of zero.  (Bug #2012)
<LI>

If a query was ignored on the slave (because of
<CODE>replicate-ignore-table</CODE> and other similar rules), the slave
still checked if the query got the same error code (0, no error) as on
the master. So if the master had an error on the query (for example,
``Duplicate entry'' in a multiple-row insert), then the slave stopped
and warned that the error codes didn't match. This is a backport of the
fix for MySQL 4.0. (Bug #797)
<LI>

<CODE>mysqlbinlog</CODE> now asks for a password at console when the
<CODE>-p/--password</CODE> option is used with no argument. This is how the
other clients (<CODE>mysqladmin</CODE>, <CODE>mysqldump</CODE>..) already
behave. Note that one now has to use <CODE>mysqlbinlog -p&#60;my_password&#62;</CODE>;
<CODE>mysqlbinlog -p &#60;my_password&#62;</CODE> will not work anymore (in other
words, put no space after <CODE>-p</CODE>). (Bug #1595)
<LI>

On some 64-bit machines (some HP-UX and Solaris machines), a slave
installed with the 64-bit MySQL binary could not connect to its master
(it connected to itself instead). (Bug #1256, #1381)
<LI>

Fixed a Windows-specific bug present since MySQL 3.23.57 and
3.23.58 that caused Windows slaves to crash when they started
replication if a <TT>`master.info'</TT> file existed. (Bug #1720)
<LI>

Fixed bug in <CODE>ALTER TABLE RENAME</CODE>, when rename to the table with
the same name in another database silently dropped destination table if
it existed. (Bug #2628)
</UL>



<H3><A NAME="News-3.23.58" HREF="manual_toc.html#News-3.23.58">C.4.2  Changes in release 3.23.58 (11 Sep 2003)</A></H3>


<UL>
<LI>

Fixed buffer overflow in password handling which could potentially be
exploited by MySQL users with <CODE>ALTER</CODE> privilege on the
<CODE>mysql.user</CODE> table to execute random code or to gain shell access with
the UID of the <CODE>mysqld</CODE> process (thanks to Jedi/Sector One for spotting and
reporting this bug).
<LI>

<CODE>mysqldump</CODE> now correctly quotes all identifiers when communicating
with the server. This assures that during the dump process, <CODE>mysqldump</CODE>
will never send queries to the server that result in a syntax error. This
problem is <STRONG>not</STRONG> related to the <CODE>mysqldump</CODE> program's output,
which was not changed. (Bug #1148)
<LI>

Fixed table/column grant handling: The proper sort order (from most specific
to less specific, see section <A HREF="manual.html#Request_access">5.4.6  Access Control, Stage 2: Request Verification</A>) was not honored. (Bug #928)
<LI>

Fixed overflow bug in <CODE>MyISAM</CODE> and <CODE>ISAM</CODE> when a row is updated
in a table with a large number of columns and at least one <CODE>BLOB/TEXT</CODE>
column.
<LI>

Fixed MySQL so that field length (in C API) for the second column in
<CODE>SHOW CREATE TABLE</CODE> is always larger than the data length.
The only known application that was affected by the old behavior was
Borland dbExpress, which truncated the output from the command.
(Bug #1064)
<LI>

Fixed <CODE>ISAM</CODE> bug in <CODE>MAX()</CODE> optimization.
<LI>

Fixed <CODE>Unknown error</CODE> when doing <CODE>ORDER BY</CODE> on reference table which
was used with <CODE>NULL</CODE> value on <CODE>NOT NULL</CODE> column. (Bug #479)
</UL>



<H3><A NAME="News-3.23.57" HREF="manual_toc.html#News-3.23.57">C.4.3  Changes in release 3.23.57 (06 Jun 2003)</A></H3>


<UL>
<LI>

Fixed problem in alarm handling that could cause problems when getting a
packet that is too large.
<LI>

Fixed problem when installing MySQL as a service on Windows when two
arguments were specified to <CODE>mysqld</CODE> (option file group name and
service name).
<LI>

Fixed <CODE>kill pid-of-mysqld</CODE> to work on Mac OS X.
<LI>

<CODE>SHOW TABLE STATUS</CODE> displayed incorrect <CODE>Row_format</CODE> value for
tables that have been compressed with <CODE>myisampack</CODE>.
(Bug #427)
<LI>

<CODE>SHOW VARIABLES LIKE 'innodb_data_file_path'</CODE> displayed only the
name of the first data file. (Bug #468)
<LI>

Fixed security problem where <CODE>mysqld</CODE> didn't allow one to <CODE>UPDATE</CODE>
rows in a table even if one had a global <CODE>UPDATE</CODE> privilege and a
database <CODE>SELECT</CODE> privilege.
<LI>

Fixed a security problem with <CODE>SELECT</CODE> and wildcarded select list,
when user only had partial column <CODE>SELECT</CODE> privileges on the table.
<LI>

Fixed unlikely problem in optimizing <CODE>WHERE</CODE> clause with a constant
expression such as in <CODE>WHERE 1 AND (a=1 AND b=1)</CODE>.
<LI>

Fixed problem on IA-64 with timestamps that caused <CODE>mysqlbinlog</CODE> to fail.
<LI>

The default option for <CODE>innodb_flush_log_at_trx_commit</CODE> was changed
from 0 to 1 to make <CODE>InnoDB</CODE> tables ACID by default.
See section <A HREF="manual.html#InnoDB_start">16.5  <CODE>InnoDB</CODE> Startup Options</A>.
<LI>

Fixed problem with too many allocated alarms on slave when connecting to
master many times (normally not a very critical error).
<LI>

Fixed a bug in replication of temporary tables. (Bug #183)
<LI>

Fixed 64-bit bug that affected at least AMD hammer systems.
<LI>

Fixed a bug when doing <CODE>LOAD DATA INFILE IGNORE</CODE>: When reading
the binary log, <CODE>mysqlbinlog</CODE> and the replication code read <CODE>REPLACE</CODE>
instead of <CODE>IGNORE</CODE>. This could make the slave's table
become different from the master's table. (Bug #218)
<LI>

Fixed overflow bug in <CODE>MyISAM</CODE> when a row is inserted into a table with a 
large number of columns and at least one <CODE>BLOB/TEXT</CODE> column. Bug was caused
by incorrect calculation of the needed buffer to pack data.
<LI>

The binary log was not locked during <CODE>TRUNCATE tbl_name</CODE> or
<CODE>DELETE FROM tbl_name</CODE> statements, which could cause an <CODE>INSERT</CODE> to
<CODE>tbl_name</CODE> to be written to the log before the
<CODE>TRUNCATE</CODE> or <CODE>DELETE</CODE> statements.
<LI>

Fixed rare bug in <CODE>UPDATE</CODE> of <CODE>InnoDB</CODE> tables where one row could be
updated multiple times.
<LI>

Produce an error for empty table and column names.
<LI>

Changed <CODE>PROCEDURE ANALYSE()</CODE> to report <CODE>DATE</CODE> instead of
<CODE>NEWDATE</CODE>.
<LI>

Changed <CODE>PROCEDURE ANALYSE(#)</CODE> to restrict the number of values in an
<CODE>ENUM</CODE> column to <CODE>#</CODE> also for string values.
<LI>

<CODE>mysqldump</CODE> no longer silently deletes the binary logs when invoked with
the <CODE>--master-data</CODE> or <CODE>--first-slave</CODE> option;
while this behavior was convenient for some
users, others may suffer from it. Now you must explicitly ask for binary
logs to be deleted by using the new <CODE>--delete-master-logs</CODE> option.
<LI>

Fixed a bug in <CODE>mysqldump</CODE> when it was invoked with the
<CODE>--master-data</CODE> option: The <CODE>CHANGE MASTER TO</CODE> statements that were
appended to the SQL dump had incorrect coordinates. (Bug #159)
</UL>



<H3><A NAME="News-3.23.56" HREF="manual_toc.html#News-3.23.56">C.4.4  Changes in release 3.23.56 (13 Mar 2003)</A></H3>

<UL>
<LI>

Fixed <CODE>mysqld</CODE> crash on extremely small values of
<CODE>sort_buffer</CODE> variable.
<LI>

Fixed a bug in privilege system for <CODE>GRANT UPDATE</CODE> on the column level.
<LI>

Fixed a rare bug when using a date in <CODE>HAVING</CODE> with <CODE>GROUP BY</CODE>.
<LI>

Fixed checking of random part of <CODE>WHERE</CODE> clause. (Bug #142)
<LI>

Fixed MySQL (and <CODE>myisamchk</CODE>) crash on artificially
corrupted <TT>`.MYI'</TT> files.
<LI>

Security enhancement:
<CODE>mysqld</CODE> no longer reads options from world-writable config files.
<LI>

Security enhancement:
<CODE>mysqld</CODE> and <CODE>safe_mysqld</CODE> now use only the first <CODE>--user</CODE>
option specified on the command line. (Normally this comes from
<TT>`/etc/my.cnf'</TT>)
<LI>

Security enhancement:
Don't allow <CODE>BACKUP TABLE</CODE> to overwrite existing files.
<LI>

Fixed unlikely deadlock bug when one thread did a <CODE>LOCK TABLE</CODE> and
another thread did a <CODE>DROP TABLE</CODE>.  In this case one could do
a <CODE>KILL</CODE> on one of the threads to resolve the deadlock.
<LI>

<CODE>LOAD DATA INFILE</CODE> was not replicated by slave if
<CODE>replicate_*_table</CODE> was set on the slave.
<LI>

Fixed a bug in handling <CODE>CHAR(0)</CODE> columns that could cause incorrect
results from the query.
<LI>

Fixed a bug in <CODE>SHOW VARIABLES</CODE> on 64-bit platforms. The bug was
caused by incorrect declaration of variable <CODE>server_id</CODE>.
<LI>

The Comment column in <CODE>SHOW TABLE STATUS</CODE> now reports that it can
contain <CODE>NULL</CODE> values (which is the case for a crashed <TT>`.frm'</TT> file).
<LI>

Fixed the <CODE>rpl_rotate_logs</CODE> test to not fail on certain platforms (e.g.
Mac OS X) due to a too long file name (changed <CODE>slave-master-info.opt</CODE>
to <CODE>.slave-mi</CODE>).
<LI>

Fixed a problem with <CODE>BLOB NOT NULL</CODE> columns used with <CODE>IS NULL</CODE>.
<LI>

Fixed bug in <CODE>MAX()</CODE> optimization in <CODE>MERGE</CODE> tables.
<LI>

Better <CODE>RAND()</CODE> initialization for new connections.
<LI>

Fixed bug with connect timeout. This bug was manifested on OS's with 
<CODE>poll()</CODE> system call, which resulted in timeout the value specified as
it was executed in both <CODE>select()</CODE> and <CODE>poll()</CODE>.
<LI>

Fixed bug in
<CODE>SELECT * FROM table WHERE datetime1 IS NULL OR datetime2 IS NULL</CODE>.
<LI>

Fixed bug in using aggregate functions as argument for <CODE>INTERVAL</CODE>,
<CODE>CASE</CODE>, <CODE>FIELD</CODE>, <CODE>CONCAT_WS</CODE>, <CODE>ELT</CODE> and
<CODE>MAKE_SET</CODE> functions.
<LI>

When running with <CODE>--lower-case-table-names=1</CODE> (default on Windows)
and you had tables or databases with mixed case on disk, then
executing <CODE>SHOW TABLE STATUS</CODE> followed with <CODE>DROP DATABASE</CODE>
or <CODE>DROP TABLE</CODE> could fail with <CODE>Errcode 13</CODE>.
<LI>

Fixed bug in logging to binary log (which affects replication) a query
that inserts a <CODE>NULL</CODE> in an <CODE>auto_increment</CODE> field and also
uses <CODE>LAST_INSERT_ID()</CODE>.
<LI>

Fixed bug in <CODE>mysqladmin --relative</CODE>.
<LI>

On some 64-bit systems, <CODE>show status</CODE> reported a strange number for
<CODE>Open_files</CODE> and <CODE>Open_streams</CODE>.
</UL>



<H3><A NAME="News-3.23.55" HREF="manual_toc.html#News-3.23.55">C.4.5  Changes in release 3.23.55 (23 Jan 2003)</A></H3>

<UL>
<LI>

Fixed double <CODE>free</CODE>'d pointer bug in <CODE>mysql_change_user()</CODE>
handling, that enabled a specially hacked version of MySQL client
to crash <CODE>mysqld</CODE>. <STRONG>Note</STRONG> that you must log in to the server
by using a valid user account to be able to exploit this bug.
<LI>

Fixed bug with the <CODE>--slow-log</CODE> when logging an administrator command
(like <CODE>FLUSH TABLES</CODE>).
<LI>

Fixed bug in <CODE>GROUP BY</CODE> when used on BLOB column with <CODE>NULL</CODE> values.
<LI>

Fixed a bug in handling <CODE>NULL</CODE> values in <CODE>CASE ... WHEN ...</CODE>.
<LI>

Bugfix for <CODE>--chroot</CODE> (see section <A HREF="manual.html#News-3.23.54">C.4.6  Changes in release 3.23.54 (05 Dec 2002)</A>)
is reverted. Unfortunately, there is no way to make it to work, without
introducing backward-incompatible changes in <TT>`my.cnf'</TT>.
Those who need <CODE>--chroot</CODE> functionality, should upgrade to MySQL 4.0.
(The fix in the 4.0 branch did not break backward-compatibility).
<LI>

Make <CODE>--lower-case-table-names</CODE> default on Mac OS X as the default
filesystem (HFS+) is case insensitive.
<LI>

Fixed a bug in <TT>`scripts/mysqld_safe.sh'</TT> in <CODE>NOHUP_NICENESS</CODE>
testing.
<LI>

Transactions in <CODE>AUTOCOMMIT=0</CODE> mode didn't rotate binary log.
<LI>

Fixed a bug in <CODE>scripts/make_binary_distribution</CODE> that resulted in
a remaining <CODE>@HOSTNAME@</CODE> variable instead of replacing it with the
correct path to the <CODE>hostname</CODE> binary.
<LI>

Fixed a very unlikely bug that could cause <CODE>SHOW PROCESSLIST</CODE> to core
dump in pthread_mutex_unlock() if a new thread was connecting.
<LI>

Forbid <CODE>SLAVE STOP</CODE> if the thread executing the query has locked
tables.  This removes a possible deadlock situation.
</UL>



<H3><A NAME="News-3.23.54" HREF="manual_toc.html#News-3.23.54">C.4.6  Changes in release 3.23.54 (05 Dec 2002)</A></H3>

<UL>
<LI>

Fixed a bug, that allowed to crash <CODE>mysqld</CODE>
with a specially crafted packet.
<LI>

Fixed a rare crash (double <CODE>free</CODE>'d pointer) when altering a
temporary table.
<LI>

Fixed buffer overrun in <CODE>libmysqlclient</CODE> library
that allowed malicious MySQL server to crash the client
application.
<LI>

Fixed security-related bug in <CODE>mysql_change_user()</CODE> handling.
All users are strongly recommended to upgrade to the version 3.23.54.
<LI>

Fixed bug that prevented <CODE>--chroot</CODE> command-line option of <CODE>mysqld</CODE>
from working.
<LI>

Fixed bug that made <CODE>OPTIMIZE TABLE</CODE> to corrupt the table
under some rare circumstances.
<LI>

Fixed <CODE>mysqlcheck</CODE> so it can deal with table names containing dashes.
<LI>

Fixed shutdown problem on Mac OS X.
<LI>

Fixed bug with comparing an indexed <CODE>NULL</CODE> field with <CODE>&#60;=&#62; NULL</CODE>.
<LI>

Fixed bug that caused <CODE>IGNORE INDEX</CODE> and <CODE>USE INDEX</CODE> sometimes
to be ignored.
<LI>

Fixed rare core dump problem in complicated <CODE>GROUP BY</CODE> queries that
didn't return any result.
<LI>

Fixed a bug where <CODE>MATCH ... AGAINST () &#62;=0</CODE> was treated as if it was
<CODE>&#62;</CODE>.
<LI>

Fixed core dump in <CODE>SHOW PROCESSLIST</CODE> when running with an
active slave (unlikely timing bug).
<LI>

Make it possible to use  multiple MySQL servers on Windows (code backported
from 4.0.2).
<LI>

One can create <CODE>TEMPORARY</CODE> <CODE>MERGE</CODE> tables now.
<LI>

Fixed that <CODE>--core-file</CODE> works on Linux (at least on kernel 2.4.18).
<LI>

Fixed a problem with <CODE>BDB</CODE> and <CODE>ALTER TABLE</CODE>.
<LI>

Fixed reference to freed memory when doing complicated <CODE>GROUP BY
... ORDER BY</CODE> queries.  Symptom was that <CODE>mysqld</CODE> died in function
<CODE>send_fields</CODE>.
<LI>

Allocate heap rows in smaller blocks to get better memory usage.
<LI>

Fixed memory allocation bug when storing <CODE>BLOB</CODE> values in internal
temporary tables used for some (unlikely) <CODE>GROUP BY</CODE> queries.
<LI>

Fixed a bug in key optimizing handling where the expression
<CODE>WHERE col_name = key_col_name</CODE> was calculated as true
for <CODE>NULL</CODE> values.
<LI>

Fixed core dump bug when doing <CODE>LEFT JOIN ... WHERE key_column=NULL</CODE>.
<LI>

Fixed <CODE>MyISAM</CODE> crash when using dynamic-row tables with huge numbers of
packed fields.
<LI>

Updated source tree to be built using <CODE>automake 1.5</CODE> and 
<CODE>libtool 1.4</CODE>.
</UL>



<H3><A NAME="News-3.23.53" HREF="manual_toc.html#News-3.23.53">C.4.7  Changes in release 3.23.53 (09 Oct 2002)</A></H3>

<UL>
<LI>

Fixed crash when <CODE>SHOW INNODB STATUS</CODE> was used and <CODE>skip-innodb</CODE>
was defined.
<LI>

Fixed possible memory corruption bug in binary log file handling when
slave rotated the logs (only affected 3.23, not 4.0).
<LI>

Fixed problem in <CODE>LOCK TABLES</CODE> on Windows when one connects to a
database that contains uppercase letters.
<LI>

Fixed that <CODE>--skip-show-database</CODE> doesn't reset the <CODE>--port</CODE> option.
<LI>

Small fix in <CODE>safe_mysqld</CODE> for some shells.
<LI>

Fixed that <CODE>FLUSH STATUS</CODE> doesn't reset <CODE>delayed_insert_threads</CODE>.
<LI>

Fixed core dump bug when using the <CODE>BINARY</CODE> cast on a <CODE>NULL</CODE> value.
<LI>

Fixed race condition when someone did a <CODE>GRANT</CODE> at the same time a new
user logged in or did a <CODE>USE database</CODE>.
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> and <CODE>RENAME TABLE</CODE> when running with
<CODE>-O lower_case_table_names=1</CODE> (typically on Windows) when giving the
table name in uppercase.
<LI>

Fixed that <CODE>-O lower_case_table_names=1</CODE> also converts database
names to lowercase.
<LI>

Fixed unlikely core dump with <CODE>SELECT ... ORDER BY ... LIMIT</CODE>.
<LI>

Changed <CODE>AND/OR</CODE> to report that they can return NULL. This fixes a
bug in <CODE>GROUP BY</CODE> on <CODE>AND/OR</CODE> expressions that return
<CODE>NULL</CODE>.
<LI>

Fixed a bug that <CODE>OPTIMIZE TABLE</CODE> of locked and modified <CODE>MyISAM</CODE> table,
reported table corruption.
<LI>

Fixed a <CODE>BDB</CODE>-related <CODE>ALTER TABLE</CODE> bug with dropping a column
and shutting down immediately thereafter.
<LI>

Fixed problem with <CODE>configure ... --localstatedir=...</CODE>.
<LI>

Fixed problem with <CODE>UNSIGNED BIGINT</CODE> on AIX (again).
<LI>

Fixed bug in pthread_mutex_trylock() on HPUX 11.0.
<LI>

Multi-threaded stress tests for <CODE>InnoDB</CODE>.
</UL>



<H3><A NAME="News-3.23.52" HREF="manual_toc.html#News-3.23.52">C.4.8  Changes in release 3.23.52 (14 Aug 2002)</A></H3>

<UL>
<LI>

Wrap <CODE>BEGIN</CODE>/<CODE>COMMIT</CODE> around transaction in the binary log.
This makes replication honor transactions.
<LI>

Fixed security bug when having an empty database name in the <CODE>user.db</CODE>
table.
<LI>

Changed initialization of <CODE>RAND()</CODE> to make it less predicatable.
<LI>

Fixed problem with <CODE>GROUP BY</CODE> on result with expression that created a
<CODE>BLOB</CODE> field.
<LI>

Fixed problem with <CODE>GROUP BY</CODE> on columns that have <CODE>NULL</CODE> values.
To solve this we now create an <CODE>MyISAM</CODE> temporary table when doing a
<CODE>GROUP BY</CODE> on a possible <CODE>NULL</CODE> item.
From MySQL 4.0.5 we can use in memory <CODE>HEAP</CODE> tables for this case.
<LI>

Fixed problem with privilege tables when downgrading from 4.0.2 to 3.23.
<LI>

Fixed thread bug in <CODE>SLAVE START</CODE>, <CODE>SLAVE STOP</CODE> and automatic repair
of <CODE>MyISAM</CODE> tables that could cause table cache to be corrupted.
<LI>

Fixed possible thread related key-cache-corruption problem with
<CODE>OPTIMIZE TABLE</CODE> and <CODE>REPAIR TABLE</CODE>.
<LI>

Added name of 'administrator command' logs.
<LI>

Fixed bug with creating an auto-increment value on second part of a
<CODE>UNIQUE()</CODE> key where first part could contain <CODE>NULL</CODE> values.
<LI>

Don't write slave-timeout reconnects to the error log.
<LI>

Fixed bug with slave net read timeouting
<LI>

Fixed a core-dump bug with <CODE>MERGE</CODE> tables and <CODE>MAX()</CODE> function.
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> with <CODE>BDB</CODE> tables.
<LI>

Fixed bug when logging <CODE>LOAD DATA INFILE</CODE> to binary log with no 
active database.
<LI>

Fixed a bug in range optimizer (causing crashes).
<LI>

Fixed possible problem in replication when doing <CODE>DROP DATABASE</CODE> on a
database with <CODE>InnoDB</CODE> tables.
<LI>

Fixed <CODE>mysql_info()</CODE> to return 0 for <CODE>Duplicates</CODE> value when using
<CODE>INSERT DELAYED IGNORE</CODE>.
<LI>

Added <CODE>-DHAVE_BROKEN_REALPATH</CODE> to the Mac OS X (darwin) compile
options in <TT>`configure.in'</TT> to fix a failure under high load.
</UL>



<H3><A NAME="News-3.23.51" HREF="manual_toc.html#News-3.23.51">C.4.9  Changes in release 3.23.51 (31 May 2002)</A></H3>


<UL>
<LI>

Fix bug with closing tags missing slash for <CODE>mysqldump</CODE> XML output.
<LI>

Remove endspace from <CODE>ENUM</CODE> values. (This fixed a problem with
<CODE>SHOW CREATE TABLE</CODE>.)
<LI>

Fixed bug in <CODE>CONCAT_WS()</CODE> that cut the result.
<LI>

Changed name of server variables <CODE>Com_show_master_stat</CODE> to
<CODE>Com_show_master_status</CODE> and <CODE>Com_show_slave_stat</CODE> to
<CODE>Com_show_slave_status</CODE>.
<LI>

Changed handling of <CODE>gethostbyname()</CODE> to make the client library
thread-safe even if <CODE>gethostbyname_r</CODE> doesn't exist.
<LI>

Fixed core-dump problem when giving a wrong password string to <CODE>GRANT</CODE>.
<LI>

Fixed bug in <CODE>DROP DATABASE</CODE> with symlinked directory.
<LI>

Fixed optimization problem with <CODE>DATETIME</CODE> and value outside
<CODE>DATETIME</CODE> range.
<LI>

Removed Sleepycat's <CODE>BDB</CODE> doc files from the source tree, as they're not
needed (MySQL covers <CODE>BDB</CODE> in its own documentation).
<LI>

Fixed MIT-pthreads to compile with <CODE>glibc</CODE> 2.2 (needed for
<CODE>make dist</CODE>).
<LI>

Fixed the <CODE>FLOAT(X+1,X)</CODE> is not converted to <CODE>FLOAT(X+2,X)</CODE>.
(This also affected <CODE>DECIMAL</CODE>, <CODE>DOUBLE</CODE> and <CODE>REAL</CODE> types)
<LI>

Fixed the result from <CODE>IF()</CODE> is case in-sensitive if the second and
third arguments are case sensitive.
<LI>

Fixed core dump problem on OSF/1 in <CODE>gethostbyname_r</CODE>.
<LI>

Fixed that underflowed decimal fields are not zero filled.
<LI>

If we get an overflow when inserting <CODE>'+11111'</CODE> for
<CODE>DECIMAL(5,0) UNSIGNED</CODE> columns, we will just drop the sign.
<LI>

Fixed optimization bug with <CODE>ISNULL(expression_which_cannot_be_null)</CODE> and
<CODE>ISNULL(constant_expression)</CODE>.
<LI>

Fixed host lookup bug in the <CODE>glibc</CODE> library that we used with the 3.23.50
Linux-x86 binaries.
</UL>



<H3><A NAME="News-3.23.50" HREF="manual_toc.html#News-3.23.50">C.4.10  Changes in release 3.23.50 (21 Apr 2002)</A></H3>


<UL>
<LI>

Fixed buffer overflow problem if someone specified a too-long <CODE>datadir</CODE>
parameter to <CODE>mysqld</CODE>.
<LI>

Add missing <CODE>&#60;row&#62;</CODE> tags for <CODE>mysqldump</CODE> XML output.
<LI>

Fixed problem with <CODE>crash-me</CODE> and <CODE>gcc</CODE> 3.0.4.
<LI>

Fixed that <CODE>@@unknown_variable</CODE> doesn't hang server.
<LI>

Added <CODE>@@VERSION</CODE> as a synonym for <CODE>VERSION()</CODE>.
<LI>

<CODE>SHOW VARIABLES LIKE 'xxx'</CODE> is now case-insensitive.
<LI>

Fixed timeout for <CODE>GET_LOCK()</CODE> on HP-UX with DCE threads.
<LI>

Fixed memory allocation bug in the glibc library used to build Linux
binaries, which caused <CODE>mysqld</CODE> to die in <CODE>free()</CODE>.
<LI>

Fixed <CODE>SIGINT</CODE> and <CODE>SIGQUIT</CODE> problems in <CODE>mysql</CODE>.
<LI>

Fixed bug in character table converts when used with big ( &#62; 64K) strings.
<LI>

<CODE>InnoDB</CODE> now retains foreign key constraints through <CODE>ALTER TABLE</CODE>
and <CODE>CREATE/DROP INDEX</CODE>.
<LI>

<CODE>InnoDB</CODE> now allows foreign key constraints to be added through the
<CODE>ALTER TABLE</CODE> syntax.
<LI>

<CODE>InnoDB</CODE> tables can now be set to automatically grow in size (autoextend).
<LI>

Our Linux RPMS and binaries are now compiled with <CODE>gcc</CODE> 3.0.4, which
should make them a bit faster.
<LI>

Fixed some buffer overflow problems when reading startup parameters.
<LI>

Because of problems on shutdown we have now disabled named pipes on
Windows by default.  One can enable named pipes by starting <CODE>mysqld</CODE> with
<CODE>--enable-named-pipe</CODE>.
<LI>

Fixed bug when using <CODE>WHERE key_column = 'J' or key_column='j'</CODE>.
<LI>

Fixed core-dump bug when using <CODE>--log-bin</CODE> with <CODE>LOAD DATA
INFILE</CODE> without an active database.
<LI>

Fixed bug in <CODE>RENAME TABLE</CODE> when used with
<CODE>lower_case_table_names=1</CODE> (default on Windows).
<LI>

Fixed unlikely core-dump bug when using <CODE>DROP TABLE</CODE> on a table
that was in use by a thread that also used queries on only temporary tables.
<LI>

Fixed problem with <CODE>SHOW CREATE TABLE</CODE> and <CODE>PRIMARY KEY</CODE> when using
32 indexes.
<LI>

Fixed that one can use <CODE>SET PASSWORD</CODE> for the anonymous user.
<LI>

Fixed core dump bug when reading client groups from option files using
<CODE>mysql_options()</CODE>.
<LI>

Memory leak (16 bytes per every <STRONG>corrupted</STRONG> table) closed.
<LI>

Fixed binary builds to use <CODE>--enable-local-infile</CODE>.
<LI>

Update source to work with new version of <CODE>bison</CODE>.
<LI>

Updated shell scripts to now agree with new POSIX standard.
<LI>

Fixed bug where <CODE>DATE_FORMAT()</CODE> returned empty string when used
with <CODE>GROUP BY</CODE>.
</UL>



<H3><A NAME="News-3.23.49" HREF="manual_toc.html#News-3.23.49">C.4.11  Changes in release 3.23.49</A></H3>


<UL>
<LI>

For a <CODE>MERGE</CODE> table, <CODE>DELETE FROM merge_table</CODE> used without a
<CODE>WHERE</CODE> clause no longer clears the mapping for the table by emptying
the <TT>`.MRG'</TT> file. Instead, it deletes records from the mapped tables.
<LI>

Don't give warning for a statement that is only a comment; this is needed for
<CODE>mysqldump --disable-keys</CODE> to work.
<LI>

Fixed unlikely caching bug when doing a join without keys. In this case,
the last used field for a table always returned <CODE>NULL</CODE>.
<LI>

Added options to make <CODE>LOAD DATA LOCAL INFILE</CODE> more secure.
<LI>

MySQL binary release 3.23.48 for Linux contained a new <CODE>glibc</CODE> library,
which has serious problems under high load and Red Hat 7.2.  The 3.23.49 binary
release doesn't have this problem.
<LI>

Fixed shutdown problem on NT.
</UL>



<H3><A NAME="News-3.23.48" HREF="manual_toc.html#News-3.23.48">C.4.12  Changes in release 3.23.48 (07 Feb 2002)</A></H3>


<UL>
<LI>

Added <CODE>--xml</CODE> option to <CODE>mysqldump</CODE> for producing XML output.
<LI>

Changed to use <CODE>autoconf</CODE> 2.52 (from <CODE>autoconf</CODE> 2.13)
<LI>

Fixed bug in complicated join with <CODE>const</CODE> tables.
<LI>

Added internal safety checks for <CODE>InnoDB</CODE>.
<LI>

Some <CODE>InnoDB</CODE> variables were always shown in <CODE>SHOW VARIABLES</CODE> as
<CODE>OFF</CODE> on high-byte-first systems (like SPARC).
<LI>

Fixed problem with one thread using an <CODE>InnoDB</CODE> table and another
thread doing an <CODE>ALTER TABLE</CODE> on the same table. Before that,
<CODE>mysqld</CODE> could crash with an assertion failure in <TT>`row0row.c'</TT>,
line 474.
<LI>

Tuned the <CODE>InnoDB</CODE> SQL optimizer to favor index searches more often
over table scans.
<LI>

Fixed a performance problem with <CODE>InnoDB</CODE> tables when several large
<CODE>SELECT</CODE> queries are run concurrently on a multiprocessor Linux
computer.  Large CPU-bound <CODE>SELECT</CODE> queries will now also generally
run faster on all platforms.
<LI>

If MySQL binary logging is used, <CODE>InnoDB</CODE> now prints after crash recovery the
latest MySQL binary log name and the offset <CODE>InnoDB</CODE> was able to recover
to. This is useful, for example, when resynchronizing a master and a
slave database in replication.
<LI>

Added better error messages to help in installation problems of <CODE>InnoDB</CODE>
tables.
<LI>

It is now possible to recover MySQL temporary tables that have become
orphaned inside the <CODE>InnoDB</CODE> tablespace.
<LI>

<CODE>InnoDB</CODE> now prevents a <CODE>FOREIGN KEY</CODE> declaration where the
signedness is not the same in the referencing and referenced integer columns.
<LI>

Calling <CODE>SHOW CREATE TABLE</CODE> or <CODE>SHOW TABLE STATUS</CODE> could cause
memory corruption and make <CODE>mysqld</CODE> crash.  Especially at risk was
<CODE>mysqldump</CODE>, because it frequently calls <CODE>SHOW CREATE TABLE</CODE>.
<LI>

If inserts to several tables containing an <CODE>AUTO_INCREMENT</CODE> column were
wrapped inside one <CODE>LOCK TABLES</CODE>, <CODE>InnoDB</CODE> asserted in
<TT>`lock0lock.c'</TT>.
<LI>

In 3.23.47 we allowed several <CODE>NULL</CODE> values in a <CODE>UNIQUE</CODE> secondary
index for an <CODE>InnoDB</CODE> table.  But <CODE>CHECK TABLE</CODE> was not relaxed: it
reports the table as corrupt.  <CODE>CHECK TABLE</CODE> no longer complains in
this situation.
<LI>

<CODE>SHOW GRANTS</CODE> now shows <CODE>REFERENCES</CODE> instead of <CODE>REFERENCE</CODE>.
</UL>



<H3><A NAME="News-3.23.47" HREF="manual_toc.html#News-3.23.47">C.4.13  Changes in release 3.23.47 (27 Dec 2001)</A></H3>


<UL>
<LI>

Fixed bug when using the following construct:
<CODE>SELECT ... WHERE key=@var_name OR key=@var_name2</CODE>
<LI>

Restrict <CODE>InnoDB</CODE> keys to 500 bytes.
<LI>

<CODE>InnoDB</CODE> now supports <CODE>NULL</CODE> in keys.
<LI>

Fixed shutdown problem on HP-UX. (Introduced in 3.23.46)
<LI>

Fixed core dump bug in replication when using <CODE>SELECT RELEASE_LOCK()</CODE>.
<LI>

Added new statement: <CODE>DO expr[,expr]...</CODE>
<LI>

Added <CODE>slave-skip-errors</CODE> option.
<LI>

Added statistics variables for all MySQL commands. (<CODE>SHOW STATUS</CODE> is
now much longer.)
<LI>

Fixed default values for <CODE>InnoDB</CODE> tables.
<LI>

Fixed that <CODE>GROUP BY expr DESC</CODE> works.
<LI>

Fixed bug when using <CODE>t1 LEFT JOIN t2 ON t2.key=constant</CODE>.
<LI>

<CODE>mysql_config</CODE> now also works with binary (relocated) distributions.
</UL>



<H3><A NAME="News-3.23.46" HREF="manual_toc.html#News-3.23.46">C.4.14  Changes in release 3.23.46 (29 Nov 2001)</A></H3>


<UL>
<LI>

Fixed problem with aliased temporary table replication.
<LI>

<CODE>InnoDB</CODE> and <CODE>BDB</CODE> tables will now use index when doing an
<CODE>ORDER BY</CODE> on the whole table.
<LI>

Fixed bug where one got an empty set instead of a DEADLOCK error when using
<CODE>BDB</CODE> tables.
<LI>

One can now kill <CODE>ANALYZE TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, and <CODE>OPTIMIZE TABLE</CODE> when
the thread is waiting to get a lock on the table.
<LI>

Fixed race condition in <CODE>ANALYZE TABLE</CODE>.
<LI>

Fixed bug when joining with caching (unlikely to happen).
<LI>

Fixed race condition when using the binary log and <CODE>INSERT DELAYED</CODE>
which could cause the binary log to have rows that were not yet written
to <CODE>MyISAM</CODE> tables.
<LI>

Changed caching of binary log to make replication slightly faster.
<LI>

Fixed bug in replication on Mac OS X.
</UL>



<H3><A NAME="News-3.23.45" HREF="manual_toc.html#News-3.23.45">C.4.15  Changes in release 3.23.45 (22 Nov 2001)</A></H3>


<UL>
<LI>

<CODE>(UPDATE|DELETE) ...WHERE MATCH</CODE> bugfix.
<LI>

shutdown should now work on Darwin (Mac OS X).
<LI>

Fixed core dump when repairing corrupted packed <CODE>MyISAM</CODE> files.
<LI>

<CODE>--core-file</CODE> now works on Solaris.
<LI>

Fix a bug which could cause <CODE>InnoDB</CODE> to complain if it cannot find
free blocks from the buffer cache during recovery.
<LI>

Fixed bug in <CODE>InnoDB</CODE> insert buffer B-tree handling that could cause
crashes.
<LI>

Fixed bug in <CODE>InnoDB</CODE> lock timeout handling.
<LI>

Fixed core dump bug in <CODE>ALTER TABLE</CODE> on a <CODE>TEMPORARY</CODE> <CODE>InnoDB</CODE>
table.
<LI>

Fixed bug in <CODE>OPTIMIZE TABLE</CODE> that reset index cardinality if it
was up to date.
<LI>

Fixed problem with <CODE>t1 LEFT_JOIN t2 ... WHERE t2.date_column IS NULL</CODE> when
date_column was declared as <CODE>NOT NULL</CODE>.
<LI>

Fixed bug with <CODE>BDB</CODE> tables and keys on <CODE>BLOB</CODE> columns.
<LI>

Fixed bug in <CODE>MERGE</CODE> tables on OS with 32-bit file pointers.
<LI>

Fixed bug in <CODE>TIME_TO_SEC()</CODE> when using negative values.
</UL>



<H3><A NAME="News-3.23.44" HREF="manual_toc.html#News-3.23.44">C.4.16  Changes in release 3.23.44 (31 Oct 2001)</A></H3>


<UL>
<LI>

Fixed <CODE>Rows_examined</CODE> count in slow query log.
<LI>

Fixed bug when using a reference to an <CODE>AVG()</CODE> column in <CODE>HAVING</CODE>.
<LI>

Fixed that date functions that require correct dates, like
<CODE>DAYOFYEAR(column)</CODE>, will return <CODE>NULL</CODE> for <CODE>0000-00-00</CODE> dates.
<LI>

Fixed bug in const-propagation when comparing columns of different
types. (<CODE>SELECT * FROM date_col="2001-01-01" and date_col=time_col</CODE>)
<LI>

Fixed bug that caused error message <CODE>Can't write, because of unique
constraint</CODE> with some <CODE>GROUP BY</CODE> queries.
<LI>

Fixed problem with <CODE>sjis</CODE> character strings used within quoted table
names.
<LI>

Fixed core dump when using <CODE>CREATE ... FULLTEXT</CODE> keys with other
storage engines than <CODE>MyISAM</CODE>.
<LI>

Don't use <CODE>signal()</CODE> on Windows because this appears to not be
100% reliable.
<LI>

Fixed bug when doing <CODE>WHERE col_name=NULL</CODE> on an indexed column
that had <CODE>NULL</CODE> values.
<LI>

Fixed bug when doing <CODE>LEFT JOIN ...  ON (col_name = constant) WHERE col_name = constant</CODE>.
<LI>

When using replications, aborted queries that contained <CODE>%</CODE> could cause
a core dump.
<LI>

<CODE>TCP_NODELAY</CODE> was not used on some systems. (Speed problem.)
<LI>

Applied portability fixes for OS/2. (Patch by Yuri Dario.)
</UL>

<P>
The following changes are for <CODE>InnoDB</CODE> tables:

</P>

<UL>
<LI>

Add missing <CODE>InnoDB</CODE> variables to <CODE>SHOW VARIABLES</CODE>.
<LI>

Foreign key checking is now done for <CODE>InnoDB</CODE> tables.
<LI>

<CODE>DROP DATABASE</CODE> now works also for <CODE>InnoDB</CODE> tables.
<LI>

<CODE>InnoDB</CODE> now supports data files and raw disk partitions bigger
than 4GB on those operating systems that have big files.
<LI>

<CODE>InnoDB</CODE> calculates better table cardinality estimates for the
MySQL optimizer.
<LI>

Accent characters in the default character set <CODE>latin1</CODE> are ordered
according to the MySQL ordering.

Note: If you are using <CODE>latin1</CODE> and have inserted characters whose
code is greater than 127 into an indexed <CODE>CHAR</CODE> column, you should
run <CODE>CHECK TABLE</CODE> on your table when you upgrade to 3.23.44, and
drop and reimport the table if <CODE>CHECK TABLE</CODE> reports an error!
<LI>

A new <TT>`my.cnf'</TT> parameter, <CODE>innodb_thread_concurrency</CODE>, helps in
performance tuning in heavily concurrent environments.
<LI>

A new <TT>`my.cnf'</TT> parameter, <CODE>innodb_fast_shutdown</CODE>, speeds up
server shutdown.
<LI>

A new <TT>`my.cnf'</TT> parameter, <CODE>innodb_force_recovery</CODE>, helps to save
your data in case the disk image of the database becomes corrupt.
<LI>

<CODE>innodb_monitor</CODE> has been improved and a new
<CODE>innodb_table_monitor</CODE> added.
<LI>

Increased maximum key length from 500 to 7000 bytes.
<LI>

Fixed a bug in replication of <CODE>AUTO_INCREMENT</CODE> columns with
multiple-line inserts.
<LI>

Fixed a bug when the case of letters changes in an update of an indexed
secondary column.
<LI>

Fixed a hang when there are more than 24 data files.
<LI>

Fixed a crash when <CODE>MAX(col)</CODE> is selected from an empty table, and
<CODE>col</CODE> is not the first column in a multi-column index.
<LI>

Fixed a bug in purge which could cause crashes.
</UL>



<H3><A NAME="News-3.23.43" HREF="manual_toc.html#News-3.23.43">C.4.17  Changes in release 3.23.43 (04 Oct 2001)</A></H3>


<UL>
<LI>

Fixed a bug in <CODE>INSERT DELAYED</CODE> and <CODE>FLUSH TABLES</CODE> introduced
in 3.23.42.
<LI>

Fixed unlikely bug, which returned non-matching rows, in <CODE>SELECT</CODE> with
many tables and multi-column indexes and 'range' type.
<LI>

Fixed an unlikely core dump bug when doing <CODE>EXPLAIN SELECT</CODE> when using
many tables and <CODE>ORDER BY</CODE>.
<LI>

Fixed bug in <CODE>LOAD DATA FROM MASTER</CODE> when using table with
<CODE>CHECKSUM=1</CODE>.
<LI>

Added unique error message when a DEADLOCK occurs during a transaction with
<CODE>BDB</CODE> tables.
<LI>

Fixed problem with <CODE>BDB</CODE> tables and <CODE>UNIQUE</CODE> columns defined
as <CODE>NULL</CODE>.
<LI>

Fixed problem with <CODE>myisampack</CODE> when using pre-space filled <CODE>CHAR</CODE>
columns.
<LI>

Applied patch from Yuri Dario for OS/2.
<LI>

Fixed bug in <CODE>--safe-user-create</CODE>.
</UL>



<H3><A NAME="News-3.23.42" HREF="manual_toc.html#News-3.23.42">C.4.18  Changes in release 3.23.42 (08 Sep 2001)</A></H3>


<UL>
<LI>

Fixed problem when using <CODE>LOCK TABLES</CODE> and <CODE>BDB</CODE> tables.
<LI>

Fixed problem with <CODE>REPAIR TABLE</CODE> on <CODE>MyISAM</CODE> tables with row
lengths in the range from 65517 to 65520 bytes.
<LI>

Fixed rare hang when doing <CODE>mysqladmin shutdown</CODE> when there was
a lot of activity in other threads.
<LI>

Fixed problem with <CODE>INSERT DELAYED</CODE> where delayed thread could be
hanging on <CODE>upgrading locks</CODE> for no apparent reason.
<LI>

Fixed problem with <CODE>myisampack</CODE> and <CODE>BLOB</CODE>.
<LI>

Fixed problem when one edited <TT>`.MRG'</TT> tables by hand.
(Patch from Benjamin Pflugmann).
<LI>

Enforce that all tables in a <CODE>MERGE</CODE> table come from the same
database.
<LI>

Fixed bug with <CODE>LOAD DATA INFILE</CODE> and transactional tables.
<LI>

Fix bug when using <CODE>INSERT DELAYED</CODE> with wrong column definition.
<LI>

Fixed core dump during <CODE>REPAIR TABLE</CODE> of some particularly broken tables.
<LI>

Fixed bug in <CODE>InnoDB</CODE> and <CODE>AUTO_INCREMENT</CODE> columns.
<LI>

Fixed bug in <CODE>InnoDB</CODE> and <CODE>RENAME TABLE</CODE> columns.
<LI>

Fixed critical bug in <CODE>InnoDB</CODE> and <CODE>BLOB</CODE> columns.  If you have
used <CODE>BLOB</CODE> columns larger than 8000 bytes in an <CODE>InnoDB</CODE>
table, it is necessary to dump the table with <CODE>mysqldump</CODE>, drop it and
restore it from the dump.
<LI>

Applied large patch for OS/2 from Yuri Dario.
<LI>

Fixed problem with <CODE>InnoDB</CODE> when one could get the error <CODE>Can't
execute the given command...</CODE> even when no transaction was active.
<LI>

Applied some minor fixes that concern Gemini.
<LI>

Use real arithmetic operations even in integer context if not
all arguments are integers. (Fixes uncommon bug in some integer
contexts).
<LI>

Don't force everything to lowercase on Windows. (To fix problem
with Windows and <CODE>ALTER TABLE</CODE>.)  Now <CODE>--lower_case_table_names</CODE>
also works on Unix.
<LI>

Fixed that automatic rollback is done when thread end doesn't lock
other threads.
</UL>



<H3><A NAME="News-3.23.41" HREF="manual_toc.html#News-3.23.41">C.4.19  Changes in release 3.23.41 (11 Aug 2001)</A></H3>


<UL>
<LI>

Added <CODE>--sql-mode=value[,value[,value]]</CODE> option to <CODE>mysqld</CODE>.
See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.
<LI>

Fixed possible problem with <CODE>shutdown</CODE> on Solaris where the
<TT>`.pid'</TT> file wasn't deleted.
<LI>

<CODE>InnoDB</CODE> now supports &#60; 4GB rows. The former limit was 8000 bytes.
<LI>

The <CODE>doublewrite</CODE> file flush method is used in <CODE>InnoDB</CODE>.
It reduces the need for Unix <CODE>fsync()</CODE> calls to a fraction and
improves performance on most Unix flavors.
<LI>

You can now use the <CODE>InnoDB</CODE> Monitor to print a lot of <CODE>InnoDB</CODE> state
information, including locks, to the standard output.  This is useful in
performance tuning.
<LI>

Several bugs which could cause hangs in <CODE>InnoDB</CODE> have been fixed.
<LI>

Split <CODE>record_buffer</CODE> to <CODE>record_buffer</CODE> and
<CODE>record_rnd_buffer</CODE>.  To make things compatible to previous MySQL
versions, if <CODE>record_rnd_buffer</CODE> is not set, then it takes the
value of <CODE>record_buffer</CODE>.
<LI>

Fixed optimizing bug in <CODE>ORDER BY</CODE> where some <CODE>ORDER BY</CODE> parts
where wrongly removed.
<LI>

Fixed overflow bug with <CODE>ALTER TABLE</CODE> and <CODE>MERGE</CODE> tables.
<LI>

Added prototypes for <CODE>my_thread_init()</CODE> and <CODE>my_thread_end()</CODE> to
<TT>`mysql_com.h'</TT>
<LI>

Added <CODE>--safe-user-create</CODE> option to <CODE>mysqld</CODE>.
<LI>

Fixed bug in <CODE>SELECT DISTINCT ... HAVING</CODE> that caused error message
<CODE>Can't find record in #...</CODE>
</UL>



<H3><A NAME="News-3.23.40" HREF="manual_toc.html#News-3.23.40">C.4.20  Changes in release 3.23.40</A></H3>


<UL>
<LI>

Fixed problem with <CODE>--low-priority-updates</CODE> and <CODE>INSERT</CODE> statements.
<LI>

Fixed bug in slave thread when under some rare circumstances it could
get 22 bytes ahead on the offset in the master.
<LI>

Added <CODE>slave_net_timeout</CODE> for replication.
<LI>

Fixed problem with <CODE>UPDATE</CODE> and <CODE>BDB</CODE> tables.
<LI>

Fixed hard bug in <CODE>BDB</CODE> tables when using key parts.
<LI>

Fixed problem when using <CODE>GRANT FILE ON database.* ...</CODE>; previously
we added the <CODE>DROP</CODE> privilege for the database.
<LI>

Fixed <CODE>DELETE FROM tbl_name ... LIMIT 0</CODE> and
<CODE>UPDATE FROM tbl_name ... LIMIT 0</CODE>, which acted as though the
<CODE>LIMIT</CODE> clause was not present (they deleted or updated all selected
rows).
<LI>

<CODE>CHECK TABLE</CODE> now checks whether an <CODE>AUTO_INCREMENT</CODE> column contains
the value 0.
<LI>

Sending a <CODE>SIGHUP</CODE> to <CODE>mysqld</CODE> will now only flush the logs,
not reset the replication.
<LI>

Fixed parser to allow floats of type <CODE>1.0e1</CODE> (no sign after <CODE>e</CODE>).
<LI>

Option <CODE>--force</CODE> to <CODE>myisamchk</CODE> now also updates states.
<LI>

Added option <CODE>--warnings</CODE> to <CODE>mysqld</CODE>. Now <CODE>mysqld</CODE>
prints the error <CODE>Aborted connection</CODE> only if this option is used.
<LI>

Fixed problem with <CODE>SHOW CREATE TABLE</CODE> when you didn't have a
<CODE>PRIMARY KEY</CODE>.
<LI>

Properly fixed the rename of <CODE>innodb_unix_file_flush_method</CODE> variable to
<CODE>innodb_flush_method</CODE>.
<LI>

Fixed bug when converting <CODE>BIGINT UNSIGNED</CODE> to <CODE>DOUBLE</CODE>. This caused
a problem when doing comparisons with <CODE>BIGINT</CODE> values outside of the
signed range.
<LI>

Fixed bug in <CODE>BDB</CODE> tables when querying empty tables.
<LI>

Fixed a bug when using <CODE>COUNT(DISTINCT)</CODE> with <CODE>LEFT JOIN</CODE> and
there weren't any matching rows.
<LI>

Removed all documentation referring to the <CODE>GEMINI</CODE> table
type. <CODE>GEMINI</CODE> is not released under an <CODE>Open Source</CODE> license.
</UL>



<H3><A NAME="News-3.23.39" HREF="manual_toc.html#News-3.23.39">C.4.21  Changes in release 3.23.39 (12 Jun 2001)</A></H3>


<UL>
<LI>

The <CODE>AUTO_INCREMENT</CODE> sequence wasn't reset when dropping
and adding an <CODE>AUTO_INCREMENT</CODE> column.
<LI>

<CODE>CREATE ... SELECT</CODE> now creates non-unique indexes delayed.
<LI>

Fixed problem where <CODE>LOCK TABLES tbl_name READ</CODE> followed by
<CODE>FLUSH TABLES</CODE> put an exclusive lock on the table.
<LI>

<CODE>REAL @variable</CODE> values were represented with only 2 digits when
converted to strings.
<LI>

Fixed problem that client ``hung'' when <CODE>LOAD TABLE FROM MASTER</CODE> failed.
<LI>

<CODE>myisamchk --fast --force</CODE> will no longer repair tables
that only had the open count wrong.
<LI>

Added functions to handle symbolic links to make life easier in 4.0.
<LI>

We are now using the <CODE>-lcma</CODE> thread library on HP-UX 10.20 so
that MySQL will be more stable on HP-UX.
<LI>

Fixed problem with <CODE>IF()</CODE> and number of decimals in the result.
<LI>

Fixed date-part extraction functions to work with dates where day
and/or month is 0.
<LI>

Extended argument length in option files from 256 to 512 chars.
<LI>

Fixed problem with shutdown when <CODE>INSERT DELAYED</CODE> was waiting for
a <CODE>LOCK TABLE</CODE>.
<LI>

Fixed core dump bug in <CODE>InnoDB</CODE> when tablespace was full.
<LI>

Fixed problem with <CODE>MERGE</CODE> tables and big tables (larger than 4G)
when using <CODE>ORDER BY</CODE>.
</UL>



<H3><A NAME="News-3.23.38" HREF="manual_toc.html#News-3.23.38">C.4.22  Changes in release 3.23.38 (09 May 2001)</A></H3>


<UL>
<LI>

Fixed a bug when <CODE>SELECT</CODE> from <CODE>MERGE</CODE> table
sometimes results in incorrectly ordered rows.
<LI>

Fixed a bug in <CODE>REPLACE()</CODE> when using the <CODE>ujis</CODE> character set.
<LI>

Applied Sleepycat <CODE>BDB</CODE> patches 3.2.9.1 and 3.2.9.2.
<LI>

Added <CODE>--skip-stack-trace</CODE> option to <CODE>mysqld</CODE>.
<LI>

<CODE>CREATE TEMPORARY</CODE> now works with <CODE>InnoDB</CODE> tables.
<LI>

<CODE>InnoDB</CODE> now promotes sub keys to whole keys.
<LI>

Added option <CODE>CONCURRENT</CODE> to <CODE>LOAD DATA</CODE>.
<LI>

Better error message when slave <CODE>max_allowed_packet</CODE> is too low to
read a very long log event from the master.
<LI>

Fixed bug when too many rows where removed when using
<CODE>SELECT DISTINCT ... HAVING</CODE>.
<LI>

<CODE>SHOW CREATE TABLE</CODE> now returns <CODE>TEMPORARY</CODE> for temporary tables.
<LI>

Added <CODE>Rows_examined</CODE> to slow query log.
<LI>

Fixed problems with function returning empty string when used together with
a group function and a <CODE>WHERE</CODE> that didn't match any rows.
<LI>

New program <CODE>mysqlcheck</CODE>.
<LI>

Added database name to output for administrative commands like <CODE>CHECK
TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, <CODE>OPTIMIZE TABLE</CODE>.
<LI>

Lots of portability fixes for <CODE>InnoDB</CODE>.
<LI>

Changed optimizer so that queries like
<CODE>SELECT * FROM tbl_name,tbl_name2 ... ORDER BY key_part1 LIMIT row_count</CODE>
will use index on <CODE>key_part1</CODE> instead of <CODE>filesort</CODE>.
<LI>

Fixed bug when doing
<CODE>LOCK TABLE to_table WRITE,...; INSERT INTO to_table... SELECT ...</CODE>
when <CODE>to_table</CODE> was empty.
<LI>

Fixed bug with <CODE>LOCK TABLE</CODE> and <CODE>BDB</CODE> tables.
</UL>



<H3><A NAME="News-3.23.37" HREF="manual_toc.html#News-3.23.37">C.4.23  Changes in release 3.23.37 (17 Apr 2001)</A></H3>


<UL>
<LI>

Fixed a bug when using <CODE>MATCH()</CODE> in <CODE>HAVING</CODE> clause.
<LI>

Fixed a bug when using <CODE>HEAP</CODE> tables with <CODE>LIKE</CODE>.
<LI>

Added <CODE>--mysql-version</CODE> option to <CODE>safe_mysqld</CODE>
<LI>

Changed <CODE>INNOBASE</CODE> to <CODE>InnoDB</CODE> (because the <CODE>INNOBASE</CODE>
name was already used). All <CODE>configure</CODE> options and <CODE>mysqld</CODE>
start options now use <CODE>innodb</CODE> instead of <CODE>innobase</CODE>. This
means that before upgrading to this version, you have to change any
configuration files where you have used <CODE>innobase</CODE> options!
<LI>

Fixed bug when using indexes on <CODE>CHAR(255) NULL</CODE> columns.
<LI>

Slave thread will now be started even if <CODE>master-host</CODE> is not set, as
long as <CODE>server-id</CODE> is set and valid <TT>`master.info'</TT> is present.
<LI>

Partial updates (terminated with kill) are now logged with a special error
code to the binary log. Slave will refuse to execute them if the error code
indicates the update was terminated abnormally, and will have to be recovered
with <CODE>SET SQL_SLAVE_SKIP_COUNTER=1; SLAVE START</CODE> after a manual sanity
check/correction of data integrity.
<LI>

Fixed bug that erroneously logged a drop of internal temporary table
on thread termination to the binary log -- this bug affected replication.
<LI>

Fixed a bug in <CODE>REGEXP</CODE> on 64-bit machines.
<LI>

<CODE>UPDATE</CODE> and <CODE>DELETE</CODE> with <CODE>WHERE unique_key_part IS NULL</CODE>
didn't update/delete all rows.
<LI>

Disabled <CODE>INSERT DELAYED</CODE> for tables that support transactions.
<LI>

Fixed bug when using date functions on <CODE>TEXT</CODE>/<CODE>BLOB</CODE> column
with wrong date format.
<LI>

UDFs now also work on Windows. (Patch by Ralph Mason.)
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> and <CODE>LOAD DATA INFILE</CODE> that disabled
key-sorting. These commands should now be faster in most cases.
<LI>

Fixed performance bug where reopened tables (tables that had been
waiting for <CODE>FLUSH</CODE> or <CODE>REPAIR TABLE</CODE>) would not use indexes for the
next query.
<LI>

Fixed problem with <CODE>ALTER TABLE</CODE> to <CODE>InnoDB</CODE> tables on FreeBSD.
<LI>

Added <CODE>mysqld</CODE> variables <CODE>myisam_max_sort_file_size</CODE> and
<CODE>myisam_max_extra_sort_file_size</CODE>.
<LI>

Initialize signals early to avoid problem with signals in <CODE>InnoDB</CODE>.
<LI>

Applied patch for the <CODE>tis620</CODE> character set to make comparisons
case-independent and to fix a bug in <CODE>LIKE</CODE> for this character set.
<STRONG>Note:</STRONG> All tables that uses the <CODE>tis620</CODE> character set must be
fixed with  <CODE>myisamchk -r</CODE> or <CODE>REPAIR TABLE</CODE> !
<LI>

Added <CODE>--skip-safemalloc</CODE> option to <CODE>mysqld</CODE>.
</UL>



<H3><A NAME="News-3.23.36" HREF="manual_toc.html#News-3.23.36">C.4.24  Changes in release 3.23.36 (27 Mar 2001)</A></H3>


<UL>
<LI>

Fixed a bug that allowed use of database names containing a <SAMP>`.'</SAMP>
character.  This fixes a serious security issue when <CODE>mysqld</CODE> is run
as root.
<LI>

Fixed bug when thread creation failed (could happen when doing a <STRONG>lot</STRONG>
of connections in a short time).
<LI>

Fixed some problems with <CODE>FLUSH TABLES</CODE> and <CODE>TEMPORARY</CODE> tables.
(Problem with freeing the key cache and error <CODE>Can't reopen table...</CODE>.)
<LI>

Fixed a problem in <CODE>InnoDB</CODE> with other character sets than <CODE>latin1</CODE>
and another problem when using many columns.
<LI>

Fixed bug that caused a core dump when using a very complex query involving
<CODE>DISTINCT</CODE> and summary functions.
<LI>

Added <CODE>SET TRANSACTION ISOLATION LEVEL ...</CODE>
<LI>

Added <CODE>SELECT ... FOR UPDATE</CODE>.
<LI>

Fixed bug where the number of affected rows was not returned when MySQL
was compiled without transaction support.
<LI>

Fixed a bug in <CODE>UPDATE</CODE> where keys weren't always used to find the
rows to be updated.
<LI>

Fixed a bug in <CODE>CONCAT_WS()</CODE> where it returned incorrect results.
<LI>

Changed <CODE>CREATE ... SELECT</CODE> and <CODE>INSERT ... SELECT</CODE> to not
allow concurrent inserts as this could make the binary log hard to repeat.
(Concurrent inserts are enabled if you are not using the binary or update log.)
<LI>

Changed some macros to be able to use fast mutex with <CODE>glibc</CODE> 2.2.
</UL>



<H3><A NAME="News-3.23.35" HREF="manual_toc.html#News-3.23.35">C.4.25  Changes in release 3.23.35 (15 Mar 2001)</A></H3>


<UL>
<LI>

Fixed newly introduced bug in <CODE>ORDER BY</CODE>.
<LI>

Fixed wrong define <CODE>CLIENT_TRANSACTIONS</CODE>.
<LI>

Fixed bug in <CODE>SHOW VARIABLES</CODE> when using <CODE>INNOBASE</CODE> tables.
<LI>

Setting and using user variables in <CODE>SELECT DISTINCT</CODE> didn't work.
<LI>

Tuned <CODE>SHOW ANALYZE</CODE> for small tables.
<LI>

Fixed handling of arguments in the benchmark script <CODE>run-all-tests</CODE>.
</UL>



<H3><A NAME="News-3.23.34a" HREF="manual_toc.html#News-3.23.34a">C.4.26  Changes in release 3.23.34a</A></H3>


<UL>
<LI>

Added extra files to the distribution to allow <CODE>INNOBASE</CODE> support
to be compiled.
</UL>



<H3><A NAME="News-3.23.34" HREF="manual_toc.html#News-3.23.34">C.4.27  Changes in release 3.23.34 (10 Mar 2001)</A></H3>


<UL>
<LI>

Added the <CODE>INNOBASE</CODE> storage engine and the <CODE>BDB</CODE> storage engine
to the MySQL source distribution.
<LI>

Updated the documentation about <CODE>GEMINI</CODE> tables.
<LI>

Fixed a bug in <CODE>INSERT DELAYED</CODE> that caused threads to hang when
inserting <CODE>NULL</CODE> into an <CODE>AUTO_INCREMENT</CODE> column.
<LI>

Fixed a bug in <CODE>CHECK TABLE</CODE> / <CODE>REPAIR TABLE</CODE> that could cause
a thread to hang.
<LI>

<CODE>REPLACE</CODE> will not replace a row that conflicts with an
<CODE>AUTO_INCREMENT</CODE> generated key.
<LI>

<CODE>mysqld</CODE> now only sets <CODE>CLIENT_TRANSACTIONS</CODE> in
<CODE>mysql-&#62;server_capabilities</CODE> if the server supports a
transaction-safe storage engine.
<LI>

Fixed <CODE>LOAD DATA INFILE</CODE> to allow numeric values to be read into
<CODE>ENUM</CODE> and <CODE>SET</CODE> columns.
<LI>

Improved error diagnostic for slave thread exit.
<LI>

Fixed bug in <CODE>ALTER TABLE ... ORDER BY</CODE>.
<LI>

Added <CODE>max_user_connections</CODE> variable to <CODE>mysqld</CODE>.
<LI>

Limit query length for replication by <CODE>max_allowed_packet</CODE>, not the
arbitrary limit of 4MB.
<LI>

Allow space around <CODE>=</CODE> in argument to <CODE>--set-variable</CODE>.
<LI>

Fixed problem in automatic repair that could leave some threads in state
<CODE>Waiting for table</CODE>.
<LI>

<CODE>SHOW CREATE TABLE</CODE> now displays the <CODE>UNION=()</CODE> for <CODE>MERGE</CODE>
tables.
<LI>

<CODE>ALTER TABLE</CODE> now remembers the old <CODE>UNION=()</CODE> definition.
<LI>

Fixed bug when replicating timestamps.
<LI>

Fixed bug in bidirectional replication.
<LI>

Fixed bug in the <CODE>BDB</CODE> storage engine that occurred when using an index
on multiple-part key where a key part may be <CODE>NULL</CODE>.
<LI>

Fixed <CODE>MAX()</CODE> optimization on sub-key for <CODE>BDB</CODE> tables.
<LI>

Fixed problem where garbage results were returned when using <CODE>BDB</CODE>
tables and <CODE>BLOB</CODE> or <CODE>TEXT</CODE> fields when joining many tables.
<LI>

Fixed a problem with <CODE>BDB</CODE> tables and <CODE>TEXT</CODE> columns.
<LI>

Fixed bug when using a <CODE>BLOB</CODE> key where a const row wasn't found.
<LI>

Fixed that <CODE>mysqlbinlog</CODE> writes the timestamp value for each query.
This ensures that one gets same values for date functions like <CODE>NOW()</CODE>
when using <CODE>mysqlbinlog</CODE> to pipe the queries to another server.
<LI>

Allow <CODE>--skip-gemini</CODE>, <CODE>--skip-bdb</CODE>, and <CODE>--skip-innodb</CODE>
options to be specified when invoking <CODE>mysqld</CODE>, even if these storage
engines are not compiled in to <CODE>mysqld</CODE>.
<LI>

You can now use <CODE>ASC</CODE> and <CODE>DESC</CODE> with <CODE>GROUP BY</CODE> columns
to specify a sort order.
<LI>

Fixed a deadlock in the <CODE>SET</CODE> code, when one ran <CODE>SET @foo=bar</CODE>,
where <CODE>bar</CODE> is a column reference, an error was not properly generated.
</UL>



<H3><A NAME="News-3.23.33" HREF="manual_toc.html#News-3.23.33">C.4.28  Changes in release 3.23.33 (09 Feb 2001)</A></H3>


<UL>
<LI>

Fixed DNS lookups not to use the same mutex as the hostname
cache.  This will enable known hosts to be quickly resolved even if a
DNS lookup takes a long time.
<LI>

Added <CODE>--character-sets-dir</CODE> option to <CODE>myisampack</CODE>.
<LI>

Removed warnings when running <CODE>REPAIR TABLE ... EXTENDED</CODE>.
<LI>

Fixed a bug that caused a core dump when using <CODE>GROUP BY</CODE> on an alias,
where the alias was the same as an existing column name.
<LI>

Added <CODE>SEQUENCE()</CODE> as an example UDF function.
<LI>

Changed <CODE>mysql_install_db</CODE> to use <CODE>BINARY</CODE> for <CODE>CHAR</CODE>
columns in the privilege tables.
<LI>

Changed <CODE>TRUNCATE tbl_name</CODE> to <CODE>TRUNCATE TABLE tbl_name</CODE>
to use the same syntax as Oracle.  Until 4.0 we will also allow
<CODE>TRUNCATE tbl_name</CODE> to not crash old code.
<LI>

Fixed ``no found rows'' bug in <CODE>MyISAM</CODE> tables when a <CODE>BLOB</CODE> was
first part of a multiple-part key.
<LI>

Fixed bug where <CODE>CASE</CODE> didn't work with <CODE>GROUP BY</CODE>.
<LI>

Added <CODE>--sort-recover</CODE> option to <CODE>myisamchk</CODE>.
<LI>

<CODE>myisamchk -S</CODE> and <CODE>OPTIMIZE TABLE</CODE> now work on Windows.
<LI>

Fixed bug when using <CODE>DISTINCT</CODE> on results from functions that referred
to a group function, like:

<PRE>
SELECT a, DISTINCT SEC_TO_TIME(SUM(a))
FROM tbl_name GROUP BY a, b;
</PRE>

<LI>

Fixed buffer overrun in <CODE>libmysqlclient</CODE> library.
Fixed bug in handling <CODE>STOP</CODE> event after <CODE>ROTATE</CODE> event in
replication.
<LI>

Fixed another buffer overrun in <CODE>DROP DATABASE</CODE>.
<LI>

Added <CODE>Table_locks_immediate</CODE> and <CODE>Table_locks_waited</CODE> status
variables.
<LI>

Fixed bug in replication that broke slave server start with existing
<TT>`master.info'</TT>. This fixes a bug introduced in 3.23.32.
<LI>

Added <CODE>SET SQL_SLAVE_SKIP_COUNTER=n</CODE> command to recover from
replication glitches without a full database copy.
<LI>

Added <CODE>max_binlog_size</CODE> variable; the binary log will be rotated
automatically when the size crosses the limit.
<LI>

Added <CODE>Last_Error</CODE>, <CODE>Last_Errno</CODE>, and <CODE>Slave_skip_counter</CODE>
variables to <CODE>SHOW SLAVE STATUS</CODE>.
<LI>

Fixed bug in <CODE>MASTER_POS_WAIT()</CODE> function.
<LI>

Execute core dump handler on <CODE>SIGILL</CODE>, and <CODE>SIGBUS</CODE> in addition to
<CODE>SIGSEGV</CODE>.
<LI>

On x86 Linux, print the current query and thread (connection) id, if
available, in the core dump handler.
<LI>

Fixed several timing bugs in the test suite.
<LI>

Extended <CODE>mysqltest</CODE> to take care of the timing issues in the test
suite.
<LI>

<CODE>ALTER TABLE</CODE> can now be used to change the definition for a
<CODE>MERGE</CODE> table.
<LI>

Fixed creation of <CODE>MERGE</CODE> tables on Windows.
<LI>

Portability fixes for OpenBSD and OS/2.
<LI>

Added <CODE>--temp-pool</CODE> option to <CODE>mysqld</CODE>.  Using this option
will cause most temporary files created to use a small set of names,
rather than a unique name for each new file.  This is to work around a
problem in the Linux kernel dealing with creating a bunch of new files
with different names.  With the old behavior, Linux seems to "leak"
memory, as it's being allocated to the directory entry cache instead of
the disk cache.
</UL>



<H3><A NAME="News-3.23.32" HREF="manual_toc.html#News-3.23.32">C.4.29  Changes in release 3.23.32 (22 Jan 2001: Production)</A></H3>


<UL>
<LI>

Changed code to get around compiler bug in Compaq C++ on OSF/1, that broke
<CODE>BACKUP TABLE</CODE>, <CODE>RESTORE TABLE</CODE>, <CODE>CHECK TABLE</CODE>, <CODE>REPAIR TABLE</CODE>, and
<CODE>ANALYZE TABLE</CODE>.
<LI>

Added option <CODE>FULL</CODE> to <CODE>SHOW COLUMNS</CODE>. Now we show the
privilege list for the columns only if this option is given.
<LI>

Fixed bug in <CODE>SHOW LOGS</CODE> when there weren't any <CODE>BDB</CODE> logs.
<LI>

Fixed a timing problem in replication that could delay sending an update
to the client until a new update was done.
<LI>

Don't convert field names when using <CODE>mysql_list_fields()</CODE>.  This is
to keep this code compatible with <CODE>SHOW FIELDS</CODE>.
<LI>

<CODE>MERGE</CODE> tables didn't work on Windows.
<LI>

Fixed problem with <CODE>SET PASSWORD=...</CODE> on Windows.
<LI>

Added missing <TT>`my_config.h'</TT> to RPM distribution.
<LI>

<CODE>TRIM("foo" from "foo")</CODE> didn't return an empty string.
<LI>

Added <CODE>--with-version-suffix</CODE> option to <CODE>configure</CODE>.
<LI>

Fixed core dump when client aborted connection without <CODE>mysql_close()</CODE>.
<LI>

Fixed a bug in <CODE>RESTORE TABLE</CODE> when trying to restore from a non-existent
directory.
<LI>

Fixed a bug which caused a core dump on the slave when replicating
<CODE>SET PASSWORD</CODE>.
<LI>

Added <CODE>MASTER_POS_WAIT()</CODE>.
</UL>



<H3><A NAME="News-3.23.31" HREF="manual_toc.html#News-3.23.31">C.4.30  Changes in release 3.23.31 (17 Jan 2001)</A></H3>


<UL>
<LI>

The test suite now tests all reachable <CODE>BDB</CODE> interface code.  During
testing we found and fixed many errors in the interface code.
<LI>

Using <CODE>HAVING</CODE> on an empty table could produce one result row when
it shouldn't.
<LI>

Fixed the MySQL RPM so it no longer depends on Perl5.
<LI>

Fixed some problems with <CODE>HEAP</CODE> tables on Windows.
<LI>

<CODE>SHOW TABLE STATUS</CODE> didn't show correct average row length for tables
larger than 4GB.
<LI>

<CODE>CHECK TABLE ... EXTENDED</CODE> didn't check row links for fixed size tables.
<LI>

Added option <CODE>MEDIUM</CODE> to <CODE>CHECK TABLE</CODE>.
<LI>

Fixed problem when using <CODE>DECIMAL()</CODE> keys on negative numbers.
<LI>

<CODE>HOUR()</CODE> (and some other <CODE>TIME</CODE> functions) on a <CODE>CHAR</CODE> column
always returned <CODE>NULL</CODE>.
<LI>

Fixed security bug in something (please upgrade if you are using an earlier
MySQL 3.23 version).
<LI>

Fixed buffer overflow bug when writing a certain error message.
<LI>

Added usage of <CODE>setrlimit()</CODE> on Linux to get
<CODE>-O --open_files_limit=#</CODE> to work on Linux.
<LI>

Added <CODE>bdb_version</CODE> variable to <CODE>mysqld</CODE>.
<LI>

Fixed bug when using expression of type:

<PRE>
SELECT ... FROM t1 LEFT JOIN t2 ON (t1.a=t2.a) WHERE t1.a=t2.a
</PRE>

In this case the test in the <CODE>WHERE</CODE> clause was wrongly optimized away.
<LI>

Fixed bug in <CODE>MyISAM</CODE> when deleting keys with possible <CODE>NULL</CODE>
values, but the first key-column was not a prefix-compressed text column.
<LI>

Fixed <CODE>mysql.server</CODE> to read the <CODE>[mysql.server]</CODE> option file group
rather than the <CODE>[mysql_server]</CODE> group.
<LI>

Fixed <CODE>safe_mysqld</CODE> and <CODE>mysql.server</CODE> to also read the
<CODE>server</CODE> option section.
<LI>

Added <CODE>Threads_created</CODE> status variable to <CODE>mysqld</CODE>.
</UL>



<H3><A NAME="News-3.23.30" HREF="manual_toc.html#News-3.23.30">C.4.31  Changes in release 3.23.30 (04 Jan 2001)</A></H3>


<UL>
<LI>

Added <CODE>SHOW OPEN TABLES</CODE> command.
<LI>

Fixed that <CODE>myisamdump</CODE> works against old <CODE>mysqld</CODE> servers.
<LI>

Fixed <CODE>myisamchk -k#</CODE> so that it works again.
<LI>

Fixed a problem with replication when the binary log file went over 2G
on 32-bit systems.
<LI>

<CODE>LOCK TABLES</CODE> will now automatically start a new transaction.
<LI>

Changed <CODE>BDB</CODE> tables to not use internal subtransactions and reuse
open files to get more speed.
<LI>

Added <CODE>--mysqld=#</CODE> option to <CODE>safe_mysqld</CODE>.
<LI>

Allow hex constants in the <CODE>--fields-*-by</CODE> and
<CODE>--lines-terminated-by</CODE> options to <CODE>mysqldump</CODE> and
<CODE>mysqlimport</CODE>. By Paul DuBois.
<LI>

Added <CODE>--safe-show-database</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added <CODE>have_bdb</CODE>, <CODE>have_gemini</CODE>, <CODE>have_innobase</CODE>,
<CODE>have_raid</CODE> and <CODE>have_openssl</CODE> to <CODE>SHOW VARIABLES</CODE> to make it
easy to test for supported extensions.
<LI>

Added <CODE>--open-files-limit</CODE> option to <CODE>mysqld</CODE>.
<LI>

Changed <CODE>--open-files</CODE> option to <CODE>--open-files-limit</CODE> in
<CODE>safe_mysqld</CODE>.
<LI>

Fixed a bug where some rows were not found with <CODE>HEAP</CODE> tables
that had many keys.
<LI>

Fixed that <CODE>--bdb-no-sync</CODE> works.
<LI>

Changed <CODE>--bdb-recover</CODE> to <CODE>--bdb-no-recover</CODE> as recover should
be on by default.
<LI>

Changed the default number of <CODE>BDB</CODE> locks to 10000.
<LI>

Fixed a bug from 3.23.29 when allocating the shared structure needed
for <CODE>BDB</CODE> tables.
<LI>

Changed <CODE>mysqld_multi.sh</CODE> to use configure variables. Patch by
Christopher McCrory.
<LI>

Added fixing of include files for Solaris 2.8.
<LI>

Fixed bug with <CODE>--skip-networking</CODE> on Debian Linux.
<LI>

Fixed problem that some temporary files where reported as having the
name <CODE>UNOPENED</CODE> in error messages.
<LI>

Fixed bug when running two simultaneous <CODE>SHOW LOGS</CODE> queries.
</UL>



<H3><A NAME="News-3.23.29" HREF="manual_toc.html#News-3.23.29">C.4.32  Changes in release 3.23.29 (16 Dec 2000)</A></H3>


<UL>
<LI>

Configure updates for Tru64, large file support, and better TCP wrapper
support. By Albert Chin-A-Young.
<LI>

Fixed bug in <CODE>&#60;=&#62;</CODE> operator.
<LI>

Fixed bug in <CODE>REPLACE</CODE> with <CODE>BDB</CODE> tables.
<LI>

<CODE>LPAD()</CODE> and <CODE>RPAD()</CODE> will shorten the result string if it's longer
than the length argument.
<LI>

Added <CODE>SHOW LOGS</CODE> command.
<LI>

Remove unused <CODE>BDB</CODE> logs on shutdown.
<LI>

When creating a table, put <CODE>PRIMARY</CODE> keys first, followed by
<CODE>UNIQUE</CODE> keys.
<LI>

Fixed a bug in <CODE>UPDATE</CODE> involving multiple-part keys where you
specified all key parts both in the update and the <CODE>WHERE</CODE> part. In
this case MySQL could try to update a record that didn't match
the whole <CODE>WHERE</CODE> part.
<LI>

Changed drop table to first drop the tables and then the <TT>`.frm'</TT> file.
<LI>

Fixed a bug in the hostname cache which caused <CODE>mysqld</CODE> to report the
hostname as <CODE>''</CODE> in some error messages.
<LI>

Fixed a bug with <CODE>HEAP</CODE> type tables; the variable
<CODE>max_heap_table_size</CODE> wasn't used. Now either <CODE>MAX_ROWS</CODE> or
<CODE>max_heap_table_size</CODE> can be used to limit the size of a <CODE>HEAP</CODE>
type table.
<LI>

Changed the default <CODE>server-id</CODE> value to 1 for masters and 2 for slaves
to make it easier to use the binary log.
<LI>

Renamed <CODE>bdb_lock_max</CODE> variable to <CODE>bdb_max_lock</CODE>.
<LI>

Added support for <CODE>AUTO_INCREMENT</CODE> on sub-fields for <CODE>BDB</CODE> tables.
<LI>

Added <CODE>ANALYZE TABLE</CODE> of <CODE>BDB</CODE> tables.
<LI>

In <CODE>BDB</CODE> tables, we now store the number of rows; this helps to optimize
queries when we need an approximation of the number of rows.
<LI>

If we get an error in a multiple-row statement, we now only roll back the
last statement, not the entire transaction.
<LI>

If you do a <CODE>ROLLBACK</CODE> when you have updated a non-transactional table
you will get an error as a warning.
<LI>

Added <CODE>--bdb-shared-data</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added <CODE>Slave_open_temp_tables</CODE> status variable to <CODE>mysqld</CODE>
<LI>

Added <CODE>binlog_cache_size</CODE> and <CODE>max_binlog_cache_size</CODE> variables to
<CODE>mysqld</CODE>.
<LI>

<CODE>DROP TABLE</CODE>, <CODE>RENAME TABLE</CODE>, <CODE>CREATE INDEX</CODE> and
<CODE>DROP INDEX</CODE> are now transaction endpoints.
<LI>

If you do a <CODE>DROP DATABASE</CODE> on a symbolically linked database, both
the link and the original database are deleted.
<LI>

Fixed <CODE>DROP DATABASE</CODE> to work on OS/2.
<LI>

Fixed bug when doing a <CODE>SELECT DISTINCT ... table1 LEFT JOIN
table2 ...</CODE> when <CODE>table2</CODE> was empty.
<LI>

Added <CODE>--abort-slave-event-count</CODE> and
<CODE>--disconnect-slave-event-count</CODE> options to <CODE>mysqld</CODE> for
debugging and testing of replication.
<LI>

Fixed replication of temporary tables. Handles everything except
slave server restart.
<LI>

<CODE>SHOW KEYS</CODE> now shows whether key is <CODE>FULLTEXT</CODE>.
<LI>

New script <CODE>mysqld_multi</CODE>. See section <A HREF="manual.html#mysqld_multi">5.1.5  The <CODE>mysqld_multi</CODE> Program for Managing Multiple MySQL Servers</A>.
<LI>

Added new script, <CODE>mysql-multi.server.sh</CODE>.  Thanks to
Tim Bunce <a HREF="mailto:Tim.Bunce@ig.co.uk">Tim.Bunce@ig.co.uk</a> for modifying <CODE>mysql.server</CODE> to
easily handle hosts running many <CODE>mysqld</CODE> processes.
<LI>

<CODE>safe_mysqld</CODE>, <CODE>mysql.server</CODE>, and <CODE>mysql_install_db</CODE> have
been modified to use <CODE>mysql_print_defaults</CODE> instead of various hacks
to read the <TT>`my.cnf'</TT> files.  In addition, the handling of various
paths has been made more consistent with how <CODE>mysqld</CODE> handles them
by default.
<LI>

Automatically remove Berkeley DB transaction logs that no longer are in
use.
<LI>

Fixed bug with several <CODE>FULLTEXT</CODE> indexes in one table.
<LI>

Added a warning if number of rows changes on <CODE>REPAIR
TABLE</CODE>/<CODE>OPTIMIZE TABLE</CODE>.
<LI>

Applied patches for OS/2 by <CODE>Yuri Dario</CODE>.
<LI>

<CODE>FLUSH TABLES tbl_name</CODE> didn't always flush the index tree
to disk properly.
<LI>

<CODE>--bootstrap</CODE> is now run in a separate thread. This fixes a problem
that caused <CODE>mysql_install_db</CODE> to core dump on some Linux machines.
<LI>

Changed <CODE>mi_create()</CODE> to use less stack space.
<LI>

Fixed bug with optimizer trying to over-optimize <CODE>MATCH()</CODE> when used
with <CODE>UNIQUE</CODE> key.
<LI>

Changed <CODE>crash-me</CODE> and the MySQL benchmarks to also work
with FrontBase.
<LI>

Allow <CODE>RESTRICT</CODE> and <CODE>CASCADE</CODE> after <CODE>DROP TABLE</CODE> to make
porting easier.
<LI>

Reset status variable which could cause problem if one used <CODE>--slow-log</CODE>.
<LI>

Added <CODE>connect_timeout</CODE> variable to <CODE>mysql</CODE> and <CODE>mysqladmin</CODE>.
<LI>

Added <CODE>connect-timeout</CODE> as an alias for <CODE>timeout</CODE> for option files
read by <CODE>mysql_options()</CODE>.
</UL>



<H3><A NAME="News-3.23.28" HREF="manual_toc.html#News-3.23.28">C.4.33  Changes in release 3.23.28 (22 Nov 2000: Gamma)</A></H3>


<UL>
<LI>

Added new options <CODE>--pager[=...]</CODE>, <CODE>--no-pager</CODE>,
<CODE>--tee=...</CODE> and <CODE>--no-tee</CODE> to the <CODE>mysql</CODE> client.  The
new corresponding interactive commands are <CODE>pager</CODE>, <CODE>nopager</CODE>,
<CODE>tee</CODE> and <CODE>notee</CODE>. See section <A HREF="manual.html#mysql">8.3  <CODE>mysql</CODE>, the Command-Line Tool</A>, <CODE>mysql --help</CODE>
and the interactive help for more information.
<LI>

Fixed crash when automatic repair of <CODE>MyISAM</CODE> table failed.
<LI>

Fixed a major performance bug in the table locking code when a lot
of <CODE>SELECT</CODE>, <CODE>UPDATE</CODE> and <CODE>INSERT</CODE> statements
constantly were running. The symptom was that the <CODE>UPDATE</CODE> and
<CODE>INSERT</CODE> queries were locked for a long time while new <CODE>SELECT</CODE>
statements were executed before the updates.
<LI>

When reading <CODE>options_files</CODE> with <CODE>mysql_options()</CODE> the
<CODE>return-found-rows</CODE> option was ignored.
<LI>

You can now specify <CODE>interactive-timeout</CODE> in the option file that
is read by <CODE>mysql_options()</CODE>. This makes it possible to force
programs that run for a long time (like <CODE>mysqlhotcopy</CODE>) to use the
<CODE>interactive_timeout</CODE> time instead of the <CODE>wait_timeout</CODE> time.
<LI>

Added to the slow query log the time and the username for each logged
query. If you are using <CODE>--log-long-format</CODE> then also queries that
do not use an index are logged, even if the query takes less than
<CODE>long_query_time</CODE> seconds.
<LI>

Fixed a problem in <CODE>LEFT JOIN</CODE> which caused all columns in a reference
table to be <CODE>NULL</CODE>.
<LI>

Fixed a problem when using <CODE>NATURAL JOIN</CODE> without keys.
<LI>

Fixed a bug when using a multiple-part keys where the first part was of type
<CODE>TEXT</CODE> or <CODE>BLOB</CODE>.
<LI>

<CODE>DROP</CODE> of temporary tables wasn't stored in the update/binary log.
<LI>

Fixed a bug where <CODE>SELECT DISTINCT * ... LIMIT row_count</CODE> only returned one row.
<LI>

Fixed a bug in the assembler code in <CODE>strstr()</CODE> for SPARC and cleaned up
the <TT>`global.h'</TT> header file to avoid a problem with bad aliasing with
the compiler submitted with Red Hat 7.0. (Reported by Trond Eivind Glomsr@o{}d)
<LI>

The <CODE>--skip-networking</CODE> option now works properly on NT.
<LI>

Fixed a long outstanding bug in the <CODE>ISAM</CODE> tables when a row with a length
of more than 65KB was shortened by a single byte.
<LI>

Fixed a bug in <CODE>MyISAM</CODE> when running multiple updating processes on
the same table.
<LI>

Allow one to use <CODE>FLUSH TABLE tbl_name</CODE>.
<LI>

Added <CODE>--replicate-ignore-table</CODE>, <CODE>--replicate-do-table</CODE>,
<CODE>--replicate-wild-ignore-table</CODE>, and <CODE>--replicate-wild-do-table</CODE>
options to <CODE>mysqld</CODE>.
<LI>

Changed all log files to use our own <CODE>IO_CACHE</CODE> mechanism instead of
<CODE>FILE</CODE> to avoid OS problems when there are many files open.
<LI>

Added <CODE>--open-files</CODE> and <CODE>--timezone</CODE> options to <CODE>safe_mysqld</CODE>.
<LI>

Fixed a fatal bug in <CODE>CREATE TEMPORARY TABLE ... SELECT ...</CODE>.
<LI>

Fixed a problem with <CODE>CREATE TABLE ... SELECT NULL</CODE>.
<LI>

Added variables <CODE>large_file_support</CODE>,<CODE>net_read_timeout</CODE>,
<CODE>net_write_timeout</CODE> and <CODE>query_buffer_size</CODE> to <CODE>SHOW VARIABLES</CODE>.
<LI>

Added status variables <CODE>Created_tmp_files</CODE> and <CODE>Sort_merge_passes</CODE>
to <CODE>SHOW STATUS</CODE>.
<LI>

Fixed a bug where we didn't allow an index name after the
<CODE>FOREIGN KEY</CODE> definition.
<LI>

Added <CODE>TRUNCATE tbl_name</CODE> as a synonym for
<CODE>DELETE FROM tbl_name</CODE>.
<LI>

Fixed a bug in a <CODE>BDB</CODE> key compare function when comparing part keys.
<LI>

Added <CODE>bdb_lock_max</CODE> variable to <CODE>mysqld</CODE>.
<LI>

Added more tests to the benchmark suite.
<LI>

Fixed an overflow bug in the client code when using overly long database names.
<LI>

<CODE>mysql_connect()</CODE> now aborts on Linux if the server doesn't answer in
<CODE>timeout</CODE> seconds.
<LI>

<CODE>SLAVE START</CODE> did not work if you started with
<CODE>--skip-slave-start</CODE> and had not explicitly run <CODE>CHANGE MASTER TO</CODE>.
<LI>

Fixed the output of <CODE>SHOW MASTER STATUS</CODE> to be consistent with
<CODE>SHOW SLAVE STATUS</CODE>. (It now has no directory in the log name.)
<LI>

Added <CODE>PURGE MASTER LOGS TO</CODE>.
<LI>

Added <CODE>SHOW MASTER LOGS</CODE>.
<LI>

Added <CODE>--safemalloc-mem-limit</CODE> option to <CODE>mysqld</CODE> to simulate memory
shortage when compiled with the <CODE>--with-debug=full</CODE> option.
<LI>

Fixed several core dumps in out-of-memory conditions.
<LI>

<CODE>SHOW SLAVE STATUS</CODE> was using an uninitialized mutex if the slave had
not been started yet.
<LI>

Fixed bug in <CODE>ELT()</CODE> and <CODE>MAKE_SET()</CODE> when the query used
a temporary table.
<LI>

<CODE>CHANGE MASTER TO</CODE> without specifying <CODE>MASTER_LOG_POS</CODE> would
set it to 0 instead of 4 and hit the magic number in the master binary log.
<LI>

<CODE>ALTER TABLE ... ORDER BY ...</CODE> syntax added.  This will create the
new table with the rows in a specific order.
</UL>



<H3><A NAME="News-3.23.27" HREF="manual_toc.html#News-3.23.27">C.4.34  Changes in release 3.23.27 (24 Oct 2000)</A></H3>


<UL>
<LI>

Fixed a bug where the automatic repair of <CODE>MyISAM</CODE> tables sometimes failed
when the data file was corrupt.
<LI>

Fixed a bug in <CODE>SHOW CREATE</CODE> when using <CODE>AUTO_INCREMENT</CODE> columns.
<LI>

Changed <CODE>BDB</CODE> tables to use new compare function in Berkeley DB 3.2.3.
<LI>

You can now use Unix socket files with MIT-pthreads.
<LI>

Added the <CODE>latin5</CODE> (turkish) character set.
<LI>

Small portability fixes.
</UL>



<H3><A NAME="News-3.23.26" HREF="manual_toc.html#News-3.23.26">C.4.35  Changes in release 3.23.26 (18 Oct 2000)</A></H3>


<UL>
<LI>

Renamed <CODE>FLUSH MASTER</CODE> and <CODE>FLUSH SLAVE</CODE> to <CODE>RESET MASTER</CODE>
and <CODE>RESET SLAVE</CODE>.
<LI>

Fixed <CODE>&#60;&#62;</CODE> to work properly with <CODE>NULL</CODE>.
<LI>

Fixed a problem with <CODE>SUBSTRING_INDEX()</CODE> and <CODE>REPLACE()</CODE>.
(Patch by Alexander Igonitchev)
<LI>

Fix <CODE>CREATE TEMPORARY TABLE IF NOT EXISTS</CODE> not to produce an error
if the table exists.
<LI>

If you don't create a <CODE>PRIMARY KEY</CODE> in a <CODE>BDB</CODE> table, a hidden
<CODE>PRIMARY KEY</CODE> will be created.
<LI>

Added read-only-key optimization to <CODE>BDB</CODE> tables.
<LI>

<CODE>LEFT JOIN</CODE> in some cases preferred a full table scan when there was
no <CODE>WHERE</CODE> clause.
<LI>

When using <CODE>--log-slow-queries</CODE>, don't count the time waiting for a lock.
<LI>

Fixed bug in lock code on Windows which could cause the key cache
to report that the key file was crashed even if it was okay.
<LI>

Automatic repair of <CODE>MyISAM</CODE> tables if you start <CODE>mysqld</CODE> with
<CODE>--myisam-recover</CODE>.
<LI>

Removed the <CODE>TYPE=</CODE> keyword from <CODE>CHECK TABLE</CODE> and
<CODE>REPAIR TABLE</CODE>. Allow <CODE>CHECK TABLE</CODE> options to be combined. (You can still
use <CODE>TYPE=</CODE>, but this usage is deprecated.)
<LI>

Fixed mutex bug in the binary replication log -- long update queries could
be read only in part by the slave if it did it at the wrong time, which
was not fatal, but resulted in a performance-degrading reconnect and
a scary message in the error log.
<LI>

Changed the format of the binary log -- added magic number, server
version, binary log version. Added the server ID and query error code for each
query event.
<LI>

Replication thread from the slave now will kill all the stale threads
from the same server.
<LI>

Long replication usernames were not being handled properly.
<LI>

Added <CODE>--replicate-rewrite-db</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added <CODE>--skip-slave-start</CODE> option to <CODE>mysqld</CODE>.
<LI>

Updates that generated an error code (such as <CODE>INSERT INTO foo(some_key)
values (1),(1)</CODE>) erroneously terminated the slave thread.
<LI>

Added optimization of queries where <CODE>DISTINCT</CODE> is used only on columns
from some of the tables.
<LI>

Allow floating-point numbers where there is no sign after the exponent
(like <CODE>1e1</CODE>).
<LI>

<CODE>SHOW GRANTS</CODE> didn't always show all column grants.
<LI>

Added <CODE>--default-extra-file=#</CODE> option to all MySQL clients.
<LI>

Columns referenced in <CODE>INSERT</CODE> statements now are initialized properly.
<LI>

<CODE>UPDATE</CODE> didn't always work when used with a range on a timestamp that
was part of the key that was used to find rows.
<LI>

Fixed a bug in <CODE>FULLTEXT</CODE> index when inserting a <CODE>NULL</CODE> column.
<LI>

Changed to use <CODE>mkstemp()</CODE> instead of <CODE>tempnam()</CODE>. Based
on a patch from John Jones.
</UL>



<H3><A NAME="News-3.23.25" HREF="manual_toc.html#News-3.23.25">C.4.36  Changes in release 3.23.25 (29 Sep 2000)</A></H3>


<UL>
<LI>

Fixed that <CODE>databasename</CODE> works as second argument to <CODE>mysqlhotcopy</CODE>.
<LI>

The values for the <CODE>UMASK</CODE> and <CODE>UMASK_DIR</CODE> environment variables
now can be specified in octal by beginning the value with a zero.
<LI>

Added <CODE>RIGHT JOIN</CODE>. This makes <CODE>RIGHT</CODE> a reserved word.
<LI>

Added <CODE>@@IDENTITY</CODE> as a synonym for <CODE>LAST_INSERT_ID()</CODE>.
(This is for MSSQL compatibility.)
<LI>

Fixed a bug in <CODE>myisamchk</CODE> and <CODE>REPAIR TABLE</CODE> when using <CODE>FULLTEXT</CODE>
index.
<LI>

<CODE>LOAD DATA INFILE</CODE> now works with FIFOs.
(Patch by Toni L. Harbaugh-Blackford.)
<LI>

<CODE>FLUSH LOGS</CODE> broke replication if you specified a log name with an
explicit extension as the value of the <CODE>log-bin</CODE> option.
<LI>

Fixed a bug in <CODE>MyISAM</CODE> with packed multiple-part keys.
<LI>

Fixed crash when using <CODE>CHECK TABLE</CODE> on Windows.
<LI>

Fixed a bug where <CODE>FULLTEXT</CODE> index always used the <CODE>koi8_ukr</CODE>
character set.
<LI>

Fixed privilege checking for <CODE>CHECK TABLE</CODE>.
<LI>

The <CODE>MyISAM</CODE> repair/reindex code didn't use the <CODE>--tmpdir</CODE>
option for its temporary files.
<LI>

Added <CODE>BACKUP TABLE</CODE> and <CODE>RESTORE TABLE</CODE>.
<LI>

Fixed core dump on <CODE>CHANGE MASTER TO</CODE> when the slave did not have
the master to start with.
<LI>

Fixed incorrect <CODE>Time</CODE> in the processlist for <CODE>Connect</CODE> of
the slave thread.
<LI>

The slave now logs when it connects to the master.
<LI>

Fixed a core dump bug when doing <CODE>FLUSH MASTER</CODE> if you didn't specify
a filename argument to <CODE>--log-bin</CODE>.
<LI>

Added missing <TT>`ha_berkeley.x'</TT> files to the MySQL Windows distribution.
<LI>

Fixed some mutex bugs in the log code that could cause thread blocks if new
log files couldn't be created.
<LI>

Added lock time and number of selected processed rows to slow query log.
<LI>

Added <CODE>--memlock</CODE> option to <CODE>mysqld</CODE> to lock <CODE>mysqld</CODE>
in memory on systems with the <CODE>mlockall()</CODE> call (as in Solaris).
<LI>

<CODE>HEAP</CODE> tables didn't use keys properly. (Bug from 3.23.23.)
<LI>

Added better support for <CODE>MERGE</CODE> tables (keys, mapping, creation,
documentation...). See section <A HREF="manual.html#MERGE">15.2  The <CODE>MERGE</CODE> Storage Engine</A>.
<LI>

Fixed bug in <CODE>mysqldump</CODE> from 3.23 which caused some <CODE>CHAR</CODE> columns
not to be quoted.
<LI>

Merged <CODE>analyze</CODE>, <CODE>check</CODE>, <CODE>optimize</CODE> and repair code.
<LI>

<CODE>OPTIMIZE TABLE</CODE> is now mapped to <CODE>REPAIR TABLE</CODE> with statistics and
sorting of the index tree.  This means that for the moment it only
works on <CODE>MyISAM</CODE> tables.
<LI>

Added a pre-alloced block to root_malloc to get fewer mallocs.
<LI>

Added a lot of new statistics variables.
<LI>

Fixed <CODE>ORDER BY</CODE> bug with <CODE>BDB</CODE> tables.
<LI>

Removed warning that <CODE>mysqld</CODE> couldn't remove the <TT>`.pid'</TT> file
under Windows.
<LI>

Changed <CODE>--log-isam</CODE> to log <CODE>MyISAM</CODE> tables instead of isam
tables.
<LI>

Fixed <CODE>CHECK TABLE</CODE> to work on Windows.
<LI>

Added file mutexes to make <CODE>pwrite()</CODE> safe on Windows.
</UL>



<H3><A NAME="News-3.23.24" HREF="manual_toc.html#News-3.23.24">C.4.37  Changes in release 3.23.24 (08 Sep 2000)</A></H3>


<UL>
<LI>

Added <CODE>Created_tmp_disk_tables</CODE> variable to <CODE>mysqld</CODE>.
<LI>

To make it possible to reliably dump and restore tables with
<CODE>TIMESTAMP(X)</CODE> columns, MySQL now reports columns with <CODE>X</CODE>
other than 14 or 8 to be strings.
<LI>

Changed sort order for <CODE>latin1</CODE> as it was before MySQL 3.23.23.
Any table that was created or modified with 3.23.22 must be repaired if it has
<CODE>CHAR</CODE> columns that may contain characters with ASCII values greater than
128!
<LI>

Fixed small memory leak introduced from 3.23.22 when creating a
temporary table.
<LI>

Fixed problem with <CODE>BDB</CODE> tables and reading on a unique (not primary) key.
<LI>

Restored the <CODE>win1251</CODE> character set (it's now only marked deprecated).
</UL>



<H3><A NAME="News-3.23.23" HREF="manual_toc.html#News-3.23.23">C.4.38  Changes in release 3.23.23 (01 Sep 2000)</A></H3>


<UL>
<LI>

Changed sort order for 'German'; all tables created with 'German' sortorder
must be repaired with <CODE>REPAIR TABLE</CODE> or <CODE>myisamchk</CODE> before use!
<LI>

Added <CODE>--core-file</CODE> option to <CODE>mysqld</CODE> to get a core file on
Linux if <CODE>mysqld</CODE> dies on the <CODE>SIGSEGV</CODE> signal.
<LI>

MySQL client <CODE>mysql</CODE> now starts with option
<CODE>--no-named-commands</CODE> (<CODE>-g</CODE>) by default. This option can be
disabled with <CODE>--enable-named-commands</CODE> (<CODE>-G</CODE>). This may cause
incompatibility problems in some cases, for example, in SQL scripts that
use named commands without a semicolon, etc.!  Long format commands
still work from the first line.
<LI>

Fixed a problem when using many pending <CODE>DROP TABLE</CODE> statements at
the same time.
<LI>

Optimizer didn't use keys properly when using <CODE>LEFT JOIN</CODE> on an
empty table.
<LI>

Added shorter help text when invoking <CODE>mysqld</CODE> with incorrect options.
<LI>

Fixed non-fatal <CODE>free()</CODE> bug in <CODE>mysqlimport</CODE>.
<LI>

Fixed bug in <CODE>MyISAM</CODE> index handling of
<CODE>DECIMAL</CODE>/<CODE>NUMERIC</CODE> keys.
<LI>

Fixed a bug in concurrent insert in <CODE>MyISAM</CODE> tables.  In some contexts,
usage of <CODE>MIN(key_part)</CODE> or <CODE>MAX(key_part)</CODE> returned an empty set.
<LI>

Updated <CODE>mysqlhotcopy</CODE> to use the new <CODE>FLUSH TABLES table_list</CODE>
syntax. Only tables which are being backed up are flushed now.
<LI>

Changed behavior of <CODE>--enable-thread-safe-client</CODE> so
that both non-threaded (<CODE>-lmysqlclient</CODE>) and threaded
(<CODE>-lmysqlclient_r</CODE>) libraries are built.  Users who linked
against a threaded <CODE>-lmysqlclient</CODE> will need to link against
<CODE>-lmysqlclient_r</CODE> now.
<LI>

Added atomic <CODE>RENAME TABLE</CODE> command.
<LI>

Don't count <CODE>NULL</CODE> values in <CODE>COUNT(DISTINCT ...)</CODE>.
<LI>

Changed <CODE>ALTER TABLE</CODE>, <CODE>LOAD DATA INFILE</CODE> on empty tables and
<CODE>INSERT ... SELECT ...</CODE> on empty tables to create non-unique indexes
in a separate batch with sorting. This will make these statements much
faster when you have many indexes.
<LI>

<CODE>ALTER TABLE</CODE> now logs the first used insert_id correctly.
<LI>

Fixed crash when adding a default value to a <CODE>BLOB</CODE> column.
<LI>

Fixed a bug with <CODE>DATE_ADD/DATE_SUB</CODE> where it returned a datetime instead
of a date.
<LI>

Fixed a problem with the thread cache which made some threads show up as
<CODE>***DEAD***</CODE> in <CODE>SHOW PROCESSLIST</CODE>.
<LI>

Fixed a lock in our thr_rwlock code, which could make selects that run
at the same time as concurrent inserts crash. This affects only systems
that don't have the <CODE>pthread_rwlock_rdlock</CODE> code.
<LI>

When deleting rows with a non-unique key in a <CODE>HEAP</CODE> table, all rows
weren't always deleted.
<LI>

Fixed bug in range optimizer for <CODE>HEAP</CODE> tables for searches on a part
index.
<LI>

Fixed <CODE>SELECT</CODE> on part keys to work with <CODE>BDB</CODE> tables.
<LI>

Fixed <CODE>INSERT INTO bdb_table ... SELECT</CODE> to work with <CODE>BDB</CODE> tables.
<LI>

<CODE>CHECK TABLE</CODE> now updates key statistics for the table.
<LI>

<CODE>ANALYZE TABLE</CODE> will now only update tables that have been changed
since the last <CODE>ANALYZE TABLE</CODE>. Note that this is a new feature and tables
will not be marked to be analyzed until they are updated in any way with
3.23.23 or newer.  For older tables, you have to do <CODE>CHECK TABLE</CODE>
to update the key distribution.
<LI>

Fixed some minor privilege problems with <CODE>CHECK TABLE</CODE>, <CODE>ANALYZE
TABLE</CODE>,
<CODE>REPAIR TABLE</CODE> and <CODE>SHOW CREATE</CODE> commands.
<LI>

Added <CODE>CHANGE MASTER TO</CODE> statement.
<LI>

Added <CODE>FAST</CODE>, <CODE>QUICK</CODE> <CODE>EXTENDED</CODE> check types to
<CODE>CHECK TABLES</CODE>.
<LI>

Changed <CODE>myisamchk</CODE> so that <CODE>--fast</CODE> and
<CODE>--check-only-changed</CODE> are also honored with <CODE>--sort-index</CODE> and
<CODE>--analyze</CODE>.
<LI>

Fixed fatal bug in <CODE>LOAD TABLE FROM MASTER</CODE> that did not lock the
table during index re-build.
<LI>

<CODE>LOAD DATA INFILE</CODE> broke replication if the database was excluded
from replication.
<LI>

More variables in <CODE>SHOW SLAVE STATUS</CODE> and <CODE>SHOW MASTER STATUS</CODE>.
<LI>

<CODE>SLAVE STOP</CODE> now will not return until the slave thread actually exits.
<LI>

Full-text search via the <CODE>MATCH()</CODE> function and <CODE>FULLTEXT</CODE> index type
(for <CODE>MyISAM</CODE> files).  This makes <CODE>FULLTEXT</CODE> a reserved word.
</UL>



<H3><A NAME="News-3.23.22" HREF="manual_toc.html#News-3.23.22">C.4.39  Changes in release 3.23.22 (31 Jul 2000)</A></H3>


<UL>
<LI>

Fixed that <CODE>lex_hash.h</CODE> is created properly for each MySQL
distribution.
<LI>

Fixed that <CODE>MASTER</CODE> and <CODE>COLLECTION</CODE> are not reserved words.
<LI>

The log generated by <CODE>--slow-query-log</CODE> didn't contain the whole queries.
<LI>

Fixed that open transactions in <CODE>BDB</CODE> tables are rolled back if the
connection is closed unexpectedly.
<LI>

Added workaround for a bug in <CODE>gcc</CODE> 2.96 (intel) and <CODE>gcc</CODE> 2.9
(IA-64) in <CODE>gen_lex_hash.c</CODE>.
<LI>

Fixed memory leak in the client library when using <CODE>host=</CODE> in the
<TT>`my.cnf'</TT> file.
<LI>

Optimized functions that manipulate the hours/minutes/seconds.
<LI>

Fixed bug when comparing the result of <CODE>DATE_ADD()</CODE>/<CODE>DATE_SUB()</CODE>
against a number.
<LI>

Changed the meaning of <CODE>-F, --fast</CODE> for <CODE>myisamchk</CODE>. Added
<CODE>-C, --check-only-changed</CODE> option to <CODE>myisamchk</CODE>.
<LI>

Added <CODE>ANALYZE tbl_name</CODE> to update key statistics for tables.
<LI>

Changed binary items <CODE>0x...</CODE> to be regarded as integers by default.
<LI>

Fix for SCO and <CODE>SHOW PROCESSLIST</CODE>.
<LI>

Added <CODE>auto-rehash</CODE> on reconnect for the <CODE>mysql</CODE> client.
<LI>

Fixed a newly introduced bug in <CODE>MyISAM</CODE>, where the index file couldn't
get bigger than 64MB.
<LI>

Added <CODE>SHOW MASTER STATUS</CODE> and <CODE>SHOW SLAVE STATUS</CODE>.
</UL>



<H3><A NAME="News-3.23.21" HREF="manual_toc.html#News-3.23.21">C.4.40  Changes in release 3.23.21</A></H3>


<UL>
<LI>

Added <CODE>mysql_character_set_name()</CODE> function to the
MySQL C API.
<LI>

Made the update log ASCII 0 safe.
<LI>

Added the <CODE>mysql_config</CODE> script.
<LI>

Fixed problem when using <CODE>&#60;</CODE> or <CODE>&#62;</CODE> with a char column that was only
partly indexed.
<LI>

One would get a core dump if the log file was not readable by the MySQL user.
<LI>

Changed <CODE>mysqladmin</CODE> to use <CODE>CREATE DATABASE</CODE> and <CODE>DROP
DATABASE</CODE> statements instead of the old deprecated API calls.
<LI>

Fixed <CODE>chown</CODE> warning in <CODE>safe_mysqld</CODE>.
<LI>

Fixed a bug in <CODE>ORDER BY</CODE> that was introduced in 3.23.19.
<LI>

Only optimize the <CODE>DELETE FROM tbl_name</CODE> to do a drop+create of
the table if we are in <CODE>AUTOCOMMIT</CODE> mode (needed for <CODE>BDB</CODE> tables).
<LI>

Added extra checks to avoid index corruption when the <CODE>ISAM</CODE>/<CODE>MyISAM</CODE>
index files get full during an <CODE>INSERT</CODE>/<CODE>UPDATE</CODE>.
<LI>

<CODE>myisamchk</CODE> didn't correctly update row checksum when used with
<CODE>-ro</CODE> (this only gave a warning in subsequent runs).
<LI>

Fixed bug in <CODE>REPAIR TABLE</CODE> so that it works with tables without indexes.
<LI>

Fixed buffer overrun in <CODE>DROP DATABASE</CODE>.
<LI>

<CODE>LOAD TABLE FROM MASTER</CODE> is sufficiently bug-free to announce it as
a feature.
<LI>

<CODE>MATCH</CODE> and <CODE>AGAINST</CODE> are now reserved words.
</UL>



<H3><A NAME="News-3.23.20" HREF="manual_toc.html#News-3.23.20">C.4.41  Changes in release 3.23.20</A></H3>


<UL>
<LI>

Fixed bug in 3.23.19; <CODE>DELETE FROM tbl_name</CODE> removed the <TT>`.frm'</TT> file.
<LI>

Added <CODE>SHOW CREATE TABLE</CODE>.
</UL>



<H3><A NAME="News-3.23.19" HREF="manual_toc.html#News-3.23.19">C.4.42  Changes in release 3.23.19</A></H3>


<UL>
<LI>

Changed copyright for all files to <CODE>GPL</CODE> for the server code and utilities and
to LGPL for the client libraries.
See http://www.fsf.org/licenses/.
<LI>

Fixed bug where all rows matching weren't updated on a <CODE>MyISAM</CODE> table
when doing update based on key on a table with many keys and some key changed
values.
<LI>

The Linux MySQL RPMs and binaries are now statically linked with
a linuxthread version that has faster mutex handling when used with
MySQL.
<LI>

<CODE>ORDER BY</CODE> can now use <CODE>REF</CODE> keys to find subsets of the rows
that need to be sorted.
<LI>

Changed name of <CODE>print_defaults</CODE> program to <CODE>my_print_defaults</CODE>
to avoid name confusion.
<LI>

Fixed <CODE>NULLIF()</CODE> to work as required by standard SQL.
<LI>

Added <CODE>net_read_timeout</CODE> and <CODE>net_write_timeout</CODE> as startup
parameters to <CODE>mysqld</CODE>.
<LI>

Fixed bug that destroyed index when doing <CODE>myisamchk --sort-records</CODE>
on a table with prefix compressed index.
<LI>

Added <CODE>pack_isam</CODE> and <CODE>myisampack</CODE> to the standard MySQL
distribution.
<LI>

Added the syntax <CODE>BEGIN WORK</CODE> (the same as <CODE>BEGIN</CODE>).
<LI>

Fixed core dump bug when using <CODE>ORDER BY</CODE> on a <CODE>CONV()</CODE> expression.
<LI>

Added <CODE>LOAD TABLE FROM MASTER</CODE>.
<LI>

Added <CODE>FLUSH MASTER</CODE> and <CODE>FLUSH SLAVE</CODE>.
<LI>

Fixed big/little endian problem in the replication.
</UL>



<H3><A NAME="News-3.23.18" HREF="manual_toc.html#News-3.23.18">C.4.43  Changes in release 3.23.18</A></H3>


<UL>
<LI>

Fixed a problem from 3.23.17 when choosing character set on the client side.
<LI>

Added <CODE>FLUSH TABLES WITH READ LOCK</CODE> to make a global lock suitable for
making a copy of MySQL data files.
<LI>

<CODE>CREATE TABLE ... SELECT ... PROCEDURE</CODE> now works.
<LI>

Internal temporary tables will now use compressed index when using
<CODE>GROUP BY</CODE> on <CODE>VARCHAR/CHAR</CODE> columns.
<LI>

Fixed a problem when locking the same table with both a <CODE>READ</CODE> and a
<CODE>WRITE</CODE> lock.
<LI>

Fixed problem with <CODE>myisamchk</CODE> and <CODE>RAID</CODE> tables.
</UL>



<H3><A NAME="News-3.23.17" HREF="manual_toc.html#News-3.23.17">C.4.44  Changes in release 3.23.17</A></H3>


<UL>
<LI>

Fixed a bug in <CODE>FIND_IN_SET()</CODE> when the first argument was <CODE>NULL</CODE>.
<LI>

Added table locks to Berkeley DB.
<LI>

Fixed a bug with <CODE>LEFT JOIN</CODE> and <CODE>ORDER BY</CODE> where the first
table had only one matching row.
<LI>

Added 4 sample <TT>`my.cnf'</TT> example files in the <TT>`support-files'</TT>
directory.
<LI>

Fixed <CODE>duplicated key</CODE> problem when doing big <CODE>GROUP BY</CODE> operations.
(This bug was probably introduced in 3.23.15.)
<LI>

Changed syntax for <CODE>INNER JOIN</CODE> to match standard SQL.
<LI>

Added <CODE>NATURAL JOIN</CODE> syntax.
<LI>

A lot of fixes in the <CODE>BDB</CODE> interface.
<LI>

Added handling of <CODE>--no-defaults</CODE> and <CODE>--defaults-file</CODE> to
<CODE>safe_mysqld.sh</CODE> and <CODE>mysql_install_db.sh</CODE>.
<LI>

Fixed bug in reading compressed tables with many threads.
<LI>

Fixed that <CODE>USE INDEX</CODE> works with <CODE>PRIMARY</CODE> keys.
<LI>

Added <CODE>BEGIN</CODE> statement to start a transaction in <CODE>AUTOCOMMIT</CODE> mode.
<LI>

Added support for symbolic links for Windows.
<LI>

Changed protocol to let client know if the server is in <CODE>AUTOCOMMIT</CODE> mode
and if there is a pending transaction.  If there is a pending transaction,
the client library will give an error before reconnecting to the server to
let the client know that the server did a rollback.
The protocol is still backward-compatible with old clients.
<LI>

<CODE>KILL</CODE> now works on a thread that is locked on a 'write' to a dead client.
<LI>

Fixed memory leak in the replication slave thread.
<LI>

Added new <CODE>log-slave-updates</CODE> option to <CODE>mysqld</CODE>, to allow
daisy-chaining the slaves.
<LI>

Fixed compile error on FreeBSD and other systems where <CODE>pthread_t</CODE>
is not the same as <CODE>int</CODE>.
<LI>

Fixed master shutdown aborting the slave thread.
<LI>

Fixed a race condition in <CODE>INSERT DELAYED</CODE> code when doing
<CODE>ALTER TABLE</CODE>.
<LI>

Added deadlock detection sanity checks to <CODE>INSERT DELAYED</CODE>.
</UL>



<H3><A NAME="News-3.23.16" HREF="manual_toc.html#News-3.23.16">C.4.45  Changes in release 3.23.16</A></H3>


<UL>
<LI>

Added <CODE>SLAVE START</CODE> and <CODE>SLAVE STOP</CODE> statements.
<LI>

Added <CODE>TYPE=QUICK</CODE> option to <CODE>CHECK TABLE</CODE> and to <CODE>REPAIR TABLE</CODE>.
<LI>

Fixed bug in <CODE>REPAIR TABLE</CODE> when the table was in use by other threads.
<LI>

Added a thread cache to make it possible to debug MySQL with
<CODE>gdb</CODE> when one does a lot of reconnects. This will also improve
systems where you can't use persistent connections.
<LI>

Lots of fixes in the Berkeley DB interface.
<LI>

<CODE>UPDATE IGNORE</CODE> will not abort if an update results in a
<CODE>DUPLICATE_KEY</CODE> error.
<LI>

Put <CODE>CREATE TEMPORARY TABLE</CODE> commands in the update log.
<LI>

Fixed bug in handling of masked IP numbers in the privilege tables.
<LI>

Fixed bug with <CODE>delay_key_write</CODE> tables and <CODE>CHECK TABLE</CODE>.
<LI>

Added <CODE>replicate-do-db</CODE> and <CODE>replicate-ignore-db</CODE> options to
<CODE>mysqld</CODE>, to restrict which databases get replicated.
<LI>

Added <CODE>SQL_LOG_BIN</CODE> option.
</UL>



<H3><A NAME="News-3.23.15" HREF="manual_toc.html#News-3.23.15">C.4.46  Changes in release 3.23.15 (May 2000: Beta)</A></H3>


<UL>
<LI>

To start <CODE>mysqld</CODE> as <CODE>root</CODE>, you must now use the <CODE>--user=root</CODE> option.
<LI>

Added interface to Berkeley DB. (This is not yet functional; play with it at
your own risk!)
<LI>

Replication between master and slaves.
<LI>

Fixed bug that other threads could steal a lock when a thread had
a lock on a table and did a <CODE>FLUSH TABLES</CODE> command.
<LI>

Added the <CODE>slow_launch_time</CODE> variable and the <CODE>Slow_launch_threads</CODE>
status variable to <CODE>mysqld</CODE>.  These can be examined with
<CODE>mysqladmin variables</CODE> and <CODE>mysqladmin extended-status</CODE>.
<LI>

Added functions <CODE>INET_NTOA()</CODE> and <CODE>INET_ATON()</CODE>.
<LI>

The default type of <CODE>IF()</CODE> now depends on the second and
third arguments and not only on the second argument.
<LI>

Fixed case when <CODE>myisamchk</CODE> could go into a loop when trying to
repair a crashed table.
<LI>

Don't write <CODE>INSERT DELAYED</CODE> to update log if <CODE>SQL_LOG_UPDATE=0</CODE>.
<LI>

Fixed problem with <CODE>REPLACE</CODE> on <CODE>HEAP</CODE> tables.
<LI>

Added possible character sets and time zone to <CODE>SHOW VARIABLES</CODE> output.
<LI>

Fixed bug in locking code that could result in locking problems with
concurrent inserts under high load.
<LI>

Fixed a problem with <CODE>DELETE</CODE> of many rows on a table with
compressed keys where MySQL scanned the index to find the rows.
<LI>

Fixed problem with <CODE>CHECK TABLE</CODE> on table with deleted keyblocks.
<LI>

Fixed a bug in reconnect (at the client side) where it didn't free memory
properly in some contexts.
<LI>

Fixed problems in update log when using <CODE>LAST_INSERT_ID()</CODE> to update
a table with an <CODE>AUTO_INCREMENT</CODE> key.
<LI>

Added <CODE>NULLIF()</CODE> function.
<LI>

Fixed bug when using <CODE>LOAD DATA INFILE</CODE> on a table with
<CODE>BLOB/TEXT</CODE> columns.
<LI>

Optimized <CODE>MyISAM</CODE> to be faster when inserting keys in sorted order.
<LI>

<CODE>EXPLAIN SELECT ...</CODE> now also prints out whether MySQL needs to
create a temporary table or use file sorting when resolving the <CODE>SELECT</CODE>.
<LI>

Added optimization to skip <CODE>ORDER BY</CODE> parts where the part is a
constant expression in the <CODE>WHERE</CODE> part.  Indexes can now be used
even if the <CODE>ORDER BY</CODE> doesn't match the index exactly, as long as
all the unused index parts and all the extra <CODE>ORDER BY</CODE>
columns are constants in the <CODE>WHERE</CODE> clause.  See section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A>.
<LI>

<CODE>UPDATE</CODE> and <CODE>DELETE</CODE> on a whole unique key in the <CODE>WHERE</CODE> part
are now faster than before.
<LI>

Changed <CODE>RAID_CHUNKSIZE</CODE> to be in 1024-byte increments.
<LI>

Fixed core dump in <CODE>LOAD_FILE(NULL)</CODE>.
</UL>



<H3><A NAME="News-3.23.14" HREF="manual_toc.html#News-3.23.14">C.4.47  Changes in release 3.23.14</A></H3>


<UL>
<LI>

Added <CODE>mysqlbinlog</CODE> program for displaying binary log files in text
format.
<LI>

Added <CODE>mysql_real_escape_string()</CODE> function to the MySQL C API.
<LI>

Fixed a bug in <CODE>CONCAT()</CODE> where one of the arguments was a function
that returned a modified argument.
<LI>

Fixed a critical bug in <CODE>myisamchk</CODE>, where it updated the header in
the index file when one only checked the table.  This confused the
<CODE>mysqld</CODE> daemon if it updated the same table at the same time. Now
the status in the index file is only updated if one uses
<CODE>--update-state</CODE>.  With older <CODE>myisamchk</CODE> versions you should
use <CODE>--read-only</CODE> when only checking tables, if there is the
slightest chance that the <CODE>mysqld</CODE> server is working on the table at the
same time!
<LI>

Fixed that <CODE>DROP TABLE</CODE> is logged in the update log.
<LI>

Fixed problem when searching on <CODE>DECIMAL()</CODE> key field
where the column data contained leading zeros.
<LI>

Fix bug in <CODE>myisamchk</CODE> when the <CODE>AUTO_INCREMENT</CODE> column isn't
the first key.
<LI>

Allow <CODE>DATETIME</CODE> in ISO8601 format: 2000-03-12T12:00:00
<LI>

Dynamic character sets.  A <CODE>mysqld</CODE> binary can now handle many different
character sets (you can choose which when starting <CODE>mysqld</CODE>).
<LI>

Added command <CODE>REPAIR TABLE</CODE>.
<LI>

Added <CODE>mysql_thread_safe()</CODE> function to the MySQL C API.
<LI>

Added the <CODE>UMASK_DIR</CODE> environment variable.
<LI>

Added <CODE>CONNECTION_ID()</CODE> function to return the client connection thread
ID.
<LI>

When using <CODE>=</CODE> on <CODE>BLOB</CODE> or <CODE>VARCHAR BINARY</CODE> keys, where
only a part of the column was indexed, the whole column of the result
row wasn't compared.
<LI>

Fix for <CODE>sjis</CODE> character set and <CODE>ORDER BY</CODE>.
<LI>

When running in ANSI mode, don't allow columns to be used that aren't in
the <CODE>GROUP BY</CODE> part.
</UL>



<H3><A NAME="News-3.23.13" HREF="manual_toc.html#News-3.23.13">C.4.48  Changes in release 3.23.13</A></H3>


<UL>
<LI>

Fixed problem when doing locks on the same table more than 2 times in
the same <CODE>LOCK TABLE</CODE> command; this fixed the problem one got when running
the test-ATIS test with <CODE>--fast</CODE> or <CODE>--check-only-changed</CODE>.
<LI>

Added <CODE>SQL_BUFFER_RESULT</CODE> option to <CODE>SELECT</CODE>.
<LI>

Removed endspace from double/float numbers in results from temporary
tables.
<LI>

Added <CODE>CHECK TABLE</CODE> command.
<LI>

Added changes for <CODE>MyISAM</CODE> in 3.23.12 that didn't get into the source
distribution because of CVS problems.
<LI>

Fixed bug so that <CODE>mysqladmin shutdown</CODE> will wait for the local server
to close down.
<LI>

Fixed a possible endless loop when calculating timestamp.
<LI>

Added <CODE>print_defaults</CODE> program to the <TT>`.rpm'</TT> files. Removed
<CODE>mysqlbug</CODE> from the client <TT>`.rpm'</TT> file.
</UL>



<H3><A NAME="News-3.23.12" HREF="manual_toc.html#News-3.23.12">C.4.49  Changes in release 3.23.12 (07 Mar 2000)</A></H3>


<UL>
<LI>

Fixed bug in <CODE>MyISAM</CODE> involving <CODE>REPLACE ... SELECT ...</CODE> which could
give a corrupted table.
<LI>

Fixed bug in <CODE>myisamchk</CODE> where it incorrectly reset the
<CODE>AUTO_INCREMENT</CODE> value.
<LI>

LOTS of patches for Linux Alpha. MySQL now appears to be relatively
stable on Alpha.
<LI>

Changed <CODE>DISTINCT</CODE> on <CODE>HEAP</CODE> temporary tables to use hashed
keys to quickly find duplicated rows. This mostly concerns queries of
type <CODE>SELECT DISTINCT ... GROUP BY ...</CODE>.  This fixes a problem where
not all duplicates were removed in queries of the above type.  In
addition, the new code is MUCH faster.
<LI>

Added patches to make MySQL compile on Mac OS X.
<LI>

Added <CODE>IF NOT EXISTS</CODE> clause to <CODE>CREATE DATABASE</CODE>.
<LI>

Added <CODE>--all-databases</CODE> and <CODE>--databases</CODE> options to <CODE>mysqldump</CODE>
to allow dumping of many databases at the same time.
<LI>

Fixed bug in compressed <CODE>DECIMAL()</CODE> index in <CODE>MyISAM</CODE> tables.
<LI>

Fixed bug when storing 0 into a timestamp.
<LI>

When doing <CODE>mysqladmin shutdown</CODE> on a local connection, <CODE>mysqladmin</CODE>
now waits until the PID file is gone before terminating.
<LI>

Fixed core dump with some <CODE>COUNT(DISTINCT ...)</CODE> queries.
<LI>

Fixed that <CODE>myisamchk</CODE> works properly with RAID tables.
<LI>

Fixed problem with <CODE>LEFT JOIN</CODE> and <CODE>key_column IS NULL</CODE>.
<LI>

Fixed bug in <CODE>net_clear()</CODE> which could give the error <CODE>Aborted
connection</CODE> in the MySQL clients.
<LI>

Added options <CODE>USE INDEX (key_list)</CODE> and <CODE>IGNORE INDEX (key_list)</CODE> as
parameters in <CODE>SELECT</CODE>.
<LI>

<CODE>DELETE</CODE> and <CODE>RENAME</CODE> should now work on <CODE>RAID</CODE> tables.
</UL>



<H3><A NAME="News-3.23.11" HREF="manual_toc.html#News-3.23.11">C.4.50  Changes in release 3.23.11</A></H3>


<UL>
<LI>

Allow the <CODE>ALTER TABLE tbl_name ADD (field_list)</CODE> syntax.
<LI>

Fixed problem with optimizer that could sometimes use incorrect keys.
<LI>

Fixed that <CODE>GRANT/REVOKE ALL PRIVILEGES</CODE> doesn't affect
<CODE>GRANT OPTION</CODE>.
<LI>

Removed extra <SAMP>`)'</SAMP> from the output of <CODE>SHOW GRANTS</CODE>.
<LI>

Fixed problem when storing numbers in timestamps.
<LI>

Fix problem with time zones that have half hour offsets.
<LI>

Allow the syntax <CODE>UNIQUE INDEX</CODE> in <CODE>CREATE</CODE> statements.
<LI>

<CODE>mysqlhotcopy</CODE> - fast online hot-backup utility for local
MySQL databases. By Tim Bunce.
<LI>

New more secure <CODE>mysqlaccess</CODE>. Thanks to Steve Harvey for this.
<LI>

Added <CODE>--i-am-a-dummy</CODE> and <CODE>--safe-updates</CODE> options to <CODE>mysql</CODE>.
<LI>

Added <CODE>select_limit</CODE> and <CODE>max_join_size</CODE> variables to <CODE>mysql</CODE>.
<LI>

Added <CODE>SQL_MAX_JOIN_SIZE</CODE> and <CODE>SQL_SAFE_UPDATES</CODE> options.
<LI>

Added <CODE>READ LOCAL</CODE> lock that doesn't lock the table for concurrent
inserts. (This is used by <CODE>mysqldump</CODE>.)
<LI>

Changed that <CODE>LOCK TABLES ... READ</CODE> no longer allows concurrent
inserts.
<LI>

Added <CODE>--skip-delay-key-write</CODE> option to <CODE>mysqld</CODE>.
<LI>

Fixed security problem in the protocol regarding password checking.
<LI>

<CODE>_rowid</CODE> can now be used as an alias for an integer type unique indexed
column.
<LI>

Added back blocking of <CODE>SIGPIPE</CODE> when compiling with <CODE>--thread-safe-clients</CODE>
to make things safe for old clients.
</UL>



<H3><A NAME="News-3.23.10" HREF="manual_toc.html#News-3.23.10">C.4.51  Changes in release 3.23.10</A></H3>


<UL>
<LI>

Fixed bug in 3.23.9 where memory wasn't properly freed when using
<CODE>LOCK TABLES</CODE>.
</UL>



<H3><A NAME="News-3.23.9" HREF="manual_toc.html#News-3.23.9">C.4.52  Changes in release 3.23.9</A></H3>


<UL>
<LI>

Fixed problem that affected queries that did arithmetic on group functions.
<LI>

Fixed problem with timestamps and <CODE>INSERT DELAYED</CODE>.
<LI>

Fixed that <CODE>date_col BETWEEN const_date AND const_date</CODE> works.
<LI>

Fixed problem when only changing a 0 to <CODE>NULL</CODE> in a table with
<CODE>BLOB/TEXT</CODE> columns.
<LI>

Fixed bug in range optimizer when using many key parts and or on the middle
key parts:  <CODE>WHERE K1=1 and K3=2 and (K2=2 and K4=4 or K2=3 and K4=5)</CODE>
<LI>

Added <CODE>source</CODE> command to <CODE>mysql</CODE> to allow reading of batch files
inside the <CODE>mysql</CODE> client.  Original patch by Matthew Vanecek.
<LI>

Fixed critical problem with the <CODE>WITH GRANT OPTION</CODE> option.
<LI>

Don't give an unnecessary <CODE>GRANT</CODE> error when using tables from many
databases in the same query.
<LI>

Added VIO wrapper (needed for SSL support; by Andrei Errapart and
T@~onu Samuel).
<LI>

Fixed optimizer problem on <CODE>SELECT</CODE> when using many overlapping indexes.
MySQL should now be able to choose keys even better when there
are many keys to choose from.
<LI>

Changed optimizer to prefer a range key instead of a ref key when the
range key can uses more columns than the ref key (which only can use
columns with <CODE>=</CODE>).  For example, the following type of queries should now
be faster: <CODE>SELECT * from key_part_1=const and key_part_2 &#62; const2</CODE>
<LI>

Fixed bug that a change of all <CODE>VARCHAR</CODE> columns to <CODE>CHAR</CODE> columns
didn't change row type from dynamic to fixed.
<LI>

Disabled floating-point exceptions for FreeBSD to fix core dump when
doing <CODE>SELECT FLOOR(POW(2,63))</CODE>.
<LI>

Renamed <CODE>mysqld</CODE> startup option from <CODE>--delay-key-write</CODE> to
<CODE>--delay-key-write-for-all-tables</CODE>.
<LI>

Added <CODE>read-next-on-key</CODE> to <CODE>HEAP</CODE> tables.  This should fix all
problems with <CODE>HEAP</CODE> tables when using non-<CODE>UNIQUE</CODE> keys.
<LI>

Added option to print default arguments to all clients.
<LI>

Added <CODE>--log-slow-queries</CODE> option to <CODE>mysqld</CODE> to log all queries
that take a long time to a separate log file with a time indicating how
long the query took.
<LI>

Fixed core dump when doing <CODE>WHERE key_col=RAND(...)</CODE>.
<LI>

Fixed optimization bug in <CODE>SELECT ... LEFT JOIN ... key_col IS NULL</CODE>,
when <CODE>key_col</CODE> could contain <CODE>NULL</CODE> values.
<LI>

Fixed problem with 8-bit characters as separators in <CODE>LOAD DATA INFILE</CODE>.
</UL>



<H3><A NAME="News-3.23.8" HREF="manual_toc.html#News-3.23.8">C.4.53  Changes in release 3.23.8 (02 Jan 2000)</A></H3>


<UL>
<LI>

Fixed problem when handling indexfiles larger than 8GB.
<LI>

Added latest patches to MIT-pthreads for NetBSD.
<LI>

Fixed problem with time zones that are &#60; GMT - 11.
<LI>

Fixed a bug when deleting packed keys in <CODE>NISAM</CODE>.
<LI>

Fixed problem with <CODE>ISAM</CODE> when doing some <CODE>ORDER BY ... DESC</CODE> queries.
<LI>

Fixed bug when doing a join on a text key which didn't cover the whole key.
<LI>

Option <CODE>--delay-key-write</CODE> didn't enable delayed key writing.
<LI>

Fixed update of <CODE>TEXT</CODE> column which involved only case changes.
<LI>

Fixed that <CODE>INSERT DELAYED</CODE> doesn't update timestamps that are given.
<LI>

Added function <CODE>YEARWEEK()</CODE> and options <CODE>x</CODE>, <CODE>X</CODE>, <CODE>v</CODE> and
<CODE>V</CODE> to <CODE>DATE_FORMAT()</CODE>.
<LI>

Fixed problem with <CODE>MAX(indexed_column)</CODE> and <CODE>HEAP</CODE> tables.
<LI>

Fixed problem with <CODE>BLOB NULL</CODE> keys and <CODE>LIKE "prefix%"</CODE>.
<LI>

Fixed problem with <CODE>MyISAM</CODE> and fixed-length rows &#60; 5 bytes.
<LI>

Fixed problem that could cause MySQL to touch freed memory when
doing very complicated <CODE>GROUP BY</CODE> queries.
<LI>

Fixed core dump if you got a crashed table where an <CODE>ENUM</CODE> field value
was too big.
</UL>



<H3><A NAME="News-3.23.7" HREF="manual_toc.html#News-3.23.7">C.4.54  Changes in release 3.23.7 (10 Dec 1999)</A></H3>


<UL>
<LI>

Fixed workaround under Linux to avoid problems with
<CODE>pthread_mutex_timedwait()</CODE>,
which is used with <CODE>INSERT DELAYED</CODE>. See section <A HREF="manual.html#Linux">2.6.1  Linux Notes</A>.
<LI>

Fixed that one will get a 'disk full' error message if one gets disk full
when doing sorting (instead of waiting until we got more disk space).
<LI>

Fixed a bug in <CODE>MyISAM</CODE> with keys &#62; 250 characters.
<LI>

In <CODE>MyISAM</CODE> one can now do an <CODE>INSERT</CODE> at the same time as other
threads are reading from the table.
<LI>

Added <CODE>max_write_lock_count</CODE> variable to <CODE>mysqld</CODE> to force a
<CODE>READ</CODE> lock after a certain number of <CODE>WRITE</CODE> locks.
<LI>

Inverted flag <CODE>delay_key_write</CODE> on <CODE>show variables</CODE>.
<LI>

Renamed <CODE>concurrency</CODE> variable to <CODE>thread_concurrency</CODE>.
<LI>

The following functions are now multi-byte-safe:
<CODE>LOCATE(substr,str)</CODE>, <CODE>POSITION(substr IN str)</CODE>,
<CODE>LOCATE(substr,str,pos)</CODE>, <CODE>INSTR(str,substr)</CODE>,
<CODE>LEFT(str,len)</CODE>, <CODE>RIGHT(str,len)</CODE>,
<CODE>SUBSTRING(str,pos,len)</CODE>, <CODE>SUBSTRING(str FROM pos FOR len)</CODE>,
<CODE>MID(str,pos,len)</CODE>, <CODE>SUBSTRING(str,pos)</CODE>, <CODE>SUBSTRING(str
FROM pos)</CODE>, <CODE>SUBSTRING_INDEX(str,delim,count)</CODE>, <CODE>RTRIM(str)</CODE>,
<CODE>TRIM([[BOTH | TRAILING] [remstr] FROM] str)</CODE>,
<CODE>REPLACE(str,from_str,to_str)</CODE>, <CODE>REVERSE(str)</CODE>,
<CODE>INSERT(str,pos,len,newstr)</CODE>, <CODE>LCASE(str)</CODE>, <CODE>LOWER(str)</CODE>,
<CODE>UCASE(str)</CODE> and <CODE>UPPER(str)</CODE>; patch by Wei He.
<LI>

Fix core dump when releasing a lock from a non-existent table.
<LI>

Remove locks on tables before starting to remove duplicates.
<LI>

Added option <CODE>FULL</CODE> to <CODE>SHOW PROCESSLIST</CODE>.
<LI>

Added option <CODE>--verbose</CODE> to <CODE>mysqladmin</CODE>.
<LI>

Fixed problem when automatically converting <CODE>HEAP</CODE> to <CODE>MyISAM</CODE>.
<LI>

Fixed bug in <CODE>HEAP</CODE> tables when doing insert + delete + insert + scan the
table.
<LI>

Fixed bugs on Alpha with <CODE>REPLACE()</CODE> and <CODE>LOAD DATA INFILE</CODE>.
<LI>

Added <CODE>interactive_timeout</CODE> variable to <CODE>mysqld</CODE>.
<LI>

Changed the argument to <CODE>mysql_data_seek()</CODE> from <CODE>ulong</CODE> to
<CODE>ulonglong</CODE>.
</UL>



<H3><A NAME="News-3.23.6" HREF="manual_toc.html#News-3.23.6">C.4.55  Changes in release 3.23.6</A></H3>


<UL>
<LI>

Added <CODE>-O lower_case_table_names={0|1}</CODE> option to <CODE>mysqld</CODE> to allow
users to force table names to lowercase.
<LI>

Added <CODE>SELECT ... INTO DUMPFILE</CODE>.
<LI>

Added <CODE>--ansi</CODE> option to <CODE>mysqld</CODE> to make some functions
standard SQL compatible.
<LI>

Temporary table names now start with <CODE>#sql</CODE>.
<LI>

Added quoting of identifiers with <CODE>`</CODE> (<CODE>"</CODE> in <CODE>--ansi</CODE> mode).
<LI>

Changed to use <CODE>snprintf()</CODE> when printing floats to avoid some buffer
overflows on FreeBSD.
<LI>

Made <CODE>FLOOR()</CODE> overflow safe on FreeBSD.
<LI>

Added <CODE>--quote-names</CODE> option to <CODE>mysqldump</CODE>.
<LI>

Fixed bug that one could make a part of a <CODE>PRIMARY KEY NOT NULL</CODE>.
<LI>

Fixed <CODE>encrypt()</CODE> to be thread-safe and not reuse buffer.
<LI>

Added <CODE>mysql_odbc_escape_string()</CODE> function to support big5 characters in
MyODBC.
<LI>

Rewrote the storage engine to use classes.  This introduces a lot of new code,
but will make table handling faster and better.
<LI>

Added patch by Sasha for user-defined variables.
<LI>

Changed that <CODE>FLOAT</CODE> and <CODE>DOUBLE</CODE> (without any length modifiers)
no longer are fixed decimal point numbers.
<LI>

Changed the meaning of <CODE>FLOAT(X)</CODE>: Now this is the same as <CODE>FLOAT</CODE> if
<CODE>X</CODE> &#60;= 24 and a <CODE>DOUBLE</CODE> if 24 &#60; <CODE>X</CODE> &#60;= 53.
<LI>

<CODE>DECIMAL(X)</CODE> is now an alias for <CODE>DECIMAL(X,0)</CODE> and <CODE>DECIMAL</CODE>
is now an alias for <CODE>DECIMAL(10,0)</CODE>.  The same goes for <CODE>NUMERIC</CODE>.
<LI>

Added option <CODE>ROW_FORMAT={DEFAULT | DYNAMIC | FIXED | COMPRESSED}</CODE> to
<CODE>CREATE_TABLE</CODE>.
<LI>

<CODE>DELETE FROM tbl_name</CODE> didn't work on temporary tables.
<LI>

Changed function <CODE>CHAR_LENGTH()</CODE> to be multi-byte character safe.
<LI>

Added function <CODE>ORD(string)</CODE>.
</UL>



<H3><A NAME="News-3.23.5" HREF="manual_toc.html#News-3.23.5">C.4.56  Changes in release 3.23.5 (20 Oct 1999)</A></H3>


<UL>
<LI>

Fixed some Y2K problems in the new date handling in 3.23.
<LI>

Fixed problem with <CODE>SELECT DISTINCT ... ORDER BY RAND()</CODE>.
<LI>

Added patches by Sergei A. Golubchik for text searching on the <CODE>MyISAM</CODE>
level.
<LI>

Fixed cache overflow problem when using full joins without keys.
<LI>

Fixed some configure issues.
<LI>

Some small changes to make parsing faster.
<LI>

Adding a column after the last field with <CODE>ALTER TABLE</CODE> didn't work.
<LI>

Fixed problem when using an <CODE>AUTO_INCREMENT</CODE> column in two keys
<LI>

With <CODE>MyISAM</CODE>, you now can have an <CODE>AUTO_INCREMENT</CODE> column as a key
sub part:
<CODE>CREATE TABLE foo (a INT NOT NULL AUTO_INCREMENT, b CHAR(5), PRIMARY KEY (b,a))</CODE>
<LI>

Fixed bug in <CODE>MyISAM</CODE> with packed char keys that could be <CODE>NULL</CODE>.
<LI>

<CODE>AS</CODE> on field name with <CODE>CREATE TABLE tbl_name SELECT ...</CODE> didn't
work.
<LI>

Allow use of <CODE>NATIONAL</CODE> and <CODE>NCHAR</CODE> when defining character columns.
This is the same as not using <CODE>BINARY</CODE>.
<LI>

Don't allow <CODE>NULL</CODE> columns in a <CODE>PRIMARY KEY</CODE> (only in <CODE>UNIQUE</CODE>
keys).
<LI>

Clear <CODE>LAST_INSERT_ID()</CODE> if one uses this in ODBC:
<CODE>WHERE auto_increment_column IS NULL</CODE>.  This seems to fix some problems
with Access.
<LI>

<CODE>SET SQL_AUTO_IS_NULL=0|1</CODE> now turns on/off the handling of
searching for the last inserted row with <CODE>WHERE
auto_increment_column IS NULL</CODE>.
<LI>

Added new variable <CODE>concurrency</CODE> to <CODE>mysqld</CODE> for Solaris.
<LI>

Added <CODE>--relative</CODE> option to <CODE>mysqladmin</CODE> to make
<CODE>extended-status</CODE> more useful to monitor changes.
<LI>

Fixed bug when using <CODE>COUNT(DISTINCT ...)</CODE> on an empty table.
<LI>

Added support for the Chinese character set GBK.
<LI>

Fixed problem with <CODE>LOAD DATA INFILE</CODE> and <CODE>BLOB</CODE> columns.
<LI>

Added bit operator <CODE>~</CODE> (negation).
<LI>

Fixed problem with UDF functions.
</UL>



<H3><A NAME="News-3.23.4" HREF="manual_toc.html#News-3.23.4">C.4.57  Changes in release 3.23.4 (28 Sep 1999)</A></H3>


<UL>
<LI>

Inserting a <CODE>DATETIME</CODE> into a <CODE>TIME</CODE> column no longer will
try to store 'days' in it.
<LI>

Fixed problem with storage of float/double on little endian machines.
(This affected <CODE>SUM()</CODE>.)
<LI>

Added connect timeout on TCP/IP connections.
<LI>

Fixed problem with <CODE>LIKE "%"</CODE> on an index that may have <CODE>NULL</CODE> values.
<LI>

<CODE>REVOKE ALL PRIVILEGES</CODE> didn't revoke all privileges.
<LI>

Allow creation of temporary tables with same name as the original table.
<LI>

When granting an account a <CODE>GRANT</CODE> option for a database, the account
couldn't grant privileges to other users.
<LI>

New statement: <CODE>SHOW GRANTS FOR user</CODE> (by Sinisa).
<LI>

New <CODE>date_add</CODE> syntax:  <CODE>date/datetime + INTERVAL # interval_type</CODE>.
By Joshua Chamas.
<LI>

Fixed privilege check for <CODE>LOAD DATA REPLACE</CODE>.
<LI>

Automatic fixing of broken include files on Solaris 2.7
<LI>

Some configure issues to fix problems with big filesystem detection.
<LI>

<CODE>REGEXP</CODE> is now case-insensitive if you use non-binary strings.
</UL>



<H3><A NAME="News-3.23.3" HREF="manual_toc.html#News-3.23.3">C.4.58  Changes in release 3.23.3</A></H3>


<UL>
<LI>

Added patches for MIT-pthreads on NetBSD.
<LI>

Fixed range bug in <CODE>MyISAM</CODE>.
<LI>

<CODE>ASC</CODE> is now the default again for <CODE>ORDER BY</CODE>.
<LI>

Added <CODE>LIMIT</CODE> to <CODE>UPDATE</CODE>.
<LI>

Added <CODE>mysql_change_user()</CODE> function to the MySQL C API.
<LI>

Added character set to <CODE>SHOW VARIABLES</CODE>.
<LI>

Added support of <CODE>--[whitespace]</CODE> comments.
<LI>

Allow <CODE>INSERT into tbl_name VALUES ()</CODE>, that is, you may now specify
an empty value list to insert a row in which each column is set to its
default value.
<LI>

Changed <CODE>SUBSTRING(text FROM pos)</CODE> to conform to standard SQL. (Before this
construct returned the rightmost <CODE>pos</CODE> characters.)
<LI>

<CODE>SUM()</CODE> with <CODE>GROUP BY</CODE> returned 0 on some systems.
<LI>

Changed output for <CODE>SHOW TABLE STATUS</CODE>.
<LI>

Added <CODE>DELAY_KEY_WRITE</CODE> option to <CODE>CREATE TABLE</CODE>.
<LI>

Allow <CODE>AUTO_INCREMENT</CODE> on any key part.
<LI>

Fixed problem with <CODE>YEAR(NOW())</CODE> and <CODE>YEAR(CURDATE())</CODE>.
<LI>

Added <CODE>CASE</CODE> construct.
<LI>

New <CODE>COALESCE()</CODE> function.
</UL>



<H3><A NAME="News-3.23.2" HREF="manual_toc.html#News-3.23.2">C.4.59  Changes in release 3.23.2 (09 Aug 1999)</A></H3>


<UL>
<LI>

Fixed range optimizer bug: <CODE>SELECT * FROM tbl_name WHERE
key_part1 &#62;= const AND (key_part2 = const OR key_part2 = const)</CODE>.  The
bug was that some rows could be duplicated in the result.
<LI>

Running <CODE>myisamchk</CODE> without <CODE>-a</CODE> updated the index
distribution incorrectly.
<LI>

<CODE>SET SQL_LOW_PRIORITY_UPDATES=1</CODE> was causing a parse error.
<LI>

You can now update index columns that are used in the <CODE>WHERE</CODE> clause.
<CODE>UPDATE tbl_name SET KEY=KEY+1 WHERE KEY &#62; 100</CODE>
<LI>

Date handling should now be a bit faster.
<LI>

Added handling of fuzzy dates (dates where day or month is 0), such as
<CODE>'1999-01-00'</CODE>.
<LI>

Fixed optimization of <CODE>SELECT ... WHERE key_part1=const1 AND
key_part_2=const2 AND key_part1=const4 AND key_part2=const4</CODE>; indextype
should be <CODE>range</CODE> instead of <CODE>ref</CODE>.
<LI>

Fixed <CODE>egcs</CODE> 1.1.2 optimizer bug (when using <CODE>BLOB</CODE> values) on Linux Alpha.
<LI>

Fixed problem with <CODE>LOCK TABLES</CODE> combined with <CODE>DELETE FROM table</CODE>.
<LI>

<CODE>MyISAM</CODE> tables now allow keys on <CODE>NULL</CODE> and <CODE>BLOB/TEXT</CODE> columns.
<LI>

The following join is now much faster:
<CODE>SELECT ... FROM t1 LEFT JOIN t2 ON ... WHERE t2.not_null_column IS NULL</CODE>.
<LI>

<CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> can be done on functions.
<LI>

Changed handling of 'const_item' to allow handling of <CODE>ORDER BY RAND()</CODE>.
<LI>

Indexes are now used for <CODE>WHERE key_column = function</CODE>.
<LI>

Indexes are now used for <CODE>WHERE key_column = col_name</CODE> even if
the columns are not identically packed.
<LI>

Indexes are now used for <CODE>WHERE col_name IS NULL</CODE>.
<LI>

Changed heap tables to be stored in low_byte_first order (to make it easy
to convert to <CODE>MyISAM</CODE> tables)
<LI>

Automatic change of <CODE>HEAP</CODE> temporary tables to <CODE>MyISAM</CODE> tables
in case of ``table is full'' errors.
<LI>

Added <CODE>--init-file=file_name</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added <CODE>COUNT(DISTINCT value, [value, ...])</CODE>.
<LI>

<CODE>CREATE TEMPORARY TABLE</CODE> now creates a temporary table, in its own
namespace, that is automatically deleted if connection is dropped.
<LI>

New reserved words (required for <CODE>CASE</CODE>):  <CODE>CASE, THEN, WHEN, ELSE and END</CODE>.
<LI>

New functions <CODE>EXPORT_SET()</CODE> and <CODE>MD5()</CODE>.
<LI>

Support for the GB2312 Chinese character set.
</UL>



<H3><A NAME="News-3.23.1" HREF="manual_toc.html#News-3.23.1">C.4.60  Changes in release 3.23.1</A></H3>


<UL>
<LI>

Fixed some compilation problems.
</UL>



<H3><A NAME="News-3.23.0" HREF="manual_toc.html#News-3.23.0">C.4.61  Changes in release 3.23.0 (05 Aug 1999: Alpha)</A></H3>


<UL>
<LI>

A new storage engine library (<CODE>MyISAM</CODE>) with a lot of new features.
See section <A HREF="manual.html#MyISAM">15.1  The <CODE>MyISAM</CODE> Storage Engine</A>.
<LI>

You can create in-memory <CODE>HEAP</CODE> tables which are extremely fast for
lookups.
<LI>

Support for big files (63-bit) on OSs that support big files.
<LI>

New function <CODE>LOAD_FILE(filename)</CODE> to get the contents of a file as a
string value.
<LI>

New <CODE>&#60;=&#62;</CODE> operator that acts as <CODE>=</CODE> but returns TRUE
if both arguments are <CODE>NULL</CODE>.  This is useful for comparing changes
between tables.
<LI>

Added the ODBC 3.0 <CODE>EXTRACT(interval FROM datetime)</CODE> function.
<LI>

Columns defined as <CODE>FLOAT(X)</CODE> are not rounded on storage and may be
in scientific notation (1.0 E+10) when retrieved.
<LI>

<CODE>REPLACE</CODE> is now faster than before.
<LI>

Changed <CODE>LIKE</CODE> character comparison to behave as <CODE>=</CODE>;
This means that <CODE>'e' LIKE ''e'</CODE> is now true.  (If the line doesn't
display correctly, the latter 'e' is a French 'e' with an acute accent above.)
<LI>

<CODE>SHOW TABLE STATUS</CODE> returns a lot of information about the tables.
<LI>

Added <CODE>LIKE</CODE> to the <CODE>SHOW STATUS</CODE> command.
<LI>

Added <CODE>Privileges</CODE> column to <CODE>SHOW COLUMNS</CODE>.
<LI>

Added <CODE>Packed</CODE> and <CODE>Comment</CODE> columns to <CODE>SHOW INDEX</CODE>.
<LI>

Added comments to tables (with <CODE>CREATE TABLE ... COMMENT "xxx"</CODE>).
<LI>

Added <CODE>UNIQUE</CODE>, as in
<CODE>CREATE TABLE tbl_name (col INT not null UNIQUE)</CODE>
<LI>

New create syntax: <CODE>CREATE TABLE tbl_name SELECT ...</CODE>
<LI>

New create syntax: <CODE>CREATE TABLE IF NOT EXISTS ...</CODE>
<LI>

Allow creation of <CODE>CHAR(0)</CODE> columns.
<LI>

<CODE>DATE_FORMAT()</CODE> now requires <SAMP>`%'</SAMP> before any format character.
<LI>

<CODE>DELAYED</CODE> is now a reserved word (sorry about that :( ).
<LI>

An example procedure is added: <CODE>analyse</CODE>, file: <TT>`sql_analyse.c'</TT>.
This will describe the data in your query.  Try the following:

<PRE>
SELECT ... FROM ...
WHERE ... PROCEDURE ANALYSE([max elements,[max memory]])
</PRE>

This procedure is extremely useful when you want to check the data in your
table!
<LI>

<CODE>BINARY</CODE> cast to force a string to be compared in case-sensitive fashion.
<LI>

Added <CODE>--skip-show-database</CODE> option to <CODE>mysqld</CODE>.
<LI>

Check whether a row has changed in an <CODE>UPDATE</CODE> now also works
with <CODE>BLOB</CODE>/<CODE>TEXT</CODE> columns.
<LI>

Added the <CODE>INNER</CODE> join syntax.  <STRONG>Note:</STRONG>  This made <CODE>INNER</CODE>
a reserved word!
<LI>

Added support for netmasks to the hostname in the MySQL grant tables.
You can specify a netmask using the <CODE>IP/NETMASK</CODE> syntax.
<LI>

If you compare a <CODE>NOT NULL DATE/DATETIME</CODE> column with <CODE>IS
NULL</CODE>, this is changed to a compare against <CODE>0</CODE> to satisfy some ODBC
applications.  (By <a HREF="mailto:shreeve@uci.edu">shreeve@uci.edu</a>.)
<LI>

<CODE>NULL IN (...)</CODE> now returns <CODE>NULL</CODE> instead of <CODE>0</CODE>.  This will
ensure that <CODE>null_column NOT IN (...)</CODE> doesn't match
<CODE>NULL</CODE> values.
<LI>

Fix storage of floating-point values in <CODE>TIME</CODE> columns.
<LI>

Changed parsing of <CODE>TIME</CODE> strings to be more strict.  Now the
fractional second part is detected (and currently skipped). The
following formats are supported:

<UL>
<LI>[[DAYS] [H]H:]MM:]SS[.fraction]

<LI>[[[[[H]H]H]H]MM]SS[.fraction]

</UL>

<LI>

Detect (and ignore) fractional second part from <CODE>DATETIME</CODE>.
<LI>

Added the <CODE>LOW_PRIORITY</CODE> attribute to <CODE>LOAD DATA INFILE</CODE>.
<LI>

The default index name now uses the same case as the column name on which the
index name is based.
<LI>

Changed default number of connections to 100.
<LI>

Use bigger buffers when using <CODE>LOAD DATA INFILE</CODE>.
<LI>

<CODE>DECIMAL(x,y)</CODE> now works according to standard SQL.
<LI>

Added aggregate UDF functions. Thanks to Andreas F. Bobak
(<a HREF="mailto:bobak@relog.ch">bobak@relog.ch</a>) for this!
<LI>

<CODE>LAST_INSERT_ID()</CODE> is now updated for <CODE>INSERT INTO ... SELECT</CODE>.
<LI>

Some small changes to the join table optimizer to make some joins faster.
<LI>

<CODE>SELECT DISTINCT</CODE> is much faster; it uses the new <CODE>UNIQUE</CODE>
functionality in <CODE>MyISAM</CODE>. One difference compared to MySQL 3.22
is that the output of <CODE>DISTINCT</CODE> is no longer sorted.
<LI>

All C client API macros are now functions to make shared libraries more
reliable. Because of this, you can no longer call <CODE>mysql_num_fields()</CODE> on
a <CODE>MYSQL</CODE> object, you must use <CODE>mysql_field_count()</CODE> instead.
<LI>

Added use of <CODE>LIBWRAP</CODE>; patch by Henning P. Schmiedehausen.
<LI>

Don't allow <CODE>AUTO_INCREMENT</CODE> for other than numerical columns.
<LI>

Using <CODE>AUTO_INCREMENT</CODE> will now automatically make the column
<CODE>NOT NULL</CODE>.
<LI>

Show <CODE>NULL</CODE> as the default value for <CODE>AUTO_INCREMENT</CODE> columns.
<LI>

Added <CODE>SQL_BIG_RESULT</CODE>; <CODE>SQL_SMALL_RESULT</CODE> is now default.
<LI>

Added a shared library RPM. This enhancement was contributed by David
Fox (<a HREF="mailto:dsfox@cogsci.ucsd.edu">dsfox@cogsci.ucsd.edu</a>).
<LI>

Added  <CODE>--enable-large-files</CODE> and <CODE>--disable-large-files</CODE> options
to <CODE>configure</CODE>. See <TT>`configure.in'</TT> for some systems where this is
automatically turned off because of broken implementations.
<LI>

Upgraded <CODE>readline</CODE> to 4.0.
<LI>

New <CODE>CREATE TABLE</CODE> options: <CODE>PACK_KEYS</CODE> and <CODE>CHECKSUM</CODE>.
<LI>

Added <CODE>--default-table-type</CODE> option to <CODE>mysqld</CODE>.
</UL>



<H2><A NAME="News-3.22.x" HREF="manual_toc.html#News-3.22.x">C.5  Changes in release 3.22.x (Old; discontinued)</A></H2>

<P>
<A NAME="IDX2313"></A>

</P>
<P>
The 3.22 version has faster and safer connect code than version 3.21, as well
as a lot of new nice enhancements.
As there aren't really any major changes, upgrading from 3.21 to 3.22 should
be very easy and painless.  See section <A HREF="manual.html#Upgrading-from-3.21">2.5.5  Upgrading from Version 3.21 to 3.22</A>.

</P>



<H3><A NAME="News-3.22.35" HREF="manual_toc.html#News-3.22.35">C.5.1  Changes in release 3.22.35</A></H3>


<UL>
<LI>

Fixed problem with <CODE>STD()</CODE>.
<LI>

Merged changes from the newest <CODE>ISAM</CODE> library from 3.23.
<LI>

Fixed problem with <CODE>INSERT DELAYED</CODE>.
<LI>

Fixed a bug core dump when using a <CODE>LEFT JOIN</CODE>/<CODE>STRAIGHT_JOIN</CODE>
on a table with only one row.
</UL>



<H3><A NAME="News-3.22.34" HREF="manual_toc.html#News-3.22.34">C.5.2  Changes in release 3.22.34</A></H3>


<UL>
<LI>

Fixed problem with <CODE>GROUP BY</CODE> on <CODE>TINYBLOB</CODE> columns; this
caused bugzilla to not show rows in some queries.
<LI>

Had to do total recompile of the Windows binary version as VC++ didn't
compile all relevant files for 3.22.33 :(
</UL>



<H3><A NAME="News-3.22.33" HREF="manual_toc.html#News-3.22.33">C.5.3  Changes in release 3.22.33</A></H3>


<UL>
<LI>

Fixed problems in Windows when locking tables with <CODE>LOCK TABLE</CODE>.
<LI>

Quicker kill of <CODE>SELECT DISTINCT</CODE> queries.
</UL>



<H3><A NAME="News-3.22.32" HREF="manual_toc.html#News-3.22.32">C.5.4  Changes in release 3.22.32 (14 Feb 2000)</A></H3>


<UL>
<LI>

Fixed problem when storing numbers in timestamps.
<LI>

Fix problem with time zones that have half hour offsets.
<LI>

Added <CODE>mysqlhotcopy</CODE>, a fast online hot-backup utility for local MySQL
databases. By Tim Bunce.
<LI>

New more secure <CODE>mysqlaccess</CODE>. Thanks to Steve Harvey for this.
<LI>

Fixed security problem in the protocol regarding password checking.
<LI>

Fixed problem that affected queries that did arithmetic on <CODE>GROUP</CODE> functions.
<LI>

Fixed a bug in the <CODE>ISAM</CODE> code when deleting rows on tables with
packed indexes.
</UL>



<H3><A NAME="News-3.22.31" HREF="manual_toc.html#News-3.22.31">C.5.5  Changes in release 3.22.31</A></H3>


<UL>
<LI>

A few small fixes for the Windows version.
</UL>



<H3><A NAME="News-3.22.30" HREF="manual_toc.html#News-3.22.30">C.5.6  Changes in release 3.22.30</A></H3>


<UL>
<LI>

Fixed optimizer problem on <CODE>SELECT</CODE> when using many overlapping indexes.
<LI>

Disabled floating-point exceptions for FreeBSD to fix core dump when
doing <CODE>SELECT FLOOR(POW(2,63))</CODE>.
<LI>

Added print of default arguments options to all clients.
<LI>

Fixed critical problem with the <CODE>WITH GRANT OPTION</CODE> option.
<LI>

Fixed non-critical Y2K problem when writing short date to log files.
</UL>



<H3><A NAME="News-3.22.29" HREF="manual_toc.html#News-3.22.29">C.5.7  Changes in release 3.22.29 (02 Jan 2000)</A></H3>


<UL>
<LI>

Upgraded the configure and include files to match the latest 3.23 version.
This should increase portability and make it easier to build shared libraries.
<LI>

Added latest patches to MIT-pthreads for NetBSD.
<LI>

Fixed problem with time zones that are &#60; GMT -11.
<LI>

Fixed a bug when deleting packed keys in NISAM.
<LI>

Fixed problem that could cause MySQL to touch freed memory when
doing very complicated <CODE>GROUP BY</CODE> queries.
<LI>

Fixed core dump if you got a crashed table where an <CODE>ENUM</CODE> field value
was too big.
<LI>

Added <CODE>mysqlshutdown.exe</CODE> and <CODE>mysqlwatch.exe</CODE> to the Windows
distribution.
<LI>

Fixed problem when doing <CODE>ORDER BY</CODE> on a reference key.
<LI>

Fixed that <CODE>INSERT DELAYED</CODE> doesn't update timestamps that are given.
</UL>



<H3><A NAME="News-3.22.28" HREF="manual_toc.html#News-3.22.28">C.5.8  Changes in release 3.22.28 (20 Oct 1999)</A></H3>


<UL>
<LI>

Fixed problem with <CODE>LEFT JOIN</CODE> and <CODE>COUNT()</CODE> on a column which
was declared <CODE>NULL</CODE> + and it had a <CODE>DEFAULT</CODE> value.
<LI>

Fixed core dump problem when using <CODE>CONCAT()</CODE> in a <CODE>WHERE</CODE> clause.
<LI>

Fixed problem with <CODE>AVG()</CODE> and <CODE>STD()</CODE> with <CODE>NULL</CODE> values.
</UL>



<H3><A NAME="News-3.22.27" HREF="manual_toc.html#News-3.22.27">C.5.9  Changes in release 3.22.27</A></H3>


<UL>
<LI>

Fixed prototype in <TT>`my_ctype.h'</TT> when using other character sets.
<LI>

Some configure issues to fix problems with big filesystem detection.
<LI>

Fixed problem when sorting on big <CODE>BLOB</CODE> columns.
<LI>

<CODE>ROUND()</CODE> will now work on Windows.
</UL>



<H3><A NAME="News-3.22.26" HREF="manual_toc.html#News-3.22.26">C.5.10  Changes in release 3.22.26 (16 Sep 1999)</A></H3>


<UL>
<LI>

Fixed core dump with empty <CODE>BLOB/TEXT</CODE> column argument to
<CODE>REVERSE()</CODE>.
<LI>

Extended <CODE>/*! */</CODE> with version numbers.
<LI>

Changed <CODE>SUBSTRING(text FROM pos)</CODE> to conform to standard SQL. (Before this
construct returned the rightmost 'pos' characters.)
<LI>

Fixed problem with <CODE>LOCK TABLES</CODE> combined with <CODE>DELETE FROM table</CODE>
<LI>

Fixed problem that <CODE>INSERT ... SELECT</CODE> didn't use <CODE>BIG_TABLES</CODE>.
<LI>

<CODE>SET SQL_LOW_PRIORITY_UPDATES=#</CODE> didn't work.
<LI>

Password wasn't updated correctly if privileges didn't change on:
<CODE>GRANT ... IDENTIFIED BY</CODE>
<LI>

Fixed range optimizer bug in
<CODE>SELECT * FROM tbl_name WHERE key_part1 &#62;= const AND (key_part2 = const
OR key_part2 = const)</CODE>.
<LI>

Fixed bug in compression key handling in <CODE>ISAM</CODE>.
</UL>



<H3><A NAME="News-3.22.25" HREF="manual_toc.html#News-3.22.25">C.5.11  Changes in release 3.22.25</A></H3>


<UL>
<LI>

Fixed some small problems with the installation.
</UL>



<H3><A NAME="News-3.22.24" HREF="manual_toc.html#News-3.22.24">C.5.12  Changes in release 3.22.24 (05 Jul 1999)</A></H3>


<UL>
<LI>

<CODE>DATA</CODE> is no longer a reserved word.
<LI>

Fixed optimizer bug with tables with only one row.
<LI>

Fixed bug when using <CODE>LOCK TABLES tbl_name READ; FLUSH TABLES;</CODE>
<LI>

Applied some patches for HP-UX.
<LI>

<CODE>isamchk</CODE> should now work on Windows.
<LI>

Changed <TT>`configure'</TT> to not use big file handling on Linux as this
crashes some Red Hat 6.0 systems
</UL>



<H3><A NAME="News-3.22.23" HREF="manual_toc.html#News-3.22.23">C.5.13  Changes in release 3.22.23 (08 Jun 1999)</A></H3>


<UL>
<LI>

Upgraded to use Autoconf 2.13, Automake 1.4 and <CODE>libtool</CODE> 1.3.2.
<LI>

Better support for SCO in <CODE>configure</CODE>.
<LI>

Added option <CODE>--defaults-file=file_name</CODE> to option file handling to force
use of only one specific option file.
<LI>

Extended <CODE>CREATE</CODE> syntax to ignore MySQL 3.23 keywords.
<LI>

Fixed deadlock problem when using <CODE>INSERT DELAYED</CODE> on a table locked with
<CODE>LOCK TABLES</CODE>.
<LI>

Fixed deadlock problem when using <CODE>DROP TABLE</CODE> on a table that was
locked by another thread.
<LI>

Add logging of <CODE>GRANT/REVOKE</CODE> commands in the update log.
<LI>

Fixed <CODE>isamchk</CODE> to detect a new error condition.
<LI>

Fixed bug in <CODE>NATURAL LEFT JOIN</CODE>.
</UL>



<H3><A NAME="News-3.22.22" HREF="manual_toc.html#News-3.22.22">C.5.14  Changes in release 3.22.22 (30 Apr 1999)</A></H3>


<UL>
<LI>

Fixed problem in the C API when you called <CODE>mysql_close()</CODE> directly after
<CODE>mysql_init()</CODE>.
<LI>

Better client error message when you can't open socket.
<LI>

Fixed <CODE>delayed_insert_thread</CODE> counting when you couldn't create a new
delayed_insert thread.
<LI>

Fixed bug in <CODE>CONCAT()</CODE> with many arguments.
<LI>

Added patches for DEC 3.2 and SCO.
<LI>

Fixed path-bug when installing MySQL as a service on NT.
<LI>

MySQL on Windows is now compiled with VC++ 6.0 instead of
with VC++ 5.0.
<LI>

New installation setup for MySQL on Windows.
</UL>



<H3><A NAME="News-3.22.21" HREF="manual_toc.html#News-3.22.21">C.5.15  Changes in release 3.22.21</A></H3>


<UL>
<LI>

Fixed problem with <CODE>DELETE FROM TABLE</CODE> when table was locked by
another thread.
<LI>

Fixed bug in <CODE>LEFT JOIN</CODE> involving empty tables.
<LI>

Changed the <CODE>mysql.db</CODE> column from <CODE>CHAR(32)</CODE> to <CODE>CHAR(60)</CODE>.
<LI>

<CODE>MODIFY</CODE> and <CODE>DELAYED</CODE> are no longer reserved words.
<LI>

Fixed a bug when storing days in a <CODE>TIME</CODE> column.
<LI>

Fixed a problem with <CODE>Host '...' is not allowed to connect to this MySQL
server</CODE> after one had inserted a new MySQL user with a <CODE>GRANT</CODE>
command.
<LI>

Changed to use <CODE>TCP_NODELAY</CODE> also on Linux (should give faster TCP/IP
connections).
</UL>



<H3><A NAME="News-3.22.20" HREF="manual_toc.html#News-3.22.20">C.5.16  Changes in release 3.22.20 (18 Mar 1999)</A></H3>


<UL>
<LI>

Fixed <CODE>STD()</CODE> for big tables when result should be 0.
<LI>

The update log didn't have newlines on some operating systems.
<LI>

<CODE>INSERT DELAYED</CODE> had some garbage at end in the update log.
</UL>



<H3><A NAME="News-3.22.19" HREF="manual_toc.html#News-3.22.19">C.5.17  Changes in release 3.22.19 (Mar 1999: Production)</A></H3>


<UL>
<LI>

Fixed bug in <CODE>mysql_install_db</CODE> (from 3.22.17).
<LI>

Changed default key cache size to 8MB.
<LI>

Fixed problem with queries that needed temporary tables with <CODE>BLOB</CODE>
columns.
</UL>



<H3><A NAME="News-3.22.18" HREF="manual_toc.html#News-3.22.18">C.5.18  Changes in release 3.22.18</A></H3>


<UL>
<LI>

Fixes a fatal problem in 3.22.17 on Linux; after <CODE>shutdown</CODE>
not all threads died properly.
<LI>

Added option <CODE>-O flush_time=#</CODE> to <CODE>mysqld</CODE>.  This is mostly
useful on Windows and tells how often MySQL should close all
unused tables and flush all updated tables to disk.
<LI>

Fixed problem that a <CODE>VARCHAR</CODE> column compared with <CODE>CHAR</CODE> column
didn't use keys efficiently.
</UL>



<H3><A NAME="News-3.22.17" HREF="manual_toc.html#News-3.22.17">C.5.19  Changes in release 3.22.17</A></H3>


<UL>
<LI>

Fixed a core dump problem when using <CODE>--log-update</CODE> and connecting
without a default database.
<LI>

Fixed some <CODE>configure</CODE> and portability problems.
<LI>

Using <CODE>LEFT JOIN</CODE> on tables that had circular dependencies caused
<CODE>mysqld</CODE> to hang forever.
</UL>



<H3><A NAME="News-3.22.16" HREF="manual_toc.html#News-3.22.16">C.5.20  Changes in release 3.22.16 (Feb 1999: Gamma)</A></H3>


<UL>
<LI>

<CODE>mysqladmin processlist</CODE> could kill the server if a new user logged in.
<LI>

<CODE>DELETE FROM tbl_name WHERE key_column=col_name</CODE> didn't find any matching
rows.  Fixed.
<LI>

<CODE>DATE_ADD(column, ...)</CODE> didn't work.
<LI>

<CODE>INSERT DELAYED</CODE> could deadlock with status <CODE>upgrading lock</CODE>.
<LI>

Extended <CODE>ENCRYPT()</CODE> to take longer salt strings than 2 characters.
<LI>

<CODE>longlong2str</CODE> is now much faster than before.  For <CODE>Intel x86</CODE>
platforms, this function is written in optimized assembler.
<LI>

Added the <CODE>MODIFY</CODE> keyword to <CODE>ALTER TABLE</CODE>.
</UL>



<H3><A NAME="News-3.22.15" HREF="manual_toc.html#News-3.22.15">C.5.21  Changes in release 3.22.15</A></H3>


<UL>
<LI>

<CODE>GRANT</CODE> used with <CODE>IDENTIFIED BY</CODE> didn't take effect until privileges
were flushed.
<LI>

Name change of some variables in <CODE>SHOW STATUS</CODE>.
<LI>

Fixed problem with <CODE>ORDER BY</CODE> with 'only index' optimization when there
were multiple key definitions for a used column.
<LI>

<CODE>DATE</CODE> and <CODE>DATETIME</CODE> columns are now up to 5 times faster than
before.
<LI>

<CODE>INSERT DELAYED</CODE> can be used to let the client do other things while the
server inserts rows into a table.
<LI>

<CODE>LEFT JOIN USING (col1,col2)</CODE> didn't work if one used it with tables
from 2 different databases.
<LI>

<CODE>LOAD DATA LOCAL INFILE</CODE> didn't work in the Unix version because of
a missing file.
<LI>

Fixed problems with <CODE>VARCHAR</CODE>/<CODE>BLOB</CODE> on very short rows (&#60; 4 bytes);
error 127 could occur when deleting rows.
<LI>

Updating <CODE>BLOB/TEXT</CODE> through formulas didn't work for short (&#60; 256 char)
strings.
<LI>

When you did a <CODE>GRANT</CODE> on a new host, <CODE>mysqld</CODE> could die on the first
connect from this host.
<LI>

Fixed bug when one used <CODE>ORDER BY</CODE> on column name that was the same
name as an alias.
<LI>

Added <CODE>BENCHMARK(loop_count,expression)</CODE> function to time expressions.
</UL>



<H3><A NAME="News-3.22.14" HREF="manual_toc.html#News-3.22.14">C.5.22  Changes in release 3.22.14</A></H3>


<UL>
<LI>

Allow empty arguments to <CODE>mysqld</CODE> to make it easier to start from shell
scripts.
<LI>

Setting a <CODE>TIMESTAMP</CODE> column to <CODE>NULL</CODE> didn't record the timestamp
value in the update log.
<LI>

Fixed lock handler bug when one did
<CODE>INSERT INTO TABLE ... SELECT ... GROUP BY</CODE>.
<LI>

Added a patch for <CODE>localtime_r()</CODE> on Windows so that it will no lonher crash
if your date is &#62; 2039, but instead will return a time of all zero.
<LI>

Names for
user-defined functions are no longer case-sensitive.
<LI>

Added escape of <CODE>^Z</CODE> (ASCII 26) to <CODE>\Z</CODE> as <CODE>^Z</CODE> doesn't
work with pipes on Windows.
<LI>

<CODE>mysql_fix_privileges</CODE> adds a new column to the <CODE>mysql.func</CODE> to
support aggregate UDF functions in future MySQL releases.
</UL>



<H3><A NAME="News-3.22.13" HREF="manual_toc.html#News-3.22.13">C.5.23  Changes in release 3.22.13</A></H3>


<UL>
<LI>

Saving <CODE>NOW()</CODE>, <CODE>CURDATE()</CODE> or <CODE>CURTIME()</CODE> directly in a
column didn't work.
<LI>

<CODE>SELECT COUNT(*) ... LEFT JOIN ...</CODE> didn't work with no <CODE>WHERE</CODE> part.
<LI>

Updated <TT>`config.guess'</TT> to allow MySQL to configure on
UnixWare 7.1.x.
<LI>

Changed the implementation of <CODE>pthread_cond()</CODE> on the Windows version.
<CODE>get_lock()</CODE> now correctly times out on Windows!
</UL>



<H3><A NAME="News-3.22.12" HREF="manual_toc.html#News-3.22.12">C.5.24  Changes in release 3.22.12</A></H3>


<UL>
<LI>

Fixed problem when using <CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE> in a
<CODE>WHERE</CODE> clause.
<LI>

You can now set the password for a user with the <CODE>GRANT ... TO user
IDENTIFIED BY 'password'</CODE> syntax.
<LI>

Fixed bug in <CODE>GRANT</CODE> checking with <CODE>SELECT</CODE> on many tables.
<LI>

Added missing file <CODE>mysql_fix_privilege_tables</CODE> to the RPM
distribution. This is not run by default because it relies on the client
package.
<LI>

Added option <CODE>SQL_SMALL_RESULT</CODE> to <CODE>SELECT</CODE> to force use of
fast temporary tables when you know that the result set will be small.
<LI>

Allow use of negative real numbers without a decimal point.
<LI>

Day number is now adjusted to maximum days in month if the resulting month
after <CODE>DATE_ADD</CODE>/<CODE>DATE_SUB()</CODE> doesn't have enough days.
<LI>

Fix that <CODE>GRANT</CODE> compares columns in case-insensitive fashion.
<LI>

Fixed a bug in <TT>`sql_list.h'</TT> that made <CODE>ALTER TABLE</CODE> dump core in
some contexts.
<LI>

The hostname in <CODE>user@hostname</CODE> can now include <SAMP>`.'</SAMP> and <SAMP>`-'</SAMP>
without quotes in the context of the <CODE>GRANT</CODE>, <CODE>REVOKE</CODE> and
<CODE>SET PASSWORD FOR ...</CODE> statements.
<LI>

Fix for <CODE>isamchk</CODE> for tables which need big temporary files.
</UL>



<H3><A NAME="News-3.22.11" HREF="manual_toc.html#News-3.22.11">C.5.25  Changes in release 3.22.11</A></H3>


<UL>
<LI>

<STRONG>Important</STRONG>: You must run the <CODE>mysql_fix_privilege_tables</CODE> script
when you upgrade to this version!  This is needed because of the new
<CODE>GRANT</CODE> system. If you don't do this, you will get <CODE>Access
denied</CODE> when you try to use <CODE>ALTER TABLE</CODE>, <CODE>CREATE INDEX</CODE>, or
<CODE>DROP INDEX</CODE>.
<LI>

<CODE>GRANT</CODE> to allow/deny users table and column access.
<LI>

Changed <CODE>USER()</CODE> to return a value in <CODE>user@host</CODE> format.
Formerly it returned only <CODE>user</CODE>.
<LI>

Changed the syntax for how to set <CODE>PASSWORD</CODE> for another user.
<LI>

New command <CODE>FLUSH STATUS</CODE> that resets most status variables to zero.
<LI>

New status variables: <CODE>aborted_threads</CODE>, <CODE>aborted_connects</CODE>.
<LI>

New option variable: <CODE>connection_timeout</CODE>.
<LI>

Added support for Thai sorting (by Pruet Boonma
<a HREF="mailto:pruet@ds90.intanon.nectec.or.th">pruet@ds90.intanon.nectec.or.th</a>).
<LI>

Slovak and Japanese error messages.
<LI>

Configuration and portability fixes.
<LI>

Added option <CODE>SET SQL_WARNINGS=1</CODE> to get a warning count also for simple
(single-row) inserts.
<LI>

MySQL now uses <CODE>SIGTERM</CODE> instead of <CODE>SIGQUIT</CODE> with
shutdown to work better on FreeBSD.
<LI>

Added option <CODE>\G</CODE> (print vertically) to <CODE>mysql</CODE>.
<LI>

<CODE>SELECT HIGH_PRIORITY ...</CODE> killed <CODE>mysqld</CODE>.
<LI>

<CODE>IS NULL</CODE> on a <CODE>AUTO_INCREMENT</CODE> column in a <CODE>LEFT JOIN</CODE> didn't
work as expected.
<LI>

New function <CODE>MAKE_SET()</CODE>.
</UL>



<H3><A NAME="News-3.22.10" HREF="manual_toc.html#News-3.22.10">C.5.26  Changes in release 3.22.10</A></H3>


<UL>
<LI>

<CODE>mysql_install_db</CODE> no longer starts the MySQL server!  You
should start <CODE>mysqld</CODE> with <CODE>safe_mysqld</CODE> after installing it!  The
MySQL RPM will, however, start the server as before.
<LI>

Added <CODE>--bootstrap</CODE> option to <CODE>mysqld</CODE> and recoded
<CODE>mysql_install_db</CODE> to use it.  This will make it easier to install
MySQL with RPMs.
<LI>

Changed <CODE>+</CODE>, <CODE>-</CODE> (sign and minus), <CODE>*</CODE>, <CODE>/</CODE>, <CODE>%</CODE>,
<CODE>ABS()</CODE> and <CODE>MOD()</CODE> to be <CODE>BIGINT</CODE> aware (64-bit safe).
<LI>

Fixed a bug in <CODE>ALTER TABLE</CODE> that caused <CODE>mysqld</CODE> to crash.
<LI>

MySQL now always reports the conflicting key values when a
duplicate key entry occurs. (Before this was only reported for <CODE>INSERT</CODE>.)
<LI>

New syntax: <CODE>INSERT INTO tbl_name SET col_name=value, col_name=value, ...</CODE>
<LI>

Most errors in the <TT>`.err'</TT> log are now prefixed with a time stamp.
<LI>

Added option <CODE>MYSQL_INIT_COMMAND</CODE> to <CODE>mysql_options()</CODE> to make
a query on connect or reconnect.
<LI>

Added option <CODE>MYSQL_READ_DEFAULT_FILE</CODE> and
<CODE>MYSQL_READ_DEFAULT_GROUP</CODE> to <CODE>mysql_options()</CODE> to read the
following parameters from the MySQL option files: <CODE>port</CODE>,
<CODE>socket</CODE>, <CODE>compress</CODE>, <CODE>password</CODE>, <CODE>pipe</CODE>, <CODE>timeout</CODE>,
<CODE>user</CODE>, <CODE>init-command</CODE>, <CODE>host</CODE> and <CODE>database</CODE>.
<LI>

Added <CODE>maybe_null</CODE> to the UDF structure.
<LI>

Added option <CODE>IGNORE</CODE> to <CODE>INSERT</CODE> statements with many rows.
<LI>

Fixed some problems with sorting of the <CODE>koi8</CODE> character sets; users of
<CODE>koi8</CODE> <STRONG>must</STRONG> run <CODE>isamchk -rq</CODE> on each table that has an
index on a <CODE>CHAR</CODE> or <CODE>VARCHAR</CODE> column.
<LI>

New script <CODE>mysql_setpermission</CODE>, by Luuk de Boer.  It allows easy
creation of new users with permissions for specific databases.
<LI>

Allow use of hexadecimal strings (0x...) when specifying a constant string
(like in the column separators with <CODE>LOAD DATA INFILE</CODE>).
<LI>

Ported to OS/2 (thanks to Antony T. Curtis <a HREF="mailto:antony.curtis@olcs.net">antony.curtis@olcs.net</a>).
<LI>

Added more variables to <CODE>SHOW STATUS</CODE> and changed format of output to
be like <CODE>SHOW VARIABLES</CODE>.
<LI>

Added <CODE>extended-status</CODE> command to <CODE>mysqladmin</CODE> which will show the
new status variables.
</UL>



<H3><A NAME="News-3.22.9" HREF="manual_toc.html#News-3.22.9">C.5.27  Changes in release 3.22.9</A></H3>


<UL>
<LI>

<CODE>SET SQL_LOG_UPDATE=0</CODE> caused a lockup of the server.
<LI>

New SQL command:  <CODE>FLUSH [ TABLES | HOSTS | LOGS | PRIVILEGES ] [, ...]</CODE>
<LI>

New SQL command:  <CODE>KILL</CODE> <CODE>thread_id</CODE>.
<LI>

Added casts and changed include files to make MySQL easier to
compile on AIX and DEC OSF/1 4.x
<LI>

Fixed conversion problem when using <CODE>ALTER TABLE</CODE> from a <CODE>INT</CODE>
to a short <CODE>CHAR()</CODE> column.
<LI>

Added <CODE>SELECT HIGH_PRIORITY</CODE>; this will get a lock for the
<CODE>SELECT</CODE> even if there is a thread waiting for another
<CODE>SELECT</CODE> to get a <CODE>WRITE LOCK</CODE>.
<LI>

Moved <CODE>wild_compare()</CODE> to string class to be able to use <CODE>LIKE</CODE> on
<CODE>BLOB</CODE>/<CODE>TEXT</CODE> columns with <CODE>\0</CODE>.
<LI>

Added <CODE>ESCAPE</CODE> option to <CODE>LIKE</CODE>.
<LI>

Added a lot more output to <CODE>mysqladmin debug</CODE>.
<LI>

You can now start <CODE>mysqld</CODE> on Windows with the <CODE>--flush</CODE> option.
This will flush all tables to disk after each update.  This makes things
much safer on the Windows platforms but also <STRONG>much</STRONG> slower.
</UL>



<H3><A NAME="News-3.22.8" HREF="manual_toc.html#News-3.22.8">C.5.28  Changes in release 3.22.8</A></H3>


<UL>
<LI>

Czech character sets should now work much better.
<LI>

<CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE> didn't work with group functions.
<LI>

<CODE>mysql</CODE> will now also try to reconnect on <CODE>USE database</CODE> commands.
<LI>

Fix problem with <CODE>ORDER BY</CODE> and <CODE>LEFT JOIN</CODE> and <CODE>const</CODE> tables.
<LI>

Fixed problem with <CODE>ORDER BY</CODE> if the first <CODE>ORDER BY</CODE> column
was a key and the rest of the <CODE>ORDER BY</CODE> columns wasn't part of the key.
<LI>

Fixed a big problem with <CODE>OPTIMIZE TABLE</CODE>.
<LI>

MySQL clients on NT will now by default first try to connect with
named pipes and after this with TCP/IP.
<LI>

Fixed a problem with <CODE>DROP TABLE</CODE> and <CODE>mysqladmin shutdown</CODE> on Windows
(a fatal bug from 3.22.6).
<LI>

Fixed problems with <CODE>TIME columns</CODE> and negative strings.
<LI>

Added an extra thread signal loop on shutdown to avoid some error messages
from the client.
<LI>

MySQL now uses the next available number as extension for the update
log file.
<LI>

Added patches for UNIXWARE 7.
</UL>



<H3><A NAME="News-3.22.7" HREF="manual_toc.html#News-3.22.7">C.5.29  Changes in release 3.22.7 (Sep 1998: Beta)</A></H3>


<UL>
<LI>

Added <CODE>LIMIT</CODE> clause for the <CODE>DELETE</CODE> statement.
<LI>

You can now use the <CODE>/*! ... */</CODE> syntax to hide MySQL-specific
keywords when you write portable code.  MySQL will parse the code
inside the comments as if the surrounding <CODE>/*!</CODE> and <CODE>*/</CODE> comment
characters didn't exist.
<LI>

<CODE>OPTIMIZE TABLE tbl_name</CODE> can now be used to reclaim disk space
after many deletes.  Currently, this uses <CODE>ALTER TABLE</CODE> to
regenerate the table, but in the future it will use an integrated
<CODE>isamchk</CODE> for more speed.
<LI>

Upgraded <CODE>libtool</CODE> to get the configure more portable.
<LI>

Fixed slow <CODE>UPDATE</CODE> and <CODE>DELETE</CODE> operations when using
<CODE>DATETIME</CODE> or <CODE>DATE</CODE> keys.
<LI>

Changed optimizer to make it better at deciding when to do a full join
and when using keys.
<LI>

You can now use <CODE>mysqladmin proc</CODE> to display information about your own
threads. Only users with the <CODE>PROCESS</CODE> privilege can get
information about all threads.
(In 4.0.2, you need the <CODE>SUPER</CODE> privilege for this.)
<LI>

Added handling of formats <CODE>YYMMDD</CODE>, <CODE>YYYYMMDD</CODE>,
<CODE>YYMMDDHHMMSS</CODE> for numbers when using <CODE>DATETIME</CODE> and
<CODE>TIMESTAMP</CODE> types. (Formerly these formats only worked with strings.)
<LI>

Added connect option <CODE>CLIENT_IGNORE_SPACE</CODE> to allow use of spaces
after function names and before <SAMP>`('</SAMP> (Powerbuilder requires this).
This will make all function names reserved words.
<LI>

Added the <CODE>--log-long-format</CODE> option to <CODE>mysqld</CODE> to enable timestamps
and INSERT_IDs in the update log.
<LI>

Added <CODE>--where</CODE> option to <CODE>mysqldump</CODE> (patch by Jim Faucette).
<LI>

The lexical analyzer now uses ``perfect hashing'' for faster parsing of SQL
statements.
</UL>



<H3><A NAME="News-3.22.6" HREF="manual_toc.html#News-3.22.6">C.5.30  Changes in release 3.22.6</A></H3>


<UL>
<LI>

Faster <CODE>mysqldump</CODE>.
<LI>

For the <CODE>LOAD DATA INFILE</CODE> statement, you can now use the new <CODE>LOCAL</CODE>
keyword to read the file from the client.  <CODE>mysqlimport</CODE> will
automatically use <CODE>LOCAL</CODE> when importing with the TCP/IP protocol.
<LI>

Fixed small optimize problem when updating keys.
<LI>

Changed makefiles to support shared libraries.
<LI>

MySQL-NT can now use named pipes, which means that you can now use
MySQL-NT without having to install TCP/IP.
</UL>



<H3><A NAME="News-3.22.5" HREF="manual_toc.html#News-3.22.5">C.5.31  Changes in release 3.22.5</A></H3>


<UL>
<LI>

All table lock handing is changed to avoid some very subtle
deadlocks when using <CODE>DROP TABLE</CODE>, <CODE>ALTER TABLE</CODE>, <CODE>DELETE FROM
TABLE</CODE> and <CODE>mysqladmin flush-tables</CODE> under heavy usage.
Changed locking code to get better handling of locks of different types.
<LI>

Updated <CODE>DBI</CODE> to 1.00 and <CODE>DBD</CODE> to 1.2.0.
<LI>

Added a check that the error message file contains error messages suitable for
the current version of <CODE>mysqld</CODE>. (To avoid errors if you accidentally
try to use an old error message file.)
<LI>

All count structures in the client (<CODE>affected_rows()</CODE>,
<CODE>insert_id()</CODE>, ...) are now of type <CODE>BIGINT</CODE> to allow 64-bit values
to be used.
This required a minor change in the MySQL protocol which should affect
only old clients when using tables with <CODE>AUTO_INCREMENT</CODE> values &#62; 16MB.
<LI>

The return type of <CODE>mysql_fetch_lengths()</CODE> has changed from <CODE>uint *</CODE>
to <CODE>ulong *</CODE>. This may give a warning for old clients but should work
on most machines.
<LI>

Change <CODE>mysys</CODE> and <CODE>dbug</CODE> libraries to allocate all thread variables
in one struct.  This makes it easier to make a threaded <TT>`libmysql.dll'</TT>
library.
<LI>

Use the result from <CODE>gethostname()</CODE> (instead of <CODE>uname()</CODE>) when
constructing <TT>`.pid'</TT> file names.
<LI>

New better compressed client/server protocol.
<LI>

<CODE>COUNT()</CODE>, <CODE>STD()</CODE> and <CODE>AVG()</CODE> are extended to handle more than
4GB rows.
<LI>

You can now store values in the range <CODE>-838:59:59</CODE> &#60;= x &#60;=
<CODE>838:59:59</CODE> in a <CODE>TIME</CODE> column.
<LI>

<STRONG>Warning: Incompatible change!!</STRONG>
If you set a <CODE>TIME</CODE> column to too short a value, MySQL now
assumes the value is given as: <CODE>[[[D ]HH:]MM:]SS</CODE> instead of
<CODE>HH[:MM[:SS]]</CODE>.
<LI>

<CODE>TIME_TO_SEC()</CODE> and <CODE>SEC_TO_TIME()</CODE> can now handle negative times
and hours up to 32767.
<LI>

Added new option
<CODE>SET SQL_LOG_UPDATE={0|1}</CODE> to allow users with
the <CODE>PROCESS</CODE> privilege to bypass the update log.
(Modified patch from Sergey A Mukhin <a HREF="mailto:violet@rosnet.net">violet@rosnet.net</a>.)
<LI>

Fixed fatal bug in <CODE>LPAD()</CODE>.
<LI>

Initialize line buffer in <TT>`mysql.cc'</TT> to make <CODE>BLOB</CODE> reading from
pipes safer.
<LI>

Added <CODE>-O max_connect_errors=#</CODE> option to <CODE>mysqld</CODE>.
Connect errors are now reset for each correct connection.
<LI>

Increased the default value of <CODE>max_allowed_packet</CODE> to <CODE>1M</CODE> in
<CODE>mysqld</CODE>.
<LI>

Added <CODE>--low-priority-updates</CODE> option to <CODE>mysqld</CODE>, to give
table-modifying operations (<CODE>INSERT</CODE>, <CODE>REPLACE</CODE>, <CODE>UPDATE</CODE>,
<CODE>DELETE</CODE>) lower priority than retrievals.  You can now use
<CODE>{INSERT | REPLACE | UPDATE | DELETE} LOW_PRIORITY ...</CODE> You can
also use <CODE>SET SQL_LOW_PRIORITY_UPDATES={0|1}</CODE> to change
the priority for one thread.  One side effect is that <CODE>LOW_PRIORITY</CODE>
is now a reserved word. :(
<LI>

Add support for <CODE>INSERT INTO table ... VALUES(...),(...),(...)</CODE>,
to allow inserting multiple rows with a single statement.
<LI>

<CODE>INSERT INTO tbl_name</CODE> is now also cached when used with <CODE>LOCK TABLES</CODE>.
(Previously only <CODE>INSERT ... SELECT</CODE> and <CODE>LOAD DATA INFILE</CODE> were
cached.)
<LI>

Allow <CODE>GROUP BY</CODE> functions with <CODE>HAVING</CODE>:

<PRE>
mysql&#62; SELECT col FROM table GROUP BY col HAVING COUNT(*)&#62;0;
</PRE>

<LI>

<CODE>mysqld</CODE> will now ignore trailing <SAMP>`;'</SAMP> characters in queries. This
is to make it easier to migrate from some other SQL servers that require the
trailing <SAMP>`;'</SAMP>.
<LI>

Fix for corrupted fixed-format output generated by <CODE>SELECT INTO OUTFILE</CODE>.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
Added Oracle <CODE>GREATEST()</CODE> and <CODE>LEAST()</CODE> functions.  You must now use
these instead of the <CODE>MAX()</CODE> and <CODE>MIN()</CODE> functions to get the
largest/smallest value from a list of values. These can now handle <CODE>REAL</CODE>,
<CODE>BIGINT</CODE> and string (<CODE>CHAR</CODE> or <CODE>VARCHAR</CODE>) values.
<LI>

<STRONG>Warning: Incompatible change!</STRONG>
<CODE>DAYOFWEEK()</CODE> had offset 0 for Sunday. Changed the offset to 1.
<LI>

Give an error for queries that mix <CODE>GROUP BY</CODE> columns and fields when
there is no <CODE>GROUP BY</CODE> specification.
<LI>

Added <CODE>--vertical</CODE> option to <CODE>mysql</CODE>, for printing results in
vertical mode.
<LI>

Index-only optimization; some queries are now resolved using
only indexes.  Until MySQL 4.0, this works only for numeric columns.
See section <A HREF="manual.html#MySQL_indexes">7.4.5  How MySQL Uses Indexes</A>.
<LI>

Lots of new benchmarks.
<LI>

A new C API chapter and lots of other improvements in the manual.
</UL>



<H3><A NAME="News-3.22.4" HREF="manual_toc.html#News-3.22.4">C.5.32  Changes in release 3.22.4</A></H3>


<UL>
<LI>

Added <CODE>--tmpdir</CODE> option to <CODE>mysqld</CODE>, for specifying the location
of the temporary file directory.
<LI>

MySQL now automatically changes a query from an ODBC client:

<PRE>
SELECT ... FROM table WHERE auto_increment_column IS NULL
</PRE>

to:

<PRE>
SELECT ... FROM table WHERE auto_increment_column == LAST_INSERT_ID()
</PRE>

This allows some ODBC programs (Delphi, Access) to retrieve the newly
inserted row to fetch the <CODE>AUTO_INCREMENT</CODE> id.
<LI>

<CODE>DROP TABLE</CODE> now waits for all users to free a table before deleting it.
<LI>

Fixed small memory leak in the new connect protocol.
<LI>

New functions <CODE>BIN()</CODE>, <CODE>OCT()</CODE>, <CODE>HEX()</CODE> and <CODE>CONV()</CODE> for
converting between different number bases.
<LI>

Added function <CODE>SUBSTRING()</CODE> with two arguments.
<LI>

If you created a table with a record length smaller than 5, you couldn't
delete rows from the table.
<LI>

Added optimization to remove <CODE>const</CODE> reference tables from <CODE>ORDER BY</CODE> and
<CODE>GROUP BY</CODE>.
<LI>

<CODE>mysqld</CODE> now automatically disables system locking on Linux and Windows,
and for systems that use MIT-pthreads.  You can force the use of locking
with the <CODE>--enable-external-locking</CODE> option.
<LI>

Added <CODE>--console</CODE> option to <CODE>mysqld</CODE>, to force a console window
(for error messages) when using Windows.
<LI>

Fixed table locks for Windows.
<LI>

Allow <SAMP>`$'</SAMP> in identifiers.
<LI>

Changed name of user-specific configuration file from <TT>`my.cnf'</TT> to
<TT>`.my.cnf'</TT> (Unix only).
<LI>

Added <CODE>DATE_ADD()</CODE> and <CODE>DATE_SUB()</CODE> functions.
</UL>



<H3><A NAME="News-3.22.3" HREF="manual_toc.html#News-3.22.3">C.5.33  Changes in release 3.22.3</A></H3>


<UL>
<LI>

Fixed a lock problem (bug in MySQL 3.22.1) when closing temporary tables.
<LI>

Added missing <CODE>mysql_ping()</CODE> to the client library.
<LI>

Added <CODE>--compress</CODE> option to all MySQL clients.
<LI>

Changed <CODE>byte</CODE> to <CODE>char</CODE> in <TT>`mysql.h'</TT> and <TT>`mysql_com.h'</TT>.
</UL>



<H3><A NAME="News-3.22.2" HREF="manual_toc.html#News-3.22.2">C.5.34  Changes in release 3.22.2</A></H3>


<UL>
<LI>

Searching on multiple constant keys that matched more than 30% of the rows
didn't always use the best possible key.
<LI>

New functions <CODE>&#60;&#60;</CODE>, <CODE>&#62;&#62;</CODE>, <CODE>RPAD()</CODE> and <CODE>LPAD()</CODE>.
<LI>

You can now save default options (like passwords) in a configuration file
(<TT>`my.cnf'</TT>).
<LI>

Lots of small changes to get <CODE>ORDER BY</CODE> to work when no records are found
when using fields that are not in <CODE>GROUP BY</CODE> (MySQL extension).
<LI>

Added <CODE>--chroot</CODE> option to <CODE>mysqld</CODE>, to start <CODE>mysqld</CODE> in
a chroot environment (by Nikki Chumakov <a HREF="mailto:nikkic@cityline.ru">nikkic@cityline.ru</a>).
<LI>

Trailing spaces are now ignored when comparing case-sensitive strings;
this should fix some problems with ODBC and flag 512!
<LI>

Fixed a core dump bug in the range optimizer.
<LI>

Added <CODE>--one-thread</CODE> option to <CODE>mysqld</CODE>, for debugging with
LinuxThreads (or <CODE>glibc</CODE>).  (This replaces the <CODE>-T32</CODE> flag)
<LI>

Added <CODE>DROP TABLE IF EXISTS</CODE> to prevent an error from occurring if the
table doesn't exist.
<LI>

<CODE>IF</CODE> and <CODE>EXISTS</CODE> are now reserved words (they would have to
be sooner or later).
<LI>

Added lots of new options to <CODE>mysqldump</CODE>.
<LI>

Server error messages are now in <TT>`mysqld_error.h'</TT>.
<LI>

The client/server protocol now supports compression.
<LI>

All bugfixes from MySQL 3.21.32.
</UL>



<H3><A NAME="News-3.22.1" HREF="manual_toc.html#News-3.22.1">C.5.35  Changes in release 3.22.1 (Jun 1998: Alpha)</A></H3>


<UL>
<LI>

Added new C API function <CODE>mysql_ping()</CODE>.
<LI>

Added new API functions <CODE>mysql_init()</CODE> and <CODE>mysql_options()</CODE>.
You now MUST call <CODE>mysql_init()</CODE> before you call
<CODE>mysql_real_connect()</CODE>.
You don't have to call <CODE>mysql_init()</CODE> if you only use
<CODE>mysql_connect()</CODE>.
<LI>

Added <CODE>mysql_options(...,MYSQL_OPT_CONNECT_TIMEOUT,...)</CODE> so you can set a
timeout for connecting to a server.
<LI>

Added <CODE>--timeout</CODE> option to <CODE>mysqladmin</CODE>, as a test of
<CODE>mysql_options()</CODE>.
<LI>

Added <CODE>AFTER column</CODE> and <CODE>FIRST</CODE> options to
<CODE>ALTER TABLE ... ADD columns</CODE>.
This makes it possible to add a new column at some specific location
within a row in an existing table.
<LI>

<CODE>WEEK()</CODE> now takes an optional argument to allow handling of weeks when
the week starts on Monday (some European countries).  By default,
<CODE>WEEK()</CODE> assumes the week starts on Sunday.
<LI>

<CODE>TIME</CODE> columns weren't stored properly (bug in MySQL 3.22.0).
<LI>

<CODE>UPDATE</CODE> now returns information about how many rows were
matched and updated, and how many ``warnings'' occurred when doing the update.
<LI>

Fixed incorrect result from <CODE>FORMAT(-100,2)</CODE>.
<LI>

<CODE>ENUM</CODE> and <CODE>SET</CODE> columns were compared in binary (case-sensitive)
fashion; changed to be case-insensitive.
</UL>



<H3><A NAME="News-3.22.0" HREF="manual_toc.html#News-3.22.0">C.5.36  Changes in release 3.22.0</A></H3>


<UL>
<LI>

New (backward-compatible) connect protocol that allows you to
specify the database to use when connecting, to get much faster
connections to a specific database.

The <CODE>mysql_real_connect()</CODE> call is changed to:


<PRE>
mysql_real_connect(MYSQL *mysql, const char *host, const char *user,
                   const char *passwd, const char *db, uint port,
                   const char *unix_socket, uint client_flag)
</PRE>

<LI>

Each connection is handled by its own thread, rather than by the
master <CODE>accept()</CODE> thread.  This fixes permanently the telnet bug
that was a topic on the mail list some time ago.
<LI>

All TCP/IP connections are now checked with backward-resolution of
the hostname to get better security. <CODE>mysqld</CODE> now has a local hostname
resolver cache so connections should actually be faster than before,
even with this feature.
<LI>

A site automatically will be blocked from future connections if someone
repeatedly connects with an ``improper header'' (like when one uses telnet).
<LI>

You can now refer to tables in different databases with references of the form
<CODE>tbl_name@db_name</CODE> or <CODE>db_name.tbl_name</CODE>.  This makes it possible to
give a user read access to some tables and write access to others simply by
keeping them in different databases!
<LI>

Added <CODE>--user</CODE> option to <CODE>mysqld</CODE>, to allow it to run
as another Unix user (if it is started as the Unix <CODE>root</CODE> user).
<LI>

Added caching of users and access rights (for faster access rights checking)
<LI>

Normal users (not anonymous ones) can change their password with
<CODE>mysqladmin password "newpwd"</CODE>.  This uses encrypted passwords
that are not logged in the normal MySQL log!
<LI>

All important string functions are now coded in assembler for x86 Linux
machines.  This gives a speedup of 10% in many cases.
<LI>

For tables that have many columns, the column names are now hashed for
much faster column name lookup (this will speed up some benchmark
tests a lot!)
<LI>

Some benchmarks are changed to get better individual timing.
(Some loops were so short that a specific test took &#60; 2 seconds. The
loops have been changed to take about 20 seconds to make it easier
to compare different databases. A test that took 1-2 seconds before
now takes 11-24 seconds, which is much better)
<LI>

Re-arranged <CODE>SELECT</CODE> code to handle some very specific queries
involving group functions (like <CODE>COUNT(*)</CODE>) without a <CODE>GROUP BY</CODE> but
with <CODE>HAVING</CODE>. The following now works:

<PRE>
mysql&#62; SELECT COUNT(*) as C FROM table HAVING C &#62; 1;
</PRE>

<LI>

Changed the protocol for field functions to be faster and avoid some
calls to <CODE>malloc()</CODE>.
<LI>

Added <CODE>-T32</CODE> option to <CODE>mysqld</CODE>, for running all queries under the
main thread.  This makes it possible to debug <CODE>mysqld</CODE> under Linux with
<CODE>gdb</CODE>!
<LI>

Added optimization of <CODE>not_null_column IS NULL</CODE> (needed for some Access
queries).
<LI>

Allow <CODE>STRAIGHT_JOIN</CODE> to be used between two tables to force the optimizer
to join them in a specific order.
<LI>

String functions now return <CODE>VARCHAR</CODE> rather than <CODE>CHAR</CODE> and
the column type is now <CODE>VARCHAR</CODE> for fields saved as <CODE>VARCHAR</CODE>.
This should make the <CODE>MyODBC</CODE> driver better, but may break some old
MySQL clients that don't handle <CODE>FIELD_TYPE_VARCHAR</CODE> the same
way as <CODE>FIELD_TYPE_CHAR</CODE>.
<LI>

<CODE>CREATE INDEX</CODE> and <CODE>DROP INDEX</CODE> are now implemented through
<CODE>ALTER TABLE</CODE>.
<CODE>CREATE TABLE</CODE> is still the recommended (fast) way to create indexes.
<LI>

Added <CODE>--set-variable</CODE> option <CODE>wait_timeout</CODE> to <CODE>mysqld</CODE>.
<LI>

Added time column to <CODE>mysqladmin processlist</CODE> to show how long a query
has taken or how long a thread has slept.
<LI>

Added lots of new variables to <CODE>show variables</CODE> and some new to
<CODE>show status</CODE>.
<LI>

Added new type <CODE>YEAR</CODE>. <CODE>YEAR</CODE> is stored in 1 byte with allowable
values of 0, and 1901 to 2155.
<LI>

Added new <CODE>DATE</CODE> type that is stored in 3 bytes rather than 4 bytes.
All new tables are created with the new date type if you don't use the
<CODE>--old-protocol</CODE> option to <CODE>mysqld</CODE>.
<LI>

Fixed bug in record caches; for some queries, you could get
<CODE>Error from table handler: #</CODE> on some operating systems.
<LI>

Added <CODE>--enable-assembler</CODE> option to <CODE>configure</CODE>, for x86 machines
(tested on Linux + <CODE>gcc</CODE>).  This will enable assembler functions for the
most important string functions for more speed!
</UL>



<H2><A NAME="News-3.21.x" HREF="manual_toc.html#News-3.21.x">C.6  Changes in release 3.21.x</A></H2>

<P>
<A NAME="IDX2314"></A>

</P>
<P>
MySQL 3.21 is quite old now, and should be avoided if possible.  This
information is kept here for historical purposes only.

</P>



<H3><A NAME="News-3.21.33" HREF="manual_toc.html#News-3.21.33">C.6.1  Changes in release 3.21.33</A></H3>


<UL>
<LI>

Fixed problem when sending <CODE>SIGHUP</CODE> to <CODE>mysqld</CODE>;
<CODE>mysqld</CODE> dumped core when starting from boot on some systems.
<LI>

Fixed problem with losing a little memory for some connections.
<LI>

<CODE>DELETE FROM tbl_name</CODE> without a <CODE>WHERE</CODE> condition is now done the
long way when you use <CODE>LOCK TABLES</CODE> or if the table is in use, to
avoid race conditions.
<LI>

<CODE>INSERT INTO TABLE (timestamp_column) VALUES (NULL);</CODE> didn't set timestamp.
</UL>



<H3><A NAME="News-3.21.32" HREF="manual_toc.html#News-3.21.32">C.6.2  Changes in release 3.21.32</A></H3>


<UL>
<LI>

Fixed some possible race conditions when doing many reopen/close on the same
tables under heavy load!  This can happen if you execute <CODE>mysqladmin
refresh</CODE> often. This could in some very rare cases corrupt the header of the
index file and cause error 126 or 138.

<LI>

Fixed fatal bug in <CODE>refresh()</CODE> when running with the
<CODE>--skip-external-locking</CODE> option.  There was a ``very small'' time gap after
a <CODE>mysqladmin refresh</CODE> when a table could be corrupted if one
thread updated a table while another thread did <CODE>mysqladmin
refresh</CODE> and another thread started a new update ont the same table
before the first thread had finished.  A refresh (or
<CODE>--flush-tables</CODE>) will now not return until all used tables are
closed!
<LI>

<CODE>SELECT DISTINCT</CODE> with a <CODE>WHERE</CODE> clause that didn't match any rows
returned a row in some contexts (bug only in 3.21.31).
<LI>

<CODE>GROUP BY</CODE> + <CODE>ORDER BY</CODE> returned one empty row when no rows where
found.
<LI>

Fixed a bug in the range optimizer that wrote
<CODE>Use_count: Wrong count for ...</CODE> in the error log file.
</UL>



<H3><A NAME="News-3.21.31" HREF="manual_toc.html#News-3.21.31">C.6.3  Changes in release 3.21.31</A></H3>


<UL>
<LI>

Fixed a sign extension problem for the <CODE>TINYINT</CODE> type on Irix.
<LI>

Fixed problem with <CODE>LEFT("constant_string",function)</CODE>.
<LI>

Fixed problem with <CODE>FIND_IN_SET()</CODE>.
<LI>

<CODE>LEFT JOIN</CODE> dumped core if the second table is used with a constant
<CODE>WHERE/ON</CODE> expression that uniquely identifies one record.
<LI>

Fixed problems with <CODE>DATE_FORMAT()</CODE> and incorrect dates.
<CODE>DATE_FORMAT()</CODE> now ignores <CODE>'%'</CODE> to make it possible to extend
it more easily in the future.
</UL>



<H3><A NAME="News-3.21.30" HREF="manual_toc.html#News-3.21.30">C.6.4  Changes in release 3.21.30</A></H3>


<UL>
<LI>

<CODE>mysql</CODE> now returns an exit code &#62; 0 if the query returned an error.
<LI>

Saving of command-line history to file in <CODE>mysql</CODE> client.
By Tommy Larsen <a HREF="mailto:tommy@mix.hive.no">tommy@mix.hive.no</a>.
<LI>

Fixed problem with empty lines that were ignored in <TT>`mysql.cc'</TT>.
<LI>

Save the pid of the signal handler thread in the pid file instead
of the pid of the main thread.
<LI>

Added patch by <a HREF="mailto:tommy@valley.ne.jp">tommy@valley.ne.jp</a> to support Japanese characters
SJIS and UJIS.
<LI>

Changed <CODE>safe_mysqld</CODE> to redirect startup messages to
<CODE>host_name.err</CODE> instead
of <CODE>host_name.log</CODE> to reclaim file space on <CODE>mysqladmin refresh</CODE>.
<LI>

<CODE>ENUM</CODE> always had the first entry as default value.
<LI>

<CODE>ALTER TABLE</CODE> wrote two entries to the update log.
<LI>

<CODE>sql_acc()</CODE> now closes the <CODE>mysql</CODE> grant tables after a reload to
save table space and memory.
<LI>

Changed <CODE>LOAD DATA</CODE> to use less memory with tables and <CODE>BLOB</CODE>
columns.
<LI>

Sorting on a function which made a division / 0 produced a wrong set
in some cases.
<LI>

Fixed <CODE>SELECT</CODE> problem with <CODE>LEFT()</CODE> when using the <CODE>czech</CODE>
character set.
<LI>

Fixed problem in <CODE>isamchk</CODE>; it couldn't repair a packed table in a very
unusual case.
<LI>

<CODE>SELECT</CODE> statements with <CODE>&#38;</CODE> or <CODE>|</CODE> (bit functions) failed on
columns with <CODE>NULL</CODE> values.
<LI>

When comparing a field = field, where one of the fields was a part key,
only the length of the part key was compared.
</UL>



<H3><A NAME="News-3.21.29" HREF="manual_toc.html#News-3.21.29">C.6.5  Changes in release 3.21.29</A></H3>


<UL>
<LI>

<CODE>LOCK TABLES</CODE> + <CODE>DELETE from tbl_name</CODE> never removed locks properly.
<LI>

Fixed problem when grouping on an <CODE>OR</CODE> function.
<LI>

Fixed permission problem with <CODE>umask()</CODE> and creating new databases.
<LI>

Fixed permission problem on result file with <CODE>SELECT ... INTO OUTFILE ...</CODE>
<LI>

Fixed problem in range optimizer (core dump) for a very complex query.
<LI>

Fixed problem when using <CODE>MIN(integer)</CODE> or <CODE>MAX(integer)</CODE> in
<CODE>GROUP BY</CODE>.
<LI>

Fixed bug on Alpha when using integer keys. (Other keys worked on Alpha.)
<LI>

Fixed bug in <CODE>WEEK("XXXX-xx-01")</CODE>.
</UL>



<H3><A NAME="News-3.21.28" HREF="manual_toc.html#News-3.21.28">C.6.6  Changes in release 3.21.28</A></H3>


<UL>
<LI>

Fixed socket permission (clients couldn't connect to Unix socket on Linux).
<LI>

Fixed bug in record caches; for some queries, you could get
<CODE>Error from table handler: #</CODE> on some operating systems.
</UL>



<H3><A NAME="News-3.21.27" HREF="manual_toc.html#News-3.21.27">C.6.7  Changes in release 3.21.27</A></H3>


<UL>
<LI>

Added user level lock functions <CODE>GET_LOCK(string,timeout)</CODE>,
<CODE>RELEASE_LOCK(string)</CODE>.
<LI>

Added <CODE>Opened_tables</CODE> to <CODE>show status</CODE>.
<LI>

Changed connect timeout to 3 seconds to make it somewhat harder
for crackers to kill <CODE>mysqld</CODE> through telnet + TCP/IP.
<LI>

Fixed bug in range optimizer when using
<CODE>WHERE key_part_1 &#62;= something AND key_part_2 &#60;= something_else</CODE>.
<LI>

Changed <CODE>configure</CODE> for detection of FreeBSD 3.0 9803xx and above
<LI>

<CODE>WHERE</CODE> with <CODE>string_col_key = constant_string</CODE> didn't always
find all rows if the column had many values differing only with
characters of the same sort value (like e and e with an accent).
<LI>

Strings keys looked up with 'ref' were not compared in case-sensitive fashion.
<LI>

Added <CODE>umask()</CODE> to make log files non-readable for normal users.
<LI>

Ignore users with old (8-byte) password on startup if not using
<CODE>--old-protocol</CODE> option to <CODE>mysqld</CODE>.
<LI>

<CODE>SELECT</CODE> which matched all key fields returned the values in the
case of the matched values, not of the found values. (Minor problem.)
</UL>



<H3><A NAME="News-3.21.26" HREF="manual_toc.html#News-3.21.26">C.6.8  Changes in release 3.21.26</A></H3>


<UL>
<LI>

<CODE>FROM_DAYS(0)</CODE> now returns "0000-00-00".
<LI>

In <CODE>DATE_FORMAT()</CODE>, PM and AM were swapped for hours 00 and 12.
<LI>

Extended the default maximum key size to 256.
<LI>

Fixed bug when using <CODE>BLOB</CODE>/<CODE>TEXT</CODE> in <CODE>GROUP BY</CODE> with many
tables.
<LI>

An <CODE>ENUM</CODE> field that is not declared <CODE>NOT NULL</CODE> has <CODE>NULL</CODE> as
the default value.
(Previously, the default value was the first enumeration value.)
<LI>

Fixed bug in the join optimizer code when using many part keys
on the same key:  <CODE>INDEX (Organization,Surname(35),Initials(35))</CODE>.
<LI>

Added some tests to the table order optimizer to get some cases with
<CODE>SELECT ... FROM many_tables</CODE> much faster.
<LI>

Added a retry loop around <CODE>accept()</CODE> to possibly fix some problems on some
Linux machines.
</UL>



<H3><A NAME="News-3.21.25" HREF="manual_toc.html#News-3.21.25">C.6.9  Changes in release 3.21.25</A></H3>


<UL>
<LI>

Changed <CODE>typedef 'string'</CODE> to <CODE>typedef 'my_string'</CODE> for better
portability.
<LI>

You can now kill threads that are waiting on a disk-full condition.
<LI>

Fixed some problems with UDF functions.
<LI>

Added long options to <CODE>isamchk</CODE>. Try <CODE>isamchk --help</CODE>.
<LI>

Fixed a bug when using 8 bytes long (alpha); <CODE>filesort()</CODE> didn't work.
Affects <CODE>DISTINCT</CODE>, <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> on 64-bit
processors.
</UL>



<H3><A NAME="News-3.21.24" HREF="manual_toc.html#News-3.21.24">C.6.10  Changes in release 3.21.24</A></H3>


<UL>
<LI>

Dynamic loadable functions. Based on source from Alexis Mikhailov.
<LI>

You couldn't delete from a table if no one had done a <CODE>SELECT</CODE> on the
table.
<LI>

Fixed problem with range optimizer with many <CODE>OR</CODE> operators on key parts
inside each other.
<LI>

Recoded <CODE>MIN()</CODE> and <CODE>MAX()</CODE> to work properly with strings and
<CODE>HAVING</CODE>.
<LI>

Changed default umask value for new files from <CODE>0664</CODE> to <CODE>0660</CODE>.
<LI>

Fixed problem with <CODE>LEFT JOIN</CODE> and constant expressions in the <CODE>ON</CODE>
part.
<LI>

Added Italian error messages from <a HREF="mailto:brenno@dewinter.com">brenno@dewinter.com</a>.
<LI>

<CODE>configure</CODE> now works better on OSF/1 (tested on 4.0D).
<LI>

Added hooks to allow <CODE>LIKE</CODE> optimization with international character
support.
<LI>

Upgraded <CODE>DBI</CODE> to 0.93.
</UL>



<H3><A NAME="News-3.21.23" HREF="manual_toc.html#News-3.21.23">C.6.11  Changes in release 3.21.23</A></H3>


<UL>
<LI>

The following symbols are now reserved words:
<CODE>TIME</CODE>, <CODE>DATE</CODE>, <CODE>TIMESTAMP</CODE>, <CODE>TEXT</CODE>, <CODE>BIT</CODE>,
<CODE>ENUM</CODE>, <CODE>NO</CODE>, <CODE>ACTION</CODE>, <CODE>CHECK</CODE>, <CODE>YEAR</CODE>,
<CODE>MONTH</CODE>, <CODE>DAY</CODE>, <CODE>HOUR</CODE>, <CODE>MINUTE</CODE>, <CODE>SECOND</CODE>,
<CODE>STATUS</CODE>, <CODE>VARIABLES</CODE>.
<LI>

Setting a <CODE>TIMESTAMP</CODE> to <CODE>NULL</CODE> in <CODE>LOAD DATA INFILE ...</CODE> didn't
set the current time for the <CODE>TIMESTAMP</CODE>.
<LI>

Fix <CODE>BETWEEN</CODE> to recognize binary strings. Now <CODE>BETWEEN</CODE> is
case-sensitive.
<LI>

Added <CODE>--skip-thread-priority</CODE> option to <CODE>mysqld</CODE>, for systems
where <CODE>mysqld</CODE> thread scheduling doesn't work properly (BSDI 3.1).
<LI>

Added ODBC functions <CODE>DAYNAME()</CODE> and <CODE>MONTHNAME()</CODE>.
<LI>

Added function <CODE>TIME_FORMAT()</CODE>.  This works like <CODE>DATE_FORMAT()</CODE>,
but takes a time string (<CODE>'HH:MM:SS'</CODE>) as argument.
<LI>

Fixed unlikely(?) key optimizer bug when using <CODE>OR</CODE> operators of key parts
inside <CODE>AND</CODE> expressions.
<LI>

Added <CODE>variables</CODE> command to <CODE>mysqladmin</CODE>.
<LI>

A lot of small changes to the binary releases.
<LI>

Fixed a bug in the new protocol from MySQL 3.21.20.
<LI>

Changed <CODE>ALTER TABLE</CODE> to work with Windows (Windows can't rename
open files).  Also fixed a couple of small bugs in the Windows version.
<LI>

All standard MySQL clients are now ported to MySQL for Windows.
<LI>

MySQL can now be started as a service on NT.
</UL>



<H3><A NAME="News-3.21.22" HREF="manual_toc.html#News-3.21.22">C.6.12  Changes in release 3.21.22</A></H3>


<UL>
<LI>

Starting with this version, all MySQL distributions will be
configured, compiled and tested with <CODE>crash-me</CODE> and the benchmarks on
the following platforms: SunOS 5.6 sun4u, SunOS 5.5.1 sun4u, SunOS 4.14 sun4c,
SunOS 5.6 i86pc, Irix 6.3 mips5k, HP-UX 10.20 hppa, AIX 4.2.1 ppc,
OSF/1 V4.0 alpha, FreeBSD 2.2.2 i86pc and BSDI 3.1 i386.
<LI>

Fix <CODE>COUNT(*)</CODE> problems when the <CODE>WHERE</CODE> clause didn't match any
records.  (Bug from 3.21.17.)
<LI>

Removed that <CODE>NULL = NULL</CODE> is true.  Now you must use <CODE>IS NULL</CODE>
or <CODE>IS NOT NULL</CODE> to test whether a value is <CODE>NULL</CODE>.
(This is according to standard SQL but may break
old applications that are ported from <CODE>mSQL</CODE>.)
You can get the old behavior by compiling with <CODE>-DmSQL_COMPLIANT</CODE>.
<LI>

Fixed bug that caused core-dump when using many <CODE>LEFT OUTER JOIN</CODE> clauses.
<LI>

Fixed bug in <CODE>ORDER BY</CODE> on string formula with possible <CODE>NULL</CODE> values.
<LI>

Fixed problem in range optimizer when using <CODE>&#60;=</CODE> on sub index.
<LI>

Added functions <CODE>DAYOFYEAR()</CODE>, <CODE>DAYOFMONTH()</CODE>, <CODE>MONTH()</CODE>,
<CODE>YEAR()</CODE>, <CODE>WEEK()</CODE>, <CODE>QUARTER()</CODE>, <CODE>HOUR()</CODE>, <CODE>MINUTE()</CODE>,
<CODE>SECOND()</CODE> and <CODE>FIND_IN_SET()</CODE>.
<LI>

Added <CODE>SHOW VARIABLES</CODE> command.
<LI>

Added support of ``long constant strings'' from standard SQL:

<PRE>
mysql&#62; SELECT 'first ' 'second';       -&#62; 'first second'
</PRE>

<LI>

Upgraded Msql-Mysql-modules to 1.1825.
<LI>

Upgraded <CODE>mysqlaccess</CODE> to 2.02.
<LI>

Fixed problem with Russian character set and <CODE>LIKE</CODE>.
<LI>

Ported to OpenBSD 2.1.
<LI>

New Dutch error messages.
</UL>



<H3><A NAME="News-3.21.21a" HREF="manual_toc.html#News-3.21.21a">C.6.13  Changes in release 3.21.21a</A></H3>


<UL>
<LI>

Configure changes for some operating systems.
</UL>



<H3><A NAME="News-3.21.21" HREF="manual_toc.html#News-3.21.21">C.6.14  Changes in release 3.21.21</A></H3>


<UL>
<LI>

Fixed optimizer bug when using
<CODE>WHERE data_field = date_field2 AND date_field2 = constant</CODE>.
<LI>

Added <CODE>SHOW STATUS</CODE> command.
<LI>

Removed <TT>`manual.ps'</TT> from the source distribution to make it smaller.
</UL>



<H3><A NAME="News-3.21.20" HREF="manual_toc.html#News-3.21.20">C.6.15  Changes in release 3.21.20</A></H3>


<UL>
<LI>

Changed the maximum table name and column name lengths from 32 to 64.
<LI>

Aliases can now be of ``any'' length.
<LI>

Fixed <CODE>mysqladmin stat</CODE> to return the right number of queries.
<LI>

Changed protocol (downward compatible) to mark if a column has the
<CODE>AUTO_INCREMENT</CODE> attribute or is a <CODE>TIMESTAMP</CODE>. This is needed for
the new Java driver.
<LI>

Added Hebrew sorting order by Zeev Suraski.
<LI>

Solaris 2.6: Fixed <CODE>configure</CODE> bugs and increased maximum table size
from 2GB to 4GB.
</UL>



<H3><A NAME="News-3.21.19" HREF="manual_toc.html#News-3.21.19">C.6.16  Changes in release 3.21.19</A></H3>


<UL>
<LI>

Upgraded <CODE>DBD</CODE> to 1.1823. This version implements <CODE>mysql_use_result</CODE>
in <CODE>DBD-Mysql</CODE>.
<LI>

Benchmarks updated for empress (by Luuk).
<LI>

Fixed a case of slow range searching.
<LI>

Configure fixes (<TT>`Docs'</TT> directory).
<LI>

Added function <CODE>REVERSE()</CODE> (by Zeev Suraski).
</UL>



<H3><A NAME="News-3.21.18" HREF="manual_toc.html#News-3.21.18">C.6.17  Changes in release 3.21.18</A></H3>


<UL>
<LI>

Issue error message if client C functions are called in wrong order.
<LI>

Added automatic reconnect to the <TT>`libmysql.c'</TT> library. If a write command
fails, an automatic reconnect is done.
<LI>

Small sort sets no longer use temporary files.
<LI>

Upgraded <CODE>DBI</CODE> to 0.91.
<LI>

Fixed a couple of problems with <CODE>LEFT OUTER JOIN</CODE>.
<LI>

Added <CODE>CROSS JOIN</CODE> syntax. <CODE>CROSS</CODE> is now a reserved word.
<LI>

Recoded <CODE>yacc</CODE>/<CODE>bison</CODE> stack allocation to be even safer and to allow
MySQL to handle even bigger expressions.
<LI>

Fixed a couple of problems with the update log.
<LI>

<CODE>ORDER BY</CODE> was slow when used with key ranges.
</UL>



<H3><A NAME="News-3.21.17" HREF="manual_toc.html#News-3.21.17">C.6.18  Changes in release 3.21.17</A></H3>


<UL>
<LI>

Changed documentation string of <CODE>--with-unix-socket-path</CODE> to avoid
confusion.
<LI>

Added ODBC and standard SQL style <CODE>LEFT OUTER JOIN</CODE>.
<LI>

The following are new reserved words: <CODE>LEFT</CODE>, <CODE>NATURAL</CODE>,
<CODE>USING</CODE>.
<LI>

The client library now uses the value of the environment variable
<CODE>MYSQL_HOST</CODE> as the default host if it's defined.
<LI>

<CODE>SELECT col_name, SUM(expr)</CODE> now returns <CODE>NULL</CODE> for <CODE>col_name</CODE>
when there are matching rows.
<LI>

Fixed problem with comparing binary strings and <CODE>BLOB</CODE> values with ASCII
characters over 127.
<LI>

Fixed lock problem: when freeing a read lock on a table with multiple
read locks, a thread waiting for a write lock would have been given the lock.
This shouldn't affect data integrity, but could possibly make <CODE>mysqld</CODE>
restart if one thread was reading data that another thread modified.
<LI>

<CODE>LIMIT offset,count</CODE> didn't work in <CODE>INSERT ... SELECT</CODE>.
<LI>

Optimized key block caching. This will be quicker than the old algorithm when
using bigger key caches.
</UL>



<H3><A NAME="News-3.21.16" HREF="manual_toc.html#News-3.21.16">C.6.19  Changes in release 3.21.16</A></H3>


<UL>
<LI>

Added ODBC 2.0 &#38; 3.0 functions <CODE>POWER()</CODE>, <CODE>SPACE()</CODE>,
<CODE>COT()</CODE>, <CODE>DEGREES()</CODE>, <CODE>RADIANS()</CODE>, <CODE>ROUND(2 arg)</CODE>
and <CODE>TRUNCATE()</CODE>.
<LI>

<STRONG>Warning: Incompatible change!</STRONG> <CODE>LOCATE()</CODE> parameters were
swapped according to ODBC standard. Fixed.
<LI>

Added function <CODE>TIME_TO_SEC()</CODE>.
<LI>

In some cases, default values were not used for <CODE>NOT NULL</CODE> fields.
<LI>

Timestamp wasn't always updated properly in <CODE>UPDATE SET ...</CODE> statements.
<LI>

Allow empty strings as default values for <CODE>BLOB</CODE> and <CODE>TEXT</CODE>, to
be compatible with <CODE>mysqldump</CODE>.
</UL>



<H3><A NAME="News-3.21.15" HREF="manual_toc.html#News-3.21.15">C.6.20  Changes in release 3.21.15</A></H3>


<UL>
<LI>

<STRONG>Warning: Incompatible change!</STRONG> <CODE>mysqlperl</CODE> is now from
Msql-Mysql-modules. This means that <CODE>connect()</CODE> now takes
<CODE>host</CODE>, <CODE>database</CODE>, <CODE>user</CODE>, <CODE>password</CODE> arguments! The old
version took <CODE>host</CODE>, <CODE>database</CODE>, <CODE>password</CODE>, <CODE>user</CODE>.
<LI>

Allow <CODE>DATE '1997-01-01'</CODE>, <CODE>TIME '12:10:10'</CODE> and
<CODE>TIMESTAMP '1997-01-01 12:10:10'</CODE> formats required by standard SQL.
<STRONG>Warning: Incompatible change!</STRONG> This has the unfortunate
side effect that you no longer can have columns named <CODE>DATE</CODE>, <CODE>TIME</CODE>
or <CODE>TIMESTAMP</CODE>. :( Old columns can still be accessed through
<CODE>tbl_name.col_name</CODE>!)
<LI>

Changed Makefiles to hopefully work better with BSD systems. Also,
<TT>`manual.dvi'</TT> is now included in the distribution to avoid having stupid
<CODE>make</CODE> programs trying to rebuild it.
<LI>

<CODE>readline</CODE> library upgraded to version 2.1.
<LI>

A new sortorder german-1. That is a normal ISO-Latin1 with a german sort
order.
<LI>

Perl <CODE>DBI</CODE>/<CODE>DBD</CODE> is now included in the distribution. <CODE>DBI</CODE>
is now the recommended way to connect to MySQL from Perl.
<LI>

New portable benchmark suite with <CODE>DBD</CODE>, with test results from
<CODE>mSQL</CODE> 2.0.3, MySQL, PostgreSQL 6.2.1 and Solid server 2.2.
<LI>

<CODE>crash-me</CODE> is now included with the benchmarks; this is a Perl program
designed to find as many limits as possible in an SQL server. Tested with
<CODE>mSQL</CODE>, PostgreSQL, Solid and MySQL.
<LI>

Fixed bug in range-optimizer that crashed MySQL on some queries.
<LI>

Table and column name completion for <CODE>mysql</CODE> command-line tool, by Zeev
Suraski and Andi Gutmans.
<LI>

Added new command <CODE>REPLACE</CODE> that works like <CODE>INSERT</CODE> but
replaces conflicting records with the new record. <CODE>REPLACE INTO
TABLE ... SELECT ...</CODE> works also.
<LI>

Added new commands <CODE>CREATE DATABASE db_name</CODE> and <CODE>DROP
DATABASE db_name</CODE>.
<LI>

Added <CODE>RENAME</CODE> option to <CODE>ALTER TABLE</CODE>: <CODE>ALTER TABLE name
RENAME TO new_name</CODE>.
<LI>

<CODE>make_binary_distribution</CODE> now includes <TT>`libgcc.a'</TT> in
<TT>`libmysqlclient.a'</TT>. This should make linking work for people who don't
have <CODE>gcc</CODE>.
<LI>

Changed <CODE>net_write()</CODE> to <CODE>my_net_write()</CODE> because of a name
conflict with Sybase.
<LI>

<A NAME="IDX2315"></A>
<A NAME="IDX2316"></A>
New function <CODE>DAYOFWEEK()</CODE> compatible with ODBC.
<LI>

Stack checking and <CODE>bison</CODE> memory overrun checking to make MySQL
safer with weird queries.
</UL>



<H3><A NAME="News-3.21.14b" HREF="manual_toc.html#News-3.21.14b">C.6.21  Changes in release 3.21.14b</A></H3>


<UL>
<LI>

Fixed a couple of small <CODE>configure</CODE> problems on some platforms.
</UL>



<H3><A NAME="News-3.21.14a" HREF="manual_toc.html#News-3.21.14a">C.6.22  Changes in release 3.21.14a</A></H3>


<UL>
<LI>

Ported to SCO Openserver 5.0.4  with FSU Pthreads.
<LI>

HP-UX 10.20 should work.
<LI>

Added new function <CODE>DATE_FORMAT()</CODE>.
<LI>

Added <CODE>NOT IN</CODE>.
<LI>

Added automatic removal of 'ODBC function conversions': <CODE>{fn now() }</CODE>
<LI>

Handle ODBC 2.50.3 option flags.
<LI>

Fixed comparison of <CODE>DATE</CODE> and <CODE>TIME</CODE> values with <CODE>NULL</CODE>.
<LI>

Changed language name from germany to german to be consistent with
the other language names.
<LI>

Fixed sorting problem on functions returning a <CODE>FLOAT</CODE>. Previously, the
values were converted to <CODE>INT</CODE> values before sorting.
<LI>

Fixed slow sorting when sorting on key field when using
<CODE>key_column=constant</CODE>.
<LI>

Sorting on calculated <CODE>DOUBLE</CODE> values sorted on integer results instead.
<LI>

<CODE>mysql</CODE> no longer requires a database argument.
<LI>

Changed the place where <CODE>HAVING</CODE> should be. According to the SQL standards, it should
be after <CODE>GROUP BY</CODE> but before <CODE>ORDER BY</CODE>. MySQL 3.20
incorrectly had it last.
<LI>

Added Sybase command <CODE>USE database</CODE> to start using another database.
<LI>

Added automatic adjusting of number of connections and table cache size
if the maximum number of files that can be opened is less than needed.
This should fix that <CODE>mysqld</CODE> doesn't crash even if you haven't done a
<CODE>ulimit -n 256</CODE> before starting <CODE>mysqld</CODE>.
<LI>

Added lots of limit checks to make it safer when running with too little
memory or when doing weird queries.
</UL>



<H3><A NAME="News-3.21.13" HREF="manual_toc.html#News-3.21.13">C.6.23  Changes in release 3.21.13</A></H3>


<UL>
<LI>

Added retry of interrupted reads and clearing of <CODE>errno</CODE>.
This makes Linux systems much safer!
<LI>

Fixed locking bug when using many aliases on the same table in the same
<CODE>SELECT</CODE>.
<LI>

Fixed bug with <CODE>LIKE</CODE> on number key.
<LI>

New error message so you can check whether the connection was lost while
the command was running or whether the connection was down from the start.
<LI>

Added <CODE>--table</CODE> option to <CODE>mysql</CODE> to print in table format.
Moved time and row information after query result.
Added automatic reconnect of lost connections.
<LI>

Added <CODE>!=</CODE> as a synonym for <CODE>&#60;&#62;</CODE>.
<LI>

Added function <CODE>VERSION()</CODE> to make easier logs.
<LI>

New multi-user test <TT>`tests/fork_test.pl'</TT> to put some strain on the
thread library.
</UL>



<H3><A NAME="News-3.21.12" HREF="manual_toc.html#News-3.21.12">C.6.24  Changes in release 3.21.12</A></H3>


<UL>
<LI>

Fixed <CODE>ftruncate()</CODE> call in MIT-pthreads. This made <CODE>isamchk</CODE>
destroy the <TT>`.ISM'</TT> files on (Free)BSD 2.x systems.
<LI>

Fixed broken <CODE>__P_</CODE> patch in MIT-pthreads.
<LI>

Many memory overrun checks. All string functions now return <CODE>NULL</CODE>
if the returned string should be longer than <CODE>max_allowed_packet</CODE> bytes.
<LI>

Changed the name of the <CODE>INTERVAL</CODE> type to <CODE>ENUM</CODE>, because
<CODE>INTERVAL</CODE> is used in standard SQL.
<LI>

In some cases, doing a <CODE>JOIN</CODE> + <CODE>GROUP</CODE> + <CODE>INTO OUTFILE</CODE>,
the result wasn't grouped.
<LI>

<CODE>LIKE</CODE> with <CODE>'_'</CODE> as last character didn't work. Fixed.
<LI>

Added extended standard SQL <CODE>TRIM()</CODE> function.
<LI>

Added <CODE>CURTIME()</CODE>.
<LI>

Added <CODE>ENCRYPT()</CODE> function by Zeev Suraski.
<LI>

Fixed better <CODE>FOREIGN KEY</CODE> syntax skipping. New reserved words:
<CODE>MATCH</CODE>, <CODE>FULL</CODE>, <CODE>PARTIAL</CODE>.
<LI>

<CODE>mysqld</CODE> now allows IP number and hostname for the <CODE>--bind-address</CODE>
option.
<LI>

Added <CODE>SET CHARACTER SET cp1251_koi8</CODE> to enable conversions of
data to and from the <CODE>cp1251_koi8</CODE> character set.
<LI>

Lots of changes for Windows 95 port. In theory, this version should now be
easily portable to Windows 95.
<LI>

Changed the <CODE>CREATE COLUMN</CODE> syntax of <CODE>NOT NULL</CODE> columns to be after
the <CODE>DEFAULT</CODE> value, as specified in the standard SQL standard. This will
make <CODE>mysqldump</CODE> with <CODE>NOT NULL</CODE> and default values incompatible with
MySQL 3.20.
<LI>

Added many function name aliases so the functions can be used with
ODBC or standard SQL syntax.
<LI>

Fixed syntax of <CODE>ALTER TABLE tbl_name ALTER COLUMN col_name SET DEFAULT
NULL</CODE>.
<LI>

Added <CODE>CHAR</CODE> and <CODE>BIT</CODE> as synonyms for <CODE>CHAR(1)</CODE>.
<LI>

Fixed core dump when updating as a user who has only <CODE>SELECT</CODE> privilege.
<LI>

<CODE>INSERT ... SELECT ... GROUP BY</CODE> didn't work in some cases. An
<CODE>Invalid use of group function</CODE> error occurred.
<LI>

When using <CODE>LIMIT</CODE>, <CODE>SELECT</CODE> now always uses keys instead of record
scan.  This will give better performance on <CODE>SELECT</CODE> and a <CODE>WHERE</CODE>
that matches many rows.
<LI>

Added Russian error messages.
</UL>



<H3><A NAME="News-3.21.11" HREF="manual_toc.html#News-3.21.11">C.6.25  Changes in release 3.21.11</A></H3>


<UL>
<LI>

Configure changes.
<LI>

MySQL now works with the new thread library on BSD/OS 3.0.
<LI>

Added new group functions <CODE>BIT_OR()</CODE> and <CODE>BIT_AND()</CODE>.
<LI>

Added compatibility functions <CODE>CHECK</CODE> and <CODE>REFERENCES</CODE>.
<CODE>CHECK</CODE> is now a reserved word.
<LI>

Added <CODE>ALL</CODE> option to <CODE>GRANT</CODE> for better compatibility. (<CODE>GRANT</CODE>
is still a dummy function.)
<LI>

Added partly translated Dutch error messages.
<LI>

Fixed bug in <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> with <CODE>NULL</CODE> columns.
<LI>

Added function <CODE>LAST_INSERT_ID()</CODE> SQL function to retrieve last
<CODE>AUTO_INCREMENT</CODE>
value.  This is intended for clients to ODBC that can't use the
<CODE>mysql_insert_id()</CODE> API function, but can be used by any client.
<LI>

Added <CODE>--flush-logs</CODE> option to <CODE>mysqladmin</CODE>.
<LI>

Added command <CODE>STATUS</CODE> to <CODE>mysql</CODE>.
<LI>

Fixed problem with <CODE>ORDER BY</CODE>/<CODE>GROUP BY</CODE> because of bug in <CODE>gcc</CODE>.
<LI>

Fixed problem with <CODE>INSERT ... SELECT ... GROUP BY</CODE>.
</UL>



<H3><A NAME="News-3.21.10" HREF="manual_toc.html#News-3.21.10">C.6.26  Changes in release 3.21.10</A></H3>


<UL>
<LI>

New program <CODE>mysqlaccess</CODE>.
<LI>

<CODE>CREATE</CODE> now supports all ODBC types and the <CODE>mSQL</CODE> <CODE>TEXT</CODE> type.
All ODBC 2.5 functions are also supported (added <CODE>REPEAT</CODE>). This provides
better portability.
<LI>

Added text types <CODE>TINYTEXT</CODE>, <CODE>TEXT</CODE>, <CODE>MEDIUMTEXT</CODE> and
<CODE>LONGTEXT</CODE>.  These are actually <CODE>BLOB</CODE> types, but all searching is
done in case-insensitive fashion.
<LI>

All old <CODE>BLOB</CODE> fields are now <CODE>TEXT</CODE> fields.  This only
changes that all searching on strings is done in case-sensitive fashion.
You must do an <CODE>ALTER TABLE</CODE> and change the data type to <CODE>BLOB</CODE>
if you want to have tests done in case-sensitive fashion.
<LI>

Fixed some <CODE>configure</CODE> issues.
<LI>

Made the locking code a bit safer. Fixed very unlikely
deadlock situation.
<LI>

Fixed a couple of bugs in the range optimizer. Now the new range benchmark
<CODE>test-select</CODE> works.
</UL>



<H3><A NAME="News-3.21.9" HREF="manual_toc.html#News-3.21.9">C.6.27  Changes in release 3.21.9</A></H3>


<UL>
<LI>

Added <CODE>--enable-unix-socket=pathname</CODE> option to <CODE>configure</CODE>.
<LI>

Fixed a couple of portability problems with include files.
<LI>

Fixed bug in range calculation that could return empty
set when searching on multiple key with only one entry (very rare).
<LI>

Most things ported to FSU Pthreads, which should allow MySQL to
run on SCO. See section <A HREF="manual.html#SCO">2.6.5.8  SCO Notes</A>.
</UL>



<H3><A NAME="News-3.21.8" HREF="manual_toc.html#News-3.21.8">C.6.28  Changes in release 3.21.8</A></H3>


<UL>
<LI>

Works now in Solaris 2.6.
<LI>

Added handling of calculation of <CODE>SUM()</CODE> functions.
For example, you can now use <CODE>SUM(column)/COUNT(column)</CODE>.
<LI>

Added handling of trigometric functions:
<CODE>PI()</CODE>, <CODE>ACOS()</CODE>, <CODE>ASIN()</CODE>, <CODE>ATAN()</CODE>, <CODE>COS()</CODE>,
<CODE>SIN()</CODE> and <CODE>TAN()</CODE>.
<LI>

New languages: Norwegian, Norwegian-ny and Portuguese.
<LI>

Fixed parameter bug in <CODE>net_print()</CODE> in <TT>`procedure.cc'</TT>.
<LI>

Fixed a couple of memory leaks.
<LI>

Now allow also the old <CODE>SELECT ... INTO OUTFILE</CODE> syntax.
<LI>

Fixed bug with <CODE>GROUP BY</CODE> and <CODE>SELECT</CODE> on key with many values.
<LI>

<CODE>mysql_fetch_lengths()</CODE> sometimes returned incorrect lengths when you used
<CODE>mysql_use_result()</CODE>. This affected at least some cases of
<CODE>mysqldump --quick</CODE>.
<LI>

Fixed bug in optimization of <CODE>WHERE const op field</CODE>.
<LI>

Fixed problem when sorting on <CODE>NULL</CODE> fields.
<LI>

Fixed a couple of 64-bit (Alpha) problems.
<LI>

Added <CODE>--pid-file=#</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added date formatting to <CODE>FROM_UNIXTIME()</CODE>, originally by Zeev Suraski.
<LI>

Fixed bug in <CODE>BETWEEN</CODE> in range optimizer (did only test = of the first
argument).
<LI>

Added machine-dependent files for MIT-pthreads i386-SCO. There is probably
more to do to get this to work on SCO 3.5.
</UL>



<H3><A NAME="News-3.21.7" HREF="manual_toc.html#News-3.21.7">C.6.29  Changes in release 3.21.7</A></H3>


<UL>
<LI>

Changed <TT>`Makefile.am'</TT> to take advantage of Automake 1.2.
<LI>

Added the beginnings of a benchmark suite.
<LI>

Added more secure password handling.
<LI>

Added new client function <CODE>mysql_errno()</CODE>, to get the error number of
the error message. This makes error checking in the client much easier.
This makes the new server incompatible with the 3.20.x server when running
without <CODE>--old-protocol</CODE>.  The client code is backward-compatible.
More information can be found in the <TT>`README'</TT> file!
<LI>

Fixed some problems when using very long, illegal names.
</UL>



<H3><A NAME="News-3.21.6" HREF="manual_toc.html#News-3.21.6">C.6.30  Changes in release 3.21.6</A></H3>


<UL>
<LI>

Fixed more portability issues (incorrect <CODE>sigwait</CODE> and <CODE>sigset</CODE>
defines).
<LI>

<CODE>configure</CODE> should now be able to detect the last argument to
<CODE>accept()</CODE>.
</UL>



<H3><A NAME="News-3.21.5" HREF="manual_toc.html#News-3.21.5">C.6.31  Changes in release 3.21.5</A></H3>


<UL>
<LI>

Should now work with FreeBSD 3.0 if used with
<TT>`FreeBSD-3.0-libc_r-1.0.diff'</TT>,
which can be found at <a HREF="http://dev.mysql.com/downloads/os-freebsd.html">http://dev.mysql.com/downloads/os-freebsd.html</a>.
<LI>

Added new <CODE>-O tmp_table_size=#</CODE> option to <CODE>mysqld</CODE>.
<LI>

New function <CODE>FROM_UNIXTIME(timestamp)</CODE> which returns a date string in
<CODE>'YYYY-MM-DD HH:MM:SS'</CODE> format.
<LI>

New function <CODE>SEC_TO_TIME(seconds)</CODE> which returns a string in
<CODE>'HH:MM:SS'</CODE> format.
<LI>

New function <CODE>SUBSTRING_INDEX()</CODE>, originally by Zeev Suraski.
</UL>



<H3><A NAME="News-3.21.4" HREF="manual_toc.html#News-3.21.4">C.6.32  Changes in release 3.21.4</A></H3>


<UL>
<LI>

Should now configure and compile on OSF/1 4.0 with the DEC compiler.
<LI>

Configuration and compilation on BSD/OS 3.0 works, but due to some bugs in
BSD/OS 3.0, <CODE>mysqld</CODE> doesn't work on it yet.
<LI>

Configuration and compilation on FreeBSD 3.0 works, but I couldn't get
<CODE>pthread_create</CODE> to work.
</UL>



<H3><A NAME="News-3.21.3" HREF="manual_toc.html#News-3.21.3">C.6.33  Changes in release 3.21.3</A></H3>


<UL>
<LI>

Added reverse check lookup of hostnames to get better security.
<LI>

Fixed some possible buffer overflows if filenames that are too long are used.
<LI>

<CODE>mysqld</CODE> doesn't accept hostnames that start with digits followed by a
<CODE>'.'</CODE>, because the hostname may look like an IP number.
<LI>

Added <CODE>--skip-networking</CODE> option to <CODE>mysqld</CODE>, to allow only socket
connections.  (This will not work with MIT-pthreads!)
<LI>

Added check of too long table names for alias.
<LI>

Added check whether database name is okay.
<LI>

Added check whether too long table names.
<LI>

Removed incorrect <CODE>free()</CODE> that killed the server on
<CODE>CREATE DATABASE</CODE> or <CODE>DROP DATABASE</CODE>.
<LI>

Changed some <CODE>mysqld</CODE> <CODE>-O</CODE> options to better names.
<LI>

Added <CODE>-O join_cache_size=#</CODE> option to <CODE>mysqld</CODE>.
<LI>

Added <CODE>-O max_join_size=#</CODE> option to <CODE>mysqld</CODE>, to be able to set a
limit how big queries (in this case big = slow) one should be able to handle
without specifying <CODE>SET SQL_BIG_SELECTS=1</CODE>.  A # = is about 10
examined records. The default is ``unlimited.''
<LI>

When comparing a <CODE>TIME</CODE>, <CODE>DATE</CODE>, <CODE>DATETIME</CODE> or <CODE>TIMESTAMP</CODE>
column to a constant, the constant is converted to a time value before
performing the comparison.
This will make it easier to get ODBC (particularly Access97) to work with
these types. It should also make dates easier to use and the comparisons
should be quicker than before.
<LI>

Applied patch from Jochen Wiedmann that allows <CODE>query()</CODE> in
<CODE>mysqlperl</CODE> to take a query with <CODE>\0</CODE> in it.
<LI>

Storing a timestamp with a two-digit year (<CODE>YYMMDD</CODE>) didn't work.
<LI>

Fix that timestamp wasn't automatically updated if set in an <CODE>UPDATE</CODE>
clause.
<LI>

Now the automatic timestamp field is the FIRST timestamp field.
<LI>

<CODE>SELECT * INTO OUTFILE</CODE>, which didn't correctly if the outfile already
existed.
<LI>

<CODE>mysql</CODE> now shows the thread ID when starting or doing a reconnect.
<LI>

Changed the default sort buffer size from 2MB to 1MB.
</UL>



<H3><A NAME="News-3.21.2" HREF="manual_toc.html#News-3.21.2">C.6.34  Changes in release 3.21.2</A></H3>


<UL>
<LI>

The range optimizer is coded, but only 85% tested. It can be enabled with
<CODE>--new</CODE>, but it crashes core a lot yet...
<LI>

More portable. Should compile on AIX and alpha-digital.
At least the <CODE>isam</CODE> library should be relatively 64-bit clean.
<LI>

New <CODE>isamchk</CODE> which can detect and fix more problems.
<LI>

New options for <CODE>isamlog</CODE>.
<LI>

Using new version of Automake.
<LI>

Many small portability changes (from the AIX and alpha-digital port)
Better checking of pthread(s) library.
<LI>

czech error messages by <a HREF="mailto:snajdr@pvt.net">snajdr@pvt.net</a>.
<LI>

Decreased size of some buffers to get fewer problems on systems with little
memory.  Also added more checks to handle ``out of memory'' problems.
<LI>

<CODE>mysqladmin</CODE>: you can now do <CODE>mysqladmin kill 5,6,7,8</CODE> to kill
multiple threads.
<LI>

When the maximum connection limit is reached, one extra connection by a user
with the <STRONG>process_acl</STRONG> privilege is granted.
<LI>

Added <CODE>-O backlog=#</CODE> option to <CODE>mysqld</CODE>.
<LI>

Increased maximum packet size from 512KB to 1024KB for client.
<LI>

Almost all of the function code is now tested in the internal test suite.
<LI>

<CODE>ALTER TABLE</CODE> now returns warnings from field conversions.
<LI>

Port changed to 3306 (got it reserved from ISI).
<LI>

Added a fix for Visual FoxBase so that any schema name from a table
specification is automatically removed.
<LI>

New function <CODE>ASCII()</CODE>.
<LI>

Removed function <CODE>BETWEEN(a,b,c)</CODE>. Use the standard SQL
syntax instead: <CODE>expr BETWEEN expr AND expr</CODE>.
<LI>

MySQL no longer has to use an extra temporary table when sorting
on functions or <CODE>SUM()</CODE> functions.
<LI>

Fixed bug that you couldn't use <CODE>tbl_name.field_name</CODE> in <CODE>UPDATE</CODE>.
<LI>

Fixed <CODE>SELECT DISTINCT</CODE> when using 'hidden group'. For example:

<PRE>
mysql&#62; SELECT DISTINCT MOD(some_field,10) FROM test
    -&#62;        GROUP BY some_field;
</PRE>

Note: <CODE>some_field</CODE> is normally in the <CODE>SELECT</CODE> part. Standard SQL should
require it.
</UL>



<H3><A NAME="News-3.21.0" HREF="manual_toc.html#News-3.21.0">C.6.35  Changes in release 3.21.0</A></H3>


<UL>
<LI>

New reserved words used: <CODE>INTERVAL</CODE>, <CODE>EXPLAIN</CODE>, <CODE>READ</CODE>,
<CODE>WRITE</CODE>, <CODE>BINARY</CODE>.
<LI>

Added ODBC function <CODE>CHAR(num,...)</CODE>.
<LI>

New operator <CODE>IN</CODE>. This uses a binary search to find a match.
<LI>

New command <CODE>LOCK TABLES tbl_name [AS alias] {READ|WRITE} ...</CODE>
<LI>

Added <CODE>--log-update</CODE> option to <CODE>mysqld</CODE>, to get a log suitable for
incremental updates.
<LI>

New command <CODE>EXPLAIN SELECT ...</CODE> to get information about how the
optimizer will do the join.
<LI>

For easier client code, the client should no longer use
<CODE>FIELD_TYPE_TINY_BLOB</CODE>, <CODE>FIELD_TYPE_MEDIUM_BLOB</CODE>,
<CODE>FIELD_TYPE_LONG_BLOB</CODE> or <CODE>FIELD_TYPE_VAR_STRING</CODE> (as
previously returned by <CODE>mysql_list_fields</CODE>).  You should instead use only
<CODE>FIELD_TYPE_BLOB</CODE> or <CODE>FIELD_TYPE_STRING</CODE>.  If you want exact
types, you should use the command <CODE>SHOW FIELDS</CODE>.
<LI>

Added varbinary syntax: <CODE>0x######</CODE> which can be used as a string
(default) or a number.
<LI>

<CODE>FIELD_TYPE_CHAR</CODE> is renamed to <CODE>FIELD_TYPE_TINY</CODE>.
<LI>

Changed all fields to C++ classes.
<LI>

Removed FORM struct.
<LI>

Fields with <CODE>DEFAULT</CODE> values no longer need to be <CODE>NOT NULL</CODE>.
<LI>

New field types:
<DL COMPACT>

<DT><CODE>ENUM</CODE>
<DD>
A string which can take only a couple of defined values. The value is
stored as a 1-3 byte number that is mapped automatically to a string.
This is sorted according to string positions!
<DT><CODE>SET</CODE>
<DD>
A string which may have one or many string values separated by ','.
The string is stored as a 1-, 2-, 3-, 4- or 8-byte number where each bit stands
for a specific set member.  This is sorted according to the unsigned value
of the stored packed number.
</DL>
<LI>

Now all function calculation is done with <CODE>double</CODE> or <CODE>long long</CODE>.
This will provide the full 64-bit range with bit functions and fix some
conversions that previously could result in precision losses.  One should
avoid using <CODE>unsigned long long</CODE> columns with full 64-bit range
(numbers bigger than 9223372036854775807) because calculations are done
with <CODE>signed long long</CODE>.
<LI>

<CODE>ORDER BY</CODE> will now put <CODE>NULL</CODE> field values first. <CODE>GROUP BY</CODE>
will also work with <CODE>NULL</CODE> values.
<LI>

Full <CODE>WHERE</CODE> with expressions.
<LI>

New range optimizer that can resolve ranges when some keypart prefix is
constant. Example:

<PRE>
mysql&#62; SELECT * FROM tbl_name
    -&#62;          WHERE key_part_1="customer"
    -&#62;          AND key_part_2&#62;=10 AND key_part_2&#60;=10;
</PRE>

</UL>



<H2><A NAME="News-3.20.x" HREF="manual_toc.html#News-3.20.x">C.7  Changes in release 3.20.x</A></H2>

<P>
<A NAME="IDX2317"></A>

</P>
<P>
MySQL 3.20 is quite old now, and should be avoided if possible.  This
information is kept here for historical purposes only.

</P>
<P>
Changes from 3.20.18 to 3.20.32b are not documented here because the
3.21 release branched here. And the relevant changes are also
documented as changes to the 3.21 version.

</P>



<H3><A NAME="News-3.20.18" HREF="manual_toc.html#News-3.20.18">C.7.1  Changes in release 3.20.18</A></H3>


<UL>
<LI>

Added <CODE>-p#</CODE> (remove <CODE>#</CODE> directories from path) to <CODE>isamlog</CODE>.
All files are written with a relative path from the database directory
Now <CODE>mysqld</CODE> shouldn't crash on shutdown when using the
<CODE>--log-isam</CODE> option.
<LI>

New <CODE>mysqlperl</CODE> version. It is now compatible with <CODE>msqlperl-0.63</CODE>.
<LI>

New <CODE>DBD</CODE> module available.
<LI>

Added group function <CODE>STD()</CODE> (standard deviation).
<LI>

The <CODE>mysqld</CODE> server is now compiled by default without debugging
information.  This will make the daemon smaller and faster.
<LI>

Now one usually only has to specify the <CODE>--basedir</CODE> option to
<CODE>mysqld</CODE>. All other paths are relative in a normal installation.
<LI>

<CODE>BLOB</CODE> columns sometimes contained garbage when used with a <CODE>SELECT</CODE>
on more than one table and <CODE>ORDER BY</CODE>.
<LI>

Fixed that calculations that are not in <CODE>GROUP BY</CODE> work as expected
(standard SQL extension).
Example:

<PRE>
mysql&#62; SELECT id,id+1 FROM table GROUP BY id;
</PRE>

<LI>

The test of using <CODE>MYSQL_PWD</CODE> was reversed. Now <CODE>MYSQL_PWD</CODE> is
enabled as default in the default release.
<LI>

Fixed conversion bug which caused <CODE>mysqld</CODE> to core dump with
Arithmetic error on SPARC-386.
<LI>

Added <CODE>--unbuffered</CODE> option to <CODE>mysql</CODE>, for new <CODE>mysqlaccess</CODE>.
<LI>

When using overlapping (unnecessary) keys and join over many tables,
the optimizer could get confused and return 0 records.
</UL>



<H3><A NAME="News-3.20.17" HREF="manual_toc.html#News-3.20.17">C.7.2  Changes in release 3.20.17</A></H3>


<UL>
<LI>

You can now use <CODE>BLOB</CODE> columns and the functions <CODE>IS NULL</CODE> and
<CODE>IS NOT NULL</CODE> in the <CODE>WHERE</CODE> clause.
<LI>

All communication packets and row buffers are now allocated dynamically
on demand. The default value of <CODE>max_allowed_packet</CODE> is now 64KB for
the server and 512KB for the client. This is mainly used to catch
incorrect packets that could trash all memory. The server limit may be
changed when it is started.
<LI>

Changed stack usage to use less memory.
<LI>

Changed <CODE>safe_mysqld</CODE> to check for running daemon.
<LI>

The <CODE>ELT()</CODE> function is renamed to <CODE>FIELD()</CODE>.  The new
<CODE>ELT()</CODE> function returns a value based on an index: <CODE>FIELD()</CODE>
is the inverse of <CODE>ELT()</CODE> Example: <CODE>ELT(2,"A","B","C")</CODE> returns
<CODE>"B"</CODE>. <CODE>FIELD("B","A","B","C")</CODE> returns <CODE>2</CODE>.
<LI>

<CODE>COUNT(field)</CODE>, where <CODE>field</CODE> could have a <CODE>NULL</CODE> value, now
works.
<LI>

A couple of bugs fixed in <CODE>SELECT ... GROUP BY</CODE>.
<LI>

Fixed memory overrun bug in <CODE>WHERE</CODE> with many unoptimizable brace levels.
<LI>

Fixed some small bugs in the grant code.
<LI>

If hostname isn't found by <CODE>get_hostname</CODE>, only the IP is checked.
Previously, you got <CODE>Access denied</CODE>.
<LI>

Inserts of timestamps with values didn't always work.
<LI>

<CODE>INSERT INTO ... SELECT ... WHERE</CODE> could give the error
<CODE>Duplicated field</CODE>.
<LI>

Added some tests to <CODE>safe_mysqld</CODE> to make it ``safer.''
<LI>

<CODE>LIKE</CODE> was case-sensitive in some places and case-insensitive in others.
Now <CODE>LIKE</CODE> is always case-insensitive.
<LI>

<TT>`mysql.cc'</TT>: Allow <CODE>'#'</CODE> anywhere on the line.
<LI>

New command <CODE>SET SQL_SELECT_LIMIT=#</CODE>. See the FAQ for more details.
<LI>

New version of the <CODE>mysqlaccess</CODE> script.
<LI>

Change <CODE>FROM_DAYS()</CODE> and <CODE>WEEKDAY()</CODE> to also take a full
<CODE>TIMESTAMP</CODE> or <CODE>DATETIME</CODE> as argument. Before they only took a
number of type <CODE>YYYYMMDD</CODE> or <CODE>YYMMDD</CODE>.
<LI>

Added new function <CODE>UNIX_TIMESTAMP(timestamp_column)</CODE>.
</UL>



<H3><A NAME="News-3.20.16" HREF="manual_toc.html#News-3.20.16">C.7.3  Changes in release 3.20.16</A></H3>


<UL>
<LI>

More changes in MIT-pthreads to get them safer. Fixed also some link
bugs at least in SunOS.
<LI>

Changed <CODE>mysqld</CODE> to work around a bug in MIT-pthreads. This makes multiple
small <CODE>SELECT</CODE> operations 20 times faster. Now <CODE>lock_test.pl</CODE> should
work.
<LI>

Added <CODE>mysql_FetchHash(handle)</CODE> to <CODE>mysqlperl</CODE>.
<LI>

The <CODE>mysqlbug</CODE> script is now distributed built to allow for reporting
bugs that appear during the build with it.
<LI>

Changed <TT>`libmysql.c'</TT> to prefer <CODE>getpwuid()</CODE> instead of
<CODE>cuserid()</CODE>.
<LI>

Fixed bug in <CODE>SELECT</CODE> optimizer when using many tables with the same
column used as key to different tables.
<LI>

Added new <CODE>latin2</CODE> and Russian <CODE>KOI8</CODE> character tables.
<LI>

Added support for a dummy <CODE>GRANT</CODE> command to satisfy Powerbuilder.
</UL>



<H3><A NAME="News-3.20.15" HREF="manual_toc.html#News-3.20.15">C.7.4  Changes in release 3.20.15</A></H3>


<UL>
<LI>

Fixed fatal bug <CODE>packets out of order</CODE> when using MIT-pthreads.
<LI>

Removed possible loop when a thread waits for command from client
and <CODE>fcntl()</CODE> fails. Thanks to Mike Bretz for finding this bug.
<LI>

Changed alarm loop in <TT>`mysqld.cc'</TT> because shutdown didn't always
succeed in Linux.
<LI>

Removed use of <CODE>termbits</CODE> from <TT>`mysql.cc'</TT>.  This conflicted with
<CODE>glibc</CODE> 2.0.
<LI>

Fixed some syntax errors for at least BSD and Linux.
<LI>

Fixed bug when doing a <CODE>SELECT</CODE> as superuser without a database.
<LI>

Fixed bug when doing <CODE>SELECT</CODE> with group calculation to outfile.
</UL>



<H3><A NAME="News-3.20.14" HREF="manual_toc.html#News-3.20.14">C.7.5  Changes in release 3.20.14</A></H3>


<UL>
<LI>

If one gives <CODE>-p</CODE> or <CODE>--password</CODE> option to <CODE>mysql</CODE> without
an argument, the user is solicited for the password from the tty.
<LI>

Added default password from <CODE>MYSQL_PWD</CODE> (by Elmar Haneke).
<LI>

Added command <CODE>kill</CODE> to <CODE>mysqladmin</CODE> to kill a specific
MySQL thread.
<LI>

Sometimes when doing a reconnect on a down connection this succeeded
first on second try.
<LI>

Fixed adding an <CODE>AUTO_INCREMENT</CODE> key with <CODE>ALTER_TABLE</CODE>.
<LI>

<CODE>AVG()</CODE> gave too small value on some <CODE>SELECT</CODE> statements with
<CODE>GROUP BY</CODE> and <CODE>ORDER BY</CODE>.
<LI>

Added new <CODE>DATETIME</CODE> type (by Giovanni Maruzzelli
<a HREF="mailto:maruzz@matrice.it">maruzz@matrice.it</a>).
<LI>

Fixed that defining <CODE>DONT_USE_DEFAULT_FIELDS</CODE> works.
<LI>

Changed to use a thread to handle alarms instead of signals on Solaris to
avoid race conditions.
<LI>

Fixed default length of signed numbers. (George Harvey
<a HREF="mailto:georgeh@pinacl.co.uk">georgeh@pinacl.co.uk</a>.)
<LI>

Allow anything for <CODE>CREATE INDEX</CODE>.
<LI>

Add prezeros when packing numbers to <CODE>DATE</CODE>, <CODE>TIME</CODE> and
<CODE>TIMESTAMP</CODE>.
<LI>

Fixed a bug in <CODE>OR</CODE> of multiple tables (gave empty set).
<LI>

Added many patches to MIT-pthreads. This fixes at least one lookup bug.
</UL>



<H3><A NAME="News-3.20.13" HREF="manual_toc.html#News-3.20.13">C.7.6  Changes in release 3.20.13</A></H3>


<UL>
<LI>

Added standard SQL <CODE>DATE</CODE> and <CODE>TIME</CODE> types.
<LI>

Fixed bug in <CODE>SELECT</CODE> with <CODE>AND</CODE>-<CODE>OR</CODE> levels.
<LI>

Added support for Slovenian characters. The <TT>`Contrib'</TT> directory contains
source and instructions for adding other character sets.
<LI>

Fixed bug with <CODE>LIMIT</CODE> and <CODE>ORDER BY</CODE>.
<LI>

Allow <CODE>ORDER BY</CODE> and <CODE>GROUP BY</CODE> on items that aren't in the
<CODE>SELECT</CODE> list.
(Thanks to Wim Bonis <a HREF="mailto:bonis@kiss.de">bonis@kiss.de</a>, for pointing this out.)
<LI>

Allow setting of timestamp values in <CODE>INSERT</CODE>.
<LI>

Fixed bug with <CODE>SELECT ... WHERE ... = NULL</CODE>.
<LI>

Added changes for <CODE>glibc</CODE> 2.0. To get <CODE>glibc</CODE> to work, you should
add the <TT>`gibc-2.0-sigwait-patch'</TT> before compiling <CODE>glibc</CODE>.
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> when changing a <CODE>NOT NULL</CODE> field to
allow <CODE>NULL</CODE> values.
<LI>

Added some standard SQL synonyms as field types to <CODE>CREATE TABLE</CODE>.
<CODE>CREATE TABLE</CODE> now allows <CODE>FLOAT(4)</CODE> and <CODE>FLOAT(8)</CODE> to mean
<CODE>FLOAT</CODE> and <CODE>DOUBLE</CODE>.
<LI>

New utility program <CODE>mysqlaccess</CODE> by <a HREF="mailto:Yves.Carlier@rug.ac.be">Yves.Carlier@rug.ac.be</a>.
This program shows the access rights for a specific user and the grant
rows that determine this grant.
<LI>

Added <CODE>WHERE const op field</CODE> (by <a HREF="mailto:bonis@kiss.de">bonis@kiss.de</a>).
</UL>



<H3><A NAME="News-3.20.11" HREF="manual_toc.html#News-3.20.11">C.7.7  Changes in release 3.20.11</A></H3>


<UL>
<LI>

When using <CODE>SELECT ... INTO OUTFILE</CODE>, all temporary tables are <CODE>ISAM</CODE>
instead of <CODE>HEAP</CODE> to allow big dumps.
<LI>

Changed date functions to be string functions. This fixed some ``funny''
side effects when sorting on dates.
<LI>

Extended <CODE>ALTER TABLE</CODE> for standard SQL compliance.
<LI>

Some minor compatibility changes.
<LI>

Added <CODE>--port</CODE> and <CODE>--socket</CODE> options to all utility programs and
<CODE>mysqld</CODE>.
<LI>

Fixed MIT-pthreads <CODE>readdir_r()</CODE>. Now <CODE>mysqladmin create database</CODE>
and <CODE>mysqladmin drop database</CODE> should work.
<LI>

Changed MIT-pthreads to use our <CODE>tempnam()</CODE>. This should fix the ``sort
aborted'' bug.
<LI>

Added sync of records count in <CODE>sql_update</CODE>. This fixed slow updates
on first connection. (Thanks to Vaclav Bittner for the test.)
</UL>



<H3><A NAME="News-3.20.10" HREF="manual_toc.html#News-3.20.10">C.7.8  Changes in release 3.20.10</A></H3>


<UL>
<LI>

New insert type: <CODE>INSERT INTO ... SELECT ...</CODE>
<LI>

<CODE>MEDIUMBLOB</CODE> fixed.
<LI>

Fixed bug in <CODE>ALTER TABLE</CODE> and <CODE>BLOB</CODE> values.
<LI>

<CODE>SELECT ... INTO OUTFILE</CODE> now creates the file in the current
database directory.
<LI>

<CODE>DROP TABLE</CODE> now can take a list of tables.
<LI>

Oracle synonym <CODE>DESCRIBE</CODE> (<CODE>DESC</CODE>).
<LI>

Changes to <CODE>make_binary_distribution</CODE>.
<LI>

Added some comments to installation instructions about <CODE>configure</CODE>
C++ link test.
<LI>

Added <CODE>--without-perl</CODE> option to <CODE>configure</CODE>.
<LI>

Lots of small portability changes.
</UL>



<H3><A NAME="News-3.20.9" HREF="manual_toc.html#News-3.20.9">C.7.9  Changes in release 3.20.9</A></H3>


<UL>
<LI>

<CODE>ALTER TABLE</CODE> didn't copy null bit. As a result, fields that were allowed
to have <CODE>NULL</CODE> values were always <CODE>NULL</CODE>.
<LI>

<CODE>CREATE</CODE> didn't take numbers as <CODE>DEFAULT</CODE>.
<LI>

Some compatibility changes for SunOS.
<LI>

Removed <TT>`config.cache'</TT> from old distribution.
</UL>



<H3><A NAME="News-3.20.8" HREF="manual_toc.html#News-3.20.8">C.7.10  Changes in release 3.20.8</A></H3>


<UL>
<LI>

Fixed bug with <CODE>ALTER TABLE</CODE> and multiple-part keys.
</UL>



<H3><A NAME="News-3.20.7" HREF="manual_toc.html#News-3.20.7">C.7.11  Changes in release 3.20.7</A></H3>


<UL>
<LI>

New commands: <CODE>ALTER TABLE</CODE>, <CODE>SELECT ... INTO OUTFILE</CODE> and
<CODE>LOAD DATA INFILE</CODE>.
<LI>

New function: <CODE>NOW()</CODE>.
<LI>

Added new field <CODE>File_priv</CODE> to <CODE>mysql/user</CODE> table.
<LI>

New script <CODE>add_file_priv</CODE> which adds the new field <CODE>File_priv</CODE>
to the <CODE>user</CODE> table. This script must be executed if you want to
use the new <CODE>SELECT ... INTO</CODE> and <CODE>LOAD DATA INFILE ...</CODE> commands
with a version of MySQL earlier than 3.20.7.
<LI>

Fixed bug in locking code, which made <CODE>lock_test.pl</CODE> test fail.
<LI>

New files <TT>`NEW'</TT> and <TT>`BUGS'</TT>.
<LI>

Changed <TT>`select_test.c'</TT> and <TT>`insert_test.c'</TT> to include
<TT>`config.h'</TT>.
<LI>

Added <CODE>status</CODE> command to <CODE>mysqladmin</CODE> for short logging.
<LI>

Increased maximum number of keys to 16 and maximum number of key parts to 15.
<LI>

Use of sub keys. A key may now be a prefix of a string field.
<LI>

Added <CODE>-k</CODE> option to <CODE>mysqlshow</CODE>, to get key information for a table.
<LI>

Added long options to <CODE>mysqldump</CODE>.
</UL>



<H3><A NAME="News-3.20.6" HREF="manual_toc.html#News-3.20.6">C.7.12  Changes in release 3.20.6</A></H3>


<UL>
<LI>

Portable to more systems because of MIT-pthreads, which will
be used automatically if <CODE>configure</CODE> cannot find a <CODE>-lpthreads</CODE>
library.
<LI>

Added GNU-style long options to almost all programs. Test with
<CODE><KBD>program</KBD> --help</CODE>.
<LI>

Some shared library support for Linux.
<LI>

The FAQ is now in <TT>`.texi'</TT> format and is available in <TT>`.html'</TT>,
<TT>`.txt'</TT> and <TT>`.ps'</TT> formats.
<LI>

Added new SQL function <CODE>RAND([init])</CODE>.
<LI>

Changed <CODE>sql_lex</CODE> to handle <CODE>\0</CODE> unquoted, but the client can't send
the query through the C API, because it takes a str pointer.
You must use <CODE>mysql_real_query()</CODE> to send the query.
<LI>

Added API function <CODE>mysql_get_client_info()</CODE>.
<LI>

<CODE>mysqld</CODE> now uses the <CODE>N_MAX_KEY_LENGTH</CODE> from <TT>`nisam.h'</TT> as
the maximum allowable key length.
<LI>

The following now works:

<PRE>
mysql&#62; SELECT filter_nr,filter_nr FROM filter ORDER BY filter_nr;
</PRE>

Previously, this resulted in the error:
<CODE>Column: 'filter_nr' in order clause is ambiguous</CODE>.
<LI>

<CODE>mysql</CODE> now outputs <CODE>'\0'</CODE>, <CODE>'\t'</CODE>, <CODE>'\n'</CODE> and <CODE>'\\'</CODE>
when encountering ASCII 0, tab, newline, or <CODE>'\'</CODE> while writing
tab-separated output.
This is to allow printing of binary data in a portable format.
To get the old behavior, use <CODE>-r</CODE> (or <CODE>--raw</CODE>).
<LI>

Added german error messages (60 of 80 error messages translated).
<LI>

Added new API function <CODE>mysql_fetch_lengths(MYSQL_RES *)</CODE>, which
returns an array of column lengths (of type <CODE>uint</CODE>).
<LI>

Fixed bug with <CODE>IS NULL</CODE> in <CODE>WHERE</CODE> clause.
<LI>

Changed the optimizer a little to get better results when searching on a key
part.
<LI>

Added <CODE>SELECT</CODE> option <CODE>STRAIGHT_JOIN</CODE> to tell the optimizer that
it should join tables in the given order.
<LI>

Added support for comments starting with <CODE>'--'</CODE> in <TT>`mysql.cc'</TT>
(Postgres syntax).
<LI>

You can have <CODE>SELECT</CODE> expressions and table columns in a <CODE>SELECT</CODE>
which are not used in the group part. This makes it efficient to implement
lookups.  The column that is used should be a constant for each group because
the value is calculated only once for the first row that is found for a group.

<PRE>
mysql&#62; SELECT id,lookup.text,SUM(*) FROM test,lookup
    -&#62;        WHERE test.id=lookup.id GROUP BY id;
</PRE>

<LI>

Fixed bug in <CODE>SUM(function)</CODE> (could cause a core dump).
<LI>

Changed <CODE>AUTO_INCREMENT</CODE> placement in the SQL query:

<PRE>
INSERT INTO table (auto_field) VALUES (0);
</PRE>

inserted 0, but it should insert an <CODE>AUTO_INCREMENT</CODE> value.
<LI>

<TT>`mysqlshow.c'</TT>: Added number of records in table. Had to change the
client code a little to fix this.
<LI>

<CODE>mysql</CODE> now allows doubled <CODE>''</CODE> or <CODE>""</CODE> within strings for
embedded <CODE>'</CODE> or <CODE>"</CODE>.
<LI>

New math functions:
<CODE>EXP()</CODE>, <CODE>LOG()</CODE>, <CODE>SQRT()</CODE>, <CODE>ROUND()</CODE>, <CODE>CEILING()</CODE>.
</UL>



<H3><A NAME="News-3.20.3" HREF="manual_toc.html#News-3.20.3">C.7.13  Changes in release 3.20.3</A></H3>


<UL>
<LI>

The <CODE>configure</CODE> source now compiles a thread-free client library
<CODE>-lmysqlclient</CODE>. This is the only library that needs to be linked
with client applications.  When using the binary releases, you must
link with <CODE>-lmysql -lmysys -ldbug -lmystrings</CODE> as before.
<LI>

New <CODE>readline</CODE> library from <CODE>bash-2.0</CODE>.
<LI>

LOTS of small changes to <CODE>configure</CODE> and makefiles (and related source).
<LI>

It should now be possible to compile in another directory using
<CODE>VPATH</CODE>. Tested with GNU Make 3.75.
<LI>

<CODE>safe_mysqld</CODE> and <CODE>mysql.server</CODE> changed to be more compatible
between the source and the binary releases.
<LI>

<CODE>LIMIT</CODE> now takes one or two numeric arguments.
If one argument is given, it indicates the maximum number of rows in
a result. If two arguments are given, the first argument indicates the offset
of the first row to return, the second is the maximum number of rows.
With this it's easy to do a poor man's next page/previous page WWW
application.
<LI>

Changed name of SQL function <CODE>FIELDS()</CODE> to <CODE>ELT()</CODE>.
Changed SQL function <CODE>INTERVALL()</CODE> to <CODE>INTERVAL()</CODE>.
<LI>

Made <CODE>SHOW COLUMNS</CODE> a synonym for <CODE>SHOW FIELDS</CODE>.
Added compatibility syntax <CODE>FRIEND KEY</CODE> to <CODE>CREATE TABLE</CODE>. In
MySQL, this creates a non-unique key on the given columns.
<LI>

Added <CODE>CREATE INDEX</CODE> and <CODE>DROP INDEX</CODE> as compatibility functions.
In MySQL, <CODE>CREATE INDEX</CODE> only checks whether the index exists and
issues an error if it doesn't exist. <CODE>DROP INDEX</CODE> always succeeds.
<LI>

<TT>`mysqladmin.c'</TT>: added client version to version information.
<LI>

Fixed core dump bug in <CODE>sql_acl</CODE> (core on new connection).
<LI>

Removed <CODE>host</CODE>, <CODE>user</CODE> and <CODE>db</CODE> tables from database <CODE>test</CODE>
in the distribution.
<LI>

<CODE>FIELD_TYPE_CHAR</CODE> can now be signed (-128 to 127) or unsigned (0 to 255)
Previously, it was always unsigned.
<LI>

Bug fixes in <CODE>CONCAT()</CODE> and <CODE>WEEKDAY()</CODE>.
<LI>

Changed a lot of source to get <CODE>mysqld</CODE> to be compiled with SunPro
compiler.
<LI>

SQL functions must now have a <CODE>'('</CODE> immediately after the function name
(no intervening space).
For example, <CODE>'USER('</CODE> is regarded as beginning a function call, and
<CODE>'USER ('</CODE> is regarded as an identifier <CODE>USER</CODE> followed by a
<CODE>'('</CODE>, not as a function call.
</UL>



<H3><A NAME="News-3.20.0" HREF="manual_toc.html#News-3.20.0">C.7.14  Changes in release 3.20.0</A></H3>


<UL>
<LI>

The source distribution is done with <CODE>configure</CODE> and Automake.
It will make porting much easier.  The <CODE>readline</CODE> library is included
in the distribution.
<LI>

Separate client compilation:
the client code should be very easy to compile on systems which
don't have threads.
<LI>

The old Perl interface code is automatically compiled and installed.
Automatic compiling of <CODE>DBD</CODE> will follow when the new <CODE>DBD</CODE> code
is ported.
<LI>

Dynamic language support: <CODE>mysqld</CODE> can now be started with Swedish
or English (default) error messages.
<LI>

New functions: <CODE>INSERT()</CODE>, <CODE>RTRIM()</CODE>, <CODE>LTRIM()</CODE> and
<CODE>FORMAT()</CODE>.
<LI>

<CODE>mysqldump</CODE> now works correctly for all field types (even
<CODE>AUTO_INCREMENT</CODE>). The format for <CODE>SHOW FIELDS FROM tbl_name</CODE>
is changed so the <CODE>Type</CODE> column contains information suitable for
<CODE>CREATE TABLE</CODE>.  In previous releases, some <CODE>CREATE TABLE</CODE>
information had to be patched when re-creating tables.
<LI>

Some parser bugs from 3.19.5 (<CODE>BLOB</CODE> and <CODE>TIMESTAMP</CODE>) are corrected.
<CODE>TIMESTAMP</CODE> now returns different date information depending on its
create length.
<LI>

Changed parser to allow a database, table or field name to
start with a number or <CODE>'_'</CODE>.
<LI>

All old C code from Unireg changed to C++ and cleaned up. This makes
the daemon a little smaller and easier to understand.
<LI>

A lot of small bugfixes done.
<LI>

New <TT>`INSTALL'</TT> files (not final version) and some information regarding porting.
</UL>



<H2><A NAME="News-3.19.x" HREF="manual_toc.html#News-3.19.x">C.8  Changes in release 3.19.x</A></H2>

<P>
<A NAME="IDX2318"></A>

</P>
<P>
MySQL 3.19 is quite old now, and should be avoided if possible.  This
information is kept here for historical purposes only.

</P>



<H3><A NAME="News-3.19.5" HREF="manual_toc.html#News-3.19.5">C.8.1  Changes in release 3.19.5</A></H3>


<UL>
<LI>

Some new functions, some more optimization on joins.
<LI>

Should now compile clean on Linux (2.0.x).
<LI>

Added functions <CODE>DATABASE()</CODE>, <CODE>USER()</CODE>, <CODE>POW()</CODE>,
<CODE>LOG10()</CODE> (needed for ODBC).
<LI>

In a <CODE>WHERE</CODE> with an <CODE>ORDER BY</CODE> on fields from only one table,
the table is now preferred as first table in a multi-join.
<LI>

<CODE>HAVING</CODE> and <CODE>IS NULL</CODE> or <CODE>IS NOT NULL</CODE> now works.
<LI>

A group on one column and a sort on a group function (<CODE>SUM()</CODE>,
<CODE>AVG()</CODE>...) didn't work together. Fixed.
<LI>

<CODE>mysqldump</CODE>: Didn't send password to server.
</UL>



<H3><A NAME="News-3.19.4" HREF="manual_toc.html#News-3.19.4">C.8.2  Changes in release 3.19.4</A></H3>


<UL>
<LI>

Fixed horrible locking bug when inserting in one thread and reading
in another thread.
<LI>

Fixed one-off decimal bug.  1.00 was output as 1.0.
<LI>

Added attribute <CODE>'Locked'</CODE> to process list as information if a query is
locked by another query.
<LI>

Fixed full magic timestamp. Timestamp length may now be 14, 12, 10, 8, 6, 4
or 2 bytes.
<LI>

Sort on some numeric functions could sort incorrectly on last number.
<LI>

<CODE>IF(arg,syntax_error,syntax_error)</CODE> crashed.
<LI>

Added functions <CODE>CEILING()</CODE>, <CODE>ROUND()</CODE>, <CODE>EXP()</CODE>, <CODE>LOG()</CODE> and <CODE>SQRT()</CODE>.
<LI>

Enhanced <CODE>BETWEEN</CODE> to handle strings.
</UL>



<H3><A NAME="News-3.19.3" HREF="manual_toc.html#News-3.19.3">C.8.3  Changes in release 3.19.3</A></H3>


<UL>
<LI>

Fixed <CODE>SELECT</CODE> with grouping on <CODE>BLOB</CODE> columns not to return
incorrect <CODE>BLOB</CODE> info. Grouping, sorting and distinct on <CODE>BLOB</CODE>
columns will not yet work as
expected (probably it will group/sort by the first 7 characters in the
<CODE>BLOB</CODE>). Grouping on formulas with a fixed string size (use <CODE>MID()</CODE>
on a <CODE>BLOB</CODE>) should work.
<LI>

When doing a full join (no direct keys) on multiple tables with <CODE>BLOB</CODE>
fields, the <CODE>BLOB</CODE> was garbage on output.
<LI>

Fixed <CODE>DISTINCT</CODE> with calculated columns.
</UL>



<H2><A NAME="InnoDB_change_history" HREF="manual_toc.html#InnoDB_change_history">C.9  <CODE>InnoDB</CODE> Change History</A></H2>



<H3><A NAME="InnoDB_news-4.1.2" HREF="manual_toc.html#InnoDB_news-4.1.2">C.9.1  MySQL/InnoDB-4.1.2, not released yet</A></H3>

<P>
Functionality added or changed:

</P>

<UL>
<LI>

Do not assert in <TT>`log0log.c'</TT>, line 856 if <CODE>ib_logfiles</CODE> are
too small for <CODE>innodb_thread_concurrency</CODE>.  Instead, print
instructions how to adjust <TT>`my.cnf'</TT> and call <CODE>exit(1)</CODE>.

<LI>

If MySQL tries to <CODE>SELECT</CODE> from an InnoDB table without setting
any table locks, print a descriptive error message and assert; some
subquery bugs were of this type.

<LI>

Added a missing space to the output format of <CODE>SHOW INNODB STATUS</CODE>;
reported by Jocelyn Fournier.

<LI>

Support multiple character sets.  Note that tables created in other
collations than <CODE>latin1_swedish_ci</CODE> cannot be accessed in
MySQL/InnoDB 4.0.

<LI>

Allow a key path length in InnoDB to be up to 3,500 bytes; this is
needed so that one can create an index on a column with 255 UTF-8
characters.
</UL>

<P>
Bugs fixed:

</P>

<UL>
<LI>

Improved portability to 64-bit platforms, especially Win64.

<LI>

Fixed an assertion failure when a purge of a table was not possible
because of missing <TT>`.ibd'</TT> file.

<LI>

Fixed a bug: do not retrieve all columns in a table if we only need
the 'ref' of the row (usually, the <CODE>PRIMARY KEY</CODE>) to calculate an
<CODE>ORDER BY</CODE>. (Bug #1942)

<LI>

On Unix-like systems, obtain an exclusive advisory lock on InnoDB
files, to prevent corruption when multiple instances of MySQL are
running on the same set of data files.  The Windows version of InnoDB
already took a mandatory lock on the files. (Bug #3608)

<LI>

All bugfixes from InnoDB-4.0.17, InnoDB-4.0.18, InnoDB-4.0.19 and InnoDB-4.0.20.
</UL>



<H3><A NAME="InnoDB_news-4.0.20" HREF="manual_toc.html#InnoDB_news-4.0.20">C.9.2  MySQL/InnoDB-4.0.20, not released yet</A></H3>

<P>
Bugs fixed:

</P>

<UL>
<LI>

Make <CODE>LOCK TABLE</CODE> aware of InnoDB row-level locks. (Bug #3299)

<LI>

Fixed race conditions in SHOW INNODB STATUS. (Bug #3596)
</UL>



<H3><A NAME="InnoDB_news-4.0.19" HREF="manual_toc.html#InnoDB_news-4.0.19">C.9.3  MySQL/InnoDB-4.0.19, May 4, 2004</A></H3>

<P>
Functionality added or changed:

</P>

<UL>
<LI>

Better error message when the server has to crash because the buffer
pool is exhausted by the lock table or the adaptive hash index.

<LI>

Print always the count of pending <CODE>pread()</CODE> and <CODE>pwrite()</CODE>
calls if there is a long semaphore wait.

<LI>

Improve space utilization when rows of 1,500 to 8,000 bytes are
inserted in the order of the primary key.

<LI>

Remove potential buffer overflow errors by sending diagnostic output to
stderr or files instead of stdout or fixed-size memory buffers.  As a
side effect, the output of <CODE>SHOW INNODB STATUS</CODE> will be written
to a file <TT>`<VAR>&#60;datadir&#62;</VAR>/innodb.status.<VAR>&#60;pid&#62;</VAR>'</TT> every 15
seconds.
</UL>

<P>
Bugs fixed:

</P>

<UL>
<LI>

Fixed a bug: <CODE>DROP DATABASE</CODE> did not work if <CODE>FOREIGN KEY</CODE>
references were defined within the database. (Bug #3058)

<LI>

Remove unnecessary files, functions and variables.  Many of these were
needed in the standalone version of InnoDB.  Remove debug functions
and variables from non-debug build.

<LI>

Add diagnostic code to analyze an assertion failure in ha_innodb.cc on line
2020 reported by a user. (Bug #2903)

<LI>

Fixed a bug: in a <CODE>FOREIGN KEY</CODE>, <CODE>ON UPDATE CASCADE</CODE>
was not triggered if the update changed a string to another value
identical in alphabetical ordering, e.g., <SAMP>`abc'</SAMP> -&#62; <SAMP>`aBc'</SAMP>.

<LI>

Protect the reading of the latest foreign key error explanation buffer
with a mutex; in theory, a race condition could cause <CODE>SHOW
INNODB STATUS</CODE> print garbage characters after the error info.

<LI>

Fixed a bug: The row count and key cardinality estimate was grossly
too small if each clustered index page only contained one record.

<LI>

Parse <CODE>CONSTRAINT FOREIGN KEY</CODE> correctly. (Bug #3332)

<LI>

Fixed a memory corruption bug on Windows.  The bug is present in all
InnoDB versions in Windows, but it depends on how the linker places a
static array in <CODE>srv0srv.c</CODE>, whether the bug shows itself. 4
bytes were overwritten with a pointer to a statically allocated
string <SAMP>`get windows aio return value'</SAMP>.

<LI>

Fix a glitch reported by Philippe Lewicki on the general mailing list:
do not print a warning to the <TT>`.err'</TT> log if <CODE>read_key</CODE> fails
with a lock wait timeout error 146.

<LI>

Allow quotes to be embedded in strings in the private SQL parser of
InnoDB, so that <SAMP>`''</SAMP> can be used in InnoDB table and column names.
Display quotes within identifiers properly.

<LI>

Debugging: Allow <CODE>UNIV_SYNC_DEBUG</CODE> to be disabled while
<CODE>UNIV_DEBUG</CODE> is enabled.

<LI>

Debugging: Handle magic numbers in a more consistent way.
</UL>



<H3><A NAME="InnoDB_news-4.0.18" HREF="manual_toc.html#InnoDB_news-4.0.18">C.9.4  MySQL/InnoDB-4.0.18, February 13, 2004</A></H3>


<UL>
<LI>

Do not allow dropping a table referenced by a <CODE>FOREIGN KEY</CODE>
constraint, unless the user does <CODE>SET FOREIGN_KEY_CHECKS=0</CODE>.
The error message here is somewhat misleading
``Cannot delete or update a parent row...'', and must be changed in a
future version 4.1.x.
<LI>

Make <CODE>InnoDB</CODE> to remember the <CODE>CONSTRAINT</CODE> name given by a user for
a <CODE>FOREIGN KEY</CODE>.
<LI>

Change the print format of <CODE>FOREIGN KEY</CODE> constraints spanning
multiple databases to <CODE>`db_name`.`tbl_name`</CODE>. But when
parsing them, we must also accept <CODE>`db_name.tbl_name`</CODE>,
because that was the output format in &#60; 4.0.18.
<LI>

An optimization in locking: If <CODE>AUTOCOMMIT=1</CODE>, then we do not
need to make a plain <CODE>SELECT</CODE> set shared locks even on the
<CODE>SERIALIZABLE</CODE> isolation level, because we know that the
transaction is read-only. A read-only transaction can always be
performed on the <CODE>REPEATABLE READ</CODE> level, and that does not
endanger the serializability.
<LI>

Implement an automatic downgrade from &#62;= 4.1.1 -&#62; 4.0.18 if the user
has not created tables in <TT>`.ibd'</TT> files or used other 4.1.x
features. <STRONG>Consult</STRONG> the manual section on
<STRONG>multiple tablespaces</STRONG> carefully if you want to downgrade!
<LI>

Fixed a bug: MySQL should not allow <CODE>REPLACE</CODE> to internally
perform an <CODE>UPDATE</CODE> if the table is referenced by a
<CODE>FOREIGN KEY</CODE>. The MySQL manual states that <CODE>REPLACE</CODE> must
resolve a duplicate-key error semantically with
<CODE>DELETE</CODE>(s) + <CODE>INSERT</CODE>, and not by an <CODE>UPDATE</CODE>.
In versions &#60; 4.0.18 and &#60; 4.1.2, MySQL could resolve a duplicate key
conflict in <CODE>REPLACE</CODE> by doing an <CODE>UPDATE</CODE> on the existing
row, and <CODE>FOREIGN KEY</CODE> checks could behave in a semantically
wrong way. (Bug #2418)
<LI>

Fixed a bug: generate <CODE>FOREIGN KEY</CODE> constraint identifiers
locally for each table, in the form
<CODE>db_name/tbl_name_ibfk_number</CODE>. If the user gives the
constraint name explicitly, then remember it. These changes should
ensure that foreign key id's in a slave are the same as in the master,
and <CODE>DROP FOREIGN KEY</CODE> does not break replication. (Bug #2167)
<LI>

Fixed a bug: allow quoting of identifiers in InnoDB's
<CODE>FOREIGN KEY</CODE> definitions with a backtick (`) and a double quote
("). You can now use also spaces in table and column names, if you
quote the identifiers. (Bug #1725) and (Bug #2424)
<LI>

Fixed a bug: <CODE>FOREIGN KEY ... ON UPDATE/DELETE NO ACTION</CODE> must
check the foreign key constraint, not ignore it. Since we do not have
deferred constraints in <CODE>InnoDB</CODE>, this bugfix makes <CODE>InnoDB</CODE> to check
<CODE>NO ACTION</CODE> constraints immediately, like it checks
<CODE>RESTRICT</CODE> constraints.
<LI>

Fixed a bug: <CODE>InnoDB</CODE> crashed in <CODE>RENAME TABLE</CODE> if 
<CODE>'db_name.tbl_name'</CODE> is shorter than 5 characters.
(Bug #2689)
<LI>

Fixed a bug: in <CODE>SHOW TABLE STATUS</CODE>, <CODE>InnoDB</CODE> row count and index
cardinality estimates wrapped around at 512 million in 32-bit
computers. Note that unless MySQL is compiled with the
<CODE>BIG_TABLES</CODE> option, they will still wrap around at 4 billion.
<LI>

Fixed a bug: If there was a <CODE>UNIQUE</CODE> secondary index, and
<CODE>NULL</CODE> values in that unique index, then with the
<CODE>IS NULL</CODE> predicate, <CODE>InnoDB</CODE> returned only the first matching row,
though there can be many.
This bug was introduced in 4.0.16. (Bug #2483)
</UL>



<H3><A NAME="InnoDB_news-5.0.0" HREF="manual_toc.html#InnoDB_news-5.0.0">C.9.5  MySQL/InnoDB-5.0.0, December 24, 2003</A></H3>


<UL>
<LI>

<STRONG>Important note:</STRONG> If you upgrade to InnoDB-4.1.1 or higher,
you cannot downgrade to a version lower than 4.1.1
any more! That is because earlier versions of <CODE>InnoDB</CODE> are not aware of
multiple tablespaces.
<LI><CODE>InnoDB</CODE> in 5.0.0 is essentially the same as InnoDB-4.1.1 with the

bugfixes of InnoDB-4.0.17 included.
</UL>



<H3><A NAME="InnoDB_news-4.0.17" HREF="manual_toc.html#InnoDB_news-4.0.17">C.9.6  MySQL/InnoDB-4.0.17, December 17, 2003</A></H3>


<UL>
<LI>

Fixed a bug: If you created a column prefix secondary index and updated it
so that the last characters in the column prefix were spaces, <CODE>InnoDB</CODE> would
assert in <TT>`row0upd.c'</TT>, line 713. The same assertion failed if you
updated a column in an ordinary secondary index so that the new value was
alphabetically equivalent, but had a different length. This could happen,
for example, in the UTF8 character set if you updated a letter to its
accented or umlaut form. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could think that a secondary index record was not
locked though it had been updated to an alphabetically equivalent value,
e.g., 'abc' -&#62; 'aBc'. 
<LI>

Fixed a bug: If you updated a secondary index column to an alphabetically
equivalent value, and rolled back your update, <CODE>InnoDB</CODE> failed to restore
the field in the secondary index to its original value. 
<LI>

There are still several outstanding non-critical bugs reported in the MySQL
bugs database. Their fixing has been delayed, because resources were
allocated to the 4.1.1 release.
</UL>



<H3><A NAME="InnoDB_news-4.1.1" HREF="manual_toc.html#InnoDB_news-4.1.1">C.9.7  MySQL/InnoDB-4.1.1, December 4, 2003</A></H3>


<UL>
<LI>

<STRONG>Important note:</STRONG> If you upgrade to InnoDB-4.1.1 or higher,
you cannot downgrade to a version lower than 4.1.1
any more! That is because earlier versions of <CODE>InnoDB</CODE> are not aware of
multiple tablespaces.
<LI>

Multiple tablespaces now available for <CODE>InnoDB</CODE>. You can store each
<CODE>InnoDB</CODE>
type table and its indexes into a separate <TT>`.ibd'</TT> file into a
MySQL database directory, into the same directory where the
<TT>`.frm'</TT> file is stored.
<LI>

The MySQL query cache now works for <CODE>InnoDB</CODE> tables also if
<CODE>AUTOCOMMIT=0</CODE>, or the statements are enclosed inside
<CODE>BEGIN ... COMMIT</CODE>. 
<LI>

Reduced <CODE>InnoDB</CODE> memory consumption by a few megabytes if one sets the buffer
pool size &#60; 8MB. 
<LI>

You can use raw disk partitions also in Windows. 
</UL>



<H3><A NAME="InnoDB_news-4.0.16" HREF="manual_toc.html#InnoDB_news-4.0.16">C.9.8  MySQL/InnoDB-4.0.16, October 22, 2003</A></H3>


<UL>
<LI>

Fixed a bug: in contrary to what was said in the manual, in a locking
read <CODE>InnoDB</CODE> set two record locks if a unique exact match search
condition was used on a multi-column unique key. For a single column
unique key it worked right. 
<LI>

Fixed a bug: If you used the rename trick
<CODE>#sql... -&#62; rsql...</CODE> to recover a temporary table, <CODE>InnoDB</CODE> asserted in
<CODE>row_mysql_lock_data_dictionary()</CODE>.
<LI>

There are several outstanding non-critical bugs reported in the MySQL bugs
database. Their fixing has been delayed, because resources are allocated
to the upcoming 4.1.1 release. 
</UL>



<H3><A NAME="InnoDB_news-3.23.58" HREF="manual_toc.html#InnoDB_news-3.23.58">C.9.9  MySQL/InnoDB-3.23.58, September 15, 2003</A></H3>


<UL>
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could make the index page directory corrupt in the
first B-tree page splits after <CODE>mysqld</CODE> startup. A symptom would be
an assertion failure in <TT>`page0page.c'</TT>, in function
<CODE>page_dir_find_slot()</CODE>.
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could in rare cases return an extraneous row if a
rollback, purge, and a <CODE>SELECT</CODE> coincided.
<LI>

Fixed a possible hang over the <TT>`btr0sea.c'</TT> latch if
<CODE>SELECT</CODE> was used inside <CODE>LOCK TABLES</CODE>.
<LI>

Fixed a bug: If a single <CODE>DELETE</CODE> statement first managed to delete
some rows and then failed in a <CODE>FOREIGN KEY</CODE> error or a
<CODE>Table is full</CODE> error, MySQL did not roll back the whole SQL statement
as it should. 
</UL>



<H3><A NAME="InnoDB_news-4.0.15" HREF="manual_toc.html#InnoDB_news-4.0.15">C.9.10  MySQL/InnoDB-4.0.15, September 10, 2003</A></H3>


<UL>
<LI>

Fixed a bug: If you updated a row so that the 8000 byte maximum length
(without <CODE>BLOB</CODE> and <CODE>TEXT</CODE>) was exceeded, <CODE>InnoDB</CODE> simply removed
the record from the clustered index. In a similar insert, <CODE>InnoDB</CODE> would
leak reserved file space extents, which would only be freed at the next
<CODE>mysqld</CODE> startup. 
<LI>

Fixed a bug: If you used big <CODE>BLOB</CODE> values, and your log files were
relatively small, <CODE>InnoDB</CODE> could in a big <CODE>BLOB</CODE> operation temporarily
write over the log produced after the latest checkpoint. If <CODE>InnoDB</CODE>
would crash at that moment, then the crash recovery would fail,
because <CODE>InnoDB</CODE> would not be able to scan the log even up to the
latest checkpoint. Starting from this version, <CODE>InnoDB</CODE> tries to ensure
the latest checkpoint is young enough. If that is not possible,
<CODE>InnoDB</CODE> prints a warning to the <TT>`.err'</TT> log of MySQL and advises
you to make the log files bigger. 
<LI>

Fixed a bug: setting <CODE>innodb_fast_shutdown=0</CODE> had no effect. 
<LI>

Fixed a bug introduced in 4.0.13: If a <CODE>CREATE TABLE</CODE> ended in a
comment, that could cause a memory overrun. 
<LI>

Fixed a bug: If <CODE>InnoDB</CODE> printed <CODE>Operating system error number .. in
a file operation</CODE> to the <TT>`.err'</TT> log in Windows, the error number
explanation was wrong. Workaround: look at section 13.2 of
http://www.innodb.com/ibman.php about Windows
error numbers.
<LI>

Fixed a bug: If you created a column prefix
<CODE>PRIMARY KEY</CODE> like in <CODE>t(a CHAR(200), PRIMARY KEY (a(10)))</CODE>
on a fixed-length <CODE>CHAR</CODE> column, <CODE>InnoDB</CODE> would crash even in a
simple <CODE>SELECT</CODE>. A <CODE>CHECK TABLE</CODE> would report the table as
corrupt, also in the case where the created key was not <CODE>PRIMARY</CODE>. 
</UL>



<H3><A NAME="InnoDB_news-4.0.14" HREF="manual_toc.html#InnoDB_news-4.0.14">C.9.11  MySQL/InnoDB-4.0.14, July 22, 2003</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports the <CODE>SAVEPOINT</CODE> and <CODE>ROLLBACK TO SAVEPOINT</CODE>
SQL statements. See http://www.innodb.com/ibman.php#Savepoints for
the syntax.
<LI>

You can now create column prefix keys like in
<CODE>CREATE TABLE t (a BLOB, INDEX (a(10)))</CODE>.
<LI>

You can also use <CODE>O_DIRECT</CODE> as the <CODE>innodb_flush_method</CODE> on the
latest versions of Linux and FreeBSD. Beware of possible bugs in those
operating systems, though. 
<LI>

Fixed the checksum calculation of data pages. Previously most OS file
system corruption went unnoticed. Note that if you downgrade from
version &#62;= 4.0.14 to an earlier version &#60; 4.0.14 then in the first
startup(s) <CODE>InnoDB</CODE> will print warnings: 

<PRE>
InnoDB: Warning: An inconsistent page in the doublewrite buffer
InnoDB: space id 2552202359 page number 8245, 127'th page in dblwr buf.
</PRE>

but that is not dangerous and can be ignored. 
<LI>

Modified the buffer pool replacement algorithm so that it tries to
flush modified pages if there are no replaceable pages in the last
10 % of the LRU list. This can reduce disk I/O if the workload is
a mixture of reads and writes. 
<LI>

The buffer pool checkpoint flush algorithm now tries to flush also
close neighbors of the page at the end of the flush list. This can
speed up database shutdown, and can also speed up disk writes if
<CODE>InnoDB</CODE> log files are very small compared to the buffer pool size. 
<LI>

In 4.0.13 we made <CODE>SHOW INNODB STATUS</CODE> to print detailed info
on the latest <CODE>UNIQUE KEY</CODE> error, but storing that info could
slow down <CODE>REPLACE</CODE> significantly. We no longer store or print
the info. 
<LI>

Fixed a bug: <CODE>SET FOREIGN_KEY_CHECKS=0</CODE> was not replicated properly
in the MySQL replication. The fix will not be backported to 3.23. 
<LI>

Fixed a bug: the parameter <CODE>innodb_max_dirty_pages_pct</CODE> forgot to
take into account the free pages in the buffer pool. This could lead
to excessive flushing even though there were lots of free pages in
the buffer pool. Workaround: <CODE>SET GLOBAL
innodb_max_dirty_pages_pct = 100</CODE>.
<LI>

Fixed a bug: If there were big index scans then a file read request
could starve and <CODE>InnoDB</CODE> could assert because of a very long semaphore wait. 
<LI>

Fixed a bug: If <CODE>AUTOCOMMIT=1</CODE> then inside <CODE>LOCK TABLES</CODE> MySQL
failed to do the commit after an updating SQL statement if binary logging was
not on, and for <CODE>SELECT</CODE> statements did not commit regardless of binary logging state. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could make the index page directory corrupt in the
first B-tree page splits after a <CODE>mysqld</CODE> startup. A symptom would be an
assertion in page0page.c, in function page_dir_find_slot(). 
<LI>

Fixed a bug: If in a <CODE>FOREIGN KEY</CODE> with an <CODE>UPDATE CASCADE</CODE>
clause the parent column was of a different internal storage length
than the child column, then a cascaded update would make the column
length wrong in the child table and corrupt the child table. Because
of MySQL's 'silent column specification changes' a fixed-length
<CODE>CHAR</CODE> column can change internally to a <CODE>VARCHAR</CODE> and cause
this error. 
<LI>

Fixed a bug: If a non-<CODE>latin1</CODE> character set was used and if in a
<CODE>FOREIGN KEY</CODE> the parent column was of a different internal storage
length than the child column, then all inserts to the child table would
fail in a foreign key error. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could complain that it cannot find the clustered
index record, or in rare cases return an extraneous row if a rollback,
purge, and a <CODE>SELECT</CODE> coincided. 
<LI>

Fixed a possible hang over the btr0sea.c latch if <CODE>SELECT</CODE> was used
inside <CODE>LOCK TABLES</CODE>. 
<LI>

Fixed a bug: contrary to what the release note of 4.0.13 said, the
group commit still did not work if the MySQL binary logging was on. 
<LI>

Fixed a bug: os_event_wait() did not work properly in Unix, which
might have caused starvation in various log operations. 
<LI>

Fixed a bug: If a single <CODE>DELETE</CODE> statement first managed to delete
some rows and then failed in a <CODE>FOREIGN KEY</CODE> error or a
'Table is full error', MySQL did not roll back the whole SQL statement
as it should, and also wrote the failed statement to the binary log, reporting
there a non-zero error_code. 
<LI>

Fixed a bug: the maximum allowed number of columns in a table is 1000, but
<CODE>InnoDB</CODE> did not check that limit in <CODE>CREATE TABLE</CODE>, and a subsequent
<CODE>INSERT</CODE> or <CODE>SELECT</CODE> from that table could cause an assertion. 
</UL>



<H3><A NAME="InnoDB_news-3.23.57" HREF="manual_toc.html#InnoDB_news-3.23.57">C.9.12  MySQL/InnoDB-3.23.57, June 20, 2003</A></H3>


<UL>
<LI>

Changed the default value of <CODE>innodb_flush_log_at_trx_commit</CODE> from 0
to 1. If you have not specified it explicitly in your <TT>`my.cnf'</TT>, and
your application runs much slower with this new release, it is because the
value 1 causes a log flush to disk at each transaction commit. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> forgot to call pthread_mutex_destroy() when a table was
dropped. That could cause memory leakage on FreeBSD and other non-Linux
Unixes. 
<LI>

Fixed a bug: MySQL could erroneously return 'Empty set' if <CODE>InnoDB</CODE> estimated
an index range size to 0 records though the range was not empty; MySQL also
failed to do the next-key locking in the case of an empty index range. 
<LI>

Fixed a bug: <CODE>GROUP BY</CODE> and <CODE>DISTINCT</CODE> could treat NULL values
inequal. 
</UL>



<H3><A NAME="InnoDB_news-4.0.13" HREF="manual_toc.html#InnoDB_news-4.0.13">C.9.13  MySQL/InnoDB-4.0.13, May 20, 2003</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports <CODE>ALTER TABLE DROP FOREIGN KEY</CODE>. You have to use
<CODE>SHOW CREATE TABLE</CODE> to find the internally generated foreign key ID
when you want to drop a foreign key. 
<LI>

<CODE>SHOW INNODB STATUS</CODE> now prints detailed information of the latest
detected <CODE>FOREIGN KEY</CODE> and <CODE>UNIQUE KEY</CODE> errors. If you do not understand
why <CODE>InnoDB</CODE> gives the error 150 from a <CODE>CREATE TABLE</CODE>, you can use
this statement to study the reason. 
<LI>

<CODE>ANALYZE TABLE</CODE> now works also for <CODE>InnoDB</CODE> type tables. It makes 10
random dives to each of the index trees and updates index cardinality
estimates accordingly. Note that since it is only an estimate,
repeated runs of <CODE>ANALYZE TABLE</CODE> may produce different numbers. MySQL
uses index cardinality estimates only in join optimization. If some
join is not optimized in the right way, you may try using <CODE>ANALYZE TABLE</CODE>. 
<LI>

<CODE>InnoDB</CODE> group commit capability now works also when MySQL
binary logging is switched on. There have to be &#62; 2 client threads
for the group commit to become active. 
<LI>

Changed the default value of <CODE>innodb_flush_log_at_trx_commit</CODE> from
0 to 1. If you have not specified it explicitly in your <TT>`my.cnf'</TT>,
and your application runs much slower with this new release, it
is because the value 1 causes a log flush to disk at each transaction
commit. 
<LI>

Added a new global settable MySQL system variable
<CODE>innodb_max_dirty_pages_pct</CODE>. It is an integer in the range 0 - 100.
The default is 90. The main thread in <CODE>InnoDB</CODE> tries to flush pages
from the buffer pool so that at most this many percents are not yet
flushed at any time. 
<LI>

If <CODE>innodb_force_recovery=6</CODE>, do not let <CODE>InnoDB</CODE> do repair of corrupt
pages based on the doublewrite buffer. 
<LI>

<CODE>InnoDB</CODE> startup now happens faster because it does not set the
memory in the buffer pool to zero. 
<LI>

Fixed a bug: The <CODE>InnoDB</CODE> parser for <CODE>FOREIGN KEY</CODE> definitions was
confused by the keywords 'foreign key' inside MySQL comments. 
<LI>

Fixed a bug: If you dropped a table to which there was a <CODE>FOREIGN
KEY</CODE> reference, and later created the same table with non-matching
column types, <CODE>InnoDB</CODE> could assert in <TT>`dict0load.c'</TT>, in function
<CODE>dict_load_table()</CODE>. 
<LI>

Fixed a bug: <CODE>GROUP BY</CODE> and <CODE>DISTINCT</CODE> could treat <CODE>NULL</CODE>
values as not equal.
MySQL also failed to do the next-key locking in the case of an
empty index range. 
<LI>

Fixed a bug: Do not commit the current transaction when a <CODE>MyISAM</CODE>
table is updated; this also makes <CODE>CREATE TABLE</CODE> not to commit an
<CODE>InnoDB</CODE> transaction, even when binary logging is enabled. 
<LI>

Fixed a bug: We did not allow <CODE>ON DELETE SET NULL</CODE> to modify the same
table where the delete was made; we can allow it because that cannot
produce infinite loops in cascaded operations. 
<LI>

Fixed a bug: Allow <CODE>HANDLER PREV</CODE> and <CODE>NEXT</CODE> also after positioning
the cursor with a unique search on the primary key.
<LI>

Fixed a bug: If <CODE>MIN()</CODE> or <CODE>MAX()</CODE> resulted in a deadlock or a lock
wait timeout, MySQL did not return an error, but returned <CODE>NULL</CODE> as the
function value.
<LI>

Fixed a bug: <CODE>InnoDB</CODE> forgot to call <CODE>pthread_mutex_destroy()</CODE> when
a table was dropped. That could cause memory leakage on FreeBSD
and other non-Linux Unix systems. 
</UL>



<H3><A NAME="InnoDB_news-4.1.0" HREF="manual_toc.html#InnoDB_news-4.1.0">C.9.14  MySQL/InnoDB-4.1.0, April 3, 2003</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports up to 64GB of buffer pool memory in a
Windows 32-bit Intel computer. This is possible because <CODE>InnoDB</CODE>
can use the AWE extension of Windows to address memory over
the 4GB limit of a 32-bit process. A new startup variable
<CODE>innodb_buffer_pool_awe_mem_mb</CODE> enables AWE and sets the size
of the buffer pool in megabytes. 
<LI>

Reduced the size of buffer headers and the lock table. <CODE>InnoDB</CODE> uses
2 % less memory. 
</UL>



<H3><A NAME="InnoDB_news-3.23.56" HREF="manual_toc.html#InnoDB_news-3.23.56">C.9.15  MySQL/InnoDB-3.23.56, March 17, 2003</A></H3>


<UL>
<LI>

Fixed a major bug in <CODE>InnoDB</CODE> query optimization: queries of type
SELECT ... WHERE indexcolumn &#60; x and SELECT ... WHERE
indexcolumn &#62; x could cause a table scan even if the selectivity
would have been very good.
<LI>

Fixed a potential bug if MySQL calls store_lock with TL_IGNORE
in the middle of a query. 
</UL>



<H3><A NAME="InnoDB_news-4.0.12" HREF="manual_toc.html#InnoDB_news-4.0.12">C.9.16  MySQL/InnoDB-4.0.12, March 18, 2003</A></H3>


<UL>
<LI>

In crash recovery <CODE>InnoDB</CODE> now prints the progress in percents of a
transaction rollback.
<LI>

Fixed a bug/feature: If your application program used
mysql_use_result(), and used &#62;= 2 connections to send
SQL queries, it could deadlock on the adaptive hash S-latch
in btr0sea.c. Now <CODE>mysqld</CODE> releases the S-latch whenever it
passes data from a SELECT to the client. 
<LI>

Fixed a bug: MySQL could erroneously return 'Empty set'
if <CODE>InnoDB</CODE> estimated an index range size to 0 records though
the range was not empty; MySQL also failed to do the next-key
locking in the case of an empty index range. 
</UL>



<H3><A NAME="InnoDB_news-4.0.11" HREF="manual_toc.html#InnoDB_news-4.0.11">C.9.17  MySQL/InnoDB-4.0.11, February 25, 2003</A></H3>


<UL>
<LI>

Fixed a bug introduced in 4.0.10: SELECT ... FROM ... ORDER BY ... DESC
could hang in an infinite loop. 
<LI>

An outstanding bug: SET FOREIGN_KEY_CHECKS=0 is not replicated properly
in the MySQL replication.
</UL>



<H3><A NAME="InnoDB_news-4.0.10" HREF="manual_toc.html#InnoDB_news-4.0.10">C.9.18  MySQL/InnoDB-4.0.10, February 4, 2003</A></H3>


<UL>
<LI>

In INSERT INTO t1 SELECT ... FROM t2 WHERE ... MySQL previously
set a table level read lock on t2. This lock is now removed. 
<LI>

Increased SHOW INNODB STATUS maximum printed length to 200KB.
<LI>

Fixed a major bug in <CODE>InnoDB</CODE> query optimization: queries of type
SELECT ... WHERE indexcolumn &#60; x and SELECT ... WHERE
indexcolumn &#62; x could cause a table scan even if the
selectivity would have been very good. 
<LI>

Fixed a bug: purge could cause a hang in a BLOB table where the
primary key index tree was of height 1. Symptom: semaphore waits
caused by an X-latch set in btr_free_externally_stored_field(). 
<LI>

Fixed a bug: using <CODE>InnoDB</CODE> HANDLER commands on a fresh handle
crashed <CODE>mysqld</CODE> in <CODE>ha_innobase::change_active_index()</CODE>. 
<LI>

Fixed a bug: If MySQL estimated a query in the middle of a SELECT
statement, <CODE>InnoDB</CODE> could hang on the adaptive hash index latch in btr0sea.c. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could report table corruption and assert
in page_dir_find_owner_slot() if an adaptive hash index search
coincided with purge or an insert. 
<LI>

Fixed a bug: some filesystem snapshot tool in Windows 2000 could
cause an <CODE>InnoDB</CODE> file write to fail with error 33 ERROR_LOCK_VIOLATION.
In synchronous writes <CODE>InnoDB</CODE> now retries the write 100 times at 1
second intervals. 
<LI>

Fixed a bug: REPLACE INTO t1 SELECT ... did not work if t1 has an
auto-inc column. 
<LI>

An outstanding bug: SET FOREIGN_KEY_CHECKS=0 is not replicated properly
in the MySQL replication.
</UL>



<H3><A NAME="InnoDB_news-3.23.55" HREF="manual_toc.html#InnoDB_news-3.23.55">C.9.19  MySQL/InnoDB-3.23.55, January 24, 2003</A></H3>


<UL>
<LI>

In INSERT INTO t1 SELECT ... FROM t2 WHERE ... MySQL previously set
a table level read lock on t2. This lock is now removed.
<LI>

Fixed a bug: If the combined size of <CODE>InnoDB</CODE> log files was &#62;= 2GB 
in a 32-bit computer, <CODE>InnoDB</CODE> would write log in a wrong
position. That could make crash recovery and <CODE>InnoDB Hot Backup</CODE>
to fail in log scan. 
<LI>

Fixed a bug: index cursor restoration could theoretically fail. 
<LI>

Fixed a bug: an assertion in btr0sea.c, in function
btr_search_info_update_slow could theoretically fail in a race of 3 threads. 
<LI>

Fixed a bug: purge could cause a hang in a BLOB table where the
primary key index tree was of height 1. Symptom: semaphore waits
caused by an X-latch set in btr_free_externally_stored_field(). 
<LI>

Fixed a bug: If MySQL estimated a query in the middle of a SELECT statement,
<CODE>InnoDB</CODE> could hang on the adaptive hash index latch in btr0sea.c. 
<LI>

Fixed a bug: <CODE>InnoDB</CODE> could report table corruption and assert in
page_dir_find_owner_slot() if an adaptive hash index search
coincided with purge or an insert. 
<LI>

Fixed a bug: some filesystem snapshot tool in Windows 2000 could
cause an <CODE>InnoDB</CODE> file write to fail with error 33 ERROR_LOCK_VIOLATION.
In synchronous writes <CODE>InnoDB</CODE> now retries the write 100 times
at 1 second intervals. 
<LI>

An outstanding bug: SET FOREIGN_KEY_CHECKS=0 is not replicated properly
in the MySQL replication. The fix will appear in 4.0.11 and will probably
not be backported to 3.23.
<LI>

Fixed bug in <CODE>InnoDB</CODE> <TT>`page0cur.c'</TT> file in function page_cur_search_with_match
which caused <CODE>InnoDB</CODE> to remain on the same page forever.
This bug is evident only in tables with more than one page.
</UL>



<H3><A NAME="InnoDB_news-4.0.9" HREF="manual_toc.html#InnoDB_news-4.0.9">C.9.20  MySQL/InnoDB-4.0.9, January 14, 2003</A></H3>


<UL>
<LI>

Removed the warning message: 'InnoDB: Out of memory in additional memory pool.'
<LI>

Fixed a bug: If the combined size of <CODE>InnoDB</CODE> log files was &#62;= 2GB in a
32-bit computer, <CODE>InnoDB</CODE> would write log in a wrong position. That could
make crash recovery and <CODE>InnoDB Hot Backup</CODE> to fail. 
<LI>

Fixed a bug: index cursor restoration could theoretically fail. 
</UL>



<H3><A NAME="InnoDB_news-4.0.8" HREF="manual_toc.html#InnoDB_news-4.0.8">C.9.21  MySQL/InnoDB-4.0.8, January 7, 2003</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports also FOREIGN KEY (...) REFERENCES ...(...)
[ON UPDATE CASCADE | ON UPDATE SET NULL | ON UPDATE RESTRICT
| ON UPDATE NO ACTION]. 
<LI>

Tables and indexes now reserve 4 % less space in the tablespace.
Also existing tables reserve less space. By upgrading to 4.0.8
you will see more free space in "InnoDB free" in SHOW TABLE STATUS. 
<LI>

Fixed bugs: updating the PRIMARY KEY of a row would generate a
foreign key error on all FOREIGN KEYs which referenced secondary
keys of the row to be updated. Also, if a referencing
FOREIGN KEY constraint only referenced the first columns in an
index, and there were more columns in that index, updating the
additional columns generated a foreign key error. 
<LI>

Fixed a bug: If an index contains some column twice, and that
column is updated, the table will become corrupt. From now on
<CODE>InnoDB</CODE> prevents creation of such indexes. 
<LI>

Fixed a bug: removed superfluous error 149 and 150 printouts
from the .err log when a locking SELECT caused a deadlock or a
lock wait timeout.
<LI>

Fixed a bug: an assertion in btr0sea.c, in function
btr_search_info_update_slow could theoretically fail in a race of 3 threads. 
<LI>

Fixed a bug: one could not switch a session transaction isolation
level back to REPEATABLE READ after setting it to something else.
</UL>



<H3><A NAME="InnoDB_news-4.0.7" HREF="manual_toc.html#InnoDB_news-4.0.7">C.9.22  MySQL/InnoDB-4.0.7, December 26, 2002</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> in 4.0.7 is essentially the same as in 4.0.6.
</UL>



<H3><A NAME="InnoDB_news-4.0.6" HREF="manual_toc.html#InnoDB_news-4.0.6">C.9.23  MySQL/InnoDB-4.0.6, December 19, 2002</A></H3>


<UL>
<LI>

Since innodb_log_arch_dir has no relevance under MySQL,
there is no need to specify it any more in my.cnf. 
<LI>

LOAD DATA INFILE in AUTOCOMMIT=1 mode no longer does
implicit commits for each 1MB of written binary log. 
<LI>

Fixed a bug introduced in 4.0.4: LOCK TABLES ... READ LOCAL
should not set row locks on the rows read. This caused
deadlocks and lock wait timeouts in mysqldump. 
<LI>

Fixed two bugs introduced in 4.0.4: in AUTO_INCREMENT,
REPLACE could cause the counter to be left 1 too low.
A deadlock or a lock wait timeout could cause the same problem. 
<LI>

Fixed a bug: TRUNCATE on a TEMPORARY table crashed <CODE>InnoDB</CODE>. 
<LI>

Fixed a bug introduced in 4.0.5: If binary logging was not switched on,
INSERT INTO ... SELECT ... or CREATE TABLE ... SELECT ... could
cause <CODE>InnoDB</CODE> to hang on a semaphore created in btr0sea.c, line 128.
Workaround: switch binary logging on. 
<LI>

Fixed a bug: in replication issuing SLAVE STOP in the middle of
a multiple-statement transaction could cause that SLAVE START would
only perform a part of the transaction. A similar error could occur
if the slave crashed and was restarted.
</UL>



<H3><A NAME="InnoDB_news-3.23.54" HREF="manual_toc.html#InnoDB_news-3.23.54">C.9.24  MySQL/InnoDB-3.23.54, December 12, 2002</A></H3>


<UL>
<LI>

Fixed a bug: the <CODE>InnoDB</CODE> range estimator greatly exaggerated
the size of a short index range if the paths to the endpoints of
the range in the index tree happened to branch already in the root.
This could cause unnecessary table scans in SQL queries. 
<LI>

Fixed a bug: ORDER BY could fail if you had not created a
primary key to a table, but had defined several indexes
of which at least one was a UNIQUE index with all its
columns declared as NOT NULL. 
<LI>

Fixed a bug: a lock wait timeout in connection with
ON DELETE CASCADE could cause corruption in indexes. 
<LI>

Fixed a bug: If a SELECT was done with a unique key
from a primary index, and the search matched to a
delete-marked record, <CODE>InnoDB</CODE> could erroneously return the NEXT record. 
<LI>

Fixed a bug introduced in 3.23.53: LOCK TABLES ... READ LOCAL
should not set row locks on the rows read. This caused deadlocks
and lock wait timeouts in mysqldump. 
<LI>

Fixed a bug: If an index contains some column twice, and that
column is updated, the table will become corrupt. From now on
<CODE>InnoDB</CODE> prevents creation of such indexes. 
</UL>



<H3><A NAME="InnoDB_news-4.0.5" HREF="manual_toc.html#InnoDB_news-4.0.5">C.9.25  MySQL/InnoDB-4.0.5, November 18, 2002</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports also transaction isolation levels READ COMMITTED
and READ UNCOMMITTED. READ COMMITTED more closely emulates Oracle
and makes porting of applications from Oracle to MySQL easier. 
<LI>

Deadlock resolution is now selective: we try to pick as victims
transactions with less modified or inserted rows. 
<LI>

FOREIGN KEY definitions are now aware of the
lower_case_table_names setting in my.cnf. 
<LI>

SHOW CREATE TABLE does not output the database name
to a FOREIGN KEY definition if the referred table is
in the same database as the table. 
<LI>

<CODE>InnoDB</CODE> does a consistency check to most index pages
before writing them to a data file. 
<LI>

If you set <CODE>innodb_force_recovery</CODE> &#62; 0, <CODE>InnoDB</CODE> tries to
jump over corrupt index records and pages when doing
SELECT * FROM table. This helps in dumping. 
<LI>

<CODE>InnoDB</CODE> now again uses asynchronous unbuffered I/O in
Windows 2000 and XP; only unbuffered simulated async
I/O in NT, 95/98/ME. 
<LI>

Fixed a bug: the <CODE>InnoDB</CODE> range estimator greatly exaggerated
the size of a short index range if the paths to the
endpoints of the range in the index tree happened
to branch already in the root. This could cause
unnecessary table scans in SQL queries.
The fix will also be backported to 3.23.54. 
<LI>

Fixed a bug present in 3.23.52, 4.0.3, 4.0.4:
<CODE>InnoDB</CODE> startup could take very long or even
crash on some Windows 95/98/ME computers. 
<LI>

Fixed a bug: the AUTO-INC lock was held to the end
of the transaction if it was granted after a
lock wait. This could cause unnecessary deadlocks. 
<LI>

Fixed a bug: If SHOW INNODB STATUS, innodb_monitor,
or innodb_lock_monitor had to print several hundred
transactions in one report, and the output became
truncated, <CODE>InnoDB</CODE> would hang, printing to the error
log many waits for a mutex created at srv0srv.c, line 1621. 
<LI>

Fixed a bug: SHOW INNODB STATUS on Unix always
reported average file read size as 0 bytes. 
<LI>

Fixed a potential bug in 4.0.4: <CODE>InnoDB</CODE> now
does ORDER BY ... DESC like <CODE>MyISAM</CODE>. 
<LI>

Fixed a bug: DROP TABLE could cause crash or a
hang if there was a rollback concurrently running
on the table. The fix will be backported to 3.23
only if this appears a real problem for users. 
<LI>

Fixed a bug: ORDER BY could fail if you had not
created a primary key to a table, but had defined
several indexes of which at least one was a UNIQUE
index with all its columns declared as NOT NULL. 
<LI>

Fixed a bug: a lock wait timeout in connection
with ON DELETE CASCADE could cause corruption in indexes. 
<LI>

Fixed a bug: If a SELECT was done with a unique
key from a primary index, and the search matched
to a delete-marked record, <CODE>InnoDB</CODE> could return the NEXT record. 
<LI>

Outstanding bugs: in 4.0.4 two bugs were introduced
to AUTO_INCREMENT. REPLACE can cause the counter to
be left 1 too low. A deadlock or a lock wait timeout
can cause the same problem. These will be fixed in 4.0.6.
</UL>



<H3><A NAME="InnoDB_news-3.23.53" HREF="manual_toc.html#InnoDB_news-3.23.53">C.9.26  MySQL/InnoDB-3.23.53, October 9, 2002</A></H3>


<UL>
<LI>

We again use unbuffered disk I/O to data files in Windows.
Windows XP and Windows 2000 read performance seems to be
very poor with normal I/O. 
<LI>

Tuned range estimator so that index range scans are
preferred over full index scans. 
<LI>

Allow dropping and creating a table even if
innodb_force_recovery is set. One can use this to
drop a table which would cause a crash in rollback
or purge, or if a failed table import causes a runaway rollback in recovery. 
<LI>

Fixed a bug present in 3.23.52, 4.0.3, 4.0.4: <CODE>InnoDB</CODE> startup
could take very long or even crash on some Windows 95/98/ME computers. 
<LI>

Fixed a bug: fast shutdown (which is the default)
sometimes was slowed down by purge and insert buffer merge. 
<LI>

Fixed a bug: doing a big SELECT from a table where no
rows were visible in a consistent read could cause a
very long (&#62; 600 seconds) semaphore wait in btr0cur.c line 310. 
<LI>

Fixed a bug: the AUTO-INC lock was held to the end of
the transaction if it was granted after a lock wait.
This could cause unnecessary deadlocks. 
<LI>

Fixed a bug: If you created a temporary table
inside LOCK TABLES, and used that temporary table,
that caused an assertion failure in ha_innobase.cc. 
<LI>

Fixed a bug: If SHOW INNODB STATUS, innodb_monitor,
or innodb_lock_monitor had to print several hundred
transactions in one report, and the output became
truncated, <CODE>InnoDB</CODE> would hang, printing to the error
log many waits for a mutex created at srv0srv.c, line 1621. 
<LI>

Fixed a bug: SHOW INNODB STATUS on Unix always
reported average file read size as 0 bytes.
</UL>



<H3><A NAME="InnoDB_news-4.0.4" HREF="manual_toc.html#InnoDB_news-4.0.4">C.9.27  MySQL/InnoDB-4.0.4, October 2, 2002</A></H3>


<UL>
<LI>

We again use unbuffered disk I/O in Windows. Windows XP and Windows 2000
read performance seems to be very poor with normal I/O.
<LI>

Increased the maximum key length of <CODE>InnoDB</CODE> tables from 500 to 1024 bytes.
<LI>

Increased the table comment field in SHOW TABLE STATUS so that
up to 16000 characters of foreign key definitions can be printed there.
<LI>

The auto-increment counter is no longer incremented if
an insert of a row immediately fails in an error.
<LI>

Allow dropping and creating a table even if
innodb_force_recovery is set. One can use this to drop
a table which would cause a crash in rollback or purge,
or if a failed table import causes a runaway rollback in recovery.
<LI>

Fixed a bug: Using ORDER BY primarykey DESC in 4.0.3 causes
an assertion failure in btr0pcur.c, line 203.
<LI>

Fixed a bug: fast shutdown (which is the default) sometimes
was slowed down by purge and insert buffer merge.
<LI>

Fixed a bug: doing a big SELECT from a table where
no rows were visible in a consistent read could cause
a very long (&#62; 600 seconds) semaphore wait in btr0cur.c line 310.
<LI>

Fixed a bug: If the MySQL query cache was used, it did not get
invalidated by a modification done by ON DELETE CASCADE or ...SET NULL.
<LI>

Fixed a bug: If you created a temporary table inside LOCK TABLES,
and used that temporary table, that caused an assertion failure
in ha_innodb.cc.
<LI>

Fixed a bug: If you set innodb_flush_log_at_trx_commit to 1, SHOW
VARIABLES would show its value as 16 million.
</UL>



<H3><A NAME="InnoDB_news-4.0.3" HREF="manual_toc.html#InnoDB_news-4.0.3">C.9.28  MySQL/InnoDB-4.0.3, August 28, 2002</A></H3>


<UL>
<LI>

Removed unnecessary deadlocks when inserts have to wait for
a locking read, update, or delete to release its next-key lock.
<LI>

The MySQL <CODE>HANDLER</CODE> SQL commands now work also for <CODE>InnoDB</CODE>
type tables. <CODE>InnoDB</CODE> does the <CODE>HANDLER</CODE> reads always as
consistent reads. <CODE>HANDLER</CODE> is a direct access path to read
individual indexes of tables. In some cases, <CODE>HANDLER</CODE> can be
used as a substitute of server-side cursors.
<LI>

Fixed a bug in 4.0.2: even a simple insert could crash the
AIX version.
<LI>

Fixed a bug: If you used in a table name characters whose code is &#62; 127,
in DROP TABLE <CODE>InnoDB</CODE> could assert on line 155 of pars0sym.c.
<LI>

Compilation from source now provides a working version both on
HP-UX-11 and HP-UX-10.20. The source of 4.0.2 worked only on 11,
and the source of 3.23.52 only on 10.20.
<LI>

Fixed a bug: If compiled on 64-bit Solaris, <CODE>InnoDB</CODE> produced a bus error
at startup.
</UL>



<H3><A NAME="InnoDB_news-3.23.52" HREF="manual_toc.html#InnoDB_news-3.23.52">C.9.29  MySQL/InnoDB-3.23.52, August 16, 2002</A></H3>


<UL>
<LI>

The feature set of 3.23 will be frozen from this version on. New features
will go the 4.0 branch, and only bugfixes will be made to the 3.23
branch.
<LI>

Many CPU-bound join queries now run faster. On Windows also many
other CPU-bound queries run faster.
<LI>

A new SQL command SHOW INNODB STATUS returns the output of the
<CODE>InnoDB</CODE> Monitor to the client. The <CODE>InnoDB</CODE> Monitor now prints detailed
information on
the latest detected deadlock.
<LI>

<CODE>InnoDB</CODE> made the SQL query optimizer to avoid too much index-only
range scans and choose full table scans instead. This is now fixed.
<LI>

<CODE>BEGIN</CODE> and <CODE>COMMIT</CODE> are now added in the binary log around transactions.
The MySQL replication now respects transaction borders:
a user will no longer see half transactions in replication slaves.
<LI>

A replication slave now prints in crash recovery the last
master binary log position it was able to recover to.
<LI>

A new setting <CODE>innodb_flush_log_at_trx_commit=2</CODE> makes <CODE>InnoDB</CODE> to write
the log to the operating system file cache at each commit. This is
almost as fast as the setting innodb_flush_log_at_trx_commit=0, and
the setting 2 also has the nice feature that in a crash where the
operating system does not crash, no committed transaction is lost.
If the operating system crashes or there is a power outage, then
the setting 2 is no safer than the setting 0.
<LI>

Added checksum fields to log blocks.
<LI>

SET FOREIGN_KEY_CHECKS=0 helps in importing tables
in an arbitrary order which does not respect the foreign key rules.
<LI>

SET UNIQUE_CHECKS=0 speeds up table imports into <CODE>InnoDB</CODE>
if you have UNIQUE constraints on secondary indexes.
This flag should be used only if you are certain that the input records
contain no UNIQUE constraint violations.
<LI>

SHOW TABLE STATUS now lists also possible ON DELETE CASCADE or
ON DELETE SET NULL in the comment field of the table.
<LI>

When CHECK TABLE is run on any <CODE>InnoDB</CODE> type table, it now
checks also the adaptive hash index for all tables.
<LI>

If you defined ON DELETE CASCADE or SET NULL and updated the
referenced key in the parent row, <CODE>InnoDB</CODE> deleted or updated
the child row. This is now changed to conform to standard SQL: you get
the error 'Cannot delete parent row'.
<LI>

Improved the auto-increment algorithm: now the first insert or
SHOW TABLE STATUS initializes the auto-increment counter for the table.
This removes almost all surprising deadlocks caused by
SHOW TABLE STATUS.
<LI>

Aligned some buffers used in reading and writing to data files.
This allows using unbuffered raw devices as data files in Linux.
<LI>

Fixed a bug: If you updated the primary key of a table so that only the
case of characters changed, that could cause assertion
failures, mostly in page0page.ic line 515.
<LI>

Fixed a bug: If you delete or update a row referenced in a foreign key
constraint and the foreign key check has to wait for a lock,
then the check may report an erroneous result. This
affects also the ON DELETE... operation.
<LI>

Fixed a bug: A deadlock or a lock wait timeout error in <CODE>InnoDB</CODE>
causes <CODE>InnoDB</CODE> to roll back the whole transaction, but MySQL could still
write the earlier SQL statements to the binary log, even though
<CODE>InnoDB</CODE> rolled them back. This could, for example, cause replicated
databases to get out-of-sync.
<LI>

Fixed a bug: If the database happened to crash in the middle of a
commit, then the recovery might leak tablespace pages.
<LI>

Fixed a bug: If you specified a non-latin1 character set in my.cnf,
then, in contrary to what is stated in the manual, in a foreign key
constraint a string type column had to have the same length specification
in the referencing table and the referenced table.
<LI>

Fixed a bug: DROP TABLE or DROP DATABASE could fail if there
simultaneously was a CREATE TABLE running.
<LI>

Fixed a bug: If you configured the buffer pool bigger than 2GB in
a 32-bit computer, <CODE>InnoDB</CODE> would assert in buf0buf.ic line 214.
<LI>

Fixed a bug: on 64-bit computers updating rows which contained the
SQL NULL in some column could cause the undo log and the ordinary
log to become corrupt.
<LI>

Fixed a bug: innodb_log_monitor caused a hang if it suppressed
lock prints for a page.
<LI>

Fixed a bug: in the HP-UX-10.20 version mutexes would leak and cause
race conditions and crashes in any part of <CODE>InnoDB</CODE> code.
<LI>

Fixed a bug: If you ran in the AUTOCOMMIT mode, executed a SELECT,
and immediately after that a RENAME TABLE, then RENAME would fail and
MySQL would complain about error 1192.
<LI>

Fixed a bug: If compiled on 64-bit Solaris, <CODE>InnoDB</CODE> produced a bus error
at startup.
</UL>



<H3><A NAME="InnoDB_news-4.0.2" HREF="manual_toc.html#InnoDB_news-4.0.2">C.9.30  MySQL/InnoDB-4.0.2, July 10, 2002</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> is essentially the same as InnoDB-3.23.51.
<LI>

If no innodb_data_file_path is specified, <CODE>InnoDB</CODE> at the database creation
now creates a 10MB auto-extending data file ibdata1 to the datadir
of MySQL. In 4.0.1 the file was 64MB and not auto-extending.
</UL>



<H3><A NAME="InnoDB_news-3.23.51" HREF="manual_toc.html#InnoDB_news-3.23.51">C.9.31  MySQL/InnoDB-3.23.51, June 12, 2002</A></H3>


<UL>
<LI>

Fixed a bug: a join could result in a seg fault in copying of a BLOB or
TEXT column if some of the BLOB or TEXT columns in the table contained
SQL NULL values.
<LI>

Fixed a bug: If you added self-referential foreign key constraints with
ON DELETE CASCADE to tables and a row deletion caused <CODE>InnoDB</CODE>
to attempt the deletion of the same row twice because of
a cascading delete, then you got an assertion failure.
<LI>

Fixed a bug: If you use MySQL 'user level locks' and close
a connection, then <CODE>InnoDB</CODE> may assert in ha_innobase.cc, line 302.
</UL>



<H3><A NAME="InnoDB_news-3.23.50" HREF="manual_toc.html#InnoDB_news-3.23.50">C.9.32  MySQL/InnoDB-3.23.50, April 23, 2002</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> now supports an auto-extending last data file. You do not need
to preallocate the whole data file at the database startup.
<LI>

Made several changes to facilitate the use of the <CODE>InnoDB Hot Backup</CODE>
tool. It is a separate non-free tool you can use to take online backups
of your database without shutting down the server or setting
any locks.
<LI>

If you want to run the <CODE>InnoDB Hot Backup</CODE> tool on an auto-extending
data file you have to upgrade it to version ibbackup-0.35.
<LI>

The log scan phase in crash recovery will now run much faster.
<LI>

Starting from this server version, the hot backup tool
truncates unused ends in the backup <CODE>InnoDB</CODE> data files.
<LI>

To allow the hot backup tool to work, on Windows we no longer use
unbuffered I/O or native async I/O; instead we use the same simulated
async I/O as on Unix.
<LI>

You can now define the ON DELETE CASCADE or ON DELETE SET NULL
clause on foreign keys.
<LI>

FOREIGN KEY constraints now survive ALTER TABLE and CREATE
INDEX.
<LI>

We suppress the FOREIGN KEY check if any of the column values in the
foreign key or referenced key to be checked is the SQL NULL. This
is compatible with Oracle, for example.
<LI>

SHOW CREATE TABLE now lists also foreign key constraints. Also
mysqldump no longer forgets about foreign keys in table definitions.
<LI>

You can now add a new foreign key constraint with
ALTER TABLE ... ADD CONSTRAINT FOREIGN KEY (...) REFERENCES ... (...).
<LI>

FOREIGN KEY definitions now allow backticks around table and
column names.
<LI>

MySQL command
SET TRANSACTION ISOLATION LEVEL ...
has now the following effect on
<CODE>InnoDB</CODE> tables: If a transaction is defined as SERIALIZABLE
then <CODE>InnoDB</CODE> conceptually adds LOCK IN SHARE MODE
to all consistent reads. If a transaction is defined to have any other
isolation level, then <CODE>InnoDB</CODE> obeys its default locking strategy
which is REPEATABLE READ.
<LI>

SHOW TABLE STATUS no longer sets an x-lock at the end of an
auto-increment index if the auto-increment counter has already
been initialized. This removes in almost all cases the surprising deadlocks
caused by SHOW TABLE STATUS.
<LI>

Fixed a bug: in a CREATE TABLE statement the string 'foreign'
followed by a non-space character confused the FOREIGN KEY parser
and caused table creation to fail with errno 150.
</UL>



<H3><A NAME="InnoDB_news-3.23.49" HREF="manual_toc.html#InnoDB_news-3.23.49">C.9.33  MySQL/InnoDB-3.23.49, February 17, 2002</A></H3>


<UL>
<LI>

Fixed a bug: If you called DROP DATABASE for a database on which
there simultaneously were running queries, the MySQL server could crash
or hang. Crashes fixed, but a full fix has to wait some changes
in the MySQL layer of code.
<LI>

Fixed a bug: on Windows one had to put the database name
in lowercase for <CODE>DROP
DATABASE</CODE> to work. Fixed in 3.23.49: case no longer matters
on Windows. On Unix, the database name remains case sensitive.
<LI>

Fixed a bug: If one defined a non-latin1 character set as
the default character set,
then definition of foreign key constraints could fail
in an assertion failure
in dict0crea.c, reporting an internal error 17.
</UL>



<H3><A NAME="InnoDB_news-3.23.48" HREF="manual_toc.html#InnoDB_news-3.23.48">C.9.34  MySQL/InnoDB-3.23.48, February 9, 2002</A></H3>


<UL>
<LI>

Tuned the SQL optimizer to favor more often index searches
over table scans.
<LI>

Fixed a performance problem when several large SELECT
queries are run concurrently on a multiprocessor Linux computer.
Large CPU-bound SELECT queries will now also generally run faster on
all platforms.
<LI>

If MySQL binary logging is used,
<CODE>InnoDB</CODE> now prints after crash recovery the latest MySQL binary log
file name and the position in that file (= byte offset)
<CODE>InnoDB</CODE> was able to recover to. This is useful, for example,
when resynchronizing a master and a slave database in replication.
<LI>

Added better error messages to help in installation problems.
<LI>

One can now recover also MySQL temporary tables which have become
orphaned inside the <CODE>InnoDB</CODE> tablespace.
<LI>

<CODE>InnoDB</CODE> now prevents a FOREIGN KEY declaration where the signedness
is not the same in the referencing and referenced integer columns.
<LI>

Fixed a bug: calling SHOW CREATE TABLE or SHOW TABLE STATUS
could cause memory corruption and make <CODE>mysqld</CODE> to crash.
Especially at risk was mysqldump, because it calls frequently
SHOW CREATE TABLE.
<LI>

Fixed a bug: If on Unix you did an ALTER TABLE to an <CODE>InnoDB</CODE> table and
simultaneously did queries to it, <CODE>mysqld</CODE> could crash with an assertion
failure in row0row.c, line 474.
<LI>

Fixed a bug: If inserts to several tables containing an auto-inc column
were wrapped inside one LOCK TABLES, <CODE>InnoDB</CODE> asserted in lock0lock.c.
<LI>

In 3.23.47 we allowed several NULLS in a UNIQUE secondary index.
But CHECK TABLE was not relaxed: it reports the table as corrupt.
CHECK TABLE no longer complains in this situation.
<LI>

Fixed a bug: on Sparc and other high-endian processors SHOW VARIABLES
showed innodb_flush_log_at_trx_commit and other boolean-valued
startup parameters always OFF even if they were switched on. 
<LI>

Fixed a bug: If you ran mysqld-max-nt as a service on Windows NT/2000,
the service shutdown did not always wait long enough for the <CODE>InnoDB</CODE> shutdown
to finish.
</UL>



<H3><A NAME="InnoDB_news-3.23.47" HREF="manual_toc.html#InnoDB_news-3.23.47">C.9.35  MySQL/InnoDB-3.23.47, December 28, 2001</A></H3>


<UL>
<LI>

Recovery happens now faster, especially in a lightly loaded system,
because background checkpointing has been made more frequent.
<LI>

<CODE>InnoDB</CODE> allows now several similar key values in a UNIQUE secondary index
if those values contain SQL NULLs. Thus the convention is now the same as in
<CODE>MyISAM</CODE> tables.
<LI>

<CODE>InnoDB</CODE> gives a better row count estimate for a table which contains BLOBs.
<LI>

In a FOREIGN KEY constraint <CODE>InnoDB</CODE> is now case-insensitive to column
names, and in Windows also to table names.
<LI>

<CODE>InnoDB</CODE> allows a FOREIGN KEY column of CHAR type to refer to a column of
VARCHAR type, and vice versa. MySQL silently changes the type of some
columns between CHAR and VARCHAR, and these silent changes do not hinder
FOREIGN KEY declaration any more.
<LI>

Recovery has been made more resilient to corruption of log files.
<LI>

Unnecessary statistics calculation has been removed from queries which
generate a temporary table. Some ORDER BY and DISTINCT queries will now run
much faster.
<LI>

MySQL now knows that the table scan of an <CODE>InnoDB</CODE> table is done through the
primary key. This will save a sort in some ORDER BY queries.
<LI>

The maximum key length of <CODE>InnoDB</CODE> tables is again restricted to 500 bytes.
The MySQL interpreter is not able to handle longer keys.
<LI>

The default value of innodb_lock_wait_timeout was changed from infinite to
50 seconds, the default value of innodb_file_io_threads from 9
to 4.
</UL>



<H3><A NAME="InnoDB_news-4.0.1" HREF="manual_toc.html#InnoDB_news-4.0.1">C.9.36  MySQL/InnoDB-4.0.1, December 23, 2001</A></H3>


<UL>
<LI>

<CODE>InnoDB</CODE> is the same as in 3.23.47.
<LI>

In 4.0.0 the MySQL interpreter did not know the syntax LOCK IN
SHARE MODE. This has been fixed.
<LI>

In 4.0.0 multiple-table delete did not work for transactional tables.
This has been fixed.
</UL>



<H3><A NAME="InnoDB_news-3.23.46" HREF="manual_toc.html#InnoDB_news-3.23.46">C.9.37  MySQL/InnoDB-3.23.46, November 30, 2001</A></H3>


<UL>
<LI>

This is the same as 3.23.45.
</UL>



<H3><A NAME="InnoDB_news-3.23.45" HREF="manual_toc.html#InnoDB_news-3.23.45">C.9.38  MySQL/InnoDB-3.23.45, November 23, 2001</A></H3>


<UL>
<LI>

This is a bugfix release.
<LI>

In versions 3.23.42-.44 when creating a table on Windows, you
have to use lowercase letters in the database name to be able to
access the table. Fixed in 3.23.45.
<LI>

<CODE>InnoDB</CODE> now flushes stdout and stderr every 10 seconds: If these
are redirected to files, the file contents can be better viewed with
an editor.
<LI>

Fixed an assertion failure in .44, in trx0trx.c, line 178
when you drop a table which has
the .frm file but does not exist inside <CODE>InnoDB</CODE>.
<LI>

Fixed a bug in the insert buffer.
The insert buffer tree could get into an inconsistent state, causing a crash,
and also crashing the recovery. This bug could appear especially in
large table imports or alterations.
<LI>

Fixed a bug in recovery: <CODE>InnoDB</CODE> could go into an infinite loop
constantly printing
a warning message that it cannot find free blocks from the buffer pool.
<LI>

Fixed a bug: when you created a temporary table of the <CODE>InnoDB</CODE> type, and then
used ALTER TABLE to it, the MySQL server could crash.
<LI>

Prevented creation of MySQL system tables 'mysql.user',
'mysql.host', or 'mysql.db', in the
<CODE>InnoDB</CODE> type.
<LI>

Fixed a bug which can cause an assertion failure in 3.23.44 in
srv0srv.c, line 1728.
</UL>



<H3><A NAME="InnoDB_news-3.23.44" HREF="manual_toc.html#InnoDB_news-3.23.44">C.9.39  MySQL/InnoDB-3.23.44, November 2, 2001</A></H3>


<UL>
<LI>

You can define foreign key constraints on <CODE>InnoDB</CODE>
tables. An example: FOREIGN KEY (col1) REFERENCES table2(col2).
<LI>

You can create data files larger than 4GB in those
filesystems that allow it.
<LI>

Improved <CODE>InnoDB</CODE> monitors, including a new innodb_table_monitor
which allows you to print the contents of the <CODE>InnoDB</CODE> internal data
dictionary.
<LI>

DROP DATABASE will now work also for <CODE>InnoDB</CODE> tables.
<LI>

Accent characters in the default character set
latin1 will be ordered according to the MySQL ordering.&#60;br&#62;
NOTE: If you are using latin1 and have inserted characters
whose code is &#62; 127 to an indexed CHAR column, you should run
CHECK TABLE on your table when you upgrade to
3.23.43, and drop and reimport the table if CHECK TABLE
reports an error!
<LI>

<CODE>InnoDB</CODE> will calculate better table cardinality
estimates.
<LI>

Change in deadlock resolution:
in .43 a deadlock rolls back only the
SQL statement, in .44 it will roll back the whole transaction.
<LI>

Deadlock, lock wait timeout, and foreign key
constraint violations (no parent row, child rows exist)
now return native MySQL
error codes 1213, 1205, 1216, 1217, respectively.
<LI>

A new my.cnf parameter innodb_thread_concurrency
helps in performance tuning in high concurrency environments.
<LI>

A new my.cnf option innodb_force_recovery will
help you in dumping tables from a corrupted database.
<LI>

A new my.cnf option innodb_fast_shutdown will
speed up shutdown. Normally <CODE>InnoDB</CODE> does a full purge
and an insert buffer merge at shutdown.
<LI>

Raised maximum key length to 7000 bytes from a
previous limit of 500 bytes.
<LI>

Fixed a bug in replication of auto-inc columns with multiline inserts.
<LI>

Fixed a bug when the case of letters changes in an update of an indexed
secondary column.
<LI>

Fixed a hang when there are more than 24 data files.
<LI>

Fixed a crash when MAX(col) is selected from an empty table, and col is a
not the first column in a multi-column index.
<LI>

Fixed a bug in purge which could cause crashes.
</UL>



<H3><A NAME="InnoDB_news-3.23.43" HREF="manual_toc.html#InnoDB_news-3.23.43">C.9.40  MySQL/InnoDB-3.23.43, October 4, 2001</A></H3>


<UL>
<LI>

This is essentially the same as InnoDB-3.23.42.
</UL>



<H3><A NAME="InnoDB_news-3.23.42" HREF="manual_toc.html#InnoDB_news-3.23.42">C.9.41  MySQL/InnoDB-3.23.42, September 9, 2001</A></H3>


<UL>
<LI>

Fixed a bug which corrupted the table if the primary key
of a &#62; 8000-byte row was updated.
<LI>

There are now 3 types of <CODE>InnoDB</CODE> Monitors: innodb_monitor,
innodb_lock_monitor, and innodb_tablespace_monitor.
innodb_monitor now prints also buffer pool hit rate and the total
number of rows inserted, updated, deleted, read.
<LI>

Fixed a bug in RENAME TABLE.
<LI>

Fixed a bug in replication with an auto-increment column.
</UL>



<H3><A NAME="InnoDB_news-3.23.41" HREF="manual_toc.html#InnoDB_news-3.23.41">C.9.42  MySQL/InnoDB-3.23.41, August 13, 2001</A></H3>


<UL>
<LI>

Support for &#60; 4GB rows. The previous limit was
8000 bytes.
<LI>

Use the doublewrite file flush method.
<LI>

Raw disk partitions supported as data files.
<LI>

<CODE>InnoDB</CODE> Monitor.
<LI>

Several hang bugs fixed and an <CODE>ORDER BY</CODE>
bug (``Sort aborted'') fixed.
</UL>



<H3><A NAME="InnoDB_news-3.23.40" HREF="manual_toc.html#InnoDB_news-3.23.40">C.9.43  MySQL/InnoDB-3.23.40, July 16, 2001</A></H3>


<UL>
<LI>

Only a few rare bugs fixed.
</UL>



<H3><A NAME="InnoDB_news-3.23.39" HREF="manual_toc.html#InnoDB_news-3.23.39">C.9.44  MySQL/InnoDB-3.23.39, June 13, 2001</A></H3>


<UL>
<LI>

<CODE>CHECK TABLE</CODE> now works for <CODE>InnoDB</CODE> tables.
<LI>

A new <TT>`my.cnf'</TT> parameter <CODE>innodb_unix_file_flush_method</CODE>
introduced. It can be used to tune disk write performance.
<LI>

An auto-increment column now gets new values past the
transaction mechanism. This saves CPU time and eliminates
transaction deadlocks in new value assignment.
<LI>

Several bugfixes, most notably the rollback bug in 3.23.38.
</UL>



<H3><A NAME="InnoDB_news-3.23.38" HREF="manual_toc.html#InnoDB_news-3.23.38">C.9.45  MySQL/InnoDB-3.23.38, May 12, 2001</A></H3>


<UL>
<LI>

The new syntax <CODE>SELECT ... LOCK IN SHARE MODE</CODE> is introduced.
<LI>

<CODE>InnoDB</CODE> now calls <CODE>fsync()</CODE> after every disk write and calculates
a checksum
for every database page it writes or reads, which will reveal disk defects.
<LI>

Several bugfixes.
</UL>



<H1><A NAME="Porting" HREF="manual_toc.html#Porting">D  Porting to Other Systems</A></H1>

<P>
<A NAME="IDX2319"></A>

</P>
<P>
This appendix will help you port MySQL to other operating systems.
Do check the list of currently supported operating systems first.
See section <A HREF="manual.html#Which_OS">2.1.1  Operating Systems Supported by MySQL</A>.
If you have created a new port of MySQL, please let us know so that
we can list it here and on our Web site (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>),
recommending it to other users.

</P>
<P>
Note: If you create a new port of MySQL, you are free to copy and
distribute it under the <CODE>GPL</CODE> license, but it does not make you a
copyright holder of MySQL.

</P>
<P>
A working POSIX thread library is needed for the server. On Solaris 2.5
we use Sun PThreads (the native thread support in 2.4 and earlier
versions is not good enough), on Linux we use LinuxThreads by Xavier
Leroy, <a HREF="mailto:Xavier.Leroy@inria.fr">Xavier.Leroy@inria.fr</a>.

</P>
<P>
The hard part of porting to a new Unix variant without good native
thread support is probably to port MIT-pthreads. See
<TT>`mit-pthreads/README'</TT> and Programming POSIX Threads
(<a HREF="http://www.humanfactor.com/pthreads/">http://www.humanfactor.com/pthreads/</a>).

</P>
<P>
Up to MySQL 4.0.2, the MySQL distribution included a patched version of
Chris Provenzano's Pthreads from MIT (see the MIT Pthreads Web page at
<a HREF="http://www.mit.edu/afs/sipb/project/pthreads/">http://www.mit.edu/afs/sipb/project/pthreads/</a> and a programming
introduction at <a HREF="http://www.mit.edu:8001/people/proven/IAP_2000/">http://www.mit.edu:8001/people/proven/IAP_2000/</a>).
These can be used for some operating systems that do not have POSIX threads.
See section <A HREF="manual.html#MIT-pthreads">2.3.5  MIT-pthreads Notes</A>.

</P>
<P>
It is also possible to use another user level thread package named
FSU Pthreads (see <a HREF="http://moss.csc.ncsu.edu/~mueller/pthreads/">http://moss.csc.ncsu.edu/~mueller/pthreads/</a>).
This implementation is being used for the SCO port.

</P>
<P>
See the <TT>`thr_lock.c'</TT> and <TT>`thr_alarm.c'</TT> programs in the <TT>`mysys'</TT>
directory for some tests/examples of these problems.

</P>
<P>
Both the server and the client need a working C++ compiler. We use <CODE>gcc</CODE>
on many platforms. Other compilers that are known to work are SPARCworks,
Sun Forte, Irix <CODE>cc</CODE>, HP-UX <CODE>aCC</CODE>, IBM AIX <CODE>xlC_r</CODE>), Intel
<CODE>ecc</CODE> and Compaq <CODE>cxx</CODE>).

</P>
<P>
To compile only the client use <CODE>./configure --without-server</CODE>.

</P>
<P>
There is currently no support for only compiling the server, nor is it
likly to be added unless someone has a good reason for it.

</P>
<P>
If you want/need to change any <TT>`Makefile'</TT> or the configure script you
will also need GNU Automake and Autoconf.
See section <A HREF="manual.html#Installing_source_tree">2.3.3  Installing from the Development Source Tree</A>.

</P>
<P>
All steps needed to remake everything from the most basic files.

</P>

<PRE>
/bin/rm */.deps/*.P
/bin/rm -f config.cache
aclocal
autoheader
aclocal
automake
autoconf
./configure --with-debug=full --prefix='your installation directory'

# The makefiles generated above need GNU make 3.75 or newer.
# (called gmake below)
gmake clean all install init-db
</PRE>

<P>
If you run into problems with a new port, you may have to do some debugging
of MySQL!
See section <A HREF="manual.html#Debugging_server">D.1  Debugging a MySQL Server</A>.

</P>
<P>
<STRONG>Note:</STRONG> Before you start debugging <CODE>mysqld</CODE>, first get the test
programs <CODE>mysys/thr_alarm</CODE> and <CODE>mysys/thr_lock</CODE> to work.  This
will ensure that your thread installation has even a remote chance to work!

</P>



<H2><A NAME="Debugging_server" HREF="manual_toc.html#Debugging_server">D.1  Debugging a MySQL Server</A></H2>

<P>
<A NAME="IDX2320"></A>
<A NAME="IDX2321"></A>
<A NAME="IDX2322"></A>

</P>
<P>
If you are using some functionality that is very new in MySQL,
you can try to run <CODE>mysqld</CODE> with the <CODE>--skip-new</CODE> (which will disable all
new, potentially unsafe functionality) or with <CODE>--safe-mode</CODE> which
disables a lot of optimization that may cause problems.
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
If <CODE>mysqld</CODE> doesn't want to start, you should verify that you don't have
any <TT>`my.cnf'</TT> files that interfere with your setup!
You can check your <TT>`my.cnf'</TT> arguments with <CODE>mysqld --print-defaults</CODE>
and avoid using them by starting with <CODE>mysqld --no-defaults ...</CODE>.

</P>
<P>
If <CODE>mysqld</CODE> starts to eat up CPU or memory or if it ``hangs,'' you
can use <CODE>mysqladmin processlist status</CODE> to find out if someone is
executing a query that takes a long time.  It may be a good idea to
run <CODE>mysqladmin -i10 processlist status</CODE> in some window if you are
experiencing performance problems or problems when new clients can't connect.

</P>
<P>
The command <CODE>mysqladmin debug</CODE> will dump some information about
locks in use, used memory and query usage to the MySQL log file. This
may help solve some problems.  This command also provides some useful
information even if you haven't compiled MySQL for debugging!

</P>
<P>
If the problem is that some tables are getting slower and slower you
should try to optimize the table with <CODE>OPTIMIZE TABLE</CODE> or
<CODE>myisamchk</CODE>.  See section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>. You should also
check the slow queries with <CODE>EXPLAIN</CODE>.

</P>
<P>
You should also read the OS-specific section in this manual for
problems that may be unique to your environment.
See section <A HREF="manual.html#Operating_System_Specific_Notes">2.6  Operating System-Specific Notes</A>.

</P>



<H3><A NAME="Compiling_for_debugging" HREF="manual_toc.html#Compiling_for_debugging">D.1.1  Compiling MySQL for Debugging</A></H3>

<P>
If you have some very specific problem, you can always try to debug
MySQL.  To do this you must configure MySQL with the
<CODE>--with-debug</CODE> or the <CODE>--with-debug=full</CODE> option.  You can check
whether MySQL was compiled with debugging by doing:
<CODE>mysqld --help</CODE>.  If the <CODE>--debug</CODE> flag is listed with the
options then you have debugging enabled.  <CODE>mysqladmin ver</CODE> also
lists the <CODE>mysqld</CODE> version as <CODE>mysql ... --debug</CODE> in this case.

</P>
<P>
If you are using <CODE>gcc</CODE> or <CODE>egcs</CODE>, the recommended <CODE>configure</CODE> line is:

</P>

<PRE>
CC=gcc CFLAGS="-O2" CXX=gcc CXXFLAGS="-O2 -felide-constructors \
   -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql \
   --with-debug --with-extra-charsets=complex
</PRE>

<P>
This will avoid problems with the <CODE>libstdc++</CODE> library and with C++
exceptions (many compilers have problems with C++ exceptions in threaded
code) and compile a MySQL version with support for all character sets.

</P>
<P>
If you suspect a memory overrun error, you can configure MySQL
with <CODE>--with-debug=full</CODE>, which will install a memory allocation
(<CODE>SAFEMALLOC</CODE>) checker. However, running with <CODE>SAFEMALLOC</CODE> is
quite slow, so if you get performance problems you should start
<CODE>mysqld</CODE> with the <CODE>--skip-safemalloc</CODE> option. This will
disable the memory overrun checks for each call to <CODE>malloc()</CODE> and
<CODE>free()</CODE>.

</P>
<P>
If <CODE>mysqld</CODE> stops crashing when you compile it with
<CODE>--with-debug</CODE>, you have probably found a compiler bug or a timing
bug within MySQL.  In this case, you can try to add <CODE>-g</CODE> to
the <CODE>CFLAGS</CODE> and <CODE>CXXFLAGS</CODE> variables above and not use
<CODE>--with-debug</CODE>. If <CODE>mysqld</CODE> now dies, you can at least attach
to it with <CODE>gdb</CODE> or use <CODE>gdb</CODE> on the core file to find out
what happened.

</P>
<P>
When you configure MySQL for debugging you automatically enable a
lot of extra safety check functions that monitor the health of <CODE>mysqld</CODE>.
If they find something ``unexpected,'' an entry will be written to
<CODE>stderr</CODE>, which <CODE>safe_mysqld</CODE> directs to the error log!  This also
means that if you are having some unexpected problems with MySQL and
are using a source distribution, the first thing you should do is to
configure MySQL for debugging!  (The second thing is to
send mail to a MySQL mailing list and ask for help.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.
Please use the
<CODE>mysqlbug</CODE> script for all bug reports or questions regarding the
MySQL version you are using!

</P>
<P>
In the Windows MySQL distribution, <CODE>mysqld.exe</CODE> is by
default compiled with support for trace files.

</P>



<H3><A NAME="Making_trace_files" HREF="manual_toc.html#Making_trace_files">D.1.2  Creating Trace Files</A></H3>

<P>
If the <CODE>mysqld</CODE> server doesn't start or if you can cause it
to crash quickly, you can try to create a trace file to find the problem.

</P>
<P>
To do this, you must have a <CODE>mysqld</CODE> that has been compiled with
debugging support.
You can check this by executing <CODE>mysqld -V</CODE>.  If the version number
ends with <CODE>-debug</CODE>, it's compiled with support for trace files.

</P>
<P>
Start the <CODE>mysqld</CODE> server with a trace log in <TT>`/tmp/mysqld.trace'</TT>
on Unix or <TT>`C:\mysqld.trace'</TT> on Windows:

</P>

<PRE>
shell&#62; mysqld --debug
</PRE>

<P>
On Windows, you should also use the <CODE>--standalone</CODE> flag to not start
<CODE>mysqld</CODE> as a service.  In a console window, use this command:

</P>

<PRE>
C:\&#62; mysqld --debug --standalone
</PRE>

<P>
After this, you can use the <CODE>mysql.exe</CODE> command-line tool in a
second console window to reproduce the problem. You can stop the
<CODE>mysqld</CODE> server with <CODE>mysqladmin shutdown</CODE>.

</P>
<P>
Note that the trace file will become <STRONG>very big</STRONG>!
If you want to generate a smaller trace file, you can use debugging options
something like this:

</P>
<P>
<CODE>mysqld --debug=d,info,error,query,general,where:O,/tmp/mysqld.trace</CODE>

</P>
<P>
This only prints information with the most interesting tags to the trace file.

</P>
<P>
If you make a bug report about this, please only send the lines from the
trace file to the appropriate mailing list where something seems to go
wrong! If you can't locate the wrong place, you can ftp the trace file,
together with a full bug report, to
<a HREF="ftp://support.mysql.com/pub/mysql/secret/">ftp://support.mysql.com/pub/mysql/secret/</a> so that a MySQL
developer can take a look a this.

</P>
<P>
The trace file is made with the <STRONG>DBUG</STRONG> package by Fred Fish.
See section <A HREF="manual.html#The_DBUG_package">D.3  The DBUG Package</A>.

</P>



<H3><A NAME="Using_gdb_on_mysqld" HREF="manual_toc.html#Using_gdb_on_mysqld">D.1.3  Debugging <CODE>mysqld</CODE> under <CODE>gdb</CODE></A></H3>

<P>
<A NAME="IDX2323"></A>

</P>
<P>
On most systems you can also start <CODE>mysqld</CODE> from <CODE>gdb</CODE> to get
more information if <CODE>mysqld</CODE> crashes.

</P>
<P>
With some older <CODE>gdb</CODE> versions on Linux you must use <CODE>run
--one-thread</CODE> if you want to be able to debug <CODE>mysqld</CODE> threads.  In
this case, you can only have one thread active at a time.  We recommend you
to upgrade to gdb 5.1 ASAP as thread debugging works much better with this
version!

</P>
<P>
When running <CODE>mysqld</CODE> under gdb, you should disable the stack trace
with <CODE>--skip-stack-trace</CODE> to be able to catch segfaults within gdb.

</P>
<P>
In MySQL 4.0.14 and above you should use the <CODE>--gdb</CODE> option to
mysqld.  This will install an interrupt handler for <CODE>SIGINT</CODE> (needed
to stop <CODE>mysqld</CODE> with <CODE>^C</CODE> to set breakpoints) and disable stack
tracing and core file handling.

</P>
<P>
It's very hard to debug MySQL under <CODE>gdb</CODE> if you do a lot of
new connections the whole time as <CODE>gdb</CODE> doesn't free the memory for
old threads.  You can avoid this problem by starting <CODE>mysqld</CODE> with
<CODE>-O thread_cache_size= 'max_connections +1'</CODE>.  In most cases just
using <CODE>-O thread_cache_size=5'</CODE> will help a lot!

</P>
<P>
If you want to get a core dump on Linux if <CODE>mysqld</CODE> dies with a
SIGSEGV signal, you can start <CODE>mysqld</CODE> with the <CODE>--core-file</CODE> option.
This core file can be used to make a backtrace that may help you
find out why <CODE>mysqld</CODE> died:

</P>

<PRE>
shell&#62; gdb mysqld core
gdb&#62;   backtrace full
gdb&#62;   exit
</PRE>

<P>
See section <A HREF="manual.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
If you are using gdb 4.17.x or above on Linux, you should install a
<TT>`.gdb'</TT> file, with the following information, in your current
directory:

</P>

<PRE>
set print sevenbit off
handle SIGUSR1 nostop noprint
handle SIGUSR2 nostop noprint
handle SIGWAITING nostop noprint
handle SIGLWP nostop noprint
handle SIGPIPE nostop
handle SIGALRM nostop
handle SIGHUP nostop
handle SIGTERM nostop noprint
</PRE>

<P>
If you have problems debugging threads with gdb, you should download
gdb 5.x and try this instead. The new gdb version has very improved
thread handling!

</P>
<P>
Here is an example how to debug mysqld:

</P>

<PRE>
shell&#62; gdb /usr/local/libexec/mysqld
gdb&#62; run
...
backtrace full # Do this when mysqld crashes
</PRE>

<P>
Include the above output in a mail generated with <CODE>mysqlbug</CODE> and
mail this to the general MySQL mailing list.
See section <A HREF="manual.html#Mailing-list">1.7.1.1  The MySQL Mailing Lists</A>.

</P>
<P>
If <CODE>mysqld</CODE> hangs you can try to use some system tools like
<CODE>strace</CODE> or <CODE>/usr/proc/bin/pstack</CODE> to examine where
<CODE>mysqld</CODE> has hung.

</P>

<PRE>
strace /tmp/log libexec/mysqld
</PRE>

<P>
<A NAME="IDX2324"></A>
<A NAME="IDX2325"></A>
<A NAME="IDX2326"></A>
<A NAME="IDX2327"></A>
If you are using the Perl <CODE>DBI</CODE> interface, you can turn on
debugging information by using the <CODE>trace</CODE> method or by
setting the <CODE>DBI_TRACE</CODE> environment variable.

</P>



<H3><A NAME="Using_stack_trace" HREF="manual_toc.html#Using_stack_trace">D.1.4  Using a Stack Trace</A></H3>

<P>
On some operating systems, the error log will contain a stack trace if
<CODE>mysqld</CODE> dies unexpectedly. You can use this to find out where (and
maybe why) <CODE>mysqld</CODE> died. See section <A HREF="manual.html#Error_log">5.8.1  The Error Log</A>.  To get a stack trace,
you must not compile <CODE>mysqld</CODE> with the <CODE>-fomit-frame-pointer</CODE>
option to gcc. See section <A HREF="manual.html#Compiling_for_debugging">D.1.1  Compiling MySQL for Debugging</A>.

</P>
<P>
If the error file contains something like the following:

</P>

<PRE>
mysqld got signal 11;
The manual section 'Debugging a MySQL server' tells you how to use a
stack trace and/or the core file to produce a readable backtrace that may
help in finding out why mysqld died
Attempting backtrace. You can use the following information to find out
where mysqld died.  If you see no messages after this, something went
terribly wrong...
stack range sanity check, ok, backtrace follows
0x40077552
0x81281a0
0x8128f47
0x8127be0
0x8127995
0x8104947
0x80ff28f
0x810131b
0x80ee4bc
0x80c3c91
0x80c6b43
0x80c1fd9
0x80c1686
</PRE>

<P>
you can find where <CODE>mysqld</CODE> died by doing the following:

</P>

<OL>
<LI>

Copy the preceding numbers to a file, for example <TT>`mysqld.stack'</TT>.

<LI>

Make a symbol file for the <CODE>mysqld</CODE> server:

<PRE>
nm -n libexec/mysqld &#62; /tmp/mysqld.sym
</PRE>

Note that most MySQL binary distributions (except for the "debug" packages,
where this information is included inside of the binaries themselves)
already ship with the above file, named <CODE>mysqld.sym.gz</CODE>.
In this case, you can simply unpack it by doing:


<PRE>
gunzip &#60; bin/mysqld.sym.gz &#62; /tmp/mysqld.sym
</PRE>

<LI>

Execute <CODE>resolve_stack_dump -s /tmp/mysqld.sym -n mysqld.stack</CODE>.

This will print out where <CODE>mysqld</CODE> died. If this doesn't help you
find out why <CODE>mysqld</CODE> died, you should make a bug report and include
the output from the above command with the bug report.

Note however that in most cases it will not help us to just have a stack
trace to find the reason for the problem.  To be able to locate the bug
or provide a workaround, we would in most cases need to know the query
that killed <CODE>mysqld</CODE> and preferable a test case so that we can
repeat the problem!  See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.
</OL>



<H3><A NAME="Using_log_files" HREF="manual_toc.html#Using_log_files">D.1.5  Using Log Files to Find Cause of Errors in <CODE>mysqld</CODE></A></H3>

<P>
Note that before starting <CODE>mysqld</CODE> with <CODE>--log</CODE> you should
check all your tables with <CODE>myisamchk</CODE>.
See section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>.

</P>
<P>
If <CODE>mysqld</CODE> dies or hangs, you should start <CODE>mysqld</CODE> with
<CODE>--log</CODE>.  When <CODE>mysqld</CODE> dies again, you can examine the end of
the log file for the query that killed <CODE>mysqld</CODE>.

</P>
<P>
If you are using <CODE>--log</CODE> without a file name, the log is stored in
the database directory as <TT>`host_name.log'</TT> In most cases it is the last
query in the log file that killed <CODE>mysqld</CODE>, but if possible you
should verify this by restarting <CODE>mysqld</CODE> and executing the found
query from the <CODE>mysql</CODE> command-line tools. If this works, you
should also test all complicated queries that didn't complete.

</P>
<P>
You can also try the command <CODE>EXPLAIN</CODE> on all <CODE>SELECT</CODE>
statements that takes a long time to ensure that <CODE>mysqld</CODE> is using
indexes properly. See section <A HREF="manual.html#EXPLAIN">7.2.1  <CODE>EXPLAIN</CODE> Syntax (Get Information About a <CODE>SELECT</CODE>)</A>.

</P>
<P>
You can find the queries that take a long time to execute by starting
<CODE>mysqld</CODE> with <CODE>--log-slow-queries</CODE>. See section <A HREF="manual.html#Slow_query_log">5.8.5  The Slow Query Log</A>.

</P>
<P>
If you find the text <CODE>mysqld restarted</CODE> in the error log file
(normally named <TT>`hostname.err'</TT>) you have probably found a query
that causes <CODE>mysqld</CODE> to fail.  If this happens, you should check all
your tables with <CODE>myisamchk</CODE> (see section <A HREF="manual.html#MySQL_Database_Administration">5  Database Administration</A>),
and test the queries in the MySQL log files to see if one doesn't
work.  If you find such a query, try first upgrading to the newest
MySQL version.  If this doesn't help and you can't find anything
in the <CODE>mysql</CODE> mail archive, you should report the bug to a MySQL
mailing list.
The mailing lists are described at
<a HREF="http://lists.mysql.com/">http://lists.mysql.com/</a>, which also has links to online
list archives.

</P>
<P>
If you have started <CODE>mysqld</CODE> with <CODE>myisam-recover</CODE>,
MySQL will automatically check and try to repair <CODE>MyISAM</CODE>
tables if they are marked as 'not closed properly' or 'crashed'.  If
this happens, MySQL will write an entry in the
<CODE>hostname.err</CODE> file <CODE>'Warning: Checking table ...'</CODE> which is
followed by <CODE>Warning: Repairing table</CODE> if the table needs to be
repaired.  If you get a lot of these errors, without <CODE>mysqld</CODE> having
died unexpectedly just before, then something is wrong and needs to
be investigated further. See section <A HREF="manual.html#Server_options">5.2.1  <CODE>mysqld</CODE> Command-Line Options</A>.

</P>
<P>
It's not a good sign if <CODE>mysqld</CODE> did died unexpectedly,
but in this case one shouldn't investigate the <CODE>Checking table...</CODE>
messages but instead try to find out why <CODE>mysqld</CODE> died.

</P>



<H3><A NAME="Reproduceable_test_case" HREF="manual_toc.html#Reproduceable_test_case">D.1.6  Making a Test Case If You Experience Table Corruption</A></H3>

<P>
If you get corrupted tables or if <CODE>mysqld</CODE> always fails after some
update commands, you can test whether this bug is reproducible by doing the
following:

</P>

<UL>
<LI>

Take down the MySQL daemon (with <CODE>mysqladmin shutdown</CODE>).
<LI>

Make a backup of the tables (to guard against the very unlikely case that
the repair will do something bad).
<LI>

Check all tables with <CODE>myisamchk -s database/*.MYI</CODE>.  Repair any
wrong tables with <CODE>myisamchk -r database/table.MYI</CODE>.
<LI>

Make a second backup of the tables.
<LI>

Remove (or move away) any old log files from the MySQL data
directory if you need more space.
<LI>

Start <CODE>mysqld</CODE> with <CODE>--log-bin</CODE>. See section <A HREF="manual.html#Binary_log">5.8.4  The Binary Log</A>.
If you want to find a query that crashes <CODE>mysqld</CODE>, you should use
<CODE>--log --log-bin</CODE>.
<LI>

When you have gotten a crashed table, stop the <CODE>mysqld server</CODE>.
<LI>

Restore the backup.
<LI>

Restart the <CODE>mysqld</CODE> server <STRONG>without</STRONG> <CODE>--log-bin</CODE>
<LI>

Re-execute the commands with <CODE>mysqlbinlog update-log-file | mysql</CODE>.
The update log is saved in the MySQL database directory with
the name <CODE>hostname-bin.#</CODE>.
<LI>

If the tables are corrupted again or you can get <CODE>mysqld</CODE> to die with the
above command, you have found reproducible bug that should be easy to
fix! FTP the tables and the binary log to
<a HREF="ftp://support.mysql.com/pub/mysql/secret/">ftp://support.mysql.com/pub/mysql/secret/</a> and enter it into
our bugs system at <a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a>.
If you are a support customer, you can use our Customer Support Center
https://support.mysql.com/ to alert the MySQL team about the
problem and have it fixed as soon as possible.

</UL>

<P>
You can also use the script <CODE>mysql_find_rows</CODE> to just execute some of the
update statements if you want to narrow down the problem.

</P>



<H2><A NAME="Debugging_client" HREF="manual_toc.html#Debugging_client">D.2  Debugging a MySQL Client</A></H2>

<P>
<A NAME="IDX2328"></A>
<A NAME="IDX2329"></A>

</P>
<P>
To be able to debug a MySQL client with the integrated debug package,
you should configure MySQL with <CODE>--with-debug</CODE> or
<CODE>--with-debug=full</CODE>.
See section <A HREF="manual.html#configure_options">2.3.2  Typical <CODE>configure</CODE> Options</A>.

</P>
<P>
<A NAME="IDX2330"></A>
<A NAME="IDX2331"></A>
Before running a client, you should set the <CODE>MYSQL_DEBUG</CODE> environment
variable:

</P>

<PRE>
shell&#62; MYSQL_DEBUG=d:t:O,/tmp/client.trace
shell&#62; export MYSQL_DEBUG
</PRE>

<P>
This causes clients to generate a trace file in <TT>`/tmp/client.trace'</TT>.

</P>
<P>
If you have problems with your own client code, you should attempt to
connect to the server and run your query using a client that is known to
work.  Do this by running <CODE>mysql</CODE> in debugging mode (assuming that you
have compiled MySQL with debugging on):

</P>

<PRE>
shell&#62; mysql --debug=d:t:O,/tmp/client.trace
</PRE>

<P>
This will provide useful information in case you mail a bug report.
See section <A HREF="manual.html#Bug_reports">1.7.1.3  How to Report Bugs or Problems</A>.

</P>
<P>
If your client crashes at some 'legal' looking code, you should check
that your <TT>`mysql.h'</TT> include file matches your MySQL library file.
A very common mistake is to use an old <TT>`mysql.h'</TT> file from an old
MySQL installation with new MySQL library.

</P>



<H2><A NAME="The_DBUG_package" HREF="manual_toc.html#The_DBUG_package">D.3  The DBUG Package</A></H2>

<P>
<A NAME="IDX2332"></A>

</P>
<P>
The MySQL server and most MySQL clients are compiled with the DBUG package
originally created by Fred Fish.  When you have configured MySQL for
debugging, this package makes it possible to get a trace file of what the
program is debugging.
See section <A HREF="manual.html#Making_trace_files">D.1.2  Creating Trace Files</A>.

</P>
<P>
You use the debug package by invoking a program with the
<CODE>--debug="..."</CODE> or the <CODE>-#...</CODE> option.

</P>
<P>
Most MySQL programs have a default debug string that will be
used if you don't specify an option to <CODE>--debug</CODE>.  The default
trace file is usually <CODE>/tmp/program_name.trace</CODE> on Unix and
<CODE>\program_name.trace</CODE> on Windows.

</P>
<P>
The debug control string is a sequence of colon-separated fields
as follows:

</P>

<PRE>
&#60;field_1&#62;:&#60;field_2&#62;:...:&#60;field_N&#62;
</PRE>

<P>
Each field consists of a mandatory flag character followed by
an optional <SAMP>`,'</SAMP> and comma-separated list of modifiers:

</P>

<PRE>
flag[,modifier,modifier,...,modifier]
</PRE>

<P>
The currently recognized flag characters are:

</P>
<TABLE BORDER WIDTH="100%">

<TR><TD><STRONG>Flag</STRONG> </TD><TD> <STRONG>Description</STRONG>

</TD></TR>
<TR><TD><CODE>d</CODE> </TD><TD> Enable output from DBUG_&#60;N&#62; macros for the current state. May be followed by a list of keywords which selects output only for the DBUG macros with that keyword. An empty list of keywords implies output for all macros.

</TD></TR>
<TR><TD><CODE>D</CODE> </TD><TD> Delay after each debugger output line. The argument is the number of tenths of seconds to delay, subject to machine capabilities. For example, <CODE>-#D,20</CODE> specifies a delay of two seconds.

</TD></TR>
<TR><TD><CODE>f</CODE> </TD><TD> Limit debugging and/or tracing, and profiling to the list of named functions.  Note that a null list disables all functions.   The appropriate <CODE>d</CODE> or <CODE>t</CODE> flags must still be given; this flag only limits their actions if they are enabled.

</TD></TR>
<TR><TD><CODE>F</CODE> </TD><TD> Identify the source file name for each line of debug or trace output.

</TD></TR>
<TR><TD><CODE>i</CODE> </TD><TD> Identify the process with the PID or thread ID for each line of debug or trace output.

</TD></TR>
<TR><TD><CODE>g</CODE> </TD><TD> Enable profiling.  Create a file called <TT>`dbugmon.out'</TT> containing information that can be used to profile the program.  May be followed by a list of keywords that select profiling only for the functions in that list.  A null list implies that all functions are considered.

</TD></TR>
<TR><TD><CODE>L</CODE> </TD><TD> Identify the source file line number for each line of debug or trace output.

</TD></TR>
<TR><TD><CODE>n</CODE> </TD><TD> Print the current function nesting depth for each line of debug or trace output.

</TD></TR>
<TR><TD><CODE>N</CODE> </TD><TD> Number each line of debug output.

</TD></TR>
<TR><TD><CODE>o</CODE> </TD><TD> Redirect the debugger output stream to the specified file.  The default output is <CODE>stderr</CODE>.

</TD></TR>
<TR><TD><CODE>O</CODE> </TD><TD> Like <CODE>o</CODE>, but the file is really flushed between each write. When needed, the file is closed and reopened between each write.

</TD></TR>
<TR><TD><CODE>p</CODE> </TD><TD> Limit debugger actions to specified processes. A process must be identified with the <CODE>DBUG_PROCESS</CODE> macro and match one in the list for debugger actions to occur.

</TD></TR>
<TR><TD><CODE>P</CODE> </TD><TD> Print the current process name for each line of debug or trace output.

</TD></TR>
<TR><TD><CODE>r</CODE> </TD><TD> When pushing a new state, do not inherit the previous state's function nesting level. Useful when the output is to start at the left margin.

</TD></TR>
<TR><TD><CODE>S</CODE> </TD><TD> Do function <CODE>_sanity(_file_,_line_)</CODE> at each debugged function until <CODE>_sanity()</CODE> returns something that differs from 0. (Mostly used with <CODE>safemalloc</CODE> to find memory leaks)

</TD></TR>
<TR><TD><CODE>t</CODE> </TD><TD> Enable function call/exit trace lines. May be followed by a list (containing only one modifier) giving a numeric maximum trace level, beyond which no output will occur for either debugging or tracing macros.  The default is a compile time option.

</TD></TR>
</TABLE>

<P>
Some examples of debug control strings that might appear on a shell command
line (the <CODE>-#</CODE> is typically used to introduce a control string to an
application program) are:

</P>

<PRE>
-#d:t
-#d:f,main,subr1:F:L:t,20
-#d,input,output,files:n
-#d:t:i:O,\\mysqld.trace
</PRE>

<P>
In MySQL, common tags to print (with the <CODE>d</CODE> option) are
<CODE>enter</CODE>, <CODE>exit</CODE>, <CODE>error</CODE>, <CODE>warning</CODE>, <CODE>info</CODE>, and
<CODE>loop</CODE>.

</P>



<H2><A NAME="RTS-threads" HREF="manual_toc.html#RTS-threads">D.4  Comments about RTS Threads</A></H2>

<P>
<A NAME="IDX2333"></A>
<A NAME="IDX2334"></A>

</P>
<P>
I have tried to use the RTS thread packages with MySQL but
stumbled on the following problems:

</P>
<P>
They use old versions of many POSIX calls and it is very tedious to
make wrappers for all functions. I am inclined to think that it would
be easier to change the thread libraries to the newest POSIX
specification.

</P>
<P>
Some wrappers are already written. See <TT>`mysys/my_pthread.c'</TT> for more info.

</P>
<P>
At least the following should be changed:

</P>
<P>
<CODE>pthread_get_specific</CODE> should use one argument.
<CODE>sigwait</CODE> should take two arguments.
A lot of functions (at least <CODE>pthread_cond_wait</CODE>,
<CODE>pthread_cond_timedwait()</CODE>)
should return the error code on error. Now they return -1 and set <CODE>errno</CODE>.

</P>
<P>
Another problem is that user-level threads use the <CODE>ALRM</CODE> signal and this
aborts a lot of functions (<CODE>read</CODE>, <CODE>write</CODE>, <CODE>open</CODE>...).
MySQL should do a retry on interrupt on all of these but it is
not that easy to verify it.

</P>
<P>
The biggest unsolved problem is the following:

</P>
<P>
To get thread-level alarms I changed <TT>`mysys/thr_alarm.c'</TT> to wait between
alarms with <CODE>pthread_cond_timedwait()</CODE>, but this aborts with error
<CODE>EINTR</CODE>.  I tried to debug the thread library as to why this happens,
but couldn't find any easy solution.

</P>
<P>
If someone wants to try MySQL with RTS threads I suggest the
following:

</P>

<UL>
<LI>

Change functions MySQL uses from the thread library to POSIX.
This shouldn't take that long.
<LI>

Compile all libraries with the <CODE>-DHAVE_rts_threads</CODE>.
<LI>

Compile <CODE>thr_alarm</CODE>.
<LI>

If there are some small differences in the implementation, they may be fixed
by changing <TT>`my_pthread.h'</TT> and <TT>`my_pthread.c'</TT>.
<LI>

Run <CODE>thr_alarm</CODE>. If it runs without any ``warning,'' ``error,'' or aborted
messages, you are on the right track. Here is a successful run on
Solaris:

<PRE>
Main thread: 1
Thread 0 (5) started
Thread: 5  Waiting
process_alarm
Thread 1 (6) started
Thread: 6  Waiting
process_alarm
process_alarm
thread_alarm
Thread: 6  Slept for 1 (1) sec
Thread: 6  Waiting
process_alarm
process_alarm
thread_alarm
Thread: 6  Slept for 2 (2) sec
Thread: 6  Simulation of no alarm needed
Thread: 6  Slept for 0 (3) sec
Thread: 6  Waiting
process_alarm
process_alarm
thread_alarm
Thread: 6  Slept for 4 (4) sec
Thread: 6  Waiting
process_alarm
thread_alarm
Thread: 5  Slept for 10 (10) sec
Thread: 5  Waiting
process_alarm
process_alarm
thread_alarm
Thread: 6  Slept for 5 (5) sec
Thread: 6  Waiting
process_alarm
process_alarm

...
thread_alarm
Thread: 5  Slept for 0 (1) sec
end
</PRE>

</UL>



<H2><A NAME="Thread_packages" HREF="manual_toc.html#Thread_packages">D.5  Differences Between Thread Packages</A></H2>

<P>
<A NAME="IDX2335"></A>

</P>
<P>
MySQL is very dependent on the thread package used. So when
choosing a good platform for MySQL, the thread package is very
important.

</P>
<P>
There are at least three types of thread packages:

</P>

<UL>
<LI>

User threads in a single process. Thread switching is managed with
alarms and the threads library manages all non-thread-safe functions
with locks. Read, write and select operations are usually managed with a
thread-specific select that switches to another thread if the running
threads have to wait for data.  If the user thread packages are
integrated in the standard libs (FreeBSD and BSDI threads) the thread
package requires less overhead than thread packages that have to map all
unsafe calls (MIT-pthreads, FSU Pthreads and RTS threads).  In some
environments (for example, SCO), all system calls are thread-safe so the
mapping can be done very easily (FSU Pthreads on SCO).  Downside: All
mapped calls take a little time and it's quite tricky to be able to
handle all situations. There are usually also some system calls that are
not handled by the thread package (like MIT-pthreads and sockets). Thread
scheduling isn't always optimal.
<LI>

User threads in separate processes. Thread switching is done by the
kernel and all data are shared between threads.  The thread package
manages the standard thread calls to allow sharing data between threads.
LinuxThreads is using this method.  Downside: Lots of processes. Thread
creating is slow. If one thread dies the rest are usually left hanging
and you must kill them all before restarting. Thread switching is
somewhat expensive.
<LI>

Kernel threads. Thread switching is handled by the thread library or the
kernel and is very fast. Everything is done in one process, but on some
systems, <CODE>ps</CODE> may show the different threads. If one thread aborts, the
whole process aborts. Most system calls are thread-safe and should
require very little overhead.  Solaris, HP-UX, AIX and OSF/1 have kernel
threads.
</UL>

<P>
In some systems kernel threads are managed by integrating user
level threads in the system libraries. In such cases, the thread
switching can only be done by the thread library and the kernel isn't
really ``thread aware.''

</P>



<H1><A NAME="Environment_variables" HREF="manual_toc.html#Environment_variables">E  Environment Variables</A></H1>

<P>
<A NAME="IDX2336"></A>

</P>
<P>
Here is a list of all the environment variables that are used directly or
indirectly by MySQL. Most of these can also be found in other
places in this manual.

</P>
<P>
Note that any options on the command line take precedence over
values specified in option files and environment variables, and
values in option files take precedence over values in environment
variables.

</P>
<P>
In many cases it's preferable to use an option file instead of environment
variables to modify the behavior of MySQL. See section <A HREF="manual.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
<A NAME="IDX2337"></A>
<A NAME="IDX2338"></A>
<A NAME="IDX2339"></A>
<A NAME="IDX2340"></A>
<A NAME="IDX2341"></A>
<A NAME="IDX2342"></A>
<A NAME="IDX2343"></A>
<A NAME="IDX2344"></A>
<A NAME="IDX2345"></A>
<A NAME="IDX2346"></A>
<A NAME="IDX2347"></A>
<A NAME="IDX2348"></A>
<A NAME="IDX2349"></A>
<A NAME="IDX2350"></A>
<A NAME="IDX2351"></A>
<A NAME="IDX2352"></A>
<A NAME="IDX2353"></A>
<A NAME="IDX2354"></A>
<A NAME="IDX2355"></A>
<A NAME="IDX2356"></A>
<A NAME="IDX2357"></A>
<A NAME="IDX2358"></A>
<A NAME="IDX2359"></A>
<A NAME="IDX2360"></A>
<A NAME="IDX2361"></A>
<A NAME="IDX2362"></A>
<A NAME="IDX2363"></A>
<A NAME="IDX2364"></A>
<A NAME="IDX2365"></A>
<A NAME="IDX2366"></A>
<A NAME="IDX2367"></A>
<A NAME="IDX2368"></A>
<A NAME="IDX2369"></A>
<A NAME="IDX2370"></A>
<A NAME="IDX2371"></A>
<A NAME="IDX2372"></A>
<A NAME="IDX2373"></A>
<A NAME="IDX2374"></A>
<A NAME="IDX2375"></A>
<A NAME="IDX2376"></A>
<A NAME="IDX2377"></A>
<A NAME="IDX2378"></A>

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><STRONG>Variable</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TD></TR>
<TR><TD><CODE>CXX</CODE> </TD><TD> The name of your C++ compiler (for running <CODE>configure</CODE>).
</TD></TR>
<TR><TD><CODE>CC</CODE> </TD><TD> The name of your C compiler (for running <CODE>configure</CODE>).
</TD></TR>
<TR><TD><CODE>CFLAGS</CODE> </TD><TD> Flags for your C compiler (for running <CODE>configure</CODE>).
</TD></TR>
<TR><TD><CODE>CXXFLAGS</CODE> </TD><TD> Flags for your C++ compiler (for running <CODE>configure</CODE>).
</TD></TR>
<TR><TD><CODE>DBI_USER</CODE> </TD><TD> The default username for Perl DBI.
</TD></TR>
<TR><TD><CODE>DBI_TRACE</CODE> </TD><TD> Trace options for Perl DBI.
</TD></TR>
<TR><TD><CODE>HOME</CODE> </TD><TD> The default path for the <CODE>mysql</CODE> history file is <TT>`$HOME/.mysql_history'</TT>.
</TD></TR>
<TR><TD><CODE>LD_RUN_PATH</CODE> </TD><TD> Used to specify where your <TT>`libmysqlclient.so'</TT> is located.
</TD></TR>
<TR><TD><CODE>MYSQL_DEBUG</CODE> </TD><TD> Debug trace options when debugging.
</TD></TR>
<TR><TD><CODE>MYSQL_HISTFILE</CODE> </TD><TD> The path to the <CODE>mysql</CODE> history file. If this variable is set, its value overrides the default of <TT>`$HOME/.mysql_history'</TT>.
</TD></TR>
<TR><TD><CODE>MYSQL_HOST</CODE> </TD><TD> The default hostname used by the <CODE>mysql</CODE> command-line client.
</TD></TR>
<TR><TD><CODE>MYSQL_PS1</CODE> </TD><TD> The command prompt to use in the <CODE>mysql</CODE> command-line client.
</TD></TR>
<TR><TD><CODE>MYSQL_PWD</CODE> </TD><TD> The default password when connecting to <CODE>mysqld</CODE>. Note that use of this is insecure!  See section <A HREF="manual.html#Password_security">5.5.6  Keeping Your Password Secure</A>.
</TD></TR>
<TR><TD><CODE>MYSQL_TCP_PORT</CODE> </TD><TD> The default TCP/IP port number.
</TD></TR>
<TR><TD><CODE>MYSQL_UNIX_PORT</CODE> </TD><TD> The default Unix socket filename; used for connections to <CODE>localhost</CODE>.
</TD></TR>
<TR><TD><CODE>PATH</CODE> </TD><TD> Used by the shell to find MySQL programs.
</TD></TR>
<TR><TD><CODE>TMPDIR</CODE> </TD><TD> The directory where temporary files are created.
</TD></TR>
<TR><TD><CODE>TZ</CODE> </TD><TD> This should be set to your local time zone. See section <A HREF="manual.html#Timezone_problems">A.4.6  Time Zone Problems</A>.
</TD></TR>
<TR><TD><CODE>UMASK_DIR</CODE> </TD><TD> The user-directory creation mask when creating directories. Note that this is ANDed with <CODE>UMASK</CODE>!
</TD></TR>
<TR><TD><CODE>UMASK</CODE> </TD><TD> The user-file creation mask when creating files.
</TD></TR>
<TR><TD><CODE>USER</CODE> </TD><TD> The default username on Windows and NetWare to use when connecting to <CODE>mysqld</CODE>.
</TD></TR>
</TABLE>



<H1><A NAME="Regexp" HREF="manual_toc.html#Regexp">F  MySQL Regular Expressions</A></H1>

<P>
<A NAME="IDX2379"></A>
<A NAME="IDX2380"></A>
<A NAME="IDX2381"></A>

</P>
<P>
A regular expression is a powerful way of specifying a pattern for a complex
search.

</P>
<P>
MySQL uses Henry Spencer's implementation of regular expressions, which is
aimed at conformance with POSIX 1003.2.
See section <A HREF="manual.html#Credits">B  Credits</A>.
MySQL uses the extended version to support pattern-matching operations
performed with the <CODE>REGEXP</CODE> operator in SQL statements.
See section <A HREF="manual.html#Pattern_matching">3.3.4.7  Pattern Matching</A>.

</P>
<P>
This appendix is a summary, with examples, of the special characters and
constructs that can be used in MySQL for <CODE>REGEXP</CODE> operations.
It does not contain all the details that can be found in
Henry Spencer's <CODE>regex(7)</CODE> manual page. That manual page is
included in MySQL source distributions, in the <TT>`regex.7'</TT> file under the
<TT>`regex'</TT> directory.

</P>
<P>
A regular expression describes a set of strings. The simplest regular
expression is one that has no special characters in it. For example, the
regular expression <CODE>hello</CODE> matches <CODE>hello</CODE> and nothing else.

</P>
<P>
Non-trivial regular expressions use certain special constructs so that
they can match more than one string. For example, the regular expression
<CODE>hello|word</CODE> matches either the string <CODE>hello</CODE> or the string
<CODE>word</CODE>.

</P>
<P>
As a more complex example, the regular expression <CODE>B[an]*s</CODE> matches any
of the strings <CODE>Bananas</CODE>, <CODE>Baaaaas</CODE>, <CODE>Bs</CODE>, and any other
string starting with a <CODE>B</CODE>, ending with an <CODE>s</CODE>, and containing any
number of <CODE>a</CODE> or <CODE>n</CODE> characters in between.

</P>
<P>
A regular expression for the <CODE>REGEXP</CODE> operator may use any of the
following special characters and constructs:

</P>
<DL COMPACT>

<DT><CODE>^</CODE>
<DD>
Match the beginning of a string.

<PRE>
mysql&#62; SELECT 'fo\nfo' REGEXP '^fo$';                   -&#62; 0
mysql&#62; SELECT 'fofo' REGEXP '^fo';                      -&#62; 1
</PRE>

<DT><CODE>$</CODE>
<DD>
Match the end of a string.

<PRE>
mysql&#62; SELECT 'fo\no' REGEXP '^fo\no$';                 -&#62; 1
mysql&#62; SELECT 'fo\no' REGEXP '^fo$';                    -&#62; 0
</PRE>

<DT><CODE>.</CODE>
<DD>
Match any character (including carriage return and newline).

<PRE>
mysql&#62; SELECT 'fofo' REGEXP '^f.*$';                    -&#62; 1
mysql&#62; SELECT 'fo\r\nfo' REGEXP '^f.*$';                -&#62; 1
</PRE>

<DT><CODE>a*</CODE>
<DD>
Match any sequence of zero or more <CODE>a</CODE> characters.

<PRE>
mysql&#62; SELECT 'Ban' REGEXP '^Ba*n';                     -&#62; 1
mysql&#62; SELECT 'Baaan' REGEXP '^Ba*n';                   -&#62; 1
mysql&#62; SELECT 'Bn' REGEXP '^Ba*n';                      -&#62; 1
</PRE>

<DT><CODE>a+</CODE>
<DD>
Match any sequence of one or more <CODE>a</CODE> characters.

<PRE>
mysql&#62; SELECT 'Ban' REGEXP '^Ba+n';                     -&#62; 1
mysql&#62; SELECT 'Bn' REGEXP '^Ba+n';                      -&#62; 0
</PRE>

<DT><CODE>a?</CODE>
<DD>
Match either zero or one <CODE>a</CODE> character.

<PRE>
mysql&#62; SELECT 'Bn' REGEXP '^Ba?n';                      -&#62; 1
mysql&#62; SELECT 'Ban' REGEXP '^Ba?n';                     -&#62; 1
mysql&#62; SELECT 'Baan' REGEXP '^Ba?n';                    -&#62; 0
</PRE>

<DT><CODE>de|abc</CODE>
<DD>
Match either of the sequences <CODE>de</CODE> or <CODE>abc</CODE>.

<PRE>
mysql&#62; SELECT 'pi' REGEXP 'pi|apa';                     -&#62; 1
mysql&#62; SELECT 'axe' REGEXP 'pi|apa';                    -&#62; 0
mysql&#62; SELECT 'apa' REGEXP 'pi|apa';                    -&#62; 1
mysql&#62; SELECT 'apa' REGEXP '^(pi|apa)$';                -&#62; 1
mysql&#62; SELECT 'pi' REGEXP '^(pi|apa)$';                 -&#62; 1
mysql&#62; SELECT 'pix' REGEXP '^(pi|apa)$';                -&#62; 0
</PRE>

<DT><CODE>(abc)*</CODE>
<DD>
Match zero or more instances of the sequence <CODE>abc</CODE>.

<PRE>
mysql&#62; SELECT 'pi' REGEXP '^(pi)*$';                    -&#62; 1
mysql&#62; SELECT 'pip' REGEXP '^(pi)*$';                   -&#62; 0
mysql&#62; SELECT 'pipi' REGEXP '^(pi)*$';                  -&#62; 1
</PRE>

<DT><CODE>{1}</CODE>
<DD>
<DT><CODE>{2,3}</CODE>
<DD>
<CODE>{n}</CODE> or <CODE>{m,n}</CODE> notation provides
a more general way of writing regular expressions that match many
occurrences of the previous atom (or ``piece'') of the pattern.
<CODE>m</CODE> and <CODE>n</CODE> are integers.

<DL COMPACT>

<DT><CODE>a*</CODE>
<DD>
Can be written as <CODE>a{0,}</CODE>.
<DT><CODE>a+</CODE>
<DD>
Can be written as <CODE>a{1,}</CODE>.
<DT><CODE>a?</CODE>
<DD>
Can be written as <CODE>a{0,1}</CODE>.
</DL>

To be more precise, <CODE>a{n}</CODE> matches exactly <CODE>n</CODE> instances of
<CODE>a</CODE>.
<CODE>a{n,}</CODE> matches <CODE>n</CODE> or more instances of <CODE>a</CODE>.
<CODE>a{m,n}</CODE> matches <CODE>m</CODE> through <CODE>n</CODE> instances of <CODE>a</CODE>,
inclusive.

<CODE>m</CODE> and <CODE>n</CODE> must be in the range from <CODE>0</CODE> to
<CODE>RE_DUP_MAX</CODE> (default 255), inclusive.  If both <CODE>m</CODE> and <CODE>n</CODE>
are given, <CODE>m</CODE> must be less than or equal to <CODE>n</CODE>.


<PRE>
mysql&#62; SELECT 'abcde' REGEXP 'a[bcd]{2}e';              -&#62; 0
mysql&#62; SELECT 'abcde' REGEXP 'a[bcd]{3}e';              -&#62; 1
mysql&#62; SELECT 'abcde' REGEXP 'a[bcd]{1,10}e';           -&#62; 1
</PRE>

<DT><CODE>[a-dX]</CODE>
<DD>
<DT><CODE>[^a-dX]</CODE>
<DD>
Matches any character that is (or is not, if ^ is used) either <CODE>a</CODE>,
<CODE>b</CODE>, <CODE>c</CODE>, <CODE>d</CODE> or <CODE>X</CODE>.  A <CODE>-</CODE> character between two other
characters forms a range that matches all characters from the first
character to the second. For example, <CODE>[0-9]</CODE> matches any decimal
digit.  To include a literal <CODE>]</CODE> character, it must immediately follow
the opening bracket <CODE>[</CODE>.  To include a literal <CODE>-</CODE> character, it
must be written first or last.  Any character that does not have a defined
meaning inside a <CODE>[]</CODE> pair has no special meaning and matches only
itself.


<PRE>
mysql&#62; SELECT 'aXbc' REGEXP '[a-dXYZ]';                 -&#62; 1
mysql&#62; SELECT 'aXbc' REGEXP '^[a-dXYZ]$';               -&#62; 0
mysql&#62; SELECT 'aXbc' REGEXP '^[a-dXYZ]+$';              -&#62; 1
mysql&#62; SELECT 'aXbc' REGEXP '^[^a-dXYZ]+$';             -&#62; 0
mysql&#62; SELECT 'gheis' REGEXP '^[^a-dXYZ]+$';            -&#62; 1
mysql&#62; SELECT 'gheisa' REGEXP '^[^a-dXYZ]+$';           -&#62; 0
</PRE>

<DT><CODE>[.characters.]</CODE>
<DD>
Within a bracket expression (written using <CODE>[</CODE> and <CODE>]</CODE>),
matches the sequence of characters of that collating element. <CODE>characters</CODE>
is either a single character or a character name like <CODE>newline</CODE>.
You can find the full list of character names in <TT>`regexp/cname.h'</TT>.


<PRE>
mysql&#62; SELECT '~' REGEXP '[[.~.]]';                     -&#62; 1
mysql&#62; SELECT '~' REGEXP '[[.tilde.]]';                 -&#62; 1
</PRE>

<DT><CODE>[=character_class=]</CODE>
<DD>
Within a bracket expression (written using <CODE>[</CODE> and <CODE>]</CODE>),
<CODE>[=character_class=]</CODE> represents
an equivalence class. It matches all characters with the same collation
value, including itself.
For example, if <CODE>o</CODE> and <CODE>(+)</CODE> are the members of an
equivalence class, then <CODE>[[=o=]]</CODE>, <CODE>[[=(+)=]]</CODE>, and
<CODE>[o(+)]</CODE> are all synonymous.
An equivalence class may not be used as an endpoint of a range.

<DT><CODE>[:character_class:]</CODE>
<DD>
Within a bracket expression (written using <CODE>[</CODE> and <CODE>]</CODE>),
<CODE>[:character_class:]</CODE> represents a character class that matches all
characters belonging to that class. The standard class names are:

<TABLE BORDER WIDTH="100%">
<TR><TD><CODE>alnum</CODE> </TD><TD> Alphanumeric characters
</TD></TR>
<TR><TD><CODE>alpha</CODE> </TD><TD> Alphabetic characters
</TD></TR>
<TR><TD><CODE>blank</CODE> </TD><TD> Whitespace characters
</TD></TR>
<TR><TD><CODE>cntrl</CODE> </TD><TD> Control characters
</TD></TR>
<TR><TD><CODE>digit</CODE> </TD><TD> Digit characters
</TD></TR>
<TR><TD><CODE>graph</CODE> </TD><TD> Graphic characters
</TD></TR>
<TR><TD><CODE>lower</CODE> </TD><TD> Lowercase alphabetic characters
</TD></TR>
<TR><TD><CODE>print</CODE> </TD><TD> Graphic or space characters
</TD></TR>
<TR><TD><CODE>punct</CODE> </TD><TD> Punctuation characters
</TD></TR>
<TR><TD><CODE>space</CODE> </TD><TD> Space, tab, newline, and carriage return
</TD></TR>
<TR><TD><CODE>upper</CODE> </TD><TD> Uppercase alphabetic characters
</TD></TR>
<TR><TD><CODE>xdigit</CODE> </TD><TD> Hexadecimal digit characters
</TD></TR>
</TABLE>

These stand for the character classes defined in the <CODE>ctype(3)</CODE> manual
page. A particular locale may provide other class names.
A character class may not be used as an endpoint of a range.


<PRE>
mysql&#62; SELECT 'justalnums' REGEXP '[[:alnum:]]+';       -&#62; 1
mysql&#62; SELECT '!!' REGEXP '[[:alnum:]]+';               -&#62; 0
</PRE>

<DT><CODE>[[:&#60;:]]</CODE>
<DD>
<DT><CODE>[[:&#62;:]]</CODE>
<DD>
These markers stand for word boundaries. They match the beginning and end of
words, respectively.  A word is a sequence of word characters that is not
preceded by or followed by word characters. A word character is an
alphanumeric character in the <CODE>alnum</CODE> class or an underscore
(<CODE>_</CODE>).


<PRE>
mysql&#62; SELECT 'a word a' REGEXP '[[:&#60;:]]word[[:&#62;:]]';   -&#62; 1
mysql&#62; SELECT 'a xword a' REGEXP '[[:&#60;:]]word[[:&#62;:]]';  -&#62; 0
</PRE>

</DL>

<P>
To use a literal instance of a special character in a regular expression,
precede it by two backslash (\) characters. The MySQL parser
interprets one of the backslashes, and the regular expression library
interprets the other. For example, to match the string <CODE>1+2</CODE> that
contains the special <CODE>+</CODE> character, only the last of the following
regular expressions is the correct one:

</P>

<PRE>
mysql&#62; SELECT '1+2' REGEXP '1+2';                       -&#62; 0
mysql&#62; SELECT '1+2' REGEXP '1\+2';                      -&#62; 0
mysql&#62; SELECT '1+2' REGEXP '1\\+2';                     -&#62; 1
</PRE>



<H1><A NAME="GPL_license" HREF="manual_toc.html#GPL_license">G  GNU General Public License</A></H1>

<P>
<A NAME="IDX2382"></A>
<A NAME="IDX2383"></A>

</P>
<P>
Version 2, June 1991

</P>

<PRE>
Copyright &copy; 1989, 1991 Free Software Foundation, Inc.
59 Temple Place - Suite 330, Boston, MA  02111-1307, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</PRE>


<H2>22.4  Preamble</H2>

<P>
  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.

</P>
<P>
  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

</P>
<P>
  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

</P>
<P>
  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

</P>
<P>
  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

</P>
<P>
  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

</P>
<P>
  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

</P>
<P>
  The precise terms and conditions for copying, distribution and
modification follow.

</P>

<H2>22.5  TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</H2>


<OL>
<LI>

This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The ``Program'', below,
refers to any such program or work, and a ``work based on the Program''
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term ``modification''.)  Each licensee is addressed as ``you''.

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

<LI>

You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

<LI>

You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:


<OL>
<LI>

You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

<LI>

You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

<LI>

If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)
</OL>

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

<LI>

You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:


<OL>
<LI>

Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

<LI>

Accompany it with a written offer, valid for at least three
years, to give any third-party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

<LI>

Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)
</OL>

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

<LI>

You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

<LI>

You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

<LI>

Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

<LI>

If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

<LI>

If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

<LI>

The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and ``any
later version'', you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

<LI>

If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.



<P><STRONG>22.6  NO WARRANTY</STRONG></P>

<LI>

BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM ``AS IS'' WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

<LI>

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.
</OL>


<H2>22.7  END OF TERMS AND CONDITIONS</H2>


<H2>22.8  How to Apply These Terms to Your New Programs</H2>

<P>
  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

</P>
<P>
  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the ``copyright'' line and a pointer to where the full notice is found.

</P>

<PRE>
<VAR>one line to give the program's name and a brief idea of what it does.</VAR>
Copyright (C) <VAR>yyyy</VAR>  <VAR>name of author</VAR>

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
</PRE>

<P>
Also add information on how to contact you by electronic and paper mail.

</P>
<P>
If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

</P>

<PRE>
Gnomovision version 69, Copyright (C) 19<VAR>yy</VAR> <VAR>name of author</VAR>
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
This is free software, and you are welcome to redistribute it
under certain conditions; type `show c' for details.
</PRE>

<P>
The hypothetical commands <SAMP>`show w'</SAMP> and <SAMP>`show c'</SAMP> should show
the appropriate parts of the General Public License.  Of course, the
commands you use may be called something other than <SAMP>`show w'</SAMP> and
<SAMP>`show c'</SAMP>; they could even be mouse-clicks or menu items--whatever
suits your program.

</P>
<P>
You should also get your employer (if you work as a programmer) or your
school, if any, to sign a ``copyright disclaimer'' for the program, if
necessary.  Here is a sample; alter the names:

</P>

<PRE>
Yoyodyne, Inc., hereby disclaims all copyright interest in the program
`Gnomovision' (which makes passes at compilers) written by James Hacker.

<VAR>signature of Ty Coon</VAR>, 1 April 1989
Ty Coon, President of Vice
</PRE>

<P>
This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.

</P>



<H1><A NAME="Function_Index" HREF="manual_toc.html#Function_Index">SQL Command, Type, and Function Index</A></H1>

<P>
<H2> </H2>
<DIR>
<LI><A HREF="manual.html#IDX1239">! (logical NOT)</A>
<LI><A HREF="manual.html#IDX1211">!= (not equal)</A>
<LI><A HREF="manual.html#IDX1062">"</A>
<LI><A HREF="manual.html#IDX1354">% (modulo)</A>
<LI><A HREF="manual.html#IDX1032">% (wildcard character)</A>
<LI><A HREF="manual.html#IDX1440">&#38; (bitwise AND)</A>
<LI><A HREF="manual.html#IDX1241">&#38;& (logical AND)</A>
<LI><A HREF="manual.html#IDX1196">() (parentheses)</A>
<LI><A HREF="manual.html#IDX1029">(Control-Z) \z</A>
<LI><A HREF="manual.html#IDX1330">* (multiplication)</A>
<LI><A HREF="manual.html#IDX1323">+ (addition)</A>
<LI><A HREF="manual.html#IDX1325">- (subtraction)</A>
<LI><A HREF="manual.html#IDX1327">- (unary minus)</A>
<LI><A HREF="manual.html#IDX593">--password option</A>
<LI><A HREF="manual.html#IDX592">-p option</A>
<LI><A HREF="manual.html#IDX198">.my.cnf file</A>, <A HREF="manual.html#IDX464">.my.cnf file</A>, <A HREF="manual.html#IDX465">.my.cnf file</A>, <A HREF="manual.html#IDX531">.my.cnf file</A>, <A HREF="manual.html#IDX568">.my.cnf file</A>, <A HREF="manual.html#IDX594">.my.cnf file</A>, <A HREF="manual.html#IDX680">.my.cnf file</A>
<LI><A HREF="manual.html#IDX915">.mysql_history file</A>
<LI><A HREF="manual.html#IDX636">.pid (process ID) file</A>
<LI><A HREF="manual.html#IDX1332">/ (division)</A>
<LI><A HREF="manual.html#IDX516"><TT>`/etc/passwd'</TT></A>
<LI><A HREF="manual.html#IDX1553">/etc/passwd</A>
<LI><A HREF="manual.html#IDX1215">&#60; (less than)</A>
<LI><A HREF="manual.html#IDX450">&#60;&#60;</A>
<LI><A HREF="manual.html#IDX1444">&#60;&#60; (left shift)</A>
<LI><A HREF="manual.html#IDX1213">&#60;= (less than or equal)</A>
<LI><A HREF="manual.html#IDX1208">&#60;=&#62; (equal to)</A>
<LI><A HREF="manual.html#IDX1209">&#60;&#62; (not equal)</A>
<LI><A HREF="manual.html#IDX1205">= (equal)</A>
<LI><A HREF="manual.html#IDX1219">&#62; (greater than)</A>
<LI><A HREF="manual.html#IDX1217">&#62;= (greater than or equal)</A>
<LI><A HREF="manual.html#IDX1445">&#62;&#62; (right shift)</A>
<LI><A HREF="manual.html#IDX1015">\" (double quote)</A>
<LI><A HREF="manual.html#IDX1013">\' (single quote)</A>
<LI><A HREF="manual.html#IDX1011">\0 (ASCII 0)</A>
<LI><A HREF="manual.html#IDX1030">\\ (escape)</A>
<LI><A HREF="manual.html#IDX1017">\b (backspace)</A>
<LI><A HREF="manual.html#IDX1021">\n (linefeed)</A>
<LI><A HREF="manual.html#IDX1019">\n (newline)</A>
<LI><A HREF="manual.html#IDX1023">\r (carriage return)</A>
<LI><A HREF="manual.html#IDX1026">\t (tab)</A>
<LI><A HREF="manual.html#IDX1028">\z (Control-Z) ASCII 26</A>
<LI><A HREF="manual.html#IDX1442">^ (bitwise XOR)</A>
<LI><A HREF="manual.html#IDX1034">_ (wildcard character)</A>
<LI><A HREF="manual.html#IDX1061">`</A>
</DIR>
<H2>A</H2>
<DIR>
<LI><A HREF="manual.html#IDX1337">ABS()</A>
<LI><A HREF="manual.html#IDX1338">ACOS()</A>
<LI><A HREF="manual.html#IDX1372">ADDDATE()</A>
<LI><A HREF="manual.html#IDX1324">addition (+)</A>
<LI><A HREF="manual.html#IDX1373">ADDTIME()</A>
<LI><A HREF="manual.html#IDX1451">AES_DECRYPT()</A>
<LI><A HREF="manual.html#IDX1450">AES_ENCRYPT()</A>
<LI><A HREF="manual.html#IDX2282">alias</A>
<LI><A HREF="manual.html#IDX1598">ALTER COLUMN</A>
<LI><A HREF="manual.html#IDX1592">ALTER DATABASE</A>
<LI><A HREF="manual.html#IDX1993">ALTER FUNCTION</A>
<LI><A HREF="manual.html#IDX1992">ALTER PROCEDURE</A>
<LI><A HREF="manual.html#IDX1595">ALTER TABLE</A>, <A HREF="manual.html#IDX1612">ALTER TABLE</A>, <A HREF="manual.html#IDX2289">ALTER TABLE</A>
<LI><A HREF="manual.html#IDX1699">ANALYZE TABLE</A>
<LI><A HREF="manual.html#IDX1441">AND, bitwise</A>
<LI><A HREF="manual.html#IDX1240">AND, logical</A>
<LI><A HREF="manual.html#IDX1954">Area()</A>, <A HREF="manual.html#IDX1958">Area()</A>
<LI><A HREF="manual.html#IDX1435">arithmetic functions</A>
<LI><A HREF="manual.html#IDX1542">AS</A>, <A HREF="manual.html#IDX1568">AS</A>
<LI><A HREF="manual.html#IDX1932">AsBinary()</A>
<LI><A HREF="manual.html#IDX1258">ASCII()</A>
<LI><A HREF="manual.html#IDX1339">ASIN()</A>
<LI><A HREF="manual.html#IDX1933">AsText()</A>
<LI><A HREF="manual.html#IDX1340">ATAN()</A>
<LI><A HREF="manual.html#IDX1341">ATAN2()</A>
<LI><A HREF="manual.html#IDX1494">AVG()</A>
</DIR>
<H2>B</H2>
<DIR>
<LI><A HREF="manual.html#IDX1018">backspace (\b)</A>
<LI><A HREF="manual.html#IDX1700">BACKUP TABLE</A>
<LI><A HREF="manual.html#IDX1906">BdMPolyFromText()</A>
<LI><A HREF="manual.html#IDX1923">BdMPolyFromWKB()</A>
<LI><A HREF="manual.html#IDX1907">BdPolyFromText()</A>
<LI><A HREF="manual.html#IDX1924">BdPolyFromWKB()</A>
<LI><A HREF="manual.html#IDX1667">BEGIN</A>, <A HREF="manual.html#IDX2001">BEGIN</A>
<LI><A HREF="manual.html#IDX1465">BENCHMARK()</A>
<LI><A HREF="manual.html#IDX1226">BETWEEN ... AND</A>
<LI><A HREF="manual.html#IDX1109">BIGINT</A>
<LI><A HREF="manual.html#IDX1259">BIN()</A>
<LI><A HREF="manual.html#IDX1248">BINARY</A>
<LI><A HREF="manual.html#IDX1104">BIT</A>
<LI><A HREF="manual.html#IDX1495">BIT_AND()</A>
<LI><A HREF="manual.html#IDX449">BIT_COUNT</A>
<LI><A HREF="manual.html#IDX1447">BIT_COUNT()</A>
<LI><A HREF="manual.html#IDX1260">BIT_LENGTH()</A>
<LI><A HREF="manual.html#IDX448">BIT_OR</A>
<LI><A HREF="manual.html#IDX1496">BIT_OR()</A>
<LI><A HREF="manual.html#IDX1497">BIT_XOR()</A>
<LI><A HREF="manual.html#IDX1141">BLOB</A>, <A HREF="manual.html#IDX1166">BLOB</A>
<LI><A HREF="manual.html#IDX1103">BOOL</A>
<LI><A HREF="manual.html#IDX1102">BOOLEAN</A>
<LI><A HREF="manual.html#IDX1940">Boundary()</A>
<LI><A HREF="manual.html#IDX1963">Buffer()</A>
</DIR>
<H2>C</H2>
<DIR>
<LI><A HREF="manual.html#IDX679">C:\my.cnf file</A>
<LI><A HREF="manual.html#IDX1776">CACHE INDEX</A>
<LI><A HREF="manual.html#IDX2000">CALL</A>
<LI><A HREF="manual.html#IDX1025">carriage return (\r)</A>
<LI><A HREF="manual.html#IDX1251">CASE</A>, <A HREF="manual.html#IDX2013">CASE</A>
<LI><A HREF="manual.html#IDX1433">CAST</A>
<LI><A HREF="manual.html#IDX1245">casts</A>
<LI><A HREF="manual.html#IDX239">CC environment variable</A>, <A HREF="manual.html#IDX287">CC environment variable</A>, <A HREF="manual.html#IDX2339">CC environment variable</A>
<LI><A HREF="manual.html#IDX232"><CODE>CC</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX1342">CEILING()</A>
<LI><A HREF="manual.html#IDX1959">Centroid()</A>
<LI><A HREF="manual.html#IDX243">CFLAGS environment variable</A>, <A HREF="manual.html#IDX291">CFLAGS environment variable</A>, <A HREF="manual.html#IDX2341">CFLAGS environment variable</A>
<LI><A HREF="manual.html#IDX1798">CHANGE MASTER TO</A>
<LI><A HREF="manual.html#IDX1133">CHAR</A>, <A HREF="manual.html#IDX1164">CHAR</A>
<LI><A HREF="manual.html#IDX1136">CHAR VARYING</A>
<LI><A HREF="manual.html#IDX1261">CHAR()</A>
<LI><A HREF="manual.html#IDX1262">CHAR_LENGTH()</A>
<LI><A HREF="manual.html#IDX1134">CHARACTER</A>
<LI><A HREF="manual.html#IDX1135">CHARACTER VARYING</A>
<LI><A HREF="manual.html#IDX1263">CHARACTER_LENGTH()</A>
<LI><A HREF="manual.html#IDX1466">CHARSET()</A>
<LI><A HREF="manual.html#IDX1702">CHECK TABLE</A>
<LI><A HREF="manual.html#IDX1703">CHECKSUM TABLE</A>
<LI><A HREF="manual.html#IDX2011">CLOSE</A>
<LI><A HREF="manual.html#IDX1229">COALESCE()</A>
<LI><A HREF="manual.html#IDX1467">COERCIBILITY()</A>
<LI><A HREF="manual.html#IDX1468">COLLATION()</A>
<LI><A HREF="manual.html#IDX501">command-line options</A>
<LI><A HREF="manual.html#IDX1079">Comment syntax</A>
<LI><A HREF="manual.html#IDX132">COMMIT</A>, <A HREF="manual.html#IDX1668">COMMIT</A>
<LI><A HREF="manual.html#IDX1200">comparison operators</A>
<LI><A HREF="manual.html#IDX252">compiler flag, DONT_USE_DEFAULT_FIELDS</A>
<LI><A HREF="manual.html#IDX1264">COMPRESS()</A>
<LI><A HREF="manual.html#IDX1265">CONCAT()</A>
<LI><A HREF="manual.html#IDX1266">CONCAT_WS()</A>
<LI><A HREF="manual.html#IDX254">configure option, --with-charset</A>
<LI><A HREF="manual.html#IDX256">configure option, --with-collation</A>
<LI><A HREF="manual.html#IDX255">configure option, --with-extra-charsets</A>
<LI><A HREF="manual.html#IDX1469">CONNECTION_ID()</A>
<LI><A HREF="manual.html#IDX153">constraints</A>
<LI><A HREF="manual.html#IDX1978">Contains()</A>
<LI><A HREF="manual.html#IDX1249">control flow functions</A>
<LI><A HREF="manual.html#IDX1267">CONV()</A>
<LI><A HREF="manual.html#IDX1434">CONVERT</A>
<LI><A HREF="manual.html#IDX1620">CONVERT TO</A>
<LI><A HREF="manual.html#IDX1964">ConvexHull()</A>
<LI><A HREF="manual.html#IDX1343">COS()</A>
<LI><A HREF="manual.html#IDX1344">COT()</A>
<LI><A HREF="manual.html#IDX1498">COUNT()</A>
<LI><A HREF="manual.html#IDX1499">COUNT(DISTINCT)</A>
<LI><A HREF="manual.html#IDX1345">CRC32()</A>
<LI><A HREF="manual.html#IDX1624">CREATE DATABASE</A>
<LI><A HREF="manual.html#IDX1991">CREATE FUNCTION</A>, <A HREF="manual.html#IDX2200">CREATE FUNCTION</A>
<LI><A HREF="manual.html#IDX1626">CREATE INDEX</A>
<LI><A HREF="manual.html#IDX1990">CREATE PROCEDURE</A>
<LI><A HREF="manual.html#IDX1630">CREATE TABLE</A>
<LI><A HREF="manual.html#IDX1558">CROSS JOIN</A>
<LI><A HREF="manual.html#IDX1979">Crosses()</A>
<LI><A HREF="manual.html#IDX1374">CURDATE()</A>
<LI><A HREF="manual.html#IDX1375">CURRENT_DATE</A>
<LI><A HREF="manual.html#IDX1377">CURRENT_TIME</A>
<LI><A HREF="manual.html#IDX1378">CURRENT_TIMESTAMP</A>
<LI><A HREF="manual.html#IDX1470">CURRENT_USER()</A>
<LI><A HREF="manual.html#IDX1376">CURTIME()</A>
<LI><A HREF="manual.html#IDX234"><CODE>CXX</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX241">CXX environment variable</A>, <A HREF="manual.html#IDX277">CXX environment variable</A>, <A HREF="manual.html#IDX279">CXX environment variable</A>, <A HREF="manual.html#IDX289">CXX environment variable</A>, <A HREF="manual.html#IDX2337">CXX environment variable</A>
<LI><A HREF="manual.html#IDX245">CXXFLAGS environment variable</A>, <A HREF="manual.html#IDX249">CXXFLAGS environment variable</A>, <A HREF="manual.html#IDX293">CXXFLAGS environment variable</A>, <A HREF="manual.html#IDX2343">CXXFLAGS environment variable</A>
</DIR>
<H2>D</H2>
<DIR>
<LI><A HREF="manual.html#IDX1709">Database information, obtaining</A>
<LI><A HREF="manual.html#IDX1471">DATABASE()</A>
<LI><A HREF="manual.html#IDX1126">DATE</A>, <A HREF="manual.html#IDX1152">DATE</A>, <A HREF="manual.html#IDX2272">DATE</A>
<LI><A HREF="manual.html#IDX1370">date and time functions</A>
<LI><A HREF="manual.html#IDX1379">DATE()</A>
<LI><A HREF="manual.html#IDX1381">DATE_ADD()</A>
<LI><A HREF="manual.html#IDX1383">DATE_FORMAT()</A>
<LI><A HREF="manual.html#IDX1382">DATE_SUB()</A>
<LI><A HREF="manual.html#IDX1380">DATEDIFF()</A>
<LI><A HREF="manual.html#IDX1127">DATETIME</A>, <A HREF="manual.html#IDX1151">DATETIME</A>
<LI><A HREF="manual.html#IDX1384">DAY()</A>
<LI><A HREF="manual.html#IDX1385">DAYNAME()</A>
<LI><A HREF="manual.html#IDX1386">DAYOFMONTH()</A>
<LI><A HREF="manual.html#IDX1387">DAYOFWEEK()</A>
<LI><A HREF="manual.html#IDX1388">DAYOFYEAR()</A>
<LI><A HREF="manual.html#IDX1041">DBI-&#62;quote</A>
<LI><A HREF="manual.html#IDX2324">DBI-&#62;trace</A>
<LI><A HREF="manual.html#IDX2326">DBI_TRACE environment variable</A>, <A HREF="manual.html#IDX2347">DBI_TRACE environment variable</A>
<LI><A HREF="manual.html#IDX2345">DBI_USER environment variable</A>
<LI><A HREF="manual.html#IDX1123">DEC</A>
<LI><A HREF="manual.html#IDX1122">DECIMAL</A>
<LI><A HREF="manual.html#IDX2003">DECLARE</A>
<LI><A HREF="manual.html#IDX1452">DECODE()</A>
<LI><A HREF="manual.html#IDX1346">DEGREES()</A>
<LI><A HREF="manual.html#IDX1530">DELAYED</A>
<LI><A HREF="manual.html#IDX1519">DELETE</A>
<LI><A HREF="manual.html#IDX1454">DES_DECRYPT()</A>
<LI><A HREF="manual.html#IDX1455">DES_ENCRYPT()</A>
<LI><A HREF="manual.html#IDX1659">DESC</A>
<LI><A HREF="manual.html#IDX435">DESCRIBE</A>, <A HREF="manual.html#IDX1660">DESCRIBE</A>
<LI><A HREF="manual.html#IDX1965">Difference()</A>
<LI><A HREF="manual.html#IDX1936">Dimension()</A>
<LI><A HREF="manual.html#IDX1621">DISCARD TABLESPACE</A>, <A HREF="manual.html#IDX1870">DISCARD TABLESPACE</A>
<LI><A HREF="manual.html#IDX1980">Disjoint()</A>
<LI><A HREF="manual.html#IDX1981">Distance()</A>
<LI><A HREF="manual.html#IDX414">DISTINCT</A>, <A HREF="manual.html#IDX734">DISTINCT</A>, <A HREF="manual.html#IDX1500">DISTINCT</A>
<LI><A HREF="manual.html#IDX1334">DIV</A>
<LI><A HREF="manual.html#IDX1333">division (/)</A>
<LI><A HREF="manual.html#IDX1520">DO</A>
<LI><A HREF="manual.html#IDX251">DONT_USE_DEFAULT_FIELDS compiler flag</A>
<LI><A HREF="manual.html#IDX1118">DOUBLE</A>
<LI><A HREF="manual.html#IDX1120">DOUBLE PRECISION</A>
<LI><A HREF="manual.html#IDX1016">double quote (\")</A>
<LI><A HREF="manual.html#IDX1648">DROP DATABASE</A>
<LI><A HREF="manual.html#IDX1617">DROP FOREIGN KEY</A>, <A HREF="manual.html#IDX1867">DROP FOREIGN KEY</A>
<LI><A HREF="manual.html#IDX1995">DROP FUNCTION</A>, <A HREF="manual.html#IDX2201">DROP FUNCTION</A>
<LI><A HREF="manual.html#IDX1603">DROP INDEX</A>, <A HREF="manual.html#IDX1652">DROP INDEX</A>
<LI><A HREF="manual.html#IDX1606">DROP PRIMARY KEY</A>
<LI><A HREF="manual.html#IDX1994">DROP PROCEDURE</A>
<LI><A HREF="manual.html#IDX1655">DROP TABLE</A>
<LI><A HREF="manual.html#IDX1676">DROP USER</A>
<LI><A HREF="manual.html#IDX1554">DUMPFILE</A>
</DIR>
<H2>E</H2>
<DIR>
<LI><A HREF="manual.html#IDX1268">ELT()</A>
<LI><A HREF="manual.html#IDX1453">ENCODE()</A>
<LI><A HREF="manual.html#IDX1456">ENCRYPT()</A>
<LI><A HREF="manual.html#IDX1448">encryption functions</A>
<LI><A HREF="manual.html#IDX2002">END</A>
<LI><A HREF="manual.html#IDX1945">EndPoint()</A>
<LI><A HREF="manual.html#IDX1147">ENUM</A>, <A HREF="manual.html#IDX1172">ENUM</A>
<LI><A HREF="manual.html#IDX1937">Envelope()</A>
<LI><A HREF="manual.html#IDX240">environment variable, CC</A>, <A HREF="manual.html#IDX288">environment variable, CC</A>
<LI><A HREF="manual.html#IDX2340">Environment variable, CC</A>
<LI><A HREF="manual.html#IDX233">environment variable, <CODE>CC</CODE></A>
<LI><A HREF="manual.html#IDX244">environment variable, CFLAGS</A>, <A HREF="manual.html#IDX292">environment variable, CFLAGS</A>
<LI><A HREF="manual.html#IDX2342">Environment variable, CFLAGS</A>
<LI><A HREF="manual.html#IDX235">environment variable, <CODE>CXX</CODE></A>
<LI><A HREF="manual.html#IDX278">Environment variable, CXX</A>, <A HREF="manual.html#IDX2338">Environment variable, CXX</A>
<LI><A HREF="manual.html#IDX242">environment variable, CXX</A>, <A HREF="manual.html#IDX290">environment variable, CXX</A>
<LI><A HREF="manual.html#IDX246">environment variable, CXXFLAGS</A>, <A HREF="manual.html#IDX250">environment variable, CXXFLAGS</A>, <A HREF="manual.html#IDX294">environment variable, CXXFLAGS</A>
<LI><A HREF="manual.html#IDX2344">Environment variable, CXXFLAGS</A>
<LI><A HREF="manual.html#IDX2327">Environment variable, DBI_TRACE</A>, <A HREF="manual.html#IDX2348">Environment variable, DBI_TRACE</A>
<LI><A HREF="manual.html#IDX2346">Environment variable, DBI_USER</A>
<LI><A HREF="manual.html#IDX912">environment variable, <CODE>HOME</CODE></A>
<LI><A HREF="manual.html#IDX2350">Environment variable, HOME</A>
<LI><A HREF="manual.html#IDX383">Environment variable, LD_LIBRARY_PATH</A>
<LI><A HREF="manual.html#IDX381">Environment variable, LD_RUN_PATH</A>, <A HREF="manual.html#IDX2352">Environment variable, LD_RUN_PATH</A>
<LI><A HREF="manual.html#IDX364">environment variable, LD_RUN_PATH</A>, <A HREF="manual.html#IDX371">environment variable, LD_RUN_PATH</A>
<LI><A HREF="manual.html#IDX2331">Environment variable, MYSQL_DEBUG</A>, <A HREF="manual.html#IDX2354">Environment variable, MYSQL_DEBUG</A>
<LI><A HREF="manual.html#IDX844">environment variable, <CODE>MYSQL_DEBUG</CODE></A>
<LI><A HREF="manual.html#IDX2356">Environment variable, MYSQL_HISTFILE</A>
<LI><A HREF="manual.html#IDX910">environment variable, <CODE>MYSQL_HISTFILE</CODE></A>
<LI><A HREF="manual.html#IDX533">environment variable, <CODE>MYSQL_HOST</CODE></A>
<LI><A HREF="manual.html#IDX2358">Environment variable, MYSQL_HOST</A>
<LI><A HREF="manual.html#IDX2360">Environment variable, MYSQL_PS1</A>
<LI><A HREF="manual.html#IDX2362">Environment variable, MYSQL_PWD</A>
<LI><A HREF="manual.html#IDX535">environment variable, <CODE>MYSQL_PWD</CODE></A>, <A HREF="manual.html#IDX842">environment variable, <CODE>MYSQL_PWD</CODE></A>
<LI><A HREF="manual.html#IDX678">environment variable, MYSQL_TCP_PORT</A>
<LI><A HREF="manual.html#IDX674">environment variable, <CODE>MYSQL_TCP_PORT</CODE></A>, <A HREF="manual.html#IDX840">environment variable, <CODE>MYSQL_TCP_PORT</CODE></A>
<LI><A HREF="manual.html#IDX2364">Environment variable, MYSQL_TCP_PORT</A>
<LI><A HREF="manual.html#IDX677">environment variable, MYSQL_UNIX_PORT</A>
<LI><A HREF="manual.html#IDX673">environment variable, <CODE>MYSQL_UNIX_PORT</CODE></A>, <A HREF="manual.html#IDX838">environment variable, <CODE>MYSQL_UNIX_PORT</CODE></A>
<LI><A HREF="manual.html#IDX320">Environment variable, MYSQL_UNIX_PORT</A>, <A HREF="manual.html#IDX2366">Environment variable, MYSQL_UNIX_PORT</A>
<LI><A HREF="manual.html#IDX211">environment variable, PATH</A>
<LI><A HREF="manual.html#IDX2368">Environment variable, PATH</A>
<LI><A HREF="manual.html#IDX319">Environment variable, TMPDIR</A>, <A HREF="manual.html#IDX2370">Environment variable, TMPDIR</A>
<LI><A HREF="manual.html#IDX2267">Environment variable, TZ</A>, <A HREF="manual.html#IDX2372">Environment variable, TZ</A>
<LI><A HREF="manual.html#IDX2251">Environment variable, UMASK</A>, <A HREF="manual.html#IDX2376">Environment variable, UMASK</A>
<LI><A HREF="manual.html#IDX2253">Environment variable, UMASK_DIR</A>, <A HREF="manual.html#IDX2374">Environment variable, UMASK_DIR</A>
<LI><A HREF="manual.html#IDX2378">Environment variable, USER</A>
<LI><A HREF="manual.html#IDX537">environment variable, <CODE>USER</CODE></A>
<LI><A HREF="manual.html#IDX280">Environment variables, CXX</A>
<LI><A HREF="manual.html#IDX1206">equal (=)</A>
<LI><A HREF="manual.html#IDX1982">Equals()</A>
<LI><A HREF="manual.html#IDX1031">escape (\\)</A>
<LI><A HREF="manual.html#IDX1347">EXP()</A>
<LI><A HREF="manual.html#IDX714">EXPLAIN</A>
<LI><A HREF="manual.html#IDX1269">EXPORT_SET()</A>
<LI><A HREF="manual.html#IDX1955">ExteriorRing()</A>
<LI><A HREF="manual.html#IDX1389">EXTRACT()</A>
</DIR>
<H2>F</H2>
<DIR>
<LI><A HREF="manual.html#IDX1048">FALSE</A>
<LI><A HREF="manual.html#IDX2010">FETCH</A>
<LI><A HREF="manual.html#IDX1270">FIELD()</A>
<LI><A HREF="manual.html#IDX1278">FILE</A>
<LI><A HREF="manual.html#IDX1271">FIND_IN_SET()</A>
<LI><A HREF="manual.html#IDX1125">FIXED</A>
<LI><A HREF="manual.html#IDX1112">FLOAT</A>, <A HREF="manual.html#IDX1116">FLOAT</A>
<LI><A HREF="manual.html#IDX1117">FLOAT(M,D)</A>
<LI><A HREF="manual.html#IDX1113">FLOAT(p)</A>, <A HREF="manual.html#IDX1119">FLOAT(p)</A>
<LI><A HREF="manual.html#IDX1348">FLOOR()</A>
<LI><A HREF="manual.html#IDX1779">FLUSH</A>
<LI><A HREF="manual.html#IDX1547">FORCE INDEX</A>, <A HREF="manual.html#IDX1576">FORCE INDEX</A>
<LI><A HREF="manual.html#IDX1548">FORCE KEY</A>, <A HREF="manual.html#IDX1579">FORCE KEY</A>
<LI><A HREF="manual.html#IDX1482">FORMAT()</A>
<LI><A HREF="manual.html#IDX1472">FOUND_ROWS()</A>
<LI><A HREF="manual.html#IDX1541">FROM</A>
<LI><A HREF="manual.html#IDX1390">FROM_DAYS()</A>
<LI><A HREF="manual.html#IDX1391">FROM_UNIXTIME()</A>
<LI><A HREF="manual.html#IDX1436">functions, arithmetic</A>
<LI><A HREF="manual.html#IDX1437">functions, bit</A>
<LI><A HREF="manual.html#IDX1250">functions, control flow</A>
<LI><A HREF="manual.html#IDX1371">functions, date and time</A>
<LI><A HREF="manual.html#IDX1449">functions, encryption</A>
<LI><A HREF="manual.html#IDX1493">functions, GROUP BY</A>
<LI><A HREF="manual.html#IDX1464">functions, information</A>
<LI><A HREF="manual.html#IDX1336">functions, mathematical</A>
<LI><A HREF="manual.html#IDX1481">functions, miscellaneous</A>
<LI><A HREF="manual.html#IDX1257">functions, string</A>
<LI><A HREF="manual.html#IDX1309">functions, string comparison</A>
<LI><A HREF="manual.html#IDX2206">Functions, user-defined</A>
</DIR>
<H2>G</H2>
<DIR>
<LI><A HREF="manual.html#IDX1891">GeomCollFromText()</A>
<LI><A HREF="manual.html#IDX1908">GeomCollFromWKB()</A>
<LI><A HREF="manual.html#IDX1883">GEOMETRY</A>
<LI><A HREF="manual.html#IDX1890">GEOMETRYCOLLECTION</A>
<LI><A HREF="manual.html#IDX1925">GeometryCollection()</A>
<LI><A HREF="manual.html#IDX1892">GeometryCollectionFromText()</A>
<LI><A HREF="manual.html#IDX1909">GeometryCollectionFromWKB()</A>
<LI><A HREF="manual.html#IDX1894">GeometryFromText()</A>
<LI><A HREF="manual.html#IDX1911">GeometryFromWKB()</A>
<LI><A HREF="manual.html#IDX1961">GeometryN()</A>
<LI><A HREF="manual.html#IDX1938">GeometryType()</A>
<LI><A HREF="manual.html#IDX1893">GeomFromText()</A>, <A HREF="manual.html#IDX1934">GeomFromText()</A>
<LI><A HREF="manual.html#IDX1910">GeomFromWKB()</A>, <A HREF="manual.html#IDX1935">GeomFromWKB()</A>
<LI><A HREF="manual.html#IDX1392">GET_FORMAT()</A>
<LI><A HREF="manual.html#IDX1484">GET_LOCK()</A>
<LI><A HREF="manual.html#IDX1946">GLength()</A>, <A HREF="manual.html#IDX1952">GLength()</A>
<LI><A HREF="manual.html#IDX1685">GRANT</A>
<LI><A HREF="manual.html#IDX571">GRANT statement</A>, <A HREF="manual.html#IDX601">GRANT statement</A>
<LI><A HREF="manual.html#IDX1751">GRANTS</A>
<LI><A HREF="manual.html#IDX1220">greater than (&#62;)</A>
<LI><A HREF="manual.html#IDX1218">greater than or equal (&#62;=)</A>
<LI><A HREF="manual.html#IDX1230">GREATEST()</A>
<LI><A HREF="manual.html#IDX1492">GROUP BY functions</A>
<LI><A HREF="manual.html#IDX1501">GROUP_CONCAT()</A>
</DIR>
<H2>H</H2>
<DIR>
<LI><A HREF="manual.html#IDX1521">HANDLER</A>
<LI><A HREF="manual.html#IDX1272">HEX()</A>
<LI><A HREF="manual.html#IDX1049">hexadecimal values</A>
<LI><A HREF="manual.html#IDX911"><CODE>HOME</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2349">HOME environment variable</A>
<LI><A HREF="manual.html#IDX307">host.frm, problems finding</A>
<LI><A HREF="manual.html#IDX1393">HOUR()</A>
</DIR>
<H2>I</H2>
<DIR>
<LI><A HREF="manual.html#IDX1059">identifiers, quoting</A>
<LI><A HREF="manual.html#IDX2012">IF</A>
<LI><A HREF="manual.html#IDX1252">IF()</A>
<LI><A HREF="manual.html#IDX1254">IFNULL()</A>
<LI><A HREF="manual.html#IDX1545">IGNORE INDEX</A>, <A HREF="manual.html#IDX1575">IGNORE INDEX</A>
<LI><A HREF="manual.html#IDX1546">IGNORE KEY</A>, <A HREF="manual.html#IDX1578">IGNORE KEY</A>
<LI><A HREF="manual.html#IDX1622">IMPORT TABLESPACE</A>, <A HREF="manual.html#IDX1871">IMPORT TABLESPACE</A>
<LI><A HREF="manual.html#IDX1231">IN</A>
<LI><A HREF="manual.html#IDX1485">INET_ATON()</A>
<LI><A HREF="manual.html#IDX1486">INET_NTOA()</A>
<LI><A HREF="manual.html#IDX1463">information functions</A>
<LI><A HREF="manual.html#IDX1557">INNER JOIN</A>
<LI><A HREF="manual.html#IDX741">INSERT</A>, <A HREF="manual.html#IDX1522">INSERT</A>
<LI><A HREF="manual.html#IDX1528">INSERT ... SELECT</A>
<LI><A HREF="manual.html#IDX1529">INSERT DELAYED</A>
<LI><A HREF="manual.html#IDX578">INSERT statement, grant privileges</A>
<LI><A HREF="manual.html#IDX1273">INSERT()</A>
<LI><A HREF="manual.html#IDX1274">INSTR()</A>
<LI><A HREF="manual.html#IDX1107">INT</A>
<LI><A HREF="manual.html#IDX1108">INTEGER</A>
<LI><A HREF="manual.html#IDX1956">InteriorRingN()</A>
<LI><A HREF="manual.html#IDX1966">Intersection()</A>
<LI><A HREF="manual.html#IDX1983">Intersects()</A>
<LI><A HREF="manual.html#IDX1234">INTERVAL()</A>
<LI><A HREF="manual.html#IDX1223">IS NOT NULL</A>
<LI><A HREF="manual.html#IDX732">IS NULL</A>, <A HREF="manual.html#IDX1222">IS NULL</A>
<LI><A HREF="manual.html#IDX782">IS NULL, and indexes</A>
<LI><A HREF="manual.html#IDX1487">IS_FREE_LOCK()</A>
<LI><A HREF="manual.html#IDX1488">IS_USED_LOCK()</A>
<LI><A HREF="manual.html#IDX1947">IsClosed()</A>, <A HREF="manual.html#IDX1953">IsClosed()</A>
<LI><A HREF="manual.html#IDX1941">IsEmpty()</A>
<LI><A HREF="manual.html#IDX1233">ISNULL()</A>
<LI><A HREF="manual.html#IDX1675">ISOLATION LEVEL</A>
<LI><A HREF="manual.html#IDX1951">IsRing()</A>
<LI><A HREF="manual.html#IDX1942">IsSimple()</A>
<LI><A HREF="manual.html#IDX2016">ITERATE</A>
</DIR>
<H2>J</H2>
<DIR>
<LI><A HREF="manual.html#IDX1556">JOIN</A>
</DIR>
<H2>K</H2>
<DIR>
<LI><A HREF="manual.html#IDX1783">KILL</A>
</DIR>
<H2>L</H2>
<DIR>
<LI><A HREF="manual.html#IDX1394">LAST_DAY()</A>
<LI><A HREF="manual.html#IDX142">LAST_INSERT_ID()</A>, <A HREF="manual.html#IDX1524">LAST_INSERT_ID()</A>
<LI><A HREF="manual.html#IDX1474">LAST_INSERT_ID([expr])</A>
<LI><A HREF="manual.html#IDX1275">LCASE()</A>
<LI><A HREF="manual.html#IDX382">LD_LIBRARY_PATH environment variable</A>
<LI><A HREF="manual.html#IDX363">LD_RUN_PATH environment variable</A>, <A HREF="manual.html#IDX370">LD_RUN_PATH environment variable</A>, <A HREF="manual.html#IDX380">LD_RUN_PATH environment variable</A>, <A HREF="manual.html#IDX2351">LD_RUN_PATH environment variable</A>
<LI><A HREF="manual.html#IDX1235">LEAST()</A>
<LI><A HREF="manual.html#IDX2015">LEAVE</A>
<LI><A HREF="manual.html#IDX736">LEFT JOIN</A>, <A HREF="manual.html#IDX1559">LEFT JOIN</A>
<LI><A HREF="manual.html#IDX1560">LEFT OUTER JOIN</A>
<LI><A HREF="manual.html#IDX1276">LEFT()</A>
<LI><A HREF="manual.html#IDX1277">LENGTH()</A>
<LI><A HREF="manual.html#IDX1216">less than (&#60;)</A>
<LI><A HREF="manual.html#IDX1214">less than or equal (&#60;=)</A>
<LI><A HREF="manual.html#IDX1312">LIKE</A>
<LI><A HREF="manual.html#IDX778">LIKE, and indexes</A>
<LI><A HREF="manual.html#IDX779">LIKE, and wildcards</A>
<LI><A HREF="manual.html#IDX738">LIMIT</A>, <A HREF="manual.html#IDX1473">LIMIT</A>
<LI><A HREF="manual.html#IDX1022">linefeed (\n)</A>
<LI><A HREF="manual.html#IDX1895">LineFromText()</A>
<LI><A HREF="manual.html#IDX1912">LineFromWKB()</A>
<LI><A HREF="manual.html#IDX1885">LINESTRING</A>
<LI><A HREF="manual.html#IDX1926">LineString()</A>
<LI><A HREF="manual.html#IDX1896">LineStringFromText()</A>
<LI><A HREF="manual.html#IDX1913">LineStringFromWKB()</A>
<LI><A HREF="manual.html#IDX1349">LN()</A>
<LI><A HREF="manual.html#IDX1799">LOAD DATA FROM MASTER</A>
<LI><A HREF="manual.html#IDX1534">LOAD DATA INFILE</A>, <A HREF="manual.html#IDX2277">LOAD DATA INFILE</A>
<LI><A HREF="manual.html#IDX1800">LOAD TABLE FROM MASTER</A>
<LI><A HREF="manual.html#IDX1279">LOAD_FILE()</A>
<LI><A HREF="manual.html#IDX1395">LOCALTIME</A>
<LI><A HREF="manual.html#IDX1396">LOCALTIMESTAMP</A>
<LI><A HREF="manual.html#IDX1280">LOCATE()</A>
<LI><A HREF="manual.html#IDX1672">LOCK TABLES</A>
<LI><A HREF="manual.html#IDX1350">LOG()</A>
<LI><A HREF="manual.html#IDX1352">LOG10()</A>
<LI><A HREF="manual.html#IDX1351">LOG2()</A>
<LI><A HREF="manual.html#IDX1236">logical operators</A>
<LI><A HREF="manual.html#IDX1168">LONG</A>
<LI><A HREF="manual.html#IDX1145">LONGBLOB</A>
<LI><A HREF="manual.html#IDX1146">LONGTEXT</A>
<LI><A HREF="manual.html#IDX2014">LOOP</A>
<LI><A HREF="manual.html#IDX1281">LOWER()</A>
<LI><A HREF="manual.html#IDX1282">LPAD()</A>
<LI><A HREF="manual.html#IDX1283">LTRIM()</A>
</DIR>
<H2>M</H2>
<DIR>
<LI><A HREF="manual.html#IDX1284">MAKE_SET()</A>
<LI><A HREF="manual.html#IDX1397">MAKEDATE()</A>
<LI><A HREF="manual.html#IDX1398">MAKETIME()</A>
<LI><A HREF="manual.html#IDX1489">MASTER_POS_WAIT()</A>, <A HREF="manual.html#IDX1801">MASTER_POS_WAIT()</A>
<LI><A HREF="manual.html#IDX1432">MATCH ... AGAINST()</A>
<LI><A HREF="manual.html#IDX1335">mathematical functions</A>
<LI><A HREF="manual.html#IDX1503">MAX()</A>
<LI><A HREF="manual.html#IDX1971">MBRContains()</A>
<LI><A HREF="manual.html#IDX1972">MBRDisjoint()</A>
<LI><A HREF="manual.html#IDX1973">MBREqual()</A>
<LI><A HREF="manual.html#IDX1974">MBRIntersects()</A>
<LI><A HREF="manual.html#IDX1975">MBROverlaps()</A>
<LI><A HREF="manual.html#IDX1976">MBRTouches()</A>
<LI><A HREF="manual.html#IDX1977">MBRWithin()</A>
<LI><A HREF="manual.html#IDX1457">MD5()</A>
<LI><A HREF="manual.html#IDX1143">MEDIUMBLOB</A>
<LI><A HREF="manual.html#IDX1106">MEDIUMINT</A>
<LI><A HREF="manual.html#IDX1144">MEDIUMTEXT</A>
<LI><A HREF="manual.html#IDX1399">MICROSECOND()</A>
<LI><A HREF="manual.html#IDX1285">MID()</A>
<LI><A HREF="manual.html#IDX1502">MIN()</A>
<LI><A HREF="manual.html#IDX1328">minus, unary (-)</A>
<LI><A HREF="manual.html#IDX1400">MINUTE()</A>
<LI><A HREF="manual.html#IDX1480">miscellaneous functions</A>
<LI><A HREF="manual.html#IDX1897">MLineFromText()</A>
<LI><A HREF="manual.html#IDX1914">MLineFromWKB()</A>
<LI><A HREF="manual.html#IDX1355">MOD (modulo)</A>
<LI><A HREF="manual.html#IDX1353">MOD()</A>
<LI><A HREF="manual.html#IDX1356">modulo (%)</A>
<LI><A HREF="manual.html#IDX1357">modulo (MOD)</A>
<LI><A HREF="manual.html#IDX1401">MONTH()</A>
<LI><A HREF="manual.html#IDX1402">MONTHNAME()</A>
<LI><A HREF="manual.html#IDX1899">MPointFromText()</A>
<LI><A HREF="manual.html#IDX1916">MPointFromWKB()</A>
<LI><A HREF="manual.html#IDX1901">MPolyFromText()</A>
<LI><A HREF="manual.html#IDX1918">MPolyFromWKB()</A>
<LI><A HREF="manual.html#IDX1888">MULTILINESTRING</A>
<LI><A HREF="manual.html#IDX1927">MultiLineString()</A>
<LI><A HREF="manual.html#IDX1898">MultiLineStringFromText()</A>
<LI><A HREF="manual.html#IDX1915">MultiLineStringFromWKB()</A>
<LI><A HREF="manual.html#IDX1331">multiplication (*)</A>
<LI><A HREF="manual.html#IDX1887">MULTIPOINT</A>
<LI><A HREF="manual.html#IDX1928">MultiPoint()</A>
<LI><A HREF="manual.html#IDX1900">MultiPointFromText()</A>
<LI><A HREF="manual.html#IDX1917">MultiPointFromWKB()</A>
<LI><A HREF="manual.html#IDX1889">MULTIPOLYGON</A>
<LI><A HREF="manual.html#IDX1929">MultiPolygon()</A>
<LI><A HREF="manual.html#IDX1902">MultiPolygonFromText()</A>
<LI><A HREF="manual.html#IDX1919">MultiPolygonFromWKB()</A>
<LI><A HREF="manual.html#IDX2132"><CODE>my_init()</CODE></A>
<LI><A HREF="manual.html#IDX2034">my_ulonglong C type</A>
<LI><A HREF="manual.html#IDX2035">my_ulonglong values, printing</A>
<LI><A HREF="manual.html#IDX2104">MySQL C type</A>
<LI><A HREF="manual.html#IDX2029">MYSQL C type</A>
<LI><A HREF="manual.html#IDX2038"><CODE>mysql_affected_rows()</CODE></A>
<LI><A HREF="manual.html#IDX2099"><CODE>mysql_autocommit()</CODE>.</A>
<LI><A HREF="manual.html#IDX2103">MYSQL_BIND C type</A>
<LI><A HREF="manual.html#IDX2039"><CODE>mysql_change_user()</CODE></A>
<LI><A HREF="manual.html#IDX2040"><CODE>mysql_character_set_name()</CODE></A>
<LI><A HREF="manual.html#IDX2041"><CODE>mysql_close()</CODE></A>
<LI><A HREF="manual.html#IDX2097"><CODE>mysql_commit()</CODE>.</A>
<LI><A HREF="manual.html#IDX2042"><CODE>mysql_connect()</CODE></A>
<LI><A HREF="manual.html#IDX2043"><CODE>mysql_create_db()</CODE></A>
<LI><A HREF="manual.html#IDX2044"><CODE>mysql_data_seek()</CODE></A>
<LI><A HREF="manual.html#IDX843"><CODE>MYSQL_DEBUG</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2330">MYSQL_DEBUG environment variable</A>, <A HREF="manual.html#IDX2353">MYSQL_DEBUG environment variable</A>
<LI><A HREF="manual.html#IDX2045"><CODE>mysql_debug()</CODE></A>
<LI><A HREF="manual.html#IDX2046"><CODE>mysql_drop_db()</CODE></A>
<LI><A HREF="manual.html#IDX2047"><CODE>mysql_dump_debug_info()</CODE></A>
<LI><A HREF="manual.html#IDX2048"><CODE>mysql_eof()</CODE></A>
<LI><A HREF="manual.html#IDX2049"><CODE>mysql_errno()</CODE></A>
<LI><A HREF="manual.html#IDX2050"><CODE>mysql_error()</CODE></A>
<LI><A HREF="manual.html#IDX2051"><CODE>mysql_escape_string()</CODE></A>
<LI><A HREF="manual.html#IDX2052"><CODE>mysql_fetch_field()</CODE></A>
<LI><A HREF="manual.html#IDX2054"><CODE>mysql_fetch_field_direct()</CODE></A>
<LI><A HREF="manual.html#IDX2053"><CODE>mysql_fetch_fields()</CODE></A>
<LI><A HREF="manual.html#IDX2055"><CODE>mysql_fetch_lengths()</CODE></A>
<LI><A HREF="manual.html#IDX2056"><CODE>mysql_fetch_row()</CODE></A>
<LI><A HREF="manual.html#IDX2032">MYSQL_FIELD C type</A>
<LI><A HREF="manual.html#IDX2057"><CODE>mysql_field_count()</CODE></A>, <A HREF="manual.html#IDX2076"><CODE>mysql_field_count()</CODE></A>
<LI><A HREF="manual.html#IDX2033">MYSQL_FIELD_OFFSET C type</A>
<LI><A HREF="manual.html#IDX2058"><CODE>mysql_field_seek()</CODE></A>
<LI><A HREF="manual.html#IDX2059"><CODE>mysql_field_tell()</CODE></A>
<LI><A HREF="manual.html#IDX2060"><CODE>mysql_free_result()</CODE></A>
<LI><A HREF="manual.html#IDX2061"><CODE>mysql_get_client_info()</CODE></A>
<LI><A HREF="manual.html#IDX2062"><CODE>mysql_get_client_version()</CODE></A>
<LI><A HREF="manual.html#IDX2063"><CODE>mysql_get_host_info()</CODE></A>
<LI><A HREF="manual.html#IDX2064"><CODE>mysql_get_proto_info()</CODE></A>
<LI><A HREF="manual.html#IDX2065"><CODE>mysql_get_server_info()</CODE></A>
<LI><A HREF="manual.html#IDX2066"><CODE>mysql_get_server_version()</CODE></A>
<LI><A HREF="manual.html#IDX909"><CODE>MYSQL_HISTFILE</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2355">MYSQL_HISTFILE environment variable</A>
<LI><A HREF="manual.html#IDX2357">MYSQL_HOST environment variable</A>
<LI><A HREF="manual.html#IDX532"><CODE>MYSQL_HOST</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2067"><CODE>mysql_info()</CODE></A>
<LI><A HREF="manual.html#IDX1526">mysql_info()</A>, <A HREF="manual.html#IDX1536">mysql_info()</A>, <A HREF="manual.html#IDX1591">mysql_info()</A>, <A HREF="manual.html#IDX1623">mysql_info()</A>
<LI><A HREF="manual.html#IDX2068"><CODE>mysql_init()</CODE></A>
<LI><A HREF="manual.html#IDX2069"><CODE>mysql_insert_id()</CODE></A>
<LI><A HREF="manual.html#IDX141">mysql_insert_id()</A>, <A HREF="manual.html#IDX1525">mysql_insert_id()</A>
<LI><A HREF="manual.html#IDX2070"><CODE>mysql_kill()</CODE></A>
<LI><A HREF="manual.html#IDX2071"><CODE>mysql_list_dbs()</CODE></A>
<LI><A HREF="manual.html#IDX2072"><CODE>mysql_list_fields()</CODE></A>
<LI><A HREF="manual.html#IDX2073"><CODE>mysql_list_processes()</CODE></A>
<LI><A HREF="manual.html#IDX2074"><CODE>mysql_list_tables()</CODE></A>
<LI><A HREF="manual.html#IDX2100"><CODE>mysql_more_results()</CODE>.</A>
<LI><A HREF="manual.html#IDX2101"><CODE>mysql_next_result()</CODE>.</A>
<LI><A HREF="manual.html#IDX2075"><CODE>mysql_num_fields()</CODE></A>
<LI><A HREF="manual.html#IDX2077"><CODE>mysql_num_rows()</CODE></A>
<LI><A HREF="manual.html#IDX2078"><CODE>mysql_options()</CODE></A>
<LI><A HREF="manual.html#IDX2079"><CODE>mysql_ping()</CODE></A>
<LI><A HREF="manual.html#IDX2359">MYSQL_PS1 environment variable</A>
<LI><A HREF="manual.html#IDX2361">MYSQL_PWD environment variable</A>
<LI><A HREF="manual.html#IDX534"><CODE>MYSQL_PWD</CODE> environment variable</A>, <A HREF="manual.html#IDX841"><CODE>MYSQL_PWD</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2080"><CODE>mysql_query()</CODE></A>, <A HREF="manual.html#IDX2138"><CODE>mysql_query()</CODE></A>
<LI><A HREF="manual.html#IDX2081"><CODE>mysql_real_connect()</CODE></A>
<LI><A HREF="manual.html#IDX1040">mysql_real_escape_string()</A>
<LI><A HREF="manual.html#IDX2082"><CODE>mysql_real_escape_string()</CODE></A>
<LI><A HREF="manual.html#IDX2083"><CODE>mysql_real_query()</CODE></A>
<LI><A HREF="manual.html#IDX2084"><CODE>mysql_reload()</CODE></A>
<LI><A HREF="manual.html#IDX2030">MYSQL_RES C type</A>
<LI><A HREF="manual.html#IDX2098"><CODE>mysql_rollback()</CODE>.</A>
<LI><A HREF="manual.html#IDX2031">MYSQL_ROW C type</A>
<LI><A HREF="manual.html#IDX2085"><CODE>mysql_row_seek()</CODE></A>
<LI><A HREF="manual.html#IDX2086"><CODE>mysql_row_tell()</CODE></A>
<LI><A HREF="manual.html#IDX2087"><CODE>mysql_select_db()</CODE></A>
<LI><A HREF="manual.html#IDX2137"><CODE>mysql_server_end()</CODE></A>
<LI><A HREF="manual.html#IDX2136"><CODE>mysql_server_init()</CODE></A>
<LI><A HREF="manual.html#IDX2088"><CODE>mysql_set_sever_option()</CODE></A>
<LI><A HREF="manual.html#IDX2089"><CODE>mysql_shutdown()</CODE></A>
<LI><A HREF="manual.html#IDX2090"><CODE>mysql_sqlstate()</CODE></A>
<LI><A HREF="manual.html#IDX2091"><CODE>mysql_ssl_set()</CODE></A>
<LI><A HREF="manual.html#IDX2092"><CODE>mysql_stat()</CODE></A>
<LI><A HREF="manual.html#IDX2102">MYSQL_STMT C type</A>
<LI><A HREF="manual.html#IDX2118"><CODE>mysql_stmt_affected_rows()</CODE></A>
<LI><A HREF="manual.html#IDX2131"><CODE>mysql_stmt_attr_get()</CODE></A>
<LI><A HREF="manual.html#IDX2130"><CODE>mysql_stmt_attr_set()</CODE></A>
<LI><A HREF="manual.html#IDX2108"><CODE>mysql_stmt_bind_param()</CODE></A>
<LI><A HREF="manual.html#IDX2109"><CODE>mysql_stmt_bind_result()</CODE></A>
<LI><A HREF="manual.html#IDX2119"><CODE>mysql_stmt_close()</CODE></A>
<LI><A HREF="manual.html#IDX2120"><CODE>mysql_stmt_data_seek()</CODE></A>
<LI><A HREF="manual.html#IDX2121"><CODE>mysql_stmt_errno()</CODE></A>
<LI><A HREF="manual.html#IDX2122"><CODE>mysql_stmt_error()</CODE>.</A>
<LI><A HREF="manual.html#IDX2110"><CODE>mysql_stmt_execute()</CODE></A>
<LI><A HREF="manual.html#IDX2111"><CODE>mysql_stmt_fetch()</CODE></A>
<LI><A HREF="manual.html#IDX2112"><CODE>mysql_stmt_fetch_column()</CODE></A>
<LI><A HREF="manual.html#IDX2123"><CODE>mysql_stmt_free_result()</CODE></A>
<LI><A HREF="manual.html#IDX2107"><CODE>mysql_stmt_init()</CODE></A>
<LI><A HREF="manual.html#IDX2124"><CODE>mysql_stmt_num_rows()</CODE></A>
<LI><A HREF="manual.html#IDX2114"><CODE>mysql_stmt_param_count()</CODE></A>
<LI><A HREF="manual.html#IDX2115"><CODE>mysql_stmt_param_metadata()</CODE></A>
<LI><A HREF="manual.html#IDX2116"><CODE>mysql_stmt_prepare()</CODE></A>
<LI><A HREF="manual.html#IDX2125"><CODE>mysql_stmt_reset()</CODE></A>
<LI><A HREF="manual.html#IDX2113"><CODE>mysql_stmt_result_metadata</CODE>.</A>
<LI><A HREF="manual.html#IDX2126"><CODE>mysql_stmt_row_seek()</CODE></A>
<LI><A HREF="manual.html#IDX2127"><CODE>mysql_stmt_row_tell()</CODE></A>
<LI><A HREF="manual.html#IDX2117"><CODE>mysql_stmt_send_long_data()</CODE>.</A>
<LI><A HREF="manual.html#IDX2128"><CODE>mysql_stmt_sqlstate()</CODE></A>
<LI><A HREF="manual.html#IDX2129"><CODE>mysql_stmt_store_result()</CODE></A>
<LI><A HREF="manual.html#IDX2093"><CODE>mysql_store_result()</CODE></A>, <A HREF="manual.html#IDX2139"><CODE>mysql_store_result()</CODE></A>
<LI><A HREF="manual.html#IDX672"><CODE>MYSQL_TCP_PORT</CODE> environment variable</A>, <A HREF="manual.html#IDX839"><CODE>MYSQL_TCP_PORT</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX676">MYSQL_TCP_PORT environment variable</A>, <A HREF="manual.html#IDX2363">MYSQL_TCP_PORT environment variable</A>
<LI><A HREF="manual.html#IDX2134"><CODE>mysql_thread_end()</CODE></A>
<LI><A HREF="manual.html#IDX2094"><CODE>mysql_thread_id()</CODE></A>
<LI><A HREF="manual.html#IDX2133"><CODE>mysql_thread_init()</CODE></A>
<LI><A HREF="manual.html#IDX2135"><CODE>mysql_thread_safe()</CODE></A>
<LI><A HREF="manual.html#IDX318">MYSQL_UNIX_PORT environment variable</A>, <A HREF="manual.html#IDX675">MYSQL_UNIX_PORT environment variable</A>, <A HREF="manual.html#IDX2365">MYSQL_UNIX_PORT environment variable</A>
<LI><A HREF="manual.html#IDX671"><CODE>MYSQL_UNIX_PORT</CODE> environment variable</A>, <A HREF="manual.html#IDX837"><CODE>MYSQL_UNIX_PORT</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2095"><CODE>mysql_use_result()</CODE></A>
<LI><A HREF="manual.html#IDX2096"><CODE>mysql_warning_count()</CODE>.</A>
</DIR>
<H2>N</H2>
<DIR>
<LI><A HREF="manual.html#IDX1131">NATIONAL CHAR</A>
<LI><A HREF="manual.html#IDX1561">NATURAL LEFT JOIN</A>
<LI><A HREF="manual.html#IDX1562">NATURAL LEFT OUTER JOIN</A>
<LI><A HREF="manual.html#IDX1565">NATURAL RIGHT JOIN</A>
<LI><A HREF="manual.html#IDX1566">NATURAL RIGHT OUTER JOIN</A>
<LI><A HREF="manual.html#IDX1132">NCHAR</A>
<LI><A HREF="manual.html#IDX1020">newline (\n)</A>
<LI><A HREF="manual.html#IDX1227">NOT BETWEEN</A>
<LI><A HREF="manual.html#IDX1212">not equal (!=)</A>
<LI><A HREF="manual.html#IDX1210">not equal (&#60;&#62;)</A>
<LI><A HREF="manual.html#IDX1232">NOT IN</A>
<LI><A HREF="manual.html#IDX1313">NOT LIKE</A>
<LI><A HREF="manual.html#IDX1314">NOT REGEXP</A>
<LI><A HREF="manual.html#IDX1238">NOT, logical</A>
<LI><A HREF="manual.html#IDX1403">NOW()</A>
<LI><A HREF="manual.html#IDX1012">NUL</A>
<LI><A HREF="manual.html#IDX424">NULL</A>, <A HREF="manual.html#IDX2276">NULL</A>
<LI><A HREF="manual.html#IDX1050">NULL value</A>
<LI><A HREF="manual.html#IDX1255">NULLIF()</A>
<LI><A HREF="manual.html#IDX1124">NUMERIC</A>
<LI><A HREF="manual.html#IDX1962">NumGeometries()</A>
<LI><A HREF="manual.html#IDX1957">NumInteriorRings()</A>
<LI><A HREF="manual.html#IDX1948">NumPoints()</A>
</DIR>
<H2>O</H2>
<DIR>
<LI><A HREF="manual.html#IDX1286">OCT()</A>
<LI><A HREF="manual.html#IDX1287">OCTET_LENGTH()</A>
<LI><A HREF="manual.html#IDX1510">OLAP</A>
<LI><A HREF="manual.html#IDX1458">OLD_PASSWORD()</A>
<LI><A HREF="manual.html#IDX2009">OPEN</A>
<LI><A HREF="manual.html#IDX1237">operators, logical</A>
<LI><A HREF="manual.html#IDX1704">OPTIMIZE TABLE</A>
<LI><A HREF="manual.html#IDX729">OR</A>
<LI><A HREF="manual.html#IDX1439">OR, bitwise</A>
<LI><A HREF="manual.html#IDX1242">OR, logical</A>
<LI><A HREF="manual.html#IDX1288">ORD()</A>
<LI><A HREF="manual.html#IDX415">ORDER BY</A>, <A HREF="manual.html#IDX1551">ORDER BY</A>, <A HREF="manual.html#IDX1611">ORDER BY</A>
<LI><A HREF="manual.html#IDX1984">Overlaps()</A>
</DIR>
<H2>P</H2>
<DIR>
<LI><A HREF="manual.html#IDX1197">parentheses ( and )</A>
<LI><A HREF="manual.html#IDX545">PASSWORD()</A>, <A HREF="manual.html#IDX588">PASSWORD()</A>, <A HREF="manual.html#IDX1459">PASSWORD()</A>, <A HREF="manual.html#IDX2239">PASSWORD()</A>
<LI><A HREF="manual.html#IDX210">PATH environment variable</A>, <A HREF="manual.html#IDX2367">PATH environment variable</A>
<LI><A HREF="manual.html#IDX1404">PERIOD_ADD()</A>
<LI><A HREF="manual.html#IDX1405">PERIOD_DIFF()</A>
<LI><A HREF="manual.html#IDX1358">PI()</A>
<LI><A HREF="manual.html#IDX1884">POINT</A>
<LI><A HREF="manual.html#IDX1930">Point()</A>
<LI><A HREF="manual.html#IDX1903">PointFromText()</A>
<LI><A HREF="manual.html#IDX1920">PointFromWKB()</A>
<LI><A HREF="manual.html#IDX1949">PointN()</A>
<LI><A HREF="manual.html#IDX1960">PointOnSurface()</A>
<LI><A HREF="manual.html#IDX1904">PolyFromText()</A>
<LI><A HREF="manual.html#IDX1921">PolyFromWKB()</A>
<LI><A HREF="manual.html#IDX1886">POLYGON</A>
<LI><A HREF="manual.html#IDX1931">Polygon()</A>
<LI><A HREF="manual.html#IDX1905">PolygonFromText()</A>
<LI><A HREF="manual.html#IDX1922">PolygonFromWKB()</A>
<LI><A HREF="manual.html#IDX1289">POSITION()</A>
<LI><A HREF="manual.html#IDX1359">POW()</A>
<LI><A HREF="manual.html#IDX1360">POWER()</A>
<LI><A HREF="manual.html#IDX1610">PRIMARY KEY</A>, <A HREF="manual.html#IDX1635">PRIMARY KEY</A>
<LI><A HREF="manual.html#IDX1758">PROCESSLIST</A>
<LI><A HREF="manual.html#IDX1788">PURGE MASTER LOGS</A>
</DIR>
<H2>Q</H2>
<DIR>
<LI><A HREF="manual.html#IDX1406">QUARTER()</A>
<LI><A HREF="manual.html#IDX1290">QUOTE()</A>
<LI><A HREF="manual.html#IDX1060">quoting of identifiers</A>
</DIR>
<H2>R</H2>
<DIR>
<LI><A HREF="manual.html#IDX1361">RADIANS()</A>
<LI><A HREF="manual.html#IDX1362">RAND()</A>
<LI><A HREF="manual.html#IDX1121">REAL</A>
<LI><A HREF="manual.html#IDX733">ref_or_null</A>
<LI><A HREF="manual.html#IDX1317">REGEXP</A>
<LI><A HREF="manual.html#IDX1985">Related()</A>
<LI><A HREF="manual.html#IDX1490">RELEASE_LOCK()</A>
<LI><A HREF="manual.html#IDX1658">RENAME TABLE</A>
<LI><A HREF="manual.html#IDX1707">REPAIR TABLE</A>
<LI><A HREF="manual.html#IDX2017">REPEAT</A>
<LI><A HREF="manual.html#IDX1291">REPEAT()</A>
<LI><A HREF="manual.html#IDX1537">REPLACE</A>
<LI><A HREF="manual.html#IDX1527">REPLACE ... SELECT</A>
<LI><A HREF="manual.html#IDX1292">REPLACE()</A>
<LI><A HREF="manual.html#IDX600">REQUIRE GRANT option</A>, <A HREF="manual.html#IDX1694">REQUIRE GRANT option</A>
<LI><A HREF="manual.html#IDX1789">RESET MASTER</A>
<LI><A HREF="manual.html#IDX1802">RESET SLAVE</A>
<LI><A HREF="manual.html#IDX1708">RESTORE TABLE</A>
<LI><A HREF="manual.html#IDX1024">return (\r)</A>
<LI><A HREF="manual.html#IDX1293">REVERSE()</A>
<LI><A HREF="manual.html#IDX1686">REVOKE</A>
<LI><A HREF="manual.html#IDX1563">RIGHT JOIN</A>
<LI><A HREF="manual.html#IDX1564">RIGHT OUTER JOIN</A>
<LI><A HREF="manual.html#IDX1294">RIGHT()</A>
<LI><A HREF="manual.html#IDX1318">RLIKE</A>
<LI><A HREF="manual.html#IDX133">ROLLBACK</A>, <A HREF="manual.html#IDX1669">ROLLBACK</A>
<LI><A HREF="manual.html#IDX1671">ROLLBACK TO SAVEPOINT</A>
<LI><A HREF="manual.html#IDX1511">ROLLUP</A>
<LI><A HREF="manual.html#IDX1363">ROUND()</A>
<LI><A HREF="manual.html#IDX1295">RPAD()</A>
<LI><A HREF="manual.html#IDX1296">RTRIM()</A>
</DIR>
<H2>S</H2>
<DIR>
<LI><A HREF="manual.html#IDX1670">SAVEPOINT</A>
<LI><A HREF="manual.html#IDX1408">SEC_TO_TIME()</A>
<LI><A HREF="manual.html#IDX1407">SECOND()</A>
<LI><A HREF="manual.html#IDX1538">SELECT</A>
<LI><A HREF="manual.html#IDX2005">SELECT INTO</A>
<LI><A HREF="manual.html#IDX131">SELECT INTO TABLE</A>
<LI><A HREF="manual.html#IDX723">SELECT speed</A>
<LI><A HREF="manual.html#IDX715">SELECT, optimizing</A>
<LI><A HREF="manual.html#IDX1476">SESSION_USER()</A>
<LI><A HREF="manual.html#IDX1148">SET</A>, <A HREF="manual.html#IDX1173">SET</A>, <A HREF="manual.html#IDX1735">SET</A>, <A HREF="manual.html#IDX2004">SET</A>
<LI><A HREF="manual.html#IDX1803">SET GLOBAL SQL_SLAVE_SKIP_COUNTER</A>
<LI><A HREF="manual.html#IDX1736">SET OPTION</A>
<LI><A HREF="manual.html#IDX1696">SET PASSWORD</A>
<LI><A HREF="manual.html#IDX589">SET PASSWORD statement</A>
<LI><A HREF="manual.html#IDX1790">SET SQL_LOG_BIN</A>
<LI><A HREF="manual.html#IDX1674">SET TRANSACTION</A>
<LI><A HREF="manual.html#IDX1462">SHA()</A>
<LI><A HREF="manual.html#IDX1461">SHA1()</A>
<LI><A HREF="manual.html#IDX1730">SHOW BINLOG EVENTS</A>, <A HREF="manual.html#IDX1791">SHOW BINLOG EVENTS</A>
<LI><A HREF="manual.html#IDX1738">SHOW CHARACTER SET</A>
<LI><A HREF="manual.html#IDX1739">SHOW COLLATION</A>
<LI><A HREF="manual.html#IDX1710">SHOW COLUMNS</A>, <A HREF="manual.html#IDX1741">SHOW COLUMNS</A>
<LI><A HREF="manual.html#IDX1711">SHOW CREATE DATABASE</A>, <A HREF="manual.html#IDX1742">SHOW CREATE DATABASE</A>
<LI><A HREF="manual.html#IDX1997">SHOW CREATE FUNCTION</A>
<LI><A HREF="manual.html#IDX1996">SHOW CREATE PROCEDURE</A>
<LI><A HREF="manual.html#IDX1712">SHOW CREATE TABLE</A>, <A HREF="manual.html#IDX1743">SHOW CREATE TABLE</A>
<LI><A HREF="manual.html#IDX1713">SHOW DATABASES</A>, <A HREF="manual.html#IDX1745">SHOW DATABASES</A>
<LI><A HREF="manual.html#IDX1714">SHOW ENGINES</A>, <A HREF="manual.html#IDX1726">SHOW ENGINES</A>, <A HREF="manual.html#IDX1746">SHOW ENGINES</A>
<LI><A HREF="manual.html#IDX1715">SHOW ERRORS</A>, <A HREF="manual.html#IDX1749">SHOW ERRORS</A>
<LI><A HREF="manual.html#IDX1716">SHOW FIELDS</A>
<LI><A HREF="manual.html#IDX1999">SHOW FUNCTION STATUS</A>
<LI><A HREF="manual.html#IDX1717">SHOW GRANTS</A>, <A HREF="manual.html#IDX1752">SHOW GRANTS</A>
<LI><A HREF="manual.html#IDX1718">SHOW INDEX</A>, <A HREF="manual.html#IDX1754">SHOW INDEX</A>
<LI><A HREF="manual.html#IDX1719">SHOW INNODB STATUS</A>
<LI><A HREF="manual.html#IDX1720">SHOW KEYS</A>, <A HREF="manual.html#IDX1755">SHOW KEYS</A>
<LI><A HREF="manual.html#IDX1731">SHOW MASTER LOGS</A>, <A HREF="manual.html#IDX1792">SHOW MASTER LOGS</A>
<LI><A HREF="manual.html#IDX1732">SHOW MASTER STATUS</A>, <A HREF="manual.html#IDX1793">SHOW MASTER STATUS</A>
<LI><A HREF="manual.html#IDX1721">SHOW PRIVILEGES</A>, <A HREF="manual.html#IDX1756">SHOW PRIVILEGES</A>
<LI><A HREF="manual.html#IDX1998">SHOW PROCEDURE STATUS</A>
<LI><A HREF="manual.html#IDX1722">SHOW PROCESSLIST</A>, <A HREF="manual.html#IDX1759">SHOW PROCESSLIST</A>
<LI><A HREF="manual.html#IDX1733">SHOW SLAVE HOSTS</A>, <A HREF="manual.html#IDX1794">SHOW SLAVE HOSTS</A>
<LI><A HREF="manual.html#IDX1734">SHOW SLAVE STATUS</A>, <A HREF="manual.html#IDX1804">SHOW SLAVE STATUS</A>
<LI><A HREF="manual.html#IDX1723">SHOW STATUS</A>
<LI><A HREF="manual.html#IDX1747">SHOW STORAGE ENGINES</A>
<LI><A HREF="manual.html#IDX1725">SHOW TABLE STATUS</A>
<LI><A HREF="manual.html#IDX1727">SHOW TABLE TYPES</A>, <A HREF="manual.html#IDX1748">SHOW TABLE TYPES</A>
<LI><A HREF="manual.html#IDX1724">SHOW TABLES</A>, <A HREF="manual.html#IDX1769">SHOW TABLES</A>
<LI><A HREF="manual.html#IDX1728">SHOW VARIABLES</A>
<LI><A HREF="manual.html#IDX1729">SHOW WARNINGS</A>, <A HREF="manual.html#IDX1775">SHOW WARNINGS</A>
<LI><A HREF="manual.html#IDX1364">SIGN()</A>
<LI><A HREF="manual.html#IDX1365">SIN()</A>
<LI><A HREF="manual.html#IDX1014">single quote (\')</A>
<LI><A HREF="manual.html#IDX1105">SMALLINT</A>
<LI><A HREF="manual.html#IDX1297">SOUNDEX()</A>
<LI><A HREF="manual.html#IDX1298">SOUNDS LIKE</A>
<LI><A HREF="manual.html#IDX1299">SPACE()</A>
<LI><A HREF="manual.html#IDX683">SQL_CACHE</A>
<LI><A HREF="manual.html#IDX684">SQL_NO_CACHE</A>
<LI><A HREF="manual.html#IDX1366">SQRT()</A>
<LI><A HREF="manual.html#IDX1939">SRID()</A>
<LI><A HREF="manual.html#IDX1805">START SLAVE</A>
<LI><A HREF="manual.html#IDX1666">START TRANSACTION</A>
<LI><A HREF="manual.html#IDX1950">StartPoint()</A>
<LI><A HREF="manual.html#IDX572">statements, GRANT</A>
<LI><A HREF="manual.html#IDX579">statements, INSERT</A>
<LI><A HREF="manual.html#IDX1504">STD()</A>
<LI><A HREF="manual.html#IDX1505">STDDEV()</A>
<LI><A HREF="manual.html#IDX1806">STOP SLAVE</A>
<LI><A HREF="manual.html#IDX1409">STR_TO_DATE()</A>
<LI><A HREF="manual.html#IDX1567">STRAIGHT_JOIN</A>
<LI><A HREF="manual.html#IDX1319">STRCMP()</A>
<LI><A HREF="manual.html#IDX1308">string comparison functions</A>
<LI><A HREF="manual.html#IDX1256">string functions</A>
<LI><A HREF="manual.html#IDX1410">SUBDATE()</A>
<LI><A HREF="manual.html#IDX1300">SUBSTRING()</A>
<LI><A HREF="manual.html#IDX1301">SUBSTRING_INDEX()</A>
<LI><A HREF="manual.html#IDX1411">SUBTIME()</A>
<LI><A HREF="manual.html#IDX1326">subtraction (-)</A>
<LI><A HREF="manual.html#IDX1508">SUM()</A>
<LI><A HREF="manual.html#IDX1967">SymDifference()</A>
<LI><A HREF="manual.html#IDX1412">SYSDATE()</A>
<LI><A HREF="manual.html#IDX1477">SYSTEM_USER()</A>
</DIR>
<H2>T</H2>
<DIR>
<LI><A HREF="manual.html#IDX1027">tab (\t)</A>
<LI><A HREF="manual.html#IDX740">Table scans, avoiding</A>
<LI><A HREF="manual.html#IDX788">table_cache</A>
<LI><A HREF="manual.html#IDX1367">TAN()</A>
<LI><A HREF="manual.html#IDX1142">TEXT</A>, <A HREF="manual.html#IDX1167">TEXT</A>
<LI><A HREF="manual.html#IDX1757">threads</A>
<LI><A HREF="manual.html#IDX1129">TIME</A>, <A HREF="manual.html#IDX1158">TIME</A>
<LI><A HREF="manual.html#IDX1413">TIME()</A>
<LI><A HREF="manual.html#IDX1418">TIME_FORMAT()</A>
<LI><A HREF="manual.html#IDX1419">TIME_TO_SEC()</A>
<LI><A HREF="manual.html#IDX1414">TIMEDIFF()</A>
<LI><A HREF="manual.html#IDX1128">TIMESTAMP</A>, <A HREF="manual.html#IDX1153">TIMESTAMP</A>
<LI><A HREF="manual.html#IDX1415">TIMESTAMP()</A>
<LI><A HREF="manual.html#IDX1416">TIMESTAMPADD()</A>
<LI><A HREF="manual.html#IDX1417">TIMESTAMPDIFF()</A>
<LI><A HREF="manual.html#IDX1139">TINYBLOB</A>
<LI><A HREF="manual.html#IDX1101">TINYINT</A>
<LI><A HREF="manual.html#IDX1140">TINYTEXT</A>
<LI><A HREF="manual.html#IDX317">TMPDIR environment variable</A>, <A HREF="manual.html#IDX2369">TMPDIR environment variable</A>
<LI><A HREF="manual.html#IDX1420">TO_DAYS()</A>
<LI><A HREF="manual.html#IDX1986">Touches()</A>
<LI><A HREF="manual.html#IDX2325">trace DBI method</A>
<LI><A HREF="manual.html#IDX1302">TRIM()</A>
<LI><A HREF="manual.html#IDX1047">TRUE</A>
<LI><A HREF="manual.html#IDX1589">TRUNCATE</A>
<LI><A HREF="manual.html#IDX1368">TRUNCATE()</A>
<LI><A HREF="manual.html#IDX1100">Types</A>
<LI><A HREF="manual.html#IDX2266">TZ environment variable</A>, <A HREF="manual.html#IDX2371">TZ environment variable</A>
</DIR>
<H2>U</H2>
<DIR>
<LI><A HREF="manual.html#IDX1303">UCASE()</A>
<LI><A HREF="manual.html#IDX2204">UDF functions</A>
<LI><A HREF="manual.html#IDX2241">ulimit</A>
<LI><A HREF="manual.html#IDX2250">UMASK environment variable</A>, <A HREF="manual.html#IDX2375">UMASK environment variable</A>
<LI><A HREF="manual.html#IDX2252">UMASK_DIR environment variable</A>, <A HREF="manual.html#IDX2373">UMASK_DIR environment variable</A>
<LI><A HREF="manual.html#IDX1329">unary minus (-)</A>
<LI><A HREF="manual.html#IDX1304">UNCOMPRESS()</A>
<LI><A HREF="manual.html#IDX1305">UNCOMPRESSED_LENGTH()</A>
<LI><A HREF="manual.html#IDX1306">UNHEX()</A>
<LI><A HREF="manual.html#IDX445">UNION</A>, <A HREF="manual.html#IDX1580">UNION</A>
<LI><A HREF="manual.html#IDX1968">Union()</A>
<LI><A HREF="manual.html#IDX1609">UNIQUE</A>
<LI><A HREF="manual.html#IDX1421">UNIX_TIMESTAMP()</A>
<LI><A HREF="manual.html#IDX1673">UNLOCK TABLES</A>
<LI><A HREF="manual.html#IDX2018">UNTIL</A>
<LI><A HREF="manual.html#IDX1590">UPDATE</A>
<LI><A HREF="manual.html#IDX1307">UPPER()</A>
<LI><A HREF="manual.html#IDX1663">USE</A>
<LI><A HREF="manual.html#IDX1543">USE INDEX</A>, <A HREF="manual.html#IDX1574">USE INDEX</A>
<LI><A HREF="manual.html#IDX1544">USE KEY</A>, <A HREF="manual.html#IDX1577">USE KEY</A>
<LI><A HREF="manual.html#IDX536"><CODE>USER</CODE> environment variable</A>
<LI><A HREF="manual.html#IDX2377">USER environment variable</A>
<LI><A HREF="manual.html#IDX1478">USER()</A>
<LI><A HREF="manual.html#IDX2205">User-defined functions</A>
<LI><A HREF="manual.html#IDX1422">UTC_DATE()</A>
<LI><A HREF="manual.html#IDX1423">UTC_TIME()</A>
<LI><A HREF="manual.html#IDX1424">UTC_TIMESTAMP()</A>
<LI><A HREF="manual.html#IDX1491">UUID()</A>
</DIR>
<H2>V</H2>
<DIR>
<LI><A HREF="manual.html#IDX1137">VARCHAR</A>, <A HREF="manual.html#IDX1165">VARCHAR</A>
<LI><A HREF="manual.html#IDX1138">VARCHARACTER</A>
<LI><A HREF="manual.html#IDX1509">VARIANCE()</A>
<LI><A HREF="manual.html#IDX1479">VERSION()</A>
</DIR>
<H2>W</H2>
<DIR>
<LI><A HREF="manual.html#IDX1425">WEEK()</A>
<LI><A HREF="manual.html#IDX1426">WEEKDAY()</A>
<LI><A HREF="manual.html#IDX1427">WEEKOFYEAR()</A>
<LI><A HREF="manual.html#IDX725">WHERE</A>
<LI><A HREF="manual.html#IDX2019">WHILE</A>
<LI><A HREF="manual.html#IDX1033">Wildcard character (%)</A>
<LI><A HREF="manual.html#IDX1035">Wildcard character (_)</A>
<LI><A HREF="manual.html#IDX1987">Within()</A>
<LI><A HREF="manual.html#IDX221">without-server option</A>
</DIR>
<H2>X</H2>
<DIR>
<LI><A HREF="manual.html#IDX1943">X()</A>
<LI><A HREF="manual.html#IDX1443">XOR, bitwise</A>
<LI><A HREF="manual.html#IDX1244">XOR, logical</A>
</DIR>
<H2>Y</H2>
<DIR>
<LI><A HREF="manual.html#IDX1944">Y()</A>
<LI><A HREF="manual.html#IDX1130">YEAR</A>, <A HREF="manual.html#IDX1159">YEAR</A>
<LI><A HREF="manual.html#IDX1428">YEAR()</A>
</DIR>
<H2> </H2>
<DIR>
<LI><A HREF="manual.html#IDX1438">| (bitwise OR)</A>
<LI><A HREF="manual.html#IDX1243">|| (logical OR)</A>
<LI><A HREF="manual.html#IDX1446">~</A>
</DIR>

</P>



<H1><A NAME="Concept_Index" HREF="manual_toc.html#Concept_Index">Concept Index</A></H1>

<P>
<H2> </H2>
<DIR>
<LI><A HREF="manual.html#IDX282"><CODE>--with-raid</CODE> link errors</A>
</DIR>
<H2>A</H2>
<DIR>
<LI><A HREF="manual.html#IDX2233">aborted clients</A>
<LI><A HREF="manual.html#IDX2234">aborted connection</A>
<LI><A HREF="manual.html#IDX538">access control</A>
<LI><A HREF="manual.html#IDX2232">access denied errors</A>
<LI><A HREF="manual.html#IDX517">access privileges</A>
<LI><A HREF="manual.html#IDX2161">Access program</A>
<LI><A HREF="manual.html#IDX577">account privileges, adding</A>
<LI><A HREF="manual.html#IDX332">accounts, anonymous user</A>
<LI><A HREF="manual.html#IDX331">accounts, root</A>
<LI><A HREF="manual.html#IDX1866">ACID</A>
<LI><A HREF="manual.html#IDX140"><CODE>ACID</CODE></A>
<LI><A HREF="manual.html#IDX520">ACLs</A>
<LI><A HREF="manual.html#IDX377">ActiveState Perl</A>
<LI><A HREF="manual.html#IDX649">adding, character sets</A>
<LI><A HREF="manual.html#IDX2221">adding, native functions</A>
<LI><A HREF="manual.html#IDX576">adding, new account privileges</A>
<LI><A HREF="manual.html#IDX2196">adding, new functions</A>
<LI><A HREF="manual.html#IDX574">adding, new user privileges</A>
<LI><A HREF="manual.html#IDX212">adding, new users</A>, <A HREF="manual.html#IDX218">adding, new users</A>
<LI><A HREF="manual.html#IDX2225">adding, procedures</A>
<LI><A HREF="manual.html#IDX2207">adding, user-defined functions</A>
<LI><A HREF="manual.html#IDX920">administration, server</A>
<LI><A HREF="manual.html#IDX2162">ADO program</A>
<LI><A HREF="manual.html#IDX423">age, calculating</A>
<LI><A HREF="manual.html#IDX1072">alias names, case sensitivity</A>
<LI><A HREF="manual.html#IDX1518">aliases, for expressions</A>
<LI><A HREF="manual.html#IDX1549">aliases, for tables</A>
<LI><A HREF="manual.html#IDX1516">aliases, in <CODE>GROUP BY</CODE> clauses</A>
<LI><A HREF="manual.html#IDX1514">aliases, in <CODE>ORDER BY</CODE> clauses</A>
<LI><A HREF="manual.html#IDX1058">aliases, names</A>
<LI><A HREF="manual.html#IDX1539">aliases, on expressions</A>
<LI><A HREF="manual.html#IDX334">anonymous user</A>, <A HREF="manual.html#IDX336">anonymous user</A>, <A HREF="manual.html#IDX544">anonymous user</A>, <A HREF="manual.html#IDX549">anonymous user</A>
<LI><A HREF="manual.html#IDX121">ANSI mode, running</A>
<LI><A HREF="manual.html#IDX111">answering questions, etiquette</A>
<LI><A HREF="manual.html#IDX457">Apache</A>
<LI><A HREF="manual.html#IDX2303">API's, list of</A>
<LI><A HREF="manual.html#IDX2021">APIs</A>
<LI><A HREF="manual.html#IDX2180">APIs, Perl</A>
<LI><A HREF="manual.html#IDX2212">argument processing</A>
<LI><A HREF="manual.html#IDX1322">arithmetic expressions</A>
<LI><A HREF="manual.html#IDX514">attackers, security against</A>
<LI><A HREF="manual.html#IDX2172">AUTO-INCREMENT, ODBC</A>
<LI><A HREF="manual.html#IDX452">AUTO_INCREMENT</A>
<LI><A HREF="manual.html#IDX2279"><CODE>AUTO_INCREMENT</CODE>, and <CODE>NULL</CODE> values</A>
</DIR>
<H2>B</H2>
<DIR>
<LI><A HREF="manual.html#IDX982">backing up, databases</A>, <A HREF="manual.html#IDX987">backing up, databases</A>
<LI><A HREF="manual.html#IDX1008">backslash, escape character</A>
<LI><A HREF="manual.html#IDX606">backups</A>
<LI><A HREF="manual.html#IDX1701">backups, database</A>
<LI><A HREF="manual.html#IDX437">batch mode</A>
<LI><A HREF="manual.html#IDX861"><CODE>batch</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1812"><CODE>BDB</CODE> storage engine</A>, <A HREF="manual.html#IDX1851"><CODE>BDB</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1813"><CODE>BDB</CODE> table type</A>, <A HREF="manual.html#IDX1852"><CODE>BDB</CODE> table type</A>
<LI><A HREF="manual.html#IDX139"><CODE>BDB</CODE> tables</A>
<LI><A HREF="manual.html#IDX706">benchmark suite</A>
<LI><A HREF="manual.html#IDX709">benchmarks</A>
<LI><A HREF="manual.html#IDX1814"><CODE>BerkeleyDB</CODE> storage engine</A>, <A HREF="manual.html#IDX1853"><CODE>BerkeleyDB</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1815"><CODE>BerkeleyDB</CODE> table type</A>, <A HREF="manual.html#IDX1854"><CODE>BerkeleyDB</CODE> table type</A>
<LI><A HREF="manual.html#IDX2271">Big5 Chinese character encoding</A>
<LI><A HREF="manual.html#IDX181">binary distributions</A>
<LI><A HREF="manual.html#IDX208">binary distributions, installing</A>
<LI><A HREF="manual.html#IDX359">binary distributions, on Linux</A>
<LI><A HREF="manual.html#IDX659">binary log</A>
<LI><A HREF="manual.html#IDX451">bit_functions, example</A>
<LI><A HREF="manual.html#IDX259">BitKeeper tree</A>
<LI><A HREF="manual.html#IDX1170"><CODE>BLOB</CODE> columns, default values</A>
<LI><A HREF="manual.html#IDX768"><CODE>BLOB</CODE> columns, indexing</A>, <A HREF="manual.html#IDX1638"><CODE>BLOB</CODE> columns, indexing</A>
<LI><A HREF="manual.html#IDX1039"><CODE>BLOB</CODE>, inserting binary data</A>
<LI><A HREF="manual.html#IDX1183"><CODE>BLOB</CODE>, size</A>
<LI><A HREF="manual.html#IDX954"><CODE>blocking_queries</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX2163">Borland Builder 4 program</A>
<LI><A HREF="manual.html#IDX2186">Borland C++ compiler</A>
<LI><A HREF="manual.html#IDX1098">brackets, square</A>
<LI><A HREF="manual.html#IDX2023">buffer sizes, client</A>
<LI><A HREF="manual.html#IDX801">buffer sizes, <CODE>mysqld</CODE> server</A>
<LI><A HREF="manual.html#IDX104">bug reports, criteria for</A>
<LI><A HREF="manual.html#IDX103">bugs database</A>
<LI><A HREF="manual.html#IDX160">bugs, known</A>
<LI><A HREF="manual.html#IDX95">bugs, reporting</A>
<LI><A HREF="manual.html#IDX102">bugs.mysql.com</A>
<LI><A HREF="manual.html#IDX2148">building, client programs</A>
</DIR>
<H2>C</H2>
<DIR>
<LI><A HREF="manual.html#IDX2027">C API, data types</A>
<LI><A HREF="manual.html#IDX2036">C API, functions</A>
<LI><A HREF="manual.html#IDX2145">C API, linking problems</A>
<LI><A HREF="manual.html#IDX2105">C Prepared statement API, functions</A>
<LI><A HREF="manual.html#IDX2185">C++ APIs</A>
<LI><A HREF="manual.html#IDX2170">C++ Builder</A>
<LI><A HREF="manual.html#IDX276">C++ compiler cannot create executables</A>
<LI><A HREF="manual.html#IDX237">C++ compiler, <CODE>gcc</CODE></A>
<LI><A HREF="manual.html#IDX1782">caches, clearing</A>
<LI><A HREF="manual.html#IDX421">calculating, dates</A>
<LI><A HREF="manual.html#IDX2211">calling sequences for aggregate functions, UDF</A>
<LI><A HREF="manual.html#IDX2210">calling sequences for simple functions, UDF</A>
<LI><A HREF="manual.html#IDX2237">can't create/write to file</A>
<LI><A HREF="manual.html#IDX1066">case sensitivity, in identifiers</A>
<LI><A HREF="manual.html#IDX1068">case sensitivity, in names</A>
<LI><A HREF="manual.html#IDX2268">case sensitivity, in searches</A>
<LI><A HREF="manual.html#IDX1310">case sensitivity, in string comparisons</A>
<LI><A HREF="manual.html#IDX525">case-sensitivity, in access checking</A>
<LI><A HREF="manual.html#IDX124">case-sensitivity, of database names</A>
<LI><A HREF="manual.html#IDX126">case-sensitivity, of table names</A>
<LI><A HREF="manual.html#IDX1246">cast operators</A>
<LI><A HREF="manual.html#IDX1201">casts</A>
<LI><A HREF="manual.html#IDX270"><CODE>cc1plus</CODE> problems</A>
<LI><A HREF="manual.html#IDX47">certification</A>
<LI><A HREF="manual.html#IDX2306">ChangeLog</A>
<LI><A HREF="manual.html#IDX561">changes to privileges</A>
<LI><A HREF="manual.html#IDX2307">changes, log</A>
<LI><A HREF="manual.html#IDX2318">changes, version 3.19</A>
<LI><A HREF="manual.html#IDX2317">changes, version 3.20</A>
<LI><A HREF="manual.html#IDX2314">changes, version 3.21</A>
<LI><A HREF="manual.html#IDX2313">changes, version 3.22</A>
<LI><A HREF="manual.html#IDX2312">changes, version 3.23</A>
<LI><A HREF="manual.html#IDX2311">changes, version 4.0</A>
<LI><A HREF="manual.html#IDX2310">changes, version 4.1</A>
<LI><A HREF="manual.html#IDX2309">changes, version 5.0</A>
<LI><A HREF="manual.html#IDX227">changing socket location</A>, <A HREF="manual.html#IDX324">changing socket location</A>, <A HREF="manual.html#IDX2263">changing socket location</A>
<LI><A HREF="manual.html#IDX1599">changing, column</A>
<LI><A HREF="manual.html#IDX2294">changing, column order</A>
<LI><A HREF="manual.html#IDX1593">changing, database</A>
<LI><A HREF="manual.html#IDX1601">changing, field</A>
<LI><A HREF="manual.html#IDX1596">changing, table</A>, <A HREF="manual.html#IDX1613">changing, table</A>, <A HREF="manual.html#IDX2290">changing, table</A>
<LI><A HREF="manual.html#IDX1083">Character sets</A>
<LI><A HREF="manual.html#IDX253">character sets</A>, <A HREF="manual.html#IDX641">character sets</A>
<LI><A HREF="manual.html#IDX648">character sets, adding</A>
<LI><A HREF="manual.html#IDX862"><CODE>character-sets-dir</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX652">characters, multi-byte</A>
<LI><A HREF="manual.html#IDX620">check options, myisamchk</A>
<LI><A HREF="manual.html#IDX627">checking, tables for errors</A>
<LI><A HREF="manual.html#IDX369">checksum errors</A>
<LI><A HREF="manual.html#IDX2270">Chinese</A>
<LI><A HREF="manual.html#IDX1189">choosing types</A>
<LI><A HREF="manual.html#IDX174">choosing, a MySQL version</A>
<LI><A HREF="manual.html#IDX1781">clearing, caches</A>
<LI><A HREF="manual.html#IDX2146">client programs, building</A>
<LI><A HREF="manual.html#IDX2020">client tools</A>
<LI><A HREF="manual.html#IDX2329">clients, debugging</A>
<LI><A HREF="manual.html#IDX2150">clients, threaded</A>
<LI><A HREF="manual.html#IDX792">closing, tables</A>
<LI><A HREF="manual.html#IDX2164">ColdFusion program</A>
<LI><A HREF="manual.html#IDX650">collating, strings</A>
<LI><A HREF="manual.html#IDX1634">column comments</A>
<LI><A HREF="manual.html#IDX1071">column names, case sensitivity</A>
<LI><A HREF="manual.html#IDX1600">column, changing</A>
<LI><A HREF="manual.html#IDX2293">columns, changing</A>
<LI><A HREF="manual.html#IDX996">columns, displaying</A>
<LI><A HREF="manual.html#IDX766">columns, indexes</A>
<LI><A HREF="manual.html#IDX1057">columns, names</A>
<LI><A HREF="manual.html#IDX1192">columns, other types</A>
<LI><A HREF="manual.html#IDX412">columns, selecting</A>
<LI><A HREF="manual.html#IDX1175">columns, storage requirements</A>
<LI><A HREF="manual.html#IDX1092">columns, types</A>
<LI><A HREF="manual.html#IDX15">command syntax</A>
<LI><A HREF="manual.html#IDX914">command-line history, mysql</A>
<LI><A HREF="manual.html#IDX857">command-line options, <CODE>mysql</CODE></A>
<LI><A HREF="manual.html#IDX935">command-line options, <CODE>mysqladmin</CODE></A>
<LI><A HREF="manual.html#IDX950">command-line options, <CODE>mysqlcc</CODE></A>
<LI><A HREF="manual.html#IDX851">command-line tool</A>
<LI><A HREF="manual.html#IDX2238">commands out of sync</A>
<LI><A HREF="manual.html#IDX209">commands, for binary distribution</A>
<LI><A HREF="manual.html#IDX1786">commands, replication masters</A>
<LI><A HREF="manual.html#IDX1796">commands, replication slaves</A>
<LI><A HREF="manual.html#IDX1080">comments, adding</A>
<LI><A HREF="manual.html#IDX151">comments, starting</A>
<LI><A HREF="manual.html#IDX61">commercial support, types</A>
<LI><A HREF="manual.html#IDX339">compatibility, between MySQL versions</A>, <A HREF="manual.html#IDX341">compatibility, between MySQL versions</A>, <A HREF="manual.html#IDX343">compatibility, between MySQL versions</A>, <A HREF="manual.html#IDX345">compatibility, between MySQL versions</A>, <A HREF="manual.html#IDX347">compatibility, between MySQL versions</A>
<LI><A HREF="manual.html#IDX1316">compatibility, with mSQL</A>
<LI><A HREF="manual.html#IDX1064">compatibility, with ODBC</A>, <A HREF="manual.html#IDX1115">compatibility, with ODBC</A>, <A HREF="manual.html#IDX1204">compatibility, with ODBC</A>, <A HREF="manual.html#IDX1225">compatibility, with ODBC</A>, <A HREF="manual.html#IDX1570">compatibility, with ODBC</A>, <A HREF="manual.html#IDX1632">compatibility, with ODBC</A>, <A HREF="manual.html#IDX2316">compatibility, with ODBC</A>
<LI><A HREF="manual.html#IDX128">compatibility, with Oracle</A>, <A HREF="manual.html#IDX1507">compatibility, with Oracle</A>, <A HREF="manual.html#IDX1662">compatibility, with Oracle</A>
<LI><A HREF="manual.html#IDX130">compatibility, with PostgreSQL</A>
<LI><A HREF="manual.html#IDX115">compatibility, with standard SQL</A>
<LI><A HREF="manual.html#IDX1665">compatibility, with Sybase</A>
<LI><A HREF="manual.html#IDX238">compiler, C++ <CODE>gcc</CODE></A>
<LI><A HREF="manual.html#IDX297">compiling, on Windows</A>
<LI><A HREF="manual.html#IDX795">compiling, optimizing</A>
<LI><A HREF="manual.html#IDX261">compiling, problems</A>
<LI><A HREF="manual.html#IDX806">compiling, speed</A>
<LI><A HREF="manual.html#IDX230">compiling, statically</A>
<LI><A HREF="manual.html#IDX2218">compiling, user-defined functions</A>
<LI><A HREF="manual.html#IDX42">compliance, Y2K</A>
<LI><A HREF="manual.html#IDX863"><CODE>compress</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX955"><CODE>compress</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX845">compressed tables</A>, <A HREF="manual.html#IDX1836">compressed tables</A>
<LI><A HREF="manual.html#IDX755">concurrent inserts</A>
<LI><A HREF="manual.html#IDX2006">Conditions</A>
<LI><A HREF="manual.html#IDX490"><CODE>config-file</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX269">config.cache</A>
<LI><A HREF="manual.html#IDX264"><CODE>config.cache</CODE> file</A>
<LI><A HREF="manual.html#IDX566">configuration files</A>
<LI><A HREF="manual.html#IDX224">configuration options</A>
<LI><A HREF="manual.html#IDX275">configure option, --with-low-memory</A>
<LI><A HREF="manual.html#IDX222"><CODE>configure</CODE> script</A>
<LI><A HREF="manual.html#IDX267"><CODE>configure</CODE>, running after prior invocation</A>
<LI><A HREF="manual.html#IDX904"><CODE>connect_timeout</CODE> variable</A>, <A HREF="manual.html#IDX939"><CODE>connect_timeout</CODE> variable</A>, <A HREF="manual.html#IDX974"><CODE>connect_timeout</CODE> variable</A>
<LI><A HREF="manual.html#IDX604">connecting, remotely with SSH</A>
<LI><A HREF="manual.html#IDX388">connecting, to the server</A>, <A HREF="manual.html#IDX527">connecting, to the server</A>
<LI><A HREF="manual.html#IDX540">connecting, verification</A>
<LI><A HREF="manual.html#IDX2235">connection, aborted</A>
<LI><A HREF="manual.html#IDX956"><CODE>connection_name</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX2177">Connector/J</A>
<LI><A HREF="manual.html#IDX2159">Connector/ODBC</A>
<LI><A HREF="manual.html#IDX718">constant table</A>, <A HREF="manual.html#IDX727">constant table</A>
<LI><A HREF="manual.html#IDX49">consulting</A>
<LI><A HREF="manual.html#IDX52">contact information</A>
<LI><A HREF="manual.html#IDX2305">contributing companies, list of</A>
<LI><A HREF="manual.html#IDX2298">contributors, list of</A>
<LI><A HREF="manual.html#IDX539">control access</A>
<LI><A HREF="manual.html#IDX13">conventions, typographical</A>
<LI><A HREF="manual.html#IDX355">copying databases</A>
<LI><A HREF="manual.html#IDX1644">copying tables</A>
<LI><A HREF="manual.html#IDX66">copyrights</A>
<LI><A HREF="manual.html#IDX62">costs, support</A>
<LI><A HREF="manual.html#IDX431">counting, table rows</A>
<LI><A HREF="manual.html#IDX2322">crash</A>
<LI><A HREF="manual.html#IDX625">crash, recovery</A>
<LI><A HREF="manual.html#IDX2258">crash, repeated</A>
<LI><A HREF="manual.html#IDX708">crash-me</A>
<LI><A HREF="manual.html#IDX702">crash-me program</A>, <A HREF="manual.html#IDX707">crash-me program</A>
<LI><A HREF="manual.html#IDX100">creating, bug reports</A>
<LI><A HREF="manual.html#IDX398">creating, databases</A>
<LI><A HREF="manual.html#IDX462">creating, default startup options</A>
<LI><A HREF="manual.html#IDX402">creating, tables</A>
<LI><A HREF="manual.html#IDX2008">Cursors</A>
<LI><A HREF="manual.html#IDX107">customer support, mailing address</A>
<LI><A HREF="manual.html#IDX705">customers, of MySQL</A>
<LI><A HREF="manual.html#IDX260">CVS tree</A>
</DIR>
<H2>D</H2>
<DIR>
<LI><A HREF="manual.html#IDX1090">data types</A>
<LI><A HREF="manual.html#IDX2028">data types, C API</A>
<LI><A HREF="manual.html#IDX642">data, character sets</A>
<LI><A HREF="manual.html#IDX989">data, importing</A>
<LI><A HREF="manual.html#IDX405">data, loading into tables</A>
<LI><A HREF="manual.html#IDX406">data, retrieving</A>
<LI><A HREF="manual.html#IDX760">data, size</A>
<LI><A HREF="manual.html#IDX758">database design</A>
<LI><A HREF="manual.html#IDX1069">database names, case sensitivity</A>
<LI><A HREF="manual.html#IDX123">database names, case-sensitivity</A>
<LI><A HREF="manual.html#IDX1594">database, changing</A>
<LI><A HREF="manual.html#IDX1650">database, deleting</A>
<LI><A HREF="manual.html#IDX864"><CODE>database</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX957"><CODE>database</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX605">databases, backups</A>
<LI><A HREF="manual.html#IDX356">databases, copying</A>
<LI><A HREF="manual.html#IDX396">databases, creating</A>
<LI><A HREF="manual.html#IDX18">databases, defined</A>
<LI><A HREF="manual.html#IDX993">databases, displaying</A>
<LI><A HREF="manual.html#IDX980">databases, dumping</A>, <A HREF="manual.html#IDX985">databases, dumping</A>
<LI><A HREF="manual.html#IDX433">databases, information about</A>
<LI><A HREF="manual.html#IDX1054">databases, names</A>
<LI><A HREF="manual.html#IDX686">databases, replicating</A>
<LI><A HREF="manual.html#IDX400">databases, selecting</A>
<LI><A HREF="manual.html#IDX817">databases, symbolic links</A>
<LI><A HREF="manual.html#IDX397">databases, using</A>
<LI><A HREF="manual.html#IDX2165">DataJunction</A>
<LI><A HREF="manual.html#IDX1150">Date and Time types</A>
<LI><A HREF="manual.html#IDX420">date calculations</A>
<LI><A HREF="manual.html#IDX2273">DATE columns, problems</A>
<LI><A HREF="manual.html#IDX43">date functions, Y2K compliance</A>
<LI><A HREF="manual.html#IDX1179">date types</A>
<LI><A HREF="manual.html#IDX1161">date types, Y2K issues</A>
<LI><A HREF="manual.html#IDX1157">date values, problems</A>
<LI><A HREF="manual.html#IDX554"><CODE>db</CODE> table, sorting</A>
<LI><A HREF="manual.html#IDX2182"><CODE>DBI</CODE> interface</A>
<LI><A HREF="manual.html#IDX2183"><CODE>DBI/DBD</CODE> interface</A>
<LI><A HREF="manual.html#IDX2332">DBUG package</A>
<LI><A HREF="manual.html#IDX866"><CODE>debug-info</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX865"><CODE>debug</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX2328">debugging, client</A>
<LI><A HREF="manual.html#IDX2321">debugging, server</A>
<LI><A HREF="manual.html#IDX1097">decimal point</A>
<LI><A HREF="manual.html#IDX610"><CODE>decode_bits</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX528">default hostname</A>
<LI><A HREF="manual.html#IDX191">default installation location</A>
<LI><A HREF="manual.html#IDX460">default options</A>
<LI><A HREF="manual.html#IDX700">default values</A>, <A HREF="manual.html#IDX1523">default values</A>, <A HREF="manual.html#IDX1633">default values</A>
<LI><A HREF="manual.html#IDX1169">default values, <CODE>BLOB</CODE> and <CODE>TEXT</CODE> columns</A>
<LI><A HREF="manual.html#IDX158">default values, suppression</A>, <A HREF="manual.html#IDX247">default values, suppression</A>
<LI><A HREF="manual.html#IDX328">default, privileges</A>
<LI><A HREF="manual.html#IDX867"><CODE>default-character-set</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX2154">defaults, embedded</A>
<LI><A HREF="manual.html#IDX1532">delayed_insert_limit</A>
<LI><A HREF="manual.html#IDX1649">deleting, database</A>
<LI><A HREF="manual.html#IDX1618">deleting, foreign key</A>, <A HREF="manual.html#IDX1868">deleting, foreign key</A>
<LI><A HREF="manual.html#IDX2202">deleting, function</A>
<LI><A HREF="manual.html#IDX1604">deleting, index</A>, <A HREF="manual.html#IDX1653">deleting, index</A>
<LI><A HREF="manual.html#IDX1607">deleting, primary key</A>
<LI><A HREF="manual.html#IDX2284">deleting, rows</A>
<LI><A HREF="manual.html#IDX1656">deleting, table</A>
<LI><A HREF="manual.html#IDX584">deleting, user</A>, <A HREF="manual.html#IDX1681">deleting, user</A>
<LI><A HREF="manual.html#IDX586">deleting, users</A>, <A HREF="manual.html#IDX1683">deleting, users</A>
<LI><A HREF="manual.html#IDX2262">deletion, <CODE>mysql.sock</CODE></A>
<LI><A HREF="manual.html#IDX2169">Delphi program</A>
<LI><A HREF="manual.html#IDX1587">derived tables</A>
<LI><A HREF="manual.html#IDX757">design, choices</A>
<LI><A HREF="manual.html#IDX162">design, issues</A>
<LI><A HREF="manual.html#IDX698">design, limitations</A>
<LI><A HREF="manual.html#IDX2297">developers, list of</A>
<LI><A HREF="manual.html#IDX258">development source tree</A>
<LI><A HREF="manual.html#IDX1096">digits</A>
<LI><A HREF="manual.html#IDX190">directory structure, default</A>
<LI><A HREF="manual.html#IDX389">disconnecting, from the server</A>
<LI><A HREF="manual.html#IDX2260">disk full</A>
<LI><A HREF="manual.html#IDX812">disk issues</A>
<LI><A HREF="manual.html#IDX822">disks, splitting data across</A>
<LI><A HREF="manual.html#IDX1094">display size</A>
<LI><A HREF="manual.html#IDX994">displaying, database information</A>
<LI><A HREF="manual.html#IDX1740">displaying, information, <CODE>SHOW</CODE></A>, <A HREF="manual.html#IDX1744">displaying, information, <CODE>SHOW</CODE></A>, <A HREF="manual.html#IDX1753">displaying, information, <CODE>SHOW</CODE></A>, <A HREF="manual.html#IDX1768">displaying, information, <CODE>SHOW</CODE></A>
<LI><A HREF="manual.html#IDX1765">displaying, table status</A>
<LI><A HREF="manual.html#IDX810">DNS</A>
<LI><A HREF="manual.html#IDX2299">Documenters, list of</A>
<LI><A HREF="manual.html#IDX338">downgrading</A>
<LI><A HREF="manual.html#IDX182">downloading</A>
<LI><A HREF="manual.html#IDX582">dropping, user</A>, <A HREF="manual.html#IDX1679">dropping, user</A>
<LI><A HREF="manual.html#IDX979">dumping, databases</A>, <A HREF="manual.html#IDX984">dumping, databases</A>
<LI><A HREF="manual.html#IDX1832">dynamic table characteristics</A>
</DIR>
<H2>E</H2>
<DIR>
<LI><A HREF="manual.html#IDX2189">Eiffel Wrapper</A>
<LI><A HREF="manual.html#IDX91">email lists</A>
<LI><A HREF="manual.html#IDX2153">embedded MySQL server library</A>
<LI><A HREF="manual.html#IDX55">employment with MySQL</A>
<LI><A HREF="manual.html#IDX53">employment, contact information</A>
<LI><A HREF="manual.html#IDX394">entering, queries</A>
<LI><A HREF="manual.html#IDX1186">ENUM, size</A>
<LI><A HREF="manual.html#IDX466">environment variables</A>, <A HREF="manual.html#IDX567">environment variables</A>, <A HREF="manual.html#IDX836">environment variables</A>
<LI><A HREF="manual.html#IDX2336">environment variables, list of</A>
<LI><A HREF="manual.html#IDX459">environment varible, PATH</A>
<LI><A HREF="manual.html#IDX1001">Errcode</A>
<LI><A HREF="manual.html#IDX1000">errno</A>
<LI><A HREF="manual.html#IDX2248">error messages, can't find file</A>
<LI><A HREF="manual.html#IDX998">error messages, displaying</A>
<LI><A HREF="manual.html#IDX644">error messages, languages</A>
<LI><A HREF="manual.html#IDX2230">errors, access denied</A>
<LI><A HREF="manual.html#IDX629">errors, checking tables for</A>
<LI><A HREF="manual.html#IDX2228">errors, common</A>
<LI><A HREF="manual.html#IDX368">errors, directory checksum</A>
<LI><A HREF="manual.html#IDX2216">errors, handling for UDFs</A>
<LI><A HREF="manual.html#IDX161">errors, known</A>
<LI><A HREF="manual.html#IDX2243">errors, linking</A>
<LI><A HREF="manual.html#IDX2229">errors, list of</A>
<LI><A HREF="manual.html#IDX3">errors, reporting</A>, <A HREF="manual.html#IDX88">errors, reporting</A>, <A HREF="manual.html#IDX98">errors, reporting</A>
<LI><A HREF="manual.html#IDX1007">escape characters</A>
<LI><A HREF="manual.html#IDX720">estimating, query performance</A>
<LI><A HREF="manual.html#IDX491"><CODE>example</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX850">examples, compressed tables</A>
<LI><A HREF="manual.html#IDX639">examples, <CODE>myisamchk</CODE> output</A>
<LI><A HREF="manual.html#IDX442">examples, queries</A>
<LI><A HREF="manual.html#IDX2166">Excel</A>
<LI><A HREF="manual.html#IDX868"><CODE>execute</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1517">expression aliases</A>, <A HREF="manual.html#IDX1540">expression aliases</A>
<LI><A HREF="manual.html#IDX428">expressions, extended</A>
<LI><A HREF="manual.html#IDX117">extensions, to standard SQL</A>
<LI><A HREF="manual.html#IDX422">extracting, dates</A>
</DIR>
<H2>F</H2>
<DIR>
<LI><A HREF="manual.html#IDX271"><CODE>fatal signal 11</CODE></A>
<LI><A HREF="manual.html#IDX33">features of MySQL</A>
<LI><A HREF="manual.html#IDX1602">field, changing</A>
<LI><A HREF="manual.html#IDX660">files, binary log</A>
<LI><A HREF="manual.html#IDX265">files, <CODE>config.cache</CODE></A>
<LI><A HREF="manual.html#IDX646">files, error messages</A>
<LI><A HREF="manual.html#IDX226">files, log</A>, <A HREF="manual.html#IDX663">files, log</A>
<LI><A HREF="manual.html#IDX695">files, <TT>`my.cnf'</TT></A>
<LI><A HREF="manual.html#IDX2249">files, not found message</A>
<LI><A HREF="manual.html#IDX2247">files, permissions</A>
<LI><A HREF="manual.html#IDX656">files, query log</A>
<LI><A HREF="manual.html#IDX623">files, repairing</A>
<LI><A HREF="manual.html#IDX440">files, script</A>
<LI><A HREF="manual.html#IDX40">files, size limits</A>
<LI><A HREF="manual.html#IDX662">files, slow query log</A>
<LI><A HREF="manual.html#IDX990">files, text</A>
<LI><A HREF="manual.html#IDX316">files, <CODE>tmp</CODE></A>
<LI><A HREF="manual.html#IDX658">files, update log</A>
<LI><A HREF="manual.html#IDX1111">floating-point number</A>
<LI><A HREF="manual.html#IDX1045">floats</A>
<LI><A HREF="manual.html#IDX929">flush tables</A>
<LI><A HREF="manual.html#IDX869"><CODE>force</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX155">foreign key, constraint</A>
<LI><A HREF="manual.html#IDX1619">foreign key, deleting</A>, <A HREF="manual.html#IDX1869">foreign key, deleting</A>
<LI><A HREF="manual.html#IDX148">foreign keys</A>, <A HREF="manual.html#IDX443">foreign keys</A>, <A HREF="manual.html#IDX1615">foreign keys</A>
<LI><A HREF="manual.html#IDX77">free licensing</A>
<LI><A HREF="manual.html#IDX284">FreeBSD troubleshooting</A>
<LI><A HREF="manual.html#IDX611"><CODE>ft_max_word_len</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX612"><CODE>ft_min_word_len</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX613"><CODE>ft_stopword_file</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX2259">full disk</A>
<LI><A HREF="manual.html#IDX1430">full-text search</A>
<LI><A HREF="manual.html#IDX1431">FULLTEXT</A>
<LI><A HREF="manual.html#IDX2203">function, deleting</A>
<LI><A HREF="manual.html#IDX1194">functions</A>
<LI><A HREF="manual.html#IDX1193">functions for <CODE>SELECT</CODE> and <CODE>WHERE</CODE> clauses</A>
<LI><A HREF="manual.html#IDX2037">functions, C API</A>
<LI><A HREF="manual.html#IDX2106">functions, C Prepared statement API</A>
<LI><A HREF="manual.html#IDX1198">functions, grouping</A>
<LI><A HREF="manual.html#IDX2223">functions, native, adding</A>
<LI><A HREF="manual.html#IDX2195">functions, new</A>
<LI><A HREF="manual.html#IDX2199">functions, user-defined</A>
<LI><A HREF="manual.html#IDX2209">functions, user-defined, adding</A>
</DIR>
<H2>G</H2>
<DIR>
<LI><A HREF="manual.html#IDX236"><CODE>gcc</CODE></A>
<LI><A HREF="manual.html#IDX2323">gdb, using</A>
<LI><A HREF="manual.html#IDX2">general information</A>
<LI><A HREF="manual.html#IDX22">General Public License</A>
<LI><A HREF="manual.html#IDX71">General Public License, MySQL</A>
<LI><A HREF="manual.html#IDX1876">geographic feature</A>
<LI><A HREF="manual.html#IDX1878">geometry</A>
<LI><A HREF="manual.html#IDX1877">geospatial feature</A>
<LI><A HREF="manual.html#IDX185">getting MySQL</A>
<LI><A HREF="manual.html#IDX1872">GIS</A>, <A HREF="manual.html#IDX1874">GIS</A>
<LI><A HREF="manual.html#IDX1689">global privileges</A>
<LI><A HREF="manual.html#IDX25">goals of MySQL</A>
<LI><A HREF="manual.html#IDX2382">GPL, General Public License</A>
<LI><A HREF="manual.html#IDX2383">GPL, GNU General Public License</A>
<LI><A HREF="manual.html#IDX72">GPL, MySQL</A>
<LI><A HREF="manual.html#IDX563">grant tables</A>
<LI><A HREF="manual.html#IDX305">grant tables, re-creating</A>
<LI><A HREF="manual.html#IDX546">grant tables, sorting</A>, <A HREF="manual.html#IDX552">grant tables, sorting</A>
<LI><A HREF="manual.html#IDX353">grant tables, upgrading</A>
<LI><A HREF="manual.html#IDX1691">granting, privileges</A>
<LI><A HREF="manual.html#IDX944">graphical tool</A>
<LI><A HREF="manual.html#IDX1515"><CODE>GROUP BY</CODE>, aliases in</A>
<LI><A HREF="manual.html#IDX1512"><CODE>GROUP BY</CODE>, extensions to standard SQL</A>, <A HREF="manual.html#IDX1552"><CODE>GROUP BY</CODE>, extensions to standard SQL</A>
<LI><A HREF="manual.html#IDX1199">grouping, expressions</A>
<LI><A HREF="manual.html#IDX945">GUI tool</A>
</DIR>
<H2>H</H2>
<DIR>
<LI><A HREF="manual.html#IDX2007">Handlers</A>
<LI><A HREF="manual.html#IDX2217">handling, errors</A>
<LI><A HREF="manual.html#IDX1816"><CODE>HEAP</CODE> storage engine</A>, <A HREF="manual.html#IDX1845"><CODE>HEAP</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1817"><CODE>HEAP</CODE> table type</A>, <A HREF="manual.html#IDX1846"><CODE>HEAP</CODE> table type</A>
<LI><A HREF="manual.html#IDX860"><CODE>help</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX953"><CODE>help</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX492"><CODE>help</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX122">hints</A>, <A HREF="manual.html#IDX1555">hints</A>, <A HREF="manual.html#IDX1571">hints</A>, <A HREF="manual.html#IDX1572">hints</A>, <A HREF="manual.html#IDX1573">hints</A>
<LI><A HREF="manual.html#IDX27">history of MySQL</A>
<LI><A HREF="manual.html#IDX958"><CODE>history_size</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX558"><CODE>host</CODE> table</A>
<LI><A HREF="manual.html#IDX555"><CODE>host</CODE> table, sorting</A>
<LI><A HREF="manual.html#IDX870"><CODE>host</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX959"><CODE>host</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX811">hostname caching</A>
<LI><A HREF="manual.html#IDX529">hostname, default</A>
<LI><A HREF="manual.html#IDX871"><CODE>html</CODE>, <CODE>mysql</CODE> option</A>
</DIR>
<H2>I</H2>
<DIR>
<LI><A HREF="manual.html#IDX2142">ID, unique</A>
<LI><A HREF="manual.html#IDX1051">identifiers</A>
<LI><A HREF="manual.html#IDX1065">identifiers, case sensitivity</A>
<LI><A HREF="manual.html#IDX872"><CODE>ignore-space</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX988">importing, data</A>
<LI><A HREF="manual.html#IDX687">increasing with replication, speed</A>
<LI><A HREF="manual.html#IDX697">increasing, performance</A>
<LI><A HREF="manual.html#IDX1605">index, deleting</A>, <A HREF="manual.html#IDX1654">index, deleting</A>
<LI><A HREF="manual.html#IDX1627">indexes</A>
<LI><A HREF="manual.html#IDX769">indexes, and <CODE>BLOB</CODE> columns</A>, <A HREF="manual.html#IDX1639">indexes, and <CODE>BLOB</CODE> columns</A>
<LI><A HREF="manual.html#IDX783">indexes, and <CODE>IS NULL</CODE></A>
<LI><A HREF="manual.html#IDX780">indexes, and <CODE>LIKE</CODE></A>
<LI><A HREF="manual.html#IDX1637">indexes, and <CODE>NULL</CODE> values</A>
<LI><A HREF="manual.html#IDX771">indexes, and <CODE>TEXT</CODE> columns</A>, <A HREF="manual.html#IDX1641">indexes, and <CODE>TEXT</CODE> columns</A>
<LI><A HREF="manual.html#IDX1778">indexes, assigning to key cache</A>
<LI><A HREF="manual.html#IDX510">indexes, block size</A>
<LI><A HREF="manual.html#IDX765">indexes, columns</A>
<LI><A HREF="manual.html#IDX776">indexes, leftmost prefix of</A>
<LI><A HREF="manual.html#IDX773">indexes, multi-column</A>
<LI><A HREF="manual.html#IDX1628">indexes, multiple-part</A>
<LI><A HREF="manual.html#IDX1056">indexes, names</A>
<LI><A HREF="manual.html#IDX775">indexes, use of</A>
<LI><A HREF="manual.html#IDX1863">InnoDB</A>
<LI><A HREF="manual.html#IDX1820"><CODE>InnoDB</CODE> storage engine</A>, <A HREF="manual.html#IDX1860"><CODE>InnoDB</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1821"><CODE>InnoDB</CODE> table type</A>, <A HREF="manual.html#IDX1861"><CODE>InnoDB</CODE> table type</A>
<LI><A HREF="manual.html#IDX138"><CODE>InnoDB</CODE> tables</A>
<LI><A HREF="manual.html#IDX1531">INSERT DELAYED</A>
<LI><A HREF="manual.html#IDX743">inserting, speed of</A>
<LI><A HREF="manual.html#IDX188">installation layouts</A>
<LI><A HREF="manual.html#IDX217">installation overview</A>
<LI><A HREF="manual.html#IDX207">installing, binary distribution</A>
<LI><A HREF="manual.html#IDX202">installing, Linux RPM packages</A>
<LI><A HREF="manual.html#IDX204">installing, Mac OS X PKG packages</A>
<LI><A HREF="manual.html#IDX164">installing, overview</A>
<LI><A HREF="manual.html#IDX374">installing, Perl</A>
<LI><A HREF="manual.html#IDX375">installing, Perl on Windows</A>
<LI><A HREF="manual.html#IDX215">installing, source distribution</A>
<LI><A HREF="manual.html#IDX2220">installing, user-defined functions</A>
<LI><A HREF="manual.html#IDX1044">integers</A>
<LI><A HREF="manual.html#IDX273">internal compiler errors</A>
<LI><A HREF="manual.html#IDX746">internal locking</A>
<LI><A HREF="manual.html#IDX2191">internals</A>
<LI><A HREF="manual.html#IDX114">Internet Relay Chat</A>
<LI><A HREF="manual.html#IDX81">Internet Service Providers</A>
<LI><A HREF="manual.html#IDX1009">introducer, string literal</A>, <A HREF="manual.html#IDX1088">introducer, string literal</A>
<LI><A HREF="manual.html#IDX113">IRC</A>
<LI><A HREF="manual.html#IDX1818"><CODE>ISAM</CODE> storage engine</A>, <A HREF="manual.html#IDX1857"><CODE>ISAM</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1819"><CODE>ISAM</CODE> table type</A>, <A HREF="manual.html#IDX1858"><CODE>ISAM</CODE> table type</A>
<LI><A HREF="manual.html#IDX78">ISP services</A>
</DIR>
<H2>J</H2>
<DIR>
<LI><A HREF="manual.html#IDX2176">Java connectivity</A>
<LI><A HREF="manual.html#IDX2178">JDBC</A>
<LI><A HREF="manual.html#IDX56">jobs at MySQL</A>
</DIR>
<H2>K</H2>
<DIR>
<LI><A HREF="manual.html#IDX1777">key cache, assigning indexes to</A>
<LI><A HREF="manual.html#IDX785">Key cache, MyISAM</A>
<LI><A HREF="manual.html#IDX1831">key space, MyISAM</A>
<LI><A HREF="manual.html#IDX614"><CODE>key_buffer_size</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX767">keys</A>
<LI><A HREF="manual.html#IDX149">keys, foreign</A>, <A HREF="manual.html#IDX444">keys, foreign</A>
<LI><A HREF="manual.html#IDX774">keys, multi-column</A>
<LI><A HREF="manual.html#IDX447">keys, searching on two</A>
<LI><A HREF="manual.html#IDX1081">keywords</A>
<LI><A HREF="manual.html#IDX163">known errors</A>
</DIR>
<H2>L</H2>
<DIR>
<LI><A HREF="manual.html#IDX647">language support</A>
<LI><A HREF="manual.html#IDX2141">last row, unique ID</A>
<LI><A HREF="manual.html#IDX189">layout of installation</A>
<LI><A HREF="manual.html#IDX777">leftmost prefix of indexes</A>
<LI><A HREF="manual.html#IDX1053">legal names</A>
<LI><A HREF="manual.html#IDX2152">libmysqld</A>
<LI><A HREF="manual.html#IDX2301">libraries, list of</A>
<LI><A HREF="manual.html#IDX2024">library, <CODE>mysqlclient</CODE></A>
<LI><A HREF="manual.html#IDX67">licenses</A>
<LI><A HREF="manual.html#IDX63">licensing costs</A>
<LI><A HREF="manual.html#IDX68">licensing policy</A>
<LI><A HREF="manual.html#IDX57">licensing terms</A>
<LI><A HREF="manual.html#IDX54">licensing, contact information</A>
<LI><A HREF="manual.html#IDX73">licensing, examples</A>
<LI><A HREF="manual.html#IDX76">licensing, free</A>
<LI><A HREF="manual.html#IDX699">limitations, design</A>
<LI><A HREF="manual.html#IDX692">limitations, replication</A>
<LI><A HREF="manual.html#IDX39">limits, file-size</A>
<LI><A HREF="manual.html#IDX2147">linking</A>
<LI><A HREF="manual.html#IDX2242">linking, errors</A>
<LI><A HREF="manual.html#IDX2144">linking, problems</A>
<LI><A HREF="manual.html#IDX805">linking, speed</A>
<LI><A HREF="manual.html#IDX816">links, symbolic</A>
<LI><A HREF="manual.html#IDX360">Linux, binary distribution</A>
<LI><A HREF="manual.html#IDX362">Linux, source distribution</A>
<LI><A HREF="manual.html#IDX1006">literals</A>
<LI><A HREF="manual.html#IDX403">loading, tables</A>
<LI><A HREF="manual.html#IDX873"><CODE>local-infile</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX960"><CODE>local-infile</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX798">locking</A>
<LI><A HREF="manual.html#IDX747">locking methods</A>
<LI><A HREF="manual.html#IDX753">locking, page-level</A>
<LI><A HREF="manual.html#IDX144">locking, row-level</A>, <A HREF="manual.html#IDX752">locking, row-level</A>
<LI><A HREF="manual.html#IDX754">locking, table-level</A>
<LI><A HREF="manual.html#IDX654">Log files</A>
<LI><A HREF="manual.html#IDX225">log files</A>
<LI><A HREF="manual.html#IDX665">log files, maintaining</A>
<LI><A HREF="manual.html#IDX607">log files, names</A>
<LI><A HREF="manual.html#IDX2308">log, changes</A>
<LI><A HREF="manual.html#IDX493"><CODE>log</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX84">logos</A>
</DIR>
<H2>M</H2>
<DIR>
<LI><A HREF="manual.html#IDX203">Mac OS X, installation</A>
<LI><A HREF="manual.html#IDX108">mailing address, for customer support</A>
<LI><A HREF="manual.html#IDX5">mailing list address</A>
<LI><A HREF="manual.html#IDX90">mailing lists</A>
<LI><A HREF="manual.html#IDX93">mailing lists, archive location</A>
<LI><A HREF="manual.html#IDX112">mailing lists, guidelines</A>
<LI><A HREF="manual.html#IDX32">main features of MySQL</A>
<LI><A HREF="manual.html#IDX664">maintaining, log files</A>
<LI><A HREF="manual.html#IDX634">maintaining, tables</A>
<LI><A HREF="manual.html#IDX478"><CODE>make_binary_distribution</CODE></A>
<LI><A HREF="manual.html#IDX9">manual, available formats</A>
<LI><A HREF="manual.html#IDX8">manual, online location</A>
<LI><A HREF="manual.html#IDX11">manual, typographical conventions</A>
<LI><A HREF="manual.html#IDX689">master/slave setup</A>
<LI><A HREF="manual.html#IDX427">matching, patterns</A>
<LI><A HREF="manual.html#IDX905"><CODE>max_allowed_packet</CODE> variable</A>, <A HREF="manual.html#IDX975"><CODE>max_allowed_packet</CODE> variable</A>
<LI><A HREF="manual.html#IDX906"><CODE>max_join_size</CODE> variable</A>, <A HREF="manual.html#IDX976"><CODE>max_join_size</CODE> variable</A>
<LI><A HREF="manual.html#IDX933">maximum memory used</A>
<LI><A HREF="manual.html#IDX1969">MBR</A>
<LI><A HREF="manual.html#IDX1822"><CODE>MEMORY</CODE> storage engine</A>, <A HREF="manual.html#IDX1847"><CODE>MEMORY</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1823"><CODE>MEMORY</CODE> table type</A>, <A HREF="manual.html#IDX1848"><CODE>MEMORY</CODE> table type</A>
<LI><A HREF="manual.html#IDX624">memory usage, myisamchk</A>
<LI><A HREF="manual.html#IDX809">memory use</A>, <A HREF="manual.html#IDX932">memory use</A>
<LI><A HREF="manual.html#IDX1824"><CODE>MERGE</CODE> storage engine</A>, <A HREF="manual.html#IDX1839"><CODE>MERGE</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1825"><CODE>MERGE</CODE> table type</A>, <A HREF="manual.html#IDX1840"><CODE>MERGE</CODE> table type</A>
<LI><A HREF="manual.html#IDX1843">MERGE tables, defined</A>
<LI><A HREF="manual.html#IDX645">messages, languages</A>
<LI><A HREF="manual.html#IDX748">methods, locking</A>
<LI><A HREF="manual.html#IDX1970">Minimum Bounding Rectangle</A>
<LI><A HREF="manual.html#IDX186">mirror sites</A>
<LI><A HREF="manual.html#IDX295">MIT-pthreads</A>
<LI><A HREF="manual.html#IDX436">modes, batch</A>
<LI><A HREF="manual.html#IDX35">modules, list of</A>
<LI><A HREF="manual.html#IDX386">monitor, terminal</A>
<LI><A HREF="manual.html#IDX1315">mSQL compatibility</A>
<LI><A HREF="manual.html#IDX2025"><CODE>msql2mysql</CODE></A>
<LI><A HREF="manual.html#IDX488">multi mysqld</A>
<LI><A HREF="manual.html#IDX2240">multi-byte character sets</A>
<LI><A HREF="manual.html#IDX653">multi-byte characters</A>
<LI><A HREF="manual.html#IDX772">multi-column indexes</A>
<LI><A HREF="manual.html#IDX668">multiple servers</A>
<LI><A HREF="manual.html#IDX1629">multiple-part index</A>
<LI><A HREF="manual.html#IDX29">My, derivation</A>
<LI><A HREF="manual.html#IDX694"><TT>`my.cnf'</TT> file</A>
<LI><A HREF="manual.html#IDX784">MyISAM key cache</A>
<LI><A HREF="manual.html#IDX1826"><CODE>MyISAM</CODE> storage engine</A>, <A HREF="manual.html#IDX1828"><CODE>MyISAM</CODE> storage engine</A>
<LI><A HREF="manual.html#IDX1827"><CODE>MyISAM</CODE> table type</A>, <A HREF="manual.html#IDX1829"><CODE>MyISAM</CODE> table type</A>
<LI><A HREF="manual.html#IDX847">MyISAM, compressed tables</A>, <A HREF="manual.html#IDX1837">MyISAM, compressed tables</A>
<LI><A HREF="manual.html#IDX1176">MyISAM, size</A>
<LI><A HREF="manual.html#IDX615"><CODE>myisam_block_size</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX257"><CODE>myisamchk</CODE></A>, <A HREF="manual.html#IDX477"><CODE>myisamchk</CODE></A>
<LI><A HREF="manual.html#IDX640"><CODE>myisamchk</CODE>, example output</A>
<LI><A HREF="manual.html#IDX609"><CODE>myisamchk</CODE>, options</A>
<LI><A HREF="manual.html#IDX823"><CODE>myisampack</CODE></A>, <A HREF="manual.html#IDX848"><CODE>myisampack</CODE></A>, <A HREF="manual.html#IDX1647"><CODE>myisampack</CODE></A>, <A HREF="manual.html#IDX1838"><CODE>myisampack</CODE></A>
<LI><A HREF="manual.html#IDX2158">MyODBC</A>
<LI><A HREF="manual.html#IDX2175">MyODBC, reporting problems</A>
<LI><A HREF="manual.html#IDX824"><CODE>mysql</CODE></A>, <A HREF="manual.html#IDX855"><CODE>mysql</CODE></A>
<LI><A HREF="manual.html#IDX44">MySQL AB, defined</A>
<LI><A HREF="manual.html#IDX170">MySQL binary distribution</A>
<LI><A HREF="manual.html#IDX48">MySQL certification</A>
<LI><A HREF="manual.html#IDX856"><CODE>mysql</CODE> command-line options</A>
<LI><A HREF="manual.html#IDX916">mysql commands, list of</A>
<LI><A HREF="manual.html#IDX50">MySQL consulting</A>
<LI><A HREF="manual.html#IDX30">MySQL Dolphin name</A>
<LI><A HREF="manual.html#IDX26">MySQL history</A>
<LI><A HREF="manual.html#IDX913">mysql history file</A>
<LI><A HREF="manual.html#IDX89">MySQL mailing lists</A>
<LI><A HREF="manual.html#IDX28">MySQL name</A>
<LI><A HREF="manual.html#IDX918">mysql prompt command</A>
<LI><A HREF="manual.html#IDX171">MySQL source distribution</A>
<LI><A HREF="manual.html#IDX917">mysql status command</A>
<LI><A HREF="manual.html#IDX1810">MySQL storage engines</A>
<LI><A HREF="manual.html#IDX1811">MySQL table types</A>
<LI><A HREF="manual.html#IDX46">MySQL training</A>
<LI><A HREF="manual.html#IDX183">MySQL version</A>
<LI><A HREF="manual.html#IDX2184">MySQL++</A>
<LI><A HREF="manual.html#IDX16">MySQL, defined</A>
<LI><A HREF="manual.html#IDX17">MySQL, introduction</A>
<LI><A HREF="manual.html#IDX24">MySQL, pronunciation</A>
<LI><A HREF="manual.html#IDX473"><CODE>mysql.server</CODE></A>
<LI><A HREF="manual.html#IDX229">mysql.sock, changing location of</A>
<LI><A HREF="manual.html#IDX2261"><CODE>mysql.sock</CODE>, protection</A>
<LI><A HREF="manual.html#IDX2026"><CODE>mysql_config</CODE></A>
<LI><A HREF="manual.html#IDX476"><CODE>mysql_fix_privilege_tables</CODE></A>, <A HREF="manual.html#IDX564"><CODE>mysql_fix_privilege_tables</CODE></A>
<LI><A HREF="manual.html#IDX475"><CODE>mysql_install_db</CODE></A>
<LI><A HREF="manual.html#IDX312"><CODE>mysql_install_db</CODE> script</A>
<LI><A HREF="manual.html#IDX825"><CODE>mysqlaccess</CODE></A>
<LI><A HREF="manual.html#IDX826"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX922"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1625"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1651"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1764"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1774"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1780"><CODE>mysqladmin</CODE></A>, <A HREF="manual.html#IDX1784"><CODE>mysqladmin</CODE></A>
<LI><A HREF="manual.html#IDX934"><CODE>mysqladmin</CODE> command-line options</A>
<LI><A HREF="manual.html#IDX494"><CODE>mysqladmin</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX827"><CODE>mysqlbinlog</CODE></A>, <A HREF="manual.html#IDX942"><CODE>mysqlbinlog</CODE></A>
<LI><A HREF="manual.html#IDX479"><CODE>mysqlbug</CODE></A>
<LI><A HREF="manual.html#IDX99"><CODE>mysqlbug</CODE> script</A>
<LI><A HREF="manual.html#IDX6"><CODE>mysqlbug</CODE> script, location</A>
<LI><A HREF="manual.html#IDX828"><CODE>mysqlcc</CODE></A>, <A HREF="manual.html#IDX948"><CODE>mysqlcc</CODE></A>
<LI><A HREF="manual.html#IDX949"><CODE>mysqlcc</CODE> command-line options</A>
<LI><A HREF="manual.html#IDX829"><CODE>mysqlcheck</CODE></A>
<LI><A HREF="manual.html#IDX2022"><CODE>mysqlclient</CODE> library</A>
<LI><A HREF="manual.html#IDX470"><CODE>mysqld</CODE></A>
<LI><A HREF="manual.html#IDX503">mysqld options</A>
<LI><A HREF="manual.html#IDX803"><CODE>mysqld</CODE> options</A>
<LI><A HREF="manual.html#IDX800"><CODE>mysqld</CODE> server, buffer sizes</A>
<LI><A HREF="manual.html#IDX2246"><CODE>mysqld</CODE>, starting</A>
<LI><A HREF="manual.html#IDX471"><CODE>mysqld-max</CODE></A>, <A HREF="manual.html#IDX480"><CODE>mysqld-max</CODE></A>
<LI><A HREF="manual.html#IDX495"><CODE>mysqld</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX474"><CODE>mysqld_multi</CODE></A>, <A HREF="manual.html#IDX489"><CODE>mysqld_multi</CODE></A>
<LI><A HREF="manual.html#IDX472"><CODE>mysqld_safe</CODE></A>, <A HREF="manual.html#IDX484"><CODE>mysqld_safe</CODE></A>
<LI><A HREF="manual.html#IDX357"><CODE>mysqldump</CODE></A>, <A HREF="manual.html#IDX830"><CODE>mysqldump</CODE></A>, <A HREF="manual.html#IDX983"><CODE>mysqldump</CODE></A>
<LI><A HREF="manual.html#IDX831"><CODE>mysqlhotcopy</CODE></A>
<LI><A HREF="manual.html#IDX358"><CODE>mysqlimport</CODE></A>, <A HREF="manual.html#IDX832"><CODE>mysqlimport</CODE></A>, <A HREF="manual.html#IDX992"><CODE>mysqlimport</CODE></A>, <A HREF="manual.html#IDX1535"><CODE>mysqlimport</CODE></A>
<LI><A HREF="manual.html#IDX833"><CODE>mysqlshow</CODE></A>
<LI><A HREF="manual.html#IDX2193">mysqltest, MySQL Test Suite</A>
</DIR>
<H2>N</H2>
<DIR>
<LI><A HREF="manual.html#IDX193">named pipes</A>, <A HREF="manual.html#IDX195">named pipes</A>
<LI><A HREF="manual.html#IDX874"><CODE>named-commands</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1052">names</A>
<LI><A HREF="manual.html#IDX1067">names, case sensitivity</A>
<LI><A HREF="manual.html#IDX1075">names, variables</A>
<LI><A HREF="manual.html#IDX175">naming, releases of MySQL</A>
<LI><A HREF="manual.html#IDX2222">native functions, adding</A>
<LI><A HREF="manual.html#IDX166">native thread support</A>
<LI><A HREF="manual.html#IDX1046">negative values</A>
<LI><A HREF="manual.html#IDX1584">nested queries</A>
<LI><A HREF="manual.html#IDX1585">nested query</A>
<LI><A HREF="manual.html#IDX1586">nesting queries</A>
<LI><A HREF="manual.html#IDX92">net etiquette</A>, <A HREF="manual.html#IDX109">net etiquette</A>
<LI><A HREF="manual.html#IDX907"><CODE>net_buffer_length</CODE> variable</A>, <A HREF="manual.html#IDX977"><CODE>net_buffer_length</CODE> variable</A>
<LI><A HREF="manual.html#IDX543">netmask notation, in <CODE>mysql.user</CODE> table</A>
<LI><A HREF="manual.html#IDX206">NetWare</A>
<LI><A HREF="manual.html#IDX2226">new procedures, adding</A>
<LI><A HREF="manual.html#IDX213">new users, adding</A>, <A HREF="manual.html#IDX219">new users, adding</A>
<LI><A HREF="manual.html#IDX2287">no matching rows</A>
<LI><A HREF="manual.html#IDX875"><CODE>no-auto-rehash</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX876"><CODE>no-beep</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX496"><CODE>no-log</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX877"><CODE>no-named-commands</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX878"><CODE>no-pager</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX879"><CODE>no-tee</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1154">non-delimited strings</A>
<LI><A HREF="manual.html#IDX2283">Non-transactional tables</A>
<LI><A HREF="manual.html#IDX157">NOT NULL, constraint</A>
<LI><A HREF="manual.html#IDX205">Novell NetWare</A>
<LI><A HREF="manual.html#IDX425">NULL value</A>
<LI><A HREF="manual.html#IDX1636"><CODE>NULL</CODE> values, and indexes</A>
<LI><A HREF="manual.html#IDX2275"><CODE>NULL</CODE> values, vs. empty values</A>
<LI><A HREF="manual.html#IDX1207"><CODE>NULL</CODE>, testing for null</A>, <A HREF="manual.html#IDX1221"><CODE>NULL</CODE>, testing for null</A>, <A HREF="manual.html#IDX1228"><CODE>NULL</CODE>, testing for null</A>, <A HREF="manual.html#IDX1253"><CODE>NULL</CODE>, testing for null</A>
<LI><A HREF="manual.html#IDX2281"><CODE>NULL</CODE> values, and <CODE>AUTO_INCREMENT</CODE> columns</A>
<LI><A HREF="manual.html#IDX2280"><CODE>NULL</CODE> values, and <CODE>TIMESTAMP</CODE> columns</A>
<LI><A HREF="manual.html#IDX1042">numbers</A>
<LI><A HREF="manual.html#IDX1177">numeric types</A>
</DIR>
<H2>O</H2>
<DIR>
<LI><A HREF="manual.html#IDX2156">ODBC</A>
<LI><A HREF="manual.html#IDX1063">ODBC compatibility</A>, <A HREF="manual.html#IDX1114">ODBC compatibility</A>, <A HREF="manual.html#IDX1203">ODBC compatibility</A>, <A HREF="manual.html#IDX1224">ODBC compatibility</A>, <A HREF="manual.html#IDX1569">ODBC compatibility</A>, <A HREF="manual.html#IDX1631">ODBC compatibility</A>, <A HREF="manual.html#IDX2315">ODBC compatibility</A>
<LI><A HREF="manual.html#IDX2160">ODBC, administrator</A>
<LI><A HREF="manual.html#IDX2168">odbcadmin program</A>
<LI><A HREF="manual.html#IDX880"><CODE>one-database</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX7">online location of manual</A>
<LI><A HREF="manual.html#IDX21"><CODE>Open Source</CODE>, defined</A>
<LI><A HREF="manual.html#IDX787">open tables</A>, <A HREF="manual.html#IDX931">open tables</A>
<LI><A HREF="manual.html#IDX943"><CODE>open_files_limit</CODE> variable</A>
<LI><A HREF="manual.html#IDX1875">OpenGIS</A>
<LI><A HREF="manual.html#IDX791">opening, tables</A>
<LI><A HREF="manual.html#IDX928">opens</A>
<LI><A HREF="manual.html#IDX595">OpenSSL</A>
<LI><A HREF="manual.html#IDX38">operating systems, file-size limits</A>
<LI><A HREF="manual.html#IDX165">operating systems, supported</A>
<LI><A HREF="manual.html#IDX197">operating systems, Windows versus Unix</A>
<LI><A HREF="manual.html#IDX1321">operations, arithmetic</A>
<LI><A HREF="manual.html#IDX1195">operators</A>
<LI><A HREF="manual.html#IDX1247">operators, cast</A>, <A HREF="manual.html#IDX1320">operators, cast</A>
<LI><A HREF="manual.html#IDX744">optimization, tips</A>
<LI><A HREF="manual.html#IDX726">optimizations</A>, <A HREF="manual.html#IDX731">optimizations</A>
<LI><A HREF="manual.html#IDX735">optimizing, DISTINCT</A>
<LI><A HREF="manual.html#IDX737">optimizing, LEFT JOIN</A>
<LI><A HREF="manual.html#IDX739">optimizing, LIMIT</A>
<LI><A HREF="manual.html#IDX633">optimizing, tables</A>
<LI><A HREF="manual.html#IDX461">option files</A>, <A HREF="manual.html#IDX565">option files</A>
<LI><A HREF="manual.html#IDX502">options, command-line</A>
<LI><A HREF="manual.html#IDX858">options, command-line, <CODE>mysql</CODE></A>
<LI><A HREF="manual.html#IDX936">options, command-line, <CODE>mysqladmin</CODE></A>
<LI><A HREF="manual.html#IDX951">options, command-line, <CODE>mysqlcc</CODE></A>
<LI><A HREF="manual.html#IDX223">options, configure</A>
<LI><A HREF="manual.html#IDX608">options, <CODE>myisamchk</CODE></A>
<LI><A HREF="manual.html#IDX387">options, provided by MySQL</A>
<LI><A HREF="manual.html#IDX690">options, replication</A>
<LI><A HREF="manual.html#IDX730">OR <CODE>Index Merge</CODE> optimization</A>
<LI><A HREF="manual.html#IDX127">Oracle compatibility</A>, <A HREF="manual.html#IDX1506">Oracle compatibility</A>, <A HREF="manual.html#IDX1661">Oracle compatibility</A>
<LI><A HREF="manual.html#IDX1513"><CODE>ORDER BY</CODE>, aliases in</A>
<LI><A HREF="manual.html#IDX1">overview</A>
</DIR>
<H2>P</H2>
<DIR>
<LI><A HREF="manual.html#IDX849"><CODE>pack_isam</CODE></A>
<LI><A HREF="manual.html#IDX2302">packages, list of</A>
<LI><A HREF="manual.html#IDX750">page-level locking</A>
<LI><A HREF="manual.html#IDX881"><CODE>pager</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX799">parameters, server</A>
<LI><A HREF="manual.html#IDX51">partnering with MySQL AB</A>
<LI><A HREF="manual.html#IDX1460">password encryption, reversibility of</A>
<LI><A HREF="manual.html#IDX335">password, root user</A>
<LI><A HREF="manual.html#IDX882"><CODE>password</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX961"><CODE>password</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX497"><CODE>password</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX570">passwords, for users</A>
<LI><A HREF="manual.html#IDX2254">passwords, forgotten</A>
<LI><A HREF="manual.html#IDX2255">passwords, lost</A>
<LI><A HREF="manual.html#IDX2256">passwords, resetting</A>
<LI><A HREF="manual.html#IDX523">passwords, security</A>
<LI><A HREF="manual.html#IDX590">passwords, setting</A>, <A HREF="manual.html#IDX1692">passwords, setting</A>, <A HREF="manual.html#IDX1697">passwords, setting</A>
<LI><A HREF="manual.html#IDX458">PATH environment variable</A>
<LI><A HREF="manual.html#IDX426">pattern matching</A>
<LI><A HREF="manual.html#IDX710">performance, benchmarks</A>
<LI><A HREF="manual.html#IDX813">performance, disk issues</A>
<LI><A HREF="manual.html#IDX722">performance, estimating</A>
<LI><A HREF="manual.html#IDX696">performance, improving</A>, <A HREF="manual.html#IDX764">performance, improving</A>
<LI><A HREF="manual.html#IDX2181">Perl API</A>
<LI><A HREF="manual.html#IDX379">Perl DBI/DBD, installation problems</A>
<LI><A HREF="manual.html#IDX373">Perl, installing</A>
<LI><A HREF="manual.html#IDX376">Perl, installing on Windows</A>
<LI><A HREF="manual.html#IDX712">permission checks, effect on speed</A>
<LI><A HREF="manual.html#IDX834"><CODE>perror</CODE></A>
<LI><A HREF="manual.html#IDX999">perror</A>
<LI><A HREF="manual.html#IDX2179">PHP API</A>
<LI><A HREF="manual.html#IDX962"><CODE>plugins_path</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX883"><CODE>port</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX963"><CODE>port</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX701">portability</A>
<LI><A HREF="manual.html#IDX1191">portability, types</A>
<LI><A HREF="manual.html#IDX2319">porting, to other systems</A>
<LI><A HREF="manual.html#IDX666">post-install, multiple servers</A>
<LI><A HREF="manual.html#IDX299">post-installation, setup and testing</A>
<LI><A HREF="manual.html#IDX129">PostgreSQL compatibility</A>
<LI><A HREF="manual.html#IDX65">prices, support</A>
<LI><A HREF="manual.html#IDX154">PRIMARY KEY, constraint</A>
<LI><A HREF="manual.html#IDX1608">primary key, deleting</A>
<LI><A HREF="manual.html#IDX526">privilege information, location</A>
<LI><A HREF="manual.html#IDX522">privilege system</A>
<LI><A HREF="manual.html#IDX524">privilege system, described</A>
<LI><A HREF="manual.html#IDX560">privilege, changes</A>
<LI><A HREF="manual.html#IDX518">privileges, access</A>
<LI><A HREF="manual.html#IDX573">privileges, adding</A>
<LI><A HREF="manual.html#IDX327">privileges, default</A>
<LI><A HREF="manual.html#IDX580">privileges, deleting</A>, <A HREF="manual.html#IDX1677">privileges, deleting</A>
<LI><A HREF="manual.html#IDX1750">privileges, display</A>
<LI><A HREF="manual.html#IDX581">privileges, dropping</A>, <A HREF="manual.html#IDX1678">privileges, dropping</A>
<LI><A HREF="manual.html#IDX1687">privileges, granting</A>
<LI><A HREF="manual.html#IDX1688">privileges, revoking</A>
<LI><A HREF="manual.html#IDX2231">problems, access denied errors</A>
<LI><A HREF="manual.html#IDX2227">problems, common errors</A>
<LI><A HREF="manual.html#IDX262">problems, compiling</A>
<LI><A HREF="manual.html#IDX2274">problems, <CODE>DATE</CODE> columns</A>
<LI><A HREF="manual.html#IDX1156">problems, date values</A>
<LI><A HREF="manual.html#IDX372">problems, installing on IBM-AIX</A>
<LI><A HREF="manual.html#IDX366">problems, installing on Solaris</A>
<LI><A HREF="manual.html#IDX378">problems, installing Perl</A>
<LI><A HREF="manual.html#IDX2244">problems, linking</A>
<LI><A HREF="manual.html#IDX2174">problems, ODBC</A>
<LI><A HREF="manual.html#IDX97">problems, reporting</A>
<LI><A HREF="manual.html#IDX326">problems, starting the server</A>
<LI><A HREF="manual.html#IDX756">problems, table locking</A>
<LI><A HREF="manual.html#IDX2265">problems, time zone</A>
<LI><A HREF="manual.html#IDX2224">procedures, adding</A>
<LI><A HREF="manual.html#IDX146">procedures, stored</A>, <A HREF="manual.html#IDX1989">procedures, stored</A>
<LI><A HREF="manual.html#IDX168">process support</A>
<LI><A HREF="manual.html#IDX1761">processes, display</A>
<LI><A HREF="manual.html#IDX2213">processing, arguments</A>
<LI><A HREF="manual.html#IDX75">products, selling</A>
<LI><A HREF="manual.html#IDX467">program variables, setting</A>
<LI><A HREF="manual.html#IDX2149">programs, client</A>
<LI><A HREF="manual.html#IDX703">programs, crash-me</A>
<LI><A HREF="manual.html#IDX469">programs, list of</A>
<LI><A HREF="manual.html#IDX884"><CODE>prompt</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX395">prompts, meanings</A>
<LI><A HREF="manual.html#IDX23">pronunciation, MySQL</A>
<LI><A HREF="manual.html#IDX350">Protocol mismatch</A>
<LI><A HREF="manual.html#IDX885"><CODE>protocol</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX2187">Python API</A>
</DIR>
<H2>Q</H2>
<DIR>
<LI><A HREF="manual.html#IDX393">queries, entering</A>
<LI><A HREF="manual.html#IDX721">queries, estimating performance</A>
<LI><A HREF="manual.html#IDX441">queries, examples</A>
<LI><A HREF="manual.html#IDX711">queries, speed of</A>
<LI><A HREF="manual.html#IDX456">queries, Twin Studies project</A>
<LI><A HREF="manual.html#IDX681">Query Cache</A>
<LI><A HREF="manual.html#IDX655">query log</A>
<LI><A HREF="manual.html#IDX964"><CODE>query</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX926">questions</A>
<LI><A HREF="manual.html#IDX110">questions, answering</A>
<LI><A HREF="manual.html#IDX886"><CODE>quick</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1036">quotes, in strings</A>
<LI><A HREF="manual.html#IDX1038">quoting</A>
<LI><A HREF="manual.html#IDX1037">quoting binary data</A>
</DIR>
<H2>R</H2>
<DIR>
<LI><A HREF="manual.html#IDX281">RAID, compile errors</A>
<LI><A HREF="manual.html#IDX1642">RAID, table type</A>
<LI><A HREF="manual.html#IDX887"><CODE>raw</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX306">re-creating, grant tables</A>
<LI><A HREF="manual.html#IDX616"><CODE>read_buffer_size</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX263">reconfiguring</A>, <A HREF="manual.html#IDX268">reconfiguring</A>
<LI><A HREF="manual.html#IDX888"><CODE>reconnect</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX626">recovery, from crash</A>
<LI><A HREF="manual.html#IDX761">reducing, data size</A>
<LI><A HREF="manual.html#IDX1616">references</A>
<LI><A HREF="manual.html#IDX2379">regex</A>
<LI><A HREF="manual.html#IDX965"><CODE>register</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX2380">regular expression syntax, described</A>
<LI><A HREF="manual.html#IDX19">relational databases, defined</A>
<LI><A HREF="manual.html#IDX172">release numbers</A>
<LI><A HREF="manual.html#IDX176">releases, naming scheme</A>
<LI><A HREF="manual.html#IDX177">releases, testing</A>
<LI><A HREF="manual.html#IDX179">releases, updating</A>
<LI><A HREF="manual.html#IDX2292">reordering, columns</A>
<LI><A HREF="manual.html#IDX622">repair options, myisamchk</A>
<LI><A HREF="manual.html#IDX631">repairing, tables</A>
<LI><A HREF="manual.html#IDX835"><CODE>replace</CODE></A>
<LI><A HREF="manual.html#IDX1003">replace utility</A>
<LI><A HREF="manual.html#IDX685">replication</A>
<LI><A HREF="manual.html#IDX693">replication limitations</A>
<LI><A HREF="manual.html#IDX1787">replication masters, commands</A>
<LI><A HREF="manual.html#IDX691">replication options</A>
<LI><A HREF="manual.html#IDX1797">replication slaves, commands</A>
<LI><A HREF="manual.html#IDX96">reporting, bugs</A>
<LI><A HREF="manual.html#IDX4">reporting, errors</A>, <A HREF="manual.html#IDX87">reporting, errors</A>
<LI><A HREF="manual.html#IDX2173">reporting, MyODBC problems</A>
<LI><A HREF="manual.html#IDX1082">reserved words, exceptions</A>
<LI><A HREF="manual.html#IDX311">restarting, the server</A>
<LI><A HREF="manual.html#IDX408">retrieving, data from tables</A>
<LI><A HREF="manual.html#IDX2215">return values, UDFs</A>
<LI><A HREF="manual.html#IDX1690">revoking, privileges</A>
<LI><A HREF="manual.html#IDX329">root password</A>
<LI><A HREF="manual.html#IDX2257">root user, password resetting</A>
<LI><A HREF="manual.html#IDX1110">rounding errors</A>, <A HREF="manual.html#IDX1369">rounding errors</A>
<LI><A HREF="manual.html#IDX749">row-level locking</A>
<LI><A HREF="manual.html#IDX429">rows, counting</A>
<LI><A HREF="manual.html#IDX2285">rows, deleting</A>
<LI><A HREF="manual.html#IDX143">rows, locking</A>
<LI><A HREF="manual.html#IDX2288">rows, matching problems</A>
<LI><A HREF="manual.html#IDX410">rows, selecting</A>
<LI><A HREF="manual.html#IDX416">rows, sorting</A>
<LI><A HREF="manual.html#IDX200">RPM file</A>
<LI><A HREF="manual.html#IDX201">RPM Package Manager</A>
<LI><A HREF="manual.html#IDX2333">RTS-threads</A>
<LI><A HREF="manual.html#IDX83">running a Web server</A>
<LI><A HREF="manual.html#IDX266">running <CODE>configure</CODE> after prior invocation</A>
<LI><A HREF="manual.html#IDX120">running, ANSI mode</A>
<LI><A HREF="manual.html#IDX438">running, batch mode</A>
<LI><A HREF="manual.html#IDX670">running, multiple servers</A>
<LI><A HREF="manual.html#IDX392">running, queries</A>
</DIR>
<H2>S</H2>
<DIR>
<LI><A HREF="manual.html#IDX919"><CODE>safe-updates</CODE> option</A>
<LI><A HREF="manual.html#IDX889"><CODE>safe-updates</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX485"><CODE>safe_mysqld</CODE></A>
<LI><A HREF="manual.html#IDX31">Sakila</A>
<LI><A HREF="manual.html#IDX439">script files</A>
<LI><A HREF="manual.html#IDX483">scripts</A>, <A HREF="manual.html#IDX487">scripts</A>
<LI><A HREF="manual.html#IDX313">scripts, <CODE>mysql_install_db</CODE></A>
<LI><A HREF="manual.html#IDX101">scripts, <CODE>mysqlbug</CODE></A>
<LI><A HREF="manual.html#IDX853">scripts, SQL</A>
<LI><A HREF="manual.html#IDX2269">searching, and case sensitivity</A>
<LI><A HREF="manual.html#IDX1429">searching, full-text</A>
<LI><A HREF="manual.html#IDX94">searching, MySQL Web pages</A>
<LI><A HREF="manual.html#IDX446">searching, two keys</A>
<LI><A HREF="manual.html#IDX519">security system</A>
<LI><A HREF="manual.html#IDX515">security, against attackers</A>
<LI><A HREF="manual.html#IDX682"><CODE>SELECT</CODE>, Query Cache</A>
<LI><A HREF="manual.html#IDX908"><CODE>select_limit</CODE> variable</A>, <A HREF="manual.html#IDX978"><CODE>select_limit</CODE> variable</A>
<LI><A HREF="manual.html#IDX399">selecting, databases</A>
<LI><A HREF="manual.html#IDX74">selling products</A>
<LI><A HREF="manual.html#IDX453">SEQUENCE</A>
<LI><A HREF="manual.html#IDX1475">sequence emulation</A>
<LI><A HREF="manual.html#IDX454">sequences</A>
<LI><A HREF="manual.html#IDX921">server administration</A>
<LI><A HREF="manual.html#IDX505">server variables</A>, <A HREF="manual.html#IDX1078">server variables</A>, <A HREF="manual.html#IDX1771">server variables</A>
<LI><A HREF="manual.html#IDX390">server, connecting</A>, <A HREF="manual.html#IDX530">server, connecting</A>
<LI><A HREF="manual.html#IDX2320">server, debugging</A>
<LI><A HREF="manual.html#IDX391">server, disconnecting</A>
<LI><A HREF="manual.html#IDX310">server, restart</A>
<LI><A HREF="manual.html#IDX308">server, shutdown</A>
<LI><A HREF="manual.html#IDX303">server, starting</A>
<LI><A HREF="manual.html#IDX323">server, starting and stopping</A>
<LI><A HREF="manual.html#IDX325">server, starting problems</A>
<LI><A HREF="manual.html#IDX966"><CODE>server</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX669">servers, multiple</A>
<LI><A HREF="manual.html#IDX79">services, ISP</A>
<LI><A HREF="manual.html#IDX80">services, Web</A>
<LI><A HREF="manual.html#IDX1187">SET, size</A>
<LI><A HREF="manual.html#IDX1698">setting passwords</A>
<LI><A HREF="manual.html#IDX468">setting program variables</A>
<LI><A HREF="manual.html#IDX591">setting, passwords</A>
<LI><A HREF="manual.html#IDX301">setup, post-installation</A>
<LI><A HREF="manual.html#IDX14">shell syntax</A>
<LI><A HREF="manual.html#IDX997">showing, database information</A>
<LI><A HREF="manual.html#IDX941"><CODE>shutdown_timeout</CODE> variable</A>
<LI><A HREF="manual.html#IDX309">shutting down, the server</A>
<LI><A HREF="manual.html#IDX1646">silent column changes</A>
<LI><A HREF="manual.html#IDX890"><CODE>silent</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX37">size of tables</A>
<LI><A HREF="manual.html#IDX1095">sizes, display</A>
<LI><A HREF="manual.html#IDX891"><CODE>skip-column-names</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX892"><CODE>skip-line-numbers</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX927">slow queries</A>
<LI><A HREF="manual.html#IDX661">slow query log</A>
<LI><A HREF="manual.html#IDX228">socket location, changing</A>
<LI><A HREF="manual.html#IDX893"><CODE>socket</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX967"><CODE>socket</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX365">Solaris installation problems</A>
<LI><A HREF="manual.html#IDX283">Solaris troubleshooting</A>
<LI><A HREF="manual.html#IDX617"><CODE>sort_buffer_size</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX618"><CODE>sort_key_blocks</CODE> <CODE>myisamchk</CODE> variable</A>
<LI><A HREF="manual.html#IDX643">sorting, character sets</A>
<LI><A HREF="manual.html#IDX418">sorting, data</A>
<LI><A HREF="manual.html#IDX547">sorting, grant tables</A>, <A HREF="manual.html#IDX553">sorting, grant tables</A>
<LI><A HREF="manual.html#IDX417">sorting, table rows</A>
<LI><A HREF="manual.html#IDX216">source distribution, installing</A>
<LI><A HREF="manual.html#IDX361">source distributions, on Linux</A>
<LI><A HREF="manual.html#IDX1873">Spatial Extensions in MySQL</A>
<LI><A HREF="manual.html#IDX807">speed, compiling</A>
<LI><A HREF="manual.html#IDX688">speed, increasing with replication</A>
<LI><A HREF="manual.html#IDX742">speed, inserting</A>
<LI><A HREF="manual.html#IDX808">speed, linking</A>
<LI><A HREF="manual.html#IDX713">speed, of queries</A>, <A HREF="manual.html#IDX724">speed, of queries</A>
<LI><A HREF="manual.html#IDX1785">SQL commands, replication masters</A>
<LI><A HREF="manual.html#IDX1795">SQL commands, replication slaves</A>
<LI><A HREF="manual.html#IDX854">SQL scripts</A>
<LI><A HREF="manual.html#IDX20">SQL, defined</A>
<LI><A HREF="manual.html#IDX118">SQL-92, extensions to</A>
<LI><A HREF="manual.html#IDX272"><CODE>sql_yacc.cc</CODE> problems</A>
<LI><A HREF="manual.html#IDX1099">square brackets</A>
<LI><A HREF="manual.html#IDX603">SSH</A>
<LI><A HREF="manual.html#IDX596">SSL and X509 Basics</A>
<LI><A HREF="manual.html#IDX602">SSL command-line options</A>
<LI><A HREF="manual.html#IDX599">SSL related options</A>, <A HREF="manual.html#IDX1693">SSL related options</A>
<LI><A HREF="manual.html#IDX34">stability</A>
<LI><A HREF="manual.html#IDX1695">Standard SQL, differences from</A>
<LI><A HREF="manual.html#IDX119">standard SQL, extensions to</A>
<LI><A HREF="manual.html#IDX116">standards compatibility</A>
<LI><A HREF="manual.html#IDX667">Starting many servers</A>
<LI><A HREF="manual.html#IDX152">starting, comments</A>
<LI><A HREF="manual.html#IDX2245">starting, <CODE>mysqld</CODE></A>
<LI><A HREF="manual.html#IDX302">starting, the server</A>
<LI><A HREF="manual.html#IDX321">starting, the server automatically</A>
<LI><A HREF="manual.html#IDX463">startup options, default</A>
<LI><A HREF="manual.html#IDX802">startup parameters</A>
<LI><A HREF="manual.html#IDX859">startup parameters, <CODE>mysql</CODE></A>
<LI><A HREF="manual.html#IDX937">startup parameters, <CODE>mysqladmin</CODE></A>
<LI><A HREF="manual.html#IDX952">startup parameters, <CODE>mysqlcc</CODE></A>
<LI><A HREF="manual.html#IDX797">startup parameters, tuning</A>
<LI><A HREF="manual.html#IDX231">statically, compiling</A>
<LI><A HREF="manual.html#IDX923">status command, results</A>
<LI><A HREF="manual.html#IDX511">status variables</A>, <A HREF="manual.html#IDX1762">status variables</A>
<LI><A HREF="manual.html#IDX1767">status, tables</A>
<LI><A HREF="manual.html#IDX322">stopping, the server</A>
<LI><A HREF="manual.html#IDX1808">storage engines, choosing</A>
<LI><A HREF="manual.html#IDX759">storage of data</A>
<LI><A HREF="manual.html#IDX1174">storage requirements, column type</A>
<LI><A HREF="manual.html#IDX762">storage space, minimising</A>
<LI><A HREF="manual.html#IDX1988">stored procedures</A>
<LI><A HREF="manual.html#IDX145">stored procedures and triggers, defined</A>
<LI><A HREF="manual.html#IDX651">string collating</A>
<LI><A HREF="manual.html#IDX1311">string comparisons, case sensitivity</A>
<LI><A HREF="manual.html#IDX1010">string literal introducer</A>, <A HREF="manual.html#IDX1089">string literal introducer</A>
<LI><A HREF="manual.html#IDX1002">string replacement, replace utility</A>
<LI><A HREF="manual.html#IDX1163">string types</A>
<LI><A HREF="manual.html#IDX1004">strings, defined</A>
<LI><A HREF="manual.html#IDX1005">strings, escaping characters</A>
<LI><A HREF="manual.html#IDX1155">strings, non-delimited</A>
<LI><A HREF="manual.html#IDX814">striping, defined</A>
<LI><A HREF="manual.html#IDX1582">subqueries</A>
<LI><A HREF="manual.html#IDX1583">subquery</A>
<LI><A HREF="manual.html#IDX1581">subselects</A>
<LI><A HREF="manual.html#IDX330">superuser</A>
<LI><A HREF="manual.html#IDX64">support costs</A>
<LI><A HREF="manual.html#IDX58">support terms</A>
<LI><A HREF="manual.html#IDX169">support, for operating systems</A>
<LI><A HREF="manual.html#IDX70">support, licensing</A>
<LI><A HREF="manual.html#IDX106">support, mailing address</A>
<LI><A HREF="manual.html#IDX59">support, types</A>
<LI><A HREF="manual.html#IDX159">suppression, default values</A>, <A HREF="manual.html#IDX248">suppression, default values</A>
<LI><A HREF="manual.html#IDX1664">Sybase compatibility</A>
<LI><A HREF="manual.html#IDX815">symbolic links</A>, <A HREF="manual.html#IDX820">symbolic links</A>
<LI><A HREF="manual.html#IDX2381">syntax, regular expression</A>
<LI><A HREF="manual.html#IDX968"><CODE>syntax</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX969"><CODE>syntax_file</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX796">system optimization</A>
<LI><A HREF="manual.html#IDX716">system table</A>
<LI><A HREF="manual.html#IDX504">system variables</A>, <A HREF="manual.html#IDX1077">system variables</A>, <A HREF="manual.html#IDX1770">system variables</A>
<LI><A HREF="manual.html#IDX521">system, privilege</A>
<LI><A HREF="manual.html#IDX513">system, security</A>
</DIR>
<H2>T</H2>
<DIR>
<LI><A HREF="manual.html#IDX1550">table aliases</A>
<LI><A HREF="manual.html#IDX793">table cache</A>
<LI><A HREF="manual.html#IDX1737">table is full</A>, <A HREF="manual.html#IDX2236">table is full</A>
<LI><A HREF="manual.html#IDX1070">table names, case sensitivity</A>
<LI><A HREF="manual.html#IDX125">table names, case-sensitivity</A>
<LI><A HREF="manual.html#IDX1809">table types, choosing</A>
<LI><A HREF="manual.html#IDX1597">table, changing</A>, <A HREF="manual.html#IDX1614">table, changing</A>, <A HREF="manual.html#IDX2291">table, changing</A>
<LI><A HREF="manual.html#IDX1657">table, deleting</A>
<LI><A HREF="manual.html#IDX751">table-level locking</A>
<LI><A HREF="manual.html#IDX894"><CODE>table</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1855">tables, <CODE>BDB</CODE></A>
<LI><A HREF="manual.html#IDX1856">tables, <CODE>Berkeley DB</CODE></A>
<LI><A HREF="manual.html#IDX2295">tables, changing column order</A>
<LI><A HREF="manual.html#IDX621">tables, checking</A>
<LI><A HREF="manual.html#IDX790">tables, closing</A>
<LI><A HREF="manual.html#IDX846">tables, compressed</A>
<LI><A HREF="manual.html#IDX1835">tables, compressed format</A>
<LI><A HREF="manual.html#IDX719">tables, constant</A>, <A HREF="manual.html#IDX728">tables, constant</A>
<LI><A HREF="manual.html#IDX1645">tables, copying</A>
<LI><A HREF="manual.html#IDX430">tables, counting rows</A>
<LI><A HREF="manual.html#IDX401">tables, creating</A>
<LI><A HREF="manual.html#IDX637">tables, defragment</A>, <A HREF="manual.html#IDX1834">tables, defragment</A>
<LI><A HREF="manual.html#IDX1705">tables, defragmenting</A>
<LI><A HREF="manual.html#IDX2286">tables, deleting rows</A>
<LI><A HREF="manual.html#IDX995">tables, displaying</A>
<LI><A HREF="manual.html#IDX1766">tables, displaying status</A>
<LI><A HREF="manual.html#IDX981">tables, dumping</A>, <A HREF="manual.html#IDX986">tables, dumping</A>
<LI><A HREF="manual.html#IDX1833">tables, dynamic</A>
<LI><A HREF="manual.html#IDX628">tables, error checking</A>
<LI><A HREF="manual.html#IDX930">tables, flush</A>
<LI><A HREF="manual.html#IDX1706">tables, fragmentation</A>
<LI><A HREF="manual.html#IDX562">tables, grant</A>
<LI><A HREF="manual.html#IDX1850">tables, <CODE>HEAP</CODE></A>
<LI><A HREF="manual.html#IDX559">tables, <CODE>host</CODE></A>
<LI><A HREF="manual.html#IDX763">tables, improving performance</A>
<LI><A HREF="manual.html#IDX638">tables, information</A>
<LI><A HREF="manual.html#IDX434">tables, information about</A>
<LI><A HREF="manual.html#IDX1862">tables, <CODE>InnoDB</CODE></A>
<LI><A HREF="manual.html#IDX1859">tables, ISAM</A>
<LI><A HREF="manual.html#IDX404">tables, loading data</A>
<LI><A HREF="manual.html#IDX635">tables, maintenance regimen</A>
<LI><A HREF="manual.html#IDX36">tables, maximum size</A>
<LI><A HREF="manual.html#IDX1849">tables, <CODE>MEMORY</CODE></A>
<LI><A HREF="manual.html#IDX1841">tables, <CODE>MERGE</CODE></A>
<LI><A HREF="manual.html#IDX1842">tables, merging</A>
<LI><A HREF="manual.html#IDX432">tables, multiple</A>
<LI><A HREF="manual.html#IDX1830">tables, <CODE>MyISAM</CODE></A>
<LI><A HREF="manual.html#IDX1055">tables, names</A>
<LI><A HREF="manual.html#IDX786">tables, open</A>
<LI><A HREF="manual.html#IDX789">tables, opening</A>
<LI><A HREF="manual.html#IDX632">tables, optimizing</A>
<LI><A HREF="manual.html#IDX1844">tables, partitioning</A>
<LI><A HREF="manual.html#IDX1643">tables, RAID</A>
<LI><A HREF="manual.html#IDX630">tables, repairing</A>
<LI><A HREF="manual.html#IDX407">tables, retrieving data</A>
<LI><A HREF="manual.html#IDX413">tables, selecting columns</A>
<LI><A HREF="manual.html#IDX411">tables, selecting rows</A>
<LI><A HREF="manual.html#IDX419">tables, sorting rows</A>
<LI><A HREF="manual.html#IDX818">tables, symbolic links</A>
<LI><A HREF="manual.html#IDX717">tables, system</A>
<LI><A HREF="manual.html#IDX794">tables, too many</A>
<LI><A HREF="manual.html#IDX2143">tables, unique ID for last row</A>
<LI><A HREF="manual.html#IDX136">tables, updating</A>
<LI><A HREF="manual.html#IDX367">tar, problems on Solaris</A>
<LI><A HREF="manual.html#IDX2188">Tcl API</A>
<LI><A HREF="manual.html#IDX498"><CODE>tcp-ip</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX192">TCP/IP</A>, <A HREF="manual.html#IDX194">TCP/IP</A>
<LI><A HREF="manual.html#IDX69">technical support, licensing</A>
<LI><A HREF="manual.html#IDX105">technical support, mailing address</A>
<LI><A HREF="manual.html#IDX895"><CODE>tee</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX315">temporary file, write access</A>
<LI><A HREF="manual.html#IDX2296">temporary tables, problems</A>
<LI><A HREF="manual.html#IDX385">terminal monitor, defined</A>
<LI><A HREF="manual.html#IDX2194">testing mysqld, mysqltest</A>
<LI><A HREF="manual.html#IDX541">testing, connection to the server</A>
<LI><A HREF="manual.html#IDX304">testing, installation</A>
<LI><A HREF="manual.html#IDX178">testing, of MySQL releases</A>
<LI><A HREF="manual.html#IDX300">testing, post-installation</A>
<LI><A HREF="manual.html#IDX10">Texinfo</A>
<LI><A HREF="manual.html#IDX1171"><CODE>TEXT</CODE> columns, default values</A>
<LI><A HREF="manual.html#IDX770"><CODE>TEXT</CODE> columns, indexing</A>, <A HREF="manual.html#IDX1640"><CODE>TEXT</CODE> columns, indexing</A>
<LI><A HREF="manual.html#IDX991">text files, importing</A>
<LI><A HREF="manual.html#IDX1184"><CODE>TEXT</CODE>, size</A>
<LI><A HREF="manual.html#IDX2335">thread packages, differences between</A>
<LI><A HREF="manual.html#IDX167">thread support</A>
<LI><A HREF="manual.html#IDX296">thread support, non-native</A>
<LI><A HREF="manual.html#IDX2151">threaded clients</A>
<LI><A HREF="manual.html#IDX925">threads</A>, <A HREF="manual.html#IDX2192">threads</A>
<LI><A HREF="manual.html#IDX1760">threads, display</A>
<LI><A HREF="manual.html#IDX2334">threads, RTS</A>
<LI><A HREF="manual.html#IDX1180">time types</A>
<LI><A HREF="manual.html#IDX2264">time zone problems</A>
<LI><A HREF="manual.html#IDX509">timeout</A>, <A HREF="manual.html#IDX1483">timeout</A>, <A HREF="manual.html#IDX1533">timeout</A>
<LI><A HREF="manual.html#IDX903">timeout, <CODE>connect_timeout</CODE> variable</A>, <A HREF="manual.html#IDX938">timeout, <CODE>connect_timeout</CODE> variable</A>, <A HREF="manual.html#IDX973">timeout, <CODE>connect_timeout</CODE> variable</A>
<LI><A HREF="manual.html#IDX940">timeout, <CODE>shutdown_timeout</CODE> variable</A>
<LI><A HREF="manual.html#IDX2278"><CODE>TIMESTAMP</CODE>, and <CODE>NULL</CODE> values</A>
<LI><A HREF="manual.html#IDX745">tips, optimization</A>
<LI><A HREF="manual.html#IDX86">ToDo list for MySQL</A>
<LI><A HREF="manual.html#IDX2155">TODO, embedded server</A>
<LI><A HREF="manual.html#IDX819">TODO, symlinks</A>
<LI><A HREF="manual.html#IDX852">tools, command-line</A>
<LI><A HREF="manual.html#IDX946">tools, graphical</A>
<LI><A HREF="manual.html#IDX947">tools, GUI</A>
<LI><A HREF="manual.html#IDX2304">tools, list of</A>
<LI><A HREF="manual.html#IDX486">tools, mysqld_multi</A>
<LI><A HREF="manual.html#IDX481">tools, mysqld_safe</A>
<LI><A HREF="manual.html#IDX482">tools, safe_mysqld</A>
<LI><A HREF="manual.html#IDX85">trademarks</A>
<LI><A HREF="manual.html#IDX45">training</A>
<LI><A HREF="manual.html#IDX135">transaction-safe tables</A>, <A HREF="manual.html#IDX1865">transaction-safe tables</A>
<LI><A HREF="manual.html#IDX134">transactions, support</A>, <A HREF="manual.html#IDX1864">transactions, support</A>
<LI><A HREF="manual.html#IDX970"><CODE>translations_path</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX2300">Translators, list of</A>
<LI><A HREF="manual.html#IDX147">triggers</A>
<LI><A HREF="manual.html#IDX286">troubleshooting, FreeBSD</A>
<LI><A HREF="manual.html#IDX285">troubleshooting, Solaris</A>
<LI><A HREF="manual.html#IDX384">tutorial</A>
<LI><A HREF="manual.html#IDX455">Twin Studies, queries</A>
<LI><A HREF="manual.html#IDX1202">type conversions</A>
<LI><A HREF="manual.html#IDX60">types of support</A>
<LI><A HREF="manual.html#IDX1093">types, columns</A>, <A HREF="manual.html#IDX1188">types, columns</A>
<LI><A HREF="manual.html#IDX1091">types, data</A>
<LI><A HREF="manual.html#IDX1181">types, date</A>
<LI><A HREF="manual.html#IDX1149">types, Date and Time</A>
<LI><A HREF="manual.html#IDX1178">types, numeric</A>
<LI><A HREF="manual.html#IDX1807">types, of tables</A>
<LI><A HREF="manual.html#IDX1190">types, portability</A>
<LI><A HREF="manual.html#IDX1162">types, strings</A>
<LI><A HREF="manual.html#IDX1182">types, time</A>
<LI><A HREF="manual.html#IDX12">typographical conventions</A>
</DIR>
<H2>U</H2>
<DIR>
<LI><A HREF="manual.html#IDX1087">UCS-2</A>
<LI><A HREF="manual.html#IDX2219">UDFs, compiling</A>
<LI><A HREF="manual.html#IDX2198">UDFs, defined</A>
<LI><A HREF="manual.html#IDX2214">UDFs, return values</A>
<LI><A HREF="manual.html#IDX896"><CODE>unbuffered</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX1084">Unicode</A>
<LI><A HREF="manual.html#IDX2140">unique ID</A>
<LI><A HREF="manual.html#IDX156">UNIQUE, constraint</A>
<LI><A HREF="manual.html#IDX409">unloading, tables</A>
<LI><A HREF="manual.html#IDX1588">unnamed views</A>
<LI><A HREF="manual.html#IDX657">update log</A>
<LI><A HREF="manual.html#IDX180">updating, releases of MySQL</A>
<LI><A HREF="manual.html#IDX137">updating, tables</A>
<LI><A HREF="manual.html#IDX337">upgrading</A>
<LI><A HREF="manual.html#IDX349">upgrading, 3.20 to 3.21</A>
<LI><A HREF="manual.html#IDX348">upgrading, 3.21 to 3.22</A>
<LI><A HREF="manual.html#IDX346">upgrading, 3.22 to 3.23</A>
<LI><A HREF="manual.html#IDX344">upgrading, 3.23 to 4.0</A>
<LI><A HREF="manual.html#IDX342">upgrading, 4.0 to 4.1</A>
<LI><A HREF="manual.html#IDX354">upgrading, different architecture</A>
<LI><A HREF="manual.html#IDX352">upgrading, grant tables</A>
<LI><A HREF="manual.html#IDX340">upgrading, to 5.0</A>
<LI><A HREF="manual.html#IDX924">uptime</A>
<LI><A HREF="manual.html#IDX187">URLs for downloading MySQL</A>
<LI><A HREF="manual.html#IDX575">user privileges, adding</A>
<LI><A HREF="manual.html#IDX585">user privileges, deleting</A>, <A HREF="manual.html#IDX1682">user privileges, deleting</A>
<LI><A HREF="manual.html#IDX583">user privileges, dropping</A>, <A HREF="manual.html#IDX1680">user privileges, dropping</A>
<LI><A HREF="manual.html#IDX548"><CODE>user</CODE> table, sorting</A>
<LI><A HREF="manual.html#IDX1074">user variables</A>
<LI><A HREF="manual.html#IDX2197">user-defined functions, adding</A>, <A HREF="manual.html#IDX2208">user-defined functions, adding</A>
<LI><A HREF="manual.html#IDX897"><CODE>user</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX971"><CODE>user</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX499"><CODE>user</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX569">usernames, and passwords</A>
<LI><A HREF="manual.html#IDX214">users, adding</A>, <A HREF="manual.html#IDX220">users, adding</A>
<LI><A HREF="manual.html#IDX587">users, deleting</A>, <A HREF="manual.html#IDX1684">users, deleting</A>
<LI><A HREF="manual.html#IDX333">users, root</A>
<LI><A HREF="manual.html#IDX704">uses, of MySQL</A>
<LI><A HREF="manual.html#IDX821">using multiple disks to start data</A>
<LI><A HREF="manual.html#IDX1086">UTF-8</A>
<LI><A HREF="manual.html#IDX1085">UTF8</A>
</DIR>
<H2>V</H2>
<DIR>
<LI><A HREF="manual.html#IDX1043">valid numbers, examples</A>
<LI><A HREF="manual.html#IDX1185"><CODE>VARCHAR</CODE>, size</A>
<LI><A HREF="manual.html#IDX804">variables, <CODE>mysqld</CODE></A>
<LI><A HREF="manual.html#IDX506">variables, server</A>, <A HREF="manual.html#IDX1772">variables, server</A>
<LI><A HREF="manual.html#IDX512">variables, status</A>, <A HREF="manual.html#IDX1763">variables, status</A>
<LI><A HREF="manual.html#IDX507">variables, system</A>, <A HREF="manual.html#IDX1773">variables, system</A>
<LI><A HREF="manual.html#IDX1076">variables, System</A>
<LI><A HREF="manual.html#IDX1073">variables, user</A>
<LI><A HREF="manual.html#IDX508">variables, values</A>
<LI><A HREF="manual.html#IDX898"><CODE>verbose</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX173">version, choosing</A>
<LI><A HREF="manual.html#IDX184">version, latest</A>
<LI><A HREF="manual.html#IDX899"><CODE>version</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX972"><CODE>version</CODE>, <CODE>mysqlcc</CODE> option</A>
<LI><A HREF="manual.html#IDX500"><CODE>version</CODE>, <CODE>mysqld_multi</CODE> option</A>
<LI><A HREF="manual.html#IDX900"><CODE>vertical</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX150">views</A>
<LI><A HREF="manual.html#IDX274">virtual memory, problems while compiling</A>
<LI><A HREF="manual.html#IDX2171">Visual Basic</A>
</DIR>
<H2>W</H2>
<DIR>
<LI><A HREF="manual.html#IDX901"><CODE>wait</CODE>, <CODE>mysql</CODE> option</A>
<LI><A HREF="manual.html#IDX82">Web server, running</A>
<LI><A HREF="manual.html#IDX1882">Well-Known Binary format</A>
<LI><A HREF="manual.html#IDX1880">Well-Known Text format</A>
<LI><A HREF="manual.html#IDX598">What is an X509/Certificate?</A>
<LI><A HREF="manual.html#IDX597">What is encryption</A>
<LI><A HREF="manual.html#IDX781">wildcards, and <CODE>LIKE</CODE></A>
<LI><A HREF="manual.html#IDX557">wildcards, in <CODE>mysql.columns_priv</CODE> table</A>
<LI><A HREF="manual.html#IDX550">wildcards, in <CODE>mysql.db</CODE> table</A>
<LI><A HREF="manual.html#IDX551">wildcards, in <CODE>mysql.host</CODE> table</A>
<LI><A HREF="manual.html#IDX556">wildcards, in <CODE>mysql.tables_priv</CODE> table</A>
<LI><A HREF="manual.html#IDX542">wildcards, in <CODE>mysql.user</CODE> table</A>
<LI><A HREF="manual.html#IDX2157">Windows</A>
<LI><A HREF="manual.html#IDX298">Windows, compiling on</A>
<LI><A HREF="manual.html#IDX199">Windows, open issues</A>
<LI><A HREF="manual.html#IDX351">Windows, upgrading</A>
<LI><A HREF="manual.html#IDX196">Windows, versus Unix</A>
<LI><A HREF="manual.html#IDX1881">WKB format</A>
<LI><A HREF="manual.html#IDX1879">WKT format</A>
<LI><A HREF="manual.html#IDX2167">Word program</A>
<LI><A HREF="manual.html#IDX2190">wrappers, Eiffel</A>
<LI><A HREF="manual.html#IDX314">write access, tmp</A>
<LI><A HREF="manual.html#IDX619"><CODE>write_buffer_size</CODE> <CODE>myisamchk</CODE> variable</A>
</DIR>
<H2>X</H2>
<DIR>
<LI><A HREF="manual.html#IDX902"><CODE>xml</CODE>, <CODE>mysql</CODE> option</A>
</DIR>
<H2>Y</H2>
<DIR>
<LI><A HREF="manual.html#IDX41">Year 2000 compliance</A>
<LI><A HREF="manual.html#IDX1160">Year 2000 issues</A>
</DIR>

</P>

<P><HR><P>
This document was generated on 14 May 2004 using the
<A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html/">texi2html</A>
translator version 1.52 (extended by davida@detron.se).</P>
 </BODY>
 </HTML>
